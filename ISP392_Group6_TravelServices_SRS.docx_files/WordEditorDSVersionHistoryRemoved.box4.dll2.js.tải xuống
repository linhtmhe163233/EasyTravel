'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1516:function(D,J,c){D=c(0);var l=c(16),e=c(47),a=c(6),k=c(118),x=c(184),y=c(817),n=c(225),t=c(613),z=c(2),v=c(368),I=c(22),E=c(55),H=c(250),M=c(1),K=c(1586);class L{constructor(X,U){this.F2j=X;this.yA=U}J(X){return this.F2j.Gz(X,this.yA)}}Object(D.a)(L,"PropertyMergeStrategies",null,[]);var S=c(1659),Q=c(1612);class N extends Q.a{constructor(){super();this.D1c=this.Z4d=this.Wn=null;this.mbe=0}get vha(){return"Property"}lGb(){this.detail.Z("Type",
this.vha);this.detail.Z("ComplexMerger",null!=this.Wn?this.Wn:-1);this.detail.Z("Strategy",null!=this.Z4d?this.Z4d:-1);this.detail.Z("ClassId",null!=this.D1c?this.D1c:-1);this.detail.Z("PropId",this.mbe);return this.detail}}Object(D.a)(N,"PropertyMergeFailureDetail",Q.a,[]);c.d(J,"a",function(){return O});class O{constructor(X=null){this.zch=this.Zb=null;this.wZb=X||this.rRc()}get Wn(){return 1}get $mb(){return this.wZb}rRc(){return[Object(E.a)(this,this.YQo,"tryPreProcessFavoredRevision"),Object(E.a)(this,
this.F_k,"cloneObjectAndRemoveNeededProperties"),Object(E.a)(this,this.OQo,"tryMergeNodeInternal")]}get yA(){return 5}get obe(){return this.zch||(this.zch=new L(this.wk(),this.yA))}oC(X,U){const T=X.Ng.value.xf;x.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",T.id,T.Oc);X.tq.logger.Rg(Object.assign(new N,{Wn:this.Wn,D1c:T.Oc,mbe:U}));return!1}wog(X){const U=X.Ng.value;x.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",U.xf.id,U.xf.Oc);for(let T=0;T<this.$mb.length;T++)if(!(0,this.$mb[T])(X))return x.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",U.xf.id,U.xf.Oc,T),X.tq.logger.J3d("GraphNodeComplexMerge.GetMergeFunctions()",T),this.L5m(X),X.fl=null,!1;x.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",U.xf.id,U.xf.Oc);
return!0}L5m(X){X.qsg||(X.qsg=!0,S.a(X.Ng.value.vu,"Base",1),S.a(X.Ng.value.xf,"Favored",1),S.a(X.En.value.xf,"Conflict",1))}YQo(X){const U=X.Ng.value,T=this.obe;if(!U.DY)return!0;let Y=!0;U.Vqa.forEach((aa,ba)=>{if(!ba.DY||X.og.contains(aa))return!0;ba=T.J(aa);if(5===ba){const oa=U.vu.Oc;x.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",oa,aa,ba);X.tq.logger.Rg(Object.assign(new N,
{Wn:this.Wn,D1c:oa,mbe:aa,Z4d:ba}));return Y=!1}6===ba&&X.g4f.add(aa);return!0});return Y}F_k(X){X.fl=X.Ng.value.xf.ZK();const U=X.g4f,T=X.fl;U&&U.forEach(Y=>{T.removeProperty(y.a.$X(Y));return!0});return!0}OQo(X){const U=X.En.value,T=U.vu.Oc,Y=this.obe;let aa=!0;U.Vqa.forEach((ba,oa)=>{const ma=Y.J(ba);aa=this.PQo(X,oa,ba,ma);aa||(X.fl=null,x.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",T,ba,ma),X.tq.logger.Rg(Object.assign(new N,{Wn:this.Wn,
D1c:T,mbe:ba,Z4d:ma})));return aa});return aa}PQo(X,U,T,Y){const aa=X.fl;if(!U.DY&&8!==Y||2===Y||7===Y||X.og.contains(T))return!0;if(5===Y)return!1;if(4===Y||3===Y){let ba;if(({value:ba}=X.Ng.value.Vqa.Fc(T)).returnValue&&ba.DY)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!U.isDeleted)return X=y.a.$X(T),(O.q3o(U,T,X)||O.yuo())&&aa.DUa(X,U.newValue),!0;Y=6}return 6===Y?(aa.removeProperty(y.a.$X(T)),!0):1===Y?this.oC(X,T):!1}zdn(X,U,T,Y,aa,ba){X=X||new n.a;U=U||new n.a;T=T||new n.a;var oa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
X.length,U.length,T.length),ma=X.length<=U.length&&X.length<=T.length;this.jAi()&&ma&&x.a.instance.Ua(541181455,1,1,oa);if(!ma&&this.pyi(ba.runtime.Zb))return null;if(this.jAi())for(oa=0;oa<X.length;oa++){ma=X.eg(oa);var ea=U.eg(oa);let ua=T.eg(oa);ma=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ma,ea,ua,oa,X.length);x.a.instance.Ua(541181457,1,1,ma)}if(this.pyi(ba.runtime.Zb))for(ba=
0;ba<X.length;ba++)if(oa=X.eg(ba),ma=U.eg(ba),ea=T.eg(ba),!Y(oa,ma)||!Y(oa,ea))return null;X=X.S5();Y=new t.a;ba=X.length;for(oa=ba;oa<U.length;oa++)ma=U.eg(oa),X.add(ma),Y.add(ma);for(;ba<T.length;ba++)U=T.eg(ba),Y.contains(U)?x.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",U):(X.add(U),aa(U));return X}jAi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}pyi(X){if(!X)return!1;
X.UVd(1000008);return X.Tjb(1000008)}FVm(X){if(!X)return!1;X.UVd(1000009);return X.Tjb(1000009)}kPi(X,U,T,Y){return K.a(X,U,T,Y)}sHa(X,U,T){X=X||new n.a;U=U||new n.a;T=T||new n.a;const Y=X.hH(),aa=U.hH(),ba=T.hH();X=O.filter(X,oa=>aa.contains(oa)&&ba.contains(oa));X.hH();X.$C(X.length,O.filter(U,oa=>!Y.contains(oa)));X.$C(X.length,O.filter(T,oa=>!Y.contains(oa)&&!aa.contains(oa)));return X}sdn(X,U){const T=y.a.$X(U),Y=X.Xd;var aa=Y.getPropertyObjectIds(X.Ng.value.vu,T),ba=Y.getPropertyObjectIds(X.Ng.value.xf,
T);const oa=Y.getPropertyObjectIds(X.En.value.xf,T);aa=this.sHa(aa,ba,oa);ba=X.fl;0<aa.length?Y.setPropertyObjectIds(ba,T,aa):ba.removeProperty(T);X.og.add(U)}Mgb(X,U,T){X.hasProperty(T)?U.DUa(T,X.AU(T)):U.removeProperty(T)}C4n(X,U){var T=U.xl();for(const Y of T)U.removeProperty(Y);T=X.xl();for(const Y of T)U.DUa(Y,X.AU(Y))}UJf(X,U,T,Y,aa){U=X.getPropertyInt32(U,aa);T=X.getPropertyInt32(T,aa);T=null!=U&&null!=T?Math.max(U,T):null!=T?T:null!=U?U:null;null!=T?X.setPropertyInt32(Y,aa,T):Y.removeProperty(aa)}b8e(X,
U,T,Y,aa,ba){U=X(U,aa);T=X(T,aa);X=X(Y,aa);Y=U.hH();let oa=!1;ba&&(oa=ba(U,T,X));oa?(ba=!0,Y=!1):(ba=Y.bJh(T),Y=Y.bJh(X));x.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.Ab(aa),U.hr(),T.hr(),X.hr(),ba,Y);return{NJc:X,x4a:ba,n4a:Y}}pWk(X,U,T,Y,aa){let ba;U=X(U,aa);T=X(T,aa);X=X(Y,aa);Y=this.vDi(U,T);ba=this.vDi(U,X);x.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.Ab(aa),U.hr(),T.hr(),X.hr(),Y,ba);return{NJc:X,x4a:Y,n4a:ba}}vDi(X,U){if(!X&&!U)return!0;if(!X||!U)return!1;if(!X.count&&!U.count)return!0;let T=!1;U.forEach((Y,aa)=>T=X.nb(Y)&&aa==X.J(Y));return T}wk(){let X;X=this.FVm(this.Zb)?O.cak.value:O.bak.value;const U=new v.a(0);for(let T=0;T<X.length;T++)U.Z(X[T],7);return U}static w8(){return new O}static get instance(){return O._instance.value}static yuo(){return I.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(79)}static q3o(X,U,T){if(void 0!==
X.newValue&&null!==X.newValue||M.a.UAi(T.type))return!0;O.K6m(X,U,T);return!1}static K6m(X,U,T){T=T.type===M.a.string;U=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",U);T||(U+=String.format(" [NewValue: {0}] [OldValue: {1}]",X.newValue,X.oldValue));x.a.instance.Ua(19145822,1,2,U)}static WPf(X,U,T){const Y=y.a.Ab(T),aa=X.Xd;var ba=aa.getPropertyObjectIds(X.Ng.value.vu,T);const oa=aa.getPropertyObjectIds(X.Ng.value.xf,T);var ma=aa.getPropertyObjectIds(X.En.value.xf,T);ma=O.Jkm(ma,
X.tq.runtime.xmc);U=U.sHa(ba,oa,ma);ba=X.fl;0<U.length?aa.setPropertyObjectIds(ba,T,U):ba.removeProperty(T);X.og.add(Y);return!0}static Jkm(X,U){const T=new n.a;X.forEach(Y=>{U.contains(Y,(aa,ba)=>aa.equals(ba))||T.add(Y);return!0});return T}static filter(X,U){const T=new n.a;X.forEach(Y=>{U(Y)&&T.add(Y);return!0});return T}static P0l(){return[y.a.Ab(l.a.Lif),y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.EL),y.a.Ab(l.a.p8c),y.a.Ab(l.a.Cag),y.a.Ab(e.a.B1c),y.a.Ab(a.a.bId),y.a.Ab(a.a.Chb),y.a.Ab(k.a.khj)]}static Q0l(){return[y.a.Ab(l.a.Lif),
y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.EL),y.a.Ab(l.a.p8c),y.a.Ab(l.a.Cag),y.a.Ab(e.a.B1c),y.a.Ab(a.a.bId),y.a.Ab(k.a.khj)]}}O._instance=new H.a(O.w8);O.bak=new H.a(O.P0l);O.cak=new H.a(O.Q0l);Object(D.a)(O,"GraphNodeComplexMerge",null,[1918])},1517:function(D,J,c){c.r(J);D=c(0);var l=c(111),e=c(1536),a=c(1523),k=c(1662),x=c(1663);class y{constructor(t,z){this.icb=!1;this.Tia=null;if(!t)throw Error.argumentNull("annotations");if(!t.vec(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.Bw=t;this.Kfc=this.Bw.Edi(z);this.Hlk=z}get i3b(){return this.Bw}get isReadOnly(){return this.icb}get cVa(){return this.Hlk}kjb(t){if(0>t||t>=this.Kfc)throw Error.argument("iField","Invalid field index");return this.Tia&&null!=this.Tia[t]?this.Tia[t]:this.Bw.fii(this.cVa,t)}Ldg(t,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.Kfc)throw Error.argument("iField","Invalid field index");if(!this.Bw.qdc(this.Bw.lHb(this.cVa,
t),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Tia||(this.Tia=Array(this.Kfc)))[t]=z}Pea(){const {Annotations:t}=c(1517);let z="[";if(this.Tia){let v=!0;for(let I=0;I<this.Kfc;++I){if(null==this.Tia[I])continue;const E=this.Bw.lHb(this.cVa,I);if(t.nsb(E,this.Tia[I],this.Bw.fii(this.cVa,I)))continue;v?v=!1:z+=", ";z+=this.Bw.gii(this.cVa,I);z+="=";const H=this.Bw.Pea(E,this.Tia[I]);E===t.baa?(z+='"',z+=e.a.Ijf(H),z+='"'):z+=H}}return z+"]"}isEqual(t){const {Annotations:z}=
c(1517);if(this===t)return!0;if(!t||this.Bw!==t.i3b||this.cVa!==t.cVa)return!1;for(let v=0;v<this.Kfc;++v)if(!z.nsb(this.Bw.lHb(this.cVa,v),this.kjb(v),t.kjb(v)))return!1;return!0}clone(){const t=new y(this.Bw,this.cVa);this.Tia&&(t.Tia=Array.clone(this.Tia));return t}$T(){return this.isReadOnly?this.clone():this}hNf(){const {Annotations:t}=c(1517);if(!this.isReadOnly&&(this.icb=!0,this.Tia))for(let z=0;z<this.Kfc;++z){const v=this.Tia[z];null!=v&&t.kLb(v)}}toString(){return this.Pea()}}Object(D.a)(y,
"StructValue",null,[1427,1425]);c.d(J,"Annotations",function(){return n});class n{constructor(t,z){if(!t)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.T9m=z.htl;let v=0;var I=z.Xib(t.J(v));++v;this.UOf=new k.a(new x.a(I));this.B2j=t.J(v);++v;this.IMi=Array(this.wNd);this.$_c=Array(this.wNd);this.Rmb=Array(this.wNd);for(I=0;I<this.wNd;++I){this.IMi[I]=z.JB(t.J(v));++v;this.$_c[I]=t.J(v);++v;var E=t.J(v);++v;this.Rmb[I]=Array(E);for(var H=0;H<E;++H)this.Rmb[I][H]=
z.JB(t.J(v)),++v}this.Glk=t.J(v);++v;this.pNi=Array(this.jbd);this.o4d=Array(this.jbd);this.p4d=Array(this.jbd);this.n4d=Array(this.jbd);for(I=0;I<this.jbd;++I)for(this.pNi[I]=z.JB(t.J(v)),++v,E=t.J(v),++v,this.o4d[I]=Array(E),this.p4d[I]=Array(E),this.n4d[I]=Array(E),H=0;H<E;++H)this.o4d[I][H]=z.JB(t.J(v)),++v,this.p4d[I][H]=t.J(v),++v,this.n4d[I][H]=({iia:v}=this.mPa(this.p4d[I][H],t,v,null,null,null)).returnValue,n.kLb(this.n4d[I][H]);this.bXj=t.J(v);++v;this.yOf=Array(this.G3b);this.zOf=Array(this.G3b);
this.xOf=Array(this.G3b);for(I=0;I<this.G3b;++I)this.yOf[I]=z.JB(t.J(v)),++v,this.zOf[I]=t.J(v),++v,this.xOf[I]=({iia:v}=this.mPa(this.zOf[I],t,v,null,null,null)).returnValue,n.kLb(this.xOf[I])}LPc(t){for(let z=0;z<this.G3b;++z)if(this.yOf[z]===t)return z;return-1}L5h(t){if(!this.sec(t))throw Error.argument("attrID","Invalid attribute ID");return this.yOf[t]}getAttributeType(t){if(!this.sec(t))throw Error.argument("attrID","Invalid attribute ID");return this.zOf[t]}lHb(t,z){if(!this.vec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.p4d[n.kbd(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}Pea(t,z){if(!this.rJf(t))throw Error.argument("typeID","Invalid type ID");if(!this.qdc(t,z))throw Error.argument("value","Value is not of the correct type");switch(t){case n.baa:return z;case n.mAa:return z?"True":"False";case n.VJa:case n.Vra:return z.toString();case n.SV:return z.Pea();default:if(!n.uI(t)&&n.vdd(t)){t=n.yjf(t);const E=this.Rmb[t].length;switch(this.$_c[t]){case 0:return this.Rmb[t][z];
case 1:if(z){var v="";for(var I=1;I<E;++I)z&1<<I-1&&(0<v.length&&(v+=" & "),v+=this.Rmb[t][I]);return v}return this.Rmb[t][0];case 2:v="";for(I=0;I<E;++I)z&1<<I&&(0<v.length&&(v+=" & "),v+=this.Rmb[t][I]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.$_c[t]);}}else return z.Pea()}}rJf(t){switch(t){case n.baa:case n.mAa:case n.VJa:case n.Vra:case n.SV:return!0;default:return n.uI(t)?this.rJf(n.W2a(t)):n.vdd(t)?this.QXm(t):this.vec(t)}}QXm(t){t=n.yjf(t);return 0<=
t&&t<this.IMi.length}vec(t){t=n.kbd(t);return 0<=t&&t<this.pNi.length}sec(t){return 0<=t&&t<this.G3b}qdc(t,z){if(null==z)return!1;switch(t){case n.baa:return"string"===typeof z;case n.mAa:return"boolean"===typeof z;case n.VJa:return"number"===typeof z;case n.Vra:return"number"===typeof z;case n.SV:return Object(l.a)(1424,z);default:if(n.uI(t))return Object(l.a)(1426,z)&&z.i5===n.W2a(t);if(n.vdd(t)){if("number"!==typeof z)return!1;t=n.yjf(t);const v=this.Rmb[t].length;switch(this.$_c[t]){case 0:return 0<=
z&&z<v;case 1:return!(z&-1<<v-1);case 2:return!!z&&!(z&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.$_c[t]);}}else return Object(l.a)(1427,z)&&z.cVa===t}}get G3b(){return this.bXj}get wNd(){return this.B2j}get jbd(){return this.Glk}$Ol(t){if(!this.sec(t))throw Error.argument("attrID","Invalid attribute ID");return this.xOf[t]}Edi(t){if(!this.vec(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.o4d[n.kbd(t)].length}gii(t,z){if(!this.vec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.o4d[n.kbd(t)][z]}fii(t,z){if(!this.vec(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.n4d[n.kbd(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}mPa(t,z,v,I,E,H){if(!z)throw Error.argumentNull("initData");if(n.uI(t)){var M=z.J(v);++v;t=n.W2a(t);var K=new a.a(this,t);for(var L=0;L<M;++L)Array.add(K.items,({iia:v}=this.mPa(t,z,v,I,E,H)).returnValue);return{returnValue:K,iia:v}}switch(t){case n.baa:return{returnValue:(I||
this.UOf).JB(z.J(v++)),iia:v};case n.mAa:return{returnValue:1===z.J(v++),iia:v};case n.VJa:return{returnValue:z.J(v++),iia:v};case n.Vra:return{returnValue:(E||this.T9m)[z.J(v++)],iia:v};case n.SV:t=z.J(v++);M=new e.a(this);for(K=0;K<t;++K)L=z.J(v),++v,H&&(L=H[L]),M.ez(L,({iia:v}=this.mPa(this.getAttributeType(L),z,v,I,E,H)).returnValue);return{returnValue:M,iia:v};default:if(n.vdd(t))return{returnValue:z.J(v++),iia:v};if(n.YDj(t)){M=z.J(v++);K=new y(this,t);for(L=0;L<M;++L){const S=z.J(v);++v;K.Ldg(S,
({iia:v}=this.mPa(this.lHb(t,S),z,v,I,E,H)).returnValue)}return{returnValue:K,iia:v}}throw Error.argument("typeID","Invalid type ID");}}static vdd(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static YDj(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static uI(t){return 32768===(t&32768)}static l4l(t){if(n.uI(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static W2a(t){if(!n.uI(t))throw Error.argument("listTypeID","List type ID required");
return t&-32769}static nsb(t,z,v){switch(t){case n.baa:case n.mAa:case n.VJa:case n.Vra:return z===v;case n.SV:return z.isEqual(v);default:return n.uI(t)?z.isEqual(v):n.vdd(t)?z===v:z.isEqual(v)}}static kLb(t){Object(l.a)(1425,t)&&t.hNf()}static $T(t){return Object(l.a)(1425,t)?t.$T():t}static yjf(t){return t-16}static kbd(t){return(t&-16385)-16}}n.baa=1;n.mAa=2;n.VJa=3;n.Vra=5;n.SV=9;Object(D.a)(n,"Annotations",null,[1428])},1521:function(D,J,c){D=c(0);var l=c(349);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(D.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var k=c(1753),x=c(1754),y=c(1755),n=c(1756),t=c(2),z=c(1569),v=c(1583),I=c(35),E=c(20),H=c(19),M=c(26);c.d(J,"a",function(){return K});class K{static get $Cf(){return"Insights_16x16x32"}static get GEl(){return"Find_16x16x32"}static get b1i(){return"-Parameterized"}static get xig(){return"Parameterized"}static get Dne(){return"bTryQuery"}static get Dog(){return"TellMeSuggestion_"}static get yDj(){return"bTryQueryAlternate"}static get Ylg(){return"MenuTellMe"}static get WCn(){const L=
{},S=[];Array.add(S,{Term:{PeopleType:"Person"}});L.And=S;return L}static Ncf(L){return L+K.b1i}static getParameter(L){let S="",Q="";if(L)for(let N=0;N<L.D_h;++N)"Type"===L.$qf(N)?S=L.getValue(N):"Value"===L.$qf(N)&&(Q=L.getValue(N));return new l.a(S,Q)}static ADb(L){L=Object.assign(new a,{neighborhood:L,mentionStart:0,mentionLength:L.length});return I.c(L)}static gOh(L,S,Q){L=Object.assign(new e,{displayName:L,email:S,userId:Q});return I.c(L)}static ePa(L,S,Q=null){return I.c(K.Mhi(L,S,Q,null))}static Mhi(L,
S,Q=null,N=null){L=Object.assign(new v.a,{neighborhood:L,mentionStart:0,mentionLength:L?L.length:0});return Object.assign(new z.a,{selection:L,userIntent:N,entryPoint:S,launchData:Q})}static P8n(L,S){return K.ePa(L,K.sfj(S))}static sfj(L){switch(L){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static rOm(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static eec(){const L=
t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!L&&0<L.length}static isEnterpriseUser(){const L=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("HostAuthType"):null;return!!L&&"aad"===L.toLowerCase()||"external"===L&&K.QEf()}static qgg(L){return L.HJo&&!K.eec()}static PUm(){const L=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===L&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static pgg(L){return L.tVa&&L.JCl&&(L.Vbd||L.Tbd||L.amb)&&!K.PUm()&&K.isEnterpriseUser()&&!K.eec()}static Npa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.A8a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.A8a}static GR(L){return!L||K.qDi(L.Fg)}static qDi(L){return!L||!L.trim().length}static nne(L){if(!L)return 0;const S=Math.pow(10,5);return Math.round(L*S)/S}static ULo(){var L=new Date;return L?new Date(L.getUTCFullYear(),L.getUTCMonth(),L.getUTCDate(),
L.getUTCHours(),L.getUTCMinutes(),L.getUTCSeconds(),L.getUTCMilliseconds()):null}static gwf(L){L=new Date(L);return(K.ULo().getTime()-L.getTime())/1E3}static ZDi(L){const {InsightsMenuItemFactory:S}=c(1752);switch(L){case k.a.Qzf:case x.a.q1h:case S.Nti:case y.a.dSi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return L.startsWith(K.Dne)||
L.startsWith(K.Dog)||L.startsWith(K.yDj)||L.startsWith("PeopleSuggestion")||L.startsWith("FileSuggestion")||L.startsWith("FindInDocumentSuggestion")||L.startsWith("NotesSuggestion")||L.startsWith("OnenoteNotesSuggestion")||L.startsWith("SmartLookupFromTellMe")||L.startsWith("GetHelpFromTellMe")||L.startsWith("GetHelpWithDescriptionFromTellMe")||L.startsWith("AddinSuggestion")||L.startsWith("OfficeScripts")?!0:!1}static trf(L,S){const Q=[];Array.add(Q,new n.a(400,L));Array.add(Q,new n.a(200,S));L=
{};L.parts=Q;return JSON.stringify(L)}static Uib(L){const S=L.indexOf("<b0>"),Q=L.lastIndexOf("</b0>"),N=[];Array.add(N,new n.a(400,L.substring(0,S)));Array.add(N,new n.a(600,L.substring(S+4,Q)));Array.add(N,new n.a(400,L.substring(Q+5,L.length)));L={};L.parts=N;return JSON.stringify(L)}static Eji(L){const S=K.gwf(L);return 60>S?CommonUIStrings.l_TimeSince_SecsAgo:3600>S?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(S/60).toString()):86400>S?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(S/3600).toString()):172800>S?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(L)).localeFormat("MMMM dd, yyyy"))}static ASl(L){const S=Array(L.length);for(let Q=0;Q<L.length;Q++)S[Q]=L[Q].commandId;return S}static QEf(){if("Dev Box"===t.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let L=t.AFrameworkApplication.K.kb("UserPrincipalName");L=M.c(L)?"":H.a.eh(L);const S=t.AFrameworkApplication.K.rw("TellMeIntEnabledForFeatureCrew")?
t.AFrameworkApplication.K.EB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(S,L)&&"inner"===t.AFrameworkApplication.K.kb("Microsoft365Ring")}static L0l(L){switch(K.bSd(L)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static jfm(L){L=K.bSd(L);switch(L){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return L}}static bSd(L){switch(L.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Cpa(){return E.a.U4&&!E.a.Er}}K.b9a=9E5;Object(D.a)(K,"TellMeUtils",null,[])},1522:function(D,J,c){c.r(J);D=c(0);var l=c(505),e=c(360),a=c(55),k=c(111),x=c(69),y=c(1673),n=c(219);class t{constructor(rb,cb,rc,Rb,fb,Pb){this.groupType=rb;this.resultType=cb;this.nkg=rc;this.i9=Rb;this.xgf=fb;this.resultIndex=
Pb}}Object(D.a)(t,"ClickLoggingInfo",null,[]);const z=rb=>{const cb=[];for(;rb;)Array.add(cb,"{ContextId:"+rb.contextId+", IsGraphNodeContext:"+rb.al+"}"),rb=rb.ik;cb.reverse();return"{"+cb.join(", ")+"}"};class v{constructor(){this.tpa=this.sessionId=null}}Object(D.a)(v,"CorrelationRecord",null,[1312]);var I=c(1542);class E{constructor(rb,cb){this.provider=rb;this.p9a=cb}}Object(D.a)(E,"ExternalResultProvider",null,[]);class H{constructor(rb,cb){this.Id=null;this.TimeStamp=0;this.Id=rb;this.TimeStamp=
cb}}Object(D.a)(H,"MRUControl",null,[]);var M=c(1664),K=c(1521),L=c(2),S=c(1397);class Q{constructor(rb,cb){this.tbk=10;this.y7=[];this.bCa=[];this.q2g=this.p2g=!1;this.Rzc=this.Qzc="";this.uZb=cb;this.fc=rb}nQc(){!this.p2g&&this.fc&&(this.Qzc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.y7=this.B6h(),this.p2g=!0);return this.y7}mbm(){!this.q2g&&this.fc&&(this.Rzc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.bCa=this.B6h(!0),this.q2g=!0);return this.bCa}QWm(rb){return rb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===rb||"TryOfficeUpsell"===rb}vEf(rb){return this.HIm(rb)||this.QWm(rb)||K.a.ZDi(rb)?!1:!0}C_a(rb){rb=rb.ControlId;this.vEf(rb)&&(rb=this.S8f(rb),this.O0n(rb),this.N$m(),Array.insert(this.y7,0,new H(rb,Date.now())),this.Qzc.length&&(rb=JSON.stringify(this.y7),S.a.instance.setItem(this.Qzc,rb)))}WE(rb){this.M$m();Array.insert(this.bCa,0,new H(M.a[rb],Date.now()));this.Rzc.length&&(rb=JSON.stringify(this.bCa),S.a.instance.setItem(this.Rzc,rb))}B6h(rb=!1){if(!this.y7.length){var cb=
rb?S.a.instance.getItem(this.Rzc):S.a.instance.getItem(this.Qzc);if(!cb||""===cb)return rb?this.bCa:this.y7;let rc=null;try{rc=JSON.parse(cb)}catch(Rb){this.GYk(rb),rc=null}if(!rc||!rc.length||10<rc.length)return rb?this.bCa:this.y7;cb=0;for(const Rb of rc)if(rb||this.fc.P1d(Rb.Id)&&this.vEf(Rb.Id))if(rb?Array.insert(this.bCa,cb++,Rb):Array.insert(this.y7,cb++,Rb),cb===this.uZb)break}return rb?this.bCa:this.y7}E$e(rb){rb=this.S8f(rb);for(const cb of this.y7)if(cb.Id===rb)return!0;return!1}GYk(rb=
!1){S.a.instance.setItem(rb?this.Rzc:this.Qzc,"")}VKm(rb){rb=this.S8f(rb.ControlId);return this.vEf(rb)?this.E$e(rb):!1}O0n(rb){if(0<this.y7.length){let cb=0;for(const rc of this.y7){if(rc.Id===rb){Array.removeAt(this.y7,cb);break}cb++}}}S8f(rb){return"Excel"===this.fc.application&&rb.startsWith("m_excelWebRenderer_ewaCtl_")?rb.substr(26,rb.length):rb}N$m(){this.y7.length===this.uZb&&Array.removeAt(this.y7,this.y7.length-1)}M$m(){this.bCa.length===this.tbk&&Array.removeAt(this.bCa,this.bCa.length-
1)}HIm(rb){rb=rb.split("|");let cb="";if(6<=rb.length)cb=rb[0];else if(3<=rb.length){if("3"===rb[0])return!0;cb=rb[1]}return cb.startsWith("WA")}static createInstance(rb){let cb=3;L.AFrameworkApplication.K&&(cb=L.AFrameworkApplication.K.nc("TellMeMaxRecommendedResultsToReturn",3));return new Q(rb,cb)}}Object(D.a)(Q,"MruControlsManager",null,[1311]);class N{constructor(rb){this.iyb=rb}aha(rb,cb){let rc;return rb.gD&&(rc=this.iyb[rb.value])?rc.aha(rb,cb):(rc=this.A7h(rb.value))?rc.aha(rc.tfn,cb):null}T9l(rb,
cb){if(rb=this.iyb[rb])for(const rc of cb)if(cb=K.a.getParameter(rc),cb.key===rb.l0f)return cb.value;return null}ljn(rb){(rb=this.A7h(rb))&&rb.ijn()}A7h(rb){const cb=rb.indexOf(K.a.b1i);return 0<cb?this.iyb[rb.substring(0,cb)]:null}}Object(D.a)(N,"ParameterizedCommandManager",null,[1310]);var O=c(1553);class X{constructor(rb,cb){this.Fg=rb;this.Yob=cb}}Object(D.a)(X,"TellMeQuery",null,[]);var U=c(1661);class T{constructor(rb,cb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=rb;this.TimeElapsedSinceClick=
cb}}Object(D.a)(T,"CommandClickedEvent",null,[]);var Y=c(26);class aa{constructor(rb,cb){this.Ldk=rb;this.Vta=cb}resultsUpdated(rb){this.Ldk(Y.c(rb.query)?"":rb.query.Fg,rb.vo,rb.attributes,this.Vta,rb.Kdc)}}Object(D.a)(aa,"ResultsUpdatedCallback",null,[1309]);class ba{constructor(rb,cb,rc,Rb,fb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=rb;this.TimeElapsedSinceClick=rc;this.CommandSurface=Rb;this.CommandId=
cb;this.TerminalParentControlId=fb}}Object(D.a)(ba,"UserActionEvent",null,[]);var oa=c(75);class ma{constructor(rb,cb){this.menuModel=rb;this.qfj=cb}}Object(D.a)(ma,"GeneratedMenuModel",null,[]);class ea{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(ea,"MenuModel",null,[]);class ua{constructor(rb,cb,rc){this.fc=rb;this.iyb=cb;this.lga=rc}XLl(rb,cb,rc){const {TellMeActor:Rb}=c(1522);let fb=0;const Pb=new ea,Ec=[];let uc=
"";Pb.sections=[];let ya=new oa.a;const db=!!this.fc&&this.fc.f5a;var tb=!!this.fc&&this.fc.Aqb||L.AFrameworkApplication.ta.Kb.Aqb;for(const $b of rb){rb=0;db||(ya=new oa.a);const Ab=new oa.a;let vc=$b.displayName;for(const Sc of $b.results){if(0<=Sc.value.indexOf(K.a.xig)){if(Sc.gD){var Xb=this.iyb[Sc.value];if(Xb&&Sc.value.endsWith(K.a.xig)){if("FindParameterized"!==Sc.value&&!tb){const ed=[];ed.push(appChrome.actions.setControlLabel(Sc.value,Xb.RSd(Sc)));ed.push(appChrome.actions.setButtonCommandValueId(Sc.value,
Xb.ypf(Sc)));appChrome.api.dispatch(ed)}Xb=Sc.value.replace(K.a.xig,"");ya.remove(Xb)?rb--:Ab.add(Xb);ya.add(Sc.value);rb++}}}else switch(Sc.type){case 5:Ab.contains(Sc.value)||(ya.add(Sc.value),rb++);break;case 7:ya.add(Sc.gD);rb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:ya.add(Sc.value),rb++}13===$b.groupType&&(vc=K.a.Npa()?0<cb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
cb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,cb));21===$b.groupType&&(vc=CommonUIStrings.l_LearningUILiveText)}fb+=rb;""!==vc&&0<rb&&(uc+=" , "+rb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+vc+" , ");0<ya.count&&!db&&(rb=appChrome.api.menuSection(ya.toArray(),$b.displayName,null,O.a[$b.groupType]),Ec.push(rb))}tb=null;0<fb&&(tb=0<cb.length?1!==fb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
fb,cb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,cb):1!==fb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,fb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,db?(cb=appChrome.api.menuSection(ya.toArray(),"",null,null),Ec.push(cb)):tb+=uc);rc&&(this.fc.exa?Rb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(tb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(tb)));Pb.sections=
Ec;return new ma(Pb,fb,[])}static get sif(){return ua.rUg||(ua.rUg=new ma(Object.assign(new ea,{sections:[]}),0,[]))}}ua.rUg=null;Object(D.a)(ua,"TellMeMenuDefintionGenerator",null,[]);var sa;(function(rb){rb[rb.TellMeControlActivated=0]="TellMeControlActivated";rb[rb.TellMeQueryExecuted=1]="TellMeQueryExecuted";rb[rb.TellMeResultsRendered=2]="TellMeResultsRendered";rb[rb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(sa||(sa={}));Object(D.b)("PerformanceMarker",sa);var Fa;(function(rb){rb[rb.TellMeTimeToRender=
0]="TellMeTimeToRender";rb[rb.TellMeSessionLength=1]="TellMeSessionLength";rb[rb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Fa||(Fa={}));Object(D.b)("PerformanceMeasure",Fa);class Pa{mark(rb){window.performance.mark(sa[rb])}measure(rb,cb,rc){const {TellMeActor:Rb}=c(1522);try{window.performance.measure(Fa[rb],sa[cb],sa[rc])}catch(fb){Rb.instance.Pe.onError("TellMePerformance:Measure","error measuring "+Fa[rb])}}INf(rb,cb,rc){const {TellMeActor:Rb}=c(1522);Rb.instance.Pe.RNf(cb,rc,rb,this.W4l(rb))}jZk(){var rb=
[0,1,2,3];for(const cb of rb)window.performance.clearMarks(sa[cb])}clearMeasures(rb){for(const cb of rb)window.performance.clearMeasures(Fa[cb])}W4l(rb){let cb=0;(rb=this.KNl(rb))&&0<rb.length&&(cb=rb[rb.length-1].duration);return cb}KNl(rb){return window.performance.getEntriesByName(Fa[rb],"measure")}}Object(D.a)(Pa,"TellMePerformance",null,[]);var Na=c(1589),Aa=c(1588),za=c(35);class xa{constructor(rb){this.Imk=rb}YMb(rb,cb,rc){const {TellMeActor:Rb}=c(1522);Rb.instance.Pe.W9(cb,Aa.a.Vic,rb.data.Ne.toString(),
Math.round(window.performance.now()-rc),Aa.a.Vic,!0,Na.a.XQa);rb=za.b(rb.data.te);cb=-1;rb.Index&&(cb=rb.Index);Rb.instance.Pe.Q7m(cb,this.Imk)}HMb(rb,cb,rc){const {TellMeActor:Rb}=c(1522);Rb.instance.Pe.W9(cb,Aa.a.Vic,rb.data.Ne.toString(),Math.round(window.performance.now()-rc),Aa.a.Vic,!1,Na.a.XQa)}sbm(rb){if(rb&&""!==rb.trim()){const rc=window.performance.now(),Rb=L.AFrameworkApplication.fzj;var cb={};cb.Text=rb;cb.IsFileHash="false";cb=za.c(cb);L.AFrameworkApplication.He.nj(Rb,2,cb,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,fb=>{this.YMb(fb,rb.length,rc)},fb=>{this.HMb(fb,rb.length,rc)},null,null,!1,4E3,6E3)}}}Object(D.a)(xa,"TellMeQueryIndexCallback",null,[]);var ka=c(1524);class wa{constructor(rb,cb,rc){this.xml=rb;this.qfj=cb;this.Fql=rc}}Object(D.a)(wa,"GeneratedMenuXml",null,[]);var ia=c(1753),va=c(19);class na{constructor(rb,cb){this.ojd=rb||{};this.TYa=cb}get xPb(){return 5}aha(rb,cb=null){return this.TYa.aha(rb,cb)||this.HNk(rb.value)}HNk(rb){return na.U5e(rb,this.ojd[rb]||null)}static U5e(rb,
cb=null){rb=String.format('<ClonedControl Id="{0}" ',rb);for(let fb in cb){var rc=fb,Rb=cb[fb];Rb=Rb?va.a.zf(Rb.toString()):"";rb+=String.format('{0}="{1}" ',rc,Rb)}return rb+"/>"}}Object(D.a)(na,"CommandMenuItemFactory",null,[1306]);var Ca=c(163);class ta{constructor(){this.u3j=CommonUIStrings.l_FindInDocumentText}get xPb(){return 8}aha(rb){var cb=rb.gD;rb=va.a.zf(rb.value);const rc=va.a.zf(cb);cb=va.a.zf(String.format(this.u3j,cb));return this.kLl(rb,rc,cb)}kLl(rb,cb,rc){return Ca.a(rb,"1540292897",
rc,K.a.GEl,null,cb,rc,null,null)}}Object(D.a)(ta,"FindInDocumentMenuItemFactory",null,[1306]);var fa=c(1754),Xa=c(1752),ob=c(1755);class xb{get xPb(){return 7}aha(rb){const cb=Object(x.a)(U.a,rb);return this.fMl(va.a.zf(rb.value),cb.id)}fMl(rb,cb){return Ca.a(cb,"1404166600",rb,null,null,rb,rb,null,null)}}Object(D.a)(xb,"TryQueryMenuItemFactory",null,[1306]);class zb{constructor(rb){this.a7=[];this.fc=rb}bYl(rb){for(const cb of this.a7)if(cb.xPb===rb)return cb;return null}ia(rb){this.a7.push(rb)}RVn(rb){this.ia(new na(this.fc.c7k,
rb));this.ia(new ob.a(this.fc.Yhn));this.ia(new ia.a(this.fc.Hco,this.fc.Gco,this.fc.QJo,this.fc.Kum,this.fc.Cto));this.ia(new Xa.InsightsMenuItemFactory);this.ia(new ta);this.ia(new fa.a);this.ia(new xb)}}Object(D.a)(zb,"MenuItemFactoryRegistry",null,[]);var Lb=c(1526);class Ia{constructor(rb,cb){this.fc=rb;this.u7g=new zb(this.fc);this.u7g.RVn(cb)}YLl(rb,cb){let rc=0;const Rb=[],fb=[];for(const Ec of rb){rb=K.a.Ylg;var Pb=[];for(const uc of Ec.results){const ya=this.u7g.bYl(uc.type).aha(uc,cb);
rb=K.a.Ylg;Pb.push(ya);if(13===uc.type||14===uc.type)rb="Menu32";17===uc.type&&(rb="MenuTellMeExtended");uc.groupType=Ec.groupType;fb.push(Object(x.a)(Lb.a,uc))}rc=rc?rc:Pb.length;Pb=Ca.d("TellMeDropdownControls",Pb);rb=Ca.g("TellMeDropdownMenuSection",Pb,rb,Ec.displayName);Rb.push(rb)}cb=Ca.h(Rb,"LookupDropdownMenu");return new wa(cb,rc,fb)}static get QMd(){return Ia.sUg||(Ia.sUg=new wa(Ca.h([],"LookupDropdownMenu"),0,[]))}}Ia.sUg=null;Object(D.a)(Ia,"TellMeXmlGenerator",null,[]);class Ya{}Ya.ogn=
"MRU";Ya.test="Test";Object(D.a)(Ya,"ActionType",null,[]);var eb=c(1572),sb;(function(rb){rb[rb.Service=0]="Service";rb[rb.Local=1]="Local";rb[rb.MRU=2]="MRU";rb[rb.TestResult=3]="TestResult";rb[rb.Unknown=4]="Unknown"})(sb||(sb={}));Object(D.b)("SubResultType",sb);var lc=c(85);class vb{constructor(rb,cb,rc,Rb,fb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=rb;this.IsEnabled=cb;this.ResultType=M.a[rc];this.SubResultType=sb[Rb];
this.OptionalData=fb?lc.a.toJSON(fb):null}}Object(D.a)(vb,"ResultInfo",null,[]);var Eb=c(114),Ua=c(190),Ta=c(294);class Nb{constructor(rb,cb=null){this.Kod="TellMeWAC.";this.ofk=rb;this.Mnk=cb}QIa(rb,cb,rc){cb=Eb.a.RH(cb);rb=Eb.a.Icf(rb,this.ofk,this.Mnk,rc,cb);Ua.a.QIa(rb,this.Kod)}PIa(rb,cb,rc=0){cb=Eb.a.RH(cb);Ua.a.PIa(Object.assign(new Ta.a,{name:rb,dataFields:cb,durationMs:rc}),this.Kod)}}Object(D.a)(Nb,"TellMeOtelLogger",null,[1330]);var Wa=c(139);class Bb{constructor(rb,cb,rc,Rb,fb,Pb,Ec){this.A7=
this.kba=this.TPg=null;this.Yea=rb;this.yab=cb;this.nNa=rc;this.hcb=Rb;this.eYa=fb;this.e$j=Pb;this.A7=Ec?Ec:new Nb(this.hcb?n.CuiHelper.wig:n.CuiHelper.Wle)}get Gr(){return this.hcb}get Zqa(){return this.nNa}Ohe(rb){this.TPg=rb;switch(rb){case ka.a.contextMenu:this.kba=ka.a.contextMenu;break;default:this.kba=ka.a.tellMe}}DKk(rb,cb){this.nNa.tpa||(this.nNa.tpa=Wa.a.create().toString(),this.CKi(rb,!0,cb))}gXh(rb,cb=!0){this.nNa.tpa&&this.A5m(rb,cb);this.hcb&&appChrome.api.updateTellMeCorrelationId("");
this.nNa.tpa=null}CKi(rb,cb,rc){const {TellMeActor:Rb}=c(1522),fb=this.z8(I.a.g4a);fb[eb.a.culture]=this.yab;fb[eb.a.appName]=this.Yea;fb[eb.a.context]=rb;fb[eb.a.Z0d]=this.eYa;fb[eb.a.OWm]=this.e$j;fb[eb.a.yVm]=rc;fb[eb.a.DPm]=cb;fb[eb.a.contentType]=Rb.instance.sKd;this.A7.QIa(I.a.g4a,fb,this.TPg);this.hcb&&appChrome.api.updateTellMeCorrelationId(this.nNa.tpa)}A5m(rb,cb){const rc=this.z8(I.a.WIb);rc[eb.a.Utl]=rb;rc[eb.a.CPm]=cb;this.A7.PIa(I.a.WIb,rc)}P7m(rb,cb,rc){let Rb=0;!rc&&0<rb.length&&(Rb=
rb.trim().split(" ").length);const fb=this.z8(I.a.query);fb[eb.a.query]="!";fb[eb.a.rOb]=cb;fb[eb.a.t6i]=rb.length;fb[eb.a.pFi]=rc;fb[eb.a.V8o]=Rb;this.A7.QIa(I.a.query,fb,this.kba)}Q6m(rb,cb,rc,Rb,fb,Pb,Ec,uc=null){const ya=this.z8(I.a.latency);ya[eb.a.culture]=this.yab;ya[eb.a.t6i]=rb;ya[eb.a.cEj]=cb;ya[eb.a.statusCode]=rc;ya[eb.a.service]=fb;ya[eb.a.isSuccess]=Pb;ya[eb.a.X_m]=Ec;uc&&(ya[eb.a.wMo]=uc);this.A7.PIa(I.a.latency,ya,Rb)}RNf(rb,cb,rc,Rb){const fb=this.z8(I.a.performance);fb[eb.a.culture]=
this.yab;fb[eb.a.HKk]=sa[rb];fb[eb.a.pwl]=sa[cb];fb[eb.a.mDn]=Fa[rc];this.A7.PIa(I.a.performance,fb,Rb)}X7m(rb,cb){var {TellMeActor:rc}=c(1522);const {CommandResultsUtility:Rb}=c(1562);if(rb.results.length){var fb=this.z8(I.a.fdj);fb[eb.a.i9]=cb.toString();fb[eb.a.groupType]=O.a[rb.groupType];16===rb.groupType&&(fb[eb.a.XUm]=rc.instance.wed);cb=[];rc=[];var Pb=[];for(const Ec of rb.results)fb[eb.a.resultType]||(fb[eb.a.resultType]=M.a[Ec.type]),rb={},27===Ec.type&&(rb.AssetId=Ec.dJ),rc.push(Rb.oWc(Ec.value)),
cb.push(Ec.value),Pb.push(new vb(Ec.value,Rb.oWc(Ec.value),Ec.type,Ec.mxj,rb));0<cb.length&&(fb[eb.a.R8n]="{"+cb.join(", ")+"}",fb[eb.a.Pvl]="{"+rc.join(", ")+"}",fb[eb.a.N8n]=za.c(Pb));this.A7.QIa(I.a.fdj,fb,this.kba)}}MMl(rb,cb){if(4===rb)return Ya.ogn;switch(cb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return M.a[cb]}c5m(rb,cb,rc,Rb,fb){const Pb=this.z8(I.a.click);Pb[eb.a.cEj]=rb;Pb[eb.a.kBn]=cb;Pb[eb.a.commandId]=
rc;Pb[eb.a.g4]=Rb;Pb[eb.a.actionType]=this.MMl(fb.groupType,fb.resultType);Pb[eb.a.resultType]=M.a[fb.resultType];Pb[eb.a.nkg]=sb[fb.nkg];Pb[eb.a.groupType]=O.a[fb.groupType];Pb[eb.a.i9]=fb.i9.toString();Pb[eb.a.xgf]=fb.xgf.toString();Pb[eb.a.resultIndex]=fb.resultIndex.toString();this.A7.QIa(I.a.click,Pb,this.kba)}i5m(rb,cb){this.nNa.tpa||(this.nNa.tpa=Wa.a.create().toString(),this.CKi("",!1,cb));cb=this.z8(I.a.TJh);cb[eb.a.rOb]=rb;this.A7.PIa(I.a.TJh,cb)}SKi(rb,cb,rc){if(rb){if(rc)for(let Rb in rc)rb[Rb]=
rc[Rb];this.A7.PIa(I.a.events,rb,cb)}}XG(rb,cb,rc=null){const Rb=this.z8(I.a.events);Rb[eb.a.event]=rb;this.SKi(Rb,Math.round(cb),rc)}gqa(rb,cb,rc=null){const Rb=this.z8(I.a.events);Rb[eb.a.event]=I.a.error;Rb[eb.a.module]=rb;Rb[eb.a.errorMessage]=cb;Rb[eb.a.message]=cb;this.SKi(Rb,Math.round(window.performance.now()),rc)}a5m(rb){const cb=this.z8(I.a.PGh);cb[eb.a.value]=rb;cb[eb.a.dde]=this.hcb;this.A7.QIa(I.a.PGh,cb,this.kba)}u4m(rb){const cb=this.z8(I.a.Knh);cb[eb.a.value]=rb;cb[eb.a.dde]=this.hcb;
this.A7.QIa(I.a.Knh,cb,this.kba)}V5m(rb){const cb=this.z8(I.a.a0h);cb[eb.a.value]=rb;cb[eb.a.dde]=this.hcb;this.A7.QIa(I.a.a0h,cb,this.kba)}N7m(rb){const cb=this.z8(I.a.M5i);cb[eb.a.value]=rb;cb[eb.a.dde]=this.hcb;this.A7.QIa(I.a.M5i,cb,this.kba)}I4m(rb){const cb=this.z8(I.a.ukj);cb[eb.a.value]=rb;this.A7.QIa(I.a.ukj,cb,this.kba)}R7m(rb,cb){const rc=this.z8(I.a.o6i);rc[eb.a.Vic]=rb;cb&&(rc[eb.a.tpa]=cb);this.A7.PIa(I.a.o6i,rc)}z8(rb){return{["SessionID"]:this.nNa.sessionId,["CorrelationID"]:this.nNa.tpa,
["Time"]:(new Date).getTime(),["Event"]:rb,["Scenario"]:this.kba}}}Object(D.a)(Bb,"UsageLogger",null,[1308]);var Ob=c(67),hc=c(1702),Gc=c(1227),bc=c(1559),Dc=c(93),Ub=c(30),Fc=c(1226),Sa=c(635),wb=c(20),Tb=c(760),Hb=c(70),$a=c(12);c.d(J,"TellMeActor",function(){return ab});class ab{constructor(){this.TYa=this.s3=this.Vb=this.Ca=this.kQ=this.dv=this.Ib=this.ga=this.Pe=this.LK=this.XKe=this.Zmh=this.tma=this.fc=null;this.NYb=!1;this.Lwe=[];this.PPg=[];this.Flh=[];this.i8g=[];this.j8g=[];this.d3g=!1;
this.FVb=this.lga=null;this.Pxc=this.eYa=!1;this.csd=!0;this.w_=this.Owc=this.fYg=this.mLe=this.V7g=null;this.CZ=[];this.Aab=this.iWb=this.lBa=this.avd=this.mhh=null;this.cYb=!1;this.fLe=0;this.eVb=null;this.Vta=-1;this.w7g=0;this.Xxc=!1;this.dbb=null;this.Alh=!1;this.gVb=this.Mo=null}get sKd(){return this.kQ?this.kQ.contentType:ab.unknown}get actions(){return this.CZ}set actions(rb){this.CZ=rb}fVd(){return this.Pe?this.Pe.Zqa.tpa:null}aP(){return this.fc}get Zen(){return this.csd}get L4o(){return this.V7g}performance(){return this.LK}get mig(){return this.mhh}set mig(rb){this.mhh=
rb}get wed(){return this.Alh}set wed(rb){this.Alh=rb}lH(rb){const cb=window.performance.now();this.lga&&!Y.c(rb)&&(this.lga(rb),this.Pe.QA(I.a.lH,window.performance.now()-cb))}initialize(rb,cb=null,rc=null,Rb=null,fb=null,Pb=null,Ec=null,uc=null,ya=null,db=null,tb=null){const {InteractionLogger:Xb}=c(1996),{GroupsPlacementInfo:$b}=c(1992),{AggregatorResultsProvider:Ab}=c(1786);this.fc=rb;this.eYa=!!L.AFrameworkApplication.ta&&L.AFrameworkApplication.ta.Kb.$dc;this.Pe=Rb;if(!Rb){Rb=new v;Rb.sessionId=
L.AFrameworkApplication.userSessionId;const vc=Tb.a.ug(L.AFrameworkApplication.lcid)||Tb.a.QVc;this.Pe=new Xb(new Bb(this.fc.application,vc.name,Rb,this.fc.Gr,this.eYa,rb.tVa,null),this.fc.j7k,this.fc)}this.TYa=new N(this.fc.parameterData);this.Zmh=rc||new Ia(this.fc,this.TYa);this.lga=Ec;this.XKe=this.XKe||new ua(this.fc,this.fc.parameterData,Ec);this.Vb=Ob.FocusManager.instance();this.s3=Q.createInstance(this.fc);this.fYg=new $b(rb);this.ga=fb||L.AFrameworkApplication.va;this.Ib=Pb||L.AFrameworkApplication.lc;
this.dv=ya;this.tma=cb;this.Mo=tb;this.LK=new Pa;this.gVb=new l.a(e.a.ih());this.avd=[];ya?ya.execute(vc=>{vc.isFeatureEnabled(ab.GJo,!0).then(Sc=>{const {AggregatorResultsProvider:ed}=c(1786);this.Xxc=Sc;this.tma=this.tma||ed.createInstance(this.s3,this.fc,this.TYa,this.Xxc);for(const pd of this.avd)this.tma.WE(pd.provider,pd.p9a);this.avd=[];return null})}):(this.Xxc=!0,this.tma=this.tma||Ab.createInstance(this.s3,this.fc,this.TYa,this.Xxc));this.Ca=uc;this.lBa=Ia.QMd;this.V7g=new Promise(vc=>{this.mLe=
vc});db&&db.execute(vc=>{this.kQ=vc})}Ub(){this.dwk()}kXn(rb){this.Owc=rb}dwk(){this.ga.fb($a.a.tellMe,Hb.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb($a.a.Xlg,Hb.a.frame,Object(a.a)(this,this.sAh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb($a.a.bmg,Hb.a.frame,Object(a.a)(this,this.iLi,"logItemExecuted"),96);this.ga.fb($a.a.emg,Hb.a.frame,Object(a.a)(this,this.LKi,"logControlDeactivation"),96);this.ga.fb($a.a.dmg,Hb.a.frame,Object(a.a)(this,this.eLi,"logInputFocus"),96);this.ga.fb($a.a.$lg,
Hb.a.frame,Object(a.a)(this,this.g4a,"interactionBegin"),96);this.ga.fb($a.a.gmg,Hb.a.frame,Object(a.a)(this,this.g4a,"interactionBegin"),96);this.ga.fb($a.a.cmg,Hb.a.frame,Object(a.a)(this,this.dLi,"logInputBlur"),96);this.ga.fb($a.a.fmg,Hb.a.frame,Object(a.a)(this,this.KKi,"logControlActivated"),96);this.ga.fb($a.a.Ubd,Hb.a.frame,Object(a.a)(this,this.g2h,"focusSearchBox"),96);this.ga.fb($a.a.Wlg,Hb.a.frame,Object(a.a)(this,this.NIh,"constructLiveNotificationForMenu"),96);this.ga.fb($a.a.hmg,Hb.a.frame,
Object(a.a)(this,this.XCf,"insertTryQuery"),96);this.ga.fb($a.a.mLf,Hb.a.frame,Object(a.a)(this,this.XCf,"insertTryQuery"),96);this.ga.fb($a.a.Ykf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.Zkf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.$kf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.alf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.blf,Hb.a.frame,Object(a.a)(this,this.hTa,
"openOrInsertUrl"),96);this.ga.fb($a.a.KZf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.LZf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.MZf,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.Q0f,Hb.a.frame,Object(a.a)(this,this.b4a,"insertMention"),96);this.ga.fb($a.a.R0f,Hb.a.frame,Object(a.a)(this,this.b4a,"insertMention"),96);this.ga.fb($a.a.S0f,Hb.a.frame,Object(a.a)(this,this.b4a,"insertMention"),96);this.ga.fb($a.a.Zlg,
Hb.a.frame,Object(a.a)(this,this.e_i,"openFeedback"),96);this.ga.fb($a.a.jmg,Hb.a.frame,Object(a.a)(this,this.hTa,"openOrInsertUrl"),96);this.ga.fb($a.a.b1e,Hb.a.frame,Object(a.a)(this,this.A2d,"launchAddin"),96);this.ga.fb($a.a.c1e,Hb.a.frame,Object(a.a)(this,this.A2d,"launchAddin"),96);this.ga.fb($a.a.d1e,Hb.a.frame,Object(a.a)(this,this.A2d,"launchAddin"),96);this.ga.fb($a.a.qRb,Hb.a.frame,Object(a.a)(this,this.qRb,"showTellMeCoachmark"),96);this.ga.fb($a.a.HKf,Hb.a.frame,Object(a.a)(this,this.GGi,
"launchAddinStore"),96);this.ga.fb($a.a.D5f,Hb.a.frame,Object(a.a)(this,this.O6i,"quickActionOnFileHandler"),96);this.ga.fb($a.a.Snf,Hb.a.frame,Object(a.a)(this,this.C4h,"generateSlidesFromFiles"),96)}iVn(rb){this.csd=!1;const cb=window.performance.now();rb.A5a.isCompleted?(this.csd=!0,this.mLe(!0)):rb.F_(()=>{this.csd=!0;this.mLe(!0);this.Pe.QA(I.a.fml,window.performance.now()-cb)});this.VVn(rb)}VVn(rb){Sa.a.tde(Object(a.a)(this,this.NLd,"dispatcher"));Sa.a.xNc([new Fc.a($a.a.tellMe,Hb.a.frame,96),
new Fc.a($a.a.Xlg,Hb.a.frame,96),new Fc.a($a.a.bmg,Hb.a.frame,96),new Fc.a($a.a.emg,Hb.a.frame,96),new Fc.a($a.a.dmg,Hb.a.frame,96),new Fc.a($a.a.$lg,Hb.a.frame,96),new Fc.a($a.a.gmg,Hb.a.frame,96),new Fc.a($a.a.cmg,Hb.a.frame,96),new Fc.a($a.a.fmg,Hb.a.frame,96),new Fc.a($a.a.Ubd,Hb.a.frame,96),new Fc.a($a.a.Wlg,Hb.a.frame,96),new Fc.a($a.a.hmg,Hb.a.frame,96),new Fc.a($a.a.mLf,Hb.a.frame,96),new Fc.a($a.a.Ykf,Hb.a.frame,96),new Fc.a($a.a.Zkf,Hb.a.frame,96),new Fc.a($a.a.$kf,Hb.a.frame,96),new Fc.a($a.a.alf,
Hb.a.frame,96),new Fc.a($a.a.blf,Hb.a.frame,96),new Fc.a($a.a.KZf,Hb.a.frame,96),new Fc.a($a.a.LZf,Hb.a.frame,96),new Fc.a($a.a.MZf,Hb.a.frame,96),new Fc.a($a.a.Q0f,Hb.a.frame,96),new Fc.a($a.a.R0f,Hb.a.frame,96),new Fc.a($a.a.S0f,Hb.a.frame,96),new Fc.a($a.a.Zlg,Hb.a.frame,96),new Fc.a($a.a.jmg,Hb.a.frame,96),new Fc.a($a.a.b1e,Hb.a.frame,96),new Fc.a($a.a.c1e,Hb.a.frame,96),new Fc.a($a.a.d1e,Hb.a.frame,96),new Fc.a($a.a.qRb,Hb.a.frame,96),new Fc.a($a.a.HKf,Hb.a.frame,96),new Fc.a($a.a.D5f,Hb.a.frame,
96),new Fc.a($a.a.Snf,Hb.a.frame,96)],rb)}NLd(rb,cb,rc,Rb,fb){if(cb.contextId===Hb.a.frame)switch(rb){case $a.a.tellMe:return this.tellMe(rb,cb,rc,Rb,fb);case $a.a.Xlg:return this.sAh(rb,cb,rc,Rb,fb);case $a.a.bmg:return this.iLi(rb,cb,rc,Rb,fb);case $a.a.emg:return this.LKi(rb,cb,rc,Rb,fb);case $a.a.dmg:return this.eLi(rb,cb,rc,Rb,fb);case $a.a.$lg:return this.g4a(rb,cb,rc,Rb,fb);case $a.a.gmg:return this.z8n(rc);case $a.a.cmg:return this.dLi(rb,cb,rc,Rb,fb);case $a.a.fmg:return this.KKi(rb,cb,rc,
Rb,fb);case $a.a.Ubd:return this.g2h(rb,cb,rc,Rb,fb);case $a.a.Wlg:return this.NIh(rb,cb,rc,Rb,fb);case $a.a.hmg:case $a.a.mLf:return this.XCf(rb,cb,rc,Rb,fb);case $a.a.Ykf:case $a.a.Zkf:case $a.a.$kf:case $a.a.alf:case $a.a.blf:case $a.a.KZf:case $a.a.LZf:case $a.a.MZf:case $a.a.jmg:return this.hTa(rb,cb,rc,Rb,fb);case $a.a.Q0f:case $a.a.R0f:case $a.a.S0f:return this.b4a(rb,cb,rc,Rb,fb);case $a.a.Zlg:return this.e_i(rb,cb,rc,Rb,fb);case $a.a.b1e:case $a.a.c1e:case $a.a.d1e:return this.A2d(rb,cb,
rc,Rb,fb);case $a.a.qRb:return this.qRb(rb,cb,rc,Rb,fb);case $a.a.HKf:return this.GGi(rb,cb,rc,Rb,fb);case $a.a.D5f:return this.O6i(rb,cb,rc,Rb,fb);case $a.a.Snf:return this.C4h(rb,cb,rc,Rb,fb)}return 2}g2h(rb,cb,rc){if(1===rc)return 32;this.hoj();rb=!1;(this.fc.tVa||this.eYa)&&(cb=document.getElementById("SearchButton"))&&cb.click();if(!this.fc.tVa&&this.eYa)for(cb=document.getElementsByClassName("ms-suiteux-search-box"),rc=0;rc<cb.length;rc++){const Rb=cb[rc].querySelector("input[type=search]");
Rb&&(rb=Ob.FocusManager.kK(Rb))}else rb=Ob.FocusManager.kK($get(this.fc.Gr?n.CuiHelper.wig:n.CuiHelper.Wle));this.Pxc=!0;return rb?32:8}XCf(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.hoj();rb=fb.CommandValueId;cb=this.fc.Gr?n.CuiHelper.wig:n.CuiHelper.Wle;this.fc.Gr&&!Y.c(fb[Gc.a.OUa])&&(fb[Gc.a.OUa]=!1);if(rb){if(this.fc.Gr)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(rb)),this.dbb=
[19],32;if(fb=$get(cb))fb.value=rb}return Ob.FocusManager.kK($get(cb))?32:8}hoj(){this.Vb.FL(this.fc.tVa||this.eYa?this.fc.YHb:this.fc.G7a,!1)}DMl(rb,cb){switch(rb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,cb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,cb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,cb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
cb)}return cb}NIh(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;rb=this.lBa?this.lBa.qfj:0;fb.Value=1!==rb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,rb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.lBa)for(const Pb of this.lBa.Fql)fb=Object(k.a)(U.a,Pb)?Pb.id:va.a.replaceAll(Pb.value,'"',""),(fb=$get(fb+"-"+K.a.Ylg))&&Ub.a.kr(fb,Ub.a.Aga,va.a.zf(this.DMl(Pb.groupType,
fb.innerText)));return 32}sAh(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.eVb=new Dc.a(2,1,0,()=>{fb[hc.a.Callback]()},97);this.lBa&&this.Ib.Wb(this.eVb);return 32}iLi(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;fb.CloseAllMenus&&(rb=void 0===fb.ParentControlId||null===fb.ParentControlId?"<NA>":fb.ParentControlId,
cb=this.FVb?this.FVb[fb.ControlId]:null,!cb&&this.FVb&&"<NA>"!==rb&&(cb=this.FVb[rb]),cb||(cb=this.NYb&&this.s3.VKm(fb),cb=this.Bnl(cb,fb.ControlId),cb=new t(cb,32,4,-1,-1,-1),this.Pe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+fb.ControlId+" determined group:"+O.a[cb.groupType])),this.Pe.fnn(fb.ControlId,rb,fb.CommandId,fb.CloseAllMenus,cb),this.TYa.ljn(fb.ControlId),fb.Location!==ka.a.contextMenu&&(this.s3.C_a(fb),this.s3.WE(cb.resultType),this.fc.Pie&&this.tma.Ttk(fb.CommandId)));
return 32}LKi(rb,cb,rc,Rb,fb){if(1===rc)return 32;(new xa(this.fVd())).sbm(this.iWb);rb=this.iWb;cb=this.Vta;rc=this.Pe.Ojd;if(Y.c(fb))return this.Pe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;fb=fb.UILocation;rb&&0<rb.length&&this.Xxc&&K.a.qgg(this.fc)&&this.fc.x1d&&19!==fb&&cb>rc&&!this.fc.XP&&(this.Pe.TNf(rb),this.Pe.Bdg(cb));this.Pe.l7n();this.fc.ipe&&19!==fb&&(this.LK.mark(3),this.LK.measure(1,0,3),this.LK.measure(2,2,3),this.LK.INf(0,1,2),this.LK.INf(2,2,3),this.LK.INf(1,
0,3),this.LK.jZk(),this.LK.clearMeasures([0,2,1]));this.Pe.Mnn(window.performance.now()-this.fLe);this.fc.Gr&&(this.Aab=null,this.Pe.Aya());this.Pxc=this.cYb=!1;this.iWb="";return 32}eLi(rb,cb,rc){if(1===rc)return 32;this.Pe.Unb(z(cb),this.Pxc);return 32}dLi(rb,cb,rc){if(1===rc)return 32;this.Pe.Aya();this.cYb=!1;return 32}KKi(rb,cb,rc,Rb,fb){if(1===rc)return 32;this.w_=null;fb&&(this.w_=fb);this.fc.ipe&&(Y.c(this.w_)||this.w_.Location!==ka.a.contextMenu)&&this.LK.mark(0);this.Pe.Ohe(Y.c(this.w_)||
Y.c(this.w_.Location)?ka.a.unknown:this.w_.Location);this.Pe.Lnn(this.w7g,this.Pxc);this.cYb||this.p6a();return 32}rMh(rb,cb){const rc=[],Rb=Date.now();for(let fb of rb)rb=(Rb-fb.timeStamp)/1E3,rb=K.a.nne(rb),Array.add(rc,new T(cb?fb.commandId:fb.controlId,rb));return rc}Mgl(rb){const cb=[],rc=Date.now();for(let Rb of rb)if(Rb.controlId||"keyboardShortcut"===Rb.commandSurface)rb=(rc-Rb.timeStamp)/1E3,rb=K.a.nne(rb),Array.add(cb,new ba(Rb.controlId,Rb.commandId,rb,Rb.commandSurface,Rb.$le));return cb}bNh(rb=
!1){var cb=rb?this.s3.mbm():this.s3.nQc();rb=[];const rc=Date.now();for(const Rb of cb)cb=(rc-Rb.TimeStamp)/1E3,cb=K.a.nne(cb),Array.add(rb,new T(Rb.Id,cb));return rb}p6a(){if(!this.cYb){this.NYb=this.cYb=!0;""!==this.fc.Sbg&&L.AFrameworkApplication.eo(this.fc.Sbg);if(!this.d3g){this.d3g=!0;const rb={};rb.IsMLREnabled=this.fc.hRm;rb.IsReactRibbonEnabled=this.fc.Gr;rb.IsSharedHeaderEnabled=!!L.AFrameworkApplication.ta&&L.AFrameworkApplication.ta.Kb.NJ;rb.IsSearchUxEnabled=this.eYa;rb.IsTellMeInHeaderEnabled=
this.fc.tVa;rb.IsGoLocalEnv=K.a.rOm();rb.IsSovereignEnvironment=K.a.eec();rb.IsTellMeServiceResultsEnabled=K.a.qgg(this.fc);rb.IsSubstrateProviderEnabled=K.a.pgg(this.fc);rb.ShouldFetchTokens=!!L.AFrameworkApplication.ta&&L.AFrameworkApplication.ta.Kb.$Qb;rb.IsSerpletEnabled=K.a.Npa();rb.FirstOnClickTimeInMS=Math.round(window.performance.now());rb.IsHeaderHidden=L.AFrameworkApplication.hideHeader||L.AFrameworkApplication.qY;rb.IsSearchInHeaderHidden=L.AFrameworkApplication.LTc;void 0!==window.performance.timing&&
null!==window.performance.timing&&(rb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));rb.IsFindWithMatchesEnabled=this.fc.POd;rb.HelpShowsTopSearchResult=this.fc.M$c;rb.HelpShowsNumberOfMatches=this.fc.L$c;L.AFrameworkApplication.K&&(rb.UiHost=L.AFrameworkApplication.K.kb("UiHostIntegrationType"));this.Pe.i8m(JSON.stringify(rb))}this.Lwe=this.rMh(y.a.instance.eQc(),!1);this.PPg=this.rMh(y.a.instance.Nib(),!0);this.Flh=this.Mgl(y.a.instance.Nib());this.i8g=this.bNh();
this.j8g=this.bNh(!0);this.Pe.p6a()}}g4a(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(wb.a.iXc)return 32;this.fLe=window.performance.now();this.p6a();rb=new aa(Object(a.a)(this,this.Gya,"onRequestCompleted"),0);this.Vta++;this.Pe.beginQuery("",this.Vta,this.NYb);this.Opg(!0,null);this.lBa=Ia.QMd;this.Aab=ua.sif;if(this.tma)ab.instance.actions=[],this.tma.eI(new X("",this.Vta),rb,this.fc.Gr);else this.Pe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.eVb&&this.Ib.Wb(this.eVb);return 32}z8n(rb){if(1===rb)return 32;this.Vb.hS(this.fc.tVa||this.eYa?this.fc.YHb:this.fc.G7a,!1);return 32}tellMe(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.w_=fb;this.Pe.Ohe(Y.c(this.w_.Location)?ka.a.unknown:this.w_.Location);rb=this.w_.Value;this.fc.Gr||rb&&""!==rb.trim()?(!this.Aab&&this.fc.Gr&&(this.Pe.Unb(z(cb),this.Pxc),this.p6a()),this.Szl(rb,
this.w_.Location),this.w_.PopulationXML=this.lBa.xml):this.NYb?this.w_.PopulationXML=this.lBa.xml:(this.w_.PopulationXML=Ia.QMd.xml,this.Aab=ua.sif,this.iWb="");return 32}Szl(rb,cb){this.fLe=window.performance.now();this.fc.ipe&&cb!==ka.a.contextMenu&&this.LK.mark(1);this.fc.Gr&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(rb));rb&&0<rb.trim().length&&(this.NYb=!1);this.fc.qyl();cb=Y.c(cb)?ka.a.tellMe:cb;if(rb!==this.iWb||this.fc.Gr){this.Vta++;this.Pe.beginQuery(rb,this.Vta,this.NYb);
this.Opg(!0,null);const rc=new X(rb,this.Vta),Rb=new aa(Object(a.a)(this,this.Gya,"onRequestCompleted"),this.Vta);this.lBa=Ia.QMd;this.Aab=ua.sif;if(this.tma)ab.instance.actions=[],this.tma.eI(rc,Rb,this.fc.Gr,cb,this.dbb),this.dbb=null;else this.Pe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.w7g=this.Vta;this.iWb=rb}}bYo(rb){if(this.fc.Gr){var cb=appChrome.selectors.getActiveControlStates();if(cb=Object(x.a)(Object,cb[rb.value])){rb.label=cb.label;let rc=
null;"description"in cb&&(rc=cb.description);rc&&Object.getType(rc)===String?rb.description=rc:"secondaryText"in cb?rb.description=cb.secondaryText:"fullDescriptionLabel"in cb&&(rb.description=cb.fullDescriptionLabel)}}}ZEn(rb){this.FVb={};let cb=0,rc=0;for(const Rb of rb){rb=0;for(const fb of Rb.results)this.FVb[fb.value]=new t(fb.groupType,fb.type,fb.mxj,cb,rb,rc),rb++,rc++,fb.label||5!==fb.type||this.bYo(fb);0<rb&&cb++}}Chc(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(rb=fb.CommandValueId)&&window.open(rb,"_blank");return 32}UGi(rb){const cb={};cb.token=this.mig;cb.files=za.c(rb);cb.type="MultiFilesDeckGeneration";if(L.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb($a.a.q0m,2,cb),!0;rb=K.a.Mhi("",K.a.sfj("GenerateDeckFromFile"),Object.assign(new bc.a,{landingTab:"All",data:cb}));rb=this.ga.Qb($a.a.q9,2,rb);return 32!==rb?(this.Pe.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+rb+"."),!1):!0}O6i(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Vb.smf();if(rb=fb.TerminalParentControlId){rb=this.gVb.J(rb);if(!rb)return 16;cb=[];Array.add(cb,rb);if(!this.UGi(cb))return 8}return 32}C4h(){if(!this.gVb.count)return 16;const rb=[];for(let cb of this.gVb.values)Array.add(rb,cb);return this.UGi(rb)?32:8}b4a(rb,cb,rc,Rb,fb){if(1===rc)return 32;
if(Y.c(fb))return this.Pe.onError("TellMeActor:InsertMention","actiondata comes null"),16;rb=fb.UILocation;let Pb;fb=fb.CommandValueId;try{Pb=za.a(fb)}catch(Ec){return this.Pe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.c(Pb)?(this.Pe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.c(this.Owc)?(this.Pe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==rb?(this.Pe.onError("TellMeActor:InsertMention",
"location "+rb+" is unexpected"),16):this.Owc.b4a(Pb.displayName,Pb.email,Pb.userId)?32:(this.Pe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}hTa(rb,cb,rc,Rb,fb){return 1===rc?32:Y.c(fb)?(this.Pe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===fb.UILocation?this.KFm(rc,fb):this.Chc(rb,cb,rc,Rb,fb)}e_i(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Mo&&window.setTimeout(()=>
{this.Mo.execute(Pb=>{Pb.iJa("TellMeSurvey",null)})},ab.bCl);return 32}KFm(rb,cb){if(1===rb)return 32;if(Y.c(cb))return this.Pe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.c(this.Owc))return this.Pe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;rb=cb.CommandValueId;return Y.c(rb)?(this.Pe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Owc.insertHtmlText(rb)?32:(this.Pe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Gya(rb,
cb,rc,Rb,fb){rc=window.performance.now();this.ZEn(cb);this.Pe.alo(cb);this.fc.Gr?(this.Aab=this.XKe.XLl(cb,rb,fb),this.fc.exa?(this.CZ.push(appChrome.actions.updateTellMeSearchResults(this.Aab.menuModel,rb,fb)),appChrome.api.dispatch(this.CZ)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Aab.menuModel,rb,fb)),this.fc.ipe&&this.cYb&&(Y.c(this.w_)||this.w_.Location!==ka.a.contextMenu)&&(this.LK.mark(2),this.LK.measure(0,1,2))):this.lBa=this.Zmh.YLl(cb,this.Pe.Zqa);this.eVb&&
this.Ib.Wb(this.eVb);fb={};fb.GroupsCount=cb.length;fb.QueryID=Rb;fb.QueryLength=rb.length;this.Pe.QA(I.a.Gel,window.performance.now()-rc,fb)}Bnl(rb,cb){return cb.startsWith(this.fc.Gr?K.a.Dog:K.a.Dne)?5:rb?4:"bSearchHelp"===cb||cb.startsWith("GetHelpFromTellMe")?8:"bInsights"===cb||cb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===cb?24:cb===this.fc.olf?2:0}WE(rb,cb){this.tma?this.tma.WE(rb,cb):Array.add(this.avd,new E(rb,cb))}GGi(rb,cb,rc,Rb,fb){if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){rb={};rb.SourceControlId=fb.SourceControlId;rb.Query=fb.CommandValueId;fb=this.ga.Qb($a.a.LZc,2,rb);if(32!==fb)this.Pe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+fb+".");return fb}return this.ga.Qb($a.a.LZc,2,fb)}A2d(rb,cb,rc,Rb,fb){({AddinResultsProvider:rb}=c(1674));if(1===rc)return 32;if(Y.c(fb))return this.Pe.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;rc=fb.CommandValueId;if(Y.b(rc))return this.Pe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!rb.jBb[rc])return this.Pe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+rc+" doesn't not exist in entitlements"),16;fb=c(1674).AddinResultsProvider.jBb[rc];rb={};rb.solutionId=fb.id;rb.version=fb.appVersion;rb.storeType=fb.storeType;rb.storeId=fb.storeId;rb.assetId=fb.assetId;rb.assetStoreId=fb.assetStoreId;rb.displayName=fb.displayName;rb.targetType=
fb.targetType;rb.height=fb.height;rb.width=fb.width;fb=this.ga.Qb($a.a.JCf,2,rb);if(32!==fb)this.Pe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+fb+". AssetId: "+rc);return fb}qRb(){if(!Y.c(this.Mo))for(let rb of y.a.instance.Nib()){if("ShowContextMenuWithFloatie"===rb.commandId)return this.Mo.execute(cb=>{cb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(rb.commandId&&-1===rb.commandId.indexOf("Tab"))break}return 8}Opg(rb,cb="",rc=null){rb?
this.gVb=new l.a(e.a.ih()):cb&&rc&&this.gVb.add(cb,rc)}static get instance(){return ab._instance||(ab._instance=new ab)}}ab._instance=null;ab.GJo="mso_tellMeService";ab.unknown="Unknown";ab.bCl=500;Object(D.a)(ab,"TellMeActor",null,[])},1523:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(1536);class e{constructor(a,k){this.icb=!1;const {Annotations:x}=c(1517);if(!a)throw Error.argumentNull("annotations");if(!a.rJf(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.uI(k))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Bw=a;this.Cbk=k;this.qp=[]}get i3b(){return this.Bw}get isReadOnly(){return this.icb}get i5(){return this.Cbk}get items(){return this.qp}Pea(){const {Annotations:a}=c(1517);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const n=this.Bw.Pea(this.i5,this.items[x]);this.i5===a.baa?(k+='"',k+=l.a.Ijf(n),k+='"'):k+=n}return k+"]"}isEqual(a){const {Annotations:k}=c(1517);if(this===a)return!0;if(!a||a.i3b!==this.Bw||a.i5!==this.i5||a.items.length!==
this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.nsb(this.i5,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new e(this.Bw,this.i5);Array.addRange(a.items,this.items);return a}$T(){return this.isReadOnly?this.clone():this}hNf(){const {Annotations:a}=c(1517);if(!this.isReadOnly){this.icb=!0;for(const k of this.items)a.kLb(k)}}toString(){return this.Pea()}}Object(D.a)(e,"ListValue",null,[1426,1425])},1524:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}
l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(D.a)(l,"TellMeScenario",null,[])},1526:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k=null,x=null,y=4,n=-99999,t=0){this.dJ="";this.YCd=-1;this.value=e;this.type=a;this.mxj=y;this.label=this.gD=k;this.groupType=30;this.description=x;this.score=n;this.count=t}}Object(D.a)(l,"ResultBinding",null,[])},1528:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.attributes=
null;this.query=e;this.vo=[]}gv(e){this.vo.push(e)}kbj(e){const a=[];for(const k of this.vo)k.groupType!==e&&a.push(k);this.vo.length!==a.length&&(this.vo=a)}get Kdc(){return!1}}Object(D.a)(l,"SimpleResultsUpdatedEventArgs",null,[1282])},1529:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e=30,a=""){this.mM=[];this.groupType=e;this.displayName=a}get results(){return this.mM}Ww(e){e.groupType=this.groupType;Array.add(this.results,e)}H8f(e=1){if(this.results.length>=e)for(let a=
0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(l,"SimpleResultGroup",null,[1283])},1536:function(D,J,c){D=c(0);class l{constructor(a,k){this.vfb=a;this.value=k}}Object(D.a)(l,"AttrValuePair",null,[]);c.d(J,"a",function(){return e});class e{constructor(a){this.icb=!1;if(!a)throw Error.argumentNull("annotations");this.Bw=a;this.PY=[]}get i3b(){return this.Bw}get isReadOnly(){return this.icb}get Zyf(){return 0<this.PY.length}Lq(a){if(!this.Bw.sec(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.PY)if(a===k.vfb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}ez(a,k){var {Annotations:x}=c(1517);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Bw.sec(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Bw.qdc(this.Bw.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.kLb(k);
for(x=0;x<this.PY.length;++x){const y=this.PY[x];if(a===y.vfb){y.value=k;return}}Array.add(this.PY,new l(a,k))}VTa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Bw.sec(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.PY.length;++k)if(a===this.PY[k].vfb){Array.removeAt(this.PY,k);break}}LPd(a){if(!a)throw Error.argumentNull("action");for(const k of this.PY)a(k.vfb,k.value)}clone(){const a=new e(this.Bw);
a.S0a(this);return a}S0a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.i3b!==this.Bw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.PY);a.LPd((k,x)=>{this.ez(k,x)})}Pea(){const {Annotations:a}=c(1517);let k="[",x=!0;for(const y of this.PY){x?x=!1:k+=", ";k+=this.Bw.L5h(y.vfb);k+="=";const n=this.Bw.getAttributeType(y.vfb),t=this.Bw.Pea(n,y.value);n===a.baa?(k+=
'"',k+=e.Ijf(t),k+='"'):k+=t}return k+"]"}isEqual(a){const {Annotations:k}=c(1517);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Bw!==a.i3b||this.Zyf!==a.Zyf)return!1;let x=0,y=null,n=!1;a.LPd((t,z)=>{++x;if(!n){var v=-1;for(let I=0,E=this.PY.length;I<E;++I)if(this.PY[I].vfb===t){v=I;break}0>v?n=!0:(y||(y=Array(this.PY.length)),y[v]=z)}});if(this.PY.length!==x||n)return!1;for(let t=0,z=this.PY.length;t<z;++t)if(!k.nsb(this.Bw.getAttributeType(this.PY[t].vfb),this.PY[t].value,
y[t]))return!1;return!0}$T(){return this.isReadOnly?this.clone():this}hNf(){const {Annotations:a}=c(1517);if(!this.isReadOnly){this.icb=!0;for(const k of this.PY)a.kLb(k.value)}}toString(){return this.Pea()}static Ijf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(e,"FeatureBundle",null,[1424,1425])},1542:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.click="Click";l.g4a="InteractionBegin";l.WIb="InteractionEnd";l.TJh="ControlActivated";
l.query="Query";l.o6i="QueryIndexRecorded";l.PGh="Clicks";l.Knh="ActionEvents";l.a0h="FilteredActionEvents";l.ukj="SessionContext";l.latency="Latency";l.performance="Performance";l.fdj="RenderedResults";l.events="Events";l.Gel="CreateResultsMenu";l.lH="UpdateRibbonControls";l.Q8n="ResultsAggregation";l.eI="IssueQuery";l.Q1k="CommandSuggestions";l.error="Error";l.SMf="LoadModelData";l.fml="DepsResolveTime";l.$en="ModelDataWaitTime";l.timedOut="TimedOut";l.uAk="AddinQueryCommandReady";l.gNl="GetAddinEntitlements";
l.M5i="ProviderMRUEvents";l.Gvl="EnableAddinSearchCommands";Object(D.a)(l,"EventNames",null,[])},1546:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.ROf=null;this.yda=this.TOf=0}onf(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.ROf=e;this.TOf=a;this.yda=k}Iib(e,
a,k){this.onf(e.ROf,e.TOf+a,k)}J(e){if(0>e||e>=this.yda)throw Error.argumentOutOfRange("index");return this.ROf[this.TOf+e]}get count(){return this.yda}static mcf(e){const a=new l;a.onf(e,0,e.length);return a}}Object(D.a)(l,"ReadOnlyList",null,[1447])},1553:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(D.b)("ResultGroupType",
l)},1560:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1612);class l extends c.a{constructor(){super();this.info=this.zj=this.eventId=null}get vha(){return"Misc"}lGb(){this.detail.Z("Type",this.vha);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.zj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(l,"BasicMergeFailureDetail",c.a,[])},1561:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(613),e=c(817),a=c(1577);class k{constructor(x,y=!0){this.Dm=
y&&x?x.ZK():x;this.u1b=new l.a}DC(x){this.u1b.add(e.a.Ab(x))}ypo(x){this.u1b=x}oPi(x){this.Dm&&(new a.a(this.Dm,x)).Vqa.forEach((y,n)=>{n.DY&&!this.u1b.contains(y)&&(this.u1b.add(y),n.isDeleted?(n=this.Dm,n.hasProperty(e.a.$X(y))&&n.removeProperty(e.a.$X(y))):this.Dm.DUa(e.a.$X(y),n.newValue));return!0})}}Object(D.a)(k,"PartialMergeResult",null,[])},1562:function(D,J,c){c.r(J);c.d(J,"CommandResultsUtility",function(){return z});D=c(0);var l=c(1572),e=c(1542),a=c(1573),k=c(1526),x=c(1529),y=c(1522),
n=c(1521),t=c(2);class z{static Gdd(v,I){if(I&&I.Gr){const E={};for(const H of v)I.P1d(H)&&(E[H]=appChrome.selectors.getModelType(H));y.TellMeActor.instance.lH(E)}}static RJo(v){return v.startsWith("btnTellMeOfficeAddIn")}static oWc(v){const I=y.TellMeActor.instance.aP();return!!I&&I.Gr&&!appChrome.selectors.isControlDisabled(v)}static w3d(v,I,E,H){if(y.TellMeActor.instance.Pe&&v){const M=[];for(const K of v)M.push(String.format('{{"Id":"{0}","Score":{1}}}',K.commandId,K.score));v={};v[l.a.suggestions]=
"[{"+M.join(",")+"}]";v[l.a.pFi]=I;v[l.a.groupType]=E;v[l.a.provider]=H;y.TellMeActor.instance.Pe.QA(e.a.Q1k,window.performance.now(),v)}}static kUl(v,I){const E=[],H=[];for(const M of I){I=M.commandId;let K=M;M.commandId in v&&(I=v[M.commandId],K=new a.a(I,M.score));Array.contains(H,I)||(E.push(K),H.push(I))}return E}static $Rc(v,I,E,H,M,K,L,S){E.Xpf&&(I=z.kUl(E.Xpf,I));var Q=n.a.ASl(I);z.Gdd(Q,E);var N=[],O=[];Q=[];const X=new x.a(L);L=16===L||18===L||7===L||4===L?t.AFrameworkApplication.K?t.AFrameworkApplication.K.nc("TellMeMaxRecommendedResultsToReturn",
3):3:0===L||17===L||25===L?5:0;for(const U of I)if(!z.TKm(U.commandId)){I=z.RJo(U.commandId);if(E.P1d(U.commandId)&&!I){if(n.a.ZDi(U.commandId))continue;I=null;M&&K&&(I=M.T9l(U.commandId,K));z.oWc(U.commandId)?Array.add(N,new k.a(U.commandId,5,I,null,S,U.score)):Array.add(O,new k.a(U.commandId,5,I,null,S,U.score))}else E.rBb&&I&&H&&Array.add(Q,U.commandId.substr(21));if(N.length+Q.length>=L)break}E=0;for(M=0;M<N.length&&E<L;M++,E++)X.Ww(N[M]);for(N=0;N<O.length&&E<L;N++,E++)X.Ww(O[N]);for(O=0;O<Q.length&&
E<L;O++,E++)H.svp(v,Q[O],X);return X}static TKm(v){z.Gxh||(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.rw("TellMeControlPredictionBlockList")&&t.AFrameworkApplication.K.EB("TellMeControlPredictionBlockList").forEach(I=>{Array.add(z.Fxh,I.toLowerCase())}),z.Gxh=!0);return Array.contains(z.Fxh,v.toLowerCase())}static jEf(v){return 2<v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static C7h(v){const I=new x.a(0);var E=v.split(";");v=y.TellMeActor.instance.aP();for(const H of E)if(0<H.length){E=H.split(":");const M=2===E.length?E[0]:H;if(!v.P1d(M))break;if(1===E.length)E=new k.a(M,5,null,null,1),I.Ww(E);else if(2===E.length)E=new k.a(M,5,E[1],null,1),I.Ww(E);else break}return I}static vtk(v,I,E){if(!(I&&I.results&&v&&v.results&&v.results.length))return{returnValue:!1,d_e:v,V_e:I};const H=[];for(var M of I.results)Array.add(H,M.value);M=0;const K=0<I.results.length?I.results[0].score:
0;for(const L of v.results)if(L.score>E&&!Array.contains(H,L.value)&&z.oWc(L.value)&&(0<K&&(L.score=K),Array.insert(I.results,M,L),M++),2===M)break;return 0<M?(E=I.results.length-5,0<E&&I.H8f(E),{returnValue:!0,d_e:v,V_e:I}):{returnValue:!1,d_e:v,V_e:I}}}z.Gxh=!1;z.Fxh=[];Object(D.a)(z,"CommandResultsUtility",null,[])},1571:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{static JLo(e){return e.toString().charCodeAt(0)}static oWm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static Kvh(e,
a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static Jvh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.pdj(e);a=l.pdj(a);return e===a}static pdj(e){return e.replace(l.r0c," ")}static $qb(e,a,k){return e.substring(a,a+k)}}l.r0c=RegExp("\u00a0","g");Object(D.a)(l,"CharUtils",null,[])},1572:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.appName="AppName";l.g4="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.tpa="CorrelationID";l.kBn="ParentUiElement";l.query="Input";l.rOb="QueryID";l.t6i="QueryLength";l.Vic="QueryIndex";l.R8n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.cEj="UiElement";l.dde="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.wMo="TokenAcquired";l.X_m="LatencyType";l.groupName="GroupName";
l.i9="GroupIndex";l.groupType="GroupType";l.N8n="ResultInfoList";l.resultType="ResultType";l.nkg="SubResultType";l.CPm="IsInputBlur";l.DPm="IsInputFocus";l.yVm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.Utl="DwellTime";l.pFi="IsZeroTerm";l.V8o="WordsCount";l.Z0d="IsSearchUxEnabled";l.OWm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.xgf="DisplayIndex";l.Pvl="EnableList";l.provider="Provider";l.contentType="ContentType";l.XUm="IsSelectionBased";l.HKk="BeginPerformanceMarker";
l.pwl="EndPerformanceMarker";l.mDn="PerformanceMeasure";Object(D.a)(l,"Columns",null,[])},1573:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(D.a)(l,"CommandSuggestion",null,[])},1577:function(D,J,c){D=c(0);var l=c(368),e=c(817),a=c(250),k=c(55);class x{constructor(n,t,z){this.Bgk=n;this.Vck=t;this.nck=z;this.aGe=new a.a(Object(k.a)(this,this.DWk,"checkIfDifferent"))}get Vob(){return this.Bgk}get oldValue(){return this.Vck}get newValue(){return this.nck}get blb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get DY(){return this.blb||this.isDeleted||this.aGe.value}DWk(){return this.blb||this.isDeleted?!0:!e.a.Qvh(this.Vob,this.oldValue,this.newValue)}}Object(D.a)(x,"PropertyDiff",null,[]);c.d(J,"a",function(){return y});class y{constructor(n,t){this.Sck=n;this.kck=t;this.aGe=new a.a(()=>this.zWc());this.Dgk=
new a.a(Object(k.a)(this,this.bzl,"evaluatePropertyDiffs"))}get vu(){return this.Sck}get xf(){return this.kck}get blb(){return!!this.xf&&!this.vu}get isDeleted(){return!this.xf&&!!this.vu}get DY(){return this.blb||this.isDeleted||this.aGe.value}get Vqa(){return this.Dgk.value}zWc(n=null){let t=!1;this.Vqa.forEach((z,v)=>{t=v.DY&&(!n||7!==n.J(z));return!t});return t}bzl(){const n=new l.a;var t=this.xf,z=this.vu;if(this.blb){z=t.xl();for(var v=0;v<z.length;v++){var I=z[v];n.Z(e.a.Ab(I),new x(I,null,
t.AU(I)))}}else if(this.isDeleted)for(t=z.xl(),v=0;v<t.length;v++)I=t[v],n.Z(e.a.Ab(I),new x(I,z.AU(I),null));else{v=z.xl();for(I=0;I<v.length;I++){var E=v[I],H=e.a.Ab(E),M=z.AU(E);const K=t.hasProperty(E)?t.AU(E):null;n.Z(H,new x(E,M,K))}v=t.xl();for(I=0;I<v.length;I++)E=v[I],z.hasProperty(E)||(H=e.a.Ab(E),M=t.AU(E),n.Z(H,new x(E,null,M)))}return n}}Object(D.a)(y,"MergeableObjectDiff",null,[])},1586:function(D,J,c){c.d(J,"b",function(){return x});c.d(J,"a",function(){return n});var l=c(225),e=c(368),
a=c(613),k=c(1743);const x=(z,v,I)=>{const E=y(z,v,I);let H=0,M=0,K=0,L=new k.a;const S=new l.a;for(let Q=0;Q<E.length;Q++){const N=E.eg(Q+1);L.tDd(z.eg(H));L.vDd(v.eg(M));L.zDd(I.eg(K));H++;M++;for(K++;H<z.length&&(!N||!N.equals(z.eg(H)));)L.tDd(z.eg(H)),H++;for(;M<v.length&&(!N||!N.equals(v.eg(M)));)L.vDd(v.eg(M)),M++;for(;K<I.length&&(!N||!N.equals(I.eg(K)));)L.zDd(I.eg(K)),K++;S.add(L);L=new k.a}for(;H<z.length;)L.tDd(z.eg(H)),H++;for(;M<v.length;)L.vDd(v.eg(M)),M++;for(;K<I.length;)L.zDd(I.eg(K)),
K++;L.isEmpty||S.add(L);return S},y=(z,v,I)=>{const E=new l.a,H=v.hH(),M=I.hH();z.forEach(K=>{H.contains(K)&&M.contains(K)&&E.add(K);return!0});return E},n=(z,v,I)=>{z=z||new l.a;v=v||new l.a;I=I||new l.a;const E=new l.a,H=new e.a(0),M=new a.a;for(var K=0;K<z.length;K++){var L=z.eg(K);H.Z(L,K)}for(z=K=0;K<v.length&&z<I.length;){L=v.eg(K);let S=I.eg(z),Q=H.Gz(L,-1),N=H.Gz(S,-1);-1===Q?(t(M,E,L),K++):-1===N?(t(M,E,S),z++):Q===N?(t(M,E,L),K++,z++):Q<N?K++:z++}for(;K<v.length;K++)L=v.eg(K),-1===H.Gz(L,
-1)&&t(M,E,L);for(;z<I.length;z++)v=I.eg(z),-1===H.Gz(v,-1)&&t(M,E,v);return E},t=(z,v,I)=>{z.contains(I)||(v.add(I),z.add(I))}},1587:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(61);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(D.a)(e,"LcsUpdateHint",null,[1501,76])},1588:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Vic="QueryIndex";l.gzj="TellMeRanker";l.hzj="TellMeRankerLogging";Object(D.a)(l,
"Services",null,[])},1589:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.XQa="HttpRequest";l.provider="Provider";Object(D.a)(l,"LatencyTypes",null,[])},1593:function(D,J,c){D=c(0);var l=c(16),e=c(6),a=c(225),k=c(184),x=c(244),y=c(61),n=c(613),t=c(55),z=c(239),v=c(1612);class I extends v.a{constructor(){super();this.nUa=null}get vha(){return"CreateMergeBlock"}lGb(){this.detail.Z("Type",this.vha);this.detail.Z("Revision",this.nUa);return this.detail}}Object(D.a)(I,"CreateMergeBlockFailureDetail",
v.a,[]);var E=c(1657),H=c(1659),M=c(1742),K=c(1613),L=c(1561),S=c(1805);c.d(J,"a",function(){return Q});class Q{static JJd(N,O,X,U,T,Y,aa){let ba;ba="";const oa=new a.a;for(let ea=0;ea<X.length;ea++){var ma=void 0;let ua;ma=E.a.CUl(O,X.J(ea),U,T,Y,aa,N);if(!ma)return{returnValue:null,T5a:ba};({VPf:ua,T5a:ma}=ma.Oci());if(!ua)return{returnValue:null,T5a:ba};ba+=ma;oa.$C(oa.length,ua)}return{returnValue:oa,T5a:ba}}static eNh(N,O,X,U,T,Y,aa,ba){let oa,ma,ea,ua,sa,Fa;Fa=sa=ua=ea=ma=oa=null;({T5a:ua,returnValue:oa}=
Q.JJd(O,Pa=>N.runtime.uk.J(Pa),X,1,Y,aa,ba));if(!oa)return k.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),N.logger.Rg(Object.assign(new I,{nUa:"Base"})),{returnValue:!1,TK:oa,iOc:ma,ydd:ea,qEd:ua,sOd:sa,$ne:Fa};({T5a:sa,returnValue:ma}=Q.JJd(O,Pa=>N.runtime.Nu.J(Pa)||N.runtime.uk.J(Pa),U,2,Y,aa,ba));if(!ma)return k.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
N.logger.Rg(Object.assign(new I,{nUa:"Favored"})),{returnValue:!1,TK:oa,iOc:ma,ydd:ea,qEd:ua,sOd:sa,$ne:Fa};({T5a:Fa,returnValue:ea}=Q.JJd(O,Pa=>N.runtime.Mq.J(Pa)||N.runtime.uk.J(Pa),T,4,Y,aa,ba));return ea?{returnValue:!0,TK:oa,iOc:ma,ydd:ea,qEd:ua,sOd:sa,$ne:Fa}:(k.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),N.logger.Rg(Object.assign(new I,{nUa:"Unfavored"})),{returnValue:!1,
TK:oa,iOc:ma,ydd:ea,qEd:ua,sOd:sa,$ne:Fa})}static NGh(N,O=!1){const X=new a.a;let U=0;for(;U<N.length;){var T=N.J(U);if(1===T.type||4===T.type||2===T.type)X.add(T),U++;else if(3===T.type){let aa="";aa+=T.character;U++;let ba=T.PRa,oa=!1;for(;U<N.length;U++){var Y=N.J(U);3===Y.type?T.runId===Y.runId&&T.wJ.equals(Y.wJ)&&(T.Lca===Y.Lca||T.UFa===Y.UFa)&&T.JF.JA(Y.JF)&&(!O||T.nu&&T.nu.equals(Y.nu))?(aa+=Y.character,Y.PRa&&(ba=!0)):oa=!0:oa=!0;if(oa){T=new S.a(null,T.source,T.Pj,T.Bg,T.runId,T.wJ,aa,T.snb,
!0,ba,T.Lca,T.UFa,T.BTa,T.JF,T.nu);X.add(T);break}}}}k.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",X.hr());return X}static G1k(N,O=!1){const X=new a.a;let U=0;for(;U<N.length;){var T=N.J(U);if(1===T.type||4===T.type||2===T.type)X.add(T),U++;else if(3===T.type){let aa=T.character.toString();U++;let ba=T.PRa;for(;U<N.length;U++){var Y=N.J(U);if(3===Y.type&&Q.Hto(T,Y,O))aa+=Y.character,Y.PRa&&(ba=!0);else break}T=new S.a(null,T.source,T.Pj,
T.Bg,T.runId,T.wJ,aa,T.snb,!0,ba,T.Lca,T.UFa,T.BTa,T.JF,T.nu);X.add(T)}}k.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",X.hr());return X}static Hto(N,O,X){return N.runId===O.runId&&N.wJ.equals(O.wJ)&&(N.Lca===O.Lca||N.UFa===O.UFa)&&N.JF.JA(O.JF)&&(!X||!!N.nu&&N.nu.equals(O.nu))}static ino(N,O,X,U,T,Y,aa,ba,oa,ma,ea,ua,sa,Fa,Pa,Na){N.setPropertyString(X.Dm,l.a.ho,T);N.setPropertyUint32(X.Dm,e.a.Wc,U);N.setPropertyUint32s(X.Dm,e.a.uq,Y);N.setPropertyUint32s(X.Dm,
e.a.ot,aa);N.setPropertyObjectIds(X.Dm,l.a.Rn,oa);N.hasProperty(X.Dm,e.a.uj)&&N.setPropertyUint32(X.Dm,e.a.uj,Q.BLl());O&&O(9)&&N.setPropertyObjectIds(X.Dm,e.a.Jv,Na);U=!1;for(T=0;T<ma.length;T++)if(ma.J(T)){U=!0;break}U&&N.setPropertyBools(X.Dm,e.a.UTf,ma);Q.dRk(O,N,X,ea,ua,sa,Fa);Q.eRk(N,X,Pa);X.DC(l.a.ho);X.DC(e.a.Wc);X.DC(e.a.uq);X.DC(e.a.ot);X.DC(l.a.Rn);X.DC(e.a.UTf);X.DC(l.a.Im);X.DC(l.a.Rqb);X.DC(e.a.FQa);X.DC(e.a.kIa);X.DC(l.a.rya);X.DC(e.a.Jv);N.hasProperty(X.Dm,e.a.uj)&&X.DC(e.a.uj);0<
ba.length?N.setPropertyUint32s(X.Dm,l.a.Im,ba):X.Dm.removeProperty(l.a.Im)}static dRk(N,O,X,U,T,Y,aa){if(N(101)){N=U.contains(!0,(ba,oa)=>oa);Q.Meg(O,X,l.a.rya,N?U:null);Q.Meg(O,X,l.a.Rqb,Q.Qej(U,T));Q.Meg(O,X,e.a.FQa,Q.Qej(U,Y));U=!1;for(T=0;T<aa.length;T++)0!==aa.J(T)&&(U=!0);U?O.setPropertyUint32s(X.Dm,e.a.kIa,aa):X.Dm.removeProperty(e.a.kIa)}}static eRk(N,O,X){const U=aa=>aa;var T=Object(t.a)(N,N.setPropertyBools,"setPropertyBools");Q.yOa(O,X.Ukb,U,T,e.a.rGa);Q.yOa(O,X.jhb,U,T,e.a.gha);Q.yOa(O,
X.R6a,U,T,e.a.jIa);T=aa=>0<aa.length;var Y=Object(t.a)(N,N.setPropertyStrings,"setPropertyStrings");Q.yOa(O,X.Tkb,T,Y,e.a.sGa);Q.yOa(O,X.ihb,T,Y,e.a.HEa);Q.yOa(O,X.Qob,T,Y,e.a.MJa);T=aa=>!!aa;Y=Object(t.a)(N,N.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");Q.yOa(O,X.Vkb,T,Y,e.a.tGa);Q.yOa(O,X.r1a,T,Y,e.a.IEa);Q.yOa(O,X.Sob,T,Y,e.a.NJa);X.R6a.any(U)?Q.yOa(O,X.Rob,()=>!0,Object(t.a)(N,N.setPropertyObjectIds,"setPropertyObjectIds"),e.a.kAa):O.Dm.removeProperty(e.a.kAa)}static Qej(N,O){const X=
new a.a;let U=!1;for(let T=0;T<N.length;T++){const Y=O.J(T)&&!N.J(T);X.add(Y);U=Y||U}return U?X:null}static Meg(N,O,X,U){U?N.setPropertyBools(O.Dm,X,U):O.Dm.removeProperty(X)}static BLl(){return x.a.FF()}static Kdi(N,O){return N.runtime.Nu.Gz(O,N.runtime.uk.J(O)||N.runtime.Mq.get(O))}static sRc(N,O,X,U,T){let Y;Y=new a.a;const aa=!!X&&X(9);if(N.runtime.Zb.isFeatureEnabled(78)){var ba=Q.G1k(U,aa);var oa=Q.NGh(U,aa);ba.length!==oa.length&&N.runtime.Zb.Xx(78)}else ba=Q.NGh(U,aa);oa=0;let ma="",ea=new a.a,
ua=new a.a,sa=new a.a,Fa=new a.a,Pa=new a.a,Na=new a.a,Aa=new a.a,za=new a.a,xa=new a.a;const ka=new M.a;let wa=new a.a;var ia=ba.J(ba.length-1);if(2!==ia.type&&4!==ia.type)return k.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",ia.type),N.logger.Rg(Object.assign(new K.a,{zj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",ia.type)})),{returnValue:!1,
K$d:Y};var va=0;for(ia=0;ia<ba.length;ia++){var na=ba.J(ia),Ca=null;if(1===na.type||3===na.type)Ca=na,ma+=Ca.text;else if(4===na.type){na=Q.Kdi(N,na.Pj);na=new L.a(na);Y.add(na);continue}Ca?(ea.add(Ca.runId),ua.add(Ca.Bg),va+=Ca.text.length,sa.add(va),Fa.add(Ca.wJ),Pa.add(Ca.snb),Na.add(Ca.PRa),Aa.add(Ca.Lca),za.add(Ca.UFa),xa.add(Ca.BTa),ka.Ukb.add(Ca.JF.Psm),ka.jhb.add(Ca.JF.ssm),ka.R6a.add(Ca.JF.ttm),ka.Tkb.add(Ca.JF.insertion.author),ka.ihb.add(Ca.JF.deletion.author),ka.Qob.add(Ca.JF.iIa.author),
ka.Vkb.add(Ca.JF.insertion.V0c),ka.r1a.add(Ca.JF.deletion.V0c),ka.Sob.add(Ca.JF.iIa.V0c),ka.Rob.add(Ca.JF.iIa.T2f),aa&&wa.add(Ca.nu)):ea.length||(ea.add(0),ua.add(0),sa.add(0),Fa.add(y.a.nil),Pa.add(!1),Na.add(!1),Aa.add(!1),za.add(!1),xa.add(0),ka.Ukb.add(!1),ka.jhb.add(!1),ka.R6a.add(!1),ka.Tkb.add(""),ka.ihb.add(""),ka.Qob.add(""),ka.Vkb.add(0),ka.r1a.add(0),ka.Sob.add(0),ka.Rob.add(y.a.nil));if(2===na.type){va=na;na=va.Wc;sa.AG(sa.length-1);Ca=T.J(oa);if(!Ca)return k.a.instance.Ua(17044307,1,
2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",oa,T.length,U.length,ia,ba.length),N.logger.Rg(Object.assign(new K.a,{zj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.Cka(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",T.hr()),k.a.instance.Cka(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
U.hr()),k.a.instance.Cka(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ba.hr()),{returnValue:!1,K$d:Y};if(Ca=Q.Kdi(N,Ca))Ca=new L.a(Ca.ZK()),Q.ino(O,X,Ca,va.Wc,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa,ka,wa),Y.add(Ca);k.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",va.Pj,na,ea.hr(),ua.hr(),
sa.hr(),Na.hr(),Aa.hr(),za.hr(),Fa.hr(),"",xa.hr());oa++;ma="";ea=new a.a;ua=new a.a;sa=new a.a;Fa=new a.a;Pa=new a.a;Na=new a.a;Aa=new a.a;za=new a.a;xa=new a.a;ka.reset();va=0;wa=new a.a}}return{returnValue:!0,K$d:Y}}static F7n(N,O){const X=N.runtime.vn.J(z.a.PL),U=O.getPropertyObjectIds(X.Dm,e.a.h2);for(let T=0;T<U.length;T++)N.runtime.vn.remove(U.J(T));O.setPropertyObjectIds(X.Dm,e.a.h2,new a.a);O.setPropertyString(X.Dm,e.a.NVa,y.a.nil.toString());X.DC(e.a.h2);X.DC(e.a.NVa)}static RCm(N,O){if(N.runtime.vn.nb(z.a.PL))return null;
const X=new L.a(N.runtime.uk.J(z.a.PL).ZK());O.setPropertyString(X.Dm,e.a.NVa,N.output.aN.last().id.toString());O.setPropertyObjectIds(X.Dm,e.a.h2,new a.a);X.DC(e.a.h2);X.DC(e.a.NVa);N.runtime.vn.Z(z.a.PL,X);return X}static Rsf(N){const O=new a.a;N.forEach(X=>{O.add(X.id);return!0});return O}static Bfc(N,O,X,U){let T=0;X.forEach(Y=>{H.a(Y,O+T++,1);393230===Y.Oc&&N.getPropertyObjectIds(Y,l.a.Rn).forEach(aa=>{U.add(aa);return!0});return!0})}static K5m(N,O){const X=new n.a;let U=0;O.forEach(T=>{if(X.contains(T))return!0;
X.add(T);if(({index:U}=Q.CNf("BaseFormatting_",U,T,Y=>N.runtime.uk.J(Y))).returnValue||({index:U}=Q.CNf("FavoredFormatting_",U,T,Y=>N.runtime.Nu.J(Y))).returnValue||({index:U}=Q.CNf("ConflictingFormatting_",U,T,Y=>N.runtime.Mq.J(Y))).returnValue)return!0;U++;return!0})}static CNf(N,O,X,U){if(X=U(X))if(H.a(X,N+O,1),1179649===X.Oc)return O++,{returnValue:!0,index:O};return{returnValue:!1,index:O}}static dhf(N){return!!N.runtime.uk.J(z.a.PL)}static yOa(N,O,X,U,T){O.any(X)?(U(N.Dm,T,O),N.DC(T)):N.Dm.removeProperty(T)}static Mnj(N,
O){const X=new a.a;X.add(0);const U=N?N.length:0;for(let T=0;T<U;T++)X.insert(T+1,N.eg(T));X.insert(X.length,O);return X}}Object(D.a)(Q,"ParagraphMergeUtils",null,[])},1610:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(225);class e{constructor(a,k,x){this.Km=null;this.ek=a;this.source=k;this.Pj=x}get type(){return this.ek}get M8a(){return!1}get hOm(){return 1===(this.source&1)}get iOm(){return 2===(this.source&2)}get jOm(){return 4===(this.source&4)}d5(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.KPl(),this.v9b())}KPl(){let a="";this.hOm&&(a+="Base");this.iOm&&(a+="FavoredUpdate");this.jOm&&(a+="UnfavoredUpdate");return a}v9b(){return""}JA(a){return this.type===a.type}Uad(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(D.a)(e,"AMergeBlock",null,[68,69])},1611:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1610);class l extends c.a{constructor(e,a,k){super(2,e,a);this.Wc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Wc,this.Pj)}v9b(){return"Eop"}clone(){return new l(this.source,this.Pj,this.Wc)}JA(e,a,k,x=!1,y=!0){return super.JA(e,a,k,x)?y?e.Wc===this.Wc:e.Pj===this.Pj&&e.Wc===this.Wc:!1}get length(){return 1}}Object(D.a)(l,"EopMergeBlock",c.a,[])},1612:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(368);class e{constructor(){this.detail=new l.a}}Object(D.a)(e,"AMergeFailureDetail",null,[1929])},1613:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1560);class l extends c.a{constructor(){super()}get vha(){return"ParagraphMerge"}}
Object(D.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1614:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1560);class l extends c.a{constructor(){super()}get vha(){return"RdOpLcs"}}Object(D.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1615:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1560);class l extends c.a{constructor(){super()}get vha(){return"TableMerge"}}Object(D.a)(l,"TableMergeFailureDetail",c.a,[])},1623:function(D,J,c){D=c(0);class l{constructor(){this.ucd=this.jVc=
null;this.FPf=this.score=this.t0c=0}r0f(E,H,M){this.score=E.J(H);++H;this.jVc=E.J(H)?M.Ioa(E.J(H)):null;++H;this.ucd=E.J(H)?M.Ioa(E.J(H)):null;++H;this.t0c=E.J(H);++H;this.FPf=E.J(H);++H;return H}}Object(D.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(E,H,M,K,L){this.wib=E;this.count=H;this.hPd=M;this.PO=K;this.depth=L}}Object(D.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1672),k=c(1761);class x{constructor(E=null,H=0,M=0,K=0){this.Lnk=E||new k.a;this.zwa=H;this.PO=M;this.depth=
K}get m6(){return this.Lnk}getKey(){return this.m6.Sx.toString()+":"+this.zwa.toString()}}Object(D.a)(x,"TrieBookmark",null,[]);class y{constructor(E,H){this.zSa=E;this.LOf=H}x9m(E){if(null==E)throw Error.argumentNull("prefix");let H={};var M=H[""]=new x;this.kXd(M,H);for(M=0;M<E.length;++M){const K=E.charCodeAt(M),L={};for(let S in H)this.qBk(K,H[S],L);H=L}return this.uOo(H)}kXd(E,H){if(!(E.PO>=this.LOf)&&(E=new x(a.a.X8e(E.m6),E.zwa,E.PO+1,E.depth),E.m6.WF&a.a.h$a&&(E.zwa+=1),this.zSa.ASb(E.m6))){E.depth+=
1;let M=!0;for(;M;)y.Hoe(E,H),this.kXd(E,H),E.zwa+=this.zSa.J9b(E.m6,!0)+(E.m6.WF&a.a.h$a?1:0),M=this.zSa.Tcd(E.m6)}}qBk(E,H,M){H.PO+1<=this.LOf&&(H.PO+=1,y.Hoe(H,M),--H.PO);H.m6.WF&a.a.h$a&&(H.zwa+=1);if(this.zSa.ASb(H.m6)){H.depth+=1;let K=!0;for(;K;)H.m6.ITb===E?(y.Hoe(H,M),this.kXd(H,M)):H.PO+1<=this.LOf&&(H.PO+=1,y.Hoe(H,M),this.kXd(H,M),--H.PO),H.zwa+=this.zSa.J9b(H.m6,!0)+(H.m6.WF&a.a.h$a?1:0),K=this.zSa.Tcd(H.m6)}}uOo(E){const H=[];for(var M in E){const K=E[M];if(!K.m6.Sx)continue;const L=
!!(K.m6.WF&a.a.h$a),S=this.zSa.J9b(K.m6,!1)+(L?1:0);Array.add(H,new e(K.zwa,S,L,K.PO,K.depth))}H.sort((K,L)=>{let S=K.wib-L.wib;return S||(S=-(K.count-L.count))?S:S=K.depth-L.depth});if(2>H.length)return H;E=[];for(M=0;M<H.length;)M+=y.JBj(M,H,E);return E}static Hoe(E,H){const M=E.getKey();M in H?(H=H[M],H.PO=Math.min(H.PO,E.PO)):H[M]=new x(a.a.X8e(E.m6),E.zwa,E.PO,E.depth)}static JBj(E,H,M){const K=H[E];let L=K.wib;const S=L+K.count;let Q=1,N=K.hPd;for(;E+Q<H.length&&H[E+Q].wib<S;){const O=H[E+Q];
O.wib>L&&(Array.add(M,new e(L,O.wib-L,N,K.PO,K.depth)),N=!1);Q+=y.JBj(E+Q,H,M);L=O.wib+O.count}L<S&&Array.add(M,new e(L,S-L,N,K.PO,K.depth));return Q}}Object(D.a)(y,"ErrorTolerantTrieLookupEngine",null,[1484]);class n extends l{constructor(E,H,M){super();this.iri=this.XZi=!1;this.CYh=null;if(E){var K=0;try{K=this.r0f(E,K,H);this.XZi=1===E.J(K);++K;this.iri=1===E.J(K);++K;const L=E.J(K);this.CYh=this.EBn(M,L)}catch(L){throw Error.argument("initData");}}}EBn(E,H){return new y(E,H)}}Object(D.a)(n,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class t extends l{constructor(E,H){super();this.query=this.name=null;if(E){this.annotations=H.annotations;var M=0;try{M=this.r0f(E,M,H),this.name=H.JB(E.J(M)),++M,this.query=H.jL(E.J(M))}catch(K){throw Error.argument("initData");}}}}Object(D.a)(t,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(E,H){super();if(E)try{this.r0f(E,0,H)}catch(M){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var v=c(1546);c.d(J,"a",function(){return I});
class I{constructor(E){this.BOf=E}get jVc(){return this.BOf.jVc}get ucd(){return this.BOf.ucd}get t0c(){return this.BOf.t0c}static create(E,H,M){const {SurfaceStringTokenStringGenerator:K}=c(1902),{QueryTokenStringGenerator:L}=c(1903),{FuzzyMatchTokenStringGenerator:S}=c(1904);let Q=0;try{if(E.J(Q)!==I.YBb)throw Error.argument("initData","Input does not represent a token string generator");++Q;const N=E.J(Q);++Q;const O=new v.a;O.Iib(E,Q,E.count-Q);switch(N){case K.$Hc:return new K(new z(O,H));case L.$Hc:return new L(new t(O,
H));case S.$Hc:return new S(new n(O,H,M));default:throw Error.argument("initData");}}catch(N){throw Error.argument("initData");}}static Aqh(E,H,M,K,L,S){E=E.BMo.getId(H,null);if(0>E)return++S,S;I.Bqh(E,M,K,L);return S}static Bqh(E,H,M,K){Array.add(K.Zjg,E);Array.add(K.axj,H);++K.boc[M]}}I.YBb=1099767983;Object(D.a)(I,"TokenStringGenerator",null,[1468])},1656:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(225);J=c(1610);var e=c(1571);class a extends J.a{constructor(k,x,y){super(k,x,
y)}gCo(k){let x;x=null;if(!this.text||!this.M8a||0>=k||k>=this.length)return{returnValue:!1,xvj:x};x=new l.a;const y=this.clone();y.w$c(e.a.$qb(this.text,0,k));const n=this.clone();n.w$c(e.a.$qb(this.text,k,this.length-k));x.add(y);x.add(n);return{returnValue:!0,xvj:x}}d5(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",J.a,[])},1657:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(184);class e{m2e(a,k){return a+("[Block: "+k+"] ")}static CUl(a,k,x,y,
n,t,z){const {ParagraphMergeBlockCreator:v}=c(1998),{TableMergeBlockCreator:I}=c(2003);if(393230===k.Oc)return new v(a,k,x,n,t,y(9),z);if(393250===k.Oc)return new I(k,x);l.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Oc);return null}}Object(D.a)(e,"MergeBlockCreator",null,[])},1658:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(6),e=c(61);J=c(1656);var a=c(1577);class k extends J.a{constructor(x,y,n,t,z,v,I,E,H,M,K,L,S,Q){super(y,n,
t);this.Bg=z;this.runId=v;this.snb=E;this.g4j=I;this.Cte=x;this.PRa=H;this.Lca=M;this.UFa=K;this.BTa=L;this.JF=S;this.nu=Q}get AGc(){return this.Cte}get wJ(){return this.g4j}get BFb(){return this.AGc(this.wJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Bg,this.runId,this.snb,this.Pj,this.wJ.toString(),this.nu?this.nu.toString():"NULL")}JA(x,y,n,t=!1){if(!super.JA(x,y,n,t))return!1;if(t)return!0;
if(!this.JF.JA(x.JF)||this.nu&&!this.nu.equals(x.nu))return!1;if(this.wJ.equals(x.wJ)||this.wJ.equals(e.a.nil)||x.wJ.equals(e.a.nil))return!0;x=new a.a(this.BFb,x.BFb);y=y.FMh(this.BFb,n);return x.zWc(y.obe)?!1:!0}get RIm(){return this.d5()&&"\ufffc"===this.text&&this.BFb?this.BFb.hasProperty(l.a.Ns)||1179725!==this.BFb.Oc?!0:!1:!1}}Object(D.a)(k,"AUserRunMergeBlock",J.a,[])},1659:function(D,J,c){c.d(J,"a",function(){return e});var l=c(184);const e=(a,k,x=4)=>{a?l.a.instance.Cka(4273285,x,4,k,a.mcd()):
l.a.instance.Ua(4293845,x,1,k,"{0}: Node was null.",k)}},1660:function(D,J,c){c.d(J,"e",function(){return y});c.d(J,"a",function(){return n});c.d(J,"d",function(){return t});c.d(J,"b",function(){return z});c.d(J,"c",function(){return v});var l=c(6),e=c(16),a=c(61),k=c(1061),x=c(1586);const y=(H,M,K)=>{const L=new k.a;let S=a.a.nil;M=L.getPropertyObjectId(M,l.a.irb);M.equals(a.a.nil)||(H=H.runtime.uk.J(M),K&&(H=K.Gz(M,H)),H&&(S=L.getPropertyObjectId(H,l.a.irb)));return S},n=(H,M,K,L,S)=>{const Q=new k.a;
let N=null;var O=Q.getPropertyObjectId(K,l.a.irb);O!==a.a.nil&&(N=H.runtime.uk.J(O),M&&(N=M.Gz(O,N)));if(N){O=Q.getPropertyObjectIds(N,e.a.gf);for(S=0;S<O.length&&!O.J(S).equals(K.id);S++);S===O.length&&(S=-1)}K=y(H,K,M);if(!K.equals(a.a.nil)&&(H=H.runtime.uk.J(K),M&&(H=M.Gz(K,H)),H)){M=Q.getPropertyObjectIds(H,e.a.gf);for(L=0;L<M.length&&!M.J(L).equals(N.id);L++);L===M.length&&(L=-1)}return{rowIndex:L,b5b:S}},t=(H,M,K,L,S)=>{var Q=new k.a;let N=null;var O=H.runtime.uk.J(K);M&&(O=M.Gz(K,O));if(!O)return null;
O=Q.getPropertyObjectIds(O,e.a.gf);K=null;L<O.length&&(L=O.J(L),K=H.runtime.uk.J(L),M&&(K=M.Gz(L,K)));K&&(Q=Q.getPropertyObjectIds(K,e.a.gf),S<Q.length&&(S=Q.J(S),N=H.runtime.uk.J(S),M&&(N=M.Gz(S,N))));return N},z=(H,M,K)=>{let L,S;S=L=-1;const Q=(new k.a).getPropertyObjectId(K,l.a.irb);var N=y(H,K,M);if(N.equals(a.a.nil)||Q.equals(a.a.nil))return{rowIndex:L,b5b:S};M=H.runtime.plg;var O=M.J(N);if(!O){O=I(H,N);if(!O)return{rowIndex:L,b5b:S};M.Z(N,O)}for(N=0;N<O.length;N++)if(O.J(N).equals(Q)){L=N;
break}O=M.J(Q);if(!O){O=E(H,Q);if(!O)return{rowIndex:L,b5b:S};M.Z(Q,O)}for(H=0;H<O.length;H++)if(O.J(H).equals(K.id)){S=H;break}return{rowIndex:L,b5b:S}},v=(H,M,K,L)=>{if(0>K||0>L)return a.a.nil;new k.a;const S=H.runtime.plg;let Q=S.J(M);if(!Q){Q=I(H,M);if(!Q)return a.a.nil;S.Z(M,Q)}if(K<Q.length)M=Q.J(K);else return a.a.nil;K=S.J(M);if(!K){K=E(H,M);if(!K)return a.a.nil;S.Z(M,K)}if(L<K.length)H=K.J(L);else return a.a.nil;return H},I=(H,M)=>{var K=new k.a;const L=H.runtime.uk.J(M);if(L){var S=H.runtime.Nu.Gz(M,
L);H=H.runtime.Mq.Gz(M,L);M=K.getPropertyObjectIds(L,e.a.gf);S=K.getPropertyObjectIds(S,e.a.gf);K=K.getPropertyObjectIds(H,e.a.gf);return M.Cq(S,(Q,N)=>Q.equals(N))?K:M.Cq(K,(Q,N)=>Q.equals(N))?S:x.a(M,S,K,(Q,N)=>Q.equals(N))}return(S=H.runtime.Nu.J(M))?K.getPropertyObjectIds(S,e.a.gf):(S=H.runtime.Mq.J(M))?K.getPropertyObjectIds(S,e.a.gf):null},E=(H,M)=>{var K=new k.a;const L=H.runtime.uk.J(M);if(L){var S=H.runtime.Nu.Gz(M,L);H=H.runtime.Mq.Gz(M,L);M=K.getPropertyObjectIds(L,e.a.gf);S=K.getPropertyObjectIds(S,
e.a.gf);K=K.getPropertyObjectIds(H,e.a.gf);return M.Cq(S,(Q,N)=>Q.equals(N))?K:M.Cq(K,(Q,N)=>Q.equals(N))?S:null}return(S=H.runtime.Nu.J(M))?K.getPropertyObjectIds(S,e.a.gf):(S=H.runtime.Mq.J(M))?K.getPropertyObjectIds(S,e.a.gf):null}},1661:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1526);class l extends c.a{constructor(e,a,k,x,y=null){super(e,a,y,null,k);this.id=x}}Object(D.a)(l,"TryQueryResultBinding",c.a,[])},1662:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.Bb=
e}get g6a(){return this.Bb.g6a}get CGo(){return 4!==this.Bb.style}get EGo(){return!0}get trie(){return this.Bb.trie}getId(e,a){if(!this.CGo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.N0l(e,a);default:throw Error.notImplemented();}}JB(e){if(!this.EGo)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.g6a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.Tfm(e);
case 4:return this.Sfm(e);default:throw Error.notImplemented();}}N0l(e,a){e=this.Bb.trie.gMi(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.roc||e.roc>=this.Bb.g6a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Ucd?this.Bb.h6c.$y(this.Bb.Ucd+4*e.roc,4):e.roc}Tfm(e){if(this.Bb.Ucd){let a=0;for(;a<this.Bb.g6a&&this.Bb.h6c.$y(this.Bb.Ucd+4*a,4)!==e;++a);if(a>=this.Bb.g6a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.eii(a)}return this.Bb.trie.eii(e)}Sfm(e){const a=
this.Bb.h6c.$y(this.Bb.Ywj+4*e,4);e=this.Bb.h6c.$y(this.Bb.Zwj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({Ywm:e}=this.MQn(e)).returnValue;return String.fromCharCode.apply(null,k)}MQn(e){let a=0;for(let k=0;3>k;++k){const x=this.Bb.h6c.J(this.Bb.oDh+e)^182;++e;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,Ywm:e}}}Object(D.a)(l,"StringTable",null,[1450])},1663:function(D,J,c){c.d(J,"a",function(){return e});
D=c(0);var l=c(1672);class e{constructor(a){this.trie=null;this.oDh=this.Ywj=this.Zwj=this.Ucd=0;if(a){this.h6c=a;var k=0;if(a.$y(k,4)!==e.YBb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.g6a=a.$y(k,4);k+=4;this.style=a.$y(k,4);k+=4;switch(this.style){case 0:const x=1===a.$y(k,4);k+=4;x||(this.Ucd=k,k+=4*this.g6a);a.$y(k,4);this.trie=this.dCn(a,k+4);break;case 4:this.Zwj=k;this.Ywj=k+=4*this.g6a;k+=4*this.g6a;a.$y(k,4);this.oDh=k+4;break;default:throw Error.argument("bytes");
}}}dCn(a,k){return new l.a(a,k)}}e.YBb=1025118440;Object(D.a)(e,"StringTableInit",null,[])},1664:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=
11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";
e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(l||(l={}));Object(D.b)("ResultType",l)},1669:function(D,J,c){D=c(0);var l=c(6),e=c(613),a=c(184),k=c(225),x=c(61),y=c(368),n=c(69),t;(function(Ua){Ua[Ua.none=0]="none";Ua[Ua.mergeConflict=1]="mergeConflict";
Ua[Ua.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Ua[Ua.failedToApplyHints=3]="failedToApplyHints";Ua[Ua.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";Ua[Ua.other=5]="other"})(t||(t={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",t);var z=c(1061),v=c(239),I=c(910);const E=Ua=>{const Ta=new k.a;Ua.forEach(Nb=>{Ta.add(Nb);return!0});return Ta};var H=c(1611),M=c(1586),K=c(1614);const L=(Ua,Ta)=>{if(Ua.length!==Ta.length)return!1;for(let Nb=0;Nb<
Ua.length;Nb++)Ua.J(Nb).Km=Ta.J(Nb),Ta.J(Nb).Km=Ua.J(Nb);return!0},S=(Ua,Ta,Nb)=>{let Wa,Bb,Ob;Wa=0;Bb=!1;Ob=0;var hc;if(!({idx:hc}=U(Ua,Ta)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Ta,Ua.hr()),{returnValue:!1,LSc:Wa,onb:Bb,r1c:Ob};if(!Nb&&2===Ua.J(hc).type)return{returnValue:!0,LSc:hc,onb:Bb,r1c:Ob};if(!Ua.J(hc).d5())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
hc,Nb,Ua.hr()),{returnValue:!1,LSc:Wa,onb:Bb,r1c:Ob};let Gc=!1,bc=0;for(;hc<Ua.length&&Ua.J(hc).Pj.equals(Ta);hc++){if(Nb===bc){Gc=!0;break}if(Nb>bc&&Nb<bc+Ua.J(hc).length){Bb=Gc=!0;Ob=Nb-bc;break}bc+=Ua.J(hc).length}Gc||Nb!==bc||(Gc=!0);Gc&&(Wa=hc);return{returnValue:Gc,LSc:Wa,onb:Bb,r1c:Ob}},Q=(Ua,Ta,Nb)=>{let Wa,Bb,Ob;Ob=Bb=0;Wa=!1;let hc=0,Gc=!1;for(;Bb<Ua.length;Bb++){if(Ta===hc){Gc=!0;break}if(Ta>hc&&Ta<hc+Ua.J(Bb).length){Wa=Gc=!0;Ob=Ta-hc;break}hc+=Ua.J(Bb).length}Gc||Ta!==hc||(Gc=!0);Gc||
(Ua=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ua.length,hc,Ta),a.a.instance.Ua(573178201,1,2,Ua),Nb.Rg(Object.assign(new K.a,{eventId:"8k6fz",info:Ua})));return{returnValue:Gc,onb:Wa,Exh:Bb,Dxh:Ob}},N=(Ua,Ta,Nb)=>{let Wa;if(Ua.J(Ta).d5()&&({xvj:Wa}=Ua.J(Ta).gCo(Nb)).returnValue)return Ua.$C(Ta+1,Wa),Ua.AG(Ta),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ta,Nb,Ua.hr());
return!1},O=(Ua,Ta,Nb)=>{let Wa,Bb;if(!({LSc:Nb,onb:Bb,r1c:Wa}=S(Ua,Ta,Nb)).returnValue)return{returnValue:!1,index:0};if(!Bb)return{returnValue:!0,index:Nb};if(N(Ua,Nb,Wa))return{returnValue:!0,index:Nb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ta,Wa,Ua.hr());return{returnValue:!1,index:0}},X=(Ua,Ta,Nb)=>{let Wa;if(!({onb:Wa,Exh:Ta,Dxh:Nb}=Q(Ua,Ta,Nb)).returnValue)return{returnValue:!1,index:0};if(!Wa)return{returnValue:!0,
index:Ta};if(N(Ua,Ta,Nb))return{returnValue:!0,index:Ta+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Nb,Ua.hr());return{returnValue:!1,index:0}},U=(Ua,Ta)=>{let Nb;Nb=0;for(let Wa=0;Wa<Ua.length;Wa++)if(Ua.J(Wa).Pj.equals(Ta))return Nb=Wa,{returnValue:!0,idx:Nb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Ta,Ua.hr());return{returnValue:!1,idx:Nb}},T=(Ua,
Ta)=>{let Nb;Nb=-1;for(let Wa=Ta;Wa<Ua.length;Wa++)if(2===Ua.J(Wa).type)return Nb=Wa,{returnValue:!0,sha:Nb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Ta,Ua.hr());return{returnValue:!1,sha:Nb}},Y=(Ua,Ta,Nb)=>{let Wa;Wa=-1;for(let Bb=Nb;Bb<Ua.length;Bb++)if(2===Ua.J(Bb).type&&Ua.J(Bb).Pj.equals(Ta))return Wa=Bb,{returnValue:!0,sha:Wa};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
Ta,Nb,Ua.hr());return{returnValue:!1,sha:Wa}},aa=(Ua,Ta)=>{let Nb;Nb=0;var Wa;if(!({idx:Wa}=U(Ua,Ta)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ta,Ua),{returnValue:!1,length:Nb};for(;Wa<Ua.length;Wa++)if(6!==Ua.J(Wa).type){if(2===Ua.J(Wa).type)return{returnValue:!0,length:Nb};a.a.instance.shipAssertTag(17342617,1,Ua.J(Wa).d5(),"We found something other than text with type "+Ua.J(Wa).type);a.a.instance.shipAssertTag(17877021,1,Ua.J(Wa).Pj.equals(Ta),
"Unexpected GraphNodeId {0} for ParaId {1}",Ua.J(Wa).Pj,Ta);Nb+=Ua.J(Wa).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ta,Ua);return{returnValue:!1,length:Nb}},ba=Ua=>{const Ta=new k.a;for(let Nb=0;Nb<Ua.length;Nb++)Ta.add(Ua.J(Nb).clone());return Ta};var oa=c(1613),ma=c(1571);class ea{constructor(Ua,Ta,Nb=null,Wa=null){this.Pj=Ua;this.type=Ta;this.text=Nb;this.Wc=Wa}isEqual(Ua){return Ua.Pj.equals(this.Pj)&&this.type===Ua.type&&this.Wc===Ua.Wc&&ma.a.Jvh(this.text,
Ua.text)}toString(){let Ua=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Pj,this.Wc,this.type);this.text&&(Ua+=String.format(" [TextLength: {0}]",this.text.length));return Ua}}Object(D.a)(ea,"MergeBlockValidationState",null,[]);var ua=c(111),sa=c(954),Fa=c(877),Pa=c(543),Na=c(470),Aa=c(953),za=c(876),xa=c(1560),ka=c(1751),wa;(function(Ua){Ua[Ua.base=1]="base";Ua[Ua.favoredUpdate=2]="favoredUpdate";Ua[Ua.unfavoredUpdate=4]="unfavoredUpdate";Ua[Ua.min=1]="min";Ua[Ua.max=
7]="max"})(wa||(wa={}));Object(D.b)("MergeBlockSource",wa);class ia{constructor(Ua,Ta,Nb,Wa){this.Bg=Ua;this.cp=Ta;this.pEd=Nb;this.ged=Wa}}Object(D.a)(ia,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var va=c(1610);class na extends va.a{constructor(Ua,Ta){super(6,Ua,Ta);this.Wc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Pj)}v9b(){return"Selection"}clone(){return new na(this.source,this.Pj)}JA(){return!1}get length(){return 0}}Object(D.a)(na,"SelectionMergeBlock",
va.a,[]);var Ca;(function(Ua){Ua[Ua.success=0]="success";Ua[Ua.selfSplit=1]="selfSplit";Ua[Ua.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Ua[Ua.unexpected=3]="unexpected"})(Ca||(Ca={}));Object(D.b)("SplitTwinListResult",Ca);var ta=c(1656);class fa extends ta.a{constructor(Ua,Ta,Nb,Wa){super(5,Ua,Ta);this._text=null;this.w$c(Nb);this.pok=Wa}get text(){return this._text}w$c(Ua){this._text=Ua}get Odd(){return this.pok}clone(){return new fa(this.source,this.Pj,this.text,this.Odd)}get M8a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(fa,"UpdateHintTextMergeBlock",ta.a,[]);class Xa{constructor(Ua,Ta,Nb,Wa){this.r3=!1;this.Adb=new y.a;this.$d=Ua;this.blh=Wa;this.tOg=Nb;this._base=Ta;this.Qye=ba(Ta);if(!L(this.base,this.Qe))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ua.logger.Rg(Object.assign(new xa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Qe(){return this.Qye}get mergeConflict(){return this.r3}a3e(Ua,
Ta){switch(Ua.type){case 1:return this.wFk(Ua,Ta);case 2:return this.z2e(Ua,Ta);case 3:return this.uGk(Ua,Ta);case 4:return this.QFk(Ua);case 5:return this.NEk(Ua,Ta);case 6:return this.x2e(Ua);default:return!1}}$2e(Ua,Ta){switch(Ua.type){case 1:return this.D2e(Ua,Ta);case 2:return this.y2e(Ua,Ta);case 3:return this.tGk(Ua,Ta);case 4:return this.PFk(Ua);case 5:return this.MEk(Ua,Ta);case 6:return this.w2e(Ua);default:return{returnValue:!1,Cu:null}}}wFk(Ua,Ta){let Nb;const Wa=({jia:Nb}=this.oJa(Ua.Bg,
Ta,!1,Ua.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",wa[Ta],Ca[Wa]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.r3=!1;Ta=new fa(Ta,Ua.Bg,Ua.text,Ua.id);this.uCf(Ua,Nb,Ta);return!0}z2e(Ua,Ta){let Nb,Wa=({jia:Nb}=this.oJa(Ua.Bg,Ta,!1,Ua.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",wa[Ta],Ca[Wa]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Bb;({jia:Bb,returnValue:Wa}=this.oJa(Ua.Bg,Ta,!1,Ua.cp+Ua.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
wa[Ta],Ca[Wa]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.r3=!1;this.Kef(Ua,Nb,Bb);return!0}uGk(Ua,Ta){let Nb;const Wa=({LAf:Nb}=this.abi(Ua,Ta,!1)).returnValue;if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",wa[Ta],Ca[Wa]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.r3=!1;Ta=new H.a(Ta,Ua.iu,Ua.Cua);this.uCf(Ua,Nb,Ta);return!0}QFk(Ua){let Ta;if(!({qXd:Ta}=this.bbi(Ua,this.Qe,"Derived")).returnValue)return!1;this.Kef(Ua,Ta,Ta+1);return!0}NEk(Ua,Ta){let Nb;if(!({UPf:Ta,KAf:Nb}=this.Nci(Ua,!1,Ta)).returnValue)return!1;this.uCf(Ua,Nb,Ta);return!0}x2e(Ua){let Ta;if(!({pXd:Ta}=this.Tai(Ua,this.Qe,"Derived")).returnValue)return!1;this.Kef(Ua,Ta,Ta+1);return!0}Vuh(Ua,Ta,Nb){const Wa=({jia:Ta}=this.oJa(Ua,Nb,!1,Ta,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",wa[Nb],Ca[Wa]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.r3=!1;Ua=new na(Nb,Ua);this.Qe.insert(Ta,Ua);return!0}D2e(Ua,Ta){var Nb=null;if(Xa.ayi(Ua.text.length))return{returnValue:!1,Cu:Nb};let Wa,Bb,Ob;var hc=({jia:Wa,sxa:Bb,Yga:Ob}=this.oJa(Ua.Bg,Ta,!0,Ua.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==hc&&2!==hc)return 3!==hc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",wa[Ta],Ca[hc]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Cu:Nb};this.r3=!1;({sha:hc}=T(this.Qe,Bb));hc=this.Qe.J(hc).Pj;Nb=new fa(Ta,Ua.Bg,Ua.text,Ua.id);Ta=new fa(Ta,hc,Ua.text,Ua.id);Nb.Km=Ta;Ta.Km=
Nb;this.base.insert(Wa,Nb);this.Qe.insert(Bb,Ta);Nb=new k.a;Nb.add(new Na.a(hc,Ob,Ua.text,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Nb}}y2e(Ua,Ta){let Nb;Nb=null;if(Xa.ayi(Ua.text.length))return{returnValue:!1,Cu:Nb};let Wa;var Bb,Ob=({jia:Wa,sxa:hc,Yga:Bb}=this.oJa(Ua.Bg,Ta,!0,Ua.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Ob){if(2!==Ob)return 3!==Ob&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
wa[Ta],Ca[Ob]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Cu:Nb};var hc=0;for({idx:Bb}=U(this.base,Ua.Bg);Bb<this.base.length&&hc<Ua.cp;Bb++)hc+=this.base.J(Bb).length;hc-=this.base.J(Bb-1).length;({sxa:hc,Yga:Bb,returnValue:Ob}=this.oJa(Ua.Bg,Ta,!0,hc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ob)return 3!==Ob&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
wa[Ta],Ca[Ob]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Cu:Nb};this.r3=!1}var Gc,bc;({jia:Gc,sxa:bc,Yga:Dc,returnValue:Ob}=this.oJa(Ua.Bg,Ta,!0,Ua.cp+Ua.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Ob){if(2!==Ob)return 3!==Ob&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",wa[Ta],Ca[Ob]),this.$d.logger.Rg(Object.assign(new ka.a,
{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Cu:Nb};var Dc=0;for({idx:bc}=U(this.base,Ua.Bg);bc<this.base.length&&Dc<Ua.cp+Ua.text.length;bc++)Dc+=this.base.J(bc).length;({sxa:bc,Yga:Dc,returnValue:Ob}=this.oJa(Ua.Bg,Ta,!0,Dc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ob)return 3!==Ob&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",wa[Ta],Ca[Ob]),
this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Cu:Nb};this.r3=!1}Ta="";Nb=new k.a;for(--bc;bc>=hc;bc--)if(6!==this.Qe.J(bc).type)if(this.Qe.J(bc).Km)Ta=this.Qe.J(bc).text+Ta,this.Qe.AG(bc);else{if(5===this.Qe.J(bc).type)Ob=Dc-Ta.length;else if(2===this.Qe.J(bc).type){if(Ob=0,!({length:Dc}=aa(this.Qe,this.Qe.J(bc).Pj)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Cu:Nb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Cu:Nb};if(!({sha:Ub}=T(this.Qe,bc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Cu:Nb};var Ub=this.Qe.J(Ub).Pj;Nb.add(new Pa.DeleteTextUpdateHint(Ub,Ob,Ta));Ta=""}for(--Gc;Gc>=Wa;Gc--)this.base.AG(Gc);if(!({sha:Ub}=T(this.Qe,hc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Cu:Nb};Ub=
this.Qe.J(Ub).Pj;Ta&&Ta.length&&Nb.add(new Pa.DeleteTextUpdateHint(Ub,Bb,Ta,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Nb}}tGk(Ua,Ta){var Nb=null;let Wa,Bb,Ob;var hc=({LAf:Wa,nqi:Bb,Yga:Ob}=this.abi(Ua,Ta,!0)).returnValue;if(0!==hc)return 3!==hc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",wa[Ta],Ca[hc]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,Cu:Nb};var Gc;if(!({sha:Gc}=T(this.Qe,Bb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,Cu:Nb};hc=this.Qe.J(Gc).Pj;const bc=this.Qe.J(Gc).Wc;let Dc,Ub,Fc;({iu:Gc,e8:Dc,Cua:Ub,Gba:Fc}=this.v6l(Ua,Gc));this.jDh(this.Qe,Gc,Dc,Fc,Bb);Nb=new H.a(Ta,Ua.iu,Ua.Cua);Ta=new H.a(Ta,Gc,Ub);Nb.Km=Ta;Ta.Km=Nb;this.base.insert(Wa,Nb);this.Qe.insert(Bb,Ta);Nb=new k.a;Nb.add(new za.a(hc,bc,
Ob,Gc,Ub,Dc,Fc,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Nb}}PFk(Ua){let Ta;Ta=null;let Nb,Wa;var Bb;if(!({qXd:Nb}=this.bbi(Ua,this.base,"Base")).returnValue)return{returnValue:!1,Cu:Ta};if(!this.base.J(Nb).Km||!({sha:Wa}=Y(this.Qe,this.base.J(Nb).Km.Pj,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.r3=!0,{returnValue:!1,Cu:Ta};if(!({sha:Bb}=T(this.Qe,Wa+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.r3=!0,{returnValue:!1,Cu:Ta};let Ob,hc,Gc,bc,Dc,Ub;({U5a:Bb,V5a:Gc,MTf:Ob,Ehn:bc,nhn:hc,ohn:Dc}=this.ZUl(Ua,Wa,Bb));if(!({length:Ub}=aa(this.Qe,Bb)).returnValue)return{returnValue:!1,
Cu:Ta};this.iDh(this.Qe,Bb,Gc,Wa);this.Qe.AG(Wa);this.base.AG(Nb);Ta=new k.a;Ta.add(new Aa.MergeParagraphUpdateHint(Ob,bc,Ub,hc,Dc,Bb,Gc,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Ta}}MEk(Ua,Ta){var Nb=null;let Wa,Bb,Ob;if(!({UPf:Ob,KAf:Wa}=this.Nci(Ua,!0,Ta)).returnValue)return{returnValue:!1,Cu:Nb};if(!({vkb:Bb}=this.gRc(this.base,this.Qe,Wa,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
Cu:Nb};if(0<Bb&&2!==this.Qe.J(Bb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.r3=!0,{returnValue:!1,Cu:Nb};let hc;if(!({iu:hc}=this.S4h(Bb)).returnValue)return{returnValue:!1,Cu:Nb};Ta=new H.a(Ta,Ua.Bg,Ua.Wc);Nb=Ob;Nb.Km=Ta;Ta.Km=Nb;this.base.insert(Wa,Ob);this.Qe.insert(Bb,Ta);Nb=new k.a;Nb.add(new sa.AddParagraphUpdateHint(Ua.Bg,
Ua.Wc,hc,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Nb}}w2e(Ua){let Ta;Ta=null;let Nb;var Wa;if(!({pXd:Wa}=this.Tai(Ua,this.base,"Base")).returnValue)return{returnValue:!1,Cu:Ta};if(!this.base.J(Wa).Km||!this.base.J(Wa).Km.Pj.equals(Ua.Bg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.r3=
!0,{returnValue:!1,Cu:Ta};if(!({vkb:Nb}=this.gRc(this.base,this.Qe,Wa,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,Cu:Ta};if(0<Nb&&2!==this.Qe.J(Nb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.r3=!0,{returnValue:!1,Cu:Ta};
const Bb=this.Qe.J(Nb).Pj,Ob=this.Qe.J(Nb).Wc;this.Qe.AG(Nb);this.base.AG(Wa);({iu:Wa}=this.S4h(Nb));0<Nb&&6===this.Qe.J(Nb-1).type&&this.RFn(Nb-1,Wa);Ta=new k.a;Ta.add(new Fa.a(Bb,Ob,Wa,Ua.id,Ua.Qu));return{returnValue:!0,Cu:Ta}}Uuh(Ua,Ta,Nb){let Wa;var Bb=({jia:Ta,sxa:Wa}=this.oJa(Ua,Nb,!0,Ta,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Bb)return 3!==Bb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
wa[Nb],Ca[Bb]),this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({sha:Bb}=T(this.Qe,Wa));Bb=this.Qe.J(Bb).Pj;Ua=new na(Nb,Ua);Nb=new na(Nb,Bb);Ua.Km=Nb;Nb.Km=Ua;this.base.insert(Ta,Ua);this.Qe.insert(Wa,Nb);return!0}ZUl(Ua,Ta,Nb){let Wa,Bb,Ob;Wa=Ua.U5a.equals(Ua.Bg)?this.Qe.J(Ta).Pj:this.Qe.J(Nb).Pj;Ua=Ua.V5a===Ua.Wc?this.Qe.J(Ta).Wc:this.Qe.J(Nb).Wc;Bb=this.Qe.J(Ta).Pj;Ta=this.Qe.J(Ta).Wc;Ob=this.Qe.J(Nb).Pj;Nb=this.Qe.J(Nb).Wc;return{U5a:Wa,
V5a:Ua,MTf:Bb,Ehn:Ta,nhn:Ob,ohn:Nb}}v6l(Ua,Ta){let Nb;var Wa=Ua.Bg.equals(Ua.iu)?Ua.e8:Ua.iu;const Bb=Ua.Wc===Ua.Cua?Ua.Gba:Ua.Cua;Ua.Bg.equals(Ua.iu)?Nb=this.Qe.J(Ta).Pj:(Nb=Wa,Wa=this.Qe.J(Ta).Pj);Ua.Wc===Ua.Cua?(Ua=this.Qe.J(Ta).Wc,Ta=Bb):(Ua=Bb,Ta=this.Qe.J(Ta).Wc);return{iu:Nb,e8:Wa,Cua:Ua,Gba:Ta}}kDh(Ua,Ta,Nb,Wa){for(;Wa<Ua.length;Wa++){if(!Ua.J(Wa).d5()&&6!==Ua.J(Wa).type&&2!==Ua.J(Wa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ua.J(Wa).type);break}Ua.J(Wa).Pj=
Ta;if(2===Ua.J(Wa).type){Ua.J(Wa).Wc=Nb;break}}}jDh(Ua,Ta,Nb,Wa,Bb){this.kDh(Ua,Nb,Wa,Bb);Xa.lDh(Ua,Ta,Bb)}iDh(Ua,Ta,Nb,Wa){this.kDh(Ua,Ta,Nb,Wa+1);Xa.lDh(Ua,Ta,Wa)}bbi(Ua,Ta,Nb){let Wa,Bb=-1;if(!({sha:Wa}=Y(Ta,Ua.Bg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Nb+"for GraphNodeId "+Ua.Bg),{returnValue:!1,qXd:Wa};if(!({sha:Bb}=T(Ta,Wa+1)).returnValue||!Ta.J(Bb).Pj.equals(Ua.e8))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
Wa+1+" in "+Nb+" of length "+Ta.length),{returnValue:!1,qXd:Wa};this.iDh(Ta,Ua.U5a,Ua.V5a,Wa);return{returnValue:!0,qXd:Wa}}abi(Ua,Ta,Nb){let Wa;const Bb=Nb?this.base:this.Qe,Ob=Nb?"Base":"Derived",hc=({jia:Ta,sxa:Nb,Yga:Wa}=this.oJa(Ua.Bg,Ta,Nb,Ua.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===hc||2===hc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Ob),{returnValue:hc,LAf:Ta,nqi:Nb,Yga:Wa};this.jDh(Bb,Ua.iu,Ua.e8,Ua.Gba,Ta);return{returnValue:hc,
LAf:Ta,nqi:Nb,Yga:Wa}}Tai(Ua,Ta,Nb){return({idx:Ua}=U(Ta,Ua.Bg)).returnValue?2!==Ta.J(Ua).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Nb),{returnValue:!1,pXd:-1}):{returnValue:!0,pXd:Ua}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Nb),{returnValue:!1,pXd:-1})}RFn(Ua,Ta){var Nb=this.Qe.J(Ua);if(Ta){let Wa;({sha:Wa}=Y(this.Qe,Ta,0));Nb=Nb.clone();Nb.Pj=Ta;this.Qe.AG(Ua);this.Qe.insert(Wa,
Nb)}else this.Qe.length>Ua&&(this.Qe.J(Ua+1).d5()||2===this.Qe.J(Ua+1).type)&&(Nb.Pj=this.Qe.J(Ua+1).Pj)}Nci(Ua,Ta,Nb){var Wa=Ta?this.base:this.Qe;Ta=Ta?"Base":"Derived";Nb=new H.a(Nb,Ua.Bg,Ua.Wc);if(Ua.iu){if(!({sha:Wa}=Y(Wa,Ua.iu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ua.iu,Ta),{returnValue:!1,UPf:Nb,KAf:Wa};Wa+=1}else Wa=0;return{returnValue:!0,UPf:Nb,KAf:Wa}}S4h(Ua){let Ta;Ta=null;let Nb=Ua-1;if(-1===
Nb)return{returnValue:!0,iu:Ta};6===this.Qe.J(Nb).type&&Nb--;if(2===this.Qe.J(Nb).type||4===this.Qe.J(Nb).type)return Ta=this.Qe.J(Nb).Pj,{returnValue:!0,iu:Ta};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Qe.J(Ua-1).type);return{returnValue:!1,iu:Ta}}gRc(Ua,Ta,Nb,Wa){let Bb,Ob=!0;Bb=-1;if(Nb>Ua.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,vkb:Bb};
if(Nb<Ua.length){if(-1<Nb&&Nb<Ua.length&&!Ua.J(Nb).Km){Ob=!1;for(var hc=Nb+1;hc<Ua.length;hc++)if(Ua.J(hc).Km){Nb=hc;Ob=!0;break}}if(!Ob)return{returnValue:!1,vkb:Bb};Ob=!1;for(hc=0;Ua.J(Nb)&&hc<Ta.length;hc++)if(Ta.J(hc).Km===Ua.J(Nb)){Bb=hc;Ob=!0;break}if(!Ob)return{returnValue:!1,vkb:Bb}}else Bb=Ta.length;if(0<Bb&&Wa&&!Ta.J(Bb-1).Km){for(Ua=Bb-1;0<=Ua&&!Ta.J(Ua).Km;Ua--);Bb=Ua+1;6===Ta.J(Bb).type&&5!==this.$d.input.source&&Bb++}return{returnValue:!0,vkb:Bb}}oJa(Ua,Ta,Nb,Wa,Bb,Ob){let hc;var Gc;
let bc;var Dc=this.base;let Ub=this.Qe,Fc=!1;Nb||(Dc=this.Qe,Ub=this.base);bc=Gc=hc=0;let Sa,wb,Tb=0;if(!({LSc:Wa,onb:Sa,r1c:wb}=S(Dc,Ua,Wa)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,jia:hc,sxa:Gc,Yga:bc};0<=Wa&&Wa<Dc.length&&!Dc.J(Wa).Km&&Sa&&!Bb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Ob),this.r3=!0,Tb=Ta===Dc.J(Wa).source?1:2,Fc=!0);Bb&&!Dc.J(Wa)&&Wa--;Bb&&Sa&&!Dc.J(Wa).Km&&(Sa=!1,wb=0);if(!Nb&&!({idx:Ua}=U(Ub,Ua)).returnValue&&!Sa)return{returnValue:0,jia:Wa,sxa:Gc,Yga:bc};if(!({vkb:Ua}=this.gRc(Dc,Ub,Wa,Nb&&!Sa)).returnValue&&!Fc&&(Ta=!1,1===this.blh&&0<Wa&&!wb&&(Wa--,{vkb:Ua,returnValue:Ta}=this.gRc(Dc,Ub,Wa,Nb&&!Sa),Ta&&(Wa++,Ua<Ub.length-1?Ua++:Ta=!1)),!Ta))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.$d.logger.Rg(Object.assign(new ka.a,{zj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.r3=!0,{returnValue:3,jia:hc,sxa:Gc,Yga:bc};if(Sa&&(!N(Dc,Wa,wb)||!Fc&&!N(Ub,Ua,wb)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,jia:hc,sxa:Gc,Yga:bc};hc=Wa;Gc=Ua;Sa&&(hc=Wa+1,Fc||(Gc=Dc.J(Wa),Nb=Ub.J(Ua),Gc.Km=Nb,Nb.Km=Gc,Dc=Dc.J(Wa+1),Gc=Ub.J(Ua+1),Dc.Km=Gc,Gc.Km=
Dc,Gc=Ua+1));if(Gc>=Ub.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Gc+" secondaryList length was "+Ub.length),{returnValue:3,jia:hc,sxa:Gc,Yga:bc};for(Dc=0;Dc<Gc;Dc++)Ub.J(Dc).Pj.equals(Ub.J(Gc).Pj)&&(bc+=Ub.J(Dc).length);return{returnValue:Tb,jia:hc,sxa:Gc,Yga:bc}}Kef(Ua,Ta,Nb){this.tOg.contains(Ua.id)&&this.Adb.Z(Ua.id,new k.a);for(--Nb;Nb>=Ta;Nb--)this.tOg.contains(Ua.id)?this.Adb.J(Ua.id).insert(this.Adb.J(Ua.id).length,
this.Qe.J(Nb)):this.Qe.J(Nb).Km&&(this.Qe.J(Nb).Km.Km=null),this.Qe.AG(Nb)}uCf(Ua,Ta,Nb){if(this.Adb.nb(Ua.Qu)){const Wa=this.Adb.J(Ua.Qu);for(let Bb=0;Bb<Wa.length;Bb++)Wa.J(Bb).Pj=Nb.Pj,Object(ua.a)(H.a,Nb)&&Object(ua.a)(H.a,Wa.J(Bb))&&(Wa.J(Bb).Wc=Nb.Wc);this.Qe.$C(Ta,this.Adb.J(Ua.Qu));this.Adb.remove(Ua.Qu)}else this.Qe.insert(Ta,Nb)}Gjm(Ua){let Ta,Nb;Nb=Ta=-1;if(!Ua.Km)return{returnValue:!1,V6b:Ta,eff:Nb};var Wa;let Bb=0,Ob=!1;if(!({idx:Wa}=U(this.Qe,Ua.Km.Pj)).returnValue)return{returnValue:!1,
V6b:Ta,eff:Nb};for(;Wa<this.Qe.length;Wa++){if(Ua.Km===this.Qe.J(Wa)){Ta=Wa;Nb=Bb;Ob=!0;break}Bb+=this.Qe.J(Wa).length}return{returnValue:Ob,V6b:Ta,eff:Nb}}rlf(Ua){let Ta;Ta=new k.a;let Nb=0,Wa=0;for(;Nb<Ua.length;){if(Wa>=this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Loc:Ta};if(Ua.J(Nb).length>this.base.J(Wa).length){if(!N(Ua,Nb,this.base.J(Wa).length))return a.a.instance.Ua(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Nb,this.base.J(Wa).length),{returnValue:!1,Loc:Ta}}else if(Ua.J(Nb).length<this.base.J(Wa).length){var Bb=!!this.base.J(Wa).Km,Ob=0;if(Bb&&!({vkb:Ob}=this.gRc(this.base,this.Qe,Wa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Wa),
{returnValue:!1,Loc:Ta};if(!N(this.base,Wa,Ua.J(Nb).length)||Bb&&!N(this.Qe,Ob,Ua.J(Nb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,Loc:Ta};if(Bb){Bb=this.base.J(Wa);var hc=this.Qe.J(Ob);Bb.Km=hc;hc.Km=Bb;Bb=this.base.J(Wa+1);Ob=this.Qe.J(Ob+1);Bb.Km=Ob;Ob.Km=Bb}}if(this.base.J(Wa).Km&&5!==this.base.J(Wa).type&&this.base.J(Wa).d5()&&(Ob=this.base.J(Wa),Bb=Ua.J(Nb),!Ob.wJ.equals(Bb.wJ)||
!Ob.JF.JA(Bb.JF))){let Gc;if(!({V6b:hc,eff:Gc}=this.Gjm(this.base.J(Wa))).returnValue)return{returnValue:!1,Loc:Ta};Ta.add(new ia(this.Qe.J(hc).Pj,Gc,Ob,Bb))}Nb++;Wa++}return{returnValue:!0,Loc:Ta}}static lDh(Ua,Ta,Nb){for(--Nb;0<=Nb;Nb--){if(!Ua.J(Nb).d5()&&6!==Ua.J(Nb).type){a.a.instance.shipAssertTag(17311187,1,2===Ua.J(Nb).type||4===Ua.J(Nb).type,"Found merge block of type "+Ua.J(Nb).type);break}Ua.J(Nb).Pj=Ta}}static ayi(Ua){return Ua?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(D.a)(Xa,"ParagraphMergeUsingHintsTwinList",null,[1930]);var ob=c(1749),xb=c(1750),zb=c(1746),Lb=c(1748),Ia=c(1747);class Ya{constructor(Ua,Ta,Nb,Wa){this.cp=Ua;this.length=Ta;this.pEd=Nb;this.ged=Wa}}Object(D.a)(Ya,"UpdateFormattingIdsPosInfo",null,[]);class eb{constructor(Ua,Ta,Nb){this.r3=!1;this.Adb=new y.a;this.B7g=!1;this.$d=Ua;this.blh=Nb;this._base=Ta;this.Qye=ba(Ta);if(!L(this.base,this.Qe))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ua.logger.Rg(Object.assign(new K.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.$d.runtime.Zb.Tjb(1000010)&&(this.B7g=!0)}get base(){return this._base}get Qe(){return this.Qye}get mergeConflict(){return this.r3}a3e(Ua,Ta){switch(Ua.type){case 11:return this.uFk(Ua,Ta);case 8:return this.z2e(Ua,Ta);case 10:return this.x2e(Ua);default:return!1}}$2e(Ua,Ta){switch(Ua.type){case 11:return this.tFk(Ua,Ta);case 8:return this.y2e(Ua,Ta);case 10:return this.w2e(Ua);default:return{returnValue:!1,Cu:null}}}Vuh(){a.a.instance.Ua(574433295,
1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}Uuh(){a.a.instance.Ua(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}rlf(Ua){let Ta;Ta=new k.a;let Nb=0,Wa=0,Bb=0;for(;Nb<Ua.length;){if(Wa>=this.base.length)return a.a.instance.shipAssertTag(574433297,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,fed:Ta};if(Ua.J(Nb).length>this.base.J(Wa).length){if(!N(Ua,Nb,this.base.J(Wa).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",
eventId:"8ps6s"})),{returnValue:!1,fed:Ta}}else if(Ua.J(Nb).length<this.base.J(Wa).length&&!this.E8a(Bb+Ua.J(Nb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,fed:Ta};if(this.base.J(Wa).Km&&5!==this.base.J(Wa).type&&this.base.J(Wa).d5()){const Ob=this.base.J(Wa),hc=Ua.J(Nb);if(!Ob.wJ.equals(hc.wJ)||
!Ob.JF.JA(hc.JF)){let Gc,bc;if(({V6b:Gc,dSh:bc}=this.Hjm(this.base.J(Wa))).returnValue)Ta.add(new Ya(bc,this.Qe.J(Gc).length,Ob,hc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,fed:Ta}}}Bb+=this.base.J(Wa).length;Nb++;Wa++}return{returnValue:!0,fed:Ta}}uFk(Ua,Ta){let Nb;if(!({JEa:Nb}=
this.E8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let Bb=0;Bb<Ua.y0.length;Bb++)switch(Ua.y0.J(Bb).type){case 7:var Wa=Ua.y0.J(Bb);this.Qe.insert(Nb,new fa(Ta,null,Wa.text,Wa.id));break;case 9:Wa=Ua.y0.J(Bb);this.Qe.insert(Nb,new H.a(Ta,Wa.Bg,Wa.Wc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new K.a,
{zj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}z2e(Ua,Ta){let Nb,Wa;if(!({JEa:Nb}=this.E8a(Ua.cp,!0)).returnValue||!({JEa:Wa}=this.E8a(Ua.cp+Ua.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ua=Wa;Ua>=Nb;Ua--)this.Qe.J(Ua).source!==Ta&&this.ZKd(this.Qe,Ua);return!0}x2e(Ua){let Ta;if(!({JEa:Ta}=this.E8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433302,
1,2,"ApplyDeleteParaHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.Nef(this.Qe,Ua,Ta);return!0}tFk(Ua,Ta){let Nb;Nb=null;let Wa,Bb;if(!({BBb:Wa,JEa:Bb}=this.E8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Cu:Nb};var Ob=this.Zpf(this.Qe,Bb-1);
Ob=new Ia.a(Ob);for(let hc=0;hc<Ua.y0.length;hc++)switch(Ua.y0.J(hc).type){case 7:Ob.y0.add(this.D2e(Ua.y0.J(hc),Ta,Wa,Bb));break;case 9:Ob.y0.add(this.vFk(Ua.y0.J(hc),Ta,Wa,Bb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Cu:Nb}}Nb=new k.a;Nb.add(Ob);return{returnValue:!0,Cu:Nb}}D2e(Ua,Ta,Nb,Wa){const Bb=new fa(Ta,Ua.Bg,Ua.text,Ua.id);Ta=new fa(Ta,
Ua.Bg,Ua.text,Ua.id);Bb.Km=Ta;Ta.Km=Bb;this.base.insert(Nb,Bb);this.Qe.insert(Wa,Ta);Nb=new Lb.a(Ua.Bg,Ua.text);Nb.id=Ua.id;return Nb}vFk(Ua,Ta,Nb,Wa){const Bb=new H.a(Ta,Ua.Bg,Ua.Wc);Ta=new H.a(Ta,Ua.Bg,Ua.Wc);Bb.Km=Ta;Ta.Km=Bb;this.base.insert(Nb,Bb);this.Qe.insert(Wa,Ta);return new zb.a(Ua.Bg,Ua.Wc)}y2e(Ua){let Ta;Ta=new k.a;let Nb;var Wa;let Bb;if(!({BBb:Nb,JEa:Wa}=this.E8a(Ua.cp,!0)).returnValue||!({BBb:Bb,JEa:Ob}=this.E8a(Ua.cp+Ua.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,
1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,Cu:Ta};this.$d.runtime.Zb.UVd(1000010);for(Ua=Ob;Ua>=Wa;Ua--)if(this.Qe.J(Ua).Km){var Ob=Ua;const hc=({HTf:Ua}=this.jEl(Ua,Wa)).returnValue;hc&&(Ta.add(hc),this.ZKd(this.Qe,Ua,Ob))}for(Wa=Bb;Wa>=Nb;Wa--)this.ZKd(this.base,Wa);return{returnValue:!0,Cu:Ta}}w2e(Ua){let Ta;Ta=null;let Nb,Wa;if(!({BBb:Nb,JEa:Wa}=this.E8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433305,
1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Cu:Ta};if(!this.Nef(this.base,Ua,Nb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Cu:Ta};this.Nef(this.Qe,Ua,Wa)&&(Ta=new k.a,Ta.add(new ob.a(this.Zpf(this.Qe,Wa-1),Ua.Bg,Ua.Wc)));
return{returnValue:!0,Cu:Ta}}E8a(Ua,Ta){var Nb;var Wa=Nb=-1;let Bb,Ob;if(!({onb:Ob,Exh:Ua,Dxh:Bb}=Q(this.base,Ua,this.$d.logger)).returnValue)return{returnValue:!1,BBb:Nb,JEa:Wa};const hc=Ua>=this.base.length;hc&&Ua--;if(this.base.J(Ua).Km){const Gc=this.HFl(this.Qe,this.base.J(Ua));if(Ob){if(0>Gc||!N(this.base,Ua,Bb)||!N(this.Qe,Gc,Bb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,
BBb:Nb,JEa:Wa};Nb=this.base.J(Ua);Wa=this.Qe.J(Gc);Nb.Km=Wa;Wa.Km=Nb;Nb=this.base.J(Ua+1);Wa=this.Qe.J(Gc+1);Nb.Km=Wa;Wa.Km=Nb;Nb=Ta?Ua+1:Ua;Wa=Ta?Gc+1:Gc}else Ta?(Nb=hc?Ua+1:Ua,Wa=hc?Gc+1:Gc):(Nb=hc?Ua:Ua-1,Wa=hc?Gc:Gc-1)}else if(Ob){if(N(this.base,Ua,Bb))Nb=Ta?Ua+1:Ua;else return a.a.instance.Ua(575706445,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,BBb:Nb,JEa:Wa};Ta?(Wa=({pIb:Wa}=this.G8b(this.base,this.Qe,
Ua,!1)).returnValue?Wa+1:0,Wa=Wa>=this.Qe.length?this.Qe.length-1:Wa):(Wa=({pIb:Wa}=this.G8b(this.base,this.Qe,Ua,!0)).returnValue?Wa-1:this.Qe.length-1,Wa=0>Wa?0:Wa)}else Ta?(({pIb:Wa}=this.G8b(this.base,this.Qe,Ua,!0)).returnValue||(({pIb:Wa}=this.G8b(this.base,this.Qe,Ua,!1)).returnValue?Wa+=1:(Wa=hc?this.Qe.length-1:0,Wa=0>Wa?0:Wa)),Nb=hc?Ua+1:Ua):(({pIb:Wa}=this.G8b(this.base,this.Qe,Ua,!1)).returnValue||(({pIb:Wa}=this.G8b(this.base,this.Qe,Ua,!0)).returnValue?--Wa:(Wa=Ua?this.Qe.length-1:0,
Wa=0>Wa?0:Wa)),Nb=hc?Ua:Ua-1);return{returnValue:!0,BBb:Nb,JEa:Wa}}G8b(Ua,Ta,Nb,Wa){let Bb=null;if(Wa)for(;Nb<Ua.length;Nb++){if(Ua.J(Nb).Km){Bb=Ua.J(Nb).Km;break}}else for(;0<=Nb;Nb--)if(Ua.J(Nb).Km){Bb=Ua.J(Nb).Km;break}if(Bb)for(Ua=0;Ua<Ta.length;Ua++)if(Ta.J(Ua)===Bb)return Ta=Ua,{returnValue:!0,pIb:Ta};return{returnValue:!1,pIb:-1}}HFl(Ua,Ta){for(let Nb=0;Nb<Ua.length;Nb++)if(Ua.J(Nb).Km===Ta)return Nb;return-1}ZKd(Ua,Ta,Nb=-1){for(Nb=0>Nb?Ta:Nb;Nb>=Ta;Nb--)Ua.J(Nb).Km&&(Ua.J(Nb).Km.Km=null),
Ua.AG(Nb)}Zpf(Ua,Ta){let Nb=0;for(;0<=Ta;Ta--)Nb+=Ua.J(Ta).length;return Nb}bim(Ua){Ua=Object(n.a)(ta.a,Ua);Ua||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"GetTextBlock",eventId:"8ujvq"})));return Ua}jEl(Ua,Ta){let Nb="",Wa=Ua;for(;Wa>=Ta&&this.Qe.J(Wa).Km&&2!==this.Qe.J(Wa).type;)Nb=this.bim(this.Qe.J(Wa)).text+Nb,Wa--;Ta=0>Wa?0:this.Zpf(this.Qe,Wa);return!this.B7g||Wa<Ua?(Ua=Wa+1,{returnValue:new xb.a(Ta,Nb),HTf:Ua}):{returnValue:null,HTf:Wa}}Hjm(Ua){let Ta,
Nb,Wa=!1;Nb=Ta=0;if(!Ua.Km)return{returnValue:!1,V6b:Ta,dSh:Nb};for(Ta=0;Ta<this.Qe.length;Ta++){if(this.Qe.J(Ta).Km===Ua){Wa=!0;break}Nb+=this.Qe.J(Ta).length}return{returnValue:Wa,V6b:Ta,dSh:Nb}}Nef(Ua,Ta,Nb){Nb=Nb===Ua.length?--Nb:Nb;Nb>Ua.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ua.J(Nb).type){const Wa=Ua.J(Nb);if(Wa.Pj!==Ta.Bg||Wa.Wc!==Ta.Wc)return!1;this.ZKd(Ua,Nb);return!0}return!1}}
Object(D.a)(eb,"ParagraphMergeUsingHintsTwinListLcs",null,[1930]);var sb=c(1593),lc=c(1561),vb=c(1745);c.d(J,"a",function(){return Eb});class Eb{constructor(Ua,Ta,Nb,Wa,Bb,Ob,hc=null,Gc=null,bc=null){this.zQ=this.vua=this.ELa=this.wsa=null;this._initialized=!1;this.$d=Ua;this.XF=Ta;this.UCa=Wa;this.ABa=Nb;this.Ysa=Bb;this.Lue=new e.a;for(Ua=0;Ua<this.XF.length;Ua++)this.Lue.add(this.XF.J(Ua).id);this.tVg=new e.a;for(Ua=0;Ua<this.ABa.length;Ua++)this.tVg.add(this.ABa.J(Ua).id);this.Pkh=new e.a;for(Ua=
0;Ua<this.UCa.length;Ua++)this.Pkh.add(this.UCa.J(Ua).id);this.Qg=Ob;this.DXe=hc||I.a.instance;this.JI=Gc;this.fX=bc;this.Bwb=1===(this.JI&&this.fX&&1===this.JI.bKa&&1===this.fX.bKa?1:0);this.Xsa=0}get kag(){return 1!==this.Xsa}QCm(){var Ua=!0;if(this.JI&&this.fX)return Ua;if(this.JI||this.fX)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.$d.runtime.Nu.nb(v.a.PL)&&(Ua=this.$d.runtime.Nu.J(v.a.PL),Ua=this.Lrg(Ua,this.$d.runtime.$Da.id,"favored")&&({updateHints:this.JI}=this.vsi(Ua,this.Lue,this.tVg,this.$d.runtime.Nu,"favored")).returnValue);Ua&&this.$d.runtime.Mq.nb(v.a.PL)&&(Ua=this.$d.runtime.Mq.J(v.a.PL),Ua=this.Lrg(Ua,this.$d.runtime.$Da.id,"unfavored")&&({updateHints:this.fX}=this.vsi(Ua,this.Lue,this.Pkh,this.$d.runtime.Mq,"unfavored")).returnValue);this.JI=this.JI?this.JI:new vb.a(new k.a,0);this.fX=this.fX?this.fX:
new vb.a(new k.a,0);Ua&&this.$d.input.rIb&&(Ua=this.$d.input.aaa.last().X2a(v.a.PL),Ua=this.Lrg(Ua,this.$d.input.aaa.last().vX.id,"alreadyMerged"));return Ua}YAm(){const Ua=new e.a;if(this.Bwb)return Ua;const Ta=this.JI?this.JI.updateHints.S5():new k.a;let Nb=0;for(;Nb<Ta.length-1;){const Wa=Ta.J(Nb);let Bb,Ob=!1;for(Bb=Nb+1;Bb<Ta.length;Bb++){const hc=Ta.J(Bb);if(Wa.Gzi(hc)){Ua.add(Wa.id);Ta.AG(Bb);Ta.AG(Nb);Ob=!0;break}}Ob||Nb++}return Ua}Lrg(Ua,Ta,Nb){Ua=this.Qg.getPropertyString(Ua,l.a.NVa);Ua=
x.a.If(Ua);return Ta.equals(Ua)?!0:(this.U9c(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.$d.runtime.$Da.id,Ua,Nb),!1)}vsi(Ua,Ta,Nb,Wa,Bb){let Ob;Ob=new vb.a(new k.a,0);Ua=this.Qg.getPropertyObjectIds(Ua,l.a.h2).S5();for(let Gc=0;Gc<Ua.length;Gc++){if(!Wa.nb(Ua.J(Gc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Ua.J(Gc),Bb),{returnValue:!1,updateHints:Ob};const bc=Wa.J(Ua.J(Gc));var hc=x.a.If(this.Qg.getPropertyString(bc,l.a.Jka));if(Ta.contains(hc)||Nb.contains(hc)){hc=this.DXe.uSc(bc);if(!hc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",bc.id,Bb),{returnValue:!1,updateHints:Ob};Ob.updateHints.add(hc)}}0<Ua.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
Bb,Ua.hr(),Ob.updateHints.hr());return{returnValue:!0,updateHints:Ob}}aCm(){return({TK:this.wsa,iOc:this.ELa,ydd:this.vua}=sb.a.eNh(this.$d,this.Qg,this.XF,this.ABa,this.UCa,this.Ysa,!0,!0)).returnValue?!0:!1}OCm(Ua){const Ta=sb.a.JJd(this.Qg,Nb=>this.$d.runtime.uk.J(Nb),this.XF,1,this.Ysa,!0,!0).returnValue;if(!Ta)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.zQ=this.Bwb?new eb(this.$d,Ta,1):new Xa(this.$d,Ta,Ua,
this.JI?this.JI.bKa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.QCm()||!this.aCm())return!1;const Ua=this.YAm();return this.OCm(Ua)?!0:!1}Pci(Ua){const Ta=new k.a;let Nb="";for(let Wa=0;Wa<Ua.length;Wa++){const Bb=Ua.J(Wa);Bb.d5()?Nb+=Ua.J(Wa).text:2===Bb.type?(Ta.add(new ea(Bb.Pj,Bb.type,Nb,Bb.Wc)),Nb=""):4===Bb.type&&(Ta.add(new ea(Bb.Pj,Bb.type)),Nb="")}return Ta}validateUpdateHintsAreComplete(Ua,Ta,Nb){Ta=this.Pci(Ta);Ua=this.Pci(Ua);let Wa=Ta.length===
Ua.length;if(Wa)for(let Bb=0;Bb<Ta.length;Bb++)if(!Ta.J(Bb).isEqual(Ua.J(Bb))){Wa=!1;break}Wa||(this.U9c(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Nb,Ua.hr(),Ta.hr()));return Wa}zvh(Ua,Ta,Nb){(Ta=({z9a:Ua}=this.cHk(Ua,Ta,Nb)).returnValue)||this.U9c(this.zQ.mergeConflict?1:3);return{returnValue:Ta,z9a:Ua}}cHk(Ua,Ta,Nb){let Wa;Wa=new k.a;let Bb=!0;var Ob=
0;let hc=null,Gc=this.JI?this.JI.updateHints.length:0;for(var bc=0;bc<Gc&&Bb;bc++)hc=this.JI.updateHints.J(bc),Ob<this.fX.updateHints.length&&hc.id.equals(this.fX.updateHints.J(Ob).id)&&5!==this.$d.input.source?({returnValue:Bb}=this.zQ.$2e(hc,2),Ob++):Bb=this.zQ.a3e(hc,2);if(!Bb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",hc.toString()),{returnValue:!1,z9a:Wa};if(!this.validateUpdateHintsAreComplete(this.zQ.Qe,this.ELa,"Favored"))return{returnValue:!1,
z9a:Wa};if(Ua&&1===this.$d.input.Xia&&!this.zQ.Vuh(Ta,Nb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ta,Nb),{returnValue:!1,z9a:Wa};Bb=!0;bc=new k.a;for(Gc=this.fX?this.fX.updateHints.length:0;Ob<Gc&&Bb;Ob++){hc=this.fX.updateHints.J(Ob);let Dc;({Cu:Dc,returnValue:Bb}=this.zQ.$2e(hc,4));Bb&&Dc&&bc.$C(bc.length,Dc)}return Bb?this.validateUpdateHintsAreComplete(this.zQ.base,this.vua,"Unfavored")?Ua&&2===this.$d.input.Xia&&!this.zQ.Uuh(Ta,
Nb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ta,Nb),{returnValue:!1,z9a:Wa}):{returnValue:!0,z9a:bc}:{returnValue:!1,z9a:Wa}:(a.a.instance.Ua(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",hc.id,hc.type),{returnValue:!1,z9a:Wa})}$4l(){let Ua,Ta=0;let Nb=0,Wa=x.a.nil;for(Ua=new y.a;Nb<this.zQ.base.length;){const hc=this.zQ.base.J(Nb);Wa.equals(hc.Pj)||(Ta=0,Wa=hc.Pj);if(5===hc.type){var Bb=
Ta+hc.length;var Ob=void 0;let Gc;const bc=ba(this.vua);if(!({index:Ob}=O(bc,hc.Pj,Ta)).returnValue||!({index:Gc}=O(bc,hc.Pj,Bb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",hc.Odd),{returnValue:!1,cPi:Ua};for(Bb=new k.a;Ob<Gc;Ob++)Bb.add(bc.J(Ob));Ua.Z(hc.Odd,Bb)}Ta+=hc.length;Nb++}return{returnValue:!0,cPi:Ua}}a5l(){let Ua;Ua=new y.a;let Ta=0;for(let Wa=
0;Wa<this.zQ.base.length;Wa++){const Bb=this.zQ.base.J(Wa);if(5===Bb.type){var Nb=void 0;let Ob;const hc=ba(this.vua);if(!({index:Nb}=X(hc,Ta,this.$d.logger)).returnValue||!({index:Ob}=X(hc,Ta+Bb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,dPi:Ua};const Gc=new k.a;for(;Nb<Ob;Nb++)Gc.add(hc.J(Nb));Ua.Z(Bb.Odd,Gc)}Ta+=Bb.length}return{returnValue:!0,dPi:Ua}}RFk(Ua){let Ta;Ta=
new k.a;let Nb;if(this.Bwb){if(!({dPi:Nb}=this.a5l()).returnValue)return{returnValue:!1,S0c:Ta}}else if(!({cPi:Nb}=this.$4l()).returnValue)return{returnValue:!1,S0c:Ta};let Wa;Wa=this.Bwb?new eb(this.$d,ba(this.ELa),1):new Xa(this.$d,ba(this.ELa),new e.a,this.JI?this.JI.bKa:0);for(var Bb=0;Bb<Ua.length;Bb++)if(!Wa.a3e(Ua.J(Bb),4))return{returnValue:!1,S0c:Ta};for(Ua=Wa.Qe.length-1;0<=Ua;Ua--)5===Wa.Qe.J(Ua).type&&(Bb=Wa.Qe.J(Ua).Odd,Wa.Qe.AG(Ua),Wa.Qe.$C(Ua,Nb.J(Bb)));this.Bwb&&(this.lQh(Wa.Qe),this.lQh(this.zQ.Qe));
if(!this.validateUpdateHintsAreComplete(this.zQ.Qe,Wa.Qe,"Merged"))return{returnValue:!1,S0c:Ta};Ta=Wa.Qe;return{returnValue:!0,S0c:Ta}}lQh(Ua){const Ta=new y.a;for(let Nb=Ua.length-1;0<=Nb;Nb--){const Wa=Object(n.a)(H.a,Ua.J(Nb));Wa&&(Ta.nb(Wa.Wc)?Ta.J(Wa.Wc).source!==Wa.source&&Ua.AG(Nb):Ta.add(Wa.Wc,Wa))}}bHk(Ua){let Ta;if(!({fed:Ta}=this.zQ.rlf(ba(this.vua))).returnValue)return!1;for(let Wa=0;Wa<Ta.length;Wa++){const Bb=Ta.J(Wa);let Ob,hc;if(!({index:Ob}=X(Ua,Bb.cp,this.$d.logger)).returnValue||
!({index:hc}=X(Ua,Bb.cp+Bb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{zj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Nb=!1;for(let Gc=Ob;Gc<hc&&!Nb;Gc++)Nb=!Bb.pEd.wJ.equals(Ua.J(Gc).wJ);if(!Nb){for(Nb=Ob;Nb<hc;Nb++)Ua.AG(Ob);Ua.insert(Ob,Bb.ged)}}return!0}aHk(Ua){let Ta;if(!({Loc:Ta}=this.zQ.rlf(ba(this.vua))).returnValue)return!1;for(let Bb=0;Bb<Ta.length;Bb++){var Nb=
Ta.J(Bb);let Ob,hc;if(({index:Ob}=O(Ua,Nb.Bg,Nb.cp)).returnValue&&({index:hc}=O(Ua,Nb.Bg,Nb.cp+Nb.ged.length)).returnValue){var Wa=!1;for(let Gc=Ob;Gc<hc&&!Wa;Gc++)Wa=!Nb.pEd.wJ.equals(Ua.J(Gc).wJ)||!Nb.pEd.JF.JA(Ua.J(Gc).JF);if(Wa){if(this.JI&&1===this.JI.bKa||this.fX&&1===this.fX.bKa)return!1}else{for(Wa=Ob;Wa<hc;Wa++)Ua.AG(Ob);Ua.insert(Ob,Nb.ged)}}else if(Nb=Nb.ged.RIm,a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",
Nb),Nb||this.JI&&1===this.JI.bKa||this.fX&&1===this.fX.bKa)return!1}return!0}g$l(Ua){let Ta,Nb;Nb=new k.a;Ta=this.$d.runtime.vn.J(v.a.PL);let Wa;({bQf:Wa}=Eb.q5h(this.$d,this.Qg));const Bb=new k.a;for(let hc=0;hc<Ua.length;hc++){if(Wa.contains(Ua.J(hc).id,(bc,Dc)=>bc.equals(Dc)))continue;if(this.$d.runtime.vn.nb(Ua.J(hc).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ua.J(hc).id),{returnValue:!1,M$d:Ta,L$d:Nb};Bb.add(Ua.J(hc).id);
var Ob=Ua.J(hc).b3a();const Gc=new lc.a(Ob);Ob=Ob.xl();for(const bc of Ob)Gc.DC(bc);Nb.add(Gc)}Ua=this.Qg.getPropertyObjectIds(Ta.Dm,l.a.h2);Ua.$C(Ua.length,Bb);this.Qg.setPropertyObjectIds(Ta.Dm,l.a.h2,Ua);return{returnValue:!0,M$d:Ta,L$d:Nb}}VRd(Ua){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ua.name,Ua.message,Ua.stack)}U9c(Ua){0===this.Xsa&&(this.Xsa=Ua)}yoc(){let Ua;Ua=null;let Ta,Nb;var Wa;try{if({vn:Ua,M$d:Ta,L$d:Nb,returnValue:Wa}=this.MPo(),Wa){if(Ta&&Nb){this.$d.runtime.vn.Z(Ta.Dm.id,
Ta);for(Wa=0;Wa<Nb.length;Wa++){const Gc=Nb.J(Wa);this.$d.runtime.vn.Z(Gc.Dm.id,Gc)}const Bb=Ta.Dm,Ob=this.Qg.getPropertyObjectIds(Bb,l.a.h2),hc=this.Qg.getPropertyString(Bb,l.a.NVa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Ob.hr(),hc)}else a.a.instance.Ua(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,vn:Ua}}}catch(Bb){a.a.instance.Ua(17162313,
1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.VRd(Bb))}this.U9c(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Xsa,this.kag);this.E5a();this.JI&&1===this.JI.bKa&&this.$d.logger.Rg(Object.assign(new oa.a,{eventId:"bc04c",zj:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.Xsa]+"/LCS"}));return{returnValue:!1,vn:Ua}}MPo(){let Ua,Ta,Nb;Nb=Ta=Ua=null;let Wa;Wa=this.initialize();
this.$d.logger.bV("PMUH Initialize");let Bb=null;Wa=Wa&&({z9a:Bb}=this.zvh(!1,x.a.nil,0)).returnValue;this.$d.logger.bV("PMUH ApplyUpdateHints");let Ob=new k.a;Wa=Wa&&({S0c:Ob}=this.RFk(Bb)).returnValue;this.$d.logger.bV("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Wa=this.Bwb?Wa&&this.bHk(Ob):Wa&&this.aHk(Ob);this.$d.logger.bV("PMUH ApplyUnfavoredFormattingChanges");this.Bwb&&!this.y9n(Ob)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.$d.logger.Rg(Object.assign(new K.a,
{zj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Wa=!1);const hc=this.HTd(Ob);Wa=Wa&&({K$d:Ua}=sb.a.sRc(this.$d,this.Qg,this.Ysa,Ob,hc)).returnValue;this.$d.logger.bV("PMUH GetMergeableObjectsFromMergeBlocks");this.JI&&1===this.JI.bKa&&this.fX&&1===this.fX.bKa||(Wa=Wa&&({M$d:Ta,L$d:Nb}=this.g$l(E(Bb))).returnValue,this.$d.logger.bV("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Wa,mergeConflict:!!this.zQ&&this.zQ.mergeConflict,vn:Ua,M$d:Ta,L$d:Nb}}HTd(Ua){const Ta=new k.a;for(let Nb=
0;Nb<Ua.length;Nb++)2===Ua.J(Nb).type&&Ta.add(Ua.J(Nb).Pj);return Ta}Sqf(Ua){const Ta=new k.a;for(let Nb=0;Nb<Ua.length;Nb++)2===Ua.J(Nb).type&&Ta.add(Ua.J(Nb));return Ta}y9n(Ua){var Ta=this.Sqf(this.wsa),Nb=this.Sqf(this.ELa),Wa=this.Sqf(this.vua),Bb=this.HTd(Ta),Ob=this.HTd(Nb),hc=this.HTd(Wa);Ob=M.b(Bb,Ob,hc);Bb=new k.a;for(hc=0;hc<Ob.length;hc++)Bb.$C(Bb.length,Ob.J(hc).JFl());Ob=this.OFl(Ua);Ta=this.KFl(Ob,Bb,Ta,Nb,Wa);Nb=0;Wa=new e.a;for(Bb=0;Bb<Ua.length;Bb++)if(Ob=Ua.J(Bb),2===Ob.type)if(Wa.contains(Ob.Pj))if(Nb<
Ta.length)Ua.AG(Bb),Ua.insert(Bb,Ta.J(Nb)),Nb++;else return!1;else Wa.add(Ob.Pj);0<Ua.length&&2!==Ua.J(Ua.length-1).type&&Nb<Ta.length&&Ua.insert(Ua.length,Ta.J(Nb));return!0}OFl(Ua){const Ta=new e.a;for(let Nb=0;Nb<Ua.length;Nb++)2===Ua.J(Nb).type&&Ta.add(Ua.J(Nb).Pj);return Ta}KFl(Ua,Ta,Nb,Wa,Bb){const Ob=new k.a;for(let hc=0;hc<Ta.length;hc++){const Gc=Ta.J(hc);if(!Ua.contains(Gc)){let bc;(({block:bc}=this.jlf(Wa,Gc)).returnValue||({block:bc}=this.jlf(Bb,Gc)).returnValue||({block:bc}=this.jlf(Nb,
Gc)).returnValue)&&bc&&Ob.add(bc)}}return Ob}jlf(Ua,Ta){for(let Nb=0;Nb<Ua.length;Nb++)if(2===Ua.J(Nb).type&&Ua.J(Nb).Pj===Ta)return Ua=Ua.J(Nb),{returnValue:!0,block:Ua};return{returnValue:!1,block:null}}E5a(){const Ua=new k.a;sb.a.Bfc(this.Qg,"BaseObjects_",this.XF,Ua);sb.a.Bfc(this.Qg,"FavoredObjects_",this.ABa,Ua);sb.a.Bfc(this.Qg,"ConflictObjects_",this.UCa,Ua)}eSk(){let Ua,Ta;Ua=x.a.nil;Ta=-1;let Nb=0;for(let Wa=0;Wa<this.zQ.Qe.length;Wa++){const Bb=this.zQ.Qe.J(Wa);if(Bb.d5())Nb+=Bb.length;
else if(6!==Bb.type)Nb=0;else return Ua=Bb.Pj,Ta=Nb,{returnValue:!0,objectId:Ua,cp:Ta}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ua,cp:Ta}}Kdd(Ua,Ta){let Nb,Wa;Wa=Ta;Nb=Ua;try{let Bb=this.initialize();if(Bb=(Bb=Bb&&this.zvh(!0,Ua,Ta).returnValue)&&({objectId:Nb,cp:Wa}=this.eSk()).returnValue)return a.a.instance.Ua(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",
Nb,Wa),{returnValue:!0,B7a:Nb,gra:Wa}}catch(Bb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.VRd(Bb))}this.U9c(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Xsa,this.kag);this.E5a();return{returnValue:!1,B7a:Nb,gra:Wa}}static q5h(Ua,Ta){let Nb;Nb=new k.a;if(!Ua.input.rIb)return{returnValue:!0,bQf:Nb};Ua=Ua.input.aaa.last().X2a(v.a.PL);
Nb=Ta.getPropertyObjectIds(Ua,l.a.h2);return{returnValue:!0,bQf:Nb}}static zGn(Ua){if(!sb.a.dhf(Ua))return!0;const Ta=new z.a;Ua.runtime.vn.Z(v.a.PL,sb.a.RCm(Ua,Ta));return!0}static eGn(Ua){if(!Ua.runtime.vn.nb(v.a.PL)||!Ua.runtime.Mq.nb(v.a.PL))return!0;const Ta=new z.a,Nb=Ua.runtime.vn.J(v.a.PL);var Wa=Ta.getPropertyString(Nb.Dm,l.a.NVa);if(x.a.If(Wa).equals(x.a.nil))return!0;Wa=Ta.getPropertyObjectIds(Nb.Dm,l.a.h2);const Bb=Ta.getPropertyObjectIds(Ua.runtime.Mq.J(v.a.PL),l.a.h2);let Ob;({bQf:Ob}=
Eb.q5h(Ua,Ta));for(let hc=0;hc<Bb.length;hc++)Wa.contains(Bb.J(hc),(Gc,bc)=>Gc.equals(bc))||Ob.contains(Bb.J(hc),(Gc,bc)=>Gc.equals(bc))||(Wa.add(Bb.J(hc)),Ua.runtime.vn.Z(Bb.J(hc),new lc.a(Ua.runtime.Mq.J(Bb.J(hc)).ZK())));Ta.setPropertyObjectIds(Nb.Dm,l.a.h2,Wa);return!0}}Object(D.a)(Eb,"ParagraphMergeUsingHints",null,[1867])},1672:function(D,J,c){D=c(0);class l{constructor(n){this.PRi=n;this.succeeded=!1;this.roc=n?n.roc:0;this.JWm=!1;this.length=this.OIo=0}}Object(D.a)(l,"TrieResult",null,[]);
class e{constructor(n,t,z){this.Tmb=new l(null);this.a$m=n;this.b0c=t;this.HMi=t+z-1}get result(){return this.Tmb}gdi(){let n;return this.b0c<=this.HMi?(n=this.a$m.charAt(this.b0c),++this.b0c,{returnValue:!0,ch:n}):{returnValue:!1,ch:"\x00"}}K7f(n,t,z){n&&(this.Tmb.JWm=!0,this.Tmb.OIo=t);this.Tmb.length=this.b0c;this.Tmb.succeeded=!0;this.Tmb.roc=z;this.b0c!==this.HMi+1&&(this.Tmb=new l(this.Tmb))}}Object(D.a)(e,"LookUpStringVisitor",null,[1467]);var a=c(1761);class k{constructor(){this.PCh=this.nAh=
this.pAh=this.mAh=this.oAh=this.o6e=this.m6e=this.q6e=this.l6e=0}}Object(D.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.O8a=this.N1c=0}}Object(D.a)(x,"TrieSymbol",null,[]);c.d(J,"a",function(){return y});class y{constructor(n,t){this.f5=null;this.i4d=this.XMi=this.VMi=this.ZMi=this.QMi=this.YMi=this.WMi=this.$Mi=this.RMi=0;this.SJ=n;if(n.$y(t,4)!==y.YBb)throw Error.argument("Input does not represent a trie");t+=4;this.JMi=1===n.$y(t,4);t+=4;this.Y9m=1===n.$y(t,4);t+=4;this.U9m=n.$y(t,4);t+=
4;if(n.$y(t,4)){n=t+4;this.f5=this.VQn(n);this.RMi=t=n+y.AQk;this.$Mi=t+=y.dFd*(this.f5.l6e+(this.f5.l6e%2?1:0));this.WMi=t+=y.dFd*(this.f5.q6e+(this.f5.q6e%2?1:0));this.YMi=t+=y.dFd*(this.f5.m6e+(this.f5.m6e%2?1:0));this.QMi=t+=y.dFd*(this.f5.o6e+(this.f5.o6e%2?1:0));this.ZMi=t+=y.s6e*this.f5.mAh;this.VMi=t+=y.t6e*this.f5.pAh;this.XMi=t+=y.t6e*this.f5.nAh;t+=y.t6e*this.f5.oAh;if(t!==n+this.f5.PCh)throw Error.argument("Corrupted trie binary");this.i4d=t}else this.f5=null}gMi(n,t,z,v){n=new e(n,t,
z);this.NKj(n,v);return n.result}eii(n){if(this.JMi)if(n)--n;else return"";if(!this.f5)throw Error.argument("Invalid trieID");const t=new a.a;t.WF=0;this.ASb(t);const z=[];for(;;){if(t.WF&y.h$a)if(n)--n;else return Array.add(z,t.ITb),String.fromCharCode.apply(null,z);const v=!!(t.WF&y.Vre),I=this.J9b(t,!0);if(v||n<I){if(Array.add(z,t.ITb),!this.ASb(t))throw Error.argument("Invalid trieID");}else if(n-=I,!this.Tcd(t))throw Error.argument("Invalid trieID");}}NKj(n,t){let z=0;this.JMi&&(n.K7f(this.Y9m,
this.U9m,0),++z);if(this.f5){var v=new a.a;v.WF=0;if(this.ASb(v))for(;;){var I=void 0;if(!({ch:I}=n.gdi()).returnValue)break;t&&(I=t(I));I=I.toString().charCodeAt(0);let E=!1;for(;!E;){const H=!!(v.WF&y.h$a);if(v.ITb===I){if(E=!0,H&&n.K7f(!!(v.WF&y.Ovg),v.Jle,z),!this.ASb(v))return}else if(z+=this.J9b(v,!0),!this.Tcd(v))return;H&&++z}}}}ASb(n){if(!n.WF)return this.Yng(n),!0;if(!(n.WF&y.Ure))return!1;n.$Qa=0;n.Sx=n.ukb;this.Yng(n);return!0}Tcd(n){if(n.WF&y.Vre)return!1;this.Yng(n);return!0}J9b(n,t){return n.WF&
y.Nvg?n.cFd:n.WF&y.Ure?!t&&n.WF&y.Vre?this.oUl(n):1:0}oUl(n){n=y.X8e(n);if(!this.ASb(n))return 0;let t=0;do n.WF&y.h$a&&++t,t+=this.J9b(n,!1);while(this.Tcd(n));return t}Yng(n){n.WF||(n.$Qa=0,n.Sx=this.i4d);var t=this.IKd(this.RMi,n.Sx),z=t.O8a;n.Sx+=t.N1c;t=this.SJ.$y(this.QMi+y.s6e*z,y.s6e);n.ITb=t&65535;n.WF=t>>16;n.WF&y.Nvg&&(n.cFd=this.Hil(n));n.WF&y.Ovg&&(t=this.IKd(this.$Mi,n.Sx),z=t.O8a,n.Sx+=t.N1c,n.Jle=this.SJ.$y(this.ZMi+4*z,4));n.WF&y.NSj?(n.ukb=this.i4d+((this.SJ.J(n.Sx)<<8|this.SJ.J(n.Sx+
1))<<8|this.SJ.J(n.Sx+2)),n.Sx+=3):n.WF&y.OSj?(n.ukb=n.Sx,n.$Qa=n.ukb):n.WF&y.PSj?(t=this.IKd(this.WMi,n.Sx),z=t.O8a,n.Sx+=t.N1c,n.ukb=this.i4d+this.SJ.$y(this.VMi+4*z,4)):n.WF&y.Ure&&(t=this.IKd(this.YMi,n.Sx),z=t.O8a,n.Sx+=t.N1c,n.$Qa||(n.$Qa=n.Sx),n.$Qa+=this.SJ.$y(this.XMi+4*z,4),n.ukb=n.$Qa)}IKd(n,t){const z=new x;let v=0;for(;;){v+=this.SJ.J(t);++t;++z.N1c;const I=this.SJ.$y(n,2);if(v<I)break;z.O8a+=I;v-=I;n+=2;v<<=8}z.O8a+=v;return z}Hil(n){let t=this.SJ.J(n.Sx);192<=t?(t=(t&63)<<15|(this.SJ.J(n.Sx+
1)&127)<<8,t|=this.SJ.J(n.Sx+2),n.Sx+=3):128<=t?(t=(t&127)<<8|this.SJ.J(n.Sx+1),n.Sx+=2):n.Sx+=1;return t}VQn(n){const t=new k;t.l6e=this.SJ.$y(n+12,2);t.q6e=this.SJ.$y(n+14,2);t.m6e=this.SJ.$y(n+16,2);t.o6e=this.SJ.$y(n+18,2);t.oAh=this.SJ.$y(n+24,4);t.mAh=this.SJ.$y(n+28,4);t.pAh=this.SJ.$y(n+32,4);t.nAh=this.SJ.$y(n+36,4);t.PCh=this.SJ.$y(n+40,4);return t}static X8e(n){const t=new a.a;t.ITb=n.ITb;t.WF=n.WF;t.cFd=n.cFd;t.Sx=n.Sx;t.ukb=n.ukb;t.$Qa=n.$Qa;t.Jle=n.Jle;return t}}y.YBb=1654263084;y.AQk=
48;y.dFd=2;y.t6e=4;y.s6e=4;y.h$a=1;y.Vre=2;y.Nvg=4;y.Ovg=8;y.Ure=16;y.OSj=64;y.PSj=128;y.NSj=256;Object(D.a)(y,"Trie",null,[1463])},1674:function(D,J,c){c.r(J);D=c(0);c(1524);var l=c(1542);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(D.a)(e,"AppsForOfficeStoreType",null,[]);var a=c(1522),k=c(2),x=c(93),y=c(12);class n{constructor(){this.oUe=0}H4f(K,L){this.oUe=window.performance.now();this.eWa(()=>{const S=window.performance.now(),Q={},N=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);L.vAk&&(Q.callback=O=>{K(O,e.marketPlace,S)},N&&(Q.storeType=e.marketPlace),k.AFrameworkApplication.va.Qb(y.a.pOb,2,Q));L.wAk&&(Q.callback=O=>{K(O,e.privateCatalog,S)},N?Q.storeType=e.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Q.storeType=10:Q.storeType=e.privateCatalog,k.AFrameworkApplication.va.Qb(y.a.pOb,2,Q))},0,()=>{if(a.TellMeActor.instance.Pe)a.TellMeActor.instance.Pe.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.oUe)+" ms")})}eWa(K,L=0,S=null){2!==k.AFrameworkApplication.va.processAction(y.a.pOb,1)?(a.TellMeActor.instance.Pe&&a.TellMeActor.instance.Pe.QA(l.a.uAk,window.performance.now()-this.oUe),K()):L<n.ocn?k.AFrameworkApplication.lc.Wb(new x.a(2,1,n.P4o,()=>{this.eWa(K,L+1,S)})):S&&S()}static get instance(){n._instance||(n._instance=new n);return n._instance}}n._instance=null;n.ocn=20;n.P4o=500;Object(D.a)(n,"AddinEntitlementsQuery",null,
[]);class t{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.bKf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(t,"AddinInfo",null,[]);var z=c(1526),v=c(1529),I=c(1528),E=c(1521),H=c(128);c.d(J,"AddinResultsProvider",function(){return M});class M{constructor(K){this.tQe=[];this.fc=K;this.Cpn=(L,S,Q)=>{if(L){const N=L.errorCode;if(a.TellMeActor.instance.Pe){const O=
{};O.StoreType=S;O.ErrorCode=N;O.AddinCount=L.value?L.value.length:0;a.TellMeActor.instance.Pe.QA(l.a.gNl,window.performance.now()-Q,O)}if(0===N&&L.value){M.jBb=M.jBb||{};L=L.value;for(const O of L)L=new t,L.displayName=O[0],L.id=O[1],L.description=O[2],L.targetType=O[3],L.appVersion=4<O.length?O[4]:"",L.assetId=5<O.length?O[5]:"",L.assetStoreId=6<O.length?O[6]:"",L.width=7<O.length?O[7]:0,L.height=8<O.length?O[8]:0,L.iconUrl=9<O.length?O[9]:"",L.providerName=10<O.length?O[10]:"",L.storeId=11<O.length?
O[11]:"",L.storeType=12<O.length?O[12]:"",L.bKf=this.z2l(L),M.jBb[L.id]=L,0<L.iconUrl.length&&(S="AddinIcon_"+L.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.f$i(S,L.iconUrl):appChrome.addInApi.registerAddinIcon(S,L.iconUrl))}}};n.instance.H4f(this.Cpn,this.fc)}qL(){return"Add-ins"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(K,L,S,Q,N=null){S=new I.a(K);N&&!Array.contains(N,27)||E.a.GR(K)||(N=new v.a(27),N.displayName=
CommonUIStrings.l_TellMeAddinProviderTitle,this.Z1l(K.Fg,N),S.gv(N));L.resultsUpdated(S)}Z1l(K,L){if((K=this.Eco(K))&&0<K.length){let S=0;K.forEach(Q=>{if(!(3<++S)){var N="AddinSuggestion"+S,O={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var X="AddinIcon_"+Q.id;0>Array.indexOf(this.tQe,X)&&0<Q.iconUrl.length&&this.f$i(X,Q.iconUrl);O["default"]=0<=Array.indexOf(this.tQe,X)?X:"AppForOfficeLogo_20"}else O["default"]=0<Q.iconUrl.length?
"AddinIcon_"+Q.id:"AppForOfficeLogo_20";X=[];X.push(appChrome.actions.setControlLabel(N,Q.displayName));X.push(appChrome.actions.setControlIconSet(N,O));X.push(appChrome.actions.setCompoundButtonCommandValueId(N,Q.id));X.push(appChrome.actions.updateCompoundButtonDescription(N,Q.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(O=window.performance.now(),X.push(appChrome.actions.updateControlEnabledDisabledState(N,!1)),
a.TellMeActor.instance.Pe&&a.TellMeActor.instance.Pe.QA(l.a.Gvl,window.performance.now()-O));appChrome.api.dispatch(X);N=new z.a(N,27,void 0,void 0,1);N.dJ=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.id,Q.storeType,Q.assetId,null,null,Q.storeId);L.Ww(N)}})}}f$i(K,L){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(K,L),Array.add(this.tQe,K))}Eco(K){if(!M.jBb)return null;const L=[],S=M.jBb;for(let N in S){var Q=S[N];Q&&M.nbn(K,Q)&&Array.add(L,Q)}return L}z2l(K){return M.ICo(K.displayName)}static nbn(K,
L){if(!L.bKf)return!1;for(const S of K.split(" ")){K=!1;for(const Q of L.bKf)if(Q.toLowerCase().startsWith(S.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static ICo(K){const L=[];for(const S of K.split(" ")){K=0;for(let Q=0;Q<S.length;Q++){const N=S.charAt(Q);N.toString().toUpperCase()===N.toString()&&Q>K&&(Array.add(L,S.substring(K,Q)),K=Q)}Array.add(L,S.substring(K,S.length));K&&Array.add(L,S.substring(0,S.length))}return L}}M.jBb=null;Object(D.a)(M,"AddinResultsProvider",null,[1307])},1742:function(D,
J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(225);class e{constructor(){this.Rob=this.Sob=this.r1a=this.Vkb=this.Qob=this.ihb=this.Tkb=this.R6a=this.jhb=this.Ukb=null;this.reset()}reset(){this.Ukb=new l.a;this.jhb=new l.a;this.R6a=new l.a;this.Tkb=new l.a;this.ihb=new l.a;this.Qob=new l.a;this.Vkb=new l.a;this.r1a=new l.a;this.r1a=new l.a;this.Sob=new l.a;this.Rob=new l.a}r3o(a){return this.NQa(this.Ukb,a)&&this.NQa(this.jhb,a)&&this.NQa(this.R6a,a)&&this.NQa(this.Tkb,a)&&this.NQa(this.ihb,
a)&&this.NQa(this.Qob,a)&&this.NQa(this.Vkb,a)&&this.NQa(this.r1a,a)&&this.NQa(this.Sob,a)&&this.NQa(this.Rob,a)}NQa(a,k){return!a||!a.length||a.length===k}}Object(D.a)(e,"MergeableTrackedChangesProperties",null,[])},1743:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(225),e=c(613);class a{constructor(){this.DKa=new l.a;this.DLa=new l.a;this.TNa=new l.a}get zBb(){return this.DKa}get Hkf(){return this.DLa}get Urb(){return this.TNa}get isEmpty(){return!this.DKa.length&&!this.DLa.length&&
!this.TNa.length}get Xmb(){return Math.max(Math.max(this.DKa.length,this.DLa.length),this.TNa.length)}get Men(){return Math.min(Math.min(this.DKa.length,this.DLa.length),this.TNa.length)}tDd(k){this.DKa.add(k)}vDd(k){this.DLa.add(k)}zDd(k){this.TNa.add(k)}JFl(){const k=new e.a,x=new l.a;let y=0;for(;y<this.DKa.length||y<this.DLa.length||y<this.TNa.length;)y<this.DKa.length&&!k.contains(this.DKa.J(y))&&(x.add(this.DKa.J(y)),k.add(this.DKa.J(y))),y<this.DLa.length&&!k.contains(this.DLa.J(y))&&(x.add(this.DLa.J(y)),
k.add(this.DLa.J(y))),y<this.TNa.length&&!k.contains(this.TNa.J(y))&&(x.add(this.TNa.J(y)),k.add(this.TNa.J(y))),y++;return x}}Object(D.a)(a,"ObjectCollection",null,[])},1744:function(D,J,c){c.d(J,"a",function(){return H});D=c(0);var l=c(1034),e=c(16),a=c(368),k=c(225);c(61);c(817);var x=c(613),y=c(184),n=c(189),t=c(1061),z=c(1421),v=c(1795),I=c(1586),E=c(1790);class H{constructor(M){this.jB=new t.a;this.FW=new a.a;this.Tjh=new a.a(0);this.Wgd=new k.a;this.lZg=new k.a;this.q8g=new k.a;this.D5g=new k.a;
this.A7g="";this.DXa=null;this.ys=this.cJe=0;this.Qtd=new a.a(0);this.tBe=this.Oah=this.Kqd=0;const {MarkerValidation:K}=c(1900);this._state=M;this.gbk=new K}get q0c(){return this.gbk}get R5i(){return this.DXa}Ioo(M){this.cJe=M}J3d(M,K){this.A7g=String.format("{0}-{1}",M,K)}Che(M){this.TYk();this.tBe=M}ueg(){this.tBe=0}TYk(){this.DXa&&this.Wgd.add(this.DXa);this.DXa=null}Rg(M){this.DXa||(this.DXa=M);switch(this.tBe){case 1:this.lZg.add(M);break;case 2:this.q8g.add(M);break;case 3:this.D5g.add(M);
break;default:this.DXa&&this.Wgd.add(M)}}AKi(M){this.Wgd.add(M)}a7m(){this.ys=this.vFa();this.Sia("MergeEnd")}Sia(M){const K=this.vFa();this.Tjh.Z(M,K-this.cJe);this.cJe=K}Gmo(){this.Kqd=this.vFa();this.Oah++}bV(M){const K=this.vFa();let L;({value:L}=this.Qtd.Fc(M)).returnValue?(L+=K-this.Kqd,this.Qtd.Z(M,L)):this.Qtd.Z(M,K-this.Kqd);this.Kqd=K}e5l(){this.FW.Z("Id",this._state.input.LLb.toString());this.FW.Z("Source",z.a[this._state.input.source]);this.FW.Z("RevSummary",H.iWa(this.Ccm()));this.FW.Z("NodesRolledBackIfFailed",
H.iWa(this.i7l()));if(!this._state.output.succeeded){let M,K,L,S,Q;({lKk:M,TBl:K,CSo:L,qKk:S,ESo:Q}=this.RDl(this._state.runtime));this.FW.Z("CharactersLost",this.ERl(M,K,L));this.FW.Z("CharactersLostInComments",this.ISl());this.FW.Z("CharactersLostInTables",this.bOl(Q,S))}this.FW.Z("FuncStep",this.A7g);this.FW.Z("FailureDetail",H.iWa(this.lGb()));this.FW.Z("FailDetailHints",this.XRd(this.lZg));this.FW.Z("FailDetailNaiveMerge",this.XRd(this.q8g));this.FW.Z("FailDetailLcs",this.XRd(this.D5g));this.FW.Z("ExtraDetails",
this.XRd(this.Wgd));this.FW.Z("Timeline",H.iWa(this.Tjh));this.FW.Z("ParagraphMergesCount",this.Oah);this.FW.Z("ParagraphMergeDurations",H.iWa(this.Qtd));this.FW.Z("MarkerInfo",H.iWa(this.q0c.f9h()));this.FW.Z("Result",H.iWa(this.g5l()));return JSON.stringify(H.iWa(this.FW))}vFa(){return(new Date).getTime()}Ccm(){const M=new a.a;let K,L,S;({Gmg:K,ptg:L,$Da:S}=this.psf(this._state,this._state.input.aaa,this._state.input.kWa,this._state.input.rIb));M.Z("hasBase",S?"true":"false");if(S){let Q=0,N=0;
for(;K&&!K.id.equals(S.id);)Q++,K=K.vX;for(;L&&!L.id.equals(S.id);)N++,L=L.vX;M.Z("lenToBaseTheirs",K?Q:-1);M.Z("lenToBaseYours",L?N:-1)}return M}psf(M,K,L,S){M=K.eg(K.length-1-(S?1:0));K=(L=L.eg(L.length-1))&&M?M.x2a(L):null;return{Gmg:M,ptg:L,$Da:K}}i7l(){if(!this._state.runtime.xsi)return null;const M=this._state.runtime.Mq,K=new a.a(0);M.forEach((L,S)=>{({value:L}=K.Fc(S.Oc.toString()));K.Z(S.Oc.toString(),L+1);return!0});return K}ERl(M,K,L){let S=null,Q=null,N=null;const O=this._state.runtime.Mq;
let X=0;try{N=new E.a(this.jB,this._state);S=I.b(M,K,L);Q=new x.a;for(M=0;M<S.length;M++)if(!S.J(M).zBb.Cq(S.J(M).Urb,(U,T)=>U.equals(T))){const U=this.iTh(S.J(M),N);X+=U;Q.add(S.J(M))}S&&O.forEach((U,T)=>{if(393230===T.Oc){T=null;for(let Y=0;Y<S.length;Y++)if(!Q.contains(S.J(Y))&&S.J(Y).Urb.contains(U,(aa,ba)=>aa===ba)){T=S.J(Y);break}T&&(U=this.iTh(T,N),Q.add(T),X+=U)}return!0});return X}catch(U){return y.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+U.toString()),-1}}RDl(M){let K,
L,S,Q,N;M.gH=X=>{if(750<this.vFa()-this._state.input.$Ua)throw y.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",X),n.a.invalidOperation(X);};K=new k.a;L=new k.a;S=new k.a;Q=new k.a;const O=new k.a;N=new k.a;try{if(M.uk){const X=M.uk.J(v.ChildNodeListMerge.b$d);let U,T;U=M.Nu.J(v.ChildNodeListMerge.b$d)||X;T=M.Mq.J(v.ChildNodeListMerge.b$d)||X;this.hlf(X,Y=>M.uk.J(Y),K,Q);this.hlf(U,Y=>M.Nu.J(Y)||M.uk.J(Y),L,O);this.hlf(T,Y=>M.Mq.J(Y)||M.uk.J(Y),S,N)}}catch(X){y.a.instance.Ua(573089732,
1,2,"Exception in FindAllParagraphAndTableIds: "+X.toString())}return{lKk:K,TBl:L,CSo:S,qKk:Q,ESo:N}}bOl(M,K){try{let S=0;const Q=this._state.runtime;var L=X=>Q.Mq.J(X)||Q.uk.J(X);const N=new x.a,O=this.DFl(M,Q,L,N);for(M=0;M<O.count;M++){let X=O.keys.J(M);const U=O.J(X);if(!N.contains(X)){let T=this.Dii(Q,L,N,X,U);if(-1!==T)S+=T;else return y.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(L=0;L<K.length;L++){let X=K.J(0);if(!N.contains(X)){let U=
this.iVd(Q.uk.J(X));if(-1===U)return y.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;S+=U}}return S}catch(S){return y.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+S.toString()),-1}}Dii(M,K,L,S,Q){M.gH("GetTableCharactersLost");let N=0;Q=this.jB.getPropertyObjectIds(Q,e.a.gf);for(let Y=0;Y<Q.length;Y++){var O=K(Q.J(Y));O=this.jB.getPropertyObjectIds(O,e.a.gf);for(let aa=0;aa<O.length;aa++){var X=K(O.J(aa));if(M.uk.J(Q.J(Y))&&
M.uk.J(O.J(aa))){var U=M.uk.J(O.J(aa));if(!U)return y.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;X=this.jB.getPropertyObjectIds(U,e.a.gf);var T=M.Nu.J(O.J(aa))||M.uk.J(O.J(aa));T=this.jB.getPropertyObjectIds(T,e.a.gf);U=this.jB.getPropertyObjectIds(U,e.a.gf);X=I.b(X,T,U);for(U=0;U<X.length;U++){T=X.J(U);const ba=this.rhm(M,K,L,T);if(-1===ba)return y.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",T.toString()),-1;N+=ba}}else{U=this.fim(K,X,L);if(-1===
U)return y.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",X.id.toString()),-1;N+=U}}}L.add(S);return N}rhm(M,K,L,S){let Q=0;var N=new k.a,O=new k.a;const X=new a.a;new a.a;for(var U=0;U<S.zBb.length;U++){var T=M.uk.J(S.zBb.J(U));T=this.jB.getPropertyObjectIds(T,e.a.bL);if(1!==T.length)return y.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",T.length),-1;var Y=M.uk.J(T.J(0));393230===Y.Oc?N.add(Y):393250===Y.Oc&&X.add(T.J(0),Y)}for(U=0;U<S.Urb.length;U++){T=
K(S.Urb.J(U));T=this.jB.getPropertyObjectIds(T,e.a.bL);if(1!==T.length)return y.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",T.length),-1;Y=K(T.J(0));if(393230===Y.Oc)O.add(Y);else if(393250===Y.Oc){Y=this.Dii(M,K,L,T.J(0),Y);if(-1===Y)return y.a.instance.Ua(573089741,1,2,"Error diffing table {0}",T.J(0).toString()),-1;Q+=Y}}U=new E.a(this.jB,this._state);if(0<N.length&&0<O.length){N=U.l0h(N,aa=>M.uk.J(aa),O,aa=>K(aa));if(-1===N)return y.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",
S.toString()),-1;Q+=N}else if(0<N.length)for(S=0;S<N.length;S++)Q+=this.jB.getPropertyString(N.J(S),e.a.ho).length+1;else if(0<O.length)for(S=0;S<O.length;S++)Q+=this.jB.getPropertyString(O.J(S),e.a.ho).length+1;for(S=0;S<X.count;S++)if(N=X.keys.J(S),!L.contains(N)){O=this.iVd(X.J(N));if(-1===O)return y.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",N.toString()),-1;Q+=O}return Q}fim(M,K,L){let S=0;K=this.jB.getPropertyObjectIds(K,e.a.gf);for(let O=0;O<K.length;O++){var Q=M(K.J(O));
Q=this.jB.getPropertyObjectIds(Q,e.a.bL);if(1!==Q.length)return y.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",Q.length),-1;var N=M(Q.J(0));if(393230===N.Oc)S+=this.jB.getPropertyString(N,e.a.ho).length+1;else if(393250===N.Oc){N=this.iVd(N);if(-1===N)return y.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",Q.J(0).toString()),-1;S+=N;L.add(Q.J(0))}}return S}iVd(M){this._state.runtime.gH("GetTextLengthOfTable");let K=0;const L=X=>this._state.runtime.Mq.J(X)||
this._state.runtime.uk.J(X);M=this.jB.getPropertyObjectIds(M,e.a.gf);for(let X=0;X<M.length;X++){var S=L(M.J(X));S=this.jB.getPropertyObjectIds(S,e.a.gf);for(let U=0;U<S.length;U++){var Q=L(S.J(U));Q=this.jB.getPropertyObjectIds(Q,e.a.gf);for(let T=0;T<Q.length;T++){var N=L(Q.J(T));N=this.jB.getPropertyObjectIds(N,e.a.bL);if(1!==N.length)return y.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var O=L(N.J(0));if(393230===O.Oc)K+=this.jB.getPropertyString(O,e.a.ho).length+
1;else if(393250===O.Oc){O=this.iVd(O);if(-1===O)return y.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",N.J(0)),-1;K+=O}}}}return K}DFl(M,K,L,S){const Q=new a.a;for(let N=0;N<M.length;N++){let O=!1;K.Mq.J(M.J(N))&&(O=!0);const X=L(M.J(N)),U=this.jB.getPropertyObjectIds(X,e.a.gf);if(!O)for(let T=0;T<U.length;T++)if(K.Mq.J(U.J(T))){O=!0;break}O?Q.add(M.J(N),X):S.add(M.J(N))}return Q}iTh(M,K){return this.hTh(M.zBb,M.Urb,K)}hTh(M,K,L){const S=new k.a;for(var Q=0;Q<M.length;Q++)S.add(this._state.runtime.uk.J(M.J(Q)));
M=new k.a;for(Q=0;Q<K.length;Q++)M.add(this._state.runtime.Mq.J(K.J(Q))||this._state.runtime.uk.J(K.J(Q)));return L.l0h(S,N=>this._state.runtime.uk.J(N),M,N=>this._state.runtime.Mq.J(N)||this._state.runtime.uk.J(N))}hlf(M,K,L,S){if(393227===M.Oc){M=this.jB.getPropertyObjectIds(M,e.a.gf);for(let Q=0;Q<M.length;Q++){const N=this.jB.getPropertyObjectIds(K(M.J(Q)),e.a.gf);for(let O=0;O<N.length;O++){const X=this.jB.getPropertyObjectIds(K(N.J(O)),e.a.gf);for(let U=0;U<X.length;U++){const T=this.jB.getPropertyObjectIds(K(X.J(U)),
e.a.bL);if(1!==T.length)return;const Y=K(T.J(0));393230===Y.Oc?L.add(T.J(0)):393250===Y.Oc?S.add(T.J(0)):y.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[Y.Oc])}}}}}ilf(M,K){M=this.jB.getPropertyObjectIds(M,e.a.gf);const L=new k.a;for(let S=0;S<M.length;S++){const Q=this.jB.getPropertyObjectIds(K(M.J(S)),e.a.bL);if(1!==Q.length)return null;L.add(Q.J(0))}return L}ISl(){let M=0;const K=this._state.runtime,L=K.Mq,S=N=>K.Mq.J(N)||K.uk.J(N);let Q=null;K.gH=N=>{if(750<this.vFa()-
this._state.input.$Ua)throw y.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",N),n.a.invalidOperation(N);};try{L.forEach((N,O)=>{if(1074135127===O.Oc){N=this.ilf(O,S);var X=K.uk.J(O.id);if(X)X=this.ilf(X,T=>K.uk.J(T)),Q||(Q=new E.a(this.jB,this._state)),M+=this.hTh(X,N,Q);else for(X=0;X<N.length;X++)M+=this.jB.getPropertyString(K.Mq.J(N.J(X)),e.a.ho).length+1}if(1074135126===O.Oc&&(N=this.jB.getPropertyObjectIds(O,e.a.gf).hH(),O=K.uk.J(O.id)))for(O=this.jB.getPropertyObjectIds(O,
e.a.gf),X=0;X<O.length;X++)if(!N.contains(O.J(X))){var U=K.uk.J(O.J(X));U=this.ilf(U,T=>K.uk.J(T));for(let T=0;T<U.length;T++)M+=this.jB.getPropertyString(K.uk.J(U.J(T)),e.a.ho).length+1}return!0})}catch(N){return y.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+N.toString()),-1}return M}lGb(){return this.DXa?this.DXa.lGb():null}XRd(M){const K=new k.a;M.forEach(L=>{K.add(H.iWa(L.lGb()));return!0});return K.toArray()}g5l(){const M=new a.a;M.Z("Succeeded",this._state.output.succeeded);
M.Z("Timeout",this._state.output.timeout);M.Z("Crash",this._state.output.crash);M.Z("MergedRevisions",this._state.output.aN?this._state.output.aN.length:-1);M.Z("Duration",this.ys-this._state.input.$Ua);return M}static iWa(M){if(!M)return null;const K={};M.forEach((L,S)=>{K[L.toString()]=S;return!0});return K}}Object(D.a)(H,"MergeLogger",null,[])},1745:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.bKa=a;this.updateHints=e}}Object(D.a)(l,"UpdateHintCollection",
null,[])},1746:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1587);class l extends c.a{constructor(e,a){super();this.Bg=e;this.Wc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(D.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1747:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(225);c=c(1587);class e extends c.a{constructor(a){super();this.y0=new l.a;this.cp=a}get type(){return 11}toString(){let a=
"";for(let k=0;k<this.y0.length;k++)a+=String.format("({0}), ",this.y0.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(e,"LcsInsertUpdateHint",c.a,[])},1748:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1587);class l extends c.a{constructor(e,a){super();this.text=a;this.Bg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.Bg,this.text)}}Object(D.a)(l,"LcsInsertTextUpdateHint",c.a,[])},
1749:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1587);class l extends c.a{constructor(e,a,k){super();this.cp=e;this.Bg=a;this.Wc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(D.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1750:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1587);class l extends c.a{constructor(e,a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",
this.cp,this.type,this.text)}}Object(D.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1751:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1560);class l extends c.a{constructor(){super()}get vha(){return"Conflict"}}Object(D.a)(l,"ConflictMergeFailureDetail",c.a,[])},1752:function(D,J,c){c.r(J);c.d(J,"InsightsMenuItemFactory",function(){return k});D=c(0);var l=c(1521),e=c(163),a=c(19);class k{constructor(x=null){this.H7j=x||CommonUIStrings.l_InsightsButtonText}get xPb(){return 10}aha(x){var y=
x.gD;x=l.a.Npa()?l.a.ePa(y,1):l.a.ADb(y);y=String.format(this.H7j,y);return this.tLl(x,y)}tLl(x,y){return e.a(k.Nti,l.a.Npa()?"1914896509":"3317204163",a.a.zf(y),l.a.$Cf,null,a.a.zf(x),a.a.zf(y),null,null)}}k.Nti="bInsights";Object(D.a)(k,"InsightsMenuItemFactory",null,[1306])},1753:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(163),e=c(19);class a{constructor(k,x,y,n,t){this.eSe=k;this.dSe=x;this.Mmk=y;this.h6j=n;this.XZg=t}get xPb(){return 4}aha(k,x=null){x=x.sessionId+"|"+x.tpa+
"|"+k.gD;if(this.XZg||this.h6j){let y=this.XZg||e.a.ZA(CommonUIStrings.l_HelpTooltip)===e.a.ZA(k.gD.trim());if(this.Mmk&&2<k.gD.length){const n=k.gD;";"===n.charAt(0)&&";"===n.charAt(n.length-1)&&n.substring(1,n.length-1)===a.Qzf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.gD);return this.B4h(x,e.a.zf(k),y)}return this.B4h(x,e.a.zf(String.format(CommonUIStrings.l_TextWithQuotation,k.gD)),!1)}B4h(k,x,y){return l.a(a.Qzf,y?this.dSe:this.eSe,
x,"OfficeAssistant_16x16x32","A0",e.a.zf(k),x,null,null)}}a.Qzf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[1306])},1754:function(D,J,c){c.d(J,"a",function(){return x});D=c(0);var l=c(2),e=c(163),a=c(90),k=c(19);class x{get xPb(){return 13}aha(){return x.aOk()}static aOk(){return e.b(x.q1h,"798637440",k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Ms,a.getImageClass("Info_32x32x32"),null,null,k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.q1h="bTellMeFirstRun";Object(D.a)(x,"FirstRunMenuItemFactory",null,[1306])},1755:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(2),e=c(163),a=c(19);class k{constructor(x=null,y=null){this.N8g=x;this.wck=y||CommonUIStrings.l_LookupNoResultsDescription}get xPb(){return 14}aha(x){x=String.format(this.wck,x.gD);return this.POk(x)}POk(x){return e.b(k.dSi,"798637440",a.a.zf(CommonUIStrings.l_LookupNoResultsTitle),
this.N8g?l.AFrameworkApplication.Ms:null,this.N8g,null,null,a.a.zf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.zf(x),null,null)}}k.dSi="lookupNoResults";Object(D.a)(k,"NoCommandsFoundMenuItemFactory",null,[1306])},1756:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(D.a)(l,"LabelFormatted",null,[])},1757:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);c(1524);var l=c(1526),
e=c(1529),a=c(1528),k=c(1521),x=c(19);class y{constructor(n){this.fc=n}qL(){return"Assistance"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:this.fc.Y2c?3:2}eI(n,t,z=!1,v,I=null){v=new a.a(n);if((!I||Array.contains(I,8))&&!k.a.GR(n)){I=new e.a(8);if(z){z=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(n.Fg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Fg);const E=[];this.fc.f5a&&(this.fc.Xie||E.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),z=this.xdi(n.Fg));const H="||"+n.Fg;E.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));E.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(E);n=new l.a("GetHelpFromTellMe",4,n.Fg,null,1)}else n=new l.a("bSearchHelp",4,n.Fg,null,1);I.Ww(n);I.displayName=CommonUIStrings.l_HelpButtonTitle;v.gv(I)}t.resultsUpdated(v)}akb(n,t=null){const z=new e.a(8),v=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(n.Fg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,n.Fg);for(let E=0;E<t.length&&2>E;E++){var I=void 0;I=[];let H="GetHelpWithDescriptionFromTellMe"+(E+1).toString(),M=4;if(this.fc.L$c)I.push(appChrome.actions.setControlLabel(H,v)),I.push(appChrome.actions.setCompoundButtonCommandValueId(H,n.Fg)),I.push(appChrome.actions.updateCompoundButtonDescription(H,this.nwf(t.length)));else if(this.fc.M$c){let K=this.Oji(t[E]);H="GetHelpFromTellMe"+(E+1).toString();this.fc.f5a&&(K=this.xdi(K));M=9;I.push(appChrome.actions.setControlLabel(H,
K));I.push(appChrome.actions.setButtonCommandValueId(H,this.Yim(t[E])))}appChrome.api.dispatch(I);I=new l.a(H,M,null,null,0);I.label=this.Oji(t[E]);I.description=this.Xim(t[E]);z.Ww(I);if(this.fc.M$c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}nwf(n){return 1===n?String.format(CommonUIStrings.l_SearchResultText,n):String.format(CommonUIStrings.l_SearchResultsText,n)}xdi(n){return this.fc.BIf?k.a.trf(n,CommonUIStrings.l_HelpScopedButtonText):n+CommonUIStrings.l_HelpScopedButtonText}Oji(n){return n.name?
n.name:""}Xim(n){return n.description?n.description:""}Yim(n){return n.id?"AssetID="+n.id:""}}Object(D.a)(y,"AssistanceResultsProvider",null,[1307])},1758:function(D,J,c){c.d(J,"a",function(){return n});D=c(0);c(1524);var l=c(1526),e=c(1529),a=c(1528),k=c(1522),x=c(1521),y=c(1559);class n{constructor(t){this.fc=t}qL(){return"Image"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:3===this.fc.kv?3:2}eI(t,z,v,I,E=null){v=new a.a(t);(!E||Array.contains(E,19))&&x.a.GR(t)&&this.fc.XP&&this.akb(t,v,1);z.resultsUpdated(v)}akb(t,
z,v,I=null){var E=[];let H;k.TellMeActor.instance.aP()&&k.TellMeActor.instance.aP().f5a?(H=this.fc.BIf?x.a.trf(t.Fg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):t.Fg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Xie||E.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.fc.XP?x.a.GR(t)?this.fc.rfb?x.a.Uib(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:
this.fc.rfb?x.a.Uib(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,t.Fg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,t.Fg):this.fc.Slc?CommonUIStrings.l_TellMeImageSuggestionButtonText:t.Fg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.exa?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),E=x.a.ePa(t.Fg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
E))):(E.push(appChrome.actions.setControlLabel("ImageForSearch",H)),t=x.a.ePa(t.Fg,9,Object.assign(new y.a,{landingTab:"Image"})),E.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",t)),appChrome.api.dispatch(E));v=new l.a("ImageForSearch",12,null,null,v);I&&(v.score=I.ConfidenceScore);I=new e.a(19,this.fc.Slc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);I.Ww(v);z.gv(I)}}Object(D.a)(n,"ImageResultsProvider",null,[1307])},1759:function(D,J,c){c.d(J,"a",function(){return y});
D=c(0);c(1524);var l=c(1526),e=c(1529),a=c(1528),k=c(1521),x=c(2);class y{constructor(n){this.fc=n}qL(){return"Template"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:3}eI(n,t){n=new a.a(n);t.resultsUpdated(n)}akb(n,t,z){var v=[];let I;I=this.fc.XP?this.fc.rfb?k.a.Uib(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,n.Fg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,n.Fg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,n.Fg);v.push(appChrome.actions.setControlLabel("TemplateForSearch",
I));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(x.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,n.Fg)));appChrome.api.dispatch(v);n=new e.a(23);n.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new l.a("TemplateForSearch",24,null,null,0);v.label=z[0].Title?z[0].Title:"";v.description=z[0].Description?z[0].Description:"";n.Ww(v);t.gv(n)}}Object(D.a)(y,"TemplateResultsProvider",null,[1307])},1760:function(D,
J,c){c.d(J,"a",function(){return z});D=c(0);c(1524);var l=c(1562),e=c(1526),a=c(1529),k=c(1528),x=c(1661),y=c(1522),n=c(1521),t=c(19);class z{constructor(v,I,E,H){this.s3=v;this.xeb=I;this.zkh=H;this.E3j=E;this.fc=y.TellMeActor.instance.aP()}qL(){return"EmptyQuery"}CU(){return 1===this.fc.kv?1:0}eI(v,I,E=!1,H,M=null){H=new k.a(v);if((!M||Array.contains(M,5)||Array.contains(M,6)||Array.contains(M,4))&&n.a.GR(v)){this.s3.nQc().length||!this.E3j||this.zkh||(v=new a.a(6),M=new e.a(null,13,void 0,void 0,
1),v.Ww(M),H.gv(v));v=new a.a(4);if(0<this.s3.nQc().length){v.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.s3.nQc();var K=[];for(var L of M)K.push(L.Id);l.CommandResultsUtility.Gdd(K,this.fc);for(var S of M)l.CommandResultsUtility.oWc(S.Id)&&v.Ww(new e.a(S.Id,5,null,null,2));H.gv(v)}if(this.zkh&&0<this.xeb.length&&this.s3.nQc().length<z.maxResults){L=new a.a(5);L.displayName=CommonUIStrings.l_TellMeTryQueryTitle;S=z.maxResults-v.results.length;v=[];for(M=0;M<this.xeb.length&&M<S;++M){if(E){K=
n.a.Dog+(M+1);const Q=this.xeb[M].key,N=t.a.replaceAll(Q,'"',"");v.push(appChrome.actions.setControlLabel(K,Q));v.push(appChrome.actions.setButtonCommandValueId(K,N));K=new x.a(Q,7,0,N,K)}else K=new x.a(this.xeb[M].key,7,0,this.xeb[M].value);L.Ww(K)}0<v.length&&appChrome.api.dispatch(v);H.gv(L)}}I.resultsUpdated(H)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",null,[1307])},1761:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.Jle=this.$Qa=this.ukb=this.Sx=
this.cFd=this.WF=this.ITb=0}}Object(D.a)(l,"TRIESCAN",null,[])},1763:function(D,J,c){c.d(J,"a",function(){return E});D=c(0);var l=c(2),e=c(406),a=c(714),k=c(401),x=c(736);c.n(x);var y=c(754);c.n(y);var n=c(53),t=c(774),z=c(372),v=c(371),I=c(7);c=c(260);class E extends c.a{constructor(H,M){super("SummaryGenerationCondition");this.pkg=-1;this.ekj=()=>{if(!E.Akg&&this.LTb.Lx>E.Pen){const K=a.a.getAugLoopRuntimeManager(),L=this.nQd();this.pkg=Date.now();K.submitOperation(Object.assign(new v.a,{operation:L}))}};
this.fkj=()=>{this.ekj();this.LTb.fee(this.fkj)};this.fob=K=>{K=K.items[0];x.TextSummaryAnnotation.typeGuard(K.body)||x.GptSummaryAnnotation.typeGuard(K.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(K.body)?(E.Akg=K.body,"Success"!==E.Akg.status?this.pg(!1):(this.pg(!0),this.R6m())):(I.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${n.a.getTypeNameFor(K.body)}`),this.pg(!1))};this.LTb=M.getInstance(0);this.Il=H.Il}static get summary(){return E.Akg}initialize(){super.initialize();
k.a.ll().then(()=>{const H=a.a.getAugLoopRuntimeManager();let M;M=this.Qzi()?x.GptSummaryAnnotation.getTypeName():this.dWc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();H.activateAnnotation(Object.assign(new e.a,{annotationType:M,handler:this.fob}))});-1===this.LTb.Lx?this.LTb.dfb(this.fkj):this.ekj()}Od(){super.Od()}dWc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Qzi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}nQd(){return this.Qzi()?Object.assign(new t.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.dWc()?Object.assign(new t.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new t.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}pg(H){super.pg(H);I.ULS.sendTraceTag(508944769,3028,50,this.FO(this.Il,H))}R6m(){if(-1!==this.pkg){var H=Date.now()-this.pkg;I.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",H)}}}E.Pen=300;Object(D.a)(E,"SummaryGenerationCondition",c.a,[])},1786:function(D,J,c){c.r(J);var l=c(0),e=c(1524),a=c(1572),k=c(1542),x=c(1526),y=c(1529),n=c(1528),t=c(1522),z=c(1521),v=c(1559);class I{constructor(hb){this.fc=
hb}qL(){return"ActionAI"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc=!1,Lc,Rc=null){Lc=new n.a(hb);if(!Rc||Array.contains(Rc,24))if(this.Ouo()||!z.a.GR(hb)){Rc=new y.a(24);var qd=z.a.GR(hb);gc&&(gc=null,z.a.Npa()&&(gc=z.a.ePa(qd?"":hb.Fg,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.fc.exa?gc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",gc)):(hb=[],gc&&hb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
gc)),appChrome.api.dispatch(hb)));Rc.Ww(new x.a("ActionAIFromTellMe",25,null,null,1));Lc.gv(Rc)}Ib.resultsUpdated(Lc)}Ouo(){return z.a.Npa()&&this.fc.HDf}}Object(l.a)(I,"ActionAIResultsProvider",null,[1307]);var E=c(1674);class H{constructor(hb,Ib){this.MAa=hb;this.Wk=Ib}resultsUpdated(hb){this.MAa.Eno(this.Wk,hb)}}Object(l.a)(H,"AggregatorResultsProviderCallback",null,[1309]);class M{constructor(hb){this.rsa=null;this.fc=hb;this.fc.rBb&&(this.rsa=null)}qL(){return"AppsForOffice"}CU(){return 0===
this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc,Lc,Rc=null){gc=new n.a(hb);if(!Rc||Array.contains(Rc,1))Rc=new y.a(1),this.rsa.ofp(Rc,hb.Fg),gc.gv(Rc);Ib.resultsUpdated(gc)}}Object(l.a)(M,"AppsForOfficeRecommendationResultsProvider",null,[1307]);var K=c(1757),L=c(1517),S=c(1536),Q=c(111);class N{constructor(hb,Ib){this.Bb=hb;this.X9m=Ib}isMatch(hb,Ib){if(!Object(Q.a)(1424,hb))throw Error.argument("objToTest","Expected feature bundle");let gc;return({value:gc}=hb.Lq(this.Bb.Xua)).returnValue?this.Bb.Nrg.isMatch(gc,
Ib):this.X9m}}Object(l.a)(N,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1451]);class O{constructor(hb,Ib){this.Bb=hb;this.HOf=Ib}isMatch(hb){if(!Object(Q.a)(1424,hb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.HOf^hb.Lq(this.Bb.Xua).returnValue)}}Object(l.a)(O,"AnnotatedWithAnnotationFilter",null,[1451]);class X{constructor(hb){this.Bb=hb}isMatch(hb,Ib){if(!Object(Q.a)(1427,hb))throw Error.argument("objToTest","Expected struct value");return this.Bb.Nrg.isMatch(hb.kjb(this.Bb.MPa),
Ib)}}Object(l.a)(X,"FieldValueMatchesStructFilter",null,[1451]);class U{constructor(hb,Ib){hb&&(this.MPa=hb.J(0),this.Nrg=Ib.Ioa(hb.J(1)))}}Object(l.a)(U,"FieldValueMatchesStructFilterInit",null,[]);class T{constructor(hb){this.HOf=hb}isMatch(hb){if(!Object(Q.a)(1424,hb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.HOf^hb.Zyf)}}Object(l.a)(T,"HasAnnotationsAnnotationFilter",null,[1451]);class Y{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib){if(!Object(Q.a)(1426,
hb))throw Error.argument("objToTest","Expected list value");switch(this.Q9){case 0:for(const gc of hb.items)if(this.Bb.filter.isMatch(gc,Ib))return!0;return!1;case 1:for(const gc of hb.items)if(!this.Bb.filter.isMatch(gc,Ib))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1451]);class aa{constructor(hb){this.Bb=hb}isMatch(hb,Ib){if(!Object(Q.a)(1426,hb))throw Error.argument("objToTest","Expected list value");return this.Bb.filter.isMatch(hb.items.length,
Ib)}}Object(l.a)(aa,"LengthMatchesListFilter",null,[1451]);class ba{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib,gc=null){let Lc=0===this.Q9;for(const Rc of this.Bb.wEh)if((Lc=Rc.isMatch(hb,Ib,gc))?1===this.Q9:0===this.Q9)return Lc;2===this.Q9&&(Lc=!Lc);return Lc}}Object(l.a)(ba,"NonterminalFilter",null,[1451]);class oa{constructor(hb,Ib){if(hb){var gc=hb.J(0);this.wEh=Array(gc);for(let Lc=0;Lc<gc;++Lc)this.wEh[Lc]=Ib.Ioa(hb.J(1+Lc))}}}Object(l.a)(oa,"NonterminalFilterInit",null,[]);class ma{constructor(hb,
Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib){if("number"!==typeof hb)throw Error.argument("objToTest","Expected number value");let gc=this.Bb.number;if(this.Bb.query){Ib=this.Bb.query.Pt(null,Ib);if("number"!==typeof Ib)throw Error.invalidOperation("Query did not return number");gc+=Ib}switch(this.Q9){case 0:return hb===gc;case 1:return hb<gc;case 2:return hb<=gc;case 3:return hb>gc;case 4:return hb>=gc;default:throw Error.notImplemented();}}}Object(l.a)(ma,"NumberFilter",null,[1451]);class ea{constructor(hb,
Ib){hb&&(this.number=hb.J(0),this.query=hb.J(1)?Ib.jL(hb.J(1)):null)}}Object(l.a)(ea,"NumberFilterInit",null,[]);class ua{constructor(hb,Ib,gc){this.YRd=this.hYl;this.c$m=hb;this.NMi=Ib;this.MMi=gc}H7e(hb){this.NMi=hb}hYl(hb){if(!hb)throw Error.argument("name","Invalid named feature bundle reference");const Ib=hb.substr(1);return 1===hb.charCodeAt(0)&&Ib===this.c$m?this.NMi:this.MMi?this.MMi.YRd(hb):null}}Object(l.a)(ua,"SimpleNamedFeatureBundleResolver",null,[1472]);class sa{constructor(hb){this.Bb=
hb}isMatch(hb,Ib){if(!Object(Q.a)(1424,hb))throw Error.argument("objToTest","Expected feature bundle");hb=this.Bb.query.Pt(null,new ua(this.Bb.xpe,hb,Ib));if("boolean"!==typeof hb)throw Error.invalidOperation("Query did not return bool");return hb}}Object(l.a)(sa,"PredicateAnnotationFilter",null,[1451]);class Fa{constructor(hb,Ib){hb&&(this.xpe=Ib.JB(hb.J(0)),this.query=Ib.jL(hb.J(1)))}}Object(l.a)(Fa,"PredicateAnnotationFilterInit",null,[]);class Pa{constructor(hb){this.Bb=hb}isMatch(hb,Ib){if("boolean"!==
typeof hb)throw Error.argument("objToTest","Expected bool value");Ib=this.Bb.query.Pt(null,Ib);if("boolean"!==typeof Ib)throw Error.invalidOperation("Query did not return bool");return hb===Ib}}Object(l.a)(Pa,"QueryBooleanFilter",null,[1451]);class Na{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib){if("number"!==typeof hb)throw Error.argument("objToTest","Expected integer");Ib=this.Bb.query.Pt(null,Ib);if("number"!==typeof Ib)throw Error.invalidOperation("Query did not return an enum value");
switch(this.Q9){case 0:return hb===Ib;case 1:return 0!==(hb&Ib);case 2:return hb===(hb&Ib);case 3:return Ib===(hb&Ib);default:throw Error.notImplemented();}}}Object(l.a)(Na,"QueryEnumFilter",null,[1451]);class Aa{constructor(hb,Ib){hb&&(this.o0d=1===hb.J(0),this.query=Ib.jL(hb.J(1)))}}Object(l.a)(Aa,"QueryEnumFilterInit",null,[]);class za{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib){if(!Object(Q.a)(1426,hb))throw Error.argument("objToTest","Expected list value");Ib=this.Bb.query.Pt(null,
Ib);if(!Object(Q.a)(1426,Ib))throw Error.invalidOperation("Query did not return list value");if(hb.i5!==Ib.i5)return!1;switch(this.Q9){case 0:return L.Annotations.nsb(L.Annotations.l4l(hb.i5),hb,Ib);case 1:for(const gc of hb.items)for(const Lc of Ib.items)if(L.Annotations.nsb(hb.i5,gc,Lc))return!0;return!1;case 2:for(const gc of hb.items)for(const Lc of Ib.items)if(!L.Annotations.nsb(hb.i5,gc,Lc))return!1;return!0;case 3:for(const gc of Ib.items)for(const Lc of hb.items)if(!L.Annotations.nsb(hb.i5,
gc,Lc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(za,"QueryListFilter",null,[1451]);class xa{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb,Ib){if("string"!==typeof hb)throw Error.argument("objToTest","Expected string");Ib=this.Bb.query.Pt(null,Ib);if("string"!==typeof Ib)throw Error.invalidOperation("Query did not return string");this.Bb.aEf&&(hb=hb.toUpperCase(),Ib=Ib.toUpperCase());switch(this.Q9){case 0:return hb===Ib;case 1:return 0<=hb.indexOf(Ib);case 2:return hb.startsWith(Ib);
case 3:return hb.endsWith(Ib);case 4:return 0<=Ib.indexOf(hb);case 5:return Ib.startsWith(hb);case 6:return Ib.endsWith(hb);default:throw Error.notImplemented();}}}Object(l.a)(xa,"QueryStringFilter",null,[1451]);class ka{constructor(hb,Ib){hb&&(this.query=Ib.jL(hb.J(0)),this.aEf=1===hb.J(1))}}Object(l.a)(ka,"QueryStringFilterInit",null,[]);class wa{constructor(hb){this.Bb=hb}isMatch(hb,Ib){if(!Object(Q.a)(1427,hb))throw Error.argument("objToTest","Expected struct value");Ib=this.Bb.query.Pt(null,
Ib);if(!Object(Q.a)(1427,Ib))throw Error.invalidOperation("Query did not return struct value");return hb.isEqual(hb)}}Object(l.a)(wa,"QueryStructFilter",null,[1451]);class ia{constructor(hb){this.Bb=hb}isMatch(hb,Ib){hb=this.Bb.query.Pt(null,Ib);if("boolean"!==typeof hb)throw Error.invalidOperation("Query did not return bool");return hb}}Object(l.a)(ia,"QueryWhereConstraintFilter",null,[1451]);class va{constructor(hb){this.Bb=hb}isMatch(hb){if("string"!==typeof hb)throw Error.argument("objToTest",
"Expected string");return this.Bb.a7f.test(hb)}}Object(l.a)(va,"RegexStringFilter",null,[1451]);class na{constructor(hb,Ib){hb&&(this.a7f=Ib.P$b(hb.J(0)))}}Object(l.a)(na,"RegexStringFilterInit",null,[]);class Ca{constructor(hb,Ib){hb&&(this.filter=Ib.Ioa(hb.J(0)))}}Object(l.a)(Ca,"SingleFilterFilterInit",null,[]);class ta{constructor(hb,Ib){hb&&(this.query=Ib.jL(hb.J(0)))}}Object(l.a)(ta,"SingleQueryFilterInit",null,[]);class fa{constructor(hb){this.Bb=hb}isMatch(hb){if("boolean"!==typeof hb)throw Error.argument("objToTest",
"Expected bool value");return hb===this.Bb.value}}Object(l.a)(fa,"StoredValueBooleanFilter",null,[1451]);class Xa{constructor(hb){hb&&(this.value=1===hb.J(0))}}Object(l.a)(Xa,"StoredValueBooleanFilterInit",null,[]);class ob{constructor(hb,Ib){this.Bb=hb;this.Q9=Ib}isMatch(hb){if("number"!==typeof hb)throw Error.argument("objToTest","Expected integer");switch(this.Q9){case 0:return this.Bb.o0d?this.Bb.value?!!(hb&this.Bb.value):!hb:hb===this.Bb.value;case 1:return this.Bb.o0d?(hb&this.Bb.value)===
this.Bb.value:32>hb&&(1<<hb&this.Bb.value)===this.Bb.value;case 2:return this.Bb.o0d?!!(hb&this.Bb.value):32>hb&&!!(1<<hb&this.Bb.value);default:throw Error.notImplemented();}}}Object(l.a)(ob,"StoredValueEnumFilter",null,[1451]);class xb{constructor(hb){hb&&(this.o0d=1===hb.J(0),this.value=hb.J(1))}}Object(l.a)(xb,"StoredValueEnumFilterInit",null,[]);class zb{constructor(){this.jBn=null;this.r6e=this.oIb=0}}Object(l.a)(zb,"WHEREConstraintData",null,[]);class Lb{constructor(hb){this.Bb=hb}isMatch(hb,
Ib){if(!Object(Q.a)(zb,hb))throw Error.argument("objToTest","Expected WHERE constraint data");let gc=-1,Lc=-1;const Rc=hb.jBn;switch(this.Bb.q7e){case 4:gc=Rc.NOc;Lc=Rc.Nig;break;case 5:gc=hb.oIb;Lc=Rc.NOc-hb.oIb;break;case 6:gc=Rc.NOc+Rc.Nig;Lc=hb.oIb+hb.r6e-gc;break;case 1:case 2:case 3:let qd=!1;for(let Ld=Rc.xgp;Ld;Ld=Ld.next)if(this.Bb.Y1o===Ld.name){qd=!0;1===this.Bb.q7e?(gc=Ld.NOc,Lc=Ld.Nig):2===this.Bb.q7e?(gc=hb.oIb,Lc=Ld.NOc-hb.oIb):(gc=Ld.NOc+Ld.Nig,Lc=hb.oIb+hb.r6e-gc);break}if(!qd)return!1;
break;case 7:gc=hb.oIb;Lc=hb.r6e;break;default:throw Error.notImplemented();}return null!==this.Bb.KCo.Okp(Rc.Qtp,gc,Lc,gc,!0,2,Ib)}}Object(l.a)(Lb,"SubSreWhereConstraintFilter",null,[1451]);class Ia{constructor(hb,Ib){if(hb){var gc=Ib.JB(hb.J(0));this.q7e=gc.charCodeAt(0);this.Y1o=gc.substr(1);this.KCo=Ib.pdm(hb.J(1))}}}Object(l.a)(Ia,"SubSreWhereConstraintFilterInit",null,[]);class Ya{constructor(hb){this.Bb=hb}isMatch(hb,Ib,gc=null){if(!Object(Q.a)(1424,hb))throw Error.argument("objToTest","Expected feature bundle");
if(null==gc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.lth&&!this.Bb.lth.isMatch(hb,Ib))return!1;if(this.Bb.rmg){let Lc;if(({value:Lc}=hb.Lq(this.Bb.CBo)).returnValue){if(!this.Bb.rmg.isMatch(Lc,Ib))return!1}else{let Rc,qd;if(!({value:Rc}=hb.Lq(this.Bb.Zuj)).returnValue||!({value:qd}=hb.Lq(this.Bb.Yuj)).returnValue||0>Rc||0>qd||Rc+qd>gc.length||!this.Bb.rmg.isMatch(gc.substr(Rc,qd),Ib))return!1}}if(this.Bb.Ovj){let Lc;if(!({value:Lc}=hb.Lq(this.Bb.Zuj)).returnValue||!this.Bb.Ovj.isMatch(Lc,
Ib))return!1}if(this.Bb.qHi){let Lc;if(!({value:Lc}=hb.Lq(this.Bb.Yuj)).returnValue||!this.Bb.qHi.isMatch(Lc,Ib))return!1}return!0}}Object(l.a)(Ya,"TextSpanFilter",null,[1451]);class eb{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.Zuj=hb.J(0),this.Yuj=hb.J(1),this.CBo=hb.J(2),this.rmg=hb.J(3)?Ib.Ioa(hb.J(3)):null,this.lth=hb.J(4)?Ib.Ioa(hb.J(4)):null,this.Ovj=hb.J(5)?Ib.Ioa(hb.J(5)):null,this.qHi=hb.J(6)?Ib.Ioa(hb.J(6)):null)}}Object(l.a)(eb,"TextSpanFilterInit",null,[]);class sb{constructor(hb,
Ib){hb&&(this.annotations=Ib.annotations,this.Xua=hb.J(0),this.Nrg=hb.J(1)?Ib.Ioa(hb.J(1)):null)}}Object(l.a)(sb,"ValueFilterAnnotationFilterInit",null,[]);var lc=c(1546);class vb{Ioa(hb,Ib){const gc=hb.J(0),Lc=new lc.a;Lc.Iib(hb,1,hb.count-1);switch(gc){case 1:return new ba(new oa(Lc,Ib),0);case 2:return new ba(new oa(Lc,Ib),1);case 3:return new ba(new oa(Lc,Ib),2);case 101:return new va(new na(Lc,Ib));case 103:return new xa(new ka(Lc,Ib),0);case 104:return new xa(new ka(Lc,Ib),1);case 105:return new xa(new ka(Lc,
Ib),2);case 106:return new xa(new ka(Lc,Ib),3);case 107:return new xa(new ka(Lc,Ib),4);case 108:return new xa(new ka(Lc,Ib),5);case 109:return new xa(new ka(Lc,Ib),6);case 201:return new fa(new Xa(Lc));case 202:return new Pa(new ta(Lc,Ib));case 301:return new ma(new ea(Lc,Ib),0);case 302:return new ma(new ea(Lc,Ib),1);case 303:return new ma(new ea(Lc,Ib),2);case 304:return new ma(new ea(Lc,Ib),3);case 305:return new ma(new ea(Lc,Ib),4);case 401:return new ob(new xb(Lc),0);case 402:return new ob(new xb(Lc),
1);case 403:return new ob(new xb(Lc),2);case 404:return new Na(new Aa(Lc,Ib),0);case 405:return new Na(new Aa(Lc,Ib),1);case 406:return new Na(new Aa(Lc,Ib),2);case 407:return new Na(new Aa(Lc,Ib),3);case 501:return new X(new U(Lc,Ib));case 502:return new wa(new ta(Lc,Ib));case 601:return new Y(new Ca(Lc,Ib),0);case 602:return new Y(new Ca(Lc,Ib),1);case 603:return new aa(new Ca(Lc,Ib));case 604:return new za(new ta(Lc,Ib),0);case 605:return new za(new ta(Lc,Ib),1);case 606:return new za(new ta(Lc,
Ib),2);case 607:return new za(new ta(Lc,Ib),3);case 701:return new T(!1);case 702:return new T(!0);case 703:return new O(new sb(Lc,Ib),!1);case 704:return new O(new sb(Lc,Ib),!0);case 705:return new N(new sb(Lc,Ib),!1);case 706:return new N(new sb(Lc,Ib),!0);case 707:return new sa(new Fa(Lc,Ib));case 901:return new Ya(new eb(Lc,Ib));case 1002:return new ia(new ta(Lc,Ib));case 1001:return new Lb(new Ia(Lc,Ib));default:throw Error.argument("initData");}}}Object(l.a)(vb,"FilterFactory",null,[1423]);
var Eb=c(1523);class Ua{constructor(hb){this.Bb=hb}get eE(){return this.Bb.eE}get I5(){return this.Bb.I5}get hle(){return this.Bb.hle}get TZd(){return this.Bb.TZd}load(hb,Ib){return this.Pt(hb,hb?new ua("root",hb,Ib):Ib)}store(hb,Ib,gc){this.Omc(hb,Ib,hb?new ua("root",hb,gc):gc,null)}Pt(hb,Ib){if(!this.TZd&&!this.Bb.annotations.qdc(this.eE,hb))throw Error.argument("input","Input value not of expected type");let gc=this.Bb.w1h;for(;gc;)hb=gc.load(hb,Ib),gc=gc.next;return hb}Omc(hb,Ib,gc,Lc){if(!this.hle)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.TZd&&!this.Bb.annotations.qdc(this.eE,hb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.qdc(this.I5,Ib))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.w1h.store(hb,Ib,gc,Lc)}static AGh(hb,Ib,gc,Lc){if(gc===Lc)return Ib;if(L.Annotations.uI(gc)&&L.Annotations.uI(Lc)){gc=L.Annotations.W2a(gc);Lc=L.Annotations.W2a(Lc);const Rc=new Eb.a(hb,Lc);for(const qd of Ib.items)Array.add(Rc.items,Ua.AGh(hb,qd,gc,Lc));return Rc}if(gc===
L.Annotations.VJa){if(Lc===L.Annotations.Vra)return Ib;if(Lc===L.Annotations.baa)return Ib.toString()}else if(gc===L.Annotations.Vra){if(Lc===L.Annotations.VJa)return Math.floor(Ib);if(Lc===L.Annotations.baa)return Ib.toString()}else if(gc===L.Annotations.baa){if(Lc===L.Annotations.VJa)return parseInt(Ib);if(Lc===L.Annotations.Vra)return parseFloat(Ib)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(Ua,"AnnotationQuery",null,[1456]);class Ta{constructor(){this.I5=
this.eE=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}a3a(hb){if(this.next)return{returnValue:this.next,pJa:hb};if(hb){const Ib=hb.RJh;hb=hb.r4i;return{returnValue:Ib,pJa:hb}}return{returnValue:null,pJa:hb}}}Object(l.a)(Ta,"AnnotationQueryStep",null,[1478]);class Nb extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=this.Bb.query.Pt(hb,Ib);if(L.Annotations.uI(this.eE)){var gc=L.Annotations.W2a(this.eE);let Rc=new Eb.a(this.Bb.annotations,gc);if(L.Annotations.uI(this.Bb.query.I5)){if(hb.items.length!==
Ib.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let qd=0,Ld=hb.items.length;qd<Ld;++qd)Array.add(Rc.items,this.kFd(hb.items[qd],Ib.items[qd],gc===L.Annotations.Vra))}else for(var Lc of hb.items)Array.add(Rc.items,this.kFd(Lc,Ib,gc===L.Annotations.Vra));return Rc}if(L.Annotations.uI(this.Bb.query.I5)){Lc=new Eb.a(this.Bb.annotations,this.eE);for(gc of Ib.items)Array.add(Lc.items,this.kFd(hb,gc,this.eE===L.Annotations.Vra));return Lc}return this.kFd(hb,
Ib,this.eE===L.Annotations.Vra)}kFd(hb,Ib,gc){hb=this.r4b(hb,Ib);return gc?hb:Math.floor(hb)}}Object(l.a)(Nb,"NumericAnnotationQueryStep",Ta,[]);class Wa extends Nb{constructor(hb){super(hb)}r4b(hb,Ib){return hb+Ib}}Object(l.a)(Wa,"AddAnnotationQueryStep",Nb,[]);class Bb extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){if(this.eE===L.Annotations.mAa&&this.Bb.query.I5===L.Annotations.mAa){let Rc;if(({result:Rc}=this.ZBh(hb)).returnValue)return Rc}if(L.Annotations.uI(this.eE)){var gc=new Eb.a(this.Bb.annotations,
L.Annotations.mAa);Ib=this.Bb.query.Pt(hb,Ib);if(L.Annotations.uI(this.Bb.query.I5)){if(hb.items.length!==Ib.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Rc=0,qd=hb.items.length;Rc<qd;++Rc)Array.add(gc.items,this.KJc(Ib.items[Rc],hb.items[Rc]))}else for(var Lc of hb.items)Array.add(gc.items,this.KJc(Ib,Lc));return gc}Lc=this.Bb.query.Pt(hb,Ib);if(L.Annotations.uI(this.Bb.query.I5)){Ib=new Eb.a(this.Bb.annotations,L.Annotations.mAa);for(gc of Lc.items)Array.add(Ib.items,
this.KJc(gc,hb));return Ib}return this.KJc(Lc,hb)}}Object(l.a)(Bb,"BinaryBooleanAnnotationQueryStep",Ta,[]);class Ob extends Bb{constructor(hb){super(hb)}ZBh(hb){return{returnValue:!hb,result:!1}}KJc(hb,Ib){return hb&&Ib}}Object(l.a)(Ob,"AndAnnotationQueryStep",Bb,[]);class hc{constructor(hb){hb&&(this.annotations=hb)}}Object(l.a)(hc,"AnnotationsOnlyQueryStepInit",null,[]);class Gc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=this.Bb.query.Pt(hb,Ib);hb=hb.clone();L.Annotations.uI(this.Bb.query.I5)?
Array.addRange(hb.items,Ib.items):Array.add(hb.items,Ib);return hb}}Object(l.a)(Gc,"AppendAnnotationQueryStep",Ta,[]);class bc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){if(this.eE===L.Annotations.SV)return this.WNc(hb,Ib);const gc=new Eb.a(this.Bb.annotations,L.Annotations.SV);for(const Lc of hb.items)Array.add(gc.items,this.WNc(Lc,Ib));return gc}WNc(hb,Ib){const gc=new S.a(this.Bb.annotations);gc.S0a(hb);hb=new S.a(this.Bb.annotations);this.Bb.script.DPa(null,new ua("Input",gc,new ua("Output",
hb,Ib)));return hb}}Object(l.a)(bc,"ApplyAnnotationQueryStep",Ta,[]);class Dc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){if(this.eE===L.Annotations.SV)return Ib=this.WNc(hb,Ib),Ib.Lq(this.Bb.jth).returnValue||new Eb.a(this.Bb.annotations,L.Annotations.SV),Ib;const gc=new Eb.a(this.Bb.annotations,L.Annotations.SV);for(const Lc of hb.items)if(hb=this.WNc(Lc,Ib),({value:hb}=hb.Lq(this.Bb.jth)).returnValue)for(const Rc of hb.items)Array.add(gc.items,Rc);return gc}WNc(hb,Ib){const gc=new S.a(this.Bb.annotations);
gc.S0a(hb);hb=new S.a(this.Bb.annotations);this.Bb.script.DPa(null,new ua("Input",gc,new ua("Output",hb,Ib)));return hb}}Object(l.a)(Dc,"ApplyExpandAnnotationQueryStep",Ta,[]);class Ub{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.script=Ib.MFb(hb.J(0)),this.jth=hb.J(1))}}Object(l.a)(Ub,"ApplyExpandQueryStepInit",null,[]);class Fc{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.script=Ib.MFb(hb.J(0)))}}Object(l.a)(Fc,"ApplyQueryStepInit",null,[]);class Sa extends Ta{constructor(hb){super();
this.Bb=hb}load(hb){if(this.eE===L.Annotations.SV)return this.i3d(hb);const Ib=new Eb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Xua));for(const gc of hb.items)Array.add(Ib.items,this.i3d(gc));return Ib}store(hb,Ib,gc,Lc){if(this.eE===L.Annotations.SV){var Rc=Ib,qd=({pJa:Lc}=this.a3a(Lc)).returnValue;qd&&(Rc=qd.store(L.Annotations.$T(this.i3d(hb)),Ib,gc,Lc));hb.ez(this.Bb.Xua,Rc)}else{var Ld=Ib;if(Rc=({pJa:Lc}=this.a3a(Lc)).returnValue){Ld=new Eb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Xua));
for(qd of hb.items)Array.add(Ld.items,this.i3d(qd));Ld=Rc.store(Ld,Ib,gc,Lc)}Ib=Ld;if(Ib.items.length!==hb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let zd=0,pf=hb.items.length;zd<pf;++zd)gc=hb.items[zd],gc.isReadOnly&&(gc=gc.clone(),hb.items[zd]=gc),gc.ez(this.Bb.Xua,Ib.items[zd])}return hb}i3d(hb){({value:hb}=hb.Lq(this.Bb.Xua)).returnValue||(hb=this.Bb.annotations.$Ol(this.Bb.Xua));return hb}}Object(l.a)(Sa,"AttrAnnotationQueryStep",Ta,
[]);class wb{constructor(hb,Ib){hb&&(this.annotations=Ib,this.Xua=hb.J(0))}}Object(l.a)(wb,"AttrQueryStepInit",null,[]);class Tb extends Ta{constructor(hb){super();this.Bb=hb}load(hb){const Ib=new S.a(this.Bb.annotations);Ib.S0a(hb);return this.Bb.module.execute(Ib)}}Object(l.a)(Tb,"CallModuleAnnotationQueryStep",Ta,[]);class Hb{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.module=Ib.Wsf(hb.J(0)))}}Object(l.a)(Hb,"CallModuleQueryStepInit",null,[]);class $a extends Ta{constructor(hb){super();
this.Bb=hb}load(hb,Ib){if(L.Annotations.uI(this.eE)){var gc=this.Bb.query.Pt(hb,Ib);Ib=new Eb.a(this.Bb.annotations,L.Annotations.baa);let qd="string"===typeof gc;for(var Lc of hb.items)if(qd)Array.add(Ib.items,Lc+gc);else for(var Rc of gc.items)Array.add(Ib.items,Lc+Rc);return Ib}Lc=this.Bb.query.Pt(hb,Ib);if("string"===typeof Lc)return hb+Lc;Rc=new Eb.a(this.Bb.annotations,L.Annotations.baa);for(gc of Lc.items)Array.add(Rc.items,hb+gc);return Rc}}Object(l.a)($a,"ConcatAnnotationQueryStep",Ta,[]);
class ab extends Ta{constructor(hb){super();this.Bb=hb}load(hb){return Ua.AGh(this.Bb.annotations,hb,this.eE,this.I5)}}Object(l.a)(ab,"ConvertAnnotationQueryStep",Ta,[]);class rb extends Ta{constructor(){super()}load(hb){return hb.items.length}}Object(l.a)(rb,"CountAnnotationQueryStep",Ta,[]);class cb extends Nb{constructor(hb){super(hb)}r4b(hb,Ib){return hb/Ib}}Object(l.a)(cb,"DivideAnnotationQueryStep",Nb,[]);class rc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=new ua(this.Bb.xpe,
null,Ib);for(const gc of hb.items)if(Ib.H7e(gc),this.Bb.query.Pt(gc,Ib))return!0;return!1}}Object(l.a)(rc,"ExistsAnnotationQueryStep",Ta,[]);class Rb extends Nb{constructor(hb){super(hb)}r4b(hb,Ib){return Math.pow(hb,Ib)}}Object(l.a)(Rb,"ExpAnnotationQueryStep",Nb,[]);class fb{constructor(hb,Ib){hb&&(this.LPa=Ib.JB(hb.J(0)))}}Object(l.a)(fb,"FeatureBundleNameQueryStepInit",null,[]);class Pb extends Ta{constructor(hb){super();this.Bb=hb}load(hb){if(L.Annotations.uI(this.eE)){const Ib=new Eb.a(this.Bb.annotations,
this.Bb.annotations.lHb(L.Annotations.W2a(this.eE),this.Bb.MPa));for(const gc of hb.items)Array.add(Ib.items,gc.kjb(this.Bb.MPa));return Ib}return hb.kjb(this.Bb.MPa)}store(hb,Ib,gc,Lc){if(L.Annotations.uI(this.eE)){var Rc=Ib,qd=({pJa:Lc}=this.a3a(Lc)).returnValue;if(qd){Rc=new Eb.a(this.Bb.annotations,this.Bb.annotations.lHb(L.Annotations.W2a(this.eE),this.Bb.MPa));for(var Ld of hb.items)Array.add(Rc.items,Ld.kjb(this.Bb.MPa));Rc=qd.store(Rc,Ib,gc,Lc)}Ib=Rc;if(Ib.items.length!==hb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let zd=0,pf=hb.items.length;zd<pf;++zd)gc=hb.items[zd],gc.isReadOnly&&(gc=gc.clone(),hb.items[zd]=gc),gc.Ldg(this.Bb.MPa,Ib.items[zd])}else qd=Ib,(Ld=({pJa:Lc}=this.a3a(Lc)).returnValue)&&(qd=Ld.store(L.Annotations.$T(hb.kjb(this.Bb.MPa)),Ib,gc,Lc)),hb.Ldg(this.Bb.MPa,qd);return hb}}Object(l.a)(Pb,"FieldAnnotationQueryStep",Ta,[]);class Ec{constructor(hb,Ib){hb&&(this.annotations=Ib,this.MPa=hb.J(0))}}Object(l.a)(Ec,"FieldQueryStepInit",null,[]);class uc extends Ta{constructor(hb){super();this.Bb=
hb}load(hb,Ib){for(const gc of hb.items)if(this.Bb.filter.isMatch(gc,Ib))return gc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(hb,Ib,gc,Lc){let Rc=Ib,qd=-1;for(let zd=0,pf=hb.items.length;zd<pf;zd++)if(this.Bb.filter.isMatch(hb.items[zd],gc)){qd=zd;break}if(0>qd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Ld=({pJa:Lc}=this.a3a(Lc)).returnValue;Ld&&(Rc=Ld.store(L.Annotations.$T(hb.items[qd]),Ib,gc,Lc));
hb.items[qd]=Rc;return hb}}Object(l.a)(uc,"FirstItemMatchingAnnotationQueryStep",Ta,[]);class ya extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=new ua(this.Bb.xpe,null,Ib);for(const gc of hb.items)if(Ib.H7e(gc),!this.Bb.query.Pt(gc,Ib))return!1;return!0}}Object(l.a)(ya,"ForAllAnnotationQueryStep",Ta,[]);class db extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){hb=Ib?Ib.YRd(this.Bb.LPa):null;if(!hb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.LPa+
'"');return hb}store(hb,Ib,gc,Lc){hb=gc?gc.YRd(this.Bb.LPa):null;if(!hb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.LPa+'"');let Rc=Ib;const qd=({pJa:Lc}=this.a3a(Lc)).returnValue;qd&&(Rc=qd.store(hb,Ib,gc,Lc));hb!==Rc&&hb.S0a(Rc);return hb}}Object(l.a)(db,"GetAnnotationQueryStep",Ta,[]);class tb{constructor(hb,Ib){this.X_j=hb;this.hgk=Ib}get RJh(){return this.X_j}get r4i(){return this.hgk}}Object(l.a)(tb,"AnnotationQueryStoreContinuation",null,[1482]);class Xb extends Ta{constructor(hb){super();
this.Bb=hb}load(hb,Ib){return this.Bb.bme.Pt(hb,Ib)?this.Bb.xCj.Pt(hb,Ib):this.Bb.oOd?this.Bb.oOd.Pt(hb,Ib):hb}store(hb,Ib,gc,Lc){var Rc=this.Bb.bme.Pt(hb,gc);this.next&&(Lc=new tb(this.next,Lc));if(Rc)return this.Bb.xCj.Omc(hb,Ib,gc,Lc);if(this.Bb.oOd)return this.Bb.oOd.Omc(hb,Ib,gc,Lc);Rc=Ib;let qd=null;Lc&&(qd=Lc.RJh,Lc=Lc.r4i);qd&&(Rc=qd.store(L.Annotations.$T(hb),Ib,gc,Lc));return Rc}}Object(l.a)(Xb,"IfAnnotationQueryStep",Ta,[]);class $b{constructor(hb,Ib){hb&&(this.bme=Ib.jL(hb.J(0)),this.xCj=
Ib.jL(hb.J(1)),this.oOd=hb.J(2)?Ib.jL(hb.J(2)):null)}}Object(l.a)($b,"IfQueryStepInit",null,[]);class Ab{constructor(hb,Ib){hb&&(this.ozm=Ib.jL(hb.J(0)),this.sFi=Ib.jL(hb.J(1)))}}Object(l.a)(Ab,"IndexAndItemQueryStepInit",null,[]);class vc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){const gc=this.Bb.ozm.Pt(hb,Ib);Ib=this.Bb.sFi.Pt(hb,Ib);hb=hb.clone();if(0>gc||gc>hb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(L.Annotations.uI(this.Bb.sFi.I5))for(let Lc=
0;Lc<Ib.items.length;++Lc)Array.insert(hb.items,gc+Lc,Ib.items[Lc]);else Array.insert(hb.items,gc,Ib);return hb}}Object(l.a)(vc,"InsertAtAnnotationQueryStep",Ta,[]);class Sc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){return!(!Ib||!Ib.YRd(this.Bb.LPa))}}Object(l.a)(Sc,"IsDefinedAnnotationQueryStep",Ta,[]);class ed extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=this.AJ(hb,Ib);return hb.items[Ib]}store(hb,Ib,gc,Lc){const Rc=this.AJ(hb,gc);let qd=Ib;const Ld=({pJa:Lc}=this.a3a(Lc)).returnValue;
Ld&&(qd=Ld.store(L.Annotations.$T(hb.items[Rc]),Ib,gc,Lc));hb.items[Rc]=qd;return hb}AJ(hb,Ib){Ib=this.Bb.query.Pt(hb,Ib);if(0>Ib||Ib>=hb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ib}}Object(l.a)(ed,"ItemAnnotationQueryStep",Ta,[]);class pd extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){const gc=new Eb.a(this.Bb.annotations,L.Annotations.W2a(this.eE));for(const Lc of hb.items)this.Bb.filter.isMatch(Lc,Ib)&&Array.add(gc.items,Lc);return gc}}
Object(l.a)(pd,"ItemsMatchingAnnotationQueryStep",Ta,[]);class oc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){Ib=this.AJ(hb,Ib);return hb.items[hb.items.length-Ib-1]}store(hb,Ib,gc,Lc){const Rc=this.AJ(hb,gc);let qd=Ib;const Ld=({pJa:Lc}=this.a3a(Lc)).returnValue;Ld&&(qd=Ld.store(L.Annotations.$T(hb.items[hb.items.length-Rc-1]),Ib,gc,Lc));hb.items[hb.items.length-Rc-1]=qd;return hb}AJ(hb,Ib){Ib=this.Bb.query?this.Bb.query.Pt(hb,Ib):0;if(0>Ib||Ib>=hb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Ib}}Object(l.a)(oc,"LastItemAnnotationQueryStep",Ta,[]);class cd extends Ta{constructor(hb){super();this.Bb=hb}load(hb){if(L.Annotations.uI(this.eE)){const Ib=new Eb.a(this.Bb.annotations,L.Annotations.VJa);for(const gc of hb.items)Array.add(Ib.items,gc.length);return Ib}return hb.length}}Object(l.a)(cd,"LengthAnnotationQueryStep",Ta,[]);class Xc extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){if(L.Annotations.uI(this.eE)){const gc=new Eb.a(this.Bb.annotations,L.Annotations.mAa);
for(const Lc of hb.items)Array.add(gc.items,this.Bb.filter.isMatch(Lc,Ib));return gc}return this.Bb.filter.isMatch(hb,Ib)}}Object(l.a)(Xc,"MatchesAnnotationQueryStep",Ta,[]);class ic extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){return this.Bb.filter.isMatch(hb,Ib)}}Object(l.a)(ic,"MatchesAsListAnnotationQueryStep",Ta,[]);class Ac extends Nb{constructor(hb){super(hb)}r4b(hb,Ib){return hb%Ib}}Object(l.a)(Ac,"ModuloAnnotationQueryStep",Nb,[]);class wd extends Nb{constructor(hb){super(hb)}r4b(hb,
Ib){return hb*Ib}}Object(l.a)(wd,"MultiplyAnnotationQueryStep",Nb,[]);class Je extends Ta{constructor(hb){super();this.Bb=hb}load(hb){if(L.Annotations.uI(this.eE)){const Ib=new Eb.a(this.Bb.annotations,L.Annotations.mAa);for(const gc of hb.items)Array.add(Ib.items,!gc);return Ib}return!hb}}Object(l.a)(Je,"NotAnnotationQueryStep",Ta,[]);class Zd extends Bb{constructor(hb){super(hb)}ZBh(hb){return{returnValue:hb,result:!0}}KJc(hb,Ib){return hb||Ib}}Object(l.a)(Zd,"OrAnnotationQueryStep",Bb,[]);class le extends Ta{constructor(hb){super();
this.Bb=hb}load(hb,Ib){const gc=this.Bb.Fjg.Pt(hb,Ib);hb=this.Bb.wKc.Pt(hb,Ib);Ib=new Eb.a(this.Bb.annotations,L.Annotations.VJa);for(let Lc=0;Lc<hb;++Lc)Array.add(Ib.items,gc+Lc);return Ib}}Object(l.a)(le,"RangeAnnotationQueryStep",Ta,[]);class kc{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.filter=Ib.Ioa(hb.J(0)))}}Object(l.a)(kc,"SingleFilterQueryStepInit",null,[]);class kd{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.query=hb.J(0)?Ib.jL(hb.J(0)):null)}}Object(l.a)(kd,
"SingleOptionalQueryQueryStepInit",null,[]);class nd{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.query=Ib.jL(hb.J(0)))}}Object(l.a)(nd,"SingleQueryQueryStepInit",null,[]);class Ud{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.Fjg=Ib.jL(hb.J(0)),this.wKc=hb.J(1)?Ib.jL(hb.J(1)):null)}}Object(l.a)(Ud,"StartAndCountOrLengthQueryStepInit",null,[]);class Qd extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){let gc;({startIndex:Ib,length:gc}=this.KUd(hb,Ib));const Lc=
new Eb.a(this.Bb.annotations,hb.i5);for(let Rc=0;Rc<gc;++Rc)Array.add(Lc.items,hb.items[Ib+Rc]);return Lc}store(hb,Ib,gc,Lc){let Rc,qd;({startIndex:Rc,length:qd}=this.KUd(hb,gc));var Ld=Ib;const zd=({pJa:Lc}=this.a3a(Lc)).returnValue;if(zd){Ld=new Eb.a(this.Bb.annotations,hb.i5);for(let pf=0;pf<qd;++pf)Array.add(Ld.items,hb.items[Rc+pf]);Ld=zd.store(Ld,Ib,gc,Lc)}Ib=Ld;for(gc=0;gc<qd;++gc)Array.removeAt(hb.items,Rc);for(let pf=0,Jc=Ib.items.length;pf<Jc;++pf)Array.insert(hb.items,Rc+pf,Ib.items[pf]);
return hb}KUd(hb,Ib){let gc;gc=this.Bb.Fjg.Pt(hb,Ib);if(0>gc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ib=this.Bb.wKc?this.Bb.wKc.Pt(hb,Ib):hb.items.length-gc;if(0>Ib||gc+Ib>hb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:gc,length:Ib}}}Object(l.a)(Qd,"SublistAnnotationQueryStep",Ta,[]);class Gd extends Ta{constructor(hb){super();this.Bb=hb}load(hb,Ib){if(L.Annotations.uI(this.eE)){const gc=
new Eb.a(this.Bb.annotations,L.Annotations.baa);for(let Lc=0,Rc=hb.items.length;Lc<Rc;++Lc)Array.add(gc.items,this.sii(hb.items[Lc],Ib));return gc}return this.sii(hb,Ib)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}sii(hb,Ib){let gc;({startIndex:Ib,length:gc}=this.KUd(hb,Ib));return hb.substr(Ib,gc)}KUd(hb,Ib){let gc;gc=this.Bb.Fjg.Pt(hb,Ib);if(0>gc)throw Error.invalidOperation("Invalid start index in Substring() query step");Ib=this.Bb.wKc?this.Bb.wKc.Pt(hb,
Ib):hb.length-gc;if(0>Ib||gc+Ib>hb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:gc,length:Ib}}}Object(l.a)(Gd,"SubstringAnnotationQueryStep",Ta,[]);class of extends Nb{constructor(hb){super(hb)}r4b(hb,Ib){return hb-Ib}}Object(l.a)(of,"SubtractAnnotationQueryStep",Nb,[]);class Tf extends Ta{constructor(hb){super();this.Bb=hb}load(hb){const Ib=new Eb.a(this.Bb.annotations,L.Annotations.baa);for(let gc=0;gc<hb.length;++gc)Array.add(Ib.items,
hb.charAt(gc).toString());return Ib}}Object(l.a)(Tf,"ToCharListAnnotationQueryStep",Ta,[]);class uh extends Ta{constructor(hb){super();this.Bb=hb}load(hb){const Ib=new Eb.a(this.Bb.annotations,this.eE);Array.add(Ib.items,hb);return Ib}}Object(l.a)(uh,"ToListAnnotationQueryStep",Ta,[]);class Gh extends Ta{constructor(hb){super();this.Bb=hb}load(){return this.Bb.value}}Object(l.a)(Gh,"ValueAnnotationQueryStep",Ta,[]);class Dh{constructor(hb,Ib){if(hb){var gc=hb.J(0),Lc=1;this.value=({iia:Lc}=Ib.mPa(gc,
hb,Lc,null,null,null)).returnValue;L.Annotations.kLb(this.value)}}}Object(l.a)(Dh,"ValueQueryStepInit",null,[]);class lg{constructor(hb,Ib){hb&&(this.xpe=Ib.JB(hb.J(0)),this.query=Ib.jL(hb.J(1)))}}Object(l.a)(lg,"VarNameAndQueryQueryStepInit",null,[]);class xh{constructor(hb,Ib){this.lWg=null;if(hb){this.annotations=Ib.annotations;var gc=0;this.eE=hb.J(gc);++gc;this.I5=hb.J(gc);++gc;this.hle=1===hb.J(gc);++gc;this.TZd=1===hb.J(gc);++gc;var Lc=hb.J(gc);++gc;if(Lc){var Rc=gc,qd=gc+Lc,Ld=gc+2*Lc;gc+=
3*Lc;var zd=hb.count-gc,pf=null;for(let gg=0;gg<Lc;++gg){var Jc=gc+hb.J(Ld+gg);const dc=(gg===Lc-1?zd:hb.J(Ld+gg+1))-hb.J(Ld+gg),ng=new lc.a;ng.Iib(hb,Jc,dc);Jc=xh.x6l(hb.J(qd+gg),ng,Ib);Jc.eE=hb.J(Rc+gg);Jc.I5=gg===Lc-1?this.I5:hb.J(Rc+gg+1);pf?pf.next=Jc:this.lWg=Jc;pf=Jc}}}}get w1h(){return this.lWg}static x6l(hb,Ib,gc){switch(hb){case 1:return new db(new fb(Ib,gc));case 2:return new Sc(new fb(Ib,gc));case 3:return new Sa(new wb(Ib,gc.annotations));case 4:return new Pb(new Ec(Ib,gc.annotations));
case 5:return new Xb(new $b(Ib,gc));case 6:return new Xc(new kc(Ib,gc));case 43:return new ic(new kc(Ib,gc));case 45:return new bc(new Fc(Ib,gc));case 49:return new Dc(new Ub(Ib,gc));case 46:return new Gh(new Dh(Ib,gc.annotations));case 51:return new Tb(new Hb(Ib,gc));case 52:return new le(new Ud(Ib,gc));case 53:return new ab(new hc(gc.annotations));case 13:return new ed(new nd(Ib,gc));case 14:return new oc(new kd(Ib,gc));case 15:return new rb;case 18:return new uc(new kc(Ib,gc));case 16:return new ya(new lg(Ib,
gc));case 17:return new rc(new lg(Ib,gc));case 22:return new vc(new Ab(Ib,gc));case 24:return new Gc(new nd(Ib,gc));case 26:return new Qd(new Ud(Ib,gc));case 27:return new pd(new kc(Ib,gc));case 30:return new uh(new hc(gc.annotations));case 31:return new Gd(new Ud(Ib,gc));case 32:return new $a(new nd(Ib,gc));case 47:return new cd(new hc(gc.annotations));case 48:return new Tf(new hc(gc.annotations));case 34:return new Wa(new nd(Ib,gc));case 35:return new of(new nd(Ib,gc));case 36:return new wd(new nd(Ib,
gc));case 37:return new cb(new nd(Ib,gc));case 38:return new Ac(new nd(Ib,gc));case 39:return new Rb(new nd(Ib,gc));case 40:return new Ob(new nd(Ib,gc));case 41:return new Zd(new nd(Ib,gc));case 42:return new Je(new hc(gc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(xh,"AnnotationQueryInit",null,[]);class eg{constructor(hb){this.Bb=hb}execute(hb,Ib){this.DPa(hb,hb?new ua("root",hb,Ib):Ib)}DPa(hb,Ib){for(const gc of this.Bb.commands)Ib=gc.execute(hb,Ib)}}Object(l.a)(eg,
"AnnotationScript",null,[1455]);class cc{constructor(hb){this.Bb=hb}execute(hb,Ib){const gc=this.Bb.vDm.Pt(hb,Ib),Lc=this.Bb.dzn.Pt(hb,Ib);this.Bb.script.DPa(hb,new ua("Input",gc,new ua("Output",Lc,Ib)));return Ib}}Object(l.a)(cc,"ApplyAnnotationScriptCommand",null,[1475]);class Ic{constructor(hb,Ib){hb&&(this.vDm=Ib.jL(hb.J(0)),this.dzn=Ib.jL(hb.J(1)),this.script=Ib.MFb(hb.J(2)))}}Object(l.a)(Ic,"ApplyScriptCommandInit",null,[]);class Yc{constructor(hb){this.Bb=hb}execute(hb,Ib){const gc=this.Bb.ebg.Pt(hb,
Ib);this.Bb.$3d.Omc(hb,gc,Ib,null);return Ib}}Object(l.a)(Yc,"AssignAnnotationScriptCommand",null,[1475]);class ad{constructor(hb){this.Bb=hb}execute(hb,Ib){const gc=this.Bb.$3d.Pt(hb,Ib);hb=this.Bb.ebg.Pt(hb,Ib);gc!==hb&&gc.S0a(hb);return Ib}}Object(l.a)(ad,"CopyAnnotationScriptCommand",null,[1475]);class yd{constructor(hb){this.Bb=hb}execute(hb,Ib){let gc=this.Bb.NLf.Pt(hb,Ib);if(this.Bb.NLf.hle){gc=L.Annotations.$T(gc);var Lc=new ua(this.Bb.LPa,null,Ib);for(let qd=0,Ld=gc.items.length;qd<Ld;++qd){var Rc=
this.ZYh(hb,gc.items[qd],Lc);if(0>this.Bb.Uee)gc.items[qd]=Rc;else if(({value:Rc}=Rc.Lq(this.Bb.Uee)).returnValue)gc.items[qd]=Rc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.NLf.Omc(hb,gc,Ib,null)}else{Lc=new ua(this.Bb.LPa,null,Ib);for(let qd=0,Ld=gc.items.length;qd<Ld;++qd)this.ZYh(hb,gc.items[qd],Lc)}return Ib}ZYh(hb,Ib,gc){let Lc;0>this.Bb.Uee?Lc=L.Annotations.$T(Ib):(Lc=new S.a(this.Bb.annotations),Lc.ez(this.Bb.Uee,Ib));gc.H7e(Lc);
this.Bb.HLk.DPa(hb,gc);return Lc}}Object(l.a)(yd,"EnumerateAnnotationScriptCommand",null,[1475]);class ne{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.LPa=Ib.JB(hb.J(0)),this.NLf=Ib.jL(hb.J(1)),this.HLk=Ib.MFb(hb.J(2)),this.Uee=hb.J(3))}}Object(l.a)(ne,"EnumerateScriptCommandInit",null,[]);class Oe{constructor(hb){this.Bb=hb}execute(hb,Ib){this.Bb.bme.Pt(hb,Ib)?this.Bb.rPo.DPa(hb,Ib):this.Bb.d_h&&this.Bb.d_h.DPa(hb,Ib);return Ib}}Object(l.a)(Oe,"IfAnnotationScriptCommand",null,[1475]);
class nf{constructor(hb,Ib){hb&&(this.bme=Ib.jL(hb.J(0)),this.rPo=Ib.MFb(hb.J(1)),this.d_h=hb.J(2)?Ib.MFb(hb.J(2)):null)}}Object(l.a)(nf,"IfScriptCommandInit",null,[]);class wf{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.$3d=Ib.jL(hb.J(0)),this.ebg=Ib.jL(hb.J(1)))}}Object(l.a)(wf,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Ye{constructor(hb){this.Bb=hb}execute(hb,Ib){const gc=this.Bb.ebg.Pt(this.Bb.$3d.Pt(hb,Ib),Ib);this.Bb.$3d.Omc(hb,gc,Ib,null);return Ib}}Object(l.a)(Ye,
"ModifyAnnotationScriptCommand",null,[1475]);class Rg{constructor(hb){this.Bb=hb}execute(hb,Ib){const gc=new S.a(this.Bb.annotations);this.Bb.query&&gc.S0a(this.Bb.query.Pt(hb,Ib));return Ib=new ua(this.Bb.LPa,gc,Ib)}}Object(l.a)(Rg,"NewAnnotationScriptCommand",null,[1475]);class Db{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.LPa=Ib.JB(hb.J(0)),this.query=hb.J(1)?Ib.jL(hb.J(1)):null)}}Object(l.a)(Db,"NewScriptCommandInit",null,[]);class Zb{constructor(hb){this.Bb=hb}execute(hb,Ib){hb=
this.Bb.query.Pt(hb,Ib);if(this.Bb.query.I5===L.Annotations.SV)hb.VTa(this.Bb.Xua);else for(const gc of hb.items)gc.VTa(this.Bb.Xua);return Ib}}Object(l.a)(Zb,"RemoveAnnotationScriptCommand",null,[1475]);class xc{constructor(hb,Ib){hb&&(this.annotations=Ib.annotations,this.query=Ib.jL(hb.J(0)),this.Xua=hb.J(1))}}Object(l.a)(xc,"RemoveScriptCommandInit",null,[]);class Jd{constructor(hb,Ib){if(hb){var gc=0,Lc=hb.J(gc);++gc;if(Lc){var Rc=gc,qd=gc+Lc;gc+=2*Lc;var Ld=hb.count-gc;this.commands=Array(Lc);
for(let zd=0;zd<Lc;++zd){const pf=gc+hb.J(qd+zd),Jc=(zd===Lc-1?Ld:hb.J(qd+zd+1))-hb.J(qd+zd),gg=new lc.a;gg.Iib(hb,pf,Jc);this.commands[zd]=Jd.n6l(hb.J(Rc+zd),gg,Ib)}}}}static n6l(hb,Ib,gc){switch(hb){case 1:return new Yc(new wf(Ib,gc));case 2:return new Ye(new wf(Ib,gc));case 3:return new Zb(new xc(Ib,gc));case 6:return new Rg(new Db(Ib,gc));case 7:return new yd(new ne(Ib,gc));case 8:return new Oe(new nf(Ib,gc));case 9:return new ad(new wf(Ib,gc));case 10:return new cc(new Ic(Ib,gc));default:throw Error.argument("initData");
}}}Object(l.a)(Jd,"AnnotationScriptInit",null,[]);var ie=c(1672);class De{constructor(hb){this.z2=hb;this.py=0}t$(){const hb=this.z2.$y(this.py,4);this.py+=4;return hb}get L_(){return this.z2}get offset(){return this.py}set offset(hb){this.py=hb}}Object(l.a)(De,"ByteArrayReader",null,[]);class qf{constructor(){this.SJ=null;this.TMi=this.yda=0}J(hb){if(0>hb||hb>=this.yda)throw Error.argumentOutOfRange("index");return this.SJ.$y(this.TMi+4*hb,4)}get count(){return this.yda}static hbl(hb,Ib,gc){const Lc=
new qf;Lc.SJ=hb;Lc.TMi=Ib;Lc.yda=gc;return Lc}}Object(l.a)(qf,"ReadOnlyListOverByteArray",null,[1447]);class tg{constructor(hb,Ib){this.LMi=this.KMi=!1;this.Bw=this.zSa=this.wOf=this.OMi=null;try{this.Bw=Ib.annotations;const gc=Ib.Xib(hb.J(0)),Lc=new De(gc);if(-914743053!==Lc.t$())throw Error.argument("Input does not represent a flat lexicon");this.KMi=1===Lc.t$();this.LMi=1===Lc.t$();const Rc=Lc.t$();Lc.offset+=Rc;const qd=Lc.t$();this.wOf=tg.oBn(Lc,qd,this.Bw);const Ld=Lc.t$();this.OMi=tg.FBn(Lc,
Ld);const zd=Lc.t$();this.zSa=new ie.a(Lc.L_,Lc.offset);Lc.offset+=zd}catch(gc){throw Error.argument("initData");}}get trie(){return this.zSa}ZQl(hb){return"i"===hb&&this.LMi?"\u0130":hb.toUpperCase()}aEf(){return this.KMi}kOl(hb){let Ib;Ib=new Eb.a(this.Bw,L.Annotations.SV);if(1!==hb)if(0===hb)hb=new S.a(this.Bw),Array.add(Ib.items,hb);else if(hb&1073741824){hb=this.OMi[hb&-1073741825];for(let Lc=0;Lc<hb.length;++Lc){var gc=hb[Lc];gc=0===gc?new S.a(this.Bw):this.wOf[gc-2];Array.add(Ib.items,gc)}}else Array.add(Ib.items,
this.wOf[hb-2]);return{returnValue:!0,B1m:Ib}}static oBn(hb,Ib,gc){if(Ib%4)throw Error.argument("reader");const Lc=qf.hbl(hb.L_,hb.offset,Ib/4);hb.offset+=Ib;hb=[];for(Ib=0;Ib<Lc.count;){const Rc=({iia:Ib}=gc.mPa(L.Annotations.SV,Lc,Ib,null,null,null)).returnValue;Array.add(hb,Rc)}return hb}static FBn(hb,Ib){Ib=hb.offset+Ib;const gc=[];for(;hb.offset<Ib;){const Lc=hb.t$(),Rc=Array(Lc);for(let qd=0;qd<Lc;++qd){const Ld=hb.t$();Rc[qd]=Ld}Array.add(gc,Rc)}return gc}}Object(l.a)(tg,"RawFlatLexicon",null,
[1454]);var Ah=c(1662),ji=c(1663);class Bh{constructor(hb){if(null==hb)throw Error.argumentNull("base64String");const Ib=hb.length;if(Ib%4)throw Error.argument("base64String's length must be a multiple of 4");this.yda=.75*Ib;this.vLb=Array(Math.ceil(this.yda/4));hb.endsWith("==")?this.yda-=2:hb.endsWith("=")&&--this.yda;let gc=0;for(let Lc=0;Lc<Ib;Lc+=4){const Rc=Bh.Hfe[hb.charCodeAt(Lc)-43]<<18|Bh.Hfe[hb.charCodeAt(Lc+1)-43]<<12|Bh.Hfe[hb.charCodeAt(Lc+2)-43]<<6|Bh.Hfe[hb.charCodeAt(Lc+3)-43];let qd=
Rc>>16&255;this.vLb[Math.floor(gc/4)]|=qd<<gc%4*8;++gc;qd=Rc>>8&255;this.vLb[Math.floor(gc/4)]|=qd<<gc%4*8;++gc;qd=Rc&255;this.vLb[Math.floor(gc/4)]|=qd<<gc%4*8;++gc}}get length(){return this.yda}J(hb){if(0>hb||hb>=this.yda)throw Error.argumentOutOfRange("i");return this.v6h(hb)}$y(hb,Ib){if(0>hb||0>Ib||hb+Ib>this.yda)throw Error.argument("Bad range");let gc=0;for(let Lc=0;Lc<Ib;++Lc)gc|=this.v6h(hb+Lc)<<8*Lc;return gc}YQn(hb,Ib){let gc=0,Lc=0,Rc=Math.floor(hb/8);for(hb%=8;Lc<Ib;){const qd=8-hb>Ib-
Lc?Ib-Lc:8-hb,Ld=this.J(Rc);gc|=(Ld>>hb&~(255<<qd))<<Lc;Lc+=qd;++Rc;hb=0}return gc}v6h(hb){return this.vLb[Math.floor(hb/4)]>>hb%4*8&255}}Bh.Hfe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Bh,"ByteArray",null,[]);class Tj{constructor(hb,Ib,gc){this.hE=hb;this.Z9m=Ib;this.b$m=gc;this.aNi=Array(hb.b?hb.b.length:0);this.UOf=
new Ah.a(new ji.a(this.Xib(this.hE.s)));this.O9=Array(hb.t.length);this.tD=new L.Annotations(this.Tib(0),this)}get annotations(){return this.tD}get htl(){return this.hE.d}H5l(){if(!(""in this.hE.m))throw Error.argument("name","Unrecognized module");return this.Wsf(this.hE.m[""])}Xib(hb){if(0>hb||!this.hE.b||hb>=this.hE.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.aNi[hb]||(this.aNi[hb]=new Bh(this.hE.b[hb]))}JB(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.O9[hb]){const Ib=this.Tib(hb).J(0);this.O9[hb]=this.UOf.JB(Ib)}return this.O9[hb]}P$b(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.O9[hb]){var Ib=this.Tib(hb);const gc=this.JB(Ib.J(0));Ib=1===Ib.J(1);this.O9[hb]=new RegExp(gc,Ib?"i":"")}return this.O9[hb]}pdm(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Wsf(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not an NL module");return this.O9[hb]||(this.O9[hb]=this.b$m.b6l(this.Tib(hb),this))}jL(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.O9[hb]||(this.O9[hb]=new Ua(new xh(this.Tib(hb),this)))}MFb(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.O9[hb]||(this.O9[hb]=new eg(new Jd(this.Tib(hb),this)))}Ioa(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not a filter");return this.O9[hb]||(this.O9[hb]=
this.Z9m.Ioa(this.Tib(hb),this))}ybm(hb){if(1>hb||hb>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.hE.t[hb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.O9[hb]||(this.O9[hb]=new tg(this.Tib(hb),this))}Tib(hb){const Ib=this.hE.n[hb];hb=(hb<this.hE.t.length-1?this.hE.n[hb+1]:this.hE.n.length)-Ib;if(0>Ib||0>hb||Ib+hb>this.hE.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ib+","+hb+")");const gc=new lc.a;
gc.onf(this.hE.n,Ib,hb);return gc}}Object(l.a)(Tj,"ObjectFetcher",null,[1422]);class sf{constructor(hb,Ib,gc){if(!hb)throw Error.argumentNull("prediction");if(!Ib)throw Error.argumentNull("fieldNames");if(!gc)throw Error.argumentNull("values");if(Ib.length!==gc.length)throw Error.argument("values","fieldNames and values do not have same length");this.Xfk=hb;this.wLb=Ib;this.f0c=gc}get prediction(){return this.Xfk}get D_h(){return this.wLb.length}$qf(hb){return 0<=hb&&hb<this.wLb.length?this.wLb[hb]:
null}getValue(hb){return 0<=hb&&hb<this.f0c.length?this.f0c[hb]:null}}Object(l.a)(sf,"PredictionData",null,[]);class vf{constructor(hb,Ib){if(!hb)throw Error.argumentNull("predictions");if(!Ib)throw Error.argumentNull("tokenAttributes");this.e$m=hb;this.i$m=Ib}buf(){return this.e$m}o5h(){return this.i$m}}Object(l.a)(vf,"PredictionDataWithTokenAttributes",null,[]);class Sf{constructor(hb,Ib){this.prediction=null;this.score=0;this.prediction=hb;this.score=Ib}}Object(l.a)(Sf,"PredictionWithScore",null,
[]);class ah{constructor(hb,Ib){if(!hb)throw Error.argumentNull("predictions");if(!Ib)throw Error.argumentNull("attributes");this.Yfk=hb;this.dXj=Ib}buf(){return this.Yfk}o5h(){return this.dXj}}Object(l.a)(ah,"PredictionsWithTokenAttributes",null,[]);class mg{constructor(hb,Ib,gc){if(!hb)throw Error.argumentNull("attributeName");if(!Ib)throw Error.argumentNull("fieldNames");if(!gc)throw Error.argumentNull("values");if(Ib.length!==gc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.cXj=hb;this.wLb=Ib;this.f0c=gc}get attributeName(){return this.cXj}get D_h(){return this.wLb.length}$qf(hb){return 0<=hb&&hb<this.wLb.length?this.wLb[hb]:null}getValue(hb){return 0<=hb&&hb<this.f0c.length?this.f0c[hb]:null}}Object(l.a)(mg,"TokenAttributes",null,[]);var Bg=c(55),Cg=c(133);class ki{constructor(hb,Ib,gc,Lc,Rc){this.ufd=0;this.ttg=null;this.vfd=this.Vpc=0;this.Dqe=this.STb=this.ksa=this.Wpc=null;this.utg=0;this.QLe=this.sC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.AS=hb;this.OMj=this.SMj=Ib;this.NMj=this.QMj=gc;this.sfd=this.PMj=Lc;this.tfd=this.RMj=Rc}TMj(){this.vfd=0;return this.rtg}rtg(){if(!(this.vfd<this.sfd))return this.stg;this.Wpc=this.OMj.items[this.vfd+this.NMj];this.ksa=new S.a(this.AS.Bb.annotations);1!==this.sfd&&this.AS.Bb.kWc||this.ksa.S0a(this.Wpc);if(0<=this.AS.Bb.P5d){({value:this.STb}=this.ksa.Lq(this.AS.Bb.P5d)).returnValue?this.STb=this.STb.$T():this.STb=new Eb.a(this.AS.Bb.annotations,
L.Annotations.SV);this.Dqe=this.tfd.items;this.utg=this.Dqe.length;for(this.ufd=0;this.ufd<this.utg;++this.ufd)this.ttg=this.Dqe[this.ufd],Array.add(this.STb.items,this.ttg);this.ksa.ez(this.AS.Bb.P5d,this.STb)}else 0<=this.AS.Bb.yig?this.ksa.ez(this.AS.Bb.yig,this.tfd.items[0]):0<=this.AS.Bb.$4e?this.ksa.ez(this.AS.Bb.$4e,!0):this.AS.Bb.jBi?this.tfd.items[0].LPd((hb,Ib)=>this.ksa.ez(hb,Ib)):(this.ksa.S0a(this.tfd.items[0]),1!==this.sfd&&this.AS.Bb.kWc||(({value:this.Vpc}=this.Wpc.Lq(this.AS.Bb.b4)).returnValue&&
this.ksa.ez(this.AS.Bb.b4,this.Vpc),({value:this.Vpc}=this.Wpc.Lq(this.AS.Bb.c8)).returnValue&&this.ksa.ez(this.AS.Bb.c8,this.Vpc),this.Wpc.Lq(this.AS.Bb.wfb).returnValue&&this.ksa.ez(this.AS.Bb.wfb,this.Vpc)));this.sC=this.ksa;this._state=2;return this.VMj}stg(){this._state=3}UMj(){this.vfd++;return this.rtg}VMj(){return 1<this.sfd&&this.AS.Bb.kWc?this.stg:this.UMj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new ki(this.AS,this.SMj,this.QMj,this.PMj,this.RMj)).getEnumerator()}[Symbol.iterator](){return Object(Cg.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.QLe=this.TMj());for(;1===this._state;)this.QLe=this.QLe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.sC}}Object(l.a)(ki,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,78,84]);class Rh{constructor(hb,Ib,gc){this.c0c=this.UMi=0;this.Lfc=null;this.VOf=this.COf=this.Jfc=this.g4d=this.FOf=
0;this.h4d=!1;this.POf=hb;this.XOf=Ib;this.d$m=gc}gdi(){null===this.Lfc&&({xzj:this.Lfc,fqi:this.FOf,length:this.g4d,uBl:hb}=this.POf.Lji(this.XOf.items[this.c0c],this.d$m),this.h4d=hb||this.h4d);if(this.Jfc<this.g4d){var hb=this.Lfc.charAt(this.FOf+this.Jfc);++this.Jfc;return{returnValue:!0,ch:hb}}if(this.c0c===this.XOf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.c0c;this.Jfc=0;this.Lfc=null;return{returnValue:!0,ch:" "}}K7f(hb,Ib){this.Jfc===this.g4d&&this.Lfc&&(this.VOf=Ib,this.COf=
this.c0c-this.UMi+1)}z7n(hb){if(0>hb||hb>=this.XOf.items.length)throw Error.argumentOutOfRange("iToken");this.c0c=this.UMi=hb;this.Lfc=null;this.COf=this.Jfc=this.g4d=this.FOf=0;this.VOf=-1;this.h4d=!1}D4l(){return{yQk:this.COf,UZm:this.VOf,tBl:this.h4d}}}Object(l.a)(Rh,"TriePrefixVisitor",null,[1467]);class ml{constructor(hb){this.Bb=hb}execute(hb){if(!({value:gc}=hb.Lq(this.Bb.pOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ib;({value:Ib}=hb.Lq(this.Bb.X_a)).returnValue||
(Ib=null);var gc=this.pNl(gc,Ib);hb=L.Annotations.$T(hb);hb.ez(this.Bb.pOa,gc);return hb}pNl(hb,Ib){let gc=null;const Lc=this.Bb.flatLexicon.trie,Rc=new Rh(this,hb,Ib);let qd=null;this.Bb.flatLexicon.aEf()&&(qd=Object(Bg.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.ZQl,"getCaseInsensitiveForm"));let Ld=0,zd;var pf;let Jc;for(;Ld<hb.items.length;){const gg=hb.items[Ld];Rc.z7n(Ld);Lc.NKj(Rc,qd);({yQk:zd,UZm:pf,tBl:Jc}=Rc.D4l());if(0<zd){({B1m:pf}=this.Bb.flatLexicon.kOl(pf));for(let dc of this.gdl(hb,
Ld,zd,pf)){1<zd&&this.Bb.kWc&&this.$dl(hb,Ib,Ld,gg,zd,Jc,dc);if(!gc)for(gc=new Eb.a(this.Bb.annotations,L.Annotations.SV),pf=0;pf<Ld;++pf)Array.add(gc.items,hb.items[pf]);Array.add(gc.items,dc)}Ld+=zd}else gc&&Array.add(gc.items,gg),++Ld}return gc||hb}$dl(hb,Ib,gc,Lc,Rc,qd,Ld){if(qd)qd=!0;else if(this.Bb.SAi){qd=!1;var zd=-1;for(var pf=0;pf<Rc;pf++){var Jc=hb.items[gc+pf];let Sd;var gg=void 0;if(!({value:Sd}=Jc.Lq(this.Bb.b4)).returnValue||!({value:gg}=Jc.Lq(this.Bb.c8)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<pf){if(Sd>zd+1){qd=!0;break}if(0>zd||null===Ib||zd>=Ib.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ib.charAt(zd)){qd=!0;break}}zd=Sd+gg}}else qd=!1;if(qd){gg=new Sys.StringBuilder;for(qd=0;qd<Rc;++qd)({xzj:zd,fqi:pf,length:Jc}=this.Lji(hb.items[gc+qd],Ib)),0<qd&&gg.append(" "),gg.append(zd.substr(pf,Jc));Ld.ez(this.Bb.wfb,gg.toString())}hb=hb.items[gc+Rc-1];let dc,ng;({value:Lc}=Lc.Lq(this.Bb.b4)).returnValue&&
({value:dc}=hb.Lq(this.Bb.b4)).returnValue&&({value:ng}=hb.Lq(this.Bb.c8)).returnValue?(Ld.ez(this.Bb.b4,Lc),Ld.ez(this.Bb.c8,dc+ng-Lc)):(Ld.VTa(this.Bb.b4),Ld.VTa(this.Bb.c8))}gdl(hb,Ib,gc,Lc){return new ki(this,hb,Ib,gc,Lc)}Lji(hb,Ib){let gc,Lc;if(({value:gc}=hb.Lq(this.Bb.wfb)).returnValue)Lc=!0,Ib=0,hb=gc.length;else{Lc=!1;if(null===Ib)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");gc=Ib;if(!({value:Ib}=hb.Lq(this.Bb.b4)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:hb}=hb.Lq(this.Bb.c8)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ib||0>hb||Ib+hb>gc.length)throw Error.argument("Token start/length values out of range","token");}return{xzj:gc,fqi:Ib,length:hb,uBl:Lc}}}Object(l.a)(ml,"FlatLexiconNLModule",null,[1448]);class el{constructor(hb,Ib){this.$4e=this.P5d=this.yig=this.wfb=this.c8=this.b4=this.X_a=this.pOa=0;this.jBi=this.SAi=this.kWc=!1;this.flatLexicon=null;this.annotations=Ib.annotations;
let gc=0;try{this.pOa=hb.J(gc),++gc,this.X_a=hb.J(gc),++gc,this.b4=hb.J(gc),++gc,this.c8=hb.J(gc),++gc,this.wfb=hb.J(gc),++gc,this.yig=hb.J(gc),++gc,this.P5d=hb.J(gc),++gc,this.$4e=hb.J(gc),++gc,this.kWc=1===hb.J(gc),++gc,this.SAi=1===hb.J(gc),++gc,this.jBi=1===hb.J(gc),++gc,this.flatLexicon=Ib.ybm(hb.J(gc))}catch(Lc){throw Error.argument("initData");}}}Object(l.a)(el,"FlatLexiconNLModuleInit",null,[]);class Kl{constructor(){this.hUc=0;this.flf=null;this.P8c=0}}Object(l.a)(Kl,"FeatureGenStackRec",
null,[]);class ig{constructor(hb){this.rng=Array(hb);this.boc=Array(hb);this.Zjg=[];this.axj=[]}}Object(l.a)(ig,"TokenStringLattice",null,[]);const Mi=(hb,Ib,gc)=>{for(let Lc=0;Lc<hb.length;Lc++)gc=Ib(gc,hb[Lc]);return gc},fh=(hb,Ib)=>{const gc=Array(hb.length);for(let Lc=0;Lc<hb.length;Lc++)gc[Lc]=Ib(hb[Lc]);return gc},zf=(hb,Ib)=>{Ib=Array(Math.min(Ib,hb.length));for(let gc=0;gc<Ib.length;gc++)Ib[gc]=hb[gc];return Ib},Eh=(hb,Ib)=>{const gc=[];for(const Lc of hb)Ib(Lc)&&Array.add(gc,Lc);return gc};
class tl{constructor(hb,Ib){this.key=hb;this.value=Ib}}Object(l.a)(tl,"KeyValuePair",null,[]);const Nh=(hb,Ib)=>({returnValue:Ib in hb,value:hb[Ib]}),Uh=hb=>{const Ib=[];for(let gc in hb){const Lc=new tl(gc,hb[gc]);Array.add(Ib,Lc)}return Ib};class ok{constructor(hb){this.Kji=this.Nim;this.Bb=hb;this.k4d=this.MOf=this.NOf=0;for(const Ib of this.Bb.vOd)this.NOf=Math.max(this.NOf,Ib.p2f),this.MOf=Math.max(this.MOf,Ib.i2f),this.k4d=Math.max(this.k4d,Ib.Nqb.length)}get IDl(){return this.Bb.Rme.trie}execute(hb){if(!hb)throw Error.argumentNull("input");
let Ib,gc;({tokens:Ib,Z_m:gc}=this.Oim(hb));let Lc=null,Rc=null,qd={};if(this.Bb.RWc){Ib=L.Annotations.$T(Ib);for(var Ld=0;Ld<Ib.items.length;++Ld)Ib.items[Ld]=L.Annotations.$T(Ib.items[Ld])}else({l_h:Rc,returnValue:Lc}=this.Zdi(hb,qd));Ld=Array(this.k4d);const zd=Array(this.k4d);for(var pf=0;pf<zd.length;++pf)zd[pf]=new Kl;for(pf=-this.NOf;pf<Ib.items.length+this.MOf;++pf){let Jc=null;this.Bb.RWc&&(Jc=Ib.items[pf],qd={},{l_h:Rc,returnValue:Lc}=this.Zdi(Jc,qd));for(const gg of this.Bb.vOd){if(0>pf&&
-pf>gg.p2f||pf>=Ib.items.length&&pf-Ib.items.length+1>gg.i2f)continue;let dc=!0;for(let ng=0;ng<gg.Nqb.length;++ng){const Sd=pf+gg.Nqb[ng];Ld[ng]=Sd;if(0>Sd?0>this.Bb.q2f:Sd>=Ib.items.length?0>this.Bb.j2f:!gc.boc[Sd]){dc=!1;break}}dc&&({uhl:Lc,vhl:Rc}=this.XFm(gg,gc,Lc,Rc,qd,zd,Ld))}this.Bb.RWc&&(Jc.ez(this.Bb.D4a?this.Bb.F3b:this.Bb.D3b,Lc),this.Bb.D4a&&Jc.ez(this.Bb.E3b,Rc))}hb=L.Annotations.$T(hb);this.Bb.RWc?hb.ez(this.Bb.pOa,Ib):(hb.ez(this.Bb.D4a?this.Bb.F3b:this.Bb.D3b,Lc),this.Bb.D4a&&hb.ez(this.Bb.E3b,
Rc));return hb}Oim(hb){let Ib,gc;if(!hb||!({value:Ib}=hb.Lq(this.Bb.pOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Lc;({value:Lc}=hb.Lq(this.Bb.X_a)).returnValue||(Lc="");gc=new ig(Ib.items.length);const Rc=Eh(this.Bb.ung,qd=>!qd.jVc||qd.jVc.isMatch(hb,null));for(let qd=0;qd<Ib.items.length;++qd){const Ld=Ib.items[qd];let zd=null;gc.rng[qd]=gc.Zjg.length;let pf=gc.boc[qd]=0;for(const Jc of Rc)0<Jc.t0c&&gc.boc[qd]+pf>=Jc.t0c||Jc.ucd&&!Jc.ucd.isMatch(Ld,
null)||({wcd:zd,ZHc:pf}=Jc.apply(this,Ld,qd,gc,Lc,zd,pf))}return{tokens:Ib,Z_m:gc}}XFm(hb,Ib,gc,Lc,Rc,qd,Ld){let zd=0;qd[0].hUc=-1;for(qd[0].flf=hb.wgj;;){var pf=Ld[zd],Jc=0>pf||pf>=Ib.boc.length?1:Ib.boc[pf];let ng=!1;for(;qd[zd].hUc<Jc-1;){++qd[zd].hUc;var gg=void 0,dc=void 0;0>pf?(gg=this.Bb.q2f,dc=1):pf>=Ib.rng.length?(gg=this.Bb.j2f,dc=1):(dc=Ib.rng[pf]+qd[zd].hUc,gg=Ib.Zjg[dc],dc=Ib.axj[dc]);qd[zd].P8c=dc*(zd?qd[zd-1].P8c:hb.score);if(({value:gg}=Nh(qd[zd].flf,gg.toString())).returnValue){zd===
hb.Nqb.length-1?(pf=gg,qd[zd].P8c&&(({value:Jc}=Nh(Rc,pf.toString())).returnValue||(Jc=-1),0>Jc&&(gc=L.Annotations.$T(gc),Array.add(gc.items,pf)),this.Bb.D4a&&(Lc=L.Annotations.$T(Lc),0>Jc?Array.add(Lc.items,qd[zd].P8c):Lc.items[Jc]+=qd[zd].P8c),0>Jc&&(this.Bb.GEi||this.Bb.D4a)&&(Rc[pf.toString()]=gc.items.length-1))):(++zd,qd[zd].hUc=-1,qd[zd].flf=gg);ng=!0;break}}if(!ng&&(--zd,0>zd))break}return{uhl:gc,vhl:Lc}}Zdi(hb,Ib){let gc;if(({value:gc}=hb.Lq(this.Bb.D4a?this.Bb.F3b:this.Bb.D3b)).returnValue)for(let Lc=
0;Lc<gc.items.length;++Lc)Ib[gc.items[Lc].toString()]=Lc;else gc=new Eb.a(this.Bb.annotations,L.Annotations.VJa);if(this.Bb.D4a){if(({value:Ib}=hb.Lq(this.Bb.E3b)).returnValue||(Ib=new Eb.a(this.Bb.annotations,L.Annotations.Vra)),Ib.items.length!==gc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.Pea(L.Annotations.SV,hb));}else Ib=null;return{returnValue:gc,l_h:Ib}}get BMo(){return this.Bb.Rme}Nim(hb,
Ib){var gc;if(({value:gc}=Ib.Lq(this.Bb.wfb)).returnValue)hb=gc;else{if(!({value:gc}=Ib.Lq(this.Bb.b4)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ib}=Ib.Lq(this.Bb.c8)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>gc||0>Ib||gc+Ib>hb.length)throw Error.argument("Token indices are out of range");hb=hb.substr(gc,Ib)}return hb}}Object(l.a)(ok,"NGramNLModule",null,[1448,1449]);class pj{constructor(hb){this.Nqb=null;this.score=this.i2f=this.p2f=
0;this.wgj=null;if(hb){var Ib=0;try{if(hb.J(Ib)!==pj.YBb)throw Error.argument("initData","Input does not represent a feature template");++Ib;const gc=hb.J(Ib);++Ib;this.Nqb=Array(gc);for(let Lc=0;Lc<gc;++Lc)this.Nqb[Lc]=hb.J(Ib),++Ib;this.p2f=hb.J(Ib);++Ib;this.i2f=hb.J(Ib);++Ib;this.score=hb.J(Ib);++Ib;this.wgj=({$pi:Ib}=pj.d8i(hb,Ib)).returnValue}catch(gc){throw Error.argument("initData");}}}static d8i(hb,Ib){const gc=hb.J(Ib);++Ib;const Lc={};for(let Rc=0;Rc<gc;++Rc){const qd=hb.J(Ib);++Ib;hb.J(Ib)?
Lc[qd.toString()]=({$pi:Ib}=pj.d8i(hb,Ib)).returnValue:(++Ib,Lc[qd.toString()]=hb.J(Ib),++Ib)}return{returnValue:Lc,$pi:Ib}}}pj.YBb=240803228;Object(l.a)(pj,"FeatureTemplate",null,[1469]);var Ek=c(1623);class cj{constructor(hb,Ib){this.D4a=this.GEi=this.RWc=!1;this.wfb=this.c8=this.b4=this.pOa=this.X_a=this.E3b=this.F3b=this.D3b=0;this.Rme=null;this.j2f=this.q2f=0;this.vOd=this.ung=null;if(hb){this.annotations=Ib.annotations;var gc=0;try{this.RWc=1===hb.J(gc);++gc;this.GEi=1===hb.J(gc);++gc;this.D4a=
1===hb.J(gc);++gc;this.D3b=hb.J(gc);++gc;this.F3b=hb.J(gc);++gc;this.E3b=hb.J(gc);++gc;this.X_a=hb.J(gc);++gc;this.pOa=hb.J(gc);++gc;this.b4=hb.J(gc);++gc;this.c8=hb.J(gc);++gc;this.wfb=hb.J(gc);++gc;this.Rme=this.$Bn(Ib.Xib(hb.J(gc)));++gc;this.q2f=hb.J(gc);++gc;this.j2f=hb.J(gc);++gc;const Lc=hb.J(gc);++gc;this.ung=Array(Lc);for(let qd=0;qd<Lc;++qd){const Ld=hb.J(gc);++gc;const zd=this.Rme.trie,pf=new lc.a;pf.Iib(hb,gc,Ld);this.ung[qd]=this.cCn(pf,Ib,zd);gc+=Ld}const Rc=hb.J(gc);++gc;this.vOd=Array(Rc);
for(Ib=0;Ib<Rc;++Ib){const qd=hb.J(gc);++gc;const Ld=new lc.a;Ld.Iib(hb,gc,qd);this.vOd[Ib]=this.GBn(Ld);gc+=qd}}catch(Lc){throw Error.argument("initData");}}}$Bn(hb){return new Ah.a(new ji.a(hb))}cCn(hb,Ib,gc){return Ek.a.create(hb,Ib,gc)}GBn(hb){return new pj(hb)}}Object(l.a)(cj,"NGramNLModuleInit",null,[]);class Fi{constructor(hb){this.Bb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");hb=hb.clone();this.Bb.script.execute(hb,null);return hb}}Object(l.a)(Fi,"ScriptNLModule",null,[1448]);
class Yh{constructor(hb,Ib){hb&&(this.script=Ib.MFb(hb.J(0)))}}Object(l.a)(Yh,"ScriptNLModuleInit",null,[]);const rj=hb=>{hb=fh(hb,Ib=>Ib*Ib);return Math.sqrt(Mi(hb,(Ib,gc)=>Ib+gc,0))},Pm=hb=>Mi(hb,(Ib,gc)=>Ib>gc?Ib:gc,hb[0]);class Fk{constructor(hb){this.Bb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");var Ib=[],gc=[];this.b1k(hb,Ib,gc);this.KAk(Ib,gc);const Lc={};for(let qd=0;qd<Ib.length;++qd){var Rc=Ib[qd];const Ld=this.Bb.pui.J(Rc);Rc=this.Bb.qui.J(Rc);for(let zd=0;zd<Rc;++zd){const pf=
this.Bb.p8.J(this.Bb.FEh.J(Ld+zd)),Jc=this.Bb.GEh.J(Ld+zd);let gg;({value:gg}=Nh(Lc,pf)).returnValue||(gg=0);Lc[pf]=gg+gc[qd]*Jc}}gc=Uh(Lc);gc.sort((qd,Ld)=>{var zd=qd.value,pf=Ld.value;(zd=-(zd>pf?1:zd<pf?-1:0))||(zd=qd.key.localeCompare(Ld.key));return zd});Ib=new Eb.a(this.Bb.annotations,L.Annotations.SV);for(const qd of zf(gc,this.Bb.Cbn))gc=new S.a(this.Bb.annotations),gc.ez(this.Bb.MIk,qd.key),gc.ez(this.Bb.OIk,qd.value),Array.add(Ib.items,gc);hb.ez(this.Bb.NIk,Ib);return hb}b1k(hb,Ib,gc){if(({value:hb}=
hb.Lq(this.Bb.LIk)).returnValue){let Lc;if(({value:Lc}=hb.Lq(this.Bb.F3b)).returnValue){let Rc;if(!({value:Rc}=hb.Lq(this.Bb.E3b)).returnValue||Lc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.nHd(Lc,Rc,Ib,gc)}if(({value:Lc}=hb.Lq(this.Bb.QIk)).returnValue){let Rc;if(!({value:Rc}=hb.Lq(this.Bb.RIk)).returnValue||Lc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.nHd(Lc,Rc,Ib,gc)}({value:Lc}=hb.Lq(this.Bb.D3b)).returnValue&&this.nHd(Lc,null,Ib,gc);({value:Lc}=hb.Lq(this.Bb.PIk)).returnValue&&this.nHd(Lc,null,Ib,gc)}}nHd(hb,Ib,gc,Lc){for(let qd=0;qd<hb.items.length;++qd){var Rc=void 0;hb.i5===L.Annotations.baa?({value:Rc}=Nh(this.Bb.QVh,hb.items[qd])).returnValue||(Rc=-1):(Rc=hb.items[qd],Rc=Rc>=this.Bb.qQf&&Rc<=this.Bb.icn?this.Bb.lUf?this.Bb.lUf.J(Rc-this.Bb.qQf)-1:Rc-this.Bb.qQf:-1);if(0<=Rc){let Ld;Ld=Ib?Ib.items[qd]:1;0<Ld&&(Array.add(gc,Rc),Array.add(Lc,
Ld))}}}KAk(hb,Ib){if(hb.length){switch(this.Bb.mMn){case 0:break;case 1:for(var gc=0;gc<Ib.length;++gc)Ib[gc]=1+Math.log(Ib[gc]);break;case 2:gc=Pm(Ib);for(let Lc=0;Lc<Ib.length;++Lc)Ib[Lc]=.5+Ib[Lc]/gc*.5;break;case 3:for(gc=0;gc<Ib.length;++gc)Ib[gc]=1;break;default:throw Error.notImplemented();}if(this.Bb.MYd)for(gc=0;gc<Ib.length;++gc)Ib[gc]*=this.Bb.MYd.J(hb[gc]);hb=rj(Ib);for(gc=0;gc<Ib.length;++gc)Ib[gc]/=hb}}}Object(l.a)(Fk,"TfIdfRankerNLModule",null,[1448]);class Ll{constructor(hb,Ib=0){if(!hb)throw Error.argumentNull("byteArray");
this.l4d=Ib;if(604662927!==hb.$y(this.l4d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.$j=hb.$y(this.l4d+4,4);this.CMi=hb.$y(this.l4d+8,4);this.S9m=hb}J(hb){if(0>hb||hb>=this.count)throw Error.argumentOutOfRange("index");return this.S9m.YQn(8*this.l4d+96+hb*this.CMi,this.CMi)}get count(){return this.$j}}Object(l.a)(Ll,"CompactIntArray",null,[1447]);const rh=(hb,Ib)=>{Ib=Array(Ib);for(let qd=0;qd<Ib.length;qd++){var gc=qd,Lc=hb.t$(),Rc=1===(Lc>>31&1)?-1:
1;const Ld=Lc&8388607;Lc=Lc>>23&255;256===Lc+1?Rc=Ld?Number.NaN:1===Rc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Lc?(Lc-=127,Rc=Rc*qp(Ld,1)*Math.pow(2,Lc)):Rc=Rc*qp(Ld,0)*Math.pow(2,-126);Ib[gc]=Rc}return Ib},qp=(hb,Ib)=>{let gc=0;for(let Lc=0;23>Lc;Lc++)gc+=(hb>>22-Lc&1)/Math.pow(2,Lc+1);return Ib+gc};class Hi{constructor(hb,Ib){this.lUf=null;this.$Si=0;this.qui=this.pui=this.MYd=null;this.ZSi=0;this.GEh=this.FEh=null;this.annotations=Ib.annotations;let gc=0;this.PIk=hb.J(gc);++gc;this.D3b=
hb.J(gc);++gc;this.QIk=hb.J(gc);++gc;this.RIk=hb.J(gc);++gc;this.F3b=hb.J(gc);++gc;this.E3b=hb.J(gc);++gc;this.LIk=hb.J(gc);++gc;this.NIk=hb.J(gc);++gc;this.MIk=hb.J(gc);++gc;this.OIk=hb.J(gc);++gc;var Lc=hb.J(gc);++gc;var Rc=Array(Lc);for(var qd=0;qd<Lc;++qd)Rc[qd]=Ib.JB(hb.J(gc)),++gc;this.p8=lc.a.mcf(Rc);this.Cbn=hb.J(gc);++gc;this.mMn=hb.J(gc);++gc;Lc=hb.J(gc);++gc;this.QVh={};for(Rc=0;Rc<Lc;++Rc){qd=Ib.JB(hb.J(gc));++gc;const Ld=hb.J(gc);++gc;this.QVh[qd]=Ld}this.qQf=hb.J(gc);++gc;this.icn=hb.J(gc);
++gc;Lc=hb.J(gc);++gc;0<Lc&&(Lc=Ib.Xib(hb.J(gc)),++gc,this.lUf=this.C$d(new De(Lc)));++gc;hb=Ib.Xib(hb.J(gc));this.NBn(hb)}C$d(hb){return new Ll(hb.L_,hb.offset)}NBn(hb){try{const Ib=new De(hb);this.$Si=Ib.t$();1===Ib.t$()?this.MYd=lc.a.mcf(rh(Ib,this.$Si)):this.MYd=null;const gc=Ib.t$();this.pui=this.C$d(Ib);Ib.offset+=gc;const Lc=Ib.t$();this.qui=this.C$d(Ib);Ib.offset+=Lc;this.ZSi=Ib.t$();const Rc=Ib.t$();this.FEh=this.C$d(Ib);Ib.offset+=Rc;this.GEh=lc.a.mcf(rh(Ib,this.ZSi))}catch(Ib){throw Error.argument("byteReader");
}}}Object(l.a)(Hi,"TfIdfRankerNLModuleInit",null,[]);class Gk{constructor(hb,Ib,gc,Lc){this.p0f=hb;this.h1h=gc;this.tokens=Lc;this.Rna=Ib;this.Xkc=-1;this.uge=0}}Object(l.a)(Gk,"TokenizerData",null,[]);class Xn{constructor(hb){this.Bb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");if(!({value:Lc}=hb.Lq(this.Bb.X_a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ib;({value:Ib}=hb.Lq(this.Bb.b4)).returnValue||(Ib=0);let gc;({value:gc}=
hb.Lq(this.Bb.c8)).returnValue||(gc=Lc.length-Ib);if(0>Ib||Ib>Lc.length)throw Error.argument("input","Start index out of range");if(0>gc||gc>Lc.length)throw Error.argument("input","Length out of range");if(Ib+gc>Lc.length)throw Error.argument("input","Bad start-length range");var Lc=new Gk(Lc,Ib,Ib+gc,new Eb.a(this.Bb.annotations,L.Annotations.SV));this.CMo(Lc);hb=hb.isReadOnly?hb.clone():hb;hb.ez(this.Bb.pOa,Lc.tokens);return hb}CMo(hb){for(;hb.Rna<hb.h1h;){if(this.Bb.sxf){var Ib=this.Bb.sxf.gMi(hb.p0f,
hb.Rna,hb.h1h-hb.Rna,null);!Ib.succeeded&&Ib.PRi&&(Ib=Ib.PRi);if(Ib.succeeded){this.XWi(hb,Ib.length,this.Bb.Zli);hb.Rna+=Ib.length;continue}}Ib=hb.p0f.substr(hb.Rna);let gc=-1,Lc=-1,Rc=-1;for(let qd=0;qd<this.Bb.wfe.length;++qd){const Ld=this.Bb.wfe[qd].exec(Ib);Ld&&0<Ld[1].length&&(0>gc||Ld[0].length>Lc)&&(gc=qd,Lc=Ld[0].length,Rc=Ld[1].length)}0<=gc?(this.XWi(hb,Rc,this.Bb.abg[gc]),hb.Rna+=Rc):hb.Rna+=1}}XWi(hb,Ib,gc){if(this.Bb.XCi)gc!==Xn.HQk&&(0>hb.Xkc&&(hb.Xkc=hb.Rna),hb.uge=hb.Rna+Ib-hb.Xkc,
gc===Xn.GQk&&(0<=hb.Xkc&&0<hb.uge&&(Ib=new S.a(this.Bb.annotations),Ib.ez(this.Bb.b4,hb.Xkc),Ib.ez(this.Bb.c8,hb.uge),Ib.ez(this.Bb.P3e,Xn.IQk),Ib.ez(this.Bb.X_a,hb.p0f),Array.add(hb.tokens.items,Ib)),hb.Xkc=-1,hb.uge=0));else{let Lc=new S.a(this.Bb.annotations);Lc.ez(this.Bb.b4,hb.Rna);Lc.ez(this.Bb.c8,Ib);Lc.ez(this.Bb.P3e,gc);Array.add(hb.tokens.items,Lc)}}}Xn.HQk="GAP";Xn.GQk="EOS_CHUNK";Xn.IQk="SENTENCE";Object(l.a)(Xn,"TokenizerNLModule",null,[1448]);class jk{constructor(hb,Ib){this.c8=this.b4=
this.P3e=this.pOa=this.X_a=0;this.XCi=!1;this.abg=this.wfe=this.Zli=this.sxf=null;if(hb){this.annotations=Ib.annotations;var gc=0;try{this.X_a=hb.J(gc);++gc;this.pOa=hb.J(gc);++gc;this.P3e=hb.J(gc);++gc;this.b4=hb.J(gc);++gc;this.c8=hb.J(gc);++gc;this.XCi=1===hb.J(gc);++gc;var Lc=hb.J(gc);++gc;0<Lc&&(this.sxf=Ib.Wsf(Lc).IDl);this.Zli=hb.J(gc)?Ib.JB(hb.J(gc)):"";++gc;const Rc=hb.J(gc);++gc;this.wfe=Array(Rc);this.abg=Array(Rc);for(Lc=0;Lc<Rc;++Lc)this.wfe[Lc]=new RegExp(Ib.JB(hb.J(gc))),++gc,this.abg[Lc]=
Ib.JB(hb.J(gc)),++gc}catch(Rc){throw Error.argument("initData");}}}}Object(l.a)(jk,"TokenizerNLModuleInit",null,[]);class Hd{constructor(hb){this.Bb=hb}execute(hb){if(!hb)throw Error.argumentNull("input");let Ib;if(!({value:Ib}=hb.Lq(this.Bb.Hwh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const gc of this.Bb.qjg)Ib=gc.apply(Ib);hb=L.Annotations.$T(hb);hb.ez(this.Bb.Iwh,Ib);return hb}static Z2e(hb,Ib){const gc=new Sys.StringBuilder;for(let Lc=
0;Lc<hb.length;++Lc)gc.append(Ib(hb.substr(Lc,1)));return gc.toString()}}Object(l.a)(Hd,"TransliteratorNLModule",null,[1448]);class Ie{constructor(hb){hb&&(this.style=hb.J(0))}apply(hb){return Hd.Z2e(hb,Ib=>Ie.eVk(Ib,this.style))}static eVk(hb,Ib){switch(Ib){case 0:return hb.toLowerCase();case 1:return"I"===hb?"\u0131":hb.toLowerCase();case 2:return hb.toUpperCase();case 3:return"i"===hb?"\u0130":hb.toUpperCase();default:throw Error.invalidOperation();}}}Ie.ZBb=0;Object(l.a)(Ie,"ChangeCaseTransliterationStage",
null,[1466]);class Ok{apply(hb){return Hd.Z2e(hb,Ok.dOo)}static dOo(hb){const Ib=hb.charCodeAt(0);return 65281<=Ib&&65374>=Ib?String.fromCharCode(Ib-65248):hb}}Ok.ZBb=4;Object(l.a)(Ok,"LatinFullWidthToHalfWidthTransliterationStage",null,[1466]);class Jj{constructor(hb,Ib){hb&&(this.a7f=Ib.P$b(hb.J(0)),this.f5n=Ib.JB(hb.J(1)))}apply(hb){return hb.replace(this.a7f,this.f5n)}}Jj.ZBb=1;Object(l.a)(Jj,"RegexReplaceTransliterationStage",null,[1466]);class ee{constructor(hb,Ib){if(hb){var gc=hb.J(0),Lc=
Ib.JB(hb.J(1)),Rc=new Ll(Ib.Xib(hb.J(2)));hb=0>hb.J(3)?null:new Ll(Ib.Xib(hb.J(3)));this.tkg={};for(Ib=0;Ib<gc;++Ib)this.tkg[Lc.charAt(Ib).toString()]=Lc.substr(Rc.J(Ib),hb?hb.J(Ib):1)}}apply(hb){return Hd.Z2e(hb,Ib=>Ib in this.tkg?this.tkg[Ib]:Ib)}}ee.ZBb=2;Object(l.a)(ee,"SingleCharSubstitutionsTransliterationStage",null,[1466]);class md{constructor(hb,Ib){this.Iwh=this.Hwh=0;this.qjg=null;if(hb){this.annotations=Ib.annotations;var gc=0;try{this.Hwh=hb.J(gc);++gc;this.Iwh=hb.J(gc);++gc;const Lc=
hb.J(gc);++gc;this.qjg=Array(Lc);for(let Rc=0;Rc<Lc;++Rc){const qd=hb.J(gc);++gc;const Ld=hb.J(gc);++gc;const zd=new lc.a;zd.Iib(hb,gc,Ld);gc+=Ld;this.qjg[Rc]=this.ZBn(qd,zd,Ib)}}catch(Lc){throw Error.argument("initData");}}}ZBn(hb,Ib,gc){switch(hb){case Ie.ZBb:return new Ie(Ib);case Jj.ZBb:return new Jj(Ib,gc);case ee.ZBb:return new ee(Ib,gc);case Ok.ZBb:return new Ok;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(md,"TransliteratorNLModuleInit",
null,[]);class nl{b6l(hb,Ib){const gc=hb.J(0),Lc=new lc.a;Lc.Iib(hb,1,hb.count-1);switch(gc){case 0:return new Fi(new Yh(Lc,Ib));case 2:return new Xn(new jk(Lc,Ib));case 3:return new ok(new cj(Lc,Ib));case 5:return new ml(new el(Lc,Ib));case 9:return new Hd(new md(Lc,Ib));case 10:return new Fk(new Hi(Lc,Ib));default:throw Error.notImplemented();}}}Object(l.a)(nl,"NLModuleFactory",null,[1429]);class gf{constructor(hb){this.EQk=";";if(!hb)throw Error.argumentNull("resource");this.Uia=new Tj(hb,new vb,
new nl);this.POf=this.Uia.H5l();this.BMi=this.Uia.annotations.LPc("Text.Text");this.zMi=this.Uia.annotations.LPc("Classification.Predictions");this.AOf=this.Uia.annotations.LPc("Classification.PredictionString");this.AMi=this.Uia.annotations.LPc("Classification.Probability");this.R9m=this.Uia.annotations.LPc("NLMod.Tokens");if(0>this.BMi||0>this.zMi||0>this.AOf||0>this.AMi)throw Error.argument("resourceObj","Resource does not represent a ranker");}vPl(){const hb=[];this.Ujf(void 0,this.Y5h(hb),null);
return hb}xPl(hb,Ib){const gc=[],Lc=[];this.Ujf(hb,this.Y5h(gc),(Rc,qd)=>{const Ld=this.Uia.annotations.L5h(Rc),zd=[],pf=[];Ib&&Ib.length&&-1===Array.indexOf(Ib,Ld)||(Rc=this.Uia.annotations.getAttributeType(Rc),this.l3i(Rc,qd,zd,pf),qd=new mg(Ld,zd,pf),Array.add(Lc,qd))});return new ah(gc,Lc)}wPl(hb){const Ib=[];this.Ujf(hb,gc=>{let Lc;if(({value:Lc}=gc.Lq(this.AOf)).returnValue){let Rc;({value:Rc}=gc.Lq(this.AMi)).returnValue&&Array.add(Ib,new Sf(Lc,Rc))}},null);return Ib}Ujf(hb,Ib,gc){var Lc=new S.a(this.Uia.annotations);
Lc.ez(this.BMi,hb);hb=this.POf.execute(Lc);if(({value:Lc}=hb.Lq(this.zMi)).returnValue)for(const Rc of Lc.items)Ib(Rc);if(gc&&({value:Ib}=hb.Lq(this.R9m)).returnValue)for(const Rc of Ib.items)Rc.LPd(gc)}l3i(hb,Ib,gc,Lc){if(L.Annotations.uI(hb))for(var Rc of Ib.items)this.l3i(Ib.i5,Rc,gc,Lc);else if(L.Annotations.YDj(hb)){Rc=this.Uia.annotations.Edi(hb);for(let qd=0;qd<Rc;qd++)Array.add(gc,this.Uia.annotations.gii(hb,qd)),Array.add(Lc,this.Uia.annotations.Pea(this.Uia.annotations.lHb(hb,qd),Ib.kjb(qd)))}else Array.add(gc,
"VALUE"),Array.add(Lc,this.Uia.annotations.Pea(hb,Ib))}Y5h(hb){return Ib=>{let gc;({value:gc}=Ib.Lq(this.AOf)).returnValue&&Array.add(hb,this.Z$l(gc))}}Z$l(hb){const Ib=hb.indexOf(this.EQk);return 0>Ib?hb:hb.substring(0,Ib)}}Object(l.a)(gf,"Ranker",null,[]);var yh=c(1562),Ef=c(1573),vi=c(2);class Ml{constructor(hb,Ib){this.R4g="";this.VPe=null;this.WPe=!1;this.rsa=null;this.fXj=["TellMe.TellMeParamCollection"];this.fc=hb;this.TYa=Ib;this.fc.rBb&&(this.rsa=null)}get ece(){if(!this.VPe&&!this.WPe){let hb=
null;try{hb=window.TellMeModel}catch(Ib){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("QueryRanker","TellMeModel not found. Exception: "+Ib)}if(hb){try{this.VPe=new gf(hb)}catch(Ib){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ib)}this.WPe=!0}else if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("QueryRanker","Classifier model not found")}return this.VPe}qL(){return"Command"}CU(){return 0===
this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc=!1,Lc=e.a.tellMe,Rc=null){const qd=new n.a(hb);if((!Rc||Array.contains(Rc,0))&&!z.a.GR(hb)){if(!this.ece&&this.WPe){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.rBb&&this.rsa&&this.rsa.initialize();if(yh.CommandResultsUtility.jEf(hb.Fg)&&(Rc=yh.CommandResultsUtility.C7h(hb.Fg),0<Rc.results.length)){Rc.displayName=
"Classifier Debug";qd.gv(Rc);Ib.resultsUpdated(qd);return}Rc=hb?this.R4g=hb.Fg:this.R4g;if(vi.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Rc=this.aam(Rc);var Ld=this.fRd(Rc.buf());Rc=Rc.o5h()}else Rc=this.$$l(Rc),Ld=this.DSl(Rc),Rc=[];yh.CommandResultsUtility.w3d(Ld,!1,"Classifier","TFIDF");Ld=yh.CommandResultsUtility.$Rc(hb,Ld,this.fc,this.rsa,this.TYa,Rc,0,1);0<Ld.results.length&&Lc!==e.a.contextMenu&&(Ld.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);gc||Ld.results.length||
this.fc.E0||this.fc.A8a||(hb=new x.a("lookupNoResults",14,hb.Fg,null,1),Ld.Ww(hb));0<Ld.results.length&&qd.gv(Ld);qd.attributes=Rc}Ib.resultsUpdated(qd)}buf(){let hb=[];try{hb=this.ece.vPl()}catch(Ib){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("GetPredictions","Exception: "+Ib)}return hb}$$l(hb){let Ib=[];try{Ib=this.ece.wPl(hb)}catch(gc){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("GetPredictionsWithScore","Exception: "+gc)}return Ib}aam(hb){try{return this.ece.xPl(hb,
this.fXj)}catch(Ib){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("GetPredictionsWithTokenAttributes","Exception: "+Ib)}return new ah([],[])}fRd(hb){const Ib=[];if(hb)for(const gc of hb)Ib.push(new Ef.a(gc,-99999));return Ib}DSl(hb){const Ib=[];if(hb)for(const gc of hb)Ib.push(new Ef.a(gc.prediction,gc.score));return Ib}}Object(l.a)(Ml,"CommandResultsProvider",null,[1307]);var kk=c(1760);class am{constructor(hb){this.fc=hb}qL(){return"Feedback"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?
1:2}eI(hb,Ib,gc,Lc,Rc=null){hb=new n.a(hb);if(!Rc||Array.contains(Rc,21))Rc=[],Rc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Rc),Rc=new y.a(22),Rc.displayName="",Rc.Ww(new x.a("TellMeFeedback",23,null,null,1)),hb.gv(Rc);Ib.resultsUpdated(hb)}}Object(l.a)(am,"FeedbackResultsProvider",null,[1307]);class Wh{constructor(hb,Ib,gc,Lc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=hb;this.CommandId=
Ib;this.CommandValueId=gc;this.InputText=Lc}}Object(l.a)(Wh,"FindInDocumentProp",null,[]);var Wg=c(19);class jg{constructor(hb){this.JKe=2;this.txb=[];this.Mcb=[];this.fc=hb;jg.eFa=hb.olf;jg.A0h="FindInDocumentSuggestion";jg.x2i="FindInDocumentSuggestion3";this.CJe=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.Ejk=this.fc.Aqb||!!vi.AFrameworkApplication.ta&&vi.AFrameworkApplication.ta.Kb.Aqb}qL(){return"FindInDocument"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:3===this.fc.kv?this.fc.uuj?
2:3:2}eI(hb,Ib,gc=!1,Lc,Rc=null){const qd=new n.a(hb);if(Rc&&!Array.contains(Rc,2))Ib.resultsUpdated(qd);else if(Array.clear(this.txb),z.a.GR(hb)){if(gc&&this.Grj()){gc=new y.a(2);gc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Rc=1;Lc="";if(0<this.Mcb.length&&!this.fc.Slc)for(var Ld of this.Mcb)if(""!==Ld.Label.toLowerCase()){if(Rc>=this.JKe)break;this.WHj(gc,Ld.Label,Ld.CommandValueId,jg.A0h+Rc,Ld.InputText);Rc++}Ld="";this.fc.XP?(qd.gv(gc),gc=new y.a(3),Ld=this.fc.rfb?z.a.Uib(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Ld=CommonUIStrings.l_TellMeOpenFindPaneText;Lc=this.B7h("");this.WHj(gc,Ld,Lc,jg.x2i,"");qd.gv(gc)}Ib.resultsUpdated(qd)}else Ld="",gc&&(gc=this.B7h(hb.Fg),Lc=[],this.fc.f5a?(this.fc.Xie&&Lc.push(appChrome.actions.setControlIconSet(jg.eFa,{"default":"FindInDocument_20"})),Ld=this.fc.BIf?z.a.trf(hb.Fg,CommonUIStrings.l_FindInDocumentScopedButtonText):hb.Fg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.XP?(Ld=this.fc.rfb?z.a.Uib(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
hb.Fg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,hb.Fg),Lc.push(appChrome.actions.setControlIconSet(jg.eFa,{"default":"FindInDocument_20"}))):Ld=this.fc.Slc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,hb.Fg),this.fc.exa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(jg.eFa,Ld)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(jg.eFa,gc))):(Lc.push(appChrome.actions.setControlLabel(jg.eFa,
Ld)),Lc.push(appChrome.actions.setButtonCommandValueId(jg.eFa,gc)),appChrome.api.dispatch(Lc)),this.bnj(Ld,jg.eFa,gc,hb.Fg)),this.fc.uuj?(Ld=new x.a(jg.eFa,8,hb.Fg),gc=new y.a(2),gc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,gc.Ww(Ld),qd.gv(gc),Ib.resultsUpdated(qd)):this.fc.cSd(hb.Fg).then(zd=>{const pf=new x.a(jg.eFa,8,hb.Fg,null,1);pf.count=zd;zd=new y.a(2);zd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;zd.Ww(pf);qd.gv(zd);Ib.resultsUpdated(qd)},zd=>{t.TellMeActor.instance.Pe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+zd);zd=new x.a(jg.eFa,8,hb.Fg,null,1);const pf=new y.a(2);pf.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;pf.Ww(zd);qd.gv(pf);Ib.resultsUpdated(qd)})}Grj(){return!!this.fc&&this.fc.Pie}WHj(hb,Ib,gc,Lc,Rc=null){const qd=[];Ib&&qd.push(appChrome.actions.setControlLabel(Lc,Ib));this.fc.XP&&qd.push(appChrome.actions.setControlIconSet(Lc,{"default":"FindInDocument_20"}));qd.push(appChrome.actions.setButtonCommandValueId(Lc,gc));appChrome.api.dispatch(qd);
this.bnj(Ib,Lc,gc,"");hb.Ww(new x.a(Lc,8,Rc,null,1,-99999))}B7h(hb){return this.Ejk?z.a.ePa(hb,15,this.CJe):Wg.a.zf(hb)}bnj(hb,Ib,gc,Lc){this.Grj()&&this.txb.length<this.JKe&&(hb=new Wh(hb,Ib,gc,Lc),Array.add(this.txb,hb))}Klo(hb){for(let Ib=0;Ib<this.txb.length;Ib++)if(this.txb[Ib].CommandId===hb){const gc=this.txb[Ib].Label;let Lc=!1;if(0<this.Mcb.length){let Rc=0;for(const qd of this.Mcb){if(qd.Label===gc){Array.removeAt(this.Mcb,Rc);Lc=!0;break}Rc++}}!Lc&&this.Mcb.length>=this.JKe-1&&Array.removeAt(this.Mcb,
1);Array.insert(this.Mcb,0,this.txb[Ib])}}}jg.eFa=null;jg.A0h=null;jg.x2i=null;Object(l.a)(jg,"FindInDocumentResultsProvider",null,[1307]);var Lh=c(1758);class je{constructor(hb){this.fc=hb}qL(){return"Insights"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc=!1,Lc,Rc=null){Lc=new n.a(hb);if(!Rc||Array.contains(Rc,13))if(this.cvo()||!z.a.GR(hb)){Rc=new y.a(13);var qd=""===hb.Fg.trim(),Ld=qd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",zd=new x.a(Ld,10,hb.Fg,null,1);gc&&(gc=
null,z.a.Npa()?qd?qd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(qd=this.fc.Slc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,hb.Fg),gc=z.a.ePa(hb.Fg,1)):(qd=String.format(CommonUIStrings.l_InsightsButtonText,hb.Fg),gc=z.a.ADb(hb.Fg)),this.fc.exa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ld,qd)),gc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
gc))):(hb=[],hb.push(appChrome.actions.setControlLabel(Ld,qd)),gc&&hb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",gc)),appChrome.api.dispatch(hb)),zd.label=qd);Rc.Ww(zd);Lc.gv(Rc)}Ib.resultsUpdated(Lc)}cvo(){return z.a.Npa()&&this.fc.FJo&&!this.fc.mha}}Object(l.a)(je,"InsightsResultsProvider",null,[1307]);var oh=c(1756);class Rd{constructor(hb){this.fc=hb}qL(){return"Learning"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc,Lc,Rc=null){gc=new n.a(hb);Rc&&!Array.contains(Rc,
21)||!z.a.GR(hb)||(Rc=[],Lc=this.fc.j1m,Rc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Lc)),Lc=Rd.ZZl(Lc),Rc.push(appChrome.actions.setControlLabel("LearningForSearch",Lc)),appChrome.api.dispatch(Rc),hb=new x.a("LearningForSearch",22,hb.Fg,null,1),Rc=new y.a(21),Rc.Ww(hb),gc.gv(Rc));Ib.resultsUpdated(gc)}static ZZl(hb){const Ib=[];Array.add(Ib,new oh.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ib,new oh.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Ib,new oh.a(600,hb));Array.add(Ib,new oh.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));hb={};hb.parts=Ib;return JSON.stringify(hb)}}Object(l.a)(Rd,"LearningProvider",null,[1307]);var Ii=c(614);class Lf{constructor(hb,Ib){this.QYb=this.G1b=this.mdb=this.bsd=null;this.Bx=!1;this.yZb=hb;this.y0j=Ib;hb&&this.NZh(hb)}zne(){this.yZb.zne()&&this.NZh(this.yZb)}getSuggestions(hb){let Ib=[];var gc=[];hb=Lf.Fin(hb);var Lc="";Array.clear(gc);for(let Rc=0;Rc<hb.length;Rc++){const qd=hb.charAt(Rc);
-1!==" ".indexOf(qd)?(Lc.length&&Array.add(gc,Lc),Lc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(qd)?(Lc.length&&Array.add(gc,Lc),Lc=qd,Array.add(gc,Lc),Lc=""):Lc+=qd}Lc.length&&Array.add(gc,Lc);for(hb=0;hb<gc.length;hb++)Lc=this.CSl(gc[hb]),Lc=this.W7k(Lc),Ib=Lf.fdn(Ib,Lc);return Ib=this.Ruk(Ib)}NGf(){this.Bx||this.zne();return this.Bx}HKd(hb){return this.bsd[hb.toString()]}Ruk(hb){for(let Ib=0;Ib<hb.length;Ib++){const gc=this.mdb[Ib];if(hb[Ib].commandId!==this.HKd(gc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Lc;(Lc=hb[Ib]).score=Lc.score+gc[1]}return hb}W7k(hb){const Ib=[];for(var gc=0;gc<this.mdb.length;gc++)Ib.push(new Ef.a(this.HKd(this.mdb[gc][0]),-5));gc=new Ii.a;for(var Lc=0;Lc<hb.length;Lc++)gc.add(this.HKd(hb[Lc][0]));for(Lc=0;Lc<Ib.length;Lc++){const qd=Ib[Lc];for(let Ld=0;Ld<hb.length;Ld++){var Rc=hb[Ld];const zd=this.HKd(Rc[0]);Rc=Rc[1];if(zd===qd.commandId){qd.score=Rc;gc.remove(zd);break}}if(!gc.count)break}return Ib}CSl(hb){const Ib=1>hb.length;for(let Ld=0;2>=Ld;Ld++){const zd=this.QYb;
for(let pf in zd){var gc=zd[pf],Lc=hb,Rc=pf;const Jc=Rc.length+1,gg=Array((Lc.length+1)*Jc);for(var qd=0;qd<=Lc.length;qd++)gg[qd*Jc]=qd;for(qd=0;qd<=Rc.length;qd++)gg[qd]=qd;for(qd=0;qd<Rc.length;qd++)for(let dc=0;dc<Lc.length;dc++)gg[(dc+1)*Jc+(qd+1)]=Lc.charAt(dc)===Rc.charAt(qd)?gg[dc*Jc+qd]:Math.min(Math.min(gg[dc*Jc+(qd+1)]+1,gg[(dc+1)*Jc+qd]+1),gg[dc*Jc+qd]+1);Lc=gg[Lc.length*Jc+Rc.length];if((!Lc||!Ib)&&Lc<=Ld)return gc}}return this.G1b}NZh(hb){this.bsd=hb.Vsf();this.mdb=hb.Jam();this.G1b=
hb.Sjm();this.QYb=hb.B2l();if(this.Bx=!!this.bsd&&!!this.mdb&&!!this.QYb&&!!this.G1b)this.Bx=0<this.mdb.length&&Lf.PDf(this.mdb);this.Bx&&(this.Bx=0<this.G1b.length&&Lf.PDf(this.G1b));this.Bx&&(this.QYb=Lf.Ikm(this.QYb));this.Bx||(this.QYb=this.G1b=this.mdb=this.bsd=null)}Zim(hb){hb=this.getSuggestions(hb);return this.uDl(hb,this.y0j)}uDl(hb,Ib){let gc=[];for(let Lc=0;Lc<hb.length;Lc++)hb[Lc].score>=Ib&&gc.push(hb[Lc]);gc.sort((Lc,Rc)=>Lc.score<Rc.score?1:Lc.score>Rc.score?-1:0);0<gc.length-10&&(gc=
gc.slice(0,10));return gc}static fdn(hb,Ib){if(!hb.length)return Ib;if(hb.length!==Ib.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let gc=0;gc<hb.length;gc++){if(hb[gc].commandId!==Ib[gc].commandId)throw Error.create("Incorrect CommandId");let Lc;(Lc=hb[gc]).score=Lc.score+Ib[gc].score}return hb}static Fin(hb){return Wg.a.eh(hb)}static PDf(hb){for(let Ib=0;Ib<hb.length;Ib++)if(2!==hb[Ib].length)return!1;return!0}static Ikm(hb){const Ib=
{};for(let Rc in hb){var gc=Rc,Lc=hb[Rc];const qd=Lc;qd.length&&Lf.PDf(qd)&&(Ib[gc]=Lc)}return Ib}}Object(l.a)(Lf,"NaiveBayesClassifierModel",null,[]);class ag{constructor(hb,Ib){this.rsa=null;this.fc=hb;this.Lzc=new Lf(Ib,hb.c6l);this.fc.rBb&&(this.rsa=null)}qL(){return"NBCommand"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc=!1,Lc=e.a.tellMe,Rc=null){const qd=new n.a(hb);if((!Rc||Array.contains(Rc,0))&&!z.a.GR(hb)){if(yh.CommandResultsUtility.jEf(hb.Fg)&&(Rc=yh.CommandResultsUtility.C7h(hb.Fg),
0<Rc.results.length)){Rc.displayName="Classifier Debug";qd.gv(Rc);Ib.resultsUpdated(qd);return}if(!this.Lzc.NGf()){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.rBb&&this.rsa&&this.rsa.initialize();Rc=this.Lzc.Zim(hb.Fg);yh.CommandResultsUtility.w3d(Rc,!1,"Classifier","NaiveBayesian");Rc=yh.CommandResultsUtility.$Rc(hb,Rc,this.fc,this.rsa,
null,null,0,1);0<Rc.results.length&&Lc!==e.a.contextMenu&&(Rc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);gc||Rc.results.length||this.fc.E0||this.fc.A8a||(hb=new x.a("lookupNoResults",14,hb.Fg,null,1),Rc.Ww(hb));0<Rc.results.length&&qd.gv(Rc)}Ib.resultsUpdated(qd)}}Object(l.a)(ag,"NaiveBayesCommandProvider",null,[1307]);class xn{constructor(){this.qxb=null;this.Bx=!1;this.zne()}zne(){this.Bx||(this.qxb=window.NBCRM)&&4===this.qxb.length&&(this.Bx=!0);return this.Bx}Jam(){return this.Bx?
this.qxb[1]:null}Sjm(){return this.Bx?this.qxb[2]:null}B2l(){return this.Bx?this.qxb[3][0]:null}Vsf(){return this.Bx?this.qxb[0][0]:null}}Object(l.a)(xn,"NaiveBayesModelAdapter",null,[1332]);var Zj=c(170);class dk{constructor(hb){this.fc=hb}qL(){return"OfficeScript"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib){const gc=new n.a(hb);if(!z.a.GR(hb)){hb=Zj.d(hb.Fg);var Lc=new y.a(28);Lc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Lc=this.aqh(hb,dk.GSo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Lc);Lc=this.aqh(hb,dk.vKl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Lc);gc.gv(Lc)}Ib.resultsUpdated(gc)}aqh(hb,Ib,gc,Lc,Rc,qd){const Ld=[];for(const zd of Ib)if(Zj.a(hb,zd)){this.fc.exa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(gc,Rc)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(gc,Lc))):(Ld.push(appChrome.actions.setControlLabel(gc,
Rc)),Ld.push(appChrome.actions.setButtonCommandValueId(gc,Lc)),appChrome.api.dispatch(Ld));qd.Ww(new x.a(gc,28,null,null,1));break}return qd}}dk.GSo="unhide row rows col cols column columns".split(" ");dk.vKl=["freeze","selection","pane","panes"];Object(l.a)(dk,"OfficeScriptsSamplesProvider",null,[1307]);var Qe=c(75),pk=c(349),io=c(1589),Oh=c(1553),Zg=c(1588),yg=c(35),Nn=c(139),rf=c(26);class ge{constructor(hb){this.AQ=null;this.O2=-1;this.GPf=14;this.IPf=12;this.attributes=this.pXe=this.query=null;
this.Kdc=!1;this.H_b=[];this.Zf=vi.AFrameworkApplication.He;vi.AFrameworkApplication.K&&(this.GPf=vi.AFrameworkApplication.K.nc("TellMeMaxTermedResults",this.GPf),this.IPf=vi.AFrameworkApplication.K.nc("TellMeMaxZeroTermResults",this.IPf));this.VR=hb}get vo(){return this.H_b}get doe(){return this.pXe}gv(hb){let Ib=!1;for(let gc=0;gc<this.vo.length;gc++)if(30!==this.vo[gc].groupType&&this.vo[gc].groupType===hb.groupType){this.H_e(this.vo[gc],hb);Ib=!0;break}Ib||this.vo.push(hb)}H_e(hb,Ib){for(let gc=
0;gc<Ib.results.length;gc++)hb.Ww(Ib.results[gc])}kbj(hb){const Ib=[];for(const gc of this.vo)gc.groupType!==hb&&Ib.push(gc);this.vo.length!==Ib.length&&(this.H_b=Ib)}C0n(hb){let Ib=null,gc=null,Lc=null;for(let Rc=0;Rc<hb.length;Rc++){const qd=hb[Rc];if(qd&&qd.vo&&qd.vo.length)for(const Ld of qd.vo)if(17===Ld.groupType||18===Ld.groupType)Ib=Ld;else if(0===Ld.groupType||16===Ld.groupType)gc=Ld,Lc=qd}Ib&&gc&&0<gc.results.length&&(17===Ib.groupType&&({d_e:gc,V_e:Ib}=yh.CommandResultsUtility.vtk(gc,Ib,
this.VR.aP()?this.VR.aP().XRl:-.6)),Lc.kbj(gc.groupType))}fBo(){this.VR&&(new Qe.a,this.Mad(this.VR.hNi))}DYc(hb,Ib){return this.query.Fg.length>this.VR.aP().tbm&&this.mTm(hb,Ib)||this.query.Fg.length>this.VR.aP().ubm&&this.aWm(hb,Ib)?!0:!1}aWm(hb,Ib){return hb&&hb.length&&Ib&&Ib.length?-1===Ib.toLowerCase().indexOf(hb.toLowerCase())?!1:!0:!1}mTm(hb,Ib){return hb&&hb.length&&Ib&&Ib.length?Ib.toLowerCase().startsWith(hb.toLowerCase()):!1}GDl(hb){const Ib=[];for(const gc of this.VR.aP().XP?this.doe:
this.vo)hb.contains(gc.groupType)||Ib.push(gc);this.VR.aP().XP?this.pXe=Ib:this.H_b=Ib}ZZo(hb,Ib){const gc=[];for(const Lc of this.vo){const Rc=Lc;if(13!==Rc.groupType||24!==Rc.groupType){const qd=hb[Oh.a[Rc.groupType].toLowerCase()];let Ld="False";qd<Ib&&(Ld="True");Rc.displayName=Rc.displayName+" ("+Ld+": "+qd+")"}gc.push(Rc)}this.H_b=gc}Mad(hb,Ib=!1,gc=null){if(this.VR.aP().XP){if(!Ib)for(this.pXe=Array(this.vo.length),Ib=0;Ib<this.vo.length;Ib++)this.doe[Ib]=this.vo[Ib];this.VR.nNi.Mad(this.vo,
this.doe,this.query,hb,gc)}else{for(gc=new Qe.a;this.vo.length;){Ib=this.vo.pop();const Lc=Oh.a[Ib.groupType].toLowerCase(),Rc=hb[Lc];if(rf.c(Rc))throw Error.create("GroupId "+Lc+" missed from group SortingOrder");gc.add(new pk.a(Rc,Ib))}gc.Sc((Lc,Rc)=>Lc.key<Rc.key?-1:1);for(hb=0;hb<gc.count;hb++)Ib=gc.J(hb).value,this.vo.push(Ib)}}gBo(){var hb=!1;let Ib=!1,gc=!1;for(let Rc=0;Rc<this.vo.length;Rc++){var Lc=this.vo[Rc];const qd=Lc.groupType;if(8===qd||15===qd||14===qd){Lc=Lc.results;for(let Ld=0;Ld<
Lc.length;Ld++){if(8===qd&&this.DYc(this.query.Fg,Lc[Ld].label)){hb=!0;break}if(15===qd&&this.DYc(this.query.Fg,Lc[Ld].label)){Ib=!0;break}if(14===qd){if(this.DYc(this.query.Fg,Lc[Ld].label)||this.DYc(this.query.Fg,Lc[Ld].description)){gc=!0;break}const zd=Lc[Ld].label.split(" ");for(const pf of zd)if(this.DYc(this.query.Fg,pf)){gc=!0;break}}}}}hb=this.VR.kdm(hb,Ib,gc);this.Mad(hb)}XMb(hb,Ib,gc,Lc,Rc,qd){if(Rc===this.AQ){var Ld=hb.data.te;Rc=null;try{Rc=yg.b(Ld)}catch(Yi){t.TellMeActor.instance.Pe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+Yi);return}if("RankerResults"in Rc&&Rc.RankerResults){this.SDa();var zd=Rc.RankerResults,pf=new Qe.a,Jc=new Qe.a;Ld=0;for(var gg of zd){zd=gg.ProviderId;var dc=gg.Score;Ld+=dc;pf.add(new pk.a(zd,dc))}pf.Sc((dh,Nf)=>dh.value>Nf.value?-1:1);dc=qd?qd.vhi:1E-6;gg={};zd={};let Yi=0;for(var ng=0;ng<pf.count;ng++){let dh=parseInt(pf.J(ng).key),Nf=pf.J(ng).value/Ld;1===dh&&(zd.answer=Yi++,zd.entity=Yi++,zd.definition=Yi++,zd.wolframanswer=
Yi++,Nf<dc&&(Jc.add(9),Jc.add(11),Jc.add(10),Jc.add(12)),gg.answer=Nf,gg.entity=Nf,gg.definition=Nf,gg.wolframanswer=Nf);2===dh&&(zd.assistance=Yi++,Nf<dc&&Jc.add(8),gg.assistance=Nf);3===dh&&(zd.classifier=Yi++,zd.serviceclassifier=Yi++,Nf<dc&&(Jc.add(0),Jc.add(17)),gg.classifier=Nf,gg.serviceclassifier=Nf);4===dh&&(zd.people=Yi++,Nf<dc&&Jc.add(14),gg.people=Nf);5===dh&&(zd.document=Yi++,Nf<dc&&Jc.add(15),gg.document=Nf);6===dh&&(zd.findindocument=Yi++,Nf<dc&&Jc.add(2),gg.findindocument=Nf);7===
dh&&(zd.notes=Yi++,Nf<dc&&Jc.add(20),gg.notes=Nf);8===dh&&(zd.image=Yi++,Nf<dc&&Jc.add(19),gg.image=Nf)}pf=new Qe.a;pf.add("classifier");pf.add("serviceclassifier");pf.add("appsforoffice");pf.add("addin");pf.add("findindocument");pf.add("assistance");pf.add("document");pf.add("people");pf.add("answer");pf.add("wolframanswer");pf.add("definition");pf.add("entity");pf.add("image");pf.add("template");pf.add("officescript");for(ng=0;ng<pf.count;ng++)pf.J(ng)in zd||(zd[pf.J(ng)]=Yi++);zd.learning=Yi++;
zd.insights=Yi++;zd.actionai=Yi++;zd.actionaicommand=Yi++;zd.feedback=Yi++;qd&&qd.AAi&&this.ZZo(gg,dc);qd&&qd.BAi&&this.GDl(Jc);Jc={};for(var Sd in gg)Jc[Sd]=gg[Sd]*Ld;this.Mad(zd,!0,Jc)}if(qd.f1d&&"Intents"in Rc&&Rc.Intents){Sd=Rc.Intents;for(var rk of Sd)if(this.mJf(rk)&&"Serplet"===rk.GroupType&&rk.ConfidenceScore>rk.ConfidenceThreshold){Sd=!1;Rc=0;if(qd.g1d){Ld=new x.a("",32);for(Jc=0;Jc<this.vo.length;Jc++)if((pf=this.vo[Jc].results)&&0<pf.length){Rc=Jc;Ld=pf[0];break}2===Ld.groupType&&(Sd=!0)}Ld=
new y.a(13);Sd&&qd.g1d&&(Ld=new y.a(13,CommonUIStrings.l_TellMeWebTitle));Jc=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Fg,null,0);pf=[];gg=null;gg=z.a.Npa()?z.a.ePa(this.query.Fg,1):z.a.ADb(this.query.Fg);pf.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",gg));gg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Fg);pf.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",gg));appChrome.api.dispatch(pf);
Ld.Ww(Jc);Jc=[];if(Sd&&qd.g1d)for(Jc.push(this.vo[Rc]),Jc.push(Ld),Sd=Rc+1;Sd<this.vo.length;Sd++)(Rc=this.vo[Sd].results)&&0<Rc.length&&Jc.push(this.vo[Sd]);else for(Jc.push(Ld),Sd=0;Sd<this.vo.length;Sd++)(Rc=this.vo[Sd].results)&&0<Rc.length&&Jc.push(this.vo[Sd]);this.H_b=Jc}}if(qd.OYc&&!qd.XP){rk=Sd=-1;for(Rc=0;Rc<this.vo.length;Rc++)switch(this.vo[Rc].groupType){case 23:Sd=Rc;break;case 0:case 17:case 2:-1===rk&&(rk=Rc)}if(-1!==Sd){rk=-1===rk?0:Sd>rk?rk+1:rk;Sd=this.vo[Sd];Rc=Array(this.vo.length);
Ld=0;for(Jc=0;Jc<Rc.length;Jc++)Jc===rk?Rc[Jc]=Sd:(23===this.vo[Ld].groupType&&Ld++,Rc[Jc]=this.vo[Ld],Ld++);this.H_b=Rc}}Lc.resultsUpdated(this);Lc=t.TellMeActor.instance.Pe;Lc.W9(Ib.length,"RankerInference",hb.data.Ne.toString(),Math.round(window.performance.now()-gc),Zg.a.gzj,!0,io.a.XQa);this.Kdc&&Lc&&(hb=this.query.Yob,Ib=Lc.Ojd,qd.x1d&&hb>Ib&&!qd.XP&&(Lc.TNf(this.query.Fg),Lc.Bdg(hb)))}}mJf(hb){if("GroupType"in hb&&hb.GroupType&&"ConfidenceScore"in hb&&"ConfidenceThreshold"in hb)return!0;t.TellMeActor.instance.Pe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}GMb(hb,Ib,gc,Lc,Rc){Lc===this.AQ&&(this.SDa(),t.TellMeActor.instance.Pe.W9(Ib.length,"RankerInference",hb.data.Ne.toString(),Math.round(window.performance.now()-gc),Zg.a.gzj,!1,io.a.XQa));Rc.resultsUpdated(this)}SDa(){-1!==this.O2&&(window.clearTimeout(this.O2),this.O2=-1)}hBo(hb){let Ib;Ib=this.VR.aP().XP?t.TellMeActor.instance.Pe.yvf(this.doe,this.query.Fg):t.TellMeActor.instance.Pe.yvf(this.vo,this.query.Fg);var gc=this.VR.aP().uhi;""!==gc&&(gc="_"+gc);let Lc=
"";this.VR.aP().l0d&&(Lc="RankerInference"+gc+",");this.VR.aP().f1d&&(Lc+="SerpletClassifier");","===Lc.charAt(Lc.length-1)&&(Lc=Lc.substring(0,Lc.length-1));gc=t.TellMeActor.instance.Pe.hji(Lc);const Rc=this.AQ=Nn.a.create().toString();gc["Client-Request-Id"]=Rc;const qd=window.performance.now(),Ld=this.VR.aP()?this.VR.aP().whi:600;this.SDa();this.O2=window.setTimeout(()=>{if(Rc===this.AQ){this.AQ="";this.O2=-1;hb.resultsUpdated(this);const zd={};zd[a.a.provider]="Ranker";zd[a.a.rOb]=this.query.Yob;
t.TellMeActor.instance.Pe.QA(k.a.timedOut,Ld,zd)}},Ld);this.Zf.nj(t.TellMeActor.instance.Pe.iji(),2,Ib,gc,!1,0,zd=>{this.XMb(zd,this.query.Fg,qd,hb,Rc,this.VR.aP())},zd=>{this.GMb(zd,this.query.Fg,qd,Rc,hb)},null,null,!1,4E3,6E3)}fPo(){var hb=0,Ib=new Qe.a,gc=this.VR.fNi,Lc=this.VR.gNi;for(var Rc=0;Rc<this.vo.length;Rc++){var qd=this.vo[Rc],Ld=Oh.a[qd.groupType].toLowerCase(),zd=gc[Ld];hb+=qd.results.length;qd.results.length>zd&&(Ld=Lc[Ld],rf.c(Ld)||Ib.add(new pk.a(Ld,qd)))}Lc=!this.query||""===this.query.Fg.trim();
Rc=hb-(Lc?this.IPf:this.GPf);if(!(0>=Rc)){Lc=window.performance.now();hb=hb.toString()+" total,"+Rc.toString()+" to remove.";if(0<Ib.count)for(Ib.Sc((pf,Jc)=>pf.key>Jc.key?-1:1),qd=0;qd<Ib.count&&0<Rc;qd++){Ld=Ib.J(qd).value;zd=Oh.a[Ld.groupType].toLowerCase();let pf=Ld.results.length-gc[zd];pf>Rc&&(pf=Rc);0<pf&&(Ld.H8f(pf),hb+=zd+": "+pf.toString()+" results removed.",Rc-=pf)}if(0<Rc){hb+=Rc.toString()+" results left after trimming.";Ib=new Qe.a;gc=this.VR.kNi;for(qd=0;qd<this.vo.length;qd++)Ld=
this.vo[qd],zd=gc[Oh.a[Ld.groupType].toLowerCase()],rf.c(zd)||Ib.add(new pk.a(zd,Ld));Ib.Sc((pf,Jc)=>pf.key<Jc.key?-1:1);for(gc=0;0<Rc;)qd=Ib.J(gc++).value,Rc>=qd.results.length?(Array.remove(this.vo,qd),hb+=Oh.a[qd.groupType]+": "+qd.results.length.toString()+" results force removed.",Rc-=qd.results.length):(qd.H8f(Rc),hb+=Oh.a[qd.groupType]+": "+Rc.toString()+" results force removed.",Rc=0)}t.TellMeActor.instance.Pe&&(Ib={},Ib[a.a.message]=hb,t.TellMeActor.instance.Pe.QA("ShowOptimal",window.performance.now()-
Lc,Ib))}}}Object(l.a)(ge,"CombineResultsUpdatedEventArgs",null,[1282]);class bh{constructor(hb,Ib,gc,Lc=!1,Rc=""){this.uOe=this.aRe=!1;this.xv=hb;this.$yb=[];this.Dch=Ib.length;this.fc=t.TellMeActor.instance.aP();this.hqd=Lc;this.kga=Rc;this.Y0b={};for(hb=0;hb<Ib.length;++hb)this.Y0b[hb.toString()]=gc?0:Ib[hb].CU()}Eno(hb,Ib){Ib&&Ib.query&&Ib.query.Yob<t.TellMeActor.instance.Vta||(this.$yb[hb]=Ib,this.uOe?this.aRe=!0:(!this.fc||3!==this.fc.kv||3!==this.Y0b[hb.toString()]||this.fTh())&&this.VYd())}JCn(){this.uOe=
!0}YSo(){this.uOe=!1;this.aRe&&(this.aRe=!1,this.VYd())}fTh(){if(this.$yb.length<this.Dch)return!1;for(let hb=0;hb<this.Dch;++hb)if(!this.$yb[hb])return!1;return!0}VYd(){var hb=this.fTh();const Ib=window.performance.now(),gc=new ge(t.TellMeActor.instance.fYg);gc.C0n(this.$yb);for(var Lc=0;Lc<this.$yb.length;++Lc){var Rc=this.$yb[Lc];if(Rc&&Rc.vo&&Rc.vo.length&&(gc.query=Rc.query,Rc.attributes&&0<Rc.attributes.length&&(gc.attributes=Rc.attributes),Rc&&Rc.vo&&(hb||this.yXk(Lc,this.$yb))))for(const qd of Rc.vo)gc.gv(qd)}gc.vo&&
gc.vo.length&&(gc.Kdc=hb,this.fc&&this.fc.jne&&gc.fPo(),this.fc&&this.fc.AUm&&gc.query.Fg&&0<gc.query.Fg.length?gc.gBo():gc.fBo(),this.fc&&(this.fc.l0d||this.fc.f1d)&&this.hqd&&gc.query.Fg&&0<gc.query.Fg.length&&gc.Kdc&&this.kga!==e.a.contextMenu?(3===this.fc.kv&&hb||this.xv.resultsUpdated(gc),gc.hBo(this.xv)):this.xv.resultsUpdated(gc),hb=t.TellMeActor.instance.Pe,gc.Kdc&&hb&&(Lc=gc.query.Yob,Rc=hb.Ojd,gc.query.Fg&&0<gc.query.Fg.length&&this.hqd&&this.fc.x1d&&this.kga!==e.a.contextMenu&&Lc>Rc&&!this.fc.l0d&&
!this.fc.XP&&(hb.TNf(gc.query.Fg),hb.Bdg(Lc)),hb.QA(k.a.Q8n,window.performance.now()-Ib)))}yXk(hb,Ib){if(!(this.Y0b&&hb.toString()in this.Y0b)||Ib.length<=hb||!Ib[hb])return!1;if(!Ib[hb].vo.length)return!0;const gc=this.Y0b[hb.toString()];if(0===gc)return!0;const Lc=this.Y0b;for(let qd in Lc){var Rc=Lc[qd];const Ld=Number.parseInvariant(qd);if(Ld!==hb&&Rc===gc&&!(Ib.length>Ld&&Ib[Ld]))return!1}return!0}}Object(l.a)(bh,"ResultsAggregator",null,[]);var lj=c(1796);class ol{constructor(){this.Tnc=this.Unc=
this.Snc=this.logCount=this.logRank=this.invertedRank=0}dtk(hb,Ib){switch(hb){case 1:this.invertedRank=Ib;break;case 3:this.logRank=Ib;break;case 2:this.logCount=Ib;break;case 5:this.Snc=Ib;break;case 4:this.Unc=Ib;break;case 6:this.Tnc=Ib}}}Object(l.a)(ol,"CommandFeatures",null,[]);class Pf{constructor(hb){this.yVg=0;this.$Ba=hb;this.LZj={}}get modelId(){return this.$Ba}get featureIntercept(){return this.yVg}get mJc(){return this.LZj}ask(hb,Ib,gc){0===Ib?this.yVg=gc:(this.mJc[hb]||(this.mJc[hb]=
new ol),this.mJc[hb].dtk(Ib,gc))}}Object(l.a)(Pf,"CoefficientsModel",null,[]);const zi=(hb,Ib)=>Math.pow(10,-Ib/(60*Math.LN10/Math.LN2*hb));class $e{constructor(hb,Ib){this.$j=1;this.Kld=new ol;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=hb?1/hb:0;this.features.logRank=2/Math.pow(2,hb);this.features.Snc=zi(10,Ib);this.features.Unc=zi(2,Ib);this.features.Tnc=zi(1,Ib)}get count(){return this.$j}get features(){return this.Kld}mri(){this.$j=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}NZo(hb){const Ib=2/Math.pow(2,hb);this.features.invertedRank=Math.max(this.features.invertedRank,hb?1/hb:0);this.features.logRank=Math.max(this.features.logRank,Ib)}l0o(hb){const Ib=zi(10,hb),gc=zi(2,hb);hb=zi(1,hb);this.features.Snc=Math.max(this.features.Snc,Ib);this.features.Unc=Math.max(this.features.Unc,gc);this.features.Tnc=Math.max(this.features.Tnc,hb)}}Object(l.a)($e,"CommandModel",null,[]);class qn{constructor(hb){this.Fsc=null;if(!hb&&t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("PredictionEngine",
"IModelAdapter can't be null");this.yZb=hb;this.asd=this.SMf()}SMf(){const hb=this.yZb.y5l(),Ib=this.yZb.Vsf();if(void 0===hb||null===hb||void 0===Ib||null===Ib)return!1;try{window.performance.now();this.Fsc={};for(let gc=0;gc<hb.length;gc++){const Lc=hb[gc],Rc=Ib[Lc[0].toString()].trim(),qd=Lc[1],Ld=0!==qd?Ib[Lc[2].toString()].trim():"",zd=Lc[3];Rc in this.Fsc||(this.Fsc[Rc]=new Pf(Rc));this.Fsc[Rc].ask(Ld,qd,zd)}}catch(gc){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("LoadModelData",
"Error Loading Suggestions Model: "+gc);return!1}return!0}sLl(){const hb=this.yZb.R1l(),Ib={};if(!hb)return Ib;let gc=1;for(let Lc=0;Lc<hb.length;Lc++){const Rc=hb[Lc];Rc.Id in Ib?(Ib[Rc.Id].mri(),Ib[Rc.Id].NZo(gc),Ib[Rc.Id].l0o(Rc.TimeElapsedSinceClick)):Ib[Rc.Id]=new $e(gc,Rc.TimeElapsedSinceClick);gc++}return Ib}NGf(){this.asd||(this.asd=this.SMf());return this.asd}Y$l(){let hb=[];if(!this.asd){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("GetPredictedCommands","IModelAdapter returned no data");
return hb}const Ib=this.sLl(),gc=this.Fsc;for(let Rc in gc){const qd=gc[Rc],Ld=qd.modelId;let zd=0;for(let pf in Ib){var Lc=pf;const Jc=Ib[pf].features;(Lc=Lc in qd.mJc?qd.mJc[Lc]:null)&&(zd+=Jc.invertedRank*Lc.invertedRank+Jc.logRank*Lc.logRank+Jc.logCount*Lc.logCount+Jc.Snc*Lc.Snc+Jc.Unc*Lc.Unc+Jc.Tnc*Lc.Tnc)}zd+=qd.featureIntercept;hb.push(new Ef.a(Ld,zd))}hb.sort((Rc,qd)=>Rc.score<qd.score?1:Rc.score>qd.score?-1:0);0<hb.length-10&&(hb=hb.slice(0,10));return hb}}Object(l.a)(qn,"PredictionEngine",
null,[]);class fl{constructor(){this.Ifh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}fRd(hb,
Ib){return Ib&&"word"===Ib.application.toLowerCase()&&hb in this.Ifh?this.Ifh[hb]:[]}}Object(l.a)(fl,"SuggestionResultsUtility",null,[]);class Qj{constructor(hb,Ib,gc){this.fc=Ib;this.Lzc=new qn(hb);this.s3=gc;this.xih=new fl}qL(){return"Suggestion"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:2}eI(hb,Ib,gc,Lc=e.a.tellMe,Rc=null){gc=new n.a(hb);t.TellMeActor.instance.wed=!1;if((!Rc||Array.contains(Rc,16))&&z.a.GR(hb)){if(!this.Lzc.NGf()){if(t.TellMeActor.instance.Pe)t.TellMeActor.instance.Pe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.$0d()&&0<this.xih.fRd(t.TellMeActor.instance.sKd,this.fc).length){const Ld=this.xih.fRd(t.TellMeActor.instance.sKd,this.fc);Rc=[];for(var qd of Ld)this.fc.Pie&&"Find"===qd||Rc.push(new Ef.a(qd,0));t.TellMeActor.instance.wed=!0}else Rc=this.Lzc.Y$l();yh.CommandResultsUtility.w3d(Rc,!0,"Recommended","LRE");qd=[];for(const Ld of Rc)this.s3&&this.s3.E$e(Ld.commandId)||
qd.push(Ld);hb=yh.CommandResultsUtility.$Rc(hb,qd,this.fc,null,null,null,16,1);0<hb.results.length&&Lc!==e.a.contextMenu&&(hb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<hb.results.length&&gc.gv(hb)}Ib.resultsUpdated(gc)}$0d(){return!!this.fc&&(this.fc.$0d||this.fc.SYm)}}Object(l.a)(Qj,"SuggestionResultsProvider",null,[1307]);class rm{R1l(){return t.TellMeActor.instance.Lwe}y5l(){return window.TellMeSuggestionModel}Vsf(){return window.CoefficientModelIdMap}}Object(l.a)(rm,"SuggestionsModelAdapter",
null,[1331]);var Ai=c(1807),qk=c(1759);c.d(J,"AggregatorResultsProvider",function(){return pe});class pe{constructor(hb=!1){this.w_b={};this.w_b[e.a.tellMe]=[];this.w_b[e.a.contextMenu]=[];this.hqd=hb}rFi(hb,Ib,gc,Lc,Rc=null){let qd;var Ld=!1;switch(Lc){case e.a.contextMenu:qd=this.w_b[e.a.contextMenu];Ld=!0;break;default:qd=this.w_b[e.a.tellMe]}Ib=new bh(Ib,qd,Ld,this.hqd,Lc);Ib.JCn();for(let zd=0;zd<qd.length;++zd){const pf=window.performance.now(),Jc=new H(Ib,zd);(Ld=t.TellMeActor.instance.aP())&&
Ld.OMk?window.setTimeout(()=>{qd[zd].eI(hb,Jc,gc,Lc,Rc);if(t.TellMeActor.instance.Pe){const gg={};gg[a.a.provider]=qd[zd].qL();gg[a.a.rOb]=hb.Yob;t.TellMeActor.instance.Pe.QA(k.a.eI,window.performance.now()-pf,gg)}},0):(qd[zd].eI(hb,Jc,gc,Lc,Rc),t.TellMeActor.instance.Pe&&(Ld={},Ld[a.a.provider]=qd[zd].qL(),Ld[a.a.rOb]=hb.Yob,t.TellMeActor.instance.Pe.QA(k.a.eI,window.performance.now()-pf,Ld)))}Ib.YSo()}qL(){return"Aggregator"}CU(){return 0}eI(hb,Ib,gc=!1,Lc=e.a.tellMe,Rc=null){if(t.TellMeActor.instance.Zen)this.rFi(hb,
Ib,gc,Lc,Rc);else{const qd=window.performance.now();t.TellMeActor.instance.L4o.then(()=>{t.TellMeActor.instance.Pe&&t.TellMeActor.instance.Pe.QA(k.a.$en,window.performance.now()-qd);this.rFi(hb,Ib,gc,Lc,Rc);return!0})}}WE(hb,Ib){this.w_b[Ib].push(hb)}Ttk(hb){switch(hb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ib=this.w_b[e.a.tellMe];for(const gc of Ib)if("FindInDocument"===gc.qL()){gc.Klo(hb);break}}}static createInstance(hb,Ib,gc,Lc){const Rc=
Ib.mha;var qd=Lc&&z.a.qgg(Ib),Ld=qd&&Ib.NZf&&!Rc;const zd=Ib.VIf&&!z.a.eec()&&!Rc,pf=Ib.bHf&&!Rc,Jc=new pe(qd);if(Ib.dvo&&!Rc){var gg=new Rd(Ib);Jc.WE(gg,e.a.tellMe)}gg=Ib.Gr?vi.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):vi.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const dc=!gg&&vi.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Jc.WE(new kk.a(hb,Ib.bRo,dc,!1),e.a.tellMe);gg&&!Rc&&Jc.WE(new Qj(new rm,Ib,hb),e.a.tellMe);hb=vi.AFrameworkApplication.ta.Kb.$Di?
new ag(Ib,new xn):new Ml(Ib,gc);Jc.WE(hb,e.a.contextMenu);(qd&&Ib.OZf||Ld)&&Jc.WE(Ai.a.yOh(Ib,!0),e.a.tellMe);Jc.WE(hb,e.a.tellMe);!Ib.w0h||Rc||"Word"===Ib.application&&Ib.POd||Jc.WE(new jg(Ib),e.a.tellMe);Ib.rBb&&!Rc&&(Ld=new M(Ib),Jc.WE(Ld,e.a.tellMe),Jc.WE(Ld,e.a.contextMenu));!Ib.wBb||Ib.M$c||Ib.L$c||Rc||Jc.WE(new K.a(Ib),e.a.tellMe);Lc&&(Ib.E0||z.a.Npa())&&(Ld=new je(Ib),Jc.WE(Ld,e.a.tellMe),Jc.WE(Ld,e.a.contextMenu));qd&&Jc.WE(Ai.a.yOh(Ib,!1),e.a.tellMe);Lc&&!Ib.vkg&&z.a.pgg(Ib)&&!Rc&&(Jc.WE(new lj.a(Ib),
e.a.tellMe),Ib.uxj&&Jc.WE(new lj.a(Ib),e.a.contextMenu));zd&&Jc.WE(new am(Ib),e.a.tellMe);!Ib.Xlc&&!Ib.XP||Rc||Jc.WE(new Lh.a(Ib),e.a.tellMe);Ib.OYc&&!Rc&&Jc.WE(new qk.a(Ib),e.a.tellMe);Ib.HDf&&(qd=new I(Ib),Jc.WE(qd,e.a.tellMe),Jc.WE(qd,e.a.contextMenu));Lc&&Ib.jZd&&!Rc&&Jc.WE(new E.AddinResultsProvider(Ib),e.a.tellMe);pf&&"Excel"===Ib.application&&!Rc&&Jc.WE(new dk(Ib),e.a.tellMe);return Jc}}Object(l.a)(pe,"AggregatorResultsProvider",null,[1307])},1790:function(D,J,c){D=c(0);var l=c(16),e=c(6),
a=c(184),k=c(225),x=c(368);c(61);var y=c(69);c(954);c(877);var n=c(543);c(470);var t=c(1749),z=c(1750),v=c(1746),I=c(1748),E=c(1747);c(953);c(876);class H{constructor(ba,oa,ma){this.MKl=ba;this.hKk=oa;this.wVk=ma}}Object(D.a)(H,"BacktraceAndMakeUpdateHintsInput",null,[]);var M=c(1571),K;(function(ba){ba[ba.EOP=0]="EOP";ba[ba.character=1]="character";ba[ba.embeddedMarker=2]="embeddedMarker"})(K||(K={}));Object(D.b)("LCSBlockType",K);class L{toString(){return String.format("[Type: {0}]",K[this.type])}}
Object(D.a)(L,"ALCSBlock",null,[]);class S extends L{constructor(ba,oa){super();this.Vve=oa;this.eOe=ba}get type(){return 1}get character(){return this.Vve}get qTa(){return this.eOe}JA(ba){return 1===ba.type&&M.a.Kvh(ba.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(S,"CharacterLCSBlock",L,[]);class Q extends L{constructor(ba,oa,ma){super();this.eOe=ba;this.JYe=oa;this.Oyc=ma}get type(){return 0}get Wc(){return this.JYe}get length(){return this.Oyc}get qTa(){return this.eOe}JA(ba){return 0!==
ba.type?!1:ba.qTa===this.qTa&&ba.Wc===this.Wc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.qTa.toString(),this.Wc,this.length)}}Object(D.a)(Q,"EOPLCSBlock",L,[]);class N extends S{constructor(ba,oa,ma){super(ba,"\ufffc");this.fbk=oa;this.Cmd=ma}get type(){return 2}get vf(){return this.fbk}get Xj(){return this.Cmd}JA(ba){return 2!==ba.type?!1:ba.vf===this.vf&&this.Xj.equals(ba.Xj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",
super.toString(),this.vf,this.Xj)}}Object(D.a)(N,"EmbeddedMarkerLCSBlock",S,[]);class O{constructor(ba,oa){this.x=ba;this.y=oa}equals(ba){return ba.x===this.x&&ba.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(O,"IntPair",null,[1112]);var X=c(1613),U=c(1593),T=c(1614),Y=c(1745);c.d(J,"a",function(){return aa});class aa{constructor(ba,oa){this.Qg=ba;this.$d=oa}JOh(ba,oa,ma,ea,ua,sa,Fa){return this.mgl(ba,oa,ma,ea,ua,sa,Fa)}mgl(ba,oa,ma,ea,ua,sa,Fa){let Pa;Pa=null;({returnValue:ba}=
this.QSd(ba,oa));if(!ba)return a.a.instance.Ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.$d.logger.bV("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Pa};({returnValue:ma}=this.QSd(ma,ea));if(!ma)return a.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.$d.logger.bV("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Pa};this.$d.logger.bV("GetLCSBlocksFromObject");Pa=this.lgl(ba,ma,ua,sa,Fa);return Pa?{returnValue:!0,updateHints:Pa}:
(a.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:Pa})}l0h(ba,oa,ma,ea){({returnValue:ba}=this.QSd(ba,oa));if(!ba)return-1;({returnValue:ma}=this.QSd(ma,ea));if(!ma)return-1;({Rdf:ma}=this.p0h(ba,ma));return ma}QSd(ba,oa){let ma;const ea=new k.a;ma=new k.a;if(!ba.length)return a.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.$d.logger.Rg(Object.assign(new X.a,{zj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,
Ajf:ma};for(let Fa=0;Fa<ba.length;Fa++)if(this.$d.runtime.gH("GetLCSBlocksFromObject: paraObjs#"+Fa),393230===ba.J(Fa).Oc){const Pa=this.Qg.getPropertyString(ba.J(Fa),l.a.ho),Na=this.Qg.getPropertyUint32(ba.J(Fa),e.a.Wc);if(null==Na)return a.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.$d.logger.Rg(Object.assign(new X.a,{zj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,Ajf:ma};let Aa=this.Qg.getPropertyUint32s(ba.J(Fa),l.a.Im);Aa=U.a.Mnj(Aa,Pa.length);const za=
this.Qg.getPropertyObjectIds(ba.J(Fa),l.a.Rn);let xa;for(xa=0;xa<Aa.length-1;xa++){var ua=oa(za.eg(xa)),sa=void 0;sa=ua?(sa=this.Qg.getPropertyBool(ua,l.a.Z$))?sa:!1:!1;if(sa)ea.add(this.Eal(ba.J(Fa).id,ua));else for(ua=Aa.eg(xa);ua<Aa.eg(xa+1);ua++)ea.add(new S(ba.J(Fa).id,M.a.charAt(Pa,ua)))}ea.add(new Q(ba.J(Fa).id,Na,Aa.J(xa)));ma.add(ea.length-1)}else return a.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ba.J(Fa).Oc),this.$d.logger.Rg(Object.assign(new X.a,
{zj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,Ajf:ma};this.$d.runtime.gH("LCS: GetLCSBlocks for base");return{returnValue:ea,Ajf:ma}}Eal(ba,oa){const ma=null==this.Qg.getPropertyInt32(oa,e.a.Ns)?0:this.Qg.getPropertyInt32(oa,e.a.Ns);return new N(ba,ma,oa.id)}lgl(ba,oa,ma,ea,ua){ea=({Rdf:ma}=this.p0h(ba,oa,ma,ea,ua)).returnValue;this.$d.logger.bV("FindFurthestPaths");ba=new H(ea,ba,oa);ba=new Y.a(this.XJk(ba,ma),1);this.$d.logger.bV("BacktraceAndMakeUpdateHints");return ba}p0h(ba,
oa,ma=-1,ea=-1,ua=-1){let sa;if(-1===ma||-1===ea||-1===ua)ua=ea=ma=-1;sa=-1;const Fa=new x.a;Fa.Z(new O(-1,1),new O(0,-1));if(-1!==ma){Fa.Z(new O(0,0),new O(ma,ma));var Pa=1}else Pa=0,ea=ba.length,ua=oa.length;for(ma=0;Pa<=ba.length+oa.length;Pa++){let Na=!1;for(let Aa=-Pa;Aa<=Pa;Aa+=2){let za,xa;Aa===-Pa?(za=Fa.J(new O(Pa-1,Aa+1)).x,xa=Fa.J(new O(Pa-1,Aa+1)).y+1):Aa===Pa?(za=Fa.J(new O(Pa-1,Aa-1)).x+1,xa=Fa.J(new O(Pa-1,Aa-1)).y):Fa.J(new O(Pa-1,Aa-1)).x>=Fa.J(new O(Pa-1,Aa+1)).x?(za=Fa.J(new O(Pa-
1,Aa-1)).x+1,xa=Fa.J(new O(Pa-1,Aa-1)).y):(za=Fa.J(new O(Pa-1,Aa+1)).x,xa=Fa.J(new O(Pa-1,Aa+1)).y+1);for(;za<ea&&xa<ua&&ba.J(za).JA(oa.J(xa));)za++,xa++;Fa.Z(new O(Pa,Aa),new O(za,xa));if(za===ea&&xa===ua){Na=!0;sa=Pa;ma=Aa;break}}if(Na)break;this.$d.runtime.gH("LCS FindFurthestPaths")}if(ma!==ea-ua)return{returnValue:null,Rdf:sa};Fa.Z(new O(sa,ma),new O(ea+1,ua+1));a.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ba.length,
oa.length,sa);return{returnValue:Fa,Rdf:sa}}XJk(ba,oa){const ma=ba.MKl,ea=ba.hKk;ba=ba.wVk;const ua=new k.a;let sa=ea.length,Fa=ba.length;for(;0<sa||0<Fa;){var Pa=sa-1,Na=Fa-1;if(this.ICn(ma,oa,sa,Fa)){Pa=ba.J(Na);if(1===Pa.type||2===Pa.type)this.FFm(ua,sa,Pa);else if(0===Pa.type)this.cFm(ua,sa,Pa);else return a.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Pa.type),this.$d.logger.Rg(Object.assign(new T.a,{zj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),
null;Fa--;oa--}else if(this.HCn(ma,oa,sa,Fa)){Na=ea.J(Pa);if(1===Na.type||2===Na.type)this.Wll(ua,Pa,Na);else if(0===Na.type)this.Bll(ua,Pa,Na);else return a.a.instance.Ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",Na.type),this.$d.logger.Rg(Object.assign(new T.a,{zj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;sa--;oa--}else if(sa&&Fa&&ea.J(Pa).JA(ba.J(Na)))sa--,Fa--;else return a.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),
this.$d.logger.Rg(Object.assign(new T.a,{zj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.$d.runtime.gH("LCS: CreateUpdateHintsFromLCSBlocks");return ua}HCn(ba,oa,ma,ea){oa=new O(oa-1,ma-ea-1);return ba.nb(oa)&&ba.J(oa).x===ma-1&&ba.J(oa).y===ea}ICn(ba,oa,ma,ea){oa=new O(oa-1,ma-ea+1);return ba.nb(oa)&&ba.J(oa).x===ma&&ba.J(oa).y===ea-1}cFm(ba,oa,ma){ma=new v.a(ma.qTa,ma.Wc);let ea=!1;if(0<ba.length&&11===ba.eg(ba.length-1).type){const ua=ba.eg(ba.length-1);ua.cp===oa&&(ea=!0,ua.y0.add(ma))}ea||
(oa=new E.a(oa),oa.y0.add(ma),ba.add(oa))}FFm(ba,oa,ma){var ea=!1;if(0<ba.length&&11===ba.eg(ba.length-1).type){const ua=ba.eg(ba.length-1);ua.cp===oa&&((ea=Object(y.a)(I.a,ua.y0.J(ua.y0.length-1)))?ea.text=ma.character.toString()+ea.text:ua.y0.add(new I.a(ma.qTa,ma.character.toString())),ea=!0)}ea||(oa=new E.a(oa),oa.y0.add(new I.a(ma.qTa,ma.character.toString())),ba.add(oa))}Bll(ba,oa,ma){oa=new t.a(oa,ma.qTa,ma.Wc);ba.add(oa)}PLc(ba,oa){let ma=!1;if(0<ba.updateHints.length&&2===ba.updateHints.eg(ba.updateHints.length-
1).type){const ea=ba.updateHints.eg(ba.updateHints.length-1);ea.Bg.equals(oa.qTa)&&ea.cp===oa.p$d&&(ea.cp=oa.p$d-1,ea.text=(void 0).character.toString()+ea.text,ma=!0)}ma||ba.updateHints.add(new n.DeleteTextUpdateHint(oa.qTa,oa.p$d-1,(void 0).character.toString()));--oa.p$d}Wll(ba,oa,ma){let ea=!1;if(0<ba.length&&8===ba.eg(ba.length-1).type){const ua=ba.eg(ba.length-1);ua.cp===oa+1&&(ua.text=ma.character.toString()+ua.text,--ua.cp,ea=!0)}ea||ba.add(new z.a(oa,ma.character.toString()))}}Object(D.a)(aa,
"LCSUpdateHintGenerator",null,[])},1795:function(D,J,c){c.r(J);D=c(0);var l=c(16),e=c(6),a=c(184),k=c(368),x=c(613),y=c(225),n=c(61),t=c(55),z=c(1560);class v extends z.a{constructor(){super()}get vha(){return"ChildNodeListMerge"}}Object(D.a)(v,"ChildNodeListMergeFailureDetail",z.a,[]);class I{Rrb(aa,ba,oa){return ba.Gz(aa,oa.J(aa))}VCj(aa,ba,oa,ma){let ea;return({value:ea}=ba.Fc(aa)).returnValue||({value:ea}=oa.Fc(aa)).returnValue?ea:ma.J(aa)}}Object(D.a)(I,"ChildNodeListMergeUtils",null,[1904]);
var E=c(1586),H=c(1806),M=c(1659);class K{constructor(aa,ba){this.classId=aa;this.DRo=ba}}Object(D.a)(K,"NodeChildrenTransformation",null,[]);var L=c(817),S=c(1577);class Q{constructor(aa,ba,oa){this.ZE=aa;this.Yra=oa;this.P8=ba}nbe(aa){let ba,oa;return({H5i:ba}=this.$Cj(this.Yra,aa)).returnValue&&ba.DY||({H5i:oa}=this.$Cj(this.P8,aa)).returnValue&&oa.DY}$Cj(aa,ba){let oa;return{returnValue:({value:oa}=(new S.a(this.ZE,aa)).Vqa.Fc(L.a.Ab(ba))).returnValue,H5i:oa}}}Object(D.a)(Q,"NodeTriplet",null,
[]);var N=c(1743);class O{constructor(aa,ba,oa){this.$d=aa;this.Qg=ba;this.N7=oa;this.sih=!0}get tq(){return this.$d}get Xd(){return this.Qg}get zAa(){return this.N7}get success(){return this.sih}f$l(){a.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");const aa=new k.a;this.a6e(aa,ba=>this.tq.runtime.uk.J(ba));this.a6e(aa,ba=>this.zAa.Rrb(ba,this.tq.runtime.Nu,this.tq.runtime.uk));this.a6e(aa,ba=>this.zAa.Rrb(ba,this.tq.runtime.Mq,this.tq.runtime.uk));return aa}a6e(aa,ba){const oa=ba(c(1795).ChildNodeListMerge.b$d);
this.Xd.getPropertyObjectIds(oa,l.a.gf).forEach(ma=>{this.Xd.getPropertyObjectIds(ba(ma),l.a.gf).forEach(ea=>{aa.nb(ea)&&!ma.equals(aa.J(ea))&&(this.sih=!1,a.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",ea,ma,aa.J(ea)));aa.Z(ea,ma);return!0});return!0})}}Object(D.a)(O,"OutlineGroupParentFinder",null,[]);var X=c(1561),U=c(1615),T=c(1660);c.d(J,"ChildNodeListMerge",function(){return Y});class Y{constructor(aa,ba=null,oa=null,ma=null,ea=
null){this.Qg=aa;this.WAn=ba||H.a.uDj;this.n6d=oa||this.c7l();this.zAa=ma||new I;this.gPi=ea||this.b5l()}get Xd(){return this.Qg}c7l(){return[new K(393227,Object(t.a)(this,this.Fzn,"pageContentNodeThreewayChildMerge")),new K(1073872968,Object(t.a)(this,this.J8o,"wordSectionNodeThreewayChildMerge")),new K(393241,Object(t.a)(this,this.S9d,"outlineElementContainerThreewayChildMerge")),new K(393252,Object(t.a)(this,this.RHo,"tableCellThreewayChildMergev2")),new K(1074135125,Object(t.a)(this,this.S9d,
"outlineElementContainerThreewayChildMerge")),new K(1074135123,Object(t.a)(this,this.S9d,"outlineElementContainerThreewayChildMerge")),new K(1074135127,Object(t.a)(this,this.S9d,"outlineElementContainerThreewayChildMerge"))]}b5l(){return[Object(t.a)(this,this.mHn,"prepareObjectGroupings"),Object(t.a)(this,this.Npm,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.lDn,"performThreewayChildMerge")]}edn(aa){let ba=0;for(;ba<this.gPi.length;ba++)if(!(0,this.gPi[ba])(aa))return a.a.instance.Ua(4273296,
1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ba),aa.logger.J3d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ba),!1;return!0}mHn(aa){const ba=new k.a,oa=new k.a,ma=new x.a;aa.runtime.Nu.forEach((ea,ua)=>Y.v1i(ua,ba));aa.runtime.Mq.forEach((ea,ua)=>Y.v1i(ua,oa));for(let ea=0;ea<this.n6d.length;ea++){const ua=this.n6d[ea].classId;aa.runtime.unb.Z(ua,new k.a);ba.nb(ua)&&ba.J(ua).forEach(sa=>{var Fa=aa.runtime.uk.J(sa.id);Fa&&(Fa=new Q(Fa,sa,aa.runtime.Mq.Gz(sa.id,Fa)),aa.runtime.unb.J(ua).add(sa.id,
Fa),ma.add(sa.id));return!0});oa.nb(ua)&&oa.J(ua).forEach(sa=>{if(ma.contains(sa.id))return!0;const Fa=aa.runtime.uk.J(sa.id);Fa&&aa.runtime.unb.J(ua).add(sa.id,new Q(Fa,Fa,sa));return!0})}aa.runtime.gH("PrepareObjectGroupings");aa.logger.Sia("PrepareObjectGroupings");return!0}lDn(aa){let ba=!0;for(let oa=0;ba&&oa<this.n6d.length;oa++){const ma=this.n6d[oa];aa.runtime.gH("Before function#"+oa);const ea=ma.classId;aa.runtime.unb.J(ea).forEach((ua,sa)=>{aa.runtime.GOa.contains(sa.ZE.id)||(ba=ma.DRo(aa,
sa)&&ba);ba||(a.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ea,sa.ZE.id),aa.logger.Rg(Object.assign(new v,{zj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ba});aa.runtime.gH("PerformThreewayChildMerge"+oa)}aa.logger.Sia("PerformThreewayChildMerge");return ba}Fzn(aa,ba){if(ba.nbe(l.a.gf)){var oa=this.Xd.getPropertyObjectIds(ba.ZE,l.a.gf);const ma=this.Xd.getPropertyObjectIds(ba.P8,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba.Yra,l.a.gf);
oa=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",oa.length,ma.length,ba.length,aa.input.source);a.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",oa);aa.logger.Rg(Object.assign(new v,{zj:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:oa}));return!1}return!0}J8o(aa,ba){if(ba.nbe(l.a.gf)){const Pa=new x.a,Na=new x.a,Aa=new x.a,za=new x.a;var oa=this.Xd.getPropertyObjectIds(ba.ZE,
l.a.gf),ma=oa.hH(),ea,ua=({hLh:ea}=this.xKj(ba.P8,ma,Pa,"Favored")).returnValue,sa=({hLh:Fa}=this.xKj(ba.Yra,ma,Na,"Unfavored")).returnValue;if(!ua||!sa)return oa=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ma.count,Pa.count,Na.count,ea,Fa),aa.logger.Rg(Object.assign(new v,{zj:"WordSectionNodeThreewayChildMerge",info:oa})),!1;oa.forEach(xa=>{Pa.contains(xa)||
Aa.add(xa);Na.contains(xa)||za.add(xa);return!0});ba=ba.ZE.ZK();ma=new y.a;for(ea=0;ea<oa.length;ea++){var Fa=oa.eg(ea);if(Aa.contains(Fa)||za.contains(Fa)){if(aa.runtime.GOa.add(Fa),ma.length&&(ua=ma.eg(ma.length-1),ua=aa.runtime.unb.J(393241).J(ua),sa=aa.runtime.unb.J(393241).J(Fa),ua&&sa))Aa.contains(Fa)?za.contains(Fa)||(ua.ZE=ua.ZE.ZK(),ua.Yra=ua.Yra.ZK(),this.uDd(ua.ZE,sa.ZE),this.uDd(ua.Yra,sa.Yra)):(ua.ZE=ua.ZE.ZK(),ua.P8=ua.P8.ZK(),this.uDd(ua.ZE,sa.ZE),this.uDd(ua.P8,sa.P8))}else ma.add(Fa)}this.Xd.setPropertyObjectIds(ba,
l.a.gf,ma);oa=new X.a(ba);oa.DC(l.a.gf);aa.runtime.vn.Z(ba.id,oa)}return!0}uDd(aa,ba){const oa=this.Xd.getPropertyObjectIds(aa,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba,l.a.gf);const ma=oa.S5();ba.forEach(ea=>{ma.add(ea);return!0});this.Xd.setPropertyObjectIds(aa,l.a.gf,ma)}xKj(aa,ba,oa,ma){let ea=0,ua=!0;this.Xd.getPropertyObjectIds(aa,l.a.gf).forEach(sa=>{ba.contains(sa)?oa.add(sa):(ua=!1,a.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ma,sa),ea++);
return!0});return{returnValue:ua,hLh:ea}}Npm(aa){let ba=!0;aa.runtime.unb.J(393241).forEach((oa,ma)=>{if(this.OPm(ma)){a.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ma.ZE.id);let ea;const ua=new O(aa,this.Xd,this.zAa);if(({P_i:oa,kMj:ea}=this.XPo(aa,ua.f$l(),ma)).returnValue)return a.a.instance.Ua(4220303,1,4,"Merging WordSection {0} as a unit.",ea),ba=ua.success&&this.Vdn(aa,ea,oa)&&ba,ba||(a.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ma.ZE.id,ua.success),aa.logger.Rg(Object.assign(new v,{zj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ua.success)}))),ba}return!0});return ba}OPm(aa){if(!aa.nbe(l.a.gf))return!1;const ba=this.Xd.getPropertyObjectIds(aa.ZE,l.a.gf).J(0),oa=this.Xd.getPropertyObjectIds(aa.P8,l.a.gf);aa=this.Xd.getPropertyObjectIds(aa.Yra,l.a.gf);return!oa.contains(ba,(ma,ea)=>ma.equals(ea))||!aa.contains(ba,(ma,ea)=>ma.equals(ea))}XPo(aa,
ba,oa){ba=ba.J(oa.ZE.id);a.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",oa.ZE.id,ba);if(aa.runtime.GOa.contains(ba))return a.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",ba),{returnValue:!1,P_i:null,kMj:ba};const ma=new N.a;oa=aa.runtime.uk.J(ba);this.Xd.getPropertyObjectIds(oa,l.a.gf).forEach(ea=>
{ma.tDd(ea);return!0});oa=this.zAa.Rrb(ba,aa.runtime.Nu,aa.runtime.uk);this.Xd.getPropertyObjectIds(oa,l.a.gf).forEach(ea=>{ma.vDd(ea);return!0});aa=this.zAa.Rrb(ba,aa.runtime.Mq,aa.runtime.uk);this.Xd.getPropertyObjectIds(aa,l.a.gf).forEach(ea=>{ma.zDd(ea);return!0});return{returnValue:!0,P_i:ma,kMj:ba}}H2f(aa,ba,oa,ma,ea){let ua=!0;aa.forEach(sa=>{const Fa=ba(sa);this.Xd.getPropertyObjectIds(Fa,l.a.gf).forEach(Pa=>{oa.add(Pa);if(ma.nb(Pa))return(ua=ma.J(Pa).equals(sa)&&ua)||a.a.instance.Ua(4273300,
1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ea,Pa,sa,ma.J(Pa)),ua;ma.Z(Pa,sa);return!0});return!0});return ua}t8l(aa,ba){let oa,ma,ea,ua;oa=new y.a;ma=new y.a;ea=new y.a;ua=new k.a;const sa=aa.runtime.uk;return this.H2f(ba.zBb,Fa=>sa.J(Fa),oa,ua,"Base")&&this.H2f(ba.Hkf,Fa=>this.zAa.Rrb(Fa,aa.runtime.Nu,sa),ma,ua,"Favored")&&this.H2f(ba.Urb,Fa=>this.zAa.Rrb(Fa,aa.runtime.Mq,sa),ea,ua,"Unfavored")?{returnValue:!0,lxh:oa,f_h:ma,
sEj:ea,nTi:ua}:{returnValue:!1,lxh:oa,f_h:ma,sEj:ea,nTi:ua}}TFl(aa,ba,oa,ma){let ea=!0;const ua=aa.runtime.uk,sa=aa.runtime.Nu,Fa=aa.runtime.Mq,Pa=aa.runtime.vn,Na=new y.a,Aa=new k.a;oa.forEach(za=>{const xa=ma.J(za);if(!xa)return a.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",za),aa.logger.Rg(Object.assign(new v,{zj:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),ea=!1;xa.equals(Na.last())||(Na.add(xa),Aa.add(xa,new y.a));Aa.J(xa).add(za);
aa.runtime.GOa.add(za);return!0});if(!ea)return!1;Aa.forEach((za,xa)=>{const ka=this.zAa.VCj(za,sa,Fa,ua).ZK();this.Xd.setPropertyObjectIds(ka,l.a.gf,xa);Pa.Z(za,new X.a(ka));Pa.J(za).DC(l.a.gf);aa.runtime.GOa.add(za);return ea});oa=this.zAa.VCj(ba,sa,Fa,ua).ZK();this.Xd.setPropertyObjectIds(oa,l.a.gf,Na);Pa.Z(ba,new X.a(oa));Pa.J(ba).DC(l.a.gf);aa.runtime.GOa.add(ba);return ea}Vdn(aa,ba,oa){let ma,ea;if(!({lxh:ua,f_h:ma,sEj:ea,nTi:oa}=this.t8l(aa,oa)).returnValue)return!1;var ua=E.b(ua,ma,ea);ua=
this.f_f(aa,ua);return!!ua&&this.TFl(aa,ba,ua,oa)}S9d(aa,ba){return this.L_i(aa,ba)}L_i(aa,ba){if(ba.nbe(l.a.gf)){var oa=this.p8l(ba);oa=this.f_f(aa,oa);if(!oa)return a.a.instance.Ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.ZE.id),aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),M.a(ba.ZE,"OutlineElementContainerThreewayChildMerge_Base",
1),M.a(ba.P8,"OutlineElementContainerThreewayChildMerge_Favored",1),M.a(ba.Yra,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ma=this.Xd.getPropertyObjectIds(ba.ZE,l.a.gf);const ea=oa.hH();ma.forEach(ua=>{ea.contains(ua)||(ua=this.Xd.getPropertyObjectIds(ba.ZE,l.a.bL),0<ua.length&&aa.runtime.U_f.add(ua.J(0)));return!0});ma=ba.P8.ZK();this.Xd.setPropertyObjectIds(ma,l.a.gf,oa);aa.runtime.vn.Z(ma.id,new X.a(ma));aa.runtime.vn.J(ma.id).DC(l.a.gf)}return!0}jKb(aa){if(!aa)return a.a.instance.Ua(573957964,
1,2,"Feature helper is null"),!1;aa.Xx(107);return aa.isFeatureEnabled(107)}RHo(aa,ba){if(!this.jKb(aa.runtime.Zb))return this.mlg(aa,ba);var oa=ba.ZE.id,ma=T.e(aa,ba.ZE,null);if(ma.equals(n.a.nil))return a.a.instance.Ua(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",oa),aa.logger.Rg(Object.assign(new U.a,{info:"Table node ID could not be found for table cell"})),!1;var ea=aa.runtime.NCb.J(ma);if(ea&&(ea=ea.J(oa)))if(ea.hg)ba=ba.P8.ZK(),ba.removeProperty(l.a.gf),
this.Xd.setPropertyBool(ba,e.a.ghostCell,!0),null!=ea.colSpan?this.Xd.setPropertyUint32(ba,e.a.colSpan,ea.colSpan):ba.removeProperty(e.a.colSpan),aa.runtime.vn.Z(ba.id,new X.a(ba)),aa.runtime.vn.J(ba.id).DC(l.a.gf),aa.runtime.vn.J(ba.id).DC(e.a.ghostCell),aa.runtime.vn.J(ba.id).DC(e.a.colSpan);else{let ua,sa;({nEd:ma,qOd:ua,Yne:sa}=this.$3l(aa,ba,ea,ma));if(!ua.length&&!sa.length)return a.a.instance.Ua(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",oa),
aa.logger.Rg(Object.assign(new U.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ua.length?sa.length?(oa=E.b(ma,ua,sa),oa=this.f_f(aa,oa)):oa=ua:oa=sa;if(!oa)return a.a.instance.Ua(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.ZE.id),aa.logger.Rg(Object.assign(new v,{zj:"TableCellThreewayChildMergev2",eventId:"8n426"})),M.a(ba.ZE,"TableCellThreewayChildMergev2_Base",
1),M.a(ba.P8,"TableCellThreewayChildMergev2_Favored",1),M.a(ba.Yra,"TableCellThreewayChildMergev2_Unfavored",1),!1;ba=ba.P8.ZK();this.Xd.setPropertyObjectIds(ba,l.a.gf,oa);ba.removeProperty(e.a.ghostCell);oa=ea.rowSpan;ea=ea.colSpan;null!=oa&&null!=ea&&(1<oa||1<ea)?(this.Xd.setPropertyUint32(ba,e.a.rowSpan,oa),this.Xd.setPropertyUint32(ba,e.a.colSpan,ea)):(ba.removeProperty(e.a.rowSpan),ba.removeProperty(e.a.colSpan));aa.runtime.vn.Z(ba.id,new X.a(ba));aa.runtime.vn.J(ba.id).DC(l.a.gf);aa.runtime.vn.J(ba.id).DC(e.a.ghostCell);
aa.runtime.vn.J(ba.id).DC(e.a.rowSpan);aa.runtime.vn.J(ba.id).DC(e.a.colSpan)}else return this.mlg(aa,ba);aa.logger.Sia("TableCellThreewayChildMergev2");return!0}$3l(aa,ba,oa,ma){let ea,ua;({nEd:ba,qOd:ea,Yne:ua}=this.B9h(ba));ba||(ba=new y.a);ea||(ea=new y.a);ua||(ua=new y.a);var sa=ba.hH(),Fa=ea.hH(),Pa=ua.hH(),Na=oa.O6d;if(Na)for(var Aa=0;Aa<Na.length;Aa++){var za=Na.J(Aa),xa=aa.runtime.uk.J(za);!sa.contains(za)&&xa&&(sa.add(za),ba.add(za));!Fa.contains(za)&&aa.runtime.Nu.Gz(za,xa)&&(Fa.add(za),
ea.add(za));!Pa.contains(za)&&aa.runtime.Mq.Gz(za,xa)&&(Pa.add(za),ua.add(za))}aa.logger.Sia("OENodesAddedToChildrenList");if(Na=oa.$wf)for(Aa=0;Aa<Na.length;Aa++)if(za=Na.J(Aa),xa=aa.runtime.uk.J(za)){var ka=this.Xd.getPropertyObjectIds(xa,l.a.gf);if(ka)for(var wa=0;wa<ka.length;wa++){var ia=ka.J(wa);sa.contains(ia)||(sa.add(ia),ba.add(ia))}ka=aa.runtime.Nu.Gz(za,xa);if(ka=this.Xd.getPropertyObjectIds(ka,l.a.gf))for(wa=0;wa<ka.length;wa++)ia=ka.J(wa),Fa.contains(ia)||(Fa.add(ia),ea.add(ia));za=aa.runtime.Mq.Gz(za,
xa);if(za=this.Xd.getPropertyObjectIds(za,l.a.gf))for(xa=0;xa<za.length;xa++)ka=za.J(xa),Pa.contains(ka)||(Pa.add(ka),ua.add(ka))}aa.logger.Sia("GhostCellOENodesAddedToChildrenList");if(oa=oa.nUf)for(sa=0;sa<oa.length;sa++)if(Fa=oa.J(sa),Fa=aa.runtime.NCb.J(ma).J(Fa))if(Fa=Fa.O6d){Fa=Fa.hH();Pa=new y.a;for(Na=0;Na<ba.length;Na++)Fa.contains(ba.J(Na))||Pa.add(ba.J(Na));ba=Pa;Pa=new y.a;for(Na=0;Na<ea.length;Na++)Fa.contains(ea.J(Na))||Pa.add(ea.J(Na));ea=Pa;Pa=new y.a;for(Na=0;Na<ua.length;Na++)Fa.contains(ua.J(Na))||
Pa.add(ua.J(Na));ua=Pa}aa.logger.Sia("NonGhostCellsOENodesRemovedFromChildrenList");return{nEd:ba,qOd:ea,Yne:ua}}mlg(aa,ba){let oa=ba.P8.hasProperty(l.a.gf),ma=ba.Yra.hasProperty(l.a.gf);oa&&(oa=!!this.Xd.getPropertyObjectIds(ba.P8,l.a.gf).length);ma&&(ma=!!this.Xd.getPropertyObjectIds(ba.Yra,l.a.gf).length);if(oa!==ma)if(this.yWm(aa.runtime.Zb))aa.logger.AKi(Object.assign(new U.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return aa.logger.Rg(Object.assign(new U.a,{info:"TableCell OE missing children, ghost cell likely touched"})),
!1;return this.L_i(aa,ba)}p8l(aa){let ba,oa;({nEd:aa,qOd:ba,Yne:oa}=this.B9h(aa));return E.b(aa,ba,oa)}f_f(aa,ba){a.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ba.length);const oa=new y.a;let ma=!0;ba.forEach(ea=>{if(!ea)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ma=!1;if(1===ea.Men&&1===ea.Xmb){const ka=ea.zBb.J(0),wa=ea.Hkf.J(0),ia=ea.Urb.J(0);
if(ka&&ka.equals(wa)&&ka.equals(ia))return oa.add(ka),!0;if(1!==ba.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ka,wa,ia,ba.length),aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ma=!1}const ua=new k.a,sa=new y.a,Fa=new y.a,Pa=new y.a,Na=new y.a,Aa=new y.a,
za=new y.a,xa=aa.runtime.uk;ea.zBb.forEach(ka=>ma=this.D3f(aa,ka,wa=>xa.J(wa),sa,Na,ua,"Base"));if(!ma)return a.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ea.Hkf.forEach(ka=>ma=this.D3f(aa,ka,wa=>this.zAa.Rrb(wa,aa.runtime.Nu,xa),Fa,Aa,ua,"Favored"));if(!ma)return a.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ea.Urb.forEach(ka=>ma=this.D3f(aa,ka,wa=>this.zAa.Rrb(wa,aa.runtime.Mq,xa),Pa,za,ua,"Unfavored"));if(!ma)return a.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),aa.logger.Rg(Object.assign(new v,{zj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;aa.runtime.Zb&&aa.runtime.Zb.Tjb(1000005)&&(Aa.length&&this.QBl(Aa,
aa.runtime.Nu)?(this.zqh(Aa,aa,oa,ua),this.sCd(aa,ua,za)):this.zqh(za,aa,oa,ua));if(sa.length){ea=null;if(!({vn:ea}=this.WAn(aa,sa,Fa,Pa,ea)).returnValue||!ea)return ma=!1;ea.forEach(ka=>{0<ka.u1b.count&&aa.runtime.vn.Z(ka.Dm.id,ka);oa.add(ua.J(ka.Dm.id));return!0})}return!0});return ma?oa:null}QBl(aa,ba){for(let oa=0;oa<aa.length;oa++)if(ba.get(aa.eg(oa).id))return!0;return!1}sCd(aa,ba,oa){oa.length&&(oa.forEach(ma=>{aa.runtime.xmc.add(ma.id);aa.runtime.xmc.add(ba.J(ma.id));return!0}),H.a.sCd(aa,
this.Xd,oa.J(0)))}zqh(aa,ba,oa,ma){aa.forEach(ea=>{const ua=new X.a(ea.ZK());ba.runtime.vn.Z(ea.id,ua);oa.add(ma.J(ea.id));return!0})}D3f(aa,ba,oa,ma,ea,ua,sa){var Fa=oa(ba);if(!Fa)return a.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",sa,ba),aa.logger.Rg(Object.assign(new v,{zj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",sa)})),!1;const Pa=this.Xd.getPropertyObjectIds(Fa,l.a.bL);if(!Pa||
!Pa.length)return a.a.instance.Ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",sa,ba),aa.logger.Rg(Object.assign(new v,{zj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",sa)})),M.a(Fa,"ProcessOutlineElement_"+sa,1),!1;Fa=Pa.eg(0);oa=oa(Fa);if(!oa)return a.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",sa,
Fa,ba),aa.logger.Rg(Object.assign(new v,{zj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",sa)})),!1;if((sa=this.Xd.getPropertyString(oa,e.a.BN))&&""!==sa&&aa.runtime.Zb&&(aa.runtime.Zb.UVd(1000005),aa.runtime.Zb.Tjb(1000005)))return ea.add(oa),ua.add(Fa,ba),aa.runtime.GOa.add(Fa),!0;ma.add(oa);ua.add(Fa,ba);aa.runtime.GOa.add(Fa);return!0}B9h(aa){let ba,oa;ba=this.Xd.getPropertyObjectIds(aa.ZE,l.a.gf);oa=this.Xd.getPropertyObjectIds(aa.P8,
l.a.gf);aa=this.Xd.getPropertyObjectIds(aa.Yra,l.a.gf);return{nEd:ba,qOd:oa,Yne:aa}}yWm(aa){if(!aa)return a.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;aa.Xx(106);return aa.isFeatureEnabled(106)}static v1i(aa,ba){ba.nb(aa.Oc)||ba.Z(aa.Oc,new y.a);ba.J(aa.Oc).add(aa);return!0}}Y.b$d=n.a.If("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(Y,"ChildNodeListMerge",null,[1872])},1796:function(D,J,c){D=c(0);var l=c(1524),e=c(1653),a=c(1572),k=c(1542),x=c(1735),y=c(1589);class n{constructor(ba,
oa){this.DimensionValue=this.DimensionName=null;this.DimensionName=ba;this.DimensionValue=oa}}Object(D.a)(n,"Dimension",null,[]);class t{constructor(ba,oa,ma,ea,ua){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ba;this.Query=oa;this.From=ma;this.Size=ea;ua&&(this.Filter=ua)}}Object(D.a)(t,"EntityRequest",null,[]);class z{constructor(ba){this.QueryString=null;this.QueryString=ba}}Object(D.a)(z,"Query",null,[]);var v=c(1526);class I{constructor(ba,oa){this.Dimensions=
this.Name=null;this.Name=ba;this.Dimensions=oa}}Object(D.a)(I,"Scenario",null,[]);var E=c(1529),H=c(1528);class M{constructor(ba,oa,ma,ea){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ba;this.TimeZone=oa;this.Cvid=ma;this.Scenario=ea}}Object(D.a)(M,"SubstrateBody",null,[]);var K=c(1588),L=c(1522),S=c(1521),Q=c(2),N=c(1728),O=c(1727),X=c(1559),U=c(35),T=c(19),Y=c(139);c.d(J,"a",function(){return aa});class aa{constructor(ba){this.HAc=this.Ldb=this.Asd=this.zvc=
this.tBc=0;this.T8g=this.ubh=this.AQ=null;this.sJe=0;this.O2=-1;this.dEc="";this.DCe=!1;this.Zf=Q.AFrameworkApplication.He;this.fc=ba;this.wyd=this.zvf();this.hzb=new e.a;this.i7g=this.fc.jne?3:2;this.GVe=this.fc.jne&&this.fc.htj?5:3;this.YYe=this.fc.Pie?2:3;this.$mh=1;this.Erd=this.fc.Hdi;this.Bhh=this.fc.IVm;this.sCc=ba.Khi;Q.AFrameworkApplication.K&&(this.ubh=Q.AFrameworkApplication.K.kb("AppCatalogUrl")+Q.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.DCe=this.fc.P7b||this.fc.mha||
this.fc.TMd);this.fc.mha&&(this.YYe=this.GVe=5)}qL(){return"Substrate"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:3}eI(ba,oa,ma,ea=l.a.tellMe,ua=null){const sa=new H.a(ba);if(!ua||Array.contains(ua,14)||Array.contains(ua,15)||Array.contains(ua,20))if(!this.sJe||window.performance.now()-this.sJe>=S.a.b9a)if(ma=this.hzb.qii())this.sJe=window.performance.now(),ma.then(Fa=>{Fa&&""!==Fa?(this.dEc=Fa,""!==this.AQ&&this.pii(ba,ea,this.dEc,oa,ua)):(L.TellMeActor.instance.Pe.onError("SubstrateResultsProvider:IssueQuery",
"Empty or null token returned"),oa.resultsUpdated(sa))},Fa=>{L.TellMeActor.instance.Pe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Fa);oa.resultsUpdated(sa)});else{if(L.TellMeActor.instance.Pe)L.TellMeActor.instance.Pe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");oa.resultsUpdated(sa)}else this.dEc&&""!==this.dEc?this.pii(ba,ea,this.dEc,oa,ua):(oa.resultsUpdated(sa),L.TellMeActor.instance.Pe.onError("SubstrateResultsProvider:IssueQuery",
"Not able to acquire token"));else oa.resultsUpdated(sa)}rza(){this.Ldb=this.HAc=this.Asd=this.zvc=this.tBc=0}pii(ba,oa,ma,ea,ua){this.rza();const sa=new H.a(ba),Fa=this.AQ=Y.a.create().toString();this.SDa();this.O2=window.setTimeout(()=>{if(Fa===this.AQ){this.AQ="";this.O2=-1;ea.resultsUpdated(sa);const Aa={};Aa[a.a.provider]=this.qL();Aa[a.a.rOb]=ba.Yob;L.TellMeActor.instance.Pe.QA(k.a.timedOut,this.sCc,Aa)}},this.sCc);const Pa={"Content-Type":"application/json",Accept:"application/json"};Pa.Authorization=
"Bearer "+ma;Pa["X-Office-Version"]=Q.AFrameworkApplication.buildVersion;Pa["X-Office-Application"]=Q.AFrameworkApplication.K.kb("Application");Pa["X-Office-Platform"]="WAC";Pa["X-TellMe-SessionId"]=L.TellMeActor.instance.fVd();Pa["X-TellMe-Culture"]=Q.AFrameworkApplication.uiCulture;Pa["X-TellMe-ProcessSessionId"]=Q.AFrameworkApplication.userSessionId;Pa["Client-Request-Id"]=Fa;const Na=window.performance.now();this.Zf.nj(this.pgm(),2,this.qgm(ba.Fg,this.fc.application,L.TellMeActor.instance.fVd(),
S.a.GR(ba)),Pa,!1,0,Aa=>{this.XMb(Aa,ba,ea,Fa,Na,oa,ua)},Aa=>{this.GMb(Aa,ba,ea,Fa,Na)},null,null,!1,4E3,6E3)}SDa(){-1!==this.O2&&(window.clearTimeout(this.O2),this.O2=-1)}XMb(ba,oa,ma,ea,ua,sa,Fa){L.TellMeActor.instance.Pe.W9(oa.Fg.length,this.wyd.join(","),ba.data.Ne.toString(),Math.round(window.performance.now()-ua),K.a.substrate,!0,y.a.XQa);const Pa=S.a.GR(oa),Na=new H.a(oa);if(ea===this.AQ){this.SDa();ba=U.b(ba.data.te);if(ba.Groups){ba=ba.Groups;for(const Aa of ba)"People"===Aa.Type&&this.fc.Vbd&&
(Fa?Array.contains(Fa,14):1)?(ba=this.Vei(Aa.Suggestions,Pa,sa),0<ba.results.length&&Na.gv(ba)):"File"===Aa.Type&&this.fc.Tbd&&(Fa?Array.contains(Fa,15):1)?(ba=this.drf(Aa.Suggestions,Pa,sa),0<ba.results.length&&(this.C_d()&&(ea=new v.a("GenerateSlidesFromTellMe",30,"",null,1),ba.Ww(ea)),Na.gv(ba))):"Notes"===Aa.Type&&this.fc.amb&&sa!==l.a.contextMenu&&(Fa?Array.contains(Fa,20):1)&&(ba=this.Ddi(Aa.Suggestions,Pa,oa),0<ba.results.length&&Na.gv(ba))}ma.resultsUpdated(Na);L.TellMeActor.instance.Pe.W9(oa.Fg.length,
this.wyd.join(","),"",Math.round(window.performance.now()-ua),"",!0,y.a.provider)}else ma.resultsUpdated(Na)}Ddi(ba,oa,ma){const ea=new E.a(20);ea.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ua of ba)this.bYm(ua)&&(ba=ua.NotesType,ba=T.a.eh(ba),ba=this.t7l(ba,ua.LastModifiedTime,ua.BodyPreview,ua.Subject,oa,ma,ua))&&(ba.groupType=20,ea.Ww(ba));return ea}Vei(ba,oa,ma){const ea=new E.a(14);ea.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const sa of ba)if(this.cYm(sa)){var ua=
sa.Id.split("@")[0];ba=sa.EmailAddresses[0];let Fa=sa.Type;if(void 0===Fa||null===Fa)Fa="User";if(ua=this.t$l(Fa,sa.DisplayName,sa.JobTitle,ba,ua,ma,oa))ua.description=ba,ba=sa.JobTitle,"Department"in sa&&"CompanyName"in sa&&(ba+="@"+sa.Department+"@"+sa.CompanyName),ua.dJ=ba,ea.Ww(ua)}return ea}drf(ba,oa,ma){const ea=new E.a(15);ea.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Aa of ba)if(this.SXm(Aa)){var ua=Aa.FileName;ba=Aa.FileExtension;var sa=ua;ua.length>ba.length&&sa.endsWith(ba)&&
(sa=ua.substr(0,ua.length-ba.length-1));var Fa=void 0,Pa=0;"DateCreated"in Aa&&Aa.DateCreated?(Pa=S.a.gwf(Aa.DateCreated),Fa=S.a.Eji(Aa.DateCreated),Fa=String.format(CommonUIStrings.l_CreatedTimeFormatString,Aa.Author,Fa)):Fa=Aa.Author;var Na=Aa.AccessUrl+"?web=1";const za=T.a.ibc(Na);ua=String.format('<a href="{0}">{1}</a>',za,T.a.uY(ua));if(ma!==l.a.contextMenu||T.a.vP(Na))if(sa=this.wYl(sa,ma===l.a.contextMenu?ua:Na,Fa,Aa.FileExtension,Aa.Text,oa))sa.description=Aa.Author,sa.YCd=Pa,ea.Ww(sa),this.DCe&&
(Pa=Aa.AccessUrl,ua=S.a.bSd(ba),Fa=Aa.DateModified?Aa.DateModified:Aa.DateCreated,Na=Aa.Size?Aa.Size:Aa.FileSize,this.Zto()&&(Pa=Pa.replace(RegExp("%20","g")," "),ua=S.a.jfm(ba)),ba=new x.a(ua,Pa,Aa.SPWebUrl,Aa.Id,Na,Fa),L.TellMeActor.instance.Opg(!1,sa.value,ba))}return ea}GMb(ba,oa,ma,ea,ua){ea===this.AQ&&(this.SDa(),L.TellMeActor.instance.Pe.W9(oa.Fg.length,this.wyd.join(","),ba.data.Ne.toString(),Math.round(window.performance.now()-ua),K.a.substrate,!1,y.a.XQa));ba=new H.a(oa);ma.resultsUpdated(ba)}t$l(ba,
oa,ma,ea,ua,sa,Fa){Fa=Fa?this.$mh:this.i7g;if(!window.LPC&&!S.a.QEf()||this.tBc===Fa)return null;this.tBc+=1;Fa="PeopleSuggestion"+this.tBc.toString();var Pa=this.ubh+"?size=1&accountName="+ea;ba=Object.assign(new N.a,{PersonaType:ba,Smtp:ea,ProfilePictureUrl:Pa,AadObjectId:ua});const Na=Object.assign(new O.a,{identifiers:ba,displayName:oa});ba=sa===l.a.contextMenu;this.fc.exa?(L.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Fa,Na,oa,ma)),sa===l.a.contextMenu&&(ma=S.a.gOh(oa,
ea,ua),L.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Fa,ma))),L.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Fa,ba))):(Pa=[],Pa.push(appChrome.actions.setPersonaButtonCoauthor(Fa,Na,oa,ma)),sa===l.a.contextMenu&&(ma=S.a.gOh(oa,ea,ua),Pa.push(appChrome.actions.setButtonCommandValueId(Fa,ma))),Pa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Fa,ba)),appChrome.api.dispatch(Pa));return new v.a(Fa,11,
oa,ea,0)}t7l(ba,oa,ma,ea,ua,sa,Fa){if(ua&&!this.fc.dEi||this.Asd===this.Erd||this.HAc===this.Erd||this.Ldb===this.Erd)return null;var Pa=null;this.Asd+=1;ua="";const Na=[],Aa={};Fa.type="Notes";this.T8g=Object.assign(new X.a,{landingTab:"Notes",data:Fa});sa=S.a.ePa(sa.Fg,33,this.T8g);if("onenotepagepreviews"===ba){if(!("ClickthroughUrl"in Fa&&Fa.ClickthroughUrl)||""===Fa.ClickthroughUrl)return null;this.HAc+=1;ua="OnenoteNotesSuggestion"+this.HAc.toString();Aa["default"]="SaveAsonetoc2_20";Pa=Fa.ClickthroughUrl;
Na.push(appChrome.actions.setControlIconSet(ua,Aa));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ua,Pa));Pa=new v.a(ua,19,null,null,0)}else if("stickynote"===ba){if(!this.Bhh)return null;this.Ldb+=1;ua="NotesSuggestion"+this.Ldb.toString();Aa["default"]="ShowAllNotes_20";Na.push(appChrome.actions.setControlIconSet(ua,Aa));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ua,sa));Pa=new v.a(ua,21,null,null,0)}else if("samsung"===ba){if(!this.Bhh)return null;this.Ldb+=1;ua="NotesSuggestion"+
this.Ldb.toString();Aa["default"]="CategoryCollapsed_20";Na.push(appChrome.actions.setControlIconSet(ua,Aa));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ua,sa));Pa=new v.a(ua,20,null,null,0)}""!==ua&&(ba=S.a.Eji(oa),ba=String.format(CommonUIStrings.l_LastModifiedString,ba),Pa.label=ea,Pa.YCd=S.a.gwf(oa),Na.push(appChrome.actions.setControlLabel(ua,ea)),Na.push(appChrome.actions.updateCompoundButtonDescription(ua,ba)),Na.push(appChrome.actions.setControlCustomTooltip(ua,ma)),appChrome.api.dispatch(Na));
return Pa}wYl(ba,oa,ma,ea,ua,sa){if(this.zvc===(sa?this.YYe:this.GVe)||this.DCe&&"Word"!==S.a.bSd(ea))return null;this.zvc+=1;sa="FileSuggestion"+this.zvc.toString();const Fa=[],Pa={};Pa["default"]=S.a.L0l(ea);this.fc.exa?(L.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa,ba)),L.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(sa,Pa)),L.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa,ma)),L.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa,
oa)),L.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(sa,ua)),this.fc.P7b&&L.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(sa,"QuickActionOnFile"))):(Fa.push(appChrome.actions.setControlLabel(sa,ba)),Fa.push(appChrome.actions.setControlIconSet(sa,Pa)),Fa.push(appChrome.actions.updateCompoundButtonDescription(sa,ma)),Fa.push(appChrome.actions.setCompoundButtonCommandValueId(sa,oa)),Fa.push(appChrome.actions.setControlCustomTooltip(sa,
ua)),this.fc.P7b&&Fa.push(appChrome.actions.setCompoundButtonSecondaryButtonId(sa,"QuickActionOnFile")),appChrome.api.dispatch(Fa));return new v.a(sa,6,ba,ma,0)}zvf(){const ba=[];this.fc.Vbd&&Array.add(ba,"People");this.fc.Tbd&&Array.add(ba,"File");this.fc.amb&&Array.add(ba,"Notes");return ba}qgm(ba,oa,ma,ea){var ua=new z(ba);ba=new t("File",ua,0,ea?this.YYe:this.GVe,null);ea=new t("People",ua,0,ea?this.$mh:this.i7g,S.a.WCn);ua=new t("Notes",ua,0,this.Erd,null);(this.fc.P7b||this.fc.TMd)&&"powerpoint"===
oa.toLowerCase()&&(oa="word");oa=new n("app",oa.toLowerCase());var sa=[];Array.add(sa,oa);oa=new I("tellmesearch",sa);sa=[];this.fc.Tbd&&Array.add(sa,ba);this.fc.Vbd&&Array.add(sa,ea);this.fc.amb&&Array.add(sa,ua);ma=new M(sa,"UTC",ma,oa);return U.c(ma)}pgm(){let ba=this.fc.bGo;this.fc.amb&&(ba+="?&setflight=NotesFrom3S");""!==this.fc.rii&&(ba=ba+"&"+this.fc.rii);return ba}cYm(ba){return"DisplayName"in ba&&"Id"in ba&&"EmailAddresses"in ba&&!!ba.Id&&!!ba.EmailAddresses}SXm(ba){return"FileExtension"in
ba&&!!ba.FileExtension&&"FileName"in ba&&!!ba.FileName&&""!==ba.FileName&&"AccessUrl"in ba&&!!ba.AccessUrl&&""!==ba.AccessUrl}bYm(ba){return"Id"in ba&&!!ba.Id&&"NotesType"in ba&&!!ba.NotesType&&"Subject"in ba&&!!ba.Subject&&""!==ba.Subject}C_d(){return!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Zto(){return!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(D.a)(aa,"SubstrateResultsProvider",null,[1307])},1797:function(D,J,c){D=c(0);var l=c(42),e=c(6),a=c(16),k=c(184),x=c(86),y=c(189),n=c(225),t=c(613),z=c(61),v=c(368),I=c(2),E=c(1473),H=c(971);class M{constructor(sa,Fa=0){this.Cbf=null;this.y0f=0;this.aN=sa;this.Bdn=Fa}}Object(D.a)(M,"GraphMergerResponse",null,[]);var K=c(55),L=c(1),S=c(123),Q=c(886),N=c(1560),O=c(1612);class X extends O.a{constructor(){super();this.Dvj=null;this.tLj=!1}get vha(){return"Crash"}lGb(){this.detail.Z("Type",
this.vha);this.detail.Z("Trace",this.sPo(this.Dvj));this.detail.Z("Continue",this.tLj);return this.detail}sPo(sa){sa=sa.split("\n");const Fa=4<sa.length?4:sa.length,Pa=new Sys.StringBuilder;for(let Na=0;Na<Fa;Na++)Na===Fa-1?Pa.append(String.format("{0}...",sa[Na])):Pa.append(String.format("{0}\n",sa[Na]));return Pa.toString()}}Object(D.a)(X,"CrashMergeFailureDetail",O.a,[]);var U=c(1994),T=c(1577),Y=c(1669),aa=c(1561);class ba{constructor(){this.ULk=new v.a;this.Q2k=new v.a;this.h6k=new v.a}}Object(D.a)(ba,
"RangeMarkers",null,[]);class oa{constructor(){this.colSpan=this.rowSpan=null;this.hg=!1;this.ZCe=new n.a;this.WLe=new n.a;this.qMe=new n.a}get $wf(){return this.ZCe.S5()}set $wf(sa){sa||(this.ZCe=new n.a);this.ZCe=sa.S5()}get nUf(){return this.WLe.S5()}set nUf(sa){sa||(this.WLe=new n.a);this.WLe=sa.S5()}get O6d(){return this.qMe.S5()}set O6d(sa){sa||(this.qMe=new n.a);this.qMe=sa.S5()}}Object(D.a)(oa,"TableCellStructureInfo",null,[]);var ma=c(1615),ea=c(1660);c.d(J,"a",function(){return ua});class ua{constructor(){this.TVd=
0;this.ZXg=this.Abb=this.wZb=this.Qg=this.teh=this.J_b=null;this.g7g=0;this.P3g=50;this.xVg=this.cPg=null}get ffe(){return this.J_b}get J9n(){return this.teh}get Xd(){return this.Qg}get $mb(){return this.wZb}get Tli(){return this.Abb}get jnm(){return this.ZXg}get Wfc(){return this.g7g}get xEh(){return this.cPg}get jOc(){return this.xVg}dgc(sa,Fa,Pa,Na,Aa,za,xa){Pa=this.Ocl(sa,Fa,Na,Aa,za,xa,this.jOc);Na=0;const ka=Pa.runtime.Uie;let wa=null;try{this.g7m(ka,Pa,xa,sa,Fa,Aa,za);for(sa=1;Na<this.$mb.length;Na++)if(!(0,this.$mb[Na])(Pa)){sa=
2;Pa.logger.J3d("GraphMerger.GetMergeFunctions()",Na);break}return wa=new M(Pa.output.aN,sa)}catch(ia){const va=!Pa.output.timeout;Pa.output.crash=va;const na=this.VRd(ia),Ca=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",va?"Crashed":"Timed Out",Pa.input.LLb,!!Pa.output.aN,na);va?(k.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ca),Pa.logger.Rg(Object.assign(new X,{Dvj:na,tLj:!!Pa.output.aN}))):k.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",
Ca);if(Pa.output.aN)return wa=new M(Pa.output.aN,2);throw ia;}finally{Pa.output.succeeded?this.d7m(ka,Pa,Na):Pa.output.timeout?this.f7m(Pa,Na):Pa.output.crash?Pa.output.aN?this.e7m(Pa,Na):this.c7m(Pa,Na):this.b7m(Pa,Na);Pa.logger.a7m();k.a.instance.Cka(42350232,1,Pa.output.succeeded?4:2,"MergeLogger",Pa.logger.e5l());Pa.logger.q0c.Qni()&&k.a.instance.Cka(559015903,1,2,"MarkerInfo",Pa.logger.q0c.toString());if(Pa.runtime.Zb&&Pa.runtime.Zb.isFeatureEnabled(75))try{this.y4m(Pa)}catch(ia){k.a.instance.Ua(571619421,
1,4,"Error logging references: {0}",ia.toString())}this.O7m(Pa);wa.y0f|=(Pa.output.succeeded?2:1)<<2*(xa-1);if(wa)try{wa.Cbf=this.TGn(Pa)}catch(ia){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",ia)}}}O7m(sa){if(!sa.output.succeeded){sa=sa.output.timeout?"Timeout":sa.logger.R5i?sa.logger.R5i.vha:"Unknown";const Fa=new S.a;x.Health.instance.recordQosError(sa,["MergeFailure"],!0,!0,!1,!1,Fa)}}y4m(sa){const Fa=Aa=>{const za=this.vFa()-sa.input.$Ua>this.Wfc;if(0<this.Wfc&&
za)throw k.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Aa),y.a.invalidOperation(Aa);};let Pa=sa.runtime.Nu.keys,Na=Aa=>sa.runtime.Nu.J(Aa);this.mNf(sa,Fa,Pa,Na,"Favored");Pa=sa.runtime.Mq.keys;Na=Aa=>sa.runtime.Mq.J(Aa);this.mNf(sa,Fa,Pa,Na,"Unfavored");Pa=sa.runtime.vn.keys;Na=Aa=>{const za=sa.runtime.vn.J(Aa);return za?za.Dm:sa.runtime.Nu.J(Aa)};this.mNf(sa,Fa,Pa,Na,"Merged")}mNf(sa,Fa,Pa,Na,Aa){var za=new n.a;const xa=new n.a;for(let ka=0;ka<Pa.length;ka++){Fa("LogAddedAndDeletedNodes");
const wa=Na(Pa.J(ka));if(4325465===wa.Oc)continue;const ia=sa.runtime.uk.J(wa.id);ia&&this.z4m(za,xa,wa,ia)}this.pLi(xa,ka=>sa.runtime.uk.J(ka),Fa);this.pLi(za,Na,Fa);Fa=new Sys.StringBuilder;for(Pa=0;Pa<za.length;Pa++)Fa.append(za.J(Pa).toString()+",");za=new Sys.StringBuilder;for(Pa=0;Pa<xa.length;Pa++)za.append(xa.J(Pa).toString()+",");k.a.instance.Cka(571619423,1,4,Aa+" revision: Added references",Fa.toString());k.a.instance.Cka(571619424,1,4,Aa+" revision: Deleted references",za.toString())}z4m(sa,
Fa,Pa,Na){const Aa=Pa.xl();for(let xa=0;xa<Aa.length;xa++){const ka=Aa[xa];if(this.Fvi(ka)){var za=this.Xd.getPropertyObjectIds(Pa,ka);this.k6m(sa,Fa,Na,ka,za)}else this.ZAi(ka)&&(za=this.Xd.getPropertyObjectId(Pa,ka),this.j6m(sa,Fa,Na,ka,za))}}pLi(sa,Fa,Pa){Pa("LogNestedReferences");Pa=new n.a;const Na=new t.a;for(let Aa=0;Aa<sa.length;Aa++){const za=sa.J(Aa);this.QNf(za,Pa,Na,Fa)}for(Fa=0;Fa<Pa.length;Fa++)sa.add(Pa.J(Fa))}QNf(sa,Fa,Pa,Na){const Aa=Na(sa);if(Aa){const xa=Aa.xl();for(let ka=0;ka<
xa.length;ka++){var za=xa[ka];if(this.Fvi(za)){za=this.Xd.getPropertyObjectIds(Aa,za);for(let wa=0;wa<za.length;wa++)Pa.contains(za.J(wa))||(Fa.add(za.J(wa)),Pa.add(za.J(wa)),this.QNf(za.J(wa),Fa,Pa,Na))}else this.ZAi(za)&&(za=this.Xd.getPropertyObjectId(Aa,za),Pa.contains(za)||(Fa.add(za),Pa.add(za),this.QNf(sa,Fa,Pa,Na)))}}}k6m(sa,Fa,Pa,Na,Aa){if(this.Xd.hasProperty(Pa,Na)){Pa=this.Xd.getPropertyObjectIds(Pa,Na);const za=Pa.hH();Na=Aa.hH();for(let xa=0;xa<Aa.length;xa++)za.contains(Aa.J(xa))||sa.add(Aa.J(xa));
for(sa=0;sa<Pa.length;sa++)Na.contains(Pa.J(sa))||Fa.add(Pa.J(sa))}else for(Fa=0;Fa<Aa.length;Fa++)sa.add(Aa.J(Fa))}j6m(sa,Fa,Pa,Na,Aa){Aa&&(this.Xd.hasProperty(Pa,Na)?(Pa=this.Xd.getPropertyObjectId(Pa,Na),Aa.equals(Pa)||(sa.add(Aa),Fa.add(Pa))):sa.add(Aa))}$6m(sa){k.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",sa.input.LLb,sa.output.crash,sa.output.timeout)}g7m(sa,Fa,Pa,Na,Aa,za,xa){if(sa){sa=Na.length?Na.eg(Na.length-1):null;var ka=Aa.length?Aa.eg(Aa.length-
1):null;Pa=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Fa.input.LLb,Na.length,sa?sa.id:z.a.nil,sa?sa.vX?sa.vX.id:z.a.nil:z.a.nil,Aa.length,ka?ka.id:z.a.nil,ka?ka.vX?ka.vX.id:z.a.nil:z.a.nil,za,xa,this.Wfc,Pa);switch(Fa.input.source){case 5:k.a.instance.Ua(51663493,1,4,Pa);break;default:k.a.instance.Ua(4051606,
1,4,Pa)}}}d7m(sa,Fa,Pa){if(sa)switch(sa=this.AQc(Fa,Pa,"Succeeded"),Fa.input.source){case 5:k.a.instance.Ua(51663494,1,4,sa);break;default:k.a.instance.Ua(4059162,1,4,sa)}}f7m(sa,Fa){Fa=this.AQc(sa,Fa,"Timeout");switch(sa.input.source){case 5:k.a.instance.Ua(51663495,1,4,Fa);break;default:k.a.instance.Ua(4059163,1,2,Fa)}}b7m(sa,Fa){Fa=this.AQc(sa,Fa,"Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663496,1,4,Fa);break;default:k.a.instance.Ua(4059164,1,2,Fa)}}e7m(sa,Fa){Fa=this.AQc(sa,
Fa,"Crash - Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663497,1,4,Fa);break;default:k.a.instance.Ua(4059165,1,2,Fa)}}c7m(sa,Fa){Fa=this.AQc(sa,Fa,"Crash - Failed");switch(sa.input.source){case 5:k.a.instance.Ua(51663498,1,4,Fa);break;default:k.a.instance.Ua(4059166,1,2,Fa)}}AQc(sa,Fa,Pa){const Na=sa.output.aN,Aa=Na&&Na.length?Na.eg(Na.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
sa.input.LLb,Pa,this.vFa()-sa.input.$Ua,Fa,Na?Na.length:0,Aa?Aa.id:z.a.nil,Aa?Aa.vX?Aa.vX.id:z.a.nil:z.a.nil,sa.input.source)}Ocl(sa,Fa,Pa,Na,Aa,za,xa){const ka=new U.a,wa=ka.input;wa.aaa=sa;wa.kWa=Fa;wa.Fm=Pa;wa.Xia=Na;wa.rIb=Aa;wa.source=za;wa.jOc=xa;wa.$Ua=this.vFa();ka.logger.Ioo(wa.$Ua);sa=ka.runtime;sa.W$c=k.a.instance.R$(1,5);sa.Uie=k.a.instance.R$(1,4);let ia="";sa.gH=va=>{if(this.Wfc){var na=this.vFa()-wa.$Ua,Ca=na>this.Wfc;ia+=String.format(" ({0}: {1})",va,na);Ca&&(ka.output.timeout=!0,
va=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",wa.LLb,this.Wfc,va,na,ia),k.a.instance.Ua(528061012,1,2,va),this.WKo(va))}};return ka}rRc(){return[Object(K.a)(this,this.Ayn,"otherAuthorsHaveChangesToMerge"),Object(K.a)(this,this.EPm,"isInputValid"),Object(K.a)(this,this.gCm,"initializeOutputMergeState"),Object(K.a)(this,this.cYd,"initializeRuntimeMergeState"),Y.a.zGn,Object(K.a)(this,this.yGn,"preProcessTableStructure"),
Object(K.a)(this.xEh,this.xEh.edn,"mergeChildNodeLists"),Object(K.a)(this,this.TQo,"tryObjectMerge"),Y.a.eGn,Object(K.a)(this,this.MDl,"finalizeObjectMerge"),Object(K.a)(this,this.g3o,"validateMarkers"),Object(K.a)(this,this.Wtk,"addMergeResultsToOutput")]}Ayn(sa){const Fa=sa.input.aaa;sa=sa.output;return Fa?Fa.length?!0:(k.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),sa.aN=Fa,sa.succeeded=!0,!1):(k.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
sa.aN=Fa,sa.succeeded=!0,!1)}EPm(sa){var Fa=sa.input;const Pa=Fa.aaa,Na=Fa.kWa,Aa=Fa.Fm,za=Fa.Xia;Fa=Fa.rIb;sa=sa.output;if(!Na||!Na.length)return k.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),sa.aN=Pa,sa.succeeded=!0,!1;let xa=!0;if(2!==za&&1!==za)return sa.aN=Pa,!1;Aa&&Aa!==z.a.nil||(xa=!1);Pa.length<(Fa?2:1)&&(k.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
Fa),xa=!1);xa||(sa.aN=2===za?Pa:Na);return xa}cYd(sa){var Fa=sa.input,Pa=Fa.aaa,Na=Fa.kWa,Aa=Fa.Xia,za;let xa;({Gmg:za,ptg:xa,$Da:Fa}=this.psf(sa,Pa,Na,Fa.rIb));if(!Fa)return k.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",za.id,xa.id),sa.logger.Rg(Object.assign(new N.a,{zj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.HLi(za,Pa.length,"TheirChanges"),this.HLi(xa,Na.length,
"YourChanges"),sa.output.aN=2===Aa?Pa:Na,!1;sa.runtime.$Da=Fa;({ASo:Pa,RBl:Na}=this.Snl(Aa,za,xa));({BSo:Fa,SBl:Aa,kKk:za}=this.C5l(sa,Pa,Na,Fa));sa.runtime.uk=za;sa.runtime.Mq=Fa;sa.runtime.Nu=Aa;sa.runtime.vn=new v.a;sa.runtime.rOd=Na.id;sa.runtime.Zne=Pa.id;sa.runtime.unb=new v.a;sa.runtime.GOa=new t.a;sa.runtime.Eef=new v.a;sa.runtime.NCb=new v.a;sa.runtime.plg=new v.a;sa.runtime.cde=new ba;sa.runtime.a5d=new n.a;sa.runtime.U_f=new t.a;sa.runtime.xmc=new n.a;sa.runtime.Zb=sa.input.jOc(sa);sa.runtime.Zb.iGc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.SJo);sa.runtime.Zb.iGc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.YLo);sa.runtime.Zb.iGc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.ABl);sa.runtime.Zb.iGc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.R_n);sa.runtime.Zb.iGc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",l.a.rdn);sa.runtime.xsi=!0;I.AFrameworkApplication.K&&(this.P3g=I.AFrameworkApplication.K.nc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}HLi(sa,Fa,Pa){const Na=new n.a;for(;sa;)Na.add(sa),sa=sa.vX;const Aa=new Sys.StringBuilder;Aa.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Pa,Fa,Na.length));let za=Na.length,xa=0;Na.forEach(ka=>({eqi:za,bMi:xa}=this.Jvk(Aa,ka,Na,za,xa)).returnValue);k.a.instance.Ua(4273302,1,4,Aa.toString())}Jvk(sa,
Fa,Pa,Na,Aa){sa.append(String.format(" [{0} {1} {2}]",Na,Fa.Fia?"S":"B",Fa.id));Na--;Aa++;return 50<Aa&&Pa.length!==Aa?(sa.append(" ...Truncated."),{returnValue:!1,eqi:Na,bMi:Aa}):{returnValue:!0,eqi:Na,bMi:Aa}}psf(sa,Fa,Pa,Na){Fa=Fa.eg(Fa.length-1-(Na?1:0));Pa=Pa.eg(Pa.length-1);Na=Fa.x2a(Pa);sa.runtime.gH("GetCommonBase");sa.logger.Sia("GetCommonBase");return{Gmg:Fa,ptg:Pa,$Da:Na}}C5l(sa,Fa,Pa,Na){let Aa,za;({result:Aa}=Fa.egc(Na));sa.runtime.gH("GetUnfavoredChanges");sa.logger.Sia("GetUnfavoredChanges");
({result:za}=Pa.egc(Na));5===sa.input.source&&(sa.runtime.VBl=Q.a.pgi(Pa),sa.runtime.DSo=Q.a.pgi(Fa));sa.runtime.gH("GetFavoredChanges");sa.logger.Sia("GetFavoredChanges");Fa=new E.a(Object(K.a)(Na,Na.X2a,"getMergeableObject"));sa.runtime.gH("GetModifiedObjects");sa.logger.Sia("GetModifiedObjects");return{BSo:Aa,SBl:za,kKk:Fa}}Snl(sa,Fa,Pa){2===sa?(sa=Fa,Fa=Pa):sa=Pa;return{ASo:Fa,RBl:sa}}gCm(sa){const Fa=sa.input,Pa=Fa.aaa,Na=Fa.kWa;sa.output.aN=(2===Fa.Xia?Pa:Na).S5();sa.runtime.gH("InitializeOutputMergeState");
sa.logger.Sia("InitializeOutputMergeState");return!0}Wtk(sa){var Fa=sa.input.Fm;const Pa=sa.runtime.vn,Na=sa.output.aN;Fa=this.Pcl(sa,Na.eg(Na.length-1),Fa,z.a.create());this.kDl(sa,Fa,Pa);Na.add(Fa);return sa.output.succeeded=!0}Pcl(sa,Fa,Pa,Na){sa.runtime.Uie&&k.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Pa,Na);sa=this.J9n(Na);sa.JKk(Fa,Pa);return sa}kDl(sa,Fa,Pa){sa.runtime.Uie&&k.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Pa.count);Pa.forEach((Na,Aa)=>{Fa.mvk(Aa.Dm);return!0})}jKb(sa){if(!sa)return k.a.instance.Ua(573957952,1,2,"Feature helper is null"),!1;sa.Xx(107);return sa.isFeatureEnabled(107)}yGn(sa){if(!this.jKb(sa.runtime.Zb))return!0;const Fa=sa.runtime.Nu,Pa=sa.runtime.Mq,Na=sa.runtime.uk;let Aa=!0;Fa.forEach((za,xa)=>{393252===xa.Oc&&(Aa=this.H3i(sa,za,xa,Na,Fa));return Aa});if(!Aa)return!1;Pa.forEach((za,xa)=>{393252===xa.Oc&&(Aa=this.H3i(sa,za,xa,Na,Pa));return Aa});sa.logger.Sia("PreProcessTableStructure");
return Aa}H3i(sa,Fa,Pa,Na,Aa){const za=null==this.Xd.getPropertyBool(Pa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(Pa,e.a.ghostCell),xa=null==this.Xd.getPropertyUint32(Pa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.rowSpan),ka=null==this.Xd.getPropertyUint32(Pa,e.a.colSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.colSpan);if(za)return!0;var wa=Na.J(Fa);if(wa){Na=null==this.Xd.getPropertyBool(wa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(wa,e.a.ghostCell);var ia=null==this.Xd.getPropertyUint32(wa,e.a.rowSpan)?
1:this.Xd.getPropertyUint32(wa,e.a.rowSpan);var va=null==this.Xd.getPropertyUint32(wa,e.a.colSpan)?1:this.Xd.getPropertyUint32(wa,e.a.colSpan);Na=Na!==za;ia=ia!==xa;va=va!==ka}else va=ia=Na=!0;const na=ea.e(sa,Pa,Aa);if(na.equals(z.a.nil))return k.a.instance.Ua(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Fa),sa.logger.Rg(Object.assign(new ma.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Ca=sa.runtime.NCb.J(na);Ca||(sa.runtime.NCb.Z(na,
new v.a),Ca=sa.runtime.NCb.J(na));let ta=Ca.J(Fa),fa=new n.a;const Xa=new n.a,ob=new n.a;Na&&(ta||(fa=this.Xd.getPropertyObjectIds(Pa,a.a.gf)));if(ia||va)if(ta){if(ta.hg)return k.a.instance.Ua(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),sa.logger.Rg(Object.assign(new ma.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=ta.rowSpan&&xa!==ta.rowSpan||null!=ta.colSpan&&ka!==ta.colSpan)return k.a.instance.Ua(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),sa.logger.Rg(Object.assign(new ma.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var xb;({rowIndex:Pa,b5b:xb}=ea.b(sa,Aa,Pa));if(-1===Pa||-1===xb)return k.a.instance.Ua(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Fa),sa.logger.Rg(Object.assign(new ma.a,{info:"Table cell location could not be found"})),!1;for(var zb=Pa;zb<Pa+xa;zb++)for(var Lb=xb;Lb<
xb+ka;Lb++){var Ia=ea.c(sa,na,zb,Lb);if(Ia.equals(z.a.nil))return k.a.instance.Ua(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ma.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ya=Aa.Gz(Ia,sa.runtime.uk.J(Ia));if(!Ya)return k.a.instance.Ua(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ma.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!Ia.equals(Fa)){if(null==this.Xd.getPropertyBool(Ya,e.a.ghostCell)||!this.Xd.getPropertyBool(Ya,e.a.ghostCell))return k.a.instance.Ua(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ma.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var eb=Ca.J(Ia);if(eb)return k.a.instance.Ua(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),sa.logger.Rg(Object.assign(new ma.a,
{info:"Ghost cell is already merged with some other cell"})),!1;Xa.add(Ia);eb=new oa;eb.hg=!0;Ya=this.Xd.getPropertyUint32(Ya,e.a.colSpan);null!=Ya&&(eb.colSpan=Ya);Ca.Z(Ia,eb)}}if(wa&&(null==this.Xd.getPropertyBool(wa,e.a.ghostCell)||!this.Xd.getPropertyBool(wa,e.a.ghostCell))&&(Aa=null==this.Xd.getPropertyUint32(wa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(wa,e.a.rowSpan),Pa=null==this.Xd.getPropertyUint32(wa,e.a.colSpan)?1:this.Xd.getPropertyUint32(wa,e.a.colSpan),Aa>xa||Pa>ka)){zb=xb=-1;({rowIndex:xb,
b5b:zb}=ea.a(sa,null,wa,xb,zb));if(-1===xb||-1===zb)return k.a.instance.Ua(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",Fa),sa.logger.Rg(Object.assign(new ma.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;wa=Xa.hH();for(Lb=xb;Lb<xb+Aa;Lb++)for(Ia=zb;Ia<zb+Pa;Ia++){eb=ea.d(sa,null,na,Lb,Ia);if(!eb)return k.a.instance.Ua(573957960,1,2,"Table cell could not be found within table bounds"),sa.logger.Rg(Object.assign(new ma.a,
{info:"Ghost cell not found in the table bounds"})),!1;eb.id.equals(Fa)||wa.contains(eb.id)||ob.add(eb.id)}}}!ta&&(Na||ia||va)&&(k.a.instance.Ua(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Fa),ta=new oa,ta.rowSpan=xa,ta.colSpan=ka,ta.hg=za,ta.O6d=fa,ta.$wf=Xa,ta.nUf=ob,Ca.add(Fa,ta));return!0}TQo(sa){return this.qDj(sa,!1)}MDl(sa){return this.qDj(sa,!0)}qDj(sa,Fa){const Pa=sa.runtime,Na=Pa.uk,Aa=Pa.Nu,za=Fa?Pa.Eef:Pa.Mq,xa=Pa.vn;let ka=
!0;const wa=sa.runtime.W$c;let ia=0,va=0,na=0;za.forEach((Ca,ta)=>{wa&&k.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Ca,ta.Oc,Fa);va++;this.P3g===va&&(ia++,sa.runtime.gH(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",ia,na,Fa)),va=0);if(sa.runtime.Zb&&sa.runtime.Zb.Tjb(1000005)&&sa.runtime.xmc.contains(ta.id,(ob,xb)=>ob.equals(xb))||this.qAo(ta.Oc))return!0;if(!Fa&&this.rkl(ta.Oc,sa.runtime.Zb))return Pa.Eef.Z(Ca,ta),!0;var fa=
Aa.get(Ca);if(!fa)return xa.nb(Ca)?xa.J(Ca).oPi(ta):xa.Z(Ca,new aa.a(ta,!1)),!0;if(!Na.J(Ca)&&!this.Udn(fa.Oc)){var Xa=!!sa.input.aaa&&!!sa.input.aaa.last()&&sa.input.aaa.last().Y4(Ca);const ob=!!sa.input.kWa&&!!sa.input.kWa.last()&&sa.input.kWa.last().Y4(Ca),xb=new T.a(fa,ta);if(!xb.DY)return xa.Z(Ca,new aa.a(fa,!1)),!0;k.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
Ca,ta.Oc,Fa,Xa,ob,!xb.DY,sa.input.source);sa.logger.Rg(Object.assign(new N.a,{zj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ka=!1}Xa=xa.Gz(Ca,new aa.a(Na.J(Ca)));({fl:fa,returnValue:ka}=this.jnm.merge(sa,this.Tli,this.Xd,Xa,fa,ta));na++;ka&&(sa.runtime.gH(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Ca,ta.Oc,na,ia,Fa)),fa&&(xa.nb(fa.Dm.id)?xa.J(fa.Dm.id).oPi(fa.Dm):xa.Z(fa.Dm.id,fa)));return ka});sa.logger.Sia("ObjectMerge");wa&&
k.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",za.count,na,Fa);return ka}g3o(sa){try{for(let Fa=0;Fa<sa.runtime.a5d.length;Fa++){const Pa=sa.runtime.a5d.J(Fa);if(sa.runtime.vn.J(Pa)){if(!this.TQm(sa,Pa))return!1}else k.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");sa.runtime.gH("Validate markers taking too long")}}catch(Fa){k.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",Fa)}return sa.logger.q0c.Qni()?
!1:!0}rvo(sa){return 38===sa||39===sa||40===sa||41===sa||44===sa||45===sa||33===sa||34===sa?!1:!0}P4l(sa){switch(sa){case 38:case 39:case 40:case 41:return e.a.me;case 44:case 45:return e.a.EEd;case 33:case 34:return e.a.Lj}return H.CommonProperties.nil}f3o(sa,Fa){const Pa=this.Xd.getPropertyUint32(sa,e.a.Ns);if(!Pa||this.rvo(Pa))return!0;sa=this.Xd.getPropertyObjectId(sa,this.P4l(Pa));return ua.Z9b(Fa,sa)?!0:(Fa.logger.q0c.OYd=Pa,!1)}TQm(sa,Fa){if(sa.runtime.U_f.contains(Fa))return!1;if(Fa=ua.Z9b(sa,
Fa)){Fa=this.Xd.getPropertyObjectIds(Fa,a.a.Rn);for(let Pa=0;Pa<Fa.length;Pa++){const Na=ua.Z9b(sa,Fa.eg(Pa));if(Na&&!this.f3o(Na,sa))return!1}}return!0}qAo(sa){switch(sa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}rkl(sa,Fa){let Pa=!1;if(1074135145===sa)return!0;Fa&&Fa.Xx(124);Fa&&Fa.isFeatureEnabled(124)&&1074135153===sa&&(Pa=!0);return Pa}Udn(sa){switch(sa){case 1074135162:return!0}return!1}dfl(sa,Fa){const Pa=new n.a,Na=new n.a,Aa=
new n.a;var za=sa.runtime.$Da;const xa=za?za.id:z.a.nil;this.OLf(za).forEach(ka=>{Pa.add(Fa(ka));return!0});za=sa.input.aaa.eg(sa.input.aaa.length-1);this.OLf(za,xa).forEach(ka=>{Na.add(Fa(ka));return!0});sa=sa.input.kWa.eg(sa.input.kWa.length-1);this.OLf(sa,xa).forEach(ka=>{Aa.add(Fa(ka));return!0});return{jKk:Pa,yKo:Na,y9o:Aa}}OLf(sa,Fa=null){const Pa=new n.a;Fa||(Fa=z.a.nil);for(;sa&&!Fa.equals(sa.id);)Pa.add(sa),sa=sa.vX;Pa.reverse();return Pa}DGo(sa){const Fa=3===this.TVd;let Pa=!1;!sa.output.succeeded&&
(2===this.TVd||sa.output.crash&&1===this.TVd)&&(Pa=!0);let Na=!1;sa.input.aaa&&0<sa.input.aaa.length&&(Fa||Pa)&&sa.runtime.Nu&&sa.runtime.uk&&sa.runtime.Zb&&(Na=sa.runtime.Zb.isFeatureEnabled(53));return Na}Fvi(sa){return 9===L.a.Ljb(L.a.rnf(sa))}ZAi(sa){return 8===L.a.Ljb(L.a.rnf(sa))}static r_l(sa){return sa.output.crash?2:sa.output.succeeded?3:1}static Z9b(sa,Fa){if(!Fa||Fa===z.a.nil)return null;const Pa=sa.runtime.vn.J(Fa);return Pa?Pa.Dm:sa.runtime.uk.J(Fa)}}ua.RVd=z.a.If("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(D.a)(ua,"GraphMergerBase",null,[1563])},1805:function(D,J,c){D=c(0);var l=c(225),e=c(1658),a=c(189),k=c(1571);class x extends e.a{constructor(n,t,z,v,I,E,H,M,K,L,S,Q,N,O){super(n,3,t,z,v,I,E,M,K,L,S,Q,N,O);this.Vve=H}get character(){return this.Vve}get text(){return this.character.toString()}w$c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}v9b(){return"CharRun"}clone(){return new x(this.AGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,this.character,
this.snb,this.PRa,this.Lca,this.UFa,this.BTa,this.JF,this.nu)}JA(n,t,z,v=!1){return super.JA(n,t,z,v)?n.character===this.character?!0:k.a.Kvh(n.character,this.character):!1}}Object(D.a)(x,"CharRunMergeBlock",e.a,[]);c.d(J,"a",function(){return y});class y extends e.a{constructor(n,t,z,v,I,E,H,M,K,L,S,Q,N,O,X){super(n,1,t,z,v,I,E,M,L,S,Q,N,O,X);this._text=H;this.XUe=K}get text(){return this._text}w$c(n){this._text=n}get M8a(){return this.XUe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.XUe)}v9b(){return"TextRun"}clone(){return new y(this.AGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,this._text,this.snb,this.XUe,this.PRa,this.Lca,this.UFa,this.BTa,this.JF,this.nu)}JA(n,t,z,v=!1){return super.JA(n,t,z,v)?k.a.Jvh(this._text,n._text):!1}Uad(){const n=new l.a;for(let z=0;z<this.text.length;z++){var t=k.a.charAt(this._text,z);if(k.a.oWm(k.a.JLo(t))){let v="";v+=t;t=k.a.charAt(this._text,++z);v+=t;t=new y(this.AGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,
v,this.snb,!1,this.PRa,this.Lca,this.UFa,this.BTa,this.JF,this.nu);n.add(t)}else t=new x(this.AGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,t,this.snb,this.PRa,this.Lca,this.UFa,this.BTa,this.JF,this.nu),n.add(t)}return n}}Object(D.a)(y,"TextRunMergeBlock",e.a,[])},1806:function(D,J,c){D=c(0);var l=c(250),e=c(16),a=c(6),k=c(118),x=c(817),y=c(184),n=c(225),t=c(368),z=c(1516);class v{constructor(H,M,K){this.position=H;this.leader=M;this.val=K}equals(H){return this.position===H.position&&this.leader===
H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(D.a)(v,"TabStop",null,[]);var I=c(1901);c.d(J,"a",function(){return E});class E extends z.a{constructor(){super()}get Wn(){return 20}get yA(){return 0}wk(){const H=super.wk();H.Z(x.a.Ab(e.a.ho),1);H.Z(x.a.Ab(e.a.Rn),1);H.Z(x.a.Ab(e.a.Im),1);H.Z(x.a.Ab(a.a.ot),1);H.Z(x.a.Ab(a.a.uq),1);H.Z(x.a.Ab(a.a.Wc),1);H.Z(x.a.Ab(e.a.Rqb),1);H.Z(x.a.Ab(a.a.FQa),1);H.Z(x.a.Ab(a.a.kIa),1);H.Z(x.a.Ab(e.a.rya),1);H.Z(x.a.Ab(a.a.rGa),1);H.Z(x.a.Ab(a.a.gha),
1);H.Z(x.a.Ab(a.a.sGa),1);H.Z(x.a.Ab(a.a.HEa),1);H.Z(x.a.Ab(a.a.tGa),1);H.Z(x.a.Ab(a.a.IEa),1);H.Z(x.a.Ab(a.a.jIa),1);H.Z(x.a.Ab(a.a.MJa),1);H.Z(x.a.Ab(a.a.NJa),1);H.Z(x.a.Ab(a.a.kAa),1);H.Z(x.a.Ab(a.a.Jv),1);H.Z(x.a.Ab(a.a.Oz),1);H.Z(x.a.Ab(a.a.Pz),1);H.Z(x.a.Ab(a.a.Dw),1);H.Z(x.a.Ab(k.a.RJ),6);H.Z(x.a.Ab(k.a.fWa),6);H.Z(x.a.Ab(a.a.zCb),7);H.Z(x.a.Ab(k.a.RJ),6);H.Z(x.a.Ab(a.a.Auj),2);H.Z(x.a.Ab(k.a.K5k),2);H.Z(x.a.Ab(k.a.GAn),2);H.Z(x.a.Ab(a.a.noc),2);H.Z(x.a.Ab(a.a.Ncd),2);H.Z(x.a.Ab(a.a.zSb),2);
H.Z(x.a.Ab(a.a.g9a),2);H.Z(x.a.Ab(a.a.Ocd),2);H.Z(x.a.Ab(a.a.Pcd),2);H.Z(x.a.Ab(a.a.iNf),2);H.Z(x.a.Ab(a.a.listID),3);H.Z(x.a.Ab(a.a.listLevel),3);return H}oC(H,M){if(M===x.a.Ab(e.a.ho)||M===x.a.Ab(e.a.Rn)||M===x.a.Ab(e.a.Im)||M===x.a.Ab(a.a.ot)||M===x.a.Ab(a.a.uq)||M===x.a.Ab(a.a.Wc)||M===x.a.Ab(e.a.Rqb)||M===x.a.Ab(a.a.FQa)||M===x.a.Ab(a.a.kIa)||M===x.a.Ab(e.a.rya)||M===x.a.Ab(a.a.rGa)||M===x.a.Ab(a.a.gha)||M===x.a.Ab(a.a.sGa)||M===x.a.Ab(a.a.HEa)||M===x.a.Ab(a.a.tGa)||M===x.a.Ab(a.a.IEa)||M===
x.a.Ab(a.a.jIa)||M===x.a.Ab(a.a.MJa)||M===x.a.Ab(a.a.NJa)||M===x.a.Ab(a.a.kAa)||M===x.a.Ab(a.a.Jv)||M===x.a.Ab(a.a.BN)){var K=H.En.value.vu,L=H.En.value.xf;M=H.Ng.value.xf;if(H.tq.runtime.GOa.contains(K.id))return y.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",K.id),!0;if(H.tq.runtime.Zb.Tjb(1000005)&&this.yAo(H,M,L))return H.fl=M.ZK(),E.tph(H),E.sCd(H.tq,H.Xd,L),!0;const S=new n.a;S.add(K);K=new n.a;
K.add(L);L=new n.a;L.add(M);if(!({vn:M}=E.uDj(H.tq,S,L,K)).returnValue)return H.qsg=!0,H.fl=null,!1;E.tph(H);H.fl=M.eg(0).Dm;return!0}return M===x.a.Ab(a.a.Oz)||M===x.a.Ab(a.a.Pz)||M===x.a.Ab(a.a.Dw)?(this.HPo(H),H.og.add(x.a.Ab(a.a.Oz)),H.og.add(x.a.Ab(a.a.Pz)),H.og.add(x.a.Ab(a.a.Dw)),!0):!1}yAo(H,M,K){M=H.Xd.getPropertyString(M,a.a.BN);H=H.Xd.getPropertyString(K,a.a.BN);return M||H?!0:!1}HPo(H){const M=H.Xd,K=H.fl;var L=H.En.value.xf,S=H.Ng.value.xf;H=this.nqf(H.En.value.vu,M);S=this.nqf(S,M);
L=this.nqf(L,M);({Xdn:L,Ydn:H,Zdn:S}=this.i5l(H,S,L));L.length?(M.setPropertyUint32s(K,a.a.Dw,L),M.setPropertyUint32s(K,a.a.Oz,H),M.setPropertyUint32s(K,a.a.Pz,S)):this.D_n(K)}nqf(H,M){const K=M.getPropertyUint32s(H,a.a.Dw),L=M.getPropertyUint32s(H,a.a.Oz);H=M.getPropertyUint32s(H,a.a.Pz);M=new n.a;if(!K)return M;for(let S=0;S<K.length;++S)M.add(new v(K.J(S),L.J(S),H.J(S)));return M}i5l(H,M,K){({G_i:M,H_i:N,I_i:Q}=this.P8h(H,M));let L,S;({G_i:K,H_i:L,I_i:S}=this.P8h(H,K));H=this.Pom(H,N,Q,L,S);var Q=
this.Oom(H,M,K);H=new n.a;M=new n.a;var N=new n.a;for(K=0;K<Q.length;++K)H.add(Q.J(K).position),M.add(Q.J(K).leader),N.add(Q.J(K).val);return{Xdn:H,Ydn:M,Zdn:N}}P8h(H,M){let K,L,S;K=new n.a;L=new t.a;S=new t.a;let Q,N;for(Q=N=0;Q<H.length&&N<M.length;)H.J(Q).position===M.J(N).position?(H.J(Q).equals(M.J(N))||S.Z(H.J(Q).position,M.J(N)),++Q,++N):H.J(Q).position<M.J(N).position?(L.Z(H.J(Q).position,H.J(Q)),++Q):(K.add(M.J(N)),++N);for(;Q<H.length;)L.Z(H.J(Q).position,H.J(Q)),++Q;for(;N<M.length;)K.add(M.J(N)),
++N;return{G_i:K,H_i:L,I_i:S}}Pom(H,M,K,L,S){const Q=new n.a;for(let N=0;N<H.length;++N){const O=H.J(N).position;M.nb(O)||(K.nb(O)?Q.add(K.J(O)):L.nb(O)||(S.nb(O)?Q.add(S.J(O)):Q.add(H.J(N))))}return Q}Oom(H,M,K){M=this.mPi(M,K);return this.mPi(H,M)}mPi(H,M){const K=new n.a;let L,S;for(L=S=0;L<H.length&&S<M.length;)H.J(L).position<=M.J(S).position?(K.add(H.J(L)),H.J(L).position===M.J(S).position&&++S,++L):K.add(M.J(S++));for(;L<H.length;)K.add(H.J(L++));for(;S<M.length;)K.add(M.J(S++));return K}D_n(H){H.removeProperty(a.a.Dw);
H.removeProperty(a.a.Oz);H.removeProperty(a.a.Pz)}static mh(){return new E}static get instance(){return E.Pg.value}static tph(H){H.og.add(x.a.Ab(e.a.ho));H.og.add(x.a.Ab(e.a.Rn));H.og.add(x.a.Ab(e.a.Im));H.og.add(x.a.Ab(a.a.ot));H.og.add(x.a.Ab(a.a.uq));H.og.add(x.a.Ab(a.a.Wc));H.og.add(x.a.Ab(e.a.Rqb));H.og.add(x.a.Ab(a.a.FQa));H.og.add(x.a.Ab(a.a.kIa));H.og.add(x.a.Ab(e.a.rya));H.og.add(x.a.Ab(a.a.rGa));H.og.add(x.a.Ab(a.a.gha));H.og.add(x.a.Ab(a.a.sGa));H.og.add(x.a.Ab(a.a.HEa));H.og.add(x.a.Ab(a.a.tGa));
H.og.add(x.a.Ab(a.a.IEa));H.og.add(x.a.Ab(a.a.jIa));H.og.add(x.a.Ab(a.a.MJa));H.og.add(x.a.Ab(a.a.NJa));H.og.add(x.a.Ab(a.a.kAa));H.og.add(x.a.Ab(a.a.Jv));H.og.add(x.a.Ab(a.a.BN))}static uDj(H,M,K,L){return(new I.a(H,M,K,L)).yoc()}static sCd(H,M,K){K=M.getPropertyObjectIds(K,e.a.Rn);for(let S=0;S<K.length;S++){var L=H.runtime.Mq.J(K.eg(S));if(L&&(L=M.getPropertyObjectId(L,a.a.me))){H.runtime.xmc.add(L);break}}}}E.Pg=new l.a(E.mh);Object(D.a)(E,"ParagraphNodeComplexMerge",z.a,[])},1807:function(D,
J,c){D=c(0);var l=c(75),e=c(1524),a=c(1653),k=c(1572),x=c(1542),y=c(1589),n=c(1526),t=c(1529),z=c(1528),v=c(1522),I=c(1521);class E{constructor(Y){this.fc=Y;this.wyd=this.zvf()}qL(){return"Add-ins"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:3}eI(Y,aa){Y=new z.a(Y);aa.resultsUpdated(Y)}akb(Y,aa,ba){let oa;oa=this.fc.XP?new t.a(29):new t.a(27);oa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ba&&this.Zyo(Y.Fg,aa,oa)}Zyo(Y,aa,ba){const oa=[];let ma;ma=this.fc.lIm?this.fc.XP&&this.fc.rfb?
I.a.Uib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):this.fc.mIm?this.fc.XP&&this.fc.rfb?I.a.Uib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.fc.XP&&this.fc.rfb?I.a.Uib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
Y);this.fc.exa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ma)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y))):(oa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ma)),oa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(oa));ba.Ww(new n.a("LaunchAddinDialogFromTellMe",29));aa.gv(ba)}zvf(){const Y=[];this.fc.jZd&&
Array.add(Y,"Addin");return Y}}Object(D.a)(E,"AddinStoreResultsProvider",null,[1307]);var H=c(1757),M=c(1562),K=c(1573),L=c(1758),S=c(1796),Q=c(1759),N=c(1588),O=c(2),X=c(35),U=c(139);c.d(J,"a",function(){return T});class T{constructor(Y,aa,ba){this.aeb=this.yDc=this.zDc=this.Dxd=!1;this.AQ=null;this.O2=-1;this.TZa=this.rEc=this.kga=this.Jzb=null;this.c5g=this.l5g=0;this.fc=Y;const oa=I.a.Npa();this.dbb=aa||[];this.Zf=O.AFrameworkApplication.He;this.Zgh=Y.OZf;this.ADc=Y.NZf;this.Bxd=oa&&this.dRb();
this.Cxd=oa&&this.eRb();this.ahh=oa&&this.fRb();this.Fxd=this.gRb();this.lTe=this.Xlc();if((aa=Y.vkg&&I.a.pgg(Y))||Y.mha)this.Jzb=new S.a(Y),this.Dxd=Y.Tbd;aa&&(this.zDc=Y.Vbd,this.yDc=Y.amb,this.aeb=this.Dxd&&this.ox("File")||this.zDc&&this.ox("People")||this.yDc&&this.ox("Notes"));this.Axd=this.Quo();this.CDc=Y.Y2c;this.Exd=this.jvo();this.kTe=this.Puo();this.w0b=this.Oie();this.maa=this.Yhm();this.xMg=new H.a(Y);this.a7j=new L.a(Y);this.Kmk=new Q.a(Y);this.KVj=new E(Y);this.sCc=ba;this.hzb=new a.a;
this.CDc&&(this.xMg=new H.a(Y));Y.mha&&(this.kTe=this.Exd=this.CDc=this.aeb=this.yDc=this.zDc=this.lTe=this.Fxd=this.ahh=this.Cxd=this.Bxd=this.ADc=!1,O.AFrameworkApplication.K&&this.ox("File")&&this.Wrj()||this.w0b)&&(Y=this.hzb.jwf("Search",O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.lOc(Y,"TellMeService",!0),Y=this.hzb.jwf("SmartLookup",O.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")),this.lOc(Y,"Shredder",!1));O.AFrameworkApplication.K&&this.aeb&&
this.ox("File")&&this.Wrj()&&(Y=this.hzb.jwf("Search",O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.lOc(Y,"TellMeService",!0))}ox(Y){return Array.contains(this.dbb,Y)?!0:!1}qL(){return"TellMeService"}CU(){return 0===this.fc.kv?0:1===this.fc.kv?1:this.ox("Command")||this.ox("Recommended")?2:3}Vhm(Y){let aa="";if(!Y&&this.ox("Command")&&this.fc.PGf){aa+="CommandSearch_DLIS,";var ba=this.fc.kzj;0<ba.length&&(aa+=ba+",")}Y&&this.ox("Recommended")&&this.ADc&&(ba=this.amm(),0<
ba.length&&(aa+=ba+","));!Y&&this.ox("Help")&&(Y=this.fc.jzj,0<Y.length&&(aa+=Y+","));this.fc.mha&&this.TZa&&0<this.TZa.length&&(aa+="IsRecallEnabled_true,");(this.fc.P7b||this.fc.TMd||this.fc.mha)&&this.aeb&&(aa+="IsGenerateSlidesEnabled_true,");0<aa.length&&(aa=aa.substr(0,aa.length-1));return aa}lOc(Y,aa,ba){const oa=ba?this.l5g:this.c5g;if(!oa||window.performance.now()-oa>=I.a.b9a)if(Y)ba?this.l5g=window.performance.now():this.c5g=window.performance.now(),Y.then(ma=>{ba?this.rEc=ma:(this.TZa=
ma,v.TellMeActor.instance.mig=ma)},ma=>{v.TellMeActor.instance.Pe.onError("TellMeServiceProvider:FetchTokenForService_"+aa,"tellMeServiceToken promise rejected: "+ma)});else if(v.TellMeActor.instance.Pe)v.TellMeActor.instance.Pe.onError("TellMeServiceProvider:FetchTokenForService_"+aa,"undefined token promise")}eI(Y,aa,ba,oa=e.a.tellMe,ma=null){const ea=new z.a(Y);ba=I.a.GR(Y);this.ox("File")&&(this.aeb||this.fc.mha)&&this.lOc(this.hzb.Zhm(),"TellMeService",!0);(this.ox("File")&&this.fc.mha||this.ox("ActionAI")&&
this.w0b)&&this.lOc(this.hzb.Xem(),"Shredder",!1);var ua=this.aeb&&!!this.rEc;const sa=this.fc.mha&&!!this.TZa;var Fa=ua||sa||ba&&this.ox("Recommended")&&this.ADc;ua=ua||sa||!ba&&(this.Zgh&&this.ox("Command")||this.Bxd&&this.ox("Answer")||this.Cxd&&this.ox("Definition")||this.lTe&&this.ox("Image")||this.CDc&&this.ox("Help")||this.Fxd&&this.ox("WolframAnswer")||this.Exd&&this.ox("Template")||this.kTe&&this.ox("Addin"));if(Fa||ua)if(this.kga=oa,oa={"Content-Type":"application/json",Accept:"application/json"},
oa["X-Office-Version"]=O.AFrameworkApplication.buildVersion,oa["X-Office-Application"]=O.AFrameworkApplication.K.kb("Application"),oa["X-Office-Platform"]="WAC",oa["X-TellMe-SqmUserId"]=O.AFrameworkApplication.K.kb("LoggableUserId")||"",oa["X-TellMe-SessionId"]=v.TellMeActor.instance.fVd(),this.rEc&&(oa.Authorization="Bearer "+this.rEc),this.TZa&&0<this.TZa.length&&(oa["X-TellMe-ShredderToken"]="Bearer "+this.TZa),Fa=this.Vhm(ba),0<Fa.length&&(oa["X-TellMe-Flights"]=Fa),Fa=[],!ba&&this.ox("Answer")&&
this.Bxd&&(ma?Array.contains(ma,9):1)&&Array.add(Fa,"Answer"),!ba&&this.ox("Command")&&this.Zgh&&!M.CommandResultsUtility.jEf(Y.Fg)&&(ma?Array.contains(ma,17):1)&&Array.add(Fa,"Command"),!ba&&this.ox("Definition")&&this.Cxd&&(ma?Array.contains(ma,10):1)&&Array.add(Fa,"Definition"),!ba&&this.ox("Help")&&this.CDc&&(ma?Array.contains(ma,8):1)&&Array.add(Fa,"Help"),!ba&&this.ox("WolframAnswer")&&this.Fxd&&(ma?Array.contains(ma,12):1)&&Array.add(Fa,"WolframAnswer"),ba&&this.ox("Recommended")&&this.ADc&&
!v.TellMeActor.instance.wed&&(ma?Array.contains(ma,18):1)&&Array.add(Fa,"Recommended"),!ba&&this.ox("Image")&&this.lTe&&(ma?Array.contains(ma,19):1)&&Array.add(Fa,"Image"),this.rEc&&this.aeb&&(ma?Array.contains(ma,14)||Array.contains(ma,15)||Array.contains(ma,20):1)&&(this.Jzb.rza(),this.Dxd&&this.ox("File")&&Array.add(Fa,"File"),this.zDc&&this.ox("People")&&Array.add(Fa,"People"),this.yDc&&this.ox("Notes")&&Array.add(Fa,"Notes")),this.TZa&&0<this.TZa.length&&this.fc.mha&&(ma?Array.contains(ma,15):
1)&&(this.Jzb.rza(),this.ox("File")&&Array.add(Fa,"File")),!ba&&this.ox("Template")&&this.Exd&&(ma?Array.contains(ma,23):1)&&Array.add(Fa,"Template"),!ba&&this.ox("Addin")&&this.kTe&&(ma?Array.contains(ma,27):1)&&Array.add(Fa,"Addin"),!ba&&this.ox("ActionAI")&&this.w0b&&(ma?Array.contains(ma,25):1)&&Array.add(Fa,"ActionAI"),Fa.length){oa["X-TellMe-SuggestionTypes"]=Fa.join(",");oa["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;oa["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;
var Pa=this.AQ=U.a.create().toString();oa["Client-Request-Id"]=Pa;var Na=window.performance.now();this.SDa();this.O2=window.setTimeout(()=>{if(Pa===this.AQ){this.AQ="";this.O2=-1;aa.resultsUpdated(ea);const Aa={};Aa[k.a.provider]=this.qL();Aa[k.a.rOb]=Y.Yob;v.TellMeActor.instance.Pe.QA(x.a.timedOut,this.sCc,Aa)}},this.sCc);this.Zf.nj(this.maa,2,this.Xhm(Y.Fg),oa,!1,0,Aa=>{this.XMb(Aa,Y,aa,Pa,Na,ma)},Aa=>{this.GMb(Aa,Y,aa,Pa,Na)},null,null,!1,4E3,this.w0b?3E4:6E3)}else v.TellMeActor.instance.Pe.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),aa.resultsUpdated(ea);else aa.resultsUpdated(ea)}SDa(){-1!==this.O2&&(window.clearTimeout(this.O2),this.O2=-1)}XMb(Y,aa,ba,oa,ma,ea){const ua=new z.a(aa);if(oa===this.AQ){this.SDa();v.TellMeActor.instance.Pe.W9(aa.Fg.length,this.dbb.join(","),Y.data.Ne.toString(),Math.round(window.performance.now()-ma),N.a.tellMe,!0,y.a.XQa);oa=Y.data.te;Y=null;try{Y=X.b(oa)}catch(za){v.TellMeActor.instance.Pe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
za);return}oa=I.a.GR(aa);if("Groups"in Y&&Y.Groups){var sa=Y.Groups;for(var Fa of sa)if("GroupType"in Fa&&"Suggestions"in Fa&&Fa.Suggestions)if("Commands"===Fa.GroupType&&(ea?Array.contains(ea,17):1)||"Recommended"===Fa.GroupType&&(ea?Array.contains(ea,18):1)){var Pa=(sa="Recommended"===Fa.GroupType)?"DLIS":"NaiveBayes";"Source"in Fa&&Fa.Source&&(Pa=Fa.Source);var Na=Fa.Suggestions;new l.a;var Aa=[];for(const za of Na)this.LXm(za)&&(Na=za.Type,("Command"===Na||sa&&"Recommended"===Na)&&Aa.push(new K.a(za.CommandId,
za.Score)));M.CommandResultsUtility.w3d(Aa,!aa.Fg.trim().length,Fa.GroupType,Pa);Pa=v.TellMeActor.instance.s3;Na=[];for(const za of Aa)sa&&Pa&&Pa.E$e(za.commandId)||Na.push(za);Aa=M.CommandResultsUtility.$Rc(aa,Na,this.fc,null,null,null,sa?18:17,0);0<Aa.results.length&&(this.kga!==e.a.contextMenu&&(Aa.displayName=sa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ua.gv(Aa))}else if("Answer"===Fa.GroupType){Na=Fa.Suggestions;sa=null;Aa=2147483647;Pa="";for(const za of Na)if(this.KXm(za))if(Pa=
za.Type,Na=this.lUd(Pa),"Answer"===Pa&&this.Bxd){sa=this.WNh(Pa,za,aa.Fg);break}else Na&&Na<Aa&&(Aa=Na,sa=this.WNh(Pa,za,aa.Fg));Aa=I.a.P8n(aa.Fg,Pa);sa&&(ea?Array.contains(ea,sa.type):1)&&(Pa=[],this.Axd?this.fc.exa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.gD)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,
Aa))):(Pa.push(appChrome.actions.setControlLabel(sa.value,sa.gD)),Pa.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),Pa.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,Aa)),appChrome.api.dispatch(Pa)):this.fc.exa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.gD+" - "+sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(sa.value,Aa))):(Pa.push(appChrome.actions.setControlLabel(sa.value,
sa.gD+" - "+sa.description)),Pa.push(appChrome.actions.setButtonCommandValueId(sa.value,Aa)),appChrome.api.dispatch(Pa)),Aa=this.kfl(sa.type),Aa.Ww(sa),ua.gv(Aa))}else"Help"===Fa.GroupType&&Fa.Suggestions.length&&(ea?Array.contains(ea,8):1)?this.CDc&&(sa=this.xMg.akb(aa,Fa.Suggestions))&&0<sa.results.length&&ua.gv(sa):"Template"===Fa.GroupType&&(ea?Array.contains(ea,23):1)?(sa=Fa.Suggestions)&&0<sa.length&&this.Kmk.akb(aa,ua,sa):"Addin"===Fa.GroupType&&(ea?Array.contains(ea,27):1)?(sa=Fa.Suggestions)&&
0<sa.length&&this.KVj.akb(aa,ua,sa):"ActionAI"===Fa.GroupType&&(ea?Array.contains(ea,25):1)?(Aa=Fa.Suggestions,sa=[],new t.a(25),Aa&&1===Aa.length&&(Pa=Aa[0])&&Pa.CommandId&&(Aa=Pa.CommandId,sa.push(new K.a(Aa,"Score"in Pa?Pa.Score:0)),sa=M.CommandResultsUtility.$Rc(aa,sa,this.fc,null,null,null,25,0),sa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ua.gv(sa))):"Substrate"===Fa.GroupType&&this.aeb&&"Type"in Fa?"File"===Fa.Type&&this.Dxd&&(ea?Array.contains(ea,15):1)?(sa=this.Jzb.drf(Fa.Suggestions,
oa,this.kga))&&0<sa.results.length&&(this.C_d()&&(Aa=new n.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Ww(Aa)),ua.gv(sa)):"People"===Fa.Type&&this.zDc&&(ea?Array.contains(ea,14):1)?(sa=this.Jzb.Vei(Fa.Suggestions,oa,this.kga))&&0<sa.results.length&&ua.gv(sa):"Notes"===Fa.Type&&this.yDc&&(ea?Array.contains(ea,14):1)&&(sa=this.Jzb.Ddi(Fa.Suggestions,oa,aa))&&0<sa.results.length&&ua.gv(sa):"Recall"===Fa.GroupType&&this.fc.mha&&"Type"in Fa&&"IntentService"===Fa.Type&&(ea?Array.contains(ea,15):1)&&(sa=
this.Jzb.drf(Fa.Suggestions,oa,this.kga))&&0<sa.results.length&&(this.C_d()&&(Aa=new n.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Ww(Aa)),ua.gv(sa));else v.TellMeActor.instance.Pe.onError("OnSuccessCallBack","GroupType"in Fa?"Invalid group suggestions found for "+Fa.GroupType:"Invalid group found")}if(Y.Intents){Fa=Y.Intents;for(const za of Fa)this.mJf(za)&&("Image"===za.GroupType&&za.ConfidenceScore>za.ConfidenceThreshold&&(ea?Array.contains(ea,19):1)?this.a7j.akb(aa,ua,0,za):"Commands"===za.GroupType&&
za.ConfidenceScore<za.ConfidenceThreshold&&(ea?Array.contains(ea,17):1)&&(Fa=new t.a(17),ua.gv(Fa)))}ba.resultsUpdated(ua);v.TellMeActor.instance.Pe.W9(aa.Fg.length,this.dbb.join(","),"",Math.round(window.performance.now()-ma),"",!0,y.a.provider)}}GMb(Y,aa,ba,oa,ma){const ea=new z.a(aa);oa===this.AQ&&(this.SDa(),v.TellMeActor.instance.Pe.W9(aa.Fg.length,this.dbb.join(","),Y.data.Ne.toString(),Math.round(window.performance.now()-ma),N.a.tellMe,!1,y.a.XQa));ba.resultsUpdated(ea)}lUd(Y){switch(Y){case "Entity":return this.ahh?
3:0;case "Definition":return this.Cxd?5:0;case "WolframAnswer":return this.Fxd?2:0;default:return 0}}WNh(Y,aa,ba){switch(Y){case "Answer":return new n.a(this.Axd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===aa.Title?ba:aa.Title,aa.Description,0);case "Entity":return new n.a(this.Axd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===aa.Title?ba:aa.Title,aa.Description,0);case "Definition":return new n.a(this.Axd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===aa.Title?ba:aa.Title,aa.Description,
0);case "WolframAnswer":return new n.a("WolframForSearch",3,""===aa.Title?ba:aa.Title,aa.Description,0);default:return null}}kfl(Y){switch(Y){case 0:return new t.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new t.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new t.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new t.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new t.a(19,this.fc.Slc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}KXm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}LXm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&""!==Y.CommandId&&"Score"in Y&&!!Y.Score}mJf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;v.TellMeActor.instance.Pe.onError("IsValidIntentGroup","Invalid intents found");return!1}Xhm(Y){const aa=I.a.qDi(Y),ba={};ba.Query=Y;aa&&this.ADc&&(this.yRm()?
ba.UserActionEvents=v.TellMeActor.instance.Flh:(ba.CommandClickedEvents=v.TellMeActor.instance.Lwe,ba.CommandActionEvents=v.TellMeActor.instance.PPg),ba.TellMeCommandClickMruEvents=v.TellMeActor.instance.i8g,ba.ContentType=v.TellMeActor.instance.sKd);this.Exd&&(Y={},Y.Application=this.fc.application,ba.TemplateInfo=Y);return X.c(ba)}dRb(){return!!this.fc&&this.fc.dRb||!!O.AFrameworkApplication.ta&&O.AFrameworkApplication.ta.Kb.dRb}eRb(){return!!this.fc&&this.fc.eRb||!!O.AFrameworkApplication.ta&&
O.AFrameworkApplication.ta.Kb.eRb}fRb(){return!!this.fc&&this.fc.fRb||!!O.AFrameworkApplication.ta&&O.AFrameworkApplication.ta.Kb.fRb}gRb(){return!!this.fc&&this.fc.gRb||!!O.AFrameworkApplication.ta&&O.AFrameworkApplication.ta.Kb.gRb}Xlc(){return!!this.fc&&(this.fc.Xlc||this.fc.XP)}Quo(){return!!this.fc&&!this.fc.f5a}jvo(){return!!this.fc&&this.fc.OYc}Puo(){return!!this.fc&&this.fc.nIm&&this.fc.kIm}Oie(){return!!this.fc&&this.fc.Oie}aEi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}bEi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}yRm(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}C_d(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Wrj(){return!!O.AFrameworkApplication.K&&
O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}amm(){return O.AFrameworkApplication.K?O.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}Yhm(){if(!O.AFrameworkApplication.K)return"";if(this.bEi())return O.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.aEi())return O.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(I.a.QEf())return O.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");
let Y=O.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=O.AFrameworkApplication.izj);return Y}static yOh(Y,aa){if(aa)return new T(Y,["Command","Recommended"],Y.eYl);aa=I.a.Npa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new T(Y,aa,Y.Khi)}}Object(D.a)(T,"TellMeServiceProvider",null,[1307])},1900:function(D,J,c){c.r(J);c.d(J,"MarkerValidation",
function(){return a});D=c(0);var l=c(368),e=c(1744);class a{constructor(){this.OYd=this.Dui=this.Cui=this.Bui=0}f9h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.Bui);k.Z("InvalidComments",this.Cui);k.Z("InvalidContentControls",this.Dui);0!==this.OYd&&k.Z("InvalidMarkerType",this.OYd);return k}Qni(){return 0<this.Bui||0<this.Cui||0<this.Dui||0!==this.OYd?!0:!1}toString(){return JSON.stringify(e.a.iWa(this.f9h()))}}Object(D.a)(a,"MarkerValidation",null,[])},1901:function(D,J,c){c.d(J,"a",function(){return y});
D=c(0);var l=c(184),e=c(1061),a=c(239),k=c(1669),x=c(1593);class y{constructor(n,t,z,v,I=null,E=null,H=null,M=null){this.$d=n;this.XF=t;this.ABa=z;this.UCa=v;this.Gbk=I;this.c3j=E;this.dok=H;this.Ysa=M||this.nbf()}nbf(){return n=>!!this.$d.runtime.Zb&&this.$d.runtime.Zb.isFeatureEnabled(n)}Sal(){return()=>this.$d.runtime.Zb}dhf(){return!!this.$d.runtime.uk.J(a.a.PL)}Uuj(){let n;if(1===this.$d.input.source||2===this.$d.input.source)n=82;else if(4===this.$d.input.source||3===this.$d.input.source)n=
41;else if(5===this.$d.input.source)n=119;else return!1;return this.dhf()&&this.Ysa(n)}Xwj(n,...t){return String.format.apply(null,[n].concat(t))}LTd(n){const {ParagraphMerge:t}=c(1995);let z=this.$d,v=this.ABa,I=this.UCa;n||(z=this.Gbk||this.$d,v=this.c3j||v,I=this.dok||I);var E=x.a.Rsf(this.XF);const H=x.a.Rsf(v),M=x.a.Rsf(I);E=this.Xwj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.$Da.id,z.runtime.rOd,z.runtime.Zne,E.hr(),H.hr(),M.hr());return n?{returnValue:new k.a(z,this.XF,v,I,this.nbf(),new e.a),hr:E}:{returnValue:new t(z,this.XF,v,I,this.nbf(),this.Sal(),new e.a),hr:E}}yoc(){this.$d.logger.Gmo();var n=this.Uuj();var t=({hr:v}=this.LTd(n)).returnValue;l.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",n,v);this.$d.logger.bV("ParagraphMergeSelector initialization");n?this.$d.logger.Che(1):this.$d.logger.Che(2);
let z=({vn:t}=t.yoc()).returnValue;this.$d.logger.ueg();var v=!z;n=!!this.$d.runtime.uk.J(a.a.PL)&&(n&&!z||!n);v&&({hr:v,returnValue:t}=this.LTd(!1),{vn:t,returnValue:z}=t.yoc(),l.a.instance.Ua(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,v));n&&(v=new e.a,x.a.F7n(this.$d,v));this.$d.logger.bV("ParagraphMergeSelector finalization");return{returnValue:z,vn:t}}Kdd(n,t){let z,v,I;const E=this.Uuj()&&this.Ysa(120);let H=({hr:I}=this.LTd(E)).returnValue,M=({B7a:z,
gra:v}=H.Kdd(n,t)).returnValue;l.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",E,I);E&&!M&&H.kag&&({hr:I,returnValue:H}=this.LTd(!1),{B7a:z,gra:v,returnValue:M}=H.Kdd(n,t),l.a.instance.Ua(18994392,1,M?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",M,I));return{returnValue:M,B7a:z,gra:v}}}Object(D.a)(y,"ParagraphMergeSelector",null,[1867])},1902:function(D,J,c){c.r(J);c.d(J,"SurfaceStringTokenStringGenerator",
function(){return e});D=c(0);var l=c(1623);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,n,t,z){null==t&&(t=a.Kji(n,k));z=l.a.Aqh(a,t,this.Bb.score,x,y,z);return{wcd:t,ZHc:z}}}e.$Hc=0;Object(D.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1903:function(D,J,c){c.r(J);c.d(J,"QueryTokenStringGenerator",function(){return a});D=c(0);var l=c(1623),e=c(1517);class a extends l.a{constructor(k){super(k);this.Bb=k}apply(k,x,y,n,t,z,v){x=this.Bb.query.load(x,null);t=0;let I=null;this.Bb.query.I5===
e.Annotations.mAa?x&&(I=this.Bb.name):((I=this.Bb.name)&&(I+="_"),I+=this.Bb.annotations.Pea(this.Bb.query.I5,x));null!=I&&(t=l.a.Aqh(k,I,this.Bb.score,y,n,t));return{wcd:z,ZHc:v+t}}}a.$Hc=1;Object(D.a)(a,"QueryTokenStringGenerator",l.a,[])},1904:function(D,J,c){c.r(J);c.d(J,"FuzzyMatchTokenStringGenerator",function(){return e});D=c(0);var l=c(1623);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,n,t,z){null==t&&(t=a.Kji(n,k));a=this.Bb.CYh.x9m(t);if(this.Bb.XZi)for(var v of a)if(!v.PO&&
v.hPd)return{wcd:t,ZHc:z};v=0;for(const I of a)if(I.PO&&!({p6e:v}=this.Bvh(I,!0,x,y,v)).returnValue)return{wcd:t,ZHc:z};if(this.Bb.iri)for(const I of a)if(!({p6e:v}=this.Bvh(I,!1,x,y,v)).returnValue)break;return{wcd:t,ZHc:z}}Bvh(a,k,x,y,n){let t;k?(k=0,t=a.hPd?1:0):(k=a.hPd?1:0,t=a.count-k);for(let z=0;z<t;++z)if(l.a.Bqh(a.wib+k+z,this.Bb.score,x,y),++n,0<this.Bb.FPf&&n>=this.Bb.FPf)return{returnValue:!1,p6e:n};return{returnValue:!0,p6e:n}}}e.$Hc=2;Object(D.a)(e,"FuzzyMatchTokenStringGenerator",l.a,
[])},1985:function(D,J,c){D=c(0);var l=c(6),e=c(47),a=c(250),k=c(1516);class x extends k.a{constructor(){super()}get Wn(){return 2}get yA(){return 7}static mh(){return new x}static get instance(){return x.Pg.value}}x.Pg=new a.a(x.mh);Object(D.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(16),n=c(817),t=c(184),z=c(1561);class v extends k.a{constructor(){super()}get Wn(){return 3}get yA(){return 7}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.QR),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(y.a.QR)){const uc=
fb.fl;var Ec=fb.Xd;t.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",uc.id,uc.Oc,Pb);Pb=Ec.getPropertyMilliseconds(fb.Ng.value.xf,y.a.QR);Ec=Ec.getPropertyMilliseconds(fb.En.value.xf,y.a.QR);Pb<Ec&&this.iTl(fb);fb.og.add(n.a.Ab(y.a.QR));return!0}t.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}iTl(fb){this.C4n(fb.En.value.xf,
fb.fl);this.Gpf(fb,l.a.g2e);this.Gpf(fb,l.a.Eth);this.Gpf(fb,l.a.sth)}Gpf(fb,Pb){var Ec=fb.Xd,uc=fb.fl;if(Ec.hasProperty(uc,Pb)&&(Pb=Ec.getPropertyObjectIds(uc,Pb))&&Pb.length)for(Ec=fb.tq.runtime.Mq,fb=fb.tq.runtime.vn,uc=0;uc<Pb.length;uc++){const ya=Pb.J(uc);if(!Ec.nb(ya))continue;const db=Ec.J(ya).ZK();fb.add(ya,new z.a(db,!1))}}static mh(){return new v}static get instance(){return v.Pg.value}}v.Pg=new a.a(v.mh);Object(D.a)(v,"AppNodeComplexMerge",k.a,[]);class I extends k.a{constructor(){super()}get Wn(){return 4}get yA(){return 7}static mh(){return new I}static get instance(){return I.Pg.value}}
I.Pg=new a.a(I.mh);Object(D.a)(I,"AppPropNodeComplexMerge",k.a,[]);class E extends k.a{constructor(){super()}get Wn(){return 5}get yA(){return 7}static mh(){return new E}static get instance(){return E.Pg.value}}E.Pg=new a.a(E.mh);Object(D.a)(E,"AppRefNodeComplexMerge",k.a,[]);var H=c(368),M=c(613),K=c(225),L=c(19);class S{constructor(fb,Pb){this.id=fb;this.ZCo=Pb}}Object(D.a)(S,"IdAndTime",null,[]);class Q extends k.a{constructor(){super()}get Wn(){return 6}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.R_a),
1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.R_a)){const Ec=fb.fl,uc=fb.Xd;t.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.Oc,Pb);Pb=uc.getPropertyObjectIds(fb.Ng.value.vu,l.a.R_a);const ya=uc.getPropertyObjectIds(fb.Ng.value.xf,l.a.R_a),db=uc.getPropertyObjectIds(fb.En.value.xf,l.a.R_a);Pb=this.Vcn(fb,Pb,ya,db);0<Pb.length?uc.setPropertyObjectIds(Ec,l.a.R_a,Pb):Ec.removeProperty(l.a.R_a);fb.og.add(n.a.Ab(l.a.R_a));
return!0}t.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}Vcn(fb,Pb,Ec,uc){const ya=this.sHa(Pb,Ec,uc),db=Pb.hH(),tb=Ec.hH(),Xb=uc.hH();Pb=k.a.filter(ya,vc=>!db.contains(vc)&&tb.contains(vc));Ec=k.a.filter(ya,vc=>!db.contains(vc)&&Xb.contains(vc));if(!Pb.length||!Ec.length)return ya;const $b=new H.a;Pb.forEach(vc=>{const Sc=new S(vc,this.I5h(fb,vc,!1));this.E5h(fb,vc,!1).forEach(ed=>
{$b.add(ed,Sc);return!0});return!0});const Ab=new M.a;Ec.forEach(vc=>{const Sc=this.I5h(fb,vc,!0);this.E5h(fb,vc,!0).forEach(ed=>$b.nb(ed)?(Ab.add($b.J(ed).ZCo>=Sc?vc:$b.J(ed).id),!1):!0);return!0});return k.a.filter(ya,vc=>!Ab.contains(vc))}I5h(fb,Pb,Ec){return(Pb=this.Yha(fb,Pb,Ec))?fb.Xd.getPropertyMilliseconds(Pb,y.a.QR):0}Yha(fb,Pb,Ec){fb=Ec?fb.tq.runtime.Mq:fb.tq.runtime.Nu;return fb.nb(Pb)?fb.J(Pb):null}E5h(fb,Pb,Ec){const uc=new K.a,ya=new M.a,db=fb.Xd;Pb=this.Yha(fb,Pb,Ec);var tb=this.ggi(db,
Pb);if(tb)for(uc.add(tb),ya.add(tb),Pb=db.getPropertyObjectIds(Pb,l.a.g2e),tb=0;Pb&&tb<Pb.length;tb++){const Xb=this.ggi(db,this.Yha(fb,Pb.J(tb),Ec));if(!Xb)break;ya.contains(Xb)||(uc.add(Xb),ya.add(Xb))}return uc}ggi(fb,Pb){if(!fb.hasProperty(Pb,l.a.kfb)||!fb.hasProperty(Pb,l.a.l3b)||!fb.hasProperty(Pb,l.a.m3b))return null;const Ec=fb.getPropertyString(Pb,l.a.kfb),uc=fb.getPropertyString(Pb,l.a.l3b);fb=fb.getPropertyString(Pb,l.a.m3b);return L.a.ZA(Ec+";"+uc+";"+fb)}static mh(){return new Q}static get instance(){return Q.Pg.value}}
Q.Pg=new a.a(Q.mh);Object(D.a)(Q,"AppsNodeComplexMerge",k.a,[]);class N extends k.a{constructor(){super()}get Wn(){return 36}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Npg),1);fb.Z(n.a.Ab(l.a.Ieg),1);return fb}oC(fb,Pb){t.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Pb);if(Pb===n.a.Ab(l.a.Npg)||Pb===n.a.Ab(l.a.Ieg)){const db=n.a.$X(Pb);var Ec=fb.Ng.value.xf,uc=fb.En.value.xf;const tb=fb.fl;var ya=fb.Xd.getPropertyStrings(fb.Ng.value.vu,db);Ec=fb.Xd.getPropertyStrings(Ec,
db);uc=fb.Xd.getPropertyStrings(uc,db);ya=this.sHa(ya,Ec,uc);fb.Xd.setPropertyStrings(tb,db,ya);fb.og.add(Pb);return!0}return!1}static mh(){return new N}static get instance(){return N.Pg.value}}N.Pg=new a.a(N.mh);Object(D.a)(N,"AutoSaveParametersNodeComplexMerge",k.a,[]);class O extends k.a{constructor(){super()}get Wn(){return 44}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.gf),1);return fb}oC(fb,Pb){const Ec=fb.tq.runtime.Zb;if(Pb===n.a.Ab(y.a.gf))return t.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
fb.fl.id,fb.fl.Oc,Pb),Ec.Xx(124),Ec.isFeatureEnabled(124)?this.Ycn(fb,Pb):this.sdn(fb,Pb),!0;t.a.instance.Ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}Ycn(fb,Pb){const Ec=n.a.$X(Pb),uc=fb.Xd;var ya=uc.getPropertyObjectIds(fb.Ng.value.vu,Ec),db=uc.getPropertyObjectIds(fb.Ng.value.xf,Ec),tb=uc.getPropertyObjectIds(fb.En.value.xf,Ec);tb=O.Qjm(fb,db,tb);ya=this.sHa(ya,db,
tb);db=fb.fl;0<ya.length?uc.setPropertyObjectIds(db,Ec,ya):db.removeProperty(Ec);fb.og.add(Pb)}static mh(){return new O}static get instance(){return O.Pg.value}static Qjm(fb,Pb,Ec){const uc=new K.a,ya=new H.a;Pb.forEach(db=>{const tb=fb.tq.runtime.Nu.J(db);tb&&ya.add(tb.AU(l.a.At).toString(),db);return!0});Ec.forEach(db=>{var tb=fb.tq.runtime.Mq.J(db);tb?(tb=tb.AU(l.a.At).toString(),ya.nb(tb)&&ya.get(tb)!==db?t.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
uc.add(db)):uc.add(db);return!0});return uc}}O.Pg=new a.a(O.mh);Object(D.a)(O,"BookmarkContainerNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super()}get Wn(){return 41}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.LBb),1);fb.Z(n.a.Ab(l.a.At),1);return fb}oC(fb,Pb){return Pb===n.a.Ab(l.a.LBb)?(fb.og.add(n.a.Ab(l.a.LBb)),!0):Pb===n.a.Ab(l.a.At)?(fb.og.add(n.a.Ab(l.a.At)),!0):!1}af(fb){return fb&&fb.length?!1:!0}static mh(){return new X}static get instance(){return X.Pg.value}}X.Pg=new a.a(X.mh);
Object(D.a)(X,"BookmarkNodeComplexMerge",k.a,[]);class U extends k.a{constructor(){super();this.HZd=!1}get Wn(){return 7}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.gf),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(y.a.gf)){const ya=fb.fl,db=fb.Xd;var Ec=fb.tq.runtime.Zb;Ec&&(this.HZd=Ec.isFeatureEnabled(76));t.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Oc,Pb);Pb=db.getPropertyObjectIds(fb.Ng.value.vu,y.a.gf);
Ec=db.getPropertyObjectIds(fb.Ng.value.xf,y.a.gf);var uc=db.getPropertyObjectIds(fb.En.value.xf,y.a.gf);Pb=this.gdn(Pb,Ec,uc);if(this.HZd&&0<Pb.length){Ec=new Sys.StringBuilder;for(uc=0;uc<Pb.length;uc++)Ec.append(Pb.J(uc).toString()+",");t.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",ya.id,Ec.toString())}0<Pb.length?db.setPropertyObjectIds(ya,y.a.gf,Pb):ya.removeProperty(y.a.gf);fb.og.add(n.a.Ab(y.a.gf));return!0}t.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
fb.Ng.value.xf.id,Pb);return!1}gdn(fb,Pb,Ec){const uc=new K.a,ya=new H.a(0);this.iDl(fb,Ec,uc,ya);return this.Hnl(Pb,ya,uc)}iDl(fb,Pb,Ec,uc){fb=fb||new K.a;Pb=Pb||new K.a;fb.forEach(ya=>{uc.Z(ya,1);return!0});Pb.forEach(ya=>{uc.Fc(ya).returnValue?uc.Z(ya,2):(uc.Z(ya,0),Ec.add(ya));return!0})}Hnl(fb,Pb,Ec){fb=fb||new K.a;const uc=new K.a,ya=new K.a,db=new K.a;fb.forEach(tb=>{let Xb=!0,$b;({value:$b}=Pb.Fc(tb)).returnValue&&(0===$b?Pb.Z(tb,2):1===$b&&(Xb=!1));Xb?uc.add(tb):this.HZd&&ya.add(tb);return!0});
Ec.forEach(tb=>{let Xb=!1,$b;({value:$b}=Pb.Fc(tb)).returnValue?0===$b&&(Xb=!0,Pb.Z(tb,2)):t.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",tb);Xb?uc.add(tb):this.HZd&&db.add(tb);return!0});this.DLi(ya,"Favored");this.DLi(db,"Unfavored");return uc}DLi(fb,Pb){if(fb.length){var Ec=new Sys.StringBuilder;for(let uc=0;uc<fb.length;uc++)Ec.append(fb.J(uc).toString()+",");t.a.instance.Ua(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Pb,Ec.toString())}}static mh(){return new U}static get instance(){return U.Pg.value}}U.Pg=new a.a(U.mh);Object(D.a)(U,"CommentContentNodeComplexMerge",k.a,[]);var T=c(69),Y=c(35);class aa extends k.a{constructor(){super();this.Eih=[1];this.bQe=new H.a}get Wn(){return 8}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Qba),3);fb.Z(n.a.Ab(l.a.hF),3);fb.Z(n.a.Ab(l.a.zJc),2);fb.Z(n.a.Ab(l.a.commentId),2);fb.Z(n.a.Ab(l.a.AHh),2);fb.Z(n.a.Ab(l.a.XDa),
2);fb.Z(n.a.Ab(l.a.SOa),1);fb.Z(n.a.Ab(l.a.ikb),1);fb.Z(n.a.Ab(l.a.hlb),1);fb.Z(n.a.Ab(l.a.VQ),1);fb.Z(n.a.Ab(l.a.UG),1);fb.Z(n.a.Ab(l.a.yJc),2);fb.Z(n.a.Ab(l.a.vHd),2);fb.Z(n.a.Ab(l.a.e5b),2);fb.Z(n.a.Ab(l.a.L9e),2);fb.Z(n.a.Ab(l.a.AM),1);fb.Z(n.a.Ab(y.a.gf),0);fb.Z(n.a.Ab(l.a.MH),0);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.AM)){var Ec=fb.Xd.getPropertyString(fb.En.value.xf,l.a.AM);this.af(Ec)?fb.fl.removeProperty(l.a.AM):fb.fl.DUa(l.a.AM,Ec);return!0}if(Pb!==n.a.Ab(l.a.SOa)&&Pb!==n.a.Ab(l.a.ikb)&&
Pb!==n.a.Ab(l.a.hlb)&&Pb!==n.a.Ab(l.a.UG)&&Pb!==n.a.Ab(l.a.VQ))return!1;var uc=fb.Ng.value.vu;const ya=fb.Ng.value.xf;var db=fb.En.value.xf;Ec=fb.fl;if(Pb===n.a.Ab(l.a.SOa)){uc=fb.Xd.getPropertyString(ya,l.a.SOa);db=fb.Xd.getPropertyString(db,l.a.SOa);db=this.af(uc)?db:this.af(db)?uc:null;if(this.af(db))return!0;fb.Xd.setPropertyString(Ec,l.a.SOa,db);fb.og.add(n.a.Ab(l.a.SOa));return!0}if(Pb===n.a.Ab(l.a.hlb))return uc=fb.Xd.getPropertyBool(ya,l.a.hlb),db=fb.Xd.getPropertyBool(db,l.a.hlb),uc=null!=
uc?uc:!1,uc=(null!=db?db:!1)||uc,fb.Xd.setPropertyBool(Ec,l.a.hlb,uc),fb.og.add(n.a.Ab(l.a.hlb)),!0;if(Pb===n.a.Ab(l.a.ikb)){uc=fb.Xd.getPropertyBool(ya,l.a.ikb);db=fb.Xd.getPropertyBool(db,l.a.ikb);if(uc===db)return!0;uc=null!=uc?uc:!1;uc=(null!=db?db:!1)||uc;fb.Xd.setPropertyBool(Ec,l.a.ikb,uc);return!0}if(Pb===n.a.Ab(l.a.UG)){uc=fb.Xd.getPropertyBool(ya,l.a.UG);db=fb.Xd.getPropertyBool(db,l.a.UG);if(uc===db)return!0;uc=null!=uc?uc:!1;uc=(null!=db?db:!1)||uc;fb.Xd.setPropertyBool(Ec,l.a.UG,uc);
fb.og.add(n.a.Ab(l.a.UG));return!0}if(Pb===n.a.Ab(l.a.VQ)){Pb=fb.tq.runtime.Zb;Pb.Xx(13);if(Pb.isFeatureEnabled(13))return this.U2k(fb,uc,ya,db,Ec);uc=fb.Xd.getPropertyString(ya,l.a.VQ);db=fb.Xd.getPropertyString(db,l.a.VQ);if(uc===db)return!0;fb.Xd.setPropertyString(Ec,l.a.VQ,db||uc);fb.og.add(n.a.Ab(l.a.VQ));return!0}return!1}U2k(fb,Pb,Ec,uc,ya){Ec=fb.Xd.getPropertyString(Ec,l.a.VQ);uc=fb.Xd.getPropertyString(uc,l.a.VQ);if(Ec===uc)return!0;Pb=fb.Xd.getPropertyString(Pb,l.a.VQ);const db={};for(let Xb=
0;Xb<this.Eih.length;Xb++){const $b=this.Eih[Xb];var tb=this.luf(Pb,$b,0);const Ab=this.luf(Ec,$b,1),vc=this.luf(uc,$b,2);tb=this.Adn(tb,Ab,vc);db[$b.toString()]=tb.toArray()}fb.Xd.setPropertyString(ya,l.a.VQ,this.qgo(db));fb.og.add(n.a.Ab(l.a.VQ));return!0}Adn(fb,Pb,Ec){const uc=new H.a,ya=new H.a(0);for(var db=0;db<Pb.length;db++){const Xb=Pb[db].UserId;uc.add(Xb,Pb[db]);ya.add(Xb,0)}for(Pb=0;Pb<Ec.length;Pb++)db=Ec[Pb].UserId,ya.nb(db)?ya.Z(db,2):(uc.add(db,Ec[Pb]),ya.add(db,0));for(Ec=0;Ec<fb.length;Ec++)Pb=
fb[Ec].UserId,ya.nb(Pb)&&2!==ya.J(Pb)&&ya.Z(Pb,1);const tb=new K.a;ya.forEach((Xb,$b)=>{if(1===$b)return!0;tb.add(uc.J(Xb));return!0});return tb}luf(fb,Pb,Ec){fb=Object(T.a)(Object,this.Ebm(fb,Ec));return Pb.toString()in fb?Array.isArray(fb[Pb.toString()])?fb[Pb.toString()]:null:[]}Ebm(fb,Pb){if(this.bQe.nb(Pb))return Object(T.a)(Object,this.bQe.J(Pb));fb=Object(T.a)(Object,this.sml(fb));this.bQe.add(Pb,fb);return fb}sml(fb){return Object(T.a)(Object,Y.b(fb))}qgo(fb){return Y.c(fb)}af(fb){return fb&&
fb.length?!1:!0}static mh(){return new aa}static get instance(){return aa.Pg.value}}aa.Pg=new a.a(aa.mh);Object(D.a)(aa,"CommentNodeComplexMerge",k.a,[]);class ba extends k.a{constructor(){super()}get Wn(){return 46}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.contentControlNode),1);fb.Z(n.a.Ab(y.a.lastModifiedTime),0);fb.Z(n.a.Ab(l.a.YJc),2);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.contentControlNode))return t.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
fb.fl.id,fb.fl.Oc,Pb),k.a.WPf(fb,this,l.a.contentControlNode);t.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}static mh(){return new ba}static get instance(){return ba.Pg.value}}ba.Pg=new a.a(ba.mh);Object(D.a)(ba,"ContentControlContainerNodeComplexMerge",k.a,[]);var oa=c(61),ma=c(1797);class ea extends k.a{constructor(){super()}get Wn(){return 37}wk(){const fb=
super.wk();fb.Z(n.a.Ab(l.a.t8),1);fb.Z(n.a.Ab(l.a.Frb),1);fb.Z(n.a.Ab(l.a.tId),2);fb.Z(n.a.Ab(l.a.UCb),2);fb.Z(n.a.Ab(l.a.contentControlNode),1);fb.Z(n.a.Ab(l.a.u9),1);fb.Z(n.a.Ab(l.a.Tga),1);fb.Z(n.a.Ab(l.a.E5b),1);fb.Z(n.a.Ab(l.a.Ggb),1);fb.Z(n.a.Ab(l.a.Egb),1);fb.Z(n.a.Ab(l.a.Dgb),1);fb.Z(n.a.Ab(l.a.ZOa),2);fb.Z(n.a.Ab(l.a.XCb),1);fb.Z(n.a.Ab(l.a.uId),1);fb.Z(n.a.Ab(l.a.s8),1);this.Zb.isFeatureEnabled(30)&&(fb.Z(n.a.Ab(l.a.RU),2),fb.Z(n.a.Ab(l.a.Uva),2),fb.Z(n.a.Ab(l.a.Xna),2),fb.Z(n.a.Ab(l.a.T4),
1),fb.Z(n.a.Ab(l.a.rpa),1),fb.Z(n.a.Ab(l.a.spa),1));return fb}oC(fb,Pb){var Ec=fb.Ng.value.xf,uc=fb.En.value.xf;const ya=fb.fl;if(Pb===n.a.Ab(l.a.contentControlNode))return k.a.WPf(fb,this,l.a.contentControlNode);if(Pb===n.a.Ab(l.a.u9)){Pb=fb.Xd.getPropertyBool(Ec,l.a.u9);uc=fb.Xd.getPropertyBool(uc,l.a.u9);if(null!=Pb&&Pb||null!=uc&&uc)fb.Xd.setPropertyBool(ya,l.a.u9,!0),fb.og.add(n.a.Ab(l.a.u9));return!0}if(Pb===n.a.Ab(l.a.Tga))return Pb=fb.Xd.getPropertyBool(Ec,l.a.Tga),uc=fb.Xd.getPropertyBool(uc,
l.a.Tga),fb.Xd.setPropertyBool(ya,l.a.Tga,null!=Pb&&!!Pb&&null!=uc&&!!uc),fb.og.add(n.a.Ab(l.a.Tga)),!0;if(Pb===n.a.Ab(l.a.E5b))return Pb=fb.Xd.getPropertyUint32(uc,l.a.E5b),null!=Pb&&(fb.Xd.setPropertyUint32(ya,l.a.E5b,Pb),fb.og.add(n.a.Ab(l.a.E5b))),!0;if(Pb===n.a.Ab(l.a.Ggb)||Pb===n.a.Ab(l.a.Egb)||Pb===n.a.Ab(l.a.Dgb))return(uc=fb.Xd.getPropertyString(uc,n.a.$X(Pb)))&&0<uc.length&&(fb.Xd.setPropertyString(ya,n.a.$X(Pb),uc),fb.og.add(Pb)),!0;if(Pb===n.a.Ab(l.a.XCb)||Pb===n.a.Ab(l.a.uId)){Ec=fb.Xd.getPropertyObjectId(Ec,
n.a.$X(Pb));if(ma.a.Z9b(fb.tq,Ec))return!0;if((uc=fb.Xd.getPropertyObjectId(uc,n.a.$X(Pb)))&&uc!==oa.a.nil)return fb.Xd.setPropertyObjectId(ya,n.a.$X(Pb),uc),fb.og.add(Pb),!0;ya.removeProperty(n.a.$X(Pb));fb.og.add(Pb);return!0}if(Pb===n.a.Ab(l.a.s8)){Ec=fb.Xd.getPropertyObjectId(Ec,l.a.s8);if((Ec=ma.a.Z9b(fb.tq,Ec))&&fb.Xd.getPropertyObjectIds(Ec,l.a.contentControlNode).hH().contains(fb.fl.id))return!0;uc=fb.Xd.getPropertyObjectId(uc,l.a.s8);return(Ec=ma.a.Z9b(fb.tq,uc))&&fb.Xd.getPropertyObjectIds(Ec,
l.a.contentControlNode).hH().contains(fb.fl.id)?(fb.Xd.setPropertyObjectId(ya,l.a.s8,uc),fb.og.add(Pb),!0):!1}if(Pb===n.a.Ab(l.a.t8))return Pb=fb.Xd.getPropertyBool(uc,l.a.t8),null==Pb||Pb||(fb.Xd.setPropertyBool(ya,l.a.t8,!1),fb.og.add(n.a.Ab(l.a.t8))),!0;if(Pb===n.a.Ab(l.a.Frb)){Pb=fb.Xd.getPropertyObjectId(Ec,l.a.Frb);uc=fb.Xd.getPropertyObjectId(uc,l.a.Frb);if(Pb&&!Pb.equals(uc))return!1;if(Pb=Pb||uc)fb.Xd.setPropertyObjectId(ya,l.a.Frb,Pb),fb.og.add(n.a.Ab(l.a.Frb));return!0}!this.Zb.isFeatureEnabled(30)||
Pb!==n.a.Ab(l.a.T4)&&Pb!==n.a.Ab(l.a.rpa)&&Pb!==n.a.Ab(l.a.spa)||t.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Pb);return!1}static mh(){return new ea}static get instance(){return ea.Pg.value}}ea.Pg=new a.a(ea.mh);Object(D.a)(ea,"ContentControlNodeComplexMerge",k.a,[]);class ua extends k.a{constructor(){super()}get Wn(){return 10}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.customXmlPartNode),1);return fb}oC(fb,
Pb){if(Pb===n.a.Ab(l.a.customXmlPartNode)){Pb=fb.fl;const uc=fb.Xd;var Ec=uc.getPropertyObjectIds(fb.Ng.value.vu,l.a.customXmlPartNode);const ya=uc.getPropertyObjectIds(fb.Ng.value.xf,l.a.customXmlPartNode),db=uc.getPropertyObjectIds(fb.En.value.xf,l.a.customXmlPartNode);Ec=this.kdn(Ec,ya,db);0<Ec.length?uc.setPropertyObjectIds(Pb,l.a.customXmlPartNode,Ec):Pb.removeProperty(l.a.customXmlPartNode);fb.og.add(n.a.Ab(l.a.customXmlPartNode));return!0}return!1}kdn(fb,Pb,Ec){return this.sHa(fb,Pb,Ec)}static mh(){return new ua}static get instance(){return ua.Pg.value}}
ua.Pg=new a.a(ua.mh);Object(D.a)(ua,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Wn(){return 9}get yA(){return 0}static mh(){return new sa}static get instance(){return sa.Pg.value}}sa.Pg=new a.a(sa.mh);Object(D.a)(sa,"CustomXmlPartNodeComplexMerge",k.a,[]);class Fa extends k.a{constructor(){super()}get Wn(){return 29}get yA(){return 3}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.embeddedFontNode),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.embeddedFontNode)){Pb=
fb.Xd;var Ec=Pb.getPropertyObjectIds(fb.Ng.value.vu,l.a.embeddedFontNode),uc=Pb.getPropertyObjectIds(fb.Ng.value.xf,l.a.embeddedFontNode);const ya=Pb.getPropertyObjectIds(fb.En.value.xf,l.a.embeddedFontNode);Ec=this.sHa(Ec,uc,ya);uc=fb.fl;0<Ec.length?Pb.setPropertyObjectIds(uc,l.a.embeddedFontNode,Ec):uc.removeProperty(l.a.embeddedFontNode);fb.og.add(n.a.Ab(l.a.embeddedFontNode));return!0}return!1}static mh(){return new Fa}static get instance(){return Fa.Pg.value}}Fa.Pg=new a.a(Fa.mh);Object(D.a)(Fa,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Pa extends k.a{constructor(){super()}get Wn(){return 30}get yA(){return 3}static mh(){return new Pa}static get instance(){return Pa.Pg.value}}Pa.Pg=new a.a(Pa.mh);Object(D.a)(Pa,"EmbeddedFontNodeComplexMerge",k.a,[]);class Na extends k.a{constructor(){super()}get Wn(){return 11}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.A4),4);fb.Z(n.a.Ab(l.a.j2a),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.j2a)){const Ec=fb.fl,uc=fb.Xd;t.a.instance.Ua(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.Oc,Pb);Pb=uc.getPropertyObjectIds(fb.Ng.value.vu,l.a.j2a);const ya=uc.getPropertyObjectIds(fb.Ng.value.xf,l.a.j2a),db=uc.getPropertyObjectIds(fb.En.value.xf,l.a.j2a);Pb=this.kPi(Pb,ya,db,(tb,Xb)=>tb.equals(Xb));0<Pb.length?uc.setPropertyObjectIds(Ec,l.a.j2a,Pb):Ec.removeProperty(l.a.j2a);fb.og.add(n.a.Ab(l.a.j2a));return!0}t.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
fb.Ng.value.xf.id,Pb);return!1}static mh(){return new Na}static get instance(){return Na.Pg.value}}Na.Pg=new a.a(Na.mh);Object(D.a)(Na,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Aa extends k.a{constructor(){super()}get Wn(){return 12}get yA(){return 3}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.yoa),1);return fb}oC(fb,Pb){const Ec=fb.fl,uc=fb.Xd;if(Pb===n.a.Ab(l.a.yoa)){let ya=-1;t.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ec.id,Ec.Oc,Pb);const db=uc.getPropertyInt32(fb.Ng.value.xf,l.a.yoa),tb=uc.getPropertyInt32(fb.En.value.xf,l.a.yoa);null!=db&&-1!==db?ya=db:null!=tb&&(ya=tb);uc.setPropertyInt32(Ec,l.a.yoa,ya);fb.og.add(Pb);return!0}t.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.vu.id,Pb);return!1}static mh(){return new Aa}static get instance(){t.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return Aa.Pg.value}}Aa.Pg=new a.a(Aa.mh);Object(D.a)(Aa,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class za extends k.a{constructor(){super()}get Wn(){return 47}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.glossaryPageContentNode),1);return fb}oC(fb,Pb){return Pb===n.a.Ab(l.a.glossaryPageContentNode)?(t.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fb.fl.id,fb.fl.Oc,Pb),k.a.WPf(fb,this,l.a.glossaryPageContentNode)):
!1}static mh(){return new za}static get instance(){return za.Pg.value}}za.Pg=new a.a(za.mh);Object(D.a)(za,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class xa extends k.a{constructor(){super()}get Wn(){return 13}get yA(){return 3}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Xja),4);return fb}static mh(){return new xa}static get instance(){return xa.Pg.value}}xa.Pg=new a.a(xa.mh);Object(D.a)(xa,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class ka extends k.a{constructor(){super()}get Wn(){return 14}get yA(){return 3}wk(){const fb=
super.wk();fb.Z(n.a.Ab(l.a.runId),3);fb.Z(n.a.Ab(l.a.Wc),3);fb.Z(n.a.Ab(l.a.uvi),3);fb.Z(n.a.Ab(l.a.JU),1);fb.Z(n.a.Ab(e.a.B0),1);fb.Z(n.a.Ab(y.a.imageAltText),1);fb.Z(n.a.Ab(l.a.vY),1);fb.Z(n.a.Ab(y.a.Uda),1);fb.Z(n.a.Ab(e.a.U9a),1);fb.Z(n.a.Ab(l.a.O_a),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(y.a.imageAltText)||Pb===n.a.Ab(l.a.vY)||Pb===n.a.Ab(l.a.JU)||Pb===n.a.Ab(l.a.wY)||Pb===n.a.Ab(y.a.tkb)||Pb===n.a.Ab(y.a.Uda)||Pb===n.a.Ab(e.a.B0)||Pb===n.a.Ab(e.a.U9a)||Pb===n.a.Ab(l.a.O_a)){const uc=fb.fl;var Ec=
fb.Xd;t.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",uc.id,uc.Oc,Pb);const ya=Ec.getPropertyInt32(fb.Ng.value.xf,e.a.B0);Ec=Ec.getPropertyInt32(fb.En.value.xf,e.a.B0);if(null!=ya&&(0===ya||2===ya))return!0;if(null!=Ec&&(0===Ec||2===Ec))return Pb=fb.En.value.xf,this.Mgb(Pb,uc,y.a.imageAltText),this.Mgb(Pb,uc,l.a.vY),this.Mgb(Pb,uc,l.a.wY),Pb.hasProperty(l.a.JU)&&this.Mgb(Pb,uc,l.a.JU),this.Mgb(Pb,uc,y.a.tkb),this.Mgb(Pb,
uc,y.a.Uda),this.Mgb(Pb,uc,e.a.B0),this.Mgb(Pb,uc,e.a.U9a),fb.og.add(n.a.Ab(y.a.imageAltText)),fb.og.add(n.a.Ab(l.a.vY)),fb.og.add(n.a.Ab(l.a.wY)),fb.og.add(n.a.Ab(l.a.JU)),fb.og.add(n.a.Ab(y.a.tkb)),fb.og.add(n.a.Ab(y.a.Uda)),fb.og.add(n.a.Ab(e.a.B0)),fb.og.add(n.a.Ab(e.a.U9a)),fb.og.add(n.a.Ab(l.a.O_a)),!0}t.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.vu.id,Pb);return!1}static mh(){return new ka}static get instance(){return ka.Pg.value}}
ka.Pg=new a.a(ka.mh);Object(D.a)(ka,"ImageNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Wn(){return 40}get yA(){return 0}static mh(){return new wa}static get instance(){return wa.Pg.value}}wa.Pg=new a.a(wa.mh);Object(D.a)(wa,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Wn(){return 32}get yA(){return 0}static mh(){return new ia}static get instance(){return ia.Pg.value}}ia.Pg=new a.a(ia.mh);Object(D.a)(ia,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class va extends k.a{constructor(){super()}get Wn(){return 34}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Xkb),1);return fb}oC(fb,Pb){const Ec=fb.fl,uc=fb.Xd;if(Pb===n.a.Ab(l.a.Xkb)){Pb=uc.getPropertyObjectIds(fb.Ng.value.vu,l.a.Xkb);const ya=uc.getPropertyObjectIds(fb.Ng.value.xf,l.a.Xkb),db=uc.getPropertyObjectIds(fb.En.value.xf,l.a.Xkb);Pb=this.sHa(Pb,ya,db);uc.setPropertyObjectIds(Ec,l.a.Xkb,Pb);fb.og.add(n.a.Ab(l.a.Xkb));return!0}return!1}static mh(){return new va}static get instance(){return va.Pg.value}}
va.Pg=new a.a(va.mh);Object(D.a)(va,"IntelligenceRegionNodeComplexMerge",k.a,[]);class na extends k.a{constructor(){super()}get Wn(){return 35}get yA(){return 0}static mh(){return new na}static get instance(){return na.Pg.value}}na.Pg=new a.a(na.mh);Object(D.a)(na,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Ca extends k.a{constructor(){super()}get Wn(){return 39}get yA(){return 0}static mh(){return new Ca}static get instance(){return Ca.Pg.value}}Ca.Pg=new a.a(Ca.mh);Object(D.a)(Ca,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class ta extends k.a{constructor(){super()}get Wn(){return 33}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.GVc),1);fb.Z(n.a.Ab(l.a.EYd),1);fb.Z(n.a.Ab(l.a.cDf),1);fb.Z(n.a.Ab(l.a.eDf),1);return fb}oC(fb,Pb){const Ec=fb.fl,uc=fb.Xd;if(Pb===n.a.Ab(l.a.GVc)||Pb===n.a.Ab(l.a.EYd)||Pb===n.a.Ab(l.a.cDf)||Pb===n.a.Ab(l.a.eDf)){Pb=Pb===n.a.Ab(l.a.GVc)?l.a.GVc:l.a.EYd;var ya=uc.getPropertyObjectIds(fb.Ng.value.vu,Pb);const db=uc.getPropertyObjectIds(fb.Ng.value.xf,Pb),tb=uc.getPropertyObjectIds(fb.En.value.xf,
Pb);ya=this.sHa(ya,db,tb);uc.setPropertyObjectIds(Ec,Pb,ya);fb.og.add(n.a.Ab(Pb));return!0}return!1}static mh(){return new ta}static get instance(){return ta.Pg.value}}ta.Pg=new a.a(ta.mh);Object(D.a)(ta,"IntelligenceRootNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Wn(){return 42}get yA(){return 0}static mh(){return new fa}static get instance(){return fa.Pg.value}}fa.Pg=new a.a(fa.mh);Object(D.a)(fa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class Xa extends k.a{constructor(){super()}get Wn(){return 45}get yA(){return 0}static mh(){return new Xa}static get instance(){return Xa.Pg.value}}
Xa.Pg=new a.a(Xa.mh);Object(D.a)(Xa,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class ob extends k.a{constructor(){super()}get Wn(){return 15}get yA(){return 3}static mh(){return new ob}static get instance(){return ob.Pg.value}}ob.Pg=new a.a(ob.mh);Object(D.a)(ob,"NumberListNodeComplexMerge",k.a,[]);var xb=c(118);class zb extends k.a{constructor(){super()}get Wn(){return 16}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.qBb),1);fb.Z(n.a.Ab(xb.a.T9e),7);fb.Z(n.a.Ab(xb.a.R9e),7);return fb}oC(fb,
Pb){const Ec=fb.fl,uc=fb.Xd;if(Pb===n.a.Ab(l.a.qBb))return this.UJf(uc,fb.Ng.value.xf,fb.En.value.xf,Ec,l.a.qBb),fb.og.add(Pb),!0;t.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.vu.id,Pb);return!1}static mh(){return new zb}static get instance(){return zb.Pg.value}}zb.Pg=new a.a(zb.mh);Object(D.a)(zb,"OutlineElementNodeComplexMerge",k.a,[]);class Lb extends k.a{constructor(){super()}get Wn(){return 17}wk(){const fb=
super.wk();fb.Z(n.a.Ab(l.a.qBb),1);fb.Z(n.a.Ab(l.a.eoa),1);fb.Z(n.a.Ab(xb.a.vJ),1);fb.Z(n.a.Ab(xb.a.Xec),1);fb.Z(n.a.Ab(xb.a.lja),8);return fb}oC(fb,Pb){const Ec=fb.fl,uc=fb.Xd;if(Pb===n.a.Ab(l.a.qBb))return this.UJf(uc,fb.Ng.value.xf,fb.En.value.xf,Ec,l.a.qBb),fb.og.add(Pb),!0;if(Pb===n.a.Ab(l.a.eoa)){var ya=uc.getPropertyBool(fb.Ng.value.xf,l.a.eoa),db=uc.getPropertyBool(fb.En.value.xf,l.a.eoa);uc.setPropertyBool(Ec,l.a.eoa,null==ya?!1:ya&&null==db?!1:db);fb.og.add(Pb);return!0}if(Pb===n.a.Ab(xb.a.Xec))return this.UJf(uc,
fb.Ng.value.xf,fb.En.value.xf,Ec,xb.a.Xec),fb.og.add(Pb),!0;if(Pb===n.a.Ab(xb.a.vJ))return ya=uc.getPropertyBool(fb.Ng.value.xf,xb.a.vJ),db=uc.getPropertyBool(fb.En.value.xf,xb.a.vJ),uc.setPropertyBool(Ec,xb.a.vJ,null==ya?!0:ya||null==db?!0:db),fb.og.add(Pb),!0;t.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.vu.id,Pb);return!1}static mh(){return new Lb}static get instance(){return Lb.Pg.value}}
Lb.Pg=new a.a(Lb.mh);Object(D.a)(Lb,"OutlineGroupNodeComplexMerge",k.a,[]);var Ia=c(42),Ya=c(55);class eb extends k.a{constructor(){super()}get Wn(){return 18}get yA(){return 2}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.wWd),3);fb.Z(n.a.Ab(y.a.lV),this.yA);fb.Z(n.a.Ab(l.a.kt),1);fb.Z(n.a.Ab(l.a.e$),1);fb.Z(n.a.Ab(l.a.sq),1);fb.Z(n.a.Ab(Ia.a.wF),1);fb.Z(n.a.Ab(Ia.a.RSa),1);return fb}oC(fb,Pb){const Ec=fb.Xd;if(fb.tq.runtime.Zb.isFeatureEnabled(73)){if(Pb===n.a.Ab(l.a.kt)||Pb===n.a.Ab(l.a.e$)||Pb===n.a.Ab(Ia.a.RSa)||
Pb===n.a.Ab(l.a.sq)||Pb===n.a.Ab(Ia.a.wF))return this.wRo(Ec,fb)}else if(Pb===n.a.Ab(l.a.kt)||Pb===n.a.Ab(l.a.sq)){let uc,ya;({NJc:Pb,x4a:uc,n4a:ya}=this.b8e(Object(Ya.a)(Ec,Ec.getPropertyUint32s,"getPropertyUint32s"),fb.Ng.value.vu,fb.Ng.value.xf,fb.En.value.xf,l.a.kt,null));if(!ya&&!uc)return t.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",fb.Ng.value.xf.id,n.a.Ab(l.a.kt)),!0;let db,tb,Xb;({NJc:db,
x4a:tb,n4a:Xb}=this.b8e(Object(Ya.a)(Ec,Ec.getPropertyObjectIds,"getPropertyObjectIds"),fb.Ng.value.vu,fb.Ng.value.xf,fb.En.value.xf,l.a.sq,null));if(!tb&&!Xb)return t.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",fb.Ng.value.xf.id,n.a.Ab(l.a.sq)),!0;const $b=tb&&!Xb;if((uc&&!ya)!==$b)return t.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
fb.Ng.value.xf.id,n.a.Ab(l.a.kt),n.a.Ab(l.a.sq)),!1;$b&&(Ec.setPropertyObjectIds(fb.fl,l.a.sq,db),Ec.setPropertyUint32s(fb.fl,l.a.kt,Pb));t.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",fb.Ng.value.xf.id,n.a.Ab(l.a.kt),uc,ya,n.a.Ab(l.a.sq),tb,Xb);fb.og.add(n.a.Ab(l.a.sq));fb.og.add(n.a.Ab(l.a.kt));
return!0}t.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}uoi(fb,Pb,Ec,uc){let ya;({NJc:Pb,x4a:uc,n4a:ya}=this.b8e(Pb,Ec.Ng.value.vu,Ec.Ng.value.xf,Ec.En.value.xf,fb,uc));return ya||uc?{returnValue:!0,o$e:Pb,x4a:uc,n4a:ya}:(t.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Ec.Ng.value.xf.id.toString(),n.a.Ab(fb)),{returnValue:!1,o$e:Pb,x4a:uc,n4a:ya})}uni(fb,Pb,Ec,uc,ya){let db;let tb,Xb,$b,Ab;({o$e:db,x4a:vc,n4a:tb,returnValue:$b}=this.uoi(fb,Object(Ya.a)(Ec,Ec.getPropertyUint32s,"getPropertyUint32s"),uc,null));({o$e:Ec,x4a:ya,n4a:Xb,returnValue:Ab}=this.uoi(Pb,Object(Ya.a)(Ec,Ec.getPropertyObjectIds,"getPropertyObjectIds"),uc,ya));var vc=vc&&!tb;return $b&&Ab?vc!==(ya&&!Xb)?(t.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
uc.Ng.value.xf.id.toString(),n.a.Ab(fb),n.a.Ab(Pb)),{returnValue:2,dId:db,cId:Ec,Kle:vc}):{returnValue:0,dId:db,cId:Ec,Kle:vc}:{returnValue:1,dId:db,cId:Ec,Kle:vc}}hFf(fb){let Pb=!0;fb.forEach(Ec=>Ec!==oa.a.nil?Pb=!1:!0);return Pb}WXl(fb,Pb,Ec){return this.hFf(fb)&&this.hFf(Pb)&&this.hFf(Ec)?!0:!1}wRo(fb,Pb){let Ec,uc,ya,db,tb,Xb;var $b=({dId:db,cId:tb,Kle:uc}=this.uni(Ia.a.RSa,l.a.sq,fb,Pb,null)).returnValue;if(2===$b||1===$b)return!0;({dId:ya,cId:Xb,Kle:Ec,returnValue:$b}=this.uni(l.a.kt,l.a.e$,
fb,Pb,Object(Ya.a)(this,this.WXl,"getExtendedGuidEquivalence")));if(2===$b||1===$b)return!0;let Ab;({NJc:$b,x4a:vc,n4a:Ab}=this.pWk(Object(Ya.a)(fb,fb.getPropertyDictionary,"getPropertyDictionary"),Pb.Ng.value.vu,Pb.Ng.value.xf,Pb.En.value.xf,Ia.a.wF));if(!Ab&&!vc)return t.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Pb.Ng.value.xf.id.toString(),n.a.Ab(Ia.a.wF)),!0;var vc=vc&&!Ab;if(Ec!==uc||Ec!==
vc)return t.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Pb.Ng.value.xf.id.toString(),n.a.Ab(l.a.kt),n.a.Ab(Ia.a.RSa),n.a.Ab(Ia.a.wF),uc,Ec,vc),!0;Ec&&(fb.setPropertyObjectIds(Pb.fl,l.a.sq,tb),fb.setPropertyUint32s(Pb.fl,Ia.a.RSa,db),fb.setPropertyObjectIds(Pb.fl,
l.a.e$,Xb),fb.setPropertyUint32s(Pb.fl,l.a.kt,ya),fb.setPropertyDictionary(Pb.fl,Ia.a.wF,$b));t.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Pb.Ng.value.xf.id.toString(),uc,Ec,vc);Pb.og.add(n.a.Ab(Ia.a.RSa));Pb.og.add(n.a.Ab(l.a.sq));Pb.og.add(n.a.Ab(l.a.kt));Pb.og.add(n.a.Ab(l.a.e$));Pb.og.add(n.a.Ab(Ia.a.wF));return!0}static mh(){return new eb}static get instance(){return eb.Pg.value}}
eb.Pg=new a.a(eb.mh);Object(D.a)(eb,"PageContentNodeComplexMerge",k.a,[]);class sb extends k.a{constructor(){super()}get Wn(){return 19}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.$Ia),1);fb.Z(n.a.Ab(l.a.appsNode),2);fb.Z(n.a.Ab(l.a.customXmlPartContainerNode),2);fb.Z(n.a.Ab(l.a.intelligenceRootNode),1);return fb}oC(fb,Pb){const Ec=fb.Xd;if(Pb===n.a.Ab(l.a.$Ia)){var uc=Ec.getPropertyObjectIds(fb.Ng.value.vu,l.a.$Ia),ya=Ec.getPropertyObjectIds(fb.Ng.value.xf,l.a.$Ia),db=Ec.getPropertyObjectIds(fb.En.value.xf,
l.a.$Ia);if((uc=this.zdn(uc,ya,db,(tb,Xb)=>tb.equals(Xb),tb=>{let Xb;({value:Xb}=fb.tq.runtime.Mq.Fc(tb)).returnValue?fb.tq.runtime.vn.Z(tb,new z.a(Xb,!1)):t.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},fb.tq))&&0<uc.length)return Ec.setPropertyObjectIds(fb.fl,l.a.$Ia,uc),fb.og.add(n.a.Ab(l.a.$Ia)),!0}if(Pb===n.a.Ab(l.a.intelligenceRootNode))return uc=Ec.getPropertyObjectIds(fb.Ng.value.vu,l.a.intelligenceRootNode),
ya=Ec.getPropertyObjectIds(fb.Ng.value.xf,l.a.intelligenceRootNode),db=Ec.getPropertyObjectIds(fb.En.value.xf,l.a.intelligenceRootNode),uc=this.sHa(uc,ya,db),Ec.setPropertyObjectIds(fb.fl,l.a.intelligenceRootNode,uc),fb.og.add(Pb),!0;t.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}static mh(){return new sb}static get instance(){return sb.Pg.value}}sb.Pg=new a.a(sb.mh);
Object(D.a)(sb,"PageManifestNodeComplexMerge",k.a,[]);class lc extends k.a{constructor(){super()}get Wn(){return 43}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Yma),0);fb.Z(n.a.Ab(l.a.GNb),0);fb.Z(n.a.Ab(l.a.bKb),0);fb.Z(n.a.Ab(l.a.Zoa),1);fb.Z(n.a.Ab(l.a.sessionId),3);fb.Z(n.a.Ab(l.a.buildVersion),3);fb.Z(n.a.Ab(l.a.MR),1);fb.Z(n.a.Ab(l.a.Pyi),1);fb.Z(n.a.Ab(l.a.qv),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(l.a.MR)||Pb===n.a.Ab(l.a.Pyi)||Pb===n.a.Ab(l.a.qv)){var Ec=fb.En.value.xf,uc=fb.Ng.value.xf,ya=n.a.$X(Pb);
uc=fb.Xd.getPropertyBool(uc,ya);Ec=fb.Xd.getPropertyBool(Ec,ya);fb.Xd.setPropertyBool(fb.fl,ya,null==uc?!1:uc&&null==Ec?!1:Ec);fb.og.add(Pb);return!0}if(Pb===n.a.Ab(l.a.Zoa)){Pb=fb.Xd;Ec=fb.Ng.value.vu;uc=fb.En.value.xf;ya=fb.Ng.value.xf;Ec=Ec?Pb.getPropertyObjectId(Ec,l.a.Zoa):null;uc=uc?Pb.getPropertyObjectId(uc,l.a.Zoa):null;ya=ya?Pb.getPropertyObjectId(ya,l.a.Zoa):null;t.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Ec?Ec.toString():
"NULL",uc?uc.toString():"NULL",ya?ya.toString():"NULL");if(uc){if(ya&&uc.equals(ya))return fb.og.add(n.a.Ab(l.a.Zoa)),Pb.setPropertyObjectId(fb.fl,l.a.Zoa,uc),!0;if(ma.a.RVd.equals(uc))return fb.og.add(n.a.Ab(l.a.Zoa)),Pb.setPropertyObjectId(fb.fl,l.a.Zoa,ma.a.RVd),!0}if(ya&&ma.a.RVd.equals(ya))return fb.og.add(n.a.Ab(l.a.Zoa)),Pb.setPropertyObjectId(fb.fl,l.a.Zoa,ma.a.RVd),!0;t.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",Ec?Ec.toString():
"NULL",uc?uc.toString():"NULL",ya?ya.toString():"NULL")}return!1}static mh(){return new lc}static get instance(){return lc.Pg.value}}lc.Pg=new a.a(lc.mh);Object(D.a)(lc,"PageMetadataNodeComplexMerge",k.a,[]);var vb=c(1806),Eb=c(175);class Ua extends k.a{constructor(){super()}get Wn(){return 31}wk(){const fb=super.wk();fb.Z(n.a.Ab(Eb.a.MA),1);fb.Z(n.a.Ab(l.a.listID),3);fb.Z(n.a.Ab(l.a.listLevel),1);fb.Z(n.a.Ab(l.a.Ie),3);fb.Z(n.a.Ab(l.a.P3b),3);fb.Z(n.a.Ab(l.a.runId),3);fb.Z(n.a.Ab(l.a.zNd),3);fb.Z(n.a.Ab(y.a.fontColor),
3);fb.Z(n.a.Ab(l.a.AIh),3);fb.Z(n.a.Ab(l.a.Wc),1);fb.Z(n.a.Ab(Eb.a.CZd),3);fb.Z(n.a.Ab(Eb.a.IJf),3);fb.Z(n.a.Ab(Eb.a.mXc),3);fb.Z(n.a.Ab(l.a.HIl),3);fb.Z(n.a.Ab(xb.a.VEj),3);for(let Pb=0;Pb<Ua.x5a.length;Pb++)fb.Z(Ua.x5a[Pb],1);return fb}oC(fb,Pb){var Ec=fb.Xd;const uc=fb.fl;n.a.$X(Pb);if(Pb===n.a.Ab(l.a.Wc)){Ec=fb.Xd.getPropertyInt32(fb.En.value.xf,l.a.Wc);if(null==Ec||!Ec)return!0;fb.Xd.setPropertyInt32(uc,l.a.Wc,Ec);fb.og.add(Pb);return!0}if(Pb===n.a.Ab(Eb.a.MA)){const ya=Ec.getPropertyUint32(fb.Ng.value.xf,
Eb.a.MA),db=Ec.getPropertyUint32(fb.En.value.xf,Eb.a.MA);if(null!=ya&&null!=db&&ya===db)return Ec.setPropertyUint32(uc,Eb.a.MA,ya),fb.og.add(Pb),!0;if(null==ya&&null==db)return uc.removeProperty(Eb.a.MA),fb.og.add(n.a.Ab(Eb.a.MA)),!0;if(null!=ya&&null==db)return Ec.setPropertyUint32(uc,Eb.a.MA,ya),fb.og.add(Pb),!0;if(null==ya&&null!=db)return Ec.setPropertyUint32(uc,Eb.a.MA,db),fb.og.add(Pb),!0}else{if(Pb===n.a.Ab(l.a.listLevel))return this.NQo(Ec,fb);if(Array.contains(Ua.x5a,Pb))return this.MQo(fb)}return!1}MQo(fb){let Pb=
!0,Ec=!0,uc,ya;({hNm:Pb,tKm:Ec,UBl:uc,K4k:ya}=this.qWk(fb));t.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",fb.Ng.value.xf.id.toString(),Pb,Ec);return Pb&&!Ec?(this.$Pi(ya,fb),!0):Pb?!1:(this.$Pi(uc,fb),!0)}qWk(fb){let Pb,Ec,uc,ya;const db=fb.En.value;let tb;const Xb=fb.Ng.value;let $b;Ec=Pb=!0;uc=new H.a;ya=new H.a;for(let Ab=0;Ab<Ua.x5a.length;Ab++){const vc=Ua.x5a[Ab],Sc=({value:tb}=
db.Vqa.Fc(vc)).returnValue;({value:$b}=Xb.Vqa.Fc(vc)).returnValue&&(Pb=this.ZCj(fb.Ng,uc,$b,vc)&&Pb);Sc&&(Ec=this.ZCj(fb.En,ya,tb,vc)&&Ec)}return{hNm:Pb,tKm:Ec,UBl:uc,K4k:ya}}ZCj(fb,Pb,Ec,uc){const ya=n.a.$X(uc);fb=fb.value.xf;Pb.Z(uc,fb.hasProperty(ya)?fb.AU(ya):null);return!Ec.DY}$Pi(fb,Pb){const Ec=Pb.fl;for(let ya=0;ya<Ua.x5a.length;ya++){var uc=Ua.x5a[ya];const db=n.a.$X(uc);(uc=fb.J(uc))?Ec.DUa(db,uc):Ec.removeProperty(db)}for(fb=0;fb<Ua.x5a.length;fb++)Pb.og.add(Ua.x5a[fb]);t.a.instance.Ua(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Pb.Ng.value.xf.id.toString())}NQo(fb,Pb){const Ec=Pb.fl,uc=fb.getPropertyInt32(Pb.Ng.value.xf,l.a.listLevel),ya=fb.getPropertyInt32(Pb.En.value.xf,l.a.listLevel);return null!=uc&&null!=ya&&uc===ya?(fb.setPropertyInt32(Ec,l.a.listLevel,uc),Pb.og.add(n.a.Ab(l.a.listLevel)),!0):null==uc&&null==ya?(Ec.removeProperty(l.a.listLevel),Pb.og.add(n.a.Ab(l.a.listLevel)),!0):null!=uc&&null==ya?(fb.setPropertyInt32(Ec,l.a.listLevel,
uc),Pb.og.add(n.a.Ab(l.a.listLevel)),!0):null==uc&&null!=ya?(fb.setPropertyInt32(Ec,l.a.listLevel,ya),Pb.og.add(n.a.Ab(l.a.listLevel)),!0):!1}static mh(){return new Ua}static get instance(){return Ua.Pg.value}}Ua.Pg=new a.a(Ua.mh);Ua.x5a=[n.a.Ab(l.a.ee),n.a.Ab(l.a.qt),n.a.Ab(y.a.m5),n.a.Ab(l.a.wda),n.a.Ab(l.a.Ot),n.a.Ab(l.a.ks),n.a.Ab(y.a.Y0),n.a.Ab(l.a.n4e),n.a.Ab(y.a.font),n.a.Ab(xb.a.Kmb),n.a.Ab(e.a.Uv)];Object(D.a)(Ua,"PersistablePropertySetComplexMerge",k.a,[]);class Ta extends k.a{constructor(){super()}get Wn(){return 21}get yA(){return 0}static mh(){return new Ta}static get instance(){return Ta.Pg.value}}
Ta.Pg=new a.a(Ta.mh);Object(D.a)(Ta,"RevisionMetadataNodeComplexMerge",k.a,[]);class Nb extends k.a{constructor(){super()}get Wn(){return 48}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.x4i),3);return fb}static mh(){return new Nb}static get instance(){return Nb.Pg.value}}Nb.Pg=new a.a(Nb.mh);Object(D.a)(Nb,"ShadowNumberListNodeComplexMerge",k.a,[]);class Wa extends k.a{constructor(){super()}get Wn(){return 22}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.o5a),7);fb.Z(n.a.Ab(l.a.VXc),2);return fb}static mh(){return new Wa}static get instance(){return Wa.Pg.value}}
Wa.Pg=new a.a(Wa.mh);Object(D.a)(Wa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class Bb extends k.a{constructor(){super()}get Wn(){return 38}get yA(){return 3}static mh(){return new Bb}static get instance(){return Bb.Pg.value}}Bb.Pg=new a.a(Bb.mh);Object(D.a)(Bb,"StylePropertySetComplexMerge",k.a,[]);var Ob=c(1615),hc=c(1660);class Gc extends k.a{constructor(){super()}get Wn(){return 23}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.gf),4);fb.Z(n.a.Ab(l.a.rowSpan),1);fb.Z(n.a.Ab(l.a.colSpan),
1);fb.Z(n.a.Ab(l.a.ghostCell),1);fb.Z(n.a.Ab(Ia.a.vMerge),1);fb.Z(n.a.Ab(Ia.a.gridSpan),1);fb.Z(n.a.Ab(l.a.h9a),2);fb.Z(n.a.Ab(l.a.Mrb),2);fb.Z(n.a.Ab(l.a.xJa),2);fb.Z(n.a.Ab(l.a.irb),5);return fb}jKb(fb){if(!fb)return t.a.instance.Ua(573957923,1,2,"Feature helper is null"),!1;fb.Xx(107);return fb.isFeatureEnabled(107)}Zxa(fb){if(!fb)return t.a.instance.Ua(540120285,1,2,"Feature helper is null"),!1;fb.Xx(108);return fb.isFeatureEnabled(108)}oC(fb,Pb){fb.tq.runtime.gH("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Pb);var Ec=Pb===n.a.Ab(l.a.rowSpan)||Pb===n.a.Ab(l.a.colSpan)||Pb===n.a.Ab(l.a.ghostCell);this.Zxa(fb.tq.runtime.Zb)&&(Ec=Ec||Pb===n.a.Ab(Ia.a.vMerge)||Pb===n.a.Ab(Ia.a.gridSpan));if(!this.jKb(fb.tq.runtime.Zb))return!Ec;var uc=fb.En.value.vu,ya=hc.e(fb.tq,uc,null);if(ya.equals(oa.a.nil))return t.a.instance.Ua(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",uc.id),fb.tq.logger.Rg(Object.assign(new Ob.a,{info:"Table node ID could not be found for table cell"})),
!1;var db=fb.tq.runtime.NCb.J(ya).J(uc.id);if(!db)return!Ec;uc=fb.fl;ya=fb.Xd;if(Pb===n.a.Ab(l.a.ghostCell))return ya.setPropertyBool(uc,l.a.ghostCell,db.hg),fb.og.add(n.a.Ab(l.a.ghostCell)),!0;if(Pb===n.a.Ab(l.a.rowSpan))return Pb=db.rowSpan,db=db.colSpan,null!=Pb&&null!=db&&(1<Pb||1<db)?ya.setPropertyUint32(uc,l.a.rowSpan,Pb):uc.removeProperty(l.a.rowSpan),fb.og.add(n.a.Ab(l.a.rowSpan)),!0;if(Pb===n.a.Ab(l.a.colSpan))return Pb=db.rowSpan,Ec=db.colSpan,db=db.hg,null!=Pb&&null!=Ec&&(1<Pb||1<Ec)?ya.setPropertyUint32(uc,
l.a.colSpan,Ec):db&&null!=Ec?ya.setPropertyUint32(uc,l.a.colSpan,Ec):uc.removeProperty(l.a.colSpan),fb.og.add(n.a.Ab(l.a.colSpan)),!0;t.a.instance.Ua(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Pb);fb.tq.logger.Rg(Object.assign(new Ob.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!Ec}static mh(){return new Gc}static get instance(){return Gc.Pg.value}}
Gc.Pg=new a.a(Gc.mh);Object(D.a)(Gc,"TableCellNodeComplexMerge",k.a,[]);class bc extends k.a{constructor(){super()}get Wn(){return 24}jKb(fb){if(!fb)return t.a.instance.Ua(573845782,1,2,"Feature helper is null"),!1;fb.Xx(107);return fb.isFeatureEnabled(107)}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.gf),1);fb.Z(n.a.Ab(y.a.R1),1);fb.Z(n.a.Ab(y.a.aAa),1);fb.Z(n.a.Ab(l.a.fnc),1);fb.Z(n.a.Ab(l.a.Y$),1);fb.Z(n.a.Ab(l.a.h9a),2);fb.Z(n.a.Ab(l.a.Mrb),2);fb.Z(n.a.Ab(l.a.xJa),2);return fb}oC(fb,
Pb){fb.tq.runtime.gH("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Pb);if(Pb===n.a.Ab(y.a.gf)||Pb===n.a.Ab(y.a.R1)||Pb===n.a.Ab(l.a.fnc)||Pb===n.a.Ab(l.a.Y$)||Pb===n.a.Ab(y.a.aAa)){const ya=fb.fl;var Ec=fb.Xd;t.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Oc,Pb);if(this.frl(fb))return!1;var uc=Ec.getPropertyObjectIds(fb.Ng.value.vu,y.a.gf);const db=Ec.getPropertyObjectIds(fb.Ng.value.xf,y.a.gf),
tb=Ec.getPropertyObjectIds(fb.En.value.xf,y.a.gf);uc=this.kPi(uc,db,tb,(Xb,$b)=>Xb.equals($b));if(0<uc.length)return Ec.setPropertyObjectIds(ya,y.a.gf,uc),Ec.setPropertyInt32(ya,y.a.aAa,uc.length),this.jKb(fb.tq.runtime.Zb)&&({value:Pb}=fb.En.value.Vqa.Fc(n.a.Ab(y.a.R1)),{value:Ec}=fb.Ng.value.Vqa.Fc(n.a.Ab(y.a.R1)),Pb.DY?ya.DUa(y.a.R1,Pb.newValue):ya.DUa(y.a.R1,Ec.newValue)),fb.og.add(n.a.Ab(y.a.gf)),fb.og.add(n.a.Ab(y.a.R1)),fb.og.add(n.a.Ab(y.a.aAa)),fb.og.add(n.a.Ab(l.a.fnc)),fb.og.add(n.a.Ab(l.a.Y$)),
!0}t.a.instance.Ua(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}frl(fb){const Pb=fb.En.value,Ec=fb.Ng.value;let uc,ya;({value:uc}=Pb.Vqa.Fc(n.a.Ab(y.a.R1)));({value:ya}=Ec.Vqa.Fc(n.a.Ab(y.a.R1)));return uc.DY||ya.DY?uc.DY&&ya.DY?(t.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
uc.oldValue,ya.newValue,uc.newValue),fb.tq.logger.Rg(Object.assign(new Ob.a,{zj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):bc.hUh(fb.tq,uc,Ec,"BaseConflict")||bc.hUh(fb.tq,ya,Pb,"BaseFavored")?!0:!1:!1}static mh(){return new bc}static get instance(){return bc.Pg.value}static hUh(fb,Pb,Ec,uc){return Pb.DY&&({value:Pb}=Ec.Vqa.Fc(n.a.Ab(y.a.gf)),Pb.DY)?(t.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
uc),fb.logger.Rg(Object.assign(new Ob.a,{zj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}bc.Pg=new a.a(bc.mh);Object(D.a)(bc,"TableNodeComplexMerge",k.a,[]);class Dc extends k.a{constructor(){super()}get Wn(){return 25}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.Wc),3);fb.Z(n.a.Ab(y.a.gf),4);fb.Z(n.a.Ab(l.a.h9a),2);fb.Z(n.a.Ab(l.a.Mrb),2);fb.Z(n.a.Ab(l.a.xJa),2);fb.Z(n.a.Ab(Ia.a.wlg),2);fb.Z(n.a.Ab(Ia.a.vlg),2);fb.Z(n.a.Ab(l.a.irb),5);return fb}static mh(){return new Dc}static get instance(){return Dc.Pg.value}}
Dc.Pg=new a.a(Dc.mh);Object(D.a)(Dc,"TableRowNodeComplexMerge",k.a,[]);class Ub extends k.a{constructor(){super()}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.hJo),2);fb.Z(n.a.Ab(y.a.gf),1);return fb}oC(fb,Pb){if(Pb===n.a.Ab(y.a.gf)){const uc=fb.fl,ya=fb.Xd;t.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",uc.id,uc.Oc,Pb);var Ec=ya.getPropertyObjectIds(fb.Ng.value.vu,y.a.gf);const db=ya.getPropertyObjectIds(fb.Ng.value.xf,
y.a.gf),tb=ya.getPropertyObjectIds(fb.En.value.xf,y.a.gf);if(Ec=this.Ldn(Ec,db,tb))return 0<Ec.length?ya.setPropertyObjectIds(uc,y.a.gf,Ec):uc.removeProperty(y.a.gf),fb.og.add(n.a.Ab(y.a.gf)),!0}t.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb);return!1}Ldn(fb,Pb,Ec){const uc=new H.a(0);fb.forEach(db=>{uc.Z(db,0);return!0});Pb.forEach(db=>{uc.nb(db)?uc.Z(db,1):uc.Z(db,3);return!0});
Ec.forEach(db=>{let tb;({value:tb}=uc.Fc(db)).returnValue?1===tb?uc.Z(db,5):3===tb?(t.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),uc.Z(db,3)):uc.Z(db,2):uc.Z(db,4);return!0});const ya=new K.a;uc.forEach((db,tb)=>{0!==tb&&2!==tb&&1!==tb&&ya.add(db);return!0});return ya}static mh(){return new Ub}static get instance(){return Ub.Pg.value}}Ub.Pg=new a.a(Ub.mh);Object(D.a)(Ub,"TaskContentNodeComplexMerge",k.a,[]);class Fc{equals(fb,Pb){return fb&&Pb?fb.UserId===Pb.UserId&&
fb.Provider===Pb.Provider&&fb.DisplayName===Pb.DisplayName&&fb.Email===Pb.Email:!fb&&!Pb}LM(){return 0}}Object(D.a)(Fc,"CommentTaskPersonComparer",null,[246]);class Sa{equals(fb,Pb){return fb&&Pb?fb.startDate?fb.endDate?fb.startDate.getTime()===Pb.startDate.getTime()&&fb.endDate.getTime()===Pb.endDate.getTime():!Pb.endDate:!Pb.startDate:!fb&&!Pb}LM(){return 0}}Object(D.a)(Sa,"CommentTaskScheduleEqualityComparer",null,[246]);class wb{equals(fb,Pb){if(!fb||!Pb)return!fb&&!Pb;if(!fb.extensions&&!Pb.extensions)return!0;
if(!fb.extensions||!Pb.extensions||fb.extensions.count!==Pb.extensions.count)return!1;let Ec=!0;fb.extensions.forEach((uc,ya)=>{let db;return({value:db}=Pb.extensions.Fc(uc)).returnValue&&ya===db?!0:Ec=!1});return Ec}LM(){return 0}}Object(D.a)(wb,"ExtensionListEqualityComparer",null,[246]);class Tb{Hyl(fb,Pb){return fb&&Pb?fb.recordId===Pb.recordId&&Tb.bQg.equals(fb.user,Pb.user)&&Tb.bQg.equals(fb.assignee,Pb.assignee)&&fb.type===Pb.type&&fb.title===Pb.title&&fb.priority===Pb.priority&&fb.isLossy===
Pb.isLossy&&fb.completion===Pb.completion&&fb.commentId===Pb.commentId&&fb.time===Pb.time&&Tb.YZj.equals(fb.schedule,Pb.schedule):!fb&&!Pb}equals(fb,Pb){return this.Hyl(fb,Pb)}LM(){return 0}}Tb.bQg=new Fc;Tb.YZj=new Sa;new wb;Object(D.a)(Tb,"HistoryRecordEqualityComparer",null,[246]);var Hb=c(2110),$a=c(1577);class ab extends k.a{constructor(fb){super();this.LNa=fb}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.aSb),5);fb.Z(n.a.Ab(l.a.taskId),2);fb.Z(n.a.Ab(l.a.UIo),2);fb.Z(n.a.Ab(l.a.ZIo),2);fb.Z(n.a.Ab(l.a.cAa),
1);return fb}wog(fb){if(!fb.En.value.vu&&!fb.Ng.value.vu){const Pb=fb.Ng.value.xf.ZK();Pb.removeProperty(l.a.cAa);const Ec=fb.Ng.value.xf,uc=fb.En.value.xf;fb.Ng=new a.a(()=>new $a.a(Pb,Ec));fb.En=new a.a(()=>new $a.a(Pb,uc))}return super.wog(fb)}oC(fb,Pb){if(Pb!==n.a.Ab(l.a.cAa))return t.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.Ng.value.xf.id,Pb),!1;const Ec=fb.fl,uc=fb.Xd;t.a.instance.Ua(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ec.id,Ec.Oc,Pb);Pb=uc.getPropertyString(fb.Ng.value.vu,l.a.cAa);const ya=uc.getPropertyString(fb.Ng.value.xf,l.a.cAa),db=uc.getPropertyString(fb.En.value.xf,l.a.cAa);Pb=this.Kdn(Pb,ya,db);if(!Pb)return!1;0<Pb.length?uc.setPropertyString(Ec,l.a.cAa,Pb):Ec.removeProperty(l.a.cAa);fb.og.add(n.a.Ab(l.a.cAa));return!0}Kdn(fb,Pb,Ec){fb=this.LNa.W6b(fb);Pb=this.LNa.W6b(Pb);Ec=this.LNa.W6b(Ec);if(!ab.NBi(fb,
Pb))return t.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!ab.NBi(fb,Ec))return t.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;Ec=ab.I1k(fb.length,Pb,Ec);return this.LNa.Pcg(Ec)}static mh(){const fb=new Hb.a;return new ab(fb)}static get instance(){return ab.Pg.value}static I1k(fb,Pb,Ec){const uc=new K.a;for(let ya=0;ya<Pb.length;ya++)uc.add(Pb.J(ya));for(;fb<Ec.length;fb++)uc.add(Ec.J(fb));
return uc}static NBi(fb,Pb){const Ec=fb.length;if(Ec>Pb.length)return!1;for(let uc=0;uc<Ec;uc++)if(!ab.n6j.equals(Pb.J(uc),fb.J(uc)))return Pb.J(uc).recordId===fb.J(uc).recordId&&t.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}ab.Pg=new a.a(ab.mh);ab.n6j=new Tb;Object(D.a)(ab,"TaskSingleNodeComplexMerge",k.a,[]);class rb extends k.a{constructor(){super()}get Wn(){return 26}wk(){const fb=super.wk();fb.Z(n.a.Ab(y.a.gf),
1);return fb}oC(fb,Pb){const Ec=y.a.gf;if(Pb===n.a.Ab(Ec)){Pb=fb.fl;const ya=fb.Xd;var uc=ya.getPropertyObjectIds(fb.Ng.value.vu,Ec);const db=ya.getPropertyObjectIds(fb.Ng.value.xf,Ec),tb=ya.getPropertyObjectIds(fb.En.value.xf,Ec);uc=this.Rdn(uc,db,tb);ya.setPropertyObjectIds(Pb,Ec,uc);fb.og.add(n.a.Ab(Ec));return!0}return!1}Rdn(fb,Pb,Ec){return this.sHa(fb,Pb,Ec)}static mh(){return new rb}static get instance(){return rb.Pg.value}}rb.Pg=new a.a(rb.mh);Object(D.a)(rb,"VectorClockContainerNodeComplexMerge",
k.a,[]);class cb extends k.a{constructor(){super()}get Wn(){return 27}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.yS),1);return fb}oC(fb,Pb){const Ec=l.a.yS;if(Pb===n.a.Ab(Ec)){Pb=fb.fl;const uc=fb.Xd,ya=uc.getPropertyUint32(fb.Ng.value.xf,Ec)||0,db=uc.getPropertyUint32(fb.En.value.xf,Ec)||0;uc.setPropertyUint32(Pb,Ec,this.V4l(ya,db));fb.og.add(n.a.Ab(Ec));return!0}return!1}V4l(fb,Pb){return fb>Pb?fb:Pb}static mh(){return new cb}static get instance(){return cb.Pg.value}}cb.Pg=new a.a(cb.mh);Object(D.a)(cb,
"VectorClockNodeComplexMerge",k.a,[]);class rc extends k.a{constructor(){super()}get Wn(){return 28}get yA(){return 0}wk(){const fb=super.wk();fb.Z(n.a.Ab(l.a.CUh),3);fb.Z(n.a.Ab(l.a.Wc),3);fb.Z(n.a.Ab(l.a.EUh),5);fb.Z(n.a.Ab(l.a.uPi),5);fb.Z(n.a.Ab(l.a.Xja),5);return fb}static mh(){return new rc}static get instance(){return rc.Pg.value}}rc.Pg=new a.a(rc.mh);Object(D.a)(rc,"WordSectionNodeComplexMerge",k.a,[]);c.d(J,"a",function(){return Rb});class Rb{FMh(fb,Pb){switch(fb.Oc){case 131073:return fb.hasProperty(l.a.imageType)||
fb.hasProperty(e.a.B0)?this.kp(ka.instance,Pb):this.kp(Ua.instance,Pb);case 1074135140:return this.kp(x.instance,Pb);case 1074135137:return this.kp(v.instance,Pb);case 1074135139:return this.kp(I.instance,Pb);case 1074135138:return this.kp(E.instance,Pb);case 1074135136:return this.kp(Q.instance,Pb);case 1074135157:return this.kp(N.instance,Pb);case 1074135152:return this.kp(O.instance,Pb);case 1074135153:return this.kp(X.instance,Pb);case 1074135126:return this.kp(U.instance,Pb);case 1074135127:return this.kp(aa.instance,
Pb);case 1074135145:return this.kp(ea.instance,Pb);case 1074135144:return this.kp(ba.instance,Pb);case 1074135142:return this.kp(ua.instance,Pb);case 1074135143:return this.kp(sa.instance,Pb);case 1074135163:return this.kp(Fa.instance,Pb);case 1074135164:return this.kp(Pa.instance,Pb);case 1074135124:return this.kp(Na.instance,Pb);case 1074135125:return this.kp(Aa.instance,Pb);case 1074135122:return this.kp(xa.instance,Pb);case 393233:return this.kp(ka.instance,Pb);case 1073872970:return this.kp(ka.instance,
Pb);case 1074135170:return this.kp(wa.instance,Pb);case 1074135168:return this.kp(ia.instance,Pb);case 1074135166:return this.kp(va.instance,Pb);case 1074135167:return this.kp(na.instance,Pb);case 1074135169:return this.kp(Ca.instance,Pb);case 1074135165:return this.kp(ta.instance,Pb);case 393234:return this.kp(ob.instance,Pb);case 393229:return this.kp(zb.instance,Pb);case 393241:return this.kp(Lb.instance,Pb);case 393227:return this.kp(eb.instance,Pb);case 131120:return this.kp(lc.instance,Pb);
case 393271:return this.kp(sb.instance,Pb);case 393230:return this.kp(vb.a.instance,Pb);case 131140:return this.kp(Ta.instance,Pb);case 1179649:return this.kp(Wa.instance,Pb);case 1073872969:return this.kp(Bb.instance,Pb);case 393252:return this.kp(Gc.instance,Pb);case 393250:return this.kp(bc.instance,Pb);case 393251:return this.kp(Dc.instance,Pb);case 1074135154:return this.kp(rb.instance,Pb);case 1074135161:return this.kp(Ub.instance,Pb);case 1074135162:return this.kp(ab.instance,Pb);case 1074135155:return this.kp(cb.instance,
Pb);case 1073872968:return this.kp(rc.instance,Pb);case 1074135172:return this.kp(Xa.instance,Pb);case 1074135171:return this.kp(fa.instance,Pb);case 1074135149:return this.kp(za.instance,Pb);case 1074135151:return this.kp(Nb.instance,Pb)}return this.kp(k.a.instance,Pb)}kp(fb,Pb){fb.Zb=Pb?Pb():null;return fb}}Object(D.a)(Rb,"GraphNodeComplexMergeFactory",null,[1871])},1992:function(D,J,c){c.r(J);D=c(0);var l=c(1553),e=c(75),a=c(349),k=c(69),x=c(1529);class y{constructor(K,L,S,Q=0){this.gmi=K;this.groupType=
L;this.syf=Q;this.e8c=S}}Object(D.a)(y,"SortingGroup",null,[]);class n{constructor(K,L,S,Q){this.order=K;this.i9=L;this.Gnm=S;this.groupType=Q}}Object(D.a)(n,"SortingProp",null,[]);var t=c(1522),z=c(1524),v=c(1521),I=c(26);class E{constructor(K,L){this.jNi={};this.iNi={};this.eNi=this.qNi=1;this.Kzh(K,L)}iBo(K,L,S){var Q=v.a.GR(S)?this.jNi:this.iNi;S=new e.a;for(var N of L)L=Object(k.a)(n,Q[l.a[N.groupType].toLowerCase()]),I.c(L)||S.add(new a.a(L,N));S.Sc((X,U)=>X.key.order<U.key.order?-1:1);Array.clear(K);
N=t.TellMeActor.instance.w_;for(L=0;L<S.count;){Q=S.J(L).key.i9;var O=S.J(L).value;const X=new x.a(S.J(L).key.groupType);I.c(N)||N.Location===z.a.contextMenu||(X.displayName=S.J(L).key.Gnm);for(const U of O.results)X.Ww(U);for(O=++L;O<S.count&&S.J(O).key.i9===Q;)this.H_e(X,S.J(O).value),O=++L;K.push(X)}}z_o(K,L){this.eNi=this.qNi=1;this.Kzh(K,L)}Kzh(K,L){this.Quj(K);for(var S=0;S<K.length;S++){let Q=K[S];for(const N of Q.e8c)this.ttk(N,S,Q.gmi,Q.groupType)}this.Quj(L);for(K=0;K<L.length;K++){S=L[K];
for(const Q of S.e8c)this.stk(Q,K,S.gmi,S.groupType)}}Quj(K){K.sort((L,S)=>Object(k.a)(y,L).syf>Object(k.a)(y,S).syf?-1:1)}ttk(K,L,S,Q){this.jNi[l.a[K].toLowerCase()]=new n(this.qNi++,L,S,Q)}stk(K,L,S,Q){this.iNi[l.a[K].toLowerCase()]=new n(this.eNi++,L,S,Q)}H_e(K,L){for(let S=0;S<L.results.length;S++)K.Ww(L.results[S])}}Object(D.a)(E,"BaseGroupingSorter",null,[]);class H{constructor(){this.r4d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.m4d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.PMi=new E(this.r4d,this.m4d)}Mad(K,L,S,Q=null,N=null){let O=!1;if(Q){for(const X of v.a.GR(S)?
this.r4d:this.m4d)this.$Pn(X,Q);O=!0}if(N){for(const X of v.a.GR(S)?this.r4d:this.m4d)this.A_o(L,X,N);O=!0}O&&this.PMi.z_o(this.r4d,this.m4d);this.PMi.iBo(K,L,S)}$Pn(K,L){const S=new e.a;for(var Q of K.e8c){const N=L[l.a[Q].toLowerCase()];S.add(new a.a(I.c(N)?Number.MAX_VALUE:N,Q))}if(S.count){S.Sc((N,O)=>N.key<O.key?-1:1);L=Array(S.count);for(Q=0;Q<S.count;Q++)L[Q]=S.J(Q).value;K.e8c=L}}A_o(K,L,S){let Q=0;for(const N of L.e8c)if(l.a[N].toLowerCase()in S&&S[l.a[N].toLowerCase()])for(const O of K)if(O.groupType===
N){Q+=S[l.a[N].toLowerCase()];break}L.syf=Q}}Object(D.a)(H,"SimplifiedGroupingSorter",null,[]);c.d(J,"GroupsPlacementInfo",function(){return M});class M{constructor(K){this.hNi={};this.fNi={};this.gNi={};this.kNi={};this.SOf={};this.lNi=this.k$m=this.f$m=this.h$m=1;this.nNi=null;this.Cw=K;this.yPk();this.xFn();this.mPk();this.pOk();K.XP&&(this.nNi=new H)}VE(K){this.hNi[l.a[K].toLowerCase()]=this.h$m++}HH(K,L){this.fNi[l.a[K].toLowerCase()]=L}$Na(K){this.gNi[l.a[K].toLowerCase()]=this.f$m++}R3(K){this.kNi[l.a[K].toLowerCase()]=
this.k$m++}KD(K){this.SOf[l.a[K].toLowerCase()]=this.lNi++}yPk(){const K=!!this.Cw&&this.Cw.f5a,L=!!this.Cw&&this.Cw.Y2c,S=!!this.Cw&&this.Cw.amb,Q=!!this.Cw&&this.Cw.VIf&&!v.a.eec(),N=!!this.Cw&&this.Cw.OYc,O=!!this.Cw&&this.Cw.jZd,X=!!this.Cw&&this.Cw.bHf,U=!!this.Cw&&this.Cw.HDf;this.Cw&&(this.Cw.P7b||this.Cw.mha||this.Cw.TMd)&&this.VE(26);U&&this.VE(24);this.VE(4);this.VE(18);this.VE(16);this.VE(7);this.VE(17);this.VE(0);this.VE(1);X&&this.VE(28);N&&this.VE(23);K||this.VE(2);K&&!L||this.VE(8);
this.VE(15);S&&this.VE(20);this.VE(14);this.VE(9);this.VE(12);this.VE(10);this.VE(11);K&&this.VE(2);K&&!L&&this.VE(8);this.VE(19);O&&this.VE(27);this.VE(21);this.VE(13);Q&&this.VE(22);this.VE(30)}xFn(){this.HH(21,1);this.HH(4,3);this.HH(18,3);this.HH(16,3);this.HH(7,3);this.HH(17,5);this.HH(0,5);this.HH(1,1);this.HH(28,2);this.HH(2,1);this.HH(8,2);this.HH(15,3);this.HH(14,2);this.HH(27,3);this.HH(9,1);this.HH(12,1);this.HH(10,1);this.HH(11,1);this.HH(19,1);this.HH(23,1);this.HH(13,1);this.HH(24,1);
this.HH(25,1);this.HH(20,2);this.HH(22,1);this.HH(26,1)}mPk(){this.$Na(4);this.$Na(0);this.$Na(17);this.$Na(7);this.$Na(16);this.$Na(18);this.$Na(15);this.$Na(20);this.$Na(8);this.$Na(14)}pOk(){this.R3(14);this.R3(10);this.R3(12);this.R3(9);this.R3(11);this.R3(20);this.R3(15);this.R3(8);this.R3(2);this.R3(1);this.R3(27);this.R3(7);this.R3(18);this.R3(16);this.R3(17);this.R3(0);this.R3(4)}w7n(){this.SOf={};this.lNi=1}kdm(K,L,S){this.w7n();const Q=!!this.Cw&&this.Cw.f5a,N=!!this.Cw&&this.Cw.Y2c,O=!!this.Cw&&
this.Cw.amb,X=!!this.Cw&&this.Cw.VIf&&!v.a.eec(),U=!!this.Cw&&this.Cw.OYc,T=!!this.Cw&&this.Cw.jZd,Y=!!this.Cw&&this.Cw.bHf,aa=!!this.Cw&&this.Cw.Oie;K=K&&N;aa&&this.KD(25);this.KD(4);this.KD(18);this.KD(16);this.KD(7);this.KD(17);this.KD(0);this.KD(1);Y&&this.KD(28);U&&this.KD(23);Q&&!N||!K||this.KD(8);L&&this.KD(15);Q||this.KD(2);T&&this.KD(27);S&&this.KD(14);Q&&!N||K||this.KD(8);L||this.KD(15);O&&this.KD(20);S||this.KD(14);this.KD(9);this.KD(12);this.KD(10);this.KD(11);Q&&this.KD(2);Q&&!N&&this.KD(8);
this.KD(19);this.KD(21);this.KD(13);X&&this.KD(22);return this.SOf}aP(){return this.Cw}}Object(D.a)(M,"GroupsPlacementInfo",null,[])},1994:function(D,J,c){D=c(0);var l=c(1744),e=c(61);class a{constructor(){this.source=0;this.Fm=this.kWa=this.aaa=null;this.Xia=0;this.rIb=!1;this.mode=this.$Ua=0;this.jOc=null;this.LLb=e.a.create()}}Object(D.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.aN=null}}Object(D.a)(k,"OutputState",null,[]);class x{constructor(){this.xsi=
this.Uie=this.W$c=!1;this.Zb=this.a5d=this.U_f=this.cde=this.plg=this.NCb=this.GOa=this.gH=this.unb=this.xmc=this.DSo=this.VBl=this.vn=this.Eef=this.Mq=this.Nu=this.uk=this.Zne=this.rOd=this.$Da=null}}Object(D.a)(x,"RuntimeState",null,[]);c.d(J,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(D.a)(y,"MergeState",null,[])},1995:function(D,J,c){c.r(J);D=c(0);var l=c(613),e=c(225),a=c(184),k=c(111),x=c(1658),y=c(1751),
n=c(1790),t=c(6),z=c(1985);class v{constructor(S,Q){this.start=S;this.end=Q}}Object(D.a)(v,"MergeDiffIdx",null,[]);class I{constructor(S,Q,N,O=!1,X=null,U=null,T=!0){this.xkd=this.wkd=this.$Sg=this.Gzc=0;this.I1b=this.Kue=null;this.Abb=X||new z.a;this.Qg=N;this.wsa=S.S5();this.wok=Q.S5();this.mQ=new v(0,0);this.GT=new v(0,0);this.CEe=O;this.Twc=T;this.Zsa=U;this.uRk();this.Rlo()}get TK(){return this.wsa}get mK(){return this.wok}get Nz(){return this.Gzc}get zA(){return this.$Sg}get Xva(){return this.wkd}get Zna(){return this.xkd}get Kol(){const S=
new e.a;for(let Q=this.Kue.start;Q<this.Kue.end;Q++)S.add(this.TK.eg(Q));return S}get Tff(){const S=new e.a;for(let Q=this.I1b.start;Q<this.I1b.end;Q++)S.add(this.mK.eg(Q));return S}chf(S){if(this.zA<S.zA){if(this.zA+this.Xva>S.zA)return!0}else if(this.zA>S.zA){if(S.zA+S.Xva>this.zA)return!0}else if(2===this.Nz&&3===S.Nz||3===this.Nz&&2===S.Nz||2===this.Nz&&2===S.Nz||3===this.Nz&&3===S.Nz)return!0;return!1}ndj(S,Q,N,O){S.AG(Q);S.$C(Q,N);return O+=N.length-1}lvj(S,Q,N,O,X){let U=this.TK.eg(S),T=this.mK.eg(Q);
if(!U||!T||!U.M8a&&!T.M8a)return{returnValue:!1,yDa:O,aKa:X};let Y=new e.a,aa=new e.a;U.M8a&&(Y=U.Uad(),U=Y.eg(N?0:Y.length-1));T.M8a&&(aa=T.Uad(),T=aa.eg(N?0:aa.length-1));if(!U.JA(T,this.Abb,this.Zsa,this.CEe,this.Twc))return{returnValue:!1,yDa:O,aKa:X};Y.length&&(O=this.ndj(this.TK,S,Y,O));aa.length&&(X=this.ndj(this.mK,Q,aa,X));return{returnValue:!0,yDa:O,aKa:X}}yEl(S,Q,N,O,X,U){for(;X<=N&&U<=O;){const T=S.eg(X),Y=Q.eg(U);if(!T.JA(Y,this.Abb,this.Zsa,this.CEe,this.Twc))break;this.mQ.start+=T.length;
this.GT.start+=Y.length;X++;U++}return{m4e:X,Fpg:U}}wEl(S,Q,N,O,X,U){for(;X>=N&&U>=O;){const T=S.eg(X),Y=Q.eg(U);if(!T.JA(Y,this.Abb,this.Zsa,this.CEe,this.Twc))return{returnValue:!0,yDa:X,aKa:U};X--;U--}return{returnValue:!1,yDa:X,aKa:U}}xEl(S,Q,N,O){let X=!1;do({m4e:S,Fpg:Q}=this.yEl(this.TK,this.mK,N,O,S,Q)),{yDa:N,aKa:O,returnValue:X}=this.lvj(S,Q,!0,N,O);while(X);return{m4e:S,Fpg:Q,yDa:N,aKa:O}}vEl(S,Q,N,O){let X=!1;do{if(!({yDa:N,aKa:O}=this.wEl(this.TK,this.mK,S,Q,N,O)).returnValue)break;({yDa:N,
aKa:O,returnValue:X}=this.lvj(N,O,!1,N,O))}while(X);return{yDa:N,aKa:O}}uRk(){var S=0,Q=0,N=this.TK.length-1,O=this.mK.length-1;0<=N&&this.TK.eg(N);0<=O&&this.mK.eg(O);({m4e:S,Fpg:Q,yDa:N,aKa:O}=this.xEl(S,Q,N,O));if(S<N||Q<O)({yDa:N,aKa:O}=this.vEl(S,Q,N,O));N++;O++;this.Kue=new v(S,N);this.I1b=new v(Q,O);this.mQ.end=this.mQ.start;this.GT.end=this.GT.start;for(var X=S;X<N;X++){var U=this.TK.eg(X);this.mQ.end+=U.length}for(X=Q;X<O;X++)U=this.mK.eg(X),this.GT.end+=U.length;a.a.instance.Ua(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",S,N,Q,O);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.mQ.start,this.mQ.end,this.GT.start,this.GT.end);this.mQ.start<=this.mQ.end&&this.GT.start<=this.GT.end&&(S=this.TK.eg(S),Q=this.mK.eg(Q),X=this.TK.eg(N),U=this.mK.eg(O),N=this.TK.eg(N-1),O=this.mK.eg(O-1),a.a.instance.Ua(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",S,X,Q,U,N,O))}Rlo(){this.$Sg=this.mQ.start;this.wkd=this.xkd=0;this.mQ.start===this.mQ.end&&this.GT.start===this.GT.end?this.Gzc=0:this.mQ.start===this.mQ.end&&this.GT.start<this.GT.end?(this.Gzc=1,this.xkd=this.GT.end-this.GT.start):this.GT.start===this.GT.end&&this.mQ.start<this.mQ.end?(this.Gzc=2,this.wkd=this.mQ.end-this.mQ.start):(this.Gzc=
3,this.wkd=this.mQ.end-this.mQ.start,this.xkd=this.GT.end-this.GT.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Nz,this.zA,this.Xva,this.Zna)}XQm(S,Q){return S.d5()&&Q.d5()?S.runId===Q.runId&&S.Bg===Q.Bg:!1}gWm(S){if(!S.d5()||"\ufffc"!==S.text)return!1;S=S.BFb;return S?S.hasProperty(t.a.Lj)||S.hasProperty(t.a.EEd)||S.hasProperty(t.a.Ehf)||S.hasProperty(t.a.A4)||S.hasProperty(t.a.imageType)||S.hasProperty(t.a.YRa)||
S.hasProperty(t.a.fKb)||S.hasProperty(t.a.Ns)&&(S=this.Qg.getPropertyInt32(S,t.a.Ns))&&(36===S||35===S||24===S||23===S||33===S||34===S||44===S||45===S||42===S||43===S)?!0:!1:!1}vXc(S){return S.d5()&&!this.gWm(S)}ZSk(){if(2===this.Nz)return!1;var S=this.I1b.start;if(!S)return!1;let Q=null;for(var N=this.I1b.start;N<this.I1b.end;N++){const O=this.mK.eg(N);if(this.vXc(O)){Q=O;break}}if(!Q)return!1;--S;for(N=this.mK.eg(S);N&&!this.vXc(N);)S--,N=this.mK.eg(S);return N&&this.XQm(N,Q)?!0:!1}W$h(S){const Q=
new e.a;for(let N=0;N<S.length;N++)S.J(N).M8a?Q.$C(Q.length,S.J(N).Uad()):Q.insert(Q.length,S.J(N));return Q}ZQm(){if(3!==this.Nz||this.Xva!==this.Zna)return!1;const S=this.W$h(this.Kol),Q=this.W$h(this.Tff);if(S.length!==Q.length)return!1;for(let N=0;N<S.length;N++)if(!S.J(N).JA(Q.J(N),this.Abb,this.Zsa,!0,this.Twc))return!1;return!0}YQm(){if(0!==this.Nz&&3!==this.Nz||this.TK.length!==this.mK.length)return!1;let S=!1;for(let Q=0;Q<this.TK.length;Q++){if(!this.TK.J(Q).JA(this.mK.J(Q),this.Abb,this.Zsa,
!0,this.Twc))return!1;if(3===this.TK.J(Q).type||1===this.TK.J(Q).type){const N=this.TK.J(Q),O=this.mK.J(Q);S=N.runId!==O.runId||N.Bg!==O.Bg||S}}return S}}Object(D.a)(I,"MergeBlockDiff",null,[]);var E=c(1613);class H{constructor(S,Q){this.id=S;this.index=Q}}Object(D.a)(H,"ParagraphStartIndex",null,[]);var M=c(1669),K=c(1593);c.d(J,"ParagraphMerge",function(){return L});class L{constructor(S,Q,N,O,X,U,T){this.I_b=this.eyb=this.Yo=this.yx=null;this.Zh=!1;this.Qkh=this.uVg=this.ZMg=this.vua=this.ELa=
this.wsa=null;this.$d=S;this.XF=Q;this.UCa=O;this.ABa=N;this.Ysa=X;this.Zsa=U;this.Qg=T}ogi(S){const Q=new l.a;S.TK.forEach(N=>{2===N.type&&Q.add(N.Pj);return!0});S.mK.forEach(N=>{2===N.type&&Q.remove(N.Pj);return!0});return Q}Qci(S){const Q=new e.a;S.mK.forEach(N=>{2===N.type&&Q.add(N.Pj);return!0});return Q}mIh(S){const Q=new e.a;let N=0,O=0;S.mK.forEach(X=>{2===X.type&&(Q.add(new H(X.Pj,N<S.zA?N:N<S.zA+S.Zna?S.zA:N-S.Zna+S.Xva)),N=O);O+=X.length;return!0});return Q}k4k(S,Q){var N=this.mIh(S);const O=
this.mIh(Q);S=this.ogi(S);const X=this.ogi(Q);Q=new e.a;const U=new l.a;let T=0;for(let Y=0;Y<N.length;Y++){const aa=N.J(Y);if(T<O.length){let ba=O.J(T);for(;T<O.length&&ba.index<=aa.index;){if(ba.id.equals(aa.id)){T++;break}S.contains(ba.id)||U.contains(ba.id)||(Q.add(ba.id),U.add(ba.id));T++;ba=O.J(T)}}X.contains(aa.id)||(Q.add(aa.id),U.add(aa.id))}for(;T<O.length;)N=O.J(T),S.contains(N.id)||U.contains(N.id)||(Q.add(N.id),U.add(N.id)),T++;return Q}initialize(){if(this.Zh){const S=!!this.yx&&!!this.Yo;
this.$d.logger.Rg(Object.assign(new E.a,{zj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return S}this.Zh=!0;if(!({TK:this.wsa,iOc:this.ELa,ydd:this.vua,qEd:this.ZMg,sOd:this.uVg,$ne:this.Qkh}=K.a.eNh(this.$d,this.Qg,this.XF,this.ABa,this.UCa,this.Ysa,!1,!1)).returnValue)return!1;this.yx=new I(this.wsa,this.ELa,this.Qg,void 0,void 0,this.Zsa);this.Yo=new I(this.wsa,this.vua,this.Qg,void 0,void 0,this.Zsa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.yx.Xva,this.yx.Zna,this.Yo.Xva,this.Yo.Zna));return!0}PJa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let S=!1;const Q=new n.a(this.Qg,this.$d);let N=null,O=null;var X=null;const U=Y=>this.$d.runtime.uk.J(Y),T=Y=>this.$d.runtime.Mq.J(Y)||this.$d.runtime.uk.J(Y);this.yx=new I(this.wsa,this.ELa,this.Qg,void 0,void 0,this.Zsa,!1);this.Yo=new I(this.wsa,this.vua,this.Qg,void 0,void 0,this.Zsa,!1);({updateHints:N}=Q.JOh(this.XF,U,this.ABa,Y=>this.$d.runtime.Nu.J(Y)||this.$d.runtime.uk.J(Y),
this.yx.zA,this.yx.zA+this.yx.Xva,this.yx.zA+this.yx.Zna)).returnValue&&({updateHints:O}=Q.JOh(this.XF,U,this.UCa,T,this.Yo.zA,this.Yo.zA+this.Yo.Xva,this.Yo.zA+this.Yo.Zna)).returnValue&&(S=!0);S||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),S=!1);S&&(X=new M.a(this.$d,this.XF,this.ABa,this.UCa,Y=>this.$d.runtime.Zb?this.$d.runtime.Zb.isFeatureEnabled(Y):!1,this.Qg,null,N,O),({vn:X}=X.yoc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.$d.logger.Rg(Object.assign(new E.a,{zj:"TryLCSMerge",eventId:"9zrqs"})),S=!1));a.a.instance.Ua(593826833,1,S?4:2,"TryLCSMerge: [Success: {0}]",S);return{returnValue:S,vn:X}}yoc(){let S;S=null;if(!this.initialize())return this.$d.logger.bV("ParagraphMerge Initialize"),this.E5a(),{returnValue:!1,vn:S};this.$d.logger.bV("ParagraphMerge Initialize");let Q;this.$d.logger.Che(2);let N=({PJa:Q}=this.Arl()).returnValue;N=N&&({vn:S,PJa:Q}=this.sRc(this.$d,this.Qg,this.Ysa,this.I_b,this.eyb)).returnValue;
this.$d.logger.ueg();if(!N){this.$d.logger.bV("ParagraphMerge DoMergeInteral");if(Q){this.$d.logger.Che(3);({vn:S,returnValue:N}=this.PJa());this.$d.logger.ueg();if(N)return{returnValue:!0,vn:S};this.E5a();return{returnValue:!1,vn:S}}this.E5a();return{returnValue:!1,vn:S}}if(!({vn:S,PJa:Q}=this.sRc(this.$d,this.Qg,this.Ysa,this.I_b,this.eyb)).returnValue)return this.$d.logger.bV("ParagraphMerge DoMergeInteral"),this.E5a(),{returnValue:!1,vn:S};this.$d.logger.bV("ParagraphMerge DoMergeInteral");return{returnValue:!0,
vn:S}}sRc(){let S;if(!({K$d:S}=K.a.sRc(this.$d,this.Qg,this.Ysa,this.I_b,this.eyb)).returnValue)return this.$d.logger.bV("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.E5a(),{returnValue:!1,vn:S,PJa:!0};this.$d.logger.bV("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,vn:S,PJa:!1}}E5a(S=!1){a.a.instance.Cka(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+S+"] BaseRevisionMergeBlocksList: {0}",this.ZMg);a.a.instance.Cka(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.uVg);a.a.instance.Cka(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.Qkh);S=new e.a;K.a.Bfc(this.Qg,"BaseObjects_",this.XF,S);K.a.Bfc(this.Qg,"FavoredObjects_",this.ABa,S);K.a.Bfc(this.Qg,"ConflictObjects_",this.UCa,S);K.a.K5m(this.$d,S)}jBh(S){let Q,N;N=Q=0;if(0===this.yx.Nz)Q=this.Yo.zA;else if(1===this.yx.Nz)Q=this.Yo.zA<this.yx.zA?this.Yo.zA:this.Yo.zA===this.yx.zA?S||1!==this.Yo.Nz?this.Yo.zA+this.yx.Zna:this.Yo.zA:this.Yo.zA+this.yx.Zna;else if(2===this.yx.Nz||3===this.yx.Nz)Q=
this.Yo.zA<=this.yx.zA?this.Yo.zA:this.Yo.zA+(this.yx.Zna-this.yx.Xva);if(2===this.Yo.Nz||3===this.Yo.Nz)N=Q+this.Yo.Xva;return{Rli:Q,Zmm:N}}C0h(S,Q){let N;N=0;if(!Q)return{returnValue:!0,H1c:N};let O=0,X=0;for(;O<S.length;){let U;for(let T=O;T<S.length;T++){O=T;U=S.J(T);const Y=U.length;X+=Y;if(!(X<Q)){if(X>Q)if(U.M8a)S.AG(O),S.$C(O,U.Uad()),X-=Y;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
Q),this.$d.logger.Rg(Object.assign(new E.a,{zj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,H1c:N};break}}if(X===Q)return O++,N=O,{returnValue:!0,H1c:N}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",Q);this.$d.logger.Rg(Object.assign(new E.a,{zj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,H1c:N}}CGk(S,Q,N){let O=0;var X=0,U=!1;const T=this.Yo.Tff.S5();
if(this.Yo.ZSk())for(--Q;0<=Q;Q--){let Y=S.J(Q);if(this.Yo.vXc(Y)){X=S.J(Q);O=X.runId;X=X.Bg;U=!0;break}}U||((X=S.J(N))&&this.Yo.vXc(X)?(O=X.runId,X=X.Bg):X=O=0);for(S=0;S<T.length;S++)N=T.J(S),N.d5()&&(U=N,this.Yo.vXc(N)?(U.runId=O,U.Bg=X):(U.runId=0,U.Bg=0));return T}bBi(S){if(2===S.length){const Q=1===S.J(0).type?S.J(0):null;S=2===S.J(1).type;if(Q&&S&&""===Q.text)return!0}return!1}Arl(){const S=this.yx.YQm();if(!S&&0===this.yx.Nz)return this.I_b=this.Yo.mK.S5(),this.eyb=this.Qci(this.Yo),{returnValue:!0,
PJa:!1};if(0===this.Yo.Nz)return this.I_b=this.yx.mK.S5(),this.eyb=this.Qci(this.yx),{returnValue:!0,PJa:!1};(this.bBi(this.yx.mK)||this.bBi(this.Yo.mK))&&this.$d.logger.AKi(Object.assign(new E.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!S){var Q=this.yx.chf(this.Yo);Q&&this.Ysa(57)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.yx=new I(this.wsa,this.ELa,this.Qg,!0,void 0,this.Zsa),this.Yo=
new I(this.wsa,this.vua,this.Qg,!0,void 0,this.Zsa),Q=this.yx.chf(this.Yo));if(Q)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.$d.logger.Rg(Object.assign(new y.a,{zj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,PJa:!0}}var N;Q=0;this.eyb=this.k4k(this.yx,this.Yo);({Rli:N,Zmm:X}=this.jBh(!1));const O=this.yx.mK.S5();if(!({H1c:N}=this.C0h(O,N)).returnValue||(2===this.Yo.Nz||3===this.Yo.Nz)&&!({H1c:Q}=
this.C0h(O,X)).returnValue)return{returnValue:!1,PJa:!1};if(2===this.Yo.Nz||3===this.Yo.Nz){this.blc(O,Q);this.blc(O,N-1);var X=null;for(var U=Q-1;U>=N;U--)2===O.J(U).type&&(X=O.J(U)),O.AG(U);0<O.length&&(U=O.J(O.length-1),2!==U.type&&4!==U.type&&X&&(this.$d.runtime.Zb.Xx(78),this.$d.runtime.Zb.isFeatureEnabled(78)&&(O.add(X),this.eyb.add(X.Pj))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",Q-N-1,N)}if(1===this.Yo.Nz||3===this.Yo.Nz)X=this.Yo.Tff,
S&&(X=this.CGk(O,N,Q)),this.blc(O,N-1),this.blc(O,N),this.blc(X,0),this.blc(X,X.length-1),O.$C(N,X),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",N,S,X.hr());this.I_b=O;return{returnValue:!0,PJa:!1}}blc(S,Q){0>Q||Q>=S.length||(S=S.J(Q),Object(k.a)(x.a,S)&&(S.PRa=!0))}Kdd(S,Q){let N;N=Q;if(!this.initialize())return{returnValue:!1,B7a:S,gra:N};if(this.Yo.chf(this.yx))return this.E5a(!0),this.$d.logger.Rg(Object.assign(new y.a,
{zj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,B7a:S,gra:N};if(0===this.Yo.Nz||3===this.Yo.Nz&&this.Yo.ZQm())return{returnValue:!0,B7a:S,gra:Q};let O;({Rli:O}=this.jBh(!0));Q<O||Q===O&&(1!==this.Yo.Nz||1===this.Yo.Nz&&1===this.yx.Nz&&Q===this.yx.zA+this.yx.Zna)?N=Q:(N=Q+this.Yo.Zna-this.Yo.Xva,N<O&&(N=O));return{returnValue:!0,B7a:S,gra:N}}}Object(D.a)(L,"ParagraphMerge",null,[1867])},1996:function(D,J,c){c.r(J);D=c(0);var l=c(1673),e=c(1589),a=c(1553),k=c(1807),x=c(1588);class y{constructor(M=
"",K="",L="",S=-99999,Q=-1,N=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=K?K:"";this.Type=L?L:"";this.Score=S;this.Age=Q;this.Count=N}}Object(D.a)(y,"Suggestion",null,[]);class n{constructor(M,K){this.GroupType=this.Suggestions=null;this.Suggestions=M;this.GroupType=K}}Object(D.a)(n,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.vgo="servicecommands";t.template="template";Object(D.a)(t,
"SuggestionGroupType",null,[]);var z=c(1522),v=c(1521),I=c(2),E=c(35);c.d(J,"InteractionLogger",function(){return H});class H{constructor(M,K,L){this.jAe=0;this.DVe=this.Jyc=null;this.ve=M;this.HTe=this.zxe=this.aFe=!1;this.b0j=K;this.Zf=I.AFrameworkApplication.He;this.fc=L;this.Ojd=this.kOe=0}get Zqa(){return this.ve.Zqa}Ohe(M){this.ve.Ohe(M)}ELi(){if(this.Jyc){var M=0;for(const K of this.Jyc)this.ve.X7m(K,M++);this.Jyc=null}}beginQuery(M,K,L){this.ve.P7m(M,K,L)}Unb(M,K){this.ve.DKk(M,K);this.aFe=
!0;this.HTe=!1}Aya(){this.aFe=!1;this.zxe||(this.ELi(),this.ve.gXh(this.jAe))}Q7m(M,K){this.ve.R7m(M,K)}fnn(M,K,L,S,Q){for(const N of this.b0j)if(M.startsWith(N)){this.HTe=!0;break}this.ve.c5m(M,K,L,S,Q)}Mnn(M){this.zxe=!1;this.jAe=M;this.aFe||this.HTe||(this.ELi(),this.ve.gXh(this.jAe,!1))}Lnn(M,K){this.ve.i5m(M,K);this.zxe=!0}Jnf(M,K){if(!M.count)return"";let L="";const S=Date.now();for(let Q of M)M=(S-Q.timeStamp)/1E3,M=v.a.nne(M),0<L.length&&(L+=";"),L+=K?Q.commandId:Q.controlId,L+=":",L+=M.toString();
return L}p6a(){var M=this.Jnf(l.a.instance.eQc(),!1);0<M.length&&this.ve.a5m(M);M=this.Jnf(l.a.instance.Nib(),!0);0<M.length&&this.ve.u4m(M);M=this.Jnf(l.a.instance.Avc,!0);0<M.length&&this.ve.V5m(M);M=z.TellMeActor.instance.j8g;0<M.length&&this.ve.N7m(E.c(M))}i8m(M){this.ve.I4m(M)}W9(M,K,L,S,Q,N,O,X=null){this.ve.Q6m(M,K,L,S,Q,N,O,X)}RNf(M,K,L,S){this.ve.RNf(M,K,L,S)}QA(M,K,L=null){this.ve.XG(M,K,L)}onError(M,K,L=null){this.ve.gqa(M,K,L)}alo(M){this.Jyc=M}ugm(M){const K=[];if(!M)return K;for(let L=
0;L<M.length;L++){const S=a.a[M[L].groupType].toLowerCase(),Q=[],N=M[L].results;if(N){for(let O=0;O<N.length;O++)"findindocument"===S?Array.add(Q,new y("","",S,N[O].score,N[O].YCd,N[O].count)):Array.add(Q,new y(N[O].label,N[O].description,S,N[O].score,N[O].YCd,N[O].count));"answer"===S||"definition"===S||"wolframanswer"===S||"entity"===S?Array.add(K,new n(Q,t.answer)):"classifier"===S||"appsforoffice"===S?Array.add(K,new n(Q,t.commands)):"serviceclassifier"===S?Array.add(K,new n(Q,t.vgo)):"assistance"===
S?Array.add(K,new n(Q,t.help)):("document"===S||"people"===S||"findindocument"===S||"notes"===S||"image"===S||"template"===S)&&Array.add(K,new n(Q,S))}}return K}yvf(M,K){const L={};L.Query=K;L.SuggestionGroups=E.c(this.ugm(M));return E.c(L)}hji(M){const K={"Content-Type":"application/json",Accept:"application/json"};K["X-Office-Version"]=I.AFrameworkApplication.buildVersion;K["X-Office-Application"]=I.AFrameworkApplication.K.kb("Application");K["X-Office-Platform"]="WAC";K["X-TellMe-SqmUserId"]=I.AFrameworkApplication.K.kb("LoggableUserId")||
"";K["X-TellMe-SessionId"]=this.ve.Zqa.tpa;K["X-TellMe-SuggestionTypes"]="Ranker";K["X-TellMe-Culture"]=I.AFrameworkApplication.uiCulture;K["X-TellMe-ProcessSessionId"]=I.AFrameworkApplication.userSessionId;K["X-TellMe-Flights"]=M;K["X-TellMe-PartialQueryIndex"]=this.kOe;return K}XMb(M,K,L){this.W9(K.length,"RankerLogging",M.data.Ne.toString(),Math.round(window.performance.now()-L),x.a.hzj,!0,e.a.XQa)}GMb(M,K,L){this.W9(K.length,"RankerLogging",M.data.Ne.toString(),Math.round(window.performance.now()-
L),x.a.hzj,!1,e.a.XQa)}iji(){this.DVe||(this.DVe=new k.a(this.fc,null,6E3));return this.DVe.maa}TNf(M){const K=this.yvf(this.Jyc,M),L=this.hji("RankerLogging"),S=window.performance.now();this.Zf.nj(this.iji(),2,K,L,!1,0,Q=>{this.XMb(Q,M,S)},Q=>{this.GMb(Q,M,S)},null,null,!1,4E3,6E3);this.kOe++}l7n(){this.kOe=0}Bdg(M){this.Ojd=M}}Object(D.a)(H,"InteractionLogger",null,[])},1998:function(D,J,c){c.r(J);D=c(0);var l=c(16),e=c(6),a=c(184),k=c(225),x=c(61),y=c(1742),n=c(1657),t=c(1611),z=c(1593);class v{constructor(M,
K,L=null){this.author=M;this.V0c=K;this.T2f=L||x.a.nil}JA(M){return M?this.author===M.author&&this.V0c===M.V0c&&this.T2f===M.T2f:!1}}Object(D.a)(v,"RunMergeBlockTrackedChangeAttribute",null,[]);class I{constructor(M,K,L){this.insertion=M||I.pif;this.deletion=K||I.pif;this.iIa=L||I.pif}get Psm(){return 0<this.insertion.author.length}get ssm(){return 0<this.deletion.author.length}get ttm(){return 0<this.iIa.author.length}JA(M){return M?this.insertion.JA(M.insertion)&&this.deletion.JA(M.deletion)&&this.iIa.JA(M.iIa):
!1}}I.pif=new v("",0);Object(D.a)(I,"RunMergeBlockTrackedChangeInfo",null,[]);var E=c(1805);c.d(J,"ParagraphMergeBlockCreator",function(){return H});class H extends n.a{constructor(M,K,L,S,Q,N,O){super();this.maxValue=Number.MAX_VALUE;this.kB=new y.a;this.oVb=null;this.hO=0;this.u1g=!1;this.Fzc="";this.Cte=M;this.Ws=K;this.Gu=L;this.Ukk=S;this.xmd=Q;this.F0g=N;this.Qg=O;if(this.Qg.hasProperty(this.Ws,l.a.ho))if(this.Qg.hasProperty(this.Ws,e.a.Wc))if(this.Qg.hasProperty(this.Ws,e.a.uq))if(this.Qg.hasProperty(this.Ws,
e.a.ot))if(this.Qg.hasProperty(this.Ws,l.a.Rn))if(this.t3=this.Qg.getPropertyString(this.Ws,l.a.ho),this.JYe=this.Qg.getPropertyUint32(this.Ws,e.a.Wc),this.Cs=this.Qg.getPropertyUint32s(this.Ws,e.a.uq),this.Ltd=this.Qg.getPropertyUint32s(this.Ws,e.a.ot),this.mCe=this.Qg.getPropertyObjectIds(this.Ws,l.a.Rn),this.t3||""===this.t3)if(this.t3.length||1!==this.mCe.length||(this.Cs.length||(this.Cs.add(0),a.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.Ltd.length||(this.Ltd.add(0),a.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.ock=this.LQd(this.Ws,e.a.UTf,this.Cs.length),this.pBc=this.LQd(this.Ws,l.a.rya,this.Cs.length),this.zma=this.LQd(this.Ws,l.a.Rqb,this.Cs.length),this.Ola=this.LQd(this.Ws,e.a.FQa,this.Cs.length),this.lma=this.Kjm(this.Ws,e.a.kIa,this.Cs.length),this.yAm(),M=this.Qg.hasProperty(this.Ws,l.a.Im)?this.Qg.getPropertyUint32s(this.Ws,l.a.Im):new k.a,this.ywd=
z.a.Mnj(M,this.t3.length),this.Cs.length!==this.Ltd.length)a.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",K.id);else if(this.Cs.length!==this.mCe.length)a.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",K.id);else{this.F0g&&(this.Qg.hasProperty(this.Ws,e.a.Jv)?this.oVb=this.Qg.getPropertyObjectIds(this.Ws,e.a.Jv):(a.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
K.id),this.oVb=this.c0(this.Cs.length,x.a.nil)),this.Cs.length!==this.oVb.length&&(a.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",K.id,this.Cs.length,this.oVb.length),this.oVb=this.c0(this.Cs.length,x.a.nil)));if(this.Cs.length!==this.pBc.length||this.Cs.length!==this.zma.length||this.Cs.length!==this.Ola.length||this.Cs.length!==this.lma.length)this.Cs.length===this.pBc.length||this.xmd||a.a.instance.Ua(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",K.id,this.Cs.length,this.pBc.length),this.Cs.length===this.zma.length||this.xmd||a.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",K.id,this.Cs.length,this.zma.length),this.Cs.length===this.Ola.length||this.xmd||a.a.instance.Ua(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",K.id,this.Cs.length,this.Ola.length),this.Cs.length===this.lma.length||this.xmd||a.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",K.id,this.Cs.length,this.lma.length),M=this.Qg.getPropertyBool(this.Ws,l.a.M$e),a.a.instance.Ua(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",K.id,Q,null==M?!1:M),this.pBc=this.c0(this.Cs.length,!0),this.zma=this.c0(this.Cs.length,!1),this.Ola=this.c0(this.Cs.length,!1),this.lma=this.c0(this.Cs.length,0),this.Qg.setPropertyBool(this.Ws,l.a.M$e,!1);this.kB.r3o(this.Cs.length)?(this.ywd.length!==this.Cs.length+1&&a.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
K.id,this.Cs.length,this.ywd.length),this.p$j=!0):a.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",K.id)}else a.a.instance.Ua(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id)}yAm(){this.Qg.hasProperty(this.Ws,e.a.rGa)?this.kB.Ukb=this.Qg.getPropertyBools(this.Ws,e.a.rGa):this.kB.Ukb=this.c0(this.Cs.length,!1);this.Qg.hasProperty(this.Ws,e.a.gha)?this.kB.jhb=this.Qg.getPropertyBools(this.Ws,e.a.gha):
this.kB.jhb=this.c0(this.Cs.length,!1);this.Qg.hasProperty(this.Ws,e.a.sGa)?this.kB.Tkb=this.Qg.getPropertyStrings(this.Ws,e.a.sGa):this.kB.Tkb=this.c0(this.Cs.length,"");this.Qg.hasProperty(this.Ws,e.a.HEa)?this.kB.ihb=this.Qg.getPropertyStrings(this.Ws,e.a.HEa):this.kB.ihb=this.c0(this.Cs.length,"");this.Qg.hasProperty(this.Ws,e.a.tGa)?this.kB.Vkb=this.Qg.getPropertyListOfMilliseconds(this.Ws,e.a.tGa):this.kB.Vkb=this.c0(this.Cs.length,0);this.Qg.hasProperty(this.Ws,e.a.IEa)?this.kB.r1a=this.Qg.getPropertyListOfMilliseconds(this.Ws,
e.a.IEa):this.kB.r1a=this.c0(this.Cs.length,0);this.Qg.hasProperty(this.Ws,e.a.jIa)?this.kB.R6a=this.Qg.getPropertyBools(this.Ws,e.a.jIa):this.kB.R6a=this.c0(this.Cs.length,!1);this.Qg.hasProperty(this.Ws,e.a.MJa)?this.kB.Qob=this.Qg.getPropertyStrings(this.Ws,e.a.MJa):this.kB.Qob=this.c0(this.Cs.length,"");this.Qg.hasProperty(this.Ws,e.a.NJa)?this.kB.Sob=this.Qg.getPropertyListOfMilliseconds(this.Ws,e.a.NJa):this.kB.Sob=this.c0(this.Cs.length,0);this.Qg.hasProperty(this.Ws,e.a.kAa)?this.kB.Rob=this.Qg.getPropertyObjectIds(this.Ws,
e.a.kAa):this.kB.Rob=this.c0(this.Cs.length,x.a.nil)}LQd(M,K,L){return this.Qg.hasProperty(M,K)?this.Qg.getPropertyBools(M,K):this.c0(L,!1)}Kjm(M,K,L){return this.Qg.hasProperty(M,K)?this.Qg.getPropertyUint32s(M,K):this.c0(L,0)}c0(M,K){const L=new k.a;for(let S=0;S<M;S++)L.add(K);return L}eim(M){const K=this.ywd.eg(M);M=this.ywd.eg(M+1);return this.t3.substring(K,M)}edi(){if(this.u1g)return null;var M=this.hO<this.Cs.length?this.Cs.eg(this.hO):this.maxValue;if(M===this.maxValue||this.Ukk&&!this.t3.length)return this.u1g=
!0,M=new t.a(this.Gu,this.Ws.id,this.JYe),this.Fzc=this.m2e(this.Fzc,M.toString()),M;const K=this.Ltd.eg(this.hO),L=this.mCe.eg(this.hO),S=this.ock.eg(this.hO),Q=this.pBc.eg(this.hO),N=this.zma.eg(this.hO),O=this.Ola.eg(this.hO),X=this.lma.eg(this.hO),U=this.F0g?this.oVb.eg(this.hO):null;var T=null;this.kB.Ukb.eg(this.hO)&&(T=new v(this.kB.Tkb.eg(this.hO)||"",this.kB.Vkb.eg(this.hO)));var Y=null;this.kB.jhb.eg(this.hO)&&(Y=new v(this.kB.ihb.eg(this.hO)||"",this.kB.r1a.eg(this.hO)));var aa=null;this.kB.R6a.eg(this.hO)&&
(aa=new v(this.kB.Qob.eg(this.hO)||"",this.kB.Sob.eg(this.hO),this.kB.Rob.eg(this.hO)));T=new I(T,Y,aa);Y=this.eim(this.hO);this.hO++;aa=Y.startsWith("\ufddfHYPERLINK ");M=new E.a(this.Cte,this.Gu,this.Ws.id,K,M,L,Y,S,!aa,Q,N,O,X,T,U);this.Fzc=this.m2e(this.Fzc,M.toString());return M}Oci(){let M;M=null;var K="";if(!this.p$j)return{VPf:M,T5a:K};if(K=this.edi())M=new k.a,M.add(K);for(;K=this.edi();)M.add(K);K=this.Fzc;return{VPf:M,T5a:K}}}Object(D.a)(H,"ParagraphMergeBlockCreator",n.a,[])},2003:function(D,
J,c){c.r(J);D=c(0);var l=c(225),e=c(1657),a=c(1610);class k extends a.a{constructor(y,n){super(4,y,n)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Pj)}v9b(){return"Table"}clone(){return new k(this.source,this.Pj)}JA(y,n,t,z=!1){return super.JA(y,n,t,z)?this.Pj.equals(y.Pj):!1}get length(){return 1}}Object(D.a)(k,"TableMergeBlock",a.a,[]);c.d(J,"TableMergeBlockCreator",function(){return x});class x extends e.a{constructor(y,n){super();this.jNg=new k(n,y.id)}Oci(){let y;
y=new l.a;y.add(this.jNg);return{VPf:y,T5a:this.m2e("",this.jNg.toString())}}}Object(D.a)(x,"TableMergeBlockCreator",e.a,[])},2092:function(D,J,c){c.r(J);var l=c(2),e=c(0),a=c(55),k=c(156);class x extends k.a{constructor(G){super(!1,!1,!0);this.vKa=G}start(){var G={["tooltipPersistenceEnabled"]:this.vKa.AAf};l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(G.textSelectionChangeEnabled=this.vKa.fme);G={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:G};this.Uh("",Object(a.a)(this,this.Z$f,"resultHandler"),G)}Z$f(G,ha){1===G&&(this.vKa.AAf=ha.tooltipPersistenceEnabled,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.vKa.fme=ha.textSelectionChangeEnabled))}}Object(e.a)(x,"AccessibilitySettingsDialog",k.a,[]);var y=c(70),n=c(12);class t{constructor(G,ha){this.ga=G;this.vKa=ha}Ub(){this.ga.qa(n.a.nwo,y.a.frame,Object(a.a)(this,this.owo,"showAccessibilitySettingsDialogHandler"))}owo(){(new x(this.vKa)).start();
return 32}}Object(e.a)(t,"AccessibilitySettingsDialogActor",null,[1892]);var z=c(464);const v=G=>{const ha=new z.a;l.AFrameworkApplication.He.nj(I(G),1,null,null,!0,2,La=>{200===La.data.Ne?ha.Dg("true"===La.data.te.toLowerCase()):ha.Dg(!1)},()=>{ha.Dg(!1)},null,void 0,void 0,void 0,void 0,"7");return ha.task},I=G=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",G,l.AFrameworkApplication.em);var E=c(128);class H{constructor(){this.PVe=
this.QXb=null}get AAf(){return!!this.QXb}set AAf(G){G!==this.QXb&&(this.QXb=G,E.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(G),this.DCi()&&l.AFrameworkApplication.He.nj(I("saveHoverableRibbonTooltipIsEnabled"),2,G.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get fme(){return!!this.PVe}set fme(G){G!==this.PVe&&(this.PVe=G)}k3m(){const G=new z.a;if(this.QXb)G.Dg(this.QXb);else if(this.DCi()){const ha=v("getHoverableRibbonTooltipIsEnabled");
ha.continueWith(()=>{this.QXb=ha.result;E.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ha.result);G.Dg(ha.result)},8)}else G.Dg(!1)}DCi(){const G=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ha=l.AFrameworkApplication.K.$("IsAnonymousUser");return G&&!ha}}Object(e.a)(H,"AccessibilitySettingsInfo",null,[1888]);var M=c(186),K=c(36);class L{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}wc(G){this.W=G;this.W.register(H,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ud(()=>
new H).ha();this.W.register(t,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ud(()=>new t(l.AFrameworkApplication.va,this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const G=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ha=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");G&&ha?(ha.Ub(),G.k3m()):K.b(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){M.a.instance.Gc(new L)}}Object(e.a)(L,"AccessibilitySettingsPackage",null,[1,2]);var S=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},Q=c(81);class N extends Sys.EventArgs{constructor(G,ha){super();this.pme=G;this.actualValue=ha}}Object(e.a)(N,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class O{constructor(){this.NVb=[];this.bRg=this.Oxe=0;this.ti=null;this.sa=new Q.a}init(G,ha,La){this.ti=G;this.Oxe=ha;this.bRg=La;this.ti.w0e(Object(a.a)(this,this.n7d,"onCpuMeterFrameAvailable"));this.hyk(Object(a.a)(this,this.p9k,"cpuPercentThresholdExceeded"))}n7d(G,
ha){ha.ARi&&(Array.enqueue(this.NVb,ha.ARi.CP),this.NVb.length>this.bRg&&(Array.dequeue(this.NVb),this.WVk()))}WVk(){var G=this.NVb.length;let ha=0;for(let La=0;La<G;La++){const lb=Array.dequeue(this.NVb);ha+=lb;Array.enqueue(this.NVb,lb)}G=ha/G;G>this.Oxe&&this.sa.raiseEvent("CPTTE",new N(this.Oxe,G))}p9k(G,ha){K.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.xJd(ha.pme,ha.actualValue))}hyk(G){this.sa.addHandler("CPTTE",G)}xJd(G,ha){const La={};La.ThresholdValue=G;La.ActualValue=
ha;return La}}Object(e.a)(O,"CpuMeterMonitor",null,[1957]);class X{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(X,"ProfileInformation",null,[]);var U=c(10),T=c(39),Y=c(244),aa=c(85);class ba{constructor(G=0,ha=0){this.Zvb=!1;this.svb={};this.urd=G;this.Lrd=ha;this.lXe=0;T.a.addHandler(window.self,U.a.Gsh,()=>{this.Zvb=!0});T.a.addHandler(window.self,U.a.Hsh,()=>{this.Zvb=!1})}Jsh(G,ha,La){const lb=ba.generateKey(ha,La);lb in this.svb?ha=this.svb[lb]:(ha=new X,ha.S=La?1:0,this.svb[lb]=
ha,this.lXe++);ha.C++;ha.M=G>ha.M?G:ha.M;ha.T+=G}pDa(G,ha){this.Jsh(G,ha,!1);this.Zvb&&this.Jsh(G,ha,!0)}getData(){if(0<this.Lrd&&this.lXe>this.Lrd)return this.NUl();const G=0<this.urd,ha={},La=this.svb;for(let Vb in La){var lb=Vb;const tc=La[Vb];this.Fgj(tc);G&&tc.T>=this.urd&&(ha[lb]=tc)}return G?aa.a.af(ha)?null:ha:this.svb}NUl(){var G=0<this.urd,ha=[];const La=this.svb;for(let lb in La){const Vb={key:lb,value:La[lb]};let tc=Vb.value;(!G||tc.T>=this.urd)&&Array.add(ha,Vb)}if(ha.length>this.Lrd)ha.sort((lb,
Vb)=>Vb.value.T-lb.value.T),ha=ha.slice(0,this.Lrd);else if(!ha.length)return null;G={};for(const lb of ha)ha=lb.value,this.Fgj(ha),G[lb.key]=ha;return G}Fgj(G){G.M=Y.a.zV(G.M,0);G.T=Y.a.zV(G.T,0)}reset(){this.svb={};this.lXe=0}static generateKey(G,ha){return ha?G+" [it]":G}}Object(e.a)(ba,"FunctionCallAggregator",null,[1081]);var oa=c(1104);class ma{}Object(e.a)(ma,"CpuMeterFrame",null,[]);class ea extends Sys.EventArgs{constructor(G){super();this.ARi=G}}Object(e.a)(ea,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class ua{}Object(e.a)(ua,"MiniTaskItemInfo",null,[]);class sa{}Object(e.a)(sa,"TaskItemInfo",null,[]);var Fa=c(1064),Pa=c(1425),Na=c(194);class Aa{constructor(G,ha,La,lb,Vb){this.Gzb=0;this.l_=null;this.Bwd=this.Whh=0;this.bfh=!1;this.dXb=0;this.Lxc=!1;this.Gta=null;this.Jod=0;this.FMe=new Q.a;this.$yd=[];this.cA=G;this.xKe=ha;this.sCe=La;this.O6g=lb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Kec();this.O2j=Vb;this.tCe=new ba(100);
this.abk=Fa.a.mF(1,5,new Pa.a)}w0e(G){this.FMe.addHandler("OnCpuMeterFrameAvailable",G)}ccj(G){this.FMe.removeHandler("OnCpuMeterFrameAvailable",G)}Tob(G,ha,La,lb=null){La=lb?lb.priority:7;const Vb=this.cA();this.start(ha,La);try{G()}finally{this.stop(ha,lb),G=this.cA()-Vb,this.O6g.track(G,ha)}}ie(G,ha){const La=this.cA();try{G()}finally{G=this.cA()-La,this.sCe.pDa(G,ha),0<this.Gzb&&this.tCe.pDa(G,ha),this.O6g.track(G,ha)}}dZf(G){const ha=new sa;ha.TN=G.mOf;ha.TP=G.priority;this.w7i(1,ha)}Qfc(G){this.Jod|=
G}start(G,ha){if(!this.Gzb){this.tCe.reset();const La=this.PEi(G);La&&this.z4d(1);this.l_=new sa;this.l_.TN=G;this.l_.TP=ha;this.l_.ST=(new Date).toISOString();this.l_.STS=Y.a.zV(this.cA(),2);La?this.l_.UI=1:this.eRm(G)?this.l_.UI=2:this.l_.UI=0}this.Gzb++}z4d(G){this.dXb|=G}CGd(G=!0,ha=0){this.dXb=G?0:this.dXb&~ha}stop(G,ha=null){let La;this.Gzb--;0>=this.Gzb&&this.l_&&(La=this.cA()-this.l_.STS,this.Bwd+=La,this.xKe.pDa(La,G),this.PEi(G)&&this.CGd(!1,1),this.l_.TRT=Y.a.zV(La,2),ha&&(this.l_.TQT=
Y.a.zV(ha.eOn,2),this.l_.TDT=Y.a.zV(ha.cGi,2)),this.O2j&&(this.w7i(0,this.l_),this.I5n()),this.Gzb=0);0<=G.indexOf(oa.a.MRo)&&this.Qfc(2);0<=G.indexOf(oa.a.tdj)&&this.Qfc(4);1===(this.dXb&1)&&this.Qfc(1);2===(this.dXb&2)&&this.Qfc(8)}I5n(){var G=this.l_.TRT;if(750<G){let La=this.tCe.getData();if(La){const lb={};for(let Vb in La){var ha=La[Vb];const tc=Vb;tc.startsWith("SiOp_")||tc.endsWith("[it]")||(lb[tc]=Math.round(100*ha.T/G))}La=lb}G=Object.assign(new ua,{B:this.l_.STS,T:G,S:La});this.abk.track(G,
this.l_.TN)}}XAo(){var G=this.cA()-this.Whh,ha=Y.a.zV(this.Bwd/G*100,2);G=new ma;G.CP=ha;G.II=this.Jod;ha=this.xKe.getData();aa.a.count(ha)&&(G.LRT=ha);ha=this.sCe.getData();aa.a.count(ha)&&(G.FP=ha);this.FMe.raiseEvent("OnCpuMeterFrameAvailable",new ea(G));this.Nvj()}Nvj(){this.xKe.reset();this.sCe.reset();this.Bwd=this.Gzb=0;this.Whh=this.cA();this.Jod=0;this.l_=null}run(){this.bfh?this.XAo():(this.Nvj(),this.bfh=!0);this.Gta?this.Gta(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,
this.run,"run"),1E3)}SBd(G,ha,La){const lb=Array(2);lb[0]=ha;lb[1]=La;this.$yd[G]||(this.$yd[G]=[]);this.$yd[G].push(lb)}w7i(G,ha){G=this.$yd[G];if(!Na.a.af(G))for(let lb=0;lb<G.length;lb++){var La=G[lb];const Vb=La[0];La=La[1];Vb&&!Vb(ha)||La(ha)}}Kec(){if(!this.Lxc){const G=window.setTimeout;this.Gta=(ha,La)=>G(ha,La);this.Lxc=!0}}PEi(G){return G.startsWith("key")||G.startsWith("input")}eRm(G){return G.startsWith("click")||G.startsWith("mouse")||G.startsWith("pointer")}}Object(e.a)(Aa,"CpuMeter",
null,[139]);class za{constructor(G){this.ltc=null;this.jq=new z.a;this.cA=G}initialize(G,ha,La,lb=!1){this.ltc||(this.ltc=new Aa(this.cA,G,ha,La,lb),this.jq.Dg(this.ltc));return this.ltc}}Object(e.a)(za,"CpuMeterProvider",null,[1956]);var xa=c(171);class ka{constructor(G=1){this.HD=[];this.pkd=[];this.$j=G}IEl(){let G=0;for(let ha=0;ha<this.HD.length;ha++)this.HD[ha]<this.HD[G]&&(G=ha);return G}pDa(G,ha){G=Y.a.zV(G,2);if(this.HD.length<this.$j)Array.add(this.HD,G),Array.add(this.pkd,ha);else{var La=
this.IEl();G>this.HD[La]&&(this.HD[La]=G,this.pkd[La]=ha)}}getData(){return this.HD.length?{["Vals"]:this.HD,["Desc"]:this.pkd}:null}reset(){this.HD=[];this.pkd=[]}}Object(e.a)(ka,"MaxDataAggregator",null,[1081]);var wa=c(40),ia=c(22);class va{get name(){return"Common.App.CpuMeter"}wc(G){G.register(za,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Ud(()=>new za(wa.a.$e));G.register(O,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Ud(()=>
new O)}init(){const G=l.AFrameworkApplication.K;if(G.$("CpuMeterIsEnabled")){const ha=ia.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");xa.a.instance.pDd.continueWith(()=>{va.kBm(G,ha)})}}dispose(){}static kBm(G,ha){const La=Fa.a.mF(10,5,new ba(G.nc("TaskManagerLoggingThreshold",0),G.nc("CpuMeterMaximumEntriesToLog",0)));ha=ha.initialize(new ka(5),new ba,La,G.$("CPUMeterExposeTaskDetailsIsEnabled"));G.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(ha.run(),G.$("CpuMeterMonitorIsEnabled")&&
ia.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ha,G.wU("CpuMeterAverageCpuPercentThreshold",80),G.nc("CpuMeterRollingAverageFramesCount",15)));K.b(16827671,306,50,"Initializing CpuMeter")}static main(){M.a.instance.Gc(new va)}}Object(e.a)(va,"CpuMeterPackage",null,[1,2]);var na=c(7),Ca=c(86),ta=c(1092),fa=c(1070),Xa=c(20),ob=c(1426);class xb{constructor(){this.Mta=this.brc=null;this.Y1b=!0;this.Wxc=!1}wc(G){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&G.register(1856,
"Common.IEventTimingMeter").ha().Ud(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var G=new fa.a(l.AFrameworkApplication.K.nc("EventTimingMeterEventSamplingPercent",0)/100);G=new ta.a(Object(a.a)(G,G.UQb,"shouldBeInSample"));const ha=Fa.a.mF(16,1,G);this.Mta=new ob.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.wU("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.wU("AshaVetoForTypingThresholdPercentile",
95),this.Y1b);(this.Wxc=!Xa.a.Y4a)&&l.AFrameworkApplication.rI(()=>{this.g8e()});this.brc=La=>{La=La.rawEvent.detail;for(const lb of La)ha.track(lb,"EventTimingData"),"false"!==lb.metadata.altPressed.toString()||"false"!==lb.metadata.ctrlPressed.toString()||"false"!==lb.metadata.repeat.toString()||"CharacterKey"!==lb.metadata.key.toString()&&"Space"!==lb.metadata.key.toString()||!this.Wxc||this.Mta.cza(lb.timeToRequestAnimationFrameMs)};T.a.addHandler(window.self,U.a.Fsh,this.brc)}dispose(){this.brc&&
(T.a.removeHandler(window.self,U.a.Fsh,this.brc),this.brc=null)}g8e(){this.Mta.KTa();this.Mta.R_i&&(na.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ca.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){M.a.instance.Gc(new xb)}}Object(e.a)(xb,"EventTimingMeterPackage",null,[1,2]);var zb=c(75),Lb=c(69),Ia=c(35);class Ya{constructor(G,ha,La,lb=null,Vb=null){this.hM=G;this.Cvb=ha;this.$vc=La;this.Jbh=
lb;this.CBc=Vb}$jf(G){const ha=new Sys.StringBuilder(this.hM.u8c);ha.append("RoamingServiceHandler.ashx?action=");ha.append("getFirstRunExperienceSettings");ha.append("&");ha.append(this.iuf(G));ha.append("&");ha.append(l.AFrameworkApplication.em);l.AFrameworkApplication.He.nj(ha.toString(),1,null,null,!0,2,Object(a.a)(this,this.h3a,"getRequestSuccessCallback"),Object(a.a)(this,this.Soa,"getRequestFailureCallback"),null)}VNd(G){var ha=new Sys.StringBuilder(this.hM.u8c);ha.append("RoamingServiceHandler.ashx?action=");
ha.append("saveFirstRunExperienceSettings");ha.append("&");ha.append(l.AFrameworkApplication.em);ha=ha.toString();G=Ia.c(G);l.AFrameworkApplication.He.nj(ha,2,G,null,!0,4,Object(a.a)(this,this.hGn,"postRequestSuccessCallback"),Object(a.a)(this,this.gIa,"postRequestFailureCallback"),null)}h3a(G){let ha=!1,La=null;try{if(0<G.data.te.length){const lb=Object(Lb.a)(Object,Ia.a(G.data.te)),Vb=lb?lb[this.hM.d2e]:null;Vb&&(La=Object(Lb.a)(Object,Ia.a(Vb.toString())))}ha=!0}catch(lb){this.Soa(null)}ha&&this.Cvb&&
this.Cvb(G.data,La)}Soa(G){this.$vc&&this.$vc(G?G.data:null)}hGn(G){this.Jbh&&this.Jbh(G?G.data:null)}gIa(G){this.CBc&&this.CBc(G?G.data:null)}iuf(G){const ha=new Sys.StringBuilder("requestedsettings=");for(let La=0;La<G.count;La++)ha.append(G.J(La)),La<G.count-1&&ha.append(";");return ha.toString()}}Object(e.a)(Ya,"FirstRunExperienceRequestHandler",null,[]);var eb=c(267);class sb{constructor(){this.Jvc=this.hmd=this.hM=null}uxo(G){G?(this.hM=G,this.bRm()&&(na.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
G=new zb.a,G.add(this.hM.d2e),this.hmd=new Ya(this.hM,Object(a.a)(this,this.h3a,"getRequestSuccessCallback"),Object(a.a)(this,this.Soa,"getRequestFailureCallback"),null,Object(a.a)(this,this.gIa,"postRequestFailureCallback")),this.hmd.$jf(G)),(this.hM.fEi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Chg()):na.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}bRm(){try{if(this.hM.fEi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.hM.ALm||this.hM.oec||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const G=l.AFrameworkApplication.K.kb("FlightId");return-1!==(G?G.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(G){na.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",G?G.toString():null)}return!1}yhj(G){const ha={},La={};La.FREDisplayedDate=(new Date).toUTCString();La.VersionDisplayed=G;La.RemindMeLater=!1;ha[this.hM.d2e]=
Ia.c(La);na.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.hmd&&this.hmd.VNd(ha)}h3a(G,ha){G=G?+G.cU-+G.bI:-1;G>this.hM.pgj?na.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",G,this.hM.pgj):ha?this.kwo(ha)?(na.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.hM.JPi),this.Chg()):(this.rgf(!1),na.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(na.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Chg())}Soa(G){this.rgf(!1);na.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",G?G.Ne:-1)}gIa(G){na.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
G?G.Ne:-1)}Chg(){this.rgf(!0);var G=ia.a.instance.Oa("Common.ISystemInitiatedFeedback");G?this.Dsj(G):(na.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((G=ia.a.instance.Sa("Common.ISystemInitiatedFeedback"))?G.execute(ha=>{this.Dsj(ha)}):na.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Dsj(G){if(G){var ha=this.hM.lHl;
ha&&(l.AFrameworkApplication.eo(ha),l.AFrameworkApplication.Ria(ha));na.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ha);G.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Jvc=Object(a.a)(this,this.dpn,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Jvc,!0),window.addEventListener("FRELaunchedEvent",this.Jvc,!0)):(na.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.yhj(this.hM.currentVersion))}else na.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}dpn(G){if(G){var ha=G.detail;G=G.type;var La=this.hM&&this.hM.HBh?this.hM.HBh.split("-")[0]:null;if("FRELaunchedEvent"===G||La&&ha&&ha.id&&-1!==ha.id.indexOf(La))ha.success&&(na.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.yhj(this.hM.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.Jvc,
!0),window.removeEventListener("FRELaunchedEvent",this.Jvc,!0))}}kwo(G){if("RemindMeLater"in G&&"FREDisplayedDate"in G){if("true"===G.RemindMeLater.toString()&&(+new Date-+new Date(G.FREDisplayedDate.toString()))/36E5>this.hM.JPi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in G&&G.VersionDisplayed<this.hM.currentVersion)return na.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}rgf(G){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
eb.a.dispatch("FREDecisionEvent",{["show"]:G})}}Object(e.a)(sb,"FirstRunExperienceLauncher",null,[1846]);class lc{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(G){this.W=G;this.W.register(1846,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Ud(()=>new sb)}init(){}dispose(){}static main(){M.a.instance.Gc(new lc)}}Object(e.a)(lc,"FirstRunExperienceLauncherPackage",null,[1,2]);class vb{constructor(){this.y=this.x=0}}Object(e.a)(vb,"HammerPoint",
null,[]);class Eb{constructor(G,ha,La,lb,Vb){this.S4g=this.UXa=this.xod=1;this.hAd=this.XEc=this.n_a=0;this.RLe=this.YKa=null;this.$sb=this.FBe=this.Wud=!1;this.wj=G;this.ANa=ha;this.Qdb=La;this.ga=lb;Vb&&(this.Wud=Vb.$("PromoteLayerPinchToZoomIsEnabled"),this.FBe=Vb.$("FinalizeWithInitialPinchScaleIsEnabled"),this.$sb=Vb.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get HL(){return this.ANa}get Nbg(){return this.Qdb}nOm(){return!!this.wj.instance}Bpn(G){this.ga&&this.ga.processAction(n.a.$vj,2);
const ha=this.wj.instance;this.Wud&&ha.l7i();this.UXa=ha.oj;this.xod=G.uPc.scale;this.S4g=1;this.RLe=this.nBh();this.YKa=this.ANa.getBounds();if(!this.YKa)return na.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;G=this.efi(G);this.$sb?this.knj(this.ANa.scrollWidth,this.YKa.width,G,this.UXa,ha):this.n_a=this.ANa.scrollWidth>this.YKa.width?this.eIc(this.Qdb.scrollLeft,G.x,this.UXa):null;this.hAd=this.ANa.scrollHeight>this.YKa.height?this.eIc(this.Qdb.scrollTop,G.y,this.UXa):null;return!0}C$f(){this.n_a=
null;this.XEc=0}knj(G,ha,La,lb,Vb){G>ha?this.n_a?(G=Vb.rLf,G!==this.XEc&&(this.n_a-=this.XEc-G,this.XEc=G)):(this.n_a=this.eIc(this.Qdb.scrollLeft,La.x,lb),this.XEc=Vb.rLf):this.C$f()}Apn(G){const ha=this.efi(G);if(!ha)return na.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;G=this.pjo(G.uPc.scale/this.xod)*this.UXa;this.l_o(ha,G);this.m_o(ha,G);return!0}l_o(G,ha){const La=this.ANa.scrollWidth,lb=this.YKa.width;this.$sb?this.knj(La,lb,G,ha,this.wj.instance):!this.n_a&&La>lb&&
(this.n_a=this.eIc(this.Qdb.scrollLeft,G.x,ha));if(G=this.vBh(G.x,this.n_a,La,lb,ha))this.Qdb.scrollLeft=G}m_o(G,ha){const La=this.ANa.scrollHeight,lb=this.YKa.height;!this.hAd&&La>lb&&(this.hAd=this.eIc(this.Qdb.scrollTop,G.y,ha));if(G=this.vBh(G.y,this.hAd,La,lb,ha))this.Qdb.scrollTop=G}vBh(G,ha,La,lb,Vb){return La<=lb||!ha||!lb?null:Math.max(0,Math.min(ha*Vb-G,La-lb))}eIc(G,ha,La){return(G+ha)/La}zpn(G){G=G.uPc.scale;this.FBe&&(G/=this.xod);this.b0h(G);this.Wud&&this.wj.instance.Q5f();this.ga&&
this.ga.processAction(n.a.Hif,2);this.$sb&&this.C$f()}ypn(G){G=G.uPc.scale;this.FBe&&(G/=this.xod);this.b0h(G,!0);this.Wud&&this.wj.instance.Q5f();this.ga&&this.ga.processAction(n.a.Hif,2);this.$sb&&this.C$f()}pjo(G){const ha=this.wj.instance,La=new Date>=this.RLe;La&&(this.RLe=this.nBh());Math.abs(G-this.S4g)>=.01*G&&ha.lqo(G*this.UXa,La);return ha.oj/this.UXa}b0h(G,ha=!1){G*=this.UXa;this.wj.instance.Bfg(G,!1);const La={};La.initialScale=this.UXa;La.finalScale=G;La.cancelled=ha;na.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",La)}efi(G){return(G=G.uPc.center)&&this.YKa?Object.assign(new vb,{x:G.x-this.YKa.x,y:G.y-this.YKa.y}):null}nBh(){const G=(new Date).getTime();return new Date(G+1E3)}}Object(e.a)(Eb,"PinchZoomAdapter",null,[1928]);class Ua{constructor(G){this._element=G}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Ua,"ScrollContainerElement",null,[1907]);
var Ta=c(134);class Nb{constructor(G,ha,La,lb,Vb,tc){this.BUe=this.xbb=null;this.W=G;this.je=ha;this.Ipd=La;this.M2g=lb;this.C9j=Vb;this.JXb=tc;this.ajd=new zb.a}register(G,ha){this.Ipd&&(4===l.AFrameworkApplication.ta.Kb.xk&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Ta.a.get_instance().pk(8,()=>{this.$ej(G,ha)}):this.$ej(G,ha))}$ej(G,ha){this.W.Sa("Common.IGestureInputManager").execute(La=>{this.PDo();this.xbb=La;this.ajd.add(G);
if(this.M2g){if(this.C9j&&0!==La.n_l()){this.Gwj();return}var lb=this.W.Sa("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const Vb=new Ua(G);lb=new Eb(lb,Vb,ha,l.AFrameworkApplication.va,l.AFrameworkApplication.K);La.NWn(G,lb)}this.Gwj()})}unregister(){if(this.xbb&&this.ajd){if(this.M2g){for(let G of this.ajd)this.xbb.oTo(G);this.ajd.clear()}this.xbb=null}}PDo(){this.JXb&&(this.je?this.BUe=this.je.Yf("Task","Register"):na.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}Gwj(){this.JXb&&
(this.BUe?this.BUe.stop():na.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Nb,"GestureInputRegistrar",null,[1855]);class Wa{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInput"}init(){this.Zh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Zh=!0)}dispose(){}wc(G){this.W=G;G.register(1855,"Common.IGestureInputRegistrar").ha().Ud(()=>new Nb(G,l.AFrameworkApplication.ta.Kq,l.AFrameworkApplication.AXc(),l.AFrameworkApplication.JBi(),
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){M.a.instance.Gc(new Wa)}}Object(e.a)(Wa,"GestureInputPackage",null,[1,2]);var Bb=c(407),Ob=c(83);class hc{constructor(){this.bpb=this.O4h=null}}Object(e.a)(hc,"GestureAdapterInfo",null,[]);var Gc=c(635),bc=c(295);class Dc{constructor(){this.pub=null}MMf(){if(!this.pub){var G="hammer.min.js";l.AFrameworkApplication.K.rw("IsServerFlavorDebug")&&
(G=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");G=l.AFrameworkApplication.Sz(String.format("{0}",G),5);G=bc.a.create(G,null,null);Gc.a.UX(G);this.pub=G.A5a}return this.pub}static get instance(){Dc._instance||(Dc._instance=new Dc);return Dc._instance}}Dc._instance=null;Object(e.a)(Dc,"HammerJsDependencyLoader",null,[1927]);const Ub=(G,ha,La=null)=>{if(void 0===ha||null===ha)throw na.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let lb=null;switch(G){case U.a.pinch:lb=new Hammer.Pinch(La);break;case U.a.pan:lb=new Hammer.Pan(La)}lb&&(lb.manager=ha);return lb};var Fc;(function(G){G[G.none=-1]="none";G[G.pinch=0]="pinch";G[G.pan=1]="pan";G[G.swipe=2]="swipe"})(Fc||(Fc={}));Object(e.b)("GestureEvent",Fc);var Sa=c(72);class wb extends Sa.a{constructor(G,ha,La,lb,Vb,tc,Nc,hd){super(G,La,lb,tc);this.ysc=ha;this.RZa=Nc;this.Jsa=hd;this.q4j=Vb}get shiftKey(){return this.RZa}get ctrlKey(){return this.Jsa}get clientPoint(){return this.ysc}get uPc(){return this.q4j}static create(G,
ha,La,lb,Vb,tc){if(La.rawEvent)if(tc){var Nc=La.rawEvent;Nc=new Sys.UI.Point(Nc.clientX,Nc.clientY)}else Nc=Sa.a.WQd(La);else Nc=new Sys.UI.Point(La.clientX,La.clientY);return new wb(G,Nc,ha,La,lb,Vb,La.shiftKey,La.ctrlKey,tc)}}Object(e.a)(wb,"GestureEventArgs",Sa.a,[]);class Tb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(Tb,"GestureManagerData",null,[]);class Hb{}Hb.$Rj=2;Hb.aSj=4;Hb.bSj=8;Hb.cSj=8;Object(e.a)(Hb,"HammerConstants",null,[]);var $a=c(94),ab=c(115),rb=c(19),cb=c(105);class rc extends T.a{constructor(G,ha){super();this.kMa=Bb.a.qMl;this.QOe=!!window.PointerEvent;this.gkh=window.hasOwnProperty("ontouchstart");this.wvb=this.wAc=null;this.XLa=
!1;this.jma=new Ob.a;this.ABc=new Ob.a;this.rXg=new zb.a;this.Cab=null;this.fVb=this.JXb=this.SOg=this.Zve=this.lKe=this.Wdh=this.iPg=this.dFc=!1;this.yzc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.CUe=null;this.ng=$a.EventHandlerManager.instance;this.QOe?(na.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.wAc=Object(a.a)(this,this.A8d,"onPointerEvent"),this.wvb=U.a.sMl):this.gkh?(na.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.wAc=Object(a.a)(this,
this.iob,"onTouchEvent"),this.wvb=U.a.touchEvents):(na.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.wAc=Object(a.a)(this,this.m8d,"onMouseEvent"),this.wvb=U.a.rMl);this.je=ha;this.U2=G;l.AFrameworkApplication.K&&(this.dFc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.iPg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.Wdh=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.lKe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Zve=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.SOg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.JXb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.fVb=this.dFc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}n_l(){return this.QOe?0:this.gkh?1:2}nv(G){super.nv(G);this.ng.jGa(this.wvb,G,0,this.wAc)}hv(G){super.hv(G);
this.ng.o1a(G,this.wvb)}NWn(G,ha){l.AFrameworkApplication.AXc()?Dc.instance.MMf().continueWith(La=>{this.ODo();if(La.Gi||La.Ho)na.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",La.status);else{na.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",La.status);if(this.SOg){La=window.Hammer;if("undefined"===typeof La){na.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Ike();return}if("undefined"===typeof La.inputHandler){na.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.Ike();return}}if(!G)throw this.Ike(),Error.argumentNull("source element can not be null");La=ab.a.Eb(G,this.kMa);if(void 0===La||null===La)La=new Ob.a,ab.a.Sl(G,this.kMa,La),this.OWn(G);if(!La.nb(Fc[0])){var lb=Object.assign(new hc,{bpb:Ub(Fc[0],this,null),O4h:ha});La.add(Fc[0],lb)}}this.Ike()}):na.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}ODo(){this.JXb&&(this.je?this.CUe=this.je.Yf("Task",
"RegisterGestureAdapterAfterLoad"):na.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Ike(){this.JXb&&(this.CUe?this.CUe.stop():na.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}oTo(G){na.ULS.sendTraceTag(42256223,310,G?100:10,"source element {0} ",G.id);const ha=ab.a.Eb(G,this.kMa);void 0!==ha&&null!==ha&&(ha.remove(Fc[0]),ha.count||(ab.a.wV(G,this.kMa),this.curRecognizer=null,this.pTo(G)))}OWn(G){this.rXg.add(G);this.ng.jGa(this.wvb,G,
0,this.wAc)}pTo(G){this.rXg.remove(G);this.ng.o1a(G,this.wvb)}recognize(G){var ha=Array(G.pointers.length);for(var La=0;La<G.pointers.length;La++)ha[La]=G.pointers[La].target;La=null;for(this.Cab=this.F4l(ha);void 0!==this.Cab&&null!==this.Cab&&(La=ab.a.Eb(this.Cab,this.kMa),void 0===La||null===La);this.Cab=this.Cab.parentNode);if(void 0!==La&&null!==La){this.curRecognizer&&this.curRecognizer.state===Hb.cSj&&(this.curRecognizer=null);ha=La.keys;for(let lb of ha){ha=La.J(lb);void 0!==ha&&null!==ha&&
void 0!==ha.bpb&&null!==ha.bpb&&(void 0===this.curRecognizer||null===this.curRecognizer||ha.bpb===this.curRecognizer||ha.bpb.canRecognizeWith(this.curRecognizer))&&ha.bpb.recognize(G);const Vb=ha.bpb.state;this.curRecognizer||Hb.$Rj!==Vb&&Hb.aSj!==Vb&&Hb.bSj!==Vb||(this.curRecognizer=ha.bpb)}}}emit(G,ha){if("hammer.input"!==G){this.XLa=!1;ha=wb.create(G,this.Cab,ha.srcEvent,ha,3,this.QOe);var La=ab.a.Eb(this.Cab,this.kMa);if(this.ZSm(G))var lb=0;else if(this.wSm(G))lb=1;else if(this.rWm(G))lb=2;else{na.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:La}=La.Fc(Fc[lb]));void 0!==La&&null!==La&&((La=La.O4h,La.nOm())?G.endsWith("start")?this.XLa=La.Bpn(ha):G.endsWith("end")?(La.zpn(ha),this.XLa=!0):G.endsWith("cancel")?(La.ypn(ha),this.XLa=!0):G.endsWith("move")&&(this.XLa=La.Apn(ha)):na.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",G))}}get(G){return Object(Lb.a)(Hammer.Recognizer,G)}F4l(G){if(1>G.length)return null;if(1===G.length)return G[0];
var ha=G[0],La=!0;for(let lb=1;lb<G.length;lb++){if(!G[lb])return null;if(ha!==G[lb]){La=!1;break}}if(La)return ha;ha=this.s5h(G[0]);La=0;for(const lb of G){G=this.s5h(lb);if(ha.J(ha.count-1)!==G.J(G.count-1))return null;for(let Vb=ha.count-2,tc=G.count-2;Vb>=La&&0<=tc;Vb--,tc--)if(ha.J(Vb)!==G.J(tc)){La=Vb+1;break}}return ha.J(La)}s5h(G){const ha=new zb.a;for(;void 0!==G&&null!==G;G=G.parentNode)ha.add(G);return ha}ibi(G){switch(G){case U.a.cQ:case U.a.RBb:return 1;case U.a.bQ:case U.a.M5e:return 2;
case U.a.jK:case U.a.SBb:return 4;case U.a.Wme:case U.a.L5e:return 8}return 0}iob(G,ha,La){G=this.ibi(G);ha=this.Q1l(La);Hammer.inputHandler(this,G,ha);this.XLa&&La.preventDefault();return this.XLa}nni(){return 1<this.jma.count}DFd(){na.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.dFc)for(let G of this.jma)this.gbj(G.key);else this.jma=new Ob.a;this.session=null}uuk(G,ha,La){na.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",G);if(!this.ABc.nb(G)){try{ha.setPointerCapture(G)}catch(lb){na.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",lb)}this.ABc.add(G,ha)}this.jma.Z(G,La);this.fVb&&1<this.jma.count&&this.U2&&!this.U2.oIc&&(this.U2.oIc=!0)}gbj(G){na.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",G);if(this.ABc.nb(G)){try{this.ABc.J(G).releasePointerCapture(G)}catch(ha){na.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ha)}this.ABc.remove(G)}else na.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",G);this.jma.remove(G);this.fVb&&
1>=this.jma.count&&this.U2&&this.U2.oIc&&(this.U2.oIc=!1)}A8d(G,ha,La){var lb=La.rawEvent.pointerType.toString();const Vb=La.rawEvent.pointerId.toString();if("touch"!==lb)return!1;G=this.ibi(G);if(1!==G&&!this.jma.nb(Vb))return!1;this.iPg&&1===G&&La.rawEvent.isPrimary&&this.jma.count&&(na.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.DFd());this.dFc?this.uuk(Vb,ha,La):this.jma.Z(Vb,La);this.lKe&&2===G&&(!this.Zve||this.Zve&&"function"===typeof La.rawEvent.getCoalescedEvents)&&
(ha=La.rawEvent.getCoalescedEvents())&&this.nni()&&(this.yzc=Math.max(this.yzc,ha.length));this.Wdh&&(this.XLa=!1);lb=this.P1l(this.jma,La,lb);Hammer.inputHandler(this,G,lb);if(4===G||8===G)this.dFc?this.gbj(Vb):this.jma.remove(Vb),this.jma.count||(this.session=null,this.lKe&&-1!==this.yzc&&(na.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.yzc),this.yzc=-1));this.XLa&&La.preventDefault();return this.XLa}m8d(){return!1}Q1l(G){const ha=new Tb;var La=G.rawEvent;const lb=
La.touches;La=La.changedTouches;ha.pointers=Array.clone(lb);ha.pointers=Array.clone(0<lb.length?lb:La);ha.changedPointers=Array.clone(La);ha.srcEvent=G;ha.pointerType="touch";return ha}P1l(G,ha,La){const lb=new Tb;lb.pointers=cb.toArray(G.values);lb.changedPointers=[ha];lb.pointerType=La;lb.srcEvent=ha;return lb}ZSm(G){return rb.a.startsWith(G,U.a.pinch)}wSm(G){return rb.a.startsWith(G,U.a.pan)}rWm(G){return rb.a.startsWith(G,U.a.swipe)}}Object(e.a)(rc,"GestureInputManager",T.a,[1889,1890]);var Rb=
c(302);class fb{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInputManager"}wc(G){G.register(rc,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Ud(()=>new rc(Rb.a.instance,l.AFrameworkApplication.ta.Kq));this.W=G}init(){this.Zh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Zh=!0)}dispose(){}static main(){M.a.instance.Gc(new fb)}}Object(e.a)(fb,"GestureInputManagerPackage",null,[1,2]);var Pb=c(250),Ec=c(46),
uc=c(1581);class ya{constructor(G,ha,La){this.WSe=this.VSe=null;this.t0b=new z.a;this.Zf=G;this.oAc=La;this.Pma=ha.appSettings[ya.d5o]||""}get Mro(){return this.t0b.task}get SQ(){return this.Zf.value}l6n(){const G={};G[ya.Wrm]=l.AFrameworkApplication.em;G["Content-Type"]="application/json; charset=utf-8";na.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ha=Ec.a.fp(this.Pma+ya.Nro,ya.Akn,l.AFrameworkApplication.ta.Kb.xk.toString());this.SQ.nj(ha,
1,"",G,!0,2,Object(a.a)(this,this.YMb,"onSuccessCallback"),Object(a.a)(this,this.HMb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}n7m(G){try{const ha={};ha.FlightName=G.FlightName;ha.SessionID=G.SessionID;na.ULS.sendTraceTag(594883776,215,50,Ia.c(ha))}catch(ha){na.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}YMb(G){if((G=G.data.te)&&G.length)try{const ha=Ia.a(G);this.VSe=ha.NavBarDataJson;na.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.VSe?({Gt:this.WSe}=Ia.d(ha.NavBarDataJson)).returnValue?(this.n7m(this.WSe),this.t0b.Dg(this.WSe)):(na.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:uc.a.$cd(this.VSe)}),this.t0b.kea()):(na.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.t0b.kea())}catch(ha){na.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.t0b.kea()}else na.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}HMb(){this.t0b.kea();
na.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return ya._instance||(ya._instance=ya.LFb())}static LFb(){return new ya(new Pb.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Kb.xk)}}ya.Wrm="X-qs";ya.Akn="at";ya.Nro="O365ShellServiceProxy.ashx";ya._instance=null;ya.d5o="ShellWebServiceBase";Object(e.a)(ya,"O365ShellActor",null,[1887]);class db{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}wc(G){this.W=
G;this.W.register(ya,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Ud(()=>new ya(new Pb.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Kb.xk))}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){l.AFrameworkApplication.grg&&l.AFrameworkApplication.ta.Kb.NJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").l6n()}dispose(){}static main(){M.a.instance.Gc(new db)}}Object(e.a)(db,
"PackageManager",null,[1,2]);class tb{rSa(){}init(){}dispose(){}}Object(e.a)(tb,"NoOpOfflineLogger",null,[1920,10]);var Xb=c(799);class $b{}$b.nDd=0;Object(e.a)($b,"OfflineLoggerConstants",null,[]);var Ab=c(93),vc=c(251),Sc=c(308);class ed{constructor(G,ha,La,lb,Vb,tc,Nc,hd){this.oKe=this.ozc=null;this.cYa=!1;this.t7=null;this.ytc=this.VYb=this.cub=0;this.VI=this.Acb=this.jid=this.Ztd=this.CQ=null;this.km=!1;this.eCa=La;this.SCa=lb;this.FCa=Vb;this.Zf=ha;this.Ib=G;this.fXa=tc;this.Rwb=!1;this.qMa=
hd;Nc?(this.jid=new ed(G,ha,La,lb,Vb,tc,!1,hd),this.jid.Ztd=this,this.ozc="OfflineLoggerManifest|"+this.fXa,this.oKe="OfflineLog|"+this.fXa+"|"):(this.ozc="OfflineLoggerManifest",this.oKe="OfflineLog|")}init(){this.Nfg();this.q3m();this.cYa=!1;this.Zf.D2b(this);this.CQ=new Ab.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.CQ);this.jid&&this.jid.init()}SHc(G){return this.oKe+G}q3m(){const G=this.eCa.getItem(this.ozc);void 0!==G&&null!==G&&0<G.length&&(this.t7=
ed.idd(G));this.t7||(this.t7={});if(void 0===this.t7.end||null===this.t7.end)this.t7.end=0;if(void 0===this.t7.offset||null===this.t7.offset)this.t7.offset=0;this.cub=this.t7.offset;isFinite(this.cub)||(this.cub=0);this.VYb=this.t7.end;isFinite(this.VYb)||(this.VYb=0);this.ytc=this.VYb}Nfg(){this.Acb=new Sc.a;this.VI=new vc.a;this.Ztd||(this.SCa.jrh(Object(a.a)(this,this.tZf,"onUlsReadyToBeSent")),this.SCa.Mrh(Object(a.a)(this,this.vZf,"onUlsSentSuccessfully")),this.SCa.Lrh(Object(a.a)(this,this.uZf,
"onUlsSentFailed")));this.SCa.arh(Object(a.a)(this,this.yVf,"onAfterUlsHostDisposed"))}tZf(G,ha){if(void 0!==ha&&null!==ha&&void 0!==ha.args&&null!==ha.args){G=!1;if(!this.Acb.nb(ha.args.tag)){if(!this.Acb.nb($b.nDd))return;G=!0}this.Acb.remove(G?$b.nDd:ha.args.tag);this.VI.nb(ha.uploadId)||this.VI.Z(ha.uploadId,new zb.a);this.VI.J(ha.uploadId).add(ha.args)}}vZf(G,ha){this.VI.remove(ha.uploadId);this.qMa&&this.Rwb&&(this.Rwb=!1,this.ZEh())}uZf(G,ha){this.Rwb=!0;if(void 0!==ha&&null!==ha&&this.VI.nb(ha.uploadId)){G=
!0;var La=this.VI.J(ha.uploadId);for(let lb of La)La=ed.serialize(lb,this.FCa),La=this.jdd(this.SHc(this.ytc++),La),this.qMa&&!La&&(G=!1);this.qMa&&G&&this.VI.remove(ha.uploadId)}}yVf(){this.dispose()}jdd(G,ha){try{return this.eCa.setItem(G,ha),!0}catch(La){return this.qMa||na.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",La.message),!1}}sendOfflineLogs(){if(!this.cYa){for(var G=this.cub,ha=new zb.a,La=null;G<this.VYb&&5>=ha.count;++G){var lb=this.SHc(G);const Vb=
this.eCa.getItem(lb);this.eCa.removeItem(lb);if(void 0===Vb||null===Vb)continue;const tc=({sessionId:lb}=ed.deserialize(Vb)).returnValue;if(tc){if(!La)La=lb;else if(lb!==La)break;ha.add(tc)}else na.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Vb)}0<ha.count&&this.SCa.Aej(this,cb.toArray(ha),La);this.cub=G;G>=this.VYb&&this.IEb()}}ZEh(){this.IEb();this.CQ=new Ab.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.CQ)}rSa(G,ha,La){!this.km&&
na.ULS.R$(ha,La)&&(this.Ztd?this.Ztd.rSa(G,ha,La):this.Acb.Z(G,!0))}dispose(){if(!this.km){this.CQ&&this.Ib.ff(this.CQ);var G=cb.toArray(this.VI.keys);G.sort();for(const ha of G){G=this.VI.J(ha);for(let La of G)G=ed.serialize(La,this.FCa),this.jdd(this.SHc(this.ytc++),G)}this.cub<this.ytc?(this.t7.end=this.ytc,this.t7.offset=this.cub,this.jdd(this.ozc,JSON.stringify(this.t7))):this.eCa.removeItem(this.ozc)}this.km=!0}b6a(){this.cYa=!0}ZLb(){this.cYa=!1;this.qMa&&this.ZEh()}IEb(){this.CQ&&(this.Ib.ff(this.CQ),
this.CQ=null)}static serialize(G,ha){const La={};La.t=G.tag;La.c=G.category;La.l=G.level;La.m=G.message;La.lt=G.logType;La.s=ha;La.ts=G.timestamp;La.o=G.isMinified;La.a=G.args;return JSON.stringify(La)}static deserialize(G){return(G=ed.idd(G))?{returnValue:new Xb.a(G.ts,G.c,G.t,G.l,G.m,G.lt,G.o,G.a),sessionId:G.s}:{returnValue:null,sessionId:null}}static idd(G){try{return JSON.parse(G)}catch(ha){na.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",ha.message)}return null}}
Object(e.a)(ed,"OfflineLoggerImpl",null,[1920,10,158]);class pd{constructor(G,ha,La,lb){this.sessionId=G;this.version=ha;this.gEd=La;this.b_f=lb;this.qLb=new zb.a}}Object(e.a)(pd,"CachedLogUpload",null,[]);class oc{constructor(G){G.name&&(this.n=G.name);G.stack&&(this.s=G.stack);G.message&&(this.m=G.message);G.file&&(this.f=G.file);null!=G.line&&(this.l=G.line);null!=G.column&&(this.c=G.column)}}Object(e.a)(oc,"LoggingExceptionArgsLocalStorage",null,[]);class cd{constructor(G){this.t=G.tag;this.c=
G.category;this.l=G.level;this.m=G.message;this.lt=G.logType;this.ts=G.timestamp;this.o=G.isMinified;this.a=G.args;G.exceptionArgs&&(this.e=new oc(G.exceptionArgs))}}Object(e.a)(cd,"LoggingArgsLocalStorage",null,[]);var Xc=c(483);class ic{constructor(G,ha,La,lb,Vb,tc,Nc){this.t=G;this.m=ha;this.s=La;this.v=lb;this.i=Vb;this.a=tc;this.d=Nc;this.op="Log"}}Object(e.a)(ic,"LoggingKeyLocalStorage",null,[]);var Ac=c(139);const wd=(G,ha,La,lb,Vb)=>!(void 0===G||null===G)&&!(void 0===G.i||null===G.i)&&!(void 0===
G.t||null===G.t)&&!(void 0===G.s||null===G.s)&&"Log"===G.op&&G.t===ha&&isFinite(G.t)&&Ac.a.isValid(G.s)&&(void 0===G.m||null===G.m||G.m===La)&&(!Vb||void 0===G.d||null===G.d||G.d===lb);class Je{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd,we,Ce){this.cYa=this.z6g=this.m6g=this.n6g=!1;this.VI=this.Acb=this.t7=this.CQ=null;this.km=!1;this.Ewb=[];this.PYb=[];this.eCa=La;this.SCa=lb;this.FCa=Vb;this.Zf=ha;this.Ib=G;this.oAc=tc;this.rMe=Nc;this.feh=hd;this.xYa=fd;this.Hak=sd;this.MHe=Kd;this.fXa=Nd;
this.$0g=we;this.Rwb=!1;this.qMa=Ce}get manifest(){return this.t7}get z_c(){return this.Acb}get fHa(){return this.VI}init(){this.Nfg();this.cYa=!1;this.Zf.D2b(this);this.CQ=new Ab.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Ib.Wb(this.CQ)}determineLogsToSendAtBoot(){this.DSh(!0)}determineLogsToSendOnReconnect(){this.DSh(!1)}DSh(G){this.IEb();this.Ewb=[];G&&(this.PYb=[]);for(var ha=0;ha<this.eCa.length;ha++){const La=this.eCa.key(ha),lb=Je.vDj(La,
!1);wd(lb,this.oAc,this.rMe,this.fXa,this.$0g)&&(lb.s===this.FCa?Array.add(this.Ewb,La):G&&Array.add(this.PYb,La))}if(this.Ewb.length||G&&this.PYb.length)if(ha=this.MHe?Object(a.a)(this,this.aBo,"sortDescendKeysToUpload"):Object(a.a)(this,this.dBo,"sortKeysToUpload"),this.Ewb.sort(ha),G&&this.PYb.sort(ha),0<this.Ewb.length||0<this.PYb.length)this.CQ=new Ab.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Ib.Wb(this.CQ)}dBo(G){return G.s!==G.s?G.s.localeCompare(G.s):G.i-
G.i}aBo(G){return G.s!==G.s?G.s.localeCompare(G.s):G.i-G.i}SHc(G,ha,La,lb){G=new ic(this.oAc,this.rMe,ha,La,G,lb,this.fXa);return JSON.stringify(G)}Nfg(){this.Acb=new Sc.a;this.VI=new vc.a;this.SCa.jrh(Object(a.a)(this,this.tZf,"onUlsReadyToBeSent"));this.SCa.Mrh(Object(a.a)(this,this.vZf,"onUlsSentSuccessfully"));this.SCa.Lrh(Object(a.a)(this,this.uZf,"onUlsSentFailed"));this.SCa.arh(Object(a.a)(this,this.yVf,"onAfterUlsHostDisposed"))}tZf(G,ha){if(void 0!==ha&&null!==ha&&void 0!==ha.args&&null!==
ha.args){if(this.z_c.nb(ha.args.tag))this.z_c.remove(ha.args.tag);else if(this.z_c.nb($b.nDd))this.z_c.remove($b.nDd);else if(!(this.Hak&&50>ha.args.level))return;({value:G}=this.fHa.Fc(ha.uploadId)).returnValue||(G=new pd(ha.sessionId,ha.version,ha.gEd,ha.b_f),this.fHa.Z(ha.uploadId,G));this.fHa.J(ha.uploadId).qLb.add(ha.args)}}vZf(G,ha){this.fHa.remove(ha.uploadId);this.qMa&&this.Rwb&&(this.Rwb=!1,this.$Eh())}uZf(G,ha){this.Rwb=!0;void 0!==ha&&null!==ha&&this.fHa.nb(ha.uploadId)&&this.gQi(ha.uploadId)&&
!this.z6g&&(this.z6g=!0,this.qMa||na.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}gQi(G){let ha=!1;if(({value:lb}=this.fHa.Fc(G)).returnValue&&lb&&0<lb.qLb.count){if(lb.gEd>=this.xYa)return this.qMa&&this.fHa.remove(G),!1;var La=lb.qLb;const Vb=Array(La.count);for(let tc=0,Nc=La.count;tc<Nc;++tc)Vb[tc]=new cd(La.J(tc));La=Je.serialize(Vb);var lb=this.SHc(lb.b_f,lb.sessionId,lb.version,lb.gEd);this.jdd(lb,La)&&(this.fHa.remove(G),ha=!0)}return ha}yVf(){this.dispose()}jdd(G,ha){try{return this.eCa.setItem(G,
ha),!0}catch(La){return this.qMa||na.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",La.message),!1}}sendOfflineLogs(){if(!this.cYa){var G=0<this.Ewb.length?this.Ewb:this.PYb,ha=G.length;if(ha)for(;0<ha;){l.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");ha--;var La=this.MHe?G.pop():G[0];this.MHe||Array.removeAt(G,0);const tc=Je.vDj(La,!0);if(wd(tc,this.oAc,this.rMe,this.fXa,this.$0g)){var lb=this.eCa.getItem(La);
this.eCa.removeItem(La);if(void 0!==lb&&null!==lb)if(tc.a>this.xYa)na.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",tc.a,this.xYa);else if(La=Je.idd(lb,!0),void 0!==La&&null!==La&&isFinite(La.length))if(La.length){lb=La[La.length-1];var Vb=(new Date).getTime()-lb.ts;if(Vb<-Je.$zj)na.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",lb.ts);else if(Vb>this.feh*Je.$zj)na.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.feh,lb.ts);else{tc.s===this.FCa?this.n6g||(this.n6g=!0,na.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.m6g||(this.m6g=!0,na.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",tc.s));ha=Array(La.length);for(lb=0;lb<La.length;lb++){G=lb;a:{Vb=La[lb];if(void 0===Vb||null===Vb){Vb=null;break a}let Nc=null;Vb.e&&(Nc=new Xc.a(null),Nc.name=
Vb.e.n,Nc.stack=Vb.e.s,Nc.message=Vb.e.m,Nc.file=Vb.e.f,Nc.line=Vb.e.l,Nc.column=Vb.e.c);Vb=new Xb.a(Vb.ts,Vb.c,Vb.t,Vb.l,Vb.m,Vb.lt,Vb.o,Vb.a,Nc)}ha[G]=Vb}this.SCa.Aej(this,ha,tc.s,tc.v,tc.a+1,tc.i);break}}else na.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",lb);else na.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",lb)}}else this.IEb()}}$Eh(){this.IEb();this.CQ=new Ab.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,
"determineLogsToSendOnReconnect"),102);this.Ib.Wb(this.CQ)}rSa(G,ha,La){!this.km&&na.ULS.R$(ha,La)&&this.z_c.Z(G,!0)}dispose(){if(!this.km){this.CQ&&this.Ib.ff(this.CQ);var G=cb.toArray(this.fHa.keys);for(const ha of G)this.gQi(ha)}this.km=!0}b6a(){this.cYa=!0;this.IEb()}ZLb(){this.cYa=!1;this.$Eh()}IEb(){this.CQ&&(this.Ib.ff(this.CQ),this.CQ=null)}static serialize(G){return JSON.stringify(G)}static vDj(G,ha){(G=Je.idd(G,ha))&&void 0===G.d&&(G=new ic(G.t,G.m,G.s,G.v,G.i,G.a,0));return G}static idd(G,
ha){try{return JSON.parse(G)}catch(La){ha&&na.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",La.message)}return null}}Je.$zj=864E5;Object(e.a)(Je,"OfflineLoggerImplV2",null,[1920,10,158]);class Zd{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(G){return this.handleError("Length",G),-1}}key(G){try{return localStorage.key(G)}catch(ha){return this.handleError("Key",ha),null}}getItem(G){try{return localStorage.getItem(G)}catch(ha){return this.handleError("GetItem",
ha),null}}setItem(G,ha){try{return localStorage.setItem(G,ha)}catch(La){return this.handleError("SetItem",La),null}}removeItem(G){try{localStorage.removeItem(G)}catch(ha){this.handleError("RemoveItem",ha)}}clear(){try{localStorage.clear()}catch(G){this.handleError("Clear",G)}}handleError(){}}Object(e.a)(Zd,"OfflineStorage",null,[1919]);class le{create(G){var ha=null;try{void 0!==localStorage&&null!==localStorage&&(ha=new Zd)}catch(lb){na.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",
lb.message)}Object.getType(na.ULS.host).implementsInterface(1170)&&ha||(na.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ha?"supported":"not supported",Object.getType(na.ULS.host).implementsInterface(1170)?"supported":"not supported"),G=0);const La=l.AFrameworkApplication.K;1===G?ha=new ed(l.AFrameworkApplication.lc,l.AFrameworkApplication.He,ha,na.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.XPh,La.$("OfflineLoggerDataBoundarySupportIsEnabled"),
La.$("OfflineLoggerMemoryOptimizationIsEnabled")):2===G?(G=l.AFrameworkApplication.ta.Kb,ha=new Je(l.AFrameworkApplication.lc,l.AFrameworkApplication.He,ha,na.ULS.host,l.AFrameworkApplication.userSessionId,G.xk,G.aja,La.nc("OfflineLoggerRetentionInDays",30),La.nc("OfflineLoggerMaxAttempts",5),La.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),La.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.XPh,La.$("OfflineLoggerDataBoundarySupportIsEnabled"),La.$("OfflineLoggerMemoryOptimizationIsEnabled"))):
ha=new tb;ha.init();return ha}}Object(e.a)(le,"OfflineLoggerFactory",null,[]);class kc{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const G=l.AFrameworkApplication.K;let ha=0;G.$("OneNoteOfflineLoggerIsEnabled")?ha=1:G.$("OfflineLoggerV2IsEnabled")&&(ha=2);0!==ha&&(l.AFrameworkApplication.Fmg=(new le).create(ha))}dispose(){}}Object(e.a)(kc,"OfflineLoggerPackage",null,[1,2]);var kd=c(43),nd=c(1397);class Ud{constructor(G){this.cNi=null;na.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.e0c=l.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.P9=G)||na.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.e0c&&this.e0c.length||na.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}yCl(G){G&&(this.e0c="https://dcg-df.microsoft.com/",na.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.xCl()}xCl(){na.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.cNi)na.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.cNi=new Date;var G=new Date;this.P9.RV("BayBridge",this.e0c).then(ha=>{const La=+new Date-+G;ha.IsSuccess?(na.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",La),this.oCl(ha.Token,this.IOl())):na.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
La,ha.ErrorCode,ha.ErrorMessage)}).catch(ha=>{na.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ha,+new Date-+G)})}}oCl(G,ha){const La={};La.Authorization="Bearer "+G;La["Authorization-Type"]="AAD";La.Accept="application/json";La["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.He.nj(ha,1,null,La,!1,2,Object(a.a)(this,this.Pfm,"getStatusSucceeded"),Object(a.a)(this,this.Nfm,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");kd.a("FetchAccountLinkedStatus")}OQl(){const G=nd.a.instance.getItem("AccountLinkedStatusCache");return G&&G.length?"true"===G.toLowerCase()?!0:!1:!1}IOl(){return this.e0c+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Nfm(){na.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Pfm(G){na.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");G=Ia.a(G.data.te).state+"";nd.a.instance.setItem("AccountLinkedStatusCache",
G)}}Object(e.a)(Ud,"PhoneLinkManager",null,[1851]);class Qd{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}wc(G){this.W=G;this.W.register(1851,"Common.App.PhoneLink.IPhoneLinkManager").ha().Ud(()=>new Ud(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.T3a()})}T3a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){M.a.instance.Gc(new Qd)}}Object(e.a)(Qd,"PhoneLinkPackage",null,[1,2]);const Gd=G=>{try{return Ia.a(G)}catch(ha){}return null};
class of{constructor(G,ha,La,lb,Vb,tc){this.a_=!1;this.Kl=null;this.COe=!1;this.ga=G;this.Zf=ha;this.Vk=La;this.y5g=lb;this.Ca=Vb;this.lak=tc}init(G,ha){ha&&G.Sa("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.c4e,"awaitRtc"))}c4e(G){const ha=G.hRc();ha.continueWith(()=>{this.Kl=ha.result;this.COe&&(this.Kl.qN(2,null,!0),this.COe=!1);this.Kl.V3((La,lb)=>{2===lb.type&&this.oc.processAction(n.a.fileNameUpdate,2)});this.Kl.Kua((La,lb)=>{2===lb.newState&&this.oc.processAction(n.a.fileNameUpdate,
2)});2===this.Kl.connectionState&&this.oc.processAction(n.a.fileNameUpdate,2)})}EPa(G){this.kZh(G,!0)}kZh(G,ha){const La=this.dPk(G.ruj),lb={};lb[of.JJh]=of.KJh;this.pej.nj(La,2,"",lb,!1,2,Object(a.a)(this,this.khc,"onRefreshFilenameSuccess"),ha?Object(a.a)(this,this.ztn,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.YXi,"onRefreshFilenameFailureNoRetry"),G)}khc(G){this.a_=!1;const ha=Gd(G.data.te);G.data.state.onSuccess(ha,this.y5g.value)}ztn(G){5!==G.data.status||this.a_?this.YXi(G):(this.a_=
!0,this.kZh(G.data.state,!1))}YXi(G){G.data.state.onFailure(-1)}PEb(G){this.lZh(G,!0)}lZh(G,ha){const La=this.ePk(),lb={};lb[of.JJh]=of.KJh;lb[of.Urm]=rb.a.Gj(G.wej);lb[of.Srm]=this.lak.value.y0k;this.pej.nj(La,2,"",lb,!1,2,Object(a.a)(this,this.P2c,"onRenameFileSuccess"),ha?Object(a.a)(this,this.Ftn,"onRenameFileFailureRetry"):Object(a.a)(this,this.$Xi,"onRenameFileFailureNoRetry"),G)}ePk(){return this.Jzh()}dPk(G){let ha=this.Jzh();return ha=Ec.a.fp(ha,of.Yrm,G?"2":"1")}Jzh(){let G=(this.Ca.value.appSettings.RenameWebServiceBase||
"")+of.Trm;G=Ec.a.fp(G,of.Vrm,rb.a.Gj(l.AFrameworkApplication.em));this.Sm&&this.Sm.tFf&&(G=Ec.a.fp(G,of.Xrm,"1"));return G}P2c(G){this.a_=!1;const ha=Gd(G.data.te);G.data.state.onSuccess(ha,this.y5g.value);this.JSi()}JSi(){this.Kl?this.Kl.qN(2,null,!0):this.COe=!0}Ftn(G){5!==G.data.status||this.a_?this.$Xi(G):(this.a_=!0,this.lZh(G.data.state,!1))}$Xi(G){G.data.state.onFailure(-1)}get oc(){return this.ga.value}get pej(){return this.Zf.value}get Sm(){return this.Vk.value}static get instance(){return of._instance||
(of._instance=of.LFb())}static LFb(){return new of(new Pb.a(()=>l.AFrameworkApplication.va),new Pb.a(()=>l.AFrameworkApplication.He),new Pb.a(()=>l.AFrameworkApplication.Sm),new Pb.a(()=>ia.a.instance.resolve("Postmessage.IHostPostmessenger")),new Pb.a(()=>l.AFrameworkApplication.K),new Pb.a(()=>ia.a.instance.resolve("Common.IRenameProps")))}}of.JJh="Content-Type";of.KJh="application/json; charset=utf-8";of.Trm="renamehandler.ashx";of.Vrm="qs";of.Urm="n";of.Xrm="sl";of.Srm="X-CoauthLockId";of.Yrm=
"u";of._instance=null;Object(e.a)(of,"ExecuteRenameFileHandler",null,[]);class Tf{constructor(){this.onFailure=this.onSuccess=null;this.ruj=!1}}Object(e.a)(Tf,"ExecuteRefreshFilenameData",null,[]);class uh{constructor(){this.onFailure=this.onSuccess=this.wej=null}}Object(e.a)(uh,"ExecuteRenameFileData",null,[]);class Gh{constructor(){this.W=null;this.gBe=of.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(G){this.W=G}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.$x,
"onFullAppSettingsReady"))}$x(){l.AFrameworkApplication.jYc()&&(of.instance.init(this.W,l.AFrameworkApplication.o7c),l.AFrameworkApplication.PEb=Object(a.a)(this,this.PEb,"executeRenameFile"),l.AFrameworkApplication.EPa=Object(a.a)(this,this.EPa,"executeRefreshFilename"),l.AFrameworkApplication.l9c=Object(a.a)(this,this.l9c,"sendFileNameAndLocationUpdateNotification"))}PEb(G,ha,La){const lb=new uh;lb.wej=G;lb.onSuccess=ha;lb.onFailure=La;this.gBe.PEb(lb)}EPa(G,ha,La){const lb=new Tf;lb.onSuccess=
G;lb.onFailure=ha;lb.ruj=La;this.gBe.EPa(lb)}l9c(){this.gBe.JSi()}dispose(){}}Object(e.a)(Gh,"PackageManager",null,[1,2]);var Dh=c(182);class lg{constructor(G,ha,La){this.Phg=this.Qhg=this.Rhg=!1;this.gig=!G&&!ha;this.hig=!G&&!La;this.gig||this.hig||(this.Rhg=!G,this.Qhg=!ha,this.Phg=!La)}}Object(e.a)(lg,"RenameDisabledDialogInfo",null,[]);class xh extends Dh.StandardDialog{constructor(G,ha,La,lb,Vb){super();this.nmg=[];this.Cfa=new lg(G,ha,La);this.Heb=lb;this.jcb=Vb;this.zg="RenameDisabledDialog";
this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose);this.npo();this.S3n()}npo(){this.Cfa.gig?this.sad(this.Heb?this.jcb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Cfa.hig?this.sad(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Stk();this.UFc(this.nmg)}sad(G){Array.add(this.nmg,G)}Stk(){const G=[];this.Cfa.Rhg||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.Cfa.Qhg||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Cfa.Phg||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<G.length&&Array.add(this.nmg,G)}}Object(e.a)(xh,"ReactRenameDisabledDialogBase",Dh.StandardDialog,[]);class eg extends xh{constructor(G,ha,La,lb,Vb){super(G,ha,La,lb,Vb)}S3n(){this.anb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(eg,"ReactRenameDisabledDialog",xh,[]);class cc{static get Vg(){return k.a.Nx(cc.Wm,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}cc.Wm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(cc,"RenameDisabledDialogHtml",null,[]);class Ic extends k.a{constructor(G,ha,La,lb,Vb){super();this.Cfa=new lg(G,ha,La);this.Heb=lb;this.jcb=Vb;this.zg="RenameDisabledDialog";this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose);this.Vg=cc.Vg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.M5("RenameRow")}V9(){if(this.Cfa.gig){let G;G=this.Heb?this.jcb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Ic.sad(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),G)}else this.Cfa.hig?Ic.sad(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.pvm()}pvm(){this.Cfa.Rhg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Cfa.Qhg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Cfa.Phg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static sad(G,ha,La){G.style.display="none";ha.innerText=La}}Object(e.a)(Ic,"RenameDisabledDialog",k.a,[]);class Yc{constructor(G,ha){this.mxb=0;this.ga=G;this.qLa=ha}initialize(G){if(!this.ga||!this.qLa)return!1;this.mxb=G;this.Ub();return!0}Ub(){this.ga.qa(n.a.U9e,y.a.frame,Object(a.a)(this,this.U9e,"commitNewDocumentTitle"))}U9e(G,ha,La,lb,Vb){if(1===La)return this.ga.processAction(n.a.renameFile,
1);G=rb.a.yJ(this.qLa.yz);Vb=(0,Vb.getNewDocumentTitle)();Vb.length>this.mxb&&(Vb=Vb.substr(0,this.mxb));if(32!==this.ga.Qb(n.a.renameFile,2,Vb))return this.cpc(G),8;this.cpc(Vb);return 32}cpc(G){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(G))}static fm(){return new Yc(l.AFrameworkApplication.va,l.AFrameworkApplication.Js)}}Object(e.a)(Yc,"ReactRenameUIHandler",null,[1921]);var ad=c(219),yd=c(1084),ne=c(537),Oe=c(102),nf=c(164),wf=c(30);class Ye{constructor(G,ha,La,lb,Vb,tc,Nc,hd,
fd,sd,Kd,Nd){this._initialized=!1;this._element=null;this.mxb=0;this.tSe=this.EEe=!1;this.ga=G;this.dla=ha;this.ge=La;this.Bs=lb;this.qLa=Vb;this.ifh=tc;this.Rwd=Nc;this.swe=hd;this.Gbb=fd;this.D2g=sd;this.wi=Kd;this.kGe=Nd}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(G,ha,La){if(!(this.ga&&this.qLa&&this.ifh&&this.Rwd&&this.swe&&ha)||0>=G)return!1;this._element=ha;this._element.title=La;this._element.setAttribute(wf.a.uh,wf.a.Z3);this._element.setAttribute("Unselectable",
"on");this.mxb=G;this.fC();return this._initialized=!0}fC(){this.dla&&(this.dla.ob(U.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.dla.ob(U.a.paste,this._element,Object(a.a)(this,this.G2c,"onPaste")));this.ge.ob(U.a.gi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Bs.ob(U.a.pointerDown,this._element,Object(a.a)(this,this.fD,"onPointerDown"));this.Bs.ob(U.a.kN,this._element,Object(a.a)(this,this.Eya,"onPointerUp"))}onBlur(){this.isActive&&!this.EEe&&(this.D2g||
this.swe(this._element),this.KHh(),this.eef(!1));return this.EEe=!1}G2c(){na.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(G){return this.isActive?this.Pqn(G):this.Qqn(G)}Pqn(G){let ha=!1;switch(G.Hb.keyCode){case Sys.UI.Key.enter:this.KHh();this.eef(this.wi||this.kGe);ha=!0;break;case Sys.UI.Key.tab:this.D2g&&this.swe(this._element);break;case Sys.UI.Key.esc:this.U$f(),this.eef(this.wi||this.kGe),ha=!0}return ha}Qqn(G){let ha=!1;switch(G.Hb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.yCj(this.kGe),
this.isActive&&this.Rwd(this._element),ha=!0}return ha}fD(){this.isActive||(this.yCj(!1),this.isActive&&(this._element.focus(),this.Rwd(this._element),this.tSe=!0));return!1}Eya(){return this.tSe?(this.Rwd(this._element),this.tSe=!1,!0):!1}Pdc(){return 32===this.ga.processAction(n.a.renameFile,1)}KHh(){const G=rb.a.yJ(this.qLa.yz);let ha=this._element.innerText.trim();ha.length>this.mxb&&(ha=ha.substr(0,this.mxb));ha!==G&&""!==ha?32!==this.ga.Qb(n.a.renameFile,2,ha)?this.U$f():this.cpc(ha):this.U$f()}U$f(){this.cpc(rb.a.yJ(this.qLa.yz))}cpc(G){this._initialized&&
(this._element.innerText=G,this.ifh())}yCj(G){this.Pdc()?this.isActive||(G&&(this.EEe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(wf.a.uh,wf.a.jwh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,ad.CuiHelper.YVh),this.Gbb&&this.Gbb.execute(ha=>{ha.o7i(!0)}),G&&this._element.focus(),na.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(n.a.omc,
2)}eef(G){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(wf.a.uh,wf.a.Z3);Sys.UI.DomElement.removeCssClass(this._element,ad.CuiHelper.YVh);this.Gbb&&this.Gbb.execute(ha=>{ha.o7i(!1)});G&&(this._element.blur(),this._element.focus())}static Aza(){yd.a.Aza(l.AFrameworkApplication.isRtl)}static fm(){return new Ye(l.AFrameworkApplication.va,ne.a.instance,Oe.KeyInputManager.instance,nf.a.instance,l.AFrameworkApplication.Js,Ye.Aza,
wa.a.hdo,wa.a.AFh,ia.a.instance.Sa("Common.App.Header.HeaderEventSource"),Xa.a.X4,Xa.a.vi,Xa.a.Dj)}}Object(e.a)(Ye,"RenameUIHandler",null,[1921]);class Rg{static get instance(){return l.AFrameworkApplication.ta.Kb.NJ?Rg._instance||(Rg._instance=Yc.fm()):Rg._instance||(Rg._instance=Ye.fm())}}Rg._instance=null;Object(e.a)(Rg,"RenameUIHandlerFactory",null,[]);var Db=c(154);class Zb{constructor(){this.DTf=this.shn=this.xhl=null}}Object(e.a)(Zb,"RenameMruEntryProperties",null,[]);var xc=c(166),Jd=c(87),
ie=c(1580),De;(function(G){G[G.unknown=-1]="unknown";G[G.success=0]="success";G[G.renameInvalidFileName=1]="renameInvalidFileName";G[G.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";G[G.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";G[G.permissionDenied=4]="permissionDenied";G[G.serverCommunicationFailure=5]="serverCommunicationFailure";G[G.fileNameTooLong=6]="fileNameTooLong"})(De||(De={}));Object(e.b)("CommonOperationResult",De);class qf{constructor(G,ha,La,lb,Vb,tc,
Nc,hd,fd,sd,Kd,Nd){this.W2g=G;this.ga=ha;this.Vk=La;this.cM=lb;this.Wwb=Vb;this.Lok=tc;this.Heb=Nc;this.glh=hd;this.uhk=fd;this.jcb=sd;this.Ca=Kd;this.thk=Nd}Ub(){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.NJ||this.oc.qa(n.a.Lbc,y.a.frame,Object(a.a)(this,this.Lbc,"initializeRenameUIHandler"));this.oc.qa(n.a.omc,y.a.frame,Object(a.a)(this,this.omc,"showRenameDisabledDialog"));this.oc.qa(n.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.oc.fb(n.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.TUn,"refreshFilename"),64);this.oc.fb(n.a.H5d,y.a.frame,Object(a.a)(this,this.H5d,"moveToFolderCompleteByHost"),64);this.oc.qa(n.a.SLb,y.a.frame,Object(a.a)(this,this.SLb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ta&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.kP().execute(G=>{G.Gv(Jd.a.DQi);G.eC(Jd.a.DQi,qf.mRn);G.Gv(Jd.a.Vkf);G.eC(Jd.a.Vkf,qf.kRn)})}Pdc(){return 0===this.thk.qgi()?32:8}W1o(){return this.Sm?this.Heb?this.Sm.$Uh:this.Sm.r2a:!0}Lbc(){return Rg.instance.initialize(l.AFrameworkApplication.EOd,l.AFrameworkApplication.RUh,l.AFrameworkApplication.Bcj||CommonUIStrings.l_RenameFileTooltip)?32:8}omc(){const G=this.W1o(),ha=this.Lok();na.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Wwb,ha,G,this.Heb);l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.uF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new eg(this.Wwb,!ha,!G,this.Heb,this.jcb()):new Ic(this.Wwb,!ha,!G,this.Heb,this.jcb());return 32}renameFile(G,ha,La,lb,Vb){if(1===La)return this.Pdc();if(!l.AFrameworkApplication.PEb)return 8;if(8===this.Pdc())return this.oc.processAction(n.a.omc,2),8;na.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.PEb(Vb,Object(a.a)(this,
this.P2c,"onRenameFileSuccess"),Object(a.a)(this,this.Etn,"onRenameFileFailure"));l.AFrameworkApplication.Acj=!0;return 32}P2c(G,ha){G?0!==G.OperationResult?this.Ami(G.OperationResult):(this.Xeo(ha,G.NewName),this.MUo(G,Object(a.a)(l.AFrameworkApplication.ta.Kb,l.AFrameworkApplication.ta.Kb.pHj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ta.updateCommandUI(),this.uhk.bFj()):this.Ami(5)}Xeo(G,ha){const La={};La[xc.a.aDl]=
ha;G.sendMessage(Jd.a.Vkf,La)}MUo(G,ha){this.$Uo(G);l.AFrameworkApplication.DLd=G.DirectInvokeDavUrl;ha=ha(G.EditDocInClientUrl);const La=new Zb;La.DTf=this.cM.yz;La.xhl=ha;La.shn=G.EditDocInClientUrl;this.oc.Qb(n.a.Ccj,2,La)}Ami(G){switch(G){case 1:G=new Dh.StandardDialog,G.Cd=0,G.IV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.mfj()}}$Uo(G){this.cM.yz=qf.hEk(this.cM.yz,G.NewName);G.BreadcrumbFolderName&&(this.cM.breadcrumbFolderName=G.BreadcrumbFolderName);
G.BreadcrumbFolderUrl&&(this.cM.breadcrumbFolderUrl=G.BreadcrumbFolderUrl);this.glh(G.NewName)}Etn(G){const ha=new Dh.StandardDialog;ha.Cd=0;switch(G){case 1:na.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ha.lka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:na.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ha.lka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:na.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:G}),ha.lka(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.kP().execute(La=>{La.sendMessage(Jd.a.$Cl,{["FailureMessage"]:De[G]})});this.mfj()}TUn(G,ha,La){if(1===La)return this.Pdc();if(!l.AFrameworkApplication.EPa)return 8;l.AFrameworkApplication.EPa(Object(a.a)(this,this.khc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.D8d,"onRefreshFilenameFailure"),
!1);return 32}SLb(G,ha,La,lb,Vb){if(1===La)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===La){const tc={};G=l.AFrameworkApplication.cmb;ha=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");G=(!G||G&&ha)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);tc[xc.a.pGo]=G;Vb&&Vb.MoveButtonClickedTime&&(tc[xc.a.Bfn]=Vb.MoveButtonClickedTime.getTime());l.AFrameworkApplication.kP().execute(Nc=>{Nc.sendMessage(Jd.a.SLb,
tc)});if(Vb&&Vb.MoveButtonClickedTime){if(G=Db.a.wG())Vb=(new Date).getTime()-Vb.MoveButtonClickedTime.getTime(),G.set("MovePostDuration",Vb.toString());Ca.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",G)}return 32}return 8}H5d(G,ha,La,lb,Vb){if(1===La)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.Pdc():8;if(2===La){if(!l.AFrameworkApplication.l9c)return Ca.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!Vb)return Ca.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Vb[xc.a.fLm])if(Vb[xc.a.WIj])if(G=Vb[xc.a.WIj].toLowerCase(),ha=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),La=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ha&&l.AFrameworkApplication.cmb&&La){const tc={};tc[xc.a.pjc]="1";tc[xc.a.documentUrl]=G;tc[xc.a.reason]=ie.a.lbg;Ca.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.kP().execute(Nc=>{Nc.sendMessage(Jd.a.mEb,tc)})}else if(!l.AFrameworkApplication.cmb&&La)Ca.Health.instance.recordKpiSuccess("MoveToFolder",null),wa.a.vm(G,wa.a.gsa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ca.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ca.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.EPa(Object(a.a)(this,this.khc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.D8d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.l9c(),Ca.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Nvo(G,ha){return G&&ha?G!==this.cM.breadcrumbFolderName||ha!==this.cM.breadcrumbFolderUrl:!1}khc(G,ha){G&&(G.NewName!==rb.a.yJ(this.cM.yz)||this.Nvo(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl))&&this.P2c(G,ha)}D8d(){}mfj(){this.glh(rb.a.yJ(this.cM.yz))}get oc(){return this.ga.value}get Sm(){return this.Vk.value}static get instance(){return qf._instance||
(qf._instance=qf.LFb())}static LFb(){return new qf(l.AFrameworkApplication.jYc,new Pb.a(()=>l.AFrameworkApplication.va),new Pb.a(()=>l.AFrameworkApplication.Sm),l.AFrameworkApplication.Js,l.AFrameworkApplication.dqa,()=>l.AFrameworkApplication.prg,l.AFrameworkApplication.o7c,Object(a.a)(Rg.instance,Rg.instance.cpc,"updateTitle"),ia.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.qv,l.AFrameworkApplication.K,ia.a.instance.resolve("Common.IRenameProps"))}static hEk(G,
ha){G=rb.a.Oha(G);return ha+G}static mRn(G){const ha=G.Values[xc.a.gRm];na.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ha);ha?l.AFrameworkApplication.va.Qb(n.a.H5d,2,G.Values):Ca.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static kRn(G){l.AFrameworkApplication.va.Qb(n.a.renameFile,2,G.Values.NewName)}}qf._instance=null;Object(e.a)(qf,"RenameActor",null,[]);var tg=c(192),Ah=c(1403),ji=c(581),Bh=c(400);class Tj{constructor(G,
ha){this.ga=G;this.juc=ha}Ub(){this.ga.qa(n.a.aig,y.a.frame,Object(a.a)(this,this.Hyo,"showRenameDialogAction"))}Hyo(G,ha,La){G=32;if(1===La)return Bh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Fpa?8:32;2===La&&(32!==this.ga.processAction(n.a.renameFile,1)?(this.ga.processAction(n.a.omc,2),tg.a.instance.Yb(Ah.a.soa,{["Reason"]:ji.a.g3n}),G=8):32===this.ga.processAction(n.a.pmc,1)?this.ga.processAction(n.a.pmc,2):this.juc.value.create().RUa());return G}}Object(e.a)(Tj,"RenameDialogActor",
null,[1926]);class sf{constructor(G,ha,La){this.dialog=null;this.ga=G;this.cM=ha;this.obb=La}Zbm(){const G={};G.nameInputProps={["type"]:"AppInputProps",["id"]:sf.o7b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:rb.a.yJ(this.cM.yz),["maxLength"]:this.obb};return G}RUa(){const G={["id"]:"RenameDialog",["bodyControls"]:this.Zbm()};this.dialog=new k.a(!1,!1,!0);this.dialog.Cd=1;this.dialog.zg="RenameDialog";this.dialog.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.m9f,"renameDialogHandler"),
G)}m9f(G,ha){if(ha&&1===G){if(ha[sf.o7b]&&(G=rb.a.yJ(this.cM.yz),ha=(ha[sf.o7b]||"").trim(),ha!==G&&""!==ha)){this.ga.Qb(n.a.renameFile,2,ha);return}tg.a.instance.Yb(Ah.a.l7b,{["Reason"]:ji.a.O_h})}}}sf.o7b="txtDocumentName";Object(e.a)(sf,"ReactRenameDialog",null,[1932]);class vf{static get Vg(){return k.a.Nx(vf.Wm,CommonUIStrings.l_RenameDialogLabel)}}vf.Wm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(vf,"RenameDialogHtml",null,[]);class Sf extends k.a{constructor(G,ha,La){super();this.ga=G;this.cM=ha;this.obb=La;this.zg="RenameDialog";this.Vg=vf.Vg}RUa(){var G={["txtDocumentName"]:rb.a.yJ(this.cM.yz)};this.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.m9f,"renameDialogHandler"),G);G=document.getElementById(Sf.o7b);0<this.obb&&(G.maxLength=this.obb);G.focus()}m9f(G,ha){if(1===G&&(G=rb.a.yJ(this.cM.yz),ha=(ha[Sf.o7b]||"").trim(),ha!==G&&""!==ha)){this.ga.Qb(n.a.renameFile,
2,ha);return}tg.a.instance.Yb(Ah.a.l7b,{["Reason"]:ji.a.O_h})}}Sf.o7b="txtDocumentName";Object(e.a)(Sf,"RenameDialog",k.a,[1932]);class ah{constructor(G){this.qLa=null;this.obb=0;this.ga=G;this._initialized=!1}initialize(G,ha){this.qLa=G;this.obb=ha;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.uF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new sf(this.ga,this.qLa,this.obb):new Sf(this.ga,this.qLa,this.obb):null}}Object(e.a)(ah,
"RenameDialogFactory",null,[1925]);var mg=c(177),Bg=c(109);class Cg{constructor(G,ha){this.ga=G;this.Vb=ha}Ub(){this.ga.qa(n.a.pmc,y.a.frame,Object(a.a)(this,this.Iyo,"showRenameFlyoutAction"))}yTk(){return E.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ta.Kb.NJ}Iyo(G,ha,La){if(1===La)return this.yTk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Gvk(){Cg.zVm&&l.AFrameworkApplication.VG&&Bg.a.instance.Wb(new Ab.a(5,1,5E3,()=>{32===this.ga.processAction(n.a.pmc,
1)&&this.Vb&&this.Vb.currentScope.name===mg.AFrame.In&&(kd.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(n.a.pmc,2))}))}static get zVm(){Cg.bqd&&null!=Cg.bqd||(l.AFrameworkApplication.se("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Cg.bqd=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Cg.bqd}}Cg.bqd=null;Object(e.a)(Cg,"RenameFlyoutActor",
null,[1924]);class ki{constructor(G,ha,La,lb,Vb){this.y0k=null;this.Vk=Vb;this.X2g=La;this.W2g=lb;this.Nok=G;this.jcb=ha}get Sm(){return this.Vk.value}qgi(){if(!this.W2g())return 5;if(this.jcb())return 1;if(this.Sm){if(this.X2g&&!this.Sm.$Uh)return 3;if(!this.X2g&&!this.Sm.r2a)return 4}return this.Nok()?0:2}}Object(e.a)(ki,"RenameProps",null,[1910]);class Rh{constructor(G,ha,La,lb,Vb,tc){this.zs=!1;this.jJe=new Ob.a;this.EWb=ha;this.cA=La;this.BVb=lb;this.Ca=Vb;this.Dma=tc}enable(){this.zs||(this.bFj(),
this.Gjg(),this.zs=!0)}generateKey(G,ha,La){return String.format("{0}/{1}/{2}",La,G,ha)}w2l(){const G=rb.a.yJ(this.EWb().yz);return this.generateKey(this.EWb().breadcrumbFolderName,this.EWb().breadcrumbFolderUrl,G)}x2l(G,ha,La){return G&&ha?this.generateKey(G,ha,La):La}Jol(G,ha,La){return G&&G!==this.EWb().breadcrumbFolderName||ha&&ha!==this.EWb().breadcrumbFolderUrl?!0:La!==rb.a.yJ(this.EWb().yz)}bFj(){const G=this.w2l();this.jJe.Z(G,new Date)}d1f(G){this.$to(G)&&this.Fnh(G)}$to(G){const ha=this.BVb();
return ha?this.Dma&&this.Dma.Io||!ha.tFf||!l.AFrameworkApplication.EPa?(this.Jwj(G),this.zs=!1):!0:!1}YYi(G,ha,La,lb){const Vb=this.Jol(G,ha,La);G=this.x2l(G,ha,La);ha=this.jJe.Fc(G).returnValue;Vb&&!ha&&(this.Cmi(lb),na.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.ONf));Vb||this.jJe.Z(G,this.cA())}}Object(e.a)(Rh,"ARenamedFileChecker",null,[1891]);class ml extends Rh{constructor(G,ha,La,lb,Vb,tc,Nc,hd){super(G,ha,La,lb,Vb,tc);this.MK=Vb;this.shk=Nc;this.gEe=hd}get ONf(){return"RenamedFileCheckerUsingSettingsRefresh"}Gjg(){this.MK.qGc(Object(a.a)(this,
this.Ymi,"handleSettingsRefresh"))}Ymi(G,ha){ha&&ha.bMb&&ha.JTi&&(ha.VRa("BreadcrumbDocName")||ha.VRa("BreadcrumbFolderName")||ha.VRa("BreadcrumbFolderUrl")||ha.VRa("DirectInvokeDAVUrl")||ha.VRa("EditDocInClientUrl"))&&(na.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.ONf),this.d1f(ha))}Jwj(){this.MK.d9f(Object(a.a)(this,this.Ymi,"handleSettingsRefresh"))}Fnh(G){if(G&&G.bMb){const ha=G.bMb;this.YYi(ha.kb("BreadcrumbFolderName"),ha.kb("BreadcrumbFolderUrl"),ha.kb("BreadcrumbDocName"),
G)}}Cmi(G){const ha={OperationResult:0,classId:1};G=G.bMb;ha.BreadcrumbFolderName=G.kb("BreadcrumbFolderName");ha.BreadcrumbFolderUrl=G.kb("BreadcrumbFolderUrl");ha.DirectInvokeDavUrl=G.kb("DirectInvokeDAVUrl");ha.EditDocInClientUrl=G.kb("EditDocInClientUrl");G=G.kb("BreadcrumbDocName");ha.NewName=l.AFrameworkApplication.$Ld?G:rb.a.yJ(G);this.gEe.execute(La=>{this.FHm(ha,La)})}FHm(G,ha){this.shk().P2c(G,ha)}}Object(e.a)(ml,"RenamedFileCheckerUsingSettingsRefresh",Rh,[]);class el extends Rh{constructor(G,
ha,La,lb,Vb,tc,Nc,hd,fd,sd){super(G,La,lb,Vb,tc,fd);this.jCc=this.am=null;this.Gfk=ha;this.ga=Nc;this.Ib=hd;sd&&sd.execute(Kd=>{this.mZn(Kd)})}get ONf(){return"RenamedFileCheckerUsingTask"}mZn(G){this.am=G;this.am.K_a(Object(a.a)(this,this.mY,"handleVisibilityChange"))}mY(G,ha){!this.zs||0!==ha.newState&&1!==ha.newState||this.jCc||(this.Gjg(),this.d1f(this.jCc))}Gjg(){this.jCc=new Ab.a(3,2,this.Gfk(),Object(a.a)(this,this.d1f,"performRenameFileCheckTick"),89);this.Ib.Wb(this.jCc)}Jwj(G){this.Ib.ff(G)}Fnh(G){this.am&&
2===this.am.LD?this.e0n(G):l.AFrameworkApplication.EPa(Object(a.a)(this,this.khc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.D8d,"onRefreshFilenameFailure"),!0)}e0n(G){this.Ib.ff(G);this.jCc=null}khc(G){G&&this.YYi(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl,G.NewName,null)}Cmi(){this.ga.processAction(n.a.fileNameUpdate,2)}D8d(){}}Object(e.a)(el,"RenamedFileCheckerUsingTask",Rh,[]);var Kl=c(67);class ig{constructor(){this.Ca=this.W=null}get name(){return"Common.App.RenameFile"}wc(G){this.W=
G;this.Ca=l.AFrameworkApplication.K;this.W.register(Tj,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ud(()=>new Tj(l.AFrameworkApplication.va,this.W.Ve("Common.App.Rename.IRenameDialogFactory"))).ha();this.W.register(ah,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ud(()=>new ah(l.AFrameworkApplication.va)).ha();this.W.register(1891,"Common.App.Rename.IRenamedFileChecker").Ud(()=>this.wel()).ha();this.W.register(Cg,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ud(()=>
new Cg(l.AFrameworkApplication.va,Kl.FocusManager.instance())).ha()}wel(){if(this.Ca.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const G=this.W.Oa("Common.IRefreshableAppSettings");if(G&&G.qCi)return new ml(()=>G.nc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.Js,()=>new Date,()=>l.AFrameworkApplication.Sm,G,this.W.Oa("Common.ISessionStatus"),()=>qf.instance,this.W.Sa("Postmessage.IHostPostmessenger"))}return new el(()=>this.Ca.nc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ca.nc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.Js,()=>new Date,()=>l.AFrameworkApplication.Sm,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.lc,this.W.Oa("Common.ISessionStatus"),this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ca.Nn(Object(a.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){const G=l.AFrameworkApplication.ta.Kb.NJ;l.AFrameworkApplication.jYc()&&Rg.instance.initialize(l.AFrameworkApplication.EOd,
G?null:l.AFrameworkApplication.RUh,G?null:l.AFrameworkApplication.Bcj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(ki,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ud(()=>new ki(()=>l.AFrameworkApplication.prg,()=>l.AFrameworkApplication.qv,l.AFrameworkApplication.o7c,l.AFrameworkApplication.jYc,new Pb.a(()=>l.AFrameworkApplication.Sm))).ha(),qf.instance.Ub(),this.Ca.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.Js,
l.AFrameworkApplication.EOd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Ub()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Ub(),l.AFrameworkApplication.o7c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Gvk())}dispose(){}}Object(e.a)(ig,"PackageManager",null,[1,2]);class Mi{static get Vg(){return k.a.Nx(Mi.Wm,CommonUIStrings.l_SaveACopyFileName)}}Mi.Wm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(Mi,"FileNameDialogHtml",null,[]);class fh extends k.a{constructor(G,ha,La,lb){super();this.qmd=this.MLa=null;this.ga=G;this.ssa=ha;this.P1b=La;this.ye(1,CommonUIStrings.l_SaveButtonLabel);this.Vg=Mi.Vg;this.zg="FileNameDialog-SaveACopy";this.Om=lb}OEa(G,ha,La){this.qmd=G;this.MLa=La;G={["txtFileName"]:rb.a.yJ(l.AFrameworkApplication.Js.yz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ha)};this.Uh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.DOd,"fileNameDialogHandler"),
G);na.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}DOd(G,ha){1!==G?na.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=ha.txtFileName.trim(),na.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ha=rb.a.Oha(l.AFrameworkApplication.fileName),G&&""!==G&&""!==ha&&(G+=ha),this.P1b.Uza(this.qmd,this.MLa,G,this.Om))}}Object(e.a)(fh,"FileNameDialog",
k.a,[1990]);class zf{constructor(G,ha,La){this.ga=G;this.ssa=ha;this.P1b=La}create(G){return new fh(this.ga,this.ssa,this.P1b,G)}}Object(e.a)(zf,"FileNameDialogFactory",null,[1955]);class Eh extends Dh.StandardDialog{constructor(G){super();this.Cd=1;this.ye(1,CommonUIStrings.l_RetryButtonLabel);this.ye(0,CommonUIStrings.l_DialogClose);this.ga=G}MO(G){na.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.wx(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(a.a)(this,this.iag,"retryDialogHandler"))}iag(G){1===G?(na.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(n.a.xkc,2)):na.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(Eh,"RetryDialog",Dh.StandardDialog,[1953]);var tl=c(1226);class Nh{constructor(G,ha,La,lb){this.$vd=null;this.Lik=G;this.Ca=La;this.H$g=ha;this.T5g=new z.a;this.je=lb}oec(){return this.Ca.$("SaveToCloudStorageUIIsEnabled")}Oib(){return n.a.ubg}lFd(){Gc.a.tde(Object(a.a)(this,
this.Khj,"saveToCloudActionDispatcher"));Gc.a.xNc([new tl.a(n.a.ubg,y.a.frame,0)],this.H$g.x$b())}Ub(){const G=this.H$g.x$b();G?(G.F_(()=>{this.T5g.Dg(!0)}),this.lFd()):na.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}K8i(){na.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Khj(G,ha,La,lb,Vb){return ha.contextId!==y.a.frame||G!==this.Oib()?2:this.oec()?1===La?Bh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Fpa?
8:32:2===La?(this.K8i(),Vb&&Vb.FileDownloadUrl&&na.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.je&&(this.$vd=this.je.Yf("DialogShown","SaveToOneDriveReponseTime")),this.T5g.task.continueWith(()=>{this.$vd&&(this.$vd.stop(),this.$vd=null);this.Lik.start(Vb)}),32):8:8}}Object(e.a)(Nh,"SaveToCloudStorageActor",null,[1901]);class Uh extends Nh{constructor(G,ha,La,lb){super(G,ha,La,lb);this.iek=ha}oec(){return this.Ca.$("SaveACopyBrsIsEnabled")}Oib(){return n.a.xkc}lFd(){Gc.a.tde(Object(a.a)(this,
this.Khj,"saveToCloudActionDispatcher"));Gc.a.xNc([new tl.a(n.a.xkc,y.a.frame,0)],this.iek.x$b())}K8i(){l.AFrameworkApplication.se("CreateCopy_cf;CreateCopy_tf");na.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(Uh,"SaveACopyActor",Nh,[]);class ok{}ok.default=0;Object(e.a)(ok,"SaveToCloudErrorCodes",null,[]);class pj{constructor(G,ha,La,lb,Vb,tc){this.Om=null;this.Dkk=G;this.cua=ha;this.P1b=La;this.Ca=lb;this.NUb=Vb;this.uH=tc}start(G){this.Om=G;
if("SharePointOnlineConsumer"===this.Ca.kb("FileSource")){const ha=ia.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ha){ha.start(null,G);return}}this.cua.aWc?("Open From URL"===Object(Lb.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.Host)||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))&&l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?(na.ULS.sendTraceTag(508852051,
216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.P1b.Uza("root","https://onedrive.live.com",null,this.Om)):(na.ULS.sendTraceTag(6590559,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"User is signed in. We will show file picker."),this.zSk()):(na.ULS.sendTraceTag(6590560,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"User is not signed in. We will show sign in dialog."),
this.Tyo())}Tyo(){this.Dkk.create().OEa()}Ep(){this.uH().MO(ok.default)}zSk(){try{na.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let G={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.NUb||2===this.NUb)G={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId};WL.init(G);na.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(G){na.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",G,G.stack),this.Ep()}}onSuccess(G){na.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");G&&G.data&&G.data.folders&&this.P1b.Uza(G.data.folders[0].id,G.data.folders[0].urls.viewInBrowser,null,this.Om)}onFailure(G){if(G&&
G.error){if("user_canceled"===G.error.code){na.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}na.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",G.error.code,G.error.message)}else na.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Ep()}}Object(e.a)(pj,"SaveToCloudManager",null,[1902]);class Ek extends pj{constructor(G,ha,La,lb,Vb,tc,Nc){super(ha,La,lb,Vb,tc,Nc);this.l3j=G}onSuccess(G){G&&
G.data&&G.data.folders?(na.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.l3j.create(this.Om).OEa(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):(na.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Ep())}onFailure(G){G&&G.error&&"user_canceled"===G.error.code&&na.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(G)}Ep(){na.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.Ep()}}Object(e.a)(Ek,"SaveACopyManager",pj,[]);var cj=c(202);class Fi{constructor(G,ha,La,lb,Vb){this.MLa=this.Gk=this.fsc=null;this.a_=!1;this.Om=this.q_a=null;this.KXe=G;this.gZa=ha;this.uH=La;this.Yi=lb;this.je=Vb}x8a(){this.Yi&&1===this.Yi.state||(this.Gk=this.gZa(),this.Gk.message=CommonUIStrings.l_CommentProgressTooltip,this.Gk.Cd=5,this.Gk.Kt=!1,this.Gk.KL(CommonUIStrings.l_DefaultDialogTitle,null,null))}aoa(){this.Gk&&(this.Gk.close(),this.Gk=
null)}U5(){1!==l.AFrameworkApplication.ta.state&&this.uH().MO(ok.default)}QOb(){na.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");wa.a.vm(this.MLa,wa.a.gsa(3),void 0,"UploadToCloudManager.RedirectToFolder")}POb(G){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk&&(G+="&wdsvodm=true");let ha=!1,La=!1;l.AFrameworkApplication.K&&(ha=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),La=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
na.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",G,ha);if(ha&&La){na.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const lb={};lb[xc.a.pjc]="1";lb[xc.a.documentUrl]=G;l.AFrameworkApplication.kP().execute(Vb=>{Vb.sendMessage(Jd.a.mEb,lb)})}else wa.a.vm(G,wa.a.gsa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Uza(G,
ha,La=null,lb=null){na.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.je&&(this.q_a=this.je.Yf("DialogShown","SaveToOneDriveUploadTime"));this.x8a();this.MLa=ha;this.fsc=this.KXe.create(G,La,lb);this.Om=lb;this.tha()}tha(){na.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.fsc.execute(Object(a.a)(this,this.xun,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.wun,"onSaveToCloudUploadFailed"))}xun(G){this.aoa();this.a_=!1;if(G&&G.data&&G.data.te){var ha;if(({Gt:ha}=
Ia.d(G.data.te)).returnValue)if(G=ha,G.StatusCode!==cj.a.Zz&&G.StatusCode!==cj.a.m6b)na.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.U5();else{na.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"UploadToCloudManager upload success.");try{G.NewDocumentUrl&&""!==G.NewDocumentUrl?this.POb(G.NewDocumentUrl):this.QOb()}catch(La){na.ULS.sendTraceTag(37025728,216,
15,"Redirect failed with exception: {0}",La.toString())}this.c4c()}else na.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:uc.a.$cd(G.data.te)}),this.U5()}else na.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.U5()}wun(G){5!==G.data.status&&12!==G.data.status||this.a_?(na.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",G.data.status),this.aoa(),this.U5(),this.c4c()):(na.ULS.sendTraceTag(6590604,
216,10,"UploadToCloudManager failure. Retrying."),this.a_=!0,this.tha())}c4c(){this.q_a&&(this.q_a.stop(),this.q_a=null)}}Object(e.a)(Fi,"UploadToCloudManager",null,[1894]);class Yh extends Fi{constructor(G,ha,La,lb,Vb,tc){super(ha,La,lb,Vb,tc);this.ga=G}eIf(){return!!this.Om&&!!this.Om.SaveEntryPoint&&"VersionHistory"===this.Om.SaveEntryPoint.toString()}U5(){na.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.eIf()&&this.ga.Qb(n.a.Dee,2,{["FailureReason"]:"Unknown"});super.U5()}QOb(){na.ULS.sendTraceTag(7205460,
216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.eIf()&&this.ga.processAction(n.a.J7c,2);super.QOb()}POb(G){na.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",G);this.eIf()&&this.ga.processAction(n.a.J7c,2);super.POb(G)}tha(){this.Om&&"true"===this.Om.SkipSaveToHost?super.tha():32!==this.ga.processAction(n.a.RPb,1)?(na.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.tha()):this.ga.Qb(n.a.RPb,
2,[()=>{na.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Fi.prototype.tha.call(this)},()=>{na.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.U5()}])}}Object(e.a)(Yh,"SaveACopyUploadToCloudManager",Fi,[]);var rj=c(762),Pm=c(1222);class Fk{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&
this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Ub()}dispose(){}wc(G){this.W=G;this.W.register(Yh,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ud(()=>new Yh(l.AFrameworkApplication.va,G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Pm.a).create(),()=>new Eh(l.AFrameworkApplication.va),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Kq)).ha();this.W.register(zf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ud(()=>
new zf(l.AFrameworkApplication.va,l.AFrameworkApplication.ta.Kb,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.W.register(Uh,"Common.App.SaveACopy.SaveACopyActor").Ud(()=>new Uh(G.resolve("Common.App.SaveACopy.SaveACopyManager"),G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Kq)).ha();this.W.register(Ek,"Common.App.SaveACopy.SaveACopyManager").Ud(()=>new Ek(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),rj.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.L8,()=>new Eh(l.AFrameworkApplication.va))).ha()}static main(){M.a.instance.Gc(new Fk)}}Object(e.a)(Fk,"PackageManager",null,[1,2]);var Ll=c(51);class rh extends Dh.StandardDialog{constructor(G,ha){super();this.SZb=!1;this.XN=null;this.ga=G;this.pvc=ha;this.fJa=!1}MO(G,ha,La){this.XN=ha;this.SZb=La;na.ULS.sendTraceTag(8194008,
216,50,"Display error with code:{0}, overwriteTarget:{1}.",G,La);G=this.Z7e(G);0===G?(this.Cd=6,this.ye(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.ye(1,CommonUIStrings.l_DialogClose));0===G&&na.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.wx(Ll.a.Qao,this.gWl(G),this.fWl(G,ha),Object(a.a)(this,this.iag,"retryDialogHandler"),!0)}iag(G){1===G?(na.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.XN?this.ga.Qb(n.a.L8c,2,[this.XN,this.SZb]):
this.ga.processAction(n.a.L8c,2)):na.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}Z7e(G){return 0>G||6<G?(na.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",G),0):G}fWl(G,ha){G=this.Z7e(G);return this.pvc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ha),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][G]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ha),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][G]}gWl(G){G=this.Z7e(G);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_InvalidFileNameTitle][G]}}Object(e.a)(rh,"ErrorRetryDialog",Dh.StandardDialog,[2003]);class qp{constructor(G,ha){this.Ca=G;this.ga=ha;this.pvc=this.Ca.$("SaveToHostWithExtraCharsInFileName")}create(){return new rh(this.ga,this.pvc)}}Object(e.a)(qp,"ErrorRetryDialogFactory",null,[1969]);class Hi extends k.a{constructor(G,ha,La,lb,Vb,tc,Nc=null){super();this.b7=null;this.ga=ha;this.ssa=lb;this.r_a=tc;this.Ca=G;this.uH=Vb;this.Yi=La;this.pvc=this.Ca.$("SaveToHostWithExtraCharsInFileName");
this.Om=Nc;this.ye(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Yi}yTh(G,ha){this.qra(1,!!G&&G!==ha);this.b7=document.getElementById(Hi.N_h);T.a.addHandler(this.b7,"change",Object(a.a)(this,this.F7d,"onFileNameChange"));T.a.addHandler(this.b7,"input",Object(a.a)(this,this.F7d,"onFileNameChange"));this.b7.focus()}M_h(G){return this.pvc?(new RegExp("["+this.DYh('\\/:*?"<>|')+"]")).test(G):(new RegExp("["+this.DYh('\\/:*?"<>|#{}%~&')+"]")).test(G)}DYh(G){return G.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")}Cyf(){const G=rb.a.yJ(l.AFrameworkApplication.Js.yz);this.qra(1,!!this.b7&&""!==this.b7.value&&this.b7.value!==G)}F7d(){this.b7&&window.setTimeout(()=>{this.Cyf()},0)}DOd(G,ha){if(1!==G)na.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{G=ha[Hi.N_h];ha=Hi.Z_i in ha?ha[Hi.Z_i]:!1;na.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",rb.a.i9i(G),ha);const La=rb.a.Oha(l.AFrameworkApplication.fileName);
(G=G?G.trim():null)&&""!==G&&""!==La||1===this.ta.state?this.M_h(G)?this.uH.create().MO(1,G,ha):this.r_a.Uza(G+La,ha,this.Om):this.uH.create().MO(2,G,ha)}}dispose(){this.b7&&(T.a.removeHandler(this.b7,"change",Object(a.a)(this,this.F7d,"onFileNameChange")),T.a.removeHandler(this.b7,"input",Object(a.a)(this,this.F7d,"onFileNameChange")),this.b7=null);super.dispose()}}Hi.N_h="txtFileName";Hi.Z_i="chkOverwrite";Object(e.a)(Hi,"FileNameDialogBase",k.a,[]);class Gk{static get Vg(){return k.a.Nx(Gk.Wm,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Gk.Wm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Gk,"FileNameDialogHtml",null,[]);class Xn extends Hi{constructor(G,ha,La,lb,Vb,tc){super(G,ha,La,lb,Vb,tc);this.Vg=Gk.Vg;this.zg="FileNameDialog-SaveAsToHost"}OEa(G,ha){const La=rb.a.yJ(l.AFrameworkApplication.Js.yz);ha={["txtFileName"]:G||La,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ha};this.Uh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.DOd,"fileNameDialogHandler"),ha);this.yTh(G,La)}}Object(e.a)(Xn,"FileNameDialog",Hi,[2002]);class jk{constructor(G,ha,
La,lb,Vb,tc){this.ga=ha;this.Ca=G;this.ssa=lb;this.r_a=tc;this.uH=Vb;this.Yi=La}create(){return new Xn(this.Ca,this.ga,this.Yi,this.ssa,this.uH,this.r_a)}}Object(e.a)(jk,"FileNameDialogFactory",null,[1968]);class Hd{constructor(G,ha,La){this.r_a=La;this.CBe=ha;this.Ca=G}Ub(){2===l.AFrameworkApplication.ta.Kb.xk?l.AFrameworkApplication.va.fb(n.a.L8c,y.a.frame,Object(a.a)(this,this.shj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.qa(n.a.L8c,y.a.frame,Object(a.a)(this,this.shj,"saveAsToHostActionDispatcher"))}shj(G,
ha,La,lb,Vb){return ha.contextId!==y.a.frame||G!==n.a.L8c?2:this.Ca.$("SaveAsToHostBrsIsEnabled")?1===La?Bh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Fpa?8:32:2===La?(na.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),G=this.CBe.create(),Vb&&Object.getType(Vb)===Array&&2===Vb.length?G.OEa(Vb[0],!!Vb[1]):G.OEa(null,!1),32):8:8}}Object(e.a)(Hd,"SaveAsToHostActor",null,[]);class Ie{constructor(G,ha,La,lb,Vb,tc,Nc,hd){this.Gk=null;this.SZb=this.a_=
!1;this.q_a=this.Om=this.XN=null;this.Ca=ha;this.Pma=this.Ca.appSettings.SaveAsToHostWebServiceBase;this.x0g=lb;this.gZa=Vb;this.Zf=La;this.uH=tc;this.je=hd;this.Yi=Nc;this.ga=G;this.NXa=ha.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}x8a(){1!==this.Yi.state&&(this.Gk=this.gZa(),this.Gk.message=CommonUIStrings.l_CommentProgressTooltip,this.Gk.Cd=5,this.Gk.Kt=!1,this.Gk.KL(CommonUIStrings.l_DefaultDialogTitle,null,null))}U5(G=0){1!==this.Yi.state&&this.uH.create().MO(G,rb.a.yJ(this.XN),
this.SZb)}QOb(){const G=this.Ca.appSettings.BreadcrumbFolderUrl;na.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");wa.a.vm(G,wa.a.gsa(3),void 0,"UploadToHostManager.RedirectToFolder")}POb(G){let ha=!1,La=!1;this.Ca&&(ha=this.Ca.$("SaveACopyIsEnabledForUiHost"),La=this.Ca.$("UiHostSupportsDocRebootFeatures"));na.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",G,ha,La);if(ha&&La){na.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const lb={};lb[xc.a.pjc]="1";lb[xc.a.documentUrl]=G;lb[xc.a.reason]=ie.a.lbg;l.AFrameworkApplication.kP().execute(Vb=>{Vb.sendMessage(Jd.a.mEb,lb)})}else ha&&!La&&l.AFrameworkApplication.XM?wa.a.vm(G,wa.a.gsa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):wa.a.vm(G,wa.a.gsa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Uza(G,ha,La=null){na.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.x0g&&
!this.x0g()&&this.Zf&&(this.je&&(this.q_a=this.je.Yf("DialogShown","SaveAsToHostUploadTime")),this.x8a(),this.SZb=ha,this.XN=G,(this.Om=La)&&"true"===this.Om.SkipSaveToHost?this.QNd():this.tha())}tha(){32!==this.ga.processAction(n.a.RPb,1)?(na.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.QNd()):this.ga.Qb(n.a.RPb,2,[()=>{na.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.QNd()},(G,ha)=>
{na.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.U5(ha)}])}Fwn(G){this.aoa();this.a_=!1;if(G&&G.data&&G.data.te)if(({Gt:ha}=Ia.d(G.data.te)).returnValue)if(G=ha,G.StatusCode!==cj.a.Zz&&G.StatusCode!==cj.a.m6b){na.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ha={};ha.FailureReason=G.StatusCode.toString();ha.ExtraInfo=G.ExtraInfo;this.cUa(ha);this.U5(parseInt(G.ExtraInfo))}else{na.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.g$f();try{G.NewDocumentUrl&&""!==G.NewDocumentUrl?this.POb(G.NewDocumentUrl):this.QOb()}catch(La){na.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",La.toString())}this.c4c()}else na.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:uc.a.$cd(G.data.te)}),this.cUa({["FailureReason"]:"Failed to deserialize response"}),this.U5();else na.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.cUa({["FailureReason"]:"null response"}),this.U5()}Ewn(G){5!==G.data.status&&12!==G.data.status||this.a_?(na.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:G.data.status,["HttpStatus"]:G.data.Ne}),this.cUa({["FailureReason"]:G.data.Ne.toString()}),this.aoa(),this.U5(),this.c4c()):(na.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.a_=!0,this.Om&&"true"===this.Om.SkipSaveToHost?this.QNd():this.tha())}aoa(){this.Gk&&
(this.Gk.close(),this.Gk=null)}c4c(){this.q_a&&(this.q_a.stop(),this.q_a=null)}g$f(){this.Om&&"VersionHistory"===this.Om.SaveEntryPoint&&this.ga.processAction(n.a.J7c,2)}cUa(G){this.Om&&"VersionHistory"===this.Om.SaveEntryPoint&&this.ga.Qb(n.a.Dee,2,G)}QNd(){let G=this.Pma+this.NXa;G=Ec.a.fp(G,"qs",rb.a.Gj(l.AFrameworkApplication.em));G=Ec.a.fp(G,"n",rb.a.Gj((new Date).getTime().toString()));G=Ec.a.fp(G,"ov",rb.a.Gj(this.SZb.toString()));G=Ec.a.fp(G,"fn",rb.a.Gj(this.XN));this.Om&&this.Om.FileDownloadUrl&&
(G=Ec.a.fp(G,"furl",rb.a.Gj(this.Om.FileDownloadUrl)));this.Zf.nj(G,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Fwn,"onUploadFinished"),Object(a.a)(this,this.Ewn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(Ie,"UploadToHostManager",null,[1879]);class Ok{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ub()}wc(G){this.W=G;this.W.register(qp,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ud(()=>new qp(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).ha();this.W.register(Ie,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ud(()=>new Ie(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.He,()=>l.AFrameworkApplication.Qk,
()=>(new Pm.a).create(),G.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Kq)).ha();this.W.register(jk,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ud(()=>new jk(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Kb,G.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),G.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();
this.W.register(Hd,"Common.App.SaveAsToHost.SaveAsToHostActor").Ud(()=>new Hd(l.AFrameworkApplication.K,G.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),G.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){M.a.instance.Gc(new Ok)}}Object(e.a)(Ok,"SaveAsToHostPackage",null,[1,2]);class Jj extends Dh.StandardDialog{constructor(){super();this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose)}MO(G){this.wx(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Jj,"ErrorDialog",Dh.StandardDialog,[1953]);var ee=c(205);class md extends Dh.StandardDialog{constructor(G,ha,La){super();this.ga=G;this.cua=ha;this.ssa=La;this.Daa=!1;this.Cd=1;this.FV(1);this.ye(1,CommonUIStrings.l_SignIn);this.ye(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}OEa(){this.cua.Mqh(Object(a.a)(this,this.VYi,"onSignIn"));this.sv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.rDm,"inputHandler"))}rDm(G){0===
G?(na.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.$$d()}PVk(){let G="2";if(this.ssa)switch(this.ssa.xk){case 3:G="0";break;case 2:G="3";break;case 1:G="1"}return G}hide(){this.cua.T1n(Object(a.a)(this,this.VYi,"onSignIn"));super.hide()}$$d(){var G=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";G=new ee.QueryStringBuilder(G);
G.Ae("prompt","1");G.Ae("cbcxt",this.PVk());l.AFrameworkApplication.qga(G);wa.a.vm(G.toString(),"LoginWindow",void 0,"SignInDialog")}VYi(){this.Opa&&this.hide();na.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb&&1===l.AFrameworkApplication.ta.Kb.xk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(n.a.ubg,2)}}Object(e.a)(md,"SignInDialog",Dh.StandardDialog,[1912]);class nl{constructor(G,ha,La){this.ga=G;this.cua=
ha;this.ssa=La}create(){return new md(this.ga,this.cua,this.ssa)}}Object(e.a)(nl,"SignInDialogFactory",null,[1900]);class gf{constructor(G,ha,La,lb,Vb,tc,Nc){this.Pma=G;this.XN=ha;this.kXb=La;this.qmd=lb;this.PPe=Vb;this.NXa=tc;this.Om=Nc}execute(G,ha){if(!l.AFrameworkApplication.Qk&&l.AFrameworkApplication.He){var La=this.Pma+this.NXa;La=Ec.a.fp(La,"fo",rb.a.Gj(this.qmd));La=Ec.a.fp(La,"fn",rb.a.Gj(this.XN));La=Ec.a.fp(La,"qs",rb.a.Gj(this.PPe));La=Ec.a.fp(La,"n",rb.a.Gj((new Date).getTime().toString()));
this.Om&&this.Om.FileDownloadUrl&&(La=Ec.a.fp(La,"furl",rb.a.Gj(this.Om.FileDownloadUrl)));this.kXb&&(La=Ec.a.fp(La,"fnn",rb.a.Gj(this.kXb)));l.AFrameworkApplication.He.nj(La,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,G,ha,null)}}}Object(e.a)(gf,"SkyDriveUploadCaller",null,[1909]);class yh{constructor(G){this.Ca=G;this.FAb=G.appSettings.SkyDriveUploadWebServiceBase;this.XN=G.appSettings.FileName;this.NXa=G.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(G,ha,La){return new gf(this.FAb,
this.XN,ha,G,l.AFrameworkApplication.em,this.NXa,La)}}Object(e.a)(yh,"SkydriveUploadCallerFactory",null,[1897]);class Ef{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ub()}dispose(){}wc(G){this.W=G;this.W.register(nl,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ud(()=>
new nl(l.AFrameworkApplication.va,rj.a.instance,l.AFrameworkApplication.ta.Kb)).ha();this.W.register(yh,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ud(()=>new yh(l.AFrameworkApplication.K)).ha();this.W.register(Nh,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ud(()=>new Nh(G.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Kq)).ha();this.W.register(Fi,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ud(()=>new Fi(G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Pm.a).create(),()=>new Jj,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Kq)).ha();this.W.register(pj,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ud(()=>new pj(G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),rj.a.instance,G.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.L8,()=>new Jj)).ha()}static main(){M.a.instance.Gc(new Ef)}}Object(e.a)(Ef,"PackageManager",null,[1,2]);class vi extends Dh.StandardDialog{constructor(){super();this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose)}MO(G,ha){this.UTh(G,ha,Ll.a.Sao)}UTh(G,ha,La){na.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",La);this.wx(La,G,ha,null)}Bgf(G,ha){na.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.wx(Ll.a.Uao,G,ha,null,!0)}}Object(e.a)(vi,"ErrorDialog",Dh.StandardDialog,[1162]);class Ml{static get Vg(){return k.a.Nx(Ml.Wm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Ml.Wm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(Ml,"FileNameDialogHtml",null,[]);var kk=c(79);class am extends Hi{constructor(G,ha,La,lb,Vb,tc,Nc,hd){super(G,ha,La,lb,Vb,tc,hd);this.Rbb=this.XRe=this.DQ=null;this.sQk=CommonUIStrings.l_SaveToAnotherFolder;this.Vg=Ml.Vg;this.zg="FileNameDialog-SaveToSharePoint";this.TCc=Nc;this.vek=hd}OEa(G){const ha=rb.a.yJ(l.AFrameworkApplication.Js.yz),La=l.AFrameworkApplication.breadcrumbFolderName,lb=l.AFrameworkApplication.breadcrumbBrandName,Vb={["txtFileName"]:G||ha};let tc=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ta.Kb.xk&&(tc=CommonUIStrings.L_SaveACopy);this.Uh(tc,Object(a.a)(this,this.DOd,"fileNameDialogHandler"),Vb);this.yTh(G,ha);this.wff.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.DQ=document.getElementById("anotherFolder"),G=document.getElementById("folderLocation"),this.XRe=wf.a.Sth(G,this.DQ,"anotherFolderDescribedBy"),this.DQ.className=
"WACButton WACDialogButtonNormal",G=!1,La&&La.length?(this.Boh(this.DQ,this.XRe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,lb,La)),G=this.Irk(lb,La)):this.Boh(this.DQ,this.XRe,CommonUIStrings.l_CurrentOnlineFolder),this.Atk(this.DQ),this.Krk(this.DQ),G?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.DQ,"SaveToAnotherLocationTwo"),na.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.DQ,
"SaveToAnotherLocationOne"),T.a.addHandler(this.DQ,U.a.click,Object(a.a)(this,this.QYf,"onSaveToAnotherLocationClick")),T.a.addHandler(this.DQ,U.a.gi,Object(a.a)(this,this.BYi,"onSaveToAnotherLocationKeyDown")))}Irk(G,ha){let La;La=!1;const lb=document.getElementById("currentLocation");lb.innerText="";const Vb=this.$ci(lb,G),tc=this.$ci(lb,ha);let Nc=255,hd=255;255<Vb+tc&&(Nc=Math.max(238,408-Vb),hd=Math.max(170,408-tc),La=!0);this.Kvk(lb,G,hd,ha,Nc);return La}$ci(G,ha){const La=document.createElement("div");
La.innerText=ha;La.style.visibility="hidden";G.appendChild(La);ha=La.clientWidth;G.removeChild(La);return ha}Kvk(G,ha,La,lb,Vb){ha&&(this.Aoh(G,ha,La),this.Cvk(G));lb&&this.Aoh(G,lb,Vb)}Aoh(G,ha,La){const lb=document.createElement("div");lb.innerText=ha;lb.title=ha;lb.className="SaveToAnotherFolderBreadcrumb";lb.style.maxWidth=La.toString()+"px";G.appendChild(lb)}Cvk(G){const ha=document.createElement("span");ha.id="FolderSeparator";const La=document.createElementNS("http://www.w3.org/2000/svg","svg");
La.setAttribute("class","SeparatorCaret");const lb=document.createElementNS("http://www.w3.org/2000/svg","polygon");lb.setAttribute("points","1 4 1 11 5 7.5");La.appendChild(lb);ha.appendChild(La);G.appendChild(ha)}Boh(G,ha,La){La=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,La);ha&&(ha.innerText=La);G.tabIndex=0;G.setAttribute(wf.a.uh,wf.a.Z3)}Krk(G){const ha=document.createElement("span");ha.id="anotherFolderText";ha.innerText=this.sQk;ha.className="AnotherFolderTextSpan";
G.appendChild(ha)}Atk(G){const ha=document.createElement("span");ha.className="cui-img-cont-float cui-img-16by16 ";this.Rbb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Rbb.setAttribute("class","FolderIconSVG");const La=document.createElementNS("http://www.w3.org/2000/svg","path");La.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Rbb.appendChild(La);ha.appendChild(this.Rbb);G.appendChild(ha)}BYi(G){!G||
G.keyCode!==kk.a.Rs&&G.keyCode!==kk.a.spe||this.QYf(G)}QYf(){if(this.b7){const G=rb.a.Oha(l.AFrameworkApplication.fileName);let ha=this.b7.value;this.hide();ha&&""!==ha&&""!==G||1===this.ta.state?(""!==G&&(ha+=G),this.M_h(ha)?this.uH.create().MO(1,ha,!1):this.TCc.start(ha,this.vek)):this.uH.create().MO(2,ha,!1)}}tVk(G){this.DQ&&this.Rbb&&(G?(this.DQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.DQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Rbb,"DisabledFolderIconSVG")):(this.DQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.DQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Rbb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.DQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Rbb,"DisabledFolderIconSVG"))))}Cyf(){super.Cyf();this.tVk(!!this.b7&&""!==this.b7.value)}dispose(){this.DQ&&(T.a.removeHandler(this.DQ,U.a.click,Object(a.a)(this,this.QYf,"onSaveToAnotherLocationClick")),T.a.removeHandler(this.DQ,U.a.gi,Object(a.a)(this,this.BYi,
"onSaveToAnotherLocationKeyDown")),this.DQ=null);super.dispose()}}Object(e.a)(am,"FileNameDialog",Hi,[1305]);var Wh=c(505),Wg=c(360),jg=c(1576),Lh=c(1700);class je{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(je,"SaveAsDialogInput",null,[]);class oh{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(oh,"SaveLocation",null,[]);var Rd=c(123);class Ii{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd){this.GJe=
null;this.XN="";this.TCc=G;this.uH=ha;this.Om=fd;this.r_a=La;this.Yi=Vb;this.cM=lb;this.pAb=Nc;this.r0b=hd;tc&&(this.GJe=new Pb.a(()=>new jg.a(tc.value,null)))}YUl(){const G=new Wh.a(Wg.a.ih());G.Z("type","currentHost");return Object.assign(new oh,{folderName:this.cM.breadcrumbFolderName,friendlyPath:this.cM.breadcrumbBrandName,properties:G})}wVm(G){return!!G&&"ClassicMru"===G.type&&!!G.service_info&&!!G.service_info.service_id&&-1!==G.service_info.service_id.indexOf("SHAREPOINT")}Qem(){if(!this.GJe||
!this.pAb)return null;var G=this.GJe.value.jP("SaveAsToSharePointDialog",!1);if(!G||3!==G.state||!G.LQi)return null;G=G.LQi;const ha=new zb.a;let La=0,lb=0;for(var Vb=0;Vb<G.length;Vb++){var tc=G[Vb];if(!this.wVm(tc))continue;La++;if(!tc.sharepoint_info)continue;const Nc=tc.url,hd=tc.sharepoint_info.site_url,fd=tc.title;tc=Lh.b(tc,l.AFrameworkApplication.isRtl);if(!(Nc&&hd&&fd&&tc))continue;lb++;const sd=new Wh.a(Wg.a.ih());sd.Z("type","SharePoint");sd.Z("siteUrl",hd);sd.Z("folderUrl",Nc);lb++;ha.add(Object.assign(new oh,
{folderName:fd,friendlyPath:tc,properties:sd}))}Vb=new Map;Vb.set("NumPlaces",G.length.toString());Vb.set("NumSharepointPlaces",La.toString());Vb.set("placesWithMetadata",lb.toString());Ca.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Vb);0<La&&(lb?.5>1*lb/La&&Ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ha}eWl(){const G=
new zb.a;G.add(this.YUl());const ha=this.Qem();ha&&G.addRange(ha);return Object.assign(new je,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.XN,extension:rb.a.Oha(this.cM.yz),saveLocations:G.toArray(),scenario:"SaveToSharePoint"})}wqf(){const G=Object(a.a)(this,this.eWl,"getDialogInput"),ha={};ha.inputPropsCallback=G;return ha}OEa(G){this.XN=G;this.XN||(this.XN=String.format(CommonUIStrings.l_SaveACopy_Filename,rb.a.yJ(this.cM.yz)));G={["id"]:"SaveAsDialog",
["bodyControls"]:this.wqf()};let ha=CommonUIStrings.L_SaveAs;2===this.Yi.Kb.xk&&(ha=CommonUIStrings.L_SaveACopy);const La=new k.a(!1,!1,!0);La.Cd=1;La.zg="SaveAsDialog";La.ye(1,CommonUIStrings.l_SaveButtonLabel);La.Uh(ha,Object(a.a)(this,this.Oao,"saveAsDialogHandler"),G)}fyo(G,ha){G&&""!==G&&""!==ha||1===this.Yi.state?this.vVm()?this.E3m(G,ha):(""!==ha&&(G+=ha),this.TCc.start(G,this.Om)):(na.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.uH.create().MO(2,
G,!1))}E3m(G,ha){Ca.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const La=this.r0b.Bbf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.r0b.aSd(La).then(lb=>{if(lb&&0<lb.length){const Vb=lb[0][xc.a.KDn];lb=lb[0][xc.a.LDn];if(""!==Vb&&""!==lb)this.pAb.Uza(lb,G+ha,Vb,this.Om),Ca.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.uH.create().MO(0,G,!1);const tc=Db.a.wG();tc&&(tc.set("SiteUrlAvailable",
""===Vb?"false":"true"),tc.set("FolderUrlAvailable",""===lb?"false":"true"));Ca.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Rd.a,{extendedProperties:tc}))}}else this.uH.create().MO(0,G,!1),Ca.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(lb=>{"Canceled"===lb?((lb=Db.a.wG())&&lb.set("IsCanceled","true"),Ca.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Rd.a,{extendedProperties:lb}))):
Ca.Health.instance.recordKpiFailure("SaveACopySFP",lb,!1,!1,null)})}vVm(){return this.r0b?this.r0b.nIf():(na.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Oao(G,ha){if(ha&&1===G){G=ha.fileName;var La=rb.a.Oha(this.cM.yz);ha.moreLocationsSelected&&this.fyo(G,La);if(ha.locationCallback){var lb=ha.locationCallback();lb?lb.properties&&"currentHost"===lb.properties.J("type")?this.r_a.Uza(G+La,!1,this.Om):lb.properties&&"SharePoint"===lb.properties.J("type")?(ha=lb.properties.J("siteUrl"),
lb=lb.properties.J("folderUrl"),this.pAb.Uza(lb,G+La,ha,this.Om)):na.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):na.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else na.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(Ii,"ReactSaveAsDialog",null,[1305]);class Lf{constructor(G,ha,La,lb,Vb,tc,Nc,hd=null,fd=null,sd=null){this.ga=ha;this.Ca=G;this.ssa=lb;this.r_a=tc;this.uH=Vb;this.Yi=La;this.gfh=Nc;this.dak=hd;this.pAb=fd;this.r0b=
sd}create(G){return this.Yi&&this.Yi.Kb.uF?new Ii(this.gfh,this.uH,this.r_a,l.AFrameworkApplication.Js,this.Yi,this.dak,this.pAb,this.r0b,G):new am(this.Ca,this.ga,this.Yi,this.ssa,this.uH,this.r_a,this.gfh,G)}}Object(e.a)(Lf,"FileNameDialogFactory",null,[1278]);class ag{constructor(G,ha,La,lb){this.$v=this.FAc=null;this.fvb=G;this.Yi=La;this.Ffk=lb;this.LXa=new Pb.a(()=>new jg.a(ha.value,Object(a.a)(this,this.LGb,"getMoreInfoEventReceived")))}get TZi(){this.FAc||(this.LXa.value.jP("Save As",!0),
this.$v&&this.$v.Tda&&this.$v.Tda.length&&(this.FAc=this.P7l(this.$v.Tda)));return this.FAc}start(G){if(!this.TZi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.FAc=l.AFrameworkApplication.breadcrumbFolderUrl;else return na.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.$v),!1;const ha=this.Ffk();ha.ryo();const La=
ha.A$l();if(!La)return na.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.fvb.start((lb,Vb)=>{ha.hide();G(lb,Vb)},()=>{this.vMb(ha)},La,this.FAc);return!0}vMb(G){G.hide();na.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}P7l(G){G=G.toLowerCase();G.endsWith("/")||(G+="/");const ha=G.indexOf("/documents/");return-1!==ha?G.substring(0,ha+1)+"_layouts/15/onedrive.aspx":""}LGb(G){this.$v||3!==G.state||(this.$v=G)}}Object(e.a)(ag,"OneDriveFilePickerHelper",
null,[1277]);class xn extends k.a{constructor(){super()}ryo(){this.Htc="FilePickerDialog";this.Vg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.zg="PickerDialog-MsoSp";this.showDialog("",null)}A$l(){return document.getElementById("FilePickerDiv")}LL(){}Yda(){}}Object(e.a)(xn,"PickerDialog",k.a,[1163]);class Zj{constructor(G,ha,La,lb,Vb,tc,Nc){this.Ca=G;this.CBe=La;this.ga=ha;this.TCc=lb;this.fvb=Vb;this.EAc=tc;this.TYj=Nc}Ub(){const G=this.fvb.x$b();G?Xa.a.Cpa||this.Ca.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(n.a.zkc,y.a.frame,Object(a.a)(this,this.Nhj,"saveToSharePointActionDispatcher"),64):(G.A5a.continueWith(ha=>{ha.Gi&&this.fvb.HXf(ha)}),this.lFd()):na.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}lFd(){Gc.a.tde(Object(a.a)(this,this.Nhj,"saveToSharePointActionDispatcher"));Gc.a.xNc([new tl.a(n.a.zkc,y.a.frame,0)],this.fvb.x$b())}get oec(){return this.Ca.$("SaveToAnotherFolderBrsIsEnabled")}get bCh(){return this.Ca.$("UserCanWriteRelative")}Nhj(G,
ha,La,lb,Vb){return ha.contextId!==y.a.frame||G!==n.a.zkc?2:this.oec&&(this.EAc.TZi||this.bCh)?1===La?Bh.SessionStatusManager.instance.Yj||l.AFrameworkApplication.Fpa?8:this.TYj()?32:8:2===La?(na.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Vb&&Vb.SaveEntryPoint&&"VersionHistory"===Vb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.bCh?(na.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.CBe.create(Vb).OEa(null)):(na.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.TCc.start(null,Vb)),32):8:8}}Object(e.a)(Zj,"SaveToSharePointActor",null,[]);class dk{constructor(G,ha,La,lb){this.Om=this.A8g=null;this.pAb=G;this.uH=ha;this.EAc=La;this.Yi=lb}start(G,ha){na.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.A8g=G;this.Om=ha;this.EAc.start((La,lb)=>{this.processResponse(La,lb)})||this.Whg()}processResponse(G,ha){if(G)this.onSuccess(ha);else this.onFailure(ha)}Whg(){1!==
this.Yi.state&&this.uH().Bgf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(G){na.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(G&&G.data&&G.data.value&&G.data.value.length&&G.data.value[0].sharePoint){const ha=G.data.value[0].sharePoint.url;G=G.data.value[0].sharePoint.listUrl;let La=null;if(ha&&(La=G?this.cfm(G):this.bfm(ha))){this.pAb.Uza(ha,this.A8g,La,this.Om);return}na.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ha,!La)}na.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.Whg()}bfm(G){G.endsWith("/")||(G+="/");let ha=0;for(let La=0;La<G.length;La++)if("/"===G.charAt(La)&&5===++ha)return G.substr(0,La);return null}cfm(G){G.endsWith("/")&&(G=G.substring(0,G.length-1));const ha=G.lastIndexOf("/");return-1!==ha?G.substring(0,ha):null}onFailure(G){na.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");G&&G.error?na.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",G.error.errorCode,G.error.message):na.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.Whg()}}Object(e.a)(dk,"SaveToSharePointManager",null,[1882]);class Qe{constructor(G,ha,La,lb,Vb,tc,Nc,hd){this.Pma=G;this.XN=ha;this.kXb=lb;this.PPe=tc;this.MLa=La;this.Rkk=Vb;this.NXa=Nc;this.Om=hd}execute(G,ha){if(!l.AFrameworkApplication.Qk&&
l.AFrameworkApplication.He){var La=this.Pma+this.NXa;La=Ec.a.fp(La,"fu",rb.a.Gj(this.MLa));La=Ec.a.fp(La,"su",rb.a.Gj(this.Rkk));La=Ec.a.fp(La,"fn",rb.a.Gj(this.XN));La=Ec.a.fp(La,"n",rb.a.Gj((new Date).getTime().toString()));this.Om&&this.Om.FileDownloadUrl&&(La=Ec.a.fp(La,"furl",rb.a.Gj(this.Om.FileDownloadUrl)));La=La+"&"+this.PPe;this.kXb&&this.kXb.length?La=Ec.a.fp(La,"fnn",rb.a.Gj(this.kXb)):na.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");na.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.He.nj(La,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,G,ha,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(Qe,"SharePointSaveAsCaller",null,[1905]);class pk{constructor(G){this.FAb=G.appSettings.SaveAsToHostWebServiceBase;this.XN=G.appSettings.FileName;this.NXa=G.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(G,ha,La,lb){return new Qe(this.FAb,this.XN,G,ha,La,l.AFrameworkApplication.em,
this.NXa,lb)}}Object(e.a)(pk,"SharePointUploadCallerFactory",null,[1881]);var io=c(1399);class Oh{constructor(G,ha,La,lb,Vb){this.Gk=this.fsc=null;this.Hte=!1;this.RRe=this.MLa=null;this.KXe=ha;this.gZa=La;this.uH=lb;this.Yi=Vb;this.ga=G}Uza(G,ha,La,lb){this.Hte=!1;na.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.x8a();this.MLa=G;lb&&lb.SaveEntryPoint&&(this.RRe=lb.SaveEntryPoint);this.fsc=this.KXe.create(G,ha,La,lb);lb&&"true"===lb.SkipSaveToHost?
this.tha():this.mJl()}mJl(){const G=()=>{na.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.tha()};32!==this.ga.Qb(n.a.RPb,2,[()=>{na.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.tha()},G])&&G()}tha(){na.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.fsc.execute(Object(a.a)(this,this.zun,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.yun,
"onSaveToSharePointUploadFailed"))}zun(G){if(G&&G.data&&G.data.te){var ha;if(({Gt:ha}=Ia.d(G.data.te)).returnValue)if(ha.StatusCode!==cj.a.Zz&&ha.StatusCode!==cj.a.m6b)na.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",G.data.status,ha.StatusCode),ha.StatusCode!==cj.a.l$f&&this.AUh(G.data.status)||(this.cUa(ha.StatusCode.toString()),this.mxo(ha.StatusCode));else{na.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.g$f();try{ha.NewDocumentUrl?this.POb(ha.NewDocumentUrl):this.QOb()}catch(La){na.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",La.toString())}}else na.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:uc.a.$cd(G.data.te)}),this.ULd()||(this.cUa("Failed to deserialize response"),this.zad())}else na.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.ULd()||(this.cUa("Unknown"),this.zad())}yun(G){G&&G.data?this.AUh(G.data.status)||
(na.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.cUa(io.a[G.data.status]),this.zad()):(na.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.ULd()||(this.cUa("Unknown"),this.zad()))}ULd(){if(!this.Hte)return na.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.Hte=!0,this.tha(),!0;na.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}AUh(G){na.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
G);return this.ULd()}QOb(){na.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");wa.a.vm(this.MLa,wa.a.gsa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}POb(G){let ha=!1,La=!1;l.AFrameworkApplication.K&&(ha=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),La=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));na.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",G,ha);if(ha&&La){na.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const lb={};lb[xc.a.pjc]="1";lb[xc.a.documentUrl]=G;lb[xc.a.reason]=ie.a.lbg;l.AFrameworkApplication.kP().execute(Vb=>{Vb.sendMessage(Jd.a.mEb,lb)})}else wa.a.vm(G,wa.a.gsa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}x8a(){this.Yi&&1===this.Yi.state||(this.Gk=this.gZa(),this.Gk.message=CommonUIStrings.l_CommentProgressTooltip,this.Gk.Cd=5,this.Gk.Kt=!1,this.Gk.KL(CommonUIStrings.l_DefaultDialogTitle,null,null))}aoa(){this.Gk&&(this.Gk.close(),this.Gk=null)}zad(){this.Ep(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}gyo(){this.Ep(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}sxo(){const G=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Ep(CommonUIStrings.l_SaveAsFileTooLargeTitle,G,Ll.a.Pao)}Ep(G,ha,La=Ll.a.Tao){na.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",G,ha);this.aoa();1!==this.Yi.state&&this.uH().UTh(G,ha,La)}mxo(G){na.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
G);switch(G){case cj.a.Sne:this.gyo();break;case cj.a.l$f:this.sxo();break;default:this.zad()}}g$f(){"VersionHistory"===this.RRe&&this.ga.processAction(n.a.J7c,2)}cUa(G){"VersionHistory"===this.RRe&&this.ga.Qb(n.a.Dee,2,{["FailureReason"]:G})}}Object(e.a)(Oh,"UploadToSharePointManager",null,[1880]);var Zg=c(636),yg=c(132);class Nn{constructor(){this.Ydb=this.yLe=this.pLe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(G){this.W=G;this.pLe=Zg.a.Gp(G.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.yLe=Zg.a.Gp(G.Sa("Common.IEventEmitter<Common.IMruResult>"));this.Ydb=Zg.a.Gp(G.Sa("Common.App.SharedFilePicker.ISharedFilePicker"));yg.Task.WAA.call(null,this.pLe,this.yLe,this.Ydb).continueWith(()=>{this.nVn()})}nVn(){this.W.register(pk,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ud(()=>new pk(l.AFrameworkApplication.K)).ha();this.W.register(Oh,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ud(()=>
new Oh(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Pm.a).create(),()=>new vi,l.AFrameworkApplication.ta)).ha();this.W.register(dk,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ud(()=>new dk(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new vi,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ta)).ha();
this.W.register(ag,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ud(()=>new ag(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Pb.a(()=>this.pLe.result),l.AFrameworkApplication.ta,()=>new xn)).ha();this.W.register(Lf,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ud(()=>new Lf(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Kb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Pb.a(()=>this.yLe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Ydb?this.Ydb.result:null)).ha();this.W.register(Zj,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ud(()=>new Zj(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ta.KTk)).ha();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ub()}static main(){M.a.instance.Gc(new Nn)}}Object(e.a)(Nn,"PackageManager",null,[1,2]);class rf{}Object(e.a)(rf,
"StringDifference",null,[1954]);class ge{constructor(G,ha){this.charCode=G;this.description=ha}}Object(e.a)(ge,"UBTableEntry",null,[]);class bh{}new ge(8,"C0 Controls 1");new ge(9,"Horizontal tab (HT)");new ge(10,"Line feed (LF)");new ge(12,"C0 Controls 2");new ge(13,"Carriage return (CR)");new ge(31,"C0 Controls 3");new ge(32,"Space");new ge(47,"ASCII Punctuation and Symbols 1");new ge(57,"ASCII Digits");new ge(64,"ASCII Punctuation and Symbols 2");new ge(90,"Uppercase Latin Alphabet");new ge(96,
"ASCII Punctuation and Symbols 3");new ge(122,"Lowercase Latin Alphabet");new ge(127,"U+0000..U+007F Basic Latin");new ge(159,"C1 Controls");new ge(160,"NB Space");new ge(191,"Latin-1 Punctuation and Symbols");new ge(255,"U+0080..U+00FF Latin-1 Supplement");new ge(383,"U+0100..U+017F Latin Extended-A");new ge(591,"U+0180..U+024F Latin Extended-B");new ge(687,"U+0250..U+02AF IPA Extensions");new ge(767,"U+02B0..U+02FF Spacing Modifier Letters");new ge(879,"U+0300..U+036F Combining Diacritical Marks");
new ge(1023,"U+0370..U+03FF Greek and Coptic");new ge(1279,"U+0400..U+04FF Cyrillic");new ge(1327,"U+0500..U+052F Cyrillic Supplement");new ge(1423,"U+0530..U+058F Armenian");new ge(1535,"U+0590..U+05FF Hebrew");new ge(1791,"U+0600..U+06FF Arabic");new ge(1871,"U+0700..U+074F Syriac");new ge(1919,"U+0750..U+077F Arabic Supplement");new ge(1983,"U+0780..U+07BF Thaana");new ge(2047,"U+07C0..U+07FF NKo");new ge(2111,"U+0800..U+083F Samaritan");new ge(2143,"U+0840..U+085F Mandaic");new ge(2303,"U+08A0..U+08FF Arabic Extended-A");
new ge(2431,"U+0900..U+097F Devanagari");new ge(2559,"U+0980..U+09FF Bengali");new ge(2687,"U+0A00..U+0A7F Gurmukhi");new ge(2815,"U+0A80..U+0AFF Gujarati");new ge(2943,"U+0B00..U+0B7F Oriya");new ge(3071,"U+0B80..U+0BFF Tamil");new ge(3199,"U+0C00..U+0C7F Telugu");new ge(3327,"U+0C80..U+0CFF Kannada");new ge(3455,"U+0D00..U+0D7F Malayalam");new ge(3583,"U+0D80..U+0DFF Sinhala");new ge(3711,"U+0E00..U+0E7F Thai");new ge(3839,"U+0E80..U+0EFF Lao");new ge(4095,"U+0F00..U+0FFF Tibetan");new ge(4255,
"U+1000..U+109F Myanmar");new ge(4351,"U+10A0..U+10FF Georgian");new ge(4607,"U+1100..U+11FF Hangul Jamo");new ge(4991,"U+1200..U+137F Ethiopic");new ge(5023,"U+1380..U+139F Ethiopic Supplement");new ge(5119,"U+13A0..U+13FF Cherokee");new ge(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new ge(5791,"U+1680..U+169F Ogham");new ge(5887,"U+16A0..U+16FF Runic");new ge(5919,"U+1700..U+171F Tagalog");new ge(5951,"U+1720..U+173F Hanunoo");new ge(5983,"U+1740..U+175F Buhid");new ge(6015,"U+1760..U+177F Tagbanwa");
new ge(6143,"U+1780..U+17FF Khmer");new ge(6319,"U+1800..U+18AF Mongolian");new ge(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new ge(6479,"U+1900..U+194F Limbu");new ge(6527,"U+1950..U+197F Tai Le");new ge(6623,"U+1980..U+19DF New Tai Lue");new ge(6655,"U+19E0..U+19FF Khmer Symbols");new ge(6687,"U+1A00..U+1A1F Buginese");new ge(6831,"U+1A20..U+1AAF Tai Tham");new ge(7039,"U+1B00..U+1B7F Balinese");new ge(7103,"U+1B80..U+1BBF Sundanese");new ge(7167,"U+1BC0..U+1BFF Batak");
new ge(7247,"U+1C00..U+1C4F Lepcha");new ge(7295,"U+1C50..U+1C7F Ol Chiki");new ge(7375,"U+1CC0..U+1CCF Sundanese Supplement");new ge(7423,"U+1CD0..U+1CFF Vedic Extensions");new ge(7551,"U+1D00..U+1D7F Phonetic Extensions");new ge(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new ge(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new ge(7935,"U+1E00..U+1EFF Latin Extended Additional");new ge(8191,"U+1F00..U+1FFF Greek Extended");new ge(8303,"U+2000..U+206F General Punctuation");
new ge(8351,"U+2070..U+209F Superscripts and Subscripts");new ge(8399,"U+20A0..U+20CF Currency Symbols");new ge(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new ge(8527,"U+2100..U+214F Letterlike Symbols");new ge(8591,"U+2150..U+218F Number Forms");new ge(8703,"U+2190..U+21FF Arrows");new ge(8959,"U+2200..U+22FF Mathematical Operators");new ge(9215,"U+2300..U+23FF Miscellaneous Technical");new ge(9279,"U+2400..U+243F Control Pictures");new ge(9311,"U+2440..U+245F Optical Character Recognition");
new ge(9471,"U+2460..U+24FF Enclosed Alphanumerics");new ge(9599,"U+2500..U+257F Box Drawing");new ge(9631,"U+2580..U+259F Block Elements");new ge(9727,"U+25A0..U+25FF Geometric Shapes");new ge(9983,"U+2600..U+26FF Miscellaneous Symbols");new ge(10175,"U+2700..U+27BF Dingbats");new ge(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new ge(10239,"U+27F0..U+27FF Supplemental Arrows-A");new ge(10495,"U+2800..U+28FF Braille Patterns");new ge(10623,"U+2900..U+297F Supplemental Arrows-B");
new ge(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new ge(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new ge(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new ge(11359,"U+2C00..U+2C5F Glagolitic");new ge(11391,"U+2C60..U+2C7F Latin Extended-C");new ge(11519,"U+2C80..U+2CFF Coptic");new ge(11567,"U+2D00..U+2D2F Georgian Supplement");new ge(11647,"U+2D30..U+2D7F Tifinagh");new ge(11743,"U+2D80..U+2DDF Ethiopic Extended");new ge(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new ge(11903,"U+2E00..U+2E7F Supplemental Punctuation");new ge(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new ge(12255,"U+2F00..U+2FDF Kangxi Radicals");new ge(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new ge(12351,"U+3000..U+303F CJK Symbols and Punctuation");new ge(12447,"U+3040..U+309F Hiragana");new ge(12543,"U+30A0..U+30FF Katakana");new ge(12591,"U+3100..U+312F Bopomofo");new ge(12687,"U+3130..U+318F Hangul Compatibility Jamo");new ge(12703,"U+3190..U+319F Kanbun");new ge(12735,
"U+31A0..U+31BF Bopomofo Extended");new ge(12783,"U+31C0..U+31EF CJK Strokes");new ge(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new ge(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new ge(13311,"U+3300..U+33FF CJK Compatibility");new ge(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new ge(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new ge(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new ge(42127,"U+A000..U+A48F Yi Syllables");new ge(42191,"U+A490..U+A4CF Yi Radicals");
new ge(42239,"U+A4D0..U+A4FF Lisu");new ge(42559,"U+A500..U+A63F Vai");new ge(42655,"U+A640..U+A69F Cyrillic Extended-B");new ge(42751,"U+A6A0..U+A6FF Bamum");new ge(42783,"U+A700..U+A71F Modifier Tone Letters");new ge(43007,"U+A720..U+A7FF Latin Extended-D");new ge(43055,"U+A800..U+A82F Syloti Nagri");new ge(43071,"U+A830..U+A83F Common Indic Number Forms");new ge(43135,"U+A840..U+A87F Phags-pa");new ge(43231,"U+A880..U+A8DF Saurashtra");new ge(43263,"U+A8E0..U+A8FF Devanagari Extended");new ge(43311,
"U+A900..U+A92F Kayah Li");new ge(43359,"U+A930..U+A95F Rejang");new ge(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new ge(43487,"U+A980..U+A9DF Javanese");new ge(43615,"U+AA00..U+AA5F Cham");new ge(43647,"U+AA60..U+AA7F Myanmar Extended-A");new ge(43743,"U+AA80..U+AADF Tai Viet");new ge(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new ge(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new ge(44031,"U+ABC0..U+ABFF Meetei Mayek");new ge(55215,"U+AC00..U+D7AF Hangul Syllables");new ge(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new ge(56191,"U+D800..U+DB7F High Surrogates");new ge(56319,"U+DB80..U+DBFF High Private Use Surrogates");new ge(57343,"U+DC00..U+DFFF Low Surrogates");new ge(63743,"U+E000..U+F8FF Private Use Area");new ge(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new ge(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new ge(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new ge(65039,"U+FE00..U+FE0F Variation Selectors");new ge(65055,"U+FE10..U+FE1F Vertical Forms");new ge(65071,"U+FE20..U+FE2F Combining Half Marks");
new ge(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new ge(65135,"U+FE50..U+FE6F Small Form Variants");new ge(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new ge(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new ge(65535,"U+FFF0..U+FFFF Specials");new ge(65663,"U+10000..U+1007F Linear B Syllabary");new ge(65791,"U+10080..U+100FF Linear B Ideograms");new ge(65855,"U+10100..U+1013F Aegean Numbers");new ge(65935,"U+10140..U+1018F Ancient Greek Numbers");new ge(65999,"U+10190..U+101CF Ancient Symbols");
new ge(66047,"U+101D0..U+101FF Phaistos Disc");new ge(66207,"U+10280..U+1029F Lycian");new ge(66271,"U+102A0..U+102DF Carian");new ge(66351,"U+10300..U+1032F Old Italic");new ge(66383,"U+10330..U+1034F Gothic");new ge(66463,"U+10380..U+1039F Ugaritic");new ge(66527,"U+103A0..U+103DF Old Persian");new ge(66639,"U+10400..U+1044F Deseret");new ge(66687,"U+10450..U+1047F Shavian");new ge(66735,"U+10480..U+104AF Osmanya");new ge(67647,"U+10800..U+1083F Cypriot Syllabary");new ge(67679,"U+10840..U+1085F Imperial Aramaic");
new ge(67871,"U+10900..U+1091F Phoenician");new ge(67903,"U+10920..U+1093F Lydian");new ge(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new ge(68095,"U+109A0..U+109FF Meoritic Cursive");new ge(68191,"U+10A00..U+10A5F Kharoshthi");new ge(68223,"U+10A60..U+10A7F Old South Arabian");new ge(68415,"U+10B00..U+10B3F Avestan");new ge(68447,"U+10B40..U+10B5F Inscriptional Parthian");new ge(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new ge(68687,"U+10C00..U+10C4F Old Turkic");new ge(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new ge(69759,"U+11000..U+1107F Brahmi");new ge(69839,"U+11080..U+110CF Kaithi");new ge(69887,"U+110D0..U+110FF Sora Sompeng");new ge(69967,"U+11100..U+1114F Chakma");new ge(70111,"U+11180..U+111DF Sharada");new ge(71375,"U+11680..U+116CF Takri");new ge(74751,"U+12000..U+123FF Cuneiform");new ge(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new ge(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new ge(92735,"U+16800..U+16A3F Bamum Supplement");new ge(94111,"U+16F00..U+16F9F Miao");new ge(110847,
"U+1B000..U+1B0FF Kana Supplement");new ge(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new ge(119295,"U+1D100..U+1D1FF Musical Symbols");new ge(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new ge(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new ge(119679,"U+1D360..U+1D37F Counting Rod Numerals");new ge(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new ge(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new ge(127023,"U+1F000..U+1F02F Mahjong Tiles");
new ge(127135,"U+1F030..U+1F09F Domino Tiles");new ge(127231,"U+1F0A0..U+1F0FF Playing Cards");new ge(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new ge(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new ge(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new ge(128591,"U+1F600..U+1F64F Emoticons");new ge(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new ge(128895,"U+1F700..U+1F77F Alchemical Symbols");new ge(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new ge(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new ge(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new ge(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new ge(917631,"U+E0000..U+E007F Tags");new ge(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new ge(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new ge(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(bh,"UnicodeBlocks",null,[1893]);class lj{constructor(){this.W=
null}wc(G){this.W=G;this.W.register(rf,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.W.register(bh,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){M.a.instance.Gc(new lj)}}Object(e.a)(lj,
"SensitiveLoggingPackage",null,[1,2]);var ol;(function(G){G[G.myFiles=0]="myFiles";G[G.recent=1]="recent";G[G.currentFolder=2]="currentFolder";G[G.yourPhone=3]="yourPhone"})(ol||(ol={}));Object(e.b)("SharedFilePickerLandingLocation",ol);class Pf{constructor(G){this.iIb=this.Nic=null;this._initialized=!1;this.uAf=G}Xhb(G){this._initialized||(G.Gv(Jd.a.k8i),G.eC(Jd.a.k8i,Object(a.a)(this,this.utn,"onReceivedPickerResponse")),this._initialized=!0)}aSd(G){return this.iIb=new Promise((ha,La)=>{const lb=
{};lb[xc.a.JDn]=G;this.Nic=(Vb,tc)=>{""===tc?(na.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ha(Vb)):("Canceled"===tc?na.ULS.sendTraceTag(572548164,306,50,tc):na.ULS.sendTraceTag(556901065,306,10,tc),La(tc))};this.uAf.execute(Vb=>{this.Xhb(Vb);Vb.sendMessage(Jd.a.cyn,lb)})})}utn(G){this.Nic(G.Values[xc.a.Kdo],void 0===G.Values[xc.a.h1f]||null===G.Values[xc.a.h1f]?"":G.Values[xc.a.h1f])}nIf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}Bbf(G,ha,La,lb,Vb,
tc,Nc,hd,fd=null){const sd={};sd[xc.a.jdo]=G;sd[xc.a.titleText]=ha;sd[xc.a.pCk]=La;sd[xc.a.qCk]=lb;sd[xc.a.sCk]=Vb;sd[xc.a.vql]=!0;sd[xc.a.eDl]=tc;sd[xc.a.NDn]=Nc;sd[xc.a.MDn]=ol[hd];E.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(sd[xc.a.ODn]="Dark");fd&&(null!=fd.b3b&&(sd[xc.a.b3b]=fd.b3b),null!=fd.Abc&&(sd[xc.a.Abc]=fd.Abc));return sd}}Object(e.a)(Pf,"SharedFilePickerManager",null,[1896]);class zi{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}wc(G){this.W=
G;G.register(Pf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Ud(()=>new Pf(G.Sa("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.T3a()})}T3a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){M.a.instance.Gc(new zi)}}Object(e.a)(zi,"SharedFilePickerPackage",null,[1,2]);class $e extends Sys.EventArgs{constructor(){super()}}Object(e.a)($e,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class qn{}Object(e.a)(qn,"TypingSpeedMeterWindow",null,[]);class fl{constructor(G,ha){new Q.a;this.cA=G;this.ti=ha;this.ti.w0e(Object(a.a)(this,this.n7d,"onCpuMeterFrameAvailable"))}n7d(){}dispose(){this.ti.ccj(Object(a.a)(this,this.n7d,"onCpuMeterFrameAvailable"))}}Object(e.a)(fl,"TypingSpeedMeter",null,[1908]);class Qj{constructor(G){this.$zd=null;this.jq=new z.a;this.cA=G}initialize(G,ha,La,lb){this.$zd||(this.$zd=new fl(this.cA,G,ha,La,lb),this.jq.Dg(this.$zd));return this.$zd}}
Object(e.a)(Qj,"TypingSpeedMeterProvider",null,[1895]);class rm{constructor(){this.fXe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const G=ia.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ha=Zg.a.Gp(ia.a.instance.Sa("Common.ICpuMeterProvider"));ha.continueWith(()=>{const La=ha.result.jq.task;var lb=new fa.a(l.AFrameworkApplication.K.nc("TypingSpeedMeterWindowSamplingPercent",0)/100);lb=new ta.a(Object(a.a)(lb,
lb.UQb,"shouldBeInSample"));const Vb=Fa.a.mF(12,1,lb),tc=l.AFrameworkApplication.K.nc("TypingSpeedMeterWindowTimeoutMs",5E3),Nc=l.AFrameworkApplication.K.nc("TypingSpeedMeterMaxKeystrokesPerWindow",5);La.CWR(()=>this.fXe=G.initialize(La.result,Vb,tc,Nc))})}}dispose(){this.fXe&&this.fXe.dispose()}wc(G){G.register(Qj,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Ud(()=>new Qj(wa.a.$e))}static main(){M.a.instance.Gc(new rm)}}Object(e.a)(rm,"TypingSpeedMeterPackage",
null,[1,2]);class Ai{constructor(){this.events=[];this.i$f=!1}static aKf(G){return G.ctrlKey&&"Control"!==G.key||G.altKey&&"Alt"!==G.key||!!Ai.QZm[G.key]}static GOk(G,ha){let La;La=Ai.aKf(G)?G.key:" "===G.key?"Space":"CharacterKey";return null!=ha?(ha.altPressed=(!!G.altKey).toString(),ha.ctrlPressed=(!!G.ctrlKey).toString(),ha.key=La,ha.repeat=(!!G.repeat).toString(),ha.shiftPressed=(!!G.shiftKey).toString(),ha):{["altPressed"]:(!!G.altKey).toString(),["ctrlPressed"]:(!!G.ctrlKey).toString(),["key"]:La,
["repeat"]:(!!G.repeat).toString(),["shiftPressed"]:(!!G.shiftKey).toString()}}static GBi(G){return window.performance&&window.performance.now&&G.timeStamp<performance.now()}static PYh(G){return!!G&&Ai.GBi(G)&&Ai.aKf(G)}static QYh(G){return!!G&&Ai.GBi(G)&&!Ai.aKf(G)}keyPressedEventHandlerStart(G,ha){Ai.QYh(G)&&this.hwj(G,ha)}keyPressedEventHandlerEnd(G){Ai.QYh(G)&&this.Nwj(G)}keyDownEventHandlerStart(G,ha){Ai.PYh(G)&&this.hwj(G,ha)}keyDownEventHandlerEnd(G){Ai.PYh(G)&&this.Nwj(G)}hwj(G,ha){G={["metadata"]:Ai.GOk(G,
ha),["timeStamp"]:this.xoc(G.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.xoc(performance.now()-G.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(G);this.vYn()}Nwj(G){if(0!==this.events.length){var ha=this.xoc(G.timeStamp);for(let La=this.events.length-1;0<=La;--La){const lb=this.events[La];if(lb.timeStamp===ha){lb.timeToHandlerFinishMs=this.xoc(performance.now()-G.timeStamp);lb.eventDurationMs=this.xoc(lb.timeToHandlerFinishMs-lb.timeToHandlerStartMs);
break}}}}xoc(G){return Number(G.toFixed(2))}vYn(){if(!this.i$f){const G=document.createEvent("CustomEvent");G.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(G);requestAnimationFrame(()=>{this.i$f=!1;const ha=performance.now();this.events.forEach(lb=>{lb.timeToRequestAnimationFrameMs=this.xoc(ha-lb.timeStamp)});var La=document.createEvent("CustomEvent");La.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(La);this.events=[];La=document.createEvent("CustomEvent");
La.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(La)});this.i$f=!0}}}Ai.QZm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class qk{constructor(){this.Eee=this.S5a=this.lSa=this.Vfc=null;this.gec=!1;this.Mjc=null;this.iPc=[];this.Rdd=()=>{qk.vSm()&&null==this.S5a?(this.lSa=null,this.S5a=requestAnimationFrame(this.D0c)):null!=this.S5a&&
(cancelAnimationFrame(this.S5a),this.S5a=null)};this.D0c=G=>{if(null!=this.lSa){const ha=G-this.lSa;if(null==this.Vfc||this.Vfc<ha)this.Vfc=ha;for(let La=0;La<qk.ranges.length;++La)if(ha<qk.ranges[La]){++this.iPc[La];break}}this.lSa=G;this.S5a=requestAnimationFrame(this.D0c)};this.Mdj=()=>{if(null!=this.Vfc){var G={};for(var ha=0;ha<qk.ranges.length;++ha)G[qk.ranges[ha]]=this.iPc[ha],this.iPc[ha]=0;ha=performance.now();G={["intervalStart"]:this.Mjc,["intervalEnd"]:ha,["maxFrameLengthMs"]:this.Vfc,
["frameData"]:G};var La=document.createEvent("CustomEvent");La.initCustomEvent("reportframetiming",!1,!1,G);dispatchEvent(La);this.Vfc=null;this.Mjc=ha}}}static tHf(){return!!window.performance&&!!window.performance.now}start(G){!this.gec&&qk.tHf()&&(this.Hqo(),this.Eee=setInterval(this.Mdj,1E3*G),this.Mjc=performance.now(),this.Rdd(),document.addEventListener("visibilitychange",this.Rdd),this.gec=!0)}stop(){this.gec&&(document.removeEventListener("visibilitychange",this.Rdd),null!=this.Eee&&(clearInterval(this.Eee),
this.Eee=null),null!=this.S5a&&(cancelAnimationFrame(this.S5a),this.S5a=null),this.Mdj(),this.gec=!1)}get oYc(){return this.gec}Hqo(){this.iPc=[];for(let G=0;G<qk.ranges.length;++G)this.iPc.push(0)}}qk.vSm=()=>"visible"===document.visibilityState;qk.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class pe{create(G){return new fa.a(G)}}Object(e.a)(pe,"RandomSamplerFactory",null,[1091]);var hb=c(15),Ib=c(1414);class gc{constructor(G,ha,La,lb,Vb){G.ACd(()=>{lb.C7c()});
G.Jrh((tc,Nc)=>{lb.A7c(Nc.revisionId,Nc.m6a)});G.CCd((tc,Nc)=>{lb.Fym(Nc.Ufj,Nc.m6a,Nc.cAj)});G.Hyk(()=>{lb.Y9f()});ha.hzk((tc,Nc)=>{lb.lLo(Nc.ydj,Nc.pme,Nc.actualValue)});ha.Sxk((tc,Nc)=>{lb.kLo(Nc.ydj,Nc.pme,Nc.actualValue)});Vb.pGc(()=>{lb.wdd()});La.V3((tc,Nc)=>{6===Nc.type&&lb.rkc(Nc.OL)})}}Object(e.a)(gc,"EventForwarder",null,[]);class Lc{constructor(G,ha,La){this.Kck=G;this.ON=La;this.j1b=ha}create(G,ha){return new gc(this.Kck,this.j1b,G,ha,this.ON)}}Object(e.a)(Lc,"EventForwarderFactory",
null,[]);var Rc=c(445);class qd{}qd.ORo="TypingToOutboundReplicationStart";qd.Jyn="OutboundReplicationStartToOutboundReplicationEnd";qd.Pgj="RtcNotificationToInboundReplicationEnd";qd.aEj="TypingToInboundReplicationEnd";Object(e.a)(qd,"PerfTrackerPhases",null,[]);var Ld=c(25);class zd{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd=null){this.l6g=!1;this.kMe=5;this.M7g=50;this.MKe=20;this.nJe=this.wKe=this.MAa=null;this.utc=this.ktc=0;this.nUe=this.wVe=!1;this.Zyd=Array(7);this.Dqc=null;this.vYg=!1;this.awe=
null;this.uja={};this.qod=G;this.cXa=ha;this.lbk=La;this.t_g=lb.create(qd.Pgj,Vb,tc,20,!1);this.aAd=lb.create(qd.aEj,Nc,hd,20,!0);if(this.Ca=l.AFrameworkApplication.K)this.l6g=this.Ca.$("LogSteppedInboundFrameIsEnabled"),this.MKe=this.Ca.nc("InboundFrameMaxNumberOfLongRunningTasks",20),this.M7g=this.Ca.nc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.kMe=this.Ca.nc("InboundFrameNumberOfLastShortTasks",5);this.Ktb=fd}get UWk(){null==this.awe&&(this.awe=!!this.Ca&&this.Ca.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.awe}initialize(G){this.MAa=G}m5n(G,ha,La=null){this.NEh();na.ULS.shipAssertTag(8229761,324,0<G.length);let lb=!1;for(const tc of G){const Nc=tc.toString();if(Nc in this.uja){var Vb=this.uja[Nc];if(!Vb.Zkc){Vb.skj(G,ha,La);if(lb)this.MLi(tc.toString(),Vb,null,null,this.Zyd,null);else{const hd=this.pBl(),fd=this.hMl(this.Dqc);lb=!0;this.MLi(tc.toString(),Vb,hd,this.nJe,this.Zyd,fd)}delete this.uja[Nc]}}else Vb=this.qod.create(this.t_g,this.aAd),Vb.skj(G,ha),this.uja[Nc]=Vb}this.nUe=!1}rkc(G){na.ULS.shipAssertTag(8257930,
304,G.YEi,"Expected data not sent on the wire");if(G.YEi){if(G.gfe in this.uja){var ha=this.uja[G.gfe];ha.tfe||(ha.rkc(G.revisionId,G.J_i,G.Arj,G.m6a),delete this.uja[G.gfe])}else ha=this.qod.create(this.t_g,this.aAd),ha.rkc(G.revisionId,G.J_i,G.Arj,G.m6a),this.uja[G.gfe]=ha;this.NEh()}}uAm(){this.wVe||(this.wKe=Array(this.MKe),this.nJe=Array(this.kMe),this.utc=this.ktc=0,this.Zyd=[0,0,0,0,0,0,0,0],this.Dqc=Array(3),this.Dqc[1]=[0,0],this.Dqc[2]=[0,0],this.wVe=!0)}Euo(G){return!G.TP&&G.TN===oa.a.tdj&&
(G=Rc.a(this.uja))&&G[0]?!0:!1}Snn(G){this.wVe=!1;const ha=Rc.a(this.uja);ha&&ha[0]&&(G.TRT>=this.M7g&&this.ktc<this.MKe?this.wKe[this.ktc++]=G:(this.nJe[this.utc]=G,this.utc=this.utc<this.kMe-1?this.utc+1:0),this.w8m(G),this.M8m(G))}Rnn(){this.uAm();this.nUe=!0}w8m(G){this.Zyd[G.TP]++}M8m(G){if(G&&G.UI){const ha=this.Dqc[G.UI];ha[0]+=1;ha[1]+=G.TRT}}hMl(G){const ha={};G&&(G[1]&&(ha.Typing=G[1]),G[2]&&(ha.Clicking=G[2]));return ha}pBl(){return this.ktc?this.wKe.slice(0,this.ktc-1):null}NEh(){var G=
Rc.a(this.uja);if(G&&(this.vYg||this.j9m(G),G.length>this.lbk))for(const ha of G){G=this.uja[ha];const La=G.createdTime,lb=this.cXa();6E4<lb-La&&(K.b(8438528,304,50,"{0}",{["Not Received"]:G.Zkc?"RtcNotification":"ServerRevision",["Duration"]:lb-La}),G.Zkc||K.b(42075798,304,15,"{0}",{["RevisionId"]:ha,["Duration"]:lb-La}),delete this.uja[ha])}}j9m(G){if(this.UWk&&this.Ktb)for(const ha of G)if(G=this.uja[ha],G.tfe&&!G.Zkc&&(G=G.createdTime,2E3<this.cXa()-G)){let La=null;Ld.StaticActiveAppFrame.za()&&
Ld.StaticActiveAppFrame.za().jb&&Ld.StaticActiveAppFrame.za().jb.Zc&&(La=Ld.StaticActiveAppFrame.za().jb.Zc.contentReplicator);this.Ktb.execute(lb=>{lb.flush(La,1)});this.vYg=!0}}MLi(G,ha,La,lb,Vb,tc){this.l6g&&(ha=ha.QLl())&&(ha.RevisionId=G,ha.LRTWR=La,ha.LSTWR=lb,ha.TSD=Vb,ha.UIWR=tc,this.MAa&&this.MAa.track(ha))}}Object(e.a)(zd,"InboundMonitor",null,[1994]);class pf{constructor(G,ha,La,lb){this.xD=ha;this.qod=La;this.knk=lb}create(G,ha,La,lb,Vb=null){return new zd(this.qod,this.xD,50,this.knk,
G,ha,La,lb,Vb)}}Object(e.a)(pf,"InboundMonitorFactory",null,[1963]);var Jc=c(376);class gg{}gg.mpe="UserCount";gg.H9n="RevisionChainLength";Object(e.a)(gg,"PerfTrackerPivotNames",null,[]);class dc{}Object(e.a)(dc,"PerfTrackingContext",null,[]);const ng=G=>5>=G?"5AndFewer":10>=G?"6To10":15>=G?"11To15":20>=G?"15To20":25>=G?"21To25":30>=G?"26To30":"31AndAbove";class Sd{}Object(e.a)(Sd,"SteppedInboundFrame",null,[]);class rk{constructor(G,ha,La,lb,Vb){this.edb=this.sod=null;this.p_g=500;this.rod=this.ota=
this.$vb=this.XXb=this.wgd=-1;this.wwg=null;this.Zfh=this.Reh=!1;this.veh=null;this.lah=this.QMa=0;this.g_b=G;this.createdTime=ha();this.yxd=!1;this.ANe=0;this.Exb=La;this.m7j=lb;this.aAd=Vb;l.AFrameworkApplication.K&&(this.p_g=l.AFrameworkApplication.K.nc("InboundFrameSamplingMinimalTotalTimeMs",500))}get tfe(){return this.Reh}get Zkc(){return this.Zfh}get Vfj(){return this.veh}get m6a(){return this.QMa}get Iyn(){return this.lah}get wEb(){return this.Exb()}rkc(G,ha,La,lb){this.tfe||(this.yxd=La,
this.ANe=ha,this.wgd=Y.a.zV(wa.a.$e(),2),this.wwg=(new Date).toISOString(),this.edb=G,this.lah=lb,this.Reh=!0,this.Zkc?this.rXh():(this.iwj(),xa.a.instance.wz(G.toString()+"Start"),Jc.a.instance.z4d(2)))}skj(G,ha,La=null){this.Zkc||(this.QMa=ha,this.Zfh=!0,this.veh=G,this.rod=Y.a.zV(wa.a.$e(),2),this.tfe&&(xa.a.instance.wz(this.edb.toString()+"End"),La&&(this.XXb=La.u6n,this.$vb=La.w7a,this.ota=La.n5n),Jc.a.instance.CGd(),this.rXh()))}QLl(){if(!(0<this.wgd&&0<this.XXb&&0<this.$vb&&0<this.ota&&0<this.rod))return null;
const G=new Sd;G.TT=Y.a.zV(this.rod-this.wgd,2);if(G.TT<this.p_g)return null;G.ST=this.wwg;G.UC=this.wEb;G.RS=Y.a.zV(this.XXb-this.wgd,2);G.SR=Y.a.zV(this.$vb-this.XXb,2);G.RRS=Y.a.zV(this.ota-this.$vb,2);G.RP=Y.a.zV(this.rod-this.ota,2);G.ResponseLanded=Y.a.zV(this.$vb,2);0<G.RS?(xa.a.instance.RY("RTCToRequestSent",this.edb.toString()+"Start","RequestInvoked"+this.XXb),xa.a.instance.RY("RequestSentToResponseReceived","RequestInvoked"+this.XXb,"RequestCompleted"+this.$vb),xa.a.instance.RY("ResponseReceivedToReplicationStart",
"RequestCompleted"+this.$vb,"ReplicationStart"+this.ota)):xa.a.instance.RY("RTCToReplicationStart",this.edb.toString()+"Start","ReplicationStart"+this.ota);xa.a.instance.RY("Replication","ReplicationStart"+this.ota,this.edb.toString()+"End");return G}iwj(){this.sod=this.g_b.create();this.sod.start(qd.Pgj,qd.aEj)}rXh(){this.sod||this.iwj();const G=this.sod.end(this.yxd,this.Wdl());this.m7j.Cee(G);this.aAd.Cee(G+this.ANe)}Wdl(){const G={};G[gg.mpe]=ng(this.wEb);var ha=this.Vfj.length;G[gg.H9n]=9>=ha?
ha.toString():"10AndAbove";return Object.assign(new dc,{P:G,FC:this.m6a,CFC:this.Iyn+this.m6a,ID:this.edb.toString(),CD:this.ANe,UC:this.wEb,RCL:this.Vfj.length})}}Object(e.a)(rk,"InboundOperation",null,[1995]);class Yi{constructor(G,ha,La){this.CLa=G;this.cXa=ha;this.Exb=La}create(G,ha){return new rk(this.CLa,this.cXa,this.Exb,G,ha)}}Object(e.a)(Yi,"InboundOperationFactory",null,[1964]);class dh{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd){this.zxd=!0;this.lbh=this.jud=null;this.qN=sd=>{this.lj.qN(6,sd)};
this.zNe=G;this.v2j=ha;this.Efk=La;this.lj=lb;this.gXe=Vb.create("TypingToOutboundReplicationStart",tc,Nc,20,!1);this.FQe=Vb.create("OutboundReplicationStartToOutboundReplicationEnd",hd,fd,20,!1)}get O0f(){return this.jud}get U$d(){return this.lbh}wdd(){!this.O0f&&this.zxd&&(this.zxd=this.v2j())&&(this.jud=this.zNe.create(this.qN,this.Efk(),this.gXe,this.FQe),this.O0f.wdd())}C7c(){this.zxd=!0;this.lbh=this.O0f;this.U$d&&(this.jud=null,this.U$d.C7c())}Y9f(){this.jud=null}A7c(G,ha){this.U$d&&this.U$d.A7c(G,
ha)}}Object(e.a)(dh,"OutboundMonitor",null,[]);class Nf{constructor(G,ha){this.zNe=G;this.zek=ha}create(G,ha,La,lb,Vb,tc,Nc){return new dh(this.zNe,G,ha,La,this.zek,lb,Vb,tc,Nc)}}Object(e.a)(Nf,"OutboundMonitorFactory",null,[]);var ei=c(61);class kf{constructor(G){this.tdb=G}get eQn(){return this.tdb}nb(G){return!!this.tdb&&G in this.tdb}get YEi(){return this.nb(kf.zMd)&&this.nb(kf.DPb)&&this.nb(kf.Rgg)}get revisionId(){if(this.nb(kf.DPb))return ei.a.If(this.tdb[kf.DPb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get gfe(){if(this.nb(kf.DPb))return this.tdb[kf.DPb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get J_i(){if(this.nb(kf.zMd))return Number.parseInvariant(this.tdb[kf.zMd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get Arj(){if(this.nb(kf.DPb))return Boolean.parse(this.tdb[kf.Rgg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get m6a(){if(this.nb(kf.LUf))return Number.parseInvariant(this.tdb[kf.LUf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static jbl(G){return new kf(G)}static obl(G,ha,La,lb){const Vb={};Vb[kf.zMd]=G.toString();Vb[kf.DPb]=ha.toString();Vb[kf.Rgg]=La.toString();Vb[kf.LUf]=lb.toString();return new kf(Vb)}}kf.DPb="RevisionID";kf.zMd="Duration";kf.Rgg="ShouldSample";kf.LUf="NumSequentialFailures";Object(e.a)(kf,"ReplicationNotificationMessage",null,[1991]);class rn{constructor(G,ha,La,lb,Vb,tc,Nc){this.ys=this.ki=0;this.Txb=this.UEc=
null;this.ete=[];this.mch=null;this.Bld={};this.QMa=0;this.g_b=G;this.fjk=ha;this.cXa=La;this.Exb=lb;this.Wgh=Vb;this.edb=null;this.Bld.TypingStartStage=null;this.Bld.ReplicationStartStage="TypingStartStage";this.Bld.ReplicationEndStage="ReplicationStartStage";this.ylh=1<this.wEb;this.gXe=tc;this.FQe=Nc}get wEb(){return this.Exb()}wdd(){this.X7e("TypingStartStage")&&(this.N6f("TypingStartStage"),na.ULS.shipAssertTag(8257931,324,!this.Txb&&!this.ys,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.ki=this.cXa(),this.UEc=this.g_b.create(),this.Zvj(this.UEc,qd.ORo))}C7c(){if(this.X7e("ReplicationStartStage")){this.N6f("ReplicationStartStage");na.ULS.shipAssertTag(8257932,324,!!this.UEc,"TypingStart not called");if(this.UEc){const G=this.nXh(this.UEc,this.edb);this.gXe.Cee(G)}this.Txb=this.g_b.create();this.Zvj(this.Txb,qd.Jyn)}}A7c(G,ha){this.X7e("ReplicationEndStage")&&(this.N6f("ReplicationEndStage"),this.ys=this.cXa(),this.QMa=ha,na.ULS.shipAssertTag(8257933,324,!!this.Txb,"ReplicationStart not called"),
this.Txb&&(na.ULS.shipAssertTag(8193425,324,!!this.Txb,"ReplicationStart not called"),ha=this.nXh(this.Txb,G),this.FQe.Cee(ha)),na.ULS.shipAssertTag(8257934,324,!!this.ki,"StartTime not set. No message sent to other editors."),this.ki&&(G=kf.obl(this.ys-this.ki,G,this.Wgh,this.QMa),this.fjk(G.eQn)))}X7e(G){if(this.Bld[G]===this.mch)return!0;na.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.drk()});return!1}drk(){const G=new Sys.StringBuilder;G.append("Actual Phase:");for(let ha=
0;ha<this.ete.length;ha++)G.append(" "+this.ete[ha]);return G.toString()}N6f(G){this.ete.push(G);this.mch=G}Zvj(G,ha){this.ylh&&G.start(ha)}nXh(G,ha){if(!this.ylh)return-1;const La={};La[gg.mpe]=ng(this.wEb);ha=Object.assign(new dc,{P:La,FC:this.QMa,CFC:0,ID:ha?ha.toString():"",CD:0,UC:this.wEb,RCL:0});return G.end(this.Wgh,ha)}}Object(e.a)(rn,"OutboundOperation",null,[1992]);class Zi{constructor(G,ha,La){this.g_b=G;this.cXa=ha;this.Exb=La}create(G,ha,La,lb){return new rn(this.g_b,G,this.cXa,this.Exb,
ha,La,lb)}}Object(e.a)(Zi,"OutboundOperationFactory",null,[1962]);class Ao{constructor(G,ha){this.lQg=this._name=this.D3=null;this.je=G;this.MAa=ha}start(G,ha=null){this.D3=this.je.Yf("UserAction",G);this._name=G;this.lQg=ha}end(G,ha){let La=-1;G&&(La=this.D3.pi,ha.D=La,ha.CN=this.lQg,ha.CD+=La,this.MAa.track(ha,this._name));return La}}Object(e.a)(Ao,"PerfTracker",null,[1993]);class gl{constructor(G,ha){this.je=G;this.MAa=ha}create(){return new Ao(this.je,this.MAa)}}Object(e.a)(gl,"PerfTrackerFactory",
null,[1961]);class Ga{constructor(G,ha,La){this.OAc=null;this.yek=G;this.s_g=ha;this.Kch=La}init(G,ha,La,lb,Vb,tc,Nc){ha=this.Kch.create(ha/100);La=this.Kch.create(La/100);this.OAc=this.yek.create(Object(a.a)(ha,ha.UQb,"shouldBeInSample"),Object(a.a)(La,La.UQb,"shouldBeInSample"),G,lb,Vb,tc,Nc)}wdd(){this.OAc.wdd()}C7c(){this.OAc.C7c()}Y9f(){this.OAc.Y9f()}A7c(G,ha){this.OAc.A7c(G,ha)}Fym(G,ha,La=null){this.s_g.m5n(G,ha,La)}rkc(G){G=kf.jbl(G);this.s_g.rkc(G);xa.a.instance.wz(G.revisionId+"Start")}lLo(G,
ha,La){K.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.xJd(G,ha,La))}kLo(G,ha,La){K.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.xJd(G,ha,La))}xJd(G,ha,La){const lb={};lb.PhaseName=G;lb.ThresholdValue=ha;lb.ActualValue=La;return lb}}Object(e.a)(Ga,"ReplicationTelemetryManager",null,[]);var kb=c(956);class nc extends kb.a{constructor(G,ha){super(G,ha);this.$j=this.xyd=0}cza(G){this.xyd+=G;this.$j++}getValue(){return this.$j?this.xyd/
this.$j:0}fUa(){this.$j=this.xyd=0}}Object(e.a)(nc,"AverageMetric",kb.a,[]);class Kb extends kb.a{constructor(G,ha){super(G,ha);this.w7=0}cza(G){G>this.w7&&(this.w7=G)}getValue(){return this.w7}fUa(){this.w7=0}}Object(e.a)(Kb,"MaxMetric",kb.a,[]);var ld=c(1905);class Kc extends kb.a{constructor(G,ha,La=100){super(G,ha);this.Grd=this.HZb=this.W0b=0;this.mwd=La;this.vRe=new ld.a(this.mwd)}cza(G){if(this.HZb===this.mwd){const ha=this.vRe.dequeue();this.W0b-=ha;this.HZb--}this.vRe.enqueue(G);this.W0b+=
G;this.HZb++;G=this.W0b/this.HZb;G>this.Grd&&this.HZb===this.mwd&&(this.Grd=G)}getValue(){return this.Grd}fUa(){this.Grd=0;this.vRe=new ld.a(this.mwd);this.HZb=this.W0b=0}}Object(e.a)(Kc,"MaxRollingAverageMetric",kb.a,[]);class ue extends kb.a{constructor(G,ha){super(G,ha);this.$j=0}cza(){this.$j++}getValue(){return this.$j}fUa(){this.$j=0}}Object(e.a)(ue,"CounterMetric",kb.a,[]);class Le{constructor(G,ha){this.Y1b=ha;this.Aue=new nc(G+"-AverageValue","Milliseconds");this.KKe=new Kb(G+"-MaxValue",
"Milliseconds");this.RKe=new Kc(G+"-MaxRollingAverageValue","Milliseconds");this.Mxe=new ue(G+"-NumberOfEvents","Count");this.Mta=new ob.a(G+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.wU("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.wU("CoAuthLatencySlowThresholdPercentile",95),this.Y1b);this.GOe=new ob.a(G+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.wU("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.wU("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.Y1b)}v1(G){this.Aue.cza(G);this.KKe.cza(G);this.RKe.cza(G);this.Mxe.cza(G);this.Mta.cza(G);this.GOe.cza(G)}hde(){this.Aue.KTa();this.KKe.KTa();this.RKe.KTa();this.Mxe.KTa();this.Mta.KTa();this.GOe.KTa();this.Aue.fUa();this.KKe.fUa();this.RKe.fUa();this.Mxe.fUa();this.Mta.fUa();this.GOe.fUa()}}Object(e.a)(Le,"ReplicationLatencyMetrics",null,[]);class cf{constructor(){this.BJe=new Ob.a}Y8i(G,ha,La){if(!(0>ha)){if(!({value:lb}=this.BJe.Fc(G,lb)).returnValue){var lb=new Le(G,La);this.BJe.Z(G,
lb)}lb.v1(ha)}}hde(){for(const G of this.BJe.values)G.hde()}}Object(e.a)(cf,"ReplicationTelemetryMetricsManager",null,[1960]);class Mf{Y8i(){}hde(){}}Object(e.a)(Mf,"ReplicationTelemetryMetricsManagerStub",null,[1960]);class Vg{constructor(G,ha,La,lb,Vb,tc,Nc){this.f_a=this.Lzd=0;this.Lbk=G;this.JOe=La;this.Djh=lb;this.VMg=Vb;this.j1b=ha;this.Mbk=tc;this.Y1b=Nc}Cee(G){this.Lbk.Y8i(this.JOe,G,this.Y1b);G>this.Djh&&this.j1b.TKo(this.JOe,this.Djh,G);this.Lzd+=G;this.f_a++;this.Lzd/this.f_a>this.VMg&&
this.f_a>this.Mbk&&this.j1b.MJk(this.JOe,this.VMg,this.Lzd/this.f_a)}}Object(e.a)(Vg,"TimeSpanVerifier",null,[1906]);class Eg{constructor(G,ha){this.Khk=G;this.j1b=ha}create(G,ha,La,lb,Vb){return new Vg(this.Khk,this.j1b,G,ha,La,lb,Vb)}}Object(e.a)(Eg,"TimeSpanVerifierFactory",null,[1884]);class wi extends Sys.EventArgs{constructor(G,ha,La){super();this.ydj=G;this.pme=ha;this.actualValue=La}}Object(e.a)(wi,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class sm{constructor(){this.sa=new Q.a}TKo(G,
ha,La){this.sa.raiseEvent("TSVTE",new wi(G,ha,La))}MJk(G,ha,La){this.sa.raiseEvent("TSVATE",new wi(G,ha,La))}hzk(G){this.sa.addHandler("TSVTE",G)}Sxk(G){this.sa.addHandler("TSVATE",G)}}Object(e.a)(sm,"TimeSpanVerifierNotifier",null,[1885]);class sh{constructor(){this.W=this.Ca=null}get name(){return"Box4.ReplicationTelemetry"}wc(G){this.Ca=G.resolve("Common.IAppSettingsManager");this.W=G;if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){G.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new gl(Ld.StaticActiveAppFrame.za().Kq,
Fa.a.mF(20,1,new Pa.a))).ha();G.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new sm).ha();this.Ca.$("Box4ReplicationTelemetryMetricsIsEnabled")?G.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new cf).ha():G.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Mf).ha();G.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Eg(G.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),G.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();
G.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new Zi(G.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),sh.z9h)).ha();G.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new Nf(G.resolve("ReplicationTelemetry.OutboundOperationFactory"),G.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();G.ia("ReplicationTelemetry.InboundOperationFactory",()=>new Yi(G.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),sh.z9h)).ha();var ha=
new pf(G.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),G.resolve("ReplicationTelemetry.InboundOperationFactory"),G.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),La=this.Ca.$("ComponentStateLoggingPackageIsEnabled")?this.W.Sa("Common.IComponentStateLogManager"):null;G.ia("ReplicationTelemetry.IInboundMonitor",()=>ha.create(this.Ca.nc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ca.nc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ca.nc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ca.nc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),La)).ha();G.ia("Common.IRandomSamplerFactory",()=>new pe).ha();G.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Ga(G.resolve("ReplicationTelemetry.OutboundMonitorFactory"),G.resolve("ReplicationTelemetry.IInboundMonitor"),G.resolve("Common.IRandomSamplerFactory"))).ha();G.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Lc(Ib.a.instance,
G.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),G.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){var G=this.Ca.nc("Box4ReplicationTelemetrySamplePercent",0),ha=this.Ca.nc("Box4ReplicationTelemetryPhaseSamplePercent",0),La=this.Ca.nc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),lb=this.Ca.nc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Vb=this.Ca.nc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),tc=this.Ca.nc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Nc=this;this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(fd=>{fd.bE().continueWith(()=>{const sd=fd.bE().result,Kd=Nc.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Kd.init(sd,G,ha,La,lb,Vb,tc);Nc.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(sd,Kd);if(Nc.Ca.$("LogSteppedInboundFrameIsEnabled")){const Nd=Zg.a.Gp(Nc.W.Sa("Common.ICpuMeterProvider"));Nd.continueWith(()=>
{const we=Nc.W.resolve("ReplicationTelemetry.IInboundMonitor");var Ce=new ta.a(()=>!0);Ce=Fa.a.mF(19,1,Ce);we.initialize(Ce);const te=Nd.result.jq.task;te.continueWith(()=>{te.result.SBd(0,()=>we.nUe,fe=>{we.Snn(fe)});te.result.SBd(1,fe=>we.Euo(fe),()=>{we.Rnn()})})})}na.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var hd=this;l.AFrameworkApplication.rI(()=>{hd.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").hde()})}}dispose(){}static z9h(){const G=hb.App.zd;
return G?G.fWh:0}}Object(e.a)(sh,"ReplicationTelemetryPackage",null,[1,2]);var Rj=c(958),Ni=c(11),xi=c(131),qe=c(3),Hh=c(82),xd=c(62),ye=c(214),Pd=c(17),Td=c(23),ul=c(8),oi=c(2076);class lh{static get Vg(){return k.a.Nx(lh.Wm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}lh.Wm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(lh,"InsertSymbolsDialogHtml",null,[]);class Xk extends oi.a{constructor(G,ha,La){super();this.TYb=this.KNa=this.leb=null;this.uFe=0;this.sFm=lb=>{1===lb?(this.wXf("symbol_d_"+Xk.Cyc),this.Vb.FL(this.iL,!0),this.Vb.at().hk.iz(this.oH),this.oH.focus()):this.hide()};this.ayj=lb=>{if(lb.target!==this.TYb){const Vb=this.Vb.at();Vb&&Vb.hk&&(Vb.hk.iz(lb.target),this.TYb=lb.target)}this.Oun(lb.target.id)};this.jHo=lb=>{const Vb=lb.yf;if("a"!==Vb.tagName.toLowerCase())return!1;lb.eventName===U.a.wB&&
this.wXf(Vb.id);this.Vb.FL(this.iL,!0);this.Vb.at().hk.iz(Vb);Vb.focus();return!0};this.lHo=lb=>{var Vb=lb.yf;if("a"!==Vb.tagName.toLowerCase())return!1;const tc=parseInt(Vb.id.substr(Vb.id.lastIndexOf("_")+1));if(lb.Hb.ctrlKey||lb.Hb.altKey||lb.Hb.keyCode>=kk.a.kUb&&lb.Hb.keyCode<=kk.a.lUb)return!1;if(lb.eventName===U.a.gi){lb=lb.Hb.keyCode;let Nc=-1;lb===Sys.UI.Key.enter?(this.wXf(Vb.id),this.Vb.FL(this.iL,!0),this.Vb.at().hk.iz(Vb),Vb.focus()):lb===Sys.UI.Key.up?Nc=tc-15:lb===Sys.UI.Key.down?Nc=
tc+15:lb===Sys.UI.Key.left?Nc=l.AFrameworkApplication.isRtl?tc+1:tc-1:lb===Sys.UI.Key.right&&(Nc=l.AFrameworkApplication.isRtl?tc-1:tc+1);0<=Nc&&(Vb=this.Cvf("symbol_d_"+Nc))&&Vb.focus()}return!0};this.ga=G;this.Vb=ha;this.meb=La;this.ye(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ye(0,CommonUIStrings.l_DialogClose);this.Daa=!1;this.Vg=lh.Vg;this.zg="InsertSymbolsDialog"}dispose(){0<Xk.EWe&&na.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.uFe,Xk.EWe);Xk.HSg++;na.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Xk.HSg);this.ga=this.meb=null;super.dispose()}RUa(){this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.sFm,null);this.uFe=0;Xk.NSg++;na.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Xk.NSg);const G=this.Cvf("symbol_d_"+Xk.Cyc);G&&G.focus()}hide(){var G=document.getElementById("symbolsContainer");if(G&&(G=G.getElementsByTagName("a")))for(let ha=0;ha<G.length;ha++)T.a.removeHandler(G[ha],
U.a.focus,this.ayj);super.hide()}get tmb(){return Xk.Iyc}set tmb(G){Xk.Iyc=G}get omb(){return Xk.vyc}set omb(G){Xk.vyc=G}V9(){super.V9();var G=document.getElementById("symbolsContainer");if(G&&(G.innerHTML=this.meb.lOk(),G=G.getElementsByTagName("a")))for(let ha=0;ha<G.length;ha++)T.a.addHandler(G[ha],U.a.focus,this.ayj)}hna(){const G=document.getElementById("symbolsContainer");G&&(this.leb||(this.leb=this.jHo,this.Pq.ob(U.a.click,G,this.leb),this.Pq.ob(U.a.wB,G,this.leb)),this.KNa||(this.KNa=this.lHo,
this.ge.ob(U.a.gi,G,this.KNa),this.ge.ob(U.a.tu,G,this.KNa),this.ge.ob(U.a.zh,G,this.KNa)));super.hna()}ohb(){const G=document.getElementById("symbolsContainer");G&&(this.leb&&(this.Pq.uc(U.a.click,G,this.leb),this.Pq.uc(U.a.wB,G,this.leb),this.leb=null),this.KNa&&(this.ge.uc(U.a.gi,G,this.KNa),this.ge.uc(U.a.tu,G,this.KNa),this.ge.uc(U.a.zh,G,this.KNa),this.KNa=null));super.ohb()}get zzf(){return!0}Oun(G){this.ioj("symbol_d_"+Xk.Cyc,!1);Xk.Cyc=parseInt(G.substr(G.lastIndexOf("_")+1));this.ioj(G,
!0);if(G=document.getElementById("SymbolNameValueLabel")){const ha=this.UUd(Xk.Cyc);G.innerText=ha.altText}}UUd(G){const ha=this.meb.rle.Xkg.value,La=Rc.a(ha);return ha[La[G]]}wXf(G){this.uFe++;Xk.EWe++;G=parseInt(G.substr(G.lastIndexOf("_")+1));const ha=this.UUd(G),La={};La.SourceControlId="symbol_"+G+"_"+ha.ple;this.ga.Qb(qe.a.Skb,2,La);na.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",G)}Cvf(G){const ha=document.getElementById("symbolsContainer");return ha?ha.querySelector("#"+
G):null}ioj(G,ha){if(G=this.Cvf(G))ha?(G.setAttribute("selected","true"),G.setAttribute("aria-selected","true"),G.tabIndex=0):(G.removeAttribute("selected"),G.setAttribute("aria-selected","false"),G.tabIndex=-1)}}Xk.Cyc=0;Xk.Iyc=null;Xk.vyc=null;Xk.NSg=0;Xk.HSg=0;Xk.EWe=0;Object(e.a)(Xk,"InsertSymbolsDialog",oi.a,[]);class Ih{constructor(G,ha,La,lb,Vb,tc,Nc){this.Ggm=()=>this.meb.cPk();this.x6i=(hd,fd,sd,Kd,Nd)=>{if(1===sd)return 32;hd=this.meb.p1i(Nd);hd=String.format(this.meb.kHo,hd.character);
Nd[Rj.a.InnerHTML]=hd;Nd[Rj.a.On]=!1;return 32};this.kRa=(hd,fd,sd,Kd,Nd)=>{if(({ke:hd,selected:sd,kRa:te}=this.DLc(fd,sd)).returnValue)return te;var we=Pd.SelectionEditor.Ze(sd);let Ce=!0;sd=8;var te=this.Lc.Pc(15);te.Db(hd.ed);we||(sd=this.ga.Mf(fd,qe.a.Wna,2,!0,Kd,null),fd=32===sd,na.ULS.shipAssertTag(6407387,348,fd,"DeleteForReplace did not succeed. Response is {0}",sd),Ce=fd);Ce&&(fd=hd.mb.qg,we=Pd.SelectionEditor.Ze(fd),na.ULS.shipAssertTag(6407388,348,we,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
fd.contextId),sd=8,we&&(sd=this.ga.Mf(fd,qe.a.Skb,2,!1,Kd,Nd),na.ULS.shipAssertTag(6407389,348,32===sd,"Insertion at IP context did not succeed. Response is {0}",sd),32===sd&&Kl.FocusManager.instance().mg(hd.uJ)));te.dispose();return sd};this.rFm=(hd,fd,sd,Kd,Nd)=>{if(1===sd)return 32;if(Pd.SelectionEditor.l4a(fd))return 2;hd=this.meb.p1i(Nd);Kd.Hs=hd.index;Kd=this.Yc.Rf(fd.node);sd=Kd.zb(11);na.ULS.shipAssertTag(6379466,324,sd,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
xi.a[fd.node.type]);sd=this.Lc.Pc(15);sd.Ut(Kd);Ih.jg.Ge(fd,hd.character,!0,!1);fd=Td.SelectionFactory.ne(Kd.currentNode,fd.cpBegin+1);this.hb.Ac(fd);sd.dispose();return 32};this.ONb=(hd,fd,sd,Kd,Nd)=>{if(1===sd)return 32;Nd.MenuItems=this.Ulk.value;return 32};this.byj=(hd,fd,sd)=>{({kRa:hd}=this.DLc(fd,sd));return hd};this.Vsj=(hd,fd,sd)=>{2===sd&&(new Xk(this.ga,Kl.FocusManager.instance(),ia.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).RUa();return 32};this.V4f=()=>32;this.ga=G;this.Yc=
ha;this.Ulk=new Pb.a(this.Ggm);this.Lc=La;this.meb=lb;this.Nk=Vb;this.hb=tc;this.en=Nc}Ub(){this.ga.fb(qe.a.V4f,Ni.a.application,this.V4f,96);this.ga.qa(qe.a.ONb,Ni.a.view,this.ONb);this.ga.qa(qe.a.qle,Ni.a.view,this.byj);this.ga.qa(qe.a.pce,Ni.a.view,this.x6i);this.ga.qa(qe.a.Skb,Ni.a.view,this.kRa);this.ga.qa(qe.a.ONb,Ni.a.Tc,this.ONb);this.ga.qa(qe.a.qle,Ni.a.Tc,this.byj);this.ga.qa(qe.a.pce,Ni.a.Tc,this.x6i);this.ga.qa(qe.a.Skb,Ni.a.Tc,this.rFm);this.ga.Xc(qe.a.ONb,1124);this.ga.Xc(qe.a.qle,1036);
this.ga.Xc(qe.a.pce,1124);this.ga.Xc(qe.a.Skb,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(qe.a.tVc,Ni.a.view,this.Vsj),this.ga.qa(qe.a.tVc,Ni.a.Tc,this.Vsj),this.ga.Xc(qe.a.tVc,1124))}DLc(G,ha){let La,lb=null;G.view.ue&&(lb=G.view);La=null;if(!lb||!lb.mb)return K.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",G.toString()),{returnValue:!0,ke:lb,selected:La,
kRa:8};La=lb.mb.qg;if(!La)return{returnValue:!0,ke:lb,selected:La,kRa:2};if(this.Nk.a0(La)||this.Nk.yia(La))return{returnValue:!0,ke:lb,selected:La,kRa:8};if(lb.mb.ib.MJ||this.en&&this.en.instance&&this.en.instance.TU(La)||Pd.SelectionEditor.l4a(G.ik))return{returnValue:!0,ke:lb,selected:La,kRa:2};if(Ih.ah.CAa(ul.ParagraphReader.PU,La))return G=8,Ih.Ic.Yb(Hh.a.ef,{["Reason"]:xd.a.zO}),{returnValue:!0,ke:lb,selected:La,kRa:G};G=32;return 1===ha?{returnValue:!0,ke:lb,selected:La,kRa:G}:{returnValue:!1,
ke:lb,selected:La,kRa:G}}static get jg(){return Ih.Md||(Ih.Md=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set jg(G){Ih.Md=G}static get ah(){return ye.ContextSetEditor.instance}static get Ic(){return tg.a.instance}}Ih.Md=null;Object(e.a)(Ih,"SymbolsActor",null,[1854]);class Ze{constructor(G,ha){this.ple=G;this.altText=ha}}Object(e.a)(Ze,"Symbol",null,[]);class If{constructor(){this.eVe=null;this.Pih=new Pb.a(If.Bcf)}get Xkg(){return this.Pih}Hbi(G){this.eVe||(this.eVe=Rc.a(this.Pih.value));
return Array.indexOf(this.eVe,G)}static Bcf(){const G={};G["\u2022"]=new Ze("\u2022",Box4Intl.Box4Strings.L_Bullet);G["\u20ac"]=new Ze("\u20ac",Box4Intl.Box4Strings.L_EuroSign);G["\u00a3"]=new Ze("\u00a3",Box4Intl.Box4Strings.L_PoundSign);G["\u00a5"]=new Ze("\u00a5",Box4Intl.Box4Strings.L_YenSign);G["\u00a9"]=new Ze("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);G["\u00ae"]=new Ze("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);G["\u2122"]=new Ze("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);G["\u00b1"]=
new Ze("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);G["\u2260"]=new Ze("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);G["\u2264"]=new Ze("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);G["\u2265"]=new Ze("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);G["\u00f7"]=new Ze("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);G["\u00d7"]=new Ze("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);G["\u221e"]=new Ze("\u221e",Box4Intl.Box4Strings.L_Infinity);G["\u00b5"]=new Ze("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
G["\u03b1"]=new Ze("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);G["\u03b2"]=new Ze("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);G["\u03c0"]=new Ze("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);G["\u03a9"]=new Ze("\u03a9",Box4Intl.Box4Strings.L_OhmSign);G["\u03a3"]=new Ze("\u03a3",Box4Intl.Box4Strings.L_NArySummation);G["\u00b0"]=new Ze("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);G["\u0394"]=new Ze("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);G["\u263a"]=new Ze("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);G["\u2665"]=new Ze("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);G["\u20b9"]=new Ze("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);G["\u00bf"]=new Ze("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);G["\u00a1"]=new Ze("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);G["\u2014"]=new Ze("\u2014",Box4Intl.Box4Strings.L_EmDash);G["\u2026"]=new Ze("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);G["\u00c0"]=new Ze("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
G["\u00c1"]=new Ze("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);G["\u00c2"]=new Ze("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);G["\u00c3"]=new Ze("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);G["\u00c4"]=new Ze("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);G["\u00c5"]=new Ze("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);G["\u00c6"]=new Ze("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);G["\u00c7"]=
new Ze("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);G["\u00c8"]=new Ze("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);G["\u00c9"]=new Ze("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);G["\u00ca"]=new Ze("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);G["\u00cb"]=new Ze("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);G["\u00cc"]=new Ze("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);G["\u00cd"]=new Ze("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);G["\u00ce"]=new Ze("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);G["\u00cf"]=new Ze("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);G["\u00d1"]=new Ze("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);G["\u00d2"]=new Ze("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);G["\u00d3"]=new Ze("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);G["\u00d4"]=new Ze("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
G["\u00d5"]=new Ze("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);G["\u00d6"]=new Ze("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);G["\u00d9"]=new Ze("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);G["\u00da"]=new Ze("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);G["\u00db"]=new Ze("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);G["\u00dc"]=new Ze("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);G["\u00df"]=
new Ze("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);G["\u00e0"]=new Ze("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);G["\u00e1"]=new Ze("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);G["\u00e2"]=new Ze("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);G["\u00e3"]=new Ze("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);G["\u00e4"]=new Ze("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);G["\u00e5"]=new Ze("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
G["\u00e6"]=new Ze("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);G["\u00e7"]=new Ze("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);G["\u00e8"]=new Ze("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);G["\u00e9"]=new Ze("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);G["\u00ea"]=new Ze("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);G["\u00eb"]=new Ze("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);G["\u00ec"]=new Ze("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);G["\u00ed"]=new Ze("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);G["\u00ee"]=new Ze("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);G["\u00ef"]=new Ze("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);G["\u00f1"]=new Ze("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);G["\u00f2"]=new Ze("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);G["\u00f3"]=new Ze("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
G["\u00f4"]=new Ze("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);G["\u00f5"]=new Ze("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);G["\u00f6"]=new Ze("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);G["\u00f9"]=new Ze("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);G["\u00fa"]=new Ze("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);G["\u00fb"]=new Ze("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);G["\u00fc"]=new Ze("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);G["\u00ff"]=new Ze("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);G["\u011e"]=new Ze("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);G["\u011f"]=new Ze("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);G["\u0130"]=new Ze("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);G["\u0131"]=new Ze("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);G["\u0152"]=new Ze("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
G["\u0153"]=new Ze("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);G["\u015e"]=new Ze("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);G["\u015f"]=new Ze("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);G["\u0178"]=new Ze("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return G}}Object(e.a)(If,"SymbolsLoader",null,[1853]);var Ho=c(403),Me=c(341),Si=c(208),sg=c(651),Fe=c(1498),ch=c(163),Se=c(90);class Mb{constructor(G){this.rle=G}get kHo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}p1i(G){G=
G.SourceControlId.split("_");const ha={};2===G.length?(ha.character=G[1],ha.index=this.rle.Hbi(ha.character)):(ha.character=G[2],ha.index=parseInt(G[1]));return ha}cPk(){return this.zii()}build(){return this.Hgm()}lOk(){const G=new Sys.StringBuilder;G.append('<table class="moreSymbolsTable">');const ha=this.rle.Xkg.value,La=Rc.a(ha);let lb=0;for(;lb<La.length;){lb%15||G.append('<tr role="presentation">');const Vb=ha[La[lb]];G.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+lb,rb.a.uY(Vb.ple),rb.a.uY(Vb.altText)));lb++;lb%15&&lb!==La.length||G.append("</tr>")}G.append("</table>");return G.toString()}Hgm(){const G=this.zii();return ch.o(G)}zii(){const G=Object.assign(new Ho.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});G.MenuSectionList.push(this.Wvk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&G.MenuSectionList.push(this.duk());return G}duk(){const G=Object.assign(new Me.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ha=Object.assign(new Si.a,{Id:"btnMoreSymbols",Command:qe.a.tVc.toString(),LabelText:rb.a.zf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:rb.a.zf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ms,Image16by16Class:Se.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});G.ControlList.push(ha);return G}Wvk(){const G=Object.assign(new Me.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ha=Object.assign(new sg.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),La=this.rle.Xkg.value,lb=Rc.a(La),Vb=Math.min(25,lb.length);for(let Nc=0;Nc<Vb;Nc++){var tc=La[lb[Nc]];tc=Object.assign(new Fe.a,{Id:String.format("{0}{1}_{2}","symbol_",Nc,tc.ple),Character:tc.ple,Command:qe.a.Skb.toString(),QueryCommand:qe.a.pce.toString(),Alt:rb.a.zf(tc.altText)});ha.GalleryItems.push(tc)}G.ControlList.push(ha);
return G}}Object(e.a)(Mb,"SymbolsUiBuilder",null,[1852]);var hj=c(49),ak=c(238),xj=c(551),jo=c(373);class To{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Ub()}dispose(){}wc(G){this.W=G;this.W.register(If,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Mb(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.W.ia("Box4.Symbols.SymbolsActor",()=>new Ih(l.AFrameworkApplication.va,new xj.a,new jo.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),ak.a.instance,hj.a.instance,this.W.Sa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){M.a.instance.Gc(new To)}}Object(e.a)(To,"Box4SymbolsPackage",null,[1,2]);var ep=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},yn=c(1656),ko=c(1610),fq=c(1593),Rp=c(1985),yj=c(232),Io=c(402);class Qm{constructor(){this.uKa=null}wc(G){this.container=G}init(){this.uKa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.uKa&&this.uKa.dispose()}}Object(e.a)(Qm,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class Dl{get A6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get B6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get C6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Fyn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Shc(){return CommonUIStrings.l_AccCheckerPaneTitle}get hCn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(Dl,"AccessibilityCheckStringsProvider",null,[59]);
class ek{constructor(){this.Vgj=this.contentId=null}}Object(e.a)(ek,"ResultIds",null,[]);class Zh{constructor(G,ha){this._element=null;this.ig=ha;this.ge=G}get element(){this._element||(this._element=this.yal(),this.Qz());return this._element}Dfg(G){this._element=G}dispose(){this.element&&(this.caa(),this.Dfg(null))}Qz(){this.ig&&this.ge?(this.ig.ob(U.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.ob(U.a.gi,this.element,Object(a.a)(this,this.$G,"onKeyPress"))):na.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}caa(){this.ig&&this.ge&&(this.ig.uc(U.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.uc(U.a.gi,this.element,Object(a.a)(this,this.$G,"onKeyPress")))}onClick(){this.oWi();return!0}$G(G){return this.fQm(G.Hb.keyCode)?(this.oWi(),!0):!1}fQm(G){return G===kk.a.spe||G===kk.a.Rs}}Object(e.a)(Zh,"AInteractivePaneElement",null,[138,10]);var Fh=c(451),
Xi=c(57);class Oi extends Zh{constructor(G,ha,La){super(G,ha);this.IMe=La}hide(){this.element.removeAttribute(wf.a.uh);wf.a.kr(this.element,wf.a.uA,wf.a.xp);this.element.style.display="none"}show(){wf.a.kr(this.element,wf.a.uA,wf.a.yM);wf.a.kr(this.element,wf.a.uh,wf.a.n3e);this.element.style.display="block"}yal(){const G=Fh.b("div",this.ASi,"AccCheckerNotification");wf.a.kr(G,wf.a.Tvh,wf.a.xp);wf.a.kr(G,wf.a.Bga,this.uUf);G.tabIndex=0;const ha=Fh.b("span",this.zSi,"AccCheckerNotificationIcon");var La=
Se.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ha.appendChild(La);La=Fh.b("span",this.uUf,"AccCheckerNotificationText");Xi.a.wv(La,this.BSi);G.appendChild(ha);G.appendChild(La);return G}oWi(){this.IMe()}}Object(e.a)(Oi,"APopupNotification",Zh,[137,138,10]);class nb extends Oi{constructor(G,ha,La,lb){super(G,ha,La);this.hua=lb}get ASi(){return"AccCheckerOutOfSyncNotificationId"}get zSi(){return"AccCheckerOutOfSyncNotificationIconId"}get uUf(){return"AccCheckerOutOfSyncNotificationTextId"}get BSi(){return this.hua.Fyn}}
Object(e.a)(nb,"OutOfSyncNotification",Oi,[]);class Bc extends Oi{constructor(G,ha,La,lb){super(G,ha,La);this.hua=lb}get ASi(){return"AccCheckerPartialResultNotificationId"}get zSi(){return"AccCheckerPartialResultNotificationIconId"}get uUf(){return"AccCheckerPartialResultNotificationTextId"}get BSi(){return this.hua.hCn}}Object(e.a)(Bc,"PartialResultNotification",Oi,[]);var wc=c(190),Zc=c(32),Ne=c(176);class df{constructor(G,ha,La,lb=null,Vb=null,tc=null,Nc=null){this.ceh=this.oM=this.ge=this.uKa=
null;this.T0=lb;this.ig=G;this.Vb=ha;this.np=La;this.hua=Nc||new Dl;this.xNe=Vb||new nb(this.T0,this.ig,Object(a.a)(this,this.Vol,"dimissOutOfSyncNotification"),this.hua);this.mOe=tc||new Bc(this.T0,this.ig,Object(a.a)(this,this.Wol,"dimissPartialResultNotification"),this.hua)}show(){}hide(){}get T0(){return this.ge||(this.ge=l.AFrameworkApplication.ta.oD)}set T0(G){this.ge=G}$Lh(){}cpa(){}dispose(){}s9a(){}AHm(G){var ha=this.ceh[G];G=ha.contentId;if((ha=ha.Vgj+"")&&ha.length){const La=[];Array.add(La,
Object.assign(new Zc.a,{name:"RuleID",string:ha}));wc.a.sendTelemetryEvent(Object.assign(new Ne.a,{name:String.format("{0}.{1}",df.Vlg,"ViolationSelected"),dataFields:La}))}this.Tgn(G)}Tgn(G){G&&this.uKa.vjo(G)||(this.Vb.FL(mg.AFrame.knh,!1),this.Nwo())}Vol(){this.iad(!1)}Wol(){this.Nsj(!1)}Nwo(){const G=Object.assign(new Dh.StandardDialog(!0),{Kt:l.AFrameworkApplication.cda,Cd:1,fJa:!1});G.FV(1);G.ye(1,this.hua.A6k);G.ye(0,CommonUIStrings.l_DialogCancel);G.IV(this.hua.C6k,this.hua.B6k,ha=>{1===ha&&
this.BDf()})}iPk(G){let ha=null;if(G.Results&&0<G.Results.length){ha={};let La=0;for(const lb of G.Results)lb.ResultId=df.dqk+ ++La,G=new ek,G.contentId=lb.ContentId,G.Vgj=lb.RuleId,ha[lb.ResultId]=G}return ha}m8m(){wc.a.addNamespaceMapping(df.Vlg,df.CJo);wc.a.sendTelemetryEvent(Object.assign(new Ne.a,{name:String.format("{0}.{1}",df.Vlg,"ShowTaskpane")}))}}df.dqk="AccCheckResult";df.Vlg="Office.UX.AccChecker";df.CJo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(df,
"BaseAccessibilityCheckPane",null,[58,10]);class Kf{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(Kf,"AccCheckerTaskPaneProps",null,[]);var af=c(1413),Ji=c(1429),aj=c(1074),ph=c(183);class ij extends df{constructor(G,ha,La,lb,Vb=null,tc=null,Nc,hd=null,fd=null){super(ha,
La,lb,tc,void 0,void 0,hd);this.dLg=null;this.Pch=this.lOe=this.utd=this.Gwd=this.awd=!1;this.EXe=null;this.zVe=!!l.AFrameworkApplication.ta&&!!l.AFrameworkApplication.ta.Kb&&l.AFrameworkApplication.ta.Kb.TIf;this.Ivc=this.y6=null;this.twc=0;this.wnd=null;this.EZ=Vb;fd&&(this.y6=fd.yBd,this.Ivc=fd.Wjp,this.twc=fd.Alp);this.lB=new Ji.a}get isVisible(){return this.Pch}NUa(G){this.Pch=G}zgf(G){G&&(this.dLg=G,G.IsSuccess&&(this.ceh=this.iPk(G),G.IsPartialResult&&this.Nsj(!0)),this.awd=!0,this.Gwd=!1,
this.Lm())}iad(G){this.isVisible&&G!==this.utd&&(this.utd=G,this.Lm())}Nsj(G){this.lOe=G;this.Lm()}WP(){this.Gwd||ph.UISurfaces.Pu().then(G=>{xa.a.instance.wz(ij.Psb+":PaneOpen:Start");G.showTaskPane(ij.Psb,this.xA());this.BDf();return null});this.isVisible?ph.UISurfaces.Pu().then(G=>{G.setSelectedTaskPane(ij.Psb);return null}):this.m8m()}Lm(){ph.UISurfaces.Pu().then(G=>{G.updateTaskPane(ij.Psb,this.xA());return null})}xA(){var G=new Kf;this.lB.iqb(G);G=Object.assign(new aj.a,{title:this.hua.Shc,
hideHeader:!1,width:320,location:2,contentProps:G,onOpen:()=>{this.G$();this.NUa(!0);l.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.nea();this.NUa(!1);this.Gwd=this.awd=!1;this.Lm();l.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.zVe&&(G.enableResize=!0,G.minResizeWidth=268,G.maxResizeWidth=920);return G}initialize(G){const ha=this.Vb.fe(ij.Psb);ha.parent=mg.AFrame.Ap;ha.fI=!0;this.uKa=G;this.hrk()}dispose(){this.s9a();this.xNe&&(this.xNe.dispose(),this.xNe=null);
this.mOe&&(this.mOe.dispose(),this.mOe=null);super.dispose()}hrk(){this.lB.GL(this.onRecheckExecute());this.lB.GL(this.BMl());this.lB.GL(this.rcm());this.lB.GL(this.onInvokeNavigateExecute());this.lB.GL(this.l0l());this.lB.GL(this.n8l());this.lB.GL(this.h$l());this.lB.GL(this.updateLastScanTime());this.lB.GL(this.showHelpPane())}onRecheckExecute(){return G=>{G.onRecheckExecute=()=>{this.BDf()}}}BMl(){return G=>{G.accessibilityCheckResultCollection=this.dLg}}rcm(){return G=>{G.resultsReady=this.awd}}onInvokeNavigateExecute(){return G=>
{G.onInvokeNavigateExecute=ha=>{this.AHm(ha)}}}l0l(){return G=>{G.helpLink=this.OAl}}n8l(){return G=>{G.outOfSync=this.utd}}h$l(){return G=>{G.partialResult=this.lOe}}updateLastScanTime(){return G=>{G.updateLastScanTime=ha=>{this.EXe=ha}}}showHelpPane(){return G=>{G.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.eL||this.Evh()?this.wnd?this.wnd():this.y6.value&&this.Ivc&&
this.twc&&this.y6.value.Qb(this.twc,2,this.Ivc):this.Otj():this.Evh()?this.wnd?this.wnd():this.y6.value&&this.Ivc&&this.twc&&this.y6.value.Qb(this.twc,2,this.Ivc):this.Otj()}}}Evh(){return!this.EZ||!this.EZ.value}Otj(){const G=this.EZ.value;if(G){var ha={};ha.query=ij.Ogk+ij.g6j;ha=Object.assign(new af.a,{bS:ha});G.V5(ij.QDe,ha)}}BDf(){this.lOe=this.utd=this.awd=!1;this.EXe&&this.EXe();this.Lm();this.Gwd=!0;this.uKa.Tmn()}G$(){this.Vb.mg(ij.Psb)}nea(){this.e5a()&&this.Vb.mg(this.Vb.iU)}e5a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===ij.Psb}}ij.Psb="AccessibilityCheckerPane";ij.g6j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ij.QDe="FA000000012";ij.Ogk="AssetID=";Object(e.a)(ij,"ReactAccessibilityCheckPane",df,[]);class Ng extends ij{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd=null){super(G,ha,La,lb,Vb,tc,void 0,fd);this.R2j=hd;this.J3=Nc}get OAl(){return this.R2j}WP(){this.J3.dPa();super.WP()}}Object(e.a)(Ng,"ReactLiveBooksAccessibilityCheckPane",ij,[]);var Oc=c(1165),Sg=c(141),li=c(178),de=c(65),ke=c(172),Ti=
c(508),Uf;(function(G){G[G.error=0]="error";G[G.warning=1]="warning";G[G.tip=2]="tip";G[G.intelligentService=3]="intelligentService"})(Uf||(Uf={}));Object(e.b)("AccessibilityRuleCategory",Uf);class fk{constructor(G,ha,La=null){this.Gse=null;this.d2g=this.M0g=!1;this.ZNa=G;this.Dgd=ha;this.ga=La;this.oc.qa(n.a.U_k,y.a.frame,Object(a.a)(this,this.d9e,"closePane"))}get oc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set oc(G){this.ga=G}Swl(){this.M0g||(this.ZNa.initialize(this),this.Dgd.initialize(this),
this.M0g=!0)}Tmn(){K.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Dgd.V$n()}WP(G,ha,La){if(1===La)return Bh.SessionStatusManager.instance.Yj?8:32;this.ZNa.isVisible||this.Swl();this.qyo();return 32}d9e(G,ha,La){1!==La&&this.ZNa.cpa();return 32}Ytn(){this.ZNa.iad(!0)}zgf(G){if(G){if(G.AccessibilityRules&&Object.keys(G.AccessibilityRules).length){const La=G.AccessibilityRules;for(let lb in La){var ha=lb;const Vb=La[lb].RuleId+"";ha!==Vb&&K.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
ha,Vb)}this.Gse=La}else!this.Gse&&G.Results&&0<G.Results.length?(K.b(18993251,200,15,"No accessibility rule definitions available"),G.IsSuccess=!1):G.AccessibilityRules=this.Gse;G.IsSuccess||K.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.w0n(G);this.c8m(G);this.ZNa.zgf(G)}}w0n(G){const ha=G.AccessibilityRules;if(G=G.Results)for(let La=G.length-1;0<=La;La--){const lb=G[La];let Vb="";const tc=lb.RuleId;lb.ContentName||(Vb+="Result does not have content name. ");tc in ha||(Vb+=String.format("No accessibility check rule exists for ID {0}.",
tc));0<Vb.length&&(K.b(36214999,200,15,"Omitting invalid accessibility check result: "+Vb),Array.removeAt(G,La))}}zdm(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):ia.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("accessibility-checker-pane-strings")}qyo(){this.d2g?this.ZNa.WP():this.zdm().then(()=>{this.d2g=!0;this.ZNa.WP()}).catch(G=>na.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
G))}c8m(G){var ha={};const La={};var lb=G.Results,Vb=[];Array.add(Vb,Object.assign(new Zc.a,{name:"FinalViolationCount",int64:0}));Array.add(Vb,Object.assign(new Zc.a,{name:"FinalErrorCount",string:"0"}));Array.add(Vb,Object.assign(new Zc.a,{name:"FinalWarningCount",string:"0"}));Array.add(Vb,Object.assign(new Zc.a,{name:"FinalTipCount",string:"0"}));Array.add(Vb,Object.assign(new Zc.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(lb){for(const hd of lb)if(G.AccessibilityRules){var tc=G.AccessibilityRules[hd.RuleId];
if(tc){if(ha[Uf[tc.Category]]){let fd=ha[Uf[tc.Category]];ha[Uf[tc.Category]]=++fd}else ha[Uf[tc.Category]]=1;La[hd.RuleId]?(tc=La[hd.RuleId],La[hd.RuleId]=++tc):La[hd.RuleId]=1}}Vb[0].int64=lb.length;for(var Nc in ha)switch(G=ha[Nc],lb=Nc,lb="Final"+lb.charAt(0).toUpperCase()+lb.substring(1,lb.length)+"Count",lb){case "FinalErrorCount":Vb[1].string=G.toString();break;case "FinalWarningCount":Vb[2].string=G.toString();break;case "FinalTipCount":Vb[3].string=G.toString();break;case "FinalIntelligentServiceCount":Vb[4].string=
G.toString()}}wc.a.sendTelemetryEvent(Object.assign(new Ne.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Vb}));for(let hd in La)ha=hd,Vb=La[hd],Nc=[],Array.add(Nc,Object.assign(new Zc.a,{name:"RuleID",string:ha})),Array.add(Nc,Object.assign(new Zc.a,{name:"FinalViolationCount",string:Vb.toString()})),wc.a.sendTelemetryEvent(Object.assign(new Ne.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Nc}))}dispose(){this.ZNa&&
this.ZNa.dispose();this.Dgd&&this.Dgd.dispose()}}Object(e.a)(fk,"AAccessibilityCheckManager",null,[53,10]);var lk=c(311);const dj=[12,14,22,19,30,43,44];class ci extends fk{constructor(G,ha,La,lb,Vb,tc){super(ha,La,G);this.oc.qa(n.a.nhg,y.a.frame,this.WP.bind(this));this.oc.fb(n.a.MNn,y.a.frame,this.z6i.bind(this),96);this.graph=Vb;this.ack=lb;this.s9j=tc;this.rhc=()=>{this.Ytn()};this.SXn()}z6i(G,ha,La,lb,Vb){if(1===La)return 32;Vb[lk.a.On]=this.ZNa.isVisible;return 32}vjo(G){if(this.s9j)return na.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;na.ULS.shipAssertTag(20272215,334,!!G);return this.ack.Ngn(G)}SXn(){for(const G of dj){const ha=this.graph.Te(G);ha.qo(this.rhc);ha.ku(this.rhc);ha.kw(this.rhc)}}zTo(){for(const G of dj){const ha=this.graph.Te(G);ha.UP(this.rhc);ha.xV(this.rhc);ha.bea(this.rhc)}}dispose(){super.dispose();this.zTo()}}Object(e.a)(ci,"WordAccessibilityCheckManager",fk,[]);var Sh=c(76),Xg=c(28),Pe=c(101),xe=c(18),pg=c(169),jm=c(6),vg=c(14),mh=c(475);class Nl{constructor(G,
ha,La,lb,Vb,tc,Nc){this.kn=null;this.JDb=0;this.Yc=ha;this.lA=La;this.hb=lb;this.ga=Vb;this.ld=tc;this.hu=G;this.ud=Nc}get dQ(){if(!this.kn){const G=this.Yc.Rf(this.hu.Zc);this.lA.yog(G);if(G.zb(7)||G.jd(7))this.kn=Sh.a.Gs(G,G.origin)}return this.kn}Ngn(G){if(!G||!G.Bg||0>=G.Bg.length)return na.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var ha=Array(G.Bg.length);let La=7,lb=null;for(let tc=0;tc<G.Bg.length;tc++)if(lb=this.UEl(G.Bg[tc])){if(7===La)La=this.JDb;else if(La!==
this.JDb)return na.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var Vb=this.ud.pTa(lb.characterData,lb.ra);const Nc=G.cpBegin?this.ud.gDb(Vb,G.cpBegin):-1;Vb=G.cpEnd?this.ud.gDb(Vb,G.cpEnd):-1;if(-1>Nc||-1>Vb)return na.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;ha[tc]=Xg.a.cR(Nc,Vb,!1,lb);switch(G.contentType){case 5:if(!Pe.a.pTc(ha[tc],!1))return!1;break;case 6:if(!xe.ImageReader.S4(ha[tc]))return!1;
break;case 7:ha[tc]=Xg.a.cR(-1,-1,!1,lb)}}else return!1;ha=new pg.Selection(ha,!1);return this.roo(lb,ha,G.contentType)}UEl(G){if(this.dQ)for(this.dQ.reset(),this.JDb=7;this.dQ.moveNext();){var ha=this.dQ.currentNode.type;if(38===ha||36===ha||23===ha)this.JDb=ha;else if(12===ha){ha=this.dQ.currentNode;const La=ha.ja(jm.a.Wc,0);if(G===La)return ha}}return null}Ukg(G){this.ga.processAction(vg.a.kU,2);this.ga.processAction(vg.a.r4,2);let ha=2;switch(this.JDb){case 23:ha=32;break;case 38:ha=this.ga.Qb(vg.a.u6a,
2,new mh.a(G));break;case 36:ha=this.ga.Qb(vg.a.umb,2,new mh.a(G));break;default:na.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.JDb)}if(32===ha)return!0;na.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.JDb);return!1}roo(G,ha,La){if(this.Ukg(G)){G=this.hu.ju;const lb=this.hb.ib.lb;lb&&lb.equals(ha)&&this.ld.rea(G,null);this.ld.rea(G,ha);switch(La){case 0:case 1:this.ga.processAction(qe.a.ZPb,2);break;case 2:this.ga.processAction(qe.a.Y8c,
2);break;case 3:this.ga.processAction(qe.a.Eza,2)}return!0}return!1}}Object(e.a)(Nl,"WordAccessibilityCheckNavigateManager",null,[1959]);class sn{constructor(G){this.uKa=null;this.xXg=G}get fileId(){return this.xXg?this.xXg():null}initialize(G){this.uKa=G}CUi(G){this.uKa.zgf(G)}}Object(e.a)(sn,"AAccessibilityCheckService",null,[57,10]);class bn{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(G){G=Sys.Serialization.JavaScriptSerializer.deserialize(G);
const ha=G.AccessibilityRules,La={};if(ha)for(let lb=0;lb<ha.length;++lb){const Vb=ha[lb];La[Vb.Key]=Vb.Value}G.AccessibilityRules=La;return G}}Object(e.a)(bn,"AccessibilityCheckResultCollection",null,[]);class Ol extends sn{constructor(G){super(G);this.onFailure=(ha,La)=>{na.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",La);ha=Object.assign(new bn,{IsSuccess:!1});this.CUi(ha)};this.onSuccess=ha=>{ha=Ol.pcm(ha);let La=null;if(ha)try{La=this.oml(ha)}catch(lb){na.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",lb.message),La=Object.assign(new bn,{IsSuccess:!1})}else na.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),La=Object.assign(new bn,{IsSuccess:!1});this.CUi(La)}}dispose(){}static pcm(G){let ha=null;G&&G.Mj&&(ha=G.Mj[0]);return ha?ha.Body:null}}Object(e.a)(Ol,"ALiveBooksAccessibilityCheckService",sn,[]);var Dm=c(1009),sc=c(1038),Hm=c(1483),Rm=c(233),hn=c(532);class km extends Rm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=
!1}ml(){return hn.a.accCheck}static construct(G,ha){const La=new km;La.FileId=G;La.IsCoauthorable=ha;return La}}Object(e.a)(km,"WordAccessibilityCheckRequest",Rm.a,[]);class On{}Object(e.a)(On,"AccessibilityCheckRule",null,[]);var Ad=c(189);class Jo{static parse(G){switch(rb.a.eh(G)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw G=String.format("Invalid Accessibility result category: {0}",G),Ad.a.argument(G);}}}Object(e.a)(Jo,
"AccessibilityRuleCategoryParser",null,[]);class oq{constructor(){this.Category=this.Text=this.Id=null}static HLo(G){const ha=new On;ha.RuleId=G.Id;ha.RuleName=G.Text;ha.Category=Jo.parse(G.Category);return ha}}Object(e.a)(oq,"WordAccessibilityCheckRule",null,[]);class lm{}Object(e.a)(lm,"AccessibilityCheckResult",null,[]);class Ko{constructor(){this.cpEnd=this.cpBegin=this.Bg=null;this.contentType=0}}Object(e.a)(Ko,"WordAccessibilityCheckContentId",null,[]);const zc=G=>{switch(rb.a.eh(G)){case "tableheading":return 0;
case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Fn=c(1627);class jd{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static FLo(G){const ha=new lm;ha.RuleId=G.RuleId;ha.ContentName=G.Label;const La=new Ko;La.Bg=G.ParaId;La.cpBegin=Fn.b(G.OS);La.cpEnd=Fn.b(G.OE);La.contentType=zc(G.ContentType);
ha.ContentId=La;return ha}}Object(e.a)(jd,"WordAccessibilityViolation",null,[]);class Em{constructor(){this.Violations=this.Rules=null}static GLo(G){const ha=new bn;try{var La={};if(G.Rules){for(let lb=0;lb<G.Rules.length;++lb){const Vb=oq.HLo(G.Rules[lb]);La[Vb.RuleId]=Vb}ha.AccessibilityRules=La}if(G.Violations){const lb=Array(G.Violations.length);for(La=0;La<G.Violations.length;++La)lb[La]=jd.FLo(G.Violations[La]);ha.Results=lb}ha.IsPartialResult=!1;ha.IsSuccess=!0}catch(lb){na.ULS.shipAssertTag(20272214,
334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",lb.message),ha.IsSuccess=!1}return ha}}Object(e.a)(Em,"WordAccessibilityCheckResult",null,[]);class Pl extends Ol{constructor(G,ha,La){super(G);this.ovb=ha;this.$bb=La}V$n(){const G=Object.assign(new Dm.a,{Iq:km.construct(this.fileId,this.$bb),status:sc.a.requestReady,aH:"AccessibilityCheck"});this.ovb(Hm.a.accChecker,!1,this.onSuccess,this.onFailure,G,null,G)}oml(G){G=Ia.b(G);return Em.GLo(G)}}Object(e.a)(Pl,
"WordAccessibilityCheckService",Ol,[]);class Sp extends Qm{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(G){super.wc(G);G.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Ng(l.AFrameworkApplication.va,yj.a.instance,Kl.FocusManager.instance(),Io.a.instance,G.Ve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Oe.KeyInputManager.instance,Oc.a.instance,l.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).ha();G.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",
()=>new Pl(()=>l.AFrameworkApplication.rootQuerySignature,Ti.a.mR,Sg.PageReader.instance.KSd(Ld.StaticActiveAppFrame.za().jb.Zc))).ha();G.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Nl(Ld.StaticActiveAppFrame.za().jb,G.resolve("Box4.Graph.IGraphIteratorFactory"),li.PageNavigator.instance,G.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,de.InteractiveViewManager.instance,G.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();
G.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new ci(l.AFrameworkApplication.va,G.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),G.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),G.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),hb.App.li.Al,ke.App.FXc)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{Qm.prototype.init.call(this)})}}Object(e.a)(Sp,"WordAccCheckerPackageManager",
Qm,[]);class vl{constructor(G,ha){this.Kih=!1;this.bPo=()=>{this.aPo()};this.Vk=G;this.YI=ha}$Sa(G){G.R0e(this.bPo)}aPo(){!this.Kih&&this.Vk&&(this.Vk.aHa?this.YI?this.YI.execute(G=>{G.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):na.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.Kih=!0)}}Object(e.a)(vl,"CoauthSurveyManager",null,[1847]);class fp{constructor(){this.hu=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){Ld.StaticActiveAppFrame.za()&&
(this.hu=Ld.StaticActiveAppFrame.za().jb)&&(this.hu.Cxa?this.oka():this.hu.vga(()=>{this.oka()}))}oka(){var G=this.hu.Zc;G&&(G=G.contentReplicator)&&this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").$Sa(G)}dispose(){}wc(G){this.W=G;G.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new vl(G.resolve("WordEditor.IWordEditorCoauthManager"),G.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").ha()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&
M.a.instance.Gc(new fp)}}Object(e.a)(fp,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var to;(function(G){G[G.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";G[G.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";G[G.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(to||(to={}));Object(e.b)("ComponentLoggingScenario",to);var cn=c(1475);class Pk{flush(G,ha){const La=this.cWl(G);La.LoggingScenario=to[ha];Rc.a(La).length?
na.ULS.sendTraceTag(594571986,3013,15,"{0}",La):na.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",cn.a[G.I0a])}cWl(G){const ha={};if(!G)return ha;const La=new ld.a;for(La.enqueue(G);!La.isEmpty;){G=La.dequeue();const lb=cn.a[G.I0a];try{ha[lb]=G.VC()}catch(Vb){na.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",lb.toString(),{["Kind"]:"Exception",["Stack"]:Vb.stack,["Message"]:Vb.message,
["FileName"]:Vb.fileName,["LineNumber"]:Vb.lineNumber})}if((G=G.WHd)&&G.length)for(const Vb of G)!Vb||cn.a[Vb.I0a]in ha||La.enqueue(Vb)}return ha}}Object(e.a)(Pk,"ComponentStateLogManager",null,[1849]);class zq{flush(){}}Object(e.a)(zq,"NoOpComponentStateLogManager",null,[1849]);class Qk{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}wc(G){this.W=G;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?
G.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Pk).as("Common.IComponentStateLogManager").ha():G.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new zq).as("Common.IComponentStateLogManager").ha()}static main(){M.a.instance.Gc(new Qk)}}Object(e.a)(Qk,"WordEditorComponentStateLoggingPackage",null,[1,2]);var kh=c(316),bm=c(648),mm=c(780),Df=c(781);class Ym{constructor(G,ha=null,La=-1,lb=null){this.y_=G;this.imh=lb||(()=>ha);this.jkd=La}nj(G,ha,La,lb,
Vb,tc,Nc,hd,fd,sd=null,Kd=!1,Nd=null,we=null){const Ce=new XMLHttpRequest;let te="";tc="";2===ha?(te="POST",La&&(tc=La)):te="GET";ha={};this.y_&&(G=kh.a.$Bd(ha,G,kh.a.wTb,l.AFrameworkApplication.L9a,this.y_));Ce.open(te,G,!0);this.gPk(ha,G);if(lb)for(let Cf in lb)Ce.setRequestHeader(Cf,rb.a.MB(lb[Cf]));for(let Cf in ha)Ce.setRequestHeader(Cf,ha[Cf]);G=Nd||this.jkd;0<G&&(Ce.timeout=G);G=[];Array.add(G,kh.a.ZQ);lb=new Sys.Net.WebRequest;const fe=new mm.a(1,2,lb,G,Vb,Nc,hd,fd,Kd,sd,we);Ce.onreadystatechange=
()=>{this.qtn(Ce,fe)};try{Ce.send(tc)}catch(Cf){na.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}R$b(){return 1}qtn(G,ha){if(this.jXk(G,ha)&&4===G.readyState)if(G.getResponseHeader(kh.a.Kif)&&l.AFrameworkApplication.sNc)l.AFrameworkApplication.sNc();else{var La=G.getResponseHeader(kh.a.d7e);kh.a.xpg(La);this.VZo(G,ha);G.status===cj.a.Zz?(ha.status=2,ha.sI(new Df.a(ha))):(ha.status=G.status&&G.status!==cj.a.rPb?G.status===cj.a.Bja?5:3:7,ha.x4(new bm.a(ha)))}}gPk(G,
ha){G["X-xhr"]=1;l.AFrameworkApplication.JRa&&(G[kh.a.D3d]=1);l.AFrameworkApplication.buildVersion&&(G[kh.a.TSa]=rb.a.MB(l.AFrameworkApplication.buildVersion));let La=null;this.imh&&(La=this.imh());La&&(G[kh.a.Sed]=La);l.AFrameworkApplication.canary&&(G[kh.a.cva]=rb.a.MB(l.AFrameworkApplication.canary),l.AFrameworkApplication.Omb&&na.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",G[kh.a.cva]));l.AFrameworkApplication.accessToken&&(kh.a.uCb(ha,l.AFrameworkApplication.nX)||(G[kh.a.FFc]=rb.a.MB(l.AFrameworkApplication.accessToken)),
kh.a.uCb(ha,l.AFrameworkApplication.wba)||(G[kh.a.GFc]=l.AFrameworkApplication.Eua.toString()));l.AFrameworkApplication.userType&&(G[kh.a.ope]=rb.a.MB(l.AFrameworkApplication.userType))}VZo(G,ha){ha.Ne=G.status?G.status:cj.a.rPb;try{ha.te=G.responseText;if(void 0!==ha.iUa&&null!==ha.iUa){ha.jj={};for(let La=0;La<ha.iUa.length;++La){const lb=ha.iUa[La];ha.jj[lb]=G.getResponseHeader(lb)}}ha.Nie&&(ha.Qja=G.responseText&&G.responseText.length?G.responseXML:null)}catch(La){na.ULS.sendTraceTag(24938645,
205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",ha.id,ha.request.get_url(),4===G.readyState)}}jXk(G,ha){return G?ha?!0:(na.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(na.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(G,ha,La){return new Ym(G,null,La,ha)}}Object(e.a)(Ym,"SimpleClientRequestSender",
null,[1074]);class jn{constructor(G,ha,La){this.Zf=G;this.Pxd=ha;this.Nch=La}nj(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd=null,Kd=!1,Nd=null,we=null,Ce=null,te=null,fe=!1){return this.Nch?this.Pxd.nj(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,we,Ce):this.Zf.nj(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd,we,Ce,te,fe)}R$b(G){return this.Nch?this.Pxd.R$b():this.Zf.R$b(G)}}Object(e.a)(jn,"ClientRequestAdapter",null,[1141]);var lf=c(212),mk=c(258),Af=c(224),Tg=c(1424),hl=c(1434),Qq=c(2077),la=c(52),bb=c(312),qb=c(743),ac=c(602),yc=c(113),
$c=c(578),Vd=c(614),me;(function(G){G[G.none=0]="none";G[G.getCells=1]="getCells";G[G.hotStoreStatus=2]="hotStoreStatus";G[G.saveMonitor=3]="saveMonitor";G[G.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";G[G.kickoutExecutor=5]="kickoutExecutor"})(me||(me={}));Object(e.b)("MostRecentRevisionIdOrigin",me);class Md extends Sys.EventArgs{constructor(G,ha,La,lb){super();this.DZc=G;this.httpStatusCode=La;this.hI=lb}}Object(e.a)(Md,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);
class Re{constructor(){this.E7=0}get isEmpty(){return!this.E7}hGc(G){this.E7|=G}kYc(G){return!!(this.E7&G)}clear(){this.E7=0}nIc(){return!1}}Object(e.a)(Re,"DocxSaveMonitorRetryAttemptOnce",null,[]);class We{constructor(G,ha=3){this.E7=0;this.dwd=new Map;this.rbk=G;this.fik=ha}get isEmpty(){return!this.E7}hGc(G){this.E7|=G;let ha=this.dwd.get(G)||0;this.dwd.set(G,++ha)}kYc(G){return!!(this.E7&G)}clear(){this.E7=0;this.dwd.clear()}nIc(G){return this.fik&G?(this.dwd.get(G)||0)<this.rbk:!1}}Object(e.a)(We,
"DocxSaveMonitorRetryAttemptMany",null,[]);class bg{static create(G=!1,ha=3,La=0){return G?new We(ha,La):new Re}}Object(e.a)(bg,"DocxSaveMonitorRetryAttemptFactory",null,[]);class yf extends Rm.a{constructor(){super();this.CellId=this.FileId=null}ml(){return hn.a.getLastSavedRevision}static construct(G){const ha=new yf;ha.FileId=G.Zi().yr;ha.CellId=yc.a(G.Mc.id);return ha}}Object(e.a)(yf,"LastSavedRevisionRequest",Rm.a,[]);var Rf;(function(G){G[G.xop=-1]="noResultYet";G[G.pvp=0]="upToDate";G[G.rsp=
1]="sessionLost";G[G.zvp=2]="userSignedOut";G[G.tqp=3]="previousRequestPending";G[G.Fee=4]="requestFailed";G[G.Tsp=5]="shuttingDown";G[G.Iop=6]="nullResponseData";G[G.rmp=7]="invalidResponseData";G[G.Ejp=8]="failedRevisionLookup";G[G.Orp=9]="savedWithinThreshold";G[G.Cop=10]="notSavedWarning";G[G.Kmp=11]="kickoutThreshold";G[G.avp=12]="unknownRevision";G[G.lhp=13]="contentNotYetLoaded";G[G.sessionExpired=14]="sessionExpired";G[G.canaryError=15]="canaryError";G[G.timeout=16]="timeout";G[G.Lmp=17]=
"kickoutThreshold_Offline";G[G.Bip=18]="dssSessionDeleted";G[G.Cip=19]="dssSessionExpired";G[G.Ivp=20]="waitingForSessionTokenRefresh";G[G.Dip=21]="dssSessionNotFound"})(Rf||(Rf={}));Object(e.b)("SaveMonitorResult",Rf);class bf{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd,we,Ce,te,fe,Cf,Th,Vf,Gj,Qh,zg,$i,xm,Xj,Dg=null,Qg){this.Mzc=0;this.AYb=!1;this.rCc=null;this.uyc=this.fO=-1;this.mPe=null;this.Eud=0;this.Fud=!1;this.Ixb=null;this.tAc=0;this.YRe=this.Pjh=null;this.NS=this.$4g=this.Fuc=0;this.wJe=
null;this.g2g=!1;this.am=null;this.Qxd=0;this.Ogh=!1;this.neh=0;this.Rgh=!1;this.$Fl=()=>{var cg;na.ULS.sendTraceTag(524871194,bf.$m,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.YU,["AppVisibilityState"]:Tg.a[null===(cg=this.am)||void 0===cg?void 0:cg.LD]});try{if(this.Ogh&&this.Zvc){var jf=this.Zvc();na.ULS.sendTraceTag(509367249,bf.$m,50,"Additional Details: {0}",jf)}}catch(Cn){cg=Ia.c({["Kind"]:"Exception",["Stack"]:Cn.stack,["Message"]:Cn.message,["FileName"]:Cn.fileName,["LineNumber"]:Cn.lineNumber}),
na.ULS.sendTraceTag(509367062,bf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",cg)}cg=this.Qwb;this.Qwb=this.cA();if(this.Maa())this.kA.event(5),this.stop("session has shut down");else if(this.Zbb===bf.Gfj&&this.sAa(this.bvb),jf=this.GXb())if(this.NHe()&&l.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.YU)this.kA.event(0);else if(this.EYb())this.kA.event(1),this.stop("session is lost"),
l.AFrameworkApplication.se("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.g2g&&!this.gQm()&&(na.ULS.sendTraceTag(554726995,bf.$m,10,"DocxSaveMonitor: Session lost but not kicked out"),this.gI(la.a.XUh));else if(this.NHe())20!==this.kA.currentState?(this.kA.event(20),this.Pjh=this.cA(),na.ULS.sendTraceTag(593510691,bf.$m,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.Qjh)):this.cA().getTime()-this.Pjh.getTime()>this.Qjh&&
(this.kA.event(14),this.m2d(20,la.a.jMd,"TokenExpired"));else if(this.n$j())if(this.Qwb=cg,this.AYb)this.kA.event(3),this.cA().getTime()-this.rCc.getTime()>this.HIe&&(cg=this.xwe.R$b(this.fO),na.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.fO,io.a[cg]),this.Qvd&&this.Qvd.log(),this.stop("stuck on previousRequestPending"),this.gI());else if(cg=ac.b(yf.construct(jf)),this.AYb=!0,this.rCc=this.Phk(),this.fO=this.xwe.nj(bf.serviceUrl,
2,cg,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.mXk,this.lXk,null,void 0,void 0,this.Rgk,this.ESe,void 0,void 0,!0),0>=this.fO)this.AYb=!1,na.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.fO.toString());else{cg=this.xwe.R$b(this.fO);jf=100;if(cg&&1!==cg||this.z_g)jf=50;na.ULS.sendTraceTag(19161612,bf.$m,jf,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.fO,["Status"]:io.a[cg]});this.Qvd&&this.Qvd.start(this.fO)}else this.kA.event(2);
else this.kA.event(13)};this.lXk=cg=>{this.NS=this.fId+1;let jf=this.AYb=!1,Cn=!1;cg=cg.data;Xa.a.el&&l.AFrameworkApplication.Ria("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");cg?(na.ULS.sendTraceTag(22552773,bf.$m,15,"Request failed {0}",{["Status"]:cg.status,["HttpStatus"]:cg.Ne,["Correlation"]:cg.jj?cg.jj[kh.a.ZQ]:"",["Id"]:cg.id,["ConsecutiveErrors"]:this.fId,["Request.InvokedTime"]:cg.bI,["Request.EnqueueTime"]:cg.yPa,["Request.CompletedTime"]:cg.cU}),Cn=7===cg.status||
13===cg.status,this.nIc(2)&&Cn?(this.XWa.hGc(2),jf=!0,this.uyc=cg.Ne,this.kA.event(16)):this.nIc(1)&&5===cg.status?(this.XWa.hGc(1),jf=!0,this.uyc=cg.Ne,this.kA.event(15)):(this.kA.event(4),this.uyc=cg.Ne)):(this.kA.event(4),na.ULS.sendTraceTag(23425240,bf.$m,15,"RequestFailed and event data is null"));if(!jf&&(this.XWa.clear(),Cn?this.m2d(17,la.a.Qsl,"while offline"):this.m2d(11,la.a.bhf,"while online")))return;this.sAa(jf?this.iPl(Cn):this.bvb)};this.mXk=cg=>{this.NS=this.fId+1;this.AYb=!1;var jf=
{};this.XWa.clear();if(cg=cg.data){var Cn=cg.jj?cg.jj[kh.a.ZQ]:"";jf.HttpStatus=cg.Ne;jf.Correlation=Cn;jf.Id=cg.id;na.ULS.sendTraceTag(23425242,bf.$m,this.z_g?50:100,"Request succeeded at the HTTP level {0}",jf);this.uyc=cg.Ne}else na.ULS.sendTraceTag(23425241,bf.$m,15,"Request succeeded with null response data");if(this.Maa()||!this.kMd)this.kA.event(5),this.stop("session has shut down");else if(!this.oVm())if(cg&&cg.te)if(cg=this.Vva(cg.te))if(this.q3.PVa(cg),cg.StatusCode)this.eKf(cg,jf)||this.kA.event(8,
jf);else{this.NS=0;this.Qwb=this.cA();this.dRe.clear();jf={["LastSavedRevisionId"]:cg.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:cg.RevisionSequenceNumber};cg=yc.b(cg.LastSavedRevisionId);this.eqb(cg,3);var al=this.Upf().store.getRevision(cg);if(al){cg=null;Cn=this.gjb();al=(al=al.x2a(Cn))?al.id:ei.a.nil;let nj=Cn;for(;nj&&!nj.id.equals(al);)cg=nj,nj=nj.Fn;this.Hqm(cg,jf,Cn)||this.kA.event(9)}else this.mpm()||this.kA.event(12,jf);this.sAa(this.V0b)&&na.ULS.sendTraceTag(22552774,bf.$m,
50,"Received response from server -- going back to normal interval")}else this.kA.event(7),this.fKf("invalid response",jf);else this.kA.event(6),this.fKf("null response",jf)};this.O8n=(cg,jf)=>{cg={};cg.DocxSaveMonitorState=Rf[jf.newState];cg.PreviousState=Rf[jf.V2f];cg.PreviousStateHits=jf.W2f;cg.PreviousStateTransitionTime=jf.X2f.toISOString();cg.LastHttpStatus=this.uyc;cg.LastSuccessTime=this.Qwb.toISOString();this.rCc&&(cg.LastRequestStartTime=this.rCc.toISOString());cg.LastSavedRevisionID=this.r5d.toString();
cg.LastSavedRevisionIdOrigin=this.Mzc;cg.LastSavedRevisionIdSetTime=this.YRe?this.YRe.toISOString():null;cg.IsViable=this.rf.aya;cg.IsNetworkConnected=this.rf.bD;cg.IsExpired=this.rf.fda;cg.HasEmergencyViewModeBeenDeployed=this.rf.Yj;cg["Navigator.Online"]=window.navigator.onLine;const Cn=jf.fEo;Cn&&bf.iPi(cg,Cn);jf=jf.newState;switch(jf){case 13:na.ULS.sendTraceTag(5830086,bf.$m,50,"{0}",cg);break;case 1:na.ULS.sendTraceTag(5884125,bf.$m,50,"{0}",cg);break;case 0:na.ULS.sendTraceTag(5830087,bf.$m,
50,"{0}",cg);break;case 2:na.ULS.sendTraceTag(5830088,bf.$m,50,"{0}",cg);break;case 3:na.ULS.sendTraceTag(5830089,bf.$m,50,"{0}",cg);break;case 4:na.ULS.sendTraceTag(5884126,bf.$m,50,"{0}",cg);break;case 5:na.ULS.sendTraceTag(5884127,bf.$m,50,"{0}",cg);break;case 6:na.ULS.shipAssertTag(5830090,bf.$m,!1,"{0}",cg);break;case 7:na.ULS.shipAssertTag(5830091,bf.$m,!1,"{0}",cg);break;case 8:na.ULS.sendTraceTag(5830092,bf.$m,15,"{0}",cg);break;case 10:na.ULS.sendTraceTag(5830094,bf.$m,15,"{0}",cg);break;
case 9:na.ULS.sendTraceTag(5884128,bf.$m,50,"{0}",cg);break;case 11:na.ULS.sendTraceTag(5830096,bf.$m,15,"{0}",cg);break;case 17:na.ULS.sendTraceTag(37835678,bf.$m,15,"{0}",cg);break;case 12:na.ULS.sendTraceTag(5830095,bf.$m,15,"{0}",cg);break;case 18:na.ULS.sendTraceTag(38122832,bf.$m,15,"{0}",cg);break;case 19:na.ULS.sendTraceTag(38122833,bf.$m,15,"{0}",cg);break;case 21:na.ULS.sendTraceTag(0,bf.$m,15,"{0}",cg);break;case 14:na.ULS.sendTraceTag(6575508,bf.$m,15,"{0}",cg);break;case 15:na.ULS.sendTraceTag(36739287,
bf.$m,50,"{0}",cg);break;case 16:na.ULS.sendTraceTag(36767649,bf.$m,15,"{0}",cg);break;case 20:na.ULS.sendTraceTag(593510690,bf.$m,15,"{0}",cg);break;default:na.ULS.shipAssertTag(5884129,bf.$m,!1,"Bad state:{0} logInfo:{1}",jf,cg)}};this.V0b=G;this.bvb=ha;this.Zbb=G;this.pmh=La;this.bkk=lb;this.Rgk=tc;this.ESe=Nc;this.JZb=hd;this.wTg=fd;this.xwe=sd;this.g_=Kd;this.q3=Nd;this.GXb=we;this.n$j=Ce;this.EYb=te;this.NHe=fe;this.Maa=Cf;this.cA=Th;this.Phk=Vf;this.g2g=Xj;this.XWa=bg.create(Qg.isEnabled,Qg.maxRetries,
zg.E7);this.dRe=new Vd.a;this.Zvc=$i;this.kA=new hl.a(-1);this.rf=Dg;this.kA.Q0e(this.O8n);this.Qvd=Gj;this.Qwb=Th();this.z_g=Qh;this.dWj=Qg.isEnabled?null:zg;this.Ktb=xm;this.Qjh=this.pmh;this.rLe=ei.a.nil;this.sa=new Q.a;ia.a.instance.Sa("Common.App.VisibilityManagement.IVisibilityManager").execute(cg=>{this.am=cg;this.am.K_a((jf,Cn)=>{this.mY(jf,Cn)});this.xPe=cg.LD});this.rf&&this.rf.nGc((cg,jf)=>{this.DHa(cg,jf)});this.HIe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
Vb):Vb;this.neh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.bvb):this.bvb;this.Ogh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.Rgh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.hik=Qg}DHa(G,
ha){na.ULS.sendTraceTag(528577692,bf.$m,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Qq.a[ha.R6d],Qq.a[ha.aMb]);1!==ha.aMb&&3!==ha.aMb&&(na.ULS.sendTraceTag(528566343,bf.$m,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.XWa.kYc(1),this.XWa.kYc(2)),this.XWa.clear())}get kMd(){return this.Fuc}get r5d(){return this.rLe}get YU(){const G=!this.gjb()||this.r5d.equals(this.gjb().id);G||na.ULS.sendTraceTag(521413851,
bf.$m,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.gjb().id.toString(),this.r5d.toString());return G}get Rzi(){return this.cA().getTime()-this.Qwb.getTime()>this.HIe}get fId(){return this.NS}get I0a(){return 3}get WHd(){let G=null;Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().jb&&Ld.StaticActiveAppFrame.za().jb.Zc&&(G=Ld.StaticActiveAppFrame.za().jb.Zc.contentReplicator);return[G,ke.App.W1]}mY(G,ha){var La,lb,Vb;G={["VisibilityState"]:Tg.a[this.am.LD],
["IsVisible"]:this.am.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.AYb,["KickoutIntervalElapsed"]:this.Rzi,["LastSuccessfulIterationTime"]:null!==(La=this.Qwb)&&void 0!==La?La:"null",["RequestStartTime"]:null!==(lb=this.rCc)&&void 0!==lb?lb:"null",["SkippedKickouts"]:this.Qxd,["LastSkippedKickoutAt"]:null!==(Vb=this.e5g)&&void 0!==Vb?Vb:"null"},["IsViable"]:this.rf.aya,["IsNetworkConnected"]:this.rf.bD,["IsExpired"]:this.rf.fda,["HasEmergencyViewModeBeenDeployed"]:this.rf.Yj,["Navigator.Online"]:window.navigator.onLine};
na.ULS.sendTraceTag(539874775,bf.$m,50,Ia.c(G));this.xPe!=this.am.LD&&(0==ha.oldState||1==ha.oldState||0!==ha.newState&&1!==ha.newState||this.sAa(this.neh),0===this.am.LD?kd.c(vg.a.$Mk,void 0,void 0,void 0,void 0,void 0,G):0===this.xPe&&kd.c(vg.a.aNk,void 0,void 0,void 0,void 0,void 0,G),this.xPe=this.am.LD)}start(){this.Fuc=this.wTg.Ugb(this.$Fl,this.Zbb)}sAa(G){if(!this.kMd||this.Zbb===G)return!1;const ha=this.Zbb;this.Zbb=G;this.stop("changing save monitor interval from "+ha+"ms to "+G+"ms");this.start();
return!0}eqb(G,ha){if(ha>=this.Mzc&&G&&!ei.a.nil.equals(G)){var La=!this.rLe.equals(G);this.Mzc=ha;this.rLe=G;const lb=this.cA();this.YRe=lb;const Vb=this.YU;La&&(ha={["Id"]:G.toString(),["IsUpToDate"]:Vb,["Origin"]:me[ha]},this.wJe&&(ha.LastUpToDateTime=this.wJe.toISOString()),(La=this.Upf())&&La.store&&(G=La.store.getRevision(G))&&(ha.LastSavedCreationTime=G.creationTime.toISOString()),na.ULS.sendTraceTag(557320151,bf.$m,50,"Updating Last Saved Revision: {0}",ha));Vb&&(this.wJe=lb)}else ha<this.Mzc?
na.ULS.sendTraceTag(572051800,bf.$m,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.Mzc,ha):na.ULS.sendTraceTag(572051801,bf.$m,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',ha)}stop(G){this.ff(G)}ff(G){this.kMd&&(na.ULS.sendTraceTag(5830084,bf.$m,50,"Stopping DocxSaveMonitor because {0}!",G),this.wTg.ff(this.kMd),this.Fuc=0)}mpm(){if(0>=this.JZb)return!1;var G=this.H7l();if(!G)return this.mPe=null,this.Eud=0,this.Fud=!1;this.Ixb=G.jFb;this.Ixb===this.mPe?this.Eud++:(this.mPe=
this.Ixb,this.Eud=1,this.Fud=!1);if(this.Eud<bf.Hen)return!1;this.tAc=+this.cA()-+this.Ixb;if(this.tAc<=this.JZb)return!1;if(!this.Fud)return this.Fud=!0,this.p7i(),!1;if(this.Ktb)this.Ktb.execute(ha=>{ha.flush(this,0)});else{G="";try{this.Zvc&&(G=this.Zvc())}catch(ha){G=Ia.c({["Kind"]:"Exception",["Stack"]:ha.stack,["Message"]:ha.message,["FileName"]:ha.fileName,["LineNumber"]:ha.lineNumber}),na.ULS.sendTraceTag(50426817,bf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",
G)}na.ULS.sendTraceTag(50426818,bf.$m,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Ixb.toISOString(),this.tAc,this.JZb,G)}this.JZb=-1;this.stop("Exceeded oldest allowed local revision");this.gI(la.a.Rsl);return!0}H7l(){let G=null,ha=this.gjb();for(;ha&&!ha.Fia;)G=ha,ha=ha.Fn;return G}oVm(){return this.EYb()?(this.kA.event(1),this.stop("session is lost"),!0):this.NHe()?(this.kA.event(14),na.ULS.sendTraceTag(20029718,
bf.$m,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.gI(la.a.jMd),!0):!1}Upf(){const G=this.GXb();return G?G.Mc:null}gjb(){const G=this.Upf();return G?Object(bb.a)(G.zm):null}nIc(G){return this.hik.isEnabled?this.XWa.nIc(G):this.dWj.kYc(G)&&!this.XWa.kYc(G)}iPl(G){return G?bf.yLo:bf.Gfj}m2d(G,ha,La){if(this.Rzi)if(this.am&&!this.am.isVisible)na.ULS.sendTraceTag(540669727,bf.$m,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.Qxd+=1,this.e5g=this.cA();else return this.kA.event(G,{}),this.stop("request failed after kickout interval "+La),this.Ktb&&this.Ktb.execute(lb=>{lb.flush(this,2)}),this.gI(ha),!0;return!1}eKf(G,ha){const La=G.StatusCode;return 88===La||89===La||236===La?(ha.KickoutDiagnostics=this.Zvc(),88===La?(ha.Result="deleted DSS session",this.kA.event(18,ha),this.stop("deleted DSS session"),this.gI(la.a.localCobaltDeletedSessionFault)):89===La?(ha.Result="expired DSS session",this.kA.event(19,ha),this.stop("expired DSS session"),
this.gI(la.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.eo("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(G=yc.b(G.LastSavedRevisionId),this.eqb(G,4)),ha.Result="DSS session not found",this.kA.event(21,ha),this.stop("DSS session not found"),this.gI(la.a.localCobaltSessionNotFound)),!0):14===La?(this.stop("DSS returned an unspecified failure"),
this.gI(la.a.$3m),!0):104===La?(this.stop("this operation is disabled on the server"),!0):this.fKf("unrecognized OperationResult: "+La,ha)}fKf(G,ha){if(!this.dRe.contains(G))this.dRe.add(G);else if(this.m2d(11,la.a.bhf,G))return ha.ConsecutiveErrors=this.fId,ha.Reason=G,na.ULS.sendTraceTag(41997899,bf.$m,15,"DocxSaveMonitor kickout. {0}",ha),!0;this.sAa(this.bvb);return!1}Hqm(G,ha,La){let lb=!1;if(G){const Vb=this.cA().getTime()-G.creationTime.getTime();Vb>=this.pmh&&(lb=!0,bf.iPi(ha,this.Acm(G,Vb,
La)),Vb>=this.HIe&&10===this.kA.currentState?(this.kA.event(11,ha),this.stop("didn't save in time"),this.gI()):(this.kA.event(10,ha),this.p7i(),this.Tmf()))}return lb}Oyk(G){this.sa.addHandler(bf.E3i,G)}nyk(G){this.sa.addHandler(bf.$mf,G)}icj(G){this.sa.removeHandler(bf.$mf,G)}p7i(){this.sa.raiseEvent(bf.E3i)}Vva(G){let ha;return({group:ha}=$c.a.d2(G)).returnValue?ha.Responses[0]:null}Acm(G,ha,La){const lb={};lb.FirstUnsavedRevisionId=G.id.toString();lb.FirstUnsavedRevisionLengthToRoot=G.gE;lb.UnsavedTimeInMs=
ha;lb.CurrentRevisionId=La.id.toString();lb.CurrentRevisionLengthToRoot=La.gE;return lb}Tmf(){Ti.a.Umf(Hm.a.saveMonitor)}gI(G=la.a.bhf){this.bkk?this.Rgh?(na.ULS.sendTraceTag(509146274,bf.$m,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",G,this.h9h()),0==this.Fuc&&this.start()):this.am&&!this.am.isVisible?(na.ULS.sendTraceTag(509146273,bf.$m,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",G,this.h9h()),0==
this.Fuc&&this.start()):(this.stop(bf.i_m),G===la.a.jMd?this.g_.value.gI(G,Object.assign(new qb.a,{ona:4,U_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,h8:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.g_.value.gI(G,new qb.a)):na.ULS.sendTraceTag(19247383,bf.$m,50,"Kickout disabled")}h9h(){const G={};var ha=ia.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");G.HasDataloss=!ha.YU;G.UnSavedRevisionsCount=ha.KVa;G.OldestUnsavedRevisionCreationTime=
ha.YU?"":ha.K9b().toString();G.RevisionsWithOutServerRevisionSequenceNumbers=ha.O5b();G.RevisionsWithServerRevisionSequenceNumbers=ha.iJd();G.RSNManager_Diagnostics=ha.VC();if(ha=ia.a.instance?ia.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)G.RunawayDataLossMonitor_Diagnostics=ha.jhj;G.DocxSaveMonitor_Diagnostics=this.VC();(ha=ia.a.instance?ia.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(G.LastSavedToHostDetailsManager_Diagnostics=ha.VC());this.am&&(G.VisibilityState=
Tg.a[this.am.LD]);return G}VC(){const G={};this.Ixb&&(G.ORT=this.Ixb.toISOString());0<this.tAc&&(G.AA=this.tAc);0<this.JZb&&(G.MAA=this.JZb);0<this.Qxd&&(G.LSKO=this.e5g.toISOString());this.kA&&0<=this.kA.currentState&&(G.SMS=Rf[this.kA.currentState]);const ha={};l.AFrameworkApplication.Qpa&&(ha.S=1);hb.App.lostSession&&(ha.LS=1);this.rf&&(this.rf.Io&&(ha.KO=1),this.rf.fda&&(ha.TE=1));this.am&&(ha.VS=Tg.a[this.am.LD]);window.navigator&&(ha.NW=!window.navigator.onLine);G.AMD=ha;return G}V_l(){const G=
{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(G["X-OfficeVersion"]=rb.a.MB(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(G["X-AccessToken"]=rb.a.MB(l.AFrameworkApplication.accessToken),G["X-AccessTokenTtl"]=l.AFrameworkApplication.Eua.toString());l.AFrameworkApplication.canary&&(G["X-Key"]=rb.a.MB(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(G["X-UserType"]=rb.a.MB(l.AFrameworkApplication.userType));
const ha=l.AFrameworkApplication.He.zZ;ha&&(G["X-WacCluster"]=rb.a.MB(ha));l.AFrameworkApplication.userSessionId&&(G["X-UserSessionId"]=rb.a.MB(l.AFrameworkApplication.userSessionId));return G}uJl(){var G=this.rf?this.rf.networkState:null;if(1===G||3===G)na.ULS.sendTraceTag(558158790,bf.$m,15,"Not sending request because we dont have network.");else if(G=this.GXb()){var ha=new Sys.Net.WebRequest;ha.set_httpVerb("POST");ha.set_url(bf.serviceUrl);var La={};La.body=ac.b(yf.construct(G));La.headers=this.V_l();
La.method=ha.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ha.getResolvedUrl(),La).then(lb=>{na.ULS.sendTraceTag(561551382,bf.$m,50,"Request succeeded at the HTTP level {0}",lb.statusText);this.$4g=lb.status;return lb.json()},lb=>{na.ULS.sendTraceTag(561551383,bf.$m,15,"Request failed at the HTTP level {0}",lb);return null}).then(lb=>{lb=JSON.stringify(lb);this.bXk(lb,this.$4g);return lb},()=>{na.ULS.sendTraceTag(561551385,bf.$m,15,"Request succeeded with null response data");return""}):
na.ULS.sendTraceTag(561002076,bf.$m,15,"Browser does not support Fetch.")}catch(lb){na.ULS.sendTraceTag(561551386,bf.$m,15,String.format("Exception when attempting to get last revision save id : {0}",lb))}}else na.ULS.sendTraceTag(540079457,bf.$m,15,"Target node is null, not sending last saved revision request.")}bXk(G,ha){let La=ei.a.nil,lb=!1,Vb=-1;ha===cj.a.Zz&&((G=this.Vva(G))?(La=yc.b(G.LastSavedRevisionId),G.StatusCode||(lb=!0,Vb=G.StatusCode)):na.ULS.sendTraceTag(561002077,bf.$m,50,"Response is null when attempting to get last revision save id"));
this.sa.raiseEvent(bf.$mf,new Md(La,lb,ha,Vb))}static iPi(G,ha){for(const La in ha)G[La]=ha[La]}gQm(){return Bh.SessionStatusManager.instance.Io}}bf.Gfj=0;bf.serviceUrl=hb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";bf.i_m="kickout";bf.E3i="PS";bf.$mf="FLSR";bf.$m=343;bf.Hen=5;bf.yLo=5E4;Object(e.a)(bf,"DocxSaveMonitor",null,[1862,164]);class pl{Ugb(G,ha){return window.setInterval(G,ha)}ff(G){window.clearInterval(G)}}pl.instance=new pl;Object(e.a)(pl,"DocxSaveMonitorTaskManager",
null,[1861]);class il{constructor(G){this.fO=0;this.gua=G}start(G){this.gua&&(this.fO=G,this.gua.reset())}log(){if(this.gua){var G={};G.RequstId=this.fO;G.InvokeCount=this.gua.RVc;G.InvokeFailedCount=this.gua.TVc;G.NoOpenConnectionCount=this.gua.A1c;G.SynchronousNotificationCount=this.gua.Fbd;G.ResponseNotAvailable=this.gua.Z7c;na.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",G)}}}Object(e.a)(il,"RequestLifeCycleTelemetryManager",null,[1848]);class Sk{constructor(){this.W=
this.URe=null;this.Vel=()=>{var G=l.AFrameworkApplication.K;if(!G.$("DocxSaveMonitorEnabled"))return null;var ha=G.$("DocxSaveMonitorKickoutEnabled");const La=G.nc("DocxSaveMonitorIntervalMs",6E4),lb=G.nc("DocxSaveMonitorFailureIntervalMs",5E3),Vb=G.nc("DocxSaveMonitorWarningTimeMs",12E4),tc=G.nc("DocxSaveMonitorKickoutTimeMs",6E5),Nc=G.nc("DocxSaveMonitorQueueTimeoutMs",6E4),hd=G.nc("DocxSaveMonitorSentTimeoutMs",12E4),fd=G.nc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var sd=G.$("DocxSaveMonitorTelemetryInfoEnabled");
const Kd=G.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Nd=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),we=G.$("DocxSaveMonitorRawWebRequestsEnabled")||Nd;Nd=G.$("ComponentStateLoggingPackageIsEnabled");G=G.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Ce=l.AFrameworkApplication.He,te=we?new Ym(l.AFrameworkApplication.userSessionId,Ce.zZ,Ce.ZQh):null;
te=new jn(Ce,te,we);sd=sd&&Ce&&!we?new il(Ce.Fea):null;we=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Ce=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const fe=bg.create(we,Ce);fe.hGc(1);fe.hGc(2);Nd=Nd?this.W.Sa("Common.IComponentStateLogManager"):null;ha=new bf(La,lb,Vb,ha,tc,Nc,hd,fd,
pl.instance,te,ia.a.instance.Ve("Wonca.KickoutExecutor"),mk.a.instance,this.fac,()=>!l.AFrameworkApplication.Z5d||rj.a.instance.aWc,()=>hb.App.lostSession,Object(a.a)(lf.a.instance,lf.a.instance.gva,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Qk,()=>new Date,()=>new Date,sd,Kd,fe,this.jNl,Nd,G,ia.a.instance.Oa("Common.ISessionStatus")||Bh.SessionStatusManager.instance,{isEnabled:we,maxRetries:Ce});ha.start();na.ULS.sendTraceTag(5884131,bf.$m,50,"SaveMonitor initialized");return ha};
this.fac=()=>{const G=Ld.StaticActiveAppFrame.za().jb.rc;return G?G.ed:null};this.jNl=()=>{const G={};l.AFrameworkApplication.lc&&(G.TM=l.AFrameworkApplication.lc.VC());Af.WoncaApp.OF&&(G.RS=Af.WoncaApp.OF.VC());ke.App.W1&&(G.CRS=ke.App.W1.VC());Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().jb&&Ld.StaticActiveAppFrame.za().jb.Zc&&Ld.StaticActiveAppFrame.za().jb.Zc.contentReplicator&&(G.GSR=Ld.StaticActiveAppFrame.za().jb.Zc.contentReplicator.VC());l.AFrameworkApplication.Qpa&&(G.S=1);
hb.App.lostSession&&(G.LS=1);hb.App.zd&&hb.App.zd.nC.Io&&(G.KO=1);G.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(G)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(hb.App.Fs||hb.App.Cm)this.URe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.URe&&this.URe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(G){this.W=G;(hb.App.Fs||hb.App.Cm)&&G.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.Vel).as("Wonca.IDocxSaveMonitor").ha()}static main(){M.a.instance.Gc(new Sk)}}
Object(e.a)(Sk,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Vj=c(708);class Ch{constructor(G,ha){this.An=G;this.lco=Object(Vj.c)(ha)}async loadChunk(G){return this.An.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(G):(await this.lco).dA.loadScript(G)}}Object(e.a)(Ch,"WordOnlineChunksLoader",null,[]);class Qn{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(G){G.ia("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Ch(l.AFrameworkApplication.K,G.Sa("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){M.a.instance.Gc(new Qn)}}
Object(e.a)(Qn,"EditorAiEntryPackage",null,[1,2]);var zh=c(1E3);class gk{constructor(G,ha,La,lb,Vb,tc,Nc){this.iMd=G;this.Jqi=ha;this.Yxm=La;this.p_f=lb;this.HMc=Vb;this.oc=tc;this.KH=Nc;this.evn=(hd,fd,sd)=>{switch(sd){case 1:if(!Object(Vj.d)(fd)||!this.uL)return 8;this.HMc.awj();break;case 2:this.HMc.a7e?this.tsj():this.Hqb()}return 32};this.hrn=(hd,fd,sd)=>{2===sd&&this.p_f.Wwl().catch(Kd=>{na.ULS.Vz(508965832,3041,10,Kd,"Failed to initialize Copilot integration package")});return 32};this.CZi=
(hd,fd)=>{fd.qZ&&(Object(kd.a)("AiMakerInitializationTriggered"),this.iMd.dea(this.CZi),this.iMd.Od(),this.HMc.awj(),this.KH.pk(19,()=>{this.HMc.a7e&&this.tsj()}))};this.mwn=async(hd,fd)=>{fd.qZ&&this.Yxm.execute(sd=>{sd.findImageAndRegisterHandler()})};this.uL=ke.App.eqe.uL}initialize(){this.iMd.U3(this.CZi);this.iMd.initialize();this.Jqi.U3(this.mwn);this.Jqi.initialize();this.oc.fb(vg.a.SId,Ni.a.view,this.evn,4);this.oc.fb(vg.a.aIi,Ni.a.application,this.hrn,1028)}tsj(){this.HMc.show().catch(G=>
{na.ULS.Vz(508965831,3041,10,G,"Failed to show document wizard")})}Hqb(){(new zh.a).x9d(0)}}Object(e.a)(gk,"AiMakerInitializer",null,[]);var sk=c(1762),wl=c(947);class Rn extends wl.a{constructor(G){var ha;super("BooleanFeatureGateConditionId");this.Il=G.Il;this.a2a=G.a2a;this.defaultValue=null!==(ha=G.defaultValue)&&void 0!==ha?ha:!1}initialize(){super.initialize();const G=l.AFrameworkApplication.K;G.Nn(()=>{const ha=G.getBooleanFeatureGate(this.a2a,this.defaultValue);this.pg(ha)})}pg(G){super.pg(G);
na.ULS.sendTraceTag(512369937,3028,50,this.FO(this.Il,G,`featureGate=${this.a2a}`))}}Object(e.a)(Rn,"BooleanFeatureGateCondition",wl.a,[]);var nk=c(712);class Zm extends wl.a{constructor(G){super(G.sIh);this.s$f=G}initialize(){super.initialize();l.AFrameworkApplication.K.Nn(()=>{var G,ha,La,lb,Vb;const tc=null!==(ha=null===(G=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===G?void 0:G.WACDatacenter)&&void 0!==ha?ha:"unknown";G=null!==(lb=null===(La=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===La?void 0:La.Ring)&&void 0!==lb?lb:"unknown";La=null===(Vb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Vb?void 0:Vb.Host;Vb=this.ZVc(tc,G,La);this.pg(Vb);na.ULS.sendTraceTag(509747520,3028,50,this.FO(this.s$f.Il,Vb,`datacenter=${tc}`))})}ZVc(G,ha,La){if("1"===ha||"unknown"===G||this.s$f.VYh.includes(La))return!0;const lb=G.toUpperCase();return!this.s$f.CTh.some(Vb=>lb.includes(Vb))}}Object(e.a)(Zm,"EditorAiDatacenterCondition",wl.a,[]);class uo extends wl.a{constructor(G,
ha,La){super("AiMakerConsentGroupConditionId");this.Il=G;this.Aba=ha;this.defaultValue=La}initialize(){super.initialize();this.Aba.execute(G=>{var ha;G.isFeatureEnabled("AiMaker",null!==(ha=this.defaultValue)&&void 0!==ha?ha:!1).then(La=>{this.pg(La);return null})})}pg(G){super.pg(G);na.ULS.sendTraceTag(509752010,3028,50,this.FO(this.Il,G))}}Object(e.a)(uo,"AiMakerConsentGroupCondition",wl.a,[]);class Ui extends wl.a{constructor(G){super("RegionComposerEnabledConditionId");this.Il=G.Il}initialize(){super.initialize();
this.pg(ke.App.eqe.uL)}pg(G){super.pg(G);na.ULS.sendTraceTag(508965830,3028,50,this.FO(this.Il,G))}}Object(e.a)(Ui,"RegionComposerEnabledCondition",wl.a,[]);var er=c(950),wh;(function(G){G[G.jAh=0]="bypass";G[G.jCn=1]="passed";G[G.uSi=2]="notPassed"})(wh||(wh={}));Object(e.b)("LicenseConditionResult",wh);class ql extends wl.a{constructor(G,ha,La){super("LicenseConditionId");this.appSettings=ha;this.p2e=La;this.Il=G.Il;this.Amb=G.Amb;this.l4b=G.l4b}initialize(){super.initialize();this.appSettings.Nn(()=>
{this.QVo().catch(G=>{na.ULS.Vz(508875776,3028,10,G,"Failed to update license condition for {0}",this.Amb)})})}async QVo(){const G=await this.CIc();this.pg(G!==wh.uSi);this.qeo(G)}async CIc(){return this.Q6e()?wh.jAh:await this.pzf()?wh.jCn:wh.uSi}Q6e(){return this.l4b?this.appSettings.getBooleanFeatureGate(this.l4b,!1):!1}async pzf(){var G=await Object(Vj.c)(this.p2e);const ha=er.b.Ira();G=await G.isFeatureEnabled(this.Amb,!1);na.ULS.sendTraceTag(508875286,3028,50,"License check for {0} trigger took: {1}ms",
this.Il,ha.$Mc);return G}qeo(G){G=Object.entries({Amb:this.Amb,sgp:G===wh.jAh}).map(([ha,La])=>`${ha}=${La}`).join(", ");na.ULS.sendTraceTag(508875285,3028,50,this.FO(this.Il,this.Eia,G))}}Object(e.a)(ql,"LicenseCondition",wl.a,[]);class Tk extends ql{constructor(G,ha,La){super({Il:G,Amb:"Copilot",l4b:"Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"},ha,La)}}Object(e.a)(Tk,"CopilotLicenseCondition",ql,[]);const Pi="CH DE FR EU UK NO SE NL PIE".split(" ");class nm extends nk.a{constructor(G,
ha,La){const lb=new Rn({Il:16,a2a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});G=new sk.a(16,G,ha,{QPb:!0,qP:!1,Cbc:!1,Bbc:!1,pP:!1});ha=new Zm({sIh:"AiMakerDocumentWizardDatacenterConditionId",Il:16,CTh:Pi,VYh:["Exchange Online Consumer","OneDriveWOPI"]});const Vb=new uo(16,La),tc=new Ui({Il:16});La=new Tk(16,l.AFrameworkApplication.K,La);super(16,new zb.a([lb,G,ha,Vb,tc,La]),null,3028,"AiMakerDocumentWizardTriggered")}}Object(e.a)(nm,"AiMakerDocumentWizardTriggerModel",nk.a,[]);var Kj=c(948);
class Ar extends wl.a{constructor(G){super("AiImageInsertedConditionId");this.Wfb=G;this.isInitialized=!1;this.YTi=()=>{this.pg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.Wfb.execute(G=>{var ha;null===(ha=G.add_onImageWasInsertedHandler)||void 0===ha?void 0:ha.call(G,this.YTi)}))}Od(){this.isInitialized&&(this.Wfb.execute(G=>{var ha;null===(ha=G.remove_onImageWasInsertedHandler)||void 0===ha?void 0:ha.call(G,this.YTi)}),this.isInitialized=!1,super.Od())}}
Object(e.a)(Ar,"AiImageInsertedCondition",wl.a,[]);class ys extends nk.a{constructor(G,ha){const La=new Rn({Il:19,a2a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),lb=new Ar(G),Vb=new Tk(19,l.AFrameworkApplication.K,ha);super(19,new zb.a([La,lb,Vb]),null,3028,"OnTriggerAiImageRemakeEventKey");this.Wfb=G;this.Aba=ha;this.$ri=!1;this.Ktk()}x3a(G){super.x3a(G);super.bDd()&&super.Zjb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==G||this.$ri||(this.s0n(),this.$ri=!0)}Ktk(){l.AFrameworkApplication.va.fb(vg.a.TId,
Ni.a.view,()=>8,1028)}s0n(){l.AFrameworkApplication.va.Vv(vg.a.TId,Ni.a.view,()=>8)}}Object(e.a)(ys,"AiImageRemakeTriggerModel",nk.a,[]);class Hk{constructor(G){this.z2c=async()=>{const ha=await this.jIi.value;await this.bVc(ha);return ha};this.tzn=M.a.instance;this.jIi=new Pb.a(G);this.WBm=new Pb.a(this.z2c)}async w4(){await this.jIi.value}async Xhb(){return await this.WBm.value}async bVc(G){M.a.instance.Gc(G);return new Promise(ha=>{this.tzn.registerOnPackageInit(G.name,ha)})}}Object(e.a)(Hk,"LazyLoadedPackage",
null,[]);class rp{constructor(){this.VUh=new Hk(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2100)).then(G=>G.instance));this.r8k=new Hk(()=>Promise.all([c.e(2),c.e(5),c.e(30)]).then(c.bind(null,2109)).then(G=>G.instance))}async Ywl(){await this.VUh.Xhb()}async Wwl(){await this.VUh.Xhb();await this.r8k.Xhb()}}Object(e.a)(rp,"AiMakerPackageManager",null,[]);var Rq=c(296),Fm={get Msl(){var G=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;
if(!G)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return G}};class Pr{constructor(G){this.container=G}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(e.a)(Pr,"AiMakerDocumentWizardDependenciesImpl",null,[]);class Gg{constructor(G,ha,La,lb,Vb){this.Usg=G;this.p_f=ha;this.Vi=La;this.rc=lb;this.w5o=Vb;this.fAi=!1;this.uqn=async()=>{this.fAi=!0;await Promise.all([this.p_f.Ywl(),this.Usg.loadChunk("aiMakerDocumentWizardUx")]);return Fm.Msl};this.HJj=new Pb.a(this.uqn)}get a7e(){return this.Vi.Dba(this.rc.ed,{qP:!1,Vca:!1,jpa:!1,pP:!1})}awj(){this.fAi||this.HJj.value.catch(G=>{na.ULS.Vz(508965829,3041,10,G,"Failed to load document wizard UX interop")})}async show(){const G=
await this.HJj.value;this.a7e?(this.Fth||(this.Fth=this.vfn(G)),this.Fth.open()):na.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}vfn(G){const ha=this.mountApp(G);return ha?ha:new mj(this.w5o,()=>this.mountApp(G))}mountApp(G){const ha=Object(Rq.a)("EditorContainer");return G.mountApp(ha,new Pr(ia.a.instance))}}Object(e.a)(Gg,"AiMakerDocumentWizardUx",null,[]);class mj{constructor(G,ha){this.controller=G;this.Krn=ha;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(G){this.controller.isOpen=
G}open(){this.isOpen||(this.isOpen=!0,this.Krn())}close(){this.isOpen=!1}}Object(e.a)(mj,"AiMakerDocumentWizardCompatAppRef",null,[]);class tk{constructor(){this.isOpen=!1}}Object(e.a)(tk,"AiMakerDocumentWizardControllerImpl",null,[]);class zn extends Kj.a{get name(){return"WordEditor.AiMaker.Entry"}F8(G){this.container=G;G.ia("WordEditor.AiMaker.AiMakerPackageManager",()=>new rp).ha();G.ia("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new tk).ha();G.ia("WordEditor.AiMaker.AiMakerDocumentWizardUx",
()=>new Gg(G.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),G.resolve("WordEditor.AiMaker.AiMakerPackageManager"),G.resolve("Box4.IParagraphReader"),Ld.StaticActiveAppFrame.za().jb.rc,G.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).ha()}H8(){(new gk(new nm(this.container.resolve("Box4.IParagraphReader"),Ld.StaticActiveAppFrame.za().jb.rc,this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new ys(this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService"),
this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,Ta.a.get_instance())).initialize()}G8(){}static main(){M.a.instance.Gc(new zn)}}Object(e.a)(zn,"AiMakerEntryPackage",Kj.a,[]);var Yk={get interop(){var G=aiInserterUx.interop;if(!G)throw Error("aiInserterUx chunk is accessed before loading");
return G}};class jl{constructor(G,ha){this.Z9d=G;this.Q8c=ha;this.WHa=async(La,lb)=>{lb.qZ&&(Object(kd.a)("AiInserterInitializationTriggered"),this.Z9d.dea(this.WHa),this.Z9d.Od(),[,La]=await Promise.all([this.T3m(),Promise.all([c.e(2),c.e(5),c.e(25)]).then(c.bind(null,2101))]),La.main(Yk.interop))}}initialize(){this.Z9d.U3(this.WHa);this.Z9d.initialize()}async T3m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(Vj.c)(this.Q8c)).dA.loadScript("aiInserterUx")}}
Object(e.a)(jl,"AiInserterInitializer",null,[]);class fr extends wl.a{constructor(G,ha){super("AiInserterConsentGroupConditionId");this.Aba=G;this.defaultValue=ha}initialize(){super.initialize();this.Aba.execute(G=>{G.isFeatureEnabled("AiInserter",!!this.defaultValue).then(ha=>{this.pg(ha);return null})})}pg(G){super.pg(G)}}Object(e.a)(fr,"AiInserterConsentGroupCondition",wl.a,[]);const sp="CH DE FR EU UK NO SE NL PIE".split(" ");class ej extends wl.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Nn(()=>{var G,ha,La,lb;const Vb=null!==(ha=null===(G=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===G?void 0:G.WACDatacenter)&&void 0!==ha?ha:"unknown";G=null!==(lb=null===(La=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===La?void 0:La.Ring)&&void 0!==lb?lb:"unknown";La=this.ZVc(Vb,G);this.pg(La)})}ZVc(G,ha){if("1"===ha||"unknown"===G)return!0;const La=G.toUpperCase();return!sp.some(lb=>La.includes(lb))}}Object(e.a)(ej,"AiInserterDatacenterCondition",
wl.a,[]);class Bp extends nk.a{constructor(G){const ha=new Rn({Il:17,a2a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"}),La=new fr(G),lb=new ej;G=new Tk(17,l.AFrameworkApplication.K,G);super(17,new zb.a([ha,La,lb,G]),null,3028,"AiInserterAppTriggered")}}Object(e.a)(Bp,"AiInserterTriggerModel",nk.a,[]);class fj extends Kj.a{get name(){return"WordEditor.AiInserter.Entry"}F8(G){this.container=G}H8(){(new jl(new Bp(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){M.a.instance.Gc(new fj)}}Object(e.a)(fj,"AiInserterEntryPackage",Kj.a,[]);const uk="CH DE FR EU UK NO SE NL PIE".split(" ");class vk extends nk.a{constructor(G){const ha=new Rn({Il:18,a2a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),La=new Zm({sIh:"AiRewriteDatacenterConditionId",Il:18,CTh:uk,VYh:["Exchange Online Consumer","OneDriveWOPI"]});G=new Tk(18,l.AFrameworkApplication.K,G);super(18,new zb.a([ha,
La,G]),null,3028,"AiRewriteTriggered")}}Object(e.a)(vk,"AiRewriteTriggerModel",nk.a,[]);var Wl={get interop(){var G=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!G)throw Error("aiRewriteUx chunk is accessed before loading");return G}};class wk{constructor(G,ha){this.$Cd=G;this.Q8c=ha;this.WHa=async(La,lb)=>{lb.qZ&&(Object(kd.a)("AiRewriteInitializationTriggered"),this.$Cd.dea(this.WHa),this.$Cd.Od(),[,La]=await Promise.all([this.H2m(),Promise.all([c.e(2),c.e(5),c.e(14)]).then(c.bind(null,
2105))]),La.main(Wl.interop))}}initialize(){this.$Cd.U3(this.WHa);this.$Cd.initialize()}async H2m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiRewriteUx"):(await Object(Vj.c)(this.Q8c)).dA.loadScript("aiRewriteUx")}}Object(e.a)(wk,"AiRewriteInitializer",null,[]);class kn extends Kj.a{get name(){return"WordEditor.AiRewrite.Entry"}F8(G){this.container=G}H8(){(new wk(new vk(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){M.a.instance.Gc(new kn)}}Object(e.a)(kn,"AiRewriteEntryPackage",Kj.a,[]);var Gn;(function(G){G[G.version0=0]="version0";G[G.version1=1]="version1"})(Gn||(Gn={}));Object(e.b)("FirstRunExperienceVersion",Gn);class tm{get d2e(){return"Word"}get HBh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Gn.version0}get currentVersion(){return Gn.version1}get ALm(){return tm.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get oec(){return tm.isEnabled()&&
l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get fEi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get lHl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get JPi(){return 24}get pgj(){return 4E3}get u8c(){return""}static isEnabled(){const G=l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==G&&"Automation"!==G}}
Object(e.a)(tm,"FirstRunExperienceLauncherSettings",null,[1958]);class lo{constructor(G){this.jWg=G}txo(G){this.jWg&&this.jWg.uxo(G)}}Object(e.a)(lo,"FirstRunExperienceManager",null,[1898]);class Uo{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}wc(G){this.W=G;this.W.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new lo(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const G=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");
G&&G.txo(new tm)}dispose(){}}Object(e.a)(Uo,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class $h{constructor(G,ha){this.eJa=(La,lb,Vb,tc,Nc)=>{var hd,fd;if(1===Vb)return Nc=null===(fd=null===(hd=lb.view.mb)||void 0===hd?void 0:hd.ib)||void 0===fd?void 0:fd.lb,(null===Nc||void 0===Nc?0:Nc.dI)||La===vg.a.had&&(null===Nc||void 0===Nc?0:Nc.t4a)?32:8;if(2===Vb){hd=this.Pbb.mj.isVisible;this.Pbb.kC(!0,1===Nc);fd=0;switch(La){case vg.a.Isj:Nc=1;break;case vg.a.Jsj:Nc=2;break;case vg.a.kje:Nc=
2;fd=1;break;case vg.a.lje:Nc=1;fd=2;break;case vg.a.had:Nc=1;fd=3;break;case vg.a.Ime:Nc=this.Pbb.B6b;break;default:fd=Nc=0}hd&&La===vg.a.eJa||this.Pbb.Rjo(Nc,fd);return 32}return 8};this.RWd=(La,lb,Vb,tc,Nc)=>{this.toggleButton(Nc,!1);return this.e0k(Vb)};this.Ime=(La,lb,Vb,tc,Nc)=>this.Pbb.mj.isVisible?this.RWd(La,lb,Vb,tc,Nc):this.eJa(La,lb,Vb,tc,Nc);this.ga=G;this.Pbb=ha}dispose(){this.Pbb&&this.Pbb.dispose()}Ub(){this.ga.qa(vg.a.Ime,Ni.a.view,this.Ime);this.ga.fb(vg.a.eJa,Ni.a.view,this.eJa,
4);this.ga.qa(vg.a.RWd,Ni.a.view,this.RWd);this.ga.fb(vg.a.kje,Ni.a.view,this.eJa,4);this.ga.qa(vg.a.lje,Ni.a.view,this.eJa);this.ga.qa(vg.a.had,Ni.a.view,this.eJa)}e0k(G){if(1===G)return 32;this.Pbb.kC(!1);return 32}toggleButton(G,ha){G&&(G[lk.a.On]=ha)}}Object(e.a)($h,"FormatPictureActor",null,[10]);class gq{constructor(G){this.Vzb=!1;this.mj=G}get B6b(){return this.mj.Ahl}Rjo(G,ha){switch(G){case 0:case 1:this.mj.syo(ha);break;case 2:this.mj.Eyo(ha)}}kC(G,ha=!1){this.Vzb||this.gCf();G?this.mj.WP(ha):
this.mj.cpa()}dispose(){this.mj.dispose()}gCf(){this.Vzb||(this.mj.initialize(),this.Vzb=!0)}}Object(e.a)(gq,"FormatPictureManager",null,[1860,10]);var Ql=c(359),cm=c(175),Sq=c(252);class Gi{}Gi.ZP=Sq.a.ZPd;Gi.Rhc=1;Gi.Shc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Gi.Rva="FormatPictureTaskPaneData";Object(e.a)(Gi,"FormatPicturePaneConstants",null,[]);class Aq{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=
this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Aq,"FormatPictureTaskPaneProps",null,[]);class Hn{constructor(G,ha,La,lb){this.hSe=0;this.fuc=this.Lma=null;this.rwd=this.iwd=this.drd=this.Lhd=this.Jzd=0;this.Vs=this.yWb=!1;this.aye=0;this.Xun=()=>{this.$lj()};this.Gm=()=>{let Vb=!1;Vb=this.EMn()||Vb;Vb=this.a7a()||Vb;Vb=this.$6a()||Vb;Vb=this.Tic()||
Vb;(Vb=this.AMn()||Vb)&&this.Lm()};this.J3=G;this.Z$j=ha;this.EJe=La;this.ig=lb}initialize(){this.S_();this.jka()}get isVisible(){return this.Vs}WP(G){this.qad(G)}cpa(){this.nea();this.fvm()}syo(G){this.joj(G,1)}Eyo(G){this.joj(G,2)}joj(G,ha){this.aye=ha;this.hSe=G}get Ahl(){return this.aye}dispose(){}S_(){this.J3.dPa();this.hSe=this.aye=0}get focusManager(){return this.Z$j.value}get oc(){return this.EJe.value}e5a(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===Gi.ZP}$lj(){this.focusManager.mg(Gi.ZP)}jka(){const G=
this.focusManager.fe(Gi.ZP);G.parent=mg.AFrame.Ap;G.sga(this.Xun)}nea(){this.e5a()&&this.focusManager.mg(this.focusManager.iU)}qad(G){ph.UISurfaces.Pu().then(ha=>{ha.showTaskPane(Gi.ZP,this.xA(G));this.isVisible&&G&&this.focusManager.mg(Gi.ZP);return null})}Lm(){ph.UISurfaces.Pu().then(G=>{G.updateTaskPane(Gi.ZP,this.xA(!1));return null})}fvm(){ph.UISurfaces.Pu().then(G=>{G.hideTaskPane(Gi.ZP,2);return null})}xA(){const G=new Aq;this.$qo(G);return Object.assign(new aj.a,{title:Gi.Shc,hideHeader:!1,
width:320,location:2,contentProps:G,onOpen:ha=>{this.Vs=!0;Ld.StaticActiveAppFrame.za().I_a(this.Gm);Ld.StaticActiveAppFrame.za().updateCommandUI();this.$lj();this.ig.w2b(Gi.ZP,ha)},onClose:()=>{this.nea();this.Vs=!1;Ld.StaticActiveAppFrame.za().Gjc(this.Gm);Ld.StaticActiveAppFrame.za().updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}$qo(G){const ha=E.e().numberFormatInfo;G.section=this.hSe;G.numberFormatInfo="object"===typeof ha?ha:null;G.title=this.Lma;
G.description=this.fuc;G.topCrop=this.Jzd;G.bottomCrop=this.Lhd;G.leftCrop=this.drd;G.rightCrop=this.iwd;G.rotationAngle=this.rwd;G.onTitleChange=this.onTitleChange();G.onDescriptionChange=this.onDescriptionChange();G.onCropSpinButtonChange=this.onCropSpinButtonChange();G.onRotationSpinButtonChange=this.onRotationSpinButtonChange();G.disabled=this.yWb}onTitleChange(){return G=>{if(G!==this.Lma){this.Lma=G;var ha=new Ql.DictionaryPropertySet;ha.setValue(cm.a.wkb,G);this.oc.Qb(qe.a.N9c,2,ha);this.Lm()}}}onDescriptionChange(){return G=>
{if(G!==this.fuc){var ha=new Ql.DictionaryPropertySet;ha.setValue(cm.a.vY,G);this.fuc=G;this.oc.Qb(qe.a.qQb,2,ha);this.Lm()}}}onCropSpinButtonChange(){return(G,ha)=>{const La=new Ql.DictionaryPropertySet;switch(ha){case 0:this.Jzd=G;La.setValue(cm.a.Bkb,G);this.oc.Qb(vg.a.yUc,2,La);break;case 1:this.Lhd=G;La.setValue(cm.a.ykb,G);this.oc.Qb(vg.a.rUc,2,La);break;case 2:this.drd=G;La.setValue(cm.a.zkb,G);this.oc.Qb(vg.a.sUc,2,La);break;case 3:this.iwd=G,La.setValue(cm.a.Akb,G),this.oc.Qb(vg.a.tUc,2,
La)}this.Lm()}}onRotationSpinButtonChange(){return G=>{this.rwd=G;const ha=new Ql.DictionaryPropertySet;ha.setValue(cm.a.FUc,0);ha.setValue(cm.a.KU,G);this.oc.Qb(qe.a.m9,2,ha);this.Lm()}}EMn(){const G=2===this.oc.Qb(qe.a.N9c,1,null),ha=G!==this.yWb;this.yWb=G;return ha}a7a(){var G=new Ql.DictionaryPropertySet;this.oc.Qb(qe.a.a7a,2,G);G=G.ja(cm.a.wkb,"");const ha=G!==this.Lma;this.Lma=G;return ha}$6a(){var G=new Ql.DictionaryPropertySet;this.oc.Qb(qe.a.$6a,2,G);G=G.ja(cm.a.vY,"");const ha=G!==this.fuc;
this.fuc=G;return ha}Tic(){var G=new Ql.DictionaryPropertySet;this.oc.Qb(vg.a.s5c,2,G);const ha=G.ja(cm.a.Bkb,0),La=G.ja(cm.a.ykb,0),lb=G.ja(cm.a.zkb,0);G=G.ja(cm.a.Akb,0);const Vb=ha!==this.Jzd||La!==this.Lhd||lb!==this.drd||G!==this.iwd;this.Jzd=ha;this.Lhd=La;this.drd=lb;this.iwd=G;return Vb}AMn(){var G=new Ql.DictionaryPropertySet;this.oc.Qb(qe.a.uOb,2,G);G=G.ja(cm.a.KU,0);const ha=G!==this.rwd;this.rwd=G;return ha}}Object(e.a)(Hn,"ReactFormatPicturePane",null,[1850,10]);class Cp{constructor(){this.zmd=
this.W=null}get name(){return"WordEditor.FormatPicture"}wc(G){this.W=G;this.W.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new gq(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.W.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new Hn(Oc.a.instance,new Pb.a(()=>Kl.FocusManager.instance()),new Pb.a(()=>l.AFrameworkApplication.va),yj.a.instance)).ha();this.W.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new $h(l.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(ke.App.Nsg||
ke.App.XLj)this.zmd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.zmd.Ub(),Ld.StaticActiveAppFrame.za().updateCommandUI()}dispose(){this.zmd&&this.zmd.dispose()}static main(){M.a.instance.Gc(new Cp)}}Object(e.a)(Cp,"WordEditorFormatPicturePackage",null,[1,2]);var Sn=c(1504),hq=c(517),Yn=c(1219);class El extends Rm.a{constructor(){super();this.Prompt=0;this.FileId=null}ml(){return hn.a.graphMergeConsentChange}static construct(G,ha){const La=new El;La.FileId=G;La.Prompt=ha;return La}}
Object(e.a)(El,"GraphMergeConsentChangedRequest",Rm.a,[]);var iq=c(594);class jq extends iq.a{constructor(){super();this.Location=this.FileId=null}ml(){return hn.a.playGraphMergeReplay}static construct(G,ha){const La=new jq;La.FileId=G;La.Location=ha;return La}}Object(e.a)(jq,"PlayGraphMergeReplayRequest",iq.a,[]);class Zn{constructor(G,ha,La,lb,Vb,tc=null,Nc=null){this.km=!1;this.$N=null;this.Rfh=this.kIe=!1;this.u$e=()=>{if(this.UAa.CWd)this.kIe=!0;else if(this.kIe=!1,!this.bgo){this.Rfh=!0;var hd=
this.WKa.Xya;na.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",hd===Yn.a.consentGiven);if(hd===Yn.a.consentDenied||hd===Yn.a.consentGiven)hd=El.construct(this.uQ(),hd),this.Wv(hd)}};this.Pmi=(hd,fd)=>{fd&&fd.ZPf&&fd.ZPf.Cbf&&!this.UAa.jEi&&(this.UAa.aFj(),this.UAa.CWd=!0,this.Wv(fd.ZPf.Cbf))};this.Nmi=(hd,fd)=>{fd&&fd.Xed&&this.UAa.aFj()};this.Omi=(hd,fd)=>{fd&&(fd.ShowMergePrompt&&this.WKa.lej(this.u$e),l.AFrameworkApplication.Og&&(l.AFrameworkApplication.Og.SessionMergeInfo|=fd.PartMergeInfo))};
this.uQ=G;this.cBd=La;this.UAa=lb;this.WKa=Vb;this.cBd&&this.cBd.syk(this.Pmi);this.q3=tc||mk.a.instance;if(!Nc){const hd=new hq.a;Nc=fd=>hd.Hha(0,fd)}this.JXj=Nc}get vYm(){return this.kIe}get bgo(){return this.Rfh}Wv(G){const ha=new Dm.a;ha.Iq=G;ha.status=sc.a.requestReady;ha.aH="GraphMerge";const La=this.JXj(()=>{this.Y7c(ha,G.ml()===hn.a.createGraphMergeReplay)});La.JH(ha);La.lU()}Y7c(G,ha){this.km||(ha&&(this.UAa.CWd=!1),2===G.statusCode&&!Na.a.IJb(G.Mj)&&1===G.Mj.length&&G.Mj[0]?(G=G.Mj[0],G.StatusCode?
this.UAa.Feg():ha&&this.WKa.lej(this.u$e),this.q3.PVa(G),this.vYm&&this.u$e()):this.UAa.Feg())}$Sa(G){this.$N=G;this.$N.lGc(this.Nmi);this.$N.mGc(this.Omi)}dispose(){this.km||(this.cBd&&this.cBd.t2n(this.Pmi),this.$N&&(this.$N.Fjc(this.Nmi),this.$N.bee(this.Omi)),this.km=!0)}}Object(e.a)(Zn,"GraphMergeBackupManager",null,[1967,10]);class mi{constructor(G,ha=null,La=null,lb=null){this.Gue=0;this.fHe=!1;this.k4g=new Date(0);this.CWd=!1;this.WKa=G;this.cA=ha||(()=>new Date);La||(La=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.nc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.Nbk=La;lb||(lb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.nc("WordEditorGraphMergeMaxBackups",1):1);this.Z6g=lb}get aXm(){return+this.cA()-+this.k4g<this.Nbk}get jEi(){return this.WKa.Xya===Yn.a.automatic?!1:this.WKa.Xya===Yn.a.consentDenied?!0:this.fHe||this.CWd||this.aXm}aFj(){this.k4g=this.cA();this.Gue++;this.Gue>=this.Z6g&&this.Feg()}Feg(){this.fHe||(this.fHe=!0,na.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",
this.Gue,this.Z6g))}}Object(e.a)(mi,"GraphMergeBackupThrottler",null,[1966]);class gr{constructor(G,ha,La=null){this.qYg=!1;this.G6=G;this.f3j=ha;null==La&&(La=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.DPe=La?Yn.a.automatic:Yn.a.promptRequired}get Xya(){return this.DPe}lej(G){if(!this.qYg&&this.Xya===Yn.a.promptRequired){var ha=this.f3j.value;ha&&ha.isFeatureEnabled(53)&&(this.qYg=!0,this.G6.execute(La=>{La.Exo(()=>{this.X4k(G)},()=>
{this.consentDenied(G)})}))}}consentDenied(G){this.Xya===Yn.a.promptRequired&&(na.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.DPe=Yn.a.consentDenied,G());this.Aaj()}X4k(G){this.Xya===Yn.a.promptRequired&&(na.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.DPe=Yn.a.consentGiven,G());this.Aaj()}Aaj(){this.G6.execute(G=>{G.$um()})}}Object(e.a)(gr,"GraphMergeCollectionConsentManager",null,[1965]);class mo extends Sys.EventArgs{constructor(G){super();
this.ZPf=G}}Object(e.a)(mo,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var dm=c(838),Dp=c(886),cs=c(1061),no=c(624),om;(function(G){G[G.none=0]="none";G[G.failure=1]="failure";G[G.crash=2]="crash";G[G.success=3]="success"})(om||(om={}));Object(e.b)("GraphMergeReplayReason",om);var Bq=c(1797),qr=c(1795),In=c(225),um=c(184);class Rl{constructor(G,ha,La,lb,Vb,tc){this.g4f=this.og=null;this.EYc=this.qsg=!1;this.fl=null;this.W$c=G.runtime.W$c;this.tq=G;this.Xd=ha;this.Ng=La;this.En=lb;this.J4k=Vb;
this.graphNodeComplexMerge=tc}}Object(e.a)(Rl,"GraphNodeComplexMergeState",null,[]);var oo=c(1577),Tq=c(1561);class gp{constructor(G,ha=null){this.Qg=G;this.wZb=ha||this.rRc()}get $mb(){return this.wZb}get Xd(){return this.Qg}rRc(){return[Object(a.a)(this,this.eAo,"simpleMerge"),Object(a.a)(this,this.X3k,"complexMerge")]}fro(G,ha,La,lb,Vb,tc){ha=new Rl(G,La,new Pb.a(()=>new oo.a(lb?lb.Dm:null,Vb)),new Pb.a(()=>new oo.a(lb?lb.Dm:null,tc)),new Pb.a(()=>new oo.a(tc,Vb)),ha.FMh(Vb,()=>G.runtime.Zb));
ha.og=lb.u1b;ha.g4f=new In.a;return ha}merge(G,ha,La,lb,Vb,tc){ha=this.fro(G,ha,La,lb,Vb,tc);La=!0;for(lb=0;lb<this.$mb.length&&La;lb++)(La=(0,this.$mb[lb])(ha))||G.logger.J3d("GraphNodeMerge.GetMergeFunctions()",lb);if(G=ha.EYc&&ha.fl?new Tq.a(ha.fl,!1):null)switch(G.ypo(ha.og),(G?G.Dm:Vb).Oc){case 1074135145:ha.tq.runtime.cde.h6k.Z(G.Dm.id,G.Dm);break;case 1074135153:ha.tq.runtime.cde.ULk.Z(G.Dm.id,G.Dm);break;case 1074135127:ha.tq.runtime.cde.Q2k.Z(G.Dm.id,G.Dm);break;case 393230:ha.tq.runtime.a5d.add(G.Dm.id)}return{returnValue:ha.EYc,
fl:G}}eAo(G){if(G.tq.runtime.Zb&&G.tq.runtime.Zb.Tjb(1000005)&&0<G.og.count)return!0;var ha=G.graphNodeComplexMerge.obe;return G.En.value.zWc(ha)&&G.J4k.value.zWc(ha)?G.Ng.value.zWc(ha)?!0:(ha=G.En.value.xf,G.EYc=!0,G.fl=ha.ZK(),!1):(G.EYc=!0,!1)}X3k(G){const ha=G.En.value.xf;G.W$c&&um.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",ha.id,ha.Oc);const La=G.graphNodeComplexMerge.wog(G);G.EYc=La;um.a.instance.Ua(4018184,1,La?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
La?"Succeeded":"Failed",ha.id,ha.Oc,!!G.fl);return La}}Object(e.a)(gp,"GraphNodeMerge",null,[1870]);var Tp=c(1474),vo=c(1421);class Lo extends Rm.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=Tp.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=vo.a.none;this.Reason=om.none;this.Prompt=0}ml(){return hn.a.createGraphMergeReplay}static construct(G,ha,La,lb,Vb,tc,
Nc,hd,fd,sd,Kd){const Nd=new Lo;Nd.FileId=G;Nd.BaseRevisions=ha;Nd.TheirRevisions=La;Nd.YourRevisions=lb;Nd.IgnoreConflictsInLastServerRevision=Vb;Nd.MergeHint=tc;Nd.ObjectSpaceId=Nc?yc.a(Nc):null;Nd.RequestId=hd?yc.a(hd):null;Nd.Source=fd;Nd.Reason=sd;Nd.Prompt=Kd;return Nd}}Object(e.a)(Lo,"CreateGraphMergeReplayRequest",Rm.a,[]);var Fp=c(819),Wj=c(239),Im=c(16),ln=c(1901),Ik=c(1994);class Cq{constructor(G,ha=null,La=null){this.Jrl=(lb,Vb)=>{let tc=lb;var Nc=Vb,hd=this.Kcb.get(lb);if(!hd)return{EIa:tc,
yPb:Nc};Nc=new In.a;Nc.add(hd);var fd=this.rxb.get(lb)||this.XF.J(lb);hd=new In.a;hd.add(fd);fd=new In.a;fd.add(this.XF.J(lb));na.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.AH.mxf,this.AH.Xia,this.zci(hd),this.zci(Nc));var sd=this.Rci(this.AH.Xia);this.HGl(sd,lb,Nc);hd=new ln.a(sd,fd,sd.input.Xia===Tp.a.yours?hd:Nc,sd.input.Xia===Tp.a.yours?Nc:hd,this.Rci(Tp.a.yours),hd,Nc);Nc=new In.a;for(fd=
0;fd<Vb.length;fd++){this.AH.gH("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Kd=({B7a:tc,gra:sd}=hd.Kdd(lb,Vb.J(fd))).returnValue;Nc.add(sd);Kd?na.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",lb,Vb.J(fd),tc,sd):na.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
lb)}return{EIa:tc,yPb:Nc}};this.AH=G;this.XF=G.uk;this.Kcb=G.zKo;this.rxb=G.z9o;this.Kak=G.Z3m;this.Qg=ha||new cs.a;this.lfk=La||this.Jrl}AMc(G){const ha=new In.a;for(let La=0;La<G.length;La++){const lb=this.Brl(G.J(La));ha.add(lb)}return ha}zMc(G,ha,La){const lb=G.Au===G.Ez&&G.startCp===G.endCp;ha&&({EIa:G.Au,gra:G.startCp}=this.SVa(G.Au,G.startCp,G.Au),lb&&(G.Ez=G.Au,G.endCp=G.startCp));La&&!lb&&({EIa:G.Ez,gra:G.endCp}=this.SVa(G.Ez,G.endCp,G.Ez));return G}Brl(G){if(G.Au===G.Ez){var ha=new In.a;
ha.add(G.startCp);ha.add(G.endCp);({EIa:G,yPb:ha}=this.Bqg(G.Au,ha));return new Fp.a(G,ha.J(0),G,ha.J(1))}ha=new In.a;var La=new In.a;let lb;ha.add(G.startCp);({EIa:ha,yPb:lb}=this.Bqg(G.Au,ha));La.add(G.endCp);({EIa:G,yPb:La}=this.Bqg(G.Ez,La));return new Fp.a(ha,lb.J(0),G,La.J(0))}Bqg(G,ha){let La=G,lb=ha;if(!this.XF.J(G))return na.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",G),{EIa:La,
yPb:lb};if(this.Kcb.get(G))({EIa:La,yPb:lb}=this.lfk(G,ha,La,lb));else if(this.AH.vBf&&!this.AH.vBf.J(this.AH.vBf.length-1).Y4(G)){lb=new In.a;for(let Vb=0;Vb<ha.length;Vb++){let tc;({EIa:La,gra:tc}=this.SVa(G,ha.J(Vb),La));lb.add(tc)}}return{EIa:La,yPb:lb}}zci(G){let ha="";G.forEach(La=>{ha+=La.mcd();ha+=" ";return!0});return ha}Rci(G){const ha=ia.a.instance.Oa("Box4.IFeatureHelper"),La=new Ik.a;La.input.source=this.AH.mxf;La.input.Xia=this.AH.Xia;La.input.jOc=()=>ha;La.runtime.uk=this.XF;La.runtime.$Da=
this.AH.s3k;G===Tp.a.yours?(La.runtime.Nu=this.rxb,La.runtime.Mq=this.Kcb,La.runtime.rOd=this.AH.gGi,La.runtime.Zne=this.AH.xGi):G===Tp.a.theirs&&(La.runtime.Nu=this.Kcb,La.runtime.Mq=this.rxb,La.runtime.rOd=this.AH.xGi,La.runtime.Zne=this.AH.gGi);La.runtime.Zb=ha;return La}HGl(G,ha,La){if(G.runtime.Nu.nb(Wj.a.PL)){var lb=G.runtime.Nu.J(Wj.a.PL);lb=this.Qg.getPropertyObjectIds(lb,jm.a.h2);if(1===lb.length&&(lb=lb.J(0),G.runtime.Nu.nb(lb)&&(lb=G.runtime.Nu.J(lb),3===this.Qg.getPropertyInt32(lb,jm.a.asb)))){const Vb=
this.Qg.getPropertyString(lb,jm.a.Jka),tc=this.Qg.getPropertyString(lb,jm.a.USb);ha.toString()===Vb&&Vb===tc&&(ha=this.Qg.getPropertyObjectId(lb,jm.a.Ndd),G.runtime.Nu.nb(ha)&&La.add(G.runtime.Nu.J(ha)))}}}v9l(G,ha){let La=0;for(let lb=0;lb<G.length;lb++)if(ha.equals(G.J(lb)))return La=lb,{returnValue:!0,idx:La};return{returnValue:!1,idx:La}}SVa(G,ha){const La=this.Kak&&!!this.rxb.J(G)&&!this.XF.J(G);let lb=G,Vb=ha,tc=!1,Nc=!1;(La?this.rxb:this.Kcb).forEach((hd,fd)=>{this.AH.gH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.hHf(fd.Oc)&&this.XF.J(hd)){fd=null;if(La){fd=this.LRc(Kd=>this.rxb.J(Kd)||this.XF.J(Kd),hd);var sd=this.q0d(fd,G)}else sd=this.LRc(Kd=>this.XF.J(Kd),hd),sd=this.q0d(sd,G);if(sd&&(Nc=!0,fd||(fd=this.LRc(Kd=>this.rxb.J(Kd)||this.XF.J(Kd),hd)),hd=this.LRc(Kd=>this.Kcb.J(Kd)||this.XF.J(Kd),hd),sd=0,({idx:sd}=this.v9l(fd,G)).returnValue)){for(let Kd=sd+1;Kd<fd.length;Kd++)if(this.q0d(hd,fd.J(Kd)))return Vb=0,lb=fd.J(Kd),tc=!0,!1;for(--sd;0<=sd;sd--)if(this.q0d(hd,fd.J(sd)))return Vb=Number.MAX_VALUE,
lb=fd.J(sd),tc=!0,!1}}return!0});tc||(na.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",G,ha,La,Nc),this.AH.mxf===vo.a.undo&&(na.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",lb),({l1h:ha}=this.cZl()).returnValue?(lb=ha,Vb=0,
na.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",lb)):na.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",lb)));return{EIa:lb,gra:Vb}}cZl(){let G=ei.a.nil,ha=new In.a;this.Kcb.forEach((La,lb)=>{this.AH.gH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.hHf(lb.Oc)?(ha=this.LRc(Vb=>this.Kcb.J(Vb)||this.XF.J(Vb),La),!1):!0});return 0<ha.length?(G=ha.J(0),{returnValue:!0,l1h:G}):{returnValue:!1,l1h:G}}hHf(G){return 393241===G||393250===G||393251===G||393252===G}LRc(G,ha){var La=G(ha);ha=new In.a;if(!this.hHf(La.Oc))return ha;La=this.Qg.getPropertyObjectIds(La,Im.a.gf);for(let lb=0;lb<La.length;lb++){const Vb=new In.a;this.Ltf(G,La.J(lb),Vb);ha.$C(ha.length,Vb)}return ha}Ltf(G,ha,La){var lb=G(ha);if(lb)if(393230===lb.Oc)La.add(ha);else if(393229===
lb.Oc)ha=this.Qg.getPropertyObjectIds(lb,Im.a.bL).eg(0),this.Ltf(G,ha,La);else if(393250===lb.Oc||393251===lb.Oc||393252===lb.Oc)for(ha=this.Qg.getPropertyObjectIds(lb,Im.a.gf),lb=0;lb<ha.length;lb++)this.Ltf(G,ha.J(lb),La)}q0d(G,ha){for(let La=0;La<G.length;La++)if(ha.equals(G.J(La)))return!0;return!1}}Object(e.a)(Cq,"GraphMergeSelectionRecordUpdater",null,[]);class wo extends Bq.a{constructor(G=null,ha=null,La=null,lb=null,Vb=null,tc=null,Nc=null,hd=null,fd=null,sd=null,Kd=null){var Nd;super();
this.hOh=we=>{const Ce=we.vX,te=Ld.StaticActiveAppFrame.za().jb.Zc;return new dm.a(we,Ce,te.xd,te.fileId,te.kpb,te.contextId,Ce?Ce.id:ei.a.nil,this.ffe,!1,!0)};this.uQ=G||(()=>l.AFrameworkApplication.rootQuerySignature);ha||(ha=we=>new Dp.a(we));this.teh=ha;this.Qg=La||new cs.a;this.cPg=Nc||new qr.ChildNodeListMerge(this.Xd);this.J_b=hd;this.ffe||(this.J_b=(we,Ce,te)=>new no.a(we,Ce,te));this.wZb=lb||this.rRc();this.Abb=Vb||new Rp.a;this.ZXg=tc||new gp(this.Xd);this.g7g=(null===(Nd=l.AFrameworkApplication.K)||
void 0===Nd?void 0:Nd.nc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.UAa=fd;this.WKa=sd;this.TVd=this.Anl(Kd);this.xVg=()=>ia.a.instance.Oa("Box4.IFeatureHelper")}Anl(G){G||(G=l.AFrameworkApplication.K?l.AFrameworkApplication.K.nc("WordEditorGraphMergeBackupCasesBrowser",0):0);return G}vFa(){return(new Date).getTime()}Xwj(G,...ha){return String.format.apply(null,[G].concat(ha))}WKo(G){throw Ad.a.invalidOperation(G);}VRd(G){return String.format("Name: {0}, Message: {1}, Stack: {2}",G.name,
G.message,G.stack)}TGn(G){if(this.UAa&&this.UAa.jEi||!this.DGo(G))return null;this.$6m(G);let ha;({jKk:lb,yKo:Vb,y9o:ha}=this.dfl(G,this.hOh));const La=Bq.a.r_l(G);var lb=Lo.construct(this.uQ(),lb.hAa(),Vb.hAa(),ha.hAa(),G.input.rIb,G.input.Xia,G.input.Fm,G.input.LLb,G.input.source,La,this.WKa.Xya);var Vb=G.output.aN;La===om.success&&0<Vb.length&&(lb.MergedRevision=this.hOh(G.output.aN.last()));return lb}AMc(G,ha){return(new Cq(G)).AMc(ha)}zMc(G,ha,La,lb){return(new Cq(G)).zMc(ha,La,lb)}}Object(e.a)(wo,
"GraphMerger",Bq.a,[]);class xk extends wo{constructor(G,ha=null,La=null){super(G,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ha,La);this.sa=new Q.a}get Xya(){return this.WKa?this.WKa.Xya:Yn.a.unknown}get delayedMergeOperation(){return null}set delayedMergeOperation(G){}syk(G){this.sa.addHandler(xk.lxf,G)}t2n(G){this.sa.removeHandler(xk.lxf,G)}Fgg(){return!1}dgc(G,ha,La,lb,Vb,tc,Nc){(G=super.dgc(G,ha,La,lb,Vb,tc,Nc))&&this.sa.raiseEvent(xk.lxf,new mo(G));return G}}xk.lxf="GMC";Object(e.a)(xk,
"WordEditorGraphMerger",wo,[1883,1562,1563]);class Br{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}wc(G){this.W=G;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new gr(this.W.Sa("WordEditor.IBusinessBarController"),new Pb.a(()=>G.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new mi(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();
this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new xk(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Zn(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){hb.App.rS||(hb.App.rS=Sn.a.w8());const G=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");hb.App.rS.cLk(G);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let G=this.W.Oa("Box4.IGraphMergeBackupManager");G&&G.dispose()}}Object(e.a)(Br,"GraphMergePackage",null,[1,2]);var Dq=c(287);class Uq{constructor(G){this.Nwe=
"FontPicker";this.IGe=null;this.z$a=G;this.Ild=this.z$a.iza(Dq.a.VKb,Object(a.a)(this,this.XEb,"featureStateChangeCallback"));this.z$a.isFeatureEnabled(Dq.a.VKb,!1).then(ha=>{this.IGe=ha})}get isLicensed(){return this.IGe}XEb(G){this.IGe=G.isEnabled;G=appChrome.actions.updateFontPickerLicenseState(this.Nwe,G.isEnabled);appChrome.api.dispatch(G)}dispose(){this.z$a.yjc(Dq.a.VKb,this.Ild)}}Object(e.a)(Uq,"ModernFontPickerFeatureHelper",null,[1276,10]);var hr=c(479),Gp=c(652),rl=c(1694);class mn{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(mn,"FontInfoTaskPaneProps",null,[]);class Jn{constructor(G,ha,La,lb=null){this.YWe=this.uW=this.Ild=null;this._state=this.UYb=0;this.EJe=G;this.z$a=ha;this.HXj=La;this.Vb=lb}get oc(){return this.EJe.value}initialize(){this.oc.qa(n.a.m$f,y.a.frame,Object(a.a)(this,this.m$f,"requestFontInfo"));this.Ild=this.z$a.iza(Dq.a.VKb,Object(a.a)(this,this.XEb,
"featureStateChangeCallback"));this.jka()}WP(G=!1){const ha=ph.UISurfaces.Pu(),La=this.z$a.isFeatureEnabled(Dq.a.VKb,!1),lb=[];lb.push(ha);lb.push(La);Promise.all(lb).then(Vb=>{Vb[0].showTaskPane(rl.a.wFb,this.xA(Vb[1]));G&&this.kK()})}pZo(G){ph.UISurfaces.Pu().then(ha=>{ha.updateTaskPane(rl.a.wFb,this.xA(G));return null})}XEb(G){this.pZo(G.isEnabled)}m$f(G,ha,La,lb,Vb){this.uW=Vb.CommandValueId;this.YWe=Vb.Trigger;this.UYb=Vb.InputMethod;this.WP(2===this._state&&1===this.UYb);return 32}xA(G){const ha=
new mn;ha.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");ha.fontName=this.uW;ha.isLicensed=G;ha.trigger=this.YWe;ha.helpArticleUrl=this.j5k();ha.paneId=rl.a.wFb;G=this.vAm();G.contentProps=ha;return G}vAm(){return Object.assign(new aj.a,{title:rl.a.Shc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}jka(){if(this.Vb){var G=this.Vb.fe(rl.a.wFb);G.parent=mg.AFrame.Ap;G.fI=!0}}onOpen(){this._state=2;this.kK()}onShow(G){0!==this._state&&(this._state=2,1===G&&(this.UYb=G),this.kK())}onClose(){this.UYb=this._state=0;this.blur()}onHide(){this._state=1;this.UYb=0}kK(){this.Vb&&1===this.UYb&&this.Vb.mg(rl.a.wFb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===rl.a.wFb&&this.Vb.mg(this.Vb.iU)}onUpsellButtonClicked(){this.z$a.launchUpsellExperience(rl.a.experienceId)}dispose(){this.z$a.yjc(Dq.a.VKb,
this.Ild)}j5k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.HXj,this.k0l(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}k0l(){switch(this.YWe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Jn.yNk(this.uW)}static yNk(G){let ha="hlpFontInfo";for(let La=0;La<G.length;++La){const lb=rb.a.charAt(G,
La);if(255<G.charCodeAt(La)||rb.a.nZd(lb))ha+=lb}return ha}}Object(e.a)(Jn,"FontInfoPane",null,[1165,10]);class Jm extends Jn{constructor(G,ha,La,lb,Vb){super(G,ha,lb.kb("FontInfoHelpBaseUrl"),Vb);this.J3=La}WP(G){this.S_();super.WP(G)}XEb(G){super.XEb(G);Ld.StaticActiveAppFrame.za().updateCommandUI()}S_(){this.J3.dPa()}}Object(e.a)(Jm,"WordEditorFontInfoPane",Jn,[]);class hp{constructor(){this.uXb=this.Vrd=this.Nvc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}wc(G){this.W=G;G.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Uq(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();G.ia("Common.ModernFontPicker.IFontInfoPane",()=>new Jm(new Pb.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Oc.a.instance,l.AFrameworkApplication.K,Kl.FocusManager.instance())).ha()}init(){this.Vrd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Nvc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.Nvc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.uXb=this.W.Oa(Gp.a))?this.uXb.initialize():na.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Ld.StaticActiveAppFrame.za().updateCommandUI()}dispose(){this.Nvc&&(this.Nvc.dispose(),this.Nvc=null);this.Vrd&&(this.Vrd.dispose(),this.Vrd=null);this.uXb&&(this.uXb.QDa(),this.uXb=null)}static main(){Object(hr.a)()&&M.a.instance.Gc(new hp)}}Object(e.a)(hp,"ModernFontPickerPackage",null,[1,2]);
var pq=c(125),Sl=c(5),Zk=c(254),fm=c(37),Gl=c(1122);class vm{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd=null){this.FZ=La;this.Yc=G;this.Lc=ha;this.rh=Vb;this.EKa=tc;this.eW=Nc;this.IOg=hd;this.HOg=fd;this.my=sd;this.g0j=Nd||vm.tw}get jh(){return this.my?this.my.jh:!1}Ssi(G){return this.oGa(G,0)}CDm(G){return this.oGa(G,1)}oGa(G,ha){let La=null;if(this.jh&&this.eW&&(this.HOg.instance&&this.HOg.instance.RJa(G),ha?1===ha&&(La=this.eW.Dci(G.node)):La=this.eW.Rpf(G.node,G.cpBegin,G.Fb),La&&!La.ja(jm.a.u9,
!1)))return na.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const lb=Sl.GraphIterator.ZX(this.Yc.Dk());lb.set(G.node);lb.zb(10);const Vb=this.Lc.Pc(15);Vb.Ut(lb);ha?fm.OutlineElementNavigator.Yd(lb):(this.Sqb(lb,G),this.FZ.Goc(G.node,kk.a.Rs));G=ul.ParagraphReader.$k(lb.currentNode);this.VEm(lb);this.jh&&La&&this.IOg&&(ha=new zb.a,ha.add(lb.currentNode),this.IOg.woh(ha,La.id));this.Nko(G);Vb.dispose();return 32}Nko(G){G=Td.SelectionFactory.ne(G,
0);hj.a.instance.Ac(G)}VEm(G){this.rh.Oy(G,!0,!0,null,!1,!1);G=fm.OutlineElementNavigator.Ee(G);this.EDm(G)}Sqb(G,ha){const La=fm.OutlineElementNavigator.Yd(G);if(ha.cpBegin||this.jh&&(!this.jh||-1!==ha.Fb)){hb.App.zd.Uo&&ha.cpBegin!==ul.ParagraphReader.textLength(ha.node)&&hb.App.zd.fq.iG(ha.node);this.rh.Oy(G,!1,!0,null,!1,!0);var lb=Sl.GraphIterator.ZX(this.Yc.Dk());lb.set(La);this.rh.S$(lb,G,ha,!0,!0,!0)}}EDm(G){G=this.g0j(G);this.EKa.qti(G)}static gF(){return new vm(new xj.a,new jo.a,ia.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Gl.a.instance,ia.a.instance.resolve("Box4.IOutlineElementEditor"),ia.a.instance.resolve("Box4.IBlobEditor"),ia.a.instance.Oa("Box4.IContentControlReader"),ia.a.instance.Oa("Box4.IContentControlEditor"),ia.a.instance.Sa("Box4.IContentControlConverter"),ia.a.instance.Oa("Box4.ContentControlConfigSettings"),ia.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=vm.cDg?vm.cDg:vm.cDg=vm.gF()}static tw(G){return Xg.a.tw(G)}}Object(e.a)(vm,"PageBreakInserter",null,[2051]);class kl{constructor(G,
ha,La,lb,Vb,tc,Nc,hd){this.YEm=(fd,sd,Kd,Nd)=>{var we=sd.view,Ce=we.mb.qg;if(!Ce)return 2;if(!this.U7e(sd))return 8;if(1===Kd)return 32;let te=!0;Kd=8;const fe=this.KHe(Ce);Ce=this.Lc.Pc(15);Ce.Db(we.ed);Ce.Uj=fd;fe||(Kd=this.ga.Mf(sd,qe.a.Wna,2,!0,Nd,null),fd=32===Kd,na.ULS.shipAssertTag(4208012,314,fd),te=fd);te&&(we=we.mb.qg,fd=this.KHe(we),na.ULS.shipAssertTag(4208013,314,fd,"{0}",{["ContextId"]:sd.contextId}),Kd=8,fd&&(Kd=this.vFe.Ssi(we),na.ULS.shipAssertTag(4208014,314,32===Kd)));Ce.dispose();
32===Kd&&this.Vd.Zs(10);return Kd};this.XEm=(fd,sd,Kd)=>{if(!sd||sd.contextId!==Ni.a.Tc)return 8;if(1===Kd)return sd.contextId===Ni.a.Tc?32:8;if(2===Kd){if(!this.U7e(sd))return 8;fd=this.vFe.Ssi(sd);32===fd&&this.Vd.Zs(10);return fd}return 32};this.WEm=(fd,sd,Kd)=>{if(!sd||sd.contextId!==Ni.a.table)return 8;if(1===Kd)return 32;if(2===Kd){if(!this.U7e(sd))return 8;fd=this.vFe.CDm(sd);32===fd&&this.Vd.Zs(10);return fd}return 32};this.ga=G;this.vFe=ha;this.Lc=La;this.en=lb;this.KHe=Vb;this.Nk=tc;this.i9j=
Nc;this.Vd=hd}Ub(){this.ga.qa(vg.a.oGa,Ni.a.view,this.YEm);this.ga.qa(vg.a.oGa,Ni.a.Tc,this.XEm);this.ga.qa(vg.a.oGa,Ni.a.table,this.WEm);this.ga.Xc(vg.a.oGa,4)}F5(){const G=Kl.FocusManager.instance().fe(pq.AppFrame.VD);mg.AFrame.Ci(G,Oe.KeyInputManager.ic(kk.a.Rs,Oe.KeyInputManager.Rh),vg.a.oGa)}$Pm(G){return this.mx(G.iterator)}HTm(G){G=G.J(0);const ha=Pd.SelectionEditor.Jj(G,!0,!1);if(this.mx(ha.Pa.iterator))return!0;G=Pd.SelectionEditor.Jj(G,!1,!1);return this.mx(G.Pa.iterator)}mx(G){return G.zb(14)}U7e(G){let ha=
null,La=G;if(La.contextId===Ni.a.view){ha=La.view;if(!ha.features.Lkg)return!1;La=ha.mb.qg;if(!La)return!1}else{const lb=Sl.GraphIterator.eb(La.node);if(lb.zb(36)||lb.zb(38)||lb.zb(40)||lb.zb(14))return!1}return Zk.a.via(G)?!1:La.contextId===Ni.a.table?this.Nk.KPm(La.node):!this.Nk.IPm(La)||this.en&&this.en.instance&&this.en.instance.TU(La)?!1:((G=this.KHe(La))?this.$Pm(La):this.HTm(ha.mb.ib))||G&&this.i9j(La,!0)?!1:!0}static gF(){return new kl(l.AFrameworkApplication.va,vm.instance,new jo.a,ia.a.instance.Sa("Box4.IExternalSelectionManager"),
Pd.SelectionEditor.Ze,ak.a.instance,Pe.a.Lxa,ia.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=kl.WBg?kl.WBg:kl.WBg=kl.gF()}}Object(e.a)(kl,"PageBreakActor",null,[2046]);class Vo{constructor(){this.LNe=this.W=null}get name(){return"WordEditor.PageBreak"}wc(G){this.W=G}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){this.LNe=kl.instance;this.LNe.Ub();this.LNe.F5();Ld.StaticActiveAppFrame.za().updateCommandUI()}dispose(){}}
Object(e.a)(Vo,"PackageManager",null,[1,2]);var Hp=c(1506),rr=c(1507),Sm=c(276),Hl=c(179),Xl=c(253),Tm=c(280),yk=c(448);class Eq{constructor(G,ha,La,lb,Vb,tc,Nc){this.nyb=null;this.sa=new Q.a;this.fye=1;this.Jqd=-1;this.RYa=null;this.Aqa=()=>{this.z6e()};this.hb=ha;this.Ib=La;this.Hkd=lb;this.iM=Vb;this.dB=tc;this.ega=Nc;this.enable()}get pKd(){return this.fye}cpj(G){this.fye!==G&&(this.fye=G,this.sa.raiseEvent("X"),this.B0d&&this.lqg())}get B0d(){const G=ia.a.instance.Oa("WordEditor.Pagination.IPageEndMarkers");
return G?G.B0d:!0}get Ek(){return this.iM.value}get Hk(){return Jc.a.instance}uxk(G){this.sa.addHandler("X",G)}lqg(){this.Hk.ie(()=>{this.ega.pV(yk.a.f0i)},"CPC:UPN")}enable(){this.hb.Xw(this.Aqa);this.z6e()}z6e(){if(!this.RYa||1>=this.RYa.count)this.cpj(1);else{var G=this.hb.ib.lb;if(G){var ha=G.isForward?G.Rc:G.Pa;!ha||0>ha.cpBegin||(G=ha.node)&&ul.ParagraphReader.Xb(G)&&this.qPm(G)&&(this.nyb&&(this.Ib.ff(this.nyb),this.nyb=null),this.nyb=new Ab.a(2,1,400,La=>{this.findCurrentPageFromIp(La,ha)},
62),this.Ib.Wb(this.nyb))}}}qPm(G){G=Sl.GraphIterator.eb(G);return G.zb(35)||G.zb(37)||G.zb(39)?!1:!0}zHj(G){this.RYa=G;this.WFj()}WFj(){if(-1!==this.Jqd){var G=this.eEl(this.Jqd);-1!==G&&this.cpj(G)}}findCurrentPageFromIp(G,ha){this.nyb===G&&(this.nyb=null,this.Jqd=this.vMl(ha),-1!==this.Jqd&&this.WFj())}eEl(G){if(!this.RYa)return-1;for(let ha=0;ha<this.RYa.count;ha++){const La=this.RYa.J(ha);if(G>La.jnh&&G<La.jnh+La.height)return La.Eh}return-1}vMl(G){var ha=this.O9l(G);if(!ha||!ha.htmlElement)return-1;
const La=ha.getBounds();G=this.pUl(G,ha);if(!G)return-1;ha=wa.a.g3a(this.Hkd.A6a,ha.htmlElement).y;return G.y+Math.floor(G.height/2)-La.y+ha}O9l(G){return G.node.qe(this.Ek.$b)}pUl(G,ha){G=this.dB?this.dB.Ava(G,!0):G.cpBegin;return Tm.a.Vq(ha,G)}disable(){this.hb.jZ(this.Aqa)}}Object(e.a)(Eq,"CurrentPageCalculator",null,[2033,2034]);class Mo{constructor(G){Mo.RZ=G}get udf(){return Mo.RZ}get pKd(){return this.udf.pKd}Mvl(){this.udf.enable()}bpl(){this.udf.disable()}}Mo.RZ=null;Object(e.a)(Mo,"CurrentPageManager",
null,[2037]);var sr=c(118);class Vq extends Sys.EventArgs{constructor(G,ha){super();this.xRi=ha}}Object(e.a)(Vq,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class No extends Sys.EventArgs{constructor(G,ha,La){super();this.delta=G;this.xRi=La}}Object(e.a)(No,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class Jk{static get n0a(){if(null!=Jk.Xwg)var G=Jk.Xwg;else{var ha;G=!(null===(ha=l.AFrameworkApplication.K)||void 0===ha||!ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));G=Jk.Xwg=G}return G}constructor(G,ha,La){this.ech=this.Oud=-1;this.TAc=null;this.sa=new Q.a;this.MLe=!1;this.I_f=(lb,Vb)=>{this.MLe=this.rWk();Vb.pob||this.tvc.value.measure(this.lWk)};this.lWk=()=>{const lb=this.A6a.clientHeight;this.kWk(lb);this.uWk(lb)};this.i_f=(lb,Vb)=>{Vb.property===sr.a.vJ&&(lb=Vb.node)&&lb.ja(sr.a.vJ,!1)&&(lb=lb.qe(this.Ek.$b))&&(lb=lb.htmlElement)&&this.OYa.add(lb)};this.iM=G;this.tvc=ha;this.OYa=new zb.a;Jk.n0a||this.Ek.t0e(this.I_f);this.jAf();this.Gda=this.Gda.bind(this);
La.fBb(this.Gda);Jk.n0a&&0===La.ou&&this.ZJ()}ZJ(){this.Ek.t0e(this.I_f)}pAa(){this.Ek.Xbj(this.I_f)}get Ek(){return this.iM.value}Gda(G,ha){this.TAc=null;Jk.n0a&&(1===ha.rnb?this.pAa():0===ha.rnb&&this.ZJ())}get A6a(){this.TAc||(this.TAc=this.Ek.ed.qe(this.Ek.$b).A6a,na.ULS.shipAssertTag(34136386,336,!!this.TAc));return this.TAc}Iyk(G){this.sa.addHandler("OnPageContentSizeChangeKey",G)}kWk(G){G!==this.ech&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new Vq(G,this.MLe)),this.ech=G)}uWk(G){G!==
this.Oud&&(-1!==this.Oud&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new No(G-this.Oud,G,this.MLe)),this.Oud=this.A6a.clientHeight)}rWk(){let G=!1;for(let ha=this.OYa.count-1;0<=ha;ha--)this.OYa.J(ha).hasChildNodes()&&(this.OYa.removeAt(ha),G=!0);return G}jAf(){hb.App.li.Al.Te(23).qo(this.i_f)}}Object(e.a)(Jk,"DocumentSizeManager",null,[]);var V=c(56),qa=c(255);class pb{constructor(G){this.iM=G}get Ek(){const G=this.iM.value;na.ULS.shipAssertTag(37820298,336,G.$i,"OutlineManager.PageView is not a PageView.");
return G}Hhe(G,ha){const La=V.a.Oi(pb.Uf.IB(G),1);ha+=La;G.qe(this.Ek.$b).htmlElement.firstChild.style.minHeight=ha+"px"}x$h(){const G=Sl.GraphIterator.eb(this.Ek.ed);G.Ip();G.Rd();na.ULS.shipAssertTag(37820299,336,10===G.Gn.type);return G.Gn}Tbi(){const G=Sl.GraphIterator.eb(this.Ek.ed);G.Ip();G.lY();na.ULS.shipAssertTag(37820300,336,10===G.Gn.type);return G.Gn}Fam(G){const ha=Sl.GraphIterator.eb(this.Ek.ed);ha.Ip();ha.Rd();let La=ha.Gn,lb=null;for(;G!==La&&ha.Oj();)lb=La,La=ha.Gn;na.ULS.shipAssertTag(37820301,
336,10===ha.Gn.type);return lb}static get Uf(){return qa.a.instance}}Object(e.a)(pb,"OutlineManager",null,[2032]);class ec{constructor(G){this.XBa=0;this.B2=null;this.phg=ha=>{for(const La of ha.customData)this.showAdornmentText(La)};this.Ib=G}u9d(){this.B2||(this.B2=this.VKc())}ZGd(){this.B2&&0<ec.NPc(this.B2).length&&this.Ib.Wb(this.B2);this.B2=null}VKc(){return Object.assign(new Ab.a(3,1,250,this.phg,166),{customData:[]})}teg(G){this.XBa=G}ead(G){if(G){G.style.width=this.XBa+"px";if(this.B2)var ha=
this.B2;else ha=this.VKc(),this.Ib.Wb(ha);ec.NPc(ha).push(G)}}JTc(G){G&&(G.style.width="0px",this.Tzf(G))}Edd(G,ha){ha?this.ead(G):this.JTc(G)}showAdornmentText(G){G.style.width===this.XBa+"px"&&(this.aQc(G).style.visibility="visible")}Tzf(G){G&&(this.aQc(G).style.visibility="hidden")}aQc(G){G=G.childNodes;na.ULS.shipAssertTag(24958351,336,1===G.length,"Expected 1 child div in the page adornment, found "+G.length);return G[0]}static NPc(G){return G.customData}}Object(e.a)(ec,"PageAdornmentAnimationManager",
null,[2036]);class Hc{constructor(G){this.lm=G;this.Uaa=new vc.a;this.Vaa=new vc.a}aEa(G){G=Sl.GraphIterator.eb(G);if(G.Ip()&&G.Wp()){G.Rd();do 10===G.Xe&&this.U1f(G.currentNode),G.It();while(8!==G.Xe)}}ZQb(G){const ha=G.Eh;var La=this.iHb(G.rSb);if(!this.Uaa.nb(La))return na.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+La),!1;G=this.Uaa.J(La);na.ULS.shipAssertTag(24958353,336,this.Vaa.nb(La),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
La=this.Vaa.J(La);return this.Nzf(G,ha,La)}YQb(G){const ha=G.Eh;var La=this.iHb(G.rSb);if(!this.Uaa.nb(La))return na.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+La),!1;G=this.Uaa.J(La);na.ULS.shipAssertTag(24958355,336,this.Vaa.nb(La),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");La=this.Vaa.J(La);return this.Emf(G,ha,La)}Rvf(G){if(!G)return na.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ha=G.LEd;if(!ha)return na.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",G.Eh)),0;ha=this.lm.oGb(ha);if(!ha)return na.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ha=this.lm.$ha(ha);const La=1===G.Eh;G=!(G.Eh%2);return 1===ha?1:2===ha?La?2:1:3===ha?G?3:4:La?2:G?3:4}U1f(G){if(10===G.type){var ha=new vc.a,La=this.lm.oGb(G);
na.ULS.shipAssertTag(24958356,336,!!La,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var lb=this.lm.$ha(La);G=this.iHb(G);this.zqg(G,lb);this.yqg(G,ha);La=Sl.GraphIterator.eb(La);if(La.Wp()){La.Rd();do G=La.currentNode,lb=this.lm.WQc(G),G=this.lm.Ioi(G),ha.add(lb,G),La.It();while(36===La.Xe)}}}zqg(G,ha){this.Vaa.nb(G)?this.Vaa.Z(G,ha):this.Vaa.add(G,ha)}yqg(G,ha){this.Uaa.nb(G)?this.Uaa.Z(G,ha):this.Uaa.add(G,ha)}iHb(G){na.ULS.shipAssertTag(24958358,
336,10===G.type,"Expected node of type Outline but received node of type "+G.type);return G.ja(jm.a.Xja,0)}Nzf(G,ha,La){const lb=1===ha;ha=!(ha%2);switch(La){case 2:if(lb){if(G.nb(2))return G.J(2)}else if(G.nb(0))return G.J(0);break;case 3:if(ha){if(G.nb(1))return G.J(1)}else if(G.nb(0))return G.J(0);break;case 4:if(lb){if(G.nb(2))return G.J(2)}else if(ha){if(G.nb(1))return G.J(1)}else if(G.nb(0))return G.J(0);break;case 1:if(G.nb(0))return G.J(0)}return!1}Emf(G,ha,La){const lb=1===ha;ha=!(ha%2);
switch(La){case 2:if(lb){if(G.nb(5))return G.J(5)}else if(G.nb(3))return G.J(3);break;case 3:if(ha){if(G.nb(4))return G.J(4)}else if(G.nb(3))return G.J(3);break;case 4:if(lb){if(G.nb(5))return G.J(5)}else if(ha){if(G.nb(4))return G.J(4)}else if(G.nb(3))return G.J(3);break;case 1:if(G.nb(3))return G.J(3)}return!1}}Object(e.a)(Hc,"PageAdornmentContentManager",null,[2035]);var bd=c(1179);class vd{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd){this.Erg(G,ha,La,tc,Nc,hd,fd);this.Eh=G;this.Uq=ha;this.Pr=La;this.rSb=
lb;this.LEd=Vb;this.Agb=tc;this.Tac=Nc;this.T8b=hd;this.p0i=fd}get top(){return this.Uq}get height(){return this.Pr}l$c(G){this.Uq!==G&&(this.Agb.style.top=G+"px",this.Uq=G)}Vdg(G){this.height!==G&&(this.Agb.style.height=G+"px",this.Pr=G)}Erg(G,ha,La,lb,Vb,tc,Nc){na.ULS.shipAssertTag(37244961,336,0<G,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",G);na.ULS.shipAssertTag(37244962,336,0<=ha,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ha);na.ULS.shipAssertTag(37244963,
336,0<=La,"PageAdornmentContainer: height parameter value {0} is unexpected value.",La,ha);na.ULS.shipAssertTag(37244992,336,!!lb,"PageAdornmentContainer: containerDomElement parameter is null.");na.ULS.shipAssertTag(37244993,336,!!Vb,"PageAdornmentContainer: headerLabelDomElement parameter is null.");na.ULS.shipAssertTag(37244994,336,!!tc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");na.ULS.shipAssertTag(37244995,336,!!Nc,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(e.a)(vd,"PageAdornmentContainer",null,[2047]);class Fd{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd,we){this.QYg="headerFooterTab";this.ezd=null;this.Vs=!0;this.KDe=0;this.VIe=null;this.D3a=!1;this.JMb=Ce=>{this.dln(Ce.Yw);return!0};this.aC=()=>!0;this.ZHb=()=>{this.Oaf()&&(this.D3a=!1,this.CUo(),this.VIe=new Date)};this.NMb=Ce=>{this.D3a||this.aW.ead(Ce.Yw);return!0};this.MMb=Ce=>{this.D3a||(Ce=Ce.Yw,this.Xgg(Ce)||this.aW.JTc(Ce));return!0};this.fWn=()=>{let Ce=Array.dequeue(this.qQe);for(;Ce;)this.ZJ(Ce),
Ce=Array.dequeue(this.qQe);this.ezd=null};this.iM=G;this.ig=ha;this.xE=La;this.dla=lb;this.ga=Vb;this.sk=tc;this.aW=Nc;this.hBa=hd;this.aMa=fd;this.Ib=sd;this.Ca=Kd;this.qQe=[];this.w2=new Map;this.NI=Nd;this.Ax=we;this.aMa.zCd(this.ZHb);this.Rw=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.uL;if(this.gpd=(this.HFe=!!this.Ca&&this.Ca.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ca&&this.Ca.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Ld.StaticActiveAppFrame.za().bJ.getLayoutBreakpoint()&&
(this.Vs=!1),Ld.StaticActiveAppFrame.za().bJ.registerLayoutBreakpointChanged(this.QYg,Ce=>{switch(Ce){case "Small":this.gpi();break;default:this.ltj()}})}get Ek(){return this.iM.value}ltj(){try{this.nyo()}catch(G){na.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",G.message,G.stack)}}gpi(){try{this.cvm()}catch(G){na.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",G.message,G.stack)}}T0n(){for(const G of this.w2.keys())this.Kde(G)}aEa(){try{this.g4k()}catch(G){na.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",G.message,G.stack)}}zHj(G){try{this.jZo(G)}catch(ha){na.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ha.message)}}dispose(){try{this.bTo(),this.ITo(),this.aMa&&this.aMa.fcj(this.ZHb)}catch(G){na.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",G.message,G.stack)}}dln(G){const ha=this.WWc(G),La=this.P7h(G);La?(kd.b("OpenHeaderFooterFromWebViewAdornment"),
G=this.hBa.Rvf(La),this.ga.Qb(ha?vg.a.Fpe:vg.a.Led,2,G),this.D3a=!0):(na.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+G.id),this.ga.processAction(vg.a.mYd,2))}bTo(){this.w2.forEach(G=>{this.pAa(G)})}ITo(){this.Rw&&(this.gpd&&(Ld.StaticActiveAppFrame.za().bJ.unregisterLayoutBreakpointChanged(this.QYg),this.gpd=!1),this.Rw=!1)}pAa(G){if(G){var ha=G.Tac;G=G.T8b;Xi.a.Zpa(ha)&&Xi.a.Zpa(G)?(this.sk.uc(U.a.XR,ha,this.NMb),this.sk.uc(U.a.XR,G,this.NMb),
this.sk.uc(U.a.yL,ha,this.MMb),this.sk.uc(U.a.yL,G,this.MMb),this.ig.uc(U.a.click,ha,this.JMb),this.ig.uc(U.a.click,G,this.JMb),this.xE.uc(ha,Fd.AMb),this.xE.uc(G,Fd.AMb),this.dla.uc(U.a.Zx,ha,this.aC),this.dla.uc(U.a.Zx,G,this.aC)):na.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}WNn(G){this.qQe.push(G);this.ezd||(this.ezd=new Ab.a(2,1,50,this.fWn),this.Ib.Wb(this.ezd))}ZJ(G){if(G){var ha=G.Tac;G=G.T8b;Xi.a.Zpa(ha)&&Xi.a.Zpa(G)?
(this.sk.ob(U.a.XR,ha,this.NMb),this.sk.ob(U.a.XR,G,this.NMb),this.sk.ob(U.a.yL,ha,this.MMb),this.sk.ob(U.a.yL,G,this.MMb),this.ig.ob(U.a.click,ha,this.JMb),this.ig.ob(U.a.click,G,this.JMb),this.xE.ob(ha,Fd.AMb),this.xE.ob(G,Fd.AMb),this.dla.ob(U.a.Zx,ha,this.aC),this.dla.ob(U.a.Zx,G,this.aC)):na.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}nyo(){if(!this.Vs){for(const G of this.w2.values())G.Agb.style.display="block";this.Vs=
!0}}cvm(){this.Vs&&(this.w2.forEach(G=>{G.Agb.style.display="none"}),this.Vs=!1)}g4k(){this.hBa.aEa(this.Ek.ed)}jZo(G){this.aW.u9d();var ha=0;const La=new zb.a;this.aEa();const lb=this.L2l();for(var Vb of G)G=Vb.Eh,this.Bzn(Vb)||this.Kde(Vb.Eh),this.w2.has(G)?this.SVo(Vb):this.L$k(Vb),ha=G,La.add(G);for(Vb=1;Vb<=ha;Vb++)La.contains(Vb)||this.Kde(Vb);for(ha+=1;ha<=lb;ha++)this.Kde(ha);this.aW.ZGd()}Bzn(G){return this.w2.has(G.Eh)?this.w2.get(G.Eh).rSb.id===G.rSb.id:!1}L2l(){let G=0;this.w2.forEach((ha,
La)=>{La>G&&(G=La)});return G}L$k(G){const ha=G.rSb.qe(this.Ek.$b);if(ha){var La=G.Eh;G=this.FKc(La,G.top,G.height,ha.fca,G.rSb,G.LEd);this.WNn(G);this.tpg(G);this.Oqg(G);this.gpd&&!this.Vs&&(G.Agb.style.display="none");this.w2.set(La,G)}}FKc(G,ha,La,lb,Vb,tc){const Nc=Fh.b("div","","PageAdornmentContainer");Nc.style.top=ha+"px";Nc.style.height=La+"px";lb.appendChild(Nc);this.A6e(Nc,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);lb=this.gcf(G);Nc.appendChild(lb);
const hd=this.Fbf(G);Nc.appendChild(hd);const fd=this.vbf(G);Nc.appendChild(fd);l.AFrameworkApplication.isRtl&&(Nc.classList.add("Rtl"),hd.classList.add("Rtl"),fd.classList.add("Rtl"));return new vd(G,ha,La,Vb,tc,Nc,hd,fd,lb)}Fbf(G){G=Fh.b("div","h"+G,this.Ax?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.NI&&(this.Ax?G.classList.add("PageAdornmentHeaderFooterBorderThemed"):G.style.borderColor=bd.a.Ype);const ha=Fh.b("span","","");ha.innerText=WordEditorIntl.WordEditorStrings.l_Header;
ha.style.whiteSpace="nowrap";G.appendChild(ha);return G}vbf(G){G=Fh.b("div","f"+G,this.Ax?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.NI&&(this.Ax?G.classList.add("PageAdornmentHeaderFooterBorderThemed"):G.style.borderColor=bd.a.Ype);const ha=Fh.b("span","","");ha.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ha.style.whiteSpace="nowrap";G.appendChild(ha);return G}gcf(G){const ha=Fh.b("div","","PageAdornmentNumberLabel");ha.innerText=G.toString();return ha}A6e(G,ha,La){if(!this.KDe){const lb=
Fh.b("p","","");lb.innerText=ha;lb.style.whiteSpace="nowrap";lb.style.visibility="hidden";G.appendChild(lb);ha=Fh.b("p","","");ha.innerText=La;ha.style.whiteSpace="nowrap";ha.style.visibility="hidden";G.appendChild(ha);this.KDe=G.clientWidth;this.aW.teg(this.KDe);G.removeChild(lb);G.removeChild(ha)}}Kde(G){if(this.w2.has(G)){var ha=this.w2.get(G);this.pAa(ha);Xi.a.rx(ha.Agb);this.w2.delete(G)}}SVo(G){if(this.w2.has(G.Eh)){var ha=this.w2.get(G.Eh);ha.l$c(G.top);ha.Vdg(G.height);this.tpg(ha);this.Oqg(ha)}else na.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}CUo(){this.aW.u9d();this.aEa();this.w2.forEach(G=>{this.tpg(G);this.Oqg(G)});this.aW.ZGd()}tpg(G){const ha=G.Tac,La=G.T8b,lb=this.hBa.ZQb(G),Vb=this.hBa.YQb(G);this.t0o(G,lb,Vb);this.aW.Edd(ha,lb);this.aW.Edd(La,Vb)}t0o(G,ha=!0,La=!0){const lb=G.Tac;G=G.T8b;3!==l.AFrameworkApplication.va.mode?(lb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,G.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(lb.title=
ha?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,G.title=La?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}Xgg(G){const ha=this.P7h(G);return ha?this.WWc(G)?this.hBa.ZQb(ha):this.hBa.YQb(ha):(na.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}P7h(G){G=G.id;G=G.substring(1,G.length);G=Number.parseInvariant(G);return this.w2.has(G)?this.w2.get(G):(na.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+G),null)}WWc(G){return G.id.length?"h"===G.id.substring(0,1):(na.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}Oqg(G){const ha=G.height;ha<Fd.Ren?(G.Tac.classList.add(Fd.lkb),G.T8b.classList.add(Fd.lkb)):(G.Tac.classList.remove(Fd.lkb),G.T8b.classList.remove(Fd.lkb));ha<Fd.Sen?(G.p0i.classList.add(Fd.lkb),G.Agb.classList.add(Fd.lkb)):(G.p0i.classList.remove(Fd.lkb),G.Agb.classList.remove(Fd.lkb))}Oaf(){return!this.VIe||
Y.a.Ezf(this.VIe,500)}static AMb(){return!0}}Fd.lkb="Hidden";Fd.Ren=120;Fd.Sen=50;Object(e.a)(Fd,"PageAdornmentManager",null,[2038,10,2034]);class Ae{constructor(G,ha){this.c$d=new zb.a;this.c$d.add(G);this.c$d.add(ha)}}Object(e.a)(Ae,"PageElementManagerList",null,[]);var Yf=c(58);class tf{constructor(G,ha,La){this.nn=G;this.UZb=[];this.IK=ha;this.NI=La}U$i(){for(let G=0,ha=this.UZb.length;G<ha;G++)Xi.a.rx(this.UZb[G]);Array.clear(this.UZb)}t9h(G,ha,La,lb,Vb,tc){let Nc=Math.min(lb.x-tc.x,Vb.x-tc.x);
lb=Math.min(tc.x+tc.width-(lb.x+lb.width),tc.x+tc.width-(Vb.x+Vb.width));ha+=Vb.y-tc.y;({nja:ha,leftMargin:Nc,rightMargin:lb}=this.bBk(ha,Nc,lb));G=this.O8l(G,Nc,lb,Nc,lb,La);G.style.top=ha+"px";G.style.zIndex="0";this.UZb.push(G);Yf.d(G,!0);return G}DTd(G){return G?G.querySelector(".PageBreakBorderSpan"):null}O8l(G,ha,La,lb,Vb,tc){return G?this.qhm(ha,La,lb,Vb,tc):this.h9l(lb,Vb,tc)}bBk(G,ha,La){ha/=this.nn.instance.oj;La/=this.nn.instance.oj;G/=this.nn.instance.oj;return{nja:G,leftMargin:ha,rightMargin:La}}BOm(G){return this.UEi(G)&&
this.l0i(G)?(G=this.XGb(G))&&G.offsetParent?!1:!0:!1}AOm(G){return!this.UEi(G)||this.l0i(G)?!1:!0}UR(){}XGb(G){if(!G.o0f)return null;let ha=null;G.rlb&&!G.nda?(G=this.DTd(G.o0f))&&(ha=G):ha=G.o0f;return ha}UEi(G){return G.rlb&&!G.nda&&G.paragraphNode?!0:!1}l0i(G){G=G.paragraphNode;return!!G&&!!G.anchor}tBh(G,ha){G=wa.a.rFa(G);ha=wa.a.rFa(ha);return(G-ha)/this.nn.instance.oj}F6e(G,ha){G=wa.a.rFa(G);ha=wa.a.rFa(ha);return(G-ha)/this.nn.instance.oj}i0c(){this.BHj(!1)}h0c(){this.BHj(!0)}BHj(G){for(let ha=
0,La=this.UZb.length;ha<La;ha++){const lb=this.UZb[ha];"PageEndMarker.Para"===lb.id?tf.FHj(lb,G):"PageEndMarker.Table"===lb.id&&tf.yIj(lb,G)}}h9l(G,ha,La){if(!tf.N1b){tf.N1b=Fh.b("div","PageEndMarker.Para","PageEndMarker");var lb=Fh.b("div","","Current FullWidth");this.NI&&(lb.style.borderTopColor=this.IK.Rwa());tf.N1b.appendChild(lb);lb=Fh.b("div","","Stale LeftWing");const Vb=Fh.b("div","","Stale RightWing");this.NI&&(lb.style.borderTopColor=this.IK.Rwa(),Vb.style.borderTopColor=this.IK.Rwa());
tf.N1b.appendChild(lb);tf.N1b.appendChild(Vb)}lb=tf.N1b.cloneNode(!0);lb.childNodes[1].style.width=G-10+"px";lb.childNodes[2].style.width=ha-10+"px";tf.FHj(lb,La);return lb}qhm(G,ha,La,lb,Vb){if(!tf.oAb){tf.oAb=Fh.b("div","PageEndMarker.Table","PageEndMarker");var tc=Fh.b("div","","Current LeftWing"),Nc=Fh.b("div","","Current RightWing");this.NI&&(tc.style.borderTopColor=this.IK.Rwa(),Nc.style.borderTopColor=this.IK.Rwa());tf.oAb.appendChild(tc);tf.oAb.appendChild(Nc);tc=Fh.b("div","","Stale LeftWing");
Nc=Fh.b("div","","Stale RightWing");this.NI&&(tc.style.borderTopColor=this.IK.Rwa(),Nc.style.borderTopColor=this.IK.Rwa());tf.oAb.appendChild(tc);tf.oAb.appendChild(Nc)}tc=tf.oAb.cloneNode(!0);tc.childNodes[0].style.width=G+"px";tc.childNodes[1].style.width=ha+"px";tc.childNodes[2].style.width=La-10+"px";tc.childNodes[3].style.width=lb-10+"px";tf.yIj(tc,Vb);return tc}static FHj(G,ha){ha?tf.K$m(G):tf.L$m(G)}static L$m(G){G.childNodes[0].style.display="none";G.childNodes[1].style.display="block";G.childNodes[2].style.display=
"block"}static K$m(G){G.childNodes[0].style.display="block";G.childNodes[1].style.display="none";G.childNodes[2].style.display="none"}static yIj(G,ha){ha?tf.Q$m(G):tf.R$m(G)}static R$m(G){G.childNodes[0].style.display="none";G.childNodes[1].style.display="none";G.childNodes[2].style.display="block";G.childNodes[3].style.display="block"}static Q$m(G){G.childNodes[0].style.display="block";G.childNodes[1].style.display="block";G.childNodes[2].style.display="none";G.childNodes[3].style.display="none"}}
tf.N1b=null;tf.oAb=null;Object(e.a)(tf,"PageEndDOMHelper",null,[]);class gh{constructor(G,ha){this.yyb=this.lch=null;this.nn=G;this.ti=ha}Wjg(G,ha){try{this.gFo(G,ha)}catch(La){na.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",La.message)}}E3k(G,ha,La,lb,Vb,tc){this.ti.ie(()=>{try{this.F3k(G,ha,La,lb,Vb,tc)}catch(Nc){na.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Nc.message)}},"PEMPC:CP")}gFo(G,ha){this.lch=G;this.yyb=ha}F3k(G,ha,La,lb,Vb,tc){var Nc=this.lch;if(Nc&&G){var hd=Nc.count,fd=G.count;if(hd&&fd){var sd=this.HEl(Nc,G);if(sd.count){var Kd=this.nn.oj,Nd=this.s5b(sd)/Kd,we=this.nIh(sd)/Kd;G=this.aPd(Nc,G);if(G.count){Nc=this.s5b(G)/Kd;Kd=this.nIh(G)/Kd;var Ce=!0;for(var te=0;te<sd.count;te++)if(sd.J(te)){Ce=!1;break}var fe=te=0;this.yyb&&ha&&(te=this.hRk(this.yyb,ha),fe=ha.count-this.yyb.count);na.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:lb,
["EstimatedPageCount"]:hd,["CalculatedPageCount"]:fd,["InOrderAverageDelta"]:Nd,["InOrderStandardDeviation"]:we,["ShortestAverageDelta"]:Nc,["ShortestStandardDeviation"]:Kd,["PositionsShouldBeUpdated"]:La,["DocumentHeightChanged"]:Vb,["DeltasAllZero"]:Ce,["HeaderFooterOpenSinceLastResponse"]:tc,["DeltaInViewport"]:te,["ChangeInViewportMarkerCount"]:fe});Vb||tc||Ce||(na.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
ha=sd.toArray().toString(),La=G.toArray().toString(),na.ULS.sendTraceTag(35726603,336,50,"{0} {1}",ha,La))}}}}else na.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}hRk(G,ha){const La=new zb.a;for(const lb of G)La.add(lb.top);if(!La.count)return-1;G=new zb.a;for(const lb of ha)G.add(lb.top);if(!G.count)return-1;ha=this.aPd(La,G);return this.s5b(ha)/this.nn.oj}s5b(G){if(!G.count)return 0;let ha=0;for(let La=
0;La<G.count;La++)ha+=G.J(La);return ha/G.count}nIh(G){if(!G.count)return 0;const ha=this.s5b(G);let La=0;for(let lb=0;lb<G.count;lb++){const Vb=G.J(lb)-ha;La+=Vb*Vb}return Math.sqrt(La/G.count)}HEl(G,ha){const La=new zb.a;if(!G.count||!ha.count)return La;G.Sc((Vb,tc)=>Vb-tc);ha.Sc((Vb,tc)=>Vb-tc);const lb=Math.min(G.count,ha.count);for(let Vb=0;Vb<lb;Vb++){const tc=Math.abs(G.J(Vb)-ha.J(Vb));La.add(tc)}return La}aPd(G,ha){const La=new zb.a;if(!G.count||!ha.count)return La;var lb=G.count<=ha.count;
const Vb=lb?G:ha;G=lb?ha:G;for(ha=0;ha<Vb.count;ha++){lb=Vb.J(ha);let Nc=Math.abs(lb-G.J(0)),hd=0;for(let fd=1;fd<G.count;fd++){var tc=G.J(fd);tc=Math.abs(lb-tc);tc<Nc&&(Nc=tc,hd=fd)}La.add(Nc);G.removeAt(hd)}return La}}Object(e.a)(gh,"PageEndMarkerPositionComparer",null,[2040]);var Te=c(394),hf=c(598);class Ph{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd){this.Uq=G;this._pageNumber=ha;this.rlb=La;this.nda=lb;this.o0f=Vb;this.outlineNode=tc;this.outlineGroupNode=Nc;this.oah=hd;this.paragraphNode=fd;this.mV=
sd}get top(){return this.Uq}get Eh(){return this._pageNumber}get Xyn(){return this.oah}l$c(G){this.Uq=G}Ihe(G){this._pageNumber=G}mnj(G){this.oah=G}}Object(e.a)(Ph,"PageEndMarker",null,[]);class Jh{constructor(){this.kf=null;this.FRi=0}}Object(e.a)(Jh,"PageEndMarkerToRestore",null,[]);class xg{constructor(G,ha,La,lb,Vb,tc,Nc){this.i_f=(hd,fd)=>{fd.property===sr.a.vJ&&(hd=fd.node)&&hd.ja(sr.a.vJ,!1)&&this.QAd.contains(hd.id)&&(fd=hd.qe(this.Ek.$b))&&(fd=fd.htmlElement)&&(this.QAd.remove(hd.id),this.OYa.add(fd))};
this.iM=G;this.nn=ha;this.XMa=La;this.uy=lb;this.PNe=Vb;this.j_=tc;this.Rq=Nc;this.xt=new zb.a;this.VZb=new zb.a;this.nAb=new vc.a;this.QAd=new hf.a(new Te.a);this.OYa=new zb.a;this.YZb=!!Vb;this.jAf()}get Ek(){const G=this.iM.value;na.ULS.shipAssertTag(37052750,336,G.$i,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return G}Xoc(G){try{this.KYo(G)}catch(ha){this.uy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
ha.message)}}bvk(G){try{this.cvk(G)}catch(ha){this.uy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ha.message)}}fSk(G){try{return this.gSk(G)}catch(ha){this.uy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ha.message)}return!1}I8n(){try{this.J8n()}catch(G){this.uy.UR(G.message+" "+G.stack),na.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",G.message)}}YRc(){try{return this.bcm()}catch(G){return this.uy.UR(G.message+" "+G.stack),na.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",G.message),null}}xqg(){try{this.n_o()}catch(G){this.uy.UR(G.message+" "+G.stack),na.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
G.message)}}j8e(){try{return this.SXk()}catch(G){return this.uy.UR(G.message+" "+G.stack),na.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",G.message),!1}}NEm(G){try{this.OEm(G)}catch(ha){this.uy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ha.message)}}KYo(G){if(G){this.AZk();for(let ha=0;ha<G.length;ha++){const La=
ha+1,lb=this.s5k(G[ha],La);this.xt.add(lb);this.nAb.add(La,lb)}}}OEm(G){let ha=!1;for(const La of G)if(La)if(0<La.Xy)for(const lb of La.YCf)ha=this.iCd(lb,La.outlineGroupNode)||ha;else if(0>La.Xy){ha=!0;for(const lb of La.lLd)this.zll(lb.Eh)}ha&&this.I9f()}cvk(G){const ha=this.T7h(G.paragraphNode);this.iCd(G,ha)&&this.I9f()}zll(G){const ha=G-1;0>ha||this.xt.count<=ha||(this.xt.removeAt(ha),this.nAb.nb(G)&&this.nAb.remove(G))}bcm(){const G=new zb.a;for(const ha of this.xt)this.Edc(ha)&&G.add(ha);return G}iCd(G,
ha){if(!G)return na.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ha=this.q5k(G,ha);G=G.VJm?-1:G.Eh;let La=!1,lb;this.nAb.nb(G)?(lb=this.nAb.J(G).Eh,ha.Ihe(lb),this.xt.Z(lb-1,ha),this.nAb.remove(G)):(lb=ha.Eh,this.xt.insert(lb-1,ha),La=!0);return La}s5k(G,ha){return new Ph(0,ha,G.HardBreak,!1,null,null,null,0,null,null)}q5k(G,ha){const La=G.uob,lb=G.Eh,Vb=G.mV,tc=!!Vb&&Vb.HardBreak,Nc=G.nda,hd=G.paragraphNode,fd=this.eei(ha),
sd=G.outlineNode;var Kd=this.Dtf(sd);if(!Kd)return na.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Nd=null;tc&&(Nd=this.uy.DTd(G.uob));G=this.uy.tBh(Nd||La,fd);Kd=this.uy.F6e(Nd||La,Kd);return new Ph(Kd,lb,tc,Nc,La,sd,ha,G,hd,Vb)}gSk(G){this.VZb=new zb.a;this.YZb&&this.PNe.reset();this.K_n();this.eBo();this.cBk();this.URk(G);return 0<this.VZb.count}K_n(){for(let G=0;G<this.xt.count;G++){const ha=this.xt.J(G);this.uy.BOm(ha)?
this.f9m(ha):(this.uy.AOm(ha)||this.Edc(ha)&&!this.Dtf(ha.outlineNode))&&this.bbj(ha)}}cBk(){let G=0,ha=null;var La=0;let lb=0;for(let Vb=0;Vb<this.xt.count;Vb++){const tc=this.xt.J(Vb);this.Edc(tc)&&(tc.rlb&&(lb+=this.qBh(tc,La,lb)),ha&&ha.id===tc.outlineNode.id||(ha=tc.outlineNode,lb=G=0),tc.rlb&&!tc.nda&&(G=this.SRk(tc)),La=tc.top+G+lb,tc.l$c(La))}this.qBh(null,La,lb);this.C_n()}qBh(G,ha,La){let lb=null;this.YZb&&(lb=this.PNe.VRk(G,ha,La));return lb?lb.delta:0}J8n(){if(this.VZb){for(let G=0;G<
this.VZb.count;G++){const ha=this.VZb.J(G);Xi.a.Uio(ha.kf,ha.FRi)}this.YZb&&this.PNe.F8n()}}n_o(){if(!this.YZb){var G=this.XMa.Tbi();if(this.xt.count){var ha=this.XMa.x$h();for(let Vb=0;Vb<this.xt.count;Vb++){var La=this.xt.J(Vb);if(this.Edc(La)&&La.nda){La=this.XMa.Fam(La.outlineNode);var lb=0<Vb?this.xt.J(Vb-1).outlineNode:ha;lb=Vb&&La.id===lb.id?this.xt.J(Vb-1).top:0;this.XMa.Hhe(La,lb)}}ha=this.xt.J(this.xt.count-1);ha.nda?this.XMa.Hhe(G,0):this.XMa.Hhe(G,ha.top)}else this.XMa.Hhe(G,0)}}eBo(){this.xt.Sc((G,
ha)=>G.Eh-ha.Eh)}I9f(){for(let G=0;G<this.xt.count;G++)this.xt.J(G).Ihe(G+1)}SRk(G){return G?this.sBh(G)-G.top:(na.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}dSk(G){if(!G)return 0;const ha=this.eei(G.outlineGroupNode);return ha?this.uy.tBh(this.uy.XGb(G),ha):0}sBh(G){if(!G)return 0;const ha=this.uy.XGb(G);G=this.Dtf(G.outlineNode);return G?this.uy.F6e(ha,G):(na.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}C_n(){let G=0,ha=!1,La=null,lb=!1;for(let Vb=this.xt.count-1;0<=Vb;Vb--){const tc=this.xt.J(Vb);this.Edc(tc)&&(La&&La.id===tc.outlineNode.id||(ha=!La,La=tc.outlineNode,G=this.x8l(La)),tc.rlb?(ha=!1,G=tc.top):this.YZb&&ha||!(tc.top>G)||(this.bbj(tc),Xi.a.rx(this.uy.XGb(tc)),lb=!0))}lb&&this.I9f()}bbj(G){this.xt.contains(G)&&(this.YZb&&this.j_.U0n(G),this.xt.remove(G))}Edc(G){return G?(G=this.uy.XGb(G))&&G.offsetParent?!0:!1:(na.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}SXk(){let G=!1;for(let ha=this.OYa.count-1;0<=ha;ha--)this.OYa.J(ha).hasChildNodes()&&(this.OYa.removeAt(ha),G=!0);return G}f9m(G){(G=this.T7h(G.paragraphNode))&&(this.QAd.contains(G.id)||this.QAd.add(G.id))}jAf(){this.Rq&&this.Rq.Te(23).qo(this.i_f)}URk(G){for(let ha=this.xt.count-1;0<=ha;ha--){const La=this.xt.J(ha);this.Edc(La)&&this.TRk(La,G)}}TRk(G,ha){const La=this.sBh(G),lb=this.dSk(G);G.rlb?(G.l$c(La),G.mnj(lb)):(ha=ha?La-G.top:lb-G.Xyn,G.l$c(La-ha),G.mnj(lb-ha),1<Math.abs(ha)&&this.Dno(this.uy.XGb(G),
ha))}Dtf(G){if(!G)return null;G=G.qe(this.Ek.$b);return G?G.htmlElement:(na.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}eei(G){return G?(G=G.qe(this.Ek.$b))?G.htmlElement:null:null}T7h(G){G=Sl.GraphIterator.eb(G);return G.zb(23)?G.jd(23):null}w8l(G){if(!G)return null;G=G.qe(this.Ek.$b);return G?wa.a.getElementBounds(G.htmlElement):(na.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}x8l(G){return(G=
this.w8l(G))?G.height/this.nn.oj:0}Dno(G,ha){ha=(Xi.a.lXl(G)-ha)*this.nn.oj;this.VZb.add(Object.assign(new Jh,{kf:G,FRi:ha}))}AZk(){this.xt=new zb.a;this.nAb=new vc.a}}Object(e.a)(xg,"PageEndMarkerPositionUpdater",null,[2039]);var ri=c(368),Lj=c(33),tn=c(355),xl=c(21),ll;(function(G){G[G.para=0]="para";G[G.tableSplit=1]="tableSplit";G[G.tableRowSplit=2]="tableRowSplit"})(ll||(ll={}));Object(e.b)("PageEndType",ll);class Um{constructor(G,ha,La,lb,Vb,tc,Nc=!1,hd=!1,fd=!1,sd=!1,Kd=!1){this.Erg(ha,La,
lb,Vb,tc,fd,Kd);this.position=G;this.Eh=ha;this.paragraphNode=La;this.mV=lb;this.uob=Vb;this.outlineNode=tc;this.N4a=Nc;this.pEi=hd;this.VJm=fd;this.nda=sd;this.G0d=Kd}Ihe(G){this.Eh=G}Erg(G,ha,La,lb,Vb,tc,Nc){Nc||(na.ULS.shipAssertTag(38326881,336,!!Vb,"PageEndDetails: outlineNode parameter value is null."),na.ULS.shipAssertTag(24126528,336,0<=G,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",G),na.ULS.shipAssertTag(24126529,336,!!ha||tc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),
na.ULS.shipAssertTag(24126530,336,!!La||tc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),na.ULS.shipAssertTag(24126531,336,!!lb||tc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static Wbl(G,ha){return Um.ebf(0,G,null,ha,!0,!1)}static Xbl(G){return Um.ebf(0,0,null,G,!1,!0)}static ebf(G,ha,La,lb,Vb,tc){return new Um(G,ha,null,null,La,lb,Vb,tc,!0)}static d6b(G,ha){return new Um(0,G,null,ha,null,null,void 0,void 0,void 0,
void 0,!0)}}Object(e.a)(Um,"PageEndDetails",null,[]);class Vm{constructor(G,ha,La,lb,Vb,tc,Nc,hd,fd,sd,Kd,Nd,we,Ce,te,fe,Cf,Th,Vf,Gj){this.Jta=!0;this.Jxe=0;this.Itd=this.LDe=this.MDe=this.Kze=this.NNe=this.vDe=!1;this.Fvd=this.Uyb=null;this.aHe=!0;this.zMb=()=>{this.i0c()};this.hXf=()=>{this.MDe=!1};this.iXf=()=>{this.LDe=this.MDe=!0};this.isn=(Qh,zg)=>{1>=Math.abs(zg.delta)||(this.Kze=!0,this.AHj(!zg.xRi))};this.zUn=Qh=>{Qh===this.Uyb&&(this.Uyb=null);if(this.Jta){var zg=Qh.customData;if(Qh=this.PYa.get(zg.id))for(this.PYa.Z(zg.id,
new zb.a),na.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Qh.count,zg.id),this.Waa&&this.Waa.aEa(),zg=0;zg<Qh.count;zg++){const $i=Qh.J(zg),xm=$i.mV;xm.HardBreak||(Xi.a.rx($i.uob),this.u9f(xm))}}};this.yUn=()=>{this.Fvd=null;this.Jta&&this.oja&&0<this.oja.count&&(na.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.Xoc(this.oja.toArray(),this.Jta))};this.iM=G;this.ji=ha;this.Waa=La;
this.cO=lb;this.xah=Vb;this.adb=tc;Vm.uy=hd;this.JXg=fd;this.XI=sd;this.Ib=Kd;this.P4j=Nd;this.je=Ce;this.j_=fe;this.RNe=Cf;this.$Zb=Th;this.RZ=Vf;this.EZb=new ri.a;this.WZb=new zb.a;this.oja=new zb.a;this.PYa=new ri.a;this.ON=we;this.qT=Gj;this.i$d=this.i$d.bind(this);this.k$d=this.k$d.bind(this);this.w6c=this.w6c.bind(this);this.Gda=this.Gda.bind(this);this.ON.pGc(this.zMb);this.ONe=!1;te&&(te.Frh(this.iXf),te.zCd(this.hXf));Nc&&Nc.Iyk(this.isn);this.qT.fBb(this.Gda)}get B0d(){return this.aHe}get Ek(){return this.iM.value}get sj(){return this.ji.value}Xoc(G,
ha){const La=this.je.Yf("Task","UpdateMarkers");this.eFo();this.Jta=ha;Vm.uy.U$i();this.EZb=new ri.a;this.WZb.clear();this.oja.clear();this.PYa=new ri.a;this.aHe=this.vDe=!1;this.cO&&this.cO.Xoc(G);this.Mxl();this.Jxe=G.length;this.j_&&this.j_.reset(G);this.Waa&&this.Waa.aEa();for(const lb of G)this.oja.add(lb),this.u9f(lb);ha&&this.cO&&this.RNe&&this.RNe.isEnabled&&(G=this.cO.YRc(),this.RNe.HDa(G));this.D3k();this.Kze=this.NNe=!1;this.LDe=this.MDe;Af.WoncaApp.instance.tIb&&Vm.ZAf&&this.cO.xqg();
this.adb.hZo(this.cO.YRc(),this.oja.count);this.aHe=!0;this.RZ.lqg();La.stop();na.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:La.pi,["RenderedLineCount"]:this.Jxe,["AvgDurationPerPageInMs"]:La.pi/this.lei()})}nei(){const G=this.cO.YRc();if(!G)return null;const ha=Xi.a.kY(),La=new zb.a;for(const lb of G)this.tSm(lb,ha)&&La.add(lb);return La}tSm(G,ha){if(!G)return!1;G=Vm.uy.XGb(G);if(!G)return!1;G=wa.a.rFa(G);return 0<=G&&G<=ha}T4h(){const G=new zb.a;if(!this.PYa)return na.ULS.sendTraceTag(35005382,
336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),G;const ha=this.PYa.keys;for(let Vb=0;Vb<ha.length;Vb++){var La=ha.J(Vb);if(La=this.PYa.J(La))for(let tc=0;tc<La.count;tc++){var lb=La.J(tc);lb.mV.HardBreak||lb.uob.classList.contains("Hidden")||(lb=wa.a.rFa(lb.uob),G.add(lb))}}return G}eFo(){const G=this.T4h(),ha=this.nei();this.xah.Wjg(G,ha);this.$Zb&&this.$Zb.isEnabled&&this.$Zb.Wjg(ha)}D3k(){if(!(25<this.lei())){var G=this.T4h(),ha=this.nei();
this.xah.E3k(G,ha,this.NNe,this.vDe,this.Kze,this.LDe);this.$Zb&&this.$Zb.isEnabled&&this.$Zb.HDa(ha)}}Gda(){this.Waa.T0n();this.ySh()}ySh(){this.Itd&&(this.Ek.Xbj(this.i$d),this.Ek.O2n(this.k$d),this.Ek.u2n(this.w6c),this.Itd=!1)}Mxl(){this.Itd||(this.Ek.t0e(this.i$d),this.Ek.pzk(this.k$d),this.Ek.Arh(this.w6c),this.Itd=!0)}u9f(G){if(this.ONe)return!0;G=this.N3n(G);if(!G)return!1;this.j_&&this.j_.pqm(G);this.cO&&(this.cO.bvk(G),this.adb.xHj(this.cO.YRc()),Af.WoncaApp.instance.tIb&&Vm.ZAf&&this.cO.xqg());
return!0}N3n(G){let ha=this.NM(G.ParaId);if(!ha)return null;if(!ha.anchor||!ha.yj)return this.yqh(G,ha),null;let La,lb;if(G.HardBreak){var Vb=ul.ParagraphReader.Wf(ha,!0,!0,!0);this.HAn(Vb)&&(ha=Vb);if(!({nja:Vb,outlineGroupNode:La,sob:lb}=this.jQo(G,ha)).returnValue)return null;this.vDe=!0}else if(!({d$d:Vb,outlineGroupNode:La,sob:lb}=this.O3n(G,ha)).returnValue)return null;return this.iCd(ha,G,Vb,La,lb)}HAn(G){return G?(G=G.qe(this.Ek.$b))?!!Vm.uy.DTd(G.htmlElement):!1:!1}O3n(G,ha){var La=G.PageEndType;
let lb,Vb=0,tc=null;if(!La){if(!({nja:G,D6a:lb}=this.oei(G,ha)).returnValue)return{returnValue:!1,d$d:Vb,outlineGroupNode:tc,sob:null}}else if(!({nja:G,Fle:lb}=this.P8l(G,ha)).returnValue)return{returnValue:!1,d$d:Vb,outlineGroupNode:tc,sob:null};var Nc=Sl.GraphIterator.eb(ha);Nc.od();tc=Nc.jd(23);ha=tc.qe(this.Ek.$b).getBounds();Nc=Nc.mUa().qe(this.Ek.$b);if(!Nc)return na.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.Ek.$b),{returnValue:!1,d$d:Vb,outlineGroupNode:tc,
sob:null};const hd=Nc.getBounds();Vb=G-ha.y;La=Vm.uy.t9h(La,Vb,this.Jta,lb,ha,hd);Nc.fca.appendChild(La);return{returnValue:!0,d$d:Vb,outlineGroupNode:tc,sob:La}}jQo(G,ha){let La=null;const lb=ha.qe(this.Ek.$b);var Vb=0;let tc=null;if(this.Z1d(G,lb,ha))return{returnValue:!1,nja:Vb,outlineGroupNode:La,sob:tc};La=Vm.eRi(ha);const Nc=La.qe(this.Ek.$b);if(!Nc)return na.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.Ek.$b),{returnValue:!1,nja:Vb,outlineGroupNode:La,
sob:tc};Vb=Nc.getBounds();Vb=Tm.a.Vq(lb,G.CP).y-Vb.y;tc=this.M_l(ha);return{returnValue:!0,nja:Vb,outlineGroupNode:La,sob:tc}}M_l(G){return G.qe(this.Ek.$b).htmlElement}NM(G){const ha=this.XI.Ajb(G);if(ha!==ei.a.nil){const La=this.sj.Eb(ha);if(La)return La}na.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",G,ha);return null}oei(G,ha){const La=G.CP;let lb=0,Vb=null;const tc=ha.qe(this.Ek.$b);if(this.Z1d(G,tc,ha))return{returnValue:!1,nja:lb,D6a:Vb};
Vb=tc.getBounds();lb=La?this.JXg(Object(Lb.a)(94,tc),La):Vb.y-this.P4j(tc);return{returnValue:!0,nja:lb,D6a:Vb}}P8l(G,ha){let La=null,lb=0;var Vb=G.PageEndType;let tc=Sl.GraphIterator.eb(ha);tc.od();if(!Lj.TableReader.mx(tc))return na.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",G.ParaId),{returnValue:({nja:lb,D6a:La}=this.oei(G,ha)).returnValue,nja:lb,Fle:La};if(Vb===ll.tableSplit){xl.returnToContainingRow(tc);Vb=tc.currentNode.qe(this.Ek.$b);
if(this.Z1d(G,Vb,ha))return{returnValue:!1,nja:lb,Fle:La};lb=Vb.getBounds().y}else{Vb=ha.qe(this.Ek.$b);if(this.Z1d(G,Vb,ha))return{returnValue:!1,nja:lb,Fle:La};lb=this.JXg(Object(Lb.a)(94,Vb),G.CP)}--lb;ha=null;do G=ha,ha=tc.jd(14);while(ha);tc=Sl.GraphIterator.eb(G);tc.od();xl.moveToFirstRow(tc);La=tc.currentNode.qe(this.Ek.$b).getBounds();return{returnValue:!0,nja:lb,Fle:La}}Z1d(G,ha,La){if(!ha||ha.rqa(16))return this.yqh(G,La),!0;ha=ha.getBounds();return ha.width||ha.height?!1:(this.Jph(G),!0)}Jph(G){this.WZb.contains(G)||
this.WZb.add(G)}yqh(G,ha){ha=ha.id;let La;({value:La}=this.EZb.Fc(ha)).returnValue||(La=new zb.a,this.EZb.Z(ha,La));La.add(G)}i$d(){const G=new zb.a;for(let ha=this.WZb.count-1;0<=ha;ha--){const La=this.WZb.J(ha);this.u9f(La)||G.add(La)}this.WZb=G;this.j8e()}j8e(){this.cO&&this.cO.j8e()&&this.AHj(!1)}AHj(G){this.cO&&(this.cO.fSk(G)&&(this.NNe=!0),this.cO.I8n(),this.adb.xHj(this.cO.YRc()),Af.WoncaApp.instance.tIb&&Vm.ZAf&&this.cO.xqg())}k$d(G,ha){try{const La=ha.id;if(this.EZb.nb(La)){const lb=this.EZb.J(La);
for(G=0;G<lb.count;G++)this.Jph(lb.J(G));this.EZb.remove(La)}}catch(La){}}i0c(){this.Jta&&(this.Jta=!1,Vm.uy.i0c())}h0c(){this.Jta||(this.Jta=!0,Vm.uy.h0c())}mtj(){this.ONe=!1;this.oja&&this.Xoc(this.oja.toArray(),this.Jta);this.Waa&&this.Waa.ltj()}hpi(){this.ONe=!0;Vm.uy.U$i();this.Waa&&this.Waa.gpi();this.j_&&this.j_.dvm()}iCd(G,ha,La,lb,Vb){const tc=this.oja.indexOf(ha)+1;if(0>tc)return null;const Nc=Xl.WordSectionNavigator.instance.zL(G),hd=this.nda(ha,G);G=new Um(La,tc,G,ha,Vb,Nc,!G||!ha||!Vb,
!1,!1,hd);this.PYa.nb(lb.id)||this.PYa.Z(lb.id,new zb.a);this.PYa.J(lb.id).add(G);return G}nda(G,ha){if(!G||!G.HardBreak)return!1;G=Sl.GraphIterator.eb(ha);G.zb(7);if(G.FJ())return!1;G.jd(23);return G.FJ()?!1:!0}T6f(G){this.Jta&&(G.anchor&&G.yj?!(G=Vm.eRi(G))||this.Uyb&&this.Uyb.customData&&this.Uyb.customData.id===G.id||(this.Uyb=Object.assign(new Ab.a(3,1,500,this.zUn),{customData:G}),this.Ib.Wb(this.Uyb)):na.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}w6c(){this.Jta&&
!this.Fvd&&this.oja&&0<this.oja.count&&(this.Fvd=new Ab.a(3,1,500,this.yUn),this.Ib.Wb(this.Fvd))}dispose(){this.Ek&&this.ySh();this.qT.a9f(this.Gda);this.ON.cee(this.zMb)}static get ZAf(){null==Vm.MEe&&(Vm.MEe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Vm.MEe}static I_l(G){let ha=0;try{const La=G.htmlElement,lb=Xi.a.jN(La.firstChild.style.marginTop);G=0;const Vb=Vm.fuf(La.parentNode);if(Vb){const tc=Vb.firstChild;tc&&tc.classList.contains("ParaWrappingDiv")&&(G=Xi.a.jN(tc.firstChild.style.marginBottom))}ha=
Math.max(lb,G)/2}catch(La){}return ha}static fuf(G){let ha=G.previousSibling;if(!ha){var La=G.parentNode;Xi.a.BGf(La)&&(La=La.parentNode)&&(ha=La.previousSibling)}if(!ha&&(G=G.parentNode,G.classList.contains("OutlineGroup")||na.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",G.tagName,G.className),(G=G.previousSibling)&&G.hasChildNodes())){ha=G.lastChild;do{if(ha.classList.contains("OutlineElement")||Xi.a.BGf(ha)&&ha.classList.contains(tn.a.nfc))break;
ha=ha.previousSibling}while(ha)}if(ha){if(ha.classList.contains(tn.a.nfc))return ha.lastChild.lastChild;if(Xi.a.BGf(ha))return ha.lastChild}return ha}static eRi(G){G=Sl.GraphIterator.eb(G);return G.zb(23)?G.jd(23):null}lei(){return this.Jxe+1}}Vm.uy=null;Vm.MEe=null;Object(e.a)(Vm,"PageEndMarkers",null,[2042,2043,10]);var Up=c(144);class ds{constructor(G,ha,La){this.Uyn=".Outline";this.iM=G;this.nn=ha;this.uy=La}get Ek(){const G=this.iM.value;na.ULS.shipAssertTag(38416594,336,G.$i,"Invalid PageView.");
return G}G9b(G){return(G=G.outlineNode)?this.cei(G):(na.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}cei(G){let ha,La;return(ha=G.qe(this.Ek.$b))&&(La=ha.htmlElement)?La.querySelector(this.Uyn):(na.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}S7h(G){G=fm.OutlineElementNavigator.Fl(G.paragraphNode);let ha;return G&&(ha=G.qe(this.Ek.$b))?ha.htmlElement:(na.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}hBh(G,
ha){const La=this.ylm(G);return this.ZRk(G,ha)-La}o9h(G){return this.hei(G.outlineNode,G.Eh)}hei(G,ha){if(!G)return-1;var La=G.ja(jm.a.uv,-1);La=V.a.Oi(La,1);var lb=G.ja(jm.a.marginTop,-1);lb=V.a.Oi(lb,1);G=G.ja(jm.a.marginBottom,-1);G=V.a.Oi(G,1);return 1===ha?La-G:La-(lb+G)}xll(G){G&&Xi.a.rx(G.uob)}auf(G){if(G.pEi||G.nda)return 0;if(G.N4a)return G=this.G9b(G),wa.a.getElementBounds(G).height/this.nn.oj;const ha=this.G9b(G);return this.uy.F6e(this.mei(G),ha)}w$k(G,ha,La){La=La.qe(this.Ek.$b).getBounds();
G=G.qe(this.Ek.$b);const lb=G.getBounds();La.y=lb.y;ha=this.uy.t9h(ll.para,ha*this.nn.oj,!1,La,La,lb);G.fca.appendChild(ha);return ha}Iti(G,ha){if(G&&!G.G0d)if(G.N4a){if(G=this.G9b(G))G.style.paddingBottom=ha+"px"}else if(G.mV&&G.mV.HardBreak)if(G.nda){if(G=this.Cfi(G))G.style.paddingBottom=ha+"px"}else{if(G=this.S7h(G))G.style.paddingTop=ha+"px"}else na.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}wsh(G,ha){ha=this.G9b(ha);G=this.G9b(G);
return wa.a.rFa(ha)-wa.a.rFa(G)}Dfi(G){G=Sl.GraphIterator.eb(G.outlineNode);G.zb(7);return G.FJ()}mBi(G){if(!G||G.G0d)return!1;if(G.N4a||G.pEi)return!0;G=this.mei(G);return!!G&&Xi.a.hca(G)}UR(G){this.uy.UR(G)}Cfi(G){return(G=this.Dfi(G))?(G=G.Aj(this.Ek.$b).htmlElement,G?G:(na.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}mei(G){return G.mV&&G.mV.HardBreak&&!G.nda?this.uy.DTd(G.uob):G.uob}ylm(G){if(G.N4a){G=this.G9b(G);if(!G)return na.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),
-1;G=Up.a.BB(G);return Xi.a.Xha(G.paddingBottom)}if(G.mV&&G.mV.HardBreak){if(G.nda)return(G=this.Cfi(G))?Xi.a.Xha(G.style.paddingBottom):-1;G=this.S7h(G);return G?Xi.a.Xha(G.style.paddingTop):(na.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}ZRk(G,ha){return this.auf(G)-ha}}Object(e.a)(ds,"PageFullHeightDOMHelper",null,[]);class Wo{constructor(){this.delta=this.oLj=this.Xy=0;this.mja=null;this.GPa=this.l4i=0;this.outlineGroupNode=null;this.dEa=0;this.YCf=
new zb.a;this.lLd=new zb.a;this.Bhn=new zb.a}}Object(e.a)(Wo,"PageFullHeightInfo",null,[]);class si{constructor(G,ha){this.lCa=G;this.vy=ha}rBh(G,ha){try{return this.WRk(G,ha)}catch(La){return this.vy.UR(La.message+" "+La.stack),na.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",La.message),null}}WRk(G,ha){na.ULS.shipAssertTag(38416596,336,G.N4a||G.mV.HardBreak);const La=this.vy.auf(G),lb=this.vy.hBh(G,ha),Vb=this.lCa.dBh(G,lb);G=Object.assign(new Wo,
{dEa:lb,GPa:Vb,mja:G});this.TXo(G);G.oLj=G.GPa-G.dEa;G.delta=ha+Vb+G.delta-La;return G}TXo(G){G.dEa>G.GPa?this.UXo(G):0>G.dEa&&this.aqg(G)}aqg(G){let ha=G.mja.Eh;for(;0>G.dEa;)G.Xy--,G.delta-=this.lCa.DQc(ha),G.dEa+=this.lCa.DQc(ha-1),ha--;G.GPa=this.lCa.DQc(ha)}UXo(G){const ha=this.vy.o9h(G.mja);G.Xy=Math.floor((G.dEa-G.GPa)/ha)+1;G.delta=G.Xy*ha;G.dEa-=G.GPa+(G.Xy-1)*ha;G.GPa=ha}}Object(e.a)(si,"PageFullHeightInfoCalculator",null,[]);class dl{constructor(G,ha,La,lb){this.g_a=0;this.VNa=null;this.lCa=
G;this.Zxb=ha;this.kX=La;this.vy=lb;this.xdh=new zb.a}get kZ(){return this.xdh}pqm(G){try{this.Lyf(G)}catch(ha){this.vy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ha.message)}}reset(G){try{this.Z6n(G)}catch(ha){this.vy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ha.message)}}dvm(){try{this.evm()}catch(G){this.vy.UR(G.message+" "+G.stack),
na.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",G.message)}}PEm(G){try{this.QEm(G)}catch(ha){this.vy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ha.message)}}U0n(G){try{this.V0n(G)}catch(ha){this.vy.UR("Pagination: "+ha.message+" "+ha.stack),na.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",
ha.message)}}zBm(){var G=this.kX.hrf(),ha=this.kX.Nbi();G=Um.Xbl(G);ha=Um.Wbl(this.g_a,ha);this.kZ.Z(0,G);this.Lyf(ha)}c7n(){var G=Xl.WordSectionNavigator.instance.Nbi();(G=this.vy.cei(G).parentNode)&&""!==G.style.minHeight&&(G.style.minHeight="")}wCm(G){this.xdh=new zb.a;this.kZ.add(null);for(let ha=0;ha<G.length;ha++){const La=Um.d6b(ha+1,G[ha]);this.kZ.add(La)}this.kZ.add(Um.d6b(G.length+1,null))}hCm(G){this.lCa.j7n(G)}J7n(){if(this.kZ)for(const G of this.kZ)G&&this.azi(G)&&this.vy.Iti(G,0)}Lyf(G){const ha=
this.zam(G);if(this.vy.mBi(ha)){let La=this.vy.auf(ha);G.outlineNode!==ha.outlineNode&&(La+=this.vy.wsh(G,ha));this.fRk(G,La);this.azi(G)&&this.v9f(G,La)}else this.VNa.add(G),20<this.VNa.count&&na.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.VNa.count);this.kZ.Z(G.Eh,G);this.eqm(G)}evm(){this.J7n()}Z6n(G){this.g_a=G.length+1;this.VNa=new zb.a;this.wCm(G);this.hCm(this.g_a);this.zBm();this.c7n()}QEm(G){this.lCa.lZo(G);for(const ha of G){if(!ha){na.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<ha.Xy){G=ha.mja.Eh;for(const La of ha.YCf)this.kZ.insert(G,La),G++}else if(0>ha.Xy)for(const La of ha.lLd)this.kZ.remove(La),this.VNa.contains(La)&&this.VNa.remove(La)}this.jdj()}V0n(G){G=G.Eh;this.lCa.W0n(G);this.kZ.removeAt(G);for(const ha of this.VNa)ha.Eh===G&&this.VNa.remove(ha);this.jdj()}fRk(G,ha){ha=this.vy.hBh(G,ha);this.lCa.dBh(G,ha)}v9f(G,ha){G.mV&&G.mV.HardBreak||this.Zxb.v9f(G,ha)}eqm(G){G=G.Eh+1;for(const ha of this.VNa)if(ha&&ha.Eh===G){this.Lyf(ha);
this.VNa.remove(ha);break}}jdj(){for(let G=0;G<this.kZ.count;G++){const ha=this.kZ.J(G);ha&&ha.Ihe(G)}}azi(G){G=this.I8l(G);return 2===G||1===G}zam(G){return this.kZ.J(G.Eh-1)}I8l(G){return G.N4a?2:G.mV&&G.mV.HardBreak?1:0}}Object(e.a)(dl,"PageFullHeightManager",null,[2049]);class qq{constructor(G,ha,La,lb){this.Zxb=G;this.lCa=ha;this.kX=La;this.vy=lb}create(){return new dl(this.lCa,this.Zxb,this.kX,this.vy)}}Object(e.a)(qq,"PageFullHeightManagerFactory",null,[]);var hg=c(1116),Oo=c(604);class An{constructor(G,
ha,La,lb,Vb){this.XZb=null;this.j_=G;this.cO=ha;this.VAc=La;this.Zxb=lb;this.vy=Vb}reset(){this.XZb=new zb.a}VRk(G,ha,La){try{return this.XRk(G,ha,La)}catch(lb){return na.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",lb.message),null}}F8n(){try{this.G8n()}catch(G){na.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",G.message)}}XRk(G,ha,La){if(!this.j_.kZ.count)return null;
const lb=this.N8l(G,!G);if(!lb||lb.G0d)return na.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(lb.mV&&lb.mV.HardBreak)return null;var Vb=this.j_.kZ.J(lb.Eh-1);return this.vy.mBi(Vb)&&(ha-=La,lb.outlineNode!==Vb.outlineNode&&(ha+=this.vy.wsh(lb,Vb)),(Vb=this.VAc.rBh(lb,ha))&&1<Math.abs(Vb.delta))?(Vb.l4i=ha,Vb.outlineGroupNode=this.u8l(G,lb),this.XZb.add(Vb),this.aqg(Vb),Vb):null}u8l(G,ha){return ha&&ha.N4a?(G=Object(Lb.a)(Oo.a,ul.ParagraphReader.XC(ha.outlineNode)),
G=Sl.GraphIterator.eb(G),G.Ip(),Object(Lb.a)(hg.a,G.jd(23))):G&&G.rlb?G.outlineGroupNode:null}G8n(){this.XZb.Sc((G,ha)=>ha.mja.Eh-G.mja.Eh);for(const G of this.XZb)this.Zxb.Vcj(G);this.oZo()}oZo(){this.cO.value.NEm(this.XZb);this.j_.PEm(this.XZb)}N8l(G,ha){return ha?this.j_.kZ.J(this.j_.kZ.count-1):this.j_.kZ.J(G.Eh)}aqg(G){let ha=G.mja.Eh;const La=-G.Xy;for(let lb=0;lb<La;lb++)ha--,G.lLd.add(this.j_.kZ.J(ha))}}Object(e.a)(An,"PageFullHeightPositionUpdater",null,[2050]);class Po{constructor(G,ha,
La,lb,Vb){this.j_=G;this.cO=ha;this.VAc=La;this.Zxb=lb;this.vy=Vb}create(){return new An(this.j_,this.cO,this.VAc,this.Zxb,this.vy)}}Object(e.a)(Po,"PageFullHeightPositionUpdaterFactory",null,[]);class Cr{constructor(G,ha){this.vy=G;this.VAc=ha}v9f(G,ha){try{this.R3n(G,ha)}catch(La){this.vy.UR(La.message+" "+La.stack),na.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",La.message)}}Vcj(G){try{this.Q3n(G)}catch(ha){this.vy.UR(ha.message+" "+ha.stack),na.ULS.sendTraceTag(38855577,
336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ha.message)}}R3n(G,ha){na.ULS.shipAssertTag(38285913,336,G.N4a||G.mV.HardBreak);G=this.VAc.rBh(G,ha);this.Vcj(G)}Q3n(G){this.P3n(G);this.I3n(G)}I3n(G){0<G.Xy?this.ZEm(G):0>G.Xy&&this.yll(G)}P3n(G){this.vy.Iti(G.mja,G.oLj)}ZEm(G){let ha=G.l4i+G.GPa;for(let lb=0;lb<G.Xy;lb++){var La=G.mja.Eh+lb;const Vb=G.mja.nda?this.vy.Dfi(G.mja):G.mja.outlineNode;La=this.v$k(Vb,G.outlineGroupNode,ha,La);G.YCf.add(La);G.Bhn.add(ha);ha+=G.GPa}}yll(G){for(const ha of G.lLd)this.vy.xll(ha)}v$k(G,
ha,La,lb){ha=this.vy.w$k(G,La,ha);return Um.ebf(La,lb,ha,G,!1,!1)}}Object(e.a)(Cr,"PageFullHeightRenderer",null,[]);class Ka{constructor(G){this.V5f=G}}Object(e.a)(Ka,"PageHeightDeltaResult",null,[2048]);class Fb{constructor(G,ha,La){this.Mp=null;this.vy=G;this.ti=ha;La.execute(lb=>{lb.register(this)})}get U0c(){return"PageHeightDelta"}get result(){return this.Mp}get oUf(){return 1}get Hbg(){return 500}get isEnabled(){return!0}xUf(){this.Mp=null}HDa(G){this.ti.ie(()=>{try{this.fIc(G)}catch(ha){na.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ha.message)}},"PHDM:C")}fIc(G){this.Mp=null;G=this.gIc(G);-1!==G&&(this.Mp=new Ka(G))}gIc(G){if(!G.count)return-1;let ha=0,La=0;for(const lb of G)G=this.YRk(lb),-1!==G&&(ha+=G,La++);return La?ha/La:-1}YRk(G){if(!G.bNm)return-1;const ha=this.vy.hei(G.LEd,G.Eh);return-1===ha?-1:Math.abs(G.height-ha)}}Object(e.a)(Fb,"PageHeightDeltaMetric",null,[2041]);class jc{constructor(G){this.CXa=null;this.vy=G}DQc(G){return this.CXa.J(G-
1)}j7n(G){this.CXa=new zb.a;for(let ha=0;ha<G;ha++)this.CXa.add(-1)}dBh(G,ha){if(this.uSm(G))return this.CXa.J(G.Eh-1);ha=this.xRk(G,ha);this.fFo(G,ha);return ha}lZo(G){for(const ha of G)this.kZo(ha)}fFo(G,ha){this.CXa.Z(G.Eh-1,ha)}W0n(G){this.CXa.removeAt(G-1)}kZo(G){if(G)if(0<G.Xy){var ha=G.mja.Eh;for(var La=0;La<G.Xy;La++)this.CXa.insert(ha,G.GPa)}else if(0>G.Xy)for(ha=-G.Xy,G=G.mja.Eh-ha,La=0;La<ha;La++)this.CXa.removeAt(G)}uSm(G){return-1!==this.CXa.J(G.Eh-1)}xRk(G,ha){if(G.N4a||G.mV.HardBreak)G=
this.vy.o9h(G),ha=ha<G?G:ha;return ha}}Object(e.a)(jc,"PageHeightStorage",null,[]);var Qc=c(111);class rd{constructor(G){this.V5f=G}}Object(e.a)(rd,"PageLevelDeltaResult",null,[2048]);class Yd{constructor(G,ha,La,lb){this.Mp=null;this.iM=G;this.nua=ha;this.ti=La;lb.execute(Vb=>{Vb.register(this)})}get Ek(){const G=this.iM.value;na.ULS.shipAssertTag(39081438,336,G.$i,"PageLevelDeltaMetric.PageView is not a PageView.");return G}get U0c(){return"PageLevelDelta"}get result(){return this.Mp}get oUf(){return 0}get Hbg(){return 60}get isEnabled(){return!0}xUf(){this.Mp=
null}HDa(G){this.ti.ie(()=>{try{this.fIc(G)}catch(ha){na.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ha.message)}},"PLDM:C")}fIc(G){this.Mp=null;G=this.gIc(G);-1!==G&&(this.Mp=new rd(G))}gIc(G){if(!G.count)return-1;let ha=0,La=0;for(const lb of G)G=this.$Rk(lb),-1!==G&&(ha+=G,La++);return La?ha/La:-1}$Rk(G){if(G.rlb)return-1;var ha=G.mV.CP;G=G.paragraphNode;na.ULS.shipAssertTag(39081441,336,!!G);G=G.qe(this.Ek.$b);na.ULS.shipAssertTag(39081442,
324,Object(Qc.a)(94,G));let La;({jLh:ha,lHi:G,igj:La}=this.NRk(G,Xi.a.Jy(G.htmlElement).length,ha));return G&&La?Math.min(ha.x-G.x,La.x-ha.x):(na.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}NRk(G,ha,La){let lb,Vb,tc,Nc=Vb=La,hd=tc=lb=null;if(La>ha)return na.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{jLh:hd,k1m:Nc,lHi:tc,h$n:Vb,igj:lb};
hd=this.nua.Vq(G,La);for(var fd=0,sd=La;fd<=sd;){const Kd=Math.floor((fd+sd)/2),Nd=this.nua.Vq(G,Kd);if(fd===sd){Nc=Kd;tc=Nd;break}Nd.y+Nd.height<=hd.y?fd=Kd+1:sd=Kd}for(;La<=ha;){fd=Math.ceil((La+ha)/2);sd=this.nua.Vq(G,fd);if(La===ha){Vb=fd;lb=sd;break}sd.y>=hd.y+hd.height?ha=fd-1:La=fd}return{jLh:hd,k1m:Nc,lHi:tc,h$n:Vb,igj:lb}}}Object(e.a)(Yd,"PageLevelDeltaMetric",null,[2041]);class Ue{constructor(G,ha,La,lb,Vb,tc,Nc){this.Eh=G;this.top=ha;this.jnh=La;this.height=lb;this.rSb=Vb;this.LEd=tc;this.bNm=
Nc}}Object(e.a)(Ue,"Page",null,[]);class ze{constructor(G,ha,La,lb,Vb){this.RZb=null;this.Oih=0;this.iM=G;this.Hkd=ha;this.wah=La;this.XMa=lb;this.yah=Vb;this.RYa=new zb.a}get Ek(){const G=this.iM.value;na.ULS.shipAssertTag(37007393,336,G.$i,"PageManager.PageView is not a PageView.");return G}get gl(){return this.RYa}xHj(G){G=this.p8i(G);this.yHj(G)}hZo(G,ha){this.Oih=ha;G=this.p8i(G);this.yHj(G);this.yah.isEnabled&&this.yah.HDa(G)}p8i(G){this.RYa=new zb.a;this.RZb=new ri.a(0);const ha=new zb.a;if(!G)return this.gl;
var La=0,lb=null;for(let Vb=0;Vb<G.count;Vb++){const tc=G.J(Vb);La=tc.Eh;lb=this.OJd(La,lb,tc);this.gl.add(lb);!ze.LLe&&0>lb.height&&ha.add(lb);lb=tc}G=this.OJd(La+1,lb,null);this.gl.add(G);!ze.LLe&&0>G.height&&ha.add(G);for(const Vb of ha)ze.LLe=!0,na.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+Vb.Eh);return this.gl}OJd(G,ha,La){const lb=ha?ha.outlineNode:this.XMa.x$h(),Vb=La?La.outlineNode:this.XMa.Tbi();var tc=this.iei(lb);const Nc=this.iei(Vb),hd=ha?
this.oBh(ha):0;tc=hd+tc;const fd=La?this.oBh(La):this.Hkd.A6a.clientHeight-Nc;return new Ue(G,hd,tc,lb.id===Vb.id?fd-hd:fd+Nc-tc,lb,Vb,(La?La.Eh:this.Oih+1)===(ha?ha.Eh:0)+1)}oBh(G){return G.nda?0:G.top}yHj(G){if(this.wah.c$d)for(const ha of this.wah.c$d)ha&&ha.zHj(G)}iei(G){this.RZb||(this.RZb=new ri.a(0));if(this.RZb.nb(G.id))return this.RZb.J(G.id);var ha=G.qe(this.Ek.$b);if(!ha)return na.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;ha=wa.a.g3a(this.Hkd.A6a,
ha.htmlElement).y;this.RZb.Z(G.id,ha);return ha}}ze.LLe=!1;Object(e.a)(ze,"PageManager",null,[2044]);var Bf=c(629);class Fg{constructor(G,ha,La,lb,Vb,tc,Nc,hd){this.guj=hd;this.trg=this.B6a=!1;this.Bln=(fd,sd)=>{0!==sd.rnb||this.trg?this.uTh():this.XWh()};this.ga=G;this.ega=ha;this.$Vb=La;this.xt=lb;this.Yi=Vb;this.Aah=tc;this.WI=Nc;hd||(this.B6a=0===this.WI.ou,this.WI.u0e(this.Bln))}Ub(){this.ga.fb(vg.a.T5c,Ni.a.application,this.T5c.bind(this),96);this.ga.fb(vg.a.wce,Ni.a.application,this.wce.bind(this),
96);this.ga.fb(vg.a.Nme,Ni.a.application,this.Nme.bind(this),96);this.ga.fb(vg.a.Kme,Ni.a.application,this.Kme.bind(this),8)}Nme(G,ha,La){return 1===La?32:this.ga.processAction(vg.a.$8a,2)}Kme(G,ha,La,lb){if(1===La)return this.guj?8:0===this.WI.ou?32:8;this.B6a?(this.uTh(),this.trg=!0):(this.XWh(),this.trg=!1);this.Yi.updateCommandUI();lb.Hs=this.B6a?1:0;return 32}T5c(G,ha,La,lb,Vb){if(1===La)return 32;G=this.Aah.rHb();-1===G?G="":this.B6a||1===this.WI.ou?(ha=this.Aah.bVl(),ha>G&&(G=ha),G=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
ha,G)):G=1===G?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,G):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,G);Vb[Bf.a.Visible]=!0;Vb[Bf.a.LabelText]=G;return 32}wce(G,ha,La,lb,Vb){if(1===La)return 32;Vb[lk.a.On]=this.B6a;return 32}XWh(){this.B6a||this.guj||(this.$Vb.Mvl(),this.xt.mtj(),this.B6a=!0)}uTh(){this.B6a&&(this.$Vb.bpl(),this.xt.hpi(),this.B6a=!1)}}Object(e.a)(Fg,"PaginationActor",null,[]);class pi{constructor(G){this.V5f=G}}Object(e.a)(pi,"PaginationDeltaResult",
null,[2048]);class Og{constructor(G,ha){this.yyb=this.Mld=null;this.ti=G;ha.execute(La=>{La.register(this)})}get U0c(){return"PaginationDelta"}get result(){return this.Mld}get oUf(){return 1}get Hbg(){return 200}get isEnabled(){return!0}xUf(){this.Mld=null}HDa(G){this.ti.ie(()=>{try{this.fIc(G)}catch(ha){na.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",ha.message)}},"PDM:C")}Wjg(G){this.yyb=G}fIc(G){this.Mld=null;G=this.gIc(this.yyb,G);-1!==
G&&(this.Mld=new pi(G))}gIc(G,ha){if(!(G&&ha&&G.count&&ha.count))return-1;const La=new zb.a;for(const lb of G)La.add(lb.top);G=new zb.a;for(const lb of ha)G.add(lb.top);ha=this.aPd(La,G);return this.s5b(ha)}s5b(G){if(!G.count)return 0;let ha=0;for(let La=0;La<G.count;La++)ha+=G.J(La);return ha/G.count}aPd(G,ha){const La=new zb.a;if(!G.count||!ha.count)return La;var lb=G.count<=ha.count;const Vb=lb?G:ha;G=lb?ha:G;for(ha=0;ha<Vb.count;ha++){lb=Vb.J(ha);let Nc=Math.abs(lb-G.J(0)),hd=0;for(let fd=1;fd<
G.count;fd++){var tc=G.J(fd);tc=Math.abs(lb-tc);tc<Nc&&(Nc=tc,hd=fd)}La.add(Nc);G.removeAt(hd)}return La}}Object(e.a)(Og,"PaginationDeltaMetric",null,[2041]);var Mj=c(463),ck=c(1423),$m=c(2070);class Aj extends Mj.a{constructor(G,ha,La,lb,Vb,tc,Nc,hd=null){super();this.$N=null;this.Ixe=0;this.g_a=-1;this.Hvb=!1;this.VY=()=>{na.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.wTh()};this.dXf=()=>{if(0==this.qT.ou){var fd=this.$N.Su;ei.a.Cq(fd,this.aZb)||
(this.aZb=fd,this.Vqn(this.qYa,this.aZb))}};this.qT=G;this.Gda=this.Gda.bind(this);this.qT.fBb(this.Gda);this.ga=ha;this.xt=La;this.RZ=lb;this.qma=Vb;this.LJe=hd||mk.a.instance;this.aZb=this.qYa=ei.a.nil;this.X$j=Nc;tc.CWR(()=>tc.result.nC.gOa(this.VY));this.b7b();this.yk=new ck.a(1E3);this.yk.m1a();this.qma.register(this)}get Yia(){return"Pagination"}get Xgf(){return this.X$j.value}get HJa(){return this.g_a}Aqo(G){this.g_a!==G&&(this.g_a=G,this.RZ.lqg())}Gda(){this.qYa=this.aZb=ei.a.nil;this.b7b()}$Sa(G){this.$N=
G;this.$N.lGc(this.dXf);this.A2b(this.$N.node)}Vqn(G,ha){ei.a.Cq(G,ha)?(this.xt.h0c(),this.b7b()):(this.xt.i0c(),this.RDo())}Uvl(){this.enabled=2}b7b(){this.enabled=0}RDo(){this.Ixe=0;this.Uvl();this.kF(null,null,null)}SFa(){return hb.App.lostSession||hb.App.zd.nC.Io?!1:!!(this.enabled&2)&&this.yk.w0()}kF(){this.yk.SPa();this.qma.AV()}forceOutbound(){}Jca(){return 0===this.enabled?!1:this.he&&this.he.status===sc.a.responseReady?!0:this.SFa()}bUa(){if(1===this._state)this.he.Iq=$m.a.Uba(l.AFrameworkApplication.rootQuerySignature,
this.qYa),this.he.aH="Pagination",this.he.status=sc.a.requestReady,this._state=3;else if(3===this._state&&this.he&&this.he.status===sc.a.responseReady)if(l.AFrameworkApplication.Qk)this._state=4;else if(this.yk.i2(),this.yk.n9(),this._state=1,this.Ixe++,2!==this.he.statusCode)this.c7b();else if(1!==(this.he.Mj?this.he.Mj.length:0))this.c7b();else{var G=this.he.Mj[0];this.LJe.PVa(G);104===G.StatusCode?this.wTh():101===G.StatusCode?this.c7b():3===G.StatusCode?this.c7b():G.StatusCode?this.c7b():G.PageEnds?
(this.Aqo(G.PageEnds.length+1),this.qYa=yc.b(G.LastKnownPaginationRevision),na.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.g_a,this.qYa),this.xt.Xoc(G.PageEnds,ei.a.Cq(this.qYa,this.aZb)),this.Xgf.oja=G.PageEnds,this.RZ.z6e(),na.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",
this.g_a,this.qYa),this.kpl()):this.c7b()}}wTh(){this.$N&&this.$N.Fjc(this.dXf);this.b7b()}c7b(){60<this.Ixe&&this.b7b()}kpl(){ei.a.Cq(this.qYa,this.aZb)&&this.b7b()}dispose(){this.$N&&(this.$N.Fjc(this.dXf),this.$N.node&&this.W6c(this.$N.node),this.$N=null);this.qT.a9f(this.Gda)}A2b(G){G&&(G.addListener(this),this.Hvb=!0)}W6c(G){this.Hvb&&G&&(G.removeListener(this),this.Hvb=!1)}Qnb(G){this.W6c(G)}wya(){}VSa(G){(G=G.xd.zm)&&this.Hnn(this.qYa,G.id)}Hnn(G,ha){ei.a.Cq(G,ha)&&this.xt.h0c()}}Object(e.a)(Aj,
"PaginationReplicator",Mj.a,[2045,10,125]);class un{get B0d(){return!0}Xoc(){}i0c(){}h0c(){}mtj(){}hpi(){}dispose(){}T6f(){}w6c(){}}Object(e.a)(un,"PageEndMarkersNoOp",null,[2042,2043,10]);class Ip{dispose(){}$Sa(){}get HJa(){return-1}}Object(e.a)(Ip,"PaginationReplicatorNoOp",null,[2045,10]);class Ma{constructor(){this.Waa=this.xt=this.RZ=this.$Vb=this.zH=null;this.xta=!1;this.PDk=()=>{this.yth()}}get name(){return"WordEditor.Pagination"}wc(G){this.W=G;this.rd=this.W.resolve("Box4.IFeatureHelper");
this.W.ia("WordEditor.Pagination.PageElementManagerList",()=>new Ae(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.OutlineManager",()=>new pb(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",()=>new ze(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").ha();this.W.ia("WordEditor.IPaginationReplicator",()=>this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Xje?new Ip:new Aj(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),
ke.App.W1,hb.App.Xoa(),new Pb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).ha();this.W.ia("WordEditor.ICurrentPageManager",()=>new Mo(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Yd(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),this.W.resolve("Box4.ITextMetricsAdapter"),Jc.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightDeltaMetric",
()=>new Fb(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Jc.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new Og(Jc.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightStorage",()=>new jc(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightDOMHelper",
()=>new ds(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new si(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightRenderer",()=>new Cr(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).ha();
this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Po(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ve("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).ha();
this.W.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new xg(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),hb.App.li.Al)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").ha();this.W.ia("WordEditor.Pagination.PageFullHeightManagerFactory",
()=>new qq(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Xl.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new gh(this.W.resolve("Common.IZoomManager"),Jc.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").ha();
this.W.ia("WordEditor.Pagination.PaginationActor",()=>new Fg(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"),this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Xje)).ha();this.W.ia("WordEditor.Pagination.DocumentSizeManager",()=>
new Jk(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),Hp.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).ha();this.W.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new Eq(l.AFrameworkApplication.va,hj.a.instance,Bg.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),this.W.Oa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").ha();this.W.ia("WordEditor.Pagination.IPageEndMarkers",
()=>{this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Xje?this.xt=new un:this.xt=new Vm(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.Zc.xd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),Tm.a.GRc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),Bg.a.instance,Vm.I_l,this.W.resolve("Box4.ContentEditableViewEventSource"),new rr.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"));
return this.xt}).as("Box4.IPaginationRefreshHelper").ha();this.W.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new tf(this.W.Sa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!hb.App.instance&&hb.App.instance.cD)).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new ec(l.AFrameworkApplication.lc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>
new Hc(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentManager",()=>this.Waa=new Fd(new Pb.a(()=>Ld.StaticActiveAppFrame.za().jb.rc),yj.a.instance,Sm.a.instance,ne.a.instance,l.AFrameworkApplication.va,Hl.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
Bg.a.instance,l.AFrameworkApplication.K,!!hb.App.instance&&hb.App.instance.cD,!!hb.App.instance&&hb.App.instance.Jpa)).as("WordEditor.Pagination.IPageAdornmentManager").ha()}init(){this.rd.pq.continueWith(()=>{this.xn()})}xn(){const G=Ld.StaticActiveAppFrame.za().jb;G.Cxa?this.yth():G.vga(this.PDk)}yth(){this.xta||(this.xta=!0,this.$Vb=ia.a.instance.resolve("WordEditor.ICurrentPageManager"),this.RZ=ia.a.instance.resolve("Common.ICurrentPageCalculator"),this.zH=ia.a.instance.resolve("WordEditor.IPaginationReplicator"),
ia.a.instance.resolve("WordEditor.Pagination.PaginationActor").Ub())}dispose(){this.Waa&&(this.Waa.dispose(),this.Waa=null);this.xt&&(this.xt.dispose(),this.xt=null);this.zH&&(this.zH.dispose(),this.zH=null);this.RZ&&(this.RZ.disable(),this.RZ=null);this.$Vb&&(this.$Vb=null)}}Object(e.a)(Ma,"PackageManager",null,[1,2]);class Za{constructor(){this.W=null}wc(G){this.W=G||ia.a.instance}dispose(){}}Object(e.a)(Za,"TellMePackage",null,[1,2]);var yb=c(1522),qc=c(1524),Tc=c(349),dd=c(1521),Dd=c(1409);class ce{constructor(G=
null,ha=null,La=null,lb,Vb=null){this.nte=null;this.BLg=!1;this.WVg=this.PUb=null;this.tkk=this.Mgh=this.JWj=this.XVg=!1;this.ojd=null;this.XWj=null==ha?l.AFrameworkApplication.wBb:ha;this.I7j=null==La?l.AFrameworkApplication.E0:La;this.blk=null==Vb?l.AFrameworkApplication.A8a:Vb;this.i6j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.Nmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.yqo(!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.Emk=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.NYc;this.Fmk=!dd.a.Cpa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.Dmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.i3j=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.$Qb;this.Gmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");
this.Zjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.mek=this.M$c||this.L$c;this.kek=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.lek=this.PGf;this.W9j=!!l.AFrameworkApplication.K&&this.tVa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.G4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):
1400;this.l5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.u4j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.T9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.x9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.r$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.f8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.KYm||this.nSm);this.w0b=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",
!1);this.Klk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.o5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.$jk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.Nkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.pkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.XP;this.g$j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.t9j=
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.M9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.d$j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.t$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.KWj=this.tVa&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.P5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Tkk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==l.AFrameworkApplication.K.kb("Application"));this.mYj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Fok=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.i8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.m8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.k5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.f$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.PWm;this.k8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.l8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.j8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.p2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.q2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.o2j=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.AKh&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.Hmk=this.cEi&&(this.NZf||this.OZf||this.Y2c||this.tVa&&dd.a.Npa()&&!!l.AFrameworkApplication.K&&(this.Xlc||this.dRb||this.eRb||this.fRb||this.gRb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.IVj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.oOa;this.JVj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.jBm(G||{});this.eSe="2918242107";this.dSe="1454393937";this.iyb={};this.xeb=[];this.j7k=[dd.a.Dne]}get application(){return this.PUb}get wBb(){return this.XWj}get Hco(){return this.eSe}get Gco(){return this.dSe}get olf(){return this.WVg}get w0h(){return this.XVg}get E0(){return this.I7j}get A8a(){return this.blk}get rBb(){return this.JWj}get Kum(){return this.i6j}get QJo(){return this.Nmk}get cEi(){return!0}get HJo(){return this.Hmk}get Cto(){return this.Mgh}yqo(G){this.Mgh=
G}get tVa(){return this.Emk}get Vbd(){return this.Fmk}get Tbd(){return this.Dmk}get JCl(){return this.i3j}get FJo(){return this.Gmk}get jne(){return!1}get Y2c(){return this.mek}get NZf(){return this.kek}get OZf(){return this.lek}get f5a(){return!1}get x1d(){return!1}get BIf(){return this.W9j}get Xie(){return this.tkk}get Xlc(){return!1}get dvo(){return!1}get j1m(){return""}get Psf(){return 2}get tbm(){return 4}get ubm(){return 5}get uhi(){return""}get eYl(){return this.G4j}get Khi(){return this.l5j}get whi(){return 1E3}get vhi(){return 1E-6}get bGo(){return this.Klk}get vkg(){return!1}get uxj(){return!1}get AUm(){return this.M9j}get f1d(){return!1}get g1d(){return!1}get BAi(){return!1}get AAi(){return!1}get PWm(){return!1}get dEi(){return!1}get POd(){return!1}get Aqb(){return!1}get dRb(){return!1}get eRb(){return!1}get fRb(){return!1}get gRb(){return!1}get M$c(){return this.Zjk}get Slc(){return this.$jk}get L$c(){return!1}get Xpf(){return null}get $0d(){return!1}get Pie(){return this.pkk}get Hdi(){return 0}get XRl(){return this.u4j}get rii(){return this.o5j}get IVm(){return this.T9j}get HDf(){return this.f8j}get Oie(){return this.w0b}get c6l(){return-3.9}get XP(){return this.Nkk}get OYc(){return this.g$j}get bHf(){return this.t9j}get VIf(){return this.d$j}get rfb(){return this.KWj}get SYm(){return this.t$j}get exa(){return this.P5j}get uuj(){return this.Tkk}get OMk(){return this.mYj}get ipe(){return this.Fok}get jZd(){return this.i8j}get nIm(){return this.m8j}get kv(){return this.k5j}get amb(){return this.f$j}get lIm(){return this.k8j}get mIm(){return this.l8j}get kIm(){return this.j8j}get vAk(){return this.IVj}get wAk(){return this.JVj}get mha(){return this.p2j}get TMd(){return this.q2j}get P7b(){return this.o2j}get KYm(){return this.r$j}get nSm(){return this.x9j}get $Jb(){return!!l.AFrameworkApplication.ta&&
l.AFrameworkApplication.ta.Kb.Gr}get Gr(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.Gr}get hRm(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.Vlc}get Yhn(){return Se.getImageClass("OfficeAssistant_32x32x32")}cSd(){return Promise.reject("GetFindMatchCount method is not overridden")}P1d(G){return Array.contains(appChrome.selectors.getVisibleControlIds(),G)}VZd(){return!1}get l0d(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get jzj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get PGf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get YHb(){return"NoOpHeaderUi"}get c7k(){return this.ojd}get parameterData(){return this.iyb}get bRo(){return this.xeb}qyl(){if(this.nte&&!this.BLg&&(this.BLg=!0,this.sqb(this.nte),this.Gr)){var G=ia.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");G=(new Dd.a(G)).tQd(this.nte.iH);appChrome.api.dispatch(G)}}get Sbg(){return""}sqb(){}Qnl(G){const ha=
[];for(let La=0;La<G.length;++La)G[La].Xvo?ha.push(new Tc.a(G[La].Rm,dd.a.yDj+La.toString())):ha.push(new Tc.a(G[La].standard,dd.a.Dne+La.toString()));return ha}jBm(G){const ha={};for(let La in G){const lb=La,Vb=G[La];for(let tc in Vb){const Nc=tc,hd=Vb[tc];(ha[Nc]||(ha[Nc]={}))[lb]=hd}}this.ojd=ha}get kzj(){return""}get htj(){return!1}}Object(e.a)(ce,"TellMeApplicationData",null,[1280]);class He{constructor(G,ha=null,La=!1){this.standard=G;this.Rm=ha;this.Xvo=La}}Object(e.a)(He,"TryQuerySet",null,
[]);class xf{constructor(){this.Z7g=this.$7g=null}get tfn(){return this.Z7g}aha(G){this.$7g=G;return this.Ybf(G)}ijn(){this.Z7g=this.$7g}RSd(G){return 8===G.type?String.format(CommonUIStrings.l_FindInDocumentText,G.gD):G.gD}ypf(G){return G.gD}}Object(e.a)(xf,"ParameterizedCommand",null,[]);class ai extends xf{constructor(G){super();this.yYc=G}get commandId(){return this.yYc?"DefinitionsParameterized":"DefinitionButton"}get l0f(){return"Definition"}Ybf(G){const ha=rb.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
G.gD));return ch.a(dd.a.Ncf(G.value),n.a.yef.toString(),ha,dd.a.$Cf,null,rb.a.zf(dd.a.ADb(G.gD)),ha,null,null)}RSd(G){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,G.gD)}ypf(G){return dd.a.ADb(G.gD)}}Object(e.a)(ai,"DefinitionsParameterizedCommand",xf,[]);class Bi extends xf{constructor(G){super();this.yYc=G}get commandId(){return this.yYc?l.AFrameworkApplication.ta.Kb.rNm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get l0f(){return"Find"}Ybf(G){const ha=
rb.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,G.gD));return ch.a(dd.a.Ncf(G.value),n.a.findInDocument.toString(),ha,"Find_16x16x32",null,rb.a.zf(G.gD),ha,null,null)}RSd(G){return String.format(CommonUIStrings.l_TextWithQuotation,G.gD)}}Object(e.a)(Bi,"FindParameterizedCommand",xf,[]);class wg extends xf{constructor(G){super();this.yYc=G}get commandId(){return this.yYc?"SynonymsParameterized":"SynonymButton"}get l0f(){return"Synonym"}Ybf(G){const ha=rb.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
G.gD));return ch.a(dd.a.Ncf(G.value),n.a.yef.toString(),ha,dd.a.$Cf,null,rb.a.zf(dd.a.ADb(G.gD)),ha,null,null)}RSd(G){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,G.gD)}ypf(G){return dd.a.ADb(G.gD)}}Object(e.a)(wg,"SynonymsParameterizedCommand",xf,[]);var Qi=c(2078),hk=c(1988),sj=c(2113),mf=c(2074),Ve=c(2075),ef=c(1609);class og extends Qi.a{constructor(){super(...arguments);this.gO=null;this.d_a=hk.FindManager.createInstance(this,sj.a.instance,ef.a.instance,
!0,!0)}static get instance(){return og._instance}F8b(){this.gO(this.d_a.Sj.Aka);this.d_a.p0a(!0)}cSd(G){const ha=new Promise((La,lb)=>{this.gO=La;setTimeout(()=>{lb("Find manager execution timed out");this.d_a.p0a(!0)},500)});G=mf.a.createQuery(G,Ve.a.none);this.d_a.find(G);return ha}}og._instance=new og;Object(e.a)(og,"TellMeFindStatusSpy",Qi.a,[]);class Ig extends ce{constructor(G){super({});this.PUb="Word";this.T4j=G;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.XVg=!0,this.WVg=
this.POd?"FindWithMatchesParameterized":"FindParameterized");G=new ai(this.$Jb);const ha=new wg(this.$Jb);this.parameterData[G.commandId]=G;this.parameterData[ha.commandId]=ha;G=new Bi(this.$Jb);this.parameterData[G.commandId]=G;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(G=[new He(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new He(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new He(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new He(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new He(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.xeb=this.Qnl(G))}cSd(G){return og.instance.cSd(G)}get G7a(){return pq.AppFrame.jra}get YHb(){return pq.AppFrame.RQa}get Sbg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}sqb(G){var ha=l.AFrameworkApplication.K;G=G.iH;G.WordCountFlyout=!this.T4j();G.SelectAllButton=!ha.$("TellMeSelectAllResultIsEnabled");const La=ha.$("TellMeDesktopUpSellIsEnabled");let lb=l.AFrameworkApplication.y1d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!lb));lb=!1;G.TextBoxUpSellButton=!La||lb;G.TableOfContentsUpSellButton=!La||lb;G.SmartArtUpSellButton=!La||lb;G.WordArtUpSellButton=!La||lb;G.MultiColumnLayoutUpSellButton=!La||lb;G.InsertEquationUpSellButton=!La||lb;G.TrackChangesUpSellButton=!La||lb;G.ShapesUpSellButton=!La||lb;G.LabelsUpSellButton=!La||lb;G.InsertCitationUpSellButton=!La||lb;G.TextBoxUpSellButtonEnterprise=!La||!lb;G.TableOfContentsUpSellButtonEnterprise=
!La||!lb;G.SmartArtUpSellButtonEnterprise=!La||!lb;G.WordArtUpSellButtonEnterprise=!La||!lb;G.MultiColumnLayoutUpSellButtonEnterprise=!La||!lb;G.InsertEquationUpSellButtonEnterprise=!La||!lb;G.TrackChangesUpSellButtonEnterprise=!La||!lb;G.ShapesUpSellButtonEnterprise=!La||!lb;G.LabelsUpSellButtonEnterprise=!La||!lb;G.InsertCitationUpSellButtonEnterprise=!La||!lb;ha=!ha.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.E0;G.SynonymButton=ha;G.DefinitionButton=ha}get kzj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get vkg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get jzj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Xlc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get PGf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get Psf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get htj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get x1d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get l0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get f1d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get g1d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get whi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get vhi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get BAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get AAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get uhi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get dEi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get Hdi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get cEi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get jne(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get f5a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Xie(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get uxj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get $0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get dRb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get eRb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get fRb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get gRb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Xpf(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(Ig,"WordEditorTellMeApplicationData",ce,[]);var Uk=c(1559),di;(function(G){G[G.none=0]="none";G[G.waitAll=1]="waitAll";G[G.synchronizeFast=2]="synchronizeFast";G[G.synchronizeSlow=3]="synchronizeSlow"})(di||(di={}));Object(e.b)("ProviderSynchronizationType",di);var zk;(function(G){G[G.immediate=0]="immediate";G[G.waitAll=1]="waitAll";G[G.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";G[G.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(zk||
(zk={}));Object(e.b)("MenuUpdatePolicy",zk);var yl=c(1528),$k=c(1526),Vp=c(1664),Mt=c(1529),Xo=c(1553),Ys=c(114),es=c(294);class Zs extends Qi.a{constructor(G){super();this.Epk=G}F8b(){this.Epk.update()}}Object(e.a)(Zs,"TellMeFindStatusManager",Qi.a,[]);class tr{constructor(G){this.peb=this.cOg=null;this.ki=0;this.Kod="TellMeWAC.";const ha=G.olf;this.fc=G;this.Wld=ha;this.CJe=Object.assign(new Uk.a,{landingTab:"Indoc",data:null});G=new Zs(this);this.d_a=hk.FindManager.createInstance(G,sj.a.instance,
ef.a.instance,!0,!0)}qL(){return"WordFindInDocument"}CU(){return this.fc.Psf?this.fc.Psf===zk.waitAll?di.waitAll:di.synchronizeSlow:di.none}eI(G,ha){this.dYm(G)?(this.peb=G,this.cOg=ha,G=mf.a.createQuery(G.Fg,Ve.a.none),this.ki=window.performance.now(),this.d_a.find(G)):ha.resultsUpdated(new yl.a(G))}update(){this.Ffo(Math.round(window.performance.now()-this.ki));var G=String.format(CommonUIStrings.l_TextWithQuotation,this.peb.Fg);var ha=l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.Aqb?
dd.a.ePa(this.peb.Fg,15,this.CJe):rb.a.zf(this.peb.Fg);const La=[];La.push(appChrome.actions.setControlLabel(this.Wld,G));La.push(appChrome.actions.setCompoundButtonCommandValueId(this.Wld,ha));La.push(appChrome.actions.updateCompoundButtonDescription(this.Wld,this.nwf()));appChrome.api.dispatch(La);G=new $k.a(this.Wld,Vp.a.FindInDocument,this.peb.Fg,this.d_a.Sj.Aka.toString());ha=new Mt.a(Xo.a.FindInDocument);ha.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ha.Ww(G);const lb=new yl.a(this.peb);
lb.gv(ha);window.requestAnimationFrame(()=>{this.cOg.resultsUpdated(lb)});this.d_a.p0a(!0);this.Gfo(Math.round(window.performance.now()-this.ki))}nwf(){const G=this.d_a.Sj.Aka.toString();return"1"===G?String.format(CommonUIStrings.l_SearchResultText,G):String.format(CommonUIStrings.l_SearchResultsText,G)}dYm(G){return!!G&&!!G.Fg&&""!==G.Fg.trim()}Ffo(G){const ha={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.peb.Fg.length};this.sendActivityEvent(ha,G)}Gfo(G){const ha={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.peb.Fg.length};this.sendActivityEvent(ha,G)}sendActivityEvent(G,ha){G=Ys.a.RH(G);wc.a.PIa(Object.assign(new es.a,{name:"Latency",dataFields:G,durationMs:ha}),this.Kod)}}Object(e.a)(tr,"WordFindInDocumentWithMatchesProvider",null,[1307]);class Av{constructor(G,ha){this.oc=G;this.IYd=
ha}b4a(G,ha,La){return this.IYd.b4a(0,G,ha,La)}insertHtmlText(G){return G?32===this.ACf(G):!1}ACf(G){return this.executeCommand(qe.a.dna,G)}executeCommand(G,ha){const La=new Ql.DictionaryPropertySet;La.setValue(cm.a.LP,ha);La.setValue(cm.a.Yja,!1);ha=this.oc.processAction(G,1);32===ha&&(ha=this.oc.Qb(G,2,La));return ha}}Object(e.a)(Av,"WordInsertContentHandler",null,[2031]);class Nt extends Za{constructor(){super();this.$x=()=>{if(l.AFrameworkApplication.amg){var G=Ld.StaticActiveAppFrame.za().Kb.avf(n.a.tellMe);
G.CWc?this.X2i():G.F_(this.mco);var ha=new Ig(()=>!1);yb.TellMeActor.instance.initialize(ha,null,null,null,null,null,Object(a.a)(Ld.StaticActiveAppFrame.za(),Ld.StaticActiveAppFrame.za().WPd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"));yb.TellMeActor.instance.iVn(G);yb.TellMeActor.instance.kXn(new Av(l.AFrameworkApplication.va,
this.W.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));ha.w0h&&ha.POd&&yb.TellMeActor.instance.WE(new tr(ha),qc.a.tellMe)}};this.mco=()=>{this.X2i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Nn(this.$x)}X2i(){Ld.StaticActiveAppFrame.za().updateCommandUI()}}Object(e.a)(Nt,"WordEditorTellMePackage",Za,[]);class Fq{constructor(){this.W=null;this.mzj=(G,ha,La)=>{2===La&&(G=new Dh.StandardDialog,G.Cd=0,G.lka(WordEditorIntl.WordEditorStrings.L_WordTestFeature,
WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}dispose(){}xn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(127)){l.AFrameworkApplication.va.fb(vg.a.qMj,Ni.a.view,this.mzj,96);var G=Kl.FocusManager.instance().fe(pq.AppFrame.VD);mg.AFrame.Ci(G,Oe.KeyInputManager.ic(kk.a.j$a,5|Oe.KeyInputManager.Rh),vg.a.qMj)}}wc(G){this.W=G}static main(){M.a.instance.Gc(new Fq)}}
Object(e.a)(Fq,"WordEditorTestFeaturePackage",null,[1,2]);var dx=c(107);class Dr{constructor(G,ha){this.Qgj=G;this.oc=ha;this.sge=(La,lb,Vb,tc,Nc)=>{if(1===Vb)return 32;this.Qgj.qN(9,Nc,!1);return 32};this.l1=(La,lb)=>{if(9===lb.type){var Vb;(La=lb.OL)?("string"===typeof La?Vb=La:"data"===La.type&&(Vb=dx.a.iOh(La.THn,La.newState,La.Bqo)),Vb&&Dr.fGc(Vb)):na.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.z6c()}z6c(){this.oc.qa(vg.a.sge,y.a.frame,this.sge);
this.Qgj.V3(this.l1)}dispose(){}static fGc(G){G=Ld.StaticActiveAppFrame.za().notificationBar.Eva(G,!1);G.image=5;G.hpa="CoAuth_AuthorStatus_16x16x32";Ld.StaticActiveAppFrame.za().notificationBar.sA(G)}}Object(e.a)(Dr,"TrackChangeNotificationActor",null,[]);class Wq{constructor(){this.lj=this.RWe=this.W=null;this.R2c=()=>{if(this.lj=hb.App.GVd().result)this.W.ia("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Dr(this.lj,l.AFrameworkApplication.va)).ha(),this.RWe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(G){this.W=
G}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){hb.App.GVd().continueWith(this.R2c)}dispose(){this.RWe&&this.RWe.dispose()}}Object(e.a)(Wq,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var ex=c(100),Kk=c(1502),Qo=c(2068);class Yl{}Yl.ipg="UnsavedChanges";Yl.jpg="UnsavedChangesThemed";Yl.Cbo="SavedChanges";Yl.JEj="UnsavedChangesOpenPipe";Yl.$To="UnsavedChangesOpenPipeCssClassNameThemed";Yl.IEj="UnsavedChangesClosePipe";Yl.XTo="UnsavedChangesClosePipeThemed";
Yl.YTo="UnsavedChanges";Yl.ZTo="UnsavedChangesThemed";Yl.kpg="UnsavedChangesIndicatorPositionRef";Object(e.a)(Yl,"UnsavedChangesHighlightUtils",null,[]);class Qx extends Kk.a{constructor(G,ha){super();this.yfa=G;this.Ax=ha;this.h3=[this.Ax?new Qo.a(Yl.jpg,Yl.ZTo):new Qo.a(Yl.ipg,Yl.YTo)]}get Oca(){return!0}get qkb(){return 4}get J3a(){return this.h3}QHa(G,ha){if(this.yfa){var La=this.yfa.AQf;if(La&&La.count&&La.contains(G.id))for(G=ha.nIa("span"),ha=0;ha<G.length;ha++)La=G[ha],ha||La.classList.add(this.Ax?
Yl.$To:Yl.JEj),ha===G.length-1&&La.classList.add(this.Ax?Yl.XTo:Yl.IEj),La.classList.add(this.Ax?Yl.jpg:Yl.ipg)}}d3a(){}}Object(e.a)(Qx,"UnsavedChangesHighlightActor",Kk.a,[]);var Bv=c(1063);class Uu{constructor(G){this.hye=null;this.yfa=G;this.EGe=!1}get key(){return"UnsavedChangesHighlight"}get Ku(){return"UnsavedChanges"}reset(G){if(this.yfa){G=G.node;if(ul.ParagraphReader.Xb(G)){const ha=this.yfa.AQf;if(ha&&ha.contains(G.id)){this.EGe=!0;this.hye=G.id;return}}this.EGe=!1;this.hye=ei.a.nil}}lAa(){let G=
null;return this.EGe?(G=Object.assign(new Bv.a,{nE:this.key,contentObject:this.hye,description:null}),{returnValue:!0,RE:G}):{returnValue:!1,RE:G}}}Object(e.a)(Uu,"UnsavedChangesHighlightCpContentDetailsProvider",null,[345,346]);class $s{constructor(G,ha,La,lb,Vb,tc,Nc){this.X7g=null;this.K6=G;this.rf=ha;this.VW=La;this.m7=lb;this.bkh=Vb;this.S_b=tc;this.Ax=Nc;this.rf.gOa(this.VY.bind(this))}get AQf(){return this.X7g}Dvm(){if(this.K6){if(1===this.K6.u9e){if(0===this.K6.xKf&&this.K6.WZi()){this.X7g=
this.K6.p5d;const G=this.K6.Cdd;this.K6.Dbo.forEach(this.Rol.bind(this));G.forEach(this.Evm.bind(this));0<G.length&&this.Cql(this.VW);return 0}return this.XQn(this.K6.xKf)}return 2}return 1}XQn(G){switch(G){case 0:return this.K6.qoi()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}opi(G,ha,La){if(ha)if(La){La=ha.querySelectorAll("span");for(let lb=0;lb<La.length;lb++){const Vb=La[lb];lb||Vb.classList.add(Yl.JEj);lb===La.length-1&&Vb.classList.add(Yl.IEj);Vb.classList.add(this.Ax?Yl.jpg:
Yl.ipg)}ha.classList.add(Yl.kpg);G&&this.m7.Voc(G)}else ha.classList.add(Yl.Cbo)}$ac(G,ha){const La=this.Rim(G);if(G&&(G=G.qe(Ld.StaticActiveAppFrame.za().jb.rc.$b)))if(G.Xg&&G.Xg.ij&&0!==G.Xg.ij.count)for(const lb of G.Xg.ij)this.opi(La,lb,ha);else this.opi(La,G.htmlElement,ha)}Rim(G){return this.bkh&&(G=this.bkh.qHb(G))&&G&&(G=G.qe(Ld.StaticActiveAppFrame.za().jb.rc.$b))?G:null}Evm(G){this.$ac(G,!0);return!0}Rol(G){this.$ac(G,!1);return!0}Cql(G){G&&G.continueWith(()=>{G.result.logActivity("UnsavedChangesHighlightEnableSurvey",
"WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}VY(G,ha){ha===Sys.EventArgs.Empty?na.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):ha&&ha.errorCode?this.S_b.YU||(G=this.Dvm(),na.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",G),Ca.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==G&&4!==G&&this.INo(G)):na.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ha?"Error Code":
"Kickout Event Args")}INo(G){let ha;const La=new Rd.a;La.extendedProperties=new Map;La.extendedProperties.set("HighlightUnsavedChangesResult",G.toString());La.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(G){case 1:case 2:case 6:ha="HighlightInternalError";break;case 5:ha="ChangeOutsideCanvas"}6!==G&&5!==G||La.extendedProperties.set("UnsavedChangesCollectionResult",this.K6.xKf.toString());ha&&(Ca.Health.instance.recordQosError(ha,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,
La),Ca.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ha,!0,!0,La))}dispose(){this.rf.ePb(this.VY.bind(this))}}Object(e.a)($s,"UnsavedChangesHighlighter",null,[10]);var ur=c(506),Ro=c(465),Bo=c(1500);class Vu extends Bo.a{constructor(G,ha){super();this.yfa=G;this.Ax=ha}n8a(G){if(!this.yfa)return!1;const ha=this.yfa.AQf;return ha?ha.contains(G.Cb.id)||G.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}LRk(G,ha){ha=G.uxa?G.uxa[ha]?G.uxa[ha].style?G.uxa[ha].style.marginLeft:null:null:
null;var La=G.leftMargin;G=1440<=La?-(La/1440*96):G.m0a(0,96,this.zoom);La=0;ha&&(ha=ha.match(/^(\d+)px/))&&ha[1]&&(La=Number(ha[1]));return G-La}rSk(G,ha,La){return Sys.UI.DomElement.getBounds(G).y-La.M4[ha].y}BRk(G){return Sys.UI.DomElement.getBounds(G).height}ANh(G,ha,La,lb){let Vb;Vb=this.LRk(La,ha);ha=this.rSk(G,ha,La);G=this.BRk(G);lb=ur.a.createElement(lb,Ro.a.div);lb.className=this.Ax?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";lb.style.left=Vb+"px";lb.style.top=ha+"px";lb.style.height=
G+"px";return lb}PMh(G,ha,La,lb){const Vb=[],tc=G.querySelectorAll("."+Yl.kpg);if(0===tc.length&&G.classList.contains(Yl.kpg))La=this.ANh(G,ha,La,lb),La.Rga=ha,Vb.push(La);else for(G=0;G<tc.length;G++){const Nc=this.ANh(tc[G],ha,La,lb);Nc.Rga=ha;Vb.push(Nc)}return Vb}$0a(G){let ha=[];var La=G.y5;const lb=La.Ag.ownerDocument;if(La.gk){let Vb=0;for(const tc of La.Xg.ij)(La=this.PMh(tc,Vb,G,lb))&&(ha=ha.concat(La)),Vb+=1}else ha=this.PMh(La.htmlElement,0,G,lb);return ha}}Object(e.a)(Vu,"UnsavedChangesIndicatorActor",
Bo.a,[]);class Ot{constructor(){this.yW=this.Ev=this.QLa=this.m7=this.wod=this.yfa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.m7=ia.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.yfa=new $s(ia.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Bh.SessionStatusManager.instance,Zg.a.Gp(ia.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.m7,ia.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
ia.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!hb.App.instance&&hb.App.instance.Jpa);this.QLa=ia.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager");this.yW=ia.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.wod=new Vu(this.yfa,!!hb.App.instance&&hb.App.instance.Jpa);this.m7.RTa(this.wod);this.QLa&&this.QLa.execute(G=>{G.tV(new Uu(this.yfa))});this.Ev=new Qx(this.yfa,!!hb.App.instance&&hb.App.instance.Jpa);this.yW.j7a(this.Ev)}dispose(){this.m7&&
this.wod&&this.m7.foe(this.wod);this.yW&&this.Ev&&this.yW.dpg(this.Ev);ex.a.jC(this.yfa)}static main(){M.a.instance.Gc(new Ot)}}Object(e.a)(Ot,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var fs=c(130);class ru{constructor(G,ha,La){this.ga=G;this.nn=ha;this.Ca=La}Ub(){this.Ca.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(n.a.smc,y.a.frame,Object(a.a)(this.nn,this.nn.smc,"showZoomDialog")),this.ga.fb(n.a.SNn,y.a.frame,Object(a.a)(this.nn,this.nn.UXi,"onQueryZoomText"),96),this.ga.qa(n.a.ofd,
y.a.frame,Object(a.a)(this.nn,this.nn.JMj,"zoomDialogTabFocusHandler")),this.ga.qa(n.a.nfd,y.a.frame,Object(a.a)(this.nn,this.nn.JMj,"zoomDialogTabFocusHandler")));this.Ca.$("ZoomSliderIsEnabled")&&(this.ga.fb(n.a.H6i,y.a.frame,Object(a.a)(this.nn,this.nn.ktn,"onQueryZoomPercentage"),96),this.ga.fb(n.a.LMj,y.a.frame,Object(a.a)(this.nn,this.nn.axn,"onZoomToPercentage"),96),this.ga.qa(n.a.P9o,y.a.frame,fs.ActionManager.Nf))}}Object(e.a)(ru,"CommonZoomActor",null,[1157]);class fx extends ru{constructor(G,
ha,La){super(G,ha,La);this.oga=ha}Ub(){super.Ub();this.Ca.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(vg.a.qtg,y.a.frame,fs.ActionManager.Nf),this.ga.qa(vg.a.Cqe,y.a.frame,Object(a.a)(this.oga,this.oga.O9o,"zoomTo100")));this.ga.qa(vg.a.zoomToPageWidth,y.a.frame,Object(a.a)(this.oga,this.oga.zoomToPageWidth,"zoomToPageWidth"));this.ga.qa(n.a.Fkb,y.a.frame,Object(a.a)(this.oga,this.oga.Fkb,"increaseZoom"));this.ga.qa(n.a.fhb,y.a.frame,Object(a.a)(this.oga,this.oga.fhb,"decreaseZoom"));this.ga.qa(vg.a.dcg,
y.a.frame,Object(a.a)(this.oga,this.oga.mqo,"setZoomLevelFromRibbon"));this.ga.fb(vg.a.Xob,y.a.frame,Object(a.a)(this.oga,this.oga.UXi,"onQueryZoomText"),96);this.ga.fb(vg.a.Dce,Ni.a.application,Object(a.a)(this.oga,this.oga.jtn,"onQueryZoomLevelLabelText"),96);this.ga.qa(qe.a.lPh,y.a.frame,fs.ActionManager.Nf);this.ga.qa(qe.a.kPh,y.a.frame,fs.ActionManager.Nf);this.ga.qa(qe.a.pPh,y.a.frame,fs.ActionManager.Nf);this.ga.qa(qe.a.mPh,y.a.frame,fs.ActionManager.Nf);this.ga.qa(vg.a.Lka,y.a.frame,fs.ActionManager.Nf)}}
Object(e.a)(fx,"WordEditorZoomActor",ru,[]);class su{constructor(G,ha){this.zoom=G;this.vCk=ha}}Object(e.a)(su,"SetCustomZoomArgs",null,[]);var gx=c(1172);class rg{constructor(G,ha){this.cjl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.djl=[rg.Aff,rg.ALd,"200","150","100","75","50"];this.Tna=3;this.SN=0;this.delta=.1;this.rLf=0;this.fd=new Q.a;this.ai=null;this.K=G;this.oc=ha;this.epj(1)}get oj(){return this.SN}epj(G){this.SN=G}get sLc(){return Math.round(100*
this.oj)}get Nhn(){return Math.floor(this.sLc/10)/10+this.delta}get Mhn(){return Math.ceil(this.sLc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}gAk(G){this.fd.addHandler("ZoomChanged",G)}a3n(G){this.fd.removeHandler("ZoomChanged",G)}hZ(G){this.gAk(G)}ZTa(G){this.a3n(G)}n$i(){}fbj(){}m$i(){}ebj(){}pfd(G){this.KMj(G,this.oj)}KMj(G,ha){null!==G&&Up.a.Onj(G,ha)}Bfg(G,ha=!0){let La=G*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(La=new su(G,ha));this.Dlj(La)}lqo(G,ha=!1){this.Lka(G,
3|(ha?0:4))}Zwn(G,ha,La){if(1===G)return 32;G=La/100;G<this.X0c?G=this.X0c:G>this.B0c&&(G=this.B0c);this.Lka(G,1);ha&&(ha.Hs=Math.floor(100*G));return 32}UXi(G,ha,La,lb,Vb){if(1===La)return 32;G=rb.a.mFa(this.sLc,6,l.AFrameworkApplication.numberFormat);Vb.Value=G;Vb.LabelText=G;return 32}axn(G,ha,La,lb,Vb){return 1===La?32:this.Zwn(La,lb,Vb.value)}ktn(G,ha,La,lb,Vb){Vb.MinValue=100*this.X0c;Vb.MaxValue=100*this.B0c;Vb.value=this.sLc;return 32}Wki(){return this.cjl}Xki(){return this.djl}hVl(){let G=
Math.floor(100*this.oj).toString();1===this.Tna?G=rg.Aff:2===this.Tna&&(G=rg.ALd);return G}Fkb(G,ha,La){if(1===La)return 32;this.U_c(this.oc?this.oc.LC:0,"IncreaseZoom");this.Tna=0;this.Lka(this.Nhn);return 32}fhb(G,ha,La){if(1===La)return 32;this.U_c(this.oc?this.oc.LC:0,"DecreaseZoom");this.Tna=0;this.Lka(this.Mhn);return 32}mqo(G,ha,La,lb,Vb){if(1===La)return 32;this.U_c(this.oc?this.oc.LC:0,"SetZoomLevelFromRibbon");G=Vb.Value;if(G.toLowerCase().startsWith("fit"))return G=new Ab.a(0,1,0,()=>{this.zoomToPageWidth(0,
null,2,null,null)},138,void 0,!0),Bg.a.instance.Wb(G),32;G=parseInt(G)/100;if(isNaN(G))return 2;this.Tna=0;this.Lka(G);return 32}U_c(G,ha){na.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",G,ha,l.AFrameworkApplication.ta.Kb.Gr)}smc(G,ha,La){if(1===La)return 32;na.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const G=this.hVl();this.ai=new gx.a(this.Wki(),this.Xki(),Object(a.a)(this,
this.Qrm,"handleZoomDialogResult"),Kl.FocusManager.instance(),!0);this.ai.smc(CommonUIStrings.l_ZoomDialogTitle,G)}TLm(G){return G.toLowerCase()===rg.Aff.toLowerCase()}ULm(G){return G.toLowerCase()===rg.ALd.toLowerCase()}Qrm(G){if(G){if(this.TLm(G)){this.Tna=1;var ha=32}else if(this.ULm(G))this.Tna=2,ha=this.zoomToPageWidth(0,null,2,null,null);else if(ha=Number.parseInvariant(G)){this.Tna=0;let La=ha;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(La=new su(ha,!0));ha=this.Dlj(La)}else ha=
8;32===ha?na.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:G}):na.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:G})}else na.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:G})}VPn(){this.fd.raiseEvent("ZoomChanged",null)}l7i(){}Q5f(){}JMj(G){if(!this.ai)return 2;var ha=this.ai.focusManager.at().hk.n4;if(ha===this.ai.aA&&G===n.a.ofd||ha===this.ai.oH&&G===n.a.nfd)this.ai.QAb||this.ai.qdo(),this.ai.focusManager.at().hk.iz(this.ai.QAb);
else if(ha.id.startsWith(this.ai.Z5c)||ha.className.startsWith(this.ai.P6i))ha=null,G===n.a.ofd?ha=this.ai.oH:G===n.a.nfd&&(ha=this.ai.aA),this.ai.focusManager.at().hk.iz(ha),Sys.UI.DomElement.removeCssClass(this.ai.QAb.parentNode,this.ai.F5f);else if(G===n.a.ofd)this.ai.focusManager.at().pgc();else if(G===n.a.nfd)this.ai.focusManager.at().ngc();else return 2;return 32}}rg.Aff="FullPage";rg.ALd="PageWidth";Object(e.a)(rg,"ZoomManager",null,[852]);var ni;(function(G){G[G.manual=0]="manual";G[G.fitToFullPage=
1]="fitToFullPage";G[G.fitWidth=2]="fitWidth";G[G.onBoot=3]="onBoot"})(ni||(ni={}));Object(e.b)("ZoomStatus",ni);c(1086);var xo;(function(G){G[G.normal=0]="normal";G[G.quiet=1]="quiet";G[G.disableScrollUpdate=2]="disableScrollUpdate";G[G.disableUiControlUpdate=4]="disableUiControlUpdate"})(xo||(xo={}));Object(e.b)("ZoomUpdateFlags",xo);var Qr=c(246),Vi=c(333),Cv=c(1223);class Dv extends rg{constructor(G,ha,La,lb,Vb,tc,Nc){super(G,ha);this.g6o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%",
"75%","50%"];this.h6o=[rg.ALd,"200","150","125","100","75","50"];this.JXe=this.Xej=!1;this.OMg="AutoFitForAdaptiveLayout";this.F3j="FitPageWidthFailure";this.uok="UpdateZoomFailure";this.Qpk="wwf";this.ZYe=null;this.q9i=()=>{this.Tna===ni.fitWidth&&this.Vlf()};this.qhl=hd=>{if(hd.ctrlKey){l.AFrameworkApplication.va.processAction(qe.a.mPh,2);hd=hd.i5o;if(!hd)return!1;this.Lka(this.oj-(0<hd?.1:-.1));this.U_c(6,"CtrlScroll");return!0}return!1};this.$wn=()=>{na.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",
!0);return!0};this.kX=La;this.sk=lb;this.Vb=Vb;this.ig=tc;this.awc=Nc;this.U3g=G.$("KeepViewAfterZoomIsEnabled");this.Rpk=G.$("ZoomShortCutIsEnabled");this.Jok=G.$("DoNotAutoScrollAfterPinchIsEnabled");this.t8j=(this.HFe=G.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&G.$("AutoFitForSmallScreenModeIsEnabled");this.I1j=G.$("DoNotProcessUpdateZoomActionIsEnabled");this.Spk=G.$("ZoomSliderIsEnabled");this.Qz()}get appName(){return"WordEditor"}get B0c(){return 4}get X0c(){return.1}get rhl(){return wacBoot.CtrlWheelMetrics}wzk(G){this.fd.addHandler("PinchStart",
G)}R2n(G){this.fd.removeHandler("PinchStart",G)}vzk(G){this.fd.addHandler("PinchEnd",G)}Q2n(G){this.fd.removeHandler("PinchEnd",G)}get eK(){return null!=this.zHg?this.zHg:this.zHg=ia.a.instance.Oa("WordEditor.IStatusBarUser")}LIj(G){G=!(G&xo.disableUiControlUpdate);const ha=Ta.a.get_instance().isCompleted(7);return G&&ha?(G={SelectZoomOption:"ComboBoxModel"},Ld.StaticActiveAppFrame.za()&&Ld.StaticActiveAppFrame.za().lH(G),this.K0o(),!0):!1}Lka(G,ha=xo.normal){let La=!0;this.I1j||l.AFrameworkApplication.va.processAction(vg.a.Lka,
2);if(this.oj===G)return this.JXe||(this.JXe=this.LIj(ha)),La;G>this.B0c?G=this.B0c:G<this.X0c&&(G=this.X0c);var lb=!!(ha&xo.quiet);1===G||lb||l.AFrameworkApplication.va.processAction(vg.a.qtg,2);try{lb=null;Ld.StaticActiveAppFrame.za()&&Object(Qc.a)(Cv.MainView,Ld.StaticActiveAppFrame.za().jb.rc)&&(lb=Ld.StaticActiveAppFrame.za().jb.rc);let Vb=-1,tc=-1,Nc=-1;const hd=!(ha&xo.disableScrollUpdate);this.U3g&&hd&&(Vb=Pd.SelectionEditor.Xkm(hj.a.instance.ib.lb,lb),tc=lb.HL.scrollLeft,Nc=lb.HL.scrollTop);
const fd=this.oj;this.epj(G);this.VPn();this.JXe=this.LIj(ha);hd&&this.k_o(lb,Vb,tc,Nc,fd)}catch(Vb){La=!1,na.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Vb)}return La}k_o(G,ha,La,lb,Vb){G&&G.isActive?this.U3g?0<=ha&&100>=ha?G.Es.D1(100-ha,!0,!0):G.Es.IZm(La,lb,Vb,this.oj):G.Es.D1():na.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}O9o(G,ha,La){2===La&&(this.U_c(this.oc?this.oc.LC:0,"ZoomTo100"),this.Tna=ni.manual,this.Lka(1));return 32}Dlj(G){this.Tna=
ni.manual;let ha,La=!0;if(this.Jok){if(!Object(Qc.a)(su,G))return na.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;ha=G.zoom/100;La=G.vCk}else ha=Number.parseInvariant(String.format("{0}",G))/100;na.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",ha);G=xo.normal;La||(G=xo.disableScrollUpdate);this.Lka(ha,G);return 32}zoomToPageWidth(G,ha,La){if(1===La)return 32;na.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(kd.a)("ZoomToPageWidth",
!0);this.Tna=ni.fitWidth;this.Wxl();return this.Vlf()}jtn(G,ha,La,lb,Vb){if(1===La)return 32;G=rb.a.mFa(this.sLc,6,l.AFrameworkApplication.numberFormat);Vb[Qr.a.labelText]=G;return 32}Wki(){return this.g6o}Xki(){return this.h6o}Wxl(){this.Xej||(Ld.StaticActiveAppFrame.za()?(Ld.StaticActiveAppFrame.za().G_(this.q9i),this.Xej=!0):na.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}Vlf(){var G=this.kX.hrf();if(!G)return 8;for(var ha=0;G;)ha=
Math.max(ha,qa.a.instance.ru(G)),G=this.kX.xRc(G);G=V.a.Oi(ha,0);(ha=this.awc())&&ha.xie()&&(G+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());G+=2*Vi.a.Vsg;G=Ld.StaticActiveAppFrame.za().RF.offsetWidth/G;this.Lka(G);return 32}K0o(){this.eK&&(this.Spk?(this.eK.pV(yk.a.J9o),this.eK.pV(yk.a.L9o)):this.eK.pV(yk.a.M9o))}DEo(G){G||(G=window.self.CtrlWheelMetrics);if(G){var ha=G.ctrlWheelOccurred;if("boolean"!==typeof ha)na.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{na.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ha);try{G.stop()}catch(La){na.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",La)}}}else na.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Qz(){this.DEo(this.rhl);if(this.sk){var G=document.getElementById(pq.AppFrame.eMd);G&&this.sk.ob(U.a.enb,G,this.qhl)}this.Vb&&(G=this.Vb.fe(pq.AppFrame.VD),this.Rpk&&(G.bindAction(Oe.KeyInputManager.ic(kk.a.lpc,Oe.KeyInputManager.Rh),n.a.Fkb),G.bindAction(Oe.KeyInputManager.ic(kk.a.Aed,
Oe.KeyInputManager.Rh),n.a.Fkb),G.bindAction(Oe.KeyInputManager.ic(kk.a.mpc,Oe.KeyInputManager.Rh),n.a.fhb),G.bindAction(Oe.KeyInputManager.ic(kk.a.opc,Oe.KeyInputManager.Rh),n.a.fhb),G.bindAction(Oe.KeyInputManager.ic(kk.a.ngd,Oe.KeyInputManager.Rh),vg.a.Cqe)));this.ig&&(this.ZYe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.ob(U.a.click,this.ZYe,this.$wn);this.t8j&&(Ld.StaticActiveAppFrame.za().bJ.registerLayoutBreakpointChanged("canvas",ha=>{this.Y3e(ha)}),Ld.StaticActiveAppFrame.za().bJ.registerBoundingWindowRectsChanged("canvas",
()=>{this.Y3e(Ld.StaticActiveAppFrame.za().bJ.getLayoutBreakpoint())}))}Y3e(G){let ha=!0,La="";if(this.Tna!==ni.onBoot)return ha;Ca.Health.instance.recordKpiUsage(this.OMg,0,this.Qpk,null);switch(G){case "Small":8===this.Vlf()&&(La=this.F3j,ha=!1);break;default:1===this.oj||this.Lka(1)||(La=this.uok,ha=!1)}ha||Ca.Health.instance.recordKpiFailure(this.OMg,La,!0,!0,null);return ha}n$i(G){this.wzk(G)}fbj(G){this.R2n(G)}m$i(G){this.vzk(G)}ebj(G){this.Q2n(G)}l7i(){this.fd.raiseEvent("PinchStart",null)}Q5f(){this.fd.raiseEvent("PinchEnd",
null)}}Object(e.a)(Dv,"WordEditorZoomManager",rg,[2030,852]);class Xq{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const G=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ha=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");G.Ub();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
ha&&Ta.a.get_instance().pk(4,()=>{ha.Y3e(Ld.StaticActiveAppFrame.za().bJ.getLayoutBreakpoint())||na.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(G){this.W=G;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Dv(l.AFrameworkApplication.K,l.AFrameworkApplication.va,Xl.WordSectionNavigator.instance,Hl.a.instance,Kl.FocusManager.instance(),yj.a.instance,()=>G.Oa("Box4.IFloatingObjectUpdater"))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new fx(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).ha())}static main(){M.a.instance.Gc(new Xq)}}Object(e.a)(Xq,"ZoomPackage",null,[1,2]);var ir=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class gs extends wl.a{constructor(G){var ha;super("DocumentOwnerConditionId");this.Il=G.Il;this.fgg=null!==(ha=G.fgg)&&void 0!==ha?ha:!0}initialize(){super.initialize();const G=
l.AFrameworkApplication.K;G.Nn(()=>{const ha=G.$("IsDocumentOwner");this.pg(ha===this.fgg)})}pg(G){super.pg(G);na.ULS.sendTraceTag(508958623,3028,50,this.FO(this.Il,G))}}Object(e.a)(gs,"DocumentOwnerCondition",wl.a,[]);var kq=c(260);class lw extends kq.a{constructor(G,ha,La){super("LicensePaywallCondition");this.z1b=G.Il;this.g3j=G.YBl;this.Ca=ha;this.dv=La}initialize(){super.initialize();this.s8k()}Od(){super.Od()}s8k(){this.Ca.Nn(()=>{!this.Ca.$("IsAnonymousUser")&&this.dv?this.dv.execute(G=>{this.AJe=
Date.now();G.isFeatureEnabled(this.g3j,!1).then(ha=>{this.AJe=Date.now()-this.AJe;this.pg(ha)})}):this.pg(!1)})}pg(G){super.pg(G);na.ULS.sendTraceTag(508884163,3028,50,this.FO(this.z1b,G,"Latency for license check: "+this.AJe.toString()+"ms"))}}Object(e.a)(lw,"LicensePaywallCondition",kq.a,[]);var pm=c(1763);class Zl extends nk.a{constructor(G,ha){var La=new Rn({Il:23,a2a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const lb=new Rn({Il:23,a2a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),
Vb=new gs({Il:23,fgg:!1});La=new zb.a([La,lb,Vb]);l.AFrameworkApplication.se("fbc73697;a29b4114");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(ha=new lw({Il:23,YBl:"Copilot"},l.AFrameworkApplication.K,ha),La.add(ha));l.AFrameworkApplication.se("f5gia801;0f27g313");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)&&(G=new pm.a({Il:23},G),La.add(G));super(23,La,null,3028,"CopilotSummarySkittleInitTriggered")}}Object(e.a)(Zl,"CopilotSummarySkittleInitTriggerModel",nk.a,[]);var Pt={get interop(){var G=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:copilotSummarySkittleUx.interop;if(!G)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return G}};class mw{constructor(G,ha){this.UId=G;this.Q8c=ha;this.WHa=async(La,lb)=>{if(lb.qZ){Object(kd.a)("CopilotSummarySkittleInitializationTriggered");
this.UId.dea(this.WHa);this.UId.Od();try{const [,Vb]=await Promise.all([this.H3m(),Promise.all([c.e(2),c.e(29)]).then(c.bind(null,2108))]);Vb.main(Pt.interop)}catch(Vb){na.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.UId.U3(this.WHa);this.UId.initialize()}async H3m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Vj.c)(this.Q8c)).dA.loadScript("copilotSummarySkittleUx")}}
Object(e.a)(mw,"CopilotSummarySkittleInitializer",null,[]);class st extends Kj.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}F8(G){this.container=G}H8(){(new mw(new Zl(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory"),this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}G8(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&M.a.instance.Gc(new st)}}Object(e.a)(st,"CopilotSummarySkittleEntryPackage",Kj.a,[]);var tp;(function(G){G[G.Zap=0]="Healthy";G[G.Qbp=1]="MissedScan";G[G.$bp=2]="NeedsReset";G[G.Y$o=3]="CriticalUnresponsive";G[G.zbp=4]="KickoutComponent"})(tp||(tp={}));Object(e.b)("TimerBasedWatchDogStatus",tp);class jr{constructor(G,ha,La){this.Fwd=this.p4g=this.r5g=this.RVb=this.ZBa=0;this.VPi=3;this.NKd=3E4;this.m1b=G;this.Jtb=ha;this.Nli=La}rza(){this.ZBa=0}async ofn(){const G=Date.now(),ha=this.m1b.Yec;
this.Fwd++;if(this.p4g==ha&&this.uvo(G,this.r5g))return{["WatchDogScanTime"]:G,["LastComponentScanTime"]:ha,["ComponentStatus"]:tp[this.RVb],["ActionTaken"]:"None. Skipping to Match Interval"};this.p4g=ha;this.r5g=G;this.Jtb=this.m1b.vPh;this.RVb=this.N7h(G,ha);3===this.RVb&&(await this.fSo(),this.RVb=this.N7h(G,this.m1b.Yec));return this.MCk(this.RVb,G,ha)}xYm(){return 0===this.RVb}N7h(G,ha){let La=0;G>ha+Math.max(this.Jtb,this.NKd)+this.Nli&&(La=0===this.ZBa?1:this.ZBa<this.VPi?2:this.ZBa===this.VPi?
3:4);return La}MCk(G,ha,La){const lb={};lb.WatchDogScanNumber=this.Fwd;lb.WatchDogScanTime=ha;lb.LastComponentScanTime=La;lb.ComponentStatus=tp[G];lb.ExpectedComponentScanInterval=this.Jtb;lb.GraceTimeInMS=this.Nli;lb.ActualTimeBetweenWatchDogAndComponentScans=ha-La;switch(G){case 0:lb.ActionTaken="None";this.ZBa=0;break;case 1:this.ZBa++;lb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.ZBa++;lb.ActionTaken="Component restarted";na.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",
this.Jtb);this.m1b.ywj();this.m1b.Jvj(Math.min(this.Jtb,this.NKd/2));break;case 3:this.ZBa++;lb["ActionTaken?"]="Attempted Synchronous run: "+tp[G];break;case 4:na.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),lb["ActionTaken?"]="Kickout would happen here",lb.ShouldKickout=!0,this.ZBa++}lb.NextExpectedComponentScanTimeInMs=La+(this.ZBa+1)*this.Jtb;lb.MissedScans=this.ZBa;return lb}async fSo(){return this.m1b.Z2h()}uvo(G,ha){return ha+this.Jtb>G}}Object(e.a)(jr,
"TimerBasedWatchDog",null,[1348]);class Yo{constructor(G,ha,La,lb,Vb,tc,Nc,hd){this.rW=null;this.uBc=this.Sfa=0;this.Nwb=new Date(Date.UTC(0,1,1,0,0));this.GI={};this.NCc=this.MCc=0;this.lEh=async()=>{var fd;na.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.MCc++);if(this.rf.Io)this.R7c(),this.stop(),na.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.Tw.KVa);else{this.Nwb=new Date;
var sd={};sd.DocxSaveMonitor_IsUpToDate=null===(fd=this.rW)||void 0===fd?void 0:fd.YU;sd.RSNManager_IsUpToDate=this.Tw.YU;sd.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.Tw.O5b();sd.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Tw.iJd();na.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",sd);if(this.am&&!this.am.isVisible)na.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",
this.Tw.KVa),this.RGn();else if(fd=this.Tw.xKc(this.Cwd),0<fd){fd=this.G5h(fd);na.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(fd));this.Vnl&&na.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.VC());if(0==this.Sfa)this.uBc=this.Yec;else if(1<this.Sfa){na.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.Sfa,this.Yec-this.uBc);if(this.OJm&&(!await this.Tw.vWd(this.qsm)||0===this.Tw.xKc(this.Cwd))){this.R7c();return}this.LNi(fd,
this.Yec);this.GI.ShouldKickout&&(na.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.GI)),this.g_.Pec(this.A2l()))}this.Sfa++}else this.R7c(),this.hXk()}};this.mEh=async()=>{await this.lEh();this.Pvj()};this.Tw=G;this.rf=ha;this.g_=Nc;this.kjk=hd;this.afh=lb;this.Cwd=Vb;this.Hik=tc;this.rW=ia.a.instance.Oa("Wonca.IDocxSaveMonitor");this.GI.ShouldKickout=!1;this.f1f=this.BDn;this.y2i=this.CDn;La.execute(fd=>{this.am=fd});this.rf.gOa(this.VY.bind(this))}get Yec(){return this.Nwb.getTime()}G5h(G){return{["NumberOfStaleRevisions"]:G,
["BrowserIsOnline"]:Qq.a[this.rf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.rf.Io,["IsSessionExpired"]:this.rf.fda,["IsSessionLost"]:this.rf.rXc,["HasEmergencyViewDeployed"]:this.rf.Yj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.am?Tg.a[this.am.LD]:"undefined"}}VY(G,ha){if(ha){G=Date.now();var La=this.Tw.xKc(this.Cwd);0<La&&(La=this.G5h(La),this.LNi(La,G));this.gao();this.P6m(ha.errorCode)}this.stop();
this.rW=ia.a.instance.Oa("Wonca.IDocxSaveMonitor")}hXk(){this.Tw.HWd(this.Hik)&&this.jUo()}jUo(){na.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.kjk.e7e();Ti.a.Umf(Hm.a.runAwayDataLoss)}A2l(){return this.pVm?la.a.g7o:this.rf.fda?la.a.hMj:la.a.f7o}stop(){0!==this.NCc&&(window.clearInterval(this.NCc),this.NCc=0);na.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async Z2h(){this.Uep&&this.stop();this.mEh();na.ULS.sendTraceTag(509101133,
3038,50,"RDLM running Synchronously")}DDo(G){this.NCc=window.setTimeout(this.mEh,G);na.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.R7c()}Pvj(){this.NCc=window.setInterval(this.lEh,this.afh);na.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.R7c()}gao(){this.V3h(this.GI);na.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.GI))}get jhj(){const G=Object.assign({},this.GI);this.V3h(G);return G}V3h(G){G.shouldKickout||(0==this.Tw.xKc(this.Cwd)?(G.NoKickoutReason="No Stale Revisions",
G.OldestRevisionCreationTime=this.Tw.K9b()):this.am&&!this.am.isVisible?(G.NoKickoutReason="Session not active",G.VisibilityManager_AppVisibilityState=this.am.LD):this.aDi&&this.Sfa<=this.y2i?(G.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",G.ScansWithPersistentRunawayDataLoss=this.Sfa):this.Sfa<=this.f1f?(G.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",G.ScansWithPersistentRunawayDataLoss=this.Sfa):G.NoKickoutReason="undefined");
G.LastScanTime=this.Nwb.toISOString();G.RunCounter=this.MCc}VC(){const G={};this.rW&&(G.DSM=this.rW.VC());this.Tw&&(G.RSN=this.Tw.VC());return G}R7c(){na.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",this.Sfa,this.uBc);this.uBc=this.Sfa=0}RGn(){this.Sfa=Math.min(this.f1f-1,this.Sfa);this.uBc=Date.now()}aDi(){return 0===this.am.LD&&this.rf.bD&&!this.rf.rXc&&!this.rf.fda&&!this.rf.Yj}LNi(G,
ha){this.Sfa>this.y2i&&this.aDi()?this.GI.ShouldKickout||(this.GI.ShouldKickout=!0,this.W3h("Persistent RunawayDataLoss detected in active session",ha,G)):this.Sfa>this.f1f&&!this.GI.ShouldKickout&&(this.GI.ShouldKickout=!0,this.W3h("Runaway DataLoss persists for more than 3 minutes.",ha,G))}W3h(G,ha,La){this.GI.KickoutTime=(new Date(ha)).toISOString();this.GI.KickoutReason=G;this.GI.DSM_isUpToDate=this.rW?this.rW.YU:"Undefined";this.GI.SessionInfo=La}P6m(G){const ha=this.GI.ShouldKickout;Ca.Health.instance.recordKpiUsage(Yo.yre,
1,Yo.uOd,null);const La=new Map;G&&La.set("ErrorCode",G.toString());ha?(La.set("ShouldKickout","true"),La.set("KickoutTime",this.GI.KickoutTime),La.set("Reason",this.GI.KickoutReason),Ca.Health.instance.recordKpiSuccess(Yo.yre,Object.assign(new Rd.a,{extendedProperties:La}))):(La.set("ShouldKickout","false"),G=this.GI.NoKickoutReason,La.set("Reason",G),Ca.Health.instance.recordKpiFailure(Yo.yre,G,!1,!1,Object.assign(new Rd.a,{extendedProperties:La})))}ywj(){na.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");
this.stop()}Jvj(G){na.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",G);this.DDo(G)}get Vnl(){return null!=this.Ayg?this.Ayg:this.Ayg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",!0)}get qsm(){return null!=this.lBg?this.lBg:this.lBg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",
3E3):3E3}get OJm(){return null!=this.BDg?this.BDg:this.BDg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get CDn(){return null!=this.wGg?this.wGg:this.wGg=l.AFrameworkApplication.K.nc("RunawayDataLossMinimumScansBeforeKickout",1)}get BDn(){return null!=this.vGg?this.vGg:this.vGg=l.AFrameworkApplication.K.nc("RunawayDataLossMaximumScansBeforeKickout",5)}get pVm(){return 1===this.rf.networkState||3===this.rf.networkState}get vPh(){return this.afh}}
Yo.yre="RunAwayDataLossKickout";Yo.uOd="wwrelfc";Object(e.a)(Yo,"RunawayDataLossMonitor",null,[1858,1859]);class wm{constructor(){this.hSg=3E4;this.N0j=24E4;this.O0j=12E4;this.W=this.Dwd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(hb.App.Fs||hb.App.Cm)this.Dwd=this.W.resolve(this.name),this.Dwd.Pvj(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.UNi()}Uel(){return new Yo(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
this.W.resolve("Common.ISessionStatus")||Bh.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),l.AFrameworkApplication.K.nc("RunawayDataLossScanIntervalInMs",this.hSg),this.wao,this.O0j,ia.a.instance.Oa("Box4.IKickoutExecutor"),Af.WoncaApp.OF)}wc(G){if(hb.App.Fs||hb.App.Cm)this.W=G,G.ia(this.name,this.Uel.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.M7f()}dispose(){this.Dwd&&this.Dwd.stop()}static main(){M.a.instance.Gc(new wm)}M7f(){this.W.ia("WordEditor.RunawayDataLossMonitorWatchDog",
()=>new jr(this.W.resolve(this.name),l.AFrameworkApplication.K.nc("RunawayDataLossScanIntervalInMs",this.hSg),l.AFrameworkApplication.K.nc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get wao(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.xao)}get xao(){return l.AFrameworkApplication.K.nc("RunawayDataLossKickoutIntervalInMs",this.N0j)}}Object(e.a)(wm,"WordEditorRunawayDataLossMonitorPackage",null,[1,2]);class rq{constructor(G,
ha){this.lik=G;this.mik=ha}}Object(e.a)(rq,"LastSavedToHostDetailsEventArgs",null,[1899]);class Tn{constructor(G,ha,La,lb,Vb,tc){this.onk=5E4;this.iWe=0;this.Nwb=new Date(Date.UTC(0,1,1,0,0));this.p0j=6E4;this.MCc=this.ZYb=0;this.sa=new Q.a;this.sfo=()=>{na.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.MCc++);this.rf.Io||this.Y8b().then(Nc=>{this.sa.raiseEvent(Tn.uGi,Nc);this.h5g=new Date;Nc=this.V0b;this.am&&!this.am.isVisible&&(Nc=this.Llk);
this.sAa(Nc)}).catch(Nc=>{this.sAa(this.Cim(Nc))})};this.Pxd=G;this.rf=La;this.q3=Vb;this.Tw=tc;this.V0b=ha.nc("LastSavedToHostDetailsIntervalMs",6E4);this.bvb=ha.nc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.Llk=ha.nc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.V0b);this.ESe=ha.nc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.h5g=new Date;lb.execute(Nc=>{this.am=Nc;this.am.K_a((hd,fd)=>{this.mY(fd)})});0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.UNi();
this.sAa(this.V0b)}mY(G){0!==G.newState&&1!==G.newState||0===G.oldState||1===G.oldState||this.rf.Io||(this.sAa(this.iWe),na.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.h5g,this.iWe))}KRa(){return 1==this.rf.networkState}Y8b(){this.Nwb=new Date;return new Promise((G,ha)=>{if(this.KRa())na.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),ha(0);else if(this.rf.fda)na.ULS.sendTraceTag(524154146,
3037,15,"Waiting for token to refresh. Not attempting to send request."),ha(2);else if(this.Tw.YU)na.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),ha(3);else{var La=ac.b(yf.construct(this.fac()));na.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var lb=0;lb=this.Pxd.nj(Tn.serviceUrl,2,La,{"Content-Type":"application/json; charset=utf-8"},!1,0,Vb=>this.N_m(Vb,G,ha),Vb=>this.O_m(Vb,ha),null,null,!0,this.ESe);0>=lb&&(na.ULS.sendTraceTag(525214231,
3037,15,"Invalid request id returned "+lb.toString()),ha(0))}})}O_m(G,ha){let La=2;if(G=G.data){if(5===G.status)La=1;else if(7===G.status||13===G.status)La=this.zso?0:1;na.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",G.status))}else na.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");ha(La)}N_m(G,ha,La){if(G=G.data){var lb={},Vb=G.jj?G.jj[kh.a.ZQ]:"";lb.HttpStatus=G.Ne;lb.Correlation=Vb;lb.Id=G.id;
na.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",lb);(G=this.Vva(G.te))?(this.q3.PVa(G),ha(new rq(G.LastSavedRevisionId,G.RevisionSequenceNumber))):(na.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),La(2))}else na.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),La(2)}sAa(G){0!==this.ZYb&&window.clearTimeout(this.ZYb);this.ZYb=window.setTimeout(this.sfo,G);na.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+
G)}fac(){const G=Ld.StaticActiveAppFrame.za().jb.rc;return G?G.ed:null}Cim(G){return 1===G?this.iWe:0===G?this.onk:3===G?this.V0b:this.bvb}Vva(G){let ha;return({group:ha}=$c.a.d2(G)).returnValue?ha.Responses[0]:null}aAk(G){this.sa.addHandler(Tn.uGi,G)}async Z2h(){const G=new Promise((ha,La)=>{window.setTimeout(La,3E3)});await Promise.race([G,this.Y8b()]).then(()=>{na.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{na.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}ywj(){0!==
this.ZYb&&(na.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.ZYb),this.ZYb=0)}Jvj(G){na.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",G);this.sAa(G)}get Yec(){return this.Nwb.getTime()}get vPh(){return this.p0j}VC(){const G={};G.LastScanTime=this.Nwb.toISOString();G.RunCounter=this.MCc;return G}get zso(){return null!=this.gHg?this.gHg:this.gHg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",
!1):!1}}Tn.uGi="ULSTHD";Tn.serviceUrl=hb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(e.a)(Tn,"LastSavedToHostDetailsManager",null,[1486,1859]);class Vk{constructor(G,ha,La){this.ntm=G;this.wza=ha;this.M_m=La;this.J0f=()=>{const lb=this.ntm();return 32!==lb?lb:!this.wza||this.wza.YU?32:8};this.lYo=(lb,Vb,tc,Nc,hd)=>{this.M_m.sAa(parseInt(hd.toString()));return 32}}Ub(G){G.qa(vg.a.J0f,Ni.a.view,this.J0f);G.qa(vg.a.gGj,Ni.a.view,this.lYo);G.Xc(vg.a.gGj,101)}}Object(e.a)(Vk,
"LastSavedToHostDetailsManagerActor",null,[]);class Wp{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}wc(G){const ha=l.AFrameworkApplication.K;this.W=G;const La=new Ym(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.He.zZ,l.AFrameworkApplication.He.ZQh);this.W.ia("WordEditor.ILastSavedToHostDetailsManager",()=>new Tn(La,ha,this.W.Oa("Common.ISessionStatus")||Bh.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),mk.a.instance,
this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).ha();this.M7f()}init(){(new Vk(()=>Af.WoncaApp.OF.coi(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Ub(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){M.a.instance.Gc(new Wp)}M7f(){this.W.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",
()=>new jr(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),l.AFrameworkApplication.K.nc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.nc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(e.a)(Wp,"LastSavedToHostDetailsPackage",null,[1,2]);class Bn{constructor(G,ha,La,lb){this.l8k=G;this.n8k=ha;this.Daf=La;this.appSettings=lb;this.FWk=async()=>{const Vb=er.b.Ira(),tc=Promise.race([this.Mqn(),new Promise(Nc=>setTimeout(()=>Nc(!1),5E3))]);na.ULS.sendTraceTag(508863558,
3048,50,"Copilot Compose feature condition check took: {0}ms",Vb.$Mc);return tc};this.Mqn=async()=>{if(!this.mNm)return!1;await this.N4o();return this.l8k.CIc()&&await this.n8k.CIc()?!0:!1};this.PMm=new Pb.a(this.FWk)}async isEnabled(){return this.PMm.value}get mNm(){const G=this.Daf.isInsertActionEnabled,ha=this.Daf.isRewriteActionEnabled;return this.Daf.isStartActionEnabled||G||ha}async N4o(){return new Promise(G=>{this.appSettings.Nn(()=>{G(!0)})})}}Object(e.a)(Bn,"CopilotComposeFeatureCondition",
null,[]);const Zf=new Hk(()=>Promise.all([c.e(2),c.e(5),c.e(24)]).then(c.bind(null,2097)).then(G=>G.instance));class Da{constructor(G,ha){this.Usg=G;this.logger=ha;this.z2c=async()=>{await this.logger.measureActivityPerformanceAsync(this.rrl,{name:"Initialize"})};this.rrl=async()=>{await Promise.all([Zf.w4(),this.Usg.loadChunk("copilotComposeUx")]);await Zf.Xhb()}}initialize(){this.z2c().catch(G=>{na.ULS.Vz(508913495,3048,10,G,"Failed to initialize CopilotCompose")})}}Object(e.a)(Da,"CopilotComposeInitializer",
null,[]);const Ra="CH DE FR EU UK NO SE NL PIE".split(" "),Ha=["Exchange Online Consumer","OneDriveWOPI"];class Ba{async CIc(){var G,ha,La,lb,Vb;const tc=null!==(ha=null===(G=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===G?void 0:G.WACDatacenter)&&void 0!==ha?ha:"unknown";G=null!==(lb=null===(La=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===La?void 0:La.Ring)&&void 0!==lb?lb:"unknown";La=null===(Vb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Vb?void 0:Vb.Host;
return this.ZVc(tc,G,La)}ZVc(G,ha,La){if("1"===ha||"unknown"===G||Ha.includes(La))return!0;const lb=G.toUpperCase();return!Ra.some(Vb=>lb.includes(Vb))}}Object(e.a)(Ba,"CopilotComposeDatacenterCondition",null,[]);class Va{constructor(G,ha){this.appSettings=G;this.p2e=ha;this.Amb="Copilot";this.l4b="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"}async CIc(){const G=await this.cXk();na.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",G);return 2!==G}async cXk(){if(this.Q6e())return 0;
const G=er.b.Ira(),ha=await this.pzf();na.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",G.$Mc);return ha?1:2}Q6e(){return this.appSettings.getBooleanFeatureGate(this.l4b,!1)}async pzf(){return(await Object(Vj.c)(this.p2e)).isFeatureEnabled(this.Amb,!1)}}Object(e.a)(Va,"CopilotComposeLicenseCondition",null,[]);class Gb{constructor(G){this.appSettings=G}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",
!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",!1)}get isAiInsertStreamingEnabled(){return this.isStreamingEnabled&&this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.AiInsertStreaming",
!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isVivaSalesCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isVivaSalesCiqEnabled",!1)}}Object(e.a)(Gb,"CopilotComposeFeatureGatesImpl",null,[]);class Cb extends Kj.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}F8(G){G.ia("WordEditor.Copilot.Compose.EditorAiTelemetryLogger",()=>
new er.a(G.resolve("Wac.Common.Utils.IOtelWrapper"),"CopilotCompose")).ha()}H8(){const G=ia.a.instance;(new Da(G.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),G.resolve("WordEditor.Copilot.Compose.EditorAiTelemetryLogger"))).initialize()}G8(){}static main(){Cb.hUl().isEnabled().then(G=>{G&&M.a.instance.Gc(new Cb)}).catch(()=>{na.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static hUl(){const G=ia.a.instance;G.ia("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition",
()=>new Ba).ha();G.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureGates",()=>new Gb(l.AFrameworkApplication.K)).ha();G.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new Va(l.AFrameworkApplication.K,G.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();G.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",()=>new Bn(G.resolve("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition"),G.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),
G.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureGates"),l.AFrameworkApplication.K)).ha();return G.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}Object(e.a)(Cb,"CopilotComposeEntryPackage",Kj.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");To.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");S;Type.registerNamespace("CACPU");va.main();Type.registerNamespace("CAEventTimingMeter");xb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");lc.main();Type.registerNamespace("Common.App.GestureInput");Wa.main();Type.registerNamespace("Common.App.GestureManager");fb.main();
Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),M.a.instance.Gc(new kc));Type.registerNamespace("Common.App.O365Shell");db.main();Type.registerNamespace("Common.App.PhoneLink");Qd.main();Type.registerNamespace("Common.App.SensitiveLogging");lj.main();Type.registerNamespace("Common.App.Rename");M.a.instance.Gc(new ig,
7);Type.registerNamespace("Common.App.Rename.RenameExecutor");M.a.instance.Gc(new Gh);Type.registerNamespace("Common.App.SaveAsToHost");Ok.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Ef.main();Type.registerNamespace("Common.App.SaveACopy");Fk.main();Type.registerNamespace("Common.App.SaveToSharePoint");Nn.main();Type.registerNamespace("Common.App.SharedFilePicker");zi.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");
Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");rm.main();ep;M.a.instance.Gc(new Ma);Sk.main();ir;Cp.main();M.a.instance.Gc(new Uo);hp.main();yn.a.prototype.toString=ko.a.prototype.toString;fq.a.Tli=new Rp.a;M.a.instance.Gc(new Br);Xq.main();M.a.instance.Gc(new Sp);M.a.instance.Gc(new Vo);M.a.instance.Gc(new Nt);Fq.main();fp.main();Qk.main();Ot.main();Type.registerNamespace("NLRT");M.a.instance.Gc(new sh);Type.registerNamespace("Common.App.AccessibilitySettings");
L.main();M.a.instance.Gc(new Wq);Qn.main();zn.main();fj.main();kn.main();st.main();Cb.main();wm.main();Wp.main();window.EventTiming={EventTimingMeter:Ai,FrameTimingMeter:qk}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20380705/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll2.js.map
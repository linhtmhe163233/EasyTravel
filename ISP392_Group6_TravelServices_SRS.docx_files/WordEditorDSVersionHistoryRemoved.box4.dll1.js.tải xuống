'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1077:function(D,J,c){function l(Q,N=self){N.addEventListener("message",function U(X){if(X&&X.data){var {id:T,type:Y,path:aa}=Object.assign({path:[]},X.data),ba=(X.data.Svh||[]).map(n);try{const ma=aa.slice(0,-1).reduce((ua,sa)=>ua[sa],Q),ea=aa.reduce((ua,sa)=>ua[sa],Q);switch(Y){case "GET":var oa=ea;break;case "SET":ma[aa.slice(-1)[0]]=n(X.data.value);oa=!0;break;case "APPLY":oa=ea.apply(ma,ba);break;case "CONSTRUCT":const ua=
new ea(...ba);oa=Object.assign(ua,{[v]:!0});break;case "ENDPOINT":const {port1:sa,port2:Fa}=new MessageChannel;l(Q,Fa);oa=x(sa,[sa]);break;case "RELEASE":oa=void 0;break;default:return}}catch(ma){oa={value:ma,[H]:0}}Promise.resolve(oa).catch(ma=>({value:ma,[H]:0})).then(ma=>{const [ea,ua]=y(ma);N.postMessage(Object.assign(Object.assign({},ea),{id:T}),ua);"RELEASE"===Y&&(N.removeEventListener("message",U),"MessagePort"===N.constructor.name&&N.close())})}});N.start&&N.start()}function e(Q){if(Q)throw Error("Proxy has been released and is not useable");
}function a(Q,N=[],O=function(){}){let X=!1;const U=new Proxy(O,{get(T,Y){e(X);if(Y===E)return()=>t(Q,{type:"RELEASE",path:N.map(aa=>aa.toString())}).then(()=>{"MessagePort"===Q.constructor.name&&Q.close();X=!0});if("then"===Y){if(0===N.length)return{then:()=>U};T=t(Q,{type:"GET",path:N.map(aa=>aa.toString())}).then(n);return T.then.bind(T)}return a(Q,[...N,Y])},set(T,Y,aa){e(X);const [ba,oa]=y(aa);return t(Q,{type:"SET",path:[...N,Y].map(ma=>ma.toString()),value:ba},oa).then(n)},apply(T,Y,aa){e(X);
T=N[N.length-1];if(T===I)return t(Q,{type:"ENDPOINT"}).then(n);if("bind"===T)return a(Q,N.slice(0,-1));const [ba,oa]=k(aa);return t(Q,{type:"APPLY",path:N.map(ma=>ma.toString()),Svh:ba},oa).then(n)},construct(T,Y){e(X);const [aa,ba]=k(Y);return t(Q,{type:"CONSTRUCT",path:N.map(oa=>oa.toString()),Svh:aa},ba).then(n)}});return U}function k(Q){Q=Q.map(y);return[Q.map(N=>N[0]),Array.prototype.concat.apply([],Q.map(N=>N[1]))]}function x(Q,N){L.set(Q,N);return Q}function y(Q){for(const [N,O]of K)if(O.RBh(Q)){const [X,
U]=O.serialize(Q);return[{type:"HANDLER",name:N,value:X},U]}return[{type:"RAW",value:Q},L.get(Q)||[]]}function n(Q){switch(Q.type){case "HANDLER":return K.get(Q.name).deserialize(Q.value);case "RAW":return Q.value}}function t(Q,N,O){return new Promise(X=>{const U=z();Q.addEventListener("message",function aa(Y){Y.data&&Y.data.id&&Y.data.id===U&&(Q.removeEventListener("message",aa),X(Y.data))});Q.start&&Q.start();Q.postMessage(Object.assign({id:U},N),O)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=c(0);const v=Symbol("Comlink.proxy"),I=Symbol("Comlink.endpoint"),E=Symbol("Comlink.releaseProxy"),H=Symbol("Comlink.thrown"),M=Q=>"object"===typeof Q&&null!==Q||"function"===typeof Q,K=new Map([["proxy",{RBh:Q=>M(Q)&&Q[v],serialize(Q){const {port1:N,port2:O}=new MessageChannel;l(Q,N);return[O,[O]]},deserialize(Q){Q.start();return a(Q,[],void 0)}}],["throw",{RBh:Q=>M(Q)&&H in Q,serialize({value:Q}){return[Q instanceof Error?
{xRa:!0,value:{message:Q.message,name:Q.name,stack:Q.stack}}:{xRa:!1,value:Q},[]]},deserialize(Q){if(Q.xRa)throw Object.assign(Error(Q.value.message),Q.value);throw Q.value;}}]]),L=new WeakMap;c.d(J,"a",function(){return S});class S{static tUj(Q){S.fbb=Q;S.Lpk=a(Q,[],void 0)}static get Endpoint(){return S.fbb}static get uUj(){return S.Lpk}}Object(D.a)(S,"WorkerUtils",null,[])},1093:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"WaterlineOverrideSettings",null,[])},
1094:function(D,J,c){D=c(0);var l=c(416),e=c(529),a=c(578),k=c(233),x=c(532);class y extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}ml(){return x.a.getActivities}static Uba(E,H,M){const K=new y;K.FileId=E;K.HighWaterline=H;K.LowWaterline=M;return K}}Object(D.a)(y,"GetActivitiesRequest",k.a,[]);class n extends k.a{constructor(E,H,M){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=E;this.Waterline=H;this.Settings=M}ml(){return x.a.getRelevantActivities}static Uba(E,
H,M){return new n(E,H,M)}}Object(D.a)(n,"GetRelevantActivitiesRequest",k.a,[]);class t extends k.a{constructor(E,H){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=E;this.WaterlineOverrideSettings=H}ml(){return x.a.getWywaActivities}static Uba(E,H){return new t(E,H)}}Object(D.a)(t,"GetWywaActivitiesRequest",k.a,[]);class z{}Object(D.a)(z,"RelevantActivitiesSettings",null,[]);class v extends k.a{constructor(){super();this.FileId=null}ml(){return x.a.updateWaterline}static Uba(E){const H=
new v;H.FileId=E;return H}}Object(D.a)(v,"UpdateWaterlineRequest",k.a,[]);c.d(J,"a",function(){return I});class I{constructor(E,H,M,K,L){this.gck=E;this.pwd=H;this.KQe=M;this.krc=K;this.GOg=L}requestWYWAActivities(E){E=t.Uba(this.pwd(),E);return l.a.then(this.I8(E,"wywa"),H=>H)}requestActivities(E,H){E=y.Uba(this.pwd(),E,H);return l.a.then(this.I8(E,"activities"),M=>M)}p6n(){const E=v.Uba(this.pwd());return l.a.then(this.I8(E,"waterline"),H=>H)}requestRelevantActivities(E,H){H=Object.assign(new z,
{FirstDocumentOpen:H,MockDataEnabled:!1});E=n.Uba(this.pwd(),E,H);return l.a.then(this.I8(E,"relevant"),M=>M)}updateActivityState(E){return l.a.ecd(this.GOg,H=>H.xUo(E.itemIds,E.activityStatesToSet,E.activityStatesToReset,E.resetUnseenCount))}requestActivityFeed(){return l.a.ecd(this.GOg,E=>E.getActivityFeed(null))}I8(E,H){const M={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.ecd(this.gck,K=>K.Wv(this.KQe,M,e.a.KIh(E,this.krc),H)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.te))return null;
({group:K}=a.a.d2(K.args.data.te));return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(D.a)(I,"SharedActivityRepository",null,[])},1432:function(D,J,c){c.d(J,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.pbp=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.dep=1]="VoiceDictationBadge";a[a.eep=2]="VoiceDictationPhrase"})(e||(e={}))},1540:function(D,J,c){c.r(J);c.d(J,"Box4PasteSteward",function(){return oa});D=c(0);var l=c(22),
e=c(2),a=c(19),k=c(127),x=c(56),y=c(2061),n=c(2062),t=c(6),z=c(7),v=c(36),I=c(75),E=c(15),H=c(91),M=c(101),K=c(8),L=c(3),S=c(88),Q=c(5),N=c(136),O=c(37),X=c(84),U=c(41),T=c(59),Y=c(28),aa=c(449),ba=c(1789);class oa extends ba.a{constructor(ma,ea,ua,sa,Fa,Pa,Na,Aa=null,za=null){super(ma,Na,Aa,za);this._formatting=null;this.OLa=!1;this.Rvb=null;this.RXb=-1;this.xxb=0;this.lEc=new I.a;this.Rbn=4294967295;v.a(4223754,307,U.OutlineElementReader.yh(ma));this.Xvb=ea;this.Xvb.N3b(this);this.pM=ua;this.pM.N3b(this);
this.qq=sa;this.Zm=Fa;this.tOe=H.ListItemReader.lg(this.zc);oa.kCm();oa.XBm();oa.HCm()}get Axa(){return null!=this.xDg?this.xDg:this.xDg=l.a.instance.Oa("Box4.IInternalLinkManager")}get mKd(){return this._formatting}get K5b(){return this.tOe&&!this.pM.zEa}get PDb(){return 0<this.xxb}reset(){super.reset();this._formatting=this.rqf(!1)}n2e(ma){var ea;v.a(4223762,307,U.OutlineElementReader.yh(this.zc)||X.OutlineReader.nx(this.zc));this.rgc(!1);var ua=new Q.GraphIterator;ua.kd(this.zc);ma=ba.a.Pf.OH(this.zc,
this.vRc(ma));this.JDd(ua,!1);v.a(4223763,307,ma===this.zc.currentNode);v.a(4223764,307,K.ParagraphReader.Xb(ma));-1!==this._formatting.zw&&oa.Sk.pE(ma,this._formatting.zw);if(oa.Sk.qq&&!this.HZ.Orj&&this._formatting.textIndent&&({unit:Fa,returnValue:sa}=oa.E$d(this._formatting.textIndent),ua=!1,sa)){if(0>sa){ua=!0;var sa=-1*sa}var Fa=oa.Baf(sa,Fa);ua?oa.Sk.qq.bqb(ma,Fa):oa.Sk.qq.mea(ma,Fa)}(oa.Qd.yg||S.a.instance.J(1)&&E.App.Iv.ySb)&&ma.setValue(t.a.LRa,!0);this._formatting.lineSpacing&&oa.Sk.lD(ma,
this._formatting.lineSpacing);e.AFrameworkApplication.se("702j5362;7g13g664");this._formatting.gS&&(null===(ea=e.AFrameworkApplication.K)||void 0===ea?0:ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(z.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),oa.Sk.Wpb(ma,this._formatting.gS.afterSpacing),oa.Sk.Xpb(ma,this._formatting.gS.beforeSpacing));if(this._formatting.dnc){ea=
[];ua=[];Fa=[];sa=this._formatting.dnc.split(" ");let Na=1,Aa=0;for(let za=0;za<sa.length;za++){var Pa=oa.Z7k(sa[za]);const xa=oa.Y7k(sa[za]);if(-1!==Pa)Na=Pa;else if(-1!==xa)Aa=xa;else{const {unit:ka,returnValue:wa}=oa.E$d(sa[za]);Pa=oa.Baf(wa,ka);if(0<=Pa&&Pa<=this.Rbn)ea.push(Pa),ua.push(Na),Fa.push(Aa);else{v.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.dnc+" index: "+za);break}Na=1;Aa=0}}0<ea.length&&oa.Sk.Esk(ma,ea,ua,Fa)}this._formatting.paragraph=ma;this.OLa=
!0}JDd(ma,ea){v.a(8128518,307,!ea);this.oV&&(0<this.oV&&this.qq.TLc(ma,this.oV),0>this.oV&&this.qq.zTa(ma,this.oV,0));ma&&this.Zm.xhe(ma,this.PDb);this.oV=0}Mcd(ma){this.lEc.add(ma)}A8e(){this.oV=0}Kda(ma,ea=null){v.a(4223772,307,K.ParagraphReader.oh(this.zc));const ua=this.zc.currentNode;this._formatting.hog(ua);if(!this.HZ.rog(this.zc,ea,!1)){var sa=ua.ra.last,Fa=Y.a.tw(ua);this.OLa&&(sa.formatting=this._formatting.nR.wf(sa),ua.Xl(),this.OLa=!1);ma=this.HZ.Nyf(ma,ea);this.HZ.K$(this.zc.currentNode,
this._formatting.Sda,ea);this.jg.Ge(Fa,ma,void 0,void 0,L.a.paste)}}Jda(ma){this.HZ.E0d&&this.HZ.w_d(ma)?(this.zF(),this.jE(ma)):(v.a(4223773,307,K.ParagraphReader.oh(this.zc)),ma=Y.a.tw(this.zc.currentNode),this.jg.kia(ma,ea=>new aa.a(ea)))}gob(){this.HZ.Tyf(this.zc)}zya(ma){if(oa.Wsl(ma)){const ea=this.zc.currentNode;K.ParagraphReader.Xb(ea)&&(ea.kic=ma.vkf)}else this.Xvb.zya(ma)}KHa(ma){this._formatting=ma;this.OLa=!0}XSa(ma){v.a(4223774,307,K.ParagraphReader.oh(this.zc));v.a(4223775,307,!this.Rvb);
v.a(4223776,307,0>this.RXb);this.Rvb=ma;this.RXb=K.ParagraphReader.textLength(this.zc.currentNode)}WSa(){v.a(4223777,307,K.ParagraphReader.oh(this.zc));v.a(4223778,307,!!this.Rvb);v.a(4223779,307,0<=this.RXb);let ma=Y.a.createTextRange(this.zc.currentNode,this.RXb,K.ParagraphReader.textLength(this.zc.currentNode)),ea="",ua="";this.Axa&&({P7f:ea,EFb:ua}=this.Axa.jog(M.a.NFa(this.Rvb))).returnValue&&(this.Rvb=ea,ua&&(this.jg.Ge(ma,ua),ma=Y.a.createTextRange(this.zc.currentNode,this.RXb,K.ParagraphReader.textLength(this.zc.currentNode))));
oa.jp.fF(ma,this.Rvb,!1);this.OLa=!0;this.Rvb=null;this.RXb=-1}jE(ma){this.n2e(ma);this._formatting.pne(this.zc.currentNode);this.HZ.K$(this.zc.currentNode,this._formatting.Sda,ma,this._formatting.marginLeft,this._formatting.textIndent)}zF(){v.a(4223808,307,K.ParagraphReader.oh(this.zc));oa.jp.wxl(this.zc.currentNode);O.OutlineElementNavigator.Yd(this.zc)}bob(){}aob(){}bTa(){}q6a(){}Dya(){v.a(4223809,307,U.OutlineElementReader.yh(this.zc)||X.OutlineReader.nx(this.zc));let ma=!1;this.PDb||(ma=this.K5b||
!0);ma||(this.oV+=1);this.xxb++}Bya(){this.xxb--;let ma=!1;this.PDb||(ma=this.K5b||!0,this.Zm.Taj(this.lEc));ma||--this.oV}OHa(ma){v.a(4223810,307,U.OutlineElementReader.yh(this.zc)||X.OutlineReader.nx(this.zc));v.a(4223811,307,!!ma.listStyleType);this.Zm.tQb(this.f2m(ma))}Cya(){v.a(4223813,307,U.OutlineElementReader.yh(this.zc))}s6a(ma){this.Xvb.s6a(ma)}b$(ma){this.pM.b$(ma)}Z9(){this.pM.Z9()}w5(ma){this.pM.w5(ma)}a$(){this.pM.a$()}Y9(ma){this.pM.Y9(ma)}X9(){this.pM.X9()}static get Sk(){return null!=
oa.gGg?oa.gGg:oa.gGg=l.a.instance.resolve("Box4.IParagraphEditor")}static get jp(){return null!=oa.zBg?oa.zBg:oa.zBg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Qd(){return null!=oa.pJg?oa.pJg:oa.pJg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get SKj(){return null!=oa.eKg?oa.eKg:oa.eKg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Ymc(){return oa.SUe}static set Ymc(ma){oa.SUe=ma}static get Jo(){return N.a.getInstance()}static kCm(){oa.E6a[y.a.heading1]=
T.StyleReader.wordStyleIdHeading1;oa.E6a[y.a.heading2]=T.StyleReader.wordStyleIdHeading2;oa.E6a[y.a.heading3]=T.StyleReader.wordStyleIdHeading3;oa.E6a[y.a.heading4]=T.StyleReader.MTb;oa.E6a[y.a.heading5]=T.StyleReader.NTb;oa.E6a[y.a.heading6]=T.StyleReader.OTb;oa.E6a[y.a.citation]=null}static XBm(){oa.eya[n.a[n.a.unspecified]]=0;oa.eya[n.a[n.a.defaultUnordered]]=1;oa.eya[n.a[n.a.defaultOrdered]]=1;oa.eya[n.a[n.a.none]]=0;oa.eya[n.a[n.a.disc]]=1;oa.eya[n.a[n.a.circle]]=2;oa.eya[n.a[n.a.square]]=3;
oa.eya[n.a[n.a.decimal]]=1;oa.eya[n.a[n.a.lowerAlpha]]=2;oa.eya[n.a[n.a.lowerRoman]]=3;oa.eya[n.a[n.a.upperAlpha]]=4;oa.eya[n.a[n.a.upperRoman]]=5}static HCm(){oa.SUe=oa.SKj.Ar()}static Z7k(ma){let ea=-1;if(!ma)return ea;ma=ma.toLowerCase();switch(ma){case "left":ea=1;break;case "center":ea=3;break;case "right":ea=4;break;case "decimal":ea=6;break;case "bar":ea=7}return ea}static Y7k(ma){let ea=-1;if(!ma)return ea;ma=ma.toLowerCase();switch(ma){case "blank":ea=0;break;case "dotted":ea=1;break;case "dashed":ea=
2;break;case "lined":ea=3}return ea}static bDb(ma){const ea=a.a.substring(ma,0,2),ua=a.a.substring(ma,2,4);return a.a.substring(ma,4,6)+ua+ea}static E$d(ma){let ea=0;const ua=ma.length;var sa=a.a.substring(ma,0,ua-2);sa=parseFloat(sa);ma=a.a.substr(ma,ua-2,2);switch(ma){case "in":ea=3;break;case "px":ea=7;break;case "cm":ea=1;break;case "pt":ea=5;break;default:z.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ma),sa=0}return{returnValue:sa,
unit:ea}}static Baf(ma,ea){let ua=0;switch(ea){case 3:ua=k.a.Nv(ma);break;case 7:ua=x.a.Yy(ma,0);break;case 1:ua=k.a.E7e(ma);break;case 5:ua=k.a.Nv(k.a.D1f(ma));break;default:z.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ma,ea)}return ua}static Wsl(ma){return!!ma&&!!ma.vkf&&""!==ma.vkf}}oa.E6a=Array(y.a.maxParagraphStyle+1);oa.eya={};oa.SUe=null;Object(D.a)(oa,"Box4PasteSteward",ba.a,[])},1575:function(D,J,c){D=c(0);var l=
c(2),e;(function(y){y[y.chrome=0]="chrome";y[y.edge=1]="edge";y[y.firefox=2]="firefox";y[y.IE=3]="IE";y[y.safari=4]="safari";y[y.others=5]="others";y[y.unknown=6]="unknown";y[y.electron=7]="electron";y[y.chromiumEdge=8]="chromiumEdge";y[y.teamsElectron=9]="teamsElectron"})(e||(e={}));Object(D.b)("BrowserCode",e);var a=c(7);const k=(y,n)=>{const t={};let z=null;switch(y){case 0:z="HtmlProcessor";var v=n.a;null!=v&&(t.SessionID=v);var I=n.b.toString();null!=I&&(t.Elements=I);var E=n.c.toString();null!=
E&&(t.PrunedElements=E);var H=n.d.toString();null!=H&&(t.TransparentElements=H);var M=n.e.toString();null!=M&&(t.VoidElements=M);var K=n.f.toString();null!=K&&(t.UnknownElements=K);break;case 1:z="WordConverter";var L=n.a;null!=L&&(t.SessionID=L);var S=n.b.toString();null!=S&&(t.BulletsConverted=S);var Q=n.c.toString();null!=Q&&(t.NumberedConverted=Q);break;case 2:z="FormattingSteward";var N=n.a;null!=N&&(t.SourceApp=N);var O=n.b;null!=O&&(t.Browser=O);var X=n.c;null!=X&&(t.OperationId=X);var U=n.d.toString();
null!=U&&(t.Lang=U);var T=n.e.toString();null!=T&&(t.TextDir=T);var Y=n.f.toString();null!=Y&&(t.Bold=Y);var aa=n.g.toString();null!=aa&&(t.Math=aa);var ba=n.h.toString();null!=ba&&(t.Italics=ba);var oa=n.i.toString();null!=oa&&(t.Underline=oa);var ma=n.j.toString();null!=ma&&(t.Strikethrough=ma);var ea=n.k.toString();null!=ea&&(t.Subscript=ea);var ua=n.l.toString();null!=ua&&(t.Superscript=ua);var sa=n.m.toString();null!=sa&&(t.Fontsize=sa);var Fa=n.n.toString();null!=Fa&&(t.Fontface=Fa);var Pa=
n.o.toString();null!=Pa&&(t.GrowFontsize=Pa);var Na=n.p.toString();null!=Na&&(t.ShrinkFontsize=Na);var Aa=n.q.toString();null!=Aa&&(t.FontColor=Aa);var za=n.r.toString();null!=za&&(t.FontHighlight=za);var xa=n.s.toString();null!=xa&&(t.ParagraphStyle=xa);var ka=n.t.toString();null!=ka&&(t.TextAlign=ka);var wa=n.u.toString();null!=wa&&(t.TextIndent=wa);var ia=n.v.toString();null!=ia&&(t.MarginLeft=ia);var va=n.w.toString();null!=va&&(t.ParagraphSpaceBefore=va);var na=n.x.toString();null!=na&&(t.ParagraphSpaceAfter=
na);var Ca=n.y.toString();null!=Ca&&(t.LineSpace=Ca);var ta=n.z.toString();null!=ta&&(t.CellShadingColor=ta);var fa=n.ba.toString();null!=fa&&(t.StyleDefinition=fa);var Xa=n.bb.toString();null!=Xa&&(t.TabStops=Xa);break;case 3:z="SemanticEvents";var ob=n.a;null!=ob&&(t.SessionID=ob);var xb=n.b.toString();null!=xb&&(t.Text=xb);var zb=n.c.toString();null!=zb&&(t.LineBreak=zb);var Lb=n.d.toString();null!=Lb&&(t.Image=Lb);var Ia=n.e.toString();null!=Ia&&(t.File=Ia);var Ya=n.f.toString();null!=Ya&&(t.FormattingChange=
Ya);var eb=n.g.toString();null!=eb&&(t.Anchor=eb);var sb=n.h.toString();null!=sb&&(t.Paragraph=sb);var lc=n.i.toString();null!=lc&&(t.Math=lc);var vb=n.j.toString();null!=vb&&(t.List=vb);var Eb=n.k.toString();null!=Eb&&(t.ListItem=Eb);var Ua=n.l.toString();null!=Ua&&(t.RenderAugmentation=Ua);var Ta=n.m.toString();null!=Ta&&(t.Span=Ta);break;case 4:z="SemanticTableEvents";var Nb=n.a;null!=Nb&&(t.SessionID=Nb);var Wa=n.b.toString();null!=Wa&&(t.Tables=Wa);var Bb=n.c.toString();null!=Bb&&(t.TableRow=
Bb);var Ob=n.d.toString();null!=Ob&&(t.TableCell=Ob);var hc=n.e.toString();null!=hc&&(t.TablePart=hc);break;case 5:z="HtmlEvents";var Gc=n.a;null!=Gc&&(t.OperationId=Gc);var bc=n.b;null!=bc&&(t.SourceApp=bc);var Dc=n.c;null!=Dc&&(t.Browser=Dc);var Ub=null==n.d?null:n.d.toString();null!=Ub&&(t.Text=Ub);var Fc=null==n.e?null:n.e.toString();null!=Fc&&(t.A=Fc);var Sa=null==n.f?null:n.f.toString();null!=Sa&&(t.Abbr=Sa);var wb=null==n.g?null:n.g.toString();null!=wb&&(t.Acronym=wb);var Tb=null==n.h?null:
n.h.toString();null!=Tb&&(t.Address=Tb);var Hb=null==n.i?null:n.i.toString();null!=Hb&&(t.Applet=Hb);var $a=null==n.j?null:n.j.toString();null!=$a&&(t.Area=$a);var ab=null==n.k?null:n.k.toString();null!=ab&&(t.B=ab);var rb=null==n.l?null:n.l.toString();null!=rb&&(t.Base=rb);var cb=null==n.m?null:n.m.toString();null!=cb&&(t.Basefont=cb);var rc=null==n.n?null:n.n.toString();null!=rc&&(t.Bdo=rc);var Rb=null==n.o?null:n.o.toString();null!=Rb&&(t.Big=Rb);var fb=null==n.p?null:n.p.toString();null!=fb&&
(t.Blockquote=fb);var Pb=null==n.q?null:n.q.toString();null!=Pb&&(t.Body=Pb);var Ec=null==n.r?null:n.r.toString();null!=Ec&&(t.Br=Ec);var uc=null==n.s?null:n.s.toString();null!=uc&&(t.Button=uc);var ya=null==n.t?null:n.t.toString();null!=ya&&(t.Caption=ya);var db=null==n.u?null:n.u.toString();null!=db&&(t.Center=db);var tb=null==n.v?null:n.v.toString();null!=tb&&(t.Cite=tb);var Xb=null==n.w?null:n.w.toString();null!=Xb&&(t.Code=Xb);var $b=null==n.x?null:n.x.toString();null!=$b&&(t.Col=$b);var Ab=
null==n.y?null:n.y.toString();null!=Ab&&(t.Colgroup=Ab);var vc=null==n.z?null:n.z.toString();null!=vc&&(t.Dd=vc);var Sc=null==n.ba?null:n.ba.toString();null!=Sc&&(t.Del=Sc);var ed=null==n.bb?null:n.bb.toString();null!=ed&&(t.Dfn=ed);var pd=null==n.bc?null:n.bc.toString();null!=pd&&(t.Dir=pd);var oc=null==n.bd?null:n.bd.toString();null!=oc&&(t.Div=oc);var cd=null==n.be?null:n.be.toString();null!=cd&&(t.Dl=cd);var Xc=null==n.bf?null:n.bf.toString();null!=Xc&&(t.Dt=Xc);var ic=null==n.bg?null:n.bg.toString();
null!=ic&&(t.Em=ic);var Ac=null==n.bh?null:n.bh.toString();null!=Ac&&(t.Fieldset=Ac);var wd=null==n.bi?null:n.bi.toString();null!=wd&&(t.Font=wd);var Je=null==n.bj?null:n.bj.toString();null!=Je&&(t.Form=Je);var Zd=null==n.bk?null:n.bk.toString();null!=Zd&&(t.Frame=Zd);var le=null==n.bl?null:n.bl.toString();null!=le&&(t.Frameset=le);var kc=null==n.bm?null:n.bm.toString();null!=kc&&(t.H=kc);var kd=null==n.bn?null:n.bn.toString();null!=kd&&(t.Head=kd);var nd=null==n.bo?null:n.bo.toString();null!=nd&&
(t.Hr=nd);var Ud=null==n.bp?null:n.bp.toString();null!=Ud&&(t.Html=Ud);var Qd=null==n.bq?null:n.bq.toString();null!=Qd&&(t.I=Qd);var Gd=null==n.br?null:n.br.toString();null!=Gd&&(t.Iframe=Gd);var of=null==n.bs?null:n.bs.toString();null!=of&&(t.Img=of);var Tf=null==n.bt?null:n.bt.toString();null!=Tf&&(t.Input=Tf);var uh=null==n.bu?null:n.bu.toString();null!=uh&&(t.Ins=uh);var Gh=null==n.bv?null:n.bv.toString();null!=Gh&&(t.Isindex=Gh);var Dh=null==n.bw?null:n.bw.toString();null!=Dh&&(t.Kbd=Dh);var lg=
null==n.bx?null:n.bx.toString();null!=lg&&(t.Label=lg);var xh=null==n.by?null:n.by.toString();null!=xh&&(t.Legend=xh);var eg=null==n.bz?null:n.bz.toString();null!=eg&&(t.Li=eg);var cc=null==n.ca?null:n.ca.toString();null!=cc&&(t.Link=cc);var Ic=null==n.cb?null:n.cb.toString();null!=Ic&&(t.Map=Ic);var Yc=null==n.cc?null:n.cc.toString();null!=Yc&&(t.Math=Yc);var ad=null==n.cd?null:n.cd.toString();null!=ad&&(t.Menu=ad);var yd=null==n.ce?null:n.ce.toString();null!=yd&&(t.Meta=yd);var ne=null==n.cf?null:
n.cf.toString();null!=ne&&(t.Noframes=ne);var Oe=null==n.cg?null:n.cg.toString();null!=Oe&&(t.Noscript=Oe);var nf=null==n.ch?null:n.ch.toString();null!=nf&&(t.Object=nf);var wf=null==n.ci?null:n.ci.toString();null!=wf&&(t.Ol=wf);var Ye=null==n.cj?null:n.cj.toString();null!=Ye&&(t.Optgroup=Ye);var Rg=null==n.ck?null:n.ck.toString();null!=Rg&&(t.Option=Rg);var Db=null==n.cl?null:n.cl.toString();null!=Db&&(t.P=Db);var Zb=null==n.cm?null:n.cm.toString();null!=Zb&&(t.Param=Zb);var xc=null==n.cn?null:n.cn.toString();
null!=xc&&(t.Pre=xc);var Jd=null==n.co?null:n.co.toString();null!=Jd&&(t.Q=Jd);var ie=null==n.cp?null:n.cp.toString();null!=ie&&(t.S=ie);var De=null==n.cq?null:n.cq.toString();null!=De&&(t.Samp=De);var qf=null==n.cr?null:n.cr.toString();null!=qf&&(t.Script=qf);var tg=null==n.cs?null:n.cs.toString();null!=tg&&(t.Select=tg);var Ah=null==n.ct?null:n.ct.toString();null!=Ah&&(t.Small=Ah);var ji=null==n.cu?null:n.cu.toString();null!=ji&&(t.Span=ji);var Bh=null==n.cv?null:n.cv.toString();null!=Bh&&(t.Strike=
Bh);var Tj=null==n.cw?null:n.cw.toString();null!=Tj&&(t.Strong=Tj);var sf=null==n.cx?null:n.cx.toString();null!=sf&&(t.Style=sf);var vf=null==n.cy?null:n.cy.toString();null!=vf&&(t.Sub=vf);var Sf=null==n.cz?null:n.cz.toString();null!=Sf&&(t.Sup=Sf);var ah=null==n.da?null:n.da.toString();null!=ah&&(t.Tables=ah);var mg=null==n.db?null:n.db.toString();null!=mg&&(t.Tbody=mg);var Bg=null==n.dc?null:n.dc.toString();null!=Bg&&(t.Td=Bg);var Cg=null==n.dd?null:n.dd.toString();null!=Cg&&(t.Textarea=Cg);var ki=
null==n.de?null:n.de.toString();null!=ki&&(t.Tfoot=ki);var Rh=null==n.df?null:n.df.toString();null!=Rh&&(t.Th=Rh);var ml=null==n.dg?null:n.dg.toString();null!=ml&&(t.Thead=ml);var el=null==n.dh?null:n.dh.toString();null!=el&&(t.Title=el);var Kl=null==n.di?null:n.di.toString();null!=Kl&&(t.Tr=Kl);var ig=null==n.dj?null:n.dj.toString();null!=ig&&(t.Tt=ig);var Mi=null==n.dk?null:n.dk.toString();null!=Mi&&(t.U=Mi);var fh=null==n.dl?null:n.dl.toString();null!=fh&&(t.Ul=fh);var zf=null==n.dm?null:n.dm.toString();
null!=zf&&(t.Var=zf);var Eh=null==n.dn?null:n.dn.toString();null!=Eh&&(t.Unknown=Eh);break;case 6:z="List";var tl=n.a;null!=tl&&(t.SessionID=tl);var Nh=n.b.toString();null!=Nh&&(t.MaxListLevel=Nh)}t.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(t)};c.d(J,"a",function(){return x});class x{static get Epa(){null==x.twb&&(x.twb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.twb}static get nAi(){null==x.OGe&&(x.OGe=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.OGe}static Z0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static Bai(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;n.f=0;return n}static t6m(y){x.Epa||x.Z0(k(0,y))}static U6h(y){const n={};n._sessionID=y;return n}static Nki(y){const n={};n.a=y;n.b=0;n.c=0;return n}static k9m(y){x.Epa||x.Z0(k(1,y))}static Aai(y,n){const t={};t.c=e[y];t.a=n;return t}static s6m(y,n){x.nAi&&y&&(y.b=n,x.Z0(k(5,y)))}static phi(y){const n={};n.a=y;n.b=
0;n.c=0;n.d=0;n.e=0;n.f=0;n.g=0;n.h=0;n.i=0;n.j=0;n.k=0;n.l=0;n.m=0;return n}static d8m(y){x.Epa||x.Z0(k(3,y))}static qhi(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;return n}static e8m(y){x.Epa||x.Z0(k(4,y))}static vrf(y,n){const t={};t.b=e[y];t.c=n;t.d=0;t.e=0;t.f=0;t.g=0;t.h=0;t.i=0;t.j=0;t.k=0;t.l=0;t.m=0;t.n=0;t.o=0;t.p=0;t.q=0;t.r=0;t.s=0;t.t=0;t.w=0;t.x=0;t.y=0;t.z=0;t.u=0;t.v=0;t.ba=0;t.bb=0;return t}static c6m(y,n){x.nAi&&y&&(y.a=n,x.Z0(k(2,y)))}static m4l(y){const n={};n.a=y;n.b=-1;return n}static T6m(y){!x.Epa&&
y&&0<=y.b&&x.Z0(k(6,y))}}x.twb=null;x.OGe=null;Object(D.a)(x,"UsageEditor",null,[])},1584:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(2),e=c(5);class a{static get trb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static cjb(k,x=!1){const y=e.GraphIterator.eb(k);y.od();return(x?y.Tb(4):y.dia(4))?4:e.GraphIterator.eb(k).zb(36)?16:e.GraphIterator.eb(k).zb(14)?2:e.GraphIterator.eb(k).zb(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",
null,[])},1605:function(D,J,c){c.d(J,"a",function(){return X});D=c(0);var l=c(75),e=c(192),a=c(22),k=c(174),x=c(2),y=c(244),n=c(6),t=c(82),z=c(62),v=c(44),I=c(447),E=c(214),H=c(238),M=c(8),K=c(254),L=c(18),S=c(11),Q=c(285),N=c(3),O=c(25);class X{static get ah(){return E.ContextSetEditor.instance}static get Xf(){return H.a.instance}static get Ic(){return e.a.instance}static jx(){return X.en||(X.en=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get SA(){return null!=X.iGg?X.iGg:X.iGg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static Eim(){this.lO||
(this.lO=new l.a,this.lO.add(N.a.WA),this.lO.add(N.a.font),this.lO.add(N.a.nZ),this.lO.add(N.a.hva),this.lO.add(N.a.bold),this.lO.add(N.a.fz),this.lO.add(N.a.superscript),this.lO.add(N.a.subscript),this.lO.add(N.a.u0a),this.lO.add(N.a.eva),this.lO.add(N.a.MDa),this.lO.add(N.a.G7e),this.lO.add(N.a.NDa),this.lO.add(N.a.t0a),this.lO.add(N.a.u0),this.lO.add(N.a.K1),this.lO.add(N.a.KC),this.lO.add(N.a.igb),this.lO.add(N.a.VIc));return this.lO}static ycc(U){return X.Eim().contains(U)?!0:!1}static lw(U,
T,Y,aa,ba){var oa=!0;if(!T.view.ue)return 2;var ma=T.view,ea=ma.mb;ea&&ea.ib.lb||(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.noSelection}),oa=!1);X.ah.fEa(L.ImageReader.cXc,ma.mb.qg)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.N$e}),oa=!1);if(X.ah.fEa(L.ImageReader.i4a,ma.mb.qg))return X.Ic.Yb(t.a.ef,{["Reason"]:z.a.SJc}),8;var ua=!X.ycc(U);X.Xf.Dcc(ma.mb.qg,ua)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.cF}),oa=!1);X.ah.fEa(L.ImageReader.s_d,ma.mb.qg)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.H$e}),oa=!1);X.ah.fEa(Q.c,ma.mb.qg)&&(X.Ic.Yb(t.a.ef,
{["Reason"]:z.a.I$e}),oa=!1);X.ah.fEa(K.a.yFf,ma.mb.qg)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.G$e}),oa=!1);X.ah.CAa(M.ParagraphReader.PU,ma.mb.qg)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.zO}),oa=!1);X.jx()&&X.jx().instance&&X.jx().instance.TU(ma.mb.qg)&&(X.Ic.Yb(t.a.ef,{["Reason"]:z.a.Y1a}),oa=!1);var sa=null;ea&&ea.ib.lb&&(sa=ea.ib.lb);if(1===Y||!oa||!sa)return oa?32:8;oa=U===N.a.ifc||U===N.a.K4b||U===N.a.jkc||U===N.a.g9b;ma=U===N.a.gOb||U===N.a.bEb||U===N.a.zjc;ua=U===N.a.IUa||U===N.a.JUa||U===N.a.lD;const Fa=
new v.GraphTransaction(15);Fa.Db(sa.Pa.node);sa=new l.a;let Pa=!1;if(oa||ma||ua)k.a.mark(7121),T=X.ah.$3h(T.ik);else{k.a.mark(7119);T=I.OutlineElementGeneralizer.Cha(ea.ib,!0);if(!T)return X.Ic.Yb(t.a.soa,{["Reason"]:z.a.kOd}),Fa.dispose(),8;ea=U===N.a.S3a||U===N.a.Gkb;T.lx&&ea&&(Pa=X.Zsm(sa,T))}(U===N.a.I9||U===N.a.ifc||U===N.a.Kba||U===N.a.K4b||U===N.a.z$||U===N.a.jkc||U===N.a.nFa||U===N.a.g9b)&&T.lx&&1<T.length&&X.$sm(T)&&(ba||(ba={}),Object.getType(ba)===Object&&(ba.InContextSet=!0));x.AFrameworkApplication.va.Mf(T,
U,Y,!0,aa,ba);Pa&&X.Cin(sa,T,ba);Fa.dispose();O.StaticActiveAppFrame.za().updateCommandUI();oa||ma||ua?k.a.mark(7122):k.a.mark(7120);return 32}static Zsm(U,T){if(!T.lx)return!1;let Y=!1,aa=!1;for(let oa=0;oa<T.length;oa++)if(T.getContext(oa).al){var ba=T.getContext(oa).node;ba&&(ba=X.SA.sjb(ba),2===ba.specialIndentType?(Y=!0,U.add(oa)):1!==ba.specialIndentType&&ba.specialIndentType||(aa=!0))}return aa&&Y}static Cin(U,T,Y){if(T.lx)for(let ba=0;ba<U.count;ba++){var aa=T.getContext(U.J(ba));if(!aa.al)continue;
aa=aa.node;const oa=X.SA.sjb(aa);2!==oa.specialIndentType||y.a.Fxa(Y.value,oa.OB)||aa.setValue(n.a.ee,oa.OB-oa.vea)}}static sgg(U,T){let Y=!0;T.contextId!==S.a.paragraph?Y=!1:X.Xf.U4a(T)?(X.Ic.Yb(t.a.wn,{["Reason"]:z.a.cF}),Y=!1):X.jx()&&X.jx().instance&&X.jx().instance.TU(T)?(X.Ic.Yb(t.a.wn,{["Reason"]:z.a.Y1a}),Y=!1):T.al&&(T=T.node,M.ParagraphReader.Xb(T)&&T.YQ&&(X.Ic.Yb(t.a.wn,{["Reason"]:z.a.zO}),Y=!1));return{returnValue:1!==U&&Y,Dy:Y?32:8}}static $sm(U){if(!U.lx)return!1;let T=1;for(let aa=
0;aa<U.length;aa++){var Y=U.getContext(aa);if(Y&&Y.al&&Y.contextId===S.a.paragraph&&(Y=Y.node))if(Y=M.ParagraphReader.Ox(Y),!aa)T=Y;else if(Y!==T)return!0}return!1}}X.en=null;X.lO=null;Object(D.a)(X,"FormattingActionHelper",null,[])},1608:function(D,J,c){c.d(J,"a",function(){return e});c.d(J,"b",function(){return a});var l=c(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;
case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1621:function(D,J,c){c.r(J);D=c(0);var l=c(25),e=c(2),a=c(130),k=c(22),x=c(56),y=c(359),n=c(44),t=c(5);class z{Pef(Rb,fb,Pb){return 1===Pb?32:z.wll(fb.node)}static wll(Rb){const fb=new t.GraphIterator;
fb.set(Rb);fb.Ip();Rb=new n.GraphTransaction(7);Rb.Ut(fb);fb.tg();Rb.dispose();return 32}}Object(D.a)(z,"DeleteOutlineLevelContentStrategy",null,[]);var v=c(175),I=c(178),E=c(79),H=c(214),M=c(17),K=c(23),L=c(8),S=c(104),Q=c(37),N=c(207),O=c(84),X=c(28);class U{constructor(Rb){this.Pm=null;this.Nma=Rb}get yBb(){return null!=this.Mwg?this.Mwg:this.Mwg=k.a.instance.Oa("Box4.IAutoCorrectRules")}get uX(){return null!=this.Owg?this.Owg:this.Owg=k.a.instance.Oa("Box4.IAutoCorrectScheduler")}get gN(){return null!=
this.NFg?this.NFg:this.NFg=k.a.instance.Oa("Box4.Pages.IPageContentEditor")}get CL(){return null!=this.kFg?this.kFg:this.kFg=k.a.instance.Oa("Box4.IOutlineEditor")}get vg(){return this.Pm||(this.Pm=this.Nma())}jHi(Rb,fb,Pb){if(this.CL&&U.rn){var Ec=H.ContextSetEditor.nsf(fb);Rb=Ec.node;M.SelectionEditor.Kk(Ec)&&(Ec=X.a.Uc(Rb,L.ParagraphReader.textLength(Rb)));var uc=S.FormattingReader.language(S.FormattingReader.Xr(Ec));Ec=t.GraphIterator.eb(Pb.ed);U.hi.h8c(Ec);var ya=Rb=null;if(Ec)for(let db=Ec.Tb(1);db&&
!ya;db=Ec.Ri(1))O.OutlineReader.Qxa(db)&&(ya=db);if(Ec&&!ya){if(!this.gN||!this.CL)return;Rb=new n.GraphTransaction(7);Rb.Ut(Ec);ya=this.gN.NJd(Ec);this.CL.Z7(Ec,!0);uc&&(Q.OutlineElementNavigator.Ee(Ec),Ec=X.a.Uc(Ec.currentNode,0),U.rn.uhe(S.FormattingReader.Xr(Ec),uc))}uc=K.SelectionFactory.Eo(ya,!0);Pb.mb.Ac(uc);M.SelectionEditor.Ze(fb)&&(Pb=t.GraphIterator.eb(fb.node),Pb.Ip(),N.OutlineNavigator.oag(Pb),this.yBb&&this.uX&&O.OutlineReader.KA(Pb,fb,!0)&&(fb=this.yBb.mlf(fb,-1,!1,E.a.Kw))&&this.uX.bij(fb));
this.vg&&this.vg.sF();Rb&&Rb.dispose()}}static get rn(){return null!=U.RAg?U.RAg:U.RAg=k.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=U.vDg?U.vDg:U.vDg=U.fm()}static fm(){return new U(()=>k.a.instance.Oa("Box4.IUndoManager"))}static get hi(){return I.PageNavigator.instance}}Object(D.a)(U,"TitleViewEditor",null,[]);var T=c(49),Y=c(473),aa=c(643),ba=c(21),oa=c(11),ma=c(285),ea=c(3);class ua{constructor(){this.Z0j=new z;this.Pef=(Rb,fb,Pb,Ec,uc)=>this.Z0j.Pef(Rb,fb,Pb,Ec,
uc)}Ub(Rb){const fb=this.YRh.Yef.bind(this.YRh),Pb=this.Pef,Ec=this.NRh.Cll.bind(this.NRh);this.h7f(Rb,fb,Pb,Ec);Rb.qa(ea.a.backspace,oa.a.Tc,Ec);Rb.qa(ea.a.backspace,oa.a.Fd,Ec);Rb.qa(ea.a.backspace,oa.a.Vc,a.ActionManager.gR);Rb.qa(ea.a.backspace,oa.a.outline,Pb);Rb.qa(ea.a.backspace,oa.a.view,fb);Rb.Xc(ea.a.backspace,1124);Rb.qa(ea.a.Tva,oa.a.Tc,a.ActionManager.gR);Rb.qa(ea.a.Tva,oa.a.Fd,Ec);Rb.qa(ea.a.Tva,oa.a.Vc,a.ActionManager.gR);Rb.qa(ea.a.Tva,oa.a.outline,Pb);Rb.qa(ea.a.Tva,oa.a.view,fb);
Rb.fb(ea.a.iKd,oa.a.view,fb,1124);Rb.qa(ea.a.QH,oa.a.Tc,Ec);Rb.qa(ea.a.QH,oa.a.Fd,Ec);Rb.qa(ea.a.QH,oa.a.Vc,a.ActionManager.gR);Rb.qa(ea.a.QH,oa.a.outline,Pb);Rb.qa(ea.a.QH,oa.a.view,fb);Rb.Xc(ea.a.QH,1124);Rb.fb(ea.a.gdf,oa.a.view,fb,1124);Rb.fb(ea.a.Wna,oa.a.view,ua.Wna,1028)}h7f(){}static get hi(){return I.PageNavigator.instance}static get Pf(){return null!=ua.nFg?ua.nFg:ua.nFg=k.a.instance.resolve("Box4.IOutlineElementEditor")}static get gN(){return null!=ua.KFg?ua.KFg:ua.KFg=k.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get CL(){return null!=
ua.jFg?ua.jFg:ua.jFg=k.a.instance.resolve("Box4.IOutlineEditor")}static get Zb(){return null!=ua.Xzg?ua.Xzg:ua.Xzg=k.a.instance.Oa("Box4.IFeatureHelper")}static Wna(Rb,fb,Pb,Ec,uc){Ec=fb.view;if(!Ec.mb||!Ec.mb.ib.lb||M.SelectionEditor.Pl(Ec.mb.ib.lb))return 8;if(1===Pb)return 32;Pb=Ec.mb.ib;const ya=Pb.lb;var db=ya.Pa,tb=null,Xb=!1;if(Pb.MJ){if(db.contextId===oa.a.outline&&1===Pb.length){for(Rb=t.GraphIterator.eb(db.node);Rb.Rd();)Rb.tg();ua.CL.Z7(Rb,!0);Q.OutlineElementNavigator.Ee(Rb);Rb=K.SelectionFactory.ne(Rb.currentNode,
0);Ec.mb.Ac(Rb);return 32}var $b=db.node;tb=null;if(ma.c(db)){var Ab=$b.qe(Ec.$b);Ab&&(Ab=Ab.Sqp)&&0<=Ab.width&&0<=Ab.height&&(tb=new Y.a(x.a.Ql(Ab.x,0),x.a.Ql(Ab.y,1)));tb||(tb=aa.a($b))}else tb=aa.a(db.node);db=t.GraphIterator.eb(db.node);db.Ip();ua.hi.h8c(db);$b=ua.gN.NJd(db);aa.b($b,tb.x,tb.y);ua.CL.Z7(db,!0);tb=K.SelectionFactory.Eo($b,!0)}else if(1===Pb.length){Xb=Pb.last;db=T.a.sDb(Xb);if(ua.Zb&&ua.Zb.isFeatureEnabled(26)&&H.ContextSetEditor.instance.nig(db).returnValue)return 2;Xb=Xb.Rc;Xb=
!Pb.Ov&&(M.SelectionEditor.Kk(Xb)||L.ParagraphReader.um(Xb)||M.SelectionEditor.v9(Xb))}Xb&&(Xb=M.SelectionEditor.Jj(ya,!1,!1,void 0,!1),Ec.mb.Ac(Xb),e.AFrameworkApplication.va.Mf(fb,ea.a.newLine,2,!1,null,uc),tb=Ec.mb.ib.lb,Ec.mb.Ac(ya));uc||(uc=new y.DictionaryPropertySet);uc.setValue(v.a.BMc,!0);e.AFrameworkApplication.va.Mf(fb,ea.a.QH,2,!0,null,uc);if(tb&&tb.Pa.isValid)return Ec.mb.Ac(tb),32;Pb.MJ&&U.instance.jHi(Rb,fb.ik,Ec);M.SelectionEditor.Pl(Ec.mb.ib.lb)||e.AFrameworkApplication.va.Mf(fb,
ea.a.newLine,2,!1,null,uc);return 32}static vll(Rb,fb){if(1===fb)return 32;fb=new n.GraphTransaction(7);fb.Db(Rb);ua.Pf.mza(Rb);fb.dispose();return 32}}Object(D.a)(ua,"ADeleteActor",null,[]);var sa=c(15),Fa=c(238),Pa=c(261),Na=c(1535),Aa=c(61),za=c(19),xa=c(111),ka=c(69),wa=c(118),ia=c(702),va=c(143);class na{get Xf(){return Fa.a.instance}Cll(Rb,fb,Pb,Ec,uc){Ec=null===uc||void 0===uc?void 0:uc.qed;if(1===Pb)return 32;var ya=Rb===ea.a.backspace;if(this.Xf.jh){if(this.Xf.Yyi(fb)&&na.Uga&&(Pb=fb.clone(),
Pb.Sb+=1,--Pb.Fb,this.Xf.kec(Pb)))return na.Uga.J$i([Pb]),32;if(this.Xf.GGf(fb,ya))return 2}if(na.jx()&&na.jx().instance&&na.jx().instance.TU(fb))return 4;var db=fb.node;let tb=fb.cpBegin;Pb=fb.cpEnd;let Xb=fb.Fb,$b=fb.Sb;const Ab=L.ParagraphReader.text(db),vc=Ab.length;let Sc=!1;if(tb===Pb){if(ya&&!tb||!ya&&tb===vc)return 2;ya?({cp:tb,returnValue:Sc}=this.Xf.tQi(db,tb),Sc||({cp:tb,rna:Xb,returnValue:Sc}=this.Xf.sQi(fb,tb,Xb)),Sc||(tb--,za.a.Lz(Ab,tb)&&tb--),Rb=ea.a.g4e):({cp:Pb,returnValue:Sc}=this.Xf.Sfn(db,
Pb),Sc||({cp:Pb,rna:$b,returnValue:Sc}=this.Xf.Rfn(fb,Pb,$b)),Sc||(Pb++,za.a.Lz(Ab,Pb)&&Pb++),Rb=ea.a.vRh)}fb=tb===Pb?X.a.Uc(db,tb):X.a.createTextRange(db,tb,Pb);Sc&&this.Xf.jh&&(ya?fb.Fb=Xb:fb.Sb=$b);if(!this.Xf.kec(fb))return 2;this.i2b(db);ya=new n.GraphTransaction(15);ya.Uj=Rb;ya.Db(db);db=Object(xa.a)(ia.a,uc)&&uc.k2a;if(!na.Qd.yg||db||va.a.vr&&na.KDa.b1d(T.a.instance.ib.lb))this.ORh(fb,Ec);else{db=na.Qd.Z_a();try{const ed=na.Fh.Qad(fb);let pd;if(({type:pd}=ed.tVd()).returnValue){const oc=Object(ka.a)(88,
uc);oc&&oc.ja(wa.a.NEf,!1)||!va.a.vr&&4===pd?na.Qd.K6a=pd:na.Qd.Zs(pd)}uc=0;for(let oc=ed.length-1;0<=oc;--oc){let cd;const Xc=({H1d:cd}=ed.getContext(oc)).returnValue;cd?(na.jp.vnb(Xc,null),uc+=na.Ej.rqb(Xc,2),na.Ej.mJd=Pb+uc):this.ORh(Xc,Ec)}}finally{db&&db.dispose()}}ya.dispose();return 32}i2b(){}static get Qd(){return null!=na.ZIg?na.ZIg:na.ZIg=k.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=na.LIg?na.LIg:na.LIg=k.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=
na.tJg?na.tJg:na.tJg=k.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get jp(){return null!=na.ABg?na.ABg:na.ABg=k.a.instance.resolve("Box4.IHyperlinkEditor")}static jx(){return na.en||(na.en=k.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Uga(){na.tvb||(na.tvb=k.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return na.tvb.instance}static get KDa(){return null!=na.cxg?na.cxg:na.cxg=k.a.instance.resolve("Box4.IContentControlViewElementManager")}}
na.en=null;na.tvb=null;Object(D.a)(na,"ADeleteParagraphContentStrategy",null,[]);var Ca=c(173),ta=c(822),fa=c(137),Xa=c(228),ob=c(78),xb=c(75),zb=c(83);class Lb extends na{constructor(){super()}get jg(){return null!=this.jxg?this.jxg:this.jxg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Xq(){return null!=this.$wg?this.$wg:this.$wg=k.a.instance.Sa("Box4.ContentControlConfigSettings")}get lgc(){return null!=this.XEg?this.XEg:this.XEg=k.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get FX(){return null!=
this.Jxg?this.Jxg:this.Jxg=k.a.instance.resolve("Box4.IContentControlChpHelper")}get oca(){return null!=this.jAg?this.jAg:this.jAg=k.a.instance.resolve("Box4.IFieldEditor")}ORh(Rb,fb){this.Mkl(Rb,fb)}dBk(Rb,fb,Pb,Ec){this.Xq.instance&&this.Xq.instance.jh&&(Rb.cpBegin===fb.cpBegin?Rb.Fb=fb.Fb:Pb&&(Rb.Fb=Pb.Jb&&Pb.Jb.length?0:-1),Rb.Sb=Ec)}i2b(Rb){const {DeleteActor:fb}=c(1621);fb.i2b(Rb)}Mkl(Rb,fb){var Pb=Rb.node;const Ec=Xa.b([new Ca.a(Rb.cpBegin,Rb.cpEnd)],this.Njm(Rb));var uc=new zb.a,ya=[];Lb.V0k(Pb,
Ec,uc,ya);for(const db of uc.keys)1<uc.J(db)&&ta.a.UTi(Aa.a.If(db));this.I_n(Pb,ya);this.lgc.XIc(Pb);Pb=Rb.Sb;uc=!!this.Xq.instance&&this.Xq.instance.jh;for(ya=Ec.length-1;0<=ya;ya--)Pb=this.deleteRange(Rb,Ec[ya],Pb,uc,fb)}Njm(Rb){const fb=[],Pb=Rb.node;var Ec=ob.f(Pb,db=>db.qna);for(var uc of Ec)Ec=uc.Lb.cp,fb.push(new Ca.a(Ec,Ec+1));uc=[];fa.a.fL?this.oca&&(uc=this.oca.arf(Pb,Rb)):uc=L.ParagraphReader.pQa(Pb);for(var ya of uc)this.JRm(ya,Rb)&&fb.push(ya);ya=!!this.Xq.instance&&this.Xq.instance.ypa;
this.Xq.instance&&this.Xq.instance.jh||!ya||!Pb.su||(Lb.AJh&&Lb.AJh.GZn(Rb),this.FX&&fb.push(...this.FX.Ppf(Pb).toArray()));return Xa.a(fb)}JRm(Rb,fb){return fa.a.fL?this.oca?!this.oca.pxi(Rb,fb):!1:!Rb.dL||!Lb.sFf(Rb,fb)}I_n(Rb,fb){const Pb=new xb.a;for(const Ec of fb)for(fb=0;fb<Ec.length;){fb=this.Xai(Ec,fb,0);if(-1===fb)break;let uc=this.Xai(Ec,fb+1,3);if(-1===uc)break;if(Ec.J(fb).dL)for(;uc>=fb;){const ya=Ec.J(uc);Pb.add(ya.pe);Ec.remove(ya);uc--}fb=uc+1}Rb.ara(Pb)}Xai(Rb,fb,Pb){for(;fb<Rb.length;fb++){const Ec=
Rb.J(fb);if(1===Ec.ZB&&Ec.vf===Pb)return fb}return-1}deleteRange(Rb,fb,Pb,Ec,uc){const ya=fb.Bc,db=fb.end;fb=null;Ec&&(fb=Rb.node.ra.nh(ya));ya<db&&(Ec=X.a.createTextRange(Rb.node,ya,db),this.dBk(Ec,Rb,fb,Pb),this.jg.Ge(Ec,"",void 0,void 0,ea.a.rHc,!1,uc));return Pb=fb&&fb.Jb&&fb.Jb.length?fb.Jb.length:-1}static get AJh(){return null!=Lb.Sxg?Lb.Sxg:Lb.Sxg=k.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static sFf(Rb,fb){return Rb.Bc>=fb.cpBegin&&Rb.end<=fb.cpEnd}static V0k(Rb,
fb,Pb,Ec){let uc=0;Rb=Rb.ra;for(const ya of fb)for(;uc<Rb.length;){fb=Rb.J(uc);if(fb.cp>=ya.Bc&&fb.cp<ya.end&&(fb.Hc&&fb.Hc.I5k&&Ec.push(fb.Hc),fb.$g))for(let db=0;db<fb.$g.length;db++){const tb=fb.$g.J(db).yn.toString();Pb.nb(tb)?Pb.Z(tb,Pb.J(tb)+1):Pb.Z(tb,1)}++uc}}}Object(D.a)(Lb,"DeleteParagraphContentStrategy",na,[]);class Ia{static get jH(){return Pa.a.instance}static Yll(Rb,fb,Pb){if(1===Pb)return 32;Rb=fb.node;return Ia.jH.rFd(Rb)?ua.vll(Rb,Pb):32}}Object(D.a)(Ia,"DeleteUnsupportedObjectStrategy",
null,[]);var Ya=c(174),eb=c(313),sb=c(192),lc=c(376),vb=c(7),Eb=c(1055),Ua=c(878),Ta=c(41),Nb=c(117),Wa=c(404),Bb=c(536),Ob=c(1644),hc=c(136),Gc=c(447),bc=c(856),Dc=c(169),Ub=c(142),Fc=c(206),Sa=c(511),wb=c(33),Tb=c(124);class Hb{constructor(Rb,fb,Pb,Ec,uc){this.a4o=Rb;this.x$=Pb;this.vd=Ec;this.actionId=fb;this.qed=uc}}Object(D.a)(Hb,"DeleteActionData",null,[]);var $a=c(1031);class ab{constructor(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb,$b){this.PRh=Rb;this.Xf=fb;this.jH=Pb;this.jp=Ec;this.z0=uc;this.Vi=ya;this.W0i=
db;this.jg=tb;this.Qd=Xb;this.KDa=$b}BNo(Rb){return!M.SelectionEditor.vl(Rb)&&!M.SelectionEditor.ada(Rb)}tem(Rb,fb,Pb){var Ec;let uc,ya,db;if(!fb&&Rb&&Rb.Zw&&(Ec=Rb.Pa)&&M.SelectionEditor.Ze(Ec)&&this.Vi.Xb(Ec.node)&&(uc=Ec.node.ra.nh(Ec.cpBegin))&&uc.Bm&&(ya=this.VRl(uc))&&ya.hyperlink.SG&&(db=this.hem(Rb,ya.cp)))return db;if(!Rb)return null;if(Ec=this.uRo(Rb,fb))return Ec;if(!Pb)return Rb;fb=M.SelectionEditor.NPa(Rb,!fb,{gC:!1,gt:!0,ZD:!0,QF:!0});return K.SelectionFactory.Iy(Rb,fb.Pa,!1)}VRl(Rb){const fb=
Rb.paragraph.ra;let Pb=null;Rb=Rb.cp;for(let Ec=0;Ec<fb.length;Ec++){const uc=fb.J(Ec);if(uc.cp>=Rb)break;uc.Bm&&(Pb=null);uc.hyperlink&&(Pb=uc)}return Pb}kem(Rb,fb){var Pb=Rb.Pa.node;if(fb){if(fb=M.SelectionEditor.UUa(Rb.Pa.node,Rb.Pa.cpBegin,!0),Rb=K.SelectionFactory.Iy(Rb,X.a.Uc(Rb.Pa.node,fb),!1),Pb=Pb.ra.nh(fb),Pb.K0||Pb.QU)Rb.Pa.Fb=0}else if(fb=M.SelectionEditor.UUa(Rb.Pa.node,Rb.Pa.cpBegin,!1),Rb=K.SelectionFactory.Iy(Rb,X.a.Uc(Rb.Pa.node,fb),!1),Pb=Pb.ra.nh(fb),Pb.K0||Pb.QU)Rb.Pa.Fb=Pb.Iw+
Pb.vN;Rb.$cc=!0;return Rb}uRo(Rb,fb){var Pb=Rb.Pa;let Ec=null;if(!Rb.Zw||!Pb||!M.SelectionEditor.Ze(Pb))return null;if(this.Vi.Xb(Pb.node)&&(Ec=fb?Pb.node.ra.nh(Pb.cpBegin):Pb.node.ra.ljb(Pb.cpBegin-1))&&Ec.NR)return this.kem(Rb,fb);Pb=t.GraphIterator.eb(Rb.Pa.node);if(!Pb.zb(8))return null;Q.OutlineElementNavigator.Yd(Pb);let uc=!1;const ya=[];if(fb?Ec&&Ec.Ph:0===Rb.Pa.cpBegin){do(Rb=fb?Q.OutlineElementNavigator.ns(Pb,!0,!0,!1):Q.OutlineElementNavigator.g1(Pb,!0,!0,!1))&&(null===Rb||void 0===Rb?
0:Rb.eRa)?(ya.push(X.a.create(Q.OutlineElementNavigator.Ee(Pb))),Q.OutlineElementNavigator.Yd(Pb)):uc=!0;while(!uc);if(0<ya.length)return fb=new Dc.Selection(fb?ya:ya.reverse(),fb),fb.$cc=!0,fb}return null}hem(Rb,fb){var Pb=M.SelectionEditor.fFa(Rb,{gC:!1,gt:!1,ZD:!0,QF:!0});if(!Pb||!Pb.Zw||Pb.Pa.node!==Rb.Pa.node)return null;Pb=Pb.Pa;if(Pb.cpBegin!==Pb.cpEnd)return null;const Ec=this.Vi.text(Pb.node);for(let uc=Pb.cpBegin-1;uc>=fb;uc--)if(!za.a.Pv(Ec.charCodeAt(uc)))return K.SelectionFactory.Iy(Rb,
X.a.Uc(Pb.node,uc+1),!1);return K.SelectionFactory.Iy(Rb,X.a.Uc(Pb.node,fb),!1)}Yef(Rb,fb,Pb,Ec,uc){var ya,db;if(1===Pb)return 32;(Pb=null===(db=null===(ya=fb.view)||void 0===ya?void 0:ya.mb)||void 0===db?void 0:db.qg)&&H.ContextSetEditor.instance.mQh(Pb).filter(L.ParagraphReader.PU).forEach(tb=>{var Xb;return null===(Xb=L.ParagraphReader.sQa(tb.node))||void 0===Xb?void 0:Xb.gie("delete_selection")});db=!1;Rb===ea.a.gdf?(Rb=ea.a.QH,db=!0):Rb===ea.a.iKd?(Rb=ea.a.backspace,db=!0):Rb===ea.a.Tva&&(fb=
new Bb.a(l.StaticActiveAppFrame.za().jb.rc));if(!fb.view.ue)return 2;Ub.GrippersManager.instance.kC(!1);ya=Rb===ea.a.QH;Pb=Fc.a.u$h(fb);if(db&&this.Xf.jh&&Pb&&M.SelectionEditor.Pl(Pb)&&this.Xf.GGf(Pb.Pa,!ya,!0))return 2;db=this.tem(Pb,ya,db);return this.$ll(Rb,fb,Ec,uc,db,ya)}$ll(Rb,fb,Pb,Ec,uc,ya){var db;const tb=fb.view,Xb=tb.mb;var $b=Ec,Ab=Ec;Rb===ea.a.Tva&&(Ab=$b=null,uc=new Dc.Selection(Ec,!0));if(!uc)return 32;const vc=this.Cso($b,ya);if(this.Xf.jh&&ab.Uga&&1===Xb.ib.length&&M.SelectionEditor.Pl(uc)&&
uc.Zw&&ab.Uga.ado(uc.Pa,ya)||fa.a.fL&&ab.oca&&1===Xb.ib.length&&M.SelectionEditor.Pl(uc)&&uc.Zw&&ab.oca.bdo(uc.Pa,ya))return 32;let Sc;ya?Ya.a.mark(Sc=5009):Ya.a.mark(Sc=5011);$b=new n.GraphTransaction(15);$b.Uj=Rb;$b.Db(tb.ed);let ed=null,pd=({Ebo:ed}=this.TTl(Rb,Ec,Xb,uc,ed)).returnValue;var oc=null;({Nje:oc}=H.ContextSetEditor.instance.nig(pd)).returnValue&&(pd=oc);if(!pd)return $b.dispose(),32;oc=!1;e.AFrameworkApplication.se("b1jb9393;09icj321");if(null===(db=e.AFrameworkApplication.K)||void 0===
db?0:db.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))db=pd.node,oc=null===db||void 0===db?void 0:db.su;const cd=new Hb(fb,Rb,Pb,Ab,oc);this.Xf.jh&&ab.Uga&&(Ab=H.ContextSetEditor.instance.uO(pd),ab.Uga.J$i(Ab));this.uBj(pd);const Xc=this.xQd(pd,uc,ya);let ic=null;ya?ic=new bc.a(uc):Xc&&(ic=new bc.a(Xc));let Ac=!1;Ab=ab.Hk;if(M.SelectionEditor.Ze(pd)){const wd=$a.a.v$b(tb.ed,vc);Ab.ie(()=>{this.Hkl(fb,Pb,Ec,pd,ya,ic,uc,wd,Xb,vc,cd,Xc)},"DVS:DAIPC")}else!this.Qd.yg||
va.a.vr&&this.KDa.b1d(uc)?Ab.ie(()=>{Ac=this.m2i(Rb,tb.ed,pd,Xb,vc,cd,ic,ed)},"DVS:PUD"):(Ab.ie(()=>{this.ANo(Rb,tb.ed,pd,ya,uc,Xb,vc,cd,ic)},"DVS:TCDC"),Ac=!0);this.AGl(Xb);this.Mej(pd);$b.dispose();Ya.a.mark(Sc+1);return Rb===ea.a.Tva?Ac?32:8:32}m2i(Rb,fb,Pb,Ec,uc,ya,db,tb){fb=$a.a.v$b(fb,uc);this.BNo(Pb)&&fb.f9a(Pb);Rb=ab.Ic.Fp(Rb);Rb.properties.Z("CountOfParagraphsDeleted",this.Vi.Paf(Pb).toString());Pb=this.mql(Pb,Ec,uc,fb,ya,db,tb);Rb.end();return Pb}ANo(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb){var $b=0,
Ab=null;const vc=H.ContextSetEditor.instance.uO(Pb),Sc=vc[vc.length-1];if(Sc.contextId===oa.a.paragraph||Sc.contextId===oa.a.Vc){var ed=t.GraphIterator.eb(Sc.node);ed.od();Q.OutlineElementNavigator.Yd(ed);Q.OutlineElementNavigator.ns(ed,!0,!1)&&(Ab=Q.OutlineElementNavigator.Ee(ed))&&($b=this.Vi.textLength(Ab))}else $b=this.Vi.textLength(Sc.node)-Sc.cpEnd;ed=Object(ka.a)(88,tb.vd);if(ed=!!ed&&ed.ja(wa.a.NEf,!1))this.k2i(Rb,fb,Pb,ya,db,tb,Xb,!1,ed);else{ed=this.Qd.Z_a();try{this.k2i(Rb,fb,Pb,ya,db,
tb,Xb,!0)}finally{ed&&ed.dispose()}}if(uc.$cc)$b=this.xQd(Pb,uc,Ec),this.Vi.Xb($b.Pa.node)&&T.a.instance.Ac($b);else{if(Ec){if(Pb.lx){Rb=vc.length-1;do uc=vc[Rb],Rb--;while(!uc.node.isConnected&&0<=Rb)}else uc=Pb;if(!this.Vi.Xb(uc.node))return;switch(Sc.contextId){case oa.a.paragraph:case oa.a.Vc:$b=Ab&&Ab.isConnected?0:$b;break;case oa.a.Tc:case oa.a.Fd:break;default:$b=0}$b=K.SelectionFactory.ne(uc.node,this.Vi.textLength(uc.node)-$b);uc.Wj===$b.Pa.cpBegin&&($b.Pa.Fb=uc.Fb)}else{$b=uc.Pa.node;if(!this.Vi.Xb($b))return;
Ab=uc.Pa.contextId===oa.a.paragraph?0:uc.Pa.contextId===oa.a.Vc?this.Vi.textLength($b):uc.Pa.cpBegin;$b=K.SelectionFactory.ne($b,Ab)}T.a.instance.Ac($b)}}k2i(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb=!1){Pb=this.WKl(Ec,Pb);Pb=ab.Fh.Qad(Pb);({type:Ab}=Pb.tVd()).returnValue&&(tb&&4!==Ab?this.Qd.Zs(Ab):va.a.vr||(this.Qd.K6a=Ab));for(tb=Pb.length-1;0<=tb;--tb){var $b=void 0;var Ab=({H1d:$b}=Pb.getContext(tb)).returnValue;$b?($b=Xb&&Ab.contextId===oa.a.Vc&&tb===Pb.length-1,this.jp.vnb(Ab,2),$b||ab.Ej.rqb(Ab,2)):this.m2i(Rb,
fb,Ab,Ec,uc,ya,db,null)}}WKl(Rb,fb){if(Object(xa.a)(Wa.a,fb)){Rb=Gc.OutlineElementGeneralizer.Cha(Rb.ib,!0);for(let Pb=0;Pb<Rb.length;Pb++)if(Rb.getContext(Pb).contextId===oa.a.table)return Rb}return fb}TTl(Rb,fb,Pb,Ec,uc){Rb===ea.a.Tva?(Rb=eb.a.rEa(fb),uc=Sa.SelectionReferenceFactory.instance.xDb()):(uc=null,Rb=1===Pb.ib.length?T.a.sDb(Ec):Pb.qg);return{returnValue:Rb,Ebo:uc}}eTk(Rb){return!Rb.al||Rb.contextId!==oa.a.paragraph||!this.Vi.Xb(Rb.node)||this.Qd.yg||this.Xf.C0d(Rb)?!1:!0}uBj(Rb){if(Rb.lx)for(let fb=
0;fb<Rb.length;fb++)this.uBj(Rb.getContext(fb));else this.eTk(Rb)&&(Rb.node.sFd=!0)}Mej(Rb){if(Rb.lx)for(let fb=0;fb<Rb.length;fb++)this.Mej(Rb.getContext(fb));else Rb.al&&(Rb=Rb.node)&&this.Vi.Xb(Rb)&&(Rb.sFd=!1)}xQd(Rb,fb,Pb){if(Rb.al&&M.SelectionEditor.Ze(Rb)&&!Pb){const Ec=Rb.node;let uc=Rb.cpBegin,ya=-1;if(({cp:uc}=this.Xf.tQi(Ec,uc)).returnValue)return K.SelectionFactory.ne(Ec,uc);if(({cp:uc,rna:ya}=this.Xf.sQi(Rb,uc,ya)).returnValue)return fb=K.SelectionFactory.ne(Ec,uc),fb.Pa.Fb=ya,fb.Pa.Sb=
ya,fb}fb=M.SelectionEditor.NPa(fb,!Pb,{gC:!fb.$cc||fb.Zw,gt:!1,ZD:!1,QF:!0,fva:M.SelectionEditor.Pl(fb)});this.Xf.jh&&M.SelectionEditor.vl(Rb)&&(fb.Pa.Sb=fb.Pa.Fb=Pb?Rb.Sb:Rb.Fb);return fb}Hkl(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb,$b,Ab,vc){const Sc=ab.Hk;!M.SelectionEditor.KA(Ec.node,Ec,uc)||this.Xf.jh&&this.Xf.Yyi(Ec)?Sc.ie(()=>{this.nll(Ec,uc,ya,db,tb,Xb,$b,Ab)},"DVS:IPM"):Sc.ie(()=>{const {response:ed,pZ:pd}=this.mll(Rb,fb,Pb,Ec,uc,db,tb,Xb,Ab,vc);ab.qSi(tb,32===ed);pd&&ab.fra(Xb,ya)},"DVS:ISE")}Xpm(Rb,
fb){hc.a.GY&&(fb.vd||(fb.vd=new y.DictionaryPropertySet),fb.vd.setValue(wa.a.eqa,"delete"),fb.vd.setValue(wa.a.Mia,"backspace"));var Pb=Rb.ND;const Ec=ab.Jd.gY(Pb),uc=Ob.a.U_m;if(null===uc||void 0===uc?0:uc.STm(Pb,Ec)){hc.a.GY&&fb.vd.setValue(wa.a.Mia,"backspace-autocorrect");Pb=uc.dCj+" ";const ya=X.a.Uc(Rb,0);this.jg.Ge(ya,Pb);Rb=K.SelectionFactory.ne(Rb,Pb.length);T.a.instance.Ac(Rb);vb.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",uc.dCj)}return e.AFrameworkApplication.va.Mf(fb.a4o,
Ec.Mz?ea.a.ML:ea.a.qD,2,!1,fb.x$,fb.vd)}upm(Rb,fb,Pb,Ec,uc){let ya=!1;0<this.W0i.o0(Rb).Xt&&(uc=e.AFrameworkApplication.va.Mf(fb,ea.a.zjc,2,!1,Pb,Ec),ya=!0);return{EU:ya,response:uc}}Bpm(Rb,fb,Pb,Ec,uc){let ya=!1;0<this.W0i.JG(Rb).Xt&&(uc=e.AFrameworkApplication.va.Mf(fb,ea.a.X6c,2,!1,Pb,Ec),ya=!0);return{EU:ya,response:uc}}Iqm(Rb,fb,Pb,Ec,uc){let ya=!1;ab.qq.jCb(Rb)&&(uc=e.AFrameworkApplication.va.Mf(fb,ea.a.bH,2,!1,Pb,Ec),ya=!0);return{EU:ya,response:uc}}com(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb,$b){const Ab=
new Nb.a;Ab.kd(fb);let vc=!1;if(Q.OutlineElementNavigator.wHa(Ab,!1,!Rb,!1)){$b=!0;Xb=32;vc=!0;(new t.GraphIterator).kd(Ab);Q.OutlineElementNavigator.Ee(Ab);const ed=Ab.currentNode;L.ParagraphReader.wva(ed)&&L.ParagraphReader.sQa(ed).gie("delete_ip");var Sc=new t.GraphIterator;Sc.set(db);(Sc=this.Vi.isEmpty(Sc))&&uc&&M.SelectionEditor.v9(uc.Pa)?(Pb.f9a(ya),Q.OutlineElementNavigator.Ee(fb),ab.Pf.mza(fb.currentNode)):ed.KJ?(Pb.f9a(ya),Q.OutlineElementNavigator.Yd(Ab),Ab.tg()):Rb&&Sc?this.Xf.vBi(db)&&
!({pZ:$b}=this.$4i(Rb,db,ed,uc,$b)).returnValue&&(Pb.f9a(ya),ab.Zm.$da(fb),this.PRh.$Gn(db),fb.tg()):wb.TableReader.isTable(Ab)?(Pb.f9a(ya),Rb&&(ba.moveToFirstRow(Ab),ba.moveToFirstColumn(Ab),N.OutlineNavigator.S9(Ab),Q.OutlineElementNavigator.Ee(Ab),tb.Ac((new bc.a(K.SelectionFactory.ne(Ab.currentNode,0))).restore())),Xb=2,$b=!1):this.Vi.Xb(ed)&&(1==this.Vi.textLength(ed)&&(tb=ob.e(ed),1==tb.length&&8==tb[0].vh&&(tb=X.a.createTextRange(ed,0,1),this.jg.Ge(tb,"",void 0,void 0,ea.a.rHc))),({pZ:$b}=
this.$4i(Rb,db,ed,uc,$b)).returnValue||(Ec.actionId==ea.a.backspace&&Pb.moc(db),this.PRh.Ikl(Rb,Pb,ya,fb,db,Ab)))}return{EU:vc,response:Xb,pZ:$b}}$4i(Rb,fb,Pb,Ec,uc){if(this.Qd.yg){if(ab.xva){const ya=Object(xa.a)(Tb.AParagraphNode,Pb)?ab.xva.MXc(Pb):!1,db=Object(xa.a)(Tb.AParagraphNode,fb)?ab.xva.MXc(fb):!1;if(ya!==db)return{returnValue:!1,pZ:uc};if(!va.a.vr&&db)return this.Xf.jh&&ab.AHk(fb,Pb,Rb)&&this.Qd.Zs(4),{returnValue:!1,pZ:uc}}Rb=Rb?fb:Pb;if(!Object(xa.a)(Tb.AParagraphNode,Rb))return{returnValue:!1,
pZ:uc};fb=Rb.ra.last;Pb=e.AFrameworkApplication.userName;if(!fb.zi||fb.zi.authorName!==Pb)return ab.Ej.MQb(Rb,2),Ec&&(T.a.instance.Ac(Ec),uc=!1),{returnValue:!0,pZ:uc}}return{returnValue:!1,pZ:uc}}Qpm(Rb,fb,Pb,Ec,uc,ya,db,tb){Ta.OutlineElementReader.zNm(fb,Rb)||({response:db,pZ:tb}=ab.hrl(Pb,Ec,Rb,ya,uc,db,tb));return{EU:!1,response:db,pZ:tb}}mll(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb,$b){let Ab=!1,vc=2;const Sc=Ec.node;let ed=void 0,pd=!1;const oc=ab.Hk;if(!uc){if(Sc.ND)return oc.ie(()=>{vc=this.Xpm(Sc,Xb)},
"DVS:HLOE"),{response:vc,pZ:Ab};oc.ie(()=>{({response:vc,EU:pd}=this.upm(Sc,Rb,fb,Pb,vc))},"DVS:HIOD");if(pd)return{response:vc,pZ:Ab};oc.ie(()=>{({response:vc,EU:pd}=this.Bpm(Sc,Rb,fb,Pb,vc))},"DVS:HWPF");if(pd)return{response:vc,pZ:Ab};ed=this.Dbi(Sc);oc.ie(()=>{({response:vc,EU:pd}=this.Iqm(ed,Rb,fb,Pb,vc))},"DVS:HPOB");if(pd)return{response:vc,pZ:Ab}}null!==ed&&void 0!==ed?ed:ed=this.Dbi(Sc);oc.ie(()=>{({response:vc,EU:pd,pZ:Ab}=this.com(uc,ed,db,Xb,$b,Ec,Sc,tb,vc,Ab))},"DVS:HAOE");if(pd)return{response:vc,
pZ:Ab};oc.ie(()=>{({response:vc,EU:pd,pZ:Ab}=this.Qpm(uc,ed,fb,Pb,db,ya,vc,Ab))},"DVS:HFLOE");return{response:vc,pZ:Ab}}Mso(Rb){return M.SelectionEditor.vl(Rb)||this.jH.IEi(Rb)||M.SelectionEditor.ada(Rb)}Cso(Rb,fb){return Rb&&Rb.hasProperty(v.a.BMc)?!Rb.ja(v.a.BMc,!1):!fb}static get Jd(){return null!=ab.GEg?ab.GEg:ab.GEg=k.a.instance.resolve("Box4.List.IListReader")}static get Zm(){return null!=ab.xEg?ab.xEg:ab.xEg=k.a.instance.resolve("Box4.List.IListEditor")}static get Pf(){return null!=ab.vFg?
ab.vFg:ab.vFg=k.a.instance.resolve("Box4.IOutlineElementEditor")}static get qq(){return Eb.a.TGb}static get Ej(){return null!=ab.OIg?ab.OIg:ab.OIg=k.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Fh(){return null!=ab.wJg?ab.wJg:ab.wJg=k.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ic(){return sb.a.instance}static get Uga(){ab.tvb||(ab.tvb=k.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return ab.tvb.instance}static get oca(){ab.Bnf||
(ab.Bnf=k.a.instance.Sa("Box4.IFieldEditor"));return ab.Bnf.instance}static get xva(){return null!=ab.Xxg?ab.Xxg:ab.Xxg=k.a.instance.Oa("Box4.IContentControlReader")}static get Hk(){return lc.a.instance}AGl(Rb){if(1===Rb.ib.length&&(Rb=Rb.ib.J(0),M.SelectionEditor.Pl(Rb))){var fb=Rb.Pa;Rb=fb.node;fb=fb.cpBegin;var Pb=this.Vi.text(Rb);fb<Pb.length&&0<fb&&" "===Pb.charAt(fb-1)&&" "===Pb.charAt(fb)&&this.jg.Ge(X.a.createTextRange(Rb,fb-1,fb),"\u00a0")}}VJk(Rb,fb){if(!fb.hyperlink.K4a){const Pb=new n.GraphTransaction(15);
try{Pb.Db(Rb.node),this.z0.jS(Rb,fb)}finally{Pb&&Pb.dispose()}fb.hyperlink.SG&&this.Qd.Zs(2)}}static hrl(Rb,fb,Pb,Ec,uc,ya,db){if(Pb=M.SelectionEditor.NPa(Ec,!Pb,{gC:!1,gt:!1,ZD:!1,QF:!0})){Ec=K.SelectionFactory.Iy(Ec,Pb.Pa);ya=32;for(Pb=0;Pb<Ec.length;++Pb){uc.f9a(Ec.J(Pb));const tb=e.AFrameworkApplication.va.Mf(Ec.J(Pb),ea.a.QH,2,!0,Rb,fb);2!==tb&&(ya=tb)}32===ya&&(db=!0)}return{response:ya,pZ:db}}mql(Rb,fb,Pb,Ec,uc,ya,db){let tb=!1;this.Nso(Rb)?(tb=ab.qgf(Rb,!0,fb,Pb,Ec,uc))&&ab.dKa(ya,fb,db):
this.Mso(Rb)?(tb=ab.qgf(Rb,!1,fb,Pb,Ec,uc))&&ab.dKa(ya,fb,db):(Ec.normalize(),ab.dKa(ya,fb,db));return tb}static dKa(Rb,fb,Pb){Pb&&Pb.fra()||ab.fra(fb,Rb)}static qgf(Rb,fb,Pb,Ec,uc,ya){var db;Ec||O.OutlineReader.ORa(Rb)||(Pb=ab.mdd(Pb))&&uc.Yoo(Pb);e.AFrameworkApplication.se("b1jb9393;09icj321");if(null===(db=e.AFrameworkApplication.K)||void 0===db?0:db.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ya.vd?ya.vd.qed=ya.qed:ya.vd={qed:ya.qed};db=Rb instanceof Wa.a?
Rb.getContext(0).node:Rb.node;db=ab.r8l(db);Rb=32===e.AFrameworkApplication.va.Mf(Rb,ya.actionId,2,fb,ya.x$,ya.vd);ab.qSi(uc,Rb,db);return Rb}static get rn(){return null!=ab.UAg?ab.UAg:ab.UAg=k.a.instance.resolve("Box4.IFormattingEditor")}static get eVa(){return null!=ab.GHg?ab.GHg:ab.GHg=k.a.instance.resolve("Box4.Styles.IWACStyleReader")}static r8l(Rb){const fb=new Ua.a;if(Rb){let Pb=null;Rb=K.SelectionFactory.Eo(Rb,!0);if(!Rb)vb.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let Ec=
0;Ec<Rb.length;Ec++)if(S.FormattingReader.J$e(Rb.J(Ec))){Pb=Rb.J(Ec);break}Pb&&((Rb=S.FormattingReader.Xr(Pb))&&Rb.cache&&Rb.cache.UB&&(Rb=Rb.wf(null),ab.rn.G5(Rb)),Rb&&(fb.formatting=Rb.Xj,fb.languageId=S.FormattingReader.language(Rb)),fb.Rka=ab.eVa.hp(Pb.node))}return fb}static qSi(Rb,fb,Pb){fb?Rb.normalize(Pb):Rb.cancel()}static fra(Rb,fb){fb&&ab.Hk.ie(()=>{const Pb=fb.restore();Pb&&Rb.Ac(Pb)},"DVS:RS")}nll(Rb,fb,Pb,Ec,uc,ya,db,tb){let Xb;!fb&&({hyperlink:Xb}=this.z0.ldc(Rb)).returnValue?(Pb=new bc.a(Ec),
this.VJk(Rb,Xb),uc.normalize(),ab.fra(ya,Pb)):ab.qgf(Rb,!1,ya,db,uc,tb)&&(fb&&this.Qd.yg?(fb=ab.Ej.mJd)?(ya.Ac(K.SelectionFactory.ne(Rb.node,fb)),ab.Ej.mJd=null):ab.fra(ya,Pb):ab.fra(ya,Pb))}static AHk(Rb,fb,Pb){Pb?(Pb=Rb,Rb=fb):Pb=fb;fb=ab.xva.Gdc(Pb,!1);Rb=ab.xva.Gdc(Rb,!0);return!(fb&&Rb)}Nso(Rb){return Rb.lx||O.OutlineReader.ORa(Rb)||this.Vi.um(Rb)}static mdd(Rb){return(Rb=Gc.OutlineElementGeneralizer.Cha(Rb.ib,!0))&&1===Rb.length&&(Rb=Rb.getContext(0).node,wb.TableReader.LR(Rb))?Rb:null}Dbi(Rb){const fb=
new t.GraphIterator;fb.set(Rb);fb.od();Q.OutlineElementNavigator.Yd(fb);return fb}}ab.tvb=null;ab.Bnf=null;Object(D.a)(ab,"ADeleteViewStrategy",null,[]);class rb{Ikl(Rb,fb,Pb,Ec,uc,ya){const db=ya.currentNode;Q.OutlineElementNavigator.Yd(ya);Rb?(fb.moc(ya.currentNode),rb.Xf.iAi(Pb,uc,db,!1)||rb.Pf.merge(Ec,ya,!1,!1)):rb.Xf.iAi(Pb,db,uc,!0)||rb.Pf.merge(ya,Ec,!1,!1)}$Gn(Rb){Rb&&L.ParagraphReader.Xb(Rb)&&(Na.a.R6c(Rb),rb.Ztl.h1e(Rb))}static get Pf(){return null!=rb.qFg?rb.qFg:rb.qFg=k.a.instance.resolve("Box4.IOutlineElementEditor")}static get Ztl(){return null!=
rb.Jyg?rb.Jyg:rb.Jyg=k.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Xf(){return Fa.a.instance}}Object(D.a)(rb,"DeleteParagraphNodeStrategy",null,[627]);class cb extends ab{constructor(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb){super(new rb,Rb,fb,Pb,Ec,uc,ya,db,tb,Xb)}}Object(D.a)(cb,"DeleteViewStrategy",ab,[]);c.d(J,"DeleteActor",function(){return rc});class rc extends ua{constructor(Rb,fb,Pb,Ec,uc,ya,db,tb,Xb,$b,Ab,vc){super();this.deleteParagraph=(Sc,ed)=>{Sc=ed.node;Na.a.R6c(Sc);this.kAe.h1e(Sc);
this.Bn&&this.Bn.instance&&this.Bn.instance.qXi(Sc);Sc.su&&(this.jm.FZn(Sc,!this.jh),this.jh&&this.fXg.instance&&this.fXg.instance.NFj(Sc));return 0};this.bLd=(Sc,ed,pd)=>{2==pd&&(Sc=e.AFrameworkApplication.breadcrumbFolderUrl,Sc&&0!=Sc.length||(Sc=e.AFrameworkApplication.breadcrumbBrandUrl),sa.App.vFb(Sc));return 32};this.Gkl=(Sc,ed,pd)=>{({DeleteActor:Sc}=c(1621));if(1===pd)return 32;pd=l.StaticActiveAppFrame.za().Kq.Yf("ModelUpdate","DeleteAnchoredObject");ed=ed.node;const oc=new t.GraphIterator;
oc.set(ed);oc.zb(12);const cd=oc.jo(12);if(Fa.a.instance.KXc(cd))return 2;Sc.i2b(cd);Sc=new n.GraphTransaction(7);Sc.Db(ed);oc.tg();Sc.dispose();pd.stop();return 32};this.$0j=new Lb;this.a1j=new cb(Fa.a.instance,Pa.a.instance,ya,db,tb,Xb,$b,Ab,vc);this.jm=Rb;this.Yvc=fb;this.fXg=Pb;this.kAe=Ec;this.Bn=uc}get jh(){return this.Yvc.instance?this.Yvc.instance.jh:!1}get YRh(){return this.a1j}get NRh(){return this.$0j}h7f(Rb,fb,Pb,Ec){const uc=Ia.Yll,ya=this.Gkl;Rb.qa(ea.a.backspace,oa.a.W7,ya);Rb.qa(ea.a.backspace,
oa.a.unsupportedObject,uc);Rb.qa(ea.a.QH,oa.a.W7,ya);Rb.qa(ea.a.QH,oa.a.unsupportedObject,uc);Rb.qa(ea.a.backspace,oa.a.paragraph,this.deleteParagraph);Rb.qa(ea.a.QH,oa.a.paragraph,this.deleteParagraph);Rb.qa(ea.a.Tva,oa.a.paragraph,this.deleteParagraph);Rb.qa(ea.a.bLd,oa.a.view,this.bLd);Rb.Xc(ea.a.Tva,64);super.h7f(Rb,fb,Pb,Ec)}static i2b(Rb){var fb;(null===(fb=sa.App.zd)||void 0===fb?0:fb.Uo)&&sa.App.zd.fq.iG(Rb)}}Object(D.a)(rc,"DeleteActor",ua,[])},1622:function(D,J,c){c.r(J);D=c(0);var l=c(7),
e=c(1465),a=c(1634),k=c(927),x=c(1567);class y{constructor(za){this.Pbk=za}initialize(){return Promise.resolve(0)}f3d(){return Promise.resolve(0)}RV(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.Pbk}))}Ane(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ile(){return!1}fSc(){return"MockAuthTokenStrategy"}}
Object(D.a)(y,"MockAuthTokenStrategy",null,[407]);var n=c(1678);class t{static get(za,xa,ka){if(!ka)return za;let wa=0;return Promise.race([za,new Promise(ia=>{wa=window.setTimeout(()=>{ia(xa)},ka)})]).then(ia=>{window.clearTimeout(wa);return Promise.resolve(ia)}).catch(()=>{window.clearTimeout(wa);return Promise.resolve(xa)})}}Object(D.a)(t,"PromiseWithTimeout",null,[]);var z=c(2),v=c(468);class I{constructor(za,xa,ka,wa,ia){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=za;this.scope=xa;this.silentLogin=ka;this.options=wa;this.correlationId=ia}}Object(D.a)(I,"TokenRequestParameters",null,[410]);var E=c(20),H=c(22);class M{constructor(){this.Amh=null;let za=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Fka),xa=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Nne);this.R0b=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",za&&""!==za?za:"Unspecified",xa&&""!==xa?xa:"Unspecified")}initialize(){return new Promise(za=>
{H.a.instance.Sa("Common.App.WopiIdentity.IWopiIdentity").execute(xa=>{this.Amh=xa;za(0)})})}fe(za){const xa=["HTTPS:","API:"];let ka=!1;const wa=za.toLocaleUpperCase();for(const ia of xa)if(wa.startsWith(ia)){ka=!0;break}return ka||this.yOm(za)?za+"/.default":za}yOm(za){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(za)}f3d(){return Promise.resolve(0)}RV(za,xa,ka,wa,ia,va,na){if(E.a.ZRa){ia=v.OAuthManagerSettings.B4o;if(!ia)return xa=Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(xa);if(!Array.contains(ia,za))return xa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+za}),Promise.resolve(xa)}za=this.fe(ka);ka=new I(ka,za,!wa,null,z.AFrameworkApplication.userSessionId);return this.Amh.getAccessToken(ka,xa,na).then(Ca=>Object.assign(new x.a,{IsSuccess:!0,Token:Ca.accessToken}),Ca=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Ca}))}Ane(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ile(){return!1}fSc(){return this.R0b}}Object(D.a)(M,"ParentFrameTokenStrategy",null,[407]);var K=c(55),L=c(763),S=c(75);class Q{constructor(){this.reject=this.resolve=null;this.startTime=0;this.z5i=this.mxh=null}}Object(D.a)(Q,"PromiseWrapper",null,[]);class N{constructor(za=0){this.py=0;this.oBc=!1;this.yy=new S.a;this._timeout=za}enqueue(za){return new Promise((xa,
ka)=>{this.yy.add(Object.assign(new Q,{z5i:za,resolve:xa,reject:ka}));this.process()})}process(){if(this.oBc||this.py===this.yy.count)return!1;const za=this.yy.J(this.py++);try{this.oBc=!0,za.z5i().then(xa=>{this.oBc=!1;this.c$e(za,xa,null,!0)}).catch(xa=>{this.oBc=!1;this.c$e(za,null,xa,!1)})}catch(xa){this.oBc=!1,this.c$e(za,null,xa,!1)}return!0}c$e(za,xa,ka,wa){if(wa){const ia=()=>{za.resolve(xa);this.process()};0<this._timeout?window.setTimeout(()=>{ia()},this._timeout):ia()}else{const ia=()=>
{za.reject(ka);this.process()};0<this._timeout?window.setTimeout(()=>{ia()},this._timeout):ia()}}}Object(D.a)(N,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=null}}Object(D.a)(O,"ResolveWithCorrelation",null,[]);var X=c(69),U=c(156),T=c(957),Y=c(87);class aa extends U.a{constructor(za,xa,ka,wa,ia,va){super(!1,!1,!0);this.QSg=this.iBa=null;this.bua=za;this.ngk=ka;this.Qq=wa;this.Pnk=ia;this.kwb=va;this.BH=document.createElement("iframe");this.BH.id="SharedAuthInteractiveFrame";
this.BH.setAttribute("name","SharedAuthInteractiveFrame");this.BH.setAttribute("title","SharedAuthInteractiveFrame");this.BH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.BH.style.border="0";this.BH.style.height="48px";this.BH.style.width="190px";$addHandler(this.BH,"error",Object(K.a)(this,this.cvn,"onSharedAuthFrameError"));za=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.bua,xa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",z.AFrameworkApplication.userType);this.BH.src=za;this.j1j=new Promise(na=>{this.QSg=na});this.RSg=!1}RUa(){this.iBa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ngk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(K.a)(this,this.gbl,"createFrame"),["resolveDialogStyles"]:this.QSg}};this.Cd=5;this.Uh(CommonUIStrings.l_SignIn,Object(K.a)(this,this.Cro,"sharedAuthConsentDialogHandler"),
this.iBa)}UHj(za=!1,xa=5){this.iBa&&this.iBa.bodyControls&&(!0!==Object(X.a)(Object,this.iBa.bodyControls).frameLoaded&&(Object(X.a)(Object,this.iBa.bodyControls).frameLoaded=!0),za!==Object(X.a)(Object,this.iBa.bodyControls).frameLoadSuccess&&(Object(X.a)(Object,this.iBa.bodyControls).frameLoadSuccess=za),xa!==this.iBa.dialogButtonsOption&&(this.iBa.dialogButtonsOption=null,this.Cd=xa),this.update(this.iBa))}Syo(za,xa){const ka=new T.a(Y.a.Gro);ka.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:za,["dialogStyles"]:xa};this.Qq.vUa(ka,this.BH.contentWindow,this.bua)}Y2h(){this.UHj(!1,6)}get Kpj(){return this.BH}get lol(){return this.j1j.then(za=>{this.RSg=!0;return za})}get mol(){return this.RSg}cvn(){this.Y2h()}gbl(){return this.BH}Cro(za){0===za&&(this.Pnk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.kwb(null))}}
Object(D.a)(aa,"SharedAuthConsentDialog",U.a,[409]);var ba=c(975),oa=c(86),ma=c(154),ea=c(40),ua=c(139),sa=c(123);class Fa{constructor(){this.BH=null;this.Qnd=0;this.sZb=this.A1b=this.tue=this.kwb=this.mba=this.ykh=null;this.Qq=new ba.a(null,null);this.R0b="SharedAuthTokenStrategy Unloaded";this.bua=v.OAuthManagerSettings.Ero;this.Bgh=v.OAuthManagerSettings.Dro;this.uUg=v.OAuthManagerSettings.enableConsoleLogging;this.t2j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.Vkk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.Kok=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.pdb={};this.R7j=new N(1500)}fSc(){return this.R0b}initialize(){var {OAuthManager:za}=c(1622);if("loadFrame"in this.pdb)return this.pdb.loadFrame.mxh;if(!this.bua)return oa.Health.instance.recordKpiFailure(za.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);za=this.Lke("loadFrame");this.Qnd=ea.a.$e();var xa=this.bua+this.Bgh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.Kok&&(xa+="&webworker=1");this.BH=document.createElement("iframe");this.YBf(this.BH);this.BH.style.cssText="height:0;width:0;display:none;";this.BH.id=
"SharedAuthFrame";this.BH.setAttribute("name","SharedAuthFrame");this.BH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.BH.setAttribute("title","SharedAuthFrame");this.BH.src=xa;document.body.appendChild(this.BH);xa=ea.a.$e()-this.Qnd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",xa,this.BH.src);return za}f3d(za){this.tue=za;const xa=new T.a(Y.a.Npj);xa.Values=this.Twh(za);
za=this.Lke("initFrame");this.Qq.vUa(xa,this.BH.contentWindow,this.bua);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return za}RV(za,xa,ka,wa,ia,va){const na=new T.a(Y.a.Hro),Ca=this.ugi();na.Values=this.cDj(za,xa,ka,wa,ia,va,Ca);za=this.Lke(Ca);wa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.R7j.enqueue(()=>new Promise(ta=>{this.vQo(va,na,ta,Ca)})):(this.Qq.vUa(na,this.BH.contentWindow,
this.bua),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",xa));return za}vQo(za,xa,ka,wa){const ia=this.pdb[wa];ia&&(this.A1b=xa,this.kwb=Object.assign(new O,{resolve:ka,correlationId:wa}),this.mba=new aa(this.bua,this.Bgh,za,this.Qq,ia,ka),this.mba.RUa())}ugi(){return ua.a.create().toString()}cDj(za,xa,ka,wa,ia,va,na){const Ca={};Ca.appName=za;Ca.appId=xa;Ca.target=ka;Ca.withPopup=wa;Ca.claims=ia;Ca.promptMessage=va;Ca.messageCorrelationId=
na;return Ca}YBf(za){$addHandler(za,"load",Object(K.a)(this,this.eqn,"onIFrameLoaded"));$addHandler(za,"error",Object(K.a)(this,this.Rnb,"onIFrameError"));this.Qq.yba(this.bua);this.Qq.Gv(Y.a.Qpj);this.Qq.eC(Y.a.Qpj,Object(K.a)(this,this.Dun,"onScriptLoaded"));this.Qq.Gv(Y.a.Ppj);this.Qq.eC(Y.a.Ppj,Object(K.a)(this,this.Cun,"onScriptInitialized"));this.Qq.Gv(Y.a.Lpj);this.Qq.eC(Y.a.Lpj,Object(K.a)(this,this.Fpn,"onGetTokenResponse"));this.Qq.Gv(Y.a.Rpj);this.Qq.eC(Y.a.Rpj,Object(K.a)(this,this.mrn,
"onLoginResponse"));this.Qq.Gv(Y.a.Opj);this.Qq.eC(Y.a.Opj,Object(K.a)(this,this.Fqn,"onInteractiveFlowReady"));this.Qq.Gv(Y.a.Mpj);this.Qq.eC(Y.a.Mpj,Object(K.a)(this,this.Ppn,"onHideDialog"));this.Qq.Gv(Y.a.Jpj);this.Qq.eC(Y.a.Jpj,Object(K.a)(this,this.lWf,"onCloseDialog"))}Lke(za){const xa=new Q;xa.startTime=ea.a.$e();const ka=new Promise((wa,ia)=>{xa.resolve=wa;xa.reject=ia});xa.mxh=ka;this.pdb[za]=xa;return ka}eqn(){const za=ea.a.$e()-this.Qnd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
za)}Rnb(za){const {OAuthManager:xa}=c(1622),ka=ea.a.$e()-this.Qnd,wa=Object.assign(new sa.a,{durationMs:ka});oa.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,wa);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ka,this.uUg?JSON.stringify(za):"")}Dun(za){const {OAuthManager:xa}=c(1622),ka=this.pdb.loadFrame;var wa=ea.a.$e()-ka.startTime,ia=za.Values.AuthLibrary.toString();za=za.Values.Success.toString();l.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",za,ia,wa);ia&&(this.R0b="SharedAuthTokenStrategy "+ia);ia=Boolean.parse(za);ia||(za=ma.a.wG(),void 0!==za&&null!==za&&(za.set("AuthLibrary",this.fSc()),wa=Object.assign(new sa.a,{durationMs:wa,extendedProperties:za}),oa.Health.instance.recordKpiFailure(xa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,wa)));ka.resolve(ia?0:1)}Cun(za){if(za.Values.interactive&&this.A1b&&this.A1b.Values.messageCorrelationId){const ka=
this.A1b.Values.messageCorrelationId.toString();if(za.Values.interactive&&this.mba){this.mba.lol.then(wa=>{this.Qq.vUa(this.A1b,this.mba.Kpj.contentWindow,this.bua);this.mba.Syo(ka,wa);this.mba.UHj(!0);this.A1b=null});return}}za=this.pdb.initFrame;const xa=ea.a.$e()-za.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",xa);za.resolve(0)}Fpn(za){if(za.Values.messageCorrelationId&&za.Values.messageCorrelationId.toString()){var xa=za.Values.messageCorrelationId.toString(),
ka=this.pdb[xa];if(ka){var wa=ea.a.$e()-ka.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",wa);za.Values.isSuccess&&za.Values.isSuccess?ka.resolve(za.Values.response):ka.reject(za.Values.response);this.BDj(xa)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Fqn(){if(this.mba.mol)this.mba.Y2h();
else if(this.tue&&this.mba){const za=new T.a(Y.a.Npj);za.Values=this.Twh(this.tue,!0);this.Qq.vUa(za,this.mba.Kpj.contentWindow,this.bua)}}Ppn(){this.mba&&this.mba.UWd()}lWf(za){za.Values.cancelled&&za.Values.cancelled&&za.Values.messageCorrelationId&&this.BDj(za.Values.messageCorrelationId.toString());this.mba&&this.mba.hide()}Twh(za,xa=!1){const ka={};ka.appIds=this.NOl();ka.upn=za.loginHint;ka.authority=za.authority;ka.authorityType=Object(e.a)(k.a,za.authorityType);ka.tenantId=za.tenantId;ka.correlationId=
z.AFrameworkApplication.userSessionId;ka.enableConsoleLogging=this.uUg;ka.enablePopupFlash=this.t2j;ka.skipUpnCheck=this.Vkk;ka.interactive=xa;return ka}NOl(){const za=[],xa=v.OAuthManagerSettings.c2e;for(let wa in xa){var ka=xa[wa];Array.contains(za,ka)||Array.add(za,ka)}return za}Ane(za,xa,ka,wa,ia,va){const na=new T.a(Y.a.Fro),Ca=this.ugi();na.Values=this.cDj(za,xa,ka,wa,ia,va,Ca);this.ykh=na;za=this.Lke(Ca);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
xa);this.xwo();return za}ile(){return!0}xwo(){this.sZb||(this.sZb=new L.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.sZb.id=16,this.sZb.n0d=!1,this.sZb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Qq.vUa(this.ykh,this.BH.contentWindow,this.bua)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ta.Kb.Vma(this.sZb,
!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}mrn(za){if(za.Values.messageCorrelationId&&za.Values.messageCorrelationId.toString()){var xa=this.pdb[za.Values.messageCorrelationId.toString()];if(xa){var ka=ea.a.$e()-xa.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ka);za.Values.isSuccess&&za.Values.isSuccess?xa.resolve(za.Values.response):xa.reject(za.Values.response)}else l.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}BDj(za){this.kwb&&this.kwb.correlationId===za&&(this.kwb.resolve(null),this.kwb=null)}}Object(D.a)(Fa,"SharedAuthTokenStrategy",null,[407]);class Pa{constructor(za){this.E7=za;this.R0b="UnsupportedAuthTokenStrategy Reason="+a.a[this.E7]}initialize(){return Promise.resolve(0)}f3d(){return Promise.resolve(0)}RV(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:a.a[this.E7],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.E7]+"]"}))}Ane(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}ile(){return!1}fSc(){return this.R0b}}Object(D.a)(Pa,"UnsupportedAuthTokenStrategy",null,[407]);var Na=c(1530);c.d(J,"OAuthManager",function(){return Aa});class Aa{constructor(za=null){this.kaa=
0;this.laa=null;this.Wyb=0;this.L2g=!!window.location.search.match(RegExp("wdpa=1","gi"));const xa=ea.a.$e();this.w7j=this.onl(za).then(ka=>ka?this.Ezm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-xa)),ka=ma.a.wG(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.kL()),ka=Object.assign(new sa.a,{durationMs:Math.floor(ea.a.$e()-xa),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,
"StrategyPickFailed",!1,!0,ka)),Promise.resolve(1))).then(ka=>0!==ka?Promise.resolve(ka):this.K2m())}pnl(){if(this.L2g)this.kaa=5,this.laa=new Pa(this.kaa);else{var za=v.OAuthManagerSettings.Wen;za&&0<za.length?(this.kaa=1,this.laa=new y(za)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.kaa=2,this.laa=new Pa(this.kaa)):(za=n.a.getAuthContext().loginHint)&&za.length?v.OAuthManagerSettings.XTc?
(this.kaa=1,this.laa=new M):(this.kaa=1,this.laa=new Fa):(this.kaa=3,this.laa=new Pa(this.kaa)):(this.kaa=4,this.laa=new Pa(this.kaa))}}kL(){return this.laa?this.laa.fSc()||"Unknown":"None"}onl(za=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const xa=ea.a.$e();return z.AFrameworkApplication.K.h_l().then(ka=>{ka?(this.pnl(),za&&(this.laa=za),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.fsl,this.kL(),Math.floor(ea.a.$e()-xa))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ea.a.$e()-xa));return Promise.resolve(ka)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ea.a.$e()-xa));return Promise.resolve(!1)})}Ezm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.kL());const za=ea.a.$e();return t.get(this.laa.initialize(),2,v.OAuthManagerSettings.b4f).then(xa=>{if(0===xa)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.kL(),Math.floor(ea.a.$e()-za));else if(1===xa){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-
za));var ka=ma.a.wG();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.kL()),ka=Object.assign(new sa.a,{durationMs:Math.floor(ea.a.$e()-za),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,"StrategyInitFailed",!1,!0,ka))}else 2===xa&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-za)),ka=ma.a.wG(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.kL()),ka=Object.assign(new sa.a,
{durationMs:Math.floor(ea.a.$e()-za),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,"StrategyInitTimedOut",!1,!0,ka)));return Promise.resolve(xa)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-za));return Promise.resolve(1)})}K2m(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.kL());const za=ea.a.$e();return t.get(this.laa.f3d(n.a.getAuthContext()),2,
v.OAuthManagerSettings.b4f).then(xa=>{if(0===xa)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.kL(),Math.floor(ea.a.$e()-za));else if(1===xa){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-za));var ka=ma.a.wG();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.kL()),ka=Object.assign(new sa.a,{durationMs:Math.floor(ea.a.$e()-za),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,
"StrategyLoadFailed",!1,!0,ka))}else 2===xa&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-za)),ka=ma.a.wG(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.kL()),ka=Object.assign(new sa.a,{durationMs:Math.floor(ea.a.$e()-za),extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,"StrategyLoadTimedOut",!1,!0,ka)));return Promise.resolve(xa)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.kL(),Math.floor(ea.a.$e()-za));return Promise.resolve(1)})}RV(za,xa,ka=null){return this.Coc(za,xa,!1,null,"",ka)}dDj(za,xa,ka,wa,ia=null){return this.Coc(za,xa,!0,ka,wa,ia)}Coc(za,xa,ka,wa,ia,va,na=0){na+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",za,this.PPb(za,xa),this.kL(),na);var Ca=ma.a.wG();void 0!==Ca&&null!==Ca&&
(Ca.set("AuthLibrary",this.kL()),Ca.set("AppName",za),Ca.set("Target",this.PPb(za,xa)),oa.Health.instance.recordKpiUsage(Aa.kpiName,0,"WacOAuthFC",Ca));if(!v.OAuthManagerSettings.isEnabled||this.L2g){var ta;return this.vNf((ta=new x.a,ta.IsSuccess=!1,ta.Token=null,ta.ErrorCode="NotEnabled",ta.ErrorMessage="OAuthManager is disabled.",ta),za)}const fa=v.OAuthManagerSettings.c2e[za];if(void 0===fa||null===fa){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
za);var Xa;return this.vNf((Xa=new x.a,Xa.IsSuccess=!1,Xa.Token=null,Xa.ErrorCode="DisallowedApp",Xa.ErrorMessage="Disallowed appName: "+za,Xa),za)}const ob=ea.a.$e();let xb=ob;const zb=this;Ca=this.w7j.then(eb=>{xb=ea.a.$e();return zb.LHm(za,fa,xa,ka,wa,ia,va,eb)});ta=ka?0:v.OAuthManagerSettings.b4f;let Lb;Xa=(Lb=new x.a,Lb.IsSuccess=!1,Lb.Token=null,Lb.ErrorCode="authTokenStrategy_timeout",Lb.ErrorMessage="Auth Strategy timed out after ["+ta+"] ms when fetching token",Lb);let Ia=this,Ya=this;return t.get(Ca,
Xa,ta).then(eb=>na<=Aa.mcn&&(eb.ErrorCode===Aa.dAj||eb.ErrorCode===Aa.kFo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",na,Math.floor(ea.a.$e()-ob)),Ia.Coc(za,xa,ka,wa,ia,va,na)):eb.ErrorCode===Aa.vFi&&!ka&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",na,Aa.WWh),Aa.Qvl&&Ia.laa.ile()&&Ia.laa.Ane(za,fa,xa,ka,wa,ia).then(sb=>Promise.resolve(Ia.Q3d(sb,za,xa,fa,ob,xb))).catch(()=>
{let sb;const lc=(sb=new x.a,sb.IsSuccess=!1,sb.Token=null,sb.ErrorCode="authTokenStrategy_failure",sb.ErrorMessage="LoginPopup failed, GetToken could not be called",sb);return Promise.resolve(Ia.Q3d(lc,za,xa,fa,ob,xb))}),Aa.WWh)?Ia.Coc(za,xa,!0,wa,ia,va,na):Promise.resolve(Ia.Q3d(eb,za,xa,fa,ob,xb))).catch(()=>{let eb;const sb=(eb=new x.a,eb.IsSuccess=!1,eb.Token=null,eb.ErrorCode="authTokenStrategy_failure",eb.ErrorMessage="Auth Strategy failed with an unknown error",eb);return Promise.resolve(Ya.Q3d(sb,
za,xa,fa,ob,xb))})}LHm(za,xa,ka,wa,ia,va,na,Ca){return 1===Ca||2===Ca?this.vNf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ca?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),za):this.laa.RV(za,xa,ka,wa,ia,va,na).then(ta=>Promise.resolve(this.rSi(ta,!0,za))).catch(ta=>Promise.resolve(this.rSi(ta,!1,za)))}Q3d(za,xa,ka,wa,ia,va){const na={},Ca=ea.a.$e()-va;na.IsSuccess=za.IsSuccess;na.ErrorCode=za.IsSuccess?"Success":za.ErrorCode||"";na.ErrorMessage=
za.IsSuccess?"Success":this.PPb(xa,za.ErrorMessage||"");na.Target=this.PPb(xa,ka||"");na.TimeInMS=Math.floor(Ca);na.LoadTimeInMS=Math.floor(va-ia);na.AuthLibrary=this.kL();na.AppName=xa;na.AuthorityType=Object(e.a)(k.a,n.a.KQd());na.UserType=this.Bkm(n.a.getAuthContext());na.IsAuthSupportedInSession=a.a[this.kaa];na.RequestCount=++this.Wyb;na.AppId=wa;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(na));za.IsSuccess||(ka=ma.a.wG(),void 0!==ka&&null!==ka&&(ka.set("AppName",xa),ka.set("AuthLibrary",
this.kL()),ka.set("ErrorCode",za.ErrorCode),ka.set("ErrorMessage",this.PPb(xa,za.ErrorMessage)),xa=Object.assign(new sa.a,{durationMs:Ca,extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,"TryGetTokenFailure",!1,!0,xa)));return za}vNf(za,xa){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",xa,this.PPb(xa,za.ErrorMessage));const ka=ma.a.wG();void 0!==ka&&null!==ka&&(ka.set("AppName",xa),ka.set("AuthLibrary",this.kL()),
ka.set("ErrorCode",za.ErrorCode),ka.set("ErrorMessage",this.PPb(xa,za.ErrorMessage)),xa=Object.assign(new sa.a,{extendedProperties:ka}),oa.Health.instance.recordKpiFailure(Aa.kpiName,"FailureBeforeGetToken",!1,!0,xa));return Promise.resolve(za)}Nyi(za){return za===Na.a.ome}PPb(za,xa){return this.Nyi(za)&&xa?"REDACTED":xa}Bkm(za){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!za.loginHint||1>za.loginHint.length?"empty":-1<za.loginHint.indexOf("guest#")?"guest":-1<za.loginHint.indexOf("ext#")?
"external":0>za.upn.indexOf("@")?"no-at":"supported"}Ovi(){return 1===this.kaa}rSi(za,xa,ka){let wa=null,ia=null,va=null,na=null;za?za.ErrorCode||za.ErrorMessage?(ia=za.ErrorCode?za.ErrorCode:Aa.TYh,va=za.ErrorMessage?za.ErrorMessage:"No message"):za.Token?xa?wa=za.Token:(ia=Aa.wZn,va="A rejected promise returned a token."):(ia=Aa.TYh,va=JSON.stringify(za)):(ia=Aa.Xhn,va="No result came from Auth Token Strategy");za&&za.Telemetry&&!this.Nyi(ka)&&(na=za.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(na)));if(ia===Aa.qfn||ia===Aa.zMo)ia=Aa.dAj,va="Auth Library Timed Out";ia===Aa.WIk&&-1<va.indexOf(Aa.Vpk)&&(ia=Aa.vFi);if(ia||va)wa=null;return Object.assign(new x.a,{IsSuccess:!!wa,Token:wa,ErrorCode:ia,ErrorMessage:va,Telemetry:na})}static get WWh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get Qvl(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Aa.zMo="token_renewal_error";Aa.TYh="Exception";Aa.Xhn="NoResult";Aa.wZn="RejectToken";Aa.qfn="monitor_window_timeout";Aa.dAj="Timeout";Aa.kFo="authTokenStrategy_timeout";Aa.WIk="login_required";Aa.Vpk="AADSTS50058";Aa.vFi="Cookies Disabled";Aa.kpiName="OAuthManager";Aa.mcn=2;Object(D.a)(Aa,"OAuthManager",null,[355])},1625:function(D,J,c){D=c(0);var l=c(22),e=c(56),a=c(127),k=c(2),x=c(85),y;(function(xa){xa[xa.unspecified=0]="unspecified";xa[xa.none=1]="none";xa[xa.hidden=2]="hidden";xa[xa.initial=
3]="initial";xa[xa.dashed=4]="dashed";xa[xa.dotted=5]="dotted";xa[xa.double=6]="double";xa[xa.groove=7]="groove";xa[xa.inset=8]="inset";xa[xa.outset=9]="outset";xa[xa.ridge=10]="ridge";xa[xa.solid=11]="solid";xa[xa.ignorable=12]="ignorable"})(y||(y={}));Object(D.b)("TableCellBorderStyleType",y);var n;(function(xa){xa[xa.unspecified=0]="unspecified";xa[xa.top=1]="top";xa[xa.center=2]="center";xa[xa.bottom=3]="bottom"})(n||(n={}));Object(D.b)("TableCellVerticalAlignType",n);var t=c(6),z=c(16),v=c(7),
I=c(111),E=c(69),H=c(722),M=c(191),K=c(33),L=c(5),S=c(207),Q=c(84),N=c(29),O=c(77),X=c(21),U=c(339),T=c(1540),Y=c(214),aa=c(262),ba=c(720),oa=c(11),ma=c(44),ea=c(37),ua=c(117),sa=c(41),Fa=c(274),Pa=c(148),Na=c(573),Aa=c(43);c.d(J,"a",function(){return za});class za{static get zwm(){return za.z6j}static get Iwm(){return za.D6j}static get Gwm(){return za.C6j}static get ah(){return null!=za.fyg?za.fyg:za.fyg=Y.ContextSetEditor.instance}static get Lk(){return null!=za.gIg?za.gIg:za.gIg=l.a.instance.resolve("Box4.ITableEditor")}static get mD(){return null!=
za.$Hg?za.$Hg:za.$Hg=l.a.instance.Oa("Box4.Styles.ITableCellspacingReader")}static NJn(xa,ka){const wa=xa.currentNode;X.forEachCell(xa,ka.rowSpan,ka.colSpan,(ia,va,na)=>{const Ca=ia.currentNode;Ca!==wa&&(Ca.hg=!0,za.wSh(ia),!na&&1<=ka.colSpan&&(Ca.colSpan=ka.colSpan),za.imj(ia,ka.uka,va,na,ka.rowSpan,ka.colSpan))})}static wKn(xa,ka){X.forEachCell(xa,ka.rowSpan,ka.colSpan,wa=>{za.pGk(wa);za.wSh(wa)})}static pGk(xa){xa=xa.currentNode;xa.hg=!0;xa.b5=!0;xa.Dqb=!0}static wSh(xa){xa&&(xa.Tb(1),Object(I.a)(H.a,
xa.currentNode)&&xa.tg())}static fHk(xa,ka,wa){0<ka&&(xa=Object(E.a)(M.TableCellNode,xa.currentNode))&&(xa.width=wa?ka:e.a.Ql(ka,0))}static sFk(xa,ka,wa){if(xa=Object(E.a)(U.TableNode,xa.currentNode))0<ka&&(xa.ee=e.a.Yy(ka,0)),0<wa&&(xa.xu=e.a.Yy(wa,0))}static dHk(xa,ka){void 0!==ka&&null!==ka&&xa.currentNode.properties.setValue(t.a.wJa,za.Iwm[ka+""])}static oGk(xa,ka){void 0!==ka&&null!==ka&&""!==ka&&(ka=parseInt(T.Box4PasteSteward.bDb(ka),16),xa.currentNode.properties.setValue(z.a.WK,ka))}static PAk(xa){if(xa){if(v.ULS.sendTraceTag(520890260,
3022,50,"Adjusting column width after paste."),Object(Aa.a)("AdjustingColumnWidthAfterPaste",!0),16==xa.type){var ka=new L.GraphIterator;ka.set(xa);if(ka.zb(14)){var wa=O.a(ka),ia=N.TableCellReader.cP(xa);if(ka.jd(14)){xa=ka.currentNode;var va=K.TableReader.Jha(ka);if(va){var na=Array.clone(va);ka=K.TableReader.nTd(ka);var Ca=0,ta=0;for(var fa=0;fa<va.length;fa++)fa>=wa&&fa<wa+ia?ka[fa]>va[fa]&&(Ca+=ka[fa]-va[fa],na[fa]=ka[fa]):ta+=va[fa]>ka[fa]?va[fa]-ka[fa]:0;(null==ta||0>=ta||isNaN(ta))&&v.ULS.sendTraceTag(521187336,
3022,50,"spaceAvailableToShrink is invalid");(null==Ca||0>=Ca||isNaN(Ca))&&v.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(ta<Ca)for(wa=0;wa<va.length;wa++)na[wa]=ka[wa];else for(fa=0;fa<va.length;fa++)if((fa<wa||fa>=wa+ia)&&va[fa]>ka[fa]){const Xa=(va[fa]-ka[fa])/ta;na[fa]-=Xa*Ca;(null==na[fa]||0>=na[fa]||isNaN(na[fa]))&&v.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Xa)}wa=Pa.a.Bea+(za.mD?za.mD.Vwa(xa):0);for(va=0;va<na.length;va++)if(null==
na[va]||0>=na[va]||isNaN(na[va]))v.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),na[va]=e.a.Ql(wa,0);xa.uG=na}else v.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else v.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static ikm(xa){var ka=new L.GraphIterator;ka.kd(xa);if((xa=S.OutlineNavigator.oag(ka))&&Q.OutlineReader.nx(ka)){ka=xa.tf(t.a.Ko);const wa=xa.tf(t.a.marginLeft);xa=xa.tf(t.a.marginRight);return ka-wa-xa}return 0}static ZTm(xa){return!(void 0===
xa||null===xa||xa===y.none)}static elc(xa,ka,wa,ia,va){if(void 0===ka||null===ka||""!==ka){switch(ka){case "thin":ka=a.a.nae(.25);break;case "initial":case "medium":ka=a.a.nae(.5);break;case "thick":ka=a.a.nae(1);break;default:ka=za.Qfm(ka,wa,ia)}va.currentNode.properties.setValue(xa,ka)}}static dlc(xa,ka,wa){void 0!==ka&&null!==ka&&ka&&wa.currentNode.properties.setValue(xa,za.Gwm[ka+""])}static who(xa,ka,wa){void 0!==ka&&null!==ka&&""!==ka&&(ka=parseInt(T.Box4PasteSteward.bDb(ka),16),wa.currentNode.properties.setValue(xa,
ka))}static Qfm(xa,ka,wa){let ia=0;const va=({unit:xa}=T.Box4PasteSteward.E$d(xa)).returnValue;switch(xa){case 5:ia=a.a.nae(va);break;case 1:ia=a.a.bVk(va);break;case 3:ia=a.a.hri(va);break;case 7:ia=e.a.fEn(va,wa)}if(ka===y.double||ka===y.groove||ka===y.ridge)ia/=3;return Math.round(ia)}static Rfm(xa,ka){let wa=0;const ia=({unit:xa}=T.Box4PasteSteward.E$d(xa)).returnValue;switch(xa){case 5:wa=a.a.Uya(ia);break;case 1:wa=a.a.D7e(ia);break;case 3:wa=a.a.rxa(ia);break;case 7:wa=e.a.Ql(ia,ka)}return wa}static Ige(xa,
ka,wa,ia,va,na,Ca){if(va&&(!Ca||16===va.Xe||Ca||14!==va.Xe)&&wa!==y.ignorable){if(Ca)switch(ia){case 5:ia=t.a.Zza;var ta=t.a.Ya;var fa=t.a.Xa;var Xa=0;break;case 4:ia=t.a.Yza;ta=t.a.tb;fa=t.a.rb;Xa=1;break;case 0:ia=t.a.Wza;ta=t.a.Wa;fa=t.a.Va;Xa=0;break;case 3:ia=t.a.Xza;ta=t.a.qb;fa=t.a.pb;Xa=1;break;default:return}else switch(ia){case 5:ia=t.a.WRb;ta=t.a.mrb;fa=t.a.jnc;Xa=0;break;case 4:ia=t.a.VRb;ta=t.a.lrb;fa=t.a.inc;Xa=1;break;case 0:ia=t.a.TRb;ta=t.a.jrb;fa=t.a.gnc;Xa=0;break;case 3:ia=t.a.URb;
ta=t.a.krb;fa=t.a.hnc;Xa=1;break;default:return}void 0!==va.currentNode&&null!==va.currentNode&&(za.ZTm(wa)?(za.who(ia,xa,va),za.dlc(ta,wa,va),za.elc(fa,ka,wa,Xa,va)):na||Ca||va.currentNode.properties.setValue(ta,"nil"))}}static imj(xa,ka,wa,ia,va,na){ia||(za.Xuh(ka,xa,!1,!1),za.P2e(ka,xa,!0,!1));ia===na-1&&za.P2e(ka,xa,!0,!1);wa||za.wvh(ka,xa,!0,!1);wa===va-1&&za.Duh(ka,xa,!0,!1)}static Cuh(xa,ka,wa,ia){xa&&(za.wvh(xa,ka,wa,ia),za.P2e(xa,ka,wa,ia),za.Duh(xa,ka,wa,ia),za.Xuh(xa,ka,wa,ia))}static wvh(xa,
ka,wa,ia){za.Ige(xa.borderTopColor,xa.borderTopWidth,xa.borderTopStyle,5,ka,wa,ia)}static P2e(xa,ka,wa,ia){za.Ige(xa.borderRightColor,xa.borderRightWidth,xa.borderRightStyle,4,ka,wa,ia)}static Duh(xa,ka,wa,ia){za.Ige(xa.borderBottomColor,xa.borderBottomWidth,xa.borderBottomStyle,0,ka,wa,ia)}static Xuh(xa,ka,wa,ia){za.Ige(xa.borderLeftColor,xa.borderLeftWidth,xa.borderLeftStyle,3,ka,wa,ia)}static Jge(xa,ka,wa){if(wa&&16===wa.Xe&&""!==xa){switch(ka){case 3:ka=t.a.pVa;var ia=0;break;case 2:ka=t.a.LV;
ia=1;break;case 0:ka=t.a.oVa;ia=0;break;case 1:ka=t.a.oS;ia=1;break;default:return}(xa=za.Rfm(xa,ia))&&wa.currentNode.properties.setValue(ka,xa)}}static OEk(xa,ka){ka&&(za.XGk(ka,xa),za.hGk(ka,xa),za.VEk(ka,xa),za.CFk(ka,xa))}static XGk(xa,ka){za.Jge(xa.WUk,3,ka)}static hGk(xa,ka){za.Jge(xa.VUk,2,ka)}static VEk(xa,ka){za.Jge(xa.TUk,0,ka)}static CFk(xa,ka){za.Jge(xa.UUk,1,ka)}static $Ek(xa,ka,wa,ia){var va=0;const na=Array(xa.length);var Ca=0;ia&&(Ca=(Ca=a.a.tdd(za.ikm(ka)))?Ca:1);for(ia=0;ia<xa.length;ia++)na[ia]=
0<Ca?Ca/100*xa[ia]:e.a.Ql(xa[ia],0),va+=na[ia];xa=wa.getValue(z.a.Xz);ia=new L.GraphIterator;ia.kd(ka);ka=0;if(N.TableCellReader.P0(ia)){if(xa=X.returnToContainingCell(ia))ka=xa.width;Ca=O.a(ia);ia=X.returnToContainingTable(ia);if(-1!==Ca&&Ca<=ia.uG.length){let ta=0;for(let fa=Ca;fa<Ca+xa.colSpan&&fa<ia.uG.length;fa++)ta+=ia.uG[fa];ka=Math.min(ka,ta);ka===ta&&(ka-=e.a.Ql(za.hhn,0))}}else if(xa)for(Ca=0;Ca<xa.length;Ca++)ka+=xa[Ca];if(0<ka&&va>ka&&va)for(va=ka/va,ka=0;ka<na.length;ka++)na[ka]*=va;
wa.setValue(z.a.Xz,na)}static iGk(xa,ka){xa.currentNode.setValue(t.a.S1,e.a.Ql(ka,1))}static noo(xa){var ka,wa;v.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Aa.a)("SettingTableSelectionBounds",!0);var ia=xa.ib,va=xa.qg;xa=za.ah.pR(va,16);if(va=za.ah.YT(va,14))if(va=va.node,!va||14!==va.type)v.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!xa)v.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(wa=null===
(ka=null===ia||void 0===ia?void 0:ia.lb)||void 0===ka?void 0:ka.Oe)||void 0===wa?0:wa.Pa)&&ia.lb.Oe.Pa.contextId===oa.a.Q1&&aa.TableBorderSelectionCache.DQa()&&0<aa.TableBorderSelectionCache.DQa().length)){aa.TableBorderSelectionCache.dVc(va);ka=aa.TableBorderSelectionCache.C$;ka.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;ka.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;ka.topMostRowSelected=Number.MAX_SAFE_INTEGER;ka.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(wa=0;wa<xa.length;wa++){if(xa.getContext(wa).contextId!==
oa.a.Jw)return;ia=xa.getContext(wa).node;if(!N.TableCellReader.$r(ia)){var na=new L.GraphIterator;na.set(ia);if(na.zb(14)&&X.getContainingTable(na)===va){na.jd(14);na=N.TableCellReader.sFa(na,ia);if(!na)return;Array.add(aa.TableBorderSelectionCache.DQa(),new ba.a(ia,na.rowIndex,na.Do,ia.rowSpan,ia.colSpan));ka.leftMostColumnSelected=Math.min(ka.leftMostColumnSelected,na.Do);ka.rightMostColumnSelected=Math.max(ka.rightMostColumnSelected,na.Do);ka.topMostRowSelected=Math.min(ka.topMostRowSelected,na.rowIndex);
ka.bottomMostRowSelected=Math.max(ka.bottomMostRowSelected,na.rowIndex)}}}aa.TableBorderSelectionCache.C$=ka}}else v.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static Qhj(xa){var ka;if(xa&&14===xa.type){v.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Aa.a)("ScalingColumnWidthForCCP",!0);var wa=new L.GraphIterator;wa.set(xa);if(wa.od()&&K.TableReader.mx(wa)){var ia=xa.uG,va=K.TableReader.nTd(wa),na=X.returnToContainingCell(wa),Ca=X.getContainingTable(wa);if(na&&
Ca){var ta=O.a(wa),fa=N.TableCellReader.cP(na);if(wa.jd(14)){var Xa=K.TableReader.Jha(wa);wa=0;for(let ob=ta;ob<ta+fa;ob++)wa+=Xa[ob];ta=Pa.a.QM(na,Ca,t.a.oS,t.a.Aa,0);na=Pa.a.QM(na,Ca,t.a.LV,t.a.Ba,0);wa-=e.a.Ql(ta+na,0);(null==wa||0>=wa||isNaN(wa))&&v.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",ta,na);na=0;for(Ca=0;Ca<ia.length;Ca++)na+=ia[Ca];Ca=wa/na;(null==Ca||0>=Ca||isNaN(Ca))&&v.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");ta=0;
for(fa=0;fa<ia.length;fa++)Xa=ia[fa],ia[fa]*=Ca,ia[fa]<va[fa]&&(ia[fa]=va[fa],1>Ca&&(null===(ka=k.AFrameworkApplication.K)||void 0===ka?0:ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(Ca=(wa-va[fa])/(na-Xa))),ta+=ia[fa];ta>wa&&(ia=Array.clone(va));ka=Pa.a.Bea+(za.mD?za.mD.Vwa(xa):0);for(va=0;va<ia.length;va++)if(null==ia[va]||0>=ia[va]||isNaN(ia[va]))v.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),ia[va]=e.a.Ql(ka,
0);ka=new ma.GraphTransaction(4);ka.Db(xa);xa.uG=ia;ka.dispose()}}}else v.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else v.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static $4n(xa){if(!xa||!K.TableReader.PIf(xa)||1!=xa.Wp())return v.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;v.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Aa.a)("ReplaceTableContentForExternalPaste",!0);
let ka=new L.GraphIterator;ka.set(xa.currentNode);ka.zb(14);ea.OutlineElementNavigator.Ee(ka);const wa=new L.GraphIterator;wa.set(xa.currentNode);wa.zb(14);if(!wa.jd(14)||!ka||14!=ka.currentNode.type)return null;if(xa=X.getContainingTableCell(ka))if(xa=N.TableCellReader.sFa(wa,xa)){if(aa.TableBorderSelectionCache.CSc())var ia=this.cem();else{ia=K.TableReader.gg(ka.currentNode)-(K.TableReader.gg(wa.currentNode)-xa.rowIndex);var va=K.TableReader.hh(ka.currentNode)-(K.TableReader.hh(wa.currentNode)-
xa.Do);this.qvk(wa,ia,va);ia=new Fa.a(xa.Do,K.TableReader.hh(wa.currentNode)-1,xa.rowIndex,K.TableReader.gg(wa.currentNode)-1)}if(!ia)return null;va=ia.bottomMostRowSelected-ia.topMostRowSelected+1;var na=ia.rightMostColumnSelected-ia.leftMostColumnSelected+1;va=Math.min(va,K.TableReader.gg(ka.currentNode));na=Math.min(na,K.TableReader.hh(ka.currentNode));for(let Ca=0;Ca<va;Ca++){X.moveToCell(wa,Ca+ia.topMostRowSelected,ia.leftMostColumnSelected);X.moveToCell(ka,Ca,0);for(let ta=0;ta<na;ta++)Ca==
xa.rowIndex-ia.topMostRowSelected&&ta==xa.Do-ia.leftMostColumnSelected||this.vQi(ka,wa),X.moveToNextColumn(wa),X.moveToNextColumn(ka);wa.Ps(14);ka.Ps(14)}X.moveToCell(wa,xa.rowIndex,xa.Do);xa.rowIndex-ia.topMostRowSelected<K.TableReader.gg(ka.currentNode)&&xa.Do-ia.leftMostColumnSelected<K.TableReader.hh(ka.currentNode)?X.moveToCell(ka,xa.rowIndex-ia.topMostRowSelected,xa.Do-ia.leftMostColumnSelected):ka=null;this.vQi(ka,wa);wa.Ps(14);X.moveToCell(wa,ia.topMostRowSelected,ia.leftMostColumnSelected);
wa.Rd();return wa.currentNode}}static yCn(xa){if(xa&&K.TableReader.PIf(xa)&&1==xa.Wp()){v.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Aa.a)("PasteTableBelowTable",!0);var ka=new L.GraphIterator;ka.set(xa.currentNode);xa=ua.a.eb(xa.currentNode);ka.Ip()&&xa.Ip()&&(ea.OutlineElementNavigator.g1(xa,!1,!0),sa.OutlineElementReader.yh(xa)&&1==xa.Wp()&&(ea.OutlineElementNavigator.Ee(ka),ea.OutlineElementNavigator.Ee(xa),ka&&xa&&ka.currentNode!=xa.currentNode&&K.TableReader.isTable(ka)&&
K.TableReader.isTable(xa)&&this.Jdn(ka,xa)&&(v.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),ka.tg(),ka.tg())))}else v.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static vQi(xa,ka){if(ka&&N.TableCellReader.isTableCell(ka)){var wa=ka.Wp();if(xa&&N.TableCellReader.isTableCell(xa)&&xa.Jz())for(;xa.Jz();)xa.Rd(),ka.Bf(xa.currentNode,xa.role),xa.tg();else wa--;for(;0<wa--;)ka.Rd(),ka.tg()}}static Jdn(xa,ka){if(!K.TableReader.isTable(xa)||!K.TableReader.isTable(ka))return!1;
var wa=K.TableReader.hh(xa.currentNode),ia=K.TableReader.hh(ka.currentNode);if(wa!=ia)return v.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;wa=K.TableReader.gg(xa.currentNode);ia=K.TableReader.gg(ka.currentNode);const va=new ma.GraphTransaction(4);va.Db(ka.currentNode);ka.currentNode.setValue(z.a.aAa,wa+ia);for(va.dispose();xa.Jz();){xa.Rd();ka.Bf(xa.currentNode,1);wa=new L.GraphIterator;wa.set(xa.currentNode);xa.tg();wa.Rd();do wa.currentNode&&
16==wa.currentNode.type&&(wa.currentNode.bF=ka.currentNode);while(wa.It())}return!0}static qvk(xa,ka,wa){v.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Aa.a)("AddRowAndColumnForExternalCCP",!0);za.EBa=Na.a.r$b;0<ka&&(X.moveToLastRow(xa),v.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+ka),this.Lk.insertRows(xa,!1,ka,this.EBa),v.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),xa.jd(14));0<wa&&(v.ULS.sendTraceTag(523896320,307,
50,"Begin insert columns: "+wa),this.Lk.insertColumns(xa,K.TableReader.hh(xa.currentNode),!1,wa,this.EBa),v.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static cem(){return aa.TableBorderSelectionCache?aa.TableBorderSelectionCache.C$:null}}za.hhn=8;za.win="Normal Table";za.bRh="Table Grid";za.EBa=null;za.z6j=x.a.i6("MsoNormalTable","Normal Table","MsoTableGrid",za.bRh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2",
"MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6",
"MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3",
"MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark",
"MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2",
"MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3",
"MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5",
"List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2",
"List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6",
"List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1",
"MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2",
"MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");za.D6j=x.a.i6(n.unspecified+"","center",n.top+"","top",n.center+"","center",n.bottom+"","bottom");za.C6j=x.a.i6(y.unspecified+"","nil",y.none+"","none",y.hidden+"","nil",y.initial+"","single",y.dotted+"","dotted",y.dashed+"","dashed",y.solid+
"","single",y.double+"","double",y.groove+"","double",y.ridge+"","double",y.inset+"","inset",y.outset+"","outset");Object(D.a)(za,"Box4TableStewardHelper",null,[])},1626:function(D,J,c){D=c(0);class l{constructor(y,n,t,z){this.W_j=y;this.cik=n;this.aik=t;this.dik=z}get EId(){return this.W_j}get Xee(){return this.cik}get Vee(){return this.aik}get resultType(){return this.dik}}Object(D.a)(l,"SearchContext",null,[1326]);class e{VJd(y,n,t,z){var v=t-n;let I;if(100<=v)v=n,I=t;else{v=Math.max(0,n+Math.ceil(v/
2)-50);I=Math.min(y.length,v+100);v=Math.max(0,I-100);let H;if(v&&" "!==y.charAt(v-1)){H=Math.min(n,v+10);for(var E=v;E<H;++E)if(" "===y.charAt(E)){v=E+1;break}}if(I!==y.length&&" "!==y.charAt(I))for(H=Math.max(t,I-10),E=I-1;E>=H;--E)if(" "===y.charAt(E)){I=E;break}}y=y.substring(v,I);return new l(y,n-v,t-v,z)}WJd(y){return this.VJd(y.$di(),y.Bc,y.end,"")}}Object(D.a)(e,"SearchContextFactory",null,[1304]);var a=c(124),k=c(1608);c.d(J,"a",function(){return x});class x extends e{constructor(){super()}WJd(y){let n=
y.Bc,t=y.end;const z=({Bc:n,end:t}=x.j9l(y,n,t)).returnValue;y=k.a(y.type);return this.VJd(z,n,t,y)}static get instance(){return null!=x.yCg?x.yCg:x.yCg=new x}static j9l(y,n,t){y=y.$di();return x.taj(y,n,t)}static taj(y,n,t){const z=a.AParagraphNode.QP(y);if(z.length<y.length){y=y.substring(0,n);const v=a.AParagraphNode.QP(y);y=y.length-v.length;n-=y;t-=y}return{returnValue:z,Bc:n,end:t}}}Object(D.a)(x,"EditorSearchContextFactory",e,[])},1628:function(D,J,c){D=c(0);var l=c(2),e=c(22),a=c(334),k=c(727),
x=c(23),y=c(25),n=c(141),t=c(49),z=c(551),v=c(207),I=c(253),E=c(84),H=c(28),M=c(8),K=c(3),L=c(6),S=c(601),Q=c(1073);class N{create(){return new Q.a}}Object(D.a)(N,"FootnoteEndnoteContainerNodeFactory",null,[380]);var O=c(538);c.d(J,"a",function(){return X});class X{constructor(U,T,Y,aa,ba,oa,ma,ea,ua){this.jAd=null;X.ga=U;this.EE=Y;this.UNe=aa;this.x_j=oa;this.Yc=ma;this.hb=ba;this.bck=ea;this.L0j=ua;X.Mh=T}I5d(U,T){this.oxl(U);U.Tb(7);this.EE.Lyi(U,T)||U.Lf(7)}oxl(U){if(this.UNe.oBi(U)){var T=!1,
Y=!1;if(U.Tb(7)){do{const aa=U.currentNode;if(37===aa.type)switch(aa.getValue(L.a.A4)){case 0:Y=!0;break;case 1:T=!0}}while(U.Ri(7))}Y||this.Joh(U,0);T||this.Joh(U,1)}}Joh(U,T){const Y=this.x_j.create(1074135124);Y.setValue(L.a.A4,T);U.Bf(Y,7)}rdo(U){U&&this.Tij(U.xoa)}Tij(U){U&&(U=x.SelectionFactory.ne(U.Lb.paragraph,U.Lb.cp+1),this.hb.Ac(U))}Wgn(U){let T=this.bck(U);void 0!==T&&null!==T?this.EE.zpa(T)&&(T=this.EE.zei(T)):T=U;return this.L0j(T)}vzo(){this.jAd?X.Mh.notificationBar.removeEntry(this.jAd):
this.jAd=X.Mh.notificationBar.Eva(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);X.Mh.notificationBar.sA(this.jAd)}oFk(U,T){U=this.Yc.Joa(U,37,37);let Y=!1;if(U.Rd()){do{const aa=U.currentNode;this.EE.FIf(aa)?this.Ouh(aa,T):Y=!0}while(U.Oj())}Y&&this.vzo()}Ouh(U,T){S.f(U,Y=>{X.FJl(Y,T);return!0},12)}Gsm(U,T){U=this.EE.LQc(U,T);return U?(U=this.Yc.Rf(U))?U.Jz():!1:!1}k$h(U,T){U=this.EE.LQc(U,T);U=this.Yc.Rf(U);if(U.Rd()){do if(T=U.currentNode,1===T.getValue(L.a.yoa))return T;
while(U.Oj())}return null}static MQc(){return new X(l.AFrameworkApplication.va,y.StaticActiveAppFrame.za(),O.a.instance,n.PageReader.instance,t.a.instance,new N,new z.a,v.OutlineNavigator.Rgn,I.WordSectionNavigator.pef)}static get instance(){return null!=X.ICg?X.ICg:X.ICg=X.MQc()}static get Sk(){return null!=X.eGg?X.eGg:X.eGg=e.a.instance.resolve("Box4.IParagraphEditor")}static FJl(U,T){T.fkb?X.Sk.qq.mea(U,E.OutlineReader.aY(U)):X.Sk.qq.mea(U,0);U=H.a.createTextRange(U,0,M.ParagraphReader.textLength(U));
X.ga.Mf(U,K.a.font,2,!0,new a.a,new k.a(T.fontName));X.ga.Mf(U,K.a.WA,2,!0,new a.a,new k.a(T.fontSize))}}X.ga=null;X.Mh=null;Object(D.a)(X,"FootnoteEndnoteEditor",null,[421])},1634:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(l||
(l={}));Object(D.b)("SupportStatus",l)},1643:function(D,J,c){c.d(J,"a",function(){return M});D=c(0);var l=c(359),e=c(61),a=c(22),k=c(175),x=c(7),y=c(111),n=c(69),t=c(11),z=c(104),v=c(536),I=c(124),E=c(101),H=c(8);class M{constructor(K,L,S,Q,N,O=null,X="",U=!0,T=!1){this.cFa=this.xke=this.Cpb=this.I5i=this.xee=null;this.eXc=!1;this.yBf=null;this.RUf=0;this.dme=null;this.context=K;this.ke=K.view;this.Vw=L;this.vd=N;this.dS=S;this.x$=Q;this.Yja=this.failed=!1;this.M9d=null;this.w4a=this.Cdc=!1;this.oAo=
M.kaf(K);this.browserName=X;this.oJj=U;this.RYc=T;this.WVa=!1;this.N5b=0;if(K=Object(y.a)(88,N)?N:null){this.I5i=new l.DictionaryPropertySet;this.I5i.ax(K);S=K.ja(k.a.Y3c,e.a.nil);this.gJc=S!=e.a.nil?S.toString():e.a.create().toString();if(K.ja(k.a.S1i,!1)){this.Cdc=!0;this.w4a=K.ja(k.a.w4a,!1);this.M9d=O;for(O=this.ke.mb.qg;O.lx;)O=O.getContext(0);if(N=Object(n.a)(I.AParagraphNode,O.node)){S=0;Q=H.ParagraphReader.textLength(N);switch(O.contextId){case t.a.Fd:S=O.cpBegin;Q=O.cpEnd;break;case t.a.Vc:S=
Q}this.xee=z.FormattingReader.gSd(O.node,S,O.Fb);x.ULS.shipAssertTag(6305503,307,!!this.xee);N=E.a.d$b(N);for(const Y of N)Y.cpEnd<=S||Y.cpBegin>=Q||M.jp.jS(O.node,Y.hyperlink)}}this.Yja=K.ja(k.a.Yja,!1);this.WVa=K.ja(k.a.WVa,!1);this.Cpb=K.ja(k.a.Cpb,null)}else this.gJc=e.a.create().toString();L&64&&(this.Yja=!0)}static get jp(){return null!=M.rBg?M.rBg:M.rBg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static kaf(K){if(K){if(K.lx){for(let L=0;L<K.length;L++)if(M.kaf(K.getContext(L)))return!0;return!1}if(Object(y.a)(v.a,
K))return M.kaf(K.ik);if(H.ParagraphReader.Xb(K.node)&&K.node.AO)return!0}return!1}}Object(D.a)(M,"ClipboardActionArguments",null,[])},1644:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(7),e=c(217),a=c(91);class k{static get U_m(){return k.Wqd}static S9k(x,y,n){try{k.Wqd=k.Xcl(x,y,n)}catch(t){k.Wqd=null,l.ULS.Vz(539787540,393,10,t,"Error in creating autoTriggerTextContext: {0}",t instanceof Error?t.message:"Unknown Error")}}static Jej(){k.Wqd=null}static Xcl(x,y,n){if(!a.ListItemReader.lg(y))throw l.ULS.sendTraceTag(539787541,
393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const t=e.a.X3l(y);if(null===t||void 0===t||!t.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),Error("No list node with id found under outline element");y=n.ww(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new k(x,t.id,y)}constructor(x,y,
n){this.dCj=x;this.u2m=y;this.U7f={listType:n.listType,listStyle:n.listStyle,KLf:n.Tu}}STm(x,y){return y&&x&&this.u2m===x.id&&y.listType===this.U7f.listType&&y.listStyle===this.U7f.listStyle&&y.Tu===this.U7f.KLf}}k.Wqd=null;Object(D.a)(k,"AutoTriggerTextContext",null,[])},1645:function(D,J,c){c.d(J,"a",function(){return L});D=c(0);var l=c(22),e=c(61),a=c(44),k=c(642),x=c(141),y=c(551),n=c(178),t=c(15),z=c(110),v=c(6),I=c(887),E=c(779),H=c(538),M=c(1570),K=c(1628);class L{constructor(S,Q,N,O,X,U){this.EE=
S;this.NLa=N;this.UNe=O;this.Fye=X;this.Yc=U}EEm(S,Q,N){const O=this.Cbi(Q,S.node),X=S.node.Mc;if(!X)return null;const U=new a.GraphTransaction(15);U.Db(S.node);U.Uj=N;N=this.FEm(O,Q);L.GEm(N,X,S,Q);U.dispose();return N}Cbi(S,Q){const N=this.Yc.Dk();N.set(Q);N.zb(7);N.jd(7);this.NLa.I5d(N,S);return N}FEm(S,Q){const N=E.a.createNode();N.properties.setValue(v.a.A4,Q);S.Bf(N,8);this.Fye.dal(N,Q);return N}static get jg(){return null!=L.ixg?L.ixg:L.ixg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Tea(){return L.jX||
(L.jX=new k.WACStyleSet)}static set Tea(S){L.jX=S}static MQc(){const {FootnoteEndnoteDefaultContentInserter:S}=c(1717);return new L(H.a.instance,M.a.instance,K.a.instance,x.PageReader.instance,S.instance,new y.a)}static get instance(){return null!=L.oDg?L.oDg:L.oDg=L.MQc()}static get hi(){return L.lA||(L.lA=n.PageNavigator.instance)}static set hi(S){L.lA=S}static GEm(S,Q,N,O){t.App.zd.Uo&&t.App.zd.fq.iG(N.node);const X=new z.a;X.setValue(v.a.U8b,S.id);X.setValue(v.a.A4,O);const U=Q.Xu(X,e.a.create());
L.jg.kia(N,T=>I.a.getInstance(T,U,S.id),L.S6h(N.node,O))}static S6h(S,Q){let N=null;(S=L.hi.uu(S))&&(S=L.Tea.iY(S))&&(N=S.QFa(Q?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return N}}L.jX=null;L.lA=null;Object(D.a)(L,"FootnoteEndnoteInserter",null,[456])},1650:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{static D4n(e,a){l.uNe=e;l.EQe=a}static A4n(e,a){l.CQe=e;l.f_a=a}static tgi(){return l.CQe===l.f_a?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,
l.f_a,l.uNe,l.EQe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.CQe,l.f_a,l.uNe,l.EQe)}}l.CQe=0;l.f_a=0;l.uNe=null;l.EQe=null;Object(D.a)(l,"ReplaceAllContext",null,[])},1670:function(D,J,c){c.r(J);D=c(0);var l=c(2071),e=c(61),a=c(2),k=c(311),x=c(22),y=c(1988),n=c(25),t=c(7),z=c(250),v=c(2073),I=c(12),E=c(14),H=c(1626);class M{constructor(Sa="",wb="",Tb=!1,Hb=!1){this.mRm=Tb;this.NUm=Hb;this.actionId=Sa;this.lJa=wb}}Object(D.a)(M,"SearchEntryPointContext",null,[]);class K{constructor(Sa){this.cga=
null;this.Vs=!1;this.JN=Sa}initialize(){this.S_();this.Qz();this.l8(0)}Qz(){this.cga.Qz()}dispose(){this.JN=null}ZRc(){return!1}get zG(){return this.cga?this.cga.zG:0}l8(Sa){this.cga.l8(Sa)}get isVisible(){return this.Vs}M_e(Sa){this.cga&&this.cga.lfp(Sa)}rbj(Sa){this.cga&&this.cga.Nqp(Sa)}iIj(Sa){this.cga&&this.cga.tvp(Sa)}YEh(){this.cga&&this.cga.Lgp()}cge(Sa){this.cga&&this.cga.cge(Sa)}}Object(D.a)(K,"FindReplacePane",null,[494,10]);var L=c(67),S=c(1429),Q=c(1086),N=c(177),O=c(183),X=c(1074),U=
c(93),T=c(109),Y=c(86),aa=c(43),ba=c(26),oa=c(401),ma=c(1538),ea=c(336),ua=c(1054),sa=c(711),Fa=c(83),Pa=c(1105);class Na{constructor(Sa){this.utk=(wb,Tb)=>{this.kAd.nb(wb)?this.kAd.Z(wb,Tb):this.kAd.add(wb,Tb);(wb=this.wOl(wb))&&this.Yui(Tb,wb,this.ZJh(ea.a.getTypeName()))};this.kAd=new Fa.a;this.bW=new Fa.a;this.annotationType=ma.RoleDetectionAnnotation.getTypeName();Sa.wVn(this.utk)}KB(Sa,wb){let Tb;const Hb=Sa.parentPath.substr(Sa.parentPath.lastIndexOf("\\")+1),$a=Sa.content;if(!$a||this.tUm($a))""!==
Hb&&({value:Tb}=this.kAd.Fc(Hb,Tb)).returnValue&&this.Yui(Tb,Sa,this.ZJh(wb)),wb===ea.a.getTypeName()?(wb=null,({value:wb}=this.bW.Fc(Hb,wb)).returnValue?this.bW.Z(Hb,Sa):this.bW.add(Hb,Sa)):wb===ua.a.getTypeName()&&this.bW.remove(Hb)}Yui(Sa,wb,Tb){const Hb=this.i3l(wb);wb=this.xOl(wb);0<wb&&Sa(Tb,Hb,wb)}xOl(Sa){try{return Number.parseInvariant(Sa.id.substr(2))}catch(wb){t.ULS.sendTraceTag(554747009,367,10,wb.toString())}return-1}wOl(Sa){let wb;return({value:wb}=this.bW.Fc(Sa,wb)).returnValue?wb:
null}z4c(Sa){if(Sa)for(const wb of Sa)this.KB(wb,"AugLoop_Core_AddOperation")}i3l(Sa){if(Sa=Sa.content)switch(Sa.roleType){case ma.RoleType.Heading1:return 1;case ma.RoleType.Heading2:return 2;case ma.RoleType.Heading3:return 3;case ma.RoleType.Heading4:return 4;case ma.RoleType.Heading5:return 5;case ma.RoleType.Heading6:return 6;case ma.RoleType.Heading7:return 7;case ma.RoleType.Heading8:return 8;case ma.RoleType.Heading9:return 9}return-1}tUm(Sa){Sa=Sa.roleType;return Sa===ma.RoleType.Heading1||
Sa===ma.RoleType.Heading2||Sa===ma.RoleType.Heading3||Sa===ma.RoleType.Heading4||Sa===ma.RoleType.Heading5||Sa===ma.RoleType.Heading6||Sa===ma.RoleType.Heading7||Sa===ma.RoleType.Heading8||Sa===ma.RoleType.Heading9}ZJh(Sa){if(Sa===ea.a.getTypeName()||Sa===sa.a.getTypeName())return Pa.a.v_e;if(Sa===ua.a.getTypeName())return Pa.a.eLd;throw Error.create("Invalid operation type");}}Object(D.a)(Na,"RoleDetectionAnnotationHandler",null,[55]);var Aa=c(135),za=c(65),xa=c(1165),ka=c(49),wa=c(75),ia=c(55),
va=c(198),na=c(234),Ca=c(178),ta=c(658);class fa extends va.a{constructor(Sa,wb){super(Sa,wb,na.a.aia());this.q2d=null;this.SQa=this.T3b=0;this.headingsReady=!1;this.$ya=this.qOa=0;this.aMi=!1;this.u8g=this.VYg=this.aVg=null}get a2d(){return!0}get yZh(){return this.aVg}get Y5d(){return this.u8g}uKj(){this.headingsReady&&(this.VYg.style.display="none",this.SQa||this.T3b?(this.yZh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.yZh.style.display=
"block"))}get p9(){return super.p9|240}static pcf(Sa,wb,Tb){var Hb=n.StaticActiveAppFrame.za().jb.Zc;if(Hb&&(Hb=Ca.PageNavigator.instance.hP(Hb))){const $a=new fa(new ta.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));$a.SQa=0;$a.T3b=0;$a.q2d=null;$a.GBb(Sa);$a.aVg=wb;$a.VYg=Tb;$a.YE(Hb);$a.headingsReady=!0;$a.uKj();$a.u8g=null;return $a}return null}}Object(D.a)(fa,"WordNavigationPaneHeadingsView",va.a,[503,124,113,10]);class Xa{constructor(Sa){this.bW=new Fa.a;this.G9g=Sa}KB(Sa,wb){wb===ea.a.getTypeName()?
(wb=null,({value:wb}=this.bW.Fc(Sa.id,wb)).returnValue?this.bW.Z(Sa.id,Sa):this.bW.add(Sa.id,Sa)):wb===ua.a.getTypeName()&&this.bW.remove(Sa.id);this.G9g&&this.G9g()}z4c(Sa){if(Sa)for(const wb of Sa)this.KB(wb,ea.a.getTypeName())}q9b(){var Sa;const wb=[];if(0<(null===(Sa=this.bW)||void 0===Sa?void 0:Sa.count))for(const Tb of this.bW.values)wb.push(Tb);return wb}}Object(D.a)(Xa,"ContractEntityAnnotationHandler",null,[55]);var ob=c(3);class xb{constructor(Sa){this.ga=Sa}Xmn(){this.cancelSearch()}cpn(Sa){this.ga.Qb(E.a.JVd,
2,Sa)}tsn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(ob.a.y4b,2)}Fun(){this.ga.processAction(ob.a.ulf,2)}onSearchQueryChanged(Sa){this.ga.Qb(ob.a.vlf,2,Sa)}rwn(){this.ga.processAction(E.a.replace,2)}swn(){this.ga.processAction(E.a.replaceAll,2)}nwn(){this.ga.processAction(I.a.qlf,2)}own(){this.ga.processAction(I.a.Ilf,2)}qwn(){this.ga.processAction(ob.a.S2f,2)}pwn(){this.ga.processAction(ob.a.XTf,2)}ajc(Sa){this.ga.Qb(E.a.ajc,2,Sa)}}Object(D.a)(xb,"FindReplaceActions",null,[502]);
var zb=c(252);class Lb{}Lb.ZP=zb.a.sib;Lb.Rhc=0;Lb.Rva="FindReplaceTaskPaneData";Lb.pS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(Lb,"FindReplaceConstants",null,[]);var Ia=c(773);class Ya{XCj(Sa){var wb,Tb,Hb;return oa.a.vjb(null===(Hb=null===(Tb=null===(wb=n.StaticActiveAppFrame.za())||void 0===wb?void 0:wb.jb)||void 0===Tb?void 0:Tb.Zc)||void 0===Hb?void 0:Hb.xd,Sa)}clearSelection(){if(this.kJe){const Sa=this.XCj(this.kJe);Sa&&Sa.una()}this.kJe=this.Bfh=null}ido(Sa){this.clearSelection();
if(Sa){const wb=this.XCj(Sa.parentPath);if(wb){const Tb=Sa.content;Tb&&(this.Bfh=Sa.id,wb.BUa([new Ia.a(Tb.range.start,Tb.range.start+Tb.range.length)]),wb.dPf(0,1));this.kJe=Sa.parentPath}}}}Object(D.a)(Ya,"RangeAnnotationContentSelector",null,[]);var eb=c(1650);class sb{constructor(Sa){this.mak=Sa}get Sj(){return this.mak.value}U6l(Sa){Sa=this.Sj.$2a(Sa);return this.FNm(Sa)?null:Sa}FNm(Sa){return Sa.id===this.Sj.gFa.id}static get instance(){return null!=sb.cCg?sb.cCg:sb.cCg=sb.gF()}static gF(){const Sa=
new z.a(()=>y.FindManager.instance.Sj);return new sb(Sa)}}Object(D.a)(sb,"SearchResultOrder",null,[]);var lc=c(8),vb=c(206);class Eb{constructor(Sa){this.HJe=Sa}get nI(){return this.HJe.value}getSelectedText(){var Sa=this.nI.y4;if(Sa){const wb=Sa.cpBegin,Tb=Sa.cpEnd-wb;if(0<Tb&&(Sa=Sa.node,lc.ParagraphReader.Xb(Sa)))return Sa.characterData.substr(wb,Tb)}return null}static getInstance(){return Eb.fm()}static fm(){const Sa=new z.a(()=>vb.a.instance);return new Eb(Sa)}}Object(D.a)(Eb,"SelectionHelper",
null,[]);var Ua=c(32),Ta=c(123),Nb=c(371),Wa=c(870),Bb=c(243),Ob=c(372),hc=c(1884),Gc=c(373);class bc extends va.a{constructor(Sa,wb,Tb){super(Sa,wb,na.a.aia());this.sIa=Tb;this.Pni=!1}get a2d(){return!0}get p9(){return super.p9|248}static pcf(Sa){var wb=n.StaticActiveAppFrame.za().jb.Zc;const Tb=Gc.a.instance.Pc(3);return wb&&(wb=Ca.PageNavigator.instance.hP(wb))?(Sa=new bc(new ta.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),Sa),Tb.r$c(Sa.$b),Sa.YE(wb),Tb.dispose(),Sa.Pni=!0,Sa):null}}Object(D.a)(bc,
"WordNavigationPaneReactHeadingsView",va.a,[124,113,10]);class Dc extends K{constructor(Sa,wb,Tb,Hb,$a,ab,rb,cb,rc,Rb,fb,Pb,Ec){var uc,ya,db;super(Sa);this.hvb=Lb.ZP;this.Amk="FindReplaceTaskPaneProps";this.Vb=L.FocusManager.instance();this.SWa=this.uNa=this.h_=this.QUe=null;this.VUb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.orc=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.msd=(null===(uc=a.AFrameworkApplication.K)||void 0===uc?void 0:uc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",
!1))||(null===(ya=a.AFrameworkApplication.K)||void 0===ya?void 0:ya.$("NavPaneReactHeadings"));this.$bk=null===(db=a.AFrameworkApplication.K)||void 0===db?void 0:db.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.TGj=()=>{this.isVisible&&this.oKd===v.a.intelligentPlaceholder&&this.Lm()};this.lB=new S.a;this.OXg=wb;this.iLa=v.a.headings;this.oFc=l.a.initial;this.ata=new wa.a;this.sQ="";this.Cvc={matchCase:!1,matchWholeWord:!1};this.DQe="";this.rSe=null;this.J3=Tb;
this.khh=!1;this.Rdb=Hb;this.hb=$a;this.pck=ab;this.XCa=rb;this.MI=cb;this.etd=!0;this.v7=this.u7=!1;this.Je=rc;this.xH=Rb;this.Ib=fb;this.$V=Pb;this.FQg=Ec;this.nue&&this.XCa.hZn(()=>{this.Lm()})}get yVe(){return 1}get nue(){return this.VUb&&this.orc&&!!this.Je}get oue(){return this.VUb&&this.$bk&&!!this.Je}get headingsReady(){return this.msd?this.xH.headingsReady:this.und?this.und.headingsReady:!1}set headingsReady(Sa){this.msd?this.xH.headingsReady=Sa:this.und&&(this.und.headingsReady=Sa)}get oKd(){return this.iLa}Lsj(){this.iLa=
v.a.headings;this.Lm()}Qwo(){this.iLa=v.a.contracts;this.Lm()}Csj(){this.iLa=v.a.find;aa.a("NavigationPaneFind");this.Lm()}wtj(){this.iLa=v.a.replace;this.Lm()}Xsj(){this.iLa=v.a.intelligentPlaceholder;this.Lm()}iad(Sa){this.khh=Sa;this.Lm()}ZRc(){return this.oKd===v.a.replace}get zG(){return this.oFc}l8(Sa){this.oFc=Sa;this.Lm()}M_e(Sa){this.xvk(Sa);this.Lm()}xvk(Sa){const wb=this.pck(Sa[Sa.length-1]);if(wb){let Tb=-1;for(let Hb=0;Hb<this.ata.count;Hb++)if(wb.id===this.ata.J(Hb).id){Tb=Hb;break}-1===
Tb?t.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.ata.$C(Tb,this.xKh(Sa))}else this.ata.addRange(this.xKh(Sa))}rbj(Sa){for(const wb of Sa)for(Sa=this.ata.count-1;0<=Sa;Sa--)if(this.ata.J(Sa).id===wb.id){this.ata.removeAt(Sa);break}this.Lm()}iIj(Sa){for(const wb of Sa)for(Sa=this.ata.count-1;0<=Sa;Sa--)if(this.ata.J(Sa).id===wb.id){this.ata.Z(Sa,this.wKh(wb));break}this.Lm()}YEh(){this.ata.clear();this.rSe=null;this.Lm()}cge(Sa){this.rSe=Sa?Sa.id:null;this.Lm()}xKh(Sa){if(!Sa)return new wa.a;
const wb=new wa.a;for(const Tb of Sa)wb.add(this.wKh(Tb));return wb}wKh(Sa){const wb=this.Rdb.WJd(Sa);return{id:Sa.id,searchBeginIndex:wb.Xee,searchEndIndex:wb.Vee,searchResult:wb.EId}}xoe(){}R_o(){var Sa={};this.JN.ajc(Sa);Sa=Sa[Q.a.Value];this.QUe=ba.c(Sa)?"":Sa;this.Lm()}oQa(){return this.sQ}eHb(){return this.DQe}Mdg(Sa){this.sQ=Sa;this.Lm()}clearSearch(){}initialize(){this.Jxd=window.performance.now();const Sa=this.Vb.fe(this.hvb);Sa.parent=N.AFrame.Ap;Sa.fI=!0;this.S_();this.l8(l.a.initial)}WP(){this.isVisible?
(t.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),O.UISurfaces.Pu().then(Sa=>{Sa.setSelectedTaskPane(this.hvb,this.yVe);this.G$();this.etd&&this.Rnj(!0);return null}).catch(Sa=>{Dc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Sa)})):(this.qad(),this.etd&&this.Rnj(!1))}Rnj(Sa){const wb=this.OXg();wb?this.sQ=wb:Sa&&this.sQ||(this.sQ="");this.JN.onSearchQueryChanged(this.sQ)}cpa(){O.UISurfaces.Pu().then(Sa=>{Sa.hideTaskPane(this.hvb,
this.yVe);return null}).catch(Sa=>{Dc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Sa)})}S_(){this.J3.dPa();this.h_=this.J3.k6b(this.Vb);this.gtk()}qad(){O.UISurfaces.Pu().then(Sa=>{this.Jxd=window.performance.now();Sa.showTaskPane(this.hvb,this.xA());Sa=[Object.assign(new Ua.a,{name:"Tab",string:this.iLa})];const wb=window.performance.now()-this.Jxd;aa.a("NavigationPaneOpen",!0,wb,Sa);return null}).catch(Sa=>{Dc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],
Sa)})}Lm(){O.UISurfaces.Pu().then(Sa=>{Sa.updateTaskPane(this.hvb,this.xA());return null}).catch(Sa=>{Dc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Sa)})}xA(){const Sa={activeTab:v.a.initial};this.lB.iqb(Sa);return Object.assign(new X.a,{title:Lb.pS,hideHeader:!1,width:320,location:this.yVe,contentProps:Sa,onOpen:()=>{this.Vs=!0;this.EYn();this.JVn();this.etd&&this.G$();n.StaticActiveAppFrame.za().updateCommandUI();n.StaticActiveAppFrame.za().I_a(this.TGj)},onClose:()=>
{try{const wb=window.performance.now();this.nea();this.Vs=!1;this.fTo();this.JTo();this.JN.tsn();this.QUe="";this.oFc=l.a.initial;n.StaticActiveAppFrame.za().Gjc(this.TGj);n.StaticActiveAppFrame.za().updateCommandUI();const Tb=window.performance.now()-wb;aa.a("NavigationPaneClose",!0,Tb)}catch(wb){Dc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],wb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}EYn(){this.nue&&!this.uNa&&oa.a.ll().then(()=>{this.uNa=
new Na(this.XCa);this.Je.ob(this.uNa,this.uNa.annotationType);this.Je.getAnnotationsByType(this.uNa.annotationType).then(Sa=>{this.uNa.z4c(Sa)})})}JTo(){this.nue&&this.uNa&&(this.Je.uc(this.uNa,this.uNa.annotationType),this.uNa=null)}IOo(){if(this.oue){var Sa=new hc.ContractEntitySignal;Sa=Object.assign(new Wa.a,{parentPath:["Signal",Bb.a.getTypeNameFor(Sa)],items:[Object.assign(new Ob.a,{body:Sa})]});this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Nb.a,{operation:Sa}))}}JVn(){this.oue&&
!this.SWa&&oa.a.ll().then(()=>{this.SWa=new Xa(this.Lm);this.Je.ob(this.SWa,hc.ContractEntityAnnotation.getTypeName());this.IOo();this.Je.getAnnotationsByType(hc.ContractEntityAnnotation.getTypeName()).then(Sa=>{this.SWa.z4c(Sa)})})}fTo(){this.oue&&this.SWa&&(this.Je.uc(this.SWa,hc.ContractEntityAnnotation.getTypeName()),this.SWa=null)}gtk(){this.lB.GL(this.FYl());this.lB.GL(this.HYl());this.lB.GL(this.g0l());this.lB.GL(this.XTl());this.lB.GL(this.b2l());this.lB.GL(this.SMl());this.lB.GL(this.onLinkExecute());
this.lB.GL(this.onPivotTabExecute());this.lB.GL(this.Tem());this.lB.GL(this.Shm());this.lB.GL(this.H1l());this.lB.GL(this.Him());this.lB.GL(this.dcm())}Him(){return Sa=>{Sa.autoDetectedHeadingsToggleDisabled=this.XCa?!this.XCa.qJk():!0}}Shm(){return Sa=>{Sa.type=this.Amk}}onLinkExecute(){return Sa=>{Sa.onLinkExecute=()=>{this.JN.Fun()}}}onPivotTabExecute(){return Sa=>{Sa.onPivotTabExecute=wb=>{switch(wb){case v.a.headings:this.Lsj();break;case v.a.replace:this.wtj();break;case v.a.contracts:this.Qwo();
break;case v.a.intelligentPlaceholder:this.Xsj();break;default:this.Csj()}ba.b(this.sQ)&&(this.sQ=this.OXg(),this.sQ||(this.sQ=""),ba.b(this.sQ)||(this.JN.onSearchQueryChanged(this.sQ),this.Lm()))}}}Tem(){return Sa=>{Sa.showOutOfSyncNotification=this.khh}}HYl(){return Sa=>{Sa.findSearchBoxContent={onSearchQueryChanged:wb=>{this.sQ=wb;this.Lm();this.JN.onSearchQueryChanged(wb)},findOptions:this.Cvc,matchCase:this.u7,matchWholeWord:this.v7,findSearchText:this.sQ,onClearButtonExecute:()=>{void 0!==this.sQ&&
null!==this.sQ&&""!==this.sQ&&(this.sQ="",this.hb.Ac(null),this.JN.Xmn())},onMatchCaseExecute:()=>{this.Cvc.matchCase=!this.Cvc.matchCase;this.u7=!this.u7;this.Lm();this.JN.nwn()},onMatchWholeWordExecute:()=>{this.Cvc.matchWholeWord=!this.Cvc.matchWholeWord;this.v7=!this.v7;this.Lm();this.JN.own()},onMenuClose:()=>{if(this.h_)this.h_.onMenuClose()},onMenuOpen:()=>{if(this.h_)this.h_.onMenuOpen()}}}}SMl(){return Sa=>{Sa.activeTab=this.oKd}}H1l(){return Sa=>{Sa.autoDetectedHeadingsToggleState=this.XCa?
this.XCa.X3e:!1;this.xH.XNc=Sa.autoDetectedHeadingsToggleState;!Sa.autoDetectedHeadingsToggleState&&this.XCa&&this.XCa.$nc(!1)}}FYl(){return Sa=>{const wb={onReplaceAllExecute:()=>{this.JN.swn()},onReplaceExecute:()=>{this.JN.rwn()},onReplaceQueryChanged:Tb=>{this.DQe=Tb;this.Lm()},replaceSearchText:this.DQe};Sa.findReplaceContent={searchResults:this.ata.toArray(),replaceSearchBoxContent:wb,onNextSearchResultExecute:()=>{this.JN.pwn()},onPrevSearchResultExecute:()=>{this.JN.qwn()},onSearchResultSelected:Tb=>
{const {FindReplaceUIManager:Hb}=c(1670);this.JN.cpn(Tb);Hb.KLi(1)},selectedResultId:this.rSe,summaryLabel:this.QUe,explanationText:this.VXl(this.oFc),haveTooManySearchResults:this.oFc===l.a.tooManyResults}}}VXl(Sa){switch(Sa){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return eb.a.tgi();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;
default:return""}}dcm(){return Sa=>{Sa.replaceFollowUpsWithCommentsIsEnabled=!0}}b2l(){return Sa=>{var wb=this.MI.INl();const Tb=[];for(const Hb of wb)wb=this.MI.AQd(Hb.Mc,Hb.id),Tb.push({id:Hb.id.toString(),intelligentPlaceholderAnchorText:wb});Sa.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Tb,onIntelligentPlaceholderInputExecute:Hb=>{this.sQ=Hb;this.iLa=v.a.find;this.Lm();this.JN.onSearchQueryChanged(Hb)},onSearchResultSelected:Hb=>{this.Lm();Hb=e.a.If(Hb);this.MI.sdo(Hb)}}}}g0l(){return Sa=>
{let wb=()=>{};this.XCa&&(wb=Object(ia.a)(this.XCa,this.XCa.$nc,"toggleAutoDetectedHeadings"));Sa.headingsContent={onHeaderInputExecute:Tb=>{this.sQ=Tb;this.iLa=v.a.find;this.Lm();aa.a("NavigationPaneFind");this.JN.onSearchQueryChanged(Tb)},renderHeadingContent:(Tb,Hb,$a)=>{this.Ib.Wb(new U.a(0,1,100,()=>{var ab=window.performance.now()-this.Jxd;if(this.msd){var rb=this.xH.h$;this.headingsReady=!0;this.Lm();$a.style.display="none";rb.first&&(Tb.style.display="block");this.Ib.Wb(new U.a(1,1,0,()=>
{bc.pcf(this)}))}else this.und=fa.pcf(Tb,Hb,$a),this.Lm();rb=window.performance.now()-this.Jxd;aa.a("NavigationPaneHeadingsLoaded",!0,rb,[Object.assign(new Ua.a,{name:"NavPaneReactHeadings",bool:this.msd})]);ab=[Object.assign(new Ua.a,{name:"HeadingFetchStart",double:ab}),Object.assign(new Ua.a,{name:"HeadingFetchFinished",double:rb})];aa.a("NavigationPaneHeadingsLoadDetails",!0,void 0,ab)}))},autoDetectedHeadingsToggle:wb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,
headingsList:this.xH.h$,onHeadingChevronClick:Tb=>{this.xH.bAl(Tb);this.Lm()},onClickHeading:Tb=>{if(this.Ib.Qv){t.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",Tb);const Hb=window.performance.now();this.Ib.Wb(new U.a(0,1,0,()=>{this.xH.onClickHeading(Tb);this.Lm();const $a=window.performance.now()-Hb;aa.a("NavigationPaneAsyncOnClickHeadingItem",!0,$a)}))}else this.xH.onClickHeading(Tb),this.Lm()},onClickBookmark:Tb=>
{if(this.Ib.Qv){t.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",Tb);const Hb=window.performance.now();this.Ib.Wb(new U.a(0,1,0,()=>{this.xH.onClickBookmark(Tb);this.Lm();const $a=window.performance.now()-Hb;aa.a("NavigationPaneAsyncOnClickHeadingItem",!0,$a)}))}else this.xH.onClickBookmark(Tb),this.Lm()},onShareHeadingClick:Tb=>{this.xH.onShareHeadingClick(Tb)},bookmarkIconUrl:Aa.a.xg("BookmarkDefault.png")}}}WTl(){var Sa,
wb=null===(Sa=this.SWa)||void 0===Sa?void 0:Sa.q9b();if(wb){Sa=Array(wb.length);let Tb=0;for(const Hb of wb)(wb=Hb.content)&&(Sa[Tb++]={id:Hb.id,type:wb.type,value:wb.value});return Sa}return null}XTl(){return Sa=>{Sa.contractsContent={onHeaderInputExecute:wb=>{this.sQ=wb;this.iLa=v.a.find;this.Lm();aa.a("NavigationPaneFind");this.JN.onSearchQueryChanged(wb)},contractEntities:this.WTl(),selectedEntityId:this.FQg.Bfh,onEntitySelected:wb=>{var Tb;const Hb=null===(Tb=this.SWa)||void 0===Tb?void 0:Tb.q9b();
if(Hb)for(const $a of Hb)if($a.id===wb){this.FQg.ido($a);break}this.Lm()}}}}inj(Sa){this.etd=Sa}YYo(Sa){this.Ib.Wb(new U.a(0,1,0,()=>{this.xH.iqg(Sa)&&this.Lm()}))}umi(Sa){this.Ib.Wb(new U.a(0,1,0,()=>{const wb=this.xH.jOb;this.xH.tll(Sa)?this.Lm():0===this.xH.jOb&&0<wb&&this.Lm()}))}upg(Sa,wb){this.Ib.Wb(new U.a(0,1,0,()=>{const Tb=this.xH.jOb;this.xH.upg(Sa,wb)?this.Lm():0<this.xH.jOb&&0===Tb&&this.Lm()}))}Kkl(Sa){this.Ib.Wb(new U.a(0,1,0,()=>{const wb=this.xH.jOb;this.xH.Lkl(Sa)?this.Lm():0===
this.xH.jOb&&0<wb&&this.Lm()}))}vpo(Sa){this.xH.cMo(Sa);this.Lm()}Upg(Sa){this.xH.Upg(Sa)&&this.Lm()}fLd(Sa){this.xH.fLd(Sa)&&this.Lm()}WLn(){return 0<this.xH.jOb}G$(){this.Vb.mg(this.hvb);t.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}nea(){if(this.e5a()){var Sa;(Sa=za.InteractiveViewManager.instance.yd)?(Sa=Sa.uJ,t.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Sa=this.Vb.iU,t.ULS.sendTraceTag(40469192,312,50,
"Taskpane now hidden with focus on default scope."));this.Vb.mg(Sa)}}e5a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.hvb}static getInstance(){return Dc.fm()}static fm(){return new Dc(new xb(a.AFrameworkApplication.va),Object(ia.a)(Eb.getInstance(),Eb.getInstance().getSelectedText,"getSelectedText"),xa.a.instance,H.a.instance,ka.a.instance,Object(ia.a)(sb.instance,sb.instance.U6l,"getNextSearchResult"),x.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
x.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),T.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new Ya)}static recordQosError(Sa,wb,Tb){const Hb=Object.assign(new Ta.a,{extendedProperties:new Map});Tb&&Hb.extendedProperties.set("exception",Tb);Y.Health.instance.recordQosError(Sa,wb,!1,!0,!1,!1,Hb)}}Object(D.a)(Dc,
"ReactFindReplacePane",K,[493,494,10]);var Ub=c(1608);c.d(J,"FindReplaceUIManager",function(){return Fc});class Fc{constructor(Sa,wb,Tb=null,Hb=null,$a=null,ab=null){this.Jjd=this.i3=0;this.v7=this.u7=this.Vzb=!1;this.qm=this.U8g=this.Xka=null;this.OGa=this.AHe=!1;this.mj=Sa;this.Xo=Tb;this.Rdb=Hb;this.z5g=$a;this.je=ab;Fc.o4b=new M}get XHf(){return this.AHe}set XHf(Sa){Sa!==this.AHe&&(this.AHe=Sa,this.IDh())}hie(Sa){this.i3=Sa;this.update();this.i3||this.zG!==l.a.searchComplete&&this.zG!==l.a.tooManyResults?
0<this.i3&&this.zG===l.a.noMatchesFound?this.l8(l.a.searchComplete):this.i3>Fc.IAj&&this.zG!==l.a.tooManyResults&&(t.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.l8(l.a.tooManyResults)):this.l8(l.a.noMatchesFound)}Dge(Sa){this.Jjd=Sa;this.OGa&&this.update();this.z5g&&!this.z5g.value.w7c&&this.idg()}reset(){}Glf(){this.je&&(this.qm=this.je.Yf("UserAction","Find"));if(this.OGa||!this.zG)this.OGa=!1,t.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.l8(l.a.searching)}F8b(){var Sa;
this.OGa=!0;let wb=this.i3?l.a.searchComplete:l.a.noMatchesFound;if(this.zG!==l.a.tooManyResults&&y.FindManager.instance){const Tb=y.FindManager.instance.Sj;0<Tb.Aka&&(Tb.Aka>Fc.IAj?wb=l.a.tooManyResults:this.a_o(Tb))}this.l8(wb);this.update();this.qm&&(this.qm.stop(),this.qm=null);Fc.zij=e.a.create().toString();Fc.KLi(0,this.B6b,this.oQa().length,this.i3);Object(Ub.b)()&&(null===(Sa=this.mj)||void 0===Sa?0:Sa.isVisible)&&(Sa={},a.AFrameworkApplication.va.Qb(I.a.vce,2,Sa),Sa[k.a.On]&&a.AFrameworkApplication.va.Qb(I.a.ZYd,
2,{CommandValueId:{query:this.oQa(),matchCase:this.u7,matchWholeWordOnly:this.v7,totalResultLimit:-1}}))}a_o(Sa){const wb=Sa.gFa;let Tb=wb;const Hb=[];do Hb[Hb.length]=Tb,Tb=Sa.$2a(Tb);while(wb!==Tb);this.mj.M_e(Hb);this.Xka&&this.mj.cge(this.Xka)}update(){this.mj&&this.mj.R_o()}get zG(){return this.mj.zG}get B6b(){return this.mj.oKd}lqb(Sa){this.XHf=Sa}IDh(){if(this.XHf)switch(this.zG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.mj.iad(!0)}else this.mj.iad(!1)}l8(Sa){if(this.mj.isVisible){switch(Sa){case l.a.noMatchesFound:case l.a.searchComplete:this.zG===
l.a.tooManyResults&&(Sa=l.a.tooManyResults)}this.mj&&(this.mj.l8(Sa),this.IDh());this.update();this.idg()}}OPa(Sa,wb){const Tb=this.OGa&&this.zG!==l.a.tooManyResults;switch(Sa){case 0:Tb&&this.mj.M_e(wb);break;case 1:Tb&&this.mj.rbj(wb);break;case 4:Tb&&this.mj.iIj(wb);break;case 2:this.mj.YEh();break;case 3:this.Xka=wb[0],Tb&&0<this.i3&&this.mj.cge(this.Xka)}}get matchCase(){return this.u7}set matchCase(Sa){this.u7!==Sa&&(this.u7=Sa,this.rGj())}get matchWholeWord(){return this.v7}set matchWholeWord(Sa){this.v7!==
Sa&&(this.v7=Sa,this.rGj())}rGj(){this.mj.xoe()}oQa(){return this.mj.oQa()}eHb(){return this.mj.eHb()}Mdg(Sa){this.mj.Mdg(Sa)}clearSearch(){this.mj.clearSearch()}get xtj(){return 0<this.i3&&this.zG!==l.a.replaceAllInProgress&&this.zG!==l.a.replaceAllComplete}gho(Sa){let wb="";Sa?wb=0<this.i3?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.oQa(),this.eHb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.oQa(),this.eHb()):
Sa||0<this.i3&&(wb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.idg(wb)}dispose(){this.mj.dispose()}ZRc(){return this.mj.ZRc()}$lo(Sa,wb=!0){Sa!==this.B6b&&(Sa===v.a.headings?(t.ULS.sendTraceTag(9056651,367,50,""),this.mj.Lsj()):Sa===v.a.find?this.mj.Csj():Sa===v.a.replace?this.mj.wtj():Sa===v.a.intelligentPlaceholder&&(wb||this.mj.inj(wb),this.mj.Xsj()))}kC(Sa,wb=!0){this.mj.inj(wb);Sa?(this.Vzb||this.gCf(),this.mj.WP(),this.i3||this.zG===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.mj.l8(l.a.searchComplete):this.l8(l.a.initial)):this.mj.cpa()}gCf(){this.Vzb||(this.mj.initialize(),this.Vzb=!0)}idg(Sa=""){var wb=this.scm();wb&&(Sa=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Sa,wb));this.Rdb&&wb&&this.Xka&&this.zG!==l.a.tooManyResults&&this.zG!==l.a.replaceAllInProgress&&(wb=this.Rdb.WJd(this.Xka),Sa=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Sa,wb.EId));(wb=this.UXl())&&(Sa=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Sa,wb));this.Xo&&Sa&&this.U8g!==Sa&&(this.U8g=Sa,this.Xo.sendNotification(Sa,!0))}scm(){let Sa="";switch(this.zG){case l.a.startSearch:Sa=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:Sa=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.Jjd,this.i3);break;case l.a.tooManyResults:this.OGa&&(Sa=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.Jjd,this.i3));break;case l.a.noMatchesFound:Sa=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:Sa=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:Sa=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Sa}UXl(){let Sa="";switch(this.zG){case l.a.initial:Sa=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.zYl());break;case l.a.noMatchesFound:Sa=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:Sa=eb.a.tgi();break;case l.a.tooManyResults:Sa=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Sa}zYl(){let Sa="";this.u7&&this.v7?Sa=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.u7?Sa=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.v7&&(Sa=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Sa}static getInstance(Sa){return Fc.fm(Sa)}static fm(Sa){const wb=Dc.getInstance();return new Fc(wb,Sa,x.a.instance.resolve("Common.Utils.IAriaNotifier"),H.a.instance,new z.a(()=>y.FindManager.instance.jPb),n.StaticActiveAppFrame.za().Kq)}static KLi(Sa,wb=-1,Tb=-1,Hb=-1){t.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Sa,
["SearchComplete.ResultsCount"]:Hb,["SearchOpsCorrelation"]:Fc.zij,["ActionId"]:Fc.o4b.actionId,["SourceControlId"]:Fc.o4b.lJa,["IsNavPanOpenedAlready"]:Fc.o4b.mRm,["IsSearchFromNavPane"]:Fc.o4b.NUm,["CurrentTab"]:wb,["QueryLength"]:Tb})}static TQk(Sa,wb,Tb){wb=void 0!==wb&&null!==wb?void 0===wb.SourceControlId||null===wb.SourceControlId?"Unknown":wb.SourceControlId:Sa===E.a.Gqb?"FindKeyboardShorcut":Sa===E.a.Iqb?"ReplaceKeyboardShorcut":"Unknown";switch(Sa){case E.a.imc:Sa="ShowHeadingsPane";break;
case E.a.Gqb:Sa="ShowFindPane";break;case E.a.Iqb:Sa="ShowReplacePane";break;case E.a.lmc:Sa="ShowIntelligentPlaceholderPane";break;case E.a.$8a:Sa="ToggleNavigationPane";break;default:Sa="Unknown"}Fc.o4b=new M(Sa,wb,Tb,!0)}}Fc.IAj=100;Fc.zij=null;Fc.o4b=null;Object(D.a)(Fc,"FindReplaceUIManager",null,[467,468,10])},1671:function(D,J,c){c.r(J);D=c(0);var l=c(177),e=c(102),a=c(79),k=c(2),x=c(22),y=c(67),n=c(1108),t=c(125),z=c(25),v=c(7),I=c(14),E=c(252),H=c(475),M=c(1570),K=c(1847),L=c(30),S=c(337),
Q=c(10),N=c(451),O=c(17),X=c(268),U=c(49),T=c(538),Y=c(1718);class aa{constructor(Ia,Ya,eb,sb,lc,vb,Eb){this.G8g=this.Ybh=this.RWg=this.LI=this.n$a=this.pUb=this.dCe=this.$xe=this.Hze=this.vW=this.Jfa=this.Ufa=null;this.koe=()=>{const Ua=this.Tta.Y9b(this.LI),Ta=this.Tta.PZl(this.LI);this.$xe.innerText=Ua.toString();this.dCe.innerText=Ta.toString();K.a.jQb(this.Ufa,1===Ua?!1:!0);K.a.jQb(this.Jfa,Ua===Ta?!1:!0)};this.wjo=()=>{const Ua=this.Vb.getRegion(E.a.i2a);let Ta;if(this.vW&&!this.vW.disabled)Ta=
this.vW;else if(this.Ufa.disabled){if(this.Jfa.disabled)return;Ta=this.Jfa}else Ta=this.Ufa;Ta.focus();Ua.hk.iz(Ta)};this.Uqa=(Ua,Ta)=>{(Ua=Ta.yl.lb)&&this.vW&&K.a.jQb(this.vW,O.SelectionEditor.Pl(Ua)?!0:!1)};this.O8e=()=>{if(!this.Jfa.disabled){const Ua=this.Tta.plb(this.LI)?I.a.U5d:I.a.T5d;this.ga.processAction(Ua,2)}return!0};this.P8e=()=>{if(!this.Ufa.disabled){const Ua=this.Tta.plb(this.LI)?I.a.W5d:I.a.V5d;this.ga.processAction(Ua,2)}return!0};this.N8e=()=>{this.vW&&!this.vW.disabled&&this.ga.processAction(I.a.NGi,
2);return!0};this.Vb=Ia;this.ga=sb;this.ig=lc;this.ge=vb;this.hb=Eb;this.Tta=eb;this.v8=document.createElement("div");this.v8.classList.add("FootnoteEndnoteActionBarControl");this.v8.style.zIndex=String(X.a.CMd);this.v8.style.position="relative";this.Auc=document.createElement("div");this.Auc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.v8.appendChild(this.Auc);this.v9k();this.v8.appendChild(this.pUb);this.v8.appendChild(this.n$a);this.$Z=e.KeyInputManager.ic(a.a.l2,0);this.EBm();
this.DBm()}rha(Ia){v.ULS.shipAssertTag(4520065,308,this.Tta.zpa(Ia));if(this.LI!==Ia){this.LI=Ia;this.koe();Ia=this.Tta.plb(this.LI);this.ebl(Ia);this.LI.urh(this.koe);let Ya="",eb="";const sb=this.Tta.Y9b(this.LI);-1!==sb&&(Ya=(sb-1).toString(),eb=(sb+1).toString());Ia?(this.Jfa.title=this.Jfa.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,eb),this.Ufa.title=this.Ufa.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:
String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Ya)):(this.Jfa.title=this.Jfa.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,eb),this.Ufa.title=this.Ufa.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ya));this.wIa()}}fEb(){this.LI&&(this.vW&&this.vW.parentNode===this.pUb&&this.pUb.removeChild(this.vW),this.Hka(),this.LI.s2n(this.koe),
this.LI=null)}dispose(){this.Vb.fe(E.a.i2a).mr(this.$Z)}ebl(Ia){3===this.ga.mode&&(Ia=Ia?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.vW=this.Uaf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Ia,null),L.a.kr(this.vW,L.a.Aga,Ia),this.pUb.appendChild(this.vW))}v9k(){this.pUb=document.createElement("div");this.pUb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.n$a=
document.createElement("div");this.n$a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.Ufa=this.Uaf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.n$a.appendChild(this.Ufa);this.$xe=N.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.n$a.appendChild(this.$xe);this.Hze=N.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.Hze.innerText=" / ";
this.n$a.appendChild(this.Hze);this.dCe=N.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.n$a.appendChild(this.dCe);this.Jfa=this.Uaf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.n$a.appendChild(this.Jfa)}Uaf(Ia,Ya,eb,sb){Ia=K.a.V0a(Ia,Ya,eb,sb,void 0===sb||null===sb);Ia.setAttribute(L.a.uh,L.a.Z3);return Ia}EBm(){const Ia=this.Vb.fe(E.a.i2a);Ia.parent=t.AppFrame.Ap;Ia.bindAction(this.$Z,I.a.r4);Ia.sga(this.wjo)}DBm(){var Ia=
new S.DOMFocusListing(()=>this.v8);Ia.Lja=!1;Ia.Qm(2);Ia.Qm(1);Ia=this.Vb.Qfb(this.v8,this.Vb.fe(E.a.i2a),Ia);Ia.TTa();Ia.yP=!0}wIa(){this.vW&&(this.ig.ob(Q.a.click,this.vW,this.N8e),this.RWg=this.ge.fpb(this.vW,this.N8e,a.a.Rs));this.ig.ob(Q.a.click,this.Ufa,this.P8e);this.Ybh=this.ge.fpb(this.Ufa,this.P8e,a.a.Rs);this.ig.ob(Q.a.click,this.Jfa,this.O8e);this.G8g=this.ge.fpb(this.Jfa,this.O8e,a.a.Rs);this.hb.Xw(this.Uqa)}Hka(){this.vW&&(this.ig.uc(Q.a.click,this.vW,this.N8e),this.ge.Vrb(this.vW,this.RWg));
this.ig.uc(Q.a.click,this.Ufa,this.P8e);this.ge.Vrb(this.Ufa,this.Ybh);this.ig.uc(Q.a.click,this.Jfa,this.O8e);this.ge.Vrb(this.Jfa,this.G8g);this.hb.jZ(this.Uqa)}static KZl(){return aa.LZl()}static LZl(){return new aa(y.FocusManager.instance(),Y.a.instance,T.a.instance,k.AFrameworkApplication.va,z.StaticActiveAppFrame.za().nD,z.StaticActiveAppFrame.za().oD,U.a.instance)}}Object(D.a)(aa,"FootnoteEndnoteActionBarControl",null,[454]);var ba=c(232),oa=c(12),ma=c(1628),ea=c(1809);class ua{constructor(Ia,
Ya,eb,sb,lc,vb,Eb,Ua,Ta,Nb,Wa,Bb){this.GE=null;this.jT=!1;this.dw=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.c_b=Ia;this.B7b=Ya;this.Kqc=eb;this.Udk=sb;this.IMe=lc;this.nm=vb;this.Bbb=Eb;this.ig=Ua;this.Fah=Ta;this.y1j=Wa;this.Mr=this.c_b.ownerDocument.createElement("div");this.Mr.id="FootnoteEndnoteControlOverlay";this.Mr.className="EditingSurfaceOverlay";this.CI=this.YTl();this.F1(!1);this.c_b.appendChild(this.Mr);this.c_b.appendChild(this.CI);this.B7b.bind();this.ai=null;this.ga=
Bb;this.NLa=Nb}k7n(){const Ia=this.Fah();Ia&&Ia.$i&&(Ia.Jpb=0,Ia.RCd())}oFj(Ia){if(this.pHc){const Ya=this.pHc.xoa;Ya&&(Ya.FFf=Ia)}}get cI(){return this.jT}get pHc(){return this.GE}get dialog(){return this.ai}get Go(){return null!=this.aBg?this.aBg:this.aBg=x.a.instance.Sa("Common.IZoomManager")}wbf(){this.ai=ea.a.TZl()}Q7c(){this.ai=null}show(Ia=!0){this.jT||(this.oFj(!0),this.y1j(),this.F1(!0),this.Qz(),Ia&&this.setFocus())}setFocus(){this.jT&&(this.B7b.setInitialSelection(),this.Udk())}update(){this.jT&&
(this.GE.isConnected?this.Kqc.koe():this.dismiss())}dismiss(Ia=!1,Ya=!1){this.jT&&(this.oFj(!1),this.caa(),this.k7n(),this.F1(!1),this.IMe(Ya),this.ai&&(this.ga.processAction(oa.a.aMc,2),this.ai=null),!Ia&&this.GE&&this.GE.isConnected&&this.NLa.rdo(this.GE),this.fEb())}T5n(Ia){const Ya=null!==this.Go.instance?this.Go.instance.oj:1;this.CI.style.width=Ia.$Ih*Ya+"px";this.dw.style.width=Ia.cKc*Ya+"px";this.CI.style.marginLeft=Ia.w5b*Ya+"px";this.nm?this.dw.style.marginRight=Ia.faf*Ya+"px":this.dw.style.marginLeft=
Ia.G5b*Ya+"px";if(Ia=this.Fah())Ia=Ia.HL,this.CI.style.bottom=Ia.offsetHeight-Ia.clientHeight+"px"}rha(Ia){v.ULS.shipAssertTag(4520073,308,this.Bbb.zpa(Ia));this.GE!==Ia&&(this.GE=Ia,this.B7b.rha(Ia),this.Kqc.rha(this.GE))}dispose(){this.dismiss();this.B7b.dispose();this.Kqc.dispose()}Qz(){this.ig&&this.ig.ob(Q.a.click,this.Mr,this.onClick)}caa(){this.ig&&this.ig.uc(Q.a.click,this.Mr,this.onClick)}YTl(){let Ia;Ia=document.createElement("div");Ia.classList.add("FootnoteEndnoteControl");this.dw=document.createElement("div");
this.dw.classList.add("FootnoteEndnoteContent");this.dw.appendChild(this.B7b.v8);this.dw.appendChild(this.Kqc.v8);Ia.appendChild(this.dw);return Ia}F1(Ia){Ia=(this.jT=Ia)?"":"none";this.Mr.style.display=Ia;this.CI.style.display=Ia}fEb(){this.GE&&(this.B7b.fEb(),this.Kqc.fEb(),this.GE=null)}static GTd(){const Ia=z.StaticActiveAppFrame.za().jb.rc;return Ia&&Ia.$i?Ia:null}static OZl(Ia,Ya,eb,sb,lc){return new ua(Ia,Ya,eb,sb,lc,k.AFrameworkApplication.isRtl,T.a.instance,ba.a.instance,ua.GTd,ma.a.instance,
ua.fql,k.AFrameworkApplication.va)}static fql(){k.AFrameworkApplication.va.Qb(oa.a.mkb,2,!0)}}Object(D.a)(ua,"FootnoteEndnoteControl",null,[453]);var sa=c(820),Fa=c(5),Pa=c(207),Na=c(37),Aa=c(8),za=c(23),xa=c(78),ka=c(1717),wa=c(353),ia=c(985),va=c(588),na=c(1479),Ca=c(65),ta=c(111);class fa extends wa.a{constructor(Ia,Ya,eb,sb,lc,vb,Eb,Ua,Ta,Nb,Wa,Bb,Ob,hc,Gc,bc,Dc){super(E.a.Aha,eb,sb,lc,Eb,Ua,Ta,Nb,Wa,Bb,Ob,hc,Gc,bc,Dc);this.IQg=Ia;this.uZa=vb;this.uZa.Qbd=this;Ya(this);this.features.Ikg=!0}get Myi(){return!0}Nwf(){const Ia=
this.IQg.Nnf(this);return ia.ViewReference.mF(this,Ia)}lgf(Ia){Object(ta.a)(fa,Ia)||this.IQg.igf()}bSc(){return va.a.SPi}onResize(){super.onResize();this.uZa.eYh()}YE(Ia,Ya=null){super.YE(Ia,Ya);this.uZa.SXh(this.ed.yj)}detach(){this.uZa.dYh();super.detach()}TPd(){this.onResize()}static T0a(){const {FootnoteEndnoteControlManager:Ia}=c(1671);return new fa(Ia.instance,na.a.r$e,z.StaticActiveAppFrame.za().jb,Ca.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),
k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),x.a.instance.Sa("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Sa("Common.IZoomManager"),x.a.instance.Oa("Box4.IContentControlViewElementManager"),x.a.instance.Oa("Box4.CpConversionManagerImpl"),x.a.instance.Oa("Box4.ContentControlConfigSettings"),x.a.instance.Oa("Box4.IContentControlReader"),x.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}
Object(D.a)(fa,"FootnoteEndnoteEditView",wa.a,[]);class Xa{constructor(Ia,Ya,eb,sb=!1){this.nvb=null;this.oGe=this.yNg=!1;this.SIl=()=>{const lc=String.format("{0} {1}",this.oGe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Hv.sendNotification(lc,!0)};this.Vb=Ia;this.Tta=Ya;this.ufa=eb();this.Pod=sb;this.v8=
document.createElement("div");this.v8.classList.add("FootnoteEndnoteEditControl");this.Auc=document.createElement("div");this.Auc.classList.add("FootnoteEndnoteEditControlDividerElement");this.yAb=(new sa.a(this.v8,"WACViewPanel_FootnoteEndnoteEditControl")).vI;this.v8.appendChild(this.Auc);this.v8.appendChild(this.yAb)}get Hv(){return null!=this.Fwg?this.Fwg:this.Fwg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}rha(Ia){v.ULS.shipAssertTag(4520077,308,this.Tta.zpa(Ia));this.nvb!==Ia&&(this.nvb=
Ia,this.N3e(this.nvb),this.oGe=this.Tta.plb(this.nvb),this.Pod?(this.ufa.nQb(L.a.UDd),this.Vb.fe(E.a.Aha).S3(this.SIl)):this.ufa.Nlj(this.oGe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,L.a.UDd))}fEb(){const Ia=T.a.instance.plb(this.nvb)?"Footnote":"Endnote";v.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ia,["CalloutHeight"]:this.v8.scrollHeight});this.phb();this.nvb=null}bind(){this.yNg||
(this.ufa.GBb(this.yAb),this.yNg=!0)}setInitialSelection(){const Ia=this.bem();Ia?this.ufa.Ac(Ia):this.ufa.c$c()}dispose(){this.phb()}N3e(Ia){this.phb();this.ufa.YE(Ia,Ia.yj)}phb(){this.ufa.detach()}bem(){let Ia=0;var Ya=null,eb=Fa.GraphIterator.eb(this.nvb);Pa.OutlineNavigator.S9(eb);if((eb=Na.OutlineElementNavigator.Ee(eb))&&Aa.ParagraphReader.Xb(eb)){if(Ya=Xa.M2l(eb)){Ia=Ya.Lb.cp+1;Ya=ka.FootnoteEndnoteDefaultContentInserter.$Qh;const sb=Ya.length;Ia+sb<=Aa.ParagraphReader.textLength(eb)&&eb.characterData.substr(Ia,
sb)===Ya&&(Ia+=sb)}Ya=za.SelectionFactory.ne(eb,Ia)}return Ya}static QZl(){return Xa.RZl()}static RZl(){return new Xa(y.FocusManager.instance(),T.a.instance,()=>fa.T0a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static M2l(Ia){Ia=xa.i(Ia,10);return 0<Ia.length?Ia[Ia.length-1]:null}}Object(D.a)(Xa,"FootnoteEndnoteEditControl",null,[445]);var ob=c(1199);class xb{constructor(Ia,Ya){this.tCa=Ia;this.nm=Ya}Y$b(Ia,Ya){Ia=this.tCa.Y$b(Ia);var eb=Ya.clientWidth;const sb=
Ya.scrollLeft,lc=Ia.$Ih;let vb=Ia.w5b,Eb=Ia.w5b,Ua=xb.jQf,Ta=xb.kQf,Nb=lc,Wa=Ia.cKc;this.nm?Ta=Ia.faf-Eb:Ua=Ia.G5b-vb;eb<lc&&(vb=Math.max(vb-sb,0),Nb=eb-vb,this.nm?(eb=Ya.scrollWidth-sb-eb,Eb=Ya.scrollWidth-Ia.w5b-lc,Ta=Math.max(Ia.faf-eb-Eb,xb.kQf),Wa=Nb-Ta-xb.jQf):(Ua=Math.max(Ia.G5b-sb-vb,xb.jQf),Wa=Nb-Ua-xb.kQf));return new ob.a(vb,Nb,Ua,Ta,Wa)}}xb.jQf=25;xb.kQf=50;Object(D.a)(xb,"FootnoteEndnoteViewPositionProvider",null,[]);class zb{constructor(Ia,Ya=0,eb=0){this.clientWidth=Ia;this.scrollLeft=
Ya;this.scrollWidth=eb?eb:Ia}}Object(D.a)(zb,"PageViewScrollContainerSizeInfo",null,[]);c.d(J,"FootnoteEndnoteControlManager",function(){return Lb});class Lb{constructor(Ia,Ya,eb,sb,lc,vb,Eb,Ua){this.yE=null;this.G$=()=>{this.np.aJ(E.a.Aha);this.np.aJ(E.a.i2a);this.np.fx(l.AFrame.In);this.Vb.MFc(E.a.Aha);this.Vb.mg(E.a.Aha)};this.Ejo=Ta=>{this.np.fx(E.a.Aha);this.np.fx(E.a.i2a);this.np.aJ(l.AFrame.In);this.Vb.zLc(E.a.Aha);(Ta||this.Vb.currentScope&&(this.Vb.currentScope.name===E.a.Aha||this.Vb.currentScope.name===
E.a.i2a))&&this.Vb.mg(l.AFrame.In)};this.Vb=Ia;this.np=Ya;this.K4j=eb;this.L4j=sb;this.J4j=lc;this.tCa=vb;this.dta=Eb;this.k_=Ua;this.$Z=e.KeyInputManager.ic(a.a.l2,0);this.$Bf();this.MT()}get control(){return this.yE}get dialog(){return this.control.dialog}get Vwi(){return this.control.cI}wbf(){this.control.wbf()}Q7c(){this.control.Q7c()}bind(Ia){this.g5k(Ia)}shg(Ia){if(this.control.pHc!==Ia.O0a)this.control.dismiss();else if(this.Vwi)return;this.f7b();this.control.rha(Ia.O0a);this.control.show(Ia.yie)}f7b(){if(this.k_){const Ia=
new n.a(!0);this.k_.qIa(Ia)}}mZ(){this.control.setFocus()}Jdd(){this.control.update()}igf(Ia,Ya=!1){this.f7b();this.control.dismiss(Ia,Ya)}R5n(Ia){const Ya=Lb.GTd().HL;Ia=this.tCa.Y$b(Ia,new zb(Ya.clientWidth,Ya.scrollLeft,Ya.scrollWidth));this.control.T5n(Ia)}dispose(){this.control.dispose();this.Vb.fe(E.a.Aha).mr(this.$Z)}Nnf(Ia){v.ULS.shipAssertTag(4520074,308,!!this.control);v.ULS.shipAssertTag(4520075,308,!!this.control.pHc);return this.Onf(this.control.pHc.id,Ia)}g5k(Ia){const Ya=this.L4j(),
eb=this.J4j();this.yE=this.K4j(Ia,Ya,eb,this.G$,this.Ejo)}$Bf(){const Ia=this.Vb.fe(E.a.Aha);Ia.parent=3===k.AFrameworkApplication.va.mode?t.AppFrame.VD:t.AppFrame.njc;this.Vb.b_e(E.a.Aha);Ia.bindAction(this.$Z,I.a.r4)}MT(){this.np.MT(E.a.Aha);this.np.MT(E.a.i2a)}Onf(Ia,Ya){return()=>{const eb=Lb.GTd().ed.Mc.Eb(Ia);this.dta.d8b();if(!eb.isConnected)return v.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.shg(new H.a(eb,!0));return Ya}}static fm(){const Ia=
new xb(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new Lb(y.FocusManager.instance(),z.StaticActiveAppFrame.za().xx,ua.OZl,Xa.QZl,aa.KZl,Ia,M.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static GTd(){const Ia=z.StaticActiveAppFrame.za().jb.rc;return Ia&&Ia.$i?Ia:null}static get instance(){return null!=Lb.fDg?Lb.fDg:Lb.fDg=Lb.fm()}}Object(D.a)(Lb,"FootnoteEndnoteControlManager",
null,[423])},1693:function(D,J,c){c.d(J,"a",function(){return z});D=c(0);var l=c(7),e=c(55),a=c(177),k=c(2),x=c(10),y=c(164),n=c(128),t=c(22);class z{constructor(v,I){this.eu=null;this.xvd=!1;this.Gcb=0;this.j4g="";this.Ave={};this.lLe=v;this.Vb=I;this.b$g=Object(e.a)(this,this.VXf,"onModalMouseWheel");this.e3g=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Kb.Ppa;this.Rw=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Kb.uL}onMenuOpen(){0<this.Gcb?this.Gcb++:(this.Gcb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",
!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.Q5i,"pushTransientFocusScope"),0)}):this.Q5i(),this.showModal())}Q5i(){this.Vb&&this.Vb.FL(a.AFrame.Xqa,!0)}QQl(){const v=n.f(),I=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.e3g&&I.isActive&&1===I.state?"_ShyRibbon":"")}Vim(v){var I=0;if(this.Rw){if(this.Ave[v])return this.Ave[v];(I=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
I=I?I.offsetTop:0;this.Ave[v]=I}return I}showModal(){if(!this.eu)if(this.eu=this.createElement("div"),this.eu.setAttribute("id","ReactModalDiv"),this.eu.style.position="absolute",this.eu.style.bottom="0px",this.eu.style.left="0px",this.eu.style.right="0px",this.eu.style.backgroundColor="white",this.eu.style.opacity="0.0",this.Rw){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.eu)}else this.lLe.appendChild(this.eu);v=this.QQl();if(v!==this.j4g){const I=this.Vim(v),E=appChrome.selectors.getShyState();
this.e3g&&E.isActive&&1===E.state&&n.a("getRibbonHeight")?this.eu.style.top=String.format("{0}px",I+appChrome.api.getRibbonHeight(n.f())):this.eu.style.top=String.format("{0}px",I);this.j4g=v}this.eu.style.display="block";this.eu.style.visibility="visible";this.eu.style.zIndex="1000";this.xvd||(window.addEventListener("wheel",this.b$g,!0),this.k0d()?y.a.instance.ob(x.a.kN,this.eu,Object(e.a)(this,this.k8d,"onModalPointerUp")):y.a.instance.ob(x.a.pointerDown,this.eu,Object(e.a)(this,this.j8d,"onModalPointerDown")),
this.xvd=!0)}onMenuClose(){this.Gcb--;0<this.Gcb||(0>this.Gcb?this.Gcb=0:this.fpi())}jWf(){this.Gcb=0;this.pMc();this.fpi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}epi(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.Xqa&&!k.AFrameworkApplication.lc.Qv&&this.Vb.hS(a.AFrame.Xqa,!1);this.eu&&(this.eu.style.zIndex="-1",this.eu.style.visibility="hidden",this.eu.style.display="none");this.xvd&&(window.removeEventListener("wheel",this.b$g,
!0),this.k0d()?y.a.instance.uc(x.a.kN,this.eu,Object(e.a)(this,this.k8d,"onModalPointerUp")):y.a.instance.uc(x.a.pointerDown,this.eu,Object(e.a)(this,this.j8d,"onModalPointerDown")),this.xvd=!1)}fpi(){this.k0d()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.epi()},0)}):this.epi()}j8d(){this.e7b();this.HTh();this.jWf();this.Z7a();return!0}k8d(){this.e7b();this.HTh();this.jWf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Z7a()},0)});return!0}Z7a(){4===k.AFrameworkApplication.ta.Kb.xk&&
k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ta.Z7a():this.Vb.mg(a.AFrame.In)}VXf(v){v.stopPropagation()}e7b(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.e7b()}pMc(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.pMc()}HTh(){k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Kb.SRa&&(this.k0d()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}k0d(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(D.a)(z,"ReactModalDiv",null,[])},1698:function(D,J,c){c.d(J,"a",function(){return e});c.d(J,"b",function(){return a});c.d(J,"c",function(){return k});var l=c(2);const e=(x,y)=>{const n=RegExp("mailto:(.*)").exec(x.url);y.email=n&&2===n.length?n[1]:x.url;y.resolveState=x.mw.charAt(35)===c(1808).ACommentFormatTranslator.wIk?1:0},a=(x,y)=>{y.contentId=x.mw},k=(x,y,n)=>{y.contentId=x.mw;y.isCurrentUser=n.email===l.AFrameworkApplication.K.kb("UserPrincipalName")}},1699:function(D,J,c){c.d(J,
"a",function(){return a});D=c(0);var l=c(1063),e=c(6);class a{constructor(k,x){this.RN=this.sAc=null;this.gb=k;this.dab=x}get key(){return"COMMENT"}get Ku(){return WordEditorIntl.WordEditorStrings.L_Comment}get o4(){return this.RN}reset(k){this.RN=k.node}lAa(k){let x=null;if(this.sAc&&this.axi(k,this.o4,this.sAc))return x=Object.assign(new l.a,{nE:this.key,contentObject:this.sAc}),{returnValue:!0,RE:x};this.sAc=null;const y=this.dab.Qbf(this.o4);if(this.dab.kEf(y)){let n=y.Rd();for(;n;){if(this.axi(k,
this.o4,n))return this.sAc=n,x=Object.assign(new l.a,{nE:this.key,contentObject:n,description:this.hQa()}),{returnValue:!0,RE:x};n=y.Oj()}}return{returnValue:!1,RE:x}}axi(k,x,y){if(this.Lrj(y))return!1;const n=this.dab.bac(y,!0),t=this.dab.bac(y,!1);return n&&t&&this.gb.LXc(x,n,t)&&(x=this.dab.Gwa(n,y.id,!0))&&(n!==this.o4||x.Lb.cp<=k)&&(y=this.dab.Gwa(t,y.id,!1))&&(t!==this.o4||y.Lb.cp>k||y.Lb.cp>=k)?!0:!1}Lrj(k){return k.ja(e.a.UG,!1)}hQa(){return null}}Object(D.a)(a,"CommentDetailsProvider",null,
[345,346])},1706:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);J=c(157);var l=c(103);class e extends J.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(e,"DocumentTypeClassifierAnnotation",J.a,[])},1710:function(D,J,c){c.d(J,"a",function(){return z});
D=c(0);var l=c(2),e=c(358),a=c(86),k=c(7),x=c(55),y=c(82),n=c(62),t=c(344);class z{constructor(v,I,E,H,M,K){this.nOe=null;this.Rbh=0;this.A3=!1;this.Ad=H;this.Se=I;this.LZ=M;this.kEe=E;this.vsc=l.AFrameworkApplication.fhg();this.nwe=v.appSettings.ChromeClipboardAccessOperationTimeout;this.FI=0;this.vZj=K;this.U2j=v.$("EnableExternalPasteSupportOnMobileIsEnabled");this.rg=e.a.getInstance(t.a.r0a);this.A3=v.$("ShouldLogCcpExtendedHealthKpis")}get sTa(){return this.LZ.sTa}process(v,I){if(!this.FI)return this.vCn(I);
if(1===this.FI)return this.VNb(v,I);if(2===this.FI)return this.FI=3,this.nOe(v,I);3===this.FI&&this.LZ.Ueg(v,I);return!1}vCn(v){let I=!0;this.U2j&&(I=!(v.Vw&1));this.Se.W4&&I||v.Vw&512?(this.nOe=v.Vw&2?Object(x.a)(this.LZ,this.LZ.paste,"paste"):Object(x.a)(this.LZ,this.LZ.C1i,"pasteInternal"),this.FI=2):(this.vsc?(this.FI=1,this.Rbh=Date.now()):this.FI=2,this.nOe=Object(x.a)(this.LZ,this.LZ.paste,"paste"));t.a.y7m(v);return!0}VNb(v,I){v=!0;if(this.kEe.value.R3i())this.FI=2;else{const E=Date.now()-
this.Rbh;E>this.nwe&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",E),this.Ad.Yb(y.a.soa,{["Reason"]:n.a.w_i}),I.dS&&(I.dS.fail("Prepare for paste timed out",!1),this.A3?this.rg.logKpiFailure({kpiName:t.a.COa,errorName:"PreparePasteTimedOut",optionalVeto:{name:t.a.Eob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",[t.a.Eob],!1,!0,!0,!1,null)),I.failed=!0,v=!1,this.vZj.B7n())}return v}}Object(D.a)(z,"ClipboardOperationPasteProcessor",
null,[543])},1711:function(D,J,c){c.d(J,"a",function(){return U});D=c(0);J=c(299);var l=c(358),e=c(86),a=c(2),k=c(43),x=c(175),y=c(7),n=c(111),t=c(69),z=c(1465),v=c(55),I=c(88),E=c(3),H=c(82),M=c(62),K=c(1110),L=c(17),S=c(49),Q=c(1643),N=c(1712),O=c(344),X=c(123);class U extends J.a{constructor(T,Y,aa,ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa,ka,wa,ia,va,na,Ca,ta,fa,Xa,ob,xb,zb,Lb=!0){super();this.hla=this.iw=null;this.ZL=this.oz=0;this.oeb=this.sSe=this.Saa=this.qh=null;this.p7=!1;this.vT=!0;this.yYg=
!1;this.init(T);this.Rl("ClipboardOperation");this.Jkb(sa,Y,oa,ma,ea);this.Ad=Fa;this.Fe=Pa;this.Se=Na;this.Lc=Aa;this.yPg=za;this.APg=xa;this.zPg=ka;this.Awe=wa;this.yVb=ia;this.Bwe=va;this.vsc=ua;this.hsc=na;this.GNa=Ca;this.Iok=Lb;this.GD=ta;this.Vd=fa;this.Pm=Xa;this.k_=ob;this._context=ba;this.hga=xb;this.x0b=zb;this.rg=l.a.getInstance(O.a.r0a);ea&&Object(n.a)(88,ea)&&(this.Saa=Object(t.a)(551,ea.ja(x.a.lva,null)));this.Saa||(this.Saa=this.hga.bbd());this.Ssb=void 0===aa||null===aa?"NotAvailable":
Object(z.a)(N.a,aa);this.Saa.tEk(this.Ssb.split(", "));T=this._context;if(this.x0b){if(!U.OBh(T,this.Awe,this.Ad,this.Saa,Lb)){this.sr=8;this.finish();return}this.qh=T.view;this.p7=3===this.qh.CKb;this.oz=0;this.ZL=aa;this.oeb=wa.sTa}else{if(!T.view.ue){this.Ad.Yb(H.a.ef,{["Reason"]:M.a.gMb});this.Saa.fail("Not in interactive view",!0);this.sr=8;this.finish();return}this.qh=T.view;if(!this.qh.mb){this.Ad.Yb(H.a.ef,{["Reason"]:M.a.noSelection});this.Saa.fail("No selection manager",!0);this.sr=8;this.finish();
return}this.p7=3===this.qh.CKb;this.oz=0;this.ZL=aa;this.oeb=wa.sTa;if(Lb&&!(this.oeb&&this.oeb.lb&&this.oeb.length)){this.Ad.Yb(H.a.ef,{["Reason"]:M.a.noSelection});this.Saa.fail("No selection when one required",!0);this.sr=8;this.finish();return}}wa=L.SelectionEditor.Pl(this.oeb.lb);wa=!(this.ZL&16&&wa);wa=va.YJm(aa,this.qg)&&wa;1!==this.behavior&&wa||(wa||this.Saa.fail("Clipboard operation disabled for selection",!0),this.sr=wa?32:8,this.vra());!this.yYg&&this.Se.vi&&(k.b("IPadCCP"),this.yYg=!0)}get qg(){this.sSe||
(this.sSe=S.a.h4b(this.oeb));return this.sSe}Zda(){super.Zda();this.oeb=null}run(){this.oz||this.setup();1===this.oz&&this.process();2===this.oz&&this.uJo();3===this.oz&&this.rJo();4===this.oz&&this.finish()}setup(){if(this.ZL&256&&this.vsc){this.JC||this.yVb.zXk(this,this.ZL,this.Ssb);this.JC.run();if(this.JC.inProgress)return;this.vT=this.JC.Dqa;this.BGd();if(!this.vT){this.Saa.fail("No access to system clipboard",!0);this.sr=8;this.oz=4;this.y3d();return}}else y.ULS.sendTraceTag(9037319,307,50,
"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.ZL,this.Ssb,this.Se.rG,this.actionId);this.ZL&32&&!this.Fe.c_d(this.qh.mb.qg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.Ad.Yb(H.a.ef,{["Reason"]:M.a.Odf}),this.Saa.fail("Cut not allowed",!0),this.hsc.show(),this.sr=8,this.oz=4):(this.ZL&16||this.ZL&32)&&I.a.instance.J(1)&&this.GD.c1d(this.qh.mb.ib.lb)?(this.Saa.fail("Selected content deleted in coauthoring",!0),this.Vd.lRb(),this.sr=8,this.oz=4):(this.ZL&4096&&(this.k_.jjc(Object.assign(new K.a,
{MWc:!0,aZ:this.Ssb})),this.Pm.undo()),this.Bwe.gHn(this.ZL),this.qh.ed?(this.iw=this.Lc.Pc(15),this.iw.Uj=this.actionId,this.iw.Db(this.qh.ed),this.oz=1):(this.Saa.fail("Interactive view has null target node",!0),this.sr=8,this.oz=4))}process(){if(!this.JC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.ZL,this.Ssb,this.Se.rG);y.ULS.shipAssertTag(6305507,307,!this.hla);this.hla=new Q.a(this._context,this.ZL,this.Saa,this.x$,this.YL,void 0,this.Se.rG,this.Iok,
this.p7);let T;T=this.ZL&65536?Object(v.a)(this.yPg,this.yPg.process,"process"):this.ZL&64?Object(v.a)(this.APg,this.APg.process,"process"):this.ZL&1?Object(v.a)(this.Awe,this.Awe.process,"process"):Object(v.a)(this.zPg,this.zPg.process,"process");this.ZL&16&&this.qh.mb.fAa.V2h();this.GNa.create(this,T,this.hla).Rl("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.JC);this.JC.run();this.JC.inProgress||(this.BGd(),this.oz=this.Qh?2:3)}uJo(){this.hla.Cdc&&(this.iw.Uj=E.a.typing);this.hla.eXc&&
this.iw.mHa(this.hla.yBf,this.hla.RUf);this.iw.dispose();this.sr=this.hla.failed?8:32;this.oz=4}rJo(){if(this.JC){if(this.JC.run(),this.JC.inProgress)return}else if(this.hla.Cdc&&(this.iw.Uj=E.a.typing),this.iw.RIa(this),this.hla.eXc&&this.iw.mHa(this.hla.yBf,this.hla.RUf),this.iw.dispose(),this.uZe)return;this.sr=this.hla.failed?8:32;this.oz=4}finish(){this.k_.jjc(Object.assign(new K.a,{MWc:!1}));this.vra();32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",
+this.endTime-+this.startTime,this.ZL,this.Ssb,this.Se.rG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.ZL,this.Ssb,this.Se.rG);this.hga.pha(this.Saa);(U.KRn||U.Bgg)&&this.l5m()}y3d(){const T=!!(this.ZL&1),Y=this._context.view;Y&&O.a.y3d(T,Y.mb,this.Se.rG)}l5m(){if(!(this.ZL&4||this.ZL&64)){var T=new Map;T.set("isCopy",String.format("{0}",!!(this.ZL&16)));T.set("isIPad",String.format("{0}",this.Se.vi));U.Bgg?
(T.set("SkipAria","false"),T.set("ErrorLevel","info"),this.rg.logKpiUsage({kpiName:O.a.SFd,kpiType:0,optionalProperties:{extendedProperties:T},blockFutureEmissionDurationInMs:0})):e.Health.instance.recordKpiUsage(O.a.SFd,0,O.a.TFd,T);this.vT||(U.Bgg?(T.set("SkipAria","false"),T.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:O.a.SFd,errorName:O.a.TCh,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:T}},blockFutureEmissionDurationInMs:0})):(T=Object.assign(new X.a,
{extendedProperties:T}),e.Health.instance.recordKpiFailure(O.a.SFd,O.a.TCh,!0,!0,T)))}}static get KRn(){null==U.iQe&&(U.iQe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return U.iQe}static get Bgg(){null==U.A3&&(U.A3=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return U.A3}static s6f(T,Y,aa,ba){T&&T.Yb(H.a.ef,{["Reason"]:aa});Y&&Y.fail(ba,!0)}static OBh(T,Y,aa=null,ba=null,oa=!0){return T.view.ue?T.view.mb?
!oa||Y.sTa&&Y.sTa.lb&&Y.sTa.length?!0:(U.s6f(aa,ba,M.a.noSelection,"Paste target is invalid"),!1):(U.s6f(aa,ba,M.a.noSelection,"No selection manager"),!1):(U.s6f(aa,ba,M.a.gMb,"Not in interactive view"),!1)}}U.iQe=null;U.A3=null;Object(D.a)(U,"ClipboardOperation",J.a,[])},1712:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.paste=1]="paste";e[e.pup=2]="textOnly";e[e.X_i=4]="overtype";e[e.copy=16]="copy";e[e.Whp=32]="deleteSelection";e[e.move=64]="move";e[e.wvp=256]="useSystemClipboard";
e[e.ukp=512]="forceInternalClipboard";e[e.MTa=4096]="reformatPastedContent";e[e.aqp=8192]="pasteAsPlainText";e[e.oad=65536]="showPlaceholderGlossary";e[e.Iqp=131072]="reformatPastedContentWithDesignerPaste";e[e.zop=262144]="noSpacesAdjustment";e[e.aPi=524288]="mergeAfterPaste"})(l||(l={}));Object(D.b)("ClipboardActionFlags",l)},1716:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||
n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1875),J);e(c(1876),J)},1717:function(D,J,c){c.r(J);c.d(J,"FootnoteEndnoteDefaultContentInserter",function(){return H});D=c(0);var l=c(22),e=c(61),a=c(2),k=c(37),x=c(551),y=c(28),n=c(6),
t=c(16),z=c(55),v=c(1208),I=c(893),E=c(1645);class H{constructor(M,K,L,S,Q=null){this.Yc=M;this.mZj=K;this.nm=L;H.rh=S;this.hRg=Q||H.bcl}get CL(){return null!=this.gFg?this.gFg:this.gFg=l.a.instance.resolve("Box4.IOutlineEditor")}dal(M,K){var L=this.Yc.Dk();L.set(M);this.CL.Pkb(L,null,!0);H.rh.CQb(L.currentNode,this.nm);M=k.OutlineElementNavigator.Ee(L);H.d6.h$c(K?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,M);L=this.hRg(L.currentNode);H.jg.Ge(L,H.$Qh);
this.HEm(M,K)}HEm(M,K){var L=this.mZj(131073);L.setValue(n.a.Ns,1===K?36:35);L.setValue(n.a.qna,!0);L.setValue(t.a.Z$,!0);const S=M.Mc.Xu(L,e.a.create());L=this.hRg(M);H.jg.kia(L,Q=>I.a.getInstance(Q,S,!0),E.a.S6h(M,K))}static fm(){return new H(new x.a,Object(z.a)(v.a.instance,v.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get d6(){return null!=H.AHg?H.AHg:H.AHg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get jg(){return null!=
H.pxg?H.pxg:H.pxg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=H.tDg?H.tDg:H.tDg=H.fm()}static bcl(M){return y.a.Uc(M,0)}}H.$Qh=" ";H.rh=null;Object(D.a)(H,"FootnoteEndnoteDefaultContentInserter",null,[452])},1718:function(D,J,c){c.d(J,"a",function(){return x});D=c(0);var l=c(551),e=c(538),a=c(1570),k=c(1645);class x{constructor(y,n){this.dta=n}NVd(y,n,t){return(y=this.dta.hdi(y.node,t?y.cpBegin:y.cpEnd,n))?y.I4():null}Mli(y,n){return(y=this.dta.uam(y.node,
y.cpBegin,n))?y.I4():null}static MQc(){return new x(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.RCg?x.RCg:x.RCg=x.MQc()}}Object(D.a)(x,"FootnoteEndnoteNavigator",null,[455])},1730:function(D,J,c){c.d(J,"a",function(){return x});D=c(0);var l=c(1793),e=c(2),a=c(51),k=c(22);class x{constructor(y,n,t,z,v,I){this.Eta=y;this.Fta=n;this.nEe=t;this.IZ=z;this.skd=v;this.PUb=I}get Msj(){return!this.Fta&&!this.nEe}get pTi(){return 2===this.PUb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get zYh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get dqi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get jkb(){return CommonUIStrings.l_OICErrorHelpLink}get Qoi(){return"OICFailure"}get icon(){return 3}get pBd(){return 2===this.PUb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}yQn(y){this.CTi(y)}u1m(y){this.CTi(y)}CTi(y){let n=
10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").OKf(this.PUb),n=3):2===y&&((!this.nEe||this.nEe(this.IZ))&&this.Fta&&l.a.instance.rdl(this.Fta,this.Eta,this.IZ),n=5);(0===y||1===y)&&this.Eta&&this.Eta(this.IZ);e.AFrameworkApplication.F7c(a.a.l_i,this.skd,n);this.dispose()}dispose(){this.IZ=this.Fta=this.Eta=null}}Object(D.a)(x,"AOICErrorDialogWithTrial",null,[10])},1789:function(D,J,c){D=c(0);var l=c(2),e=c(20),a=c(22),k=c(760),x=c(1575),y=c(2062),n;(function(fa){fa[fa.default=0]=
"default";fa[fa.numbered=1]="numbered";fa[fa.bullet=2]="bullet";fa[fa.invalid=3]="invalid"})(n||(n={}));Object(D.b)("ListTypeOfMultiLevelList",n);var t=c(36);class z{constructor(fa,Xa=null){this.qck=fa;this.M3=Xa||x.a.vrf(e.a.QBb,"")}get Vy(){return this.qck}get Jc(){return this.M3}ieg(fa){this.Jc.d++;return this.Vy.ieg(fa)}Elc(fa){this.Jc.e++;return this.Vy.Elc(fa)}IL(fa){this.Jc.f++;return this.Vy.IL(fa)}dqb(fa){this.Jc.h++;return this.Vy.dqb(fa)}R5(fa){this.Jc.i++;return this.Vy.R5(fa)}fka(fa){this.Jc.j++;
return this.Vy.fka(fa)}YIa(fa){this.Jc.k++;return this.Vy.YIa(fa)}xra(fa){this.Jc.l++;return this.Vy.xra(fa)}ehe(fa){this.Jc.m++;return this.Vy.ehe(fa)}AUa(fa,Xa=!1){this.Jc.n++;return this.Vy.AUa(fa,Xa)}tyf(){this.Jc.o++;return this.Vy.tyf()}oig(){this.Jc.p++;return this.Vy.oig()}Xv(fa){this.Jc.q++;return this.Vy.Xv(fa)}Iza(fa){this.Jc.r++;return this.Vy.Iza(fa)}tlc(fa){this.Jc.g++;return this.Vy.tlc(fa)}j$c(fa){return this.Vy.j$c(fa)}hqb(fa){this.Jc.s++;return this.Vy.hqb(fa)}Khe(fa){this.Jc.s++;
return this.Vy.Khe(fa)}Acf(fa){this.Jc.ba++;return this.Vy.Acf(fa)}Lge(fa){this.Jc.s++;return this.Vy.Lge(fa)}fqb(fa){this.Jc.s++;return this.Vy.fqb(fa)}JQb(fa){this.Jc.t++;return this.Vy.JQb(fa)}cie(fa){this.Jc.u++;return this.Vy.cie(fa)}cka(fa){this.Jc.v++;return this.Vy.cka(fa)}bfg(fa){this.Jc.bb++;return this.Vy.bfg(fa)}K$(fa){return this.Vy.K$(fa)}F$(fa){this.Jc.z++;return this.Vy.F$(fa)}B$f(){return this.Vy.B$f()}pea(fa,Xa){this.Jc.w++;this.Jc.x++;return this.Vy.pea(fa,Xa)}lD(fa){this.Jc.y++;
return this.Vy.lD(fa)}KC(){return this.Vy.KC()}clone(){return new z(this.Vy.clone(),this.Jc)}}Object(D.a)(z,"FormattingStewardUsageCollector",null,[317]);class v extends z{constructor(fa,Xa=null){super(fa,Xa)}get U9(){return this.Vy}get zw(){return this.U9.zw}set zw(fa){this.U9.zw=fa}get textIndent(){return this.U9.textIndent}get marginLeft(){return this.U9.marginLeft}get dnc(){return this.U9.dnc}get gS(){return this.U9.gS}get lineSpacing(){return this.U9.lineSpacing}get Y5(){return this.U9.Y5}get leftIndent(){return this.U9.leftIndent}get Sda(){return this.U9.Sda}get paragraph(){return this.U9.paragraph}set paragraph(fa){this.U9.paragraph=
fa}get nR(){return this.U9.nR}get nnc(){return this.U9.nnc}pne(fa){return this.U9.pne(fa)}hog(fa){return this.U9.hog(fa)}clone(){const fa=this.Vy.clone();return new v(fa,this.Jc)}}Object(D.a)(v,"FormattingStewardUsageCollector",z,[591,317]);var I=c(8),E=c(378),H=c(878),M=c(37),K=c(207),L=c(84),S=c(41),Q=c(61),N=c(359),O=c(140),X=c(19),U=c(86),T=c(56),Y=c(2061),aa=c(16),ba=c(6),oa=c(47),ma=c(123),ea=c(598),ua=c(360),sa=c(146),Fa=c(59),Pa=c(98),Na=c(180),Aa=c(1637),za=c(152),xa=c(28),ka=c(1422),wa=
c(892);class ia{constructor(fa,Xa,ob,xb,zb,Lb,Ia,Ya,eb,sb,lc=null){var vb;this.wE=this._paragraph=null;this.Ttd=Y.a.none;this.QOg=this.Utd=null;this.Paa=0;this.hyb=this.nnc=this.leftIndent=this.Y5=this.Qyc=this.gS=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=fa;this.Ce=Xa;this.ev=ob;this.rz=xb;this.AK=zb;this.AXb=Lb;this.Ila=Ia;this.jWb=Ya;this.yXa=eb;this.lvb=sb;lc?(t.a(4223818,307,!!lc.wE),this.wE=lc.wE.wna(this.paragraph),this.Ttd=lc.bic,this.Utd=lc.h0f,lc.gS&&(this.gS=
new ka.a,this.gS.afterSpacing.value=lc.gS.afterSpacing.value,this.gS.beforeSpacing.value=lc.gS.beforeSpacing.value,null===(vb=l.AFrameworkApplication.K)||void 0===vb?0:vb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.gS.afterSpacing.unit=lc.gS.afterSpacing.unit,this.gS.beforeSpacing.unit=lc.gS.beforeSpacing.unit),lc.lineSpacing&&(this.Qyc=lc.lineSpacing.clone()),this.Paa=lc.Paa,this.nnc=lc.nnc.clone(),this._textIndent=lc.textIndent,this._marginLeft=
lc.marginLeft,this._tabStops=lc.dnc,this.Y5=lc.Y5,this.leftIndent=lc.leftIndent,lc.Sda&&(this.hyb=lc.Sda)):(this.wE=new Na.a(this.paragraph,0),this.wE.formatting=new za.a(this.wE,Q.a.nil),Xa=xa.a.tw(fa),Xa=this.AK.Xr(Xa),this.Aio(Xa),this.bwo(fa)?(this.AXb.Vjo(this.wE.formatting,Xa),fa.hasProperty(aa.a.Jh)?this.Paa=fa.getValue(aa.a.Jh):this.Paa=0):this.Paa=-1,this.Ttd=0,this.gS=this.Utd=null,this.lvb&&(this.gS=this.AXb.zQa(fa),this.Qyc=this.AXb.GGb(fa),this.Y5=this.AXb.aac(fa),this.leftIndent=this.AXb.yU(fa)),
this.nnc=new N.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(fa){t.a(4223816,307,!!fa&&I.ParagraphReader.Xb(fa));this._paragraph=fa}get nR(){return this.wE.formatting}get bic(){return this.Ttd}get h0f(){return this.Utd}get qw(){return this.QOg}get zw(){return this.Paa}set zw(fa){t.a(4223817,307,1===fa||2===fa||3===fa||6===fa);this.Paa=fa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get dnc(){return this._tabStops}get lineSpacing(){return this.Qyc}get Sda(){return this.hyb}get qc(){return this.rz}Aio(fa){const Xa=
this.AK.language(fa);Xa&&this.Ce.jeg(this.wE.formatting,Xa,0,fa.cache.HJb,!1)}bwo(fa){fa=this.qc.Kg(this.qc.hp(fa));return fa===Fa.StyleReader.nqe||fa===Fa.StyleReader.wordStyleIdNormal||fa===Fa.StyleReader.Npc||fa===Fa.StyleReader.styleIdNormal}ieg(fa){(fa=k.a.ug(fa))&&this.Ce.uhe(this.wE.formatting,fa.LCID);return!0}Elc(){return!1}IL(fa){this.Ce.IL(this.wE.formatting,fa);return!0}dqb(fa){this.Ce.fz(this.wE.formatting,fa);return!0}R5(fa){this.Ce.R5(this.wE.formatting,fa);return!0}fka(fa){this.Ce.fka(this.wE.formatting,
fa);return!0}YIa(fa){this.Ce.YIa(this.wE.formatting,fa);return!0}xra(fa){this.Ce.xra(this.wE.formatting,fa);return!0}ehe(fa){if(0>=fa)return!1;this.Ce.WA(this.wE.formatting,fa);return!0}AUa(fa,Xa){if(!fa||""===fa)return!1;if(({r2h:ob}=O.FontUtils.JDj(fa)).returnValue)return this.Ce.bka(this.wE.formatting,ob.fontName),!0;var ob=!1;const xb=O.FontUtils.QSa(fa);Xa&&this.Xlb(xb,this.Ila)&&(this.Ila.Lna(fa),ob=!0);if(this.Xlb(xb,this.jWb)||this.Xlb(xb,this.yXa))ob=!0;ob&&this.Ce.bka(this.wE.formatting,
xb);return ob}Xlb(fa,Xa){return!!Xa&&Xa.isEnabled&&Xa.Xlb(fa)}tyf(){this.Ce.jmi(this.wE.formatting);return!0}oig(){this.Ce.Qtj(this.wE.formatting);return!0}Xv(fa){var {Box4PasteSteward:Xa}=c(1540);if(null===fa||""===fa)return!1;fa=Xa.bDb(fa);Xa=null;this.Sda&&this.Sda.hasOwnProperty(ba.a.listLevel.id.toString())&&(Xa=this.Sda[ba.a.listLevel.id.toString()]);this.Ce.Xv(this.wE.formatting,fa,Xa);return!0}Iza(fa){const {Box4PasteSteward:Xa}=c(1540);if(!fa||""===fa||!ia.Imm().contains(fa))return!1;this.Ce.Iza(this.wE.formatting,
Xa.bDb(fa));return!0}tlc(fa){this.Ce.tlc(this.wE.formatting,fa);return!0}j$c(fa){let Xa=0;switch(X.a.eh(fa)){case "small-caps":Xa=1;break;case "uppercase":Xa=2}this.Ce.hm(this.wE.formatting,oa.a.capitalization,Xa);return!0}F$(fa){const {Box4PasteSteward:Xa}=c(1540);if(!fa||""===fa)return!1;this.nnc.setValue(aa.a.WK,parseInt(Xa.bDb(fa),16));return!0}fqb(fa){return 0>=fa?!1:this.Khe(this.qc.hgm(fa))}hqb(fa){this.KC();this.Ttd=fa;return!0}Acf(fa){var {Box4PasteSteward:Xa}=c(1540),ob=new Map;ob.set("Source",
"CreateStyleCCP_FormattingSteward");U.Health.instance.recordKpiUsage(sa.a.RLj,0,sa.a.zB,ob);ob=Pa.a.egm(fa);fa=[];fa.push(ob);(fa=Pa.a.$Fc(fa,this.paragraph))?(Xa.Ymc=this.qc.Ar(),t.b(593078085,3017,50,"Custom style created via paste.")):(Xa=new Map,Xa.set("Source","CreateStyleCCP_FormattingSteward"),Xa.set("IsStyleNull",(!ob).toString()),Xa=Object.assign(new ma.a,{extendedProperties:Xa}),U.Health.instance.recordKpiFailure(sa.a.RLj,"UnableToCreateStyle",!1,!0,Xa));return fa}Khe(fa){const {Box4PasteSteward:Xa}=
c(1540);return fa&&0<fa.length&&Xa.Ymc&&Xa.Ymc.pj(fa)?(this.Utd=fa,!0):!1}Lge(fa){const {Box4PasteSteward:Xa}=c(1540);return fa&&0<fa.length&&Xa.Ymc&&Xa.Ymc.pj(fa)?(this.QOg=fa,!0):!1}hog(fa){if(this.qw){fa=this.qc.ZC(fa);if(!fa)return t.a(41968715,307,!1),!1;(fa=fa.pj(this.qw))&&this.Ce.l8a(this.wE.formatting,fa);return!0}return!1}pea(fa,Xa){this.gS=new ka.a;this.gS.beforeSpacing=this.Jmo(fa);this.gS.afterSpacing=this.Imo(Xa);return!0}Jmo(fa){return new wa.a(4,fa)}Imo(fa){return new wa.a(4,fa)}lD(fa){if(!fa)return!1;
const Xa=parseFloat(X.a.substring(fa,0,X.a.eh(fa).indexOf("px")));if(!isNaN(Xa))return this.Qyc=new wa.a(3,T.a.Yy(Xa,1)),!0;fa=parseFloat(X.a.substring(fa,0,X.a.eh(fa).indexOf("%")));return isNaN(fa)?!1:(this.Qyc=new wa.a(2,fa/100),!0)}JQb(fa){let Xa=0;if(!fa||""===fa)return!1;switch(fa){case "left":Xa=1;break;case "center":Xa=2;break;case "right":Xa=3;break;case "justify":Xa=6}if(!Xa)return!1;this.zw=Xa;return!0}cie(fa){this._textIndent=fa;return!0}cka(fa){this._marginLeft=fa;return!0}bfg(fa){this._tabStops=
fa;return!0}K$(fa){this.hyb=JSON.parse(fa);return this.Sda?!0:!1}KC(){this.wE.formatting=new za.a(this.wE,Q.a.nil);return!0}B$f(){this.Paa=0;return!0}pne(fa){var {Box4PasteSteward:Xa}=c(1540);if(this.bic>Y.a.none&&Xa.E6a[this.bic]){t.a(4223819,307,1<=this.bic);t.a(4223820,307,this.bic<=Y.a.maxParagraphStyle);Xa=this.qc.ZC(fa);if(!Xa)return t.a(4223821,307,!1),!1;Xa=Xa.pj(c(1540).Box4PasteSteward.E6a[this.bic]);this.ev.cK(Xa,fa,!1);return!0}if(this.h0f){Xa=this.qc.ZC(fa);if(!Xa)return t.a(41968716,
307,!1),!1;Xa=Xa.pj(this.h0f);this.ev.cK(Xa,fa,!1);return!0}return!1}clone(){return new ia(this.paragraph,this.Ce,this.ev,this.rz,this.AK,this.AXb,this.Ila,this.jWb,this.yXa,this.lvb,this)}static Imm(){ia.z_||(ia.z_=new ea.a(ua.a.ih()),ia.z_.add(Aa.a.yellow),ia.z_.add(Aa.a.E1m),ia.z_.add(Aa.a.lHk),ia.z_.add(Aa.a.EKl),ia.z_.add(Aa.a.blue),ia.z_.add(Aa.a.red),ia.z_.add(Aa.a.ahn),ia.z_.add(Aa.a.Vyj),ia.z_.add(Aa.a.green),ia.z_.add(Aa.a.purple),ia.z_.add(Aa.a.jbn),ia.z_.add(Aa.a.Qkn),ia.z_.add(Aa.a.gray),
ia.z_.add(Aa.a.MAo),ia.z_.add(Aa.a.black));return ia.z_}}ia.z_=null;Object(D.a)(ia,"FormattingSteward",null,[591,317]);class va{rog(){return!1}Nyf(fa){return fa}Tyf(){}K$(){}tQb(){}w_d(){return!1}get E0d(){return!1}lD(){}pea(){}Uhe(){}get Orj(){return!1}}Object(D.a)(va,"NoOpPasteStewardBridge",null,[590]);var na=c(75);class Ca{constructor(fa,Xa){this.Uin=fa;this.Vin=Xa||"Normal"}}Object(D.a)(Ca,"NoteTagInfoBox4",null,[]);c.d(J,"a",function(){return ta});class ta{constructor(fa,Xa,ob=null,xb=null){this.iIl=
l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.kbh=0;this.zc=fa;this.q7=Xa;this.HZ=xb||new va;this.Jc=ob||x.a.vrf(e.a.QBb,"")}get jg(){return null!=this.hxg?this.hxg:this.hxg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.sAg?this.sAg:this.sAg=a.a.instance.Oa("Box4.IFontService")}get BEa(){return null!=this.pyg?this.pyg:this.pyg=a.a.instance.Oa("Box4.CustomFontService")}get pvl(){return null!=this.Pyg?this.Pyg:this.Pyg=a.a.instance.Oa("Box4.IEmbeddedFontService")}reset(){}get GLc(){return this.rqf(!1)}rqf(fa){t.a(4223770,
307,S.OutlineElementReader.yh(this.zc));const Xa=M.OutlineElementNavigator.Ee(this.zc);M.OutlineElementNavigator.Yd(this.zc);t.a(4223771,307,!!Xa&&I.ParagraphReader.Xb(Xa));fa=new ia(Xa,ta.rn,ta.tE,ta.qc,ta.W8,ta.UJl,this.fontService,this.BEa,this.pvl,this.iIl,void 0,fa);return new v(fa,this.Jc)}Kda(){}Jda(){}gob(){}zya(){}KHa(){}XSa(){}WSa(){}jE(){}zF(){}bob(){}aob(){}bTa(){}q6a(){}Dya(){}Bya(){}OHa(){}Cya(){}s6a(){}rgc(fa){S.OutlineElementReader.yh(this.zc)?(ta.Pf.ppa(this.zc,!0),M.OutlineElementNavigator.ns(this.zc,
!1,!1)):L.OutlineReader.nx(this.zc)?K.OutlineNavigator.S9(this.zc)?fa?(this.zc.tg(),ta.CL.Z7(this.zc,!1)):ta.Pf.cPb(this.zc):ta.CL.Z7(this.zc,!1):t.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zc.Xe)}vRc(fa){let Xa=null;if(fa&&fa.f$&&fa.cultureName)try{Xa=Object.assign(new H.a,{languageId:k.a.ug(fa.cultureName).LCID})}catch(ob){t.a(8128526,307,!1,"Setting up culture {0} encountered {1}",fa.cultureName,ob)}Xa||null==this.q7||(Xa=Object.assign(new H.a,{languageId:this.q7}));return Xa}get oV(){return this.kbh}set oV(fa){this.kbh=
fa}JDd(){}Mcd(){}A8e(){}get K5b(){return!1}get PDb(){return!1}f2m(fa){var Xa=1;if(fa.bAi){var ob=0;switch(fa.listStyleType){case y.a.none:Xa=0;break;case y.a.decimal:Xa=1;break;case y.a.lowerAlpha:Xa=2;break;case y.a.lowerRoman:Xa=3;break;case y.a.upperAlpha:Xa=4;break;case y.a.upperRoman:Xa=5}}else switch(ob=1,fa.listStyleType){case y.a.none:Xa=0;break;case y.a.disc:Xa=1;break;case y.a.circle:Xa=2;break;case y.a.square:Xa=3}var xb=E.a,zb=xb.IX,Lb=fa.Mya;const Ia=new na.a;for(const Ya of Lb)Lb=new Ca(Ya.Uin,
Ya.Vin),Ia.add(Lb);xb=zb.call(xb,ob,Xa,Ia,fa.listId,fa.listLevel,fa.levelText,fa.font);fa.ks!==n.invalid&&(xb.o6=fa.ks);fa.bAi&&!fa.Qvi&&(xb.UA=0<fa.listId&&0<=fa.listLevel&&!fa.gic?fa.Hmc:fa.Ehl);!xb.Mz||3!==xb.listStyle&&5!==xb.listStyle||(xb.zw="right");(fa=fa.FLf)&&xb.propertySet.ax(fa);xb.d9b=!0;this.HZ.tQb(this.zc,xb);return xb}b$(){}Z9(){}w5(){}a$(){}Y9(){}X9(){}static get Pf(){return null!=ta.xFg?ta.xFg:ta.xFg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get CL(){return null!=
ta.mFg?ta.mFg:ta.mFg=a.a.instance.resolve("Box4.IOutlineEditor")}static get rn(){return null!=ta.TAg?ta.TAg:ta.TAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get tE(){return null!=ta.cKg?ta.cKg:ta.cKg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get qc(){return null!=ta.GKg?ta.GKg:ta.GKg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get W8(){return null!=ta.XAg?ta.XAg:ta.XAg=a.a.instance.resolve("Box4.IFormattingReader")}static get UJl(){return null!=ta.YAg?ta.YAg:
ta.YAg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}ta.Hf=null;Object(D.a)(ta,"Box4PasteStewardBase",null,[575,313,314])},1793:function(D,J,c){D=c(0);var l=c(55),e=c(7),a=c(2),k=c(51),x=c(466),y=c(22);class n{constructor(S,Q,N,O){this.yKe=null;this.skd=O;this.Eta=S;this.Fta=Q;this.IZ=N;this.Sgh=this.zLb.Uto;S=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.dbk=S[0];this.cbk=S[1]}get zLb(){return this.yKe||(this.yKe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get jkb(){return CommonUIStrings.l_OICErrorHelpLink}get P$c(){return this.Sgh}get tNi(){return this.dbk}get sNi(){return this.cbk}get rNi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Sgh?
3:2}get NNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get oId(){return!!this.Fta}get ONc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Z5f(S){this.Y1c(S)}tLf(S){this.Y1c(S)}Y1c(S){let Q=10;this.Fta&&1===S&&(this.Fta(this.IZ),Q=1);this.Eta&&this.Eta(this.IZ);this.mN(Q)}oMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}iVf(){this.zLb.PGi();this.mN(4)}mN(S){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.skd,S);a.AFrameworkApplication.F7c(k.a.j_i,this.skd,S)}dispose(){this.IZ=this.Eta=this.Fta=null}}Object(D.a)(n,"AOICErrorDialog",null,[10]);var t=c(39),z=c(182);class v extends n{constructor(S,Q,N,O){super(S,Q,N,O);this.Ecb=this.$F=null;S=document.createElement("span");S.id="errorMessageText";S.innerText=this.errorMessage;S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));this.$F=document.createElement("a");this.$F.href="#";this.$F.innerText=this.jkb;S.appendChild(this.$F);
t.a.addHandler(this.$F,"click",Object(l.a)(this,this.oMb,"oicErrorHelpLinkHandler"));Q=new z.StandardDialog;Q.zg=this.id;this.P$c?(N=document.createElement("span"),O=document.createElement("span"),N.innerText=this.tNi,O.innerText=this.sNi,this.Ecb=document.createElement("a"),this.Ecb.href="#",this.Ecb.innerText=this.rNi,S.appendChild(document.createElement("br")),S.appendChild(N),S.appendChild(this.Ecb),S.appendChild(O),t.a.addHandler(this.Ecb,"click",Object(l.a)(this,this.iVf,"oicErrorMacOfferLinkHandler"))):
this.oId&&(S.appendChild(document.createElement("br")),S.appendChild(document.createElement("br")),N=document.createElement("span"),N.innerText=this.NNc,S.appendChild(N));this.oId?(Q.Cd=1,Q.ye(1,this.ONc)):Q.Cd=0;Q.sv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.tLf,"legacyOICErrorDialogHandler"),S);Q.M5("errorMessageText")}dispose(){this.$F&&(t.a.removeHandler(this.$F,"click",Object(l.a)(this,this.oMb,"oicErrorHelpLinkHandler")),this.$F=null);this.Ecb&&(t.a.removeHandler(this.Ecb,"click",
Object(l.a)(this,this.iVf,"oicErrorMacOfferLinkHandler")),this.Ecb=null);super.dispose()}}Object(D.a)(v,"OICErrorDialog",n,[]);class I{constructor(S,Q,N){this.Eta=Q;this.Fta=S;this.IZ=N}get id(){return"OICErrorDialogWithDownload"}get AYh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get jkb(){return CommonUIStrings.l_OICErrorHelpLink}get NNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ONc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Z5f(S){this.Y1c(S)}tLf(S){this.Y1c(S)}Y1c(S){let Q=
10;1===S&&(this.Fta(this.IZ),Q=1);this.Eta&&this.Eta(this.IZ);this.mN(Q)}oMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}mN(S){a.AFrameworkApplication.F7c(k.a.k_i,3,S)}dispose(){this.IZ=this.Fta=this.Eta=null}}Object(D.a)(I,"AOICErrorDialogWithDownload",null,[10]);class E extends I{constructor(S,Q,N){super(S,Q,N);this.$F=null;S=document.createElement("span");S.id="errorMessageText";S.innerText=this.AYh;S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));this.$F=
document.createElement("a");this.$F.href="#";this.$F.innerText=this.jkb;S.appendChild(this.$F);t.a.addHandler(this.$F,"click",Object(l.a)(this,this.oMb,"oicErrorHelpLinkHandler"));S.appendChild(document.createElement("br"));S.appendChild(document.createElement("br"));Q=document.createElement("span");Q.innerText=this.NNc;S.appendChild(Q);Q=new z.StandardDialog;Q.zg=this.id;Q.Cd=1;Q.ye(1,this.ONc);Q.sv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.tLf,"legacyOICErrorDialogHandler"),S);Q.M5("errorMessageText")}dispose(){this.$F&&
(t.a.removeHandler(this.$F,"click",Object(l.a)(this,this.oMb,"oicErrorHelpLinkHandler")),this.$F=null);super.dispose()}}Object(D.a)(E,"OICErrorDialogWithDownload",I,[]);var H=c(156);class M extends n{constructor(S,Q,N,O){super(S,Q,N,O);Q={["errorMessage"]:this.errorMessage};Q.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.jkb,["onExecute"]:X=>{this.oMb(X)}};this.P$c?(Q.macOfficePreLinkText=this.tNi,Q.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.rNi,
["onExecute"]:X=>{this.iVf(X)}},Q.macOfficePostText=this.sNi):this.oId&&(Q.errorFileDownloadOffer=this.NNc);S=new H.a(!1,!1,!0);this.oId?(S.Cd=1,S.ye(1,this.ONc)):S.Cd=0;S.zg=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};S.Uh(this.dialogTitle,Object(l.a)(this,this.Z5f,"reactOICErrorDialogHandler"),Q)}}Object(D.a)(M,"ReactOICErrorDialog",n,[]);class K extends I{constructor(S,Q,N){super(S,Q,N);Q={["errorMessage"]:this.AYh,["errorFileDownloadOffer"]:this.NNc};Q.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.jkb,["onExecute"]:O=>{this.oMb(O)}};S=new H.a(!1,!1,!0);S.Cd=1;S.ye(1,this.ONc);S.zg=this.id;Q={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:Q};S.Uh(this.dialogTitle,Object(l.a)(this,this.Z5f,"reactOICErrorDialogHandler"),Q)}}Object(D.a)(K,"ReactOICErrorDialogWithDownload",I,[]);c.d(J,"a",function(){return L});class L{constructor(){this.rMa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Kb.uF}qdl(S,Q,N){this.rMa?new M(S,Q,null,N):new v(S,Q,null,
N)}rdl(S,Q,N){this.rMa?new K(S,Q,N):new E(S,Q,N)}sdl(S,Q,N,O,X){const {ReactOICErrorDialogWithTrial:U}=c(1890),{OICErrorDialogWithTrial:T}=c(1891);this.rMa?new U(S,Q,N,null,O,X):new T(S,Q,N,null,O,X)}static get instance(){return L._instance||(L._instance=new L)}}L._instance=null;Object(D.a)(L,"OICErrorDialogFactory",null,[1207])},1794:function(D,J,c){c.r(J);D=c(0);var l=c(311),e=c(1869),a=c(958),k=c(359),x=c(2),y=c(61),n=c(358),t=c(22),z=c(130),v=c(102),I=c(79),E=c(1467),H=c(192),M=c(40),K=c(20),
L=c(271),S=c(175),Q=c(7),N=c(250),O=c(111),X=c(69),U=c(308),T=c(11),Y=c(28),aa=c(3),ba=c(15),oa=c(125),ma=c(536),ea=c(49),ua=c(1711),sa=c(1710),Fa=c(344),Pa=c(299);class Na extends Pa.a{constructor(ta,fa,Xa,ob,xb,zb){super();this.init(ta);this.Rl("DummyClipboardOperation");this.Jkb(x.AFrameworkApplication.va,fa,ob,xb,zb);this._context=Xa;this.sr=8;this.vra()}run(){this.acb=!0;this.D9c(this._context);this.U6a();this.sr=32}}Object(D.a)(Na,"DummyClipboardOperation",Pa.a,[]);Pa=c(1603);class Aa extends Pa.a{constructor(ta,
fa,Xa,ob,xb){super(ta,fa,xb);this.lk=Xa;this.$Se=ob}Foc(ta){let fa;if(this.zT&&!ta)return Q.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,$va:null};fa=null;if(this.$Se&&!this.zT){const Xa=this.properties.ja(S.a.K1i,"");Xa&&(fa=this.lk.Cob(Xa))}fa||(fa=this.lk.Cob(ta));return{returnValue:!0,$va:fa}}}Object(D.a)(Aa,"HtmlStringImportStrategy",Pa.a,[]);var za=c(1870);class xa extends za.a{constructor(ta,fa,Xa,ob,xb){super(ta,fa,Xa,ob,xb)}Uei(){return this.properties.ja(S.a.wNb,
"")}Foc(ta){x.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.ehh){if(this.lk)return ta=this.lk.u0f(ta,!0),{returnValue:!0,$va:ta};Q.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Foc(ta)}i_c(ta){ta=super.i_c(ta);return ta.length&&" "!==ta?ta:"\u00a0"}}Object(D.a)(xa,"MultiLinePlainTextImportStrategy",za.a,[]);class ka extends Pa.a{constructor(ta,fa,Xa){super(ta,fa,Xa)}Foc(ta){({ClipboardActor:fa}=
c(1794));if(this.zT&&!ta)return Q.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,$va:null};var fa=fa.wCn;fa.innerText=ta;return{returnValue:!0,$va:fa}}}Object(D.a)(ka,"PlainTextImportStrategy",Pa.a,[]);var wa=c(82),ia=c(62);class va{constructor(ta){this.a5=this.AHf=!1;this.fga=ta}R3i(){this.AHf||(this.AHf=!0,this.a5=!1,this.fga.VNb(()=>{this.a5=!0}));return this.a5}PCj(){this.AHf=!1;const ta=this.fga.paste();return ta?ta.hasChildNodes()?{returnValue:!0,xId:ta}:(Q.ULS.sendTraceTag(7891019,
307,50,"DOM innerText empty."),va.Ic.Yb(wa.a.f2,{["Reason"]:ia.a.kkf}),{returnValue:!1,xId:ta}):(Q.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),va.Ic.Yb(wa.a.UEb,{["Reason"]:ia.a.blg}),{returnValue:!1,xId:ta})}static get Ic(){return H.a.instance}}Object(D.a)(va,"SystemClipboardImportStrategy",null,[545]);var na=c(254);c.d(J,"ClipboardActor",function(){return Ca});class Ca{get kGi(){return this.xMa}set kGi(ta){this.xMa=ta}constructor(ta,fa,Xa,ob,xb,zb,Lb,Ia,Ya,eb,sb,lc,vb,Eb,Ua,
Ta,Nb,Wa){this.Shd=null;this.xMa=0;this.cnd=this.cFc=!1;this.ttb=l.a.On;this.nad=()=>{const Bb=Array(1);Bb.push("PasteRecoveryFloatie");var Ob=this.rfk.qQa();Ob=Object.assign(new e.a,{x:Ob.x,y:Ob.y});this.aM.showFloatie(Ob,Bb,1);return 32};this.dIb=()=>{this.aM.M0&&this.aM.dismissFloatie();return 32};this.v6i=(Bb,Ob,hc,Gc,bc)=>{if(1===hc)return 32;bc[a.a.On]=!1;return 32};this.Ftl=(Bb,Ob,hc,Gc,bc,Dc)=>{Q.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Ub=Dc.DataTransfer;Dc=Ub.getData("text/html");
Ub=Ub.getData("text/plain");let Fc=!1;const Sa=new k.DictionaryPropertySet;0<Dc.length?(Q.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Sa.setValue(S.a.LP,Dc),Fc=!0):0<Ub.length&&(Q.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Sa.setValue(S.a.wNb,Ub),Fc=!0);if(Fc){const wb=this.ry.J(Ob);return this.WGd.create(Bb,Ob,wb,new N.a(()=>this.YLc(wb,Sa)),hc,Gc,bc,Sa)}return null};this.l5f=(Bb,Ob,hc,Gc,bc)=>{if(Ob="object"===typeof bc?bc:null)this.y0b?
this.Bho(Bb,this.xMa,Ob):Bb===aa.a.cce?(Bb=this.xMa!==aa.a.MTa&&this.xMa!==aa.a.NTa&&this.xMa!==aa.a.fza,Ob[this.ttb]=this.xMa===aa.a.MTa||Bb):Bb===aa.a.dce?Ob[this.ttb]=this.xMa===aa.a.NTa:Bb===aa.a.h5f&&(Ob[this.ttb]=this.xMa===aa.a.fza);return 32};this.CX=(Bb,Ob,hc,Gc,bc,Dc)=>{if((x.AFrameworkApplication.eZ||x.AFrameworkApplication.DF)&&!x.AFrameworkApplication.CEb||na.a.via(hc)&&na.a.Tcc())return new Na(Bb,Ob,hc,Gc,bc,Dc);let Ub=this.ry.J(Ob);1!==Gc&&Ub&1&&(this.xMa=Ob);if(1!==Gc){var Fc=Object(O.a)(88,
Dc)?Dc:null;Dc?(Ub&1&&(this.Shd=Fc),Fc=Fc?Fc.ja(S.a.aZ,0):0,Ob===aa.a.paste&&Fc===aa.a.o0a?Ub=this.ry.J(aa.a.R_):Ob===aa.a.j$&&Fc===aa.a.fCb&&(Ub=this.ry.J(aa.a.S$d))):!Dc&&Ub&4096&&(Dc=this.Shd,Fc=Object(O.a)(88,Dc)?Dc:null)&&(Fc=Fc.ja(S.a.Y3c,y.a.nil),Q.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Fc))}return this.WGd.create(Bb,Ob,Ub,new N.a(()=>this.YLc(Ub,Dc)),hc,Gc,bc,Dc)};this.hJn=(Bb,Ob,hc,Gc,bc)=>this.J6e(Bb,Ob,hc,bc);this.gJn=(Bb,Ob,hc,Gc,bc)=>this.J6e(Bb,
Ob,hc,bc);this.fJn=(Bb,Ob,hc,Gc,bc)=>this.J6e(Bb,Ob,hc,bc);this.D5d=(Bb,Ob,hc,Gc,bc,Dc)=>{Dc=Y.a.Uc(ea.a.instance.ib.lb.Pa.node,Dc);return this.CX(Bb,Ob,hc,Gc,bc,Dc)};this.zZj=ta;this.fga=fa;this.Ad=Xa;this.lk=ob;this.ga=zb;this.yid=eb;this.yVb=sb;this.Be=lc;this.fg=vb;this.Vb=Ya;this.x0b=Eb;this.y0b=Ua;this.rfk=Ta;this.aM=Nb;this.nHe=Wa;this.rg=n.a.getInstance(Fa.a.r0a);Ia&&(this.cFc=Ia.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.cnd=this.y0b&&Ia.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));
this.ry=new U.a;this.ry.Z(aa.a.paste,257);this.ry.Z(aa.a.j$,8449);this.ry.Z(aa.a.R_,1);this.ry.Z(aa.a.X3a,1);this.ry.Z(aa.a.mBb,1);this.ry.Z(aa.a.sDa,1);this.ry.Z(aa.a.NYd,513);this.ry.Z(aa.a.MTa,4097);this.ry.Z(aa.a.NTa,12289);this.ry.Z(aa.a.fza,131073);this.ry.Z(aa.a.z0f,7);this.ry.Z(aa.a.R$d,1);this.ry.Z(aa.a.S$d,8193);this.ry.Z(aa.a.copy,272);this.ry.Z(aa.a.NHc,16);this.ry.Z(aa.a.cut,304);this.ry.Z(aa.a.J5e,48);this.ry.Z(aa.a.C5d,64);this.ry.Z(aa.a.D5d,64);this.ry.Z(aa.a.oad,327680);this.ry.Z(aa.a.qhf,
1);this.cnd&&this.ry.Z(aa.a.Gob,this.ry.J(aa.a.S$d))}get mVa(){return null!=this.UHg?this.UHg:this.UHg=t.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.nIg?this.nIg:this.nIg=t.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get WGd(){return this.zZj.value}get AHo(){return this.fga}Ub(){this.ga.fb(aa.a.MMn,T.a.application,this.v6i,97);this.ga.fb(aa.a.NMn,T.a.application,this.v6i,97);this.ga.fb(aa.a.cce,T.a.application,this.l5f,97);this.ga.fb(aa.a.dce,
T.a.application,this.l5f,97);this.ga.fb(aa.a.h5f,T.a.application,this.l5f,97);this.ga.KT(aa.a.J5e,T.a.view,this.CX,1028);this.ga.Veb(aa.a.NHc,T.a.view,this.CX);this.ga.KT(aa.a.qhf,T.a.view,this.Ftl,1028);this.ga.KT(aa.a.R_,T.a.view,this.CX,1028);this.ga.KT(aa.a.X3a,T.a.view,this.CX,1028);this.ga.KT(aa.a.mBb,T.a.view,this.CX,1028);this.ga.KT(aa.a.sDa,T.a.view,this.CX,1028);this.x0b&&this.ga.fb(aa.a.o0a,T.a.view,this.fJn,1028);this.y0b&&this.ga.fb(aa.a.fCb,T.a.view,this.gJn,1028);this.ga.KT(aa.a.paste,
T.a.view,this.CX,1028);this.ga.KT(aa.a.j$,T.a.view,this.CX,1028);this.ga.KT(aa.a.S$d,T.a.view,this.CX,1028);this.ga.KT(aa.a.R$d,T.a.view,this.CX,1028);this.ga.KT(aa.a.z0f,T.a.view,this.CX,1028);this.ga.KT(aa.a.MTa,T.a.view,this.CX,1028);this.ga.KT(aa.a.NTa,T.a.view,this.CX,1028);this.ga.qa(aa.a.oPb,T.a.view,z.ActionManager.Nf);this.ga.qa(aa.a.R1i,T.a.view,z.ActionManager.Nf);this.ga.qa(aa.a.O1i,T.a.view,z.ActionManager.Nf);this.ga.qa(aa.a.P1i,T.a.view,z.ActionManager.Nf);this.ga.qa(aa.a.Q1i,T.a.view,
z.ActionManager.Nf);this.ga.qa(aa.a.N1i,T.a.view,z.ActionManager.Nf);this.ga.Veb(aa.a.C5d,T.a.view,this.CX);this.ga.Veb(aa.a.D5d,T.a.view,this.D5d);this.ga.Veb(aa.a.NYd,T.a.view,this.CX);this.ga.Veb(aa.a.oad,T.a.view,this.CX);this.cnd&&(this.ga.fb(aa.a.jIc,T.a.view,this.hJn,1028),this.ga.KT(aa.a.Gob,T.a.view,this.CX,1028));this.ga.qa(aa.a.nPh,T.a.view,z.ActionManager.Nf);this.ga.qa(aa.a.RPh,T.a.view,z.ActionManager.Nf);this.nHe&&(this.ga.fb(aa.a.nad,T.a.view,this.nad,96),this.ga.fb(aa.a.dIb,T.a.view,
this.dIb,96))}F5(){if(this.Vb){const ta=this.Vb.fe(oa.AppFrame.VD);this.cnd&&ta.bindAction(v.KeyInputManager.ic(I.a.Nsb,v.KeyInputManager.Rh|4),aa.a.jIc)}else Q.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}Bho(ta,fa,Xa){switch(fa){case aa.a.NTa:case aa.a.j$:case aa.a.Gob:fa=aa.a.dce;break;case aa.a.fza:fa=aa.a.h5f;break;default:fa=aa.a.cce}Xa[this.ttb]=ta===fa}l$l(){const ta=Object(O.a)(88,this.Shd)?this.Shd:null;return ta?ta.ja(S.a.Y3c,y.a.nil):
y.a.nil}J6e(ta,fa,Xa,ob){if(1===Xa){if(!Object(O.a)(ma.a,fa)||!this.yid||na.a.via(fa)&&na.a.Tcc())return 8;Xa=new N.a(()=>this.YLc(this.ry.J(aa.a.R_),ob));const xb=this.yid.create(Xa,Object(X.a)(88,ob));Xa=new sa.a(x.AFrameworkApplication.K,E.a.instance,Xa,H.a.instance,xb,this.yVb);return ua.a.OBh(fa,Xa)?32:8}if(2===Xa){if(this.Xso(ba.App.x_a))return this.o0a(ta);ba.App.tjc(()=>{this.o0a(ta)});return 32}return 2}o0a(ta){if(!this.Be)return Q.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),
8;var fa=this.Be.ijb();if(!fa)return Q.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;fa=fa.Yn;if(!fa)return Q.ULS.sendTraceTag(592454659,307,10,"No document"),8;Q.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",ta);this.rg.logKpiUsage({kpiName:Fa.a.COa});this.fg.Hvl(ta);ta=M.a.OEb(fa,"paste");fa=this.fg.Yol();Q.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",fa);if(ta)return Q.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.rg.logKpiSuccess({kpiName:Fa.a.COa}),
32;this.npm();Q.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.rg.logKpiFailure({kpiName:Fa.a.COa,errorName:"ExecCommandFailed"});return 8}npm(){this.mVa&&(this.mVa.mRb(),Fa.a.y3d(!0,ea.a.instance,K.a.rG));if(this.telemetry){const ta=this.telemetry.bbd();ta.r3b("CallExecCommandPasteOperation");ta.fail("call to execCommand('paste') failed",!0);this.telemetry.pha(ta)}}Xso(ta){let fa=!1;this.Vb?this.Vb.currentScope?fa=!this.Vb.$Ef(this.Vb.currentScope.name):Q.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):Q.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(fa){Q.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>ta)return Q.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.smf();return!1}return!0}YLc(ta,fa){return ta&256?new va(this.AHo):ta&2?ta&4096?new Aa(fa,this.Ad,this.lk,ba.App.instance.$Wc,ba.App.instance.PUa):new ka(fa,this.Ad,ba.App.instance.PUa):fa.hasProperty(S.a.wNb)?new xa(fa,this.Ad,this.lk,
this.cFc,ba.App.instance.PUa):new Aa(fa,this.Ad,this.lk,ba.App.instance.$Wc,ba.App.instance.PUa)}static get wCn(){return L.a.CUd("Box4PasteScratchPad")}NBh(ta,fa,Xa,ob){return!x.AFrameworkApplication.eZ&&!x.AFrameworkApplication.DF||x.AFrameworkApplication.CEb?(ta=this.CX(null,ta?aa.a.cut:aa.a.copy,fa,1,Xa,ob))?ta.response:8:8}}Object(D.a)(Ca,"ClipboardActor",null,[])},1808:function(D,J,c){c.r(J);D=c(0);var l=c(19),e=c(2064),a=c(1848);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}
Object(D.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);var x=c(2065),y=c(1638),n=c(8),t=c(74),z=c(16),v=c(7),I=c(1698);c.d(J,"ACommentFormatTranslator",function(){return E});class E{constructor(H){this.Sg=H}uEk(H,M){const K=n.ParagraphReader.text(M);let L=null,S=null,Q=null,N=0;var O=0,X=!1;let U="";for(M.ra||K&&K.length&&"\n"!==K||v.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");N<M.ra.length;){const Y=M.ra.J(N),aa=Y.cp;var T=Y.formatting?Y.formatting.Jn:
null;U+=l.a.substring(K,X?O+1:O,aa);Y.Bm&&L&&(O=new e.a,O.fullName=U.startsWith("@")?U.substr(1):U,I.a(L,O),X=new k,I.c(L,X,O),H.tCf(U,O,X,!0),U="",L=null);Y.Bm&&S&&(O=Q||new x.a,O.link=S.url,H.cti(U,O),U="",S=null);L&&S||""===U||(this.Sg.CBb&&Q?(H.RCf(U,Q),Q=null):H.Yca(U),U="");Y.hyperlink&&(Y.hyperlink.mw?L=Y.hyperlink:Y.hyperlink.url&&(S=Y.hyperlink));this.Sg.CBb&&T&&(Q=new x.a,Q.weight=T.ja(z.a.bold,!1)?y.a.e5d:0,Q.italic=T.ja(z.a.italic,!1),Q.underline=T.ja(z.a.underline,!1),Q.strikethrough=
T.ja(z.a.strikethrough,!1),T.hasProperty(z.a.highlight)&&(O=T.getValue(z.a.highlight),Q.highlight=t.a.eF(O)),T.hasProperty(z.a.fontColor)&&(T=T.getValue(z.a.fontColor),Q.color=t.a.eF(T)));O=aa;X=!!Y.blob;N++}}}E.vIk="_@_";E.wIk="Z";Object(D.a)(E,"ACommentFormatTranslator",null,[608])},1809:function(D,J,c){D=c(0);var l=c(156),e=c(19),a=c(30),k=c(22),x=c(2),y=c(163),n=c(172);class t{static get Vg(){return l.a.Nx(t.Wm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}
t.Wm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(t,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(14),v=c(3);c.d(J,"a",function(){return I});class I extends l.a{constructor(E,H,M){super();this.rYg=!1;this.uW=null;this.PIl=K=>{switch(K){case 1:this.ga.processAction(z.a.E2h,2);break;case 2:this.ga.processAction(z.a.F2h,2);break;case 0:this.ga.processAction(z.a.G2h,2)}};this.Hu=H;this.ZS=!1;this.vXb=I.tIl;this.Mh=E;this.ga=M;this.zg="FootnoteEndnoteFormattingOptionsDialog";this.Cd=2;this.Vg=t.Vg;this.ye(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.ye(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Uh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.PIl,null);this.fkb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.uW}set fontName(E){this.uW=E;if(E=document.getElementById("FontSizeComboBox"))E.focus(),this.Mh.updateCommandUI()}get fontSize(){return this.vXb}get fkb(){return this.rYg}set fkb(E){this.rYg=E;this.CEn()}V9(){this.UEd("FontStyleComboBox",
"FontPlaceholder",z.a.HPd.toString(),z.a.g6i.toString(),z.a.p4c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.UEd("FontSizeComboBox","FontPlaceholder",z.a.IPd.toString(),v.a.p5c.toString(),z.a.q4c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const E=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.uY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.uY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.RHc("NoStyle","IndentPlaceholderStyles",
z.a.I2h.toString(),z.a.h6i.toString(),E,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.RHc("FirstLineIndent","IndentPlaceholderStyles",z.a.H2h.toString(),z.a.O4f.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}UEd(E,H,M,K,L,S,Q){M=y.c(E,M,!0,!0,K,L,e.a.zf(S),!0,Q);this.yJd(E,H,M,"Medium")}RHc(E,H,M,K,L,S,Q){M=y.f(E,M,K,e.a.zf(L),e.a.zf(S),Q);this.yJd(E,H,M,"Large",S)}yJd(E,H,M,K,L=null){H=document.getElementById(H);
this.Hu.C_a(E,M);M=this.Hu.fGb(E,K);L&&a.a.wDd(M,String.format("{0}Label",E),L);H.appendChild(M);this.Hu.Rqa(E)}CEn(){this.Hu.Rqa("NoStyle");this.Hu.Rqa("FirstLineIndent")}dispose(){this.ZS||(this.Hu.iZ("FontStyleComboBox"),this.Hu.iZ("FontSizeComboBox"),this.Hu.iZ("NoStyle"),this.Hu.iZ("FirstLineIndent"),this.ZS=!0);this.Mh.updateCommandUI();super.dispose()}static get xVa(){return k.a.instance.resolve("Common.IStandaloneRootController").sea}static UZl(){return new I(n.App.pn,I.xVa,x.AFrameworkApplication.va)}static TZl(){return I.UZl()}}
I.tIl=-1;Object(D.a)(I,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1837:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.ki=this.Zqd=0;this.PXg=a;this.smk=e}nnb(){return this.Zqd-this.ki>=this.smk}reset(){this.ki=this.Zqd=this.PXg()}update(){this.Zqd=this.PXg()}}Object(D.a)(l,"TimeBasedTaskYieldStrategy",null,[647])},1848:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.contentId=""}}Object(D.a)(l,"AtMentionOptionalAttributes",
null,[])},1875:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.ObjectSchemaType=J.ObjectSemantic=J.SequenceType=J.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(J.IntentIds||(J.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(J.SequenceType||(J.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(J.ObjectSemantic||(J.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(J.ObjectSchemaType||(J.ObjectSchemaType={}))},1876:function(D,J,c){Object.defineProperty(J,"__esModule",
{value:!0});J.SearchSuggestionAnnotation=J.SearchSuggestionSignal=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}J.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}J.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1884:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1885),J);e(c(1886),J);e(c(1887),J);e(c(1888),J)},1885:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1886:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1887:function(D,J,c){Object.defineProperty(J,
"__esModule",{value:!0});J.ContractEntityAnnotation=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},
1888:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntitySignal=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1890:function(D,J,c){c.r(J);c.d(J,"ReactOICErrorDialogWithTrial",
function(){return k});D=c(0);var l=c(55);J=c(1730);var e=c(466),a=c(156);class k extends J.a{constructor(x,y,n,t,z,v){super(x,y,n,t,z,v);y={["errorMessage"]:this.zYh,["offerString"]:this.pTi};x=new a.a(!1,!1,!0);this.Msj?(x.Cd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.jkb,["onExecute"]:()=>{e.Redirect.showHelp(this.Qoi)}}):(x.Cd=4,x.ye(2,this.dqi));x.ye(1,this.pBd);x.zg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Uh(this.dialogTitle,Object(l.a)(this,
this.yQn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(D.a)(k,"ReactOICErrorDialogWithTrial",J.a,[])},1891:function(D,J,c){c.r(J);c.d(J,"OICErrorDialogWithTrial",function(){return a});D=c(0);var l=c(55);J=c(1730);var e=c(182);class a extends J.a{constructor(k,x,y,n,t,z){super(k,x,y,n,t,z);k=document.createElement("span");k.innerText=this.zYh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.pTi;k.appendChild(x);
x=new e.StandardDialog;this.Msj?(x.Cd=1,x.g_e(this.jkb,this.Qoi)):(x.Cd=4,x.ye(2,this.dqi));x.ye(1,this.pBd);x.zg=this.id;x.sv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.u1m,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(D.a)(a,"OICErrorDialogWithTrial",J.a,[])},1893:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1894),J);e(c(1895),J)},1894:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1895:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.SearchProviderAnnotation=J.SearchProviderSignal=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}J.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}J.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1984:function(D,
J,c){function l(la){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");la?L.YXn():L.main();Nh.main(la);ki.main(la);z.a.instance.Gc(new Qq,0,la);z.a.instance.Gc(new jd,0,la);Rm(la);Ol(la)}var e=c(0),a=c(7),k=c(1622),x=c(1634),y=c(2),n=c(86),t=c(468),z=c(186),v=c(35),I=c(40),E=c(20),H=c(85),M=c(22),K=c(123);class L{get name(){return"Common.App.OAuth.OAuthPackage"}wc(la){la.register(355,"Common.App.OAuth.IOAuthManager").ha().Ud(()=>
new k.OAuthManager)}init(){const la=M.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.sRo(la)}sRo(la){const bb=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===bb){var qb=t.OAuthManagerSettings.tKc;if(qb&&qb.IsEnabled){var ac=qb.Application,yc=t.OAuthManagerSettings.authority;if(void 0!==ac&&null!==ac&&ac.length&&void 0!==yc&&null!==yc&&yc.length){var $c=x.a[la.kaa],Vd=E.a.rG,
me=la.kL();try{var Md=new Map;void 0!==Md&&null!==Md?(Md.set("SupportStatus",$c),Md.set("Browser",Vd),Md.set("AuthStrategy",me)):Md=null}catch(We){Md=null}n.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Md);var Re=I.a.$e();la.RV("Core",ac).then(We=>{const bg=Math.floor(I.a.$e()-Re);$c=x.a[la.kaa];Vd=E.a.rG;me=la.kL();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
bg,We.IsSuccess,$c,We.ErrorCode,bb,Vd,me);Md&&(Md.set("SupportStatus",$c),Md.set("Browser",Vd),Md.set("AuthStrategy",me));var yf=Object.assign(new K.a,{durationMs:bg,extendedProperties:Md});if(We.IsSuccess){if(n.Health.instance.recordKpiSuccess("WacCorePFT",yf),We="Bearer "+We.Token,y.AFrameworkApplication.He.Ved=We,yf=qb.Endpoint){var Rf=I.a.$e();y.AFrameworkApplication.He.H2b(yf,1,null,{["Authorization"]:We},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(bf=>{var pl=Math.floor(I.a.$e()-
Rf),il=null;bf.Ho?bf="Canceled":bf.Gi?bf="Faulted":(il=bf.result,bf=il.succeeded?"Completed":"Failed");pl={["TaskResult"]:bf,["BrowserTokenDurationMS"]:bg,["BrowserValidationDurationMS"]:pl};il&&(pl.HttpStatus=il.args.data.Ne,il.succeeded&&(il=v.a(il.args.data.te),pl.ServerValidationDurationMS=il.ElapsedMilliseconds,pl.ServerValidationResult=il.ValidatedToken,pl.KMSI=il.KMSI,pl.Scopes=il.Scopes,pl.TokenExpirationS=Math.floor(parseInt(il.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===bf?50:15,H.a.toJSON(pl))})}}else n.Health.instance.recordKpiFailure("WacCorePFT",We.ErrorCode,!1,!1,yf)}).catch(We=>{var bg=Math.floor(I.a.$e()-Re);bg=Object.assign(new K.a,{durationMs:bg,extendedProperties:Md});n.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+We.toString(),!1,!1,bg)})}}}}dispose(){}static main(){z.a.instance.Gc(new L)}static YXn(){z.a.instance.Gc(new L,0,!0)}}Object(e.a)(L,"OAuthPackage",null,[1,2]);var S=c(376),Q=c(368),N=c(19);class O{constructor(){this.Iwd=
new Q.a}eRo(la,bb){if(!la)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;la=N.a.eh(la);if(this.Iwd.nb(la))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",la),!1;this.Iwd.Z(la,bb);return!0}d9l(la){if(!la)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;la=N.a.eh(la);return this.Iwd.nb(la)?this.Iwd.J(la):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
la),null)}}Object(e.a)(O,"SdxPaneSuppressionManager",null,[]);var X=c(250),U=c(258),T=c(15);class Y{constructor(la){this.VLe=0;this.Cck=la}nnb(){return this.VLe>=this.Cck}reset(){this.VLe=0}update(){this.VLe++}}Object(e.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[647]);var aa=c(1837);class ba{constructor(){this.w9c=new Set}gpb(la){this.w9c.add(la)}xTo(la){this.w9c.delete(la)}Uun(){return()=>{this.w9c.forEach(la=>{la.onSessionClose()})}}Vun(){return()=>{this.w9c.forEach(la=>{la.onSessionConnect()})}}Wun(){return()=>
{this.w9c.forEach(la=>{la.onSessionDisconnect()})}}}Object(e.a)(ba,"AlSessionLifeEventNotifier",null,[623]);var oa=c(1417),ma=c(81),ea=c(93),ua=c(61),sa=c(6),Fa=c(1538),Pa=c(157),Na=c(336),Aa=c(1054),za=c(711),xa=c(243),ka=c(411),wa=c(680),ia=c(420),va=c(406);class na{constructor(){this.token=null}}Object(e.a)(na,"ReleaseAnnotationParameters",null,[]);class Ca{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(Ca,"SetAnnotationMetadataParameters",null,[]);class ta{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(e.a)(ta,"SetAnnotationStateParameters",null,[]);var fa=c(598),Xa=c(360),ob=c(75),xb=c(83),zb=c(601),Lb=c(1231),Ia=c(309),Ya=c(761),eb=c(8),sb=c(401);class lc extends Sys.EventArgs{constructor(la,bb){super();this.annotation=la;this.ifb=bb}}Object(e.a)(lc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var vb=c(1022);class Eb{constructor(la){this.$1e=this.annotations=null;if(!la)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(la.items&&0<la.items.length){const bb=Eb.RTd(la.parentPath);this.annotations=Array(la.items.length);let qb=0;for(const ac of la.items){const yc=Object.assign(new vb.a,{id:ac.id,parentPath:bb,content:ac.body,annotationType:xa.a.getTypeNameFor(ac.body),parentRevId:la.parentRevId});this.annotations[qb++]=yc}this.$1e=xa.a.getTypeNameFor(la)}}static RTd(la){return la?la.join("\\"):""}}Object(e.a)(Eb,"AnnotationOperation",null,[]);class Ua extends Sys.EventArgs{constructor(la){super();this.annotationType=
la}}Object(e.a)(Ua,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Ta extends Sys.EventArgs{constructor(la,bb){super();this.annotation=la;this.opType=bb}}Object(e.a)(Ta,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Nb{constructor(){this.newState=this.oldState=0;this.handlers=new ob.a}}Object(e.a)(Nb,"AnnotationResultStateUpdateData",null,[]);var Wa=c(614),Bb=c(1016);class Ob{constructor(){this.X1e=this.jDk=this.Y1e=null}}Object(e.a)(Ob,"AnnotationCallbacks",null,[]);class hc{constructor(la,
bb,qb,ac,yc,$c){this.b2b=null;this.gBc=new Q.a(0);this.xFc=new Q.a;this.fhd=new Q.a;this.mud=new Wa.a;this.rYf=null;this.ti=la;this.nMa=bb;this.aG=qb;this.rC=ac;this.QI=yc;this.rd=$c}Z4o(la,bb,qb,ac){this.rC.jcc(la)&&this.ti.ie(()=>{if(!this.b2b){this.b2b=new Q.a;var yc=eb.ParagraphReader.yw(sb.a.getRootNode(),!0,!0);for(const $c of yc)$c&&(yc=$c.ja(sa.a.Wc,0))&&(this.b2b.add(yc,$c.id),this.gBc.Z($c.id.toString(),yc))}this.nMa.qYf(la,($c,Vd)=>{if($c){var me=this.rC.wci(la);$c.contentDescriptor.Rv===
me&&((me=this.s_l($c))?$c.hfb?(me=this.Zaf($c,me))&&(Vd?qb(Vd,$c.contentDescriptor):bb(me,$c.contentDescriptor)):ac($c.contentDescriptor):this.ikl($c,Object.assign(new Ob,{Y1e:bb,jDk:qb,X1e:ac})))}})},"PAS:FEPAOT")}s_l(la){if(3===la.contentDescriptor.Rv){let bb;return({value:bb}=this.b2b.Fc(la.contentDescriptor.paragraphId)).returnValue?bb:null}if(4===la.contentDescriptor.Rv)return ua.a.nil;a.ULS.sendTraceTag(592525442,hc.Ii,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}uOm(la,
bb){if(3===la.contentDescriptor.Rv)return bb=this.QI.value.Eb(bb).getValue(sa.a.uj),la.contentDescriptor.uj===bb;if(4===la.contentDescriptor.Rv&&bb===ua.a.nil)return!0;a.ULS.sendTraceTag(592525443,hc.Ii,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}ikl(la,bb){if(3===la.contentDescriptor.Rv){const qb=la.contentDescriptor.paragraphId;this.xFc.nb(qb)||this.xFc.add(qb,new ob.a);this.xFc.J(qb).add(ac=>{12===ac.type&&this.b2b.add(qb,ac.id);la.hfb?(ac=this.Zaf(la,ac.id))&&bb.Y1e(ac,
la.contentDescriptor):bb.X1e(la.contentDescriptor)})}else if(4===la.contentDescriptor.Rv)if(la.hfb){const qb=this.Zaf(la,ua.a.nil);qb&&bb.Y1e(qb,la.contentDescriptor)}else bb.X1e(la.contentDescriptor);else a.ULS.sendTraceTag(592525444,hc.Ii,15,"DelayCallbackForAnnotation: Unsupported content type")}Zaf(la,bb){if(this.uOm(la,bb)){if(bb=this.rC.kin(la.hfb,la.contentDescriptor,bb.toString()))return this.fhd.Z(bb.id,la.m7a),bb}else this.rd.isFeatureEnabled(90)&&this.aG.cGc(la);return null}LHj(la,bb){const qb=
this.rC.qRd(la);qb&&(bb===Aa.a.getTypeName()?this.JPo(la,qb):this.uPo(la,qb))}JPo(la,bb){this.rC.jcc(la.annotationType)&&(this.aG.VTa(this.QI.value,bb,la.annotationType),this.fhd.remove(la.id))}uPo(la,bb){if(this.rC.jcc(la.annotationType)){bb=Object.assign(new Bb.a,{hfb:this.rC.nDk(la),contentDescriptor:bb,annotationType:la.annotationType});bb=this.aG.addAnnotation(this.QI.value,bb);this.fhd.Z(la.id,bb);const qb=this.rC.Uki(la.annotationType);qb&&this.mud.contains(qb)&&(this.ti.ie(()=>{var ac=eb.ParagraphReader.yw(sb.a.getRootNode(),
!0,!0);if(ac&&0<ac.count){const yc=new ob.a;for(const $c of ac)(ac=hc.OTd($c))&&yc.add(ac);0<yc.count&&this.aG.Hph(this.QI.value,qb,yc.toArray())}},"PAS:TAOCPA"),this.mud.remove(qb))}}Znb(la){if(this.b2b)if(la){var bb=la.ja(sa.a.Wc,0);if(bb&&(this.gBc.Z(la.id.toString(),bb),({value:bb}=this.xFc.Fc(bb)).returnValue))for(const qb of bb)qb(la)}else a.ULS.sendTraceTag(592525445,hc.Ii,10,"OnParagraphNodeConnected: Invalid node")}sXi(la,bb){if(la){var qb=la.id.toString();la=la.ja(sa.a.Wc,0);var ac=0;({value:ac}=
this.gBc.Fc(qb)).returnValue&&(3===bb?(this.xFc.remove(ac),this.gBc.remove(qb)):2===bb?this.gBc.Z(qb,la):a.ULS.sendTraceTag(592525447,hc.Ii,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,hc.Ii,10,"UpdatePersistedAnnotations: Invalid node")}Ybm(la){let bb;return({value:bb}=this.fhd.Fc(la)).returnValue?bb:ua.a.nil}J0o(la,bb,qb){la?bb?this.nMa.Yei(la,ac=>{if(ac){const Vd=hc.OTd(bb,qb);if(Vd){var yc=Array(ac.length),$c=!1;for(let me=
0;me<ac.length;me++)if($c||Vd!==ac[me])yc[me]=ac[me];else{const Md=hc.OTd(bb);if(!Md)return;$c=!0;yc[me]=Md;ac[me]=Md}$c&&this.aG.Hph(this.QI.value,la,yc)}}}):a.ULS.sendTraceTag(588863697,hc.Ii,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,hc.Ii,10,"UpdateWorkflowParagraphVersion: null workflowType")}Smo(la){la?this.mud.add(la):a.ULS.sendTraceTag(588863698,hc.Ii,10,"SetPendingWorkflow: null workflowType")}zZk(la){la?this.mud.remove(la):a.ULS.sendTraceTag(588105731,
hc.Ii,10,"ClearPendingWorkflow: null workflowType")}static OTd(la,bb=0){if(!la)return null;bb||(bb=la.ja(sa.a.uj,0));la=eb.ParagraphReader.uR(la);if(bb&&la)return String.format("{0}{1}{2}",la,hc.eBn,bb);a.ULS.sendTraceTag(588091606,hc.Ii,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",bb?"valid":"0",la?"valid":"0");return null}}hc.Ii=389;hc.eBn="-";Object(e.a)(hc,"PersistedAnnotationStorage",null,[644]);class Gc{constructor(){this.config=this.token=null}}Object(e.a)(Gc,"UpdateAnnotationConfigParameters",
null,[]);var bc=c(122),Dc=c(1207),Ub=c(340),Fc=c(1428),Sa=c(871),wb=c(206),Tb=c(1112),Hb=c(288);class $a{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg=null,yf){this.Hdb=yf;this.sa=new ma.a;this.OAa=new xb.a;this.B6=new xb.a;this.tD=new xb.a;this.Ste=new xb.a;this.buc=new fa.a(Xa.a.ih());this.wNe=new ob.a;this.KUb=new xb.a;this.Ote=new xb.a;this.hhd=new xb.a;this.LUb=new xb.a;this.irc=new xb.a;this.ihd=new xb.a;this.zjd=new xb.a;this.wsd=[];this.xsd=[];this.pzc=null;this.Dck=new fa.a(Xa.a.ih());
this.Qte=new Map;this.Ztc=new Map;this.wsc=null;this.$ka=new xb.a;this.rLc=null;this.abh=this.e0g=0;this.DZa=null;this.thl=()=>{if(this.wsd.length||this.xsd.length)try{0<this.wsd.length&&this.Kan(),0<this.xsd.length&&this.SSo()}finally{this.MZk()}else this.Ib.ff(this.pzc),this.pzc=null};this.IZk=()=>{const Rf=new ob.a;for(const bf of this.tD.values)if(Rf.add(bf),Rf.count===$a.Nck)break;for(const bf of Rf)this.q1a(bf),this.bQb(bf,Aa.a.getTypeName());this.tD.count||(this.Ib.ff(this.wsc),this.wsc=null)};
this.r2c=(Rf,bf)=>{for(const pl of bf.Qj)Rf=pl.intent,!Rf.type&&this.Bso(Rf.intent,pl.cpBegin,pl.cpEnd,pl.UKb)&&this.q1a(Rf.intent)};this.o8j=la.$("AugLoopAnnotationsAttachingIsEnabled");this.ejk=la.EB("SendReleaseMessageAnnotationList")||[];this.rd=Re;this.CKa=bg;this.nMa=$c;this.aG=Vd;this.fn=qb;this.rC=me;this.$aa=Md;this.QI=ac;this.ti=bb;this.Ib=yc;M.a.instance.resolve("Box4.ICharacterPropertiesEditor").z0e(this.r2c);this.Yr=We;this.oWj=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.d8j=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.S9j=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.l2g=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.Hdb&&this.zqm();this.qz=wb.a.instance}get B$i(){return this.LUb}set B$i(la){this.LUb=la}ob(la,bb){a.ULS.sendTraceTag(41521862,$a.Ii,50,"New registration for annotation type: {0}.",bb);this.addHandler(la,
bb);this.pZe(bb).catch(qb=>{a.ULS.sendTraceTag(594396739,$a.Ii,10,"Failed to activate annotation type {0}: {1}",bb,qb.toString())})}addHandler(la,bb){if(la&&bb&&""!==bb){var qb=null;({value:qb}=this.LUb.Fc(bb,qb)).returnValue?qb.add(la):(qb=new ob.a,qb.add(la),this.LUb.add(bb,qb))}else a.ULS.sendTraceTag(41521861,$a.Ii,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!la,!bb,""===bb)}uc(la,bb){a.ULS.sendTraceTag(41521863,$a.Ii,50,"Unregister handler for annotation type: {0}.",
bb);let qb=null;({value:qb}=this.LUb.Fc(bb,qb)).returnValue&&(qb.remove(la),qb.count||(a.ULS.sendTraceTag(41521864,$a.Ii,50,"Unregister all handlers for annotation type: {0}.",bb),this.LUb.remove(bb),this.Gln(bb)))}goj(la){this.rLc||(this.rLc=this.Yr.Pc(2),this.rLc.Db(la))}MZk(){var la;null===(la=this.rLc)||void 0===la?void 0:la.dispose();this.rLc=null}OLh(){this.pzc||(this.pzc=new ea.a(4,2,100,this.thl,141),this.Ib.Wb(this.pzc))}Kan(){let la;la=Array.dequeue(this.wsd);const bb=sb.a.OGb(this.QI.value,
la);if(bb)if(bb.yj){this.goj(bb);var qb=null;if(({value:qb}=this.irc.Fc(la,qb)).returnValue){this.irc.remove(la);for(const ac of qb)this.Lan(bb,ac)}else a.ULS.sendTraceTag(50663568,$a.Ii,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Dck.add(la);else a.ULS.sendTraceTag(50436127,$a.Ii,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}Lan(la,bb){var qb=bb.content.range;qb=new Lb.a(0,qb.start,qb.start+qb.length,ua.a.create(),bb,ac=>{this.Ste.Z(bb.id,
ac.toString())});this.fn.nHa(la,qb);this.sa.j9&&this.sa.raiseEvent($a.Ogc,new Ta(bb,Na.a.getTypeName()))}SNi(la){const bb=sb.a.n3a(la.parentPath);let qb=null;({value:qb}=this.irc.Fc(bb,qb)).returnValue||(qb=new ob.a,this.irc.add(bb,qb),this.wsd.push(bb));qb.add(la);this.OLh()}Nan(la,bb){this.ti.ie(()=>{let qb;if(({value:qb}=this.B6.Fc(la,qb)).returnValue){var ac=this.urj(la);for(const yc of qb){let $c;({value:$c}=this.tD.Fc(yc,$c)).returnValue&&bb($c)&&$a.VIb($c)&&(this.SNi($c),ac&&this.sa.raiseEvent($a.Ogc,
new Ta($c,Aa.a.getTypeName())))}}},"AS:MIFAT")}TSo(la,bb){this.ti.ie(()=>{let qb;if(({value:qb}=this.B6.Fc(la,qb)).returnValue)for(const ac of qb){let yc;({value:yc}=this.tD.Fc(ac,yc)).returnValue&&bb(yc)&&$a.VIb(yc)&&this.Yog(yc)}},"AS:UIFAT")}Nln(la){var bb=sb.a.DJ(la);let qb=null;if(({value:qb}=this.OAa.Fc(bb,qb)).returnValue){bb=0;for(var ac=new ob.a;qb.count>bb;){var yc=qb.J(bb),$c=null;({value:$c}=this.tD.Fc(yc,$c)).returnValue&&$a.VIb($c)?this.rC.H$c(la,$c)?this.q1a($c,!this.rd.isFeatureEnabled(90)):
(yc=$c.content.range,$c=new Lb.a(0,yc.start,yc.start+yc.length,ua.a.create(),$c),ac.add($c),bb++):bb++}0<ac.count&&this.fn.oPf(la,ac)}}SSo(){let la="";la=Array.dequeue(this.xsd);const bb=sb.a.OGb(this.QI.value,la);if(bb&&12===bb.type){this.goj(bb);var qb=null;({value:qb}=this.ihd.Fc(la,qb)).returnValue?(this.fn.Bdd(ac=>qb.contains(ac.intent),bb,0),this.ihd.remove(la)):a.ULS.sendTraceTag(50663570,$a.Ii,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
$a.Ii,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}Yog(la){let bb;({value:bb}=this.Ste.Fc(la.id,bb)).returnValue||(bb=sb.a.n3a(la.parentPath));this.Ste.remove(la.id);var qb=null;({value:qb}=this.ihd.Fc(bb,qb)).returnValue||(qb=new ob.a,this.ihd.add(bb,qb),this.xsd.push(bb));qb.add(la);this.OLh();qb=null;({value:qb}=this.irc.Fc(bb,qb)).returnValue&&qb.remove(la)}fuk(la){const bb=la.id;var qb=la.annotationType;const ac=la.parentPath;if(this.rC.Flb(la)){var yc=sb.a.vjb(this.QI.value,
ac);if(yc&&(yc=yc.ja(sa.a.uj,0).toString(),la.parentRevId&&yc!==la.parentRevId))return!1}yc=null;({value:yc}=this.B6.Fc(qb,yc)).returnValue||(yc=new ob.a,this.B6.add(qb,yc));yc.add(bb);qb=null;({value:qb}=this.OAa.Fc(ac,qb)).returnValue||(qb=new ob.a,this.OAa.add(ac,qb));qb.add(bb);this.tD.add(bb,la);this.Y4o(la);return!0}Y4o(la){const bb=this.rC.k5h(la);if(0===bb.length)this.NTh(la);else{let qb=!1;this.nMa.Gsn(bb,la.annotationType,(ac,yc)=>{this.tD.nb(la.id)?(yc=this.rC.Wlb(la,sb.a.AOl(la)),!ac&&
yc?this.eqg(la,10,!1):ac&&this.eqg(la,ac),qb||(this.NTh(la),qb=!0)):yc.QUa=!0})}}NTh(la){const bb=$a.VIb(la);bb&&this.SNi(la);!bb&&this.sa.j9&&this.sa.raiseEvent($a.Ogc,new Ta(la,Na.a.getTypeName()))}gFj(la,bb,qb,ac){let yc=!0;this.ti.ie(()=>{if(ac.startsWith(sb.a.lEb)){var $c=la.id,Vd=null;if(bb===Aa.a.getTypeName())this.q1a(la);else if(({value:Vd}=this.tD.Fc($c,Vd)).returnValue)a.ULS.sendTraceTag(41418891,$a.Ii,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",$c,la.annotationType),
this.tD.Z($c,la);else if(!this.fuk(la)){yc=!1;return}qb&&bb===Na.a.getTypeName()&&ac!==sb.a.lEb&&this.wNe.add(la.annotationType)}this.bQb(la,bb)},"AS:UAS");return yc}gio(la){if(la)for(const bb of la)this.bQb(bb,za.a.getTypeName()),la=bb.content,this.zjd.nb(la.categoryName)?this.zjd.Z(la.categoryName,bb):this.zjd.add(la.categoryName,bb);else a.ULS.sendTraceTag(592802119,$a.Ii,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}Oxk(la){this.sa.addHandler($a.Ogc,la)}erh(la){this.sa.addHandler($a.cUi,
la)}icc(la){return this.KUb.nb(la)}Nxk(la){this.sa.addHandler($a.W6d,la)}f2n(la){this.sa.removeHandler($a.W6d,la)}urj(la){return!sb.a.af(la)&&Ya.a(la)&&this.sa.j9}q1a(la,bb=!0){if(this.tD.nb(la.id)){var qb=this.tD.J(la.id);this.tD.remove(la.id);var ac=null;({value:ac}=this.OAa.Fc(la.parentPath,ac)).returnValue?(ac.remove(la.id),$a.VIb(qb)&&this.Yog(qb)):a.ULS.sendTraceTag(50734169,$a.Ii,15,"DeleteAnnotationFromStorage: No annotations in given parent path");ac=null;({value:ac}=this.B6.Fc(la.annotationType,
ac)).returnValue?ac.remove(la.id):a.ULS.sendTraceTag(50734170,$a.Ii,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.urj(la.annotationType)?this.sa.raiseEvent($a.Ogc,new Ta(qb,Aa.a.getTypeName())):this.bQb(la,Aa.a.getTypeName());bb&&this.$aa.LHj(qb,Aa.a.getTypeName())}}yof(la,bb,qb=!1){const ac=new ob.a;var yc;if(!({value:yc}=this.B6.Fc(la,yc)).returnValue)return ac;for(const $c of yc)this.tD.nb($c)?(la=this.tD.J($c),(yc=this.rC.qRd(la))&&(bb.equals(yc)||
qb&&bb.overlaps(yc))&&ac.add(la)):a.ULS.sendTraceTag(577843217,$a.Ii,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",$c);return ac}YKd(la){let bb=null;if(({value:bb}=this.B6.Fc(la,bb)).returnValue){la=bb.toArray();for(const qb of la){let ac;({value:ac}=this.tD.Fc(qb,ac)).returnValue&&this.q1a(ac)}}}bLm(la){return xa.a.getTypeNameFor(la)===Ub.a.getTypeName()}bxi(la){var bb,qb;return(null===(qb=null===(bb=this.Hdb)||void 0===bb?void 0:bb.sci)||void 0===qb?void 0:
qb.call(bb))===Dc.a.iqc&&la&&0===la.priority?this.Hdb.Xbd(la.context.substr(la.startInContext,la.range.length)):!1}o5i(la,bb){this.ti.ie(()=>{a.ULS.R$($a.Ii,100)&&a.ULS.sendTraceTag(41418894,$a.Ii,100,"Operation of type {0} with path {1} received",xa.a.getTypeNameFor(la),la.parentPath.join("\\"));try{const qb=new Eb(la);for(const ac of qb.annotations)if(ac.annotationType===Sa.FlagResultAnnotation.getTypeName()){const yc=ac.content.results.map($c=>{var Vd;const me=null===(Vd=$c.M_)||void 0===Vd?void 0:
Vd.seq;Vd=void 0===me?ac.id:ac.id+"_"+me;return{id:Vd,body:{...$c,id:Vd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.o5i({items:yc,parentPath:la.parentPath,parentRevId:la.parentRevId,H_:la.H_},bb)}else qb.$1e===Na.a.getTypeName()&&this.mvo(ac)?(y.AFrameworkApplication.se("g8469255;j5hhe441"),this.l2g&&(this.DZa||(this.DZa=Tb.a.JQd()),this.e0g++,this.DZa.moh("AnnotationSkippedDueToInvalidContextCount",this.e0g.toString()))):this.VSc(ac,bb,qb.$1e,!0)}catch(qb){a.ULS.sendTraceTag(41418898,
$a.Ii,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",qb.message,qb.stack)}},"AS:PO")}mvo(la){var bb;y.AFrameworkApplication.se("01dfc961;05c12706");if(this.S9j&&Ya.a(la.annotationType)){var qb;let yc=qb=null;if(this.qz){qb=this.qz.y4;var ac=null===qb||void 0===qb?void 0:qb.node;qb=sb.a.n3a(la.parentPath);if(sb.a.OGb(this.QI.value,qb)!==ac)return!1;la=la.content;qb=la.context.substring(la.startInContext,la.startInContext+la.range.length);yc=null===(bb=null===ac||
void 0===ac?void 0:ac.characterData)||void 0===bb?void 0:bb.substring(la.range.start,la.range.start+la.range.length);this.l2g&&la&&0===la.priority&&(bb=0<la.range.start?ac.characterData.charAt(la.range.start-1):null,ac=la.range.start+la.range.length<ac.characterData.length?ac.characterData.charAt(la.range.start+la.range.length):null,"en-us"==la.language.toLocaleLowerCase()&&yc&&qb&&yc===qb&&(bb&&bb.match("[A-Za-z0-9]")||ac&&ac.match("[A-Za-z0-9]"))&&(this.DZa||(this.DZa=Tb.a.JQd()),this.abh++,this.DZa.moh("partialWordAnnotationsCount",
this.abh.toString())))}return yc&&qb&&yc!==qb?!0:!1}return!1}VSc(la,bb,qb,ac){if(this.bLm(la.content)&&this.bxi(la.content))this.qAa(la,70);else{var yc=la.parentPath;qb!==Aa.a.getTypeName()&&ac||this.naj(la);ac&&qb===Na.a.getTypeName()&&Ya.a(la.annotationType)&&la.content.isHotCritique&&this.d8j?this.Ztc.set(la.id,{annotation:la,time:Date.now()}):(ac=la.annotationType,sb.a.af(ac)||ac!==ka.a.getTypeName()?!sb.a.af(ac)&&Ya.a(ac)&&la.content&&0==la.content.priority&&bc.a.Z4?(la=sb.a.n3a(yc))&&la==bc.a.RMl()&&
a.ULS.sendTraceTag(539870169,$a.Ii,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):qb!==Aa.a.getTypeName()&&this.buc.contains(yc)?a.ULS.sendTraceTag(41418897,$a.Ii,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",yc,la.id):this.eFj(la,yc,qb,bb):a.ULS.sendTraceTag(595342670,$a.Ii,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",yc))}}g_n(la){if(la&&la.annotationType&&this.rC.jcc(la.annotationType)){var bb;
if(({value:bb}=this.B6.Fc(la.annotationType,bb)).returnValue&&(la=this.rC.qRd(la)))for(const qb of bb){let ac;({value:ac}=this.tD.Fc(qb,ac)).returnValue&&(bb=this.rC.qRd(ac))&&(la.equals(bb)||la.overlaps(bb))&&this.q1a(ac)}}}bQb(la,bb){this.ti.ie(()=>{let qb=null;if(({value:qb}=this.B$i.Fc(la.annotationType,qb)).returnValue)for(const ac of qb)ac.KB(la,bb)},"AS:SATH")}HZk(){a.ULS.sendTraceTag(50860999,$a.Ii,50,"ClearStorage: Initiated Clearing Storage");this.wsc||(this.wsc=new ea.a(4,2,100,this.IZk,
142),this.Ib.Wb(this.wsc))}activateAnnotation(la,bb){let qb;if(({value:qb}=this.hhd.Fc(la,qb)).returnValue){if(qb.contains(bb))return Promise.resolve(null);qb.add(bb)}else{let ac;this.hhd.add(la,(ac=new ob.a,ac.add(bb),ac))}return this.pZe(la)}pZe(la){a.ULS.sendTraceTag(41521865,$a.Ii,50,"ActivateAnnotation: Activating annotation type {0}.",la);if(this.KUb.nb(la))return Promise.resolve(null);var bb=null;if(({value:bb}=this.Ote.Fc(la,bb)).returnValue)return bb;this.Vqk(la);bb=null;this.CKa&&(bb=this.CKa());
if(bb){const qb=new va.a;qb.annotationType=la;this.oWj&&(this.$ka.nb(la)||this.$ka.Z(la,new Nb),qb.stateUpdateHandler=(ac,yc)=>{this.$ka.J(la).oldState=ac;this.$ka.J(la).newState=yc;for(const $c of this.$ka.J(la).handlers)$c(la,ac,yc)});bb=bb.activateAnnotation(qb);this.Ote.add(la,bb);return bb.then(ac=>{this.Ote.remove(la);this.KUb.add(la,ac.token);this.fFj(ac.token,la);this.sa.raiseEvent($a.W6d,new Ua(la,!0));this.xqm(la);return ac})}return Promise.reject(Error.create("Error during annotation activation"))}xqm(la){const bb=
this.rC.Uki(la);bb&&this.nMa.Yei(bb,qb=>{if(this.$aa.rYf){var ac=eb.ParagraphReader.yw(sb.a.getRootNode(),!0,!0);if(ac&&0<ac.count){let yc=0;for(const $c of ac){ac=hc.OTd($c);if(!ac)continue;let Vd=!1;for(;yc<qb.length;){if(ac===qb[yc]){Vd=!0;break}yc++}if(!Vd){this.$aa.rYf(bb);break}yc++}}}})}Vqk(la){this.$aa.Z4o(la,(bb,qb)=>{0<this.yof(la,qb,!0).count||this.gFj(bb,Na.a.getTypeName(),!0,bb.parentPath)},(bb,qb)=>{if(3!==qb.Rv)a.ULS.sendTraceTag(591541786,$a.Ii,15,"Annotation moved to unsupported location type: {0}",
qb.Rv);else if(bb.Rv!==qb.Rv)a.ULS.sendTraceTag(591541787,$a.Ii,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",bb.Rv,qb.Rv);else{bb=this.yof(la,bb);for(const yc of bb){const $c=yc.content;bb=sb.a.vjb(this.QI.value,yc.parentPath);if(!bb){a.ULS.sendTraceTag(591541788,$a.Ii,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.fn.Bdd(Vd=>Vd.intent===$c,bb,0))break;var ac=qb.Rua;ac=new Lb.a(0,ac,ac+qb.Qua,null,$c);this.fn.nHa(bb,
ac)}}},bb=>{for(const qb of this.yof(la,bb))this.q1a(qb,!1)})}releaseAnnotation(la,bb){let qb;if(({value:qb}=this.hhd.Fc(la,qb)).returnValue){qb.contains(bb)&&qb.remove(bb);if(0<qb.count)return Promise.resolve(!1);this.hhd.remove(la)}a.ULS.sendTraceTag(593790408,$a.Ii,50,"ReleaseAnnotation: Releasing annotation type {0}.",la);return this.$jj(la)}Gln(la){var bb=null;if(({value:bb}=this.B6.Fc(la,bb)).returnValue){a.ULS.sendTraceTag(41418899,$a.Ii,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
la);for(const qb of bb)if(bb=null,({value:bb}=this.tD.Fc(qb,bb)).returnValue){const ac=bb.parentPath;let yc=null;({value:yc}=this.OAa.Fc(ac,yc)).returnValue&&(yc.remove(qb),yc.count||this.OAa.remove(ac));this.tD.remove(qb);$a.VIb(bb)&&this.Yog(bb)}this.B6.remove(la)}Array.contains(this.ejk,la)&&this.$jj(la)}$jj(la){let bb=null,qb=null;this.CKa&&(qb=this.CKa());if(qb){if(({value:bb}=this.KUb.Fc(la,bb)).returnValue){const ac=new na;ac.token=bb;this.KUb.remove(la);this.sa.raiseEvent($a.W6d,new Ua(la,
!1));return qb.releaseAnnotation(ac)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}xHi(){this.ti.ie(()=>{if(this.o8j){var la=sb.a.getRootNode();if(la){var bb=new xb.a;zb.f(la,qb=>{var ac=sb.a.DJ(qb),yc=null;if(({value:yc}=this.OAa.Fc(ac,yc)).returnValue)for(const $c of yc)ac=null,({value:ac}=this.tD.Fc($c,ac)).returnValue&&(ac.parent=qb,ac.oXc=!0,ac.uNb=2,bb.nb(ac.annotationType)||bb.Z(ac.annotationType,new ob.a),bb.J(ac.annotationType).add($c),
yc=null,({value:yc}=this.B6.Fc(ac.annotationType,yc)).returnValue&&yc.remove(ac.id));return!0},12);for(const qb of this.B6.keys)if(la=null,({value:la}=this.B6.Fc(qb,la)).returnValue)for(const ac of la)if(la=null,({value:la}=this.tD.Fc(ac,la)).returnValue){let yc=null;la.parentPath===sb.a.lEb?(la.uNb=1,la.parent=null):({value:yc}=this.tD.Fc(la.parentPath,yc)).returnValue?(la.uNb=3,la.parent=yc):(la.uNb=0,la.parent=null,a.ULS.sendTraceTag(41554060,$a.Ii,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
la.id));la.oXc=!0;bb.nb(la.annotationType)||bb.Z(la.annotationType,new ob.a);bb.J(la.annotationType).add(ac)}else a.ULS.sendTraceTag(41997840,$a.Ii,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",ac);else a.ULS.sendTraceTag(41997841,$a.Ii,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",qb);this.B6=bb;this.wNe.clear()}else a.ULS.sendTraceTag(41554058,$a.Ii,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
$a.Ii,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}mDk(la){this.o5i(la,!0)}Uvn(la,bb){this.ti.ie(()=>{const qb=bb?bb+String.format("\\{0}",la.id):sb.a.DJ(la);a.ULS.sendTraceTag(41418900,$a.Ii,50,"OnTileDeleted: Tile delete event received for tile {0}.",qb);this.buc.contains(qb)||this.buc.add(qb);var ac=null;if(({value:ac}=this.OAa.Fc(qb,ac)).returnValue){a.ULS.sendTraceTag(41418901,$a.Ii,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",ac.count,
qb);for(const yc of ac)ac=null,({value:ac}=this.tD.Fc(yc,ac)).returnValue&&(this.bQb(ac,Aa.a.getTypeName()),this.sa.j9&&this.sa.raiseEvent($a.Ogc,new Ta(ac,Aa.a.getTypeName())),this.tD.remove(yc));this.OAa.remove(qb)}},"AS:OTD")}Tvn(la){la=sb.a.DJ(la);this.buc.remove(la)&&a.ULS.sendTraceTag(41418902,$a.Ii,50,"OnTileAdded: Deleted tile {0} was re-added.",la)}MZo(la){if(la){a.ULS.sendTraceTag(50436131,$a.Ii,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",la.count);var bb=new xb.a;
for(var qb of la)la=null,({value:la}=bb.Fc(qb.parentPath,la)).returnValue||(la=new xb.a,bb.add(qb.parentPath,la)),la.Z(qb.id,qb);for(const ac of bb){bb=sb.a.vjb(this.QI.value,ac.key);if(!bb){a.ULS.sendTraceTag(50436160,$a.Ii,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}qb=new Ia.a([0]);for(let yc=0,$c=bb.ra.length;yc<$c;yc++)la=bb.ra.J(yc),la.Qj&&qb.UVa(la.Qj,void 0,(Vd,me)=>{if(me){var Md=null,Re=me.intent;Re&&({value:Md}=ac.value.Fc(Re.id,Md)).returnValue&&(Re=new wa.a,
Re.start=me.Lb.cp,Re.length=Vd.Lb.cp-Re.start,Md.content.range=Re,Md.rqa=!1)}})}}else a.ULS.sendTraceTag(50436130,$a.Ii,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(la){a.ULS.sendTraceTag(593049729,$a.Ii,50,"GetAnnotationsByType: Method called for type {0}.",la);return this.pZe(la).then(()=>{const bb=new ob.a;this.ti.ie(()=>{if(sb.a.af(la)||la!==ka.a.getTypeName()){this.wNe.contains(la)&&this.xHi();var qb=null;if(({value:qb}=this.B6.Fc(la,qb)).returnValue){a.ULS.sendTraceTag(41418903,
$a.Ii,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",la);var ac=new ob.a;for(const yc of qb)qb=null,({value:qb}=this.tD.Fc(yc,qb)).returnValue&&(qb.rqa&&ac.add(qb),bb.add(qb));ac&&0<ac.count&&$a.VIb(ac.J(0))&&this.MZo(ac)}}else for(ac of this.zjd.values)bb.add(ac);bb.count||a.ULS.sendTraceTag(41418904,$a.Ii,50,"GetAnnotationsByType: No annotations found for type {0}!",la)},"AS:GABT");return bb},bb=>{a.ULS.sendTraceTag(41418905,$a.Ii,10,"Exception occurred while fetching annotations of type {0}: {1}",
la,bb);return null})}Gha(la){let bb=null;return({value:bb}=this.tD.Fc(la,bb)).returnValue?bb:null}zof(la){let bb=null;if(this.OAa.nb(la))for(const qb of this.OAa.J(la))if(la=this.Gha(qb))bb||(bb=new ob.a),bb.add(la);return bb}ZKb(la){return(la=this.Gha(la))?(la.oXc||this.xHi(),la):null}qAa(la,bb){this.Loo(la,bb);this.eqg(la,bb);this.bQb(la,za.a.getTypeName())}JUo(la,bb){this.EYo(la,bb);this.Ulo(la,sb.a.zOl(la));this.bQb(la,za.a.getTypeName())}KUo(la,bb){la=this.rC.k5h(la);for(const qb of la)this.aG.Tpg(this.QI.value,
qb,bb)}Loo(la,bb){let qb=null;this.CKa&&(qb=this.CKa());qb&&(la=this.BOl(la,bb))&&qb.setAnnotationState(la)}eqg(la,bb,qb=!0){if(la&&$a.Vvi(la)){var ac=this.Gha(la.id);!la.content||ac&&la.content===ac.content||sb.a.setAnnotationState(la,bb);ac&&ac.content&&sb.a.setAnnotationState(ac,bb);qb&&this.sa.j9&&(70===bb||60===bb)&&this.sa.raiseEvent($a.cUi,new lc(la,bb))}}BOl(la,bb){let qb=null;la&&(qb=Object.assign(new ta,{id:la.id,value:bb}),sb.a.af(la.parentPath)||(qb.parentPath=la.parentPath.split("\\")));
return qb}Ulo(la,bb){const qb=this.CKa?this.CKa():null;qb&&(la=this.yOl(la,bb))&&qb.setAnnotationMetadata(la)}EYo(la,bb){if(la&&$a.Vvi(la)){var qb=this.Gha(la.id);!la.content||qb&&la.content==qb.content||sb.a.Ikj(la,bb);qb&&qb.content&&sb.a.Ikj(qb,bb)}}yOl(la,bb){if(!la)return null;const qb=new Ca;qb.id=la.id;qb.value=bb;sb.a.af(la.parentPath)||(qb.parentPath=la.parentPath.split("\\"));return qb}Bso(la,bb,qb,ac){if(y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",
!1)&&(la.annotationType===Hb.FeedbackAnnotation.getTypeName()||la.annotationType===Hb.FeedbackRewriteAnnotation.getTypeName()))return!1;const yc=la.content;if(this.rC.Flb(la)&&yc){const $c=yc.range.start+yc.range.length;if(0<ac&&$c<=qb||0>ac&&$c<=qb+ac)return!1;if(0<ac&&yc.range.start>=bb||0>ac&&yc.range.start>=qb)return yc.range.start+=ac,!1}return!this.rd.isFeatureEnabled(63)&&yc&&yc.M_?(la=this.rC.Wlb(la,60),!(60===yc.M_.state&&la)):!0}roh(la,bb){this.$ka.nb(bb)||this.$ka.Z(bb,new Nb);this.$ka.J(bb).handlers.add(la);
la(bb,this.$ka.J(bb).oldState,this.$ka.J(bb).newState)}W$i(la,bb){this.$ka.nb(bb)&&this.$ka.J(bb).handlers.contains(la)&&this.$ka.J(bb).handlers.remove(la)}static Vvi(la){la=xa.a.getBaseTypesFor(la.content);return Array.contains(la,Pa.a.getTypeName())}static VIb(la){if(void 0===la.content||null===la.content||""===sb.a.n3a(la.parentPath))return!1;const bb=xa.a.getBaseTypesFor(la.content);return Array.contains(bb,ia.a.getTypeName())&&la.annotationType!==Fa.RoleDetectionAnnotation.getTypeName()}IUo(la){la?
(this.Qte.AugLoop_Text_Critique=la,la=this.icc("AugLoop_Text_Critique")?this.KUb.J("AugLoop_Text_Critique"):null,this.fFj(la,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,$a.Ii,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}fFj(la,bb){if(la&&this.Qte[bb]){const qb=new Gc;qb.token=la;qb.config=this.Qte[bb];this.CKa&&(this.CKa().updateAnnotationConfig(qb),a.ULS.sendTraceTag(540615553,$a.Ii,50,"Annotation configuration has been updated for annotation type: {0}.",
bb))}}naj(la){let bb=null;({value:bb}=this.tD.Fc(la.id,bb)).returnValue&&(la.annotationType=bb.annotationType);this.Ztc.has(la.id)&&this.Ztc.delete(la.id)}eFj(la,bb,qb,ac){this.g_n(la);this.gFj(la,qb,ac,bb)&&this.$aa.LHj(la,qb)}VTa(la){const bb=la.parentPath,qb=Aa.a.getTypeName();this.naj(la);this.qAa(la,70);this.buc.contains(bb)||this.eFj(la,bb,qb,!0)}s4l(la){const bb=new ob.a;la=this.B6.Fc(la).value;if(null===la)return bb;for(const qb of la)la=this.tD.Fc(qb).value,null!==la&&bb.push(la);return bb}async zqm(){await Object(Fc.b)();
this.haj()}haj(){const la=this.s4l(Ub.a.getTypeName());for(const bb of la)this.bxi(bb.content)&&this.VTa(bb)}}$a.Ii=389;$a.Ogc="OnAnnotationOperation";$a.cUi="OnAnnotationLocalStateChange";$a.W6d="OnAnnotationActivationChange";$a.Nck=20;Object(e.a)($a,"AnnotationStorage",null,[645]);class ab{constructor(){this.Zfe=null;this.R$c=!1}}Object(e.a)(ab,"AugmentationLoopStateManager",null,[642]);var rb=c(202),cb=c(578),rc=c(69),Rb=c(105),fb=c(602),Pb=c(532),Ec=c(233);class uc extends Ec.a{constructor(){super();
this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}ml(){return Pb.a.seedFullFileAugLoop}static construct(la,bb,qb,ac,yc,$c){const Vd=new uc;Vd.ExpectedEndRevisionId=la;Vd.OriginString=bb;Vd.Authorization=qb;Vd.AugLoopSeedUrl=ac;Vd.FileId=yc;Vd.SeedBatchesInParallelIsEnabled=$c;Vd.AddDocumentKindTypeToPathIsEnabled=
!0;Vd.CheckOnDemandNodeVersionEnabled=!0;Vd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Vd}}Object(e.a)(uc,"FullFileAugLoopSeedingRequest",Ec.a,[]);class ya{constructor(){this.authToken=this.url=this.C_i=null}}Object(e.a)(ya,"ReseedingTaskInfo",null,[]);var db=c(25);class tb{constructor(la,bb,qb,ac,yc,$c){this.hfa=null;this.cXg=!1;this.sWb=null;this.TQe=0;this.T4c=(Vd,me)=>{Vd=me.Jba;this.sWb&&Rb.AT(Vd,Md=>Md===this.sWb)&&(me.httpStatusCode!==rb.a.Zz||me.hI||2!==me.n1f?me.httpStatusCode!==rb.a.Zz||
me.hI||1!==me.n1f?this.Jfj(()=>{a.ULS.sendTraceTag(50861003,tb.Ii,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",me.httpStatusCode,me.hI,me.n1f,me.Vr)}):(this.iO.R$c=!1,this.hfa.Fjc(this.T4c),this.Je.HZk(),a.ULS.sendTraceTag(50861002,tb.Ii,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Vd=Object(rc.a)(ya,this.sWb),this.J6i(me.K9n,Vd.C_i,Vd.url,Vd.authToken)):
this.Jfj(()=>{a.ULS.sendTraceTag(50861001,tb.Ii,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.cDl=Vd=>{if(void 0===Vd||null===Vd||void 0===Vd.data||null===Vd.data||void 0===Vd.data.te||null===Vd.data.te)a.ULS.sendTraceTag(41445393,tb.Ii,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Vd.data.Ne!==rb.a.Zz)a.ULS.sendTraceTag(41445394,tb.Ii,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",
Vd.data.Ne);else try{let me;({group:me}=cb.a.d2(Vd.data.te)).returnValue?me.Responses&&me.Responses.length?(Vd=null,me&&me.Responses&&me.Responses.length&&(Vd=me.Responses[0])?(this.q3.PVa(Vd),Vd.StatusCode?a.ULS.sendTraceTag(41445398,tb.Ii,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Vd.StatusCode):a.ULS.sendTraceTag(41445399,tb.Ii,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Vd.LastSeededRevisionId)):
a.ULS.sendTraceTag(41445397,tb.Ii,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,tb.Ii,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,tb.Ii,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(me){a.ULS.sendTraceTag(41445400,tb.Ii,10,"FileSeedingSuccessCallback: {0}",
me.message)}};this.bDl=Vd=>{void 0===Vd||null===Vd||void 0===Vd.data||null===Vd.data||void 0===Vd.data.te||null===Vd.data.te?a.ULS.sendTraceTag(41445401,tb.Ii,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,tb.Ii,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Vd.data.Ne)};this.jXj=la.$("AugLoopServerSideSeedingIsEnabled");this.hXj=la.$("AugLoopReseedingIsEnabled");this.iXj=la.$("AugLoopFFSSeedBatchesInParallelIsEnabled");
this.l7g=la.nc("MaxReseedingRetries",1);this.Zf=bb;this.Jnd=qb;this.iO=ac;this.q3=yc;this.Je=$c;db.StaticActiveAppFrame.za()&&db.StaticActiveAppFrame.za().jb&&db.StaticActiveAppFrame.za().jb.Zc&&db.StaticActiveAppFrame.za().jb.Zc.contentReplicator&&(this.hfa=db.StaticActiveAppFrame.za().jb.Zc.contentReplicator)}$Cm(la,bb,qb){if(this.jXj){var ac=this.iO.Zfe;ac&&ac.trim().length?this.cXg?this.hXj&&(a.ULS.sendTraceTag(50861E3,tb.Ii,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.TQe=
0,this.hfa?(this.iO.R$c=!0,this.hfa.lGc(this.T4c),this.sWb=Object.assign(new ya,{C_i:la,url:bb,authToken:qb}),this.hfa.kF(null,null,this.sWb)):a.ULS.sendTraceTag(592814793,tb.Ii,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,tb.Ii,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.J6i(ac,la,bb,qb),this.cXg=!0):a.ULS.sendTraceTag(41445391,tb.Ii,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
tb.Ii,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}Jfj(la){this.TQe<this.l7g?(a.ULS.sendTraceTag(594384E3,tb.Ii,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.TQe,this.l7g),this.hfa.kF(null,null,this.sWb)):(this.iO.R$c=!1,this.hfa.Fjc(this.T4c),la())}J6i(la,bb,qb,ac){const yc=uc.construct(la,bb,ac,qb,y.AFrameworkApplication.rootQuerySignature,this.iXj);
a.ULS.sendTraceTag(595178454,tb.Ii,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Jnd.U3a.execute(()=>{this.yvk(yc)})}yvk(la){a.ULS.sendTraceTag(595178453,tb.Ii,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Zf.nj(T.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,fb.b(la),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.cDl,this.bDl,la);a.ULS.sendTraceTag(42016906,
tb.Ii,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}tb.Ii=389;Object(e.a)(tb,"FullFileAugLoopSeedingService",null,[]);class Xb{constructor(){}}Object(e.a)(Xb,"RuntimeManagerInitializationTracker",null,[]);var $b=c(714);class Ab{getAugLoopRuntimeManager(){return $b.a.getAugLoopRuntimeManager()}}Object(e.a)(Ab,"AlFactoryWrapper",null,[641]);class vc{ll(){return sb.a.ll()}}Object(e.a)(vc,"UtilsWrapper",null,[640]);var Sc=c(760),ed=c(56),pd=c(16),oc=c(47),cd=c(175),Xc=c(2060),
ic=c(5),Ac=c(104),wd=c(218),Je=c(28),Zd=c(356),le=c(394),kc=c(99);class kd{constructor(la,bb,qb,ac,yc){this.Ca=la;this.Hf=qb;this.ep=ac;this.De=yc;this.xpa=this.Ca.$("WordDesignerCaptionDetectionEnabled")}Ujo(la,bb){la.listType=this.k4l(bb);la.outlineLevel=eb.ParagraphReader.Qwa(bb);la.indentation=kd.Wrf(this.ep.yU(bb));la.alignment=kd.lof(eb.ParagraphReader.Ox(bb));la.isInsideTable=this.isInsideTable(bb);la.isInsideTOC=bb.Fr;la.rightIndentation=kd.Wrf(this.ep.i3a(bb));var qb=this.ep.aac(bb);la.specialIndentType=
kd.pfm(qb);la.specialIndentBy=kd.Wrf(qb);la.listType!==Xc.e.NoList&&this.Blo(bb,la);this.Foo(bb,la);qb=[];this.xpa&&(qb=this.YIn(bb));la.formattedRanges=this.a_l(bb,qb);this.xpa&&null!=qb&&(la.objectReferences=0<qb.length?qb:void 0)}a_l(la,bb){var qb=la.ra?la.ra.length:0,ac=Ac.FormattingReader.Xr(Je.a.create(la));let yc=kc.a.PH,$c=0,Vd=kc.a.HM/2;ac&&(Vd=Ac.FormattingReader.Zn(ac,pd.a.fontSize,kc.a.HM)/2,yc=Ac.FormattingReader.Zn(ac,pd.a.font,kc.a.PH),$c=Ac.FormattingReader.language(ac));ac="Normal";
var me=this.De.hp(la);me&&(ac=me.getValue(oc.a.la)||"Normal",me.hasProperty(pd.a.font)&&(yc=me.getValue(pd.a.font)));if(qb){--qb;me=[];let bf=null,pl=void 0,il=null;this.xpa&&la.hasProperty(pd.a.Rn)&&(il=la.getValue(pd.a.Rn));const Sk=la.properties.ja(sa.a.gha,null);for(let Vj=0;Vj<qb;Vj++){var Md=la.ra.J(Vj),Re=la.Mc,We=null;this.xpa&&(We=kd.Zvf(la,il,Vj));Md.Ue&&(bf=kd.gWo(Re,Md.Ue,bf));Md.hyperlink&&Md.hyperlink.url?pl=Md.hyperlink.url:Md.Bm&&(pl=void 0);var bg=la.ra.J(Vj+1).cp-1;Re=Md.cp;bg=bg-
Md.cp+1;let Ch=!1,Qn=!1,zh=!1,gk=Vd,sk=0,wl=0,Rn=ac,nk=void 0,Zm=$c,uo=yc,Ui;if(Md.formatting){var yf=Md.formatting;Ch=Ac.FormattingReader.Zn(yf,pd.a.bold,!1);Qn=Ac.FormattingReader.Zn(yf,pd.a.italic,!1);zh=Ac.FormattingReader.Zn(yf,pd.a.underline,!1);gk=Ac.FormattingReader.Zn(yf,pd.a.fontSize,2*Vd)/2;sk=Ac.FormattingReader.Zn(yf,oc.a.capitalization,0);wl=Ac.FormattingReader.Zn(yf,pd.a.fontColor,0);Zm=Ac.FormattingReader.language(yf)||$c;uo=Ac.FormattingReader.Zn(yf,pd.a.font,yc);Rn=ac;var Rf=yf.Jn;
Rf&&(Rf=Rf.ja(oc.a.qw,null))&&!Rf.equals(ua.a.nil)&&yf.paragraph.Mc&&(yf=yf.paragraph.Mc.Eb(Rf))&&(Rn=(new wd.a(yf)).getValue(oc.a.la))}this.xpa&&(Ui=this.stf(We),null!=Ui&&this.vqh(bb,We,Ui,me.length,Xc.b.Inline));bf&&(nk=0<bf.count);Md={isDeleted:this.ELm(Sk,Md,Vj,pl),fontFamily:uo,fontWeight:Ch?Xc.d.Bold:Xc.d.Normal,fontSize:gk,italic:Qn,underline:zh?Xc.h.SingleLine:Xc.h.None,capitalization:kd.tKh(sk),color:wl,styleName:Rn,isFollowUp:nk,languageId:kd.jKh(Zm),start:Re,length:bg,link:pl,isReference:kd.isReference(Md)?
!0:void 0,objectType:null!==Ui&&void 0!==Ui?Ui:void 0};We=0<me.length?me[me.length-1]:void 0;kd.vTk(We,Md)?We.length+=Md.length:me.push(Md)}return me}return[{fontFamily:yc,fontWeight:Xc.d.Normal,fontSize:Vd,italic:!1,underline:Xc.h.None,capitalization:kd.tKh(0),color:0,styleName:ac,isFollowUp:void 0,languageId:kd.jKh($c),start:0,length:la.characterData.length}]}ELm(la,bb,qb,ac){if(this.QB()){if(bb.blob||bb.formatting&&bb.formatting.cache&&bb.formatting.cache.HJb||ac)return!0;if(la&&qb<la.length)return la[qb]}return bb.NR?
!0:bb.Lh?!0:!1}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static vTk(la,bb){return!!la&&!!bb&&la.start+la.length===bb.start&&la.isDeleted===bb.isDeleted&&la.fontFamily===bb.fontFamily&&la.fontWeight===bb.fontWeight&&la.fontSize===bb.fontSize&&la.italic===bb.italic&&la.underline===bb.underline&&la.capitalization===bb.capitalization&&la.color===bb.color&&la.highlightColor===bb.highlightColor&&la.styleName===
bb.styleName&&void 0===la.link&&void 0===bb.link&&la.languageId===bb.languageId&&!la.isReference&&!bb.isReference&&!la.isFollowUp&&!bb.isFollowUp&&void 0===la.objectType&&void 0===bb.objectType}k4l(la){const bb=new ic.GraphIterator;bb.set(la);bb.zb(11);bb.jd(11);return(la=this.Hf.ww(bb))?kd.b8k(la.listType):Xc.e.NoList}Blo(la,bb){var qb=this.Hf.Aca(la);qb&&(qb.hasProperty(sa.a.listID)&&(bb.listId=qb.getValue(sa.a.listID).toString()),qb=this.eci(la,pd.a.font),la=this.eci(la,pd.a.fontSize),qb&&(bb.bulletAndNumberFontFamily=
qb),la&&(bb.bulletAndNumberFontSize=la))}isInsideTable(la){const bb=new ic.GraphIterator;bb.set(la);return bb.zb(14)}Foo(la,bb){bb.spacingBeforeParagraph=this.Phi(la,sa.a.C5,sa.a.ZY,sa.a.Ui);bb.spacingAfterParagraph=this.Phi(la,sa.a.B5,sa.a.YY,sa.a.ua);bb.lineSpacing=this.GGb(la)}Phi(la,bb,qb,ac){if(eb.ParagraphReader.Zn(la,bb,!1))return 0;bb=eb.ParagraphReader.Zn(la,qb,-1);if(0<=bb)return bb*Zd.a.nNb/100;la=eb.ParagraphReader.Zn(la,ac,-1);return 0<=la?la/20:0}eci(la,bb){la=this.$Wl(la);if(null!=
la&&null!=la.cache)return la.cache.getValue(bb)}$Wl(la){var bb;la=null===(bb=la.ra)||void 0===bb?void 0:bb.last;return null!=la&&la.Ph?la.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}GGb(la){const bb=eb.ParagraphReader.Zn(la,sa.a.ya,Zd.a.ya);la=eb.ParagraphReader.Zn(la,sa.a.xa,Zd.a.lineSpacing);switch(bb){case 0:return la/240;case 1:return la/20;default:return 0}}static gWo(la,bb,qb){for(let ac=0;ac<bb.length;ac++){const yc=bb.J(ac),
$c=yc.Lj,Vd=la.Eb($c);Vd&&Vd.ja(sa.a.UG,!1)&&(qb||(qb=new fa.a(new le.a)),yc.Qc?qb.add($c):qb.remove($c))}return qb}static jKh(la){return(la=Sc.a.ug(la))&&la.name?la.name.toLowerCase():void 0}static Wrf(la){return la?2===la.unit?Math.floor(ed.a.sCb(la.value)/20):Math.floor(la.value/20):0}static pfm(la){if(!la)return Xc.g.Initial;switch(la.specialIndentType){case 1:return Xc.g.FirstLine;case 2:return Xc.g.Hanging;default:return Xc.g.Initial}}static tKh(la){switch(la){case 2:return Xc.c.AllCaps;case 1:return Xc.c.SmallCaps;
default:return Xc.c.NoCaps}}static lof(la){switch(la){case 1:return Xc.a.Left;case 3:return Xc.a.Right;case 2:return Xc.a.Center;case 6:return Xc.a.Justified;case 0:return Xc.a.None;default:return Xc.a.Other}}static b8k(la){switch(la){case 15:return Xc.e.Any;case 1:return Xc.e.Bullet;case 42:return Xc.e.Invalid;case 13:return Xc.e.Lim;case 14:return Xc.e.Nil;case 16:return Xc.e.NoList;case 0:return Xc.e.Numbered;default:return Xc.e.Invalid}}static isReference(la){return la.blob&&(7===la.blob.vh||
10===la.blob.vh)||la.$g&&0<la.$g.length||la.Ue&&0<la.Ue.length||la.Jb&&0<la.Jb.length?!0:!1}static Zvf(la,bb,qb){return null==bb?null:bb[qb]&&!bb[qb].equals(ua.a.nil)&&la.Mc?la.Mc.Eb(bb[qb]):null}stf(la){if(null==la)return null;if(la.hasProperty(sa.a.Ns)){var bb=la.getValue(sa.a.Ns);if(kd.L2i.has(bb))return kd.L2i.get(bb)}if(la.hasProperty(sa.a.U8b)&&null!=la.getValue(sa.a.U8b))return Xc.f.FootnoteEndnote;if(la.hasProperty(sa.a.pageBreak)&&la.getValue(sa.a.pageBreak))return Xc.f.PageBreak;if(la.hasProperty(sa.a.iKb)&&
la.getValue(sa.a.iKb))return Xc.f.Tab;bb=!1;la.hasProperty(cd.a.R4)?bb=la.getValue(cd.a.R4):la.hasProperty(sa.a.wia)&&(bb=la.getValue(sa.a.wia));return bb&&la.hasProperty(sa.a.imageType)&&1==la.getValue(sa.a.imageType)?Xc.f.Image:null}static EOm(la){return la.hasProperty(sa.a.Rac)&&0<=la.getValue(sa.a.Rac)?!0:!1}EDi(la){return kd.vGo.has(la)}yNh(la,bb,qb,ac){return null==la||null==bb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):ac===Xc.b.Inline&&null==qb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):ac===Xc.b.Floating&&null!=qb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>qb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):kd.EOm(la)?null:this.EDi(bb)?{referencedPath:["session",
"doc","main",la.id.toString()],formattedRangeIndex:qb,anchorMode:null!==ac&&void 0!==ac?ac:Xc.b.Unspecified,anchoredObjectType:ac==Xc.b.Floating?bb:void 0}:null}vqh(la,bb,qb,ac,yc){bb=this.yNh(bb,qb,ac,yc);null!=bb&&null!=la&&la.push(bb)}YIn(la){const bb=[];if(null==la)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),bb;let qb=null;la.hasProperty(sa.a.X7)&&(qb=la.getValue(sa.a.X7));if(null!=qb)for(let ac=0;ac<qb.length;++ac){const yc=kd.Zvf(la,
qb,ac),$c=this.stf(yc);null!=$c&&this.vqh(bb,yc,$c,null,Xc.b.Floating)}return bb}kJh(la){if(null==la||!la.hasProperty(pd.a.Rn))return!1;const bb=la.getValue(pd.a.Rn);for(let ac=0;ac<bb.length;ac++){var qb=kd.Zvf(la,bb,ac);qb=this.stf(qb);if(this.EDi(qb))return!0}return!1}}kd.L2i=new Map([[5,Xc.f.Image],[11,Xc.f.TextBox],[7,Xc.f.Chart],[6,Xc.f.SmartArt],[10,Xc.f.Drawing],[2,Xc.f.EquationObject],[4,Xc.f.Ink],[19,Xc.f.PageBreak],[23,Xc.f.FootnoteEndnote],[24,Xc.f.FootnoteEndnote],[35,Xc.f.FootnoteEndnoteReferenceMark],
[36,Xc.f.FootnoteEndnoteReferenceMark],[0,Xc.f.Other]]);kd.vGo=new Set([Xc.f.Image,Xc.f.TextBox,Xc.f.Chart,Xc.f.SmartArt,Xc.f.Drawing,Xc.f.Ink]);Object(e.a)(kd,"FormattingExtractor",null,[639]);var nd=c(1237);class Ud extends Sys.EventArgs{constructor(la){super();this.Jac=la}}Object(e.a)(Ud,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Qd extends Sys.EventArgs{constructor(la){super();this.w9=la}}Object(e.a)(Qd,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Gd{constructor(la,bb,qb){this.E1c=
la;this.graphNode=bb;this.fullPath=qb}}Object(e.a)(Gd,"NodeEvent",null,[668]);class of{constructor(){this.QFe=this.ADe=!1;this.Owb=null;this.sa=new ma.a;this.Raa=new Q.a(0);this.wbb=new nd.a(Xa.a.ih());this.zxb=new nd.a(Xa.a.ih());this.vsd=[]}Uqh(la){this.sa.addHandler("IsCollectingNodeEventsChangedKey",la)}nZk(){this.Raa=new Q.a(0);this.Jac=!1}get Jac(){return this.ADe}set Jac(la){this.ADe!==la&&(this.ADe=la,this.sa.raiseEvent("HasNodeEventsChangedKey",new Ud(la),this))}get w9(){return this.QFe}set w9(la){this.QFe!==
la&&(this.QFe=la,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Qd(la),this))}SPb(la,bb){this.wbb.nb(la)||this.wbb.Z(la,bb)}lbo(la,bb){this.zxb.Z(la,bb)}sOl(la){let bb=null;this.zxb.nb(la)&&(bb=this.zxb.J(la),this.zxb.remove(la));return bb}mde(la,bb){if(la)if(this.w9){var qb=3!==bb&&4!==bb&&5!==bb||!this.wbb.nb(String.format("{0}",la.id))?sb.a.DJ(la):this.wbb.J(String.format("{0}",la.id));if(({value:ac}=this.Raa.Fc(qb)).returnValue)if(ac||3!==bb)if(5===ac&&3===bb){if(la=qb.split("\\").pop(),
this.zxb.nb(la)){var ac=this.zxb.J(la);ac===qb?(this.kOf(qb,bb),this.Raa.add(qb,bb)):(this.zxb.Z(la,qb),this.wbb.Z(la,ac),this.YLi(qb),this.Raa.remove(qb),this.kOf(qb,bb),this.Raa.add(ac,5))}}else ac&&(4!==ac||0!==bb&&3!==bb&&5!==bb)&&(this.kOf(qb,bb),this.Raa.add(qb,bb));else this.YLi(qb),this.Raa.remove(qb);else this.m9m(qb,bb),this.vsd.push(la),this.Raa.add(qb,bb);this.Jac=0<this.Raa.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}m9m(la,bb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",la,bb)}kOf(la,bb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",la,bb)}YLi(la){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",la)}u5k(){let la=null;var bb=!1;let qb=null;for(;this.vsd.length&&!bb;){qb=Array.dequeue(this.vsd);if(!qb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.wbb.nb(String.format("{0}",qb.id))?(la=this.wbb.J(String.format("{0}",qb.id)),this.wbb.remove(String.format("{0}",qb.id)),this.vsd.push(qb)):la=sb.a.DJ(qb);bb=this.Raa.nb(la)}if(!bb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.nZk(),null;bb=this.Raa.J(la);this.Raa.remove(la);this.Jac=0<this.Raa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",la,bb);return new Gd(bb,qb,la)}zTn(la){this.Owb=la}v5k(){if(!this.Owb)return null;
for(var la=0;la<this.Owb.length;la++){var bb=this.Owb.J(la);bb=sb.a.DJ(bb.node);if(this.Raa.nb(bb))return null}la=this.Owb;this.Owb=null;return la}FZk(){this.Owb=null}gDo(){this.w9=!0}ZMm(la){return this.Raa.nb(la.id.toString())}}Object(e.a)(of,"NodeEventsCollection",null,[638]);var Tf=c(1505),uh=c(1427),Gh=c(292),Dh=c(113);class lg extends uh.a{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We){super();this.Znd=new Tf.a;this.hbb=!1;this.Muc=null;this.gja=(bg,yf)=>{(bg=yf.node)&&this.q8a(bg)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),sb.a.iuo(bg,this.fma.w9,this.VUb,this.Uik)&&(this.fma.mde(bg,0),this.jGj(bg)));this.fma.w9&&this.$aa.Znb(bg)};this.nUi=(bg,yf)=>{bg=yf.node;this.fma.SPb(String.format("{0}",bg.id),sb.a.DJ(bg))};this.dTa=(bg,yf)=>{(bg=yf.node)&&this.q8a(bg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.fma.w9&&this.fma.mde(bg,3));this.fma.w9&&this.$aa.sXi(bg,3)};this.IP=(bg,yf)=>{bg=yf.node;yf=yf.property;bg&&this.FWj.has(yf)&&this.q8a(bg)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.fma.w9&&(this.fma.mde(bg,2),yf===sa.a.uj&&this.jGj(bg)));this.fma.w9&&yf===sa.a.Wc&&this.$aa.sXi(bg,2)};this.oUi=(bg,yf)=>{(bg=yf.node)&&eb.ParagraphReader.Xb(bg)&&!this.ruc.has(bg)&&!this.NAe.has(bg)&&(this.ruc.add(bg),this.TY())};this.uXi=(bg,yf)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(bg=yf.node)&&this.Je.Nln(bg)};this.jUf=()=>{this.T$c()?this.ZJ():this.hbb&&!this.fma.w9&&this.pAa()};this.yC=bb;this.fma=qb;this.Uik=Dh.b(ac.Zfe);
this.VUb=la.$("AugLoopOperationsAreEnabled");this.Je=yc;this.$aa=$c;this.rC=Vd;this.Ib=me;this.fn=Md;this.aG=Re;this.ruc=new Set;this.NAe=new Set;We.pra(this,7);this.FWj=new Set([pd.a.ho,pd.a.bold,pd.a.italic,pd.a.underline,pd.a.font,pd.a.fontSize,pd.a.fontColor,oc.a.capitalization,pd.a.Jh,pd.a.Rn,sa.a.C5,sa.a.ZY,sa.a.Ui,sa.a.B5,sa.a.YY,sa.a.ua,sa.a.ya,sa.a.xa,sa.a.listID,sa.a.iN,sa.a.ee,sa.a.qja,sa.a.xu,sa.a.uj])}get index(){return 7}get O2c(){return this.Muc}set O2c(la){this.Muc=la;this.$aa.rYf=
la?()=>{this.Muc()}:null}init(){this.T$c()&&this.ZJ();this.fma.Uqh(this.jUf)}ZJ(){this.yC?(this.hbb=!0,this.yC.ku(this.gja),this.yC.pO(this.nUi),this.yC.kw(this.dTa),this.yC.qo(this.IP),this.yC.Brh(this.uXi),this.yC.$xk(this.oUi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}pAa(){this.yC?(this.hbb=!1,this.yC.xV(this.gja),this.yC.w$(this.nUi),this.yC.bea(this.dTa),this.yC.UP(this.IP),this.yC.lcj(this.uXi),this.yC.l2n(this.oUi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}tXd(la){la&&this.Znd.add(la.id,la.ja(sa.a.uj,0))}jGj(la){this.Znd.nb(la.id)?(this.$aa.J0o(oa.a.Vje,la,this.Znd.J(la.id)),this.Znd.remove(la.id)):(this.$aa.zZk(oa.a.Vje),this.O2c&&this.O2c())}q8a(la){const bb=db.StaticActiveAppFrame.za().jb.rc;return!!bb&&bb.ov&&!!bb.ed&&!!bb.ed.Mc&&!!la&&!!la.Mc&&la.Mc.id===bb.ed.Mc.id}run(){if(0!==this.ruc.size){var la=[];for(const bb of this.ruc)la.push(bb),this.NAe.add(bb),100<=la.length&&
(this.uXh(la),la=[]);0<la.length&&this.uXh(la);this.ruc.clear()}}uXh(la){const bb=new ea.a(4,1,500,()=>{for(const qb of la)this.NAe.delete(qb),this.LUo(qb)},158);this.Ib.Wb(bb)}LUo(la){var bb=this.fn.wQa(la,0,ac=>this.Mvo(ac.intent));if(0<bb.count)for(const ac of bb){bb=this.$aa.Ybm(ac.intent.id);var qb=la.hoa;const yc=eb.ParagraphReader.uR(la);ac.end<ac.Bc||(qb=Gh.a.ZKc(yc,qb,ac.Bc,ac.end-ac.Bc,ac.Bc,ac.end-ac.Bc,la),this.aG.W7f(la.Mc,bb,qb))}}Mvo(la){return!!la&&this.rC.Flb(la)&&!!la.content}T$c(){return!this.hbb&&
this.fma.w9}}Object(e.a)(lg,"ParagraphNodeEventHandler",uh.a,[635]);var xh=c(1029),eg=c(400),cc=c(456),Ic=c(103);class Yc extends cc.a{constructor(){super();this.H_=Object.assign(new Ic.a,{T_:Yc.getTypeName(),B_:Yc.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(Yc,"DeltaUpdateOperation",cc.a,[]);var ad=c(372);class yd{constructor(){this.referencedPath=null}}Object(e.a)(yd,"ItemReference",null,[]);
class ne extends ad.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(ne,"ItemWithPath",ad.a,[]);var Oe=c(999);class nf extends Oe.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new Ic.a,{T_:nf.getTypeName(),B_:nf.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(nf,"MoveOperation",Oe.a,[]);var wf=c(446);
class Ye extends wf.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new Ic.a,{T_:Ye.getTypeName(),B_:Ye.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Ye,"SelectionSignal",wf.a,[]);class Rg extends Ye{constructor(){super();this.content=null;this.H_=Object.assign(new Ic.a,{T_:Rg.getTypeName(),B_:Rg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(Rg,"SelectionContentSignal",Ye,[]);class Db{constructor(){this.range=this.tileReference=null}}Object(e.a)(Db,"TextTileRange",null,[]);var Zb=c(1692),xc=c(371),Jd=c(37),ie=c(17);class De{constructor(la,bb,qb,ac,yc,$c,Vd,me){this._augLoopRuntimeManager=this.$ld=null;this.iTe=!1;this.wma=this.mJe=this.Zwd=null;this.nSg=2E3;this.ZFl=()=>{if(T.App.lostSession||eg.SessionStatusManager.instance&&eg.SessionStatusManager.instance.Io)$b.a.getAugLoopRuntimeManager().closeSession(),
a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Ib.ff(this.$ld);this.ti.ie(()=>{var Md;const Re=wb.a.instance.y4;this.QB()&&this.w6n();for(this.qEc.reset();this.FYa.Jac&&!this.qEc.nnb();){let yf;yf=this.FYa.u5k();if(!yf||!yf.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.qEc.update();continue}if(!this.Sto(yf)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
yf.graphNode.id);this.qEc.update();continue}const Rf=yf.graphNode.id.toString();var We=-1,bg=!0;Re&&ie.SelectionEditor.Ze(Re)&&Rf==Re.node.id.toString()&&(We=Re.cpBegin,bg=!1);let bf=null;if(this.izb.contains(Rf))switch(yf.E1c){case 3:this.izb.remove(Rf);bf=3;break;default:bf=yf.E1c}else switch(yf.E1c){case 0:case 1:this.izb.add(Rf);bf=0;break;case 2:this.izb.add(Rf);bf=0;break;case 3:this.izb.remove(Rf);bf=3;break;default:bf=yf.E1c}if(null!=bf){We=this.Xdi(yf.graphNode,yf.fullPath,bf,We,bg);if(4==
bf||5==bf){if(We.prevParentPath.join()!==We.parentPath.join()){bg=Object.assign(new Aa.a,{parentPath:We.prevParentPath,items:We.items});const pl=Object.assign(new Na.a,{parentPath:We.parentPath,items:We.items,prevId:We.prevId,nextId:We.nextId});Rf!==We.prevId&&Rf!==We.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",bf,Rf,We.prevId,We.nextId,yf.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,
{operation:bg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,{operation:pl}));14===yf.graphNode.type&&this.Kjj(yf.graphNode,We.parentPath).forEach(il=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,{operation:il}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,{operation:We}));if(this.Chd&&this.wma&&this.wma[0]==Rf)switch(bf){case 3:this.wma=null;break;case 0:case 1:case 2:case 4:case 5:this.wma[1]=null===(Md=this.Bxb.QGb(yf.graphNode))||
void 0===Md?void 0:Md.jQc(yf.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",xa.a.getTypeNameFor(We),Rf);switch(bf){case 0:case 4:case 5:this.Je.Tvn(yf.graphNode);break;case 3:this.Je.Uvn(yf.graphNode,We.parentPath.join("\\"))}}this.qEc.update()}(Md=this.FYa.v5k())&&this.Qdj(Md)},"TV:FPEFO")};this.Uqa=(Md,Re)=>{var We;if(Re.yl&&Re.yl.length){if(this.Chd)if(Md=sb.a.d7l(Re.yl),!Md)this.wma=null;else if(!this.wma||this.wma[0]!=
Md.id.toString()){const bg=this.FYa.ZMm(Md)?null:null===(We=this.Bxb.QGb(Md))||void 0===We?void 0:We.jQc(Md);this.wma=[Md.id.toString(),bg]}this.iTe&&this.FYa.zTn(Re.yl.lb)}};this.Ca=la;this.FYa=bb;this.Ib=qb;this.qEc=ac;this.gXj=this.Ca.$("AugLoopOperationsAreEnabled");this.izb=new fa.a(Xa.a.ih());this.Je=yc;this.ti=$c;this.Bxb=Vd;this.hb=me;this.Chd=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.Xw(this.Uqa);sb.a.ll().then(()=>{this._augLoopRuntimeManager=
$b.a.getAugLoopRuntimeManager();y.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ca.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Zb.a,{handler:Md=>{this.Je.mDk(Md)}}));this.gXj&&this.FYa.gDo();this.ZDo()}).catch(()=>{});this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.nSg=5E3)}w6n(){const la=this.Je.Ztc.entries();
for(let bb=0;bb<this.Je.Ztc.size;bb++){const qb=la.next();y.AFrameworkApplication.se("gi204158;ef1e2812");Date.now()-qb.value[1].time>=this.nSg&&this.Je.VSc(qb.value[1].annotation,!0,Na.a.getTypeName(),!1)}}Sto(la){return 3===la.E1c||sb.a.Trj(la.graphNode)}ZDo(){!this.$ld&&this.FYa.w9&&(this.$ld=new ea.a(4,2,this.Ca.nc("NodeEventsFiringInterval",500),this.ZFl,131),this.Ib.Wb(this.$ld))}Kjj(la,bb){var qb,ac=[];const yc=ic.GraphIterator.eb(la),$c=yc.Wp();for(var Vd=0;Vd<$c;Vd++){let me=yc.qF(Vd);11===
me.type&&(me=Jd.OutlineElementNavigator.Ee(yc));const Md=me.id.toString(),Re=null===(qb=this.Bxb.QGb(me))||void 0===qb?void 0:qb.aDb(me);ac.push(Object.assign(new ad.a,{body:Re,id:Md,revId:sb.a.fwf(me)}));yc.jd(la.type)}bb.push(la.id.toString());qb=[];qb.push(Object.assign(new Na.a,{parentPath:bb.slice(),items:ac,prevId:null}));for(ac=0;ac<$c;ac++)Vd=yc.qF(ac),11===Vd.type&&(Vd=Jd.OutlineElementNavigator.Ee(yc)),0<yc.Wp()&&(qb=qb.concat(this.Kjj(Vd,bb))),yc.jd(la.type);bb.pop();return qb}AQa(la){return la.split("\\").slice(0,
-1)}Xdi(la,bb,qb,ac=-1,yc=!0){var $c;let Vd=null,me=null;const Md=la.id.toString();var Re=null;3!==qb&&(Re=sb.a.PPk(la));if(Re)for(let We=0;We<Re.length;We++)if(Re[We]===Md){me=We+1<Re.length?Re[We+1]:null;Vd=We?Re[We-1]:null;break}Md!==Vd&&Md!==me||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",qb,Md,Vd,me,la.type);Re=null===($c=this.Bxb.QGb(la))||void 0===$c?void 0:$c.aDb(la,ac,yc);
ac=[Object.assign(new ad.a,{body:Re,id:Md,revId:sb.a.fwf(la)})];switch(qb){case 0:case 1:return Object.assign(new Na.a,{parentPath:this.AQa(bb),items:ac,prevId:Vd,nextId:me});case 4:return Object.assign(new nf,{parentPath:this.AQa(sb.a.DJ(la)),prevParentPath:this.AQa(bb),items:ac,prevId:Vd,nextId:me});case 5:return qb=this.FYa.sOl(Md),Object.assign(new nf,{parentPath:this.AQa(null!==qb&&void 0!==qb?qb:sb.a.DJ(la)),prevParentPath:this.AQa(bb),items:ac,prevId:Vd,nextId:me});case 2:return Object.assign(new za.a,
{parentPath:this.AQa(bb),items:ac});case 3:return Object.assign(new Aa.a,{parentPath:this.AQa(bb),items:ac});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",qb,Md),Object.assign(new Oe.a,{parentPath:this.AQa(bb),items:ac,prevId:Vd,nextId:me})}}jjm(la){return this.wma&&this.wma[0]===la?this.wma[1]:null}Mfo(la){var bb;if(!this.Chd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!sb.a.Trj(la))return!1;
const qb=la.id.toString();var ac=this.izb.contains(qb)?2:0;ac=this.Xdi(la,sb.a.DJ(la),ac);this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,{operation:ac}));this.izb.add(qb);this.wma=[qb,null===(bb=this.Bxb.QGb(la))||void 0===bb?void 0:bb.jQc(la)];return!0}yeo(la,bb){var qb;if(this.Chd){var ac=la.id.toString(),yc=this.AQa(sb.a.DJ(la));bb=[Object.assign(new ne,{id:ac,revId:sb.a.fwf(la),parentPath:yc,delta:bb})];yc=Object.assign(new Yc,{parentPath:yc,items:bb});this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,
{operation:yc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",ac);this.wma=[ac,null===(qb=this.Bxb.QGb(la))||void 0===qb?void 0:qb.jQc(la)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}LHk(la,bb){if(la.tileReference.referencedPath.length!==bb.tileReference.referencedPath.length||la.range.start!==bb.range.start||la.range.length!==bb.range.length)return!1;for(let qb=0;qb<la.tileReference.referencedPath.length;qb++)if(la.tileReference.referencedPath[qb]!==
bb.tileReference.referencedPath[qb])return!1;return!0}GHk(la,bb){if(la.selectedRanges.length!==bb.selectedRanges.length||la.content!==bb.content)return!1;for(let qb=0;qb<la.selectedRanges.length;qb++)if(!this.LHk(la.selectedRanges[qb],bb.selectedRanges[qb]))return!1;return!0}Qdj(la){var bb;if(la){var qb=new ob.a,ac="";for(let Vd=0;Vd<la.length;Vd++){var yc=la.J(Vd),$c=(null===(bb=this.Bxb.QGb(yc.node))||void 0===bb?void 0:bb.aDb(yc.node)).content;ac+=$c;$c=yc.cpBegin<$c.length?yc.cpBegin:-1;$c=Object.assign(new wa.a,
{start:$c,length:yc.cpEnd-yc.cpBegin});const me=yc.node.id.toString();yc=this.AQa(sb.a.DJ(yc.node));yc.push(me);qb.add(Object.assign(new Db,{range:$c,tileReference:Object.assign(new yd,{referencedPath:yc})}))}la=Object.assign(new Rg,{selectedRanges:qb.toArray(),content:ac});this.mJe&&this.GHk(la,this.mJe)||(bb=this.Zwd?this.Zwd:ua.a.create().toString(),qb=[Object.assign(new ad.a,{body:la,id:bb})],this.Zwd?bb=Object.assign(new za.a,{parentPath:["session","doc"],items:qb}):(this.Zwd=bb,bb=Object.assign(new Na.a,
{parentPath:["session","doc"],items:qb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new xc.a,{operation:bb})),this.mJe=la)}}xoo(la){(this.iTe=la)?this.Adj():this.FYa.FZk()}Adj(){this.Qdj(this.hb.ib.lb)}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(e.a)(De,"TileView",null,[637]);var qf=c(42),tg=c(53);class Ah{constructor(la){tg.a.assign(Ah,this,la)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(la){return tg.a.matchesTypesFor(la,
[Ah.getTypeName()])}}Ah.H_={T_:Ah.getTypeName(),B_:Ah.getBaseTypes()};class ji{constructor(la){tg.a.assign(ji,this,la)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(la){return tg.a.matchesTypesFor(la,[ji.getTypeName()])}}ji.H_={T_:ji.getTypeName(),B_:ji.getBaseTypes()};class Bh{constructor(la){tg.a.assign(Bh,this,la)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(la){return tg.a.matchesTypesFor(la,
[Bh.getTypeName()])}}Bh.H_={T_:Bh.getTypeName(),B_:Bh.getBaseTypes()};class Tj{constructor(la){tg.a.assign(Tj,this,la)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(la){return tg.a.matchesTypesFor(la,[Tj.getTypeName()])}}Tj.H_={T_:Tj.getTypeName(),B_:Tj.getBaseTypes()};class sf{constructor(la){tg.a.assign(sf,this,la)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(la){return tg.a.matchesTypesFor(la,[sf.getTypeName()])}}sf.H_={T_:sf.getTypeName(),B_:sf.getBaseTypes()};var vf;(function(la){la[la.Top=0]="Top";la[la.Center=1]="Center";la[la.Bottom=2]="Bottom"})(vf||(vf={}));var Sf;(function(la){la[la.none=0]="none";la[la.firstRow=32]="firstRow";la[la.lastRow=64]="lastRow";la[la.firstCol=128]="firstCol";la[la.lastCol=256]="lastCol";la[la.uop=512]="noHBand";la[la.Aop=1024]="noVBand";la[la.nwCell=160]="nwCell";la[la.neCell=
288]="neCell";la[la.swCell=192]="swCell";la[la.seCell=320]="seCell";la[la.ujl=1184]="defaultLook"})(Sf||(Sf={}));Object(e.b)("TableLookFlags",Sf);class ah{aDb(la){if(la)switch(la.type){case 14:return this.Nfl(la);case 15:return new Ah;case 16:return this.Mfl(la)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}Nfl(la){var bb=la.uG||[];let qb=0;for(let ac=0;ac<bb.length;ac++)qb+=bb[ac];bb=bb.map((ac,yc)=>({columnId:yc.toString(),widthPercent:0!=qb?100*ac/qb:0}));return new Tj({columnDefs:bb,
tableLook:la.properties.ja(sa.a.tableLook,Sf.ujl),complexTable:la.properties.ja(sa.a.complexTable,!1),floatingTable:la.properties.ja(sa.a.Fyi,!1)})}Mfl(la){return new ji({rowspan:la.properties.ja(sa.a.rowSpan,1),colspan:la.properties.ja(sa.a.colSpan,1),borderInfo:{topBorder:{color:la.properties.ja(sa.a.WRb,0),size:la.properties.ja(sa.a.jnc,4),style:la.properties.ja(sa.a.mrb,"single")},leftBorder:{color:la.properties.ja(sa.a.URb,0),size:la.properties.ja(sa.a.hnc,4),style:la.properties.ja(sa.a.krb,
"single")},rightBorder:{color:la.properties.ja(sa.a.VRb,0),size:la.properties.ja(sa.a.inc,4),style:la.properties.ja(sa.a.lrb,"single")},bottomBorder:{color:la.properties.ja(sa.a.TRb,0),size:la.properties.ja(sa.a.gnc,4),style:la.properties.ja(sa.a.jrb,"single")}},verticalAlignment:la.properties.ja(sa.a.wJa,vf.Top),ghostCell:la.properties.ja(sa.a.ghostCell,!1),renderCell:la.properties.ja(sa.a.renderCell,!1),skippedCell:la.properties.ja(sa.a.skippedCell,!1),fillColor:la.properties.ja(pd.a.WK,0),verticalMerge:la.properties.ja(qf.a.vMerge,
null)})}jQc(la){return null===la||void 0===la?void 0:la.properties}}Object(e.a)(ah,"TableElementNodeToTileConverter",null,[636]);class mg{constructor(la,bb,qb){this.rm=bb;this.$za=qb;this.HNd=!1;this.Muc=null;this.mZi=(ac,yc)=>{this.dza(yc.node,0)};this.iZi=(ac,yc)=>{ac=yc.node;this.$za.SPb(ac.id.toString(),sb.a.DJ(ac))};this.nZi=(ac,yc)=>{this.dza(yc.node,3)};this.c9d=(ac,yc)=>{this.dza(yc.node,2)};this.pZi=(ac,yc)=>{this.dza(yc.node,0)};this.qZi=(ac,yc)=>{this.dza(yc.node,3)};this.oZi=(ac,yc)=>
{ac=yc.node;this.$za.SPb(ac.id.toString(),sb.a.DJ(ac))};this.d9d=(ac,yc)=>{this.dza(yc.node,2)};this.kZi=(ac,yc)=>{this.dza(yc.node,0)};this.jZi=(ac,yc)=>{ac=yc.node;this.$za.SPb(ac.id.toString(),sb.a.DJ(ac))};this.lZi=(ac,yc)=>{this.dza(yc.node,3)};this.a9d=(ac,yc)=>{var $c;ac=yc.node;if(yc.property===sa.a.ghostCell){if(yc=ac.hg?ac:null===($c=ac.kya)||void 0===$c?void 0:$c.BM){$c=ic.GraphIterator.eb(yc);var Vd=$c.Wp();for(var me=0;me<Vd;me++){$c.qF(me);var Md=Jd.OutlineElementNavigator.Ee($c);this.$za.SPb(Md.id.toString(),
String.format("{0}\\{1}",sb.a.DJ(yc),Md.id));this.dza(Md,4);$c.jd(16)}}}else if(yc.property===pd.a.gf){yc=ic.GraphIterator.eb(ac);$c=yc.Wp();let Re=null;Vd=[];for(me=0;me<$c;me++){yc.qF(me);Md=Jd.OutlineElementNavigator.Ee(yc);this.$za.lbo(Md.id.toString(),String.format("{0}\\{1}",sb.a.DJ(ac),Md.id));if(14!==Md.type){if(Re=sb.a.DJ(Md))this.$za.SPb(Md.id.toString(),Re),this.dza(Md,5)}else Vd.push(Md);yc.jd(16)}Re&&Vd.forEach(We=>{this.$za.SPb(We.id.toString(),String.format("{0}\\{1}",Re.split("\\").slice(0,
-1).join("\\"),We.id));this.dza(We,5)})}this.dza(ac,2)};this.jUf=()=>{this.T$c()?this.ZJ():this.HNd&&!this.$za.w9&&this.pAa()};this.VUb=la.$("AugLoopOperationsAreEnabled")}get O2c(){return this.Muc}init(){this.T$c()&&this.ZJ();this.$za.Uqh(this.jUf)}ZJ(){const {Dyj:la,Gle:bb,syj:qb}=this.O9h();if(la&&bb&&qb){this.HNd=!0;var ac=this.iZi,yc=this.nZi,$c=this.c9d;la.ku(this.mZi);la.pO(ac);la.kw(yc);la.qo($c);ac=this.oZi;yc=this.qZi;$c=this.d9d;bb.ku(this.pZi);bb.pO(ac);bb.kw(yc);bb.qo($c);ac=this.jZi;
yc=this.lZi;$c=this.a9d;qb.ku(this.kZi);qb.pO(ac);qb.kw(yc);qb.qo($c)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}pAa(){const {Dyj:la,Gle:bb,syj:qb}=this.O9h();if(la&&bb&&qb){this.HNd=!1;var ac=this.iZi,yc=this.nZi,$c=this.c9d;la.xV(this.mZi);la.w$(ac);la.bea(yc);la.UP($c);ac=this.oZi;yc=this.qZi;$c=this.d9d;bb.xV(this.pZi);bb.w$(ac);bb.bea(yc);bb.UP($c);ac=this.jZi;yc=this.lZi;$c=this.a9d;qb.xV(this.kZi);qb.w$(ac);qb.bea(yc);qb.UP($c)}else a.ULS.sendTraceTag(524149330,
389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}dza(la,bb){la&&this.q8a(la)&&this.$za.w9&&this.VUb&&this.$za.mde(la,bb)}O9h(){return{Dyj:this.rm.Te(14),Gle:this.rm.Te(15),syj:this.rm.Te(16)}}q8a(la){const bb=db.StaticActiveAppFrame.za().jb.rc;return!!bb&&bb.ov&&!!bb.ed&&!!bb.ed.Mc&&!!la&&!!la.Mc&&la.Mc.id===bb.ed.Mc.id}T$c(){return!this.HNd&&!!this.$za.w9}}Object(e.a)(mg,"TableNodeEventHandler",null,[635]);class Bg{constructor(la,bb){this.Y0i=la;this.dIo=bb}QGb(la){return la?
14===la.type||15===la.type||16===la.type?this.dIo:12===la.type?this.Y0i:null:null}}Object(e.a)(Bg,"NodeToTileConverterHolder",null,[631]);var Cg=c(373);class ki{get name(){return"Box4.AugmentationLoop"}wc(la){this.W=la;const bb=this.W.resolve("Common.IAppSettingsManager"),qb=bb.$("AugLoopTaskUseTimeBasedYieldStrategy"),ac=new of,yc=qb?new aa.a(bb.nc("AugLoopTaskAllowedRunTimeBeforeYielding",10),I.a.$e):new Y(bb.nc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia("Common.ICpuMeter",()=>S.a.instance).ha();
this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new ab).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.W.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new lg(bb,T.App.li.Al.Te(12),ac,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.lc,
this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();sb.a.Die()&&this.W.ia("Box4.AugmentationLoop.TableNodeEventHandler",()=>new mg(bb,T.App.li.Al,ac)).ha();this.W.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new O).ha();this.W.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new kd(this.W.resolve("Common.IAppSettingsManager"),
this.W.Oa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).ha();this.W.ia("Box4.AugmentationLoop.IAnnotationPolicies",()=>new oa.a(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.W.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new hc(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),
this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),la.resolve("Box4.IFeatureHelper"))).ha();const $c=this.W.resolve("IRoamingDictionary");this.W.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new $a(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),y.AFrameworkApplication.lc,
this.W.Oa("Box4.IIntelligenceReader"),this.W.Oa("Box4.IIntelligenceEditor"),this.W.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),la.resolve("Box4.IFeatureHelper"),Cg.a.instance,()=>{try{return $b.a.getAugLoopRuntimeManager()}catch(Vd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Vd),null}},$c)).ha();this.W.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",
()=>new Bg(new xh.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new ah)).ha();this.W.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new De(bb,ac,y.AFrameworkApplication.lc,yc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");
this.W.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new vc).ha();this.W.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new Ab).ha()}init(){if(y.AFrameworkApplication.oG.BootFailed)a.ULS.sendTraceTag(512624089,389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const la=new tb(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.He,
T.App.h6,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),U.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),bb=new ba;this.W.register(623,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().g2o(()=>bb);y.AFrameworkApplication.se("b8afb343;bjdjj400");y.AFrameworkApplication.se("72af9564;82jf1647");const qb=sb.a.I2m(this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.resolve("Common.App.OAuth.IOAuthManager"),la,this.W.resolve("Common.ISharedDependencyLoader"),
bb);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Xb(qb)).ha();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();sb.a.Die()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(la){z.a.instance.Gc(new ki,0,la);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}
Object(e.a)(ki,"Box4AugmentationLoopPackage",null,[1,2]);var Rh=c(613),ml=c(44),el=c(11),Kl=c(410),ig=c(1160);class Mi{constructor(la,bb,qb,ac=null,yc=null,$c=null){this.CM=new ig.a(bb,ac,yc,$c);this.Lb=la;this.Qc=qb}get type(){return this.CM.type}get id(){return this.CM.id}get intent(){return this.CM.intent}wf(la){return new Mi(la,this.type,this.Qc,this.id,this.intent,this.CM.xya)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.CM,this.Qc)}}Object(e.a)(Mi,"IntentObject",null,[134]);
var fh=c(480),zf=c(153),Eh=c(251);class tl{constructor(){this.Bvc=new zf.a}bCd(la,bb,qb,ac,yc=null,$c=null,Vd=null){la=la.WX(bb,la.ra.DPo(bb));la.Qj||(la.Qj=new fh.a(la));la.Qj.add(new Mi(la,qb,ac,yc,$c,Vd));la.B4a=!0}Laj(la){return la.Lb&&la.Lb.Qj&&la.Lb.Qj.h7c(bb=>bb===la,[la.type])?!0:!1}Maj(la,bb){if(la.type===bb.type&&la.Qc&&!bb.Qc&&la.Lb&&la.Lb.Qj&&la.Lb.Qj.contains(la)&&bb.Lb&&bb.Lb.Qj&&bb.Lb.Qj.contains(bb)){var qb=[la.type];la.Lb.Qj.h7c(ac=>ac===la,qb);bb.Lb.Qj.h7c(ac=>ac===bb,qb)}}$2o(la,
bb,qb){if(!bb)return!1;qb=new Ia.a([qb]);for(let ac=0;ac<la.length;ac++){const yc=la.J(ac);if(!yc.Qj)continue;let $c=!0;qb.UVa(yc.Qj,void 0,Vd=>{Vd.id&&bb.equals(Vd.id)&&($c=!1)});if(!$c)return!1}return!0}cHn(la,bb,qb,ac){let yc=null,$c=null;bb=new Ia.a([bb]);const Vd=la.ra;for(let me=0;me<Vd.length;me++){const Md=Vd.J(me);if(!Md.Qj)continue;let Re=!0;bb.UVa(Md.Qj,void 0,(We,bg)=>{if(bg){var yf=bg.Lb.cp<qb,Rf=We.Lb.cp>ac;yf&&We.Lb.cp<=qb||bg.Lb.cp>=ac&&Rf||(yf&&Rf?Re=!1:yf?yc=We:Rf?$c=bg:this.Maj(bg,
We))}});if(!Re)return!1}if(yc){if(!this.Laj(yc))return!1;this.bCd(la,qb,yc.type,yc.Qc,yc.id,yc.intent,yc.CM.xya)}if($c){if(!this.Laj($c))return!1;this.bCd(la,ac,$c.type,$c.Qc,$c.id,$c.intent,$c.CM.xya)}return!0}Cgg(la){let bb;return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:bb}=this.Bvc.Fc(la.type,bb)).returnValue?bb.Cgg(la):!0}Man(la,bb){if(this.Cgg(bb)){var qb=bb.id,ac=bb.type,yc=bb.Bc,$c=bb.end;if(({cpEnd:$c}=tl.gKj(la,yc,$c)).returnValue){if(Kl.a(ac)){if(!this.$2o(la.ra,
qb,ac))return}else if(!this.cHn(la,ac,yc,$c))return;this.bCd(la,yc,ac,!0,qb,bb.intent,bb.CM.xya);this.bCd(la,$c,ac,!1,qb,bb.intent,bb.CM.xya)}}}d4c(la,bb){db.StaticActiveAppFrame.za().Rif(la,()=>{const qb=new ml.GraphTransaction(2);try{qb.Db(la);const ac=la.uZ();try{const yc=la.f0();try{bb()}finally{yc&&yc.dispose()}}finally{ac&&ac.dispose()}}finally{qb&&qb.dispose()}})}nHa(la,bb){this.d4c(la,()=>{this.Man(la,bb)})}Oan(la,bb){if(bb.count){var qb=new Wa.a,ac=new Eh.a;for(var yc of bb){var $c=yc.value;
Kl.a(yc.key)||$c.Sc((me,Md)=>me.Bc!==Md.Bc?me.Bc-Md.Bc:me.end-Md.end);if(tl.e3o($c))for(var Vd of $c)$c=Vd.end,({cpEnd:$c}=tl.gKj(la,Vd.Bc,$c)).returnValue&&($c=$c!==Vd.end?new Lb.a(Vd.type,Vd.Bc,$c,Vd.id,Vd.intent,Vd.CM.xya):Vd,qb.add($c.Bc),qb.add($c.end),tl.Ltk(ac,$c))}la.eNd(qb);la=la.ra;for(qb=0;qb<la.length;qb++){yc=la.J(qb);if(Vd=yc.Qj)for(const Md of bb.keys)Vd.Gbj(Md);let me;({value:me}=ac.Fc(yc.cp,me)).returnValue||(me=null);if(me){Vd||(Vd=yc.Qj=new fh.a(yc));for(const Md of me)Vd.add(Md.wf(yc))}yc.B4a=
!0}}}oPf(la,bb){const qb=new zf.a;for(const ac of bb){let yc;({value:yc}=qb.Fc(ac.type,yc)).returnValue||(yc=new ob.a,qb.Z(ac.type,yc));yc.add(ac)}this.d4c(la,()=>{this.Oan(la,qb)})}USo(la,bb,qb){la=la.ra;const ac=new Ia.a([8]);bb===qb&&(qb+=1);for(let yc=0;yc<la.length;yc++){const $c=la.J(yc);$c.Qj&&ac.UVa($c.Qj,void 0,(Vd,me)=>{me&&Math.max(me.Lb.cp,bb)<Math.min(Vd.Lb.cp,qb)&&this.Maj(me,Vd)})}}Zog(la,bb,qb){this.d4c(la,()=>{this.USo(la,bb,qb)})}WSo(la,bb){la=la.ra;for(let qb=0;qb<la.length;qb++){const ac=
la.J(qb);ac.Qj&&ac.Qj.Gbj(bb)}}LVa(la,bb){this.d4c(la,()=>{this.WSo(la,bb)})}VSo(la,bb,qb){let ac=!1;bb=bb.ra;qb=[qb];for(let yc=0;yc<bb.length;yc++){const $c=bb.J(yc);$c.Qj&&(ac=$c.Qj.h7c(la,qb)||ac)}return ac}Bdd(la,bb,qb){let ac=!1;this.d4c(bb,()=>{ac=this.VSo(la,bb,qb)});return ac}j$b(la,bb,qb,ac){return!la||0>qb||ac>la.characterData.length||qb>ac?new ob.a:this.wQa(la,bb,yc=>Math.max(yc.Bc,qb)<=Math.min(yc.end,ac))}wQa(la,bb,qb){return tl.e2l(la,bb,qb)}static e2l(la,bb,qb){const ac=new ob.a;la=
la.ra;bb=new Ia.a([bb]);if(!la)return ac;for(let yc=0;yc<la.length;yc++){const $c=la.J(yc);$c.Qj&&bb.UVa($c.Qj,void 0,(Vd,me)=>{me&&(Vd=new Lb.a(me.type,me.Lb.cp,Vd.Lb.cp,me.id,me.intent,me.CM.xya),qb(Vd)&&ac.add(Vd))})}return ac}jRc(la,bb){const qb=new ob.a;if(!tl.NXm(la.contextId))return qb;let ac;const yc=la.node;la.contextId!==el.a.paragraph?(ac=la.cpBegin,la=la.cpEnd):(ac=0,la=yc.characterData.length);qb.addRange(this.j$b(yc,bb,ac,la));return qb}oXn(la){this.Bvc.nb(0)||this.Bvc.Z(0,la)}static gKj(la,
bb,qb){la=eb.ParagraphReader.textLength(la);if(bb>=la)return{returnValue:!1,cpEnd:qb};qb>la&&(qb=la);return{returnValue:!0,cpEnd:qb}}static e3o(la){if(!la.count)return!0;const bb=new Rh.a,qb=la.J(0).type,ac=Kl.a(qb);let yc=-1;for(const $c of la){if($c.type!==qb||(Kl.c($c.type)?$c.Bc>$c.end:$c.Bc>=$c.end))return!1;if(ac){la=$c.id;if(!la||la.equals(ua.a.nil)||bb.contains(la))return!1;bb.add(la)}else if(-1===yc)yc=$c.end;else if(yc>$c.Bc)return!1}return!0}static Ltk(la,bb){let qb;({value:qb}=la.Fc(bb.Bc,
qb)).returnValue||(qb=new ob.a,la.Z(bb.Bc,qb));qb.add(new Mi(null,bb.type,!0,bb.id,bb.intent,bb.CM.xya));({value:qb}=la.Fc(bb.end,qb)).returnValue||(qb=new ob.a,la.Z(bb.end,qb));qb.add(new Mi(null,bb.type,!1,bb.id,bb.intent,bb.CM.xya))}static NXm(la){return la===el.a.Fd||la===el.a.Tc||la===el.a.paragraph}}Object(e.a)(tl,"IntentRangeEditor",null,[630]);class Nh{constructor(){this.W=null}get name(){return"Box4.Intent"}wc(la){this.W=la;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new tl).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(la){z.a.instance.Gc(new Nh,
0,la);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(e.a)(Nh,"PackageManager",null,[1,2]);var Uh=c(1047),ok=c(111),pj=c(1431);class Ek{constructor(la){this.$9m=la;this.W9m=[]}get handler(){return this.$9m}get qoa(){return this.W9m}}Object(e.a)(Ek,"RegisteredListener",null,[]);class cj{constructor(la,bb){this.type=0;this.payload=null;this.type=la;this.payload=bb}}Object(e.a)(cj,"OfficeSharedCommentsEvent",null,[1069]);class Fi{constructor(){this.eventType=0;this.newViewContainer=
null;this.viewContainerVisibilityState=1}}Object(e.a)(Fi,"ViewContainerEvent",null,[1069]);var Yh=c(587);class rj{constructor(la){this.IOf=!1;this.lqa=new ob.a;this.q4d=la}LWn(la){la=new Ek(la);this.lqa.add(la)}CEj(la){for(let bb=0;bb<this.lqa.count;++bb)if(this.lqa.J(bb).handler===la){this.lqa.removeAt(bb);break}}qUa(la=!1){const bb=()=>{if(y.AFrameworkApplication.Qk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let yc=0;yc<this.lqa.count;++yc){const $c=
this.lqa.J(yc);for(;0<$c.qoa.length;){var qb=Array.dequeue($c.qoa);if(Object(ok.a)(Fi,qb)){var ac=$c.handler;ac(qb)}else Object(ok.a)(cj,qb)&&(ac=$c.handler,ac(qb.type,qb.payload))}}};la?bb():this.IOf||(this.IOf=!0,Yh.a.T3(this.q4d,()=>{bb();this.IOf=!1},pj.a.HHl))}}Object(e.a)(rj,"GenericEventHost",null,[]);class Pm{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=
this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(Pm,"BasicEventPayload",null,[1115]);class Fk{constructor(la){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=la}}Object(e.a)(Fk,"CommentContextDetails",null,[]);class Ll{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=
0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(Ll,"ContextChangeWithSelectedThreadIndex",null,[1115]);class rh{constructor(){this.tasks=this.comments=null}}Object(e.a)(rh,"LoadCommentsNoVirtualization",null,[1115]);class qp extends rj{constructor(la){super(la);this.Aeh=0}Jno(){this.Aeh=1656}vXn(la,bb,qb,ac,yc,$c){la=new Ek(la);$c&&Array.enqueue(la.qoa,this.q$k($c,this.Aeh));$c=bb?bb.length:0;Array.enqueue(la.qoa,this.YLh($c,qb,ac,0));$c&&Array.enqueue(la.qoa,this.ZMh(bb,
yc));this.lqa.add(la);this.qUa()}OSb(la){this.CEj(la)}seo(la,bb,qb,ac=0){this.KIb(this.YLh(la,bb,qb,ac));this.qUa()}teo(la,bb,qb){this.KIb(this.Q$k(la,bb,qb));this.qUa()}Teo(la,bb){this.KIb(this.ZMh(la,bb));this.qUa()}selectComment(la){this.KIb(this.aOh(la,6));this.qUa()}highlightComment(la){this.KIb(this.aOh(la,7));this.qUa()}jqg(la,bb){this.KIb(this.hdl(la,bb));this.qUa()}c2f(la,bb){this.KIb(this.ofl(la,bb));this.qUa()}q$k(la,bb=0){const qb=new Pm;qb.modelCapabilityFlags=la;qb.richTextCapabilityFlags=
bb;return new cj(12,qb)}YLh(la,bb,qb,ac){const yc=new Pm;yc.numberOfComments=la;yc.numberOfThreads=bb;yc.contextDetails=Object.assign(new Fk(qb),{nextPopulatedContextDetails:ac});yc.contextDrafts=null;yc.rehydrationDrafts=null;return new cj(0,yc)}Q$k(la,bb,qb){const ac=new Pm;ac.comments=la;ac.numberOfThreads=bb;ac.tasks=qb;return new cj(2,ac)}ZMh(la,bb){const qb=new rh;qb.comments=la;qb.tasks=bb;return new cj(1,qb)}aOh(la,bb){const qb=new Pm;qb.commentId="";la&&(qb.commentId=la);return new cj(bb,
qb)}hdl(la,bb){const qb=new Pm;qb.changes=[];qb.contextDetails=Object.assign(new Fk(bb),{nextPopulatedContextDetails:la});return new cj(10,qb)}ofl(la,bb){const qb=new Pm;qb.commentId=la;qb.smartReplies=bb;return new cj(15,qb)}KIb(la){for(let bb=0;bb<this.lqa.count;++bb)Array.enqueue(this.lqa.J(bb).qoa,la)}}Object(e.a)(qp,"OfficeSharedCommentsEventHost",rj,[1098]);var Hi=c(232),Gk=c(179),Xn=c(276);class jk{constructor(){this.SSe=this.nLg=!1;this.YI=this.Jp=this.I_g=this.$5g=this.JAd=this.f_b=this.ijh=
this.XPg=this.dA=this.qDc=null}initialize(la,bb,qb,ac=null,yc=null,$c=null,Vd=null,me=null,Md=null,Re=null){this.dA=la;this.XPg=bb;this.ijh=qb;this.f_b=ac;this.JAd=yc;this.$5g=$c;this.I_g=Vd;this.Jp=me;this.nLg=!0;this.YI=Md;this.qDc=Re}BYd(la=null,bb=null){if(!this.nLg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((qb,ac)=>{ac(Yh.a.QD(-2130915313))});if(this.SSe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.qDc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.qDc=appResourceLoader.loadChunk("sharedComments"):this.qDc=this.dA.loadScript("sharedComments"));return this.qDc.then(()=>{la&&la();this.SSe||(this.YI&&this.YI.execute(qb=>{qb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),bb&&bb(),sharedComments.instantiate(this.XPg,this.ijh,this.f_b,this.JAd,this.$5g,this.I_g,this.Jp));this.SSe=!0})}}Object(e.a)(jk,
"CommentActivationManager",null,[1139]);class Hd extends rj{constructor(la){super(la)}lZn(la){this.LWn(la)}RTo(la){this.CEj(la)}Toj(la){la=this.M$k(la);for(let bb=0;bb<this.lqa.count;++bb)Array.enqueue(this.lqa.J(bb).qoa,la);this.qUa(!0)}M$k(la){const bb=new Fi;bb.eventType=3;bb.viewContainerVisibilityState=la;return bb}fIl(){const la=this.wgl();for(let bb=0;bb<this.lqa.count;++bb)Array.enqueue(this.lqa.J(bb).qoa,la);this.qUa(!0)}wgl(){const la=new Fi;la.eventType=2;return la}}Object(e.a)(Hd,"ViewContainerEventHost",
rj,[1057]);var Ie=c(55);class Ok{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(Ok,"CommentUIActionPayload",null,[]);var Jj=c(308);class ee{constructor(la,bb){this.ga=la;this.Rsb=bb;this.Nqc=new Jj.a;for(let qb of this.Rsb)this.Nqc.Z(qb.value.canvasActionId,qb.key),la=qb.value,la.delayActionsUntilRegistration||this.qa(la)}qa(la){la.withFlags?this.ga.fb(la.canvasActionId,la.canvasContextId,Object(Ie.a)(this,this.Lnh,"actionHandler"),97):this.ga.qa(la.canvasActionId,la.canvasContextId,
Object(Ie.a)(this,this.Lnh,"actionHandler"))}PTa(la,bb){this.Rsb.nb(la)&&(this.Rsb.J(la).delayActionsUntilRegistration&&this.qa(this.Rsb.J(la)),this.Rsb.J(la).registeredCallback=bb)}Lnh(la,bb,qb,ac,yc){if(this.Nqc.nb(la)){var $c=this.Nqc.J(la);if(!this.Rsb.nb($c))return 8;const Vd=this.Rsb.J($c);if(Vd.preCallback){const me=Vd.preCallback(la,bb,qb,ac,yc);if(2!==me)return me}if(!Vd.registeredCallback)return 1===qb?8:2;$c=Object.assign(new Ok,{actionType:$c});1===qb&&($c.actionBehavior=1);$c=Vd.registeredCallback($c);
return Vd.postCallback?Vd.postCallback($c,la,bb,qb,ac,yc):$c?32:8}return 2}}Object(e.a)(ee,"OfficeSharedCommentsActionHost",null,[1100]);var md=c(1844),nl=c(67),gf=c(134),yh=c(1487),Ef=c(12),vi=c(29),Ml=c(551),kk=c(1165),am=c(125),Wh=c(310),Wg=c(49),jg=c(21),Lh=c(1065),je=c(1058),oh=c(1599),Rd=c(177),Ii=c(10),Lf=c(38),ag=c(710),xn=c(474),Zj=c(14),dk=c(2068);class Qe{constructor(la){this.yW=la;this.sic=new Q.a;this.I3a=new Q.a;this.PBm();this.yvm=[new dk.a(Lf.a.lHh,Lf.a.r2k),new dk.a(Lf.a.EHd,Lf.a.q2k),
new dk.a(Lf.a.cHh,Lf.a.d2k),new dk.a(Lf.a.wHd,Lf.a.c2k),new dk.a(Lf.a.mHh,Lf.a.t2k),new dk.a(Lf.a.FHd,Lf.a.s2k)]}UTa(la){this.yW.UTa(la);this.v_n(la)}gHf(la,bb){return!!la&&!!la.objectId&&bb.contains(ua.a.If(la.objectId))}aSa(la){la=Object(rc.a)(776,la);return!!la&&!!la.objectId}v_n(la){for(const bb of this.yvm)la.classList.remove(bb.className,bb.RSc);la.classList.remove(Lf.a.B1f,Lf.a.HHd,Lf.a.dHh,Lf.a.GHd,Qe.xug)}PBm(){const la=new Q.a,bb=new Q.a;la.add(0,null);la.add(1,Lf.a.EHd);la.add(2,Lf.a.lHh);
la.add(3,Lf.a.HHd);bb.add(0,null);bb.add(1,Lf.a.wHd);bb.add(2,Lf.a.cHh);bb.add(3,Lf.a.dHh);this.I3a.Z(1,la);this.I3a.Z(2,bb);this.I3a.Z(3,bb);this.sic.add(0,null);this.sic.add(1,Lf.a.FHd);this.sic.add(2,Lf.a.mHh);this.sic.add(3,Lf.a.GHd)}}Qe.xug="CommentImportant";Object(e.a)(Qe,"CommentHighlightUtils",null,[]);class pk{constructor(){this.JMd=0;this.JCb=null}}Object(e.a)(pk,"CommentGuidsInElementInfo",null,[]);class io{constructor(){this.Rni=!1;this.Cna=this.bNb=null;this.vTa=this.hIb=0}}Object(e.a)(io,
"HighlightInfoForElement",null,[]);class Oh{constructor(){this.wri=this.yri=this.xri=-1;this.ppi=[];this.f5b=[];this.RUc=this.SUc=-1;this.xwi=!1}}Object(e.a)(Oh,"HighlightInfoForElementsInPara",null,[]);class Zg{constructor(){this.Wog=this.WXf=null}}Object(e.a)(Zg,"OnAnchorMouseOutData",null,[]);var yg=c(1527);class Nn{constructor(la,bb,qb,ac,yc,$c,Vd,me){this.Wwe=la;this.paa=bb;this.sk=qb;this.U2=ac;this.ga=yc;this.Ib=$c;this.hj=Vd;this.KYa=this.gj=null;this.jnn=Md=>{if(!this.gj||this.U2.M_d)return!0;
if(Md=Md.Vo){if(this.gj.Tz&&Md[0].toString()===this.gj.Tz.objectId)return!0;this.KYa&&Md[0].equals(this.KYa.Wog[0])?this.Ib.ff(this.KYa.WXf):(this.KYa&&(this.Ib.ff(this.KYa.WXf),this.ga.Qb(Ef.a.IHd,2,this.KYa.Wog)),this.gj.Fo.ywi(Md[0])&&!this.hj.Am||this.ga.Qb(Ef.a.I9e,2,Md));this.KYa=null}return!0};this.inn=Md=>{if(this.U2.M_d)return!0;const Re=Md.Vo;Re&&(Md=new ea.a(2,1,0,()=>{this.ga.Qb(Ef.a.IHd,2,Re);this.KYa=null}),this.Ib.Wb(Md),this.KYa=Object.assign(new Zg,{WXf:Md,Wog:Re}));return!0};this.NUi=
Md=>{const Re=new ea.a(2,1,0,()=>{if(this.gj&&!this.gj.Fo.Tx){var We=Md.Vo;if(!We)We=db.StaticActiveAppFrame.za().Hp.currentScope,this.gj.Tz&&(!We||We.name!==Rd.AFrame.KM&&We.name!==Rd.AFrame.Sr)&&this.gj.clearSelection();else if(!this.gj.Tz||We.toString()!==this.gj.Tz.objectId)if(We=this.gj.Fo.m0(We.toString()))We=Object.assign(new yh.a,{commentId:We.id,mS:!1,E$:1}),this.ga.Qb(Zj.a.selectComment,2,We)}});this.Ib.Wb(Re);return!1};me.execute(Md=>{this.gj=Md})}szh(la,bb,qb,ac){const yc=new Oh,$c=[],
Vd=this.paa.aSa(bb)?bb.objectId:null;for(let Re=0,We=la.length;Re<We;Re++){var me=la[Re],Md=yg.g(me);const bg=yg.d(me);me=new Rh.a;const yf=new io;if(Md){const Rf=new xn.a(yg.c);Md=this.X_h(Md,Vd,Rf);0<Md.length&&(this.xXo(Md,qb,me,yf,Vd,ac),$c.push(Object.assign(new pk,{JMd:Re,JCb:Rf})))}bg&&(Md=this.X_h(bg,Vd),0<Md.length&&(this.zXo(Md,qb,me,yf,yc,Vd,ac,Re),this.NVo($c,Md,Re,yf)));0<qb.count&&this.AXo(bb,qb,yf,ac);this.LVo($c,yf);yc.ppi.push(yf)}return yc}Suh(la,bb,qb){let ac=!1;for(let yc=0,$c=
la.length;yc<$c;yc++){const Vd=la[yc],me=bb.ppi[yc],Md=ag.a(Vd);if(1!==Md&&2!==Md&&3!==Md)continue;const Re=3===Md||2===Md&&-1!==Vd.className.indexOf(Lf.a.aRa);this.paa.UTa(Vd);this.Juk(Vd,me,Re,ac);this.wtk(Vd,yc,Md,me,bb,qb);this.xtk(Vd,yc,bb,me);ac=Re}}X_h(la,bb,qb=null){const ac=[];for(let yc=0;yc<la.length;yc++)this.Wwe.qqj(la[yc],la[yc].toString()===bb)&&(ac.push(la[yc]),qb&&qb.add(la[yc]));return ac}xXo(la,bb,qb,ac,yc,$c){var Vd;let me=!1,Md=!1;for(const We of la){bb.add(We);qb.add(We);var Re=
We.toString();Re===yc?(Re=$c?1:2,ac.vTa=Re,ac.hIb=Re):this.gHf(this.gj.Tz,bb)&&(Re===(null===(Vd=this.gj.Tz)||void 0===Vd?void 0:Vd.objectId)&&(Md=!0),me=!0)}0<la.length&&!ac.vTa&&(ac.vTa=Md?1:3,ac.hIb=me?1:3)}zXo(la,bb,qb,ac,yc,$c,Vd,me){var Md,Re;const We=new xn.a(yg.c);Vd=Vd?1:2;let bg=!1;for(const yf of la){const Rf=yf.toString();bb.contains(yf)||(Rf===$c?yc.wri=me:(yc.xri=me,ac.vTa=3,(null===(Md=this.gj.Tz)||void 0===Md?void 0:Md.objectId)===Rf&&(yc.yri=me,ac.vTa=1)),We.add(yf));Rf===(null===
(Re=this.gj.Tz)||void 0===Re?void 0:Re.objectId)&&(bg=!0);bb.remove(yf);qb.contains(yf)&&this.yXo(ac,yf,Rf,$c,Vd);Rf===$c&&(ac.vTa=Vd)}0<la.length&&!ac.vTa&&(ac.vTa=bg?1:3);0<We.count&&yc.f5b.push(Object.assign(new pk,{JMd:me,JCb:We}))}NVo(la,bb,qb,ac){0!==la.length&&(bb.forEach(yc=>{for(let $c=la.length-1;0<=$c;$c--){const Vd=la[$c];if(Vd.JCb.contains(yc)){Vd.JMd===qb&&(ac.Cna?ac.Cna.push(yc):ac.Cna=[yc]);Vd.JCb.remove(yc);break}}}),la=la.filter(yc=>0<yc.JCb.count))}AXo(la,bb,qb,ac){var yc,$c;this.gHf(la,
bb)?qb.hIb=ac?1:2:qb.hIb||(qb.hIb=null!=(null===(yc=this.gj.Tz)||void 0===yc?void 0:yc.objectId)&&bb.contains(ua.a.If(null===($c=this.gj.Tz)||void 0===$c?void 0:$c.objectId))?1:3);qb.bNb||(qb.bNb=[]);for(const Vd of bb)qb.bNb.push(Vd)}LVo(la,bb){if(0<la.length){bb.Cna||(bb.Cna=[]);for(const qb of la[la.length-1].JCb)bb.Cna.push(qb)}}yXo(la,bb,qb,ac,yc){la.Rni=!0;la.bNb||(la.bNb=[]);la.bNb.push(bb);qb===ac&&(la.hIb=yc)}gHf(la,bb){return!!la&&!!la.objectId&&bb.contains(ua.a.If(la.objectId))}Juk(la,
bb,qb,ac){!bb.vTa||qb||ac||((qb=this.paa.sic.J(bb.vTa))&&la.classList.add(qb),bb.Rni&&la.classList.add(Lf.a.B1f))}wtk(la,bb,qb,ac,yc,$c){ac=this.paa.I3a.J(qb).J(ac.hIb);bb<yc.wri?ac=$c?this.paa.I3a.J(qb).J(1):this.paa.I3a.J(qb).J(2):bb<yc.xri&&!ac&&(ac=bb<yc.yri?this.paa.I3a.J(qb).J(1):this.paa.I3a.J(qb).J(3));ac&&(bb=yc.xwi,la.classList.add(ac),bb&&la.classList.add(Qe.xug))}xtk(la,bb,qb,ac){ac.Cna||(ac.Cna=this.RSl(bb,qb)||ac.bNb);bb=null;ac.Cna&&0<ac.Cna.length&&(this.sk.ob(Ii.a.f1,la,this.jnn,
ac.Cna),this.sk.ob(Ii.a.mya,la,this.inn,ac.Cna),bb=ac.Cna[0]);this.sk.ob(Ii.a.click,la,this.NUi,bb);this.sk.ob(Ii.a.jK,la,this.NUi,bb)}RSl(la,bb){for(;0<bb.f5b.length&&bb.f5b[0].JMd===la;)bb.f5b.splice(0,1);if(0<bb.f5b.length){la=[];for(const qb of bb.f5b[0].JCb)la.push(qb);return la}return null}}Object(e.a)(Nn,"AllMarkupModeHighlightChangeHandler",null,[769]);var rf=c(1499);class ge extends rf.a{constructor(la){super(100,25);this.Lqc=new Q.a(0);this.RVj=6E4;this.DHl=()=>{const bb=this.Lqc.keys;if(bb.length){var qb=
"";for(let ac=0;ac<bb.length;ac++)qb+=bb.J(ac)+":"+this.Lqc.J(bb.J(ac))+";";this.Zqa(qb);this.Lqc=new Q.a(0)}};this.btb=new ob.a;this.btb.add(1);this.btb.add(6);this.btb.add(2);this.btb.add(4);this.btb.add(10);this.btb.add(11);this.Sg=la;la.t6f&&window.setInterval(this.DHl,this.RVj)}uIa(la){this.Sg.KRo&&this.Sg.t6f&&(this.btb.contains(la)?this.wRn(la):this.Zqa(la+""))}wRn(la){this.Lqc.Z(la,this.Lqc.Gz(la,0)+1)}}Object(e.a)(ge,"CommentActionInTypingRecorder",rf.a,[783]);var bh=c(1638),lj=c(244);class ol{static L0n(la){la&&
la.atmention&&delete la.atmention.isCurrentUser;return la}}Object(e.a)(ol,"DeltaFormatHelpers",null,[]);class Pf{constructor(){this.optional=this.attributes=null}}Object(e.a)(Pf,"Operation",null,[]);class zi extends Pf{constructor(){super();this.insert=null}}Object(e.a)(zi,"DeltaOperation",Pf,[]);class $e{constructor(){this.ops=null}}Object(e.a)($e,"Delta",null,[]);var qn=c(139),fl=c(180),Qj=c(152),rm=c(59),Ai=c(74),qk=c(101),pe=c(497),hb=c(1208),Ib=c(1808);class gc extends Ib.ACommentFormatTranslator{constructor(la,
bb){super(la);this.De=bb}$mg(la){const bb=new bh.a;for(let qb=0;qb<la.length;qb++){const ac=la[qb];ac.iJb=!0;this.uEk(bb,ac);bb.Yca("\n")}return[bb.O9b()]}QLo(la,bb){la=bh.a.hGb(la[0]);la=this.CHn(la);const qb=new ob.a;let ac=0,yc=null,$c=null;for(;ac<la.ops.length;){const Vd=la.ops[ac];yc||(yc=hb.a.instance.createInstance(393230),yc.iJb=!0,yc.Gg(sa.a.Wc,lj.a.FF()),bb(yc),yc.ra.clear(),yc.sra(""));"\n"===Vd.insert?($c=this.NMf(yc,$c),this.hqo(yc),qb.add(yc),yc=null):$c=this.P3m(yc,Vd,$c);ac++}return qb.toArray()}hqo(la){const bb=
la.eBh();for(let qb=0;qb<bb;qb++)la.xe.uq.Z(qb,gc.Chn),la.xe.ot.Z(qb,gc.MTf)}NMf(la,bb){var qb=la.dNd();qb.cp===la.characterData.length?qb.Ph=!0:(qb=Object.assign(new fl.a(la,la.characterData.length),{Ph:!0}),la.ra.add(qb));qb=la.ra.last;if(bb){bb=!!bb.mw;const ac=this.JIh(la,qb,!bb,bb,null);qb.formatting=ac;bb&&(la=this.HIh(la,qb),qb.IU=la.Xj);qb.Bm=!0;bb=null}qb.cp||qb.formatting||(qb.formatting=new Qj.a(qb,ua.a.nil));return bb}P3m(la,bb,qb){const ac=la.dNd(),yc=!!bb.attributes&&!!bb.attributes.link,
$c=!!bb.attributes&&!!bb.attributes.atmention,Vd=this.JIh(la,ac,yc,$c,bb);ac.formatting=Vd;qb&&(qb.mw&&(qb=this.HIh(la,ac),ac.IU=qb.Xj),ac.Bm=!0,qb=null);if(yc||$c)this.l3m(ac,la,bb),qb=ac.hyperlink;la.sra(la.characterData+bb.insert);return qb}HIh(la,bb){bb=new Qj.a(bb,ua.a.create());let qb=this.QJd();qb.setValue(sa.a.fKb,!0);qb=la.Mc.uV(qb);bb.Xj=qb.id;return bb}JIh(la,bb,qb,ac,yc){bb=new Qj.a(bb,ua.a.create());let $c=hb.a.instance.createInstance(1179649);if(qb||ac)$c.setValue(pd.a.UB,!0),$c.setValue(pd.a.V4,
!0),qb&&this.Nho(la,$c);this.Sg.CBb&&yc&&yc.attributes&&this.Kno(yc.attributes,$c);$c=la.Mc.uV($c);bb.Xj=$c.id;return bb}Nho(la,bb){(la=this.De.ZC(la))&&(la=la.pj(rm.StyleReader.Mpc))&&bb.setValue(oc.a.qw,la.id)}Kno(la,bb){this.xQb(la.weight>=bh.a.e5d,bb,pd.a.bold,!0);this.xQb(la.italic,bb,pd.a.italic,!0);this.xQb(la.underline,bb,pd.a.underline,!0);this.xQb(la.underline,bb,pd.a.underlineType,kc.a.KSb);this.xQb(la.strikethrough,bb,pd.a.strikethrough,!0);if(Ai.a.eZc(la.highlight)){var qb=Ai.a.XFa(la.highlight);
this.xQb(!!la.highlight,bb,pd.a.highlight,Ai.a.J5(qb))}Ai.a.eZc(la.color)&&(qb=Ai.a.XFa(la.color),this.xQb(!!la.color,bb,pd.a.fontColor,Ai.a.J5(qb)))}xQb(la,bb,qb,ac){la&&bb.setValue(qb,ac)}l3m(la,bb,qb){if(qb.attributes&&qb.attributes.atmention){var ac=qk.a.NFa(qb.attributes.atmention.email);qb=qb.optional&&qb.optional.atmention&&qb.optional.atmention.contentId?qb.optional.atmention.contentId:gc.ALl(1===qb.attributes.atmention.resolveState);ac=new pe.a(la,ac,!0,void 0,void 0,void 0,qb);this.E9k(ac,
bb.Mc);la.hyperlink=ac}else bb=qk.a.NFa(qb.attributes.link),ac=this.zbl(la.paragraph.ra.first),la.hyperlink=new pe.a(la,bb,!1,ac.Xj)}zbl(la){let bb=this.RNh();bb=la.paragraph.Mc.uV(bb);la=new Qj.a(la,ua.a.nil);la.Xj=bb.id;return la}E9k(la,bb){var qb=String.format(' HYPERLINK "{0}"',la.url),ac=la.mw;const yc=this.QJd();yc.setValue(sa.a.Ns,15);yc.setValue(sa.a.mw,ac);yc.setValue(sa.a.YRa,!0);yc.setValue(sa.a.XX,qb);la.Jua(bb.uV(yc).id);ac=this.QJd();ac.setValue(sa.a.Ns,47);ac.setValue(sa.a.XX,qb);la.Jua(bb.uV(ac).id);
qb=this.QJd();qb.setValue(sa.a.Ns,16);la.Jua(bb.uV(qb).id)}RNh(){const la=hb.a.instance.createInstance(1179649);la.setValue(pd.a.UB,!0);la.setValue(pd.a.V4,!0);la.setValue(pd.a.isHidden,!0);return la}QJd(){const la=this.RNh();la.setValue(pd.a.Z$,!0);return la}CHn(la){const bb=new ob.a;for(let qb=0;qb<la.ops.length;qb++){const ac=la.ops[qb];ac.optional=ol.L0n(ac.optional);if(-1!==ac.insert.indexOf("\n")&&"\n"!==ac.insert){const yc=ac.insert.split("\n");for(let $c=0;$c<yc.length;$c++)if(qb!==la.ops.length-
1||$c!==yc.length-1||yc[$c])bb.add(Object.assign(new zi,{insert:yc[$c],attributes:ac.attributes,optional:ac.optional})),$c!==yc.length-1&&bb.add(Object.assign(new zi,{insert:"\n"}))}else bb.add(ac)}return Object.assign(new $e,{ops:bb.toArray()})}static ALl(la){return Ib.ACommentFormatTranslator.vIk+qn.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(la?"Z":"")}}gc.Chn=0;gc.MTf=0;Object(e.a)(gc,"CommentDeltaFormatTranslator",Ib.ACommentFormatTranslator,[]);var Lc=c(1699),Rc=c(1601);
class qd{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(la,bb,qb){this.Kj=la;this.K=bb;this.$K=qb}$D(la){return this.Kj.$D(la)}lKm(la){la=this.Kj.$D(la);return la?!la.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}DWc(la){return this.Kj.DWc(la)}isCurrentUserMentioned(la){var bb,qb;la=this.Kj.GSl(la);for(const ac of la){if(!ac.text||0===ac.text.length)continue;la=bh.a.hGb(ac.text[0]);let yc=0;for(;la.ops&&yc<la.ops.length;){const $c=
null===(qb=null===(bb=la.ops[yc])||void 0===bb?void 0:bb.attributes)||void 0===qb?void 0:qb.atmention;if($c&&$c.email===this.userPrincipalName)return!0;yc++}}return!1}v2c(){this.$K.s$("OnContentFilterUpdate")}}Object(e.a)(qd,"CommentFilterActor",null,[781]);var Ld=c(102),zd=c(2063),pf=c(900),Jc=c(605);class gg{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md){this.Yh=la;this.Ib=bb;this.ti=qb;this.uWa=ac;this.hj=yc;this.J2=$c;this.Ah=Vd;this.aU=me;this.sN=Md;this.kvb=null;this.dWe=0;this.lqd=!1;this.Gud=0;this.YSb=
this.Bad=this.$Og=this.Zxc=this.zAb=!1;this.updateViewportInfo=()=>{this.aU.dhg()&&this.Ah.updateViewportInfo(this.lqd,this.FZf)};this.Enb=()=>{this.Ah.Tma.Hpa()&&(this.D6c(this.Ah.Tma.rc),this.Ah.Tma.Djc(this.Enb))};this.FZf=()=>{this.B9a();this.aU.EZf()};this.Tjg=()=>{!this.zAb&&this.aU.tgg()&&(this.Gud=this.gYe.scrollTop,this.zAb=!0,this.uWa.uIa(2))};this.R6f=(Re,We)=>{this.zAb&&(Re=this.gYe.scrollTop,Re-this.Gud?(this.Zxc||We.Jpe||this.updatePosition(),this.Zxc||1!==We.Jpe||this.B9a(),this.m1e(Re),
this.aU.AYf()):this.Zxc=this.zAb=!1)};this.gYe=this.Ah.Sea;this.tja=Jc.a.R9d;this.ut=this.Ah.ut;this.Ah.xIh()}get r_d(){return this.aU.pIf()}get tja(){return this.Ah.tja}set tja(la){this.Ah.tja=la}get Hvh(){return"1"===this.ut.BF.style.opacity}Dpj(la){this.Bad||(this.Bad=!0,this.Ah.r3i(),this.kvb=la(this.ut.lGa,this.Ah.ubj,()=>{this.updatePosition()}),this.Ah.$Ki(this.kvb),this.aU.initialize(this.kvb,this),this.Ah.initialize(this.kvb,this.aU.Gnb),this.Ah.U9i(),this.Ah.xpj(),this.Ah.ypj(),this.Ah.Cpj(this.aU.B4e,
this.aU.N8d,this.aU.M8d),this.B7f())}x$c(){}xie(){return this.Ah.vqj()}setInitialActiveContainerId(la,bb,qb=null){this.Ah.setInitialActiveContainerId(la,0,qb)}updatePosition(){if(!this.YSb&&this.r_d&&this.Yh.Eac()){var la=I.a.$e()-this.dWe<Jc.a.QHj;la||this.lqd||this.B9a(la)}}F3e(){this.B9a()}sUa(la,bb,qb){this.sN.Qhb&&this.J2.s$("OnFloatingCommentsVisibilityChange",!0);this.Ah.sUa(la,bb,qb)}deleteContainer(la,bb,qb=!1){this.Ah.deleteContainer(la,bb,()=>{this.Yh.mTc()||this.Ah.WWd();this.aU.GWf()},
qb)}addContainer(la,bb,qb){this.Ah.addContainer(la,bb,qb,this.Ah.ol,this.aU.yRc,this.aU.pVf)}V1i(la){this.YSb=!0;la();this.YSb=!1}u7c(la,bb,qb){this.Ah.u7c(la,bb,qb)}T4b(){this.Ah.T4b()}lIj(){const la="1"===this.ut.BF.style.opacity;switch(!0){case la&&!this.Yh.mTc():this.Ah.WWd();break;case !la&&this.Yh.mTc():this.Ah.pRb()}}ong(la=!0){this.aU.Zgg&&this.Ah.DAj(la)}static j9h(la,bb=null){const qb=new xb.a;for(const ac of la)ac.Df||ac.Zq!==zd.a.beingCreated&&(!bb||bb(ac))&&gg.lsk(qb,ac.objectId,ac);
return qb}static lsk(la,bb,qb){let ac;({value:ac}=la.Fc(bb,ac)).returnValue||(ac=[],la.Z(bb,ac));ac.push(qb)}D6c(la){la&&(la.wga(()=>{this.updateViewportInfo()}),this.Gud=this.gYe.scrollTop,la.Orh(this.Tjg),la.Prh(this.R6f))}B7f(){this.Ah.ol?this.D6c(this.Ah.ol):this.Ah.Tma?this.Ah.Tma.O2b(this.Enb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}m1e(la){this.ut.BF.style.top=la-this.Gud+"px";this.Zxc=!1}B9a(la=!1){la=new ea.a(0,1,0,()=>{this.Qgf()},
129,void 0,!la);this.Ib.Wb(la);this.lqd=!0;this.Zxc=this.zAb;this.uWa.uIa(10)}Vtf(la){return this.Ah.a1a({contentAnchorPositions:la.contentAnchorPositions})}Qgf(){this.lqd=!1;if(this.ut.lGa&&this.kvb&&this.Yh.Eac()){this.Ah.tNd();var la=0;this.ti.ie(()=>{la=this.Ah.IRd()},"FCM:UP:GET");var bb=null,qb=null;this.ti.ie(()=>{const ac=this.aU.J7h(la,this.Ah.ol);bb=ac.e3k;qb=this.Vtf(ac)},"FCM:UP:GP");this.ti.ie(()=>{this.zAb?(this.Ah.EWh(qb),this.zAb=!1):this.kvb.emitEvent(3,qb);this.J2.Sce()},"FCM:UP:RC");
this.kvb.setFirstCommentRenderDone();"0"===this.ut.BF.style.opacity&&0<bb.count&&!this.hj.Am&&this.hj.dJa&&this.ti.ie(()=>{this.Ah.pRb()},"FCM:UP:SFC");!this.$Og&&0<bb.count&&(Yh.a.T3(this.Ib,this.Ah.xLi,pj.a.wLi),this.$Og=!0);this.dWe=I.a.$e();this.uWa.uIa(6)}else this.dWe=I.a.$e()}}Object(e.a)(gg,"FloatingCommentManager",null,[759,760]);var dc=c(115),ng=c(1500),Sd;(function(la){la[la.Vsp=0]="singleHint";la[la.$np=1]="multiHint";la[la.prp=2]="resolvedHint";la[la.aop=3]="multiResolvedHint";la[la.entryPoint=
4]="entryPoint";la[la.unknown=void 0]="unknown"})(Sd||(Sd={}));Object(e.b)("CommentIconType",Sd);var rk=c(128),Yi=c(1126);const dh={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Sd.unknown]:""},Nf={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Sd.unknown]:[]},ei=(la,bb)=>{switch(la){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(bb){case 3:return Yi.a.sHh;
case 2:return Yi.a.tHh;case 1:return Yi.a.uHh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(bb){case 3:return Yi.a.pHh;case 2:return Yi.a.qHh;case 1:return Yi.a.rHh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(bb){case 3:return Yi.a.vHh;case 2:return Yi.a.wHh;
case 1:return Yi.a.xHh}}},kf=(la,bb)=>{rk.a("renderIcon")&&appChrome.api.renderIcon(la,bb)};class rn{}rn.rpi=16;rn.Lvm=1;rn.CBf=20;rn.GMj=2;Object(e.a)(rn,"CommentIconConstants",null,[]);class Zi{constructor(){this.xHd=0;this.aHc=!1}}Object(e.a)(Zi,"CommentHintCensus",null,[]);class Ao{constructor(la,bb,qb,ac,yc){this.aQg=la;this.e2b=qb;this.u1j=ac;this.Rga=yc;this.YNa=-1;this.Vwe=new Set(bb)}get y(){if(-1!==this.YNa)return this.YNa;const la=Sys.UI.DomElement.getBounds(this.aQg),bb=this.aQg.getClientRects();
return this.YNa=0<bb.length&&bb[0]?this.u1j?la.y/this.e2b+rn.GMj:Math.floor(bb[0].height)/(2*this.e2b)+la.y/this.e2b-rn.rpi/2:0}get DHd(){return Array.from(this.Vwe)}lwk(la){this.Vwe=new Set([...this.Vwe,...la])}}Object(e.a)(Ao,"HintInfo",null,[799]);class gl extends ng.a{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf){super();this.Sg=la;this.ig=bb;this.sk=qb;this.xE=ac;this.ga=yc;this.Yh=Re;this.Bsa=We;this.uWa=bg;this.hj=yf;this.SZj=Rf;this.Lid=new Map;this.Qvb=this.kzb=null;this.eoc={Grb:-1,
aUf:-1}}n8a(la){let bb=!1;T.App.WLj&&la.mc.$i?S.a.instance.ie(()=>{bb=yg.m(la,!0)},"CHA:SCIVE"):S.a.instance.ie(()=>{bb=yg.l(la.htmlElement,!0)},"CHA:SCI");return bb}$0a(la){const bb=this.zoom,qb=la.y5,ac=la.uxa;let yc=0;for(let me=0;me<la.M4.length;me++)if(0<la.M4[me].width){yc=me;break}const $c=la.m0a(1,rn.CBf,bb,yc);this.uWa.uIa(1);let Vd=[];ac.forEach((me,Md)=>{const Re=la.M4[Md].y/bb;me=this.Pbl(this.s0l(me,Md),We=>this.Bbl(qb,We,We.y-Re,$c),()=>gl.Ddl(qb));Vd=Vd.concat(me)});return Vd}Pbl(la,
bb,qb){qb=qb();const ac=[];for(const yc of la){la=bb(yc);for(const Vd of yc.DHd)this.Lid.set(Vd.toString(),la);const $c=this.Gdi(yc.DHd);this.FGj($c,la);null==qb.Rga&&(qb.Rga=yc.Rga);qb.appendChild(la);ac.push(la)}this.abc(this.Qvb);this.pkb(this.kzb);return[qb]}Vsl(la,bb){la=null===la||void 0===la?void 0:la.querySelectorAll("."+gl.M_i);return 0<(null===la||void 0===la?void 0:la.length)&&la[0]&&(la=Array.from(la[0].querySelectorAll(gl.u2k)))?this.Dco(la,bb):!1}Dco(la,bb){let qb=0,ac=la.length-1,yc;
for(;ac>=qb;){yc=Math.floor((ac-qb)/2+qb);const $c=la[yc];if($c.offsetTop>=bb-2&&$c.offsetTop<=bb+2)return!0;$c.offsetTop>bb+2?ac=yc-1:qb=yc+1}return!1}Gdi(la){var bb,qb;let ac=0,yc=0;for(const $c of la)if(this.Yh.rHf($c)){if(this.Sg.contentFilterApiEnabled&&this.hj.Am&&(la=this.Yh.m0($c.toString()),null===(qb=(bb=this.SZj).isContentInFilteredContent)||void 0===qb||!qb.call(bb,la.id)))continue;this.Yh.ywi($c)?yc+=1:ac+=1}bb=new Zi;bb.xHd=ac+yc;bb.aHc=0===ac;return bb}Uoc(la){if(la=this.Lid.get(la.objectId)){var bb=
yg.g(la);bb=this.Gdi(bb);this.FGj(bb,la)}}FGj(la,bb){let qb,ac;if(this.Sg.contentFilterApiEnabled&&0===la.xHd)bb.style.display="none";else if(1===la.xHd?(qb=la.aHc?2:0,ac=la.aHc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=la.xHd&&(qb=la.aHc?3:1,ac=la.aHc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),bb.style.display=
"block",la=bb.firstElementChild)this.pko(la,qb),la.title=ac+". "+la.title,kf(dh[qb],la)}pko(la,bb){la.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;dc.a.Sl(la,gl.yHh,bb)}s0l(la,bb){la=this.Cbl(la,bb);la.sort((qb,ac)=>qb.y-ac.y);return this.vdn(la)}Cbl(la,bb){const qb=[],ac=this.Sg.$q,yc=this.zoom;la=yg.f(la,!0);for(let $c=0,Vd=la.length;$c<Vd;$c++){const me=la[$c],Md=yg.g(me);Md&&qb.push(new Ao(me,Md,yc,ac,bb))}return qb}vdn(la){let bb=null;const qb=[];for(let ac=0;ac<
la.length;ac++)bb&&Math.abs(la[ac].y-bb.y)<rn.rpi+rn.Lvm?bb.lwk(la[ac].DHd):(bb=la[ac],qb.push(bb));return qb}Bbl(la,bb,qb,ac){const yc=la.Ag.ownerDocument,$c=yc.createElement("div");$c.className=gl.nHh;$c.style.top=qb+"px";$c.style.left=ac+"px";$c.style.right="auto";$c.style.zIndex="40";dc.a.Sl($c,Lf.a.CJc,bb.DHd);bb=yc.createElement("span");this.$pg(bb,$c);kf(dh[0],bb);this.fC(bb,la);return $c}$pg(la,bb){la.title=CommonUIStrings.l_CommentHintTooltip;la.setAttribute("role","button");bb.appendChild(la)}fC(la,
bb){this.ig.oE(Ii.a.click,la,this.Qpn.bind(this),bb);this.ig.ob(Ii.a.wB,la,this.Tpn.bind(this));this.sk.ob(Ii.a.f1,la,this.Wpn.bind(this));this.sk.ob(Ii.a.yL,la,this.Vpn.bind(this));this.xE.ob(la,this.Spn.bind(this))}static Ddl(la){la=la.Ag.ownerDocument.createElement("div");la.className=gl.M_i;return la}Spn(){return!0}Tpn(){return!0}Qpn(la){const bb=yg.g(la.Yw.parentNode);la.eventName===Ii.a.jK&&(this.Bsa.y8e(),this.lFh());this.ga.Qb(Ef.a.oHh,2,bb);return!0}Wpn(la){this.AFa(this.Qvb)!==la.Yw&&(la=
yg.g(la.Yw.parentNode),this.ga.Qb(Ef.a.I9e,2,la));return!0}Vpn(){this.ga.processAction(Ef.a.IHd,2);return!0}abc(la){this.lFh();this.Qvb=la;this.qFk()}qFk(){this.rFk(this.AFa(this.Qvb),this.AFa(this.kzb))}pkb(la){this.$Yk();this.kzb=la;if(la=this.AFa(this.kzb)){const bb=this.vSd(la);this.jhe(la,bb,1)}}AFa(la){if(!la)return null;let bb=null;if(la=this.Yh.m0(la))if(la=la.Df?this.Yh.$D(la.Df):la)bb=la.objectId;return bb&&this.Lid.has(bb)?this.Lid.get(bb).firstChild:null}lFh(){this.bZk(this.AFa(this.Qvb),
this.AFa(this.kzb))}bZk(la,bb){if(la){const qb=this.vSd(la);this.jhe(la,qb,la===bb?1:3);this.Qvb=null}}rFk(la,bb){la&&(la.title=0<this.eoc.aUf&&1<this.eoc.Grb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.eoc.aUf,this.eoc.Grb):CommonUIStrings.l_CommentHintTooltip,bb!==la&&(bb=this.vSd(la),this.jhe(la,bb,2)))}$Yk(){const la=this.AFa(this.Qvb),bb=this.AFa(this.kzb);if(bb){const qb=this.vSd(bb);this.jhe(bb,qb,la===bb?2:3);this.kzb=null}}jhe(la,bb,qb){this.LOm()?
this.gko(la,qb):this.gmo(la,bb,qb)}gko(la,bb){la=null===la||void 0===la?void 0:la.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===la||void 0===la?void 0:la.length)&&(la[0].style.fill=2===bb||1===bb?"Highlight":"ButtonText")}gmo(la,bb,qb){bb=Nf[bb];for(let yc=0;yc<bb.length;yc++){var ac=bb[yc];const $c=ei(ac,qb);if(!this.gLm($c)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${$c}.`);break}ac=null===la||void 0===la?void 0:la.querySelectorAll("."+ac);0<(null===
ac||void 0===ac?void 0:ac.length)&&(ac[0].style.fill=`var(${$c})`)}}LOm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}vSd(la){return dc.a.Eb(la,gl.yHh)}gLm(la){var bb;const qb=document.getElementById(am.AppFrame.GMc);return!(null===(bb=null===qb||void 0===qb?void 0:qb.style)||void 0===bb||!bb.getPropertyValue(la))}}gl.nHh="clip16x16 HintContainer";gl.u2k=".clip16x16.HintContainer";gl.M_i="OutlineElementHintMargin";gl.yHh="CommentIconType";Object(e.a)(gl,
"CommentHintActor",ng.a,[775]);var Ga=c(1028);class kb extends Ga.a{get Zgg(){return this.v0()}get Tgf(){return this.K8o.Fhi()}constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re){super();this.Ch=la;this.Ur=bb;this.Kj=qb;this.taskManager=ac;this.zBd=yc;this.$K=$c;this.Ah=Vd;this.getSelectedText=me;this.K8o=Md;this.focusManager=Re;this.i2c=()=>{};this.H7d=()=>{};this.qMg=!1;this.hVk={[0]:()=>this.yRh(),[1]:()=>this.tmc.F3e(),[2]:()=>this.yRh()};this.EZf=()=>{this.zBd.uIa(11)};this.B4e=We=>{if(this.Ur.CBb)for(const bg of yg.t)We.bindAction(Ld.KeyInputManager.PG(bg),
Zj.a.k6e)};this.N8d=()=>{this.H7d()};this.M8d=(We,bg)=>{if(We.name!==Rd.AFrame.Sr&&bg){var yf=this.Kj.tt?this.Kj.tt.id:"";this.Ch.wMb||(this.Ch.wMb=Yh.a.T3(this.taskManager,()=>{this.i2c(yf)}))}};this.SYi=()=>{};this.Gnb=()=>{this.nsj()};this.pVf=(We,bg)=>{0===bg&&(this.$K.Sce(),this.zBd.uIa(0))};this.GWf=()=>{this.zBd.uIa(5)};this.yRc=We=>{let bg=0;const yf=this.Kj.$O();for(let Rf=0;Rf<yf.length;Rf++){if(yf[Rf].Df||yf[Rf].done)continue;if((yf[Rf].Zq===zd.a.beingCreated?yf[Rf].Cz.draftId:yf[Rf].id)===
We.contentId)break;const bf=this.Mx.getContentAnchorPosition(yf[Rf].id);!bf||4<Math.abs(We.anchorTop-bf.anchorTop)||bg++}return bg};this.WTi=()=>{this.$K.Sce()};this.AYf=()=>{this.zBd.uIa(2)};this.nsj=()=>{if(!this.qMg&&this.Ah.Sea){const We=this.Ah.Sea.getElementsByClassName(gl.nHh);for(let bg=0;bg<We.length;bg++)We[bg].style.opacity="1";this.qMg=!0}}}initialize(la,bb){this.Mx=la;this.tmc=bb;this.E6c();this.Ur.Qhb&&this.LXn()}Fjo(la,bb){this.H7d=la;this.i2c=bb}V7h(la,bb){return{Q_a:this.sTl(la,bb),
containerContentByType:{}}}J7h(la,bb){const qb=gg.j9h(this.Kj.$O(),this.Kj.oia),ac=[],yc=yg.e(!0);var $c=this.Kj.$O();bb=this.FJn(bb,$c,qb);!bb.O2f&&bb.contentAnchorPosition&&(ac.push(bb.contentAnchorPosition),bb.contentAnchorPosition=null);for($c=0;$c<yc.length;$c++){const Vd=yc[$c],me=yg.g(Vd);if(me)for(let Md=0;Md<me.length;Md++){const Re=this.getContentAnchorPosition(la,qb,Vd,me[Md]);Re&&(ac.push(Re),bb.O2f&&bb.contentAnchorPosition&&Re.contentId===bb.O2f.id&&(ac.push(bb.contentAnchorPosition),
bb.contentAnchorPosition=null))}}bb.contentAnchorPosition&&ac.splice(0,0,bb.contentAnchorPosition);return{e3k:qb,contentAnchorPositions:ac}}pIf(){var la;return!(null===(la=this.Mx)||void 0===la||!la.getAreContainersEnabled())}v0(){return this.Kj.Eac()}tgg(){return this.v0()}Z$c(){return this.v0()}dhg(){return this.Mx&&this.Ah.Sea&&this.v0()}nMo(){this.$K.s$("OnFloatingCommentsVisibilityChange",this.Ch.dJa);if(this.Ch.dJa)this.Ah.pRb();else{const la=this.Kj.rJ;la.Tz&&la.clearSelection();this.Ah.WWd()}}HYi(la){0!==
la&&this.i2c(this.Kj.tt?this.Kj.tt.id:"")}getContentAnchorPosition(la,bb,qb,ac){let yc=null;return({value:yc}=bb.Fc(ac.toString(),yc)).returnValue?(bb=yc[0])&&!bb.Df?{...(new pf.a),anchorTop:(Jc.a.zQc(qb)-la)/this.Ah.bca,anchorLeft:0,containerContentType:0,contentId:bb.id}:null:null}FJn(la,bb,qb){var ac,yc;const $c={};"CREATE"===(null===(yc=null===(ac=this.Kj.Tx)||void 0===ac?void 0:ac.Cz)||void 0===yc?void 0:yc.sessionType)&&(ac=this.Ah.Sea.querySelectorAll(yg.b),la=this.Ah.t5h((0<ac.length?ac[0]:
null)||this.getSelectedText(),this.Kj.Tx.Cz.draftId,0,la),$c.O2f=this.X9l(bb,qb),$c.contentAnchorPosition=la);return $c}X9l(la,bb){var qb=Array.indexOf(la,this.Kj.Tx);for(--qb;-1<qb;qb--)if(bb.nb(la[qb].objectId))return la[qb]}sTl(la,bb){return this.J7h(la,bb).contentAnchorPositions}E6c(){this.$K.u$("OnAfterTrackChangeMarkupViewChange",(la,bb)=>{if(bb)this.hVk[bb.fk]()})}LXn(){this.$K.u$("OnFloatingCommentsToggle",this.nMo.bind(this))}yRh(){const la=yg.i();if(0!==la.length){var bb=gg.j9h(this.Kj.$O()),
qb=this.Kj.rJ;for(let ac=0;ac<la.length;ac++){const yc=yg.g(la[ac]);for(let $c=0;$c<yc.length;$c++){let Vd;({value:Vd}=bb.Fc(yc[$c].toString(),Vd)).returnValue&&(Vd.forEach(me=>{var Md;me&&!me.Df&&(this.tmc.deleteContainer(me.id,0,!1),(null===(Md=qb.Tz)||void 0===Md?void 0:Md.id)===me.id&&qb.clearSelection())}),this.focusManager.mg(Rd.AFrame.In))}}}}}Object(e.a)(kb,"CommentFloatingContainerActor",Ga.a,[779]);var nc=c(1502),Kb=c(2069),ld=c(197);class Kc extends nc.a{constructor(la,bb,qb,ac,yc,$c,Vd,
me,Md){super();this.tak=la;this.dab=bb;this.Wwe=qb;this.ti=yc;this.paa=me;this.J2=Md;this.gj=null;this.fk=1;ac.execute(Re=>{this.gj=Re});this.h3=[];this.Qsc=new ld.ScriptSharpLegacyMap;this.CVn($c,Vd);this.E6c()}get sj(){return this.tak.value}get j2k(){return this.dab}get Oca(){return!!this.gj}get qkb(){return 0}get J3a(){return this.h3}get jZg(){return this.Qsc.nb(this.fk)?this.Qsc.J(this.fk):this.Qsc.J(0)}aSa(la){return this.paa.aSa(la)}d3a(la,bb){if(la=Object(rc.a)(776,la))for(const qb of this.WJn(la))bb.add(qb)}QHa(la,
bb){this.Oca&&this.ti.ie(()=>{this.xsn(la,bb)},"CHA:OPHC")}xsn(la,bb){if(this.gj.Fo.Eac()){var qb=this.Cr.tEa,ac=new fa.a(new le.a),yc=bb.nIa("*"),$c=this.VSl(qb),Vd=!!qb&&!qb.action||!!$c&&$c===this.gj.Tz,me;this.ti.ie(()=>{this.Wwe.V7l(la.id,ac,null===$c||void 0===$c?void 0:$c.objectId)},"OPHC:GOI");this.ti.ie(()=>{me=this.jZg.szh(yc,$c,ac,Vd);me.xwi=this.vwi(qb)&&0===qb.action},"OPHC:BHI");this.ti.ie(()=>{this.jZg.Suh(yc,me,Vd)},"OPHC:AH")}}VSl(la){let bb=null;!this.vwi(la)||0!==la.action&&2!==
la.action||(bb=this.Cr.tEa.HA);return bb||this.gj.Tz}WJn(la){if(!la)return[];la=this.sj.Eb(ua.a.If(la.objectId));return this.j2k.MTd(la,null)}T$i(){return!1}KF(la,bb,qb){this.Oca&&(la=Object.assign(new Kb.a,{action:la,type:0,HA:bb,WJ:qb}),this.Cr.KF(la))}y8e(){this.Oca&&(this.KF(3,this.gj.hbc,this.gj.hbc),this.gj.hbc=null)}CVn(la,bb){this.Qsc.add(1,la);this.Qsc.add(0,bb)}E6c(){this.J2.u$("OnBeforeTrackChangeMarkupViewChange",(la,bb)=>{bb&&bb.KTf!==this.fk&&(this.fk=bb.KTf)})}vwi(la){return la&&0===
la.type}}Object(e.a)(Kc,"CommentHighlightActor",nc.a,[778,617]);var ue=c(1051),Le=c(329),cf=c(505),Mf=c(1535);class Vg{constructor(la,bb){this.R2k=la;this.jVf=bb}}Object(e.a)(Vg,"CommentEndParaIdBeforeChangeInfo",null,[]);var Eg=c(1639);class wi{constructor(la,bb,qb,ac,yc,$c,Vd,me){this.eLf=la;this.Ch=bb;this.Kj=qb;this.$K=ac;this.rm=yc;this.Hk=$c;this.n2k=Vd;this.Ur=me;this.Gtb=null;this.GJn=(Md,Re)=>{(Md=Re.commentNode)&&!yg.s(Md)&&(Re=this.Kj.zpf(Md),ua.a.Cq(Re.cbd,Re.qNc)||this.dGj(Re,Md)||this.WDh(Re.WDa,
Re.ROa,Md)||this.kqg(Md))};this.$ln=(Md,Re)=>{Re.property===sa.a.mwa&&(Md=yg.h(Re.node,ua.a.nil),this.Gtb=new Vg(Re.node.id,Md))};this.lnn=(Md,Re)=>{Md=Re.node;if(Re.property===sa.a.mwa&&Md){var We=yg.k(Md,ua.a.nil);Re=yg.h(Md,ua.a.nil);var bg=this.Gtb?this.xd.Eb(this.Gtb.jVf):null;!yg.s(Md)&&We&&!We.equals(Re)&&this.Gtb&&Md.id.equals(this.Gtb.R2k)&&!We.equals(this.Gtb.jVf)&&bg&&bg.isConnected&&this.u_e(this.Gtb.jVf,Md.id);Re&&this.Ch.fy.nb(Re)&&(We=this.Ch.fy.J(Re),We.C3a&&(a.ULS.shipAssertTag(572835481,
327,!!We.dN,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),We.dN&&We.dN.contains(Md.id)&&(We.dN.remove(Md.id),We.dN.count||(We.C3a=!1),this.Ch.iV.nb(Md.id)?this.Ch.iV.J(Md.id).remove(Re):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.F2c=(Md,Re)=>{Md=Re.node.id;this.Ch.fy.nb(Md)&&this.Q0n(Md)};this.Kln=(Md,Re)=>{Re&&Re.node&&this.KWa.nb(Re.node)&&(Md=this.KWa.J(Re.node).Q9d,this.KWa.nb(Md)||(Md=this.KWa.J(Re.node),
this.WDh(Md.tdf?Md.currentNode:Md.Q9d,Md.tdf?Md.Q9d:Md.currentNode,Md.commentNode)||this.kqg(Md.commentNode)),this.KWa.remove(Re.node))};this.onn=(Md,Re)=>{const We=Md.Lj;if(!Re&&this.sdb.nb(We)){var bg;(bg=this.sdb).Z(We,bg.J(We)&(Md.Qc?-2:-3));this.sdb.J(We)||(this.kqg(this.xd.Eb(We)),this.sdb.remove(We))}};this.KWa=new cf.a(new ue.a);this.sdb=new nd.a(yg.c);this.$K.u$("OnCommentNodeAdded",this.GJn);this.Ur.contentFilterApiEnabled?(this.$K.u$("OnCommentPaneOpen",this.ZGm.bind(this)),this.$K.u$("OnCommentPaneClose",
this.YGm.bind(this)),this.$K.u$("OnContentFilterUpdate",this.v2c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Md=>{this.$K.u$(Md,this.WGm.bind(this))});this.Ur.Qhb&&this.$K.u$("OnFloatingCommentsVisibilityChange",this.XGm.bind(this));la=this.rm.Te(12);la.kw(this.F2c);la.ku(this.Kln);this.rm.Te(40).oGc(this.$ln);this.rm.Te(40).qo(this.lnn);Le.a.QTa(this.onn)}get px(){return this.eLf.value}get xd(){return this.px.xd}V7l(la,bb,qb){if(this.VAn(la))for(const ac of this.Ch.fy.J(la).dN)!this.qqj(ac,
qb===ac.toString())||bb.add(ac)}qqj(la,bb){const qb=this.xd.Eb(la),ac=yg.s(qb);if(!qb||ac)return!1;la=this.Kj.m0(la.toString());return!la||this.Ur.contentFilterApiEnabled&&this.Ch.Am&&!this.n2k.isContentInFilteredContent(la.id)||!this.Ch.Am&&!this.Kj.oia(la)&&!bb?!1:!0}VAn(la){return this.BAn(la)}kqg(la){if(la){var bb=Mf.a.MTd(la,null),qb=new Wa.a;for(let ac=1;ac<bb.length-1;ac++)this.u_e(bb[ac].id,la.id),qb.add(bb[ac]);ag.b(qb)}}XGm(){const la=new Wa.a;for(const bb of this.Kj.$O())!bb.Df&&bb.Zq!==
zd.a.beingCreated&&this.Kj.oia(bb)&&this.Kj.Joe(bb,la);ag.b(la)}BAn(la){if(!this.Ch.IY)return!1;let bb=null;if(({value:bb}=this.Ch.fy.Fc(la,bb)).returnValue)return bb.C3a;let qb=!1;this.Hk.ie(()=>{const ac=yg.e();for(let yc=0;yc<ac.length;yc++)qb=this.eZo(ac[yc],la,qb);qb||(this.Ch.fy.add(la,new Eg.a),this.Ch.fy.J(la).C3a=!1)},"CHORA:PHOC");return qb}eZo(la,bb,qb){la=yg.g(la);if(!la)return qb;for(let ac=0;ac<la.length;ac++){const yc=this.xd.Eb(la[ac]);yc&&!yg.s(yc)&&(qb=qb||this.IVk(yc,bb))}return qb}IVk(la,
bb){var qb=this.Kj.zpf(la);if(this.dGj(qb,la))return!1;var ac=qb.cbd;const yc=qb.qNc;qb=qb.WDa;if(ac!==ua.a.nil&&(ac.equals(yc)||ac.equals(bb)))return!1;for(ac=eb.ParagraphReader.Wf(qb,!1);ac&&!ac.id.equals(yc);){if(ac.id.equals(bb))return this.u_e(bb,la.id),!0;ac=eb.ParagraphReader.Wf(ac,!1)}return!1}u_e(la,bb){this.Ch.iV.nb(bb)||this.Ch.iV.add(bb,new fa.a(new le.a));this.Ch.iV.J(bb).add(la);this.Ch.fy.nb(la)?this.Ch.fy.J(la).dN||(this.Ch.fy.J(la).dN=new fa.a(new le.a)):this.Ch.fy.add(la,new Eg.a(!0));
this.Ch.fy.J(la).C3a=!0;this.Ch.fy.J(la).dN.add(bb)}Q0n(la){if(this.Ch.fy.J(la).dN)for(const bb of this.Ch.fy.J(la).dN)this.Ch.iV.nb(bb)?this.Ch.iV.J(bb).remove(la):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Ch.fy.remove(la)}WGm(){const la=new Wa.a;for(const bb of this.Kj.$O())bb.Df||bb.Zq===zd.a.beingCreated||this.Kj.oia(bb)||this.Kj.Joe(bb,la);ag.b(la)}ZGm(){this.qDf("OnCommentPaneOpen")}v2c(){this.qDf("OnContentFilterUpdate")}YGm(){this.qDf("OnCommentPaneClose")}qDf(la){const bb=
new Wa.a;for(const qb of this.Kj.$O())qb.Df||qb.Zq===zd.a.beingCreated||this.Kj.rJ.MBh(la,qb)||this.Kj.Joe(qb,bb);ag.b(bb)}dGj(la,bb){let qb=!1;if(!la.wke||!la.YMd){qb=!0;if(!la.WDa||!la.ROa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!la.WDa,!la.ROa),!0;la.wke||this.KWa.nb(la.WDa)||this.KWa.add(la.WDa,{commentNode:bb,currentNode:la.WDa,Q9d:la.ROa,tdf:!0});la.YMd||this.KWa.nb(la.ROa)||this.KWa.add(la.ROa,{commentNode:bb,currentNode:la.ROa,Q9d:la.WDa,
tdf:!1})}return qb}WDh(la,bb,qb){la=Mf.a.Gwa(la,qb.id,!0);bb=Mf.a.Gwa(bb,qb.id,!1);let ac;la||({value:ac}=this.sdb.Fc(qb.id,ac),this.sdb.Z(qb.id,ac&1));bb||({value:ac}=this.sdb.Fc(qb.id,ac),this.sdb.Z(qb.id,ac&2));return!la||!bb}}Object(e.a)(wi,"CommentHighlightOnRestActor",null,[777]);var sm=c(549),sh=c(438),Rj=c(636);class Ni{constructor(la,bb){this.yAb=la;this.Dla=bb}getViewContainer(){return this.yAb}registerForViewContainerEvents(la){this.Dla.lZn(la)}unregisterForViewContainerEvents(la){this.Dla.RTo(la)}}
Object(e.a)(Ni,"ViewContainerProvider",null,[1056]);class xi{constructor(la,bb,qb,ac){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=la;this.appLocale=bb;this.uiCulture=qb;this.dataCulture=ac}}Object(e.a)(xi,"LocalizationDetails",null,[]);var qe=c(1162),Hh=c(1550),xd=c(482);class ye{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf,bf,pl,il,Sk,Vj,Ch,Qn,zh,gk,sk,wl,Rn,nk,Zm,uo,Ui,er){this.Yq=la;this.Kj=bb;this.i5b=qb;this.Y_=ac;this.Ur=yc;this.Ch=$c;
this.nPd=Vd;this.bbc=me;this.eq=Md;this.oc=Re;this.dynamicScriptLoader=We;this.V9n=bg;this.focusManager=yf;this.Q9e=Rf;this.M9e=bf;this.Snh=pl;this.Z3o=il;this.L1=Sk;this.$K=Vj;this.Fao=Ch;this.QAl=Qn;this.xTi=zh;this.$3o=gk;this.KCb=sk;this.aU=wl;this.Ah=Rn;this.sN=nk;this.daf=Zm;this.z6a=uo;this.JHd=Ui;this.v6k=er;this.Eod=this.XYa=null;this.D_g=!1;this.RMe=[];this.zeh=this.E_g=!1;this.initialize=(wh,ql)=>{this.PAm(ql)};this.sil=wh=>Ai.a.KId(wh);this.pnn=()=>{this.ssi()};this.rZl=(wh,ql,Tk)=>{wh=
{...(new qe.a),containerPanel:wh,paneOpenedCallback:ql,paneClosedCallback:Tk,ulsLogger:new sm.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.Ah.mqf(),destroyAllContainersCallback:()=>{this.Ch.Am||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Ur.oPd,synchronousContainerPositioningEnabled:!1,
trackChangeInSidetrackEnabled:this.Ur.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Ur.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Ur.contentNavigationApiEnabled,contentFilterApiEnabled:this.Ur.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.Ur.contentNavigationApiEnabled&&(wh.sidetrackContentNavigationApi=this.daf,wh.featureGateApiSettings=this.aU.Tgf,wh.telemetryDetails=this.xTi,this.Ur.contentFilterApiEnabled&&
(wh.contentFilterAPI=this.v6k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(wh)};this.hpn=wh=>{2!==this.Yq.mode&&3!==this.Yq.mode&&this.Kj.tt&&wh===this.Kj.tt.id&&this.Yq.clearSelection();db.StaticActiveAppFrame.za().updateCommandUI(!0)};this.PUi=(wh,ql)=>{this.Hx("onCSCStart",window.performance.now());this.Teb&&!wh&&(this.uxn(),this.Hx("openInFishbowl",!0));this.i5b.Yeb&&this.Ur.$Db&&this.oc.processAction(Ef.a.yHa,2);ql&&ql();this.Hx("onCSCEnd",window.performance.now())};this.$K.u$("OnCommentInit",
this.initialize);this.$K.u$("OnCommentRenderedOnce",this.pnn);this.aU.Fjo(()=>{},this.hpn);this.Ur.Qhb&&xd.a.sTc&&(this.Ch.dJa=!1)}get vLa(){return this.Yq}get Teb(){return this.Ch.Teb}Hx(la,bb){this.z6a.Hx(Uh.a.comments,la,bb,!0)}PAm(la){if(this.Ch.IY)la&&la.CHa&&la.CHa();else if(this.D_g)(null===la||void 0===la?0:la.CHa)&&this.RMe.push(la.CHa);else{var bb=this.Ur.Fac;this.Hx("hasCommentOnBoot",bb);bb?this.KCb.logKpiUsage(Hh.a.h5b,0):sh.a.Gjn();this.D_g=!0;this.Hx("initInProgress",!0);this.Kj.initialize(this.Yq);
this.i5b.initialize(this.Yq,null);this.i5b.zpj(this.Yq);this.bbc.JBm(this.Y_.qoo);this.Hx("InitAMSetup",window.performance.now());Rj.a.Gp(this.QAl).continueWith(qb=>{(this.XYa=qb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.Q9e.initialize(this.XYa);this.vLa.E9e.initialize(this.vLa,this.Kj,this.XYa,this.Q9e);this.Snh.initialize(this.dynamicScriptLoader,this.vLa.E9e,this.xTi,this.XYa,new Ni(this.Z3o,this.$3o),this.uci(),"",this.Q9e.Fhi(),
this.L1,T.App.oie);this.Hx("AMInitialized",window.performance.now());this.Ur.contentNavigationApiEnabled?(T.App.oFb?T.App.oFb:this.Ah.gIi()).then(()=>{this.Hx("FCMLoaded",window.performance.now());this.x$c();this.BYd(la)}):this.BYd(la)})}}AGn(){var la;null===(la=sharedComments.setDarkModeColorHandler)||void 0===la?void 0:la.call(sharedComments,this.sil)}BYd(la){this.Eod=this.Snh.BYd(void 0,this.AGn.bind(this));this.fVc(la);this.Ch.IY=!0;this.Ur.Eig&&this.M9e.initialize()}fVc(la){if(!this.Ch.vIb){this.Hx("InitCSStart",
window.performance.now());var bb=this.eq.Yf("Task","InitiateCommentingSession");this.KCb.logKpiUsage(Hh.a.zHh,0);try{const qb=this.eq.Yf("Task","InitiateCommentingSession-UpdateModel");this.JHd.gBm();qb.stop();this.Hx("initAtBoot",window.performance.now());this.Ur.$q&&this.Kj.Eac()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",I.a.$e()));gf.a.get_instance().oI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Ch.vIb=
!0;this.Eod.then(()=>{this.Hx("SCLoaded",window.performance.now());this.Ah.ABm();this.Hx("FCMInitiated",window.performance.now());if(this.Ur.$q){let yc=!1;if(this.Teb){var ac=this.Y_.jRd(this.Teb);ac?(y.AFrameworkApplication.se("3ge3g205;cha3g788"),ac=this.Y_.kRd(ac,0),ac)?this.Kj.oia(ac)||(yc=!0,this.vxn(ac)):(yc=!0,this.f6a()):yc=!0}ac=la?la.HVi:null;this.Ur.contentNavigationApiEnabled?this.PUi(yc,ac):this.f3m(yc,ac)}la&&la.CHa&&la.CHa();for(const yc of this.RMe)yc();this.E_g&&this.ssi();this.RMe=
[]})}catch(qb){a.ULS.Vz(539567713,327,10,qb,`Comments Initialization Failed: ${qb}`),this.KCb.logKpiFailure(Hh.a.zHh,"CommentsInitializationFailed",{isInternal:!0},{name:Hh.a.g5b,isInternal:!0})}finally{bb.stop(),this.Hx("InitCSEnd",window.performance.now())}this.oc.processAction(Ef.a.bHh,2)}}vxn(la){this.oc.processAction(Ef.a.OV,2);this.aU.nsj();Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Y_.selectComment(la,{...(new yh.a),mS:!0,E$:1});this.focusManager.mg(Rd.AFrame.Sr);a.ULS.sendTraceTag(574734912,
327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.xX)},pj.a.ndo);this.KCb.Sv(Ef.a.H9e);y.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}f6a(){this.oc.processAction(Ef.a.f6a,2)}f3m(la,bb){(T.App.oFb?T.App.oFb:this.Ah.gIi()).then(()=>{this.Hx("FCMLoaded",window.performance.now());this.x$c();this.PUi(la,bb)}).catch(qb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+
qb.toString())})}x$c(){this.sN.trackChangeInSidetrackEnabled?(this.nPd.x$c(),this.Hx("STSet",window.performance.now())):this.nPd.Dpj(this.rZl)}ssi(){this.zeh||(this.Ch.IY&&this.Eod?(this.Eod.then(()=>{const la=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.Fao.execute(bb=>{la.registerSafelinksNavigator(bb.Eoc.bind(bb))});this.V9n.execute(bb=>{bb.FVn(la)})}),this.zeh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),
this.E_g=!0))}uci(){return new xi(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}uxn(){this.Y_.Mij(this.Teb,{...(new yh.a),Sgg:!1,xWc:!0});this.KCb.Sv(Ef.a.H9e)}}Object(e.a)(ye,"CommentInitActor",null,[]);class Pd{constructor(la,bb,qb,ac,yc,$c){this.ig=la;this.xE=bb;this.ga=qb;this.TZj=ac;this.wj=yc;this.Sg=$c;this.npe=this.zXa=null}get zoom(){let la=1;this.wj&&this.wj.instance&&(la=this.wj.instance.oj);return 0<
la?la:1}sCl(la,bb){if(!this.npe||!la.uxa||bb>=la.uxa.length)return null;const qb=this.zoom,ac=la.y5,yc=la.m0a(1,rn.CBf,qb,bb);return this.Ial(la.uxa[bb],ac,(this.npe.y-la.M4[bb].y)/qb+rn.GMj,yc)}Ial(la,bb,qb,ac){if(this.zXa)return(bb=this.zXa.parentElement)&&bb.removeChild(this.zXa),this.rlj(la,this.zXa,qb,ac),this.zXa;const yc=bb.Ag.ownerDocument,$c=yc.createElement("div");$c.className=Pd.k2k;this.rlj(la,$c,qb,ac);la=yc.createElement("span");this.$pg(la,$c);kf(dh[4],la);this.SWn(la,bb);return this.zXa=
$c}$pg(la,bb){la.title=CommonUIStrings.l_CommentNewCommentButton;la.setAttribute("role","button");bb.appendChild(la)}SWn(la,bb){this.ig.oE(Ii.a.click,la,this.Oon.bind(this),bb);this.ig.ob(Ii.a.wB,la,this.Qon.bind(this));this.xE.ob(la,this.Pon.bind(this))}QWd(){if(this.zXa){const la=this.zXa.parentElement;la&&la.removeChild(this.zXa)}}rlj(la,bb,qb,ac){this.Sg.g$n||this.TZj.Vsl(la,qb)?bb.style.left=ac+rn.CBf+"px":bb.style.left=ac+"px";bb.style.top=qb+"px";bb.style.right="auto";bb.style.display="block";
bb.style.position="absolute";bb.style.overflow="hidden";bb.style.cursor="default";bb.style.zIndex="40"}Qon(){return!0}Oon(la){this.ga.LC=30;this.ga.processAction(Ef.a.yHa,2);la=la.Yw;kf(dh[4],la);la=la.parentElement;(null===la||void 0===la?0:la.parentElement)&&la.parentElement.removeChild(la);return!0}Pon(){return!0}}Pd.k2k="clip16x16 EntryPointContainer";Object(e.a)(Pd,"CommentMarginEntryPointActor",null,[]);var Td=c(419),ul=c(76),oi=c(225),lh=c(34),Xk=c(118);class Ih{constructor(la,bb,qb,ac,yc,
$c,Vd){this.eLf=la;this.X0m=bb;this.Fo=qb;this.Ch=ac;this.Ur=yc;this.K9e=$c;this.KCb=Vd;this.x5i=new Set;this.fLb=new Set;this.j3c=new oi.a;this.j5b=new Map;this.EHh=M.a.instance.Ve("Box4.CommentParagraphMapping");this.LCb=new Set;this.Oga=this.iRd()}get px(){return this.eLf.value}get xd(){return this.px.xd}get ZDa(){return this.X0m.value}iRd(){const la=new ic.GraphIterator;la.set(this.px);this.ZDa.Z5a(la);return la}gBm(){this.Ch.vIb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
lh.Debug.o2a());this.Ur.contentNavigationApiEnabled||(this.Ur.Fac&&this.eBm(),this.Fo.QWi())}smn(){this.Hfj();this.LCb.forEach(la=>{this.$vg(la)});this.LCb.clear();this.Fo.QWi()}$vg(la){if(Td.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${la}`);var bb=this.j5b.get(la).Imc,qb=this.j5b.get(la).X7b;bb===ua.a.nil||qb===ua.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${bb} or end ${qb} has invalid value`):(this.EHh.value.H0a.set(la,bb),this.EHh.value.G0a.set(la,
qb),a.ULS.sendTraceTag(512235651,327,50,`Start ${bb} and End ${qb} mapping info for Comment ${la} added on Comment Model load`))}}NDm(la){const bb=[];for(const qb of la)la=qb.Lj.toString(),this.JFj(la,qb.paragraph.id,qb.Qc),qb.Qc&&(this.x5i.has(la)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",qb.Lj):(this.x5i.add(la),(la=this.nsk(qb))&&bb.push(la)));return bb}JFj(la,bb,qb){Td.a.isEnabled&&(this.j5b.has(la)||this.j5b.set(la,{Imc:ua.a.nil,X7b:ua.a.nil}),
qb?this.j5b.get(la).Imc=bb:this.j5b.get(la).X7b=bb)}nsk(la){var bb=this.xd.Eb(la.Lj);this.Oga.Bj(bb);if(40!==this.Oga.Xe||!bb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!bb,!la.Lj),this.Oga=39===this.Oga.Xe?this.Oga:this.iRd(),null;bb=this.Fo.vJd(this.Oga);let qb;if(({index:qb}=this.Fo.wne(bb)).returnValue)if(this.Fo.RZe(bb,qb),this.fLb.add(bb.objectId),yg.p(bb)||this.LCb.add(bb.objectId),
bb.Df)this.Xlf(bb);else return{contentId:bb.id,containerContentType:0,n$:{Bd:la.Lb.cp,cN:la.paragraph.Uk}};else this.j3c.add(bb);return null}Xlf(la){if(la.Df){var bb=this.Fo.$D(la.Df);if(bb&&bb.Df){const qb=this.Fo.$D(bb.Df);qb&&(qb.Df?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(la.Df=bb.Df,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${la.objectId} parentObjectId: ${bb.objectId}`)))}}}eBm(){const la=new Q.a(0),
bb=ul.a.gp(this.Fo.pKa),qb=new Set;this.Ur.Tyn&&!Td.a.isEnabled&&this.vuk(bb,la);const ac=this.iRd(),yc=new Set,$c=new Set,Vd=new ml.GraphTransaction(2);try{if(Vd.Ut(ac),ac.Jt(1)){for(;bb.moveNext();){if(!eb.ParagraphReader.oh(bb.iterator))continue;const Md=bb.iterator.currentNode,Re=eb.ParagraphReader.YFb(Md);Td.a.isEnabled&&this.San(Md,Re,la);qb.add(Md.id.toString());this.U4i(Re,$c,ac,yc)}this.Hfj();const me=this.WSl(qb);0<me.length&&this.k9n(me,qb,ac,$c);this.LCb.forEach(Md=>{this.$vg(Md)});this.LCb.clear()}}finally{Vd&&
Vd.dispose()}0==this.fLb.size&&this.Ur.Fac&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Rc.a.i7m(yc,$c,this.xd)}U4i(la,bb,qb,ac){for(const yc of la){la=this.Ur.$q?!yc.Qc:yc.Qc;const $c=yc.Lj.toString();this.JFj($c,yc.paragraph.id,yc.Qc);la?bb.has($c)||ac.add($c):bb.has($c)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",yc.Lj):(bb.add($c),this.osk(yc,qb))}}k9n(la,bb,qb,ac){const yc=this.g9l(la);Rc.a.JWk(yc);
const $c=new Set,Vd=new Set;yc.forEach(Md=>{bb.has(Md.id.toString())||Vd.has(Md.id.toString())||(Vd.add(Md.id.toString()),Md=eb.ParagraphReader.YFb(Md),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Md.length} CommentRangeObjects`),this.U4i(Md,ac,qb,$c))});const me=[];la.forEach(Md=>{this.fLb.has(Md)||me.push(Md)});0<me.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${me.length} Failed To Load on Retry: ${me.join(",")}`),this.KCb.logKpiFailure(Hh.a.h5b,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Hh.a.g5b,isInternal:!0}))}g9l(la){const bb=[];la.forEach(qb=>{if(qb=this.K9e.H7h(qb))qb=yg.k(qb),(qb=this.xd.Eb(qb))&&qb.yj&&bb.push(qb)});return bb}osk(la,bb){const qb=this.xd.Eb(la.Lj);bb.Bj(qb);40===bb.Xe&&qb?(la=this.Fo.vJd(bb),({index:bb}=this.Fo.wne(la)).returnValue?(this.Fo.RZe(la,bb),this.fLb.add(la.objectId),yg.p(la)||this.LCb.add(la.objectId),la.Df&&this.Xlf(la)):this.j3c.add(la)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!qb,!la.Lj),39===bb.Xe||this.iRd())}WSl(la){const bb=[],qb=this.K9e.QSl();if(this.fLb.size===qb.length)return bb;qb.forEach(ac=>{!this.fLb.has(ac)&&Rc.a.aYm(ac,la,this.K9e,this.xd)&&bb.push(ac)});return bb}Hfj(){for(let la=0;la<this.j3c.length;la++){const bb=this.j3c.J(la);let qb;({index:qb}=this.Fo.wne(bb)).returnValue?(this.Fo.RZe(bb,qb),yg.p(bb)||this.LCb.add(bb.objectId),this.fLb.add(bb.objectId),bb.Df&&this.Xlf(bb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
bb.fxa,bb.H1a,bb.objectId,bb.Df))}this.j3c.clear()}vuk(la,bb){la.xo(qb=>{if(11===qb.Xe){var ac=qb.currentNode;const yc=ac.ja(Xk.a.T9e,null),$c=ac.ja(Xk.a.R9e,null);qb=!!yc&&0<yc.length;const Vd=!!$c&&0<$c.length;qb&&yc.forEach(Md=>{const Re=this.xd.Eb(Md);Re&&!yg.s(Re)&&bb.add(Md,0)});Vd&&$c.forEach(Md=>{bb.nb(Md)&&bb.remove(Md)});(ac=ac.ja(pd.a.bL,null))&&ac.forEach(Md=>{const Re=this.xd.Eb(Md);eb.ParagraphReader.Xb(Re)&&!this.Ch.fy.nb(Md)&&this.Ch.fy.add(Md,new Eg.a)});const me=bb.keys;for(let Md=
0;Md<me.length;Md++){ac&&0<bb.J(me.J(Md))&&(this.Ch.iV.nb(me.J(Md))||this.Ch.iV.add(me.J(Md),new fa.a(new le.a)),ac.forEach(We=>{const bg=this.xd.Eb(We);eb.ParagraphReader.Xb(bg)&&(this.Ch.fy.J(We).dN||(this.Ch.fy.J(We).dN=new fa.a(new le.a)),this.Ch.iV.J(me.J(Md)).add(We),this.Ch.fy.J(We).C3a=!0,this.Ch.fy.J(We).dN.add(me.J(Md)))}));let Re;bb.Z(Re=bb.keys.J(Md),bb.J(Re)+1)}return qb||Vd}return!0},null)}San(la,bb,qb){la&&(this.jTj(bb,qb),this.Ch.fy.nb(la.id)||this.Ch.fy.add(la.id,new Eg.a),qb.forEach((ac,
yc)=>{0<yc&&(this.Ch.iV.nb(ac)||this.Ch.iV.add(ac,new fa.a(new le.a)),this.Ch.fy.J(la.id).dN||(this.Ch.fy.J(la.id).dN=new fa.a(new le.a)),this.Ch.iV.J(ac).add(la.id),this.Ch.fy.J(la.id).C3a=!0,this.Ch.fy.J(la.id).dN.add(ac));qb.Z(ac,yc+1);return!0}))}jTj(la,bb){la.forEach(qb=>{if(qb.Qc){const ac=this.xd.Eb(qb.Lj);ac&&!yg.s(ac)&&bb.Z(qb.Lj,0)}else bb.nb(qb.Lj)&&bb.remove(qb.Lj)})}}Object(e.a)(Ih,"CommentModelBootLoader",null,[774]);var Ze=c(1062);class If{constructor(la){this.BHh=la;this.Fvc=null;
this.P7g=void 0;this.Q7g=null;this.mAc=new Map;this.iAe=new Map}bZn(){Ze.a.QTa(this.KVo.bind(this))}KVo(la,bb){const qb=la.id.toString();var ac=la.getValue(sa.a.hF).toString();bb?(this.mAc.delete(qb),this.iAe.delete(ac)):(this.mAc.set(qb,la),this.iAe.set(ac,la));0===this.mAc.size&&this.Fvc&&(la=+new Date-+this.Fvc,this.Fvc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${la}`));bb||this.P7g!==ac||(bb=+new Date-
+this.Q7g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${bb}`),ac=new K.a,ac.durationMs=bb,this.BHh.logKpiFailure(Hh.a.zHd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:ac},{name:Hh.a.hHh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ac}));this.Fvc||(this.Fvc=new Date)}set Uen(la){this.P7g=la;this.Q7g=new Date;if(la=this.OSl(la))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${la.id} present but failed to load`),
la=new K.a,this.BHh.logKpiFailure(Hh.a.zHd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Hh.a.hHh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:la})}QSl(){return[...this.mAc.keys()]}OSl(la){return this.iAe.get(la)}H7h(la){return this.mAc.get(la)}}Object(e.a)(If,"CommentNodeTracker",null,[]);class Ho{get contentType(){return 0}constructor(la,bb,qb,ac,yc){this.uag=la;this.Fo=bb;this.Y_=qb;this.rJ=ac;this.Ch=yc;this.uag.r$i(this)}Qij(la,bb,qb){0===bb?(bb=this.Fo.DWc(la),
this.Y_.selectComment(bb?this.Fo.Tx:this.Fo.$D(la),Object.assign(new yh.a,{mS:qb||bb,E$:1}))):this.rJ.clearSelection()}Xqj(la){if(this.Ch.Am||this.Fo.DWc(la.contentId))return!0;const bb=this.Fo.$D(la.contentId);if(bb)return this.Fo.oia(bb);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${la.contentId}`);return!1}}Object(e.a)(Ho,"CommentReviewSuggestionContentActor",null,[772]);class Me{get Gxj(){return this.Bkg}constructor(la,bb){this.JHd=la;this.Ur=bb;this.Bkg=new Set([12])}initialize(){}oIi(la){if(!eb.ParagraphReader.Xb(la.node))return[];
la=eb.ParagraphReader.YFb(la.node);return this.JHd.NDm(la)}uUi(){this.JHd.smn()}Ani(){return this.Ur.rAo?this.Ur.Fac:!0}}Object(e.a)(Me,"CommentReviewSuggestionContentProvider",null,[773]);var Si=c(311),sg=c(70),Fe=c(130),ch=c(254),Se=c(1600);class Mb{constructor(){this.commentId=null;this.rYc=!1}}Object(e.a)(Mb,"CommentToSelectOnPaneLoadData",null,[]);class hj{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf,bf){this.Yq=la;this.Fo=bb;this.YDa=qb;this.Y_=ac;this.$K=yc;this.Ch=$c;this.nPd=Vd;
this.Ur=me;this.i5b=Md;this.QKb=Re;this.oc=We;this.fLf=bg;this.focusManager=yf;this.Hk=Rf;this.O2k=bf;this.R5c=(pl,il,Sk,Vj,Ch)=>{if(1===Sk||!Ch)return 32;Ch[Si.a.On]=xd.a.sTc?this.Ch.Am:this.Ch.dJa;return 32};this.oc.qa(Ef.a.kRb,sg.a.frame,this.Yq.kRb.bind(this.Yq));this.oc.qa(Ef.a.lMd,sg.a.frame,this.lMd.bind(this));this.oc.qa(Ef.a.F9e,sg.a.frame,this.hnn.bind(this));this.oc.qa(Ef.a.X1k,sg.a.frame,this.gnn.bind(this));this.oc.qa(Ef.a.vRi,sg.a.frame,this.Qrn.bind(this));this.oc.qa(Ef.a.JTh,sg.a.frame,
this.von.bind(this));this.oc.qa(Ef.a.oHh,sg.a.frame,this.Rpn.bind(this));this.oc.fb(Ef.a.I9e,sg.a.frame,this.aFk.bind(this),64);this.oc.fb(Ef.a.IHd,sg.a.frame,this.w_n.bind(this),64);this.oc.qa(Zj.a.selectComment,sg.a.frame,this.Y_.kdo.bind(this.Y_));this.Ur.D1m&&this.oc.qa(Zj.a.S2d,sg.a.frame,this.S2d.bind(this));this.Ooh(Zj.a.LLc,!1);this.Ooh(Zj.a.Jef,!0);this.oc.fb(Zj.a.KHd,sg.a.frame,this.KHd.bind(this),64);this.Ur.Qhb&&(this.oc.qa(Zj.a.kng,sg.a.frame,this.cwn.bind(this)),this.oc.fb(Zj.a.R5c,
sg.a.frame,this.R5c.bind(this),96));this.oc.qa(Zj.a.NKi,sg.a.frame,Fe.ActionManager.Nf);this.Ur.CBb&&this.oc.qa(Zj.a.k6e,sg.a.frame,this.vQk.bind(this));this.oc.qa(Zj.a.xRh,sg.a.frame,(pl,il)=>ch.a.via(il.ik)&&ch.a.Tcc()?8:32)}get Kj(){return this.Fo}get mode(){return this.Yq.mode}get Tz(){return this.Yq.Tz}get BA(){return this.Ur.$q}get sj(){return this.QKb.value}get mb(){return this.fLf.value}get rJ(){return this.Yq}lMd(la,bb,qb,ac,yc){return yc?yc?(la=this.Y_.jRd(yc.NavigationId))&&this.Y_.kRd(la,
1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}hnn(la,bb,qb,ac,yc){yc&&this.$K.s$("OnCommentInit",{...(new Se.a),CHa:()=>{var $c=this.Y_.jRd(yc.NavigationId);if($c){var Vd=this.Y_.kRd($c,1);Vd?this.i5b.isVisible?(this.Z8c(Vd,1),this.focusManager.jD(Rd.AFrame.Sr)):this.Kj.oia(Vd)?($c=yg.r(Vd),this.Y_.selectComment(Vd,{...(new yh.a),mS:!$c,E$:1}),this.focusManager.jD(Rd.AFrame.KM)):
(this.Ch.Am||this.oc.processAction(Ef.a.OV,2),Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Z8c(Vd,1)},pj.a.Z8c)):this.oc.processAction(Ef.a.f6a,2)}}});return 32}gnn(la,bb,qb,ac,yc){yc?(la=this.Kj.gQc(yc))?this.rJ.Sgc(la.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.rJ.Sgc(null);return 32}Qrn(la,bb,qb,ac,yc){if(yc){if(this.Ch.vIb){for(la=0;la<yc.length;la++)this.Kj.mlj(yc[la]);this.Yq.UOb()}else this.Kj.rwk(yc);this.q7m(yc)}return 32}von(la,
bb,qb,ac,yc){if(yc)if(this.Ch.vIb){for(la=0;la<yc.length;la++)this.Kj.mlj(yc[la],!0);this.Yq.UOb()}else this.Kj.mZk();return 32}Rpn(la,bb,qb,ac,yc){this.BA||this.Ch.Am||this.oc.processAction(Ef.a.OV,2);if(yc){la=null;if(!this.Tz||2!==this.mode&&3!==this.mode){if(!yc)return 8;if(this.BA)la=this.ZDl(yc);else for(bb=0;bb<yc.length&&(la=this.Kj.m0(yc[bb].toString()),this.nPd.r_d&&(!la||la.done));bb++);}else la=this.Tz;this.Z8c(la,1);la&&this.Ch.IY&&this.focusManager.mg(this.BA&&!this.Ch.Am?Rd.AFrame.KM:
Rd.AFrame.Sr)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}aFk(la,bb,qb,ac,yc){var $c;if(!yc)return 32;if(yc&&0<yc.length){bb=la=qb=0;ac=!1;for(let Vd=0;Vd<yc.length;Vd++)yc[Vd].toString()===(null===($c=this.Tz)||void 0===$c?void 0:$c.objectId)?(ac=!0,la++):this.Fo.rHf(yc[Vd])&&(ac&&0===qb&&(qb=Vd,bb=la),la++);($c=this.Fo.m0(yc[qb].toString()))?(this.YDa.eoc.aUf=bb+1,this.YDa.eoc.Grb=la,this.rJ.Sgc($c.id)):(yc=yc[qb],this.sj.Eb(yc)?
a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${yc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",yc.toString()))}return 32}w_n(){this.rJ.Sgc(null);return 32}Ooh(la,bb){this.oc.qa(la,sg.a.frame,(qb,ac,yc)=>this.Znn(yc,bb))}cwn(la,bb,qb){var ac;if(1===qb)return this.Fo.Tx?8:32;if(2===qb){if(xd.a.sTc||this.Ch.Am)return this.oc.processAction(Ef.a.OV,2),this.Ch.dJa=this.Ch.Am,32;
if(!this.Fo.mTc())return 32;this.Ch.dJa=!this.Ch.dJa;this.$K.s$("OnFloatingCommentsToggle");null===(ac=db.StaticActiveAppFrame.za())||void 0===ac?void 0:ac.updateCommandUI(!0)}return 32}S2d(la,bb,qb){2===qb&&(la=this.Kj.Yr.Pc(7),la.Db(this.Kj.pKa),bb=new bh.a,bb.Yca(`${String.fromCodePoint(128077)} \n`),this.Fo.tDb(Wg.a.instance.ib.lb,void 0,bb),this.O2k.QWd(),la.dispose());return 32}Znn(la,bb=!1){if(2===la)la=this.Kj.Yr.Pc(15),la.Db(this.Kj.pKa),this.Hk.ie(()=>{this.LLc(bb)},"ECM:DAC"),la.dispose();
else if(1===la&&!this.Kj.Eac())return 2;return 32}LLc(la=!1){this.Yq.mode=1;const bb=this.Kj.$O();for(const qb of bb)qb.Zq===zd.a.beingCreated||la&&!qb.done||qb.Df||this.Yq.deleteComment(qb);this.focusManager.mg(Rd.AFrame.In);0<(la?this.Kj.$O().filter(qb=>qb.done):this.Kj.$O()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",la):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",la)}KHd(la,bb,
qb){if(2===qb)if(la=this.focusManager.currentScope.name,la!==Rd.AFrame.Sr&&la!==Rd.AFrame.KM){!this.BA||this.Ch.Am?(this.Ch.Am||this.oc.processAction(Ef.a.OV,2),this.focusManager.mg(Rd.AFrame.Sr)):this.focusManager.mg(Rd.AFrame.KM);var ac=this.mb.ib.lb;if(!ac||!ac.Pa)return 2;la=ac.Pa.cpBegin;bb=ac.Pa.node;ac=!!this.Tz&&(ie.SelectionEditor.Pl(ac)||ac.dI)&&yg.q(this.Tz,bb,this.sj,la);la=!!this.Tz&&(2===this.mode||3===this.mode);if(ac||la)return this.rJ.Sij(this.Tz.id,!0),32;ac=this.BA&&!this.Ch.Am?
this.Kj.I7h(!0,!0):null;this.rJ.tdo(ac)}else this.Kj.tt&&(this.Yq.bbc.Lij(this.Kj.tt,!0),this.Yq.bbc.pkb(null===(ac=this.Kj.tt)||void 0===ac?void 0:ac.objectId)),this.focusManager.mg(Rd.AFrame.In);return 32}vQk(){return 4}q7m(la){const bb=new Set;for(let qb=0;qb<la.length;qb++){const ac=this.Kj.gQc(la[qb]);ac&&bb.add(ac.Df?ac.Df:ac.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",bb.size.toString())}Z8c(la,bb){la?this.i5b&&!this.Ch.IY?this.Ch.ugb=Object.assign(new Mb,{commentId:la.id,
rYc:!1}):this.Y_.selectComment(la,Object.assign(new yh.a,{mS:!!bb,E$:bb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}ZDl(la){let bb=null,qb=!1;for(let ac=0;ac<la.length;ac++){const yc=la[ac].toString();if(this.Kj.rHf(la[ac])){bb||(bb=yc);if(qb&&this.Kj.tt.objectId!==yc)return this.Kj.m0(yc);qb=qb||!!this.Kj.tt&&this.Kj.tt.objectId===yc}}return bb?this.Kj.m0(bb):null}}Object(e.a)(hj,"CommentsActionManager",null,[]);var ak=c(236),xj=c(50),jo=c(183),To=c(1846),
ep=c(522),yn=c(32),ko;(function(la){la[la.Xgp=0]="commentDeeplink";la[la.catchUpActivity=1]="catchUpActivity"})(ko||(ko={}));Object(e.b)("DeeplinkSource",ko);class fq{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf){this.ga=la;this.Yh=bb;this.Ev=qb;this.Xwe=ac;this.tQ=yc;this.zgh=$c;this.Vb=Vd;this.hj=me;this.Sg=Md;this.Uwb=Re;this.Zwe=We;this.rK=bg;this.GTe=!1;this.qoo=Rf=>{if(this.Sg.$q&&!this.hj.Am){const bf=new ea.a(0,1,0,()=>{this.Zkj(Rf)},136,void 0,!0);y.AFrameworkApplication.lc.Wb(bf)}else this.Zkj(Rf)};
yf.execute(Rf=>{this.KE=Rf})}get Fo(){return this.Yh}get mb(){return this.Uwb.value}FWh(la){let bb=la.Zq===zd.a.beingCreated?la.Cz.draftId:la.id,qb=null;la.Df&&(bb=la.Df,qb=()=>{this.zgh.selectComment(la.id)});this.tQ.setInitialActiveContainerId(bb,0,qb)}kdo(la,bb,qb,ac,yc){if(!yc.commentId)return 2;la=this.Yh.$D(yc.commentId);if(!la)return 2;this.Opb(la,yc);return 32}Pij(la,bb){var qb,ac;if(la){var yc=(null===(ac=null===(qb=this.Yh.Tx)||void 0===qb?void 0:qb.Cz)||void 0===ac?void 0:ac.draftId)===
la?this.Yh.Tx:this.Yh.$D(la);this.selectComment(yc,bb)}}selectComment(la,bb){la&&this.Opb(la,bb)}Mij(la,bb){var qb=this.jRd(la);qb&&((qb=this.kRd(qb,0))?bb.Sgg?(this.hj.ugb=Object.assign(new Mb,{commentId:qb.id,rYc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Opb(qb,Object.assign(new yh.a,{commentId:qb.id,E$:1,mS:!0,xWc:!0})),this.Sg.$q&&void 0!==la&&null!==la&&this.FWh(qb),Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Vb.mg(this.Sg.$q&&!this.hj.Am?
Rd.AFrame.KM:Rd.AFrame.Sr)},pj.a.Hjo),ak.a.instance.pf(xj.a.oQh,(new Date).getTime()),la=this.Sg.$q?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",la+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,la,(new Date).getTime()-y.AFrameworkApplication.xX)):this.ga.processAction(Ef.a.f6a,2))}jRd(la){let bb=null;var qb=null;if(N.a.zdc(la))bb=la;else if(({Gt:qb}=v.d(la)).returnValue&&(la=qb))return ep.a.comment in la&&(bb=la[ep.a.comment]),bb;bb||(qb=
qb?Object.keys(qb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",qb?qb.join(","):"Not Json."));return bb?bb.toString():null}kRd(la,bb){const qb=this.Yh.gQc(la),ac=0===bb;ac&&this.rK.logKpiUsage(Hh.a.zHd,0);if(!qb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",la,bb);const yc=new yn.a;yc.name="DeepLinkSource";yc.string=ko[bb];this.rK.logActivity("CommentDeeplinkNotFound",{dataFields:[yc]});ac&&(bb=new K.a,bb.extendedProperties=
new Map([["ErrorLevel","warning"]]),this.rK.logKpiFailure(Hh.a.zHd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:bb}),this.Zwe.Uen=la)}return qb}Zkj(la){this.GTe=!0;this.mb.Ac(la);this.GTe=!1}Opb(la,bb){if(la){this.Sg.Qhb&&!this.hj.dJa&&this.ga.processAction(Zj.a.kng,2);this.hj.wMb&&(y.AFrameworkApplication.lc.ff(this.hj.wMb),this.hj.wMb=null);var qb=this.Yh.tt,ac=this.Fo.Stf(la),yc=2===bb.E$,$c={};yc&&($c.TriggeredByFindReplace=!0);if(this.hj.Am)yc&&($c.PaneAlreadyOpen=!0),jo.UISurfaces.Pu().then(Vd=>
{Vd.setSelectedTaskPane(To.a.LHd);return null});else if(la.Zq!==zd.a.beingCreated&&!this.Fo.oia(la))this.hj.IY?this.ga.processAction(Zj.a.OV,2):this.hj.ugb=Object.assign(new Mb,{commentId:la.id,rYc:bb.xWc}),yc&&($c.OpeningPaneToSelect=!0);else if(this.Sg.$q){const Vd=ac.Zq===zd.a.beingCreated;Vd?this.tQ.sUa(ac.Cz.draftId,0,bb.mS):this.tQ.sUa(ac.id,0,bb.mS);!Vd&&yc&&($c.SelectingDHC=!0)}Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.hj.IY&&(bb.mS&&this.Vb.mg(this.Sg.$q&&!this.hj.Am?Rd.AFrame.KM:Rd.AFrame.Sr),
bb.xWc&&this.Fo.oia(la)||!bb.mS&&!bb.E$||this.zgh.selectComment(la.id))},pj.a.Odg);yc=this.Fo.Stf(qb);this.Sg.tva&&this.KE&&yc&&yc.id!==ac.id&&this.KE.fireEvent(9,{comment:yc});this.Yh.selectComment(la);this.Sg.tva&&this.KE&&la.Zq===zd.a.normal&&!la.Df&&this.KE.fireEvent(8,{comment:la});this.Xwe.highlightComment(la,!0);this.Ev.KF(0,ac,qb);db.StaticActiveAppFrame.za().updateCommandUI(!0);0<Object.keys($c).length&&this.rK.Sv(Zj.a.selectComment,{customData:$c})}}}Object(e.a)(fq,"CommentSelectionActor",
null,[771]);class Rp extends wf.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Ic.a,{T_:Rp.getTypeName(),B_:Rp.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Rp,"CommentSmartReplySignal",wf.a,[]);class yj extends Pa.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Ic.a,
{T_:yj.getTypeName(),B_:yj.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(e.a)(yj,"SmartReply",Pa.a,[]);var Io=c(870);class Qm{constructor(la){this.Asa=la}b6b(la,bb){return Object.assign(new Io.a,{parentPath:["Signal",Rp.getTypeName()],items:[Object.assign(new ad.a,{body:Object.assign(new Rp,{commentId:la,comment:bb})})]})}c2f(la){const bb=new ob.a;if(la&&la.CommentId&&la.ResultSets&&0<la.ResultSets.length&&
la.ResultSets[0].Documents&&0<la.ResultSets[0].Documents.length){for(const qb of la.ResultSets[0].Documents)bb.add(qb.Caption);0<bb.count&&this.Asa.c2f(la.CommentId,bb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return yj.getTypeName()}}Object(e.a)(Qm,"BaseCommentSmartReplyProvider",null,[1168]);class Dl extends Qm{constructor(la,bb,qb,ac){super(la);this.Je=bb;this.nB=qb;this.kXj=ac}initialize(){this.nB.ll().then(()=>{this.Je.ob(this,
Qm.prototype.getTypeName.call(this))})}invoke(la,bb){this.nB.ll().then(()=>{this.kXj.getAugLoopRuntimeManager().submitOperation(Object.assign(new xc.a,{operation:this.b6b(la,bb)}))})}KB(la,bb){la&&xa.a.getTypeNameFor(la.content)===this.getTypeName()&&bb===Na.a.getTypeName()?this.c2f(la.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(Dl,"CommentSmartReplyProvider",Qm,[55]);var ek=c(39),Zh=c(141),Fh=c(172);class Xi{constructor(la,bb,qb,ac,yc,$c){this.Ca=
la;this.rd=bb;this.Dx=qb;this.FJe=ac;this.Zwe=yc;this.sN=$c;this.Zvb=!1;this.Zwe.bZn();this.YPg=this.y7l();this.t6f&&(ek.a.addHandler(window.self,Ii.a.Gsh,()=>{this.Zvb=!0}),ek.a.addHandler(window.self,Ii.a.Hsh,()=>{this.Zvb=!1}));0<this.YPg&&y.AFrameworkApplication.se("77dda873;fe8jd931")}get px(){return this.Dx?this.Dx.value:null}get ZDa(){return this.FJe.value}get KRo(){return this.Zvb}get Fac(){return 0<this.YPg}get $q(){return this.sN.$q}get Ipl(){return!0}get xJk(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",
!1)}get dSb(){return this.rd.isFeatureEnabled(115)&&!Fh.App.FXc}get Aeo(){return this.rd.isFeatureEnabled(38)&&this.Ca.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get Y1k(){return this.Ca.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get t6f(){return this.Ca.$("RecordCommentActionsInTypingIsEnabled")}get aSi(){return this.Ca.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get $Db(){return this.$q&&!this.Fac&&!this.Ca.kb("BootActivityNavigationId")&&E.a.Nt}get CBb(){return this.rd.isFeatureEnabled(7)}get xIk(){return this.Ca.$("AtMentionUserFloodGateCampaignIsEnabled")}get p2k(){return this.Ca.$("CommentFriendlyTimestampsIsEnabled")}get Apl(){return this.Ca.kb("DisabledChangeGatesInSharedComments")}get oPd(){return this.sN.oPd}get tRb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get g$n(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightAlignedEntrypointIsEnabled",!1)}get Eig(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get dZ(){return this.Ca.kb("PresenceUserId")}get aea(){return Fh.App.mqe&&!!Zh.PageReader.instance&&Zh.PageReader.instance.Pwa(db.StaticActiveAppFrame.za().jb.Zc).aea}get Rhb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get $Io(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get Qhb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get g3k(){return this.Ca.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get W2k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get D1m(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.sN.contentNavigationApiEnabled}get Tyn(){return this.rd.isFeatureEnabled(88)}get tva(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.sN.contentFilterApiEnabled}get o2k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get rAo(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}get cAl(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandToFullHyperlinkRange",!1)}y7l(){if(this.px&&this.ZDa){const la=new ic.GraphIterator;la.set(this.px);this.ZDa.Z5a(la);let bb=0;39===
la.Xe&&(bb=la.Wp());return bb}return-1}}Object(e.a)(Xi,"CommentsSettings",null,[]);class Oi{constructor(){this.uLg=null;this.IY=!1;this.wMb=this.ugb=null;this.fy=new cf.a(new le.a);this.iV=new cf.a(new le.a);this.T5f=this.vIb=!1;this.dJa=!0}get Am(){return xd.a.Am}set Am(la){xd.a.Am=la}get Teb(){return this.uLg}set Teb(la){this.uLg=la}}Oi.fk=1;Object(e.a)(Oi,"CommentsState",null,[]);var nb=c(1393);class Bc{constructor(la){this.paa=la}szh(la,bb,qb){const ac=new Oh;bb=this.paa.aSa(bb)?bb.objectId:null;
if(!bb)return ac;bb=ua.a.If(bb);if(qb.contains(bb))return ac.SUc=0,ac.RUc=la.length,ac;for(let $c=0,Vd=la.length;$c<Vd;$c++){var yc=la[$c];qb=yg.g(yc);yc=yg.d(yc);qb&&nb.a.dJh(qb,bb)&&(ac.SUc=$c);if(yc&&nb.a.dJh(yc,bb)){ac.RUc=$c;break}}return ac}Suh(la,bb,qb){const ac=-1===bb.SUc&&-1===bb.RUc,yc=-1<bb.SUc?bb.SUc:-1;bb=-1<bb.RUc?bb.RUc:la.length;const $c=!ac&&yc===bb;var Vd=!1;for(let me=0;me<la.length;me++){const Md=la[me],Re=ag.a(Md);if(1!==Re&&2!==Re&&3!==Re)continue;this.paa.UTa(Md);if(ac||me<
yc||me>bb)continue;const We=3===Re||2===Re&&-1!==Md.className.indexOf(Lf.a.aRa),bg=qb?1:2;this.aGk(me,yc,bb,bg,We,Vd,Md,$c);if(me!==bb||$c)(Vd=this.paa.I3a.J(Re).J(bg))&&Md.classList.add(Vd),Vd=We}}aGk(la,bb,qb,ac,yc,$c,Vd,me){la!==bb&&la!==qb||yc||$c||((la=this.paa.sic.J(ac))&&Vd.classList.add(la),me&&Vd.classList.add(Lf.a.B1f))}}Object(e.a)(Bc,"DefaultHighlightChangeHandler",null,[769]);var wc;(function(la){la[la.success=0]="success";la[la.noSelection=1]="noSelection";la[la.invalidContent=2]="invalidContent"})(wc||
(wc={}));Object(e.b)("AnchorCreationResult",wc);var Zc=c(65),Ne=c(23),df=c(280),Kf=c(238),af=c(1223);class Ji{}Object(e.a)(Ji,"EditorAnchorInfo",null,[793]);class aj{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md){this.b1m=la;this.fLf=bb;this.Kj=qb;this.vxa=ac;this.YDa=yc;this.Nl=$c;this.$K=Vd;this.Ur=me;this.Ang=Md;this.qgh=null;this.vxa.RTa(this.YDa);this.Ur.contentFilterApiEnabled&&(this.$K.u$("OnCommentPaneOpen",this.IXo.bind(this)),this.$K.u$("OnCommentPaneClose",this.HXo.bind(this)),this.$K.u$("OnContentFilterUpdate",
this.v2c.bind(this)))}get mb(){return this.fLf.value}get sj(){return this.b1m.value}initialize(){}JBm(la){this.qgh=la}dispose(){}pkb(la){this.YDa.pkb(la)}abc(la){this.YDa.abc(la)}highlightComment(la){this.Lij(la,!1);this.YDa.pkb(la.objectId)}Uoc(la){this.YDa.Uoc(la)}AFa(la){return this.YDa.AFa(la)}v2c(){this.bse("OnContentFilterUpdate")}IXo(){this.bse("OnCommentPaneOpen")}HXo(){this.bse("OnCommentPaneClose")}bse(la){const bb=[],qb=new Set;for(const yc of this.Kj.$O())if(!yc.Df&&yc.Zq!==zd.a.beingCreated&&
!this.Kj.rJ.MBh(la,yc)){var ac=this.s8l(yc);qb.has(ac.id.toString())||(qb.add(ac.id.toString()),(ac=ac.qe(Zc.InteractiveViewManager.instance.yd.$b))&&bb.push(ac))}bb.forEach(yc=>{this.vxa.Voc(yc)})}s8l(la){var bb,qb,ac;const yc=null===(bb=this.sj)||void 0===bb?void 0:bb.Eb(la.objectId);if(!yc)return null;la=yg.k(yc);bb=null===(qb=this.sj)||void 0===qb?void 0:qb.Eb(la);return null===(ac=this.Ang.instance)||void 0===ac?void 0:ac.qHb(bb)}Lij(la,bb){if(!la.Zq){var qb=this.sj.Eb(ua.a.If(la.objectId)),
ac=Mf.a.uca(qb,this.sj,!0);qb=Mf.a.uca(qb,this.sj,!1);if(ac&&qb){const yc=ac.Lb.paragraph;ac=ac.Lb.cp;if(this.gVm(yc,ac))db.StaticActiveAppFrame.za().updateCommandUI(!0);else{ac=Ne.SelectionFactory.ne(yc,ac);qb=Je.a.Uc(qb.Lb.paragraph,qb.Lb.cp);if(aj.Xf.x9(ac.Pa)||aj.Xf.x9(qb))la.IRa=!0,la.X5a();la=bb?Ne.SelectionFactory.Iy(ac,qb):ac;this.qgh(la)}}}}ZYk(){this.YDa.abc(null);this.YDa.pkb(null)}C9k(){const la=new Ji;return{returnValue:wc.success,anchor:la}}gVm(la,bb){if(la&&Object(ok.a)(af.MainView,
this.Nl.yd)){var qb=la.qe(this.Nl.yd.$b);la=document.getElementById(am.AppFrame.oKa);if(qb&&la){bb=df.a.Vq(qb,bb);if(!bb)return!1;bb=bb.y;qb=Sys.UI.DomElement.getBounds(la).y;la=la.offsetHeight;if(bb>=qb&&bb<=qb+la)return!0}}return!1}static get Xf(){return Kf.a.instance}static getInstance(){return aj.fm()}static fm(){return aj._instance||(aj._instance=new aj(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),new X.a(()=>Wg.a.instance),M.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),
M.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,M.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Zc.InteractiveViewManager.instance,M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings"),M.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")))}}aj._instance=null;Object(e.a)(aj,"EditorCommentHintManager",null,[767,768,10]);var ph=c(2066),ij=c(355),Ng=c(1171);class Oc extends md.a{constructor(la,
bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf,bf,pl,il,Sk,Vj,Ch,Qn,zh,gk,sk,wl,Rn){super(Vd);this.ji=bb;this.Uwb=me;this.E9e=Re;this.Bsa=We;this.Ssc=bg;this.tQ=yf;this.Sg=Rf;this.Xo=bf;this.IVb=pl;this.hj=il;this.J2=Sk;this.je=Ch;this.rK=Qn;this.aU=gk;this.BHd=sk;this.Ang=Rn;this.Hoi=this.iih=this.QXa=null;this.Enb=()=>{this.isa.Hpa()&&(this.k$i(this.isa.rc),this.isa.Djc(this.Enb))};this.Z0c=nk=>{2===nk.mode?this.uD=1:1===nk.mode&&(this.uD=0);this.Yh.Tx&&0===this.uD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",
this.Yh.Tx.Cz.sessionType):this.hj.IY&&(this.BA||this.K2.isVisible)&&this.UOb()};this.oln=()=>{this.hj.vIb?this.mode=0:this.uD=0};this.SHa=(nk,Zm)=>{var uo;nk=Zm.yl.lb;if((this.BA||this.Oda&&this.Oda.isVisible)&&!this.IVb.GTe&&nk){Zm=ie.SelectionEditor.Pl(nk);var Ui=nk.dI;null!==(uo=this.Hoi)&&void 0!==uo&&uo.gca||(this.Fo||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),uo=this.Fo&&this.Fo.glb(this.ga,!1),1!==this.mode||Zm&&!Ui||!uo?this.Ssc.QWd():this.Icl(nk));2!==
this.mode&&3!==this.mode&&this.Sg.Y1k&&this.ZPo(nk,Zm,Ui)}};this.EWk=()=>{if(this.Kj&&this.Kj.Tx&&!T.App.IDf){var nk=this.Kj.Tx;nk.Cz.sessionType!==ph.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${nk.Zq} present on app shutdown`),(nk=Rc.a.TWl(nk))&&this.rK.logKpiFailure(nk,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Hh.a.g5b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.xln=()=>{if(this.hj.IY){var nk=()=>!0;this.BA&&!this.hj.Am&&(nk=Zm=>this.Fo.oia(Zm));
nk=this.Fo.epf(nk);this.UOb(nk)}};this.ga=Vd;this.uD=1===this.ga.mode?0:1;this.K2=yc;this.Yh=ac;this.Faa=$c;this.Vb=Md;this.$Xn();qb.j7a(this.Bsa);this.mb.Xw(this.SHa);la.CWR(()=>la.result.nC.gOa(this.oln));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.H_a(this.Z0c);this.J2.u$("OnAfterTrackChangeMarkupViewChange",this.xln);y.AFrameworkApplication.rI&&y.AFrameworkApplication.rI(this.EWk);wl.execute(nk=>{this.KE=nk});zh.execute(nk=>{nk.b7k.execute(Zm=>{this.Hoi=Zm})})}$Xn(){this.isa&&(this.isa.Hpa()?
this.k$i(this.isa.rc):this.isa.O2b(this.Enb))}k$i(la){la.wga(()=>{this.SDo()})}get isa(){var la;return null===(la=Fh.App.pn)||void 0===la?void 0:la.jb}get mb(){return this.Uwb.value}get Kj(){return this.Yh}get Fo(){return this.Yh}get BA(){return this.Sg.$q}get HRi(){return!0}get Ejj(){return!0}get hbc(){return this.QXa}set hbc(la){this.QXa=la}get mode(){return super.mode}set mode(la){la!==this.uD&&(super.mode=la,this.X5a())}get Tz(){return this.model&&this.model.tt?this.model.tt.Df?this.model.$D(this.model.tt.Df):
this.model.tt:null}get sj(){return this.ji.value}get osj(){return!1}get aea(){return this.Sg.aea}UOb(la=null,bb=null){const qb=this.Fo,ac=!this.uD,yc=this.Oda.l2k,$c=qb.wTd();yc.jqg($c?5:1,ac);la=this.Sg.tRb&&la?la:qb.Bpf(this.Sg.tRb&&this.BA&&!this.hj.Am);yc.teo(la,$c,qb.NWa);this.Ppg();bb&&a.ULS.sendTraceTag(572281362,327,50,bb)}w2c(la,bb,qb=!1){this.hj.Am?this.tQ.lIj():bb?this.tQ.deleteContainer(la.Zq===zd.a.beingCreated?la.Cz.draftId:la.id,0,qb):this.fQn(la)}fQn(la){const {SKo:bb}=this.Yh.x1l(la),
qb=this.Faa.AFa(la.objectId);qb&&this.tQ.addContainer(la.id,qb.parentElement,0,bb)}Wij(la){const bb=this.Tz;this.a9c();this.Bsa.KF(0,this.Yh.tt,bb);this.BA&&this.Yh.tt&&!this.hj.Am&&this.tQ.sUa(this.Yh.tt.id,0,1===la)}udo(){const la=this.Tz;this.b9c();this.Bsa.KF(0,this.Yh.tt,la);this.BA&&this.Yh.tt&&!this.hj.Am&&this.tQ.sUa(this.Yh.tt.id,0,!1)}Uoc(la){this.Faa.Uoc(la)}rvl(la,bb){this.tQ.addContainer(la,null,0,bb)}LCn(la){this.tQ.V1i(la)}tvl(la,bb){this.tQ.u7c(la,bb,0)}RWo(){this.tQ.F3e()}Oij(la){if(la&&
(2!==this.mode||la.Zq===zd.a.beingCreated)){var bb=this.Yh.tt;bb!==la&&(this.Yh.selectComment(la),this.K2.isVisible?this.hj.IY?(this.K2.selectComment(la,1),this.Dla.selectComment(la.id)):this.hj.ugb=Object.assign(new Mb,{commentId:la.id,rYc:!1}):this.BA&&!la.done&&(this.Sij(la.id,!1),this.Dla.selectComment(la.id)),!this.K2.isVisible&&this.BA&&la.done||(this.bbc.pkb(la.objectId),this.Bsa.KF(0,this.Tz,bb)))}}fVc(){}Aif(){this.hj.vIb=!1}VAb(la){this.Sg.aSi&&this.Yh.tt&&this.clearSelection();super.VAb(la);
this.rK.logKpiUsage(Hh.a.P9e,0);this.Ppg();if(this.BA){const bb=this.Yh.vim(la.draftId);this.rvl(la.draftId,bb)}}addReply(la,bb){this.rK.logKpiUsage(Hh.a.NHd,0);super.addReply(la,bb)}uva(la){this.BA&&null!=la.Cz&&this.Yh.paj(la.Cz.draftId);super.uva(la);this.Faa.pkb(la.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",yg.a(la));this.rK.logKpiUsage(Hh.a.fHh,0);this.KWk(la);Rc.a.F3o(la,this.sj,this.rK);this.rK.Sv(Zj.a.eHh,{succeeded:!0,customData:{actionType:la.Df?ph.a.reply:
ph.a.create}})}wgb(la){super.wgb(la);this.rK.Sv(Zj.a.eHh,{succeeded:!0,customData:{actionType:ph.a.edit}})}KWk(la){if(la.Df){var bb=this.Yh.Stf(la);if(bb.GGc&&bb.HGc){var qb=this.sj.Eb(ua.a.If(bb.HGc));bb=bb.HGc===bb.GGc?null:this.sj.Eb(ua.a.If(bb.GGc));Rc.a.Lug(qb,la,!0);Rc.a.Lug(bb,la,!1)}}}MLc(la){super.MLc(la);this.Tz&&this.Tz.id===la.id&&(super.clearSelection(),this.BA&&this.tQ.T4b());if(this.BA)if(yg.r(la)){var bb=[];let qb=null;for(const ac of this.model.$O())ac!==la&&(ac.Df===la.Df&&bb.push(ac),
ac.id===la.Df&&(qb=ac));qb&&qb.id&&qb.objectId&&!qb.done&&this.Fo.UG(qb.objectId)&&!this.Fo.J2i(qb.objectId)&&!bb.length&&this.w2c(qb,!0)}else bb=la.Zq===zd.a.beingCreated,la.done||this.w2c(la,!0),bb&&this.Yh.paj(la.Cz.draftId)}editComment(la,bb){1===this.mode&&la&&(this.Yh.VMc(la,bb),ph.a.edit===bb.sessionType&&this.rK.logKpiUsage(Hh.a.kHh,0),this.Sg.dSb&&3!==ph.a.asf(bb.sessionType)&&this.IVb.selectComment(la,Object.assign(new yh.a,{mS:!1,E$:0})))}$fe(la){this.BA&&!this.hj.Am||super.$fe(la)}deleteComment(la){la.Zq!==
zd.a.beingCreated&&this.Fo.LRh(ua.a.If(la.objectId));this.QXa&&this.QXa.id===la.id&&(this.Yh.tt&&this.QXa.id===this.Yh.tt.id?this.QXa=null:this.Bsa.y8e());!this.Yh.tt||this.Yh.tt.id!==la.id&&this.Yh.tt.Df!==la.id?this.Yh.tt&&this.Bsa.KF(0,this.Yh.tt,null):void 0===la.Df||null===la.Df?this.clearSelection():this.Yh.selectComment(this.Yh.$D(la.Df));la.IRa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",yg.a(la));super.deleteComment(la);a.ULS.sendTraceTag(50426377,
327,50,`${yg.a(la)} deleted by user action. DurableId: ${la.H1a}`)}qCb(la,bb){super.qCb(la,bb);this.BA&&!this.hj.Am&&bb&&(this.Yh.tt&&this.Yh.tt.id===la.id&&this.clearSelection(),this.hbc&&this.hbc.id===la.id&&this.Bsa.y8e())}tdo(la=null){(la=this.Fo.MSl(la))?this.IVb.selectComment(la,Object.assign(new yh.a,{mS:!0,E$:1})):this.Wij(1)}Icl(la){var bb,qb=this.isa.rc;if(qb){var ac=la.Pa.node,yc=null===(bb=this.Ang.instance)||void 0===bb?void 0:bb.qHb(ac);if(yc)for(const $c of qb.$Pa(yc))if($c&&$c instanceof
ij.a&&(bb=$c,qb=Ng.a.CNh(bb),this.Ssc.npe=this.BCl(ac,la),yc=this.FRk(qb),null!==yc)){if(la=this.Ssc.sCl(qb,yc))qb.uxa[yc].appendChild(la),bb.hz(la);break}}}BCl(la,bb){let qb;for(const ac of la.mH)if(ac&&ac){qb=ac;break}la=bb.Pa.Wj;bb=!(null===qb||void 0===qb||!qb.ao)&&0<qb.ao.length;return 0>la||!bb||null===qb||void 0===qb||!qb.eop?null:df.a.Q_(la,qb,!1,!1)}FRk(la){var bb;const qb=null===(bb=this.Ssc.npe)||void 0===bb?void 0:bb.y;for(const [ac,yc]of la.M4.entries())if(la=qb-yc.y,-2<=la&&la<yc.height+
2)return ac;return null}X5a(){T.App.bkb=2===this.mode||3===this.mode;1!==this.mode&&this.Ssc.QWd()}ZPo(la,bb,qb){const ac=this.Vb.currentScope;let yc=null;if(bb||qb){bb=la.Pa.cpBegin;la=la.Pa.node;if(this.Tz&&yg.q(this.Tz,la,this.sj,bb))return;yc=this.h6l(la,bb)}yc?!this.BA||this.hj.Am?Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Oij(yc)},pj.a.mdo):this.Oij(yc):!this.Yh.tt||ac&&ac.name===Rd.AFrame.KM||this.clearSelection()}h6l(la,bb){let qb=null;const ac=this.model.$O();for(let yc=ac.length-1;0<=
yc;yc--){const $c=ac[yc];if($c.objectId&&!($c.Df||this.BA&&!this.Oda.isVisible&&$c.done)&&yg.q($c,la,this.sj,bb)){qb=$c;break}}return qb}selectComment(la,bb=1){this.IVb.Pij(la,Object.assign(new yh.a,{mS:1===bb,E$:bb}))}Sij(la,bb){const qb=this.Yh.$D(la);qb?this.BA&&!yg.r(qb)&&qb.Zq!==zd.a.beingCreated&&this.tQ.sUa(la,0,bb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const la=this.model.tt;this.Sg.tva&&this.KE&&la&&this.KE.fireEvent(9,{comment:la});super.clearSelection();
this.Bsa.KF(1,la,la);this.BA&&la&&this.tQ.T4b()}HUm(){var la;return 500>(null===(la=this.iih)||void 0===la?void 0:la.pi)}Sgc(la,bb=1){if(!this.Sg.aSi||!this.Yh.Tx){var qb=this.Yh.$D(la),ac=null;qb||(ac=this.QXa);var yc=this.HUm(),$c=!1;1===bb&&this.Dla&&(yc?$c=!0:this.Dla.highlightComment(la));la?qb?yc?$c=!0:this.Faa.abc(qb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.Faa.abc(null);qb?yc?$c=!0:(this.QXa=qb,this.Bsa.KF(2,qb,ac)):
(this.QXa=null,this.Bsa.KF(3,null,ac));$c&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}SDo(){this.je&&(this.iih=this.je.Yf("UserAction","StartScrollDetectionStopwatch"))}notify(la,bb){this.Xo.sendNotification(la,bb)}Ppg(){this.BHd.onContentChanged()}MBh(la,bb){var qb,ac;switch(la){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.lAo(bb);case "OnContentFilterUpdate":return!(null===(ac=(qb=this.BHd).isContentInFilterUpdateDiff)||
void 0===ac?0:ac.call(qb,bb.id));default:return!0}}lAo(la){return this.Sg.o2k?!la.done&&this.Fo.oia(la)===this.BHd.isContentInFilteredContent(la.id):this.Fo.oia(la)===this.BHd.isContentInFilteredContent(la.id)}static getInstance(){return Oc.fm()}static fm(){Oc.Pg||(Oc.Pg=new Oc(T.App.Xoa(),new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),M.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,M.a.instance.resolve("Common.Comments.ICommentModel"),M.a.instance.resolve("Common.Comments.ICommentPane"),
aj.getInstance(),y.AFrameworkApplication.va,new X.a(()=>Wg.a.instance),nl.FocusManager.instance(),M.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),M.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),M.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),M.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings"),M.a.instance.resolve("Common.Utils.IAriaNotifier"),M.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),
M.a.instance.resolve("WordEditor.Comments.CommentsState"),M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Fh.App.pn.jb.rc,db.StaticActiveAppFrame.za().Kq,M.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),M.a.instance.Sa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),M.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),M.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),M.a.instance.Sa("WordEditor.Extension.RichApiEventManager"),
M.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")),Oc.Pg.RQb=!0);return Oc.Pg}}Oc.Pg=null;Object(e.a)(Oc,"EditorCommentManager",md.a,[764,765,766,10]);var Sg=c(1787);class li{constructor(la,bb,qb,ac){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=la;this.body=bb;this.confirmButton=qb;this.cancelButton=ac}}Object(e.a)(li,"ViewContainerModalDialogStrings",null,[]);c(1508);class de{constructor(la,bb){this.canvasContextId=this.canvasActionId=0;this.withFlags=
!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=la;this.canvasContextId=bb}}Object(e.a)(de,"CommentUIAction",null,[]);var ke=c(1074);class Ti{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf,bf,pl,il){this.ga=la;this.ig=bb;this.ge=qb;this.Vb=ac;this.np=yc;this.Mh=$c;this.J3=Vd;this.Asa=me;this.JAd=Md;this.eYe=Re;this.Ib=We;this.tQ=bg;this.Sg=yf;this.hj=Rf;this.IVb=bf;this.J2=pl;this.Ala=il;this.Xwe=this.gj=null;this.ugh=
this.wLg=!1;this.UBc=null;this.Ixo=(Sk,Vj,Ch)=>2!==Ch||this.hj.IY?1===Ch?32:2:(this.J2.s$("OnCommentInit",Object.assign(new Se.a,{CHa:()=>{this.ga.processAction(Ef.a.OV,2)}})),32);this.Mri=(Sk,Vj,Ch)=>1!==Ch||this.hj.IY?2:8;this.irk=(Sk,Vj,Ch)=>{if(1===Ch)return!this.glb()||this.Yeb?8:this.hj.IY?2:32;if(!this.hj.IY)return this.Yeb=!0,this.J2.s$("OnCommentInit",Object.assign(new Se.a,{CHa:()=>{this.$q||this.hj.Am||this.ga.processAction(Ef.a.OV,2)}})),32;this.$q||this.hj.Am||this.ga.processAction(Ef.a.OV,
2);(this.$q||this.hj.Am)&&this.Vb.mg(this.hj.Am?Rd.AFrame.Sr:Rd.AFrame.KM);return 2};this.Bkl=(Sk,Vj,Ch)=>1===Ch&&eg.SessionStatusManager.instance.Yj?8:2;this.hpl=(Sk,Vj,Ch,Qn)=>1!==Qn||(this.$q||this.isVisible)&&this.gj.model.tt?Sk||this.gj.model.tt?32:8:8;this.mkb=(Sk,Vj,Ch,Qn,zh)=>{if(1===Ch||!this.hj.Am)return 32;if(!this.$q&&2===Ch&&(2===this.gj.mode||3===this.gj.mode))return zh=new li(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,
CommentPaneStrings.DiscardDialogResume),this.JAd.invokeModalConfirmationDialog(()=>{this.xnn(Sk,Vj,Ch,Qn)},()=>{this.Cmn()},zh),32;this.SWd();if(this.$q)return 32;zh&&this.DWh();return 32};this.DOb=(Sk,Vj,Ch,Qn,zh)=>{if(1===Ch)return 32;zh[Si.a.On]=this.isVisible;return 32};this.Nqc=this.x9k()}get isVisible(){return this.hj.Am}get Yeb(){return this.wLg}set Yeb(la){this.wLg=la}get Iro(){return"SharedCommentsTaskPaneProps"}get D3c(){return null}get wRi(){return null}get jF(){return this.np}get Oda(){return null}get l2k(){return this.Asa}get $q(){try{return this.Sg.$q}catch(la){return!1}}uci(){return new xi(y.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}x9k(){const la=new zf.a,bb=new de(Ef.a.yHa,sg.a.frame);bb.preCallback=this.irk;const qb=new de(Zj.a.VTf,sg.a.frame),ac=new de(Zj.a.R2f,sg.a.frame),yc=new de(Zj.a.deleteComment,sg.a.frame);yc.preCallback=this.Bkl;yc.postCallback=this.hpl;this.$q&&(qb.preCallback=this.Mri,ac.preCallback=this.Mri);const $c=new de(Ef.a.OV,sg.a.frame);$c.preCallback=this.Ixo;la.Z(6,$c);la.Z(0,bb);la.Z(1,qb);la.Z(2,
ac);la.Z(3,yc);return la}zpj(la){this.ugh||(this.ymk=this.pUd(),this.J3.dPa(),this.Tqo(),this.Oqo(la),this.ugh=!0)}Oqo(la){this.gj=la;this.Xwe=la.bbc;this.gj.JYh=this.Asa}initialize(la){this.zpj(la);this.Ub()}cCf(){this.UBc&&this.Vb.mg(Rd.AFrame.Sr);this.Yeb&&!this.$q?(this.ga.processAction(Ef.a.yHa,2),this.Yeb=!1):this.hj.ugb&&Yh.a.T3(y.AFrameworkApplication.lc,()=>{const la=this.hj.ugb.commentId,bb=this.hj.ugb.rYc;this.ga.Qb(Zj.a.selectComment,2,Object.assign(new yh.a,{commentId:la,E$:1,mS:!0,xWc:bb}));
bb&&(Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Vb.mg(Rd.AFrame.Sr)},pj.a.Odg),ak.a.instance.pf(xj.a.oQh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.xX);this.hj.ugb=null},pj.a.ldo)}dispose(){}U5(){}selectComment(){this.isVisible||this.$q||this.Ysj();this.Mh.updateCommandUI(!0)}Ub(){this.ga.qa(Ef.a.mkb,sg.a.frame,this.mkb);this.ga.fb(Ef.a.DOb,sg.a.frame,this.DOb,96)}X5a(){-1!==this.gj.mode&&
(this.gj.mode||this.DWh())}DWh(){const la=this.gj,bb=la.Fo,qb=bb.wTd(),ac=bb.Bpf(this.Sg.tRb&&this.Sg.$q&&!this.hj.Am);this.Asa.seo(ac.length,qb,!la.mode,qb?5:1);this.Asa.Teo(ac,bb.NWa)}Tqo(){const la=this.Vb.fe(Rd.AFrame.Sr);la.parent=Rd.AFrame.Ap;la.fI=!0;la.c8c=!0;la.VVa=!0;la.bOa((bb,qb)=>{Jc.a.LBh(qb.name)&&(this.hj.wMb=Yh.a.T3(this.Ib,()=>{qb.name!==Rd.AFrame.KM&&2!==this.gj.mode&&3!==this.gj.mode&&(this.gj.clearSelection(),this.Mh.updateCommandUI(!0));this.hj.wMb=null},pj.a.mnn))});this.np.MT(Rd.AFrame.Sr);
if(this.Sg.CBb)for(const bb of yg.t)la.bindAction(Ld.KeyInputManager.PG(bb),Zj.a.k6e)}ujo(){this.UBc&&this.eYe.fIl()}HDh(){this.R3j&&this.ujo()}xnn(la,bb,qb,ac){const yc=this.gj,$c=yc.Fo.Tx;$c&&$c.Cz?yc.E9e.endCommentSession($c.Cz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.mkb(la,bb,qb,ac,!0);Yh.a.T3(this.Ib,()=>{this.Mh.updateCommandUI(!0)},pj.a.f$n)}Cmn(){this.UBc&&this.Vb.mg(Rd.AFrame.Sr);this.Mh.updateCommandUI(!0)}tIa(la){la.mr(this.Vb.YW);
la.mr(this.Vb.ZW)}kRb(la,bb,qb){if(1===qb)return 32;this.Ysj();return 32}Ysj(){this.isVisible||(this.Sg.Qhb&&(this.hj.dJa=!0),this.hj.IY?(this.gql(),this.hj.Am=!0,this.J2.Sce(),this.Vb.MFc(Rd.AFrame.Sr),this.$q&&this.Sg.tRb&&this.gj.UOb(this.gj.model.epf(()=>!0)),this.R3j=!0,jo.UISurfaces.Pu().then(la=>{la.showTaskPane(To.a.LHd,this.ymk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.gj.Sgc(null),this.Mh.updateCommandUI(!0),this.tIa(this.Vb.fe(Rd.AFrame.Sr)),
this.J2.s$("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.J2.s$("OnCommentInit",Object.assign(new Se.a,{CHa:()=>{this.hj.Am||this.ga.processAction(Ef.a.OV,2)}})))}gql(){this.ga.Qb(Zj.a.r4,2,null);this.ga.Qb(Zj.a.kU,2,null)}glb(){return this.Ala.glb(this.ga,!1)}VAb(){}show(){this.isVisible||this.ga.processAction(Ef.a.OV,2)}editComment(){return 2}SWd(){this.gj.paneClosing();this.hj.Am=!1;if(this.$q&&this.Sg.tRb){const bb=this.gj.model;this.gj.UOb(bb.epf(qb=>
bb.oia(qb)))}var la=nl.FocusManager.instance();la.currentScope&&la.currentScope.name===Rd.AFrame.Sr&&la.mg(this.$q&&(2===this.gj.mode||3===this.gj.mode||this.gj.Kj.tt)?Rd.AFrame.KM:la.iU);this.np.fx(Rd.AFrame.Sr);this.Vb.zLc(Rd.AFrame.Sr);jo.UISurfaces.Pu().then(bb=>{bb.hideTaskPane(To.a.LHd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.$q&&(la=this.gj.model.tt)&&this.TVo(la);this.J2.s$("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,
"New Comment Pane closed.")}TVo(la){la.done?this.gj.clearSelection():this.IVb.FWh(la)}Lvn(la=null){this.eYe.Toj(3);this.cCf();if(la){this.HDh();ek.a.p7f(la,[Ii.a.contextMenu]);const bb=this.Vb.fe(Rd.AFrame.Sr);this.ig.w2b(Rd.AFrame.Sr,la,bb.VVa)}}mtn(la){this.np.aJ(Rd.AFrame.Sr);1!==la&&Yh.a.T3(y.AFrameworkApplication.lc,()=>{this.Vb.jD(Rd.AFrame.Sr)},pj.a.Odg)}onTaskPaneClose(){this.hj.IY&&this.eYe.Toj(1)}pUd(){const la={type:this.Iro,hkp:this.HDh};return Object.assign(new ke.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,
contentProps:la,hideHeader:!1,width:300,location:2,onOpen:bb=>{this.UBc=bb;this.Lvn(bb);this.tQ.ong(!0)},onClose:()=>{this.UBc=null;this.ga.Qb(Ef.a.mkb,2,!0);this.Mh.updateCommandUI(!0);this.onTaskPaneClose();const bb=this.gj.Fo;this.hj.dJa&&bb.mTc()&&this.tQ.ong(!1)},onShow:bb=>{this.mtn(bb)}})}OV(){return 32}}Object(e.a)(Ti,"OfficeSharedCommentPane",null,[10,757,758]);var Uf=c(1697),fk=c(182);class lk{constructor(la,bb){this.containerType="full-pane";this.identifier=null;this.ga=la;this.identifier=
bb}openView(){this.ga.processAction(Ef.a.kRb,2)}closeView(){this.ga.Qb(Ef.a.mkb,2,!0)}invokeModalConfirmationDialog(la,bb,qb){const ac=new fk.StandardDialog;qb&&qb.title&&qb.body&&qb.confirmButton&&qb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),qb=new li("","","",""));ac.Cd=1;ac.ye(1,qb.confirmButton);ac.ye(0,qb.cancelButton);ac.sv(qb.title,qb.body,1,yc=>{1===yc?la():bb()})}}Object(e.a)(lk,"ViewContainerAPI",null,[753,754]);class dj{constructor(la,
bb,qb){this.nNo=la;this.Ch=bb;this.JJa=qb;this.fd=new ma.a;this.nNo.execute(ac=>{this.JJa.Cde("OnBeforeTrackChangeMarkupViewChange",(yc,$c)=>{$c&&$c.KTf!==ac.fk&&this.fd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",$c)});this.JJa.Cde("OnAfterTrackChangeMarkupViewChangeEventKey",(yc,$c)=>{$c&&$c.fk===ac.fk&&(Oi.fk=ac.fk,this.fd.raiseEvent("OnAfterTrackChangeMarkupViewChange",$c))})})}u$(la,bb){this.fd.addHandler(la,bb)}s$(la,bb){this.fd.raiseEvent(la,bb)}Sce(){this.Ch.T5f||(this.Ch.T5f=!0,this.fd.raiseEvent("OnCommentRenderedOnce"))}}
Object(e.a)(dj,"WordCommentEventsActor",null,[]);var ci=c(1843);class Sh{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(Sh,"InitCommentSessionResult",null,[]);class Xg extends Sh{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(Xg,"BeginDraftingHostResult",Sh,[]);var Pe=c(2112),xe=c(2067),pg=c(1060);class jm{constructor(la,bb,qb,ac,yc,$c,Vd,me,Md,Re,We,bg,yf,Rf,bf){this.taskManager=
la;this.Asa=bb;this.jVj=qb;this.yOo=ac;this.M9e=yc;this.Ur=$c;this.zt=Vd;this.focusManager=me;this.L1=Md;this.oc=Re;this.Hk=We;this.Y_=bg;this.Ch=yf;this.P2k=Rf;this.N2k=bf;this.f_b=this.x7=this.Nm=null;this.$Zj="WordWebCommitNewCommentActivity";this.a_j="WordWebCommitTaskActivity";this.XZj="WordWebCommentReactionActivity";this.cQg=null}get Ala(){return this.x7}lHn(la){var bb;const qb=this.Ala.Tx,ac=this.x7.$O();if(ac&&qb){const yc=pg.a.jib(null!==(bb=qb.authorId)&&void 0!==bb?bb:"");bb=new ci.a(qb.authorId,
qb.I3b,qb.author,null!==yc&&void 0!==yc?yc:"",!0);la.author=bb;la.insertIndex=Array.indexOf(ac,qb);la.authorName=qb.author;la.authorIdentity="";return null}return Yh.a.QD(-2130915320)}initialize(la,bb,qb,ac){this.Nm=la;this.x7=bb;this.f_b=qb;this.cQg=ac}beginDraftingAsync(la){if(!la)return new Promise((ac,yc)=>{yc(Yh.a.QD(-2130915327))});const bb=new Xg,qb=ph.a.asf(la.sessionType);return void 0===qb||null===qb?new Promise((ac,yc)=>{yc(Yh.a.QD(-2130915317))}):new Promise((ac,yc)=>{Yh.a.T3(this.taskManager,
()=>{if(1!==this.Nm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Nm.mode),yc(Yh.a.QD(-2130915325));else{this.eDh();try{switch(qb){case 0:if(!this.Nm.Oda.glb()){yc(Yh.a.QD(-2130915326));return}this.P2k.QWd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${la.draftId}`);this.Nm.VAb(la);break;case 1:if(!la.threadId||""===la.threadId){yc(Yh.a.QD(-2130915324));return}if(this.Ur.Eig){const me=this.x7.$D(la.threadId);if(me){const Md=this.x7.D7h(me,
!1),Re=Pe.a.ZFb(me,Md,me.authorId===this.Ur.dZ);Re&&this.M9e.invoke(la.threadId,Re)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Nm.mode)}this.Nm.addReply(la.threadId,la);break;case 3:if(!la.threadId||""===la.threadId){yc(Yh.a.QD(-2130915324));return}var $c=this.x7.$D(la.threadId);if(!$c){yc(Yh.a.QD(-2130915323));return}this.Nm.editComment($c,la);break;case 2:if(!la.commentId||""===la.commentId){yc(Yh.a.QD(-2130915324));return}const Vd=this.x7.$D(la.commentId);
if(!Vd){yc(Yh.a.QD(-2130915323));return}this.Nm.editComment(Vd,la)}}catch(Vd){yc(Vd);this.Bej();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Vd} on Session ${qb}`);return}($c=this.lHn(bb))?yc($c):ac(bb);this.Bej()}},pj.a.beginDraftingAsync)})}commit(la,bb,qb){const ac=this.Ala.Tx;if(!ac)throw Yh.a.QD(-2130915320);var yc=ac.Cz;if(!yc)throw Yh.a.QD(-2130915320);const $c=ph.a.asf(yc.sessionType);if(void 0===$c||null===$c)throw Yh.a.QD(-2130915317);if(la!==yc.draftId)throw Yh.a.QD(-2130915327);
let Vd=!1,me=!1;yc=!1;switch($c){case 3:if(!qb)throw Yh.a.QD(-2130915327);break;case 0:this.Hk.ie(()=>{if(!this.Nm.Oda.glb())throw Yh.a.QD(-2130915326);ac.text=[bb];this.Nm.BA&&!this.Ch.Am?this.Nm.LCn(()=>{this.Nm.uva(ac);this.Nm.tvl(la,ac.id)}):this.Nm.uva(ac);me=qb&&null!=qb.Task;Vd=this.Nm.BA;Yh.a.T3(this.taskManager,()=>{this.Opb(ac.id)},pj.a.Opb)},"WESCA:C:C");break;case 1:this.Hk.ie(()=>{ac.text=[bb];this.Nm.uva(ac);me=qb&&null!=qb.Task;Vd=this.Nm.BA},"WESCA:C:R");break;case 2:this.Hk.ie(()=>
{ac.text=[bb];this.Nm.wgb(ac);this.Y4i(Zj.a.e5m)},"WESCA:C:E");break;default:throw Yh.a.QD(-2130915322);}qb&&(qb.Resolve&&(this.olj(ac,qb.Resolve.isResolved),qb.Resolve.isResolved&&!this.Ch.Am&&this.Nm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),qb.Task&&this.Nm.o3k(ac,qb.Task),qb.Reaction&&(yc=this.Ur.W2k,qb.Reaction.isActive?this.Nm.PBd(ac,qb.Reaction.reactionType):this.Nm.Ode(ac,qb.Reaction.reactionType)));this.Ur.g3k&&me&&this.L1.execute(Md=>Md.logActivity(this.a_j,"CommentsTasksFpsIsEnabled"));
Vd&&this.L1.execute(Md=>{Md.logActivity(this.$Zj,"CommentsFpsIsEnabled")});yc&&this.L1.execute(Md=>{Md.logActivity(this.XZj,"CommentReactionsFpsIsEnabled")});return ac.id}endCommentSession(la){const bb=this.Ala.Tx;if(bb){if(bb.Cz&&bb.Cz.draftId!==la)throw Yh.a.QD(-2130915327);if(bb.Zq===zd.a.beingCreated)this.Nm.deleteComment(bb),!this.Nm.BA||bb.Df||this.Ch.Am||this.focusManager.mg(Rd.AFrame.In);else{if(3!==this.Nm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");
return}bb.Zq=zd.a.normal;bb.pUa=xe.a.succeeded;bb.Cz=null;this.Nm.g7e()}}this.zt&&this.zt.updateCommandUI(!0);this.Ala.wTd()||this.Asa.jqg(1,!this.Nm.mode)}deleteComment(la){(la=this.x7.$D(la))?(this.Nm.deleteComment(la),this.Nm.BA&&!this.Ch.Am?la.Df||this.focusManager.mg(Rd.AFrame.In):this.focusManager.jD(Rd.AFrame.Sr),this.yOo.Ogg(la)&&this.Y4i(Zj.a.NKi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(la){this.Opb(la,0)}highlightComment(la){this.Nm.Sgc(la,
0)}setThreadResolvedState(la,bb){(la=this.x7.$D(la))&&this.olj(la,bb)}olj(la,bb){if(la.Df&&""!==la.Df)throw Yh.a.QD(-2130915321);this.Nm.qCb(la,bb);bb&&!this.Ch.Am&&this.focusManager.mg(Rd.AFrame.In)}presentLinkToComment(la){var bb=this.x7.$D(la);bb?(bb=this.Ala.KRd(bb))?(la={["nav"]:btoa(`{"${ep.a.comment}":${bb}}`),["mode"]:"copy"},this.N2k.Sv(Zj.a.presentLinkToComment),this.oc.Qb(Ef.a.U8,2,la,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",
la):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",la)}selectFirstThreadInNextCommentContext(){this.Nm.Wij(0)}selectLastThreadInPreviousCommentContext(){this.Nm.udo()}registerForCommentEvents(la){const bb=this.Ala.Bpf(this.Ur.tRb&&this.Ur.$q&&!this.Ch.Am),qb=this.Ala.NWa,ac=this.Ala.wTd(),yc=!this.Nm.mode;this.Asa.Jno();this.cQg.x5l().then($c=>{this.Asa.vXn(la,bb,ac,yc,qb,$c);this.Asa.jqg(ac?5:1,yc);this.zt&&this.zt.updateCommandUI(!0)})}unregisterForCommentEvents(la){this.Asa.OSb(la)}registerForAction(la,
bb){this.jVj.PTa(la,bb)}unregisterForAction(){}checkAtMentionCapability(){return this.f_b?this.f_b.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(la=>{la(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}eDh(){const la=this.Nm.BA&&!this.Ch.Am?Rd.AFrame.KM:Rd.AFrame.Sr;if(la===Rd.AFrame.Sr){if(!this.Ch.Am)return;jo.UISurfaces.Pu().then(bb=>
{bb.setSelectedTaskPane(To.a.LHd);return null})}this.focusManager.jD(la)}Opb(la,bb=1){this.eDh();this.Y_.Pij(la,Object.assign(new yh.a,{E$:bb,mS:1===bb}))}Bej(){this.Nm.Oda.Yeb&&(this.Nm.Oda.Yeb=!1)}Y4i(la){this.oc.processAction(la,2)}}Object(e.a)(jm,"WordEditorSharedCommentAPI",null,[755,756]);class vg{constructor(la,bb,qb,ac,yc,$c,Vd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=la;this.parentId=bb;
this.commentBody=qb;this.author=ac;this.date=yc;this.commentFlags=$c;this.usersByReactionType=Vd}}Object(e.a)(vg,"OfficeSharedCommentModel",null,[]);c(1679);class mh{constructor(la,bb){this.Ca=la;this.QKb=bb;this.ioh="AD";this.Rsc=new Q.a;this.QXe=new Q.a;this.ZIk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.$Pg=new Rh.a}get userPrincipalName(){return this.Ca.kb("UserPrincipalName")}get P6a(){return this.Ca.kb("PresenceProvider")}get dZ(){return this.Ca.kb("PresenceUserId")}get sj(){return this.QKb.value}nSi(la){const bb=
this.ZIk.exec(la);return bb?bb[1]:la}Ehi(la,bb=!1){let qb=0;la.done&&(qb=la.Df&&""!==la.Df?qb|4:qb|8);la.uJh&&(qb|=2);bb&&(qb|=1);this.Ogg(la)&&(qb|=16);la.TGf&&(qb|=32);this.wtm(la)||(qb|=128);return qb}wtm(la){return la?(la=this.sj.Eb(la.objectId))?la.hasProperty(sa.a.VQ):!1:!1}Ogg(la){if(!la)return!1;if(void 0===la.authorId||null===la.authorId||""===la.authorId)return this.UNf(la.id,la.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.dZ||null===this.dZ||""===this.dZ)return this.UNf(la.id,
la.objectId,"PresenceUserId null or empty"),!1;if(this.dZ==la.authorId&&la.I3b==this.P6a)return!1;const bb=this.fOd(la.authorId),qb=this.fOd(this.dZ);if(this.P6a===this.ioh&&bb&&qb&&bb[0]!=this.userPrincipalName&&bb[1]!=qb[1])return!0;this.UNf(la.id,la.objectId,"Unknown");return!1}isCurrentUser(la){if(!la||void 0===la.authorId||null===la.authorId||""===la.authorId||void 0===this.dZ||null===this.dZ||""===this.dZ)return!1;if(this.dZ==la.authorId&&la.I3b==this.P6a)return!0;la=this.fOd(la.authorId);const bb=
this.fOd(this.dZ);return this.P6a===this.ioh&&la&&bb?la[0]==this.userPrincipalName||la[1]==bb[1]:!1}fOd(la){if(void 0===la||null===la)return null;la=la.split("::");return 3===la.length?la.slice(1,3):null}UNf(la,bb,qb){la&&!this.$Pg.contains(la)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${bb}; reason: ${qb}`),this.$Pg.add(la))}E3h(la,bb){var qb;if(!la)return null;const ac=la.Y0d;let yc=!1;1===bb&&(yc=!0);bb=la.author?this.nSi(la.author):"";const $c=pg.a.jib(null!==
(qb=la.authorId)&&void 0!==qb?qb:"");qb=new ci.a(la.authorId?la.authorId:"",la.I3b,bb,null!==$c&&void 0!==$c?$c:"",this.isCurrentUser(la));return new vg(la.id?la.id:"",la.Df?la.Df:"",la.text&&la.text.length?la.text[0]:null,qb,la.date||ac?la.date:new Date,this.Ehi(la,yc),this.Ghi(la.usersByReactionType))}yKl(la,bb,qb){const ac=[],yc=new Q.a;if(!la)return ac;for(const $c of la)$c.Zq!==zd.a.beingCreated&&qb($c)&&($c.id&&this.Rsc.nb($c.id)?(la=this.Rsc.J($c.id),la=this.$cl($c,la,bb),ac.push(la),yc.Z($c.id,
la)):$c.id?(la=this.E3h($c,bb),ac.push(la),yc.Z($c.id,la)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.Rsc=yc;return ac}PQl(la,bb,qb){const ac=[];for(const yc of la)yc.Zq!==zd.a.beingCreated&&qb(yc)&&(yc.id&&this.Rsc.nb(yc.id)?ac.push(this.Rsc.J(yc.id)):yc.id&&ac.push(this.E3h(yc,bb)));return ac}$cl(la,bb,qb){var ac=la.Y0d,yc=1===qb;qb=la.Df?la.Df:"";const $c=la.text&&la.text.length?la.text[0]:null,Vd=la.author?this.nSi(la.author):"",me=la.authorId?la.authorId:"",Md=la.I3b?
la.I3b:"",Re=pg.a.jib(me);ac=la.date||ac?la.date:new Date;yc=this.Ehi(la,yc);const We=this.isCurrentUser(la),bg=this.Ghi(la.usersByReactionType);return bb.parentId===qb&&bb.commentBody===$c&&bb.author.DisplayName===Vd&&bb.author.UserId===me&&bb.author.Provider===Md&&bb.author.IsCurrentUser===We&&bb.date===ac&&bb.commentFlags===yc&&this.CHk(bb.usersByReactionType,bg)?bb:(bb=new ci.a(me,Md,Vd,null!==Re&&void 0!==Re?Re:"",We),new vg(la.id,qb,$c,bb,ac,yc,bg))}CHk(la,bb){if(!la&&!bb)return!0;if(!bb||!la)return!1;
var qb=Object.keys(la);if(qb.length!==Object.keys(bb).length)return!1;for(const ac of qb){if(!(ac in bb))return!1;qb=la[ac];const yc=bb[ac];if(qb.length!==yc.length)return!1;for(let $c=0;$c<qb.length;$c++)if(!this.qHk(qb[$c],yc[$c]))return!1}return!0}qHk(la,bb){return la||bb?la&&bb&&la.UserId===bb.UserId&&la.Provider===bb.Provider&&la.Email===bb.Email&&la.DisplayName===bb.DisplayName&&la.IsCurrentUser===bb.IsCurrentUser?!0:!1:!0}Ghi(la){if(!la)return null;const bb={},qb=this.Ca.kb("PresenceUserId");
for(const yc of Object.keys(la)){const $c=[];var ac=la[yc];for(const Vd of ac){ac=Vd.UserId===qb;let me;this.QXe.nb(Vd.UserId)?(me=this.QXe.J(Vd.UserId),me.IsCurrentUser=ac):(me=new ci.a(Vd.UserId,Vd.Provider,Vd.DisplayName,Vd.Email,ac),this.QXe.add(Vd.UserId,me));$c.push(me)}bb[yc]=$c}return bb}}Object(e.a)(mh,"WordEditorSharedCommentModelTranslator",null,[752]);class Nl{constructor(){this.Jp=null;this.whd=this.Wbh=this.zMg=this.hjh=this.cmh=this.E8g=this.Ydh=!1}Fhi(){this.Jp||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Znj());return this.Jp}x5l(){return new Promise((la,bb)=>{this.whd?la(this.Vci()):this.Okj().then(()=>{la(this.Vci())}).catch(qb=>{bb(qb)})})}Vci(){this.whd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let la;la=33;this.zMg&&(la|=2);this.Ydh&&(la|=8);this.cmh&&(la|=16);this.E8g&&(la|=4);this.hjh&&
(la|=64);this.Wbh&&(la|=128);return la}}Object(e.a)(Nl,"OfficeSharedCommentsAppCapabilities",null,[1099]);class sn extends Nl{constructor(la){super();this.XYa=null;this.Sg=la;this.Voo();this.Znj()}Voo(){this.hjh=this.Sg.dSb;this.cmh=!1;this.Wbh=this.E8g=this.Ydh=!0}initialize(la){this.XYa=la;this.Okj()}Znj(){this.Jp={};this.Jp.LivePersonaPicker="true";this.Jp.PersonaColor="true";this.Jp.DiscreteHostedComments=this.Sg.Ipl.toString();this.Jp.NewCommentButton="true";this.Jp.DisabledChangeGates=this.Sg.Apl;
this.Jp.CommentsFluentUI="true";this.Jp.CommentTasks=this.Sg.dSb.toString();this.Jp.CommentTasksFromReply=this.Jp.CommentTasks;this.Jp.CommentFriendlyTimestamps=this.Sg.p2k.toString();this.Jp.AtMentionFloodgateSurvey=this.Sg.xIk.toString();this.Jp.HyperlinksInComments="true";this.Jp.LogDraftCommentIdPair="true";this.Jp.RichTextFormattingInWeb=this.Sg.CBb.toString();this.Jp.RichContentEditIntegration="true";this.Jp.HyperlinksWithDisplayText="true";this.Jp.SmartReplies=this.Sg.Eig.toString();this.Jp.LinkToComment=
"true";this.Jp.TaskPaneWithNewInfrastructure="true";this.Jp.CommentReactions="true";this.Jp.WebThemeIntegration="true";this.Jp.NewSelectionInteractions="true";this.Jp.HighlightsAndFontColorInWebComments="true";this.Jp.TruncationUIWithReadMoreText="true";this.Jp.CtrlEnterTip="true";this.Jp.AtMentionHintMessage="true";this.Jp.LivePersonaCardForWeb="true";this.Jp.TaskHistoryRecordIDs=this.Sg.$Io.toString();this.Jp.ContentNavigation=this.Sg.contentNavigationApiEnabled.toString()}Okj(){return new Promise((la,
bb)=>{this.XYa?this.XYa.atMentionsEnabledAsync().then(qb=>{this.zMg=qb;this.whd=!0;la(this.whd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),bb(Yh.a.QD(-2130915320)))})}}Object(e.a)(sn,"WordSharedCommentsAppCapabilities",Nl,[662]);class bn{constructor(){this._initialized=!1;this.f3k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Hh.a.Ikf,vetoPillar:7};
this.gJo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:Uf.a.Ikf,vetoPillar:7}}get z6a(){return null!=this.CFg?this.CFg:this.CFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}E_(la){this.z6a.E_(Uh.a.comments,la,!0)}get name(){return"WordEditor.Comments"}wc(la){this.W=la;this.E_("CPConfigStart");la.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Lh.a(n.Health.instance,new je.a,this.f3k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();la.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",
()=>new Lh.a(n.Health.instance,new je.a,this.gJo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();la.ia("WordEditor.Comments.CommentNodeTracker",()=>new If(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();la.ia("WordEditor.Comments.CommentsSettings",()=>new Xi(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc),new X.a(()=>oh.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();la.ia("WordEditor.Comments.CommentsState",()=>new Oi).ha();la.ia("WordEditor.Comments.WordCommentEventsActor",()=>new dj(la.Sa("Box4.TrackChange.ITrackChangeManager"),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();la.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new mh(y.AFrameworkApplication.K,new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();
la.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new gc(la.resolve("WordEditor.Comments.CommentsSettings"),la.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();la.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new qp(y.AFrameworkApplication.lc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();la.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>new ge(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();
la.ia("WordEditor.Comments.EditorCommentModel",Sg.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();la.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new Ih(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc),new X.a(()=>oh.a.instance),la.resolve("WordEditor.Comments.IEditorCommentModel"),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("WordEditor.Comments.CommentsSettings"),la.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));la.ia("WordEditor.Comments.ICommentFilterActor",()=>new qd(la.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,la.resolve("WordEditor.Comments.WordCommentEventsActor"))).ha();la.resolve("WordEditor.Comments.ICommentFilterActor");la.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new wi(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("WordEditor.Comments.IEditorCommentModel"),
la.resolve("WordEditor.Comments.WordCommentEventsActor"),la.resolve("Box4.INotebookManager").Al,S.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),la.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();la.ia("WordEditor.Comments.CommentHighlightUtils",()=>new Qe(la.resolve("Box4.Highlight.IHighlightManager"))).ha();la.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Bc(la.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();
la.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new Nn(la.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),la.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ta.X1,y.AFrameworkApplication.ta.DJa,y.AFrameworkApplication.va,y.AFrameworkApplication.lc,la.resolve("WordEditor.Comments.CommentsState"),la.Sa("WordEditor.Comments.IEditorCommentManager"))).ha();la.ia("WordEditor.Comments.CommentHighlightActor",()=>new Kc(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),
la.resolve("WordEditor.CommentsInteractive.ICommentEditor"),la.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),la.Sa("WordEditor.Comments.IEditorCommentManager"),S.a.instance,la.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),la.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),la.resolve("WordEditor.Comments.CommentHighlightUtils"),la.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();la.ia("WordEditor.Comments.CommentHintActor",
()=>new gl(la.resolve("WordEditor.Comments.CommentsSettings"),Hi.a.instance,Gk.a.instance,Xn.a.instance,y.AFrameworkApplication.va,vi.TableCellReader.pQm,jg.moveToLastRenderedCellOfTheRow,new Ml.a,la.Sa("Box4.ContentControlConfigSettings"),la.resolve("WordEditor.Comments.IEditorCommentModel"),la.resolve("WordEditor.Comments.ICommentHighlightActor"),la.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();
la.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Pd(Hi.a.instance,Xn.a.instance,y.AFrameworkApplication.va,la.resolve("WordEditor.Comments.ICommentHintActor"),la.Sa("Common.IZoomManager"),la.resolve("WordEditor.Comments.CommentsSettings"))).ha();la.ia("WordEditor.Comments.ViewContainerAPI",()=>new lk(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();la.ia("Common.Comments.CommentActivationManager",()=>new jk).as("Common.Comments.ICommentActivationManager").ha();
la.ia("Common.Comments.ViewContainerEventHost",()=>new Hd(y.AFrameworkApplication.lc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();la.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new Dl(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();
la.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new sn(la.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.E_("CPConfigEnd")}init(){this.E_("CPInitStart");this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{try{this.xn(),this.E_("CPInitEnd")}catch(la){throw a.ULS.Vz(524300632,327,10,la,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",la),this.z6a.Hx(Uh.a.comments,
"CPInitException",la,!0),la;}})}xn(){const la=this.W.resolve("WordEditor.Comments.CommentsSettings");this.E_("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new Ti(y.AFrameworkApplication.va,y.AFrameworkApplication.ta.nD,y.AFrameworkApplication.ta.oD,y.AFrameworkApplication.ta.Hp,y.AFrameworkApplication.ta.xx,db.StaticActiveAppFrame.za(),kk.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.W.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),la,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",
()=>new ee(y.AFrameworkApplication.va,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").Nqc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new jm(y.AFrameworkApplication.lc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
la,db.StaticActiveAppFrame.za(),y.AFrameworkApplication.ta.Hp,this.W.Sa("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,S.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();md.a.factory=Oc.getInstance;this.W.ia("WordEditor.Comments.EditorCommentManager",
Oc.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",()=>new kb(this.W.resolve("WordEditor.Comments.CommentsState"),la,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${am.AppFrame.oKa} .${Wh.a.N6b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ta.Hp)).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const bb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),qb=bb.trackChangeInSidetrackEnabled;qb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").Y9i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ia("WordEditor.Comments.FloatingCommentManager",
()=>new gg(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,S.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),bb)).ha();this.W.ia("WordEditor.Comments.IFloatingCommentManager",()=>qb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):
this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new fq(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),aj.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ta.Hp,this.W.resolve("WordEditor.Comments.CommentsState"),
la,new X.a(()=>Wg.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Sa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.W.ia("WordEditor.Comments.CommentInitActor",()=>new ye(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),la,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),aj.getInstance(),db.StaticActiveAppFrame.za().Kq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.Sa("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ta.Hp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Sa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Sa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),
this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),bb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.W.ia("WordEditor.Comments.CommentsActionManager",()=>new hj(this.W.resolve("WordEditor.Comments.EditorCommentManager"),
this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),la,this.W.resolve("Common.Comments.ICommentPane"),new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc.xd),y.AFrameworkApplication.va,new X.a(()=>Wg.a.instance),
nl.FocusManager.instance(),S.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").ha();this.W.resolve("WordEditor.Comments.CommentInitActor");la.contentNavigationApiEnabled&&(this.W.ia("WordEditor.Comments.CommentContentProvider",()=>new Me(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.W.ia("WordEditor.Comments.CommentContentActor",()=>new Ho(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).ha(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const ac=la.$q,yc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");yc&&ac&&
(this.W.resolve("WordEditor.Comments.CommentsState").Teb=bn.i6h(),la.$Db||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit"));Rc.a.t7m();la.Fac&&db.StaticActiveAppFrame.za().jb.wXh();md.a.instance&&(la.$Db||gf.a.get_instance().pk(4,()=>{this.nnn(ac)},11).continueWith(()=>{this.dBm()}),this._initialized=!0);this.BVn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dBm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit")}nnn(la){la||
this.Qmm()}Qmm(){const la=bn.i6h();la&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.xX),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit",Object.assign(new Se.a,{CHa:()=>{md.a.instance.Oda.isVisible||y.AFrameworkApplication.va.processAction(Ef.a.OV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").Mij(la,Object.assign(new yh.a,{Sgg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Sv(Ef.a.H9e))}BVn(la,
bb,qb){la&&la.execute(ac=>{ac.tV(new Lc.a(bb,qb))})}dispose(){this._initialized&&(md.a.instance&&md.a.instance.dispose(),this._initialized=!1)}static i6h(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(e.a)(bn,"PackageManager",null,[1,2]);const Ol=la=>{const bb=M.a.instance.Sa("Box4.IPackageBootPerfLogger"),qb=window.performance.now();bb.execute(ac=>{ac.Hx(Uh.a.comments,"CPMain",qb,!0)});z.a.instance.Gc(new bn,0,la)};var Dm=c(1989);class sc{isComment(la){return Mf.a.isComment(la)}IZd(la){return Mf.a.IZd(la)}kEf(la){return Mf.a.kEf(la)}uWf(la,
bb){Mf.a.uWf(la,bb)}yWf(la,bb){Mf.a.yWf(la,bb)}Qbf(la){return Mf.a.Qbf(la)}Z5a(la){return oh.a.instance.Z5a(la)}deleteComment(la,bb){Mf.a.deleteComment(la,bb)}aLd(la,bb){Mf.a.aLd(la,bb)}opb(la){Mf.a.opb(la)}uca(la,bb,qb){return Mf.a.uca(la,bb,qb)}Gwa(la,bb,qb){return Mf.a.Gwa(la,bb,qb)}bac(la,bb){return Mf.a.bac(la,bb)}fQc(la,bb,qb,ac=null){return Mf.a.fQc(la,bb,qb,ac)}u2b(la,bb,qb,ac){Mf.a.u2b(la,bb,qb,ac)}OBd(la,bb,qb,ac){return Mf.a.OBd(la,bb,qb,ac)}get hJb(){return Mf.a.hJb}set hJb(la){Mf.a.hJb=
la}RMb(la,bb){Mf.a.RMb(la,bb)}R6c(la){Mf.a.R6c(la)}f8f(la){Mf.a.f8f(la)}MTd(la,bb){return Mf.a.MTd(la,bb)}vWf(la,bb){Mf.a.vWf(la,bb)}xWf(la,bb){Mf.a.xWf(la,bb)}l7d(la,bb,qb,ac,yc,$c){Mf.a.l7d(la,bb,qb,ac,yc,$c)}Xif(la,bb){Mf.a.Xif(la,bb)}M4c(la,bb,qb,ac){return Mf.a.M4c(la,bb,qb,ac)}R4c(la,bb,qb,ac){return Mf.a.R4c(la,bb,qb,ac)}}Object(e.a)(sc,"CommentEditorProxy",null,[663]);class Hm{constructor(){this.W=null}get XRb(){return null!=this.bIg?this.bIg:this.bIg=(()=>this.W.Sa("WordEditor.ITableEditor"))()}get z6a(){return null!=
this.DFg?this.DFg:this.DFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}E_(la){this.z6a.E_(Uh.a.comments,la,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(la){this.W=la;this.E_("CIPConfigStart");la.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new sc).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.E_("CIPConfigEnd")}init(){this.E_("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn();this.E_("CIPInitEnd")})}xn(){this.Qvm()}dispose(){}Qvm(){Le.a.QTa(Mf.a.yWf);
Dm.a.F0e(Mf.a.vWf);Dm.a.BCd(Mf.a.xWf);Dm.a.gyk(Mf.a.knn);this.XRb.execute(bb=>{bb.G0e(Mf.a.RMb)});const la=T.App.li.Al;la.Te(39).qo(Mf.a.uWf);Dm.a.nxk(Mf.a.pmn);Dm.a.exk(Mf.a.yln);Td.a.isEnabled&&la.Te(12).kw(Mf.a.oRj)}}Object(e.a)(Hm,"PackageManager",null,[1,2]);const Rm=la=>{const bb=M.a.instance.Sa("Box4.IPackageBootPerfLogger"),qb=window.performance.now();bb.execute(ac=>{ac.Hx(Uh.a.comments,"CIPMain",qb,!0)});z.a.instance.Gc(new Hm,0,la)};var hn=c(2110),km=c(178),On=c(1696);class Ad{constructor(la,
bb,qb,ac,yc,$c,Vd){this.LNa=la;this.sba=bb;this.L7=qb;this.Yc=ac;this.d5j=yc;this.$Le=$c;this.exb=Vd;On.a.fyk((me,Md)=>{this.cwk(Md.graphNode,Md.Z1k)});On.a.Myk((me,Md)=>{this.P8k(Md.graphNode,Md.T_k)})}LSd(){var la=this.d5j();const bb=this.Yc.Dk();bb.set(la);if(this.sba.xRo(bb))return bb;bb.set(la);km.PageNavigator.instance.GP(bb);la=this.L7.Pfl(bb.currentNode);bb.Bj(la);return bb}cVd(la){const bb=this.LSd();let qb=null;this.sba.PPd(bb,ac=>{this.L7.cji(ac)===la&&(qb=ac);return!qb});return qb}Zii(la){const bb=
this.LSd();let qb=null;this.sba.PPd(bb,ac=>{this.L7.gac(ac)===la&&(qb=ac);return!qb});return qb}rLi(la,bb,qb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",la,bb,qb)}dji(){const la=this.LSd(),bb=[];this.sba.PPd(la,qb=>{bb.push(this.L7.cji(qb));return!0});return bb}Ugb(la,bb){if(!bb.length)return this.exb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const qb=this.LSd(),ac=
qn.a.create().toString(),yc=new oi.a;for(let $c of bb)yc.add($c),this.rLi($c.type,ac,$c.completion);bb=this.LNa.Pcg(yc);this.L7.Ugb(qb.currentNode,ac,la,bb);this.$Le();return ac}ff(la){(la=this.cVd(la))?(this.L7.ff(la),this.$Le()):this.exb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}gac(la){la=this.cVd(la);return la?this.L7.gac(la):(this.exb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}$ii(la){return this.L7.gac(la)}bji(la){la=
this.cVd(la);if(!la)return this.exb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;la=this.L7.Wuf(la);return this.LNa.W6b(la).toArray()}DEk(la,bb){if(!bb.length)return this.exb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const qb=this.cVd(la);if(!qb)return this.exb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const ac=this.L7.Wuf(qb),yc=this.LNa.W6b(ac);
for(let $c of bb)yc.add($c),this.rLi($c.type,la,$c.completion);la=this.LNa.Pcg(yc);la!==ac&&(this.L7.voo(qb,la),this.$Le());return!0}cwk(la,bb){if(bb=this.Zii(bb)){const qb=this.Yc.Dk();qb.set(la);this.L7.Wb(bb.clone(),this.L7.iyl(bb,qb))}}N8i(la,bb,qb){if(bb.nb(la))return bb.J(la);const ac=qn.a.create().toString();bb.add(la,ac);qb&&this.exb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return ac}P8k(la,bb){const qb=new Eh.a;var ac=
this.Yc.Dk();ac.set(la);ac.Tb(38)&&this.sba.PPd(ac,yc=>{const $c=this.L7.gac(yc);void 0!==$c&&null!==$c&&qb.add($c,yc);return!0});for(let yc of bb)if(la=null,({value:la}=qb.Fc(yc.key,la)).returnValue)if(yc.value===yc.key)la=this.Zii(yc.key),this.L7.ipo(la,parseInt(yc.key));else{la=this.L7.Wuf(la);if(!la||""===la){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}la=this.LNa.W6b(la);ac=new xb.a;for(let $c=0;$c<la.length;$c++){if(la.J($c).commentId){const Vd=
Number.parseInvariant(la.J($c).commentId);bb.nb(Vd)?la.J($c).commentId=bb.J(Vd).toString():la.J($c).commentId=null}la.J($c).recordId=this.N8i(la.J($c).recordId,ac,!1);-1===la.J($c).type&&(la.J($c).undoId=this.N8i(la.J($c).undoId,ac,!0))}this.Ugb(yc.value,la.toArray())}}static Wr(){return new Ad(M.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),M.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new Ml.a,()=>db.StaticActiveAppFrame.za().jb.Zc,
()=>{M.a.instance.Sa("Common.Interface.IEditNotificationManager").execute(la=>{la.editHappened()})},!0)}}Object(e.a)(Ad,"TaskActor",null,[666]);var Jo=c(1139);class oq{create(){return new Jo.a}}Object(e.a)(oq,"TaskContentNodeFactory",null,[380]);var lm=c(1082);class Ko{create(){return new lm.a}}Object(e.a)(Ko,"TaskNodeFactory",null,[380]);class zc{constructor(la,bb,qb,ac,yc,$c){this.sba=la;this.Lc=bb;this.Yc=qb;this.tmk=ac;this.wmk=yc;this.YUb=$c}oel(la,bb,qb){const ac=this.wmk.create(1074135162);
ac.setValue(sa.a.taskId,la);ac.setValue(sa.a.aSb,bb);ac.setValue(sa.a.cAa,qb);return ac}iac(la){const bb=this.Lc.Pc(4);bb.Db(la);this.YUb();return bb}cji(la){return this.sba.kKb(la)?la.getValue(sa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}gac(la){return this.sba.kKb(la)?la.hasProperty(sa.a.aSb)?la.getValue(sa.a.aSb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Wuf(la){return this.sba.kKb(la)?la.getValue(sa.a.cAa):(a.ULS.sendTraceTag(42812049,
3003,10,"Unexpected node type"),null)}Pfl(la){if(7!==la.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const bb=this.iac(la);try{const qb=this.tmk.create(1074135161),ac=this.Yc.Dk();ac.set(la);ac.Q3(qb,38,zc.WIo);return qb}finally{bb&&bb.dispose()}}Ugb(la,bb,qb,ac){if(!this.sba.SIf(la))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const yc=this.iac(la);try{const $c=this.oel(bb,qb,ac),Vd=this.Yc.Dk();Vd.set(la);Vd.Q3($c,1,new ua.a(qn.a.Iva(qb.toString()),
1));return $c}finally{yc&&yc.dispose()}}ff(la){if(this.sba.kKb(la))if(la.anchor&&la.anchor.Vp){var bb=la.anchor.Vp.us.node;if(this.sba.SIf(bb)){var qb=this.iac(bb);try{const ac=this.Yc.Dk();ac.set(bb);ac.Bj(la.anchor.node);ac.tg()}finally{qb&&qb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}voo(la,bb){if(this.sba.kKb(la)){var qb=
this.iac(la);try{la.setValue(sa.a.cAa,bb)}finally{qb&&qb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}ipo(la,bb){if(this.sba.kKb(la)){var qb=this.iac(la);try{const ac=la.hasProperty(sa.a.aSb)?la.getValue(sa.a.aSb):null;void 0===ac||null===ac||ac===bb?la.Gg(sa.a.aSb,bb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{qb&&qb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}iyl(la,bb){if(!bb.Jt(38)){const qb=this.Yc.Dk();
qb.set(la);qb.zb(71);qb.jd(71);la=zb.b(qb.currentNode,la.Zi().Mc,!0);bb.Bf(la,38)}return bb.Tb(38)}Wb(la,bb){if(this.sba.SIf(bb)){var qb=this.iac(bb);try{const ac=this.Yc.Dk();ac.set(bb);ac.Bf(la,1)}finally{qb&&qb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Wr(){return new zc(M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Cg.a,new Ml.a,new oq,new Ko,()=>{Fh.App.pn.jb.Zc.rF.f8(10)})}}zc.WIo=new ua.a(qn.a.If("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(zc,"TaskEditor",null,[665]);class Fn{constructor(la,bb){this.Dx=la;this.$xb=bb}kKb(la){return!!la&&72===la.type}MWm(la){return!!la&&71===la.Xe}SIf(la){return!!la&&71===la.type}xRo(la){la.set(this.Dx.value);this.$xb.GP(la);return!!la.Tb(38)}PPd(la,bb){if(la&&bb)if(this.MWm(la))for(var qb=!0,ac=la.Tb(1);qb&&ac;)this.kKb(ac)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",ac.type),qb=bb(ac),ac=la.Lf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
la.Xe);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Wr(){return new Fn(new X.a(()=>db.StaticActiveAppFrame.za().jb.Zc),km.PageNavigator.instance)}}Object(e.a)(Fn,"TaskNavigator",null,[664]);class jd{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}dispose(){}wc(la){this.W=la;la.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new hn.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();
la.ia("WordEditor.Tasks.TaskNavigator",()=>Fn.Wr()).as("WordEditor.Tasks.ITaskNavigator").ha();la.ia("WordEditor.Tasks.TaskEditor",()=>zc.Wr()).as("WordEditor.Tasks.ITaskEditor").ha();la.ia("WordEditor.Tasks.TaskActor",()=>Ad.Wr()).as("WordEditor.Tasks.ITaskActor").ha()}xn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(115)}}Object(e.a)(jd,"TasksPackage",null,[1,2]);var Em=c(79),Pl=c(1693),Sp=c(402),vl=c(94);class fp{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(fp,"TaskPaneGroupAppProps",null,[]);var to=c(187);class cn{static t3k(la,bb){nl.FocusManager.nK()&&(Gk.a.instance.iDa(la,bb,!1),to.a.instance.iDa(la,bb,!1),y.AFrameworkApplication.ta.xx.MT(la))}}Object(e.a)(cn,"ReactTaskPaneManagerUtils",null,[]);var Pk=c(144),zq=c(337);class Qk{constructor(){this.type=null}}Object(e.a)(Qk,
"SampleTaskPaneProps",null,[]);var kh=c(1694);class bm{constructor(){this.entry=null;this.show=!1}}Object(e.a)(bm,"AnimationBatchEntry",null,[]);var mm=c(298),Df=c(1155),Ym=c(129);class jn{constructor(){this.Iah=[];this.Jah=[];this.Kma={};this.aLa=this.$Ka=null;this.czd=!1;this.h_=null;this.jwd=this.frd=0;this.grc=[];this.oHe=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Kb.Nlb;this.Rw=!1}initialize(){this.czd=!1;(this.Rw=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Kb.uL)&&
this.Dcf()}Fcf(la,bb,qb,ac){bb=this.eVd(bb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.Dcf();const yc=document.createElement("div");yc.id=bb;yc.className=jn.I4o;yc.style.width="0";this.oHe||(this.Xsk(qb,bb,yc),this.Kma[bb]=la.Fcf(bb,qb,ac,yc));return yc}Dcf(){this.czd||this.iro()}Xsk(la,bb,qb){let ac=null,yc=null;0===la?(ac=this.$Ka,yc=this.Iah):1===la&&(ac=this.aLa,yc=this.Jah);if(ac){la=!1;for(let $c=0;$c<yc.length;$c++)if(!la)yc[$c]===bb&&(la=!0);else if(yc[$c]in this.Kma){this.BFm(ac,
qb,this.Kma[yc[$c]]);return}ac.appendChild(qb)}}BFm(la,bb,qb){la.insertBefore(bb,qb.element)}Tql(la){la=this.eVd(la);if(la in this.Kma){const bb=this.Kma[la];bb.element.parentNode.removeChild(bb.element);delete this.Kma[la]}}Gtj(la){la=this.eVd(la);la in this.Kma&&(la=this.Kma[la])&&!la.isVisible&&(this.Osj(la,!0),this.msh(la.position,!0,this.cBh(la,!0)),1===la.position&&1<H.a.count(this.Kma)&&this.g9m())}kvm(la){la=this.eVd(la);la in this.Kma&&(la=this.Kma[la])&&la.isVisible&&(this.Osj(la,!1),this.msh(la.position,
!1,this.cBh(la,!1)))}k6b(la){if(this.h_)return this.h_;const bb=document.createElement("div");document.body.appendChild(bb);bb&&(this.h_=new Pl.a(bb,la));return this.h_}Osj(la,bb){la.element&&(la.isVisible=bb,this.grc.push(Object.assign(new bm,{entry:la,show:bb})));0===la.position?this.frd+=bb?1:-1:this.jwd+=bb?1:-1;1===this.grc.length&&window.setTimeout(Object(Ie.a)(this,this.MDo,"startPaneAnimation"),0);this.Rw&&la.element&&la.element.parentNode&&(0===la.position&&!this.frd||1===la.position&&!this.jwd?
(la.element.parentNode.style.minHeight="0px",la.element.parentNode.style.height="0px",la.element.parentNode.style.overflow="hidden"):(la.element.parentNode.style.minHeight="",la.element.parentNode.style.height="",la.element.parentNode.style.overflow=""))}MDo(){this.oXi();var la=Rb.where(Rb.asEnumerable(this.grc),yc=>0===yc.entry.position),bb=Rb.where(la,yc=>!yc.show);if(Rb.any(bb)&&Rb.Ct(bb)!==Rb.Ct(la)){for(var qb of bb)qb.entry.element.style.width="0";la=Rb.where(la,yc=>yc.show)}bb=Rb.where(Rb.asEnumerable(this.grc),
yc=>1===yc.entry.position);qb=Rb.where(bb,yc=>!yc.show);if(Rb.any(qb)&&Rb.Ct(qb)!==Rb.Ct(bb)){for(var ac of qb)ac.entry.element.style.width="0";bb=Rb.where(bb,yc=>yc.show)}for(let yc of Rb.concat(la,bb))la=yc.entry,Ym.WacAirSpace.DV(la.element,mm.a.Ghg),ac=new Df.a(la.element),yc.show?ac.T1e(0,la.width):ac.T1e(la.width,0),Ym.WacAirSpace.animate(ac,null,null);this.grc.length=0}oXi(){}cBh(la,bb){let qb=la.width;la=0===la.position?this.frd:this.jwd;if(bb&&1===la||!bb&&!la)qb+=1;return qb}iro(){this.czd||
(this.$Ka||(this.$Ka=document.createElement("div"),this.$Ka.id=jn.G4o,this.$Ka.className=jn.TKj,Sys.UI.DomElement.addCssClass(this.$Ka,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Kb.C9&&Sys.UI.DomElement.addCssClass(this.$Ka,"FlexBoxLayout"),this.oHe&&Sys.UI.DomElement.addCssClass(this.$Ka,jn.QKj),this.qqh(0,this.$Ka)),this.aLa||(this.aLa=document.createElement("div"),this.aLa.id=jn.H4o,this.aLa.className=jn.TKj,Sys.UI.DomElement.addCssClass(this.aLa,"alignRight"),y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Kb.C9&&Sys.UI.DomElement.addCssClass(this.aLa,"FlexBoxLayout"),this.oHe&&Sys.UI.DomElement.addCssClass(this.aLa,jn.QKj),this.qqh(1,this.aLa)),this.tZi(this.$Ka,this.aLa),this.czd=!0)}tZi(){}mDa(la,bb){Array.add(1===la?this.Jah:this.Iah,bb)}eVd(la){return la+"-Entry"}g9m(){let la=0;for(const bb of H.a.eP(this.Kma)){const qb=Object(rc.a)(1155,this.Kma[bb]);qb&&qb.isVisible&&1===qb.position&&la++}2===la?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<la&&
a.ULS.sendTraceTag(595179605,320,50,la+" simultaneous panes open")}}jn.G4o="WACTaskPaneContainerLeft";jn.H4o="WACTaskPaneContainerRight";jn.TKj="WACTaskPaneContainer";jn.I4o="WACTaskPaneEntry";jn.QKj="WACReactTaskPaneContainer";Object(e.a)(jn,"BaseTaskPaneManager",null,[1156]);var lf=c(494),mk=c(296);class Af extends jn{constructor(la,bb){super();this.Zzc=this.Yzc=this.iYe=this.hYe=0;this.S2h=()=>{Zc.InteractiveViewManager.instance.forEach(qb=>{qb.TPd()})};this.ga=la;this.u0g=bb}qqh(la,bb){const qb=
db.StaticActiveAppFrame.za().RF;qb.parentNode&&(la?1===la&&(this.Rw?((la=Object(mk.a)("FarPane"))&&la.appendChild(bb),bb.classList.add("regionComposer"),db.StaticActiveAppFrame.za().bJ.registerBoundingWindowRectsChanged("farPane",(ac,yc)=>{"DP"===yc||3===yc?bb.classList.add("DL"):bb.classList.remove("DL")})):qb.parentNode.insertBefore(bb,qb.nextSibling)):this.Rw?((la=Object(mk.a)("NearPane"))&&la.appendChild(bb),bb.classList.add("regionComposer")):qb.parentNode.insertBefore(bb,qb))}msh(la,bb,qb){this.Rw||
(bb=bb?qb:-qb,la?this.Zzc+=bb:this.Yzc+=bb)}oXi(){if(!this.Rw){var la=db.StaticActiveAppFrame.za().RF;Ym.WacAirSpace.DV(la,mm.a.Ghg);if(this.hYe!==this.Yzc){const bb=new lf.a(la);bb.YCk(this.hYe,this.Yzc,this.u0g);Ym.WacAirSpace.animate(bb,null,this.S2h);this.hYe=this.Yzc}this.iYe!==this.Zzc&&(la=new lf.a(la),la.ZCk(this.iYe,this.Zzc,this.u0g),Ym.WacAirSpace.animate(la,null,this.S2h),this.iYe=this.Zzc)}}}Object(e.a)(Af,"TaskPaneManager",jn,[]);var Tg=c(252);class hl extends Af{get oyi(){null==this.sse&&
(this.sse=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.sse}constructor(la,bb){super(la,bb);this.YW=Ld.KeyInputManager.ic(Em.a.Kw,0);this.ZW=Ld.KeyInputManager.ic(Em.a.Kw,4);this.XQe=this.Kzc=null;this.F5g="AccCheckerTaskPane";this.sa=new ma.a;this.isPaneOpen=!1;this.sse=this.kBe=null;this.mDa(0,"SampleTaskPane");this.mDa(0,Tg.a.sib);this.mDa(1,Tg.a.sIk);this.mDa(1,"CustomTaskPane");
this.mDa(1,Tg.a.aDf);this.mDa(1,Rd.AFrame.Sr);this.mDa(1,Rd.AFrame.foh);this.mDa(1,Rd.AFrame.aoh);this.mDa(1,Tg.a.ZPd);this.mDa(1,Tg.a.WLc);this.mDa(1,Tg.a.MNc);this.H9j=(this.eMg=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Kb)&&y.AFrameworkApplication.ta.Kb.MHf;this.M8j=Fh.App.zec;this.S8j=this.eMg&&y.AFrameworkApplication.ta.Kb.eYc;this.initialize();la.fb(Zj.a.Zhg,el.a.application,hl.Zhg,96)}get Qee(){if(!db.StaticActiveAppFrame.za()||!db.StaticActiveAppFrame.za().RF)return null;
this.XQe||(this.XQe=new Pl.a(db.StaticActiveAppFrame.za().RF,nl.FocusManager.instance()));return this.XQe}Ub(){}tZi(la,bb){const qb=Sp.a.instance,ac=nl.FocusManager.instance(),yc=vl.EventHandlerManager.instance,$c=this;jo.UISurfaces.Pu().then(Vd=>{$c.Kzc=$c.k6b(ac);let me;Vd.renderTaskPaneGroups(la,bb,(me=new fp,me.middleContainer=db.StaticActiveAppFrame.za().RF,me.onTabStripFocus=()=>{ac.jD(Tg.a.enc)},me.onOpen=(Md,Re)=>{$c.NHf(Md)&&cn.t3k(Md,Re);yc.$Ze(Re,"focus",$c.Zgi(Md,ac),!0);var We=$c.Yzi(Md),
bg=Vd.selectors.getTabbedTaskPaneCount(We?1:2);We=We?Tg.a.ule:Tg.a.enc;1===bg&&(qb.U7(We),this.isPaneOpen=!0,this.j7i({isPaneOpen:this.isPaneOpen,cSb:Re}));Re=$c.nrf(Md);if(bg=ac.fe(Re))bg.RJc=We,$c.Lvo(Md)&&(bg.mr($c.YW),bg.mr($c.ZW)),qb.Iyi(Re)&&qb.fx(Re);this.oyi&&this.bOd&&this.bOd.dismissFloatie(!0)},me.onClose=(Md,Re)=>{$c.NHf(Md);const We=$c.Yzi(Md),bg=We?Tg.a.ule:Tg.a.enc;Vd.selectors.getTabbedTaskPaneCount(We?1:2)||(qb.fx(bg),this.isPaneOpen=!1,this.j7i({isPaneOpen:this.isPaneOpen,cSb:Re}));
yc.i8f(Re,"focus",$c.Zgi(Md,ac),!0);this.oyi&&this.bOd&&this.bOd.dismissFloatie(!0)},me.setFocusCallback=(Md,Re)=>{$c.NHf(Md)&&Re&&(Md=ac.fe($c.nrf(Md)),Md.GZk(),Md.sga(Re))},me.onOverflowMenuOpen=()=>{if($c.Kzc)$c.Kzc.onMenuOpen()},me.onOverflowMenuClose=()=>{if($c.Kzc)$c.Kzc.onMenuClose()},me.onShow=(Md,Re)=>{2===Re&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{ac.mg(Md)},0)})},me.onHide=(Md,Re,We)=>{We&&1!==Re&&ac.mg(ac.iU)},me.onResizeStart=()=>{if(db.StaticActiveAppFrame.za()&&(db.StaticActiveAppFrame.za().RF.className=
am.AppFrame.Yrg,$c.Qee))$c.Qee.onMenuOpen()},me.onResizeEnd=()=>{if(db.StaticActiveAppFrame.za()&&(Pk.a.pCi()||(db.StaticActiveAppFrame.za().RF.className+=" "+db.StaticActiveAppFrame.za().sCh),$c.Qee))$c.Qee.onMenuClose()},me));this.jka(Tg.a.enc,ac,bb,$c);this.jka(Tg.a.ule,ac,la,$c);return null})}jka(la,bb,qb,ac){const yc=bb.fe(la);yc.parent=Rd.AFrame.Ap;yc.fI=!0;Gk.a.instance.iDa(la,qb,!1);to.a.instance.iDa(la,qb,!1);la=new zq.DOMFocusListing(()=>qb);la.Qm(3);la.Qm(2);la.Qm(4);la.Qm(1);bb.nna(()=>
qb,yc,la).yP=!0;yc.mr(ac.YW);yc.mr(ac.ZW)}nrf(la){return la===this.F5g?Tg.a.lnh:la}Zgi(la,bb){return()=>{bb.jD(this.nrf(la))}}Lvo(la){return la===this.F5g?!1:!0}sNm(la){return la===Tg.a.sib}NHf(la){return this.sNm(la)||la===Tg.a.lnh||0<=la.indexOf("AppForOfficePanel")||la===Tg.a.ZPd||la===Tg.a.aDf&&this.H9j||la===Tg.a.WLc&&this.M8j||la===Tg.a.MNc&&this.S8j||la===kh.a.wFb?!0:!1}Yzi(la){return la===Tg.a.sib||"SampleTaskPane"===la}static Rhm(){return new hl(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static Zhg(la,
bb,qb,ac,yc){if(1===qb)return 32;jo.UISurfaces.Pu().then($c=>{$c.showTaskPane(yc,Object.assign(new ke.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Qk,{type:"SampleTaskPaneProps"})}));return null});return 32}L_a(la){this.sa.addHandler("onPaneToggle",la)}l7c(la){this.sa.removeHandler("onPaneToggle",la)}j7i(la){this.sa.raiseEvent("onPaneToggle",la)}get bOd(){this.kBe||(this.kBe=M.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.kBe}}
Object(e.a)(hl,"TaskPaneManager",Af,[657]);class Qq{constructor(){this.DT=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.DT=hl.Rhm();this.DT.Ub();db.StaticActiveAppFrame.za().T8a=this.DT}dispose(){}}Object(e.a)(Qq,"PackageManager",null,[1,2]);c.d(J,"a",function(){return l})},1989:function(D,J,c){D=c(0);var l=c(174),e=c(738),a=c(358),k=c(22),x=c(2),y=c(81),n=c(43),t=c(42),z=c(6),v=c(16),I=c(7),E=c(75),H=c(445),M=c(88),K=c(473),L=c(5),S=c(601),Q=c(199),N=c(223),O=c(18),X=c(1120),
U=c(37),T=c(84),Y=c(41),aa=c(785),ba=c(29),oa=c(77),ma=c(21),ea=c(54);class ua{constructor(Wa,Bb,Ob,hc){this.mLd=this.kLd=null;this.Nad=Wa;this.Cle=Bb;this.Vuj=Ob;this.Wuj=hc}}Object(D.a)(ua,"TableSimplificationInformation",null,[]);var sa=c(78),Fa=c(28),Pa=c(449),Na=c(261),Aa=c(935),za=c(1625),xa=c(285),ka=c(3),wa=c(15),ia=c(141),va=c(17),na=c(262),Ca=c(33),ta=c(257),fa=c(8),Xa=c(641),ob=c(573),xb=c(344);class zb extends Sys.EventArgs{constructor(Wa){super();this.So=Wa}}Object(D.a)(zb,"AfterTrimCompleteOnCopyArgs",
Sys.EventArgs,[]);var Lb=c(1799);class Ia extends Lb.a{constructor(Wa,Bb,Ob,hc){super(Wa,Bb,{});this.uUa=[];for(Wa=0;Wa<Ob.length;Wa++)this.uUa.push(...Ob.J(Wa).toArray());this.gEa=0;this.Ky=hc;this.So={}}}Object(D.a)(Ia,"BasicInternalCopyArguments",Lb.a,[]);class Ya extends Sys.EventArgs{constructor(Wa,Bb){super();this.So=Bb;this.uUa=[];for(Bb=0;Bb<Wa.length;Bb++)this.uUa.push(...Wa.J(Bb).toArray())}}Object(D.a)(Ya,"BeforeCopyArguments",Sys.EventArgs,[]);class eb extends Sys.EventArgs{constructor(Wa){super();
this.So=Wa}}Object(D.a)(eb,"BeforePasteArguments",Sys.EventArgs,[]);class sb extends Sys.EventArgs{constructor(Wa,Bb,Ob,hc){super();this.paragraph=Wa;this.cpBegin=Bb;this.cpEnd=Ob;this.So=hc}}Object(D.a)(sb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var lc=c(1841),vb=c(1842);class Eb{constructor(Wa,Bb,Ob,hc,Gc,bc,Dc,Ub,Fc){this.lnc=Wa;this.source=Bb;this.target=Ob;this.j_f=hc;this.rowIndex=Gc;this.Do=bc;this.w0a=Dc;this.D1i=Ub;this.ke=Fc}}Object(D.a)(Eb,"CoreInternalTablePasteArguments",null,[]);
class Ua extends Sys.EventArgs{constructor(Wa,Bb,Ob,hc,Gc){super();this.operation=Wa;this.v_i=Bb;this.original=Ob;this.clone=hc;this.So=Gc}}Object(D.a)(Ua,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Ta=c(91);c.d(J,"a",function(){return Nb});class Nb{constructor(Wa,Bb,Ob,hc,Gc,bc,Dc,Ub,Fc,Sa,wb,Tb,Hb,$a,ab){this.hX=this.yt=null;this.TLe=!1;this.EBa=null;this.dZk=(rb,cb)=>{l.a.mark(5566);cb=cb.target;if(cb.Rd())return cb.tg(),!0;rb.ri(this.UNc);return!0};this.UNc=(rb,cb)=>{cb=new lc.a(cb,null);
const rc=new e.a(rb,this.sKc,cb);rc.Rl("ExecuteCoreCopyToInternalClipboard");this.bJn(cb);rc.run();rb.ri(this.kPo);return!0};this.sKc=(rb,cb)=>{if(!cb.source.Rd())return cb.yi&&(cb.yi.rGd=null),I.ULS.shipAssertTag(6305560,307,!1),this.rg.logKpiFailure({kpiName:xb.a.RFd,errorName:"InternalCopyFailedSourceHasNoChildren"}),!1;rb.ri(this.UKh);return!0};this.UKh=(rb,cb)=>{const rc=cb.insertAfter,Rb=cb.source,fb=cb.target,Pb=Rb.currentNode;var Ec=this.VZi;if(!Pb.Bia)return rb.ri(this.rKc),!0;cb.yi.WQb&&
(cb.WQb=!0);if(!this.IWk(cb))return cb.Mka.vGa.c++,rb.ri(this.rKc),!0;if(!cb.WQb&&(Pb.l8b()&&cb.Mka.vGa.c++,Pb.l8b()||Ec&&!Pb.Jlb(this.vv)))return rb.ri(this.rKc),!0;if(!cb.WQb&&Ec&&!Pb.Rz)return Rb.Jz()&&(cb.dpe=!0,cb=new e.a(rb,this.sKc,new lc.a(cb,rc)),cb.Rl("RecursiveCoreCopyToInternalClipboard"),cb.run()),rb.ri(this.rKc),!0;Ec=fb.currentNode.Zi().xd;Ec=S.b(Pb,Ec,!0);Ec.jlb=!0;this.bsa.nde(cb.Mka.FHb,Ec);fb.aI(Ec,rc,18===Rb.parentNode.type?1:Rb.role);fb.Bj(Ec);cb.insertAfter=Ec;fa.ParagraphReader.Xb(Ec)&&
(this.oJn(rb,this.sKc,Pb,Ec,cb),this.nJn(rb,Pb,Ec));this.kYh(Pb,Ec);Rb.Jz()&&(I.ULS.shipAssertTag(6305562,307,!cb.dpe),cb=new e.a(rb,this.sKc,new lc.a(cb,null)),cb.Rl("RecursiveCoreCopyToInternalClipboard"),cb.run());rb.ri((uc,ya)=>this.R8k(uc,ya));return!0};this.rKc=(rb,cb)=>{cb.dpe&&(cb.insertAfter=cb.rGd,cb.dpe=!1);if(!cb.source.It()){cb.yi&&(cb.yi.rGd=cb.insertAfter);const rc=cb.source;11!==rc.Xe||rc.t$b(-1)||this.SJn(rb,rc.currentNode,cb.target.currentNode,cb);return!1}rb.ri(this.UKh);return!0};
this.kPo=(rb,cb)=>{if(cb.gEa>=cb.uUa.length)return Nb.sa.raiseEvent("AfterTrimCompleteOnCopy",new zb(cb.So)),rb.ri(this.Q8k),!0;rb=cb.uUa[cb.gEa];var rc=rb.node,Rb=rb.cpBegin;let fb=rb.cpEnd;if(!va.SelectionEditor.pv(rb))if(!cb.gEa&&va.SelectionEditor.Kk(rb))fb=Rb=fa.ParagraphReader.textLength(rc);else if(fa.ParagraphReader.um(rb))Rb=0,fb=fa.ParagraphReader.textLength(rc);else if(va.SelectionEditor.ada(rb)){I.ULS.shipAssertTag(6305568,307,!cb.gEa);var Pb=L.GraphIterator.eb(rc);Rb=Pb.zb(12);I.ULS.shipAssertTag(6305569,
307,Rb);rc=Pb.origin;fb=Rb=fa.ParagraphReader.textLength(rc)}else{if(T.OutlineReader.v0d(rb))for(rb=Q.a.gp(rb.node);rb.moveNext();)Pb=rb.currentNode,fa.ParagraphReader.Xb(Pb)&&cb.uUa.push(Fa.a.createTextRange(Pb,0,fa.ParagraphReader.textLength(Pb)));cb.gEa++;return!0}Pb=cb.c0f[rc.id.toString()];I.ULS.shipAssertTag(6305570,307,!!Pb);if(!Pb)return I.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:cb.gEa,["SelectedContextsLength"]:cb.uUa.length,["SelectedNodeType"]:rc.type,
["ContextId"]:rb.contextId}),cb.gEa++,!0;rc=sa.e(Pb);let Ec,uc=!1;for(Ec=rc.length-1;0<=Ec;Ec--)if(!rc[Ec].IDa)if(4===rc[Ec].vh)rc[Ec].Lb.blob=null,rc[Ec].Lb.blob=new Pa.a(rc[Ec].Lb),cb.Mka.vGa.e++;else{rc[Ec].Lb.blob=null;if(-1!==rc[Ec].pe){var ya=rc[Ec].Lb.formatting,db=void 0,tb=void 0;ya&&-1===ya.pe?(tb=rc[Ec].pe+1,db=rc[Ec].k5-1,ya.pe=rc[Ec].pe):(db=rc[Ec].k5,tb=rc[Ec].pe);for(ya=0;ya<db;ya++)Pb.xe.removeAt(tb,16);0<db&&(uc=!0)}db="";xa.f(rc[Ec])?(db=" ",cb.Mka.vGa.f++):xa.g(rc[Ec])&&(tb=xa.b(rc[Ec]))&&
(db=xa.a(tb),cb.Mka.vGa.g++);tb=rc[Ec].Lb.cp;tb>=Rb&&tb<fb&&(Nb.jg.Ge(Fa.a.createTextRange(Pb,tb,tb+1),db,void 0,void 0,void 0,void 0,!0),fb=fb-1+db.length,cb.Mka.vGa.i++)}uc&&Pb.Xl();this.$0n(Pb);Nb.sa.raiseEvent("BeforeTrimOnCopy",new sb(Pb,Rb,fb,cb.So));rc=fa.ParagraphReader.textLength(Pb);fb<rc&&Nb.jg.Ge(Fa.a.createTextRange(Pb,fb,rc),"",void 0,void 0,void 0,void 0,!0);0<Rb&&Nb.jg.Ge(Fa.a.createTextRange(Pb,0,Rb),"",void 0,void 0,void 0,void 0,!0);this.fom(Pb,cb.Mka.vGa);fa.ParagraphReader.textLength(Pb)||
cb.gEa!==cb.uUa.length-1||!va.SelectionEditor.pv(rb)||Pb.su||(rb=L.GraphIterator.eb(Pb),rb.zb(25)&&(U.OutlineElementNavigator.Yd(rb),this.rh.A1a(rb),cb.gEa&&(this.yt.lb.nwa=!0)));cb.gEa!=cb.uUa.length-1||this.nwa||Pb.Cg(t.a.D5,t.a.Pda,t.a.Hqa,t.a.Pya,t.a.g$);this.bsa.s6c(cb.Mka.z$d,cb.Mka.wCb,cb.Mka.Dfb,Pb);cb.gEa++;return!0};this.Q8k=(rb,cb)=>{this.zka.yTb(null);cb.Ky.dispose();l.a.mark(5567);this.zin();this.hX=cb.Mka;this.HKi("Copy");this.ZJm&&I.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");
return!1};this.ACn=(rb,cb)=>{if(cb.lnc){if(cb.lnc.inProgress)return!0;ba.TableCellReader.isTableCell(cb.source)||cb.source.jd(16);if(this.Zfn(cb))return!1}else Ca.TableReader.isTable(cb.target)||cb.target.jd(14),Ca.TableReader.isTable(cb.source)||cb.source.jd(14),ma.moveToCell(cb.target,cb.rowIndex,cb.Do),ma.moveToCell(cb.source,0,0);if(ba.TableCellReader.hg(cb.source)||ba.TableCellReader.hg(cb.target))return!0;this.nCn(cb,rb);return!0};this.uKc=(rb,cb)=>{if(!cb.source.Rd())return rb.ri(this.Fob),
!0;rb.ri(this.WKh);return!0};this.WKh=(rb,cb)=>{const rc=cb.source,Rb=cb.target,fb=rc.currentNode;if(!fb.Bia||!fb.zOa||this.tvo(rc,Rb))return rb.ri(this.Naf),!0;if(M.a.instance.J(1)&&Y.OutlineElementReader.yh(rc)){if(!U.OutlineElementNavigator.Ee(rc).zOa)return U.OutlineElementNavigator.Yd(rc),rb.ri(this.Naf),!0;U.OutlineElementNavigator.Yd(rc)}I.ULS.shipAssertTag(6305608,307,!fb.l8b());var Pb=Rb.currentNode.Zi().xd;Pb=S.b(fb,Pb,!0);Pb.GHa();Pb.QXc=!0;this.k5n(rc,Rb);Rb.aI(Pb,cb.insertAfter,rc.role);
Rb.Bj(Pb);cb.insertAfter=Pb;wa.App.zd.Uo&&wa.App.zd.fq.iG(Pb);this.kYh(fb,Pb);cb=new e.a(rb,this.uKc,new vb.a(rc,Rb,null,cb.j_f,cb.So));cb.Rl("RecursiveCorePasteOperation");cb.run();rb.ri(this.U8k);return!0};this.U8k=(rb,cb)=>{const rc=cb.target,Rb=rc.currentNode,fb=cb.source,Pb=fb.currentNode;let Ec=-1;cb.So[Nb.$Af]&&(Ec=cb.So[Nb.$Af]);fa.ParagraphReader.Xb(Rb)&&(this.dKn(rb,this.uKc,Pb,Rb,cb),this.$Jn(rb,Pb,Rb));Rb.h1();cb.So[X.a.tui]?22===Rb.type&&(ba.TableCellReader.P0(fb)||Rb.setValue(z.a.listID,
Number.MAX_VALUE)):this.FK.u4n(Rb);if(fa.ParagraphReader.Xb(Rb)&&(cb=sa.i(Rb,5),0<cb.length)){for(const uc of cb)!uc.properties.hasProperty(z.a.BNb)&&uc.properties.hasProperty(z.a.bae)&&(cb=uc.properties.getValue(z.a.bae),uc.properties.setValue(z.a.BNb,cb)),O.ImageReader.tcc()?O.ImageReader.mKb(uc.properties)&&this.Vj.Abg(uc.properties,Ec):O.ImageReader.Qy(uc.properties)||this.Vj.Abg(uc.properties,Ec);Rb.Zi().contentReplicator.forceOutbound(null,null,null)}this.jYh(rc);this.$_o(Pb,Rb);Ca.TableReader.LR(Rb)&&
I.ULS.sendTraceTag(524919814,3022,50,"TablePasted");ba.TableCellReader.Tpa(rc)&&za.a.Qhj(Rb);rc.sc();rb.ri(this.Naf);return!0};this.Naf=(rb,cb)=>{if(!cb.source.It())return rb.ri(this.Fob),!0;rb.ri(this.WKh);return!0};this.Fob=()=>{l.a.mark(5565);return!1};this.FZb=bc;this.ep=Dc;this.Vj=Wa;this.nVe=Bb;this.HK=Ob;this.rh=hc;this.FK=Gc;this.Ca=Ub;this.Lc=Sa;this.CAd=Fc.create(2097162);this.j7f(this.CAd);this.fAe=Fc.create(2097162);this.j7f(this.fAe);this.kYe=Fc.create(2097162);this.j7f(this.kYe);this.ozd=
this.CAd;this.OZ=wb;this.F3=Tb;this.Vd=Hb;this.rg=a.a.getInstance(xb.a.r0a);this.oDc=$a;this.jjk=$a.substr(0,3);this.h7=ab}get Sk(){return null!=this.bGg?this.bGg:this.bGg=k.a.instance.resolve("Box4.IParagraphEditor")}get Zb(){return null!=this.Pzg?this.Pzg:this.Pzg=k.a.instance.Oa("Box4.IFeatureHelper")}get vv(){return this.yt?this.yt.vv:0}get RCb(){return this.yt.lb.RCb}get nwa(){return this.yt.lb.nwa}get zka(){return this.ozd}get Dzj(){return this.kYe}get Q$e(){return this.yt.MJ&&!this.TLe}$oj(){this.TLe=
!0}get VZi(){return!this.yt.MJ}get bsa(){return Xa.a.instance}j7f(Wa){var Bb=new Aa.a(-1);this.FZb.Al.dOa(Bb);const Ob=new L.GraphIterator;Ob.set(Bb);x.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");Bb=3;this.Ca&&this.Ca.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(Bb=0);Bb=this.Lc.Pc(Bb);Bb.Ut(Ob);Ob.Bf(Wa,80);Bb.dispose()}cJd(Wa,Bb=null){Wa=Wa.mb;this.yt=Wa.ib.clone();this.TLe=!1;Wa=L.GraphIterator.eb(Wa.Z1);
const Ob=L.GraphIterator.eb(this.zka),hc=this.Lc.Pc(3,ka.a.uGm);hc.Ut(Ob);Wa.Tb(82);do Wa.currentNode.yTb(null);while(Wa.Ri(82));Wa=new e.a(Bb,this.dZk,new Ia(Wa,Ob,this.yt,hc));Wa.Rl("InternalCopy");Wa.Qh=!Bb||Bb.Qh;Wa.run()}R8k(Wa,Bb){var Ob=Bb.source;const hc=Bb.target;var Gc=hc.currentNode,bc=Ob.currentNode;fa.ParagraphReader.oh(hc)&&(Bb.c0f[bc.id.toString()]=Gc);if(fa.ParagraphReader.Xb(Gc)){if(0<fa.ParagraphReader.Bii(bc))if(0<this.ep.JG(bc).Xt)bc.setValue(z.a.oTa,0);else{const Dc=this.ep.o0(bc).Xt;
this.Sk.qq.mea(Gc,Dc)}if(!this.LZd&&this.h7.E1i){Ob.sc();if(!Ca.TableReader.mx(hc)&&Ob.SGa&&!this.nwa)for(const Dc of this.h7.e0f)Gc.removeProperty(Dc);Ob.Bj(bc)}}if(fa.ParagraphReader.Xb(Gc)){for(bc=0;bc<Gc.xe.length;bc++)Gc.xe.uq.Z(bc,ta.CharacterPropertiesEditor.bN),Gc.xe.ot.Z(bc,ta.CharacterPropertiesEditor.ZR);I.ULS.shipAssertTag(6305565,307,!!wa.App.zd);(this.Vd.yg||M.a.instance.J(1)&&wa.App.Iv.ySb)&&Gc.setValue(z.a.LRa,!0);Gc.Cg(z.a.bFb,z.a.H0i,z.a.X_f);M.a.instance.J(1)&&fa.ParagraphReader.Xb(Gc)&&
Gc.Cg(z.a.Txa)}this.VZi&&(this.jYh(hc),Ca.TableReader.isTable(hc)&&(Gc=this.yt.GO(),Gc.moveNext(),(Gc=ba.TableCellReader.sFa(Ob,Gc.current.node))||(Gc=new aa.a(0,0)),Ob=new ua(Gc,hc,Ca.TableReader.Jha(Ob),Ca.TableReader.Euf(Ob)),this.nVe.value.v7n(Ob)));Y.OutlineElementReader.yh(hc)&&!hc.Jt(2)&&(this.rh.OH(hc),hc.sc());hc.sc();Bb.yi&&(Bb.yi.rGd=Bb.insertAfter);Wa.ri(this.rKc);return!0}IWk(Wa){const Bb=Wa.source;if(Y.OutlineElementReader.yh(Bb)&&Bb.dkb(12)){const Ob=Bb.Rd();if(fa.ParagraphReader.Xb(Ob)&&
Ob.ja(z.a.BN,null))return Bb.sc(),Wa.WQb=!1;Bb.sc()}else if(fa.ParagraphReader.Xb(Bb.Gn)&&Bb.Gn.ja(z.a.BN,null))return!1;return!0}nJn(Wa,Bb,Ob){Bb=sa.e(Bb);Ob=sa.e(Ob);for(let hc=0;hc<Bb.length;hc++)Bb[hc].YVf(Ob[hc],Wa,this.sKc)}$0n(Wa){if(Wa=Wa.ra){var Bb=new E.a;for(let Ob=0;Ob<Wa.length;Ob++){const hc=Wa.J(Ob);hc.Ji&&Bb.add(hc)}for(const Ob of Bb)Ob.Ji=null}}get ZJm(){return!L.GraphIterator.eb(this.zka).Rd()}rJj(){this.ozd=this.kYe}qJj(){this.ozd=this.CAd}y1o(){this.ozd=this.fAe}get CXm(){return this.zka===
this.CAd}get oMm(){return this.zka===this.fAe}mFh(){const Wa=L.GraphIterator.eb(this.zka);for(;Wa.Rd();)Wa.tg()}HKi(Wa){const Bb=this.hX.vGa.b;Wa+="-"+Bb;this.hX.vGa.b=Wa;this.hX.FHb.b=Wa;this.hX.z$d.b=Wa;this.hX.wCb.b=Wa;this.hX.Dfb.b=Wa;this.bsa.I6m(this.hX.vGa);this.bsa.FNf(this.hX.FHb);this.bsa.zLi(this.hX.z$d);this.bsa.rNf(this.hX.wCb);this.bsa.oNf(this.hX.Dfb);this.hX.vGa.b=Bb;this.hX.FHb.b=Bb;this.hX.z$d.b=Bb;this.hX.wCb.b=Bb;this.hX.Dfb.b=Bb}A1i(Wa,Bb,Ob,hc,Gc=null,bc=null){this.HKi("Paste");
Bb=L.GraphIterator.eb(Bb);const Dc=L.GraphIterator.eb(this.zka);var Ub=null;Gc&&(Ub=new K.a(T.OutlineReader.ljl,T.OutlineReader.Xjl),Ub=Gc.equals(new K.a(-1,-1))?new K.a(0,0):Gc.Vke(Ub));if(this.nui())if(Dc.Rd(),O.ImageReader.Mt(Dc.currentNode))Gc=Dc.currentNode,Dc.sc(),Dc.aI(this.rh.Tgb(),null,1),Dc.Rd(),Dc.aI(Gc,null,2),Dc.sc(),Dc.Bj(Gc),Dc.tg(),this.$oj();else if(N.isFloatingEmbeddedFileNode(Dc.currentNode)){Gc=Dc.currentNode;Dc.sc();Dc.aI(this.rh.Tgb(),null,1);Dc.Rd();var Fc=this.rh.OH(Dc);Fc=
Fa.a.Uc(Fc,0);Nb.jg.Ge(Fc,"<<"+N.getEmbeddedFileName(Gc)+">>",void 0,void 0,void 0,void 0,!0);Dc.sc();Dc.sc();Dc.Bj(Gc);Dc.tg();this.$oj()}this.OZ&&this.OZ.sHf(Ob)||!this.mEi(Dc,Bb)?(l.a.mark(5564),Dc.currentNode.yTb(null),Wa={},Wa[Nb.$Af]=hc,Ta.ListItemReader.lg(Ob)&&(Wa[X.a.tui]=!0),Ob=new vb.a(Dc,Bb,Ob,Ub,Wa),hc=new e.a(bc,this.uKc,Ob),hc.Rl("ExecuteCorePasteFromInternalClipboard"),hc.Qh=!bc||bc.Qh,this.cJn(Ob),hc.run()):(Dc.currentNode.yTb(null),I.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),
this.Z4n(bc,Dc,Bb,Ub,Wa),I.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}JDi(Wa){if(Wa&&Wa.isValid){const Bb=L.GraphIterator.eb(this.zka);return this.mEi(Bb,Wa)}return!1}mEi(Wa,Bb){if(ba.TableCellReader.Tpa(Bb)&&1===Wa.Wp()){Wa.Tb(1);if(Y.OutlineElementReader.yh(Wa)){U.OutlineElementNavigator.Ee(Wa);if(Ca.TableReader.isTable(Wa))return Ca.TableReader.RB(Wa.currentNode)&&I.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),Bb.zb(14)&&
!Ca.TableReader.RB(ma.getContainingTable(Bb))?I.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."):I.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),!0;U.OutlineElementNavigator.Yd(Wa)}Wa.sc()}return!1}Z4n(Wa,Bb,Ob,hc,Gc){let bc,Dc;let Ub;Object(n.a)("ReplaceTableCellsFromClipboardTable",!0);Ob.zb(14);bc=ea.a.Ls(Ob);Dc=oa.a(Ob);Ob.jd(14);var Fc=Ca.TableReader.gg(Ob.currentNode);Ub=Ca.TableReader.hh(Ob.currentNode);const Sa=Ca.TableReader.gg(Bb.currentNode),
wb=Ca.TableReader.hh(Bb.currentNode);I.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Fc,Ub,Sa,wb,bc,Dc);if(na.TableBorderSelectionCache.CSc())this.hpo(),Fc=Math.min(this.Nle+1,Fc),Ub=Math.min(this.Jlg+1,Ub),this.Jlg-this.TIo==Ub-1&&(this.Nyj==this.Nle?Dc=0:this.Nle-this.Nyj==Fc-1&&(Ob.Rd(),bc=ea.a.Ls(Ob),Dc=oa.a(Ob)));else{this.EBa=ob.a.r$b;const Tb=bc+Sa-Fc;0<Tb&&(ma.moveToLastRow(Ob),I.ULS.sendTraceTag(8716374,
307,50,"Begin insert rows: "+Tb),this.nVe.value.insertRows(Ob,!1,Tb,this.EBa),I.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Ob.jd(14));const Hb=Dc+wb-Ub;if(0<Hb){I.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Hb);try{this.nVe.value.insertColumns(Ob,Ub,!1,Hb,this.EBa)}catch($a){throw I.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",$a.toString()),$a;}I.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Tb||0<Hb)&&Object(n.a)("InsertRowsAndColumnsForInternalCCP",
!0)}Fc=this.xRl(Fc,Ub,Sa,wb,bc,Dc);I.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Wa=new e.a(Wa,this.ACn,new Eb(null,Bb,Ob,hc,bc,Dc,Fc,null,Gc));Wa.Rl("ExecuteCorePasteTableInTable");Wa.Qh=!1;Wa.run()}zin(){if(this.LZd){for(var Wa=L.GraphIterator.eb(this.zka),Bb=Wa.currentNode;14!==Wa.Xe;)if(Bb=Wa.Rd(),!Bb){I.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.sSi(Bb)}}Din(Wa){this.LZd&&this.sSi(Wa)}KLo(Wa){const Bb=
L.GraphIterator.eb(Wa);this.HK.Pkb(Bb,null,!0);Wa.hg=!1;Wa.rowSpan=1;Wa.colSpan=1}sSi(Wa){if(Wa&&14===Wa.type){I.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Bb={},Ob=Ca.TableReader.gg(Wa),hc=Ca.TableReader.hh(Wa),Gc=L.GraphIterator.eb(Wa);ma.forEachCellInTable(Gc,(bc,Dc,Ub)=>{const Fc={};bc=bc.currentNode;if(16===bc.type)if(bc.hg)Nb.iIh(Dc,Ub)in Bb||(this.KLo(bc),Fc.IsGhostCell="->false");else{Nb.LUn(Wa,bc,Dc,Ub,Ob,(wb,Tb,Hb)=>{Fc.rowSpan=String.format("{0}:{1}->{2}",
wb,Tb,Hb)});Nb.KUn(Wa,bc,Ub,Dc,hc,(wb,Tb,Hb)=>{Fc.colSpan=String.format("{0}:{1}->{2}",wb,Tb,Hb)});const Sa=String.format("{0},{1}-{2},{3}",Dc,Ub,Dc+bc.rowSpan,Ub+bc.colSpan);for(let wb=0;wb<bc.rowSpan;wb++)for(let Tb=0;Tb<bc.colSpan;Tb++)if(wb||Tb)Bb[Nb.iIh(Dc+wb,Ub+Tb)]=Sa}if(0<H.a(Fc).length){if(void 0===Fc.IsGhostCell||null===Fc.IsGhostCell){if(void 0===Fc.rowSpan||null===Fc.rowSpan)Fc.rowSpan=bc.rowSpan;if(void 0===Fc.colSpan||null===Fc.colSpan)Fc.colSpan=bc.colSpan}I.ULS.sendTraceTag(39175904,
307,50,"NormalizeTable: [{0},{1}]: {2}.",Dc,Ub,Fc)}return!0});Nb.Otl(Bb)}}fom(Wa,Bb){if(Wa&&fa.ParagraphReader.Xb(Wa)){var Ob=0,hc=L.GraphIterator.eb(Wa);for(hc.Tb(6);!hc.Zr;){var Gc=hc.currentNode;hc.Ri(6);O.ImageReader.Mt(Gc)?O.ImageReader.UHf(Gc)?L.GraphIterator.eb(Gc).dkb(59)?I.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.Sk.YJh(Gc,Fa.a.Uc(Wa,Ob),!0),Bb.d++,Ob++):(Gc=L.GraphIterator.eb(Gc),Gc.zb(12),Gc.tg(),Bb.h++):I.ULS.shipAssertTag(6305571,
307,!1)}}}get LZd(){return!!this.Ca&&this.Ca.$("ComplexTableCellPasteWithFormattingIsEnabled")}xRl(Wa,Bb,Ob,hc,Gc,bc){const Dc=[];let Ub,Fc,Sa,wb;na.TableBorderSelectionCache.CSc()?(Ub=Math.min(Wa,Gc+Ob),Fc=Math.min(Bb,bc+hc),wb=Gc):(wb=0,Ub=Math.max(Gc+Ob,Wa));for(;wb<Ub;wb++)for(na.TableBorderSelectionCache.CSc()?Sa=bc:(Sa=0,Fc=bc+hc,wb<Gc?Sa=Bb:wb>=Gc&&wb<Math.min(Gc+Ob,Wa)?Sa=bc:wb>=Gc+Ob&&wb<Wa?Sa=Bb:Fc=Math.max(bc+hc,Bb));Sa<Fc;Sa++)Dc.push(Array(2)),Dc[Dc.length-1][0]=wb,Dc[Dc.length-1][1]=
Sa;return Dc}k5n(Wa,Bb){if(this.LZd)if(!Bb||!Wa)I.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Wa,["table"]:Bb});else if(16===Bb.currentNode.type&&16===Wa.parentNode.type){Bb=Bb.currentNode;Wa=Wa.parentNode;var Ob={};Bb.hg!==Wa.hg&&(Bb.hg=Wa.hg,Ob.IsGhostCell=Bb.hg);Bb.b5!==Wa.b5&&(Bb.b5=Wa.b5,Ob.IsSkippedCell=Bb.b5);Bb.Dqb!==Wa.Dqb&&(Bb.Dqb=Wa.Dqb,Ob.ShouldRenderCell=Bb.Dqb);Bb.colSpan!==Wa.colSpan&&(Ob.ColSpan=String.format("{0}<={1}.",Bb.colSpan,Wa.colSpan),
Bb.colSpan=Wa.colSpan);Bb.rowSpan!==Wa.rowSpan&&(Ob.RowSpan=String.format("{0}<={1}.",Bb.rowSpan,Wa.rowSpan),Bb.rowSpan=Wa.rowSpan);H.a(Ob)}}tvo(Wa,Bb){let Ob=!1;Y.OutlineElementReader.yh(Wa)&&(Ob=Y.OutlineElementReader.YQ(Wa)&&this.LWm(Bb));return Ob}LWm(Wa){if(Wa)return Wa=Wa.Xe,36===Wa||38===Wa||16===Wa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}$Jn(Wa,Bb,Ob){Bb=sa.e(Bb);const hc=sa.e(Ob);for(let Gc=Bb.length-1;0<=Gc;Gc--){if(!Bb[Gc].Wlc(Ob)){const bc=
Fa.a.createTextRange(Ob,Bb[Gc].Lb.cp,Bb[Gc].Lb.cp+1);Nb.jg.Ge(bc,"",void 0,void 0,void 0,void 0,!0)}Bb[Gc].h2c(hc[Gc],Wa,this.uKc,this.oMm)}}$_o(Wa,Bb){if(M.a.instance.J(1)&&Ca.TableReader.LR(Wa)){let Ob=0;const hc=Ca.TableReader.gg(Wa);for(const Gc of Ca.TableReader.Qx(Wa,0,hc-1))Gc.Zu&&Ob++;Wa=this.Lc.Pc(4);Wa.Db(Bb);Bb.properties.setValue(v.a.aAa,hc-Ob);Wa.dispose()}}s6d(){return!L.GraphIterator.eb(this.zka).Rd()}nui(){return this.Q$e?1===L.GraphIterator.eb(this.zka).Wp():!1}s8h(Wa){try{return this.jUl(Wa)}catch(Bb){return I.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Bb.message),0}}jUl(Wa){let Bb=0;if(Wa&&(Bb=this.iUl(Wa),!Bb&&Wa.childNodes))for(let Ob=0;Ob<Wa.childNodes.length&&!(Bb=this.s8h(Wa.childNodes[Ob]));Ob++);return Bb}iUl(Wa){if(1===Wa.nodeType&&Wa.getAttribute){Wa=(Wa.getAttribute("class")||"").split(" ");for(const Bb of Wa)if(Bb.startsWith(this.jjk))return Bb.startsWith(this.oDc)?this.vv&&Bb===this.oDc+this.vv?3:2:1}return 0}oJn(Wa,Bb,Ob,hc,Gc){Gc.So||(Gc.So={});Nb.sa.raiseEvent("OnParagraphCopy",
new Ua(Wa,Bb,Ob,hc,Gc.So))}SJn(Wa,Bb,Ob,hc){hc.So||(hc.So={});Nb.sa.raiseEvent("OnCopyComplete",new Ua(Wa,null,Bb,Ob,hc.So))}cJn(Wa){Wa.So||(Wa.So={});Nb.sa.raiseEvent("BeforePaste",new eb(Wa.So))}bJn(Wa){Wa.So||(Wa.So={});Nb.sa.raiseEvent("BeforeCopy",new Ya(this.yt,Wa.So))}dKn(Wa,Bb,Ob,hc,Gc){Nb.sa.raiseEvent("OnParagraphPaste",new Ua(Wa,Bb,Ob,hc,Gc.So))}jYh(Wa){ba.TableCellReader.isTableCell(Wa)&&(Wa.Tb(1)||this.HK.Z7(Wa,!0),Wa.sc())}kYh(Wa,Bb){this.F3.Xxa(Bb)&&(Bb.width=Wa.width)}static F0e(Wa){Nb.sa.addHandler("OnParagraphCopy",
Wa)}static BCd(Wa){Nb.sa.addHandler("OnParagraphPaste",Wa)}static z2n(Wa){Nb.sa.removeHandler("OnParagraphPaste",Wa)}static gyk(Wa){Nb.sa.addHandler("OnCopyComplete",Wa)}static mxk(Wa){Nb.sa.addHandler("BeforePaste",Wa)}static U1n(Wa){Nb.sa.removeHandler("BeforePaste",Wa)}static kxk(Wa){Nb.sa.addHandler("BeforeCopy",Wa)}static nxk(Wa){Nb.sa.addHandler("BeforeTrimOnCopy",Wa)}static exk(Wa){Nb.sa.addHandler("AfterTrimCompleteOnCopy",Wa)}static get jg(){return null!=Nb.qxg?Nb.qxg:Nb.qxg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get jH(){return Na.a.instance}static get Hi(){return ia.PageReader.instance}static Otl(Wa){const Bb=
{};for(const Ob of H.a(Wa)){const hc=Wa[Ob];Bb[hc]=hc in Bb?String.format("{0}|{1}",Bb[hc],Ob):Ob}1<=H.a(Bb).length&&I.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Bb)}static KUn(Wa,Bb,Ob,hc,Gc,bc){Bb.colSpan>Gc-Ob&&(bc&&bc("A",Bb.colSpan,Gc-Ob),Bb.colSpan=Gc-Ob);Wa=Nb.Gzo(Wa,Bb,hc,Ob);Bb.colSpan!==Wa&&(bc&&bc("B",Bb.colSpan,Wa),Bb.colSpan=Wa)}static LUn(Wa,Bb,Ob,hc,Gc,bc){Bb.rowSpan>Gc-Ob&&(bc&&bc("A",Bb.rowSpan,Gc-Ob),Bb.rowSpan=Gc-Ob);Wa=Nb.Hzo(Wa,Bb,Ob,hc);Bb.rowSpan!==
Wa&&(bc&&bc("B",Bb.rowSpan,Wa),Bb.rowSpan=Wa)}static Gzo(Wa,Bb,Ob,hc){return Nb.Stj(Wa,Bb.colSpan,(Gc,bc)=>{ma.moveToCell(Gc,Ob,hc+bc)})}static Hzo(Wa,Bb,Ob,hc){return Nb.Stj(Wa,Bb.rowSpan,(Gc,bc)=>{ma.moveToCell(Gc,Ob+bc,hc)})}static Stj(Wa,Bb,Ob){if(14!==Wa.type)throw Error.argument("tableNode is not a Table.");if(!Ob)throw Error.argumentNull("MoveToCellAction");for(let Gc=1;Gc<Bb;Gc++){var hc=L.GraphIterator.eb(Wa);Ob(hc,Gc);hc=hc.currentNode;if(!hc||16!==hc.type||!hc.hg)return Gc}return Bb}static iIh(Wa,
Bb){return Wa+","+Bb}nCn(Wa,Bb){for(;Wa.target.Rd();)Wa.target.tg();Wa.lnc=new e.a(Bb,Wa.D1i?Wa.D1i:this.uKc,new vb.a(Wa.source,Wa.target,null,Wa.j_f));Wa.lnc.Rl("ExecuteCorePasteCellContentInCell");Wa.lnc.Qh=!1;Wa.lnc.run()}Zfn(Wa){let Bb=!1;if(na.TableBorderSelectionCache.CSc()){const Ob=oa.a(Wa.target),hc=ea.a.Ls(Wa.target);let Gc=this.Nle;isNullOrUndefined(Wa.w0a[Wa.w0a.length-1])||(Gc=Math.min(Gc,Wa.w0a[Wa.w0a.length-1][0]));let bc=this.Jlg;isNullOrUndefined(Wa.w0a[Wa.w0a.length-1])||(bc=Math.min(bc,
Wa.w0a[Wa.w0a.length-1][1]));ba.TableCellReader.HRa(Wa.target)||ba.TableCellReader.HRa(Wa.source)||hc==Gc&&Ob==bc?Bb=!0:(ba.TableCellReader.isTableCell(Wa.target)||Wa.target.jd(16),ba.TableCellReader.gda(Wa.source)?(ba.TableCellReader.HRa(Wa.target)||(ma.moveToNextRow(Wa.target),ma.moveToColumnByIndex(Wa.target,Wa.Do),I.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),ma.moveToNextOrPreviousCell(Wa.source,!1,!1)):ba.TableCellReader.gda(Wa.target)||Ob==bc?(ma.moveToNextRow(Wa.source),
ma.moveToColumnByIndex(Wa.source,0),I.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),ma.moveToNextRow(Wa.target),ma.moveToColumnByIndex(Wa.target,Wa.Do),I.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(ma.moveToNextOrPreviousCell(Wa.target,!1,!1),ma.moveToNextOrPreviousCell(Wa.source,!1,!1)))}else ba.TableCellReader.HRa(Wa.source)?Bb=!0:(ba.TableCellReader.isTableCell(Wa.target)||Wa.target.jd(16),ba.TableCellReader.gda(Wa.source)?(ma.moveToNextRow(Wa.target),
ma.moveToColumnByIndex(Wa.target,Wa.Do),I.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):ma.moveToNextOrPreviousCell(Wa.target,!1,!1),ma.moveToNextOrPreviousCell(Wa.source,!1,!1));Bb&&(this.OZ&&this.OZ.bKn(Wa.target,Wa.w0a),Ca.TableReader.isTable(Wa.target)||Wa.target.jd(14),this.Din(Wa.target.currentNode),I.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return Bb}hpo(){this.Nle=na.TableBorderSelectionCache.C$.bottomMostRowSelected;this.Jlg=
na.TableBorderSelectionCache.C$.rightMostColumnSelected;this.TIo=na.TableBorderSelectionCache.C$.leftMostColumnSelected;this.Nyj=na.TableBorderSelectionCache.C$.topMostRowSelected}}Nb.sa=new y.a;Nb.$Af="PasteConstrainingWidth";Object(D.a)(Nb,"InternalClipboard",null,[])},1999:function(D,J,c){D=c(0);var l=c(2),e=c(130),a=c(61),k=c(244),x=c(22),y=c(19),n=c(86),t=c(192),z=c(16),v=c(47),I=c(6),E=c(7),H=c(69),M=c(43),K=c(32),L=c(308),S=c(88),Q=c(11),N=c(5),O=c(104),X=c(18),U=c(37),T=c(253),Y=c(41),aa=
c(255),ba=c(21),oa=c(78),ma=c(152),ea=c(890),ua=c(3),sa=c(82),Fa=c(62),Pa=c(15),Na=c(99),Aa=c(44),za=c(479),xa=c(447),ka=c(214),wa=c(17),ia=c(23),va=c(49),na=c(33),Ca=c(238),ta=c(8),fa=c(1584),Xa=c(1605),ob=c(299),xb=c(174),zb=c(67),Lb=c(511),Ia=c(143),Ya=c(25);class eb extends ob.a{constructor(Ta,Nb,Wa,Bb,Ob,hc,Gc,bc){super();this.Hfh=this.iw=null;this.init(Ta);this.Rl("FormattingViewOperation");this.Jkb(l.AFrameworkApplication.va,Nb,Bb,Ob,hc);this._context=Wa;this.l$a=0;this.zs=!0;this.C3j=Gc;this.en=
bc}get lca(){return this.en.instance}run(){const Ta=this._context.view;var Nb=null;Ta.ue&&(Nb=Ta.mb);if(Nb){var Wa=Nb.ib.lb,Bb=!Xa.a.ycc(this.actionId);!Wa||eb.Xf.jIf(Wa,Bb)?(eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.cF}),this.zs=!1):this.lca&&this.lca.Qcc(Wa)?(eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.Y1a}),this.zs=!1):eb.ah.CAa(ta.ParagraphReader.PU,Nb.qg)&&(eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.zO}),this.zs=!1)}else eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.Fda}),this.zs=!1;1!==this.behavior&&this.zs||(this.zs&&(Wa=Nb.ib.lb,
1===Nb.ib.length&&1===Wa.length&&wa.SelectionEditor.vl(Wa.Pa)&&oa.b(Wa.Pa)&&(eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.UJc}),this.zs=!1)),(Wa=this.zs)&&this.actionId===ua.a.O5&&((Wa=Array.from(Nb.ib.lb).some(O.FormattingReader.J$e))||eb.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.ehf})),this.sr=Wa?32:8,this.l$a=3);this.l$a||(xb.a.mark(5730),this.Hfh=Lb.SelectionReferenceFactory.instance.xDb(),Wa=Nb.ib.lb.Pa,this.iw=new Aa.GraphTransaction(15),this.iw.Db(Wa.node),this.iw.Uj=this.actionId,this.l$a=1);if(1===this.l$a){this.JC||
this.D9c(this._context.ik);if(1===this.U6a())return;this.l$a=2}if(2===this.l$a){if(this.actionId===ua.a.O5)if(Nb=Nb.qg,Nb.lx)for(Wa=0;Wa<Nb.length;Wa++)Bb=Nb.getContext(Wa),this.IDj(Bb);else this.IDj(Nb);Ia.a.X$e&&this.zPo(this.actionId,this.vd);this.Hfh.fra(this.actionId===ua.a.nZ||this.actionId===ua.a.hva);(Nb=Object(H.a)(26,this.vd))&&!Nb.OUa||zb.FocusManager.instance().mg(Ta.uJ);this.iw.dispose();this.iw=null;Ya.StaticActiveAppFrame.za().updateCommandUI();xb.a.mark(5731);this.l$a=3;this.sr=32}3===
this.l$a&&(this.C3j.process(this.actionId,this._context,this.behavior,this.response),this.vra())}zPo(Ta,Nb){const Wa={};Wa.FormattingActionId=Ta;Wa.FormattingActionData=Nb;8===this.ga.Qb(ua.a.FDd,2,Wa)&&E.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Ta,Nb)}IDj(Ta){(wa.SelectionEditor.pv(Ta)||wa.SelectionEditor.Kk(Ta))&&Pa.App.yN.wea(Ta.node)}static get Xf(){return Ca.a.instance}static get ah(){return ka.ContextSetEditor.instance}static get Ic(){return t.a.instance}}
Object(D.a)(eb,"FormattingViewOperation",ob.a,[]);var sb=c(1056),lc=c(955),vb=c(74);c.d(J,"a",function(){return Ua});const Eb=new Set([ua.a.u0,ua.a.K1,ua.a.KC,ua.a.MDa,ua.a.NDa,ua.a.t0a,ua.a.eva,ua.a.u0a]);class Ua{constructor(Ta,Nb,Wa=null,Bb,Ob,hc,Gc,bc,Dc,Ub,Fc,Sa,wb){this.kpiName="ChangeCaseCommandUsage";this.Q8="wwaengidc";this.lmb=new Map;this.B6g=new Set;this.GFb=()=>new ea.a(2);this.a6i=(Tb,Hb,$a,ab,rb)=>{ab=!0;Hb.contextId!==Q.a.view&&(ab=!1);if(1===$a&&!ab)return 8;if(Tb===ua.a.q5c)Tb=rb.formatting,
rb=rb.Hig;else{if(!Hb.view||!Hb.view.ue)return 2;Hb=Hb.view;if(!Hb.mb||!Hb.mb.ib.lb)return 8;Tb=rb;rb=Hb.mb.ib}this.f4k(rb,Tb);return 32};this.u2e=(Tb,Hb,$a,ab,rb,cb)=>new eb(Tb,Hb,$a,ab,rb,cb,this.i4j,Ua.jx());this.CDd=(Tb,Hb,$a,ab,rb)=>{var cb,rc,Rb;let fb=!0,Pb=Hb;const Ec=!Xa.a.ycc(Tb);Hb.contextId!==Q.a.Fd&&Hb.contextId!==Q.a.Tc?fb=!1:(Ua.Xf.x9(Pb,!1,Ec)&&(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.cF}),fb=!1),Ua.jx()&&Ua.jx().instance&&Ua.jx().instance.TU(Pb)&&(fb=!1),fb&&wa.SelectionEditor.vl(Hb)&&
oa.b(Pb)&&(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.UJc}),fb=!1),ta.ParagraphReader.PU(Hb)&&(Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.zO}),fb=!1));if(1===$a||!fb)return fb?32:8;if(Hb.contextId===Q.a.Tc)return 2;(Hb=null===(cb=this.Lo)||void 0===cb?void 0:cb.YTd(Pb))&&(Pb=Hb);this.Jvo(Tb)&&(cb=wa.SelectionEditor.CSb(Pb),wa.SelectionEditor.Ze(cb)||(Pb=cb));cb="boolean"===typeof rb&&rb;Hb=!1;(null===(rc=this.Baa)||void 0===rc?0:rc.annotateRange)&&(null===(Rb=this.Baa)||void 0===Rb?0:Rb.Idc(Pb.node))&&(Hb=this.tX(Pb,
Tb,rb,cb));Hb&&Tb!==ua.a.O5||Ua.Hea.tX(Pb,uc=>{this.ilc(uc,Tb,rb,Pb.cpEnd)},cb);Pb.node.Fr&&(rc=[Object.assign(new K.a,{name:"Source",string:"CharacterFormatting"})],M.a("TOCFormatting",!0,void 0,rc));this.MJm(Tb)&&this.ZFd(Pb,Tb);ab&&fa.a.trb&&(ab.Hs|=fa.a.cjb(Pb.node));return 32};this.qcd=(Tb,Hb,$a)=>1!==$a&&2===$a?(this.lmb.set("Source","Shortcut"),Tb=Hb.node.characterData.substr(Hb.cpBegin,Hb.cpEnd-Hb.cpBegin),Ua.DIf(Tb,0,Tb.length)?this.ZFd(Hb,ua.a.MDa):Ua.ZVm(Tb,Tb.length)?this.ZFd(Hb,ua.a.eva):
this.ZFd(Hb,ua.a.NDa)):32;this.igb=(Tb,Hb,$a)=>{let ab=!0;Tb=!Xa.a.ycc(Tb);Hb.contextId!==Q.a.Fd&&Hb.contextId!==Q.a.Tc?ab=!1:(Ua.Xf.x9(Hb,!1,Tb)&&(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.cF}),ab=!1),ab&&wa.SelectionEditor.vl(Hb)&&oa.b(Hb)&&(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.UJc}),ab=!1),ab&&ta.ParagraphReader.PU(Hb)&&(Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.zO}),ab=!1));if(1===$a||!ab)return ab?32:8;Hb=Hb.node;this.Xs.ACb(Hb,!1);Hb.Fr&&(Hb=[Object.assign(new K.a,{name:"Source",string:"ClearFormatting"})],M.a("TOCFormatting",
!0,void 0,Hb));return 32};this.VIc=(Tb,Hb,$a,ab,rb)=>{Tb={};Tb[sb.a.mKa]=6168;Tb[sb.a.lKa]=6169;const cb=Hb.view;var rc=null;cb.$i&&(rc=cb);var Rb=!0;let fb=32;rc&&(rc=rc.mb.ib.lb)&&(Ua.Xf.jIf(rc)?(Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.cF}),fb=8,Rb=!1):1===$a&&(fb=32,Rb=!1));Rb&&(Rb=new Aa.GraphTransaction(1===$a?3:15),Rb.Db(cb.root),fb=sb.a.Mqa(ua.a.igb,Hb,$a,ab,rb,Tb,12),Rb.dispose());return fb};this.C2e=(Tb,Hb,$a,ab,rb)=>{var cb,rc=!0,Rb=32;const fb=!Xa.a.ycc(Tb);Hb.contextId!==Q.a.Tc?rc=!1:Ua.Xf.x9(Hb,
!1,fb)&&(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.cF}),rc=!1);if(1===$a||!rc)return rc?32:8;$a=Hb.node;Tb===ua.a.KC&&(Ua.Zm.WIc($a),this.Xs.FFh($a),rc=this.rz.ZC($a).pj(this.rz.wordStyleIdNormal),this.ev.cK(rc,$a,!0));$a=Ua.Cj.Uuf(Hb);!$a&&(rc=null===(cb=this.Lo)||void 0===cb?void 0:cb.YTd(Hb))&&(Hb=rc,$a=ia.SelectionFactory.Xn(Hb));if($a)Rb=va.a.sDb($a),Rb=l.AFrameworkApplication.va.Mf(Rb,Tb,2,!1,ab,rb);else{ab=Object(H.a)(26,rb);cb=O.FormattingReader.Xr(Hb);if(!cb)return 16;cb=cb.cache;switch(Tb){case ua.a.font:Ua.R1h();
if(ab&&ab.vd){const {fontName:Pb,Jea:Ec,bold:uc,italic:ya}=Ua.prf(ab.vd);Ua.Cj.dhe(Pb);Ua.Cj.hfg(Ec);Object(za.a)()&&(Tb=1==uc,rb=1==ya,Tb||rb)&&(Ua.Cj.IL(Tb),Ua.Cj.fz(rb))}break;case ua.a.Xv:E.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Ua.Cj.Xv(rb);break;case ua.a.ura:Ua.Cj.Xv(rb);this.u1.F_a(rb)||E.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ua.a.Mga:Ua.Cj.Mga();break;case ua.a.nZ:E.ULS.sendTraceTag(594899722,
340,50,"Font background color is selected from Standard colors.");Ua.Cj.Iza(rb);break;case ua.a.H$:Ua.Cj.Iza(rb);this.u1.F_a(rb)||E.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.hva:Ua.Cj.FGd();break;case ua.a.WA:Ua.R1h();Ua.Cj.WA(ab.vd);break;case ua.a.u0:Tb=Ua.Cj.MG(z.a.fontSize,cb.fontSize);Ua.Cj.WA(this.Ce.u0(Tb));break;case ua.a.K1:Tb=Ua.Cj.MG(z.a.fontSize,cb.fontSize);Ua.Cj.WA(this.Ce.K1(Tb));break;case ua.a.bold:Tb=Ua.Cj.MG(z.a.bold,
cb.isBold);Ua.Cj.IL(!Tb);break;case ua.a.fz:Tb=Ua.Cj.MG(z.a.italic,cb.isItalic);Ua.Cj.fz(!Tb);break;case ua.a.underline:Tb=Ua.Cj.MG(z.a.underline,cb.isUnderline);Ua.Cj.R5(!Tb);break;case ua.a.hka:Ua.Cj.hka(rb);break;case ua.a.superscript:Tb=Ua.Cj.MG(z.a.superscript,cb.isSuperscript);Ua.Cj.xra(!Tb);break;case ua.a.subscript:Tb=Ua.Cj.MG(z.a.subscript,cb.isSubscript);Ua.Cj.YIa(!Tb);break;case ua.a.strikethrough:Tb=Ua.Cj.MG(z.a.strikethrough,cb.isStrikethrough);Ua.Cj.fka(!Tb);break;case ua.a.Ht:Tb=Ua.Cj.MG(v.a.Ht,
cb.isDoubleStrikethrough);Ua.Cj.Yge(!Tb);break;case ua.a.KC:Ua.Cj.y7a();break;case ua.a.O5:rb.hasProperty(z.a.vL)&&Ua.Cj.O5(rb.getValue(z.a.vL));rb.hasProperty(I.a.noProof)&&(Tb=rb.getValue(I.a.noProof),Ua.Cj.fmo(Tb));break;default:this.B6g.has(Tb)||(this.B6g.add(Tb),(rb=e.ActionManager.xba(Tb))&&rb.length||(rb="UnknownAction"),E.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${rb} (${Tb})`))}}Ya.StaticActiveAppFrame.za().updateCommandUI();return Rb};
this.WT=(Tb,Hb,$a,ab,rb)=>{ab=Ua.Ic.Fp(ua.a.Xio);var cb=!0;Hb.contextId!==Q.a.Vc&&(cb=!1);if(1===$a||!cb)return cb?32:8;$a=Hb.node;cb=N.GraphIterator.eb(Hb.node);cb.od();cb=cb.dia(4);if((cb=!!cb&&Ua.Jd.hda(cb))&&!Pa.App.mfc)return 8;var rc=!ta.ParagraphReader.textLength($a);ab.properties.Z("Action",Tb.toString());ab.properties.Z("ListContext",cb.toString());ab.properties.Z("IsEmptyParagraph",rc.toString());E.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
Tb,cb,rc);cb=$a.ra.last;this.i1n($a,Tb);var Rb=!!cb.formatting;const fb=$a.getValue(I.a.lwa);rc=this.Md.S1a($a);Rb=!Rb&&fb&&fb.equals(a.a.nil)?new ma.a(cb,a.a.nil):rc.wf(rc.Lb);this.ilc(rc,Tb,rb,cb.cp);S.a.instance.J(1)&&Ua.Ej.oQb($a,cb,Hb.cpBegin,Hb.cpEnd,Rb,rc,Ua.Qd.yg);ab.end();return 32};this.ana=(Tb,Hb,$a)=>{Tb=!0;const ab=N.GraphIterator.eb(Hb.node);ab.od();Hb.contextId===Q.a.Vc&&ab.dia(4)||(Ua.Ic.Yb(sa.a.wn,{["Reason"]:Fa.a.JLf}),Tb=!1);return Ua.Jd.hda(ab.currentNode)?1!==$a&&Tb?32:Tb?32:
8:8};this.Wqa=(Tb,Hb,$a,ab,rb)=>{Tb=!0;Hb.contextId!==Q.a.paragraph&&(Tb=!1);if(1===$a&&!Tb)return 8;$a=Hb.node;-1!==rb.Jh?rb.Jh!==ta.ParagraphReader.Ox($a)&&(rb.Jh=0):rb.Jh=ta.ParagraphReader.Ox($a);Tb=this.ep.sjb($a);rb.Lt?(!rb.Ysm&&this.atm(rb.Lt,Tb)&&2===rb.Lt.specialIndentType&&(rb.Lt.specialIndentType=0),rb.Lt.xIb===Tb.xIb&&k.a.Fxa(rb.Lt.OB,Tb.OB)||(rb.Lt.OB=Number.MAX_VALUE),rb.Lt.yIb===Tb.yIb&&k.a.Fxa(rb.Lt.lpa,Tb.lpa)||(rb.Lt.lpa=Number.MAX_VALUE)):rb.Lt=Tb;Hb=Ua.ah.Fwh(Hb.ik);void 0!==Hb&&
null!==Hb&&(Hb=Hb.node,void 0!==Hb&&null!==Hb&&(Hb=T.WordSectionNavigator.instance.zL(Hb),void 0!==Hb&&null!==Hb&&(Hb=Ua.Uf.ru(Hb)-(Ua.Uf.CJ(Hb)+Ua.Uf.oL(Hb)+Pa.App.GAa),Tb.QUc=Hb-Tb.OB,Tb.PUc=Hb-Tb.lpa,rb.Lt.PUc=Math.min(rb.Lt.PUc,Tb.PUc),rb.Lt.QUc=Math.min(rb.Lt.QUc,Tb.QUc))));Hb=this.BW.zQa($a);rb.spacing?(rb.spacing.beforeSpacing=Ua.ush(Hb.beforeSpacing,rb.spacing.beforeSpacing),rb.spacing.afterSpacing=Ua.ush(Hb.afterSpacing,rb.spacing.afterSpacing),rb.spacing.lineSpacing.unit===Hb.lineSpacing.unit&&
k.a.Fxa(rb.spacing.lineSpacing.value,Hb.lineSpacing.value)||(rb.spacing.lineSpacing.unit=0,rb.spacing.lineSpacing.value=0)):rb.spacing=Hb;Hb=new N.GraphIterator;Hb.set($a);Hb.zb(11);if($a=Hb.jd(11))rb.isRtl=Y.OutlineElementReader.Pn($a);$a=Ua.Jd.ww(Hb);Hb=16;void 0!==$a&&null!==$a&&(Hb=$a.listType);rb.listType=Ua.RUl(rb.listType,Hb);rb.Wx=16===rb.listType?null:$a;return 32};this.JMn=(Tb,Hb,$a,ab,rb)=>{rb.isRtl=Y.OutlineElementReader.Pn(U.OutlineElementNavigator.Fl(Hb.node));return 32};this.tvh=(Tb,
Hb,$a)=>{if(Tb===ua.a.LQb)Tb=!0;else if(Tb===ua.a.KQb)Tb=!1;else return 2;Tb&&this.JLi(Hb);if(1===$a)return 32;this.rh.BQb(U.OutlineElementNavigator.Fl(Hb.node),Tb);return 32};this.zMn=(Tb,Hb,$a,ab,rb)=>{Tb=Hb.node;rb.isRtl=Y.OutlineElementReader.isRtl(U.OutlineElementNavigator.Fl(Tb));rb.Jh=X.ImageReader.Ox(Tb);return 32};this.JNn=(Tb,Hb,$a,ab,rb)=>{Tb=Hb.node;rb.isRtl=Y.OutlineElementReader.isRtl(U.OutlineElementNavigator.Fl(Tb));rb.Jh=na.TableReader.Ox(Tb);-1!==rb.Jh&&rb.Jh||(rb.Jh=rb.isRtl?3:
1);return 32};this.N2e=(Tb,Hb,$a,ab,rb)=>{let cb;if(!({Dy:cb}=Xa.a.sgg($a,Hb)).returnValue)return cb;const rc=Hb.node;switch(Tb){case ua.a.KQb:this.rh.Elc(rc,!1);break;case ua.a.LQb:this.JLi(Hb);this.rh.Elc(rc,!0);break;case ua.a.O5:cb=l.AFrameworkApplication.va.Mf(Hb.ik,Tb,$a,!0,ab,rb),32===cb&&ta.ParagraphReader.um(Hb)&&Ua.Z4c&&Ua.Z4c.wea(rc)}return 32};this.WYk=(Tb,Hb,$a,ab,rb)=>{const cb={};cb[sb.a.mKa]=6168;cb[sb.a.lKa]=6169;var rc=Hb.view;const Rb=new Aa.GraphTransaction(1===$a?3:15);Rb.Db(rc.root);
let fb=sb.a.Mqa(Tb,Hb,$a,ab,rb,cb,0),Pb=null;rc.$i&&(Pb=rc);rc=!0;let Ec=null;Pb&&(Ec=Pb.mb.ib.lb)&&(Tb=!Xa.a.ycc(Tb),Ua.Xf.jIf(Ec,Tb)?(Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.cF}),fb=8,rc=!1):1===$a&&(fb=32,rc=!1),Ua.ah.CAa(ta.ParagraphReader.PU,Pb.mb.qg)&&(Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.zO}),fb=8,rc=!1));rc&&this.dWm(Ec)&&(fb=sb.a.Mqa(ua.a.igb,Hb,$a,ab,rb,cb,12));Rb.dispose();return fb};this.VYk=(Tb,Hb,$a)=>{Tb=!0;Hb.contextId!==Q.a.paragraph&&Hb.contextId!==Q.a.Tc?Tb=!1:Ua.Xf.U4a(Hb)&&(Ua.Ic.Yb(sa.a.wn,
{["Reason"]:Fa.a.cF}),Tb=!1);if(1===$a||!Tb)return Tb?32:8;Hb=Hb.node;$a=new Aa.GraphTransaction(15);$a.Db(Hb);Ua.Zm.WIc(Hb);this.Xs.ACb(Hb,!0);this.ev.F8e(Hb);$a.dispose();return 2};this.vom=(Tb,Hb,$a)=>{Tb=!0;Hb.contextId!==Q.a.view&&(Tb=!1);if(1===$a&&!Tb)return 8;if(!Hb.view||!Hb.view.ue)return 2;Hb=Hb.view;if(!Hb.mb||!Hb.mb.ib.lb)return 8;if(Ua.ah.CAa(ta.ParagraphReader.PU,Hb.mb.qg))return Ua.Ic.Yb(sa.a.ef,{["Reason"]:Fa.a.zO}),8;Hb=Hb.mb.ib;for(const ab of Hb)for(const rb of ab)if(rb&&rb.contextId!==
Q.a.Fd&&rb.contextId!==Q.a.Tc&&rb.contextId!==Q.a.paragraph&&rb.contextId!==Q.a.Vc)return 2;return 32};this.b7a=(Tb,Hb,$a,ab,rb)=>{Tb=!0;Hb.contextId!==Q.a.paragraph&&(Tb=!1);if(1===$a&&!Tb)return 8;rb.Lt||(Hb=Hb.node,$a=this.ep.sjb(Hb),rb.Lt=$a,Hb=U.OutlineElementNavigator.Fl(Hb),rb.isRtl=Hb?Y.OutlineElementReader.Pn(Hb):!1);return 32};this.KNn=(Tb,Hb,$a,ab,rb)=>{Hb=Hb.node;Tb=U.OutlineElementNavigator.Fl(Hb);rb.Lt||(Hb=this.B9l(Hb),Hb=this.ep.sjb(Hb),rb.Lt=Hb,rb.isRtl=Y.OutlineElementReader.isRtl(Tb));
return 32};this.i4j=Ta;this.Baa=Nb;this.f7=Wa;this.Lo=Bb;this.Ce=Ob;this.Md=hc;this.Xs=Gc;this.BW=bc;this.ev=Ub;this.rz=Dc;this.rh=Fc;this.ep=wb}get u1(){return null!=this.EGg?this.EGg:this.EGg=x.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get DPd(){return!!this.f7&&this.f7.enabled}Ub(){const Ta=l.AFrameworkApplication.va,Nb=this.JMn;(Ua.Zb?Ua.Zb.TB(43):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Ta.qa(ua.a.font,Q.a.Vc,this.WT),Ta.qa(ua.a.WA,
Q.a.Vc,this.WT),Ta.qa(ua.a.u0,Q.a.Vc,this.WT),Ta.qa(ua.a.K1,Q.a.Vc,this.WT),Ta.qa(ua.a.Xv,Q.a.Vc,this.WT),Ta.qa(ua.a.ura,Q.a.Vc,this.WT),Ta.qa(ua.a.Mga,Q.a.Vc,this.WT),Ta.qa(ua.a.nZ,Q.a.Vc,this.WT),Ta.qa(ua.a.H$,Q.a.Vc,this.WT),Ta.qa(ua.a.hva,Q.a.Vc,this.WT),Ta.qa(ua.a.bold,Q.a.Vc,this.WT),Ta.qa(ua.a.fz,Q.a.Vc,this.WT),Ta.qa(ua.a.underline,Q.a.Vc,this.WT),Ta.qa(ua.a.hka,Q.a.Vc,this.WT),Ta.qa(ua.a.superscript,Q.a.Vc,this.WT),Ta.qa(ua.a.subscript,Q.a.Vc,this.WT),Ta.qa(ua.a.strikethrough,Q.a.Vc,this.WT),
Ta.qa(ua.a.Ht,Q.a.Vc,this.WT),Ta.qa(ua.a.O5,Q.a.Vc,this.WT),Ta.qa(ua.a.KC,Q.a.Vc,this.WT)):Pa.App.mfc&&(Ta.qa(ua.a.font,Q.a.Vc,this.ana),Ta.qa(ua.a.WA,Q.a.Vc,this.ana),Ta.qa(ua.a.Xv,Q.a.Vc,this.ana),Ta.qa(ua.a.ura,Q.a.Vc,this.ana),Ta.qa(ua.a.Mga,Q.a.Vc,this.ana),Ta.qa(ua.a.bold,Q.a.Vc,this.ana),Ta.qa(ua.a.fz,Q.a.Vc,this.ana),Ta.qa(ua.a.superscript,Q.a.Vc,this.ana),Ta.qa(ua.a.subscript,Q.a.Vc,this.ana),Ta.qa(ua.a.strikethrough,Q.a.Vc,this.ana),Ta.qa(ua.a.Ht,Q.a.Vc,this.ana),Ta.qa(ua.a.u0,Q.a.Vc,this.ana),
Ta.qa(ua.a.K1,Q.a.Vc,this.ana));const Wa=Pa.App.wVa.GKc(Bb=>xa.OutlineElementGeneralizer.Cha(Bb.ib,!0));Ta.fb(ua.a.G7e,Q.a.view,this.vom,100);Ta.fb(ua.a.qcd,Q.a.Fd,this.qcd,1028);Ta.qa(ua.a.Z6a,Q.a.view,this.a6i);Ta.qa(ua.a.q5c,Q.a.view,this.a6i);Ta.qa(ua.a.Wqa,Q.a.view,Wa);Ta.qa(ua.a.Wqa,Q.a.paragraph,this.Wqa);Ta.qa(ua.a.Wqa,Q.a.image,this.zMn);Ta.qa(ua.a.Wqa,Q.a.unsupportedObject,Nb);Ta.qa(ua.a.Wqa,Q.a.table,this.JNn);Ta.qa(ua.a.b7a,Q.a.view,Wa);Ta.qa(ua.a.b7a,Q.a.paragraph,this.b7a);Ta.qa(ua.a.b7a,
Q.a.table,this.KNn);Ta.Xc(ua.a.Z6a,99);Ta.Xc(ua.a.q5c,1127);Ta.Xc(ua.a.Wqa,97);Ta.Xc(ua.a.b7a,97);this.uM(Ta,ua.a.font);this.uM(Ta,ua.a.WA);this.uM(Ta,ua.a.u0);this.uM(Ta,ua.a.K1);Ta.Veb(ua.a.p2h,Q.a.view,this.u2e);Ta.Xc(ua.a.p2h,1092);this.uM(Ta,ua.a.Xv);this.uM(Ta,ua.a.ura);this.uM(Ta,ua.a.Mga);this.uM(Ta,ua.a.nZ);this.uM(Ta,ua.a.H$);this.uM(Ta,ua.a.t0a);this.uM(Ta,ua.a.MDa);this.uM(Ta,ua.a.NDa);this.uM(Ta,ua.a.eva);this.uM(Ta,ua.a.u0a);this.uM(Ta,ua.a.hva);this.uM(Ta,ua.a.bold);Ta.gQb(ua.a.bold,
this.GFb);this.uM(Ta,ua.a.fz);Ta.gQb(ua.a.fz,this.GFb);this.uM(Ta,ua.a.underline);Ta.gQb(ua.a.underline,this.GFb);this.uM(Ta,ua.a.hka);this.uM(Ta,ua.a.superscript);Ta.gQb(ua.a.superscript,this.GFb);this.uM(Ta,ua.a.subscript);Ta.gQb(ua.a.subscript,this.GFb);this.uM(Ta,ua.a.strikethrough);Ta.gQb(ua.a.strikethrough,this.GFb);this.uM(Ta,ua.a.Ht);Ta.gQb(ua.a.Ht,this.GFb);Ta.fb(ua.a.pRa,Q.a.Fd,this.CDd,96);Ta.Veb(ua.a.O5,Q.a.view,this.u2e);Ta.qa(ua.a.O5,Q.a.paragraph,this.N2e);Ta.qa(ua.a.O5,Q.a.Fd,this.CDd);
Ta.qa(ua.a.O5,Q.a.Tc,this.C2e);Ta.qa(ua.a.KC,Q.a.view,this.WYk);Ta.qa(ua.a.KC,Q.a.paragraph,this.VYk);Ta.qa(ua.a.KC,Q.a.Fd,this.CDd);Ta.qa(ua.a.KC,Q.a.Tc,this.C2e);Ta.Xc(ua.a.KC,1036);Ta.qa(ua.a.igb,Q.a.Fd,this.igb);Ta.qa(ua.a.igb,Q.a.Tc,this.igb);Ta.qa(ua.a.VIc,Q.a.view,this.VIc);Ta.qa(ua.a.KQb,Q.a.view,Xa.a.lw);Ta.qa(ua.a.KQb,Q.a.paragraph,this.N2e);Ta.qa(ua.a.KQb,Q.a.unsupportedObject,this.tvh);Ta.Xc(ua.a.KQb,1028);Ta.qa(ua.a.LQb,Q.a.view,Xa.a.lw);Ta.qa(ua.a.LQb,Q.a.paragraph,this.N2e);Ta.qa(ua.a.LQb,
Q.a.unsupportedObject,this.tvh);Ta.Xc(ua.a.LQb,1028)}uM(Ta,Nb){Ta.Veb(Nb,Q.a.view,this.u2e);Ta.qa(Nb,Q.a.Fd,this.CDd);Ta.qa(Nb,Q.a.Tc,this.C2e);Ta.Xc(Nb,1036)}f4k(Ta,Nb){for(const bc of Ta)for(const Dc of bc){Ta=null;if(Dc.contextId===Q.a.Fd){if(oa.b(Dc))continue;Ta=[];var Wa=Dc.node.ra;if(Wa){var Bb=Wa.length-1;const Ub=Dc.cpBegin,Fc=Dc.cpEnd;let Sa=!1;const wb=Dc.node.characterData;if(wb&&""!==wb){var Ob=wb.substr(Ub,Fc-Ub);Ob&&""!==Ob&&y.a.S$e(Ob,0,Ob.length)&&(Sa=!0)}Ob=!1;for(let Tb=0;Tb<Bb;Tb++){var hc=
Wa.J(Tb).cp,Gc=Wa.J(Tb+1).cp;if(Wa.J(Tb).formatting&&Math.max(hc,Ub)<Math.min(Gc,Fc)){if(wb&&""!==wb&&(hc=hc<Ub?Ub:hc,Gc=wb.substr(hc,(Gc<Fc?Gc:Fc)-hc),!Sa&&y.a.S$e(Gc,0,Gc.length)))continue;Ob=!0;Ta.push(Wa.J(Tb).formatting)}else if(Ob)break}Wa.J(Bb).formatting&&Dc.cpEnd>Wa.J(Bb).cp&&Ta.push(Wa.J(Bb).formatting)}}else if(Dc.contextId===Q.a.paragraph&&!ta.ParagraphReader.PU(Dc)){if(Ta=[],Wa=Dc.node.ra)for(Bb=0;Bb<Wa.length;Bb++)Wa.J(Bb).formatting&&Ta.push(Wa.J(Bb).formatting)}else if(Dc.contextId===
Q.a.Vc)Ta=[O.FormattingReader.Xr(Dc)];else if(Dc.contextId===Q.a.Tc){this.hMn(Dc,Nb);return}if(Ta&&0<Ta.length)for(const Ub of Ta)if(O.FormattingReader.zpg(Nb,Ub.cache,Dc))return}}hMn(Ta,Nb){if(Ta=O.FormattingReader.Xr(Ta)){Ta=Ta.cache;var Wa=Ua.Cj.MG(z.a.bold,Ta.isBold);Nb.bold=Wa?1:0;Wa=Ua.Cj.MG(z.a.italic,Ta.isItalic);Nb.italic=Wa?1:0;Wa=Ua.Cj.MG(z.a.underline,Ta.isUnderline);Nb.underline=Wa?1:0;Nb.underlineType=Ua.Cj.MG(z.a.underlineType,Ta.underlineType);Wa=Ua.Cj.MG(z.a.superscript,Ta.isSuperscript);
Nb.superscript=Wa?1:0;Wa=Ua.Cj.MG(z.a.subscript,Ta.isSubscript);Nb.subscript=Wa?1:0;Wa=Ua.Cj.MG(z.a.strikethrough,Ta.isStrikethrough);Nb.strikethrough=Wa?1:0;Wa=Ua.Cj.MG(v.a.Ht,Ta.isDoubleStrikethrough);Nb.Ht=Wa?1:0;Wa=Ua.Cj.MG(z.a.font,Ta.GG);Nb.fontName=Na.a.J2a(Wa);Nb.Jea=Ta.Ie;Nb.fontSize=Ua.Cj.MG(z.a.fontSize,Ta.fontSize);Nb.fontColor=Ua.Cj.MG(z.a.fontColor,Ta.fontColor);Nb.highlight=Ua.Cj.MG(z.a.highlight,Ta.highlight)}}Jvo(Ta){return Ta===ua.a.underline||Ta===ua.a.hka||Ta===ua.a.strikethrough||
Ta===ua.a.Ht||Ta===ua.a.nZ}static prf(Ta){return"string"===typeof Ta?{fontName:Ta,Jea:-1,bold:2,italic:2}:Ta}tX(Ta,Nb,Wa,Bb){var Ob;const hc=Ta.cpBegin,Gc=Ta.cpEnd,bc=Ta.node;var Dc=O.FormattingReader.Xr(Ta);let Ub=hc;const Fc=null===(Ob=l.AFrameworkApplication.K)||void 0===Ob?void 0:Ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Ob=Ua.Qd.yg;if(Fc&&(Ob||bc.su))return!1;if(Eb.has(Nb))for(const Sa of bc.ra)if(!(Sa.cp<=hc)){if(Sa.cp>=Gc)break;Sa.formatting&&Sa.formatting.cache.fontSize!=
Dc.cache.fontSize&&(Dc=this.urf(Ta.node,Dc,Nb,Wa,Fc?null:Bb),this.Baa.annotateRange(Ta.node,Fc?bc.ra.E1a(Ub):Ub,Fc?bc.ra.E1a(Sa.cp):Sa.cp,Dc),Ub=Sa.cp,Dc=Sa.formatting)}Nb=this.urf(Ta.node,Dc,Nb,Wa,Fc?null:Bb);this.Baa.annotateRange(Ta.node,Fc?bc.ra.E1a(Ub):Ub,Fc?bc.ra.E1a(Gc):Gc,Nb);return!0}urf(Ta,Nb,Wa,Bb,Ob){const hc={},Gc=Object(H.a)(26,Bb),bc=Nb.cache;switch(Wa){case ua.a.bold:2===Bb.value&&(Bb.value=bc.isBold?0:1);hc[z.a.bold.id]=1===Bb.value;break;case ua.a.fz:2===Bb.value&&(Bb.value=bc.isItalic?
0:1);hc[z.a.italic.id]=1===Bb.value;break;case ua.a.underline:2===Bb.value&&(Bb.value=bc.isUnderline?0:1);hc[z.a.underline.id]=1===Bb.value;break;case ua.a.hka:hc[z.a.underlineType.id]=Bb.number;break;case ua.a.superscript:2===Bb.value&&(Bb.value=bc.isSuperscript?0:1);hc[z.a.superscript.id]=1===Bb.value;1===Bb.value&&(hc[z.a.subscript.id]=!1);break;case ua.a.subscript:2===Bb.value&&(Bb.value=bc.isSubscript?0:1);hc[z.a.subscript.id]=1===Bb.value;1===Bb.value&&(hc[z.a.superscript.id]=!1);break;case ua.a.strikethrough:6!==
l.AFrameworkApplication.va.LC?E.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):E.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Bb.value&&(Bb.value=bc.isStrikethrough?0:1);hc[z.a.strikethrough.id]=1===Bb.value;break;case ua.a.Ht:2===Bb.value&&(Bb.value=bc.isDoubleStrikethrough?0:1);hc[v.a.Ht.id]=1===Bb.value;break;case ua.a.font:if(Gc&&Gc.vd){const {fontName:Ub,Jea:Fc,bold:Sa,italic:wb}=Ua.prf(Gc.vd);Bb=Ub.substr(0,Ua.iOi);this.DPd&&
(hc[I.a.XT.id]=Bb,hc[I.a.PC.id]=Bb,hc[I.a.Z_.id]=Bb,hc[I.a.x0.id]=Bb,hc[I.a.Le.id]=Fc,hc[I.a.Ye.id]=Fc,hc[I.a.Ke.id]=Fc,hc[I.a.Me.id]=Fc);hc[z.a.font.id]=Bb;hc[I.a.Ie.id]=Fc;if(Object(za.a)()){Bb=1==Sa;var Dc=1==wb;if(Bb||Dc)hc[z.a.bold.id]=Bb,hc[z.a.italic.id]=Dc}}break;case ua.a.Xv:Bb=lc.a.instance.pva(Ta,Bb);hc[z.a.fontColor.id]=Bb;break;case ua.a.ura:Dc=lc.a.instance.pva(Ta,Bb);hc[z.a.fontColor.id]=Dc;this.u1.F_a(Bb)||E.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");
break;case ua.a.Mga:hc[z.a.fontColor.id]=vb.a.auto;break;case ua.a.nZ:hc[z.a.highlight.id]=parseInt(Bb,16);break;case ua.a.H$:hc[z.a.highlight.id]=parseInt(Bb,16);this.u1.F_a(Bb)||E.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.hva:hc[z.a.highlight.id]=vb.a.auto;break;case ua.a.WA:hc[z.a.fontSize.id]=this.Ce.u5b(Gc.vd);break;case ua.a.u0:hc[z.a.fontSize.id]=this.r1l(bc.fontSize);break;case ua.a.K1:hc[z.a.fontSize.id]=this.DVl(bc.fontSize);
break;case ua.a.pRa:if(Bb=null===(Dc=Ua.gA)||void 0===Dc?void 0:Dc.pRa)for(const Ub of Bb.xl())hc[Ub.id]=Bb.tf(Ub);break;case ua.a.KC:if(Bb=Nb.Jn)for(const Ub of Bb.xl())hc[Ub.id]=null;hc[I.a.zCb.id]=!0;break;case ua.a.MDa:case ua.a.NDa:case ua.a.t0a:case ua.a.eva:case ua.a.u0a:bc.LQa&&2===bc.capitalization&&(hc[v.a.capitalization.id]=0)}null!=Ob&&(hc[l.AFrameworkApplication.tnf]=Ob);return hc}r1l(Ta){Ta=this.Ce.u0(Ta);return this.Ce.u5b(Ta)}DVl(Ta){Ta=this.Ce.K1(Ta);return this.Ce.u5b(Ta)}ilc(Ta,
Nb,Wa,Bb){var Ob=Ta.cache;const hc=Object(H.a)(26,Wa);switch(Nb){case ua.a.bold:2===Wa.value&&(Wa.value=Ob.isBold?0:1);this.Ce.IL(Ta,1===Wa.value);break;case ua.a.fz:2===Wa.value&&(Wa.value=Ob.isItalic?0:1);this.Ce.fz(Ta,1===Wa.value);break;case ua.a.underline:2===Wa.value&&(Wa.value=Ob.isUnderline?0:1);this.Ce.R5(Ta,1===Wa.value);break;case ua.a.hka:this.Ce.hka(Ta,Wa);break;case ua.a.superscript:2===Wa.value&&(Wa.value=Ob.isSuperscript?0:1);this.Ce.xra(Ta,1===Wa.value);break;case ua.a.subscript:2===
Wa.value&&(Wa.value=Ob.isSubscript?0:1);this.Ce.YIa(Ta,1===Wa.value);break;case ua.a.strikethrough:6!==l.AFrameworkApplication.va.LC?E.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):E.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Wa.value&&(Wa.value=Ob.isStrikethrough?0:1);this.Ce.fka(Ta,1===Wa.value);break;case ua.a.Ht:2===Wa.value&&(Wa.value=Ob.isDoubleStrikethrough?0:1);this.Ce.Yge(Ta,1===Wa.value);break;case ua.a.font:if(hc&&
hc.vd){const {fontName:Gc,Jea:bc,bold:Dc,italic:Ub}=Ua.prf(hc.vd);this.Ce.bka(Ta,Gc.substr(0,Ua.iOi));this.Ce.hfg(Ta,bc);Object(za.a)()&&(Wa=1==Dc,Bb=1==Ub,Wa||Bb)&&(this.Ce.IL(Ta,Wa),this.Ce.fz(Ta,Bb))}break;case ua.a.Xv:E.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.Ce.Xv(Ta,Wa,null);break;case ua.a.ura:this.Ce.Xv(Ta,Wa,null);this.u1.F_a(Wa)||E.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ua.a.Mga:this.Ce.Mga(Ta);
break;case ua.a.nZ:E.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Ce.Iza(Ta,Wa);break;case ua.a.H$:this.Ce.Iza(Ta,Wa);this.u1.F_a(Wa)||E.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.hva:this.Ce.FGd(Ta);break;case ua.a.WA:this.Ce.WA(Ta,hc.vd);break;case ua.a.u0:this.Ce.jmi(Ta);break;case ua.a.K1:this.Ce.Qtj(Ta);break;case ua.a.O5:Ob=Wa.ja(I.a.noProof,!1);this.Ce.jeg(Ta,Wa.getValue(z.a.vL),
Bb,Ob);break;case ua.a.pRa:this.Ce.fhe(Ta);break;case ua.a.KC:this.Ce.Lga(Ta);break;case ua.a.MDa:case ua.a.NDa:case ua.a.t0a:case ua.a.eva:case ua.a.u0a:Ob.LQa&&2===Ob.capitalization&&this.Ce.IYk(Ta)}}i1n(Ta,Nb){ua.a.KC===Nb&&U.OutlineElementNavigator.Fl(Ta).properties.removeProperty(z.a.m1)}atm(Ta,Nb){return this.Lvh(Ta,Nb)||this.Lvh(Nb,Ta)}Lvh(Ta,Nb){return(1===Ta.specialIndentType||!Ta.specialIndentType)&&2===Nb.specialIndentType}B9l(Ta){Ta=N.GraphIterator.eb(Ta);Ta.zb(11);ba.moveToCell(Ta,0,
0);Ta.Rd();Ta.lY();return Ta.currentNode}dWm(Ta){return!Ta||wa.SelectionEditor.Pl(Ta)||1===Ta.length&&wa.SelectionEditor.vl(Ta.Pa)&&!wa.SelectionEditor.olb(Ta.Pa)?!1:!0}JLi(Ta){Ua.Teh.nb(Ta.contextId)||(E.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Ta.contextId),Ua.Teh.Z(Ta.contextId,!0))}MJm(Ta){return Ta===ua.a.t0a||Ta===ua.a.MDa||Ta===ua.a.NDa||Ta===ua.a.eva||Ta===ua.a.u0a}ZFd(Ta,Nb){const Wa=Ta.node,Bb=Wa.characterData.substr(Ta.cpBegin,Ta.cpEnd-Ta.cpBegin);this.lmb.set("Command",Nb.toString());
n.Health.instance.recordKpiUsage(this.kpiName,1,this.Q8,this.lmb);Nb=Ua.aKo(Bb,Nb);Wa.sra(Wa.characterData.substr(0,Ta.cpBegin)+Nb+Wa.characterData.substr(Ta.cpEnd));return 32}static get Cj(){return Ua.gA||(Ua.gA=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static jx(){return Ua.en||(Ua.en=x.a.instance.Sa("Box4.IExternalSelectionManager"))}static get ah(){return ka.ContextSetEditor.instance}static get Xf(){return Ca.a.instance}static get Ic(){return t.a.instance}static get Zb(){return null!=
Ua.Mzg?Ua.Mzg:Ua.Mzg=x.a.instance.Oa("Box4.IFeatureHelper")}static get Z4c(){return Pa.App.yN}static get Qd(){return null!=Ua.nJg?Ua.nJg:Ua.nJg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=Ua.PIg?Ua.PIg:Ua.PIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Hea(){return null!=Ua.sIg?Ua.sIg:Ua.sIg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Jd(){return null!=Ua.OEg?Ua.OEg:Ua.OEg=x.a.instance.resolve("Box4.List.IListReader")}static get Zm(){return null!=
Ua.AEg?Ua.AEg:Ua.AEg=x.a.instance.resolve("Box4.List.IListEditor")}static get Uf(){return aa.a.instance}static RUl(Ta,Nb){return 42===Ta?Nb:Ta!==Nb||16===Ta?16:Ta}static ush(Ta,Nb){Ta.Uwi||(Nb.Uwi?Nb=Ta:Nb.unit===Ta.unit&&k.a.Fxa(Nb.value,Ta.value)||(Nb.value=-1));return Nb}static aKo(Ta,Nb){switch(Nb){case ua.a.MDa:return Ta.toLowerCase();case ua.a.NDa:return 6!==l.AFrameworkApplication.va.LC?E.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):E.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),Ta.toUpperCase();case ua.a.t0a:case ua.a.eva:return Ua.vVk(Ta,Nb===ua.a.eva);case ua.a.u0a:return Ua.rMo(Ta);default:return Ta}}static rMo(Ta){let Nb="";for(let Wa=0;Wa<Ta.length;Wa++)Nb=Ta.charAt(Wa)===Ta.charAt(Wa).toUpperCase()?Nb+Ta.charAt(Wa).toLowerCase():Nb+Ta.charAt(Wa).toUpperCase();return Nb}static vVk(Ta,Nb){let Wa,Bb,Ob=!0,hc=Ta.length,Gc=0,bc=Ua.DIf(Ta,Gc,hc);for(;0<hc;){Bb=Wa=!1;var Dc=hc;let Fc;var Ub=void 0;for(Ub=0;0<Dc&&Ua.TXk(Ta.charAt(Gc+
Ub));Ub++,Dc--)Bb=Ua.e1d(Ta.charAt(Gc+Ub));for(Fc=Ub;0<Dc&&!(Wa=Ua.e1d(Ta.charAt(Gc+Ub)))&&" "!==Ta.charAt(Gc+Ub)&&"/"!==Ta.charAt(Gc+Ub);Ub++,Dc--);Dc=Ub-Fc;if(0>=Dc)break;Gc+=Fc;Ub=Ta.substr(Gc,Dc);Ub=Ub===Ub.toUpperCase();if(bc||!Ub)Ta=Ob||Bb||Nb?Ta.substr(0,Gc)+Ta.charAt(Gc).toUpperCase()+Ta.substr(Gc+1,Dc-1).toLowerCase()+Ta.substr(Gc+Dc):Ta.substr(0,Gc)+Ta.substr(Gc,Dc).toLowerCase()+Ta.substr(Gc+Dc);hc-=Dc+Fc;Gc+=Dc;if(Ob=Wa)Gc++,hc--,bc=Ua.DIf(Ta,Gc,hc)}return Ta}static DIf(Ta,Nb,Wa){for(;0<
Wa&&!Ua.e1d(Ta.charAt(Nb));){if(Ta.charAt(Nb)!==Ta.charAt(Nb).toUpperCase())return!1;Nb++;Wa--}return!0}static ZVm(Ta,Nb){for(var Wa=0;0<Nb&&!Ua.e1d(Ta.charAt(Wa));){if(Ta.charAt(Wa)!==Ta.charAt(Wa).toLowerCase())return!1;Wa++;Nb--}return!0}static e1d(Ta){return"."===Ta||"!"===Ta||"?"===Ta?!0:!1}static TXk(Ta){return-1==="0123456789".indexOf(Ta)&&Ta.toUpperCase()===Ta.toLowerCase()}static R1h(){const Ta=x.a.instance.Sa("Common.ISystemInitiatedFeedback");Ta&&Ta.execute(Nb=>{Nb.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}Ua.Teh=new L.a;Ua.gA=null;Ua.en=null;Ua.iOi=31;Object(D.a)(Ua,"TextFormattingActor",null,[])},2061:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.none=0]="none";e[e.heading1=1]="heading1";e[e.heading2=2]="heading2";e[e.heading3=3]="heading3";e[e.heading4=4]="heading4";e[e.heading5=5]="heading5";e[e.heading6=6]="heading6";e[e.citation=7]="citation";e[e.maxParagraphStyle=7]="maxParagraphStyle"})(l||(l={}));Object(D.b)("ParagraphStyle",l)},2062:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.unspecified=0]="unspecified";e[e.none=1]="none";e[e.defaultUnordered=2]="defaultUnordered";e[e.disc=3]="disc";e[e.circle=4]="circle";e[e.square=5]="square";e[e.defaultOrdered=6]="defaultOrdered";e[e.decimal=7]="decimal";e[e.lowerAlpha=8]="lowerAlpha";e[e.lowerRoman=9]="lowerRoman";e[e.upperAlpha=10]="upperAlpha";e[e.upperRoman=11]="upperRoman"})(l||(l={}));Object(D.b)("ListStyleType",l)},2064:function(D,J,c){c.d(J,"a",function(){return l});
D=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(D.a)(l,"AtMentionAttributes",null,[])},2071:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";e[e.noMatchesFound=7]="noMatchesFound"})(l||
(l={}));Object(D.b)("FindReplaceViewType",l)},2073:function(D,J,c){c.d(J,"a",function(){return l});var l;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||(l={}))},2090:function(D,J,c){function l(b,h){h=Object.assign(new ma.a,{name:"LinkType",string:h});e(Mb.a.mEm,b,[h])}function e(b,h,r,B=!0){h&&h.UILocation&&Object(ne.d)(b,B,ne.e,0,h.UILocation,0,r)}
function a(b,h){const r=Ya.a.instance;return new JB(b,h,r.Ve("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,r.Ve("WordEditor.Bookmark.FullBookmarkManager").value,r.resolve("Box4.IHyperlinkStrategy"),r.resolve("Box4.IHyperlinkEditor"),r.resolve("Box4.ICharacterPropertiesEditor"),r.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,r.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Zq.a.instance,r.Oa("Box4.IInternalLinkManager"))}function k(b,h){var r;return b===
ht.none?"none":null===(r=Xt[b])||void 0===r?void 0:r[h]}function x(){const b=Ya.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&t.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ya.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&t.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}c.r(J);var n=c(0),t=
c(7),z=c(55),v=c(2),I=c(35),E=c(19),H=c(166),M=c(87);class K{constructor(b){this.Tmg=0;this.iIb=this.Nic=this.aVa=null;this.nS=v.AFrameworkApplication.ta.Kq;this.sY=b;this.sY.Gv(M.a.Blj);this.sY.eC(M.a.Blj,Object(z.a)(this,this.ttn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.iIb)return t.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.iIb;this.aVa=this.nS.Yf("ComponentAttach","getCustomAuthConfig");return this.iIb=new Promise((b,h)=>{const r={};let B=!1,P=!1,
ca=0;this.Tmg=window.setInterval(()=>{4>ca?(ca++,this.sY.sendMessage(M.a.getCustomAuthConfig,r)):(window.clearInterval(this.Tmg),B=!0,t.ULS.sendTraceTag(588087303,344,10,I.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Nic=(ra,Qa)=>{window.clearInterval(this.Tmg);B||P||(P=!0,ra?(t.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ra)):(t.ULS.sendTraceTag(589050654,369,10,I.c({["error"]:Qa.toString()})),h(Qa)))};this.sY.sendMessage(M.a.getCustomAuthConfig,
r)})}ttn(b){try{const h=I.a(b.Values[H.a.JQk]);let r=v.AFrameworkApplication.K.kb("Application")||"";r=E.a.eh(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.aVa&&(this.aVa.stop(),
this.aVa=null);this.Nic(h,"")}catch(h){t.ULS.sendTraceTag(589050655,344,10,I.c({["error"]:h.message,["stack"]:h.stack})),this.Nic(null,h.message)}}}Object(n.a)(K,"AccountSwitchingManager",null,[352]);var L=c(186);class S{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(K,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Ud(()=>new K(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){L.a.instance.Gc(new S)}}
Object(n.a)(S,"AccountSwitchingPackage",null,[1,2]);var Q;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";
b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(Q||(Q={}));Object(n.b)("ErrorCodes",Q);c(1835);class N{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(n.a)(N,"OutstandingRequest",null,[]);class O{}O.cin="AADSTS50058";O.invalidResourceUrl="AADSTS50001";O.Whn="AADSTS65001";O.Min="AADSTS70011";O.userAborted="13002";O.KFn="Popup Window is null";
O.JFn="Popup Window closed";O.adalTimeout="Token renewal operation failed due to timeout";O.AMo="tokenRevoked";Object(n.a)(O,"WopiHostErrorType",null,[]);var X=c(468),U=c(61),T=c(1834);class Y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(Y,"WopiIdentityInfo",null,[843]);class aa{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(n.a)(aa,"WopiIdentityToken",
null,[842]);var ba=c(20),oa=c(190),ma=c(32),ea=c(176);class ua{constructor(b){this._initialized=!1;this.Jhc={};this.Kke={};this.nS=v.AFrameworkApplication.ta.Kq;this.uAf=b}Xhb(b){this._initialized||(b.Gv(M.a.Fic),b.eC(M.a.Fic,Object(z.a)(this,this.stn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,r=null){this.NY(b,h);return new Promise((B,P)=>{if(this.MDf(h))if(h in this.Jhc)P("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{t.ULS.sendTraceTag(37856032,344,10,I.c({["error"]:"Request timeout.",
["callerId"]:h}));P("timeout")},12E4);this.eof(b,h,r,(ra,Qa)=>{window.clearTimeout(ca);ra?B(ra):(t.ULS.sendTraceTag(37856033,369,15,I.c({["error"]:Q[Qa]})),P(Qa))})}else t.ULS.sendTraceTag(37856034,344,10,I.c({["error"]:"Caller is not allowed."})),P("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.MDf(b)?this.Ham((B,P)=>{B?h(B):(t.ULS.sendTraceTag(37856064,369,10,I.c({["error"]:P.toString()})),r(P))}):(t.ULS.sendTraceTag(37856065,344,10,I.c({["error"]:"Caller is not allowed."})),
r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const B=this.getAuthContextSync(b);B?h(B):r("notAllowed")})}getAuthContextSync(b){if(this.MDf(b)){const h=new T.a;h.upn=v.AFrameworkApplication.K.kb("UserPrincipalName");h.userId=v.AFrameworkApplication.K.kb("LoggableUserId");h.authority=v.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=v.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=v.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.mwm(b);b=v.AFrameworkApplication.K.kb("HostAuthType");
h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}t.ULS.sendTraceTag(40751647,344,10,I.c({["error"]:"Caller is not allowed."}));return null}mwm(b){const h=X.OAuthManagerSettings.XTc;return ba.a.ZRa?h&&X.OAuthManagerSettings.Yyj?Array.contains(X.OAuthManagerSettings.Yyj,b.toLowerCase()):!1:h}eof(b,h,r,B){var P=[];Array.add(P,Object.assign(new ma.a,{name:"CallerId",string:h}));Array.add(P,Object.assign(new ma.a,{name:H.a.njg,string:b.correlationId}));oa.a.sendTelemetryEvent(Object.assign(new ea.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:P}));P=U.a.create().toString();const ca="getAccessToken_"+P,ra=this.nS.Yf("ComponentAttach",ca);this.Kke[ca]=ra;const Qa={};Qa[H.a.ojg]=P;Qa[H.a.SCo]=b.resource;Qa[H.a.TCo]=b.scope;Qa[H.a.Cvj]=v.AFrameworkApplication.K.kb("HostAuthType");Qa[H.a.WCo]=v.AFrameworkApplication.K.kb("UserPrincipalName");Qa[H.a.UCo]=b.silentLogin;Qa[H.a.PCo]=b.options;Qa[H.a.njg]=b.correlationId;Qa[H.a.QCo]=h;r&&(Qa[H.a.addinName]=r.AddinName,
Qa[H.a.OCo]=r.AddinTrustId);this.uAf.execute(mb=>{this.Xhb(mb);mb.sendMessage(M.a.getAuthToken,Qa)});this.Jhc[P]=new N(b,B)}Ham(b){const h=v.AFrameworkApplication.K.kb("UserName"),r=v.AFrameworkApplication.K.kb("UserPrincipalName"),B=v.AFrameworkApplication.K.kb("LoggableUserIdSpace"),P=new Y;P.email=r;P.displayName=h;switch(B){case "OrgIdPuid":P.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":P.authority="MicrosoftAccount";break;default:P.authority=B}b(P,null)}stn(b){let h=
null;try{let B=b.Values[H.a.ojg];const P=b.Values[H.a.NCo],ca=b.Values[H.a.Cvj],ra=b.Values[H.a.VCo];let Qa=null,mb=null;const Jb=this.Jhc[B];if("undefined"!==typeof Jb&&Jb){var r=[];Array.add(r,Object.assign(new ma.a,{name:H.a.njg,string:Jb.requestParameters.correlationId}));oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:r}));h=Jb.requestCallback;delete this.Jhc[B];"undefined"!==typeof P&&P&&P.length?mb=new aa(P,ca,
ra):Qa=Q[this.gan(b)];r="getAccessToken_"+B;r in this.Kke&&(this.Kke[r].stop(),delete this.Kke[r]);h(mb,Qa)}else t.ULS.sendTraceTag(37856066,344,10,I.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:B}))}catch(B){b=b.Values[H.a.ojg],b in this.Jhc&&delete this.Jhc[b],this.q3d(),t.ULS.sendTraceTag(37856067,344,10,I.c({["error"]:B.message,["stack"]:B.stack})),h&&h(null,"generalException")}}MDf(b){var h=v.AFrameworkApplication.Fmm();b=b.toLowerCase();for(const r of h)if(b===
r.toLowerCase())return!0;h=X.OAuthManagerSettings.c2e;for(let r in h)if(b===h[r].toLowerCase())return!0;return!1}gan(b){b=b.Values[H.a.RCo];this.q3d();t.ULS.sendTraceTag(39068821,344,15,I.c({["error"]:b}));return b?-1<b.indexOf(O.cin)?9:-1<b.indexOf(O.KFn)||-1<b.indexOf(O.JFn)?12:-1<b.indexOf(O.invalidResourceUrl)?10:-1<b.indexOf(O.userAborted)?8:-1<b.indexOf(O.Min)||-1<b.indexOf(O.Whn)||b===O.AMo?11:-1<b.indexOf(O.adalTimeout)?6:0:13}NY(b,h){b=this.FUn(b.resource);t.ULS.sendTraceTag(39921882,344,
50,I.c({["callerId"]:h,["resource"]:b}))}q3d(){t.ULS.sendTraceTag(39068822,344,50,I.c({["userAgent"]:window.navigator.userAgent}))}FUn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(n.a)(ua,"WopiIdentityManager",null,[835]);class sa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}wc(b){this.W=b;b.register(ua,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Ud(()=>new ua(b.Sa("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){t.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){L.a.instance.Gc(new sa)}}Object(n.a)(sa,"WopiIdentityPackage",null,[1,2]);var Fa=c(505),Pa=c(360),Na=c(69),Aa;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]=
"cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Aa||(Aa={}));Object(n.b)("ApplicationFeatureHelperRequestType",Aa);class za{constructor(){this.message=null;this.httpStatusCode=0}}Object(n.a)(za,"HttpRequstToPromiseRejectData",null,[]);var xa=c(86),ka=c(46),wa=c(202),ia=c(767);class va{constructor(b,h){this.Ca=b;this.Zf=h}OKc(b,h,r,B=null,P=null,ca=null,ra=null,Qa=null){const mb=Aa[r],Jb=mb+"RequestFailure";xa.Health.instance.recordKpiUsage(Jb,0,"jpittsdirects",null);return new Promise((Yb,
fc)=>{t.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",mb);const Mc=null!=ra?ra:this.Ca.nc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Wc=null!=Qa?Qa:this.Ca.nc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Zf.ZAb(b,1,null,this.Grf(r,B),ca,1,id=>{t.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",mb);try{if(void 0===id||null===id||void 0===
id.data||null===id.data||void 0===id.data.te||null===id.data.te){xa.Health.instance.recordKpiFailure(Jb,"Invalid RequestSucceededEventArgs",!1,!0,null);let ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",mb);fc(this.MFa(ve,id))}else if(id.data.Ne!==wa.a.Zz){xa.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+id.data.Ne.toString(),!1,!0,null);let ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
id.data.Ne,mb);fc(this.MFa(ve,id))}else{void 0!==P&&null!==P&&void 0!==id.data.jj&&null!==id.data.jj&&P(id.data.jj);var Id=h(id.data.te);if(Id)t.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",mb),Yb(Id);else{xa.Health.instance.recordKpiFailure(Jb,"Parse Failure",!1,!0,null);let ve=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",mb);fc(this.MFa(ve,
id))}}}catch(ve){xa.Health.instance.recordKpiFailure(Jb,"Unexpected Failure",!1,!0,null),Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ve,mb),fc(this.MFa(Id,id))}},id=>{if(id.data){xa.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+id.data.Ne.toString(),!1,!0,null);var Id=ia.a.V$b(id.data.te||"No Data");Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
id.data.Ne,Id,mb)}else xa.Health.instance.recordKpiFailure(Jb,"Invalid RequestFailedEventArgs",!1,!0,null),Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",mb);fc(this.MFa(Id,id))},void 0,void 0,Mc,Wc)})}MFa(b,h){const r=new za;r.message=b;r.httpStatusCode=h&&h.data?h.data.Ne:-1;return r}Grf(b,h){const r={};r["x-UserDataSignature"]=this.Ca.kb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Ca.$("LicensingIsEnabled").toString();
r["x-CacheIsEnabled"]=this.Ca.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Ca.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Ca.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]="true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=ka.a.iP(window.location.href,"wd_afhpipl")||
"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(h)for(let B of h.keys)r[B]=h.J(B);return r}}Object(n.a)(va,"HttpRequestToPromiseUtility",null,[]);var na;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(na||(na={}));Object(n.b)("AlternateAuthSupportApp",
na);class Ca{constructor(){this.Token=null;this.ExpirationTime=0}}Object(n.a)(Ca,"WacAlternateAuthToken",null,[]);class ta{constructor(b,h){this.yMo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ca=b;this.$gd=new Fa.a(Pa.a.ih());this.Jwc=new va(b,h);void 0!==X.OAuthManagerSettings.nOf&&null!==X.OAuthManagerSettings.nOf&&void 0!==X.OAuthManagerSettings.Y3d&&null!==X.OAuthManagerSettings.Y3d&&0<X.OAuthManagerSettings.Y3d&&
(b=new Ca,b.Token=X.OAuthManagerSettings.nOf,b.ExpirationTime=X.OAuthManagerSettings.Y3d,this.$gd.Z("loki",b))}iOl(){let b=null;this.$gd.nb(na[0])&&(b=this.$gd.J(na[0]));return void 0===b||null===b||this.gXm(b)?this.vCl():Promise.resolve(b.Token)}gXm(b){return b.ExpirationTime-Date.now()<this.yMo}vCl(){const b=new Fa.a(Pa.a.ih());b.Z("X-AlternateAuthApp",na[0]);return this.Jwc.OKc(this.jjb("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.nBn,"parseAlternateAuthTokenResponse"),2,b).then(h=>
{t.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",na[0]);this.$gd.Z(na[0],h);return h.Token},h=>{h=Object(Na.a)(za,h);t.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}nBn(b){let h=null;({Gt:h}=I.d(b));t.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",
b);return h}jjb(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}?{2}",h,b,v.AFrameworkApplication.em)}}Object(n.a)(ta,"AlternateAuthHelper",null,[814]);var fa=c(614);class Xa{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(n.a)(Xa,"FeatureStateChangeArgs",null,[]);var ob=c(154),xb=c(205),zb=c(85),Lb=c(139),Ia;(function(b){b[b.Enabled=
0]="Enabled";b[b.Disabled=1]="Disabled"})(Ia||(Ia={}));Object(n.b)("FeatureState",Ia);var Ya=c(22),eb=c(12),sb=c(123);class lc{constructor(b,h,r=null,B=null,P=null){this.nib=this.sma=this.Rdh=this.wcb=this.lyd=null;this.Jwc=new va(b,h);this.Ca=b;this.xak=b.nc("LicensingMaxRetryAttempts",0);this.Jpd=b.$("IsO365ConsumerHost");this.XGe=b.$("IsO365CommercialHost");this.qGe=b.$("PremiumUpsellIsEnabled");this.rYb=!1;this.xJe=0;this.EPg=r;this.Nlh=B;this.ga=P;this.vcb=b.$("LicensingIsEnabled");this.Fxb=
b.$("OcpsIsEnabled")&&this.XGe;this.RXe=b.$("ShowPrivacyDialog")&&!!B;this.gYb=b.$("IsAnonymousUser");this.nOd=new Promise(ca=>{ca(!1)});this.Prb=new Promise(ca=>{ca(!0)});this.mib=new Fa.a(Pa.a.ih());this.DAd=!0;this.I5g=this.p3l();this.T4a()&&!this.gYb?(void 0!==v.AFrameworkApplication.ta&&null!==v.AFrameworkApplication.ta&&(this.lyd=v.AFrameworkApplication.ta.Kq,void 0!==this.lyd&&null!==this.lyd&&(this.wcb=this.lyd.DSa("WebServiceCall","ApplicationFeatureHelperService"))),this.nib=this.tog()):
this.nib=new Promise(ca=>{ca({})});this.nib.catch(ca=>{ca=Object(Na.a)(za,ca);t.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ca?ca.httpStatusCode.toString():"Unknown")});this.DAd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.rYb=ca;return null})}p3l(){const b=this.Ca.rw("AllLicensedFeatures")?this.Ca.EB("AllLicensedFeatures"):[],h=new fa.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}T4a(){return this.XGe||this.Jpd}tog(b=0,h=!1){t.ULS.sendTraceTag(51185368,
3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=ob.a.wG();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.Jpd.toString()),r.set("isO365CommercialHost",this.XGe.toString()),r.set("isFreemiumUpsellSettingEnabled",this.qGe.toString()));xa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);xa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",
r);void 0!==this.wcb&&null!==this.wcb&&this.wcb.start();let B=null;h&&(B=new Fa.a(Pa.a.ih()),B.Z("x-LicensingForceRefresh","true"));this.Rdh=new Date;return(this.vcb?this.Jwc.OKc(this.jjb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.rBn,"parseApplicationFeatureHelperResponse"),0,B,Object(z.a)(this,this.$In,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(P=>{const ca=Object.assign(new sb.a,{durationMs:this.wwj()});ca.extendedProperties=r;
ca.extendedProperties&&P&&(ca.extendedProperties.set("featureCount",zb.a.count(P).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in P).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in P).toString()),"FreemiumUpsell"in P&&ca.extendedProperties.set("isFreemiumUpsellEnabled",P.FreemiumUpsell.toString()),this.sma&&ca.extendedProperties.set("fromCache",(this.sma<this.Rdh).toString()));xa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ca);return P},P=>{const ca=Object.assign(new sb.a,{durationMs:this.wwj()}),ra=Object(Na.a)(za,P);if(!ra)return t.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Qa,mb)=>{mb(P)});ca.extendedProperties=r;ca.extendedProperties&&ca.extendedProperties.set("status",ra.httpStatusCode.toString());
xa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===ra.httpStatusCode&&++b<=this.xak?this.tog(b):new Promise((Qa,mb)=>{mb(ra)})})}rBn(b){(b=I.b(b))?(t.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),t.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):t.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}jjb(b){var h=
this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ca.rw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ca.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=lc.gTd(this.Ca))&&0<b.length&&(this.DAd&&(b+="ucbf"),h=new xb.QueryStringBuilder(h),h.Ae("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Fxb&&!this.RXe&&!this.vcb)return this.Prb;t.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var r=this.Fxb?this.EPg.Y8("ControllerConnectedServicesEnabled"):this.Prb;const ca=this.RXe?this.Nlh.getSettings().then(ra=>2!==ra.iJ,()=>h):this.Prb;return r.then(ra=>ra?ca:this.nOd)}if("FreemiumUpsell"===b&&(!this.qGe||!this.Jpd||this.gYb))return this.nOd;r=null;r=this.Fxb?this.EPg.isFeatureEnabled(b):this.Prb;let B=null;B=this.vcb?this.jNm(b,h):this.Prb;let P=null;P=this.RXe?this.Nlh.isFeatureEnabled(b):this.Prb;return r.then(ca=>ca?P.then(ra=>ra?B:this.nOd):this.nOd).then(ca=>
{this.UKi(b,ca,!0);return ca},()=>{this.UKi(b,h,!1);return h})}UKi(b,h,r){t.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.vcb)return new Promise(r=>{r(2)});t.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.nib.then(r=>this.lVd(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.qGe&&this.Jpd&&!this.gYb){if(this.rYb&&2!==this.xJe||!this.rYb&&1!==this.xJe)t.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.rYb.toString()),this.xJe=this.rYb?2:1;return this.rYb}return!1}launchUpsellExperience(b,h=null){t.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=ob.a.wG();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));xa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);
if(r=Ya.a.instance.Oa("Common.IInProductMessagingUIManager")){const B=Object(z.a)(this,this.apm,"handleDimeTaskComplete");r.IGi(b,B,h)}else t.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(eb.a.gQd,2,{["experience"]:b})}iza(b,h){if(!this.vcb)return null;if(!b||!h)return t.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const r=Lb.a.create().toString();this.mib.nb(b)||this.mib.Z(b,new Fa.a(Pa.a.ih()));this.mib.J(b).add(r,h);t.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}yjc(b,h){this.vcb&&(b&&this.mib.nb(b)?h&&Lb.a.isValid(h)?this.mib.J(b).nb(h)?(t.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
h,b)),this.mib.J(b).remove(h)):t.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):t.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):t.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
b)))}lVd(b,h,r){return this.DAd?b in h?h[b].LicenseTier:r:b in h?this.bCn(h[b],r):r}bCn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}apm(){t.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.nib.then(b=>{this.v9i(b)}).catch(()=>{this.v9i({})})}v9i(b){t.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.tog(0,!0);h.then(r=>
{this.nib=h;zb.a.count(r)>zb.a.count(b)?xa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let B of this.mib.keys)if(B in r){const P=this.lVd(B,r,0);B in b?this.lVd(B,b,0)!==P&&this.CUf(B,!0,P):this.CUf(B,!0,P)}else B in b&&this.CUf(B,!1,this.lVd(B,b,0))}).catch(r=>{xa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);t.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(r))})}CUf(b,h,r){t.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Xa(b,h,r);r=this.mib.J(b);for(let B of r)try{B.value(h)}catch(P){t.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,B.key,P.message))}}iNm(b,h){if(this.vcb){const r=
this.I5g.contains(b);let B=!0,P="",ca=!1;return this.nib.then(ra=>{b in ra?(ra=ra[b],P=Ia[ra.FeatureState],B=1!==ra.FeatureState):B=!r;this.hLi(b,r,P,ca,h,B);return B},()=>{ca=!0;r&&(B=h);this.hLi(b,r,P,ca,h,B);return B})}return this.Prb}hLi(b,h,r,B,P,ca){t.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,B,r,P,ca)}jNm(b,h){if(this.DAd)return this.iNm(b,h);if(this.vcb){if(this.I5g.contains(b))return this.nib.then(r=>
b in r,()=>h);t.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Prb}$In(b){try{b&&"Date"in b&&(this.sma=new Date(b.Date),t.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.sma.toString()))}catch(h){t.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}wwj(){if(void 0!==this.wcb&&
null!==this.wcb){const b=this.wcb.pi;this.wcb.stop();return b}return null}static gTd(b){try{if(ba.a.jle){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),B=JSON.parse(r).LocalStorageKey;if(void 0!==B&&null!==B&&0<B.length)return B}}}catch(h){t.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(n.a)(lc,"ApplicationFeatureHelper",null,[815]);var vb=c(75);class Eb{constructor(b,h){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(n.a)(Eb,"CloudPolicySettingsCacheData",null,[]);var Ua=c(1397),Ta=c(635),Nb=c(295);class Wa{static Wtj(){return v.AFrameworkApplication.K.$("SideCarIsEnabled")?Wa.Ufe&&Wa.CWc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Wa.Ufe=Nb.a.create(v.AFrameworkApplication.K.kb("SideCarUrl"));Ta.a.UX(Wa.Ufe);Wa.Ufe.F_((r,B)=>{(Wa.CWc=B.succeeded)?b(B.succeeded):h(B.succeeded)})}):
new Promise(b=>{b(!1)})}}Wa.CWc=!1;Wa.Ufe=null;Object(n.a)(Wa,"SideCarLoader",null,[]);class Bb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(n.a)(Bb,"CloudPolicySettingsData",null,[]);class Ob{constructor(b,h){this.$ve=0;this.bHd=null;this.Jwc=new va(b,h);this.Ca=b;h=b.kb("HostAuthType");this.Fxb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.s9g=I.b(b.kb("OcpsDefaultSettings")||"{}");this.$yc=
this.gTd();h=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.EB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.sjd=new fa.a;for(let r=0;r<h.length;r++)this.sjd.add(h[r]);this.Fxb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.bHd=this.AQo():this.bHd=this.sog(this.Fxb,this.jjb("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.wBn,"parseCloudPolicySettingsResponse"));this.bHd.then(()=>null).catch(r=>{r=Object(Na.a)(za,r);t.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}Y8(b,h=!0){if(!this.Fxb){const ca=this;return new Promise(ra=>{ra(ca.CRc(b))})}let r=this,B=this;const P=this.bHd.then(ca=>{try{let ra=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(ra=ca.PolicySettings.unknown);if(ra){if(b in ra&&void 0!==ra[b]&&null!==ra[b])return new Promise(mb=>{mb("0"!==ra[b])});const Qa=b.toLowerCase();if(Qa in ra&&void 0!==ra[Qa]&&null!==ra[Qa])return new Promise(mb=>
{mb("0"!==ra[Qa])});t.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(mb=>{mb(r.CRc(b))})}return new Promise(Qa=>{Qa(r.CRc(b))})}catch(ra){return t.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ra.message),r.handleError(ra.toString(),h,r.CRc(b))}},ca=>B.handleError(ca,h,B.CRc(b)));P.then(ca=>{t.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);
return null});return P}isFeatureEnabled(b,h=!0){if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.lNm(b,h);let r=new Promise(P=>{P(!0)}),B="";this.sjd.contains(b)&&(B="ControllerConnectedServicesEnabled",r=this.Y8(B,h));r.then(P=>{t.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,B);return null});return r}lNm(b,h=!0){let r=new Promise(P=>
{P(!0)}),B="";"mso_sendASmile"===b?B="Enabled":"Survey"===b||"FloodgateSurvey"===b?B="SurveyEnabled":this.sjd.contains(b)&&(B="ControllerConnectedServicesEnabled");""!==B&&(r=this.Y8(B,h));r.then(P=>{t.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,B);return null});return r}handleError(b,h,r){return h?new Promise(B=>{B(r)}):new Promise((B,P)=>{P(b)})}sog(b,h,r){if(!b)return Promise.resolve(new Bb);let B=!1,P=
null;xa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.Yaf("GetCloudPolicySettings");return(new Promise((ra,Qa)=>{if(void 0!==this.$yc&&null!==this.$yc&&0<this.$yc.length){const mb=this.dQo();if(void 0!==mb&&null!==mb){B=!0;ra(mb);return}}this.Jwc.OKc(h,r,1,null,Object(z.a)(this,this.lJn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ca.nc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ca.nc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(mb=>{t.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.lRo(mb);ra(mb);return mb},mb=>{Qa(mb);return null})})).then(ra=>{({YA:ca,returnValue:P}=this.Hke(ca));var Qa=ob.a.wG();Qa&&Qa.set("FromCache",B.toString());Qa=Object.assign(new sb.a,{durationMs:P,extendedProperties:Qa});xa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Qa);return ra})}AQo(){return Wa.Wtj().then(()=>{t.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}jjb(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}",h,b)}wBn(b){let h=null;({Gt:h}=I.d(b));b=!!h;t.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}lJn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.$ve=h)}}catch(h){t.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}CRc(b){return b in this.s9g?"0"!==this.s9g[b]:!0}dQo(){try{const b=Ua.a.instance.getItem(this.$yc);if(void 0===b||null===b)return t.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;t.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return t.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return t.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return t.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new Bb;r.PolicySettings=h.PolicySettings;
r.ControllerConnectedServicesFeatureNames=new vb.a;this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")&&this.Ca.EB("ServicesControlsMicrosoftControllerServicesList");for(let B of this.sjd)r.ControllerConnectedServicesFeatureNames.add(B);t.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return r}catch(b){return t.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}lRo(b){try{if(void 0===
b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)t.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.$ve)t.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Eb(b,this.$ve),r=JSON.stringify(h);t.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);Ua.a.instance.setItem(this.$yc,r);t.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){t.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}gTd(){const b=lc.gTd(this.Ca);return b&&0<b.length?"OCPS"+b:null}Yaf(b){const h=Ya.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.Yf("WebServiceCall",b):null}Hke(b){if(void 0!==b&&null!==b){const h=b.pi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,
YA:b}}}Object(n.a)(Ob,"CloudPolicySettingsHelper",null,[812]);class hc{constructor(){this.uVh=this.xJj=this.iJ=0;this.vVh=this.yJj=this.ZCb="";this.ZTe=this.XVa=2}clone(){const b=new hc;b.iJ=this.iJ;b.xJj=this.xJj;b.uVh=this.uVh;b.ZCb=this.ZCb;b.yJj=this.yJj;b.vVh=this.vVh;b.XVa=this.XVa;b.ZTe=this.src;return b}get src(){return this.ZTe}serialize(b=null){const h={};if(!b||b.contains(hc.mMb))h[hc.mMb]=this.iJ;if(!b||b.contains(hc.U1c))h[hc.U1c]=this.ZCb;if(!b||b.contains(hc.V1c))h[hc.V1c]=this.XVa;
return JSON.stringify(h)}static create(b,h=null){const r=new hc;r.ZTe=b;void 0!==h&&null!==h&&(hc.mMb in h&&(r.iJ=h[hc.mMb]),hc.U1c in h&&(r.ZCb=h[hc.U1c]),hc.V1c in h&&(r.XVa=h[hc.V1c]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return hc.create(h,r);t.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(r){throw t.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
r.toString()),r;}}}hc.mMb="CCS";hc.U1c="CCSTime";hc.V1c="OfficePrivacyRoamedNoticeShown";Object(n.a)(hc,"UserPrivacySettings",null,[]);var Gc=c(158);class bc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ca=b;this.Zf=h;this.QSe=this.Vf=null}jjb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ca.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");
h.append(v.AFrameworkApplication.em);return h.toString()}executeRequest(b,h,r,B=null){return this.Zf.H2b(b,h,B,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Vf||null===this.Vf||void 0===b||null===b)t.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var B=this.Vf.iJ!==b.iJ;if(2===this.Vf.src&&B)this.wbo(b),h(!0);else{var P=this.rgo(b);if(void 0===P||null===
P||!P.length)t.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Vf.src)h(this.DDj(P));else if(0===this.Vf.src){t.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",P);const ca=this.executeRequest(this.jjb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",P);ca.continueWith(()=>{if(ca.Ho||ca.Gi)t.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
h(!1);else{var ra=ca.result;void 0!==ra.args&&null!==ra.args&&void 0!==ra.args.data&&null!==ra.args.data&&ra.args.data.Ne===wa.a.Zz?(t.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(t.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ca){t.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),h(!1)}})}rgo(b){if(void 0===this.Vf||null===this.Vf||void 0===b||null===
b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new vb.a;0===b.src?(this.Vf.iJ!==b.iJ&&(h.add(hc.mMb),h.add(hc.U1c)),this.Vf.XVa!==b.XVa&&h.add(hc.V1c)):1===b.src&&this.Vf.iJ!==b.iJ&&h.add(hc.mMb);return h.count?b.serialize(h):(t.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.QSe){const b=this;this.QSe=new Promise(h=>{try{b.Vf?h(b.Vf.clone()):b.uQo().then(r=>{b.Vf=r;h(b.Vf.clone());
return null},()=>{b.sQo().then(r=>{b.Vf=r;h(b.Vf.clone());return null},()=>{b.tQo().then(r=>{b.Vf=r;h(b.Vf.clone());return null},()=>{t.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Vf=new hc;h(b.Vf.clone());return null});return null});return null})}catch(r){t.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Vf=new hc,h(b.Vf.clone())}})}return this.QSe}uQo(){return new Promise((b,h)=>
{try{const B=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ca.$("PrivacyDialogShouldCheckRoaming")||B){var r=this.executeRequest(this.jjb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.Ho||r.Gi)t.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const P=r.result;if(P&&P.args&&P.args.data)if(P.args.data.Ne!==wa.a.Zz)t.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
P.args.data.Ne);else{if(P.args.data.te){b(bc.parse(P.args.data.te,0));t.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",P.args.data.te);return}t.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else t.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(P){t.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",P.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else t.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(B){t.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",B.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}sQo(){return new Promise((b,
h)=>{try{const r=Gc.a.get("WacUPToggleState");let B=null;void 0!==r&&null!==r&&0<r.length&&(B=decodeURIComponent(r));if(void 0!==B&&null!==B&&0<B.length){const P=bc.parse(B,1);t.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",P.toString());b(P)}else{const P=hc.create(1),ca=new vb.a;ca.add(hc.mMb);const ra=P.serialize(ca);this.DDj(ra)?(t.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
ra),b(P)):(t.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ra),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){t.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}tQo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let r=hc.create(2);h?(r.iJ=
2,v.AFrameworkApplication.pTh(),t.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.iJ=1,t.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){t.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),h=hc.create(2),h.iJ=1,b(h)}})}wbo(b){t.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.iJ?v.AFrameworkApplication.pTh():v.AFrameworkApplication.Lvl();t.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}DDj(b){try{t.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ca.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");t.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Gc.a.Xoj("WacUPToggleState",
b,Gc.a.pHa,h)}catch(h){return t.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.EB("ServicesControlsMicrosoftControllerServicesList"):[],B=new fa.a;for(let P=0;P<r.length;P++)B.add(r[P]);return B.contains(b)?2!==h.iJ:!0},()=>{t.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,h){try{return t.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),hc.deserialize(b,h)}catch(r){throw t.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(n.a)(bc,"UserPrivacySettingsHelper",null,[813]);class Dc{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.W=b;this.W.register(812,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Ud(()=>
new Ob(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(813,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Ud(()=>new bc(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(814,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Ud(()=>new ta(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(815,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Ud(()=>new lc(v.AFrameworkApplication.K,
v.AFrameworkApplication.He,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),v.AFrameworkApplication.va))}init(){v.AFrameworkApplication.K.Nn(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");v.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{t.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{t.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.MJo()})}dispose(){}MJo(){try{v.AFrameworkApplication.K.$("SideCarIsEnabled")&&Wa.Wtj().then(b=>
{t.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){L.a.instance.Gc(new Dc)}}Object(n.a)(Dc,"ApplicationFeatureHelperPackage",null,[1,2]);var Ub=c(173);class Fc{lTd(b,h){let r;const B=[];for(;r=h.exec(b);){const P=r.index;B.push(new Ub.a(P,P+r[0].length))}return B}isEndPuncSpecialCase(b){const h=this.lTd(b,Fc.DBo);for(const r of h)if(r.end===b.length)return!0;return!1}ZNc(b){for(const h of Fc.hAl){const r=
this.lTd(b,h);if(0<r.length&&!r[0].Bc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.lTd(B,Fc.oXh);for(h=b.length-1;0<=h;h--){const P=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[h].Bc,B.length),r+b[h].end+this.ZNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.lTd(B,Fc.oXh);for(r=0;r<b.length;r++){const P=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[r].Bc,B.length),h+b[r].end+
this.ZNc(B)}return-1}}Fc.gkf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Fc.hkf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
Fc.ikf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Fc.hAl=[new RegExp(Fc.gkf,"ig"),new RegExp(Fc.hkf,"ig"),new RegExp(Fc.ikf,"ig")];Fc.Pig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Fc.Sig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Fc.Rig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Fc.Qig=Fc.Sig+"|"+Fc.Rig;Fc.Tig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Fc.Uig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Fc.Vig="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Fc.Wig="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Fc.Ncg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Fc.Qig+"|"+Fc.Tig+"|"+Fc.Uig+")";Fc.Mcg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Fc.Vig+")";Fc.fUf=Fc.Pig+"|"+Fc.Wig;Fc.Oig=Fc.fUf+"|"+Fc.Ncg+"|"+Fc.Mcg;Fc.oXh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Fc.DBo=new RegExp(Fc.Oig,"g");Object(n.a)(Fc,"ProofingSentenceSeparatorScriptSharp",null,[808]);class Sa{Qfd(b,h){const r=[];let B;for(;null!=(B=h.exec(b));){const P=B.index;r.push({Bc:P,end:P+B[0].length})}return r}isEndPuncSpecialCase(b){return this.Qfd(b,Sa.sSj).some(h=>
h.end==b.length)}ZNc(b){for(const h of Sa.nPj){const r=this.Qfd(b,h);if(0<r.length&&0==r[0].Bc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.Qfd(B,Sa.gug);for(h=b.length-1;0<=h;h--){const P=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[h].Bc,B.length),r+b[h].end+this.ZNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.Qfd(B,Sa.gug);for(r=0;r<b.length;r++){const P=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(P))return B=
B.substring(b[r].Bc,B.length),h+b[r].end+this.ZNc(B)}return-1}}Sa.WNj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Sa.nSj="[\u2639\u263a\u263b]";Sa.Xug="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Sa.ZOj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Sa.qRj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Sa.dvg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Sa.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Sa.Wug="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Sa.uQj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Sa.tQj="[\uff21-\uff3a\uff41-\uff5a]";Sa.rQj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Sa.qQj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Sa.sQj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Sa.Zqe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Sa.fug="[\u3002\uff61]";Sa.kgd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Sa.vPj="[\u00bb\u2019\u201d\u203a\"']";Sa.tre=Sa.WNj+"|"+Sa.nSj;Sa.vQj="[\u2028\u2029\n\r]";Sa.pQj="("+Sa.kgd+"|"+Sa.Xug+"|"+Sa.dvg+"|"+Sa.Wug+
")";Sa.oQj="("+Sa.kgd+"|"+Sa.Xug+"|"+Sa.dvg+"|"+Sa.Symbol+"|"+Sa.Wug+"|"+Sa.ZOj+"|"+Sa.qRj+")";Sa.gkf="("+Sa.Zqe+"("+Sa.tre+"|"+Sa.vPj+"|"+Sa.kgd+")*"+Sa.vQj+")";Sa.hkf="("+Sa.Zqe+"("+Sa.tre+")*("+Sa.kgd+")+)";Sa.ikf="("+Sa.fug+"("+Sa.tre+")*)";Sa.nPj=[new RegExp(Sa.gkf,"ig"),new RegExp(Sa.hkf,"ig"),new RegExp(Sa.ikf,"ig")];Sa.Pig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Sa.Sig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Sa.Rig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Sa.Qig=Sa.Sig+"|"+Sa.Rig;Sa.Tig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Sa.Uig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Sa.Vig="(("+Sa.uQj+"|"+Sa.rQj+"|"+Sa.sQj+")[.])+|(("+Sa.qQj+")[.\ufe52\uff0e])+";Sa.Wig="("+Sa.tQj+")[.\ufe52\uff0e]";Sa.Ncg=Sa.pQj+"("+Sa.Qig+"|"+Sa.Tig+"|"+Sa.Uig+")";Sa.Mcg=Sa.oQj+"("+Sa.Vig+")";Sa.fUf=Sa.Pig+"|"+Sa.Wig;Sa.Oig=Sa.fUf+"|"+Sa.Ncg+"|"+Sa.Mcg;Sa.gug=new RegExp(Sa.Zqe+"|"+Sa.fug,"ig");Sa.sSj=new RegExp(Sa.Oig,"g");Object(n.a)(Sa,"ProofingSentenceSeparator",null,[808]);class wb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.W=b;v.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new Sa).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new Fc).ha()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){L.a.instance.Gc(new wb)}}Object(n.a)(wb,"Box4GrammarCheckPackage",null,[1,2]);var Tb=c(102),Hb=c(65),$a=c(1849),ab=c(25);class rb{constructor(){this.W=null}get name(){return"Box4.AtMentions"}wc(b){this.W=b;this.W.ia("Box4.AtMentions.IAtMentionsListener",()=>new $a.a(this.W.resolve("Box4.IEditingDomManager"),
this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Hb.InteractiveViewManager.instance)).ha()}init(){v.AFrameworkApplication.K.Nn(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Afb(ab.StaticActiveAppFrame.za().jb,Tb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){L.a.instance.Gc(new rb)}}Object(n.a)(rb,"Box4AtMentionsPackage",null,[1,2]);class cb{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new cb)}}
Object(n.a)(cb,"Box4WorkersPackage",null,[1,2]);var rc=c(308),Rb=c(83);class fb{constructor(){this.AKa=new Rb.a}L5(b,h){this.AKa.Z(b,h)}kof(b){({value:b}=this.AKa.Fc(b));return b}}Object(n.a)(fb,"AggregationMethodsForActivityName",null,[]);var Pb=c(256);class Ec{constructor(){this.Qud=new rc.a;this.AKa=new rc.a}L5(b,h,r){this.AKa.nb(b)&&this.AKa.J(b)||this.AKa.Z(b,new fb);this.AKa.J(b).L5(h,r)}kof(b,h){return this.AKa.nb(b)&&this.AKa.J(b)?this.AKa.J(b).kof(h):null}TRc(b){this.Qud.nb(b)&&this.Qud.J(b)||
this.Qud.Z(b,new Pb.a);return this.Qud.J(b)}eQh(b,h){this.TRc(b).add(h)}}Object(n.a)(Ec,"ActivityAggregationInfo",null,[743]);var uc=c(111),ya=c(1007),db=c(1032);class tb extends ya.a{constructor(b,h){super(b);this.nXe=(this.sVj=h)?h.jZl():db.a.Xnf()}get gDa(){return this.sVj}get activityName(){return this.gDa.name}get startTime(){return this.gDa.startTime}get endTime(){return this.gDa.endTime}end(){}cancel(){}Nmf(){}dXo(){this.c9b.Z("AM",this.gDa.mode.toString());this.c9b.Z("C",this.gDa.count.toString());
this.c9b.Z("DA",this.gDa.NVh.toFixed(2));this.c9b.Z("DV",this.gDa.Ttl.toFixed(2))}huf(b){return this.gDa.huf(b)}Nuf(){return this.gDa.Nuf()}M2b(){for(let b of this.gDa.hDa)b.M2b()}}Object(n.a)(tb,"AggregatedActivity",ya.a,[]);class Xb{constructor(b,h){this.vte=0;this.LAa=b;this.vWa=h}GBk(b,h){this.vte=h;for(h=0;h<b.count;h++){const r=b.J(h);this.HBk(r)}}HBk(b){const h=Object(Na.a)(tb,b);if(h)if(1===this.vte)this.FBk(h);else if(2===this.vte){this.IBk(h);for(let r of this.vWa.TRc(this.LAa)){const B=
h.gDa.hDa.J(0);B.properties.nb(r)&&b.properties.Z(r,B.properties.J(r))}}}FBk(b){for(let h of this.vWa.TRc(this.LAa))this.Xgj(b,h)}IBk(b){for(let h of b.Nuf())this.Xgj(b,h)}Xgj(b,h){const r=this.vWa.kof(this.LAa,h);if(r){const B=b.huf(h);b.properties.Z(h,r(B))}}}Object(n.a)(Xb,"PropertyAggregationHelper",null,[]);var $b=c(1100);class Ab{constructor(b,h,r,B,P){this.FUb=b;this.vWa=h;this.iQg=P;this.cte=B;this.T$j=r}get Znh(){return this.T$j.value}EJc(b){if(Object(uc.a)($b.a,b))b.EJc();else if(Object(uc.a)(tb,
b)&&this.cte.UBh(b.activityName.toString())){b=Object(Na.a)(tb,b);b.dXo();b=b.BNi();var h=[];Array.add(h,b);b=I.c(h);t.ULS.sendTraceTag(6907266,213,50,b)}}pDa(b,h){const r=(new Date).getTime();var B=this.iQg.list.J(b);const P=({KBk:B}=this.rNl(B)).returnValue;this.iQg.list.Z(b,new vb.a);h&&(B=this.Z8k(B,r,this.FUb.Oli));0<B.count&&(new Xb(b,this.vWa)).GBk(B,P)}Z8k(b,h,r){const B=new vb.a;for(let P=0;P<b.count;P++){const ca=b.J(P);ca.startTime>h-r?ca.M2b():B.add(ca)}return B}rNl(b){const h=this.Znh.aAj(b);
b=this.Znh.iLo(b);const r=this.LBk(h,b);return{returnValue:r,KBk:1===r?h:b}}LBk(b,h){return b.count*this.FUb.WPi<h.count?1:2}get enabled(){return this.FUb.enabled}M2b(){}}Object(n.a)(Ab,"ActivityAggregationManager",null,[744]);class vc{constructor(b){this.enabled=!1;this.mOi=500;this.BPi=2;this.WPi=5;this.Oli=3E4;this.gOc(b.appSettings)}gOc(b){this.enabled=Boolean.parse(b[vc.wif]||"false");this.mOi=parseInt(b[vc.Sbn]||"500");this.BPi=parseInt(b[vc.yen]||"2");this.WPi=parseInt(b[vc.Yen]||"5");this.Oli=
parseInt(b[vc.Ymm]||"30000")}}vc.wif="ActivityAggregationEnabled";vc.Sbn="ActivityAggregationMaxInterval";vc.yen="ActivityAggregationMinChain";vc.Yen="ActivityAggregationModeFactor";vc.Ymm="ActivityAggregationGraceWindow";Object(n.a)(vc,"ActivityAggregationParams",null,[]);class Sc{constructor(b,h){this.vWa=b;this.tLg=h}aAj(b,h=1){if(!b||!b.count)return b;const r=new vb.a;var B=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(!ca)continue;const ra=ca.activityName;B?B.FYm(ca)?B.add(ca):(B=B.process(),
r.addRange(B),B=this.tLg(ra,h),B.add(ca)):(B=this.tLg(ra,h),B.add(ca))}B&&(b=B.process(),r.addRange(b));return r}iLo(b){if(!b||!b.count)return b;const h={};var r=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(ca){if(!r){r=new vb.a;var B=this.vWa.TRc(ca.activityName);for(let ra of B)r.add(ra)}B=this.hbm(ca,r);null!==B&&(B in h&&h[B]||(h[B]=new vb.a),h[B].add(ca))}}b=new vb.a;for(const P of zb.a.eP(h))r=this.aAj(h[P],2),b.addRange(r);return b}hbm(b,h){let r="";for(let B of h)r+=B,r=b.properties.nb(B)&&
void 0!==b.properties.J(B)&&null!==b.properties.J(B)?r+b.properties.J(B):r+"null";return r}}Object(n.a)(Sc,"ActivityAggregationSchemes",null,[741]);class ed{constructor(b,h,r,B,P){this.ys=this.ki=0;this.FUb=r;this.Uqc=B;this.vWa=P;this.name=b;this.nz=h;this.hDa=new vb.a}get mode(){return this.nz}get count(){return this.hDa.count}get startTime(){return this.ki}get endTime(){return this.ys}get NVh(){if(!this.count)return 0;let b=0;for(let h of this.hDa)b+=h.endTime-h.startTime;return b/this.count}get Ttl(){if(!this.count)return 0;
let b=0;const h=this.NVh;for(let r of this.hDa){const B=r.endTime-r.startTime;b+=(B-h)*(B-h)}return b/this.count}add(b){this.count?this.ys=b.endTime>this.endTime?b.endTime:this.endTime:(this.ki=b.startTime,this.ys=b.endTime);this.hDa.add(b)}FYm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.FUb.mOi}process(){if(this.count>=this.FUb.BPi){const b=new vb.a,h=this.Uqc(this);b.add(h);return b}return this.hDa}huf(b){const h=new vb.a;for(let r of this.hDa)if(r.properties.nb(b)){const B=r.properties.J(b);
h.add(B)}else h.add(null);return h}Nuf(){const b=this.vWa.TRc(this.name),h=new Pb.a;for(let r of this.WNl())b.contains(r)||h.add(r);return h}WNl(){const b=new Pb.a;if(!this.hDa)return b;for(let h of this.hDa)for(let r of h.properties.keys)b.add(r);return b}jZl(){return this.hDa.J(0).uniqueID}}Object(n.a)(ed,"ActivityCollection",null,[740]);class pd{constructor(){this.Itb=new rc.a}get list(){return this.Itb}add(b){const h=b.activityName;if(this.Itb.nb(h)&&this.Itb.J(h)){const r=this.u1l(this.Itb.J(h),
b);this.Itb.J(h).insert(r,b)}else this.Itb.Z(h,new vb.a),this.Itb.J(h).add(b)}u1l(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.J(r).startTime)return r+1;return 0}}Object(n.a)(pd,"CompletedActivitiesHelper",null,[739]);class oc{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){v.AFrameworkApplication.rI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.W=b;const h=B=>new tb(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
B),r=(B,P)=>new ed(B,P,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Ab,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Ud(()=>new Ab(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ve("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(vc,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Ud(()=>new vc(v.AFrameworkApplication.K));b.register(Ec,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Ud(()=>new Ec);b.register(Sc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Ud(()=>new Sc(b.resolve("Common.IActivityAggregationInfo"),
r));b.register(pd,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Ud(()=>new pd)}static main(){L.a.instance.Gc(new oc)}}Object(n.a)(oc,"ActivityAggregatorPackage",null,[1,2]);var cd=c(537),Xc=c(10),ic=c(1408);class Ac{constructor(b){this.kch=0;this.Xve=null;this.Ygk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get Vfg(){return this.Ygk.value}Ub(){this.isInitialized?this.sjc():this.HXn(Object(z.a)(this,this.sjc,"registerActionsInternal"))}sjc(){t.ULS.sendTraceTag(50595938,
333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.Omn,"onChatContainerReady"))}).catch(b=>{t.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.FVk,"chatCountChanged"))}).catch(b=>{t.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>
{b.onKeyDown(Object(z.a)(this,this.Rmn,"onChatKeyPress"))}).catch(b=>{t.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){t.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}FVk(b){t.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.Vfg.Nmn();else if(1===b&&!this.kch){const h=document.getElementById(this.Xve?this.Xve:ic.a.tCb);h?this.Vfg.Smn(h,Object(z.a)(this,this.aOo,"transferFocusToChat")):t.ULS.sendTraceTag(50595971,
333,10,"Chat parent is null")}this.kch=b}Omn(b){this.Xve=b}Rmn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.$No(b.shiftKey)}HXn(b){cd.a.instance.ob(Xc.a.$Go,window.self,()=>{b();return!0})}aOo(){t.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{t.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){t.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",
b)}}$No(b){t.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.Vfg.Pmn(b)}}Object(n.a)(Ac,"ChatManager",null,[746]);var wd=c(81);class Je{constructor(){this.sa=new wd.a;this.vnk=!1}jzk(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}Uyk(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get QMo(){return this.vnk}o7i(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(n.a)(Je,"HeaderEventSource",null,[]);var Zd=c(177),le=c(337),
kc=c(79);class kd{constructor(b,h,r,B,P){this.Rzd=null;this.Vb=b;this.np=h;this.sk=r;this.ynk=B;this.ga=P}W9i(b,h,r,B=null){const P=this.Vb.fe(h);P.parent=r;P.fI=!0;B&&P.S3(B);this.sk.iDa(h,b,!1);this.ynk.iDa(h,b,!1);h=new le.DOMFocusListing(()=>b);h.Qm(2);h.Qm(1);h.Qm(8);h.Qm(5);h.Qm(3);h.Qm(6);this.Vb.nna(()=>b,P,h).yP=!0;h=Tb.KeyInputManager.ic(kc.a.Kw,0);r=Tb.KeyInputManager.ic(kc.a.Kw,4);P.mr(h);P.mr(r)}onFlexPaneOpen(b){this.W9i(b,ic.a.agc,ic.a.RQa);this.Vb.mg(ic.a.agc);this.np.U7(ic.a.agc)}onFlexPaneClose(){this.np.fx(ic.a.agc);
this.Vb.mg(ic.a.RQa)}Smn(b,h){this.Rzd||(this.Rzd=h,this.W9i(b,ic.a.tCb,Zd.AFrame.xM,Object(z.a)(this,this.Qmn,"onChatFocus")));this.Vb.mg(ic.a.tCb);this.np.U7(ic.a.tCb)}Qmn(){this.Rzd&&this.Rzd()}Nmn(){this.np.fx(ic.a.tCb);this.Vb.UPd(Zd.AFrame.In)}Pmn(b){this.ga.processAction(b?eb.a.zkf:eb.a.are,2)}}Object(n.a)(kd,"ReactSharedHeaderFocusManager",null,[705]);var nd=c(130),Ud=c(1071),Qd=c(40),Gd=c(70);class of{constructor(b){this.ga=b}Ub(){this.ga.qa(eb.a.gQd,Gd.a.frame,Object(z.a)(this,this.hRi,
"navigateToUpsellPage"));this.ga.qa(eb.a.C3h,Gd.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.qa(eb.a.E5n,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Jdj,Gd.a.frame,nd.ActionManager.Nf)}hRi(b,h,r,B,P){if(1===r)return 32;b=8;2===r&&(r=this.wpf(P,"experience","gopremiumribbon"),P=ka.a.d9("2116536"),P=ka.a.Oo(P,"ocid",Ud.b(v.AFrameworkApplication.ta.Kb.xk,v.AFrameworkApplication.ta.Kb.aja,r)),Qd.a.vm(P,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(eb.a.Jdj,
2),t.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,r,B,P){if(1===r)return 32;var ca=8;2===r&&(t.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Ya.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.wpf(P,"experience","gopremium"),P=this.wpf(P,"dimeCampaignId",null),ca.launchUpsellExperience(b,P),ca=32):(t.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.hRi(b,
h,r,B,P)));return ca}wpf(b,h,r){b&&b[h]&&(r=Object(Na.a)(String,b[h]));return r}}Object(n.a)(of,"UpsellActor",null,[706]);class Tf{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ya.a.instance.resolve("Common.App.Header.IUpsellActor").Ub();Ya.a.instance.resolve("Common.App.Header.IChatManager").Ub()}dispose(){}wc(b){this.W=b;this.W.register(Je,"Common.App.Header.HeaderEventSource").ha();this.W.register(of,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Ud(()=>
new of(v.AFrameworkApplication.va));this.W.register(kd,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Ud(()=>new kd(v.AFrameworkApplication.ta.Hp,v.AFrameworkApplication.ta.xx,v.AFrameworkApplication.ta.X1,v.AFrameworkApplication.ta.hme,v.AFrameworkApplication.va));this.W.register(Ac,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Ud(()=>new Ac(this.W.Ve("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){L.a.instance.Gc(new Tf)}}
Object(n.a)(Tf,"CommonAppHeaderPackage",null,[1,2]);var uh=c(763);class Gh{static H5h(b,h){switch(b){case 3:return Gh.Ulm(h);case 2:return Gh.F8l(h);case 1:return Gh.RXl(h)}return""}static Ulm(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static F8l(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static RXl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,r){if(ba.a.vi||ba.a.QG)window.setTimeout(()=>{Gh.m9i(r,Gh.zVd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Gh.Pth(r),b,0,!1)}static n_k(b,h,r,B){h&&
B&&B();Gh.openInClient(b,h,r)}static zVd(){return ba.a.vi?1:ba.a.QG?2:ba.a.j5a?3:ba.a.el?4:0}static Clm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static Dlm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get FGf(){return"zh-CN"===window.navigator.language}static m9i(b,h){1===h?(t.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Gh.H5h(b,h),8<ba.a.K3a?Qd.a.vm(b,void 0,void 0,"RedirectToAppStore"):Qd.a.Bib(b)):document.hidden||(Gh.FGf?(b=v.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(t.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Qd.a.Bib(b)):t.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(t.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Gh.H5h(b,
h),null,null)))}static Pth(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Vie(){return(ba.a.j5a||ba.a.el)&&ba.a.Er}static get lvo(){return ba.a.vi||ba.a.QG}static a6h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static hAi(b){return(b=Gh.n2l(b))&&""!==b?Boolean.parse(b):!1}static pfg(b){Gh.Sko(b)}static n2l(b){try{return localStorage.getItem(b)}catch(h){return t.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static Sko(b){try{localStorage.setItem(b,"true")}catch(h){t.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}Gh.BEh="ChromeExtensionBarDismiss";Object(n.a)(Gh,"WildFireUtilities",null,[]);var Dh=c(368);class lg{constructor(){this.Nte=new Dh.a;this.Lte=new Dh.a;this.Kte=new Dh.a;this.wNk(this.Nte);this.vNk(this.Lte);this.uNk(this.Kte);this.qEe=new Dh.a;
this.pEe=new Dh.a;this.oEe=new Dh.a;this.YPk(this.qEe);this.XPk(this.pEe);this.WPk(this.oEe);this.owe=new Dh.a;this.GNk(this.owe);this.TAb(this.owe);this.TAb(this.Kte);this.TAb(this.Lte);this.TAb(this.Nte);this.TAb(this.pEe);this.TAb(this.qEe);this.TAb(this.oEe)}NUd(b,h){switch(b){case 1:return this.Kmm(h);case 2:return this.uOl(h)}return Gh.Vie?this.owe:null}wNk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}vNk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}uNk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}YPk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}GNk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}XPk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}WPk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}TAb(b){b.add("Corporation","Microsoft Corporation")}Kmm(b){switch(b){case 3:return this.qEe;case 2:return this.pEe;case 1:return this.oEe}return null}uOl(b){switch(b){case 3:return this.Nte;case 2:return this.Lte;case 1:return this.Kte}return null}static get instance(){lg._instance||
(lg._instance=new lg);return lg._instance}}lg._instance=null;Object(n.a)(lg,"WildFireStringFactory",null,[]);class xh{constructor(b,h,r,B,P=null,ca=null){this.kNe=null;this._id=b;this.NOe=h;this.t5j=P;this.Axc=B;this.QCc=ca;this.B$a=null;this.hFc=r;this.YDc=lg.instance.NUd(h,b)}o$k(){this.B$a=new uh.a(this.title,this.message,null);this.B$a.addButton(this.oQk,Object(z.a)(this,this.vmn,"onButtonOneClick"),"");this.hFc&&this.B$a.hqh(this.uQk,Object(z.a)(this,this.Amn,"onButtonTwoClick"));this.B$a.Nga=
Object(z.a)(this,this.Lpl,"dismissBar");this.B$a.image=3;this.B$a.id=16;this.B$a.closeable=!0}get title(){return this.YDc.J("Headline")}get message(){return this.YDc.J("CallToAction")}get oQk(){return this.hFc?this.YDc.J("InstallButton"):this.YDc.J("UseAppButton")}get uQk(){return this.hFc?this.YDc.J("OpenAppButton"):""}vmn(){this.hFc?this.RFm():this.w1o()}Amn(){this.hFc&&this.oxn()}get $zh(){return this.B$a}get XHa(){this.kNe||(this.kNe=this.t5j());return this.kNe}RFm(){t.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Axc&&this.QCc&&this.QCc();Gh.m9i(this._id,this.NOe)}oxn(){this.XHa&&(t.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Axc&&this.QCc&&this.QCc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Gh.Pth(this._id),this.XHa,0,!1))}w1o(){Gh.Vie?this.kQk():(t.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Gh.pfg("BizBarClicked"),1!==this.NOe&&2!==this.NOe||Gh.n_k(this.XHa,this.Axc,this._id,this.QCc))}kQk(){this.Axc?
t.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):t.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Qd.a.Bib(v.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}Mpl(){this.Axc?t.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):t.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Gh.pfg(Gh.BEh)}Lpl(){Gh.Vie?this.Mpl():(Gh.pfg(Gh.a6h(this._id)),t.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Kcf(){const b=v.AFrameworkApplication.ta.Kb;
new xh(b.xk,Gh.zVd(),8<ba.a.K3a,1===b.aja,()=>b.TQ,b.kbg());t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(n.a)(xh,"WildFireBusinessBar",null,[]);class eg{get name(){return"Common.App.WildFire"}OZe(b){const h=v.AFrameworkApplication.ta.Kb;let r=!1;b&&(b.o$k(),b.$zh&&(r=h.Vma(b.$zh,!0)));return r}t$k(){var b=v.AFrameworkApplication.ta.Kb;b=new xh(b.xk,Gh.zVd(),!1,1===b.aja);this.OZe(b)&&t.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}Kcf(b,h,r,B,P,ca){b=new xh(b,
r,B,h,P,ca);this.OZe(b)&&t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}Fgl(){const b=v.AFrameworkApplication.ta.Kb;var h=v.AFrameworkApplication.K;const r=b.xk,B=1===b.aja;if(h.$(Gh.Clm(r))){var P=Gh.zVd(),ca=8<ba.a.K3a;if(2!==r||2!==P||!B){h=h.$(Gh.Dlm(r));var ra=b.kbg(),Qa=()=>b.TQ;h&&!Gh.hAi(Gh.a6h(r))&&this.Kcf(r,B,P,ca,Qa,ra)}}}init(){var b=v.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;Gh.Vie&&b&&!Gh.hAi(Gh.BEh)?
this.t$k():(document.body&&Gh.lvo&&this.Fgl(),v.AFrameworkApplication.va.qa(eb.a.SKf,Gd.a.frame,Object(z.a)(this,this.SKf,"launchWildFireBusinessBar")))}SKf(b,h,r,B,P){if(1===r)return 32;if(!P)return 8;this.Kcf(P.app,P.mode,P.platform,P.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){L.a.instance.Gc(new eg)}}Object(n.a)(eg,"PackageManager",null,[1,2]);class cc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(cc,"BrowserInfo",null,[]);class Ic{constructor(){this.Version=
this.Name=null}}Object(n.a)(Ic,"PluginInfo",null,[]);class Yc{static e5(){if(v.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=Yc.QKl();try{const h=JSON.stringify(b);t.ULS.sendTraceTag(6903563,102,50,h)}catch(h){t.ULS.sendTraceTag(6903564,102,15,h.message)}}else t.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static P$l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const B=b[r].name,P=b[r].version;
Array.add(h,Object.assign(new Ic,{Name:B,Version:P}))}return h}static QKl(){const b=new cc,h=new Sys.StringBuilder;Yc.ZH(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);Yc.ZH(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);Yc.ZH(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);Yc.ZH(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);Yc.ZH(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);Yc.ZH(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);Yc.ZH(r=>{b.ScreenWidth=r},()=>window.screen.width,h);Yc.ZH(r=>{b.ScreenHeight=r},()=>window.screen.height,h);Yc.ZH(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);Yc.ZH(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);Yc.ZH(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);Yc.ZH(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);Yc.ZH(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);Yc.ZH(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);Yc.ZH(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);Yc.ZH(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);Yc.ZH(r=>{b.WinOrientation=r},()=>window.self.orientation,h);Yc.ZH(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);Yc.ZH(r=>{b.SupportsTouch=r},()=>ba.a.ybd,h);Yc.ZH(r=>{b.NavAppName=r},()=>window.navigator.appName,h);Yc.ZH(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);Yc.ZH(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);Yc.ZH(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);Yc.ZH(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);Yc.ZH(r=>{b.NavPlugins=r},Yc.P$l,h);Yc.ZH(r=>{b.CalculatedDevicePixelRatio=r},()=>Yc.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static ZH(b,h,r){try{const B=h();b(B)}catch(B){r.isEmpty()||r.append(" | "),r.append(B.message||
"null")}}}Object(n.a)(Yc,"BrowserInfoLogger",null,[]);class ad{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){Yc.e5()}dispose(){}static main(){L.a.instance.Gc(new ad)}}Object(n.a)(ad,"BrowserInfoLoggerPackage",null,[1,2]);class yd{constructor(){this.sa=new wd.a}bfb(b){this.sa.addHandler("OnEditHappenedEvent",b)}j7c(b){this.sa.removeHandler("OnEditHappenedEvent",b)}JOn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(yd,"EditNotificationEventSource",null,[]);var ne=c(43),Oe=c(93);
class nf{constructor(b,h,r,B,P,ca,ra=0){this.nAe=!1;this.mAe=this.Dxb=null;this.Ilh=!1;this.Ib=h;this.Csd=b;this.Mbb=r;this.ofa=B;this.Glh=P;this.Z1j=ca;this.Tkd=0;this.fnd=!1;try{0<ra&&(this.Tkd=ra,3E5>this.Tkd&&(this.Tkd=3E5),this.Ib&&!this.mAe&&(this.mAe=new Oe.a(3,2,this.Tkd,Object(z.a)(this,this.y5n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Ib.Wb(this.mAe)))}catch(Qa){t.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Qa)}}get qrg(){return this.Ilh}editHappened(){this.qrg?this.fnd=!0:(this.Ilh=!0,xa.Health.instance.addQosPillar("Save"),xa.Health.instance.addQosPillar("ContentCreation"),ne.c(eb.a.editDocument));this.nAe=!0;this.Glh&&this.Glh.boh();this.ofa&&this.ofa.JOn();v.AFrameworkApplication.Og&&v.AFrameworkApplication.Og.xan();this.Z1j&&!this.Dxb&&(this.o9c(null),this.Dxb=new Oe.a(3,2,this.Csd,Object(z.a)(this,this.o9c,"sendPostMessageIfNecessary"),113),this.Ib.Wb(this.Dxb))}o9c(){this.nAe&&(this.Mbb.CWR(()=>
this.Mbb.result.sendMessage(M.a.editNotification,null)),t.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.nAe=!1)}y5n(){try{this.fnd&&(ne.c(eb.a.editDocument),this.fnd=!1)}catch(b){this.fnd=!1,t.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(n.a)(nf,"EditNotificationManager",null,[704]);class wf{constructor(b,h,r,B,P){this.qDe=this.Dxb=null;this.KXb=this.Zse=!1;this.Ib=h;this.Csd=
b;this.Mbb=r;this.sk=B;this.CMe=P;this.c$i(null)}c$i(){const b=document.getElementById(v.AFrameworkApplication.t3b);!this.KXb&&this.sk&&b&&(this.sk.ob(Xc.a.f1,b,Object(z.a)(this,this.EQf,"mouseActivityHandler"),null),this.KXb=!0);this.CMe(()=>{this.dispose()})}EQf(){this.KXb&&(this.sk.uc(Xc.a.f1,document.getElementById(v.AFrameworkApplication.t3b),Object(z.a)(this,this.EQf,"mouseActivityHandler")),this.KXb=!1);this.boh();return!1}boh(){this.Zse=!0;this.qDe||(this.qDe=new Oe.a(3,2,this.Csd,Object(z.a)(this,
this.c$i,"registerHandlerTask"),112),this.Ib.Wb(this.qDe));this.Dxb||(this.o9c(null),this.Dxb=new Oe.a(3,2,this.Csd,Object(z.a)(this,this.o9c,"sendPostMessageIfNecessary"),111),this.Ib.Wb(this.Dxb))}o9c(){this.Zse&&(this.Mbb.CWR(()=>this.Mbb.result.sendMessage(M.a.U1o,null)),t.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Zse=!1)}dispose(){this.KXb&&(this.sk.uc(Xc.a.f1,document.getElementById(v.AFrameworkApplication.t3b),Object(z.a)(this,
this.EQf,"mouseActivityHandler")),this.KXb=!1)}}Object(n.a)(wf,"UserActivityHostNotificationManager",null,[703,10]);var Ye=c(179),Rg=c(109),Db=c(636);class Zb{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){Zb.pul&&0<Zb.Jhf&&(this.W.register(yd,"Common.App.HostNotification.EditNotificationEventSource").ha(),this.W.register(wf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Ud(()=>
new wf(6E4,Rg.a.instance,Db.a.Gp(this.W.Sa("Postmessage.IHostPostmessenger")),Ye.a.instance,v.AFrameworkApplication.rI)),this.W.register(nf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Ud(()=>new nf(Zb.Jhf,Rg.a.instance,Db.a.Gp(this.W.Sa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Oa("Common.Interface.IUserActivityHostNotificationManager"),Zb.qul,Zb.jul)),this.W.resolve("Common.Interface.IEditNotificationManager"),
t.ULS.shipAssertTag(38086291,209,0<Zb.Jhf,"EditNotification Interval is less than or equal to 0."))}wc(b){this.W=b}dispose(){}static get Jhf(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get jul(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get pul(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get qul(){return!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){L.a.instance.Gc(new Zb)}}Object(n.a)(Zb,"CommonHostNotificationPackage",null,[1,2]);class xc{constructor(b,h,r){this.yzb=null;this.Ib=b;this.ga=h;this.sWg=r.create()}ipb(){this.yzb?t.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(t.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.yzb=new Oe.a(2,1,3E4,Object(z.a)(this,this.hje,"showFloatPane"),
67),this.Ib.Wb(this.yzb))}hje(){this.yzb=null;t.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.sWg.display()}PTa(){this.ga.qa(eb.a.hje,Gd.a.frame,Object(z.a)(this,this.vxo,"showFloatPaneHandler"))}vxo(b,h,r,B,P){return b!==eb.a.hje?2:1===r?32:2===r&&P?(t.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.ipb():(this.yzb?(t.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Ib.ff(this.yzb)):(t.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.sWg.remove(null)),this.yzb=null),32):8}}Object(n.a)(xc,"FloatPaneActor",null,[702]);var Jd=c(96),ie=c(90),De=c(39),qf=c(30);class tg{constructor(b,h,r,B,P){this.UJe=this.xwc=this.Avd=this.qZa=this.Qfa=this.JWa=this.gve=this.Xaa=this.bBc=this.Vyc=this.Wyc=this.WBe=null;this.Ib=h;this.Ca=b;this.ig=r;this.W=P;this.PAa=B}$Lh(){this.Xaa=document.createElement("div");this.Xaa.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.Xaa.style.width=this.Qfa.width+"px";(this.UJe=this.A7l(this.PAa))?(this.qZa=document.createElement("a"),this.qZa.setAttribute(qf.a.uh,qf.a.xz),this.ig.ob(Xc.a.click,this.qZa,Object(z.a)(this,this.WXi,"onRedirectClick")),this.qZa.href=this.UJe,this.qZa.target="_blank",this.qZa.appendChild(this.Qfa),this.Xaa.appendChild(this.qZa)):this.Xaa.appendChild(this.Qfa);this.JWa=document.createElement("a");this.JWa.setAttribute(qf.a.uh,qf.a.Z3);this.JWa.className="StandardButton WACFloatPaneCloseButton";
this.JWa.title=CommonUIStrings.l_Close;this.JWa.tabIndex=-1;this.gve=ie.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.gve.setAttribute(qf.a.uh,qf.a.xz);this.JWa.appendChild(this.gve);this.ig.ob(Xc.a.click,this.JWa,Object(z.a)(this,this.onClose,"onClose"));this.Xaa.appendChild(this.JWa);this.bBc.appendChild(this.Xaa)}f1l(b){const h=this.Ca.$("O365PromotionHasStarted");switch(b){case 2:return Jd.a.Sba(String.format("adppt{0}.png",
h?"sale":""));case 1:return Jd.a.Sba(String.format("adxls{0}.png",h?"sale":""));case 3:return Jd.a.Sba(String.format("addoc{0}.png",h?"sale":""))}return null}A7l(b){const h=this.Ca.kb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.xwc=null;this.Xaa&&!this.Avd&&(b?t.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):t.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.Xaa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Xaa.style.height="0px",this.Avd=new Oe.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Ib.Wb(this.Avd))}remove(){this.Xaa&&this.bBc&&(this.qZa&&this.ig.uc(Xc.a.click,this.qZa,Object(z.a)(this,this.WXi,"onRedirectClick")),this.ig.uc(Xc.a.click,this.JWa,Object(z.a)(this,this.onClose,"onClose")),this.bBc.removeChild(this.Xaa),this.Xaa=null);this.Avd=null}display(){if(this.WBe=
this.W.Oa("Common.IFloatPaneContainer"))if(this.bBc=this.WBe.container){var b=this.f1l(this.PAa);b?(t.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Qfa=document.createElement("img"),this.Qfa.className="WACFloatPaneImage",this.Wyc=Object(z.a)(this,this.jrn,"onLoadImageFinish"),De.a.addHandler(this.Qfa,Xc.a.load,this.Wyc),this.Vyc=Object(z.a)(this,this.irn,"onLoadImageError"),De.a.addHandler(this.Qfa,Xc.a.error,this.Vyc),this.Qfa.src=b):t.ULS.sendTraceTag(23674907,
207,15,"The target image is empty, can't show the float pane.")}else t.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else t.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}jrn(){const b=this.Ca.nc("O365AdPaneShowingDuration",60);this.$Lh();this.Xaa.style.display="block";this.Xaa.style.height=this.Qfa.height+"px";this.xwc=new Oe.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Ib.Wb(this.xwc);
this.Iaj()}irn(){t.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.Iaj();this.Qfa=null}Iaj(){this.Wyc&&this.Qfa&&De.a.removeHandler(this.Qfa,Xc.a.load,this.Wyc);this.Wyc=null;this.Vyc&&this.Qfa&&De.a.removeHandler(this.Qfa,Xc.a.error,this.Vyc);this.Vyc=null}WXi(){t.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.xwc&&this.Ib.ff(this.xwc);this.hide();return!0}dispose(){this.hide()}}
Object(n.a)(tg,"FloatPane",null,[727]);class Ah{constructor(b,h,r,B,P){this.Ib=h;this.Ca=b;this.ig=r;this.W=P;this.PAa=B}create(){return new tg(this.Ca,this.Ib,this.ig,this.PAa,this.W)}}Object(n.a)(Ah,"FloatPaneFactory",null,[701]);var ji=c(232);class Bh{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Dyi(){return v.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&v.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Dyi&&(t.ULS.sendTraceTag(23674944,
207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").ipb(),t.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").PTa())}wc(b){this.W=b;this.Dyi&&(this.W.register(Ah,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ud(()=>new Ah(v.AFrameworkApplication.K,v.AFrameworkApplication.lc,ji.a.instance,v.AFrameworkApplication.ta.Kb.xk,this.W)).ha(),
this.W.register(xc,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ud(()=>new xc(v.AFrameworkApplication.lc,v.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){L.a.instance.Gc(new Bh)}}Object(n.a)(Bh,"FloatPanePackage",null,[1,2]);var Tj=c(1678);class sf{}Object(n.a)(sf,"LokiTokenResult",null,[]);class vf{constructor(b){this.Ksd=b}Lsf(){const b=this.y4l();return b?vf.T4a?new Promise((h,r)=>{this.Ksd.continueWith(()=>
{this.Ksd.Ho||this.Ksd.Gi?r(Error.create("Error downloading auth library")):this.Ksd.result.RV("Loki",b).then(B=>{B=v.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.B4l():B.IsSuccess&&B.Token?Object.assign(new sf,{isSuccess:!0,token:B.Token,errorMessage:null}):Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(B)});h(B);return B})})}):Promise.resolve(Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Tj.a.P5h())}))}B4l(){const b=v.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new sf,{isSuccess:!0,token:b,errorMessage:null})}y4l(){let b=null;const h=Tj.a.KQd();2===h?b=v.AFrameworkApplication.K.kb("LokiAADAppId"):1===h&&(b=v.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get T4a(){return v.AFrameworkApplication.K.$("IsO365CommercialHost")||
v.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(n.a)(vf,"LokiTokenManager",null,[698]);class Sf{get name(){return"Common.App.LivePersonaUtils"}init(){Ya.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(vf,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Ud(()=>new vf(Db.a.Gp(b.Sa("Common.App.OAuth.IOAuthManager"))))}static main(){L.a.instance.Gc(new Sf)}}Object(n.a)(Sf,"LivePersonaUtilsPackage",null,[1,2]);class ah{constructor(b){this.Gte=
b}Jxi(b){if(!this.Gte)return!0;b=ka.a.Mrf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.Gte.length;h++)if(b.endsWith(this.Gte[h]))return!0;return!1}}Object(n.a)(ah,"DomainAllowListManager",null,[]);class mg{constructor(b,h){this.Jdf=null;this.nWe=b;this.url=h}get Yqg(){return ka.a.Nja(this.url)}get vs(){return this.nWe}eng(){const b={},h=this.vs;b.a=this.Yqg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.Jdf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(n.a)(mg,"PerformanceTimingEntry",null,[]);const Bg=(b,h)=>{const r={};let B=null;switch(b){case 0:B="ResourceTiming";b=h.a;null!=b&&(r.Url=b);b=h.b;null!=b&&(r.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(r.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(r.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(r.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(r.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(r.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(r.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(r.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(r.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(r.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(r.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(r.ResponseEnd=b);b=h.n;
null!=b&&(r.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(r.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(r.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(r.TransferSize=h);break;case 1:B="PerformanceTiming",b=h.a,null!=b&&(r.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(r.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(r.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(r.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(r.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(r.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(r.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(r.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(r.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(r.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(r.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(r.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(r.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(r.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(r.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(r.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(r.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(r.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(r.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(r.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(r.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(r.LoadEventEnd=b),h=h.w,null!=h&&(r.CustomText=h)}r.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(r)};var Cg=c(50),ki=c(236),Rh=c(171);class ml{constructor(b,h=null,r=null){this.ag=b;this.Xqg=this;this.z4j=h||(()=>window.location.href);this.Vze=new ah(r)}run(){if(ml.Mfb(window.performance))try{const P=this.z4j();if(ml.Hnk.exec(P)&&this.Vze.Jxi(P)){var b=new mg(window.performance.timing,P);Rh.a.instance.HRn(b.vs.fetchStart);Rh.a.instance.IRn(b.vs.navigationStart);
Rh.a.instance.RY(Cg.a.dKl,"connectStart","requestStart");Rh.a.instance.RY(Cg.a.lKl,"requestStart","responseStart");Rh.a.instance.RY(Cg.a.oKl,"responseStart","responseEnd");this.Xqg.D5a(1,b.eng());this.ag.pf(Cg.a.Hib,b.vs.fetchStart);this.ag.pf(Cg.a.iKl,b.vs.domainLookupStart);this.ag.pf(Cg.a.hKl,b.vs.domainLookupEnd);this.ag.pf(Cg.a.fKl,b.vs.connectStart);this.ag.pf(Cg.a.qKl,b.vs.secureConnectionStart);this.ag.pf(Cg.a.eKl,b.vs.connectEnd);this.ag.pf(Cg.a.mKl,b.vs.requestStart);this.ag.pf(Cg.a.mnf,
b.vs.responseStart);this.ag.pf(Cg.a.jKl,b.vs.responseEnd-b.vs.responseStart);this.ag.pf(Cg.a.nKl,b.vs.responseStart-b.vs.requestStart);var h=0,r=0,B=0;({transferSize:h,yif:r,hef:B}=this.RQo(P)).returnValue&&(this.ag.pf(Cg.a.sKl,h),this.ag.pf(Cg.a.gKl,B),this.ag.pf(Cg.a.kKl,r));this.ag.pf(Cg.a.jPc,b.vs.navigationStart)}}catch(P){t.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",P)}}RQo(b){let h,r,B;B=r=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,yif:r,hef:B};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,yif:r,hef:B};b=b[0];var P=b.transferSize;void 0!==h&&null!==h&&(h=P);P=b.decodedBodySize;void 0!==P&&null!==P&&(B=P);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,yif:r,hef:B}}D5a(b,h){t.ULS.sendTraceTag(4551815,306,50,Bg(b,h))}static get instance(){return ml._instance||
(ml._instance=new ml(ki.a.instance,null,v.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.K.EB("ResourceLoggerDomainAllowList"):null))}static Mfb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}ml._instance=null;ml.Hnk=RegExp("^https?://.*","i");Object(n.a)(ml,"PerformanceTimingLogger",null,[699]);class el{constructor(b,h){this.Jdf=null;this.nWe=b;this.behavior=h;this.url=this.vs.name}get Yqg(){return 2===this.behavior?this.url:
ka.a.Nja(this.url)}get vs(){return this.nWe}eng(){const b={},h=this.vs;b.a=this.Yqg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(el.Ijb(h,"decodedBodySize"));b.p=this.round(el.Ijb(h,"encodedBodySize"));b.q=this.round(el.Ijb(h,"transferSize"));b.n=this.Jdf;return b}round(b){return Math.round(1E3*b)/1E3}static Ijb(b,h){return b[h]}}Object(n.a)(el,"ResourceTimingEntry",null,[728]);class Kl{constructor(b,h=null,r=100){this.hMg=b;this.iyd=h;this.y$a={};this.KYj=r}wPo(b){var h=b.name.toLowerCase();const r=ka.a.YGb(h);this.gfj(r,h)&&(r in this.y$a?t.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.kEi(b),h.encodedsize=el.Ijb(b,"encodedBodySize"),h.decodedsize=el.Ijb(b,"decodedBodySize"),this.y$a[r]=h))}xPo(b){var h=b.name.toLowerCase();const r=ka.a.YGb(h);this.o8n(r,h)&&(r in this.y$a?t.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.kEi(b),h.encodedsize=el.Ijb(b,"encodedBodySize"),
h.decodedsize=el.Ijb(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.y$a[r]=h))}gfj(b,h){if(this.hMg)return Array.contains(this.hMg,b);if(this.iyd)for(b=ka.a.dY(h),h=0;h<this.iyd.length;h++)if(this.iyd[h]&&b.endsWith(this.iyd[h]))return!0;return!1}o8n(b,h){return this.gfj(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}kEi(b){try{const h=el.Ijb(b,"transferSize");if(void 0!==h&&null!==h)return!h;t.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.KYj}catch(h){t.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}hUn(){if(zb.a.af(this.y$a))t.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=v.AFrameworkApplication.flightId?v.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new sb.a,{extendedProperties:ob.a.wG()});h.extendedProperties.set("Flights",I.c(b));this.nLi(h,this.y$a,xa.Health.instance)}}jof(b){let h=0,r=0,B=0,P=0;const ca=this.y$a;for(let Qa in ca){var ra=ca[Qa];Qa.endsWith(".js")&&(ra=Object(Na.a)(Object,ra),ra.responseend<b&&(h+=1,r+=ra.decodedsize,P+=ra.encodedsize,B+=ra.iscached?0:ra.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=
B;b.encodedBytes=P;return b}nLi(b,h,r){if(h){var B=0,P=0,ca=0,ra=0,Qa=0,mb=0,Jb=0,Yb=0,fc=0,Mc=0,Wc=0;for(let Id in h){var id=h[Id];try{const ve=Object(Na.a)(Object,id);if(!ve)continue;const $d=ve.iscached?Boolean.parse(ve.iscached.toString()):!1,be=ve.fetchstart?this.parseFloat(ve.fetchstart.toString()):0,he=(ve.responseend?this.parseFloat(ve.responseend.toString()):0)-be,re=ve.encodedsize?this.parseFloat(ve.encodedsize.toString()):0,Xf=ve.decodedsize?this.parseFloat(ve.decodedsize.toString()):0;
B+=he;ra+=re;Jb+=Xf;Mc++;$d?(ca+=he,mb+=re,fc+=Xf,Wc++):(P+=he,Qa+=re,Yb+=Xf)}catch(ve){t.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",ve.message)}}b.extendedProperties.set("StaticResources",I.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",B.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",P.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Qa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",mb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Yb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",fc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Mc.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Wc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(n.a)(Kl,"AppStaticResourceManager",null,[]);class ig extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(n.a)(ig,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Mi{constructor(b,
h,r=null,B=null,P=100,ca=!1){this.aIe=!1;this.Co=null;this.rtc=0;this.sa=new wd.a;this.htb=null;this.e_=!1;this.Rjh=0;this.Ib=b;this.aSg=0;this.Xqg=this;this.Vze=new ah(r);this.LK=h;B&&(this.htb=new Kl(null,B,P));this.QVj=ca}get ezh(){try{return!(void 0===this.LK||null===this.LK)&&!(void 0===this.LK.getEntriesByType||null===this.LK.getEntriesByType)}catch(b){return t.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get Xil(){return this.aSg}get isActive(){return this.e_}get Umg(){return this.Rjh}Rqh(b){this.sa.addHandler(Mi.xjf,
b)}Qbj(b){this.sa.removeHandler(Mi.xjf,b)}wc(b,h){const r=this.Umg!==b;this.Rjh=b;this.isActive&&this.Ib&&r&&(this.ff(),this.Wb());this.aSg=h}activate(){!this.isActive&&this.ezh&&(this.Wb(),this.e_=!0)}deactivate(b){this.isActive&&(this.ff(),b&&this.flush(),this.e_=!1)}flush(){if(this.isActive&&this.ezh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.rtc&&t.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.rtc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.rtc=0);const r=[];for(let B=this.rtc;B<b.length;B++)this.Vze.Jxi(b[B].name)&&(this.htb&&(this.QVj?this.htb.xPo(b[B]):this.htb.wPo(b[B])),r.push(new el(b[B],this.Xil)));h||(this.rtc=b.length);this.sa.raiseEvent(Mi.xjf,new ig(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.Xqg.D5a(0,r[b].eng());0<r.length&&
t.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(h){t.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}D5a(b,h){t.ULS.sendTraceTag(4310804,306,50,Bg(b,h))}CRn(){this.htb.hUn()}jof(b){return this.htb.jof(b)}Wb(){this.Ib&&0<this.Umg&&(this.Co=new Oe.a(3,2,1E3*this.Umg,()=>{this.flush()},5),this.Ib.Wb(this.Co),this.aIe=!0)}ff(){this.aIe&&(this.Ib.ff(this.Co),this.Co=null,this.aIe=
!1)}}Mi.xjf="EntriesAvailable";Object(n.a)(Mi,"ResourceTimingLogger",null,[681,699]);class fh{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");ml.instance.run()}dispose(){}wc(b){this.W=b;let h=null;if(v.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=v.AFrameworkApplication.K.EB("ResourceLoggerDomainAllowList")}catch(ca){t.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=
[];r.push(ka.a.dY(Jd.a.a6).toLowerCase());r.push(ka.a.dY(Jd.a.B$c).toLowerCase());const B=v.AFrameworkApplication.K.nc("AppStaticResourceMonitorCacheThresholdInMs",100),P=v.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(681,"Common.NetworkTiming.IResourceTimingLogger").ha().Ud(()=>new Mi(v.AFrameworkApplication.lc,window.performance,h,r,B,P))}static main(){L.a.instance.Gc(new fh)}}Object(n.a)(fh,"ResourceTimingPackage",null,[1,2]);var zf=c(250);class Eh{constructor(){this.Wse=
{}}Rqk(b){this.Wse[b.id.toString()]=b}fjn(b){const h=this.Wse;for(let r in h)h[r].notify(b,!1);this.Wse={}}sMn(b,h){h&&this.Rqk(h);return this.iYi(b,h)}kif(b){this.fjn(b)}CWh(b,h){b.notify(h,!0)}}Object(n.a)(Eh,"AEventEmitter",null,[404]);var tl;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(tl||(tl={}));Object(n.b)("EventResultState",tl);class Nh{constructor(){this._state=0}get state(){return this._state}set state(b){t.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:tl[this._state],["NewState"]:tl[b]},"ResultType",this.Bgi());this._state=b}}Object(n.a)(Nh,"AEventResult",null,[403]);class Uh extends Nh{constructor(){super();this.EUe=this.vBc=null;this.state=0;this.DFe=this.Y_g=!1}get Tda(){return this.vBc}get J8a(){return this.EUe}get YFm(){return this.Y_g}Bgi(){return"GetMoreInfo Result"}}Object(n.a)(Uh,"GetMoreInfoResult",Nh,[745,403]);var ok=c(1399),pj=c(1580),Ek=c(1072);class cj{constructor(b,h,r,B,P,
ca,ra,Qa){this.ga=b;this.Zf=h;this.Mh=r;this.PAa=B;this.Ib=P;this.xD=ca;this.T5j=ra;this.Fyd=Qa}DVn(){this.wgc.qa(eb.a.Chc,Gd.a.frame,Object(z.a)(this,this.Chc,"openUrlInNewTab"));this.wgc.qa(eb.a.RZf,Gd.a.frame,Object(z.a)(this,this.RZf,"openDocumentUrl"));v.AFrameworkApplication.iha?this.qLi():this.wgc.fb(eb.a.cMd,Gd.a.frame,Object(z.a)(this,this.cMd,"documentLoaded"),96)}Chc(b,h,r,B,P){P&&P.MenuItemId&&(t.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:Ek.a[this.Eda]}),
Qd.a.vm(P.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}RZf(b,h,r,B,P){if(P&&P.MenuItemId){const ca=v.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ra=v.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");t.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,ra);if(ca&&ra){t.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:Ek.a[this.Eda]});
b=P.MenuItemId.toString();const Qa={};Qa[H.a.pjc]="1";Qa[H.a.documentUrl]=b;Qa[H.a.reason]=pj.a.open;t.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");v.AFrameworkApplication.kP().execute(mb=>{mb.sendMessage(M.a.mEb,Qa)})}else this.Chc(b,h,r,B,P)}return 32}cMd(){this.qLi();return 32}tSa(b,h,r=""){if(h&&h.bI){const B=ok.a[h.status];h=h.bI.getTime();const P=this.nq()-h;t.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:B,
["ElapsedMs"]:P,["StartTime"]:h,["Notes"]:r})}else t.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}qLi(){var b=v.AFrameworkApplication.K.$("QPGVCI"),h=ka.a.iP(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=ka.a.iP(document.URL,"wdPreviousSession",b);b=ka.a.iP(document.URL,"wdPreviousCorrelation",b);var B=v.AFrameworkApplication.K.$("NAOPLP");if(v.AFrameworkApplication.iha){var P=v.AFrameworkApplication.iha.getTime();
!h||h>P?t.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:P,["SessionId"]:r,["Correlation"]:b}):t.ULS.sendTraceTag(5849683,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:P-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else t.ULS.sendTraceTag(5849681,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get wgc(){return this.ga.value}get v1c(){return this.Zf.value}get uRi(){return this.Mh.value}get Eda(){return this.PAa.value}get c6d(){return this.Ib.value}get nq(){return this.xD}get NSa(){return this.T5j.value}get hVa(){return this.Fyd.value}static get instance(){return cj._instance||(cj._instance=cj.Wr())}static Wr(){return new cj(new zf.a(()=>v.AFrameworkApplication.va),new zf.a(()=>v.AFrameworkApplication.He),new zf.a(()=>v.AFrameworkApplication.ta),
new zf.a(()=>v.AFrameworkApplication.ta.Kb.xk),new zf.a(()=>v.AFrameworkApplication.lc),()=>(new Date).getTime(),new zf.a(()=>v.AFrameworkApplication.ta.Kb.NSa),new zf.a(()=>v.AFrameworkApplication.hVa))}}cj._instance=null;Object(n.a)(cj,"NewAndOpenCommonHelpers",null,[401]);class Fi{constructor(b,h,r){this.dxd=this.Co=null;this.gRe=0;this.ljk=b;this.Ib=h;this.CSg=r}rBk(){this.gRe=this.$jc+1}G$f(b){this.Co&&(this.Ib.ff(this.Co),this.Co=null);b&&(this.gRe=0)}JDo(b){const h=this.tLo;0<=h?(this.rBk(),
this.G$f(!1),this.Co=new Oe.a(4,1,h,b,107),this.Ib.Wb(this.Co)):(this.G$f(!0),t.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.CSg}))}get $jc(){return this.gRe}get tLo(){return this.$jc>=this.rkj.length?-1:this.rkj[this.$jc]}get rkj(){if(!this.dxd){const b=(this.ljk.value||"0").split(",");this.dxd=[];for(let h=0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?t.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.CSg,["Entry"]:b[h]}):
Array.add(this.dxd,r)}}return this.dxd}}Object(n.a)(Fi,"RetryHelper",null,[]);class Yh extends Eh{constructor(b,h){super();this.cCa=b;this.yCc=new Fi(h,this.b1c.c6d,"GetMoreInfo");this.Mp=new Uh}C$m(){this.cPf("Document opened")}Gcl(b){return()=>{this.cPf(b,!0)}}iYi(b,h=null){t.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Mp.state?(h&&this.CWh(h,this.Mp),t.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.cPf(b);return this.Mp}cPf(b,h=!1){this.yCc.G$f(!h);1===this.Mp.state?t.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.yCc.$jc}):(t.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.yCc.$jc}),this.Mp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.b1c.NSa,v.AFrameworkApplication.em),this.b1c.v1c.ZAb(h,1,null,null,[Yh.vbh,Yh.jih],5,this.rbl(),this.qbl(b)))}rbl(){return b=>
{var h=!1;let r=!1;var B=!1,P;v.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.te?({Gt:P}=I.d(b.data.te)).returnValue?P?(B=!0,this.Mp.EUe=P.StorageServiceDisplayName,this.Mp.vBc=Yh.$Ei(P.PersonalFileStorageUrl)?P.PersonalFileStorageUrl:"",""===this.Mp.Tda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")&&(this.Mp.vBc=ka.a.Nja(v.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.Mp.Tda&&""!==this.Mp.J8a):t.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
t.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):t.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));B||((P=b.data.jj)?(this.Mp.EUe=(P[Yh.jih]||"").toString(),h=(P[Yh.vbh]||"").toString(),this.Mp.vBc=Yh.$Ei(h)?h:"",""===this.Mp.Tda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")?(this.Mp.vBc=ka.a.Nja(v.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.Mp.Tda&&""!==this.Mp.J8a):h=""===h&&""!==this.Mp.J8a):(t.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));B=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.yCc.$jc,r,h,B);this.b1c.tSa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,B);this.Hkj(3,h,r)}}qbl(b){return h=>{this.b1c.tSa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.Hkj(2);this.yCc.JDo(this.Gcl(b))}}Hkj(b,h=!1,r=!1){this.Mp.state=b;this.Mp.Y_g=h;this.Mp.DFe=r;this.kif(this.Mp)}get b1c(){return this.cCa.value}static get instance(){return Yh._instance||(Yh._instance=Yh.Wr())}static Wr(){return new Yh(new zf.a(()=>cj.instance),new zf.a(()=>v.AFrameworkApplication.N5l))}static $Ei(b){if(!b)return t.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(E.a.eh(b).startsWith("https://"))return!0;t.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Yh.vbh="PersonalFileStorageUrl";Yh.jih="StorageServiceDisplayName";Yh._instance=null;Object(n.a)(Yh,"GetMoreInfoActor",Eh,[]);class rj{constructor(b,h,r,B,P){this.i7j=6E4;this.eri="inactive";this.Tnh="active";this.e_=!0;this.Ib=b;this.Y4j=h;this.xD=r;this.Bzd=B;this.sa=new wd.a;P&&this.xDo();this.i4g=this.Ubi()}toh(b){this.sa.addHandler(this.Tnh,b)}puk(b){this.sa.addHandler(this.eri,b)}xDo(){const b=new Oe.a(5,2,this.i7j,Object(z.a)(this,this.Cym,
"inactiveLoop"),108);this.Dym.Wb(b)}Cym(){const b=this.Ubi(),h=this.nq()-b;h>this.zme&&this.e_&&(t.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.e_=!1,this.sa.raiseEvent(this.eri));b-this.i4g>this.zme&&(this.e_=!0,this.sa.raiseEvent(this.Tnh));this.i4g=b}get Dym(){return this.Ib.value}get Ubi(){return this.Y4j}get nq(){return this.xD}get zme(){return this.Bzd.value}static get instance(){return rj._instance||(rj._instance=rj.Wr())}static Wr(){return new rj(new zf.a(()=>
Rg.a.instance),()=>v.AFrameworkApplication.FKf.getTime(),()=>(new Date).getTime(),new zf.a(()=>v.AFrameworkApplication.zme),!0)}}rj._instance=null;Object(n.a)(rj,"InactivityManager",null,[]);var Pm=c(1700);class Fk extends Nh{constructor(){super();this.Vbk=this.l8g=this.k8g=null;this.state=this.Sjh=0;this.DFe=!1}get cRf(){return this.k8g}get LQi(){return this.l8g}get zLo(){return this.Sjh}Bgi(){return"MruActor Result"}}Object(n.a)(Fk,"MruResult",Nh,[402,403]);class Ll{constructor(b,h,r){this.task=
null;this.AIb=b;this.maxRetries=h;this.taskManager=r;this.retryCount=this.LVc=0;this.uPe=this.yZc=null}WSm(b,h){return b===wa.a.W8b||20===h||18===h||3===h}nUm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get Uae(){return this.uPe}reset(){this.LVc=this.retryCount=0;this.uPe=this.yZc=null;this.task&&(this.taskManager.ff(this.task),this.task=null)}cDm(b,h,r,B){this.uPe=String.format("{0}_{1}",r,B);if(this.retryCount>=
this.maxRetries)return t.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.WSm(r,B))return t.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.nUm(B)&&1<=this.LVc)return this.yZc=r,!1;h=Math.max(h,this.AIb*Math.pow(2,this.LVc));if(26===B)h=Math.max(h,3E4);else if(27===B||28===B)h=Math.max(h,6E4);9===B||412===r&&(null==this.yZc||412!==this.yZc)?h=500:this.LVc+=1;this.yZc=r;this.retryCount+=1;this.task&&this.taskManager.ff(this.task);t.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new Oe.a(2,1,h,b,107);this.taskManager.Wb(this.task);return!0}}Object(n.a)(Ll,"RetryManager",null,[]);var rh=c(128);class qp{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(qp,"WriteOptions",null,[]);var Hi=c(760);class Gk extends Eh{constructor(b,h,r,B,P,ca,ra){super();this.cCa=b;this.Mak=h;this.xdb=new Ll(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.eN.c6d);this.Neb=new Ll(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.eN.c6d);this.ahk=r;this.Tmh=B;this.Mpk={};this.$la=new Fk;this.v4j=P;this.isd="";this.cM=ca;this.zUg=ra;this.svd="";this.ehk=v.AFrameworkApplication.K.nc("WordRecentLinksCount",
25)}get zqe(){return this.Mpk}oZn(){this.eN.wgc.qa(eb.a.Ccj,Gd.a.frame,Object(z.a)(this,this.h3n,"renameMruEntry"))}h3n(){return this.ktg("Rename")}U$m(){this.DNi("File Opened")}V$m(){this.DNi("IntervalUpdate")}DNi(b){t.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.ktg(b)}Oha(b){(b=E.a.Oha(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}FQd(){switch(this.eN.Eda){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}Hkm(b){var h=this.v4j();if(!h)return null;const r=new qp;r.documentUrl=this.zUg.value?encodeURI(h):h;r.mruItemId=this.isd;r.app=this.FQd();if(h=this.cM())r.folderName=h.breadcrumbFolderName,h=h.yz,r.documentName=E.a.yJ(h),r.documentExt=this.Oha(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(r)}ktg(b,h=!1){if(4===this.eN.Eda&&!v.AFrameworkApplication.$Ld)return 2;var r=ob.a.wG();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.isd?"true":"false"),r.set("URLEncoded",this.zUg.value?"true":"false"));xa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.Hkm(r);if(!b)return h=!v.AFrameworkApplication.JTb,r&&(r.set("WebEditingIsEnabled",v.AFrameworkApplication.JTb?"true":"false"),r.set("ProtectedFile",v.AFrameworkApplication.eZ?
"true":"false")),xa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new sb.a,{extendedProperties:r})),2;this.Neb&&!h&&this.Neb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.eN.NSa,this.fNf);this.Tmh?this.zqe["X-FileId"]=v.AFrameworkApplication.em:r+=String.format("&{0}",v.AFrameworkApplication.em);v.AFrameworkApplication.sessionStartInfoSettings&&(this.zqe["X-Office-AudienceGroup"]=Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.zqe["X-Timeout"]=15E3;return this.eN.v1c.nj(r,2,b,this.zqe,!0,5,Object(z.a)(this,this.m9o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.Lgl,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}m9o(b){this.Mmi(b.data)}Mmi(b){const h=ob.a.wG();this.Neb&&(h&&this.Neb.Uae&&(h.set("LastError",this.Neb.Uae),h.set("NumRetries",this.Neb.retryCount.toString())),this.Neb.reset());const r=Pm.c(b.te);r&&r.diagnostics_data&&(this.isd=r.diagnostics_data.mru_id);
b=+b.cU-+b.bI;h&&h.set("RequestDuration",b.toString());xa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new sb.a,{extendedProperties:h}))}Lgl(b){if(b.data.Ne===wa.a.m6b)this.Mmi(b.data);else{var h=b.data.Ne===wa.a.Bja,r=ob.a.wG();this.Wmi(this.Neb,b,this.rgl(),r);r&&(r.set("StatusCode",b.data.Ne.toString()),h||this.ZZe(b.data,r));xa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Ne),h,!1,Object.assign(new sb.a,{extendedProperties:r}))}}rgl(){return()=>
{this.ktg("Retry",!0)}}W5l(){this.g0c("Polling")}V5l(){this.g0c("Retry",!0)}F$m(){this.g0c("Open")}E$m(){this.g0c("Activity")}D$m(){this.g0c("ActivityRecentLinks",!1,!0)}g0c(b,h=!1,r=!1){t.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const B=ob.a.wG();B&&(B.set("Trigger",b),B.set("IsRetry",h?"true":"false"),r&&B.set("RecentLinks","true"));xa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",B);this.xdb&&!h&&this.xdb.reset();r?this.DMh(Object(z.a)(this,this.X5l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.S5l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.DMh(Object(z.a)(this,this.Y5l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.U5l,"getMruFromServerFailureCallback"))}ZZe(b,h){b&&b.jj&&(b=b.jj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}h6m(b,h){b&&(h&&h.set("RequestDuration",(+b.cU-+b.bI).toString()),xa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new sb.a,{extendedProperties:h})))}Y5l(b){this.Zci(b)}Zci(b,h=!1){var r="";let B=null,
P=null,ca=null;const ra=Pm.c(b.data.te);ra&&(B=ra.places?ra.places.items:[],P=ra.documents?ra.documents.items:[],(ca=Pm.a(ra,h))&&(r=I.c(ca)));v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()&&(h?this.svd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=ob.a.wG();this.xdb&&(r&&this.xdb.Uae&&(r.set("LastError",this.xdb.Uae),r.set("NumRetries",this.xdb.retryCount.toString())),this.xdb.reset());h&&r&&r.set("RecentLinks","true");ca||B||P?(h?this.eN.tSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.eN.tSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.Goe(3,ca,B,P),this.h6m(b.data,r)):(h?this.eN.tSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.eN.tSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.ZZe(b.data,r),xa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new sb.a,{extendedProperties:r})),this.Goe(3,null,null,null,!0));this.kif(this.$la)}X5l(b){this.Zci(b,
!0)}Wmi(b,h,r,B){let P=0,ca=0;const ra=Pm.c(h.data.te);ra&&(null!=ra.response_code&&(P=ra.response_code,B&&B.set("MruResponseCode",P.toString()),9===P&&(this.isd="")),ra.error_data&&null!=ra.error_data.retry_after_ms&&(ca=ra.error_data.retry_after_ms,B&&B.set("ExpectedRetryAfter",ca.toString())));b&&(h=b.cDm(r,ca,h.data.Ne,P),B&&(B.set("CurrentRetryCount",b.retryCount.toString()),B.set("RetryScheduled",h?"true":"false")))}U5l(b){this.Yci(b)}Yci(b,h=!1){const r=b.data.Ne===wa.a.Bja,B=ob.a.wG();B&&
(B.set("StatusCode",b.data.Ne.toString()),h&&B.set("RecentLinks","true"),r||this.ZZe(b.data,B));h?this.eN.tSa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.eN.tSa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.Goe(2);this.Wmi(this.xdb,b,Object(z.a)(this,this.V5l,"getMruFromServerRetryTask"),B);xa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Ne),r,!1,Object.assign(new sb.a,{extendedProperties:B}));this.kif(this.$la);
v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.svd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}S5l(b){this.Yci(b,!0)}Goe(b,h=null,r=null,B=null,P=!1){if(3!==this.$la.state||3===b)this.$la.k8g=h,this.$la.l8g=r,this.$la.Vbk=B,this.$la.state=b,this.$la.DFe=P,this.$la.Sjh=this.eN.nq()}iYi(b,h){t.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.$la.state});
h&&3===this.$la.state&&this.CWh(h,this.$la);return this.$la}DMh(b,h,r=!1){this.Goe(1);let B;const P={};B=r?String.format(this.eN.NSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.ehk,"OfficeSuite",this.fNf,"ClassicMru"):String.format(this.eN.NSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.FQd(),this.fNf);this.ahk.value||(B+="&entity=docs");v.AFrameworkApplication.sessionStartInfoSettings&&(P["X-Office-AudienceGroup"]=Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");r&&(P["X-Office-Application"]="147");this.Tmh?P["X-FileId"]=v.AFrameworkApplication.em:B+=String.format("&{0}",v.AFrameworkApplication.em);this.eN.v1c.nj(B,1,null,P,!0,5,b,h,null)}get eN(){return this.cCa.value}get fNf(){return this.Mak.value}static get instance(){return Gk._instance||(Gk._instance=Gk.Wr())}static Wr(){return new Gk(new zf.a(()=>cj.instance),new zf.a(()=>Hi.a.ug(v.AFrameworkApplication.lcid).name),new zf.a(()=>v.AFrameworkApplication.ta.Kb.uF),v.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>v.AFrameworkApplication.ta.Kb.TQ,()=>v.AFrameworkApplication.Js,new zf.a(()=>v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Gk._instance=null;Object(n.a)(Gk,"MruActor",Eh,[]);class Xn{constructor(){this.aFc=this.Tch=this.W=null;this.Oh=!1}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.W=b;b.register(401,"Common.INewAndOpenCommonHelpers").ha().Ud(()=>cj.instance);b.register(404,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Ud(()=>Yh.instance);b.register(404,"Common.IEventEmitter<Common.IMruResult>").ha().Ud(()=>
Gk.instance)}init(){v.AFrameworkApplication.K.Nn(()=>{this.T3a()})}T3a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;cj.instance.DVn();v.AFrameworkApplication.zHa&&(b=!0);v.AFrameworkApplication.d6f&&(Gk.instance.F$m(),0<v.AFrameworkApplication.MQi&&this.hph(),this.aro(),b=!0);v.AFrameworkApplication.hVa&&b&&Yh.instance.C$m();v.AFrameworkApplication.VYo&&(b=Gk.instance,
b.oZn(),b.U$m(),Rg.a.instance.Wb(this.WYo))}aro(){rj.instance.toh(Object(z.a)(Gk.instance,Gk.instance.E$m,"makeGetMruRequestActivityTrigger"));rj.instance.toh(Object(z.a)(this,this.hph,"addGetMruFromServerTask"));rj.instance.puk(Object(z.a)(this,this.oll,"deleteGetMruFromServerTask"))}oll(){Rg.a.instance.ff(this.NQi)}hph(){Rg.a.instance.Wb(this.NQi)}get NQi(){return this.Tch||(this.Tch=new Oe.a(5,2,v.AFrameworkApplication.MQi,Object(z.a)(Gk.instance,Gk.instance.W5l,"getMruFromServerTask"),109))}get WYo(){return this.aFc||
(this.aFc=new Oe.a(2,2,6E4*v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(Gk.instance,Gk.instance.V$m,"makeUpdateMruTask"),197))}dispose(){this.Oh||(this.Oh=!0,this.aFc&&(Rg.a.instance.ff(this.aFc),this.aFc=null))}}Object(n.a)(Xn,"CorePackageManager",null,[1,2,10]);var jk=c(1576),Hd=c(150);class Ie{static awl(b){return Ie.Pzh("New",b)}static bwl(b){return Ie.Pzh("Open",b)}static vzh(b,h){return Ie.j0a("LoadingMenuSection",Ie.Y3m,
b,Ie.THc("lblLoading",h))}static UHc(b,h,r=null,B=null){return Ie.j0a("MessageMenuSection",Ie.KQi,h,Ie.THc("lblMessage",b,r,B))}static NOk(b){return Ie.vzh(b,CommonUIStrings.l_VoicedLoadingText)}static OOk(b,h){return Ie.UHc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Tda,h.J8a)}static MOk(b,h){return Ie.UHc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.J8a,"\n\n"),b.labelText)}static zzh(b){return Ie.UHc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static KOk(b,
h,r){return Ie.j0a("menuNewBlank",Ie.eum,r?b.labelText:null,Ie.QHc(b.Coi,b.Doi,b.Eoi,null,b.L3a,b.qUc,h,"blank"))}static GPk(){return Ie.THc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Nzh(){return Ie.THc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static HPk(b,h){return Ie.j0a("menuNewTemplates",b,null,h)}static IOk(b,h){return Ie.j0a("menuNewMoreTemplates",Ie.C2h,null,Ie.QHc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,b,h))}static ANk(b,h,r){let B="";r&&h&&(B=Ie.j0a("BrowseMoreMenuSection",Ie.C2h,null,Ie.QHc("btnBrowseMore",h,h,null,null,null,b||"1959943459",r)));return B}static THc(b,h,r=null,B=null){let P=B;h&&0<h.length&&(P=Ie.DRi.Iob(h).trimEnd(),P=0<=P.indexOf("{0}")?String.format(P,B):String.format("{0} {1}",P,B));r=r&&B?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',E.a.zf(r),E.a.zf(B),E.a.zf(P)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
E.a.zf(b||""),Ie.DRi.Iob(E.a.zf(h||"")),r)}static QHc(b,h,r,B,P,ca,ra,Qa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',E.a.zf(b||""),E.a.zf(h||""),E.a.zf(r||""),B||"32by32",E.a.zf(P||""),E.a.zf(ca||""),ra,E.a.zf(Qa||""))}static Pzh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
b,h)}static j0a(b,h,r,B){r=r?String.format('Title="{0}"',E.a.zf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',E.a.zf(b||""),E.a.zf(h||""),r,B)}}Ie.KQi="MenuMru";Ie.Y3m="MenuLoading";Ie.eum="MenuHeader";Ie.C2h="MenuFooter";Ie.DRi=Hd.a.MC("\n","&#10;");Object(n.a)(Ie,"NewAndOpenXmlUtilities",null,[]);
class Ok{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(n.a)(Ok,"HostInformation",null,[]);var Jj=c(194);class ee{constructor(b,h,r,B,P,ca){this.d1b=this.$v=this.Uhd=null;this.Kxd=this.wTe=!1;this.x7g=0;this.cTe=this.sHe=!1;this.cCa=b;this.xvc=h;this.LXa=new zf.a(()=>new jk.a(r.value,Object(z.a)(this,this.LGb,"getMoreInfoEventReceived")));this.Tbk=B;this.Ncb=P;this.qkk=ca;this.wDc=this.Rie;this.iqd=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("GateTemplateRenderingByGetMoreInfoResponse");
2===this.HP.Eda&&(this.cTe=!0);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.HCl()}get Y7(){switch(this.HP.Eda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}HCl(){Rg.a.instance.Wb(new Oe.a(5,1,0,()=>{this.getTemplateListJson()}))}Ub(){const b=this.HP.wgc;b.qa(eb.a.newDocument,Gd.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));
b.qa(eb.a.wae,Gd.a.frame,Object(z.a)(this,this.wae,"populateNewMenu"))}newDocument(b,h,r,B,P){if(1===r)return 32;if(2===r&&P){if(v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&P.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.va.processAction(eb.a.PGn,2);if(P.MenuItemId&&P.SourceControlId)return"NewDocumentHome"===P.SourceControlId&&ne.a("NewDocumentFromHomeTab"),this.WKc(P.MenuItemId,P.SourceControlId)}return 8}WKc(b,
h){var r=this.h6d.kNh;if(null===r)return 8;var B=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.cmb&&B){t.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const P={};P[H.a.template]=b;P[H.a.Y7]=this.Y7;P[H.a.lcid]=v.AFrameworkApplication.lcid.toString();P[H.a.reason]=pj.a.acf;P[H.a.uiCulture]=v.AFrameworkApplication.uiCulture;P[H.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.kP().execute(ca=>{ca.sendMessage(M.a.WKc,P)})}else B=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,E.a.Gj(this.zHa),E.a.Gj(b),E.a.Gj(this.Y7),E.a.Gj(v.AFrameworkApplication.lcid.toString()),E.a.Gj(B.toString()),E.a.Gj(h),E.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.em),(r=v.AFrameworkApplication.K.kb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+E.a.Gj(r)),
h+="&"+v.AFrameworkApplication.HUd(),v.AFrameworkApplication.JRa&&(h+="&"+v.AFrameworkApplication.iTd()),(r=this.$v?this.$v.Tda:null)?h+="&DestinationUrl="+E.a.Gj(r):3===this.HP.Eda&&this.HP.hVa&&t.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Qd.a.vm(h,"_blank",void 0,"CreateNewDocument");2!==this.HP.Eda&&3!==this.HP.Eda||t.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Ek.a[this.HP.Eda],["Template"]:b});
v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.HP.Eda&&("blank"===b?ne.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ma.a,{name:"TemplateId",string:b})],ne.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}E8m(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const B=window.performance;if(B&&"undefined"!==typeof B.getEntriesByName){for(let ca=0;ca<b.length;ca++){var P=B.getEntriesByName(b[ca]);P&&
0<P.length&&(P=P[0],h=Math.min(parseInt(String(P.fetchStart)),h),r=Math.max(parseInt(String(P.responseEnd)),r))}r>h&&t.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}wae(b,h,r,B,P){if(1===r)return this.cTe&&(v.AFrameworkApplication.hqa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.cTe=!1),32;2!==r||this.sHe||(this.x7g=(new Date).getTime(),t.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Rie,["CachedNewMenuXmlExists"]:!!this.Uhd,["ShouldCallGetMoreInfo"]:this.HP.hVa}));v.AFrameworkApplication.se("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.se("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.wFn(P)}wFn(b){b&&(this.Uhd?b.PopulationXML=this.Uhd:(this.HP.hVa&&!this.$v&&this.zhn.jP("Opened New menu",!0),b.PopulationXML=this.lMl(this.getTemplateListJson())));
return 32}nCi(){return!this.HP.hVa||!!this.$v&&3===this.$v.state&&!!this.$v.J8a&&!!this.$v.Tda}PHf(){return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&!this.iqd?!0:this.nCi()}getTemplateListJson(){if(!this.Rie&&!this.iqd&&!this.PHf())return null;if(this.wDc&&!this.Kxd){var b="9";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=v.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let r=this.Y7;"TemplateCollectionId"in h&&(r=h.TemplateCollectionId);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(r="WordConsumerWAC",b="23");b=String.format(this.HP.NSa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",E.a.Gj(v.AFrameworkApplication.lcid.toString()),E.a.Gj(r),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+v.AFrameworkApplication.HUd();v.AFrameworkApplication.JRa&&(b+="&"+v.AFrameworkApplication.iTd());this.HP.v1c.nj(b,1,null,null,!1,2,B=>{this.HP.tSa("CreateNewActor.GetTemplateListJson",B.data);this.LJo(B.data.te)},B=>{this.HP.tSa("CreateNewActor.GetTemplateListJson",B.data);this.KJo()},null,void 0,void 0,void 0,void 0,"5");this.wDc=!1}return this.d1b}LJo(b){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.d1b=this.FDl(b):this.d1b=b;this.wDc=!1;this.y6c();this.iqd?this.PHf()?this.tgf():this.$v&&(t.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.sgf()):this.tgf()}tgf(){if(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()){const b=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=v.AFrameworkApplication.cmb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.d1b,!0,b&&h));3===this.HP.Eda&&
t.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}KJo(){this.Kxd=this.wDc=!0;this.y6c();this.sgf();xa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}sgf(){v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.HP.Eda&&t.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}FDl(b){b=JSON.parse(b);const h=
new vb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const r=Jj.a.Asg(b,B=>h.contains(B.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(r));return JSON.stringify(b)}dwf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const B=b.length?b[h]:null;b=B?B.Url||"":"";var P;let ca=r=h=!1;if(B&&(P=B.AspectRatio))P=parseFloat(P),1>P?h=!0:1.5<P?r=!0:1===P&&(ca=!0);else switch(t.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),
this.HP.Eda){case 3:h=!0;break;case 2:r=!0;break;case 5:ca=!0}return{returnValue:b,eym:h?"95by123":r?"123by69":ca?"100by100":"123by95"}}lMl(b){b=({wie:h}=this.LOk(b,this.h6d,this.h6d.XHc||"1056925771")).returnValue;if(h){this.Uhd=b;var h=(new Date).getTime()-this.x7g;t.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}LGb(b,h){t.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.$v||3!==b.state?2===
b.state&&(t.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.wTe=!0,this.y6c()):(this.$v=b,h||this.y6c(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()&&rh.d("setFileMenuHostInformation")&&(b=Object.assign(new Ok,{hostUrl:this.$v.Tda,hostName:this.$v.J8a,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),t.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),
this.iqd&&this.d1b&&this.d1b.length&&(this.PHf()?this.tgf():this.sgf(),t.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}LOk(b,h,r){let B;B=!1;const P=this.nCi();let ca="";this.HP.hVa&&(this.wTe?(ca=Ie.zzh(h),this.wTe=!1,t.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.$v?P?ca=Ie.OOk(h,this.$v):this.$v.YFm?(B=!0,this.wDc=!1,ca=Ie.MOk(h,this.$v),t.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(B=!0,ca=Ie.zzh(h),t.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.$v.Tda,["StorageServiceDisplayNameIsSet"]:!!this.$v.J8a})):(ca=Ie.NOk(h.labelText),t.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));P&&(ca+=Ie.KOk(h,r,!ca)+({wie:B}=this.FPk(b,r)).returnValue);return{returnValue:Ie.awl(ca),wie:B}}FPk(b,h){let r;r=!1;if(!this.Rie)return r=!0,t.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",wie:r};let B="",P="",ca="MenuTemplate";if(this.Kxd)B=Ie.Nzh(),this.Kxd=!1,t.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ra=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);B=this.EPk(ra,h);t.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.ERi&&"OneDrive"===this.zHa&&(P=Ie.IOk(this.Ahn,v.AFrameworkApplication.ERi))}catch(ra){t.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),B=Ie.Nzh()}r=!0}else ca="MenuLoading",B=Ie.GPk(),t.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Ie.HPk(ca,B)+P,wie:r}}EPk(b,h){let r="";const B=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];let ra="";if(P){const Qa=P.Title,mb=P.AssetId;P=P.Thumbnails;mb&&Qa&&P&&({eym:P,returnValue:ra}=this.dwf(P),r+=Ie.QHc("jbtnNewTemplate"+ca,Qa,null,P,null,ra,h,mb))}B[ca]=
ra}b=new Oe.a(4,1,5E3,()=>{this.E8m(B)},106);this.HP.c6d.Wb(b);return r}y6c(){this.sHe=!0;this.HP.uRi.cKa(this.h6d.YOc);this.sHe=!1}get HP(){return this.cCa.value}get h6d(){return this.xvc.value}get zhn(){return this.LXa.value}get Ahn(){return this.Tbk.value}get zHa(){return this.Ncb.value}get Rie(){return this.qkk.value}}Object(n.a)(ee,"CreateNewActor",null,[]);class md{constructor(){this._initialized=!1;this.HUe={}}JB(b){this.hYh();return this.get(b)}contains(b){this.hYh();return b.toString()in
this.HUe}hYh(){this._initialized||(this.Svk(),this._initialized=!0)}Zeb(b,h){this.HUe[b.toString()]=h}get(b){return this.HUe[b.toString()]}}Object(n.a)(md,"AIntlHelper",null,[]);class nl extends md{constructor(){super()}Svk(){this.Zeb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Zeb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Zeb(2,CommonUIStrings.l_Open);this.Zeb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Zeb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Zeb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return nl._instance||
(nl._instance=new nl)}static Vxn(b){return nl.instance.JB(b)}}nl._instance=null;Object(n.a)(nl,"MruActorIntlHelper",md,[]);var gf;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(gf||(gf={}));Object(n.b)("DisplayState",gf);class yh{constructor(b,h,r,B,P,ca,ra,Qa){this.sve=null;this.sYe=!0;this.Thd="";this.qnk=0;this.bZb=null;this.WIe=3;this.Ca=Qa;this.cCa=b;this.hua=h;this.m3j=r;this.oYj=B;this.nYj=P;this.LXa=new zf.a(()=>new jk.a(ca.value,
null));this.a5j=new zf.a(()=>new jk.a(ra.value,Object(z.a)(this,this.sgn,"mruEventResultReceived")));this.Ca.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ca.$("UiHostSupportsDocRebootFeatures")}sgn(b,h){this.bZb=b;h||this.z9i()}rYn(){this.eN.wgc.fb(eb.a.a2f,Gd.a.frame,Object(z.a)(this,this.a2f,"populateMruMenu"),96)}a2f(b,h,r,B,P){return 1!==r&&P?this.uFn(P):32}uFn(b){this.Mwl();this.Lwl();b.PopulationXML=Ie.bwl(this.Thd+this.sve);return 32}Mwl(){var b=3;let h=!1;if(this.Thd&&this.qnk===this.bZb.zLo)t.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.WIe;else{t.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.eN.nq();this.bZb=this.rgn.jP("File Open opened",!0);this.Thd&&2!==this.WIe&&3!==this.bZb.state?h=!0:(b=this.zem(this.bZb),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.SRa&&rh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,
!0)),this.Thd=({rhn:b}=this.nMl(this.bZb)).returnValue);r=this.eN.nq()-r;t.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:gf[b]},1!==b&&(r.IsStale=h),t.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.WIe=b}zem(b){let h;try{h=I.c(b.cRf)}catch(r){h=null,t.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
r)}return h}Lwl(){this.sYe?(t.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.sve=({S4o:this.sYe}=this.z$m()).returnValue):t.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");t.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.sYe,["NotDisplayingLink"]:!this.sve})}nMl(b){let h;1===b.state||0===b.state?(t.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),
b=2,h=Ie.vzh(this.o3a(2),this.o3a(5))):3===b.state&&b.cRf?(h=this.JOk(b.cRf),b=0):(t.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=Ie.UHc(this.o3a(1),this.o3a(2)),b=1);return{returnValue:h,rhn:b}}JOk(b){let h;const r=this.N0c.XHc||"2155708348";if(b.length){h=Ie.THc("lblRecentDocuments",this.o3a(3));let B=0;for(let P=0;P<b.length;P++){const ca=b[P];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(h+=Ie.QHc("MruButton"+P,ca.FileName.toString(),ca.Path.toString(),
null,this.N0c.L3a,this.N0c.qUc,r,ca.DocumentUrl.toString()),ca.IsPinned&&B++)}h=Ie.j0a("RecentDocumentsMenuSection",Ie.KQi,this.o3a(2),h);t.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:B})}else h=Ie.UHc(this.o3a(0),this.o3a(2)),t.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}z$m(){let b;b=!0;let h=this.SMk;var r=this.RMk;if(h&&r||!this.eN.hVa)b=!1;else{const B=this.oTd.jP("File Open",
!1);3===B.state&&(h=B.Tda,r=B.J8a,b=!1)}r=r?String.format(this.o3a(4),r):null;return{returnValue:Ie.ANk(this.N0c.XHc,r,h),S4o:b}}z9i(){this.eN.uRi.cKa(this.N0c.YOc)}get eN(){return this.cCa.value}get o3a(){return this.hua.value}get N0c(){return this.m3j.value}get SMk(){return this.oYj.value}get RMk(){return this.nYj.value}get oTd(){return this.LXa.value}get rgn(){return this.a5j.value}}Object(n.a)(yh,"MruRenderer",null,[]);var Ef=c(1581);class vi{constructor(b,h,r,B,P,ca,ra){this.$v=null;this.rfh=
!1;this.$sa=this.D2=0;this.ick=b;this.CZb=h;this.psd=r;this.xvc=B;this.Ncb=P;this.cCa=ca;this.LXa=new zf.a(()=>new jk.a(ra.value,Object(z.a)(this,this.LGb,"getMoreInfoEventReceived")))}WKc(){!this.$v&&this.CTf.hVa?this.oTd.jP("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}LGb(b){if(!this.$v&&3===b.state)this.$v=b;else if(2===b.state){this.rfh?t.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.oTd.jP("NewDocumentFromStream",!0),this.rfh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.D2=
(new Date).getTime();var b=this.WCl.kNh;if(null===b)this.CZb(null);else{var h=this.psd.menuItemId,r=this.psd.lJa,B=this.psd.lFo,P=this.psd.dDl;this.$sa="streamBase64"===B?P.length/1024:0;t.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.Y7,this.$sa);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,E.a.Gj(this.zHa),E.a.Gj(h),E.a.Gj(this.Y7),E.a.Gj(v.AFrameworkApplication.lcid.toString()),
E.a.Gj(ca.toString()),E.a.Gj(r),E.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.em,E.a.Gj(B));b+="&"+v.AFrameworkApplication.HUd();v.AFrameworkApplication.JRa&&(b+="&"+v.AFrameworkApplication.iTd());(h=this.$v?this.$v.Tda:null)&&(b+="&DestinationUrl="+E.a.Gj(h));this.CTf.v1c.nj(b,2,P,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.uhn,"newDocumentFromStreamSuccessHandler"),Object(z.a)(this,this.thn,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,
void 0,void 0,"31")}}uhn(b){if(b&&b.data&&b.data.te)if(({Gt:h}=I.d(b.data.te)).returnValue)if(b=h,b.StatusCode!==wa.a.Zz&&b.StatusCode!==wa.a.m6b)t.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.Y7,this.$sa,b.StatusCode),this.CZb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.D2;t.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.Y7,this.$sa,h);this.ick(b.NewDocumentUrl)}else t.ULS.sendTraceTag(24904476,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.Y7,this.$sa),this.CZb(null);else t.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.Y7,this.$sa,{["ResponseData"]:Ef.a.$cd(b.data.te)}),this.CZb(null);else t.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.Y7,this.$sa),
this.CZb(null)}thn(b){b&&b.data&&t.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.Y7,this.$sa,b.data.status);this.CZb(null)}get Y7(){switch(this.CTf.Eda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get WCl(){return this.xvc.value}get zHa(){return this.Ncb.value}get CTf(){return this.cCa.value}get oTd(){return this.LXa.value}}Object(n.a)(vi,"NewDocumentFromStreamOperation",
null,[]);class Ml{constructor(b,h,r,B){this.xvc=b;this.Ncb=h;this.cCa=r;this.$4j=B}create(b,h,r){return new vi(b,h,r,this.xvc,this.Ncb,this.cCa,this.$4j)}}Object(n.a)(Ml,"NewDocumentFromStreamOperationFactory",null,[723]);var kk=c(132);class am{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(Ml,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Ud(()=>new Ml(new zf.a(()=>v.AFrameworkApplication.ta.Kb.brf()),
new zf.a(()=>v.AFrameworkApplication.zHa),new zf.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new zf.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.K.Nn(()=>{this.T3a()})}T3a(){const b=Db.a.Gp(Ya.a.instance.Sa("Common.INewAndOpenCommonHelpers")),h=Db.a.Gp(Ya.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.zHa&&kk.Task.WAA.call(null,b,h).continueWith(()=>{const r=new ee(new zf.a(()=>b.result),new zf.a(()=>
v.AFrameworkApplication.ta.Kb.brf()),new zf.a(()=>h.result),new zf.a(()=>v.AFrameworkApplication.ta.Kb.crf().XHc||"1959943459"),new zf.a(()=>v.AFrameworkApplication.zHa),new zf.a(()=>v.AFrameworkApplication.rRm));r.Ub();r.y6c()});if(v.AFrameworkApplication.d6f){const r=Db.a.Gp(Ya.a.instance.Sa("Common.IEventEmitter<Common.IMruResult>"));kk.Task.WAA.call(null,b,h,r).continueWith(()=>{const B=new yh(new zf.a(()=>b.result),new zf.a(()=>nl.Vxn),new zf.a(()=>v.AFrameworkApplication.ta.Kb.crf()),new zf.a(()=>
v.AFrameworkApplication.Uxn),new zf.a(()=>v.AFrameworkApplication.Txn),new zf.a(()=>h.result),new zf.a(()=>r.result),v.AFrameworkApplication.K);B.rYn();B.z9i()})}}dispose(){}}Object(n.a)(am,"UXPackageManager",null,[1,2,10]);var Wh=c(182);class Wg extends Wh.StandardDialog{constructor(){super();this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose)}MO(b){this.wx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}Bgf(b){this.wx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null,!0)}}Object(n.a)(Wg,"ErrorDialog",Wh.StandardDialog,[700]);var jg=c(464);class Lh{z5h(){t.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new jg.a;b.Dg("api.onedrive.com");return b.task}}Object(n.a)(Lh,"OneDriveConsumerEndpointHelper",null,[680]);var je=c(51);class oh{constructor(b,h,r,B){this.Lxb=this.JHa=null;this.PSe=this.RSe=!1;this.NZb=null;this.Ca=b;this.NUb=h;this.Wwb=r;this.uH=B}get vth(){return this.NUb}get K(){return this.Ca}x$b(){this.NZb||(this.NZb=this.Bhc?
Nb.a.create(this.Bhc,null,null,null,!1):null);return this.NZb}setup(b){this.Lxb=b;this.RSe||this.PSe?this.RSe&&this.Lxb&&this.Lxb(!0):(b=this.x$b())?(this.PSe=!0,b.A5a.continueWith(h=>{this.asn(h)}),Ta.a.UX(b)):(t.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Lxb(!1))}HXf(b){t.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}asn(b){this.PSe=!1;if(b.Gi)this.HXf(b),
this.Lxb(!1);else try{this.RSe=!0,t.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.RBf(),t.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Lxb(!0)}catch(h){t.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Lxb(!1)}}ebd(b){this.JHa=b;this.Wwb?t.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,
this.GVf,"onApiReady")))}GVf(b){b?this.C2d():this.Ep()}Ep(){this.uH().MO(je.a.exn)}onSuccess(b){t.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.JHa&&this.JHa(!0,b)}dispose(){this.NZb&&this.NZb.dispose()}}Object(n.a)(oh,"AOneDriveFilePickerApiManager",null,[726,10]);class Rd extends oh{constructor(b,h,r,B,P,ca){super(h,r,B,ca);this.Om=null;this.cua=b;this.ykk=P}get Bhc(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.Om=b;this.ebd(h)}RBf(){WL.init(1===
this.vth||2===this.vth?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}ebd(b){this.JHa=b;!this.Wwb&&this.cua.aWc?(t.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.GVf,"onApiReady"))):(t.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.ykk())}C2d(){try{t.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.Om).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){t.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Ep()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){t.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}t.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,b.error.message)}else t.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.JHa&&this.JHa(!1,b);this.Ep()}}Object(n.a)(Rd,"OneDriveFilePickerApiManagerV5",oh,[]);class Ii extends oh{constructor(b,h,r,B,P){super(b,h,r,B);this.Dnd=this.G$g=null;this.w2j=P;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.Jme,"toggleHostDivVisibility")}get Bhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.Dnd=h;const r=this.w2j.z5h();r.continueWith(()=>{t.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.G$g=r.result;this.ebd((B,P)=>{this.Jme();b(B,P)})},3);r.continueWith(()=>{t.ULS.sendTraceTag(24134242,352,15,r.exception.message);this.Jme()},5)}RBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.G$g;this.options.advanced.iframeParentDiv=
this.Dnd}C2d(){try{t.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Jme(),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Ep()}}onFailure(b){this.JHa&&this.JHa(!1,b);this.Ep()}Jme(){this.Dnd.style.visibility="hidden"===this.Dnd.style.visibility?"":"hidden"}}Object(n.a)(Ii,"OneDriveFilePickerApiManagerV7",oh,[]);class Lf extends oh{constructor(b,h,r,B){super(b,h,r,B);this.EWj=
b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Bhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h,r,B){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=B;this.options.cancel=h;this.EWj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.ebd(b)}ebd(b){this.JHa=b;this.Wwb?t.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.GVf,"onApiReady")))}RBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}C2d(){try{t.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){t.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Ep()}}HXf(b){t.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Ta.a.j1n(this.Bhc);this.NZb=null}Ep(){this.uH().Bgf(je.a.Rao)}onFailure(b){this.JHa&&this.JHa(!1,b)}}Object(n.a)(Lf,"OneDriveFilePickerApiManagerV72",
oh,[]);class ag{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(n.a)(ag,"IExtraData",null,[]);class xn extends Lf{constructor(b,h,r,B){super(b,h,r,B);this.options.advanced.filter=b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.Jth;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new ag(v.AFrameworkApplication.userSessionId))}get Bhc(){return this.K.kb("OneDriveApiV72Url")}C2d(){try{t.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Ep()}}}Object(n.a)(xn,"OneDriveFilePickerApiOpenManagerV72",Lf,[]);class Zj{constructor(b){this.jq=null;this.Zf=b;this.eRe=3}z5h(){this.jq=new jg.a;t.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.wcg();return this.jq.task}wcg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.GDb);this.Zf.ZAb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.O5l,"getMoreInfoSucceeded"),Object(z.a)(this,this.M5l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}M5l(b){if(b.data.Ne===wa.a.Bja&&"X-NewKey"in b.data.jj){t.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.jj["X-NewKey"];this.wcg(h)}else 0<this.eRe?(t.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.eRe),this.eRe--,this.wcg()):(t.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.jq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}O5l(b){"PersonalFileStorageUrl"in b.data.jj&&""!==b.data.jj.PersonalFileStorageUrl?(t.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.jq.Dg(b.data.jj.PersonalFileStorageUrl)):(t.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.jq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(Zj,"OneDriveForBusinessEndpointHelper",null,[680]);var dk=c(762);class Qe{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.W=b;this.W.register(Rd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Ud(()=>new Rd(dk.a.instance,v.AFrameworkApplication.K,
v.AFrameworkApplication.L8,v.AFrameworkApplication.dqa,v.AFrameworkApplication.cig,()=>new Wg));v.AFrameworkApplication.aKb?this.W.register(680,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Lh):this.W.register(680,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Zj(v.AFrameworkApplication.He));this.W.register(Ii,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Ud(()=>new Ii(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,
v.AFrameworkApplication.dqa,()=>new Wg,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Lf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Ud(()=>new Lf(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,v.AFrameworkApplication.dqa,()=>new Wg));this.W.register(xn,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Ud(()=>new xn(v.AFrameworkApplication.K,v.AFrameworkApplication.L8,v.AFrameworkApplication.dqa,
()=>new Wg))}static main(){L.a.instance.Gc(new Qe)}}Object(n.a)(Qe,"PackageManager",null,[1,2]);class pk{constructor(b,h,r,B,P,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=B;this.WasServiceDown=P;this.AffinitizedUrl=ca}}Object(n.a)(pk,"SafeLinksData",null,[]);class io{constructor(b,h){this.Ole=b;this.YA=h}}Object(n.a)(io,
"SafeLinksGetUrlReputationRequestData",null,[]);class Oh{constructor(b,h,r,B){this.Ca=b;this.Zf=h;this.u5j=r;Oh.je=B}Eoc(b,h,r){try{var B=null;Oh.je&&(B=Oh.je.Yf("WebServiceCall","SafeLinksGetUrlReputation"));const P=new io(h,B);B={};B.AffinitizedUrl=b;B.TargetUrl=h;B.PolicyCookie=r;const ca=I.c(B);this.Zf.nj(this.u5j,2,ca,null,!1,2,Object(z.a)(this,this.Hpn,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.Gpn,"onGetUrlReputationFailureCallback"),P,void 0,void 0,3E3,3E3,"36");return!0}catch(P){t.ULS.sendTraceTag(588788033,
378,10,P.message)}return!1}Hpn(b){let h="OnGetUrlReputationSuccessCallback: ",r=10;const B=b.data.state;try{const P=I.b(b.data.te).reputationResults[0],ca=P.navigateUrl.length,ra=B.Ole.length,Qa=P.navigateUrl===B.Ole;P.navigateUrl&&0<P.navigateUrl.length&&(B.Ole=P.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Ne,P.verdict,ra.toString(),ca.toString(),Qa.toString());r=50}catch(P){h+=String.format("Exception {0}",
P.message)}this.Emi(B,h,r)}Gpn(b){let h="OnGetUrlReputationFailureCallback: ";const r=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Ne)}catch(B){h+=String.format("Exception {0}",B.message)}this.Emi(r,h,10)}Emi(b,h,r){b.YA&&(b.YA.stop(),b.YA=null);t.ULS.sendTraceTag(588788034,378,r,h);Qd.a.vm(b.Ole,void 0,"noopener,noreferrer","SafeLinksNav")}}Oh.je=null;Object(n.a)(Oh,"SafeLinksNavigationHelper",null,[]);var Zg;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=
1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Zg||(Zg={}));Object(n.b)("SafeLinksNavigationState",Zg);class yg{constructor(b,h,r,B=!1,P=null,ca=null){this.Bvb=this.Avb=0;this.UWc=this.Tmd=!1;this.gdb=null;this.LYb=!0;this.exd=null;t.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ca=b;this.Zf=h;this.Yea=r;yg.je=ca;this.tpk=B?this.Ca.kb("SafeLinksHandlerWebServiceBase"):
this.Ca.kb("WebServiceBase");this.Ook=this.Ca.kb("SafeLinksHashedUserId");this.a9o=this.Ca.kb("SafeLinksWorkloadIdHeaderValue");this.Brd=this.Ca.nc("SafeLinksMaxGetPolicyBootRetries",2);this.Crd=this.Ca.nc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.mpd=this.CUm();this.lpd=this.BUm();yg.Mlh=this.Ca.kb("UserPrincipalName")||"";yg.sEc=this.Ca.kb("TenantId")||"";t.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.mpd,this.lpd);if(this.mpd&&
this.lpd){h=(b=this.Yib())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.wHf();t.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var ra=!b||"unknown"===h||b.WasServiceDown||r,Qa=ob.a.wG();Qa&&(Qa.set("shouldGetSafeLinksDataFromServer",ra.toString()),Qa.set("isSafeLinksEnabledCacheValue",h.toString()));P?(this.LYb=!1,P.execute(mb=>{mb.isFeatureEnabled("MsoUrlreputation",!0).then(Jb=>{this.LYb=Jb;Qa.set("isUserLicensedForSafeLinks",this.LYb.toString());
xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa);this.LYb&&ra&&this.AUd(!0);return null})})):(xa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa),ra&&this.AUd(!0))}}get appName(){return this.Yea}get Upe(){return this.tpk}get userId(){return this.Ook}get nki(){try{if(""===yg.YCe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=v.AFrameworkApplication.buildVersion;b.OS=this.Ca.kb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
yg.YCe=window.self.btoa(h)}}catch(b){t.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return yg.YCe}get R$l(){const b=this.Upe?this.Upe+"/":"",h=new xb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ae("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Ae("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.em)}get hkm(){const b=this.Upe?this.Upe+"/":"",h=new xb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ae("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ae("s2saat","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Ae("s2se03","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.Ae("sladpar",this.nki);h.Ae("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.em)}get Ygn(){yg.PRe||(yg.PRe=new Oh(this.Ca,this.Zf,this.hkm,yg.je));return yg.PRe}Eoc(b){if(!b)return t.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.TOm(b);t.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.mpd,this.lpd,this.LYb);if(!(h&&this.mpd&&this.lpd&&this.LYb))return!1;h=0;const r=({state:h}=this.Kvo()).returnValue;t.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Zg[h]);const B=ob.a.wG();B&&B.set("SafeLinksNavigationState",Zg[h]);xa.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",B);if(!r)return 2!==h&&3!==h||xa.Health.instance.recordKpiFailure("SafeLinksNavigations",Zg[h],!1,!0,null),!1;t.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.hwo())return this.wHf()?!1:this.Ygn.Eoc(this.qNl(),b,this.jfi());if(!this.wHf())return this.pDj(b),!0;this.gdb=b;t.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.UWc=!1;this.AUd();return!0}TOm(b){b=b.toLowerCase();const h=this.Ca.EB("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}AUd(b=!1){var h=ob.a.wG();h&&h.set("isOnBootRequest",b.toString());
xa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);xa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.Yaf("SafeLinksGetPolicy");this.Zf.nj(this.R$l,1,null,null,!0,2,Object(z.a)(this,this.rdm,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.qdm,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.UWc=b;this.Tmd=!0;b?this.Avb++:this.Bvb++}rdm(b){let h=wa.a.Kin,
r="";try{this.Tmd=this.UWc=!1;var B=b.data.state;const Mc=({YA:B}=this.Hke(B)).returnValue,Wc=Object.assign(new sb.a,{durationMs:Mc});xa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Wc);t.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Ne,b.data.te.length,Mc);if(b.data.Ne!==wa.a.Zz)r="Unexpected httpStatus: "+b.data.Ne.toString();else{B=null;try{B=I.b(b.data.te)}catch(id){r="Exception:"+
id.toString()+" deserializing response";return}if(B){var P=B.IsSafeLinksEnabled;if(void 0===P||null===P||0>=P.length)r="Invalid isSafeLinksEnabledString";else{t.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",P);var ca=yg.w0f(P);if(void 0===B.WebAffinitizedUrl||null===B.WebAffinitizedUrl||0>=B.WebAffinitizedUrl.length)r="Invalid WebAffinitizedUrl";else if(void 0===B.PolicyCookie||null===B.PolicyCookie||0>=B.PolicyCookie.length)r="Invalid PolicyCookie";else if(void 0===B.PolicyCookieTTL||
null===B.PolicyCookieTTL)r="Invalid PolicyCookieTTL";else{var ra=B.WebAffinitizedUrl,Qa=B.PolicyCookie,mb=B.AffinitizedUrl,Jb=new Date;Jb.setMinutes(Jb.getMinutes()+(5<B.PolicyCookieTTL?B.PolicyCookieTTL-5:0));var Yb=Jb.getTime(),fc=new pk(P,ra,Qa,Yb,!1,mb);this.Ykj(fc);h=b.data.Ne;this.gdb&&(ca?(this.pDj(this.gdb),this.Bvb=this.Avb=0):(t.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",
!0,!0,null),Qd.a.Bib(this.gdb)),this.gdb=null)}}}else r="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Mc){r="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Mc.toString()}finally{h!==wa.a.Zz&&this.Dmi(h,r)}}qdm(b){this.Tmd=!1;let h=500,r="";try{let B=b.data.state;const P=({YA:B}=this.Hke(B)).returnValue,ca=Object.assign(new sb.a,{durationMs:P});h=b.data.Ne;xa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),
!1,!0,ca);r="Request Failed, Status="+ok.a[b.data.status]+" Duration: "+P}catch(B){r="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+B.toString()}finally{this.Dmi(h,r)}}Dmi(b,h=""){try{if(t.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Avb<this.Brd&&this.Bvb<this.Crd)this.AUd(this.UWc);else{this.UWc=!1;t.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.Avb,this.Bvb,b,h);h=null;const r=ob.a.wG();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new sb.a,{extendedProperties:r}));xa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const B=new pk("false","","",0,!0,"");this.Ykj(B);this.gdb&&(t.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),xa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Qd.a.Bib(this.gdb),this.gdb=null)}}catch(r){t.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}pDj(b){const h=this.jfi(),r=this.vlm(),B={};B.Url=b;B.SafeLinksCookie=h;B.CorrelationId=Lb.a.create().toString();B.WorkloadId=this.a9o;B.UserAgentInfo=ba.a.rG+"|"+this.appName;this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(B.User=yg.Mlh,B.TenantId=yg.sEc,B.AdditionalProperties=this.nki);t.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",B.CorrelationId);Qd.a.n2f(Qd.a.gsa(4),r,B)}CUm(){const b=this.Ca.kb("IsSafeLinksEnabledForUser");return b?yg.w0f(b):!1}BUm(){const b=this.Ca.EB("SafeLinksDisabledBrowsers");if(ba.a.Q4){if(this.Ca.rw("SafeLinksForTeamsIsEnabled")&&this.Ca.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,ba.a.rG))return!1;return"officecomhwa"===(this.Ca.kb(v.AFrameworkApplication.Fka)||"").toLowerCase()?
!1:!0}hwo(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&ba.a.xXc?!0:ba.a.Q4}Kvo(){let b;b=0;const h=this.Yib(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(t.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(t.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:yg.w0f(r),state:b};if(this.Tmd)return b=3,t.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Avb>=this.Brd||this.Bvb>=this.Crd)return b=2,t.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Avb,this.Brd,this.Bvb,this.Crd),{returnValue:!1,state:b};t.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.Brd+this.Crd-(this.Avb+this.Bvb));return{returnValue:!0,state:b}}jfi(){const b=this.Yib();return b?b.PolicyCookie:""}vlm(){const b=this.Yib();return b?b.WebAffinitizedUrl:""}qNl(){const b=this.Yib();return b?b.AffinitizedUrl:""}TXl(){const b=new Date;try{const h=this.Yib();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){t.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}wHf(){const b=this.TXl();return!!b&&b.getTime()<Date.now()}Yib(){if(!this.exd){const b=
Ua.a.instance.getItem(this.userId);if(!b||""===b)return null;this.exd=JSON.parse(b)}return this.exd}Ykj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.exd=b;b.WasServiceDown||this.p9o(b)}p9o(b){b=JSON.stringify(b);Ua.a.instance.setItem(this.userId,b)}Yaf(b){return void 0!==yg.je&&null!==yg.je?yg.je.Yf("WebServiceCall",
b):null}Hke(b){if(void 0!==b&&null!==b){const h=b.pi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,YA:b}}static w0f(b){return"false"!==b.toLowerCase()?!0:!1}}yg.je=null;yg.PRe=null;yg.sEc="";yg.Mlh="";yg.YCe="";Object(n.a)(yg,"SafeLinksManager",null,[696]);const Nn=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},rf=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class ge{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}wc(b){this.W=b}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.$x,"onFullAppSettingsReady"))}dispose(){}$x(){v.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(yg,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Ud(()=>new yg(v.AFrameworkApplication.K,v.AFrameworkApplication.He,String.format("{0}-{1}",
Nn(v.AFrameworkApplication.ta.Kb.xk),rf(v.AFrameworkApplication.ta.Kb.aja)),!1,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.ta.Kq)),this.W.Oa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){L.a.instance.Gc(new ge)}}Object(n.a)(ge,"SafeLinksPackage",null,[1,2]);var bh=c(212);class lj{constructor(b){this.sa=new wd.a;this.Mh=b}cfb(b){this.sa.addHandler(lj.Gza,b)}k7c(b){this.sa.removeHandler(lj.Gza,b)}J_a(b){this.sa.addHandler(lj.CVa,b)}gPb(b){this.sa.removeHandler(lj.CVa,
b)}L0e(b){this.sa.addHandler(lj.coc,b)}whg(){this.sa.raiseEvent(lj.Gza)}Azf(){return bh.a.instance.URa(v.AFrameworkApplication.Cy)}}lj.Gza="SE";lj.v9c="SEP";lj.CVa="SER";lj.coc="TRP";Object(n.a)(lj,"NullSessionExpirationManager",null,[678,679]);class ol{constructor(){this.pDc=this.Vdb=!1;const b=v.AFrameworkApplication.Cy;0>=b||(this.Cy=b,t.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Cy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.xX}),
bh.a.instance.Vrh(Object(z.a)(this,this.thc,"onSessionExpiredDetected")),bh.a.instance.Urh(Object(z.a)(this,this.S2c,"onSessionExpiringDetected")))}thc(){bh.a.instance.wcj(Object(z.a)(this,this.thc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Ryf()}S2c(){bh.a.instance.W2n(Object(z.a)(this,this.S2c,"onSessionExpiringDetected"));this.pDc||this.Vdb||(t.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.pDc=!0,
this.eig())}Ryf(){this.Vdb||(v.AFrameworkApplication.mN(je.a.u9c),this.Vdb=!0,this.Cje())}}Object(n.a)(ol,"ASessionExpirationManager",null,[]);var Pf=c(156),zi=c(278);class $e{constructor(b,h,r,B){this.Cmg="";this.Cgd=b;this.fgh=r;this.bgh=B;this.r1g=h;b=(new Date(this.Cgd)).format(v.AFrameworkApplication.pqj);this.Cmg=this.r1g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}$kc(b){1===b?this.fgh&&this.fgh(this.r1g):0===b&&v.AFrameworkApplication.va.Qb(eb.a.close,
2,zi.g)}dispose(){this.bgh&&this.bgh()}}$e.id="SessionExpirationDialog";Object(n.a)($e,"SessionExpirationDialogSharedProperties",null,[]);class qn{}qn.Vg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(n.a)(qn,"SessionExpirationDialogHtml",null,[]);class fl extends Pf.a{constructor(b,h,r,B){super(h);const P={};this.OZa=new $e(b,h,r,B);this.zg=$e.id;v.AFrameworkApplication.QBh?(this.Cd=1,
this.ye(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Kt=!1);h||1===v.AFrameworkApplication.ta.mode?this.ye(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ye(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Vg=qn.Vg;P.WACSessionExpirationText=this.OZa.Cmg;this.Uh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.$kc,"sessionExpirationDialogHandler"),P);this.M5(this.rj("WACSessionExpirationText"))}$kc(b){this.OZa.$kc(b)}Wzf(){this.hide()}dispose(){super.dispose();
this.OZa&&this.OZa.dispose()}}Object(n.a)(fl,"LegacySessionExpirationDialog",Pf.a,[834]);class Qj extends Wh.StandardDialog{constructor(b,h,r,B){super(h);this.OZa=new $e(b,h,r,B);this.zg=$e.id;v.AFrameworkApplication.QBh?(this.Cd=1,this.ye(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Kt=!1);h||1===v.AFrameworkApplication.ta.mode?this.ye(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ye(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.sv(CommonUIStrings.l_DefaultDialogTitle,
this.OZa.Cmg,0,Object(z.a)(this,this.$kc,"sessionExpirationDialogHandler"))}$kc(b){this.OZa.$kc(b)}Wzf(){this.hide()}dispose(){super.dispose();this.OZa&&this.OZa.dispose()}}Object(n.a)(Qj,"SessionExpirationDialog",Wh.StandardDialog,[834]);const rm=(b,h,r,B)=>v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF&&v.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Qj(b,h,r,B):new fl(b,h,r,B);var Ai=c(203);class qk extends ol{constructor(b){super();this.Ixd=this.A0b=
!0;this.q_=null;this.sa=new wd.a;this.Mh=b}cfb(b){this.sa.addHandler(qk.Gza,b)}k7c(b){this.sa.removeHandler(qk.Gza,b)}J_a(b){this.sa.addHandler(qk.CVa,b)}gPb(b){this.sa.removeHandler(qk.CVa,b)}L0e(b){this.sa.addHandler(qk.coc,b)}Azf(){return bh.a.instance.URa(v.AFrameworkApplication.Cy)}whg(b){this.A0b=b}eig(){if(!this.q_&&!Ai.a.EM){if(this.Ixd){const b=Object(z.a)(this,this.i7b,"disposeCallback");this.q_=rm(this.Cy,!1,Object(z.a)(this,this.alc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(qk.v9c)}}Cje(){this.q_&&
(this.q_.Opa&&this.q_.Wzf(),this.q_=null);if(this.A0b){const b=Object(z.a)(this,this.i7b,"disposeCallback");this.q_=rm(this.Cy,!0,Object(z.a)(this,this.alc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(qk.Gza)}i7b(){this.q_=null}alc(b){(b||this.Mh.uEd())&&this.Mh.refreshDocument(null)}}qk.Gza="SE";qk.v9c="SEP";qk.CVa="SER";qk.coc="TRP";Object(n.a)(qk,"SessionExpirationManager",ol,[678,679]);class pe{}pe.Zpk="Aborting";pe.HBd="ActivityDuration";pe.error="Error";pe.Gjf="Errors";pe.failed="Failed";
pe.iFb="FirstActivity";pe.initialized="Initialized";pe.kickedOut="KickedOut";pe.B_m="LastActivity";pe.Ifj="RetryOverride";pe.Gee="RequestGroups";pe.vpb="Requests";pe.Ree="Responses";pe.xge="SessionDuration";pe.status="Status";pe.success="Success";pe.dGo="Successful";pe.tokens="Tokens";pe.L1f="PollingDuration";Object(n.a)(pe,"SessionExpirationStrings",null,[]);class hb{constructor(b){this.sC={};this.Zka={};this.YYa={};this.gLi=15;this.n3g=!1;this.njk=new Date;this.zqd=new Date;this.Ib=b;this.jO=new Oe.a(2,
2,6E4*this.gLi,Object(z.a)(this,this.CMj,"writeMeasures"),135,"SL",!1);this.Ib.Wb(this.jO);this.$Bm()}CMj(){t.ULS.sendTraceTag(41964821,217,50,t.ULS.qZc({["Aggregate"]:this.Zka,["Current"]:this.sC}))}$Bm(){this.Zka[pe.Gee]=0;this.Zka[pe.vpb]=0;this.Zka[pe.Ree]=0;this.Zka[pe.status]=pe.initialized;this.Zka[pe.iFb]=new Date;this.Zka[pe.xge]=0;this.Zka[pe.HBd]=0;this.Zka[pe.xge]=0;this.sC[pe.xge]=0;this.Zka[pe.HBd]=0;this.sC[pe.HBd]=0}get KEn(){this.YYa[pe.L1f]=+new Date-+this.YYa[pe.iFb];return this.YYa}xBf(b,
h){var r=b[h];r=r?r:0;r++;b[h]=r;this.keg(b)}keg(b){const h=new Date;b[pe.HBd]=+h-+this.zqd;this.zqd=h;b[pe.xge]=+this.zqd-+this.njk;b[pe.B_m]=this.zqd}J$(b,h){this.sC[b]=h;this.keg(this.sC)}Adg(b,h){this.sC[b]=h;this.keg(this.sC)}Dbc(b){this.xBf(this.sC,b);this.xBf(this.Zka,b);this.xBf(this.YYa,b)}flush(){this.n3g||(this.Zka[pe.status]=this.sC[pe.status],this.CMj(this.jO),this.Ib.z1(this.jO,6E4*this.gLi))}W6n(){const b=this.sC[pe.status];b&&(this.Zka[pe.status]=b);this.sC={}}m7n(){this.YYa={};this.YYa[pe.L1f]=
0;this.YYa[pe.iFb]=new Date}stop(){t.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.n3g=!0;this.Ib.ff(this.jO)}}Object(n.a)(hb,"SessionLogger",null,[674]);class Ib{constructor(b,h){this.Gzd=b;this.yBa=h}get tokens(){return this.Gzd}get errors(){return this.yBa}}Object(n.a)(Ib,"TokenRefreshArgs",null,[697]);var gc=c(400);class Lc extends Sys.EventArgs{constructor(b,h,r,B,P,ca,ra){super();this.YYa=b;this.BEn=h;this.Gee=B;this.failed=P;this.vpb=ca;this.Ree=
ra}}Object(n.a)(Lc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Rc=c(36);class qd{constructor(b,h=null,r=null){this.pDc=this.Vdb=!1;this.Ixd=this.A0b=!0;this.sa=new wd.a;this.rDc=this.qyc=this.uvd=!1;this.ryb=null;this.Fbh=10;this.Qpd=!1;this.vWe=b;this.bIe=v.AFrameworkApplication.HYm;this.Ib=Rg.a.instance;t.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:v.AFrameworkApplication.Cy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.xX});
this.ve=h||new hb(Rg.a.instance);this.Dma=r;bh.a.instance.Vrh(Object(z.a)(this,this.Tpk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));bh.a.instance.Urh(Object(z.a)(this,this.$Ye,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));gc.SessionStatusManager.instance.I0e(Object(z.a)(this,this.$Ye,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));gc.SessionStatusManager.instance.yzk(Object(z.a)(this,this.DGn,"preemptiveTokenRefresh"));this.H4g=new Date;v.AFrameworkApplication.GYm&&
(bh.a.instance.m7e=Object(z.a)(this,this.GUn,"refreshAccessTokenWhenSessionExpired"));b=!1;v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Fbh=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=v.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));
b?gc.SessionStatusManager.instance.I0e(Object(z.a)(this,this.Upk,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):gc.SessionStatusManager.instance.I0e(Object(z.a)(this,this.$Ye,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}cfb(b){this.sa.addHandler(qd.Gza,b)}k7c(b){this.sa.removeHandler(qd.Gza,b)}J_a(b){this.sa.addHandler(qd.CVa,b)}gPb(b){this.sa.removeHandler(qd.CVa,b)}L0e(b){this.sa.addHandler(qd.coc,b)}Azf(){return bh.a.instance.URa(v.AFrameworkApplication.Cy)}GUn(){this.gTc(!1);
return!bh.a.instance.URa(v.AFrameworkApplication.Cy)}Tpk(b,h){bh.a.instance.j1d?this.thc(b,h):this.bIe?(this.qyc=!1,this.gTc(!1)):(this.Vdb||t.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.thc(b,h))}Upk(b,h){bh.a.instance.i1d?this.S2c(b,h):(Rc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.qyc=!1,this.gTc(!0))}$Ye(b,h){bh.a.instance.i1d?this.S2c(b,h):this.gTc(!0)}gTc(b){if(!this.uvd&&!this.qyc)if(this.Dma&&
this.Dma.Io)this.rDc=!0,this.ve.J$(pe.status,pe.kickedOut),this.ve.flush(),this.ve.stop();else if(t.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.rDc),this.rDc)this.Cje();else{this.ve.flush();this.ve.W6n();this.ve.Dbc(pe.Gee);this.uvd=!0;this.Qpd||(this.ve.m7n(),this.Qpd=!0,this.P9k());const h=this.vWe.$Un(b);h.continueWith(()=>{if(this.vWe.JKn(h))this.ve.Dbc(pe.dGo),this.ve.J$(pe.status,pe.success),this.Ixd=!1,this.bIe&&(this.A0b=!1),this.qyc=!1,this.H4g=
new Date,this.PEo(),this.sa.raiseEvent(qd.CVa,new Ib(h.result.tokens,null));else{const r=h.result.errors;this.ve.Dbc(pe.failed);this.ve.J$(pe.status,pe.failed);b||(this.rDc=this.vWe.SXc(r));this.rDc&&(this.ve.J$(pe.Zpk,JSON.stringify(r)),t.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.qyc=!0;this.sa.raiseEvent(qd.CVa,new Ib(null,r))}this.ve.flush();this.uvd=!1})}}thc(){this.bIe||bh.a.instance.wcj(Object(z.a)(this,this.thc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(39408094,
217,50,"SessionExpiredDetected");this.Ryf(bh.a.instance.j1d)}S2c(){this.pDc||this.Vdb||(t.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.pDc=!0,this.eig(bh.a.instance.i1d))}Ryf(b){if(!this.Vdb){var h=b?je.a.zgo:je.a.u9c;const r=Object.assign(new sb.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));v.AFrameworkApplication.mN(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(v.AFrameworkApplication.xX),t.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&xa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Vdb=!0;this.Cje()}}PEo(){this.Qpd&&(this.Ib.ff(this.ryb),this.Qpd=!1)}P9k(){this.ryb=new Oe.a(2,2,1E3*this.Fbh,Object(z.a)(this,this.xMo,"tokenRefreshPolling"),
135);this.Ib.Wb(this.ryb)}xMo(){const b=this.ve.KEn;t.ULS.sendTraceTag(555255521,217,50,"{0}",I.c(b));this.sa.raiseEvent(qd.coc,new Lc(b,b[pe.L1f],b[pe.iFb],b[pe.Gee],b[pe.failed],b[pe.vpb],b[pe.Ree]))}DGn(){3E5<+new Date-+this.H4g?(t.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.gTc(!1)):t.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}qd.Gza="SE";qd.v9c="SEP";qd.CVa="SER";qd.coc="TRP";Object(n.a)(qd,
"ASessionExpirationManagerWithRefresh",null,[]);class Ld extends qd{constructor(b,h,r=null,B=null){super(h,r,B);this.q_=null;this.Mh=b}whg(b){this.A0b=b}eig(b){if(!this.q_&&!Ai.a.EM){if(b){var h=Object(z.a)(this,this.i7b,"disposeCallback");this.q_=rm(v.AFrameworkApplication.Ipb,!1,Object(z.a)(this,this.alc,"sessionExpirationHandler"),h)}else if(this.Ixd){if(this.uvd)return;h=Object(z.a)(this,this.i7b,"disposeCallback");this.q_=rm(v.AFrameworkApplication.Cy,!1,Object(z.a)(this,this.alc,"sessionExpirationHandler"),
h)}t.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",qd.v9c,b);this.sa.raiseEvent(qd.v9c)}}Cje(){this.q_&&(this.q_.Opa&&this.q_.Wzf(),this.q_=null);if(this.A0b){this.ve.stop();if(this.Dma&&this.Dma.Io)return;const b=Object(z.a)(this,this.i7b,"disposeCallback");this.q_=rm(v.AFrameworkApplication.Cy,!0,Object(z.a)(this,this.alc,"sessionExpirationHandler"),b)}t.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",qd.Gza);this.sa.raiseEvent(qd.Gza)}i7b(){this.q_=null}alc(b){(b||
this.Mh.uEd())&&this.Mh.refreshDocument(null)}}Object(n.a)(Ld,"SessionExpirationManagerWithRefresh",qd,[678,679]);class zd{constructor(b,h,r=null,B=null){this.ulh=!1;this._instance=null;this._frame=b;this.Nm=h;this.ve=r||new hb(Rg.a.instance);this.Dma=B}create(){this.ulh=v.AFrameworkApplication.eSa;if(!this.ulh)return new qk(this._frame);v.AFrameworkApplication.eo("WOPITokenRefreshIsEnabled");t.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(v.AFrameworkApplication.C5o){case 1:t.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this._instance=new lj(this._frame);break;case 2:t.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Ld(this._frame,this.Nm,this.ve,this.Dma);break;default:t.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new qk(this._frame)}t.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());
return this._instance}}Object(n.a)(zd,"SessionExpirationManagerFactory",null,[677]);class pf{}Object(n.a)(pf,"Error",null,[]);class Jc{}Object(n.a)(Jc,"NamedResult",null,[]);class gg extends Jc{}Object(n.a)(gg,"ErrorInfo",Jc,[]);var dc=c(1095);class ng{constructor(b,h,r,B=null,P=!1,ca=null,ra=!1,Qa=!1){this.xCa=0;this.MNa=this.Co=null;this.Gzd=new vb.a;this.yBa=new vb.a;this.jq=null;this.Yxc=!1;this.FEc=this.GEc=null;this.Ib=b;this.Kbh=h;this.Kbh.execute(mb=>{mb.eC(M.a.wAf,Object(z.a)(this,this.Xpn,
"onHostResponseReceived"))});this.v3=r;this.Zjh=new dc.a("WebServiceCall","TokenRefresh");this.ve=B||new hb(b);this.gjk=P;this.rf=ca?ca:gc.SessionStatusManager.instance;this.wUg=ra;this.mld=Qa}Xpn(b){if(b.MessageId!==M.a.wAf)Rc.b(39408099,306,15,"Unexpected message.");else{var h=new vb.a,r=new vb.a;this.ve.Dbc(pe.Ree);var B=b.Values[H.a.xkj];if(!B||0>=B.length)Rc.b(40122317,306,15,"Found no tokens in the dictionary"),B=b.Values;Rc.b(40122318,306,100,"The Tokens array contains {0} tokens",B.length);
this.ve.J$("Correlation",b.CorrelationId);var P="";for(let Qa=0;Qa<B.length;Qa++){this.ve.Adg(pe.tokens,B.length);var ca=B[Qa],ra=ca;if(!ra||!ra.Name)continue;this.ve.Dbc(ra.Name);const mb=ca;if(mb&&mb.Value)Rc.b(39408128,306,100,"Received token with name: {0}",mb.Name),h.add(mb),this.Gzd.add(mb),this.mld||this.ve.J$(pe.status,pe.success),this.wUg&&this.rf&&this.rf.E7n();else if(ca=this.Cdm(ca),Rc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ra.Name,
JSON.stringify(ca),this.MNa),r.add(ca),this.mld||(this.yBa.add(ca),P=JSON.stringify(ca),this.ve.J$(pe.error,JSON.stringify(ca)),this.ve.J$(pe.status,pe.failed)),this.wUg)for(const Jb of ca.Errors)ra=this.HXl(Jb),this.rf&&this.rf.zwk(ra)}this.mld?(0<r.count?this.FEc?this.FEc(new Ib(h,r)):Rc.b(512267295,306,15,"Received errors but the promise has completed"):this.GEc?this.GEc(new Ib(h,r)):Rc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Rc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,r.count,b.CorrelationId,this.MNa)):(0<r.count&&""!==P?(B=Object.assign(new sb.a,{extendedProperties:new Map}),B.extendedProperties.set("Errors",P),B.extendedProperties.set("RetryCount",this.xCa.toString()),B.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),B.extendedProperties.set("IsTokenExpiring",this.Yxc.toString()),xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,B)):xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),
Rc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.MNa),0<r.count&&!this.SXc(r)?(b=this.v3.Cgi(r),b!==this.v3.akc&&(this.ve.Adg(pe.Ifj,b),this.Ib.z1(this.Co,b))):(this.ve.flush(),this.Co&&(Rc.b(39408131,306,100,"Deleting task {0} from task manager",this.Co.name),this.Ib.ff(this.Co)),this.jq&&!this.jq.task.isCompleted?this.jq.Dg(new Ib(h,r)):Rc.b(512267293,306,15,"Received results but the task has completed")))}}Cdm(b){if(!b)return null;
const h=Object.assign(new gg,{Name:b.Name,Errors:[]});for(const r of b.Errors)b=new pf,b.Id=r.Id,b.Details=ia.a.V$b(r.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.tej()}tej(){v.AFrameworkApplication.se("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.xCa>=this.v3.P4d?(Rc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.MNa),this.Kal(this.jq)):(xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Gjj())}Gjj(){const b=
{};b[H.a.xkj]=this.v3.tokens;const h=Lb.a.create().toString();Rc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.v3.tokens),this.xCa+1,h,this.MNa);this.Kbh.execute(r=>{r.sendMessage(M.a.h2e,b,h)});this.xCa++;this.ve.Dbc(pe.vpb)}Kal(b){const h=new vb.a;for(let r=0;r<this.v3.tokens.length;r++){const B=Object.assign(new gg,{Name:this.v3.tokens[r],Errors:[Object.assign(new pf,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(B);this.yBa.add(B)}this.Ib.ff(this.Co);this.ve.J$(pe.Gjf,JSON.stringify(this.yBa));this.ve.J$(pe.status,pe.failed);b&&!b.task.isCompleted&&b.Dg(new Ib(new vb.a,this.yBa))}$Un(b){this.Zjh.start();this.Yxc=b;this.MNa=Lb.a.create().toString();Rc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.MNa,this.Yxc);this.xCa=0;this.yBa.clear();this.Gzd.clear();this.jq=new jg.a;this.mld?this.uej(this.v3.P4d).then(h=>{this.jq&&!this.jq.task.isCompleted&&this.jq.Dg(h);this.FEc=
this.GEc=null;this.ve.J$(pe.Gjf,JSON.stringify(this.yBa));this.ve.J$(pe.status,pe.success);this.ve.flush()}).catch(h=>{this.jq&&!this.jq.task.isCompleted&&this.jq.Dg(Object(Na.a)(697,h));this.FEc=this.GEc=null;this.ve.J$(pe.Gjf,JSON.stringify(this.yBa));this.ve.J$(pe.status,pe.failed);this.ve.flush()}):(this.Co=new Oe.a(this.v3.priority,2,this.v3.akc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,M.a.h2e,!0),this.gjk&&this.tej(),this.Ib.Wb(this.Co));return this.jq.task}uej(b){const h=
this,r=new Promise((Qa,mb)=>{h.GEc=Qa;h.FEc=mb;xa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.Gjj()}),B=this,P=new Promise((Qa,mb)=>{window.setTimeout(()=>{mb(B.tMh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},B.v3.akc)});let ca=b;const ra=this;return new Promise((Qa,mb)=>{ca--;Promise.race([r,P]).then(Jb=>{xa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Qa(Jb)}).catch(Jb=>{var Yb=ra.v3.akc;if(Object(uc.a)(697,Jb)&&
(Jb=Object(Na.a)(697,Jb),0<Jb.errors.count)){ra.F5m(Jb.errors);ra.Uoh(Jb.errors);if(ra.SXc(Jb.errors)){mb(Jb);return}const fc=ra.v3.Cgi(Jb.errors);fc!==ra.v3.akc?(ra.ve.Adg(pe.Ifj,fc),Yb=fc):ra.cXm(Jb.errors)&&(Yb=0)}ca?window.setTimeout(()=>{ra.uej(ca).then(Qa).catch(mb)},Yb):(Yb=ra.tMh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ra.Uoh(Yb.errors),mb(Yb),Rc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ra.MNa))})})}Uoh(b){for(let h of b)this.yBa.add(h)}cXm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}tMh(b,h){const r=new vb.a;for(let B=0;B<this.v3.tokens.length;B++){const P=this.Lal(this.v3.tokens[B],b,h);r.add(P)}return new Ib(new vb.a,r)}Lal(b,h,r){return Object.assign(new gg,{Name:b,Errors:[Object.assign(new pf,{Id:h,Details:r})]})}F5m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new sb.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.xCa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.Yxc.toString());xa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.ve.J$(pe.error,b);this.ve.J$(pe.status,pe.failed)}}JKn(b){this.Zjh.stop();const h=this.Bsm(b.result.errors);t.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.MNa,this.Yxc,this.xCa,this.yBa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.IKn(b.result.tokens)}SXc(b){return this.v3.SXc(b)}IKn(b){for(let h=0;h<b.count;h++){const r=b.J(h);if(r.Name===H.a.accessToken){const B=(new Date).getTime();r.Expiry>v.AFrameworkApplication.Cy?
(t.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.xX},"PreviousAccessTokenTtl",v.AFrameworkApplication.Cy),v.AFrameworkApplication.accessToken=r.Value,v.AFrameworkApplication.Cy=Math.floor(r.Expiry),v.AFrameworkApplication.Esg=B,v.AFrameworkApplication.Eua=Math.floor(r.Expiry)):t.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,
["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.xX},"PreviousAccessTokenTtl",v.AFrameworkApplication.Cy)}}return!0}Bsm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const B=b.J(r);t.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",B.Name,JSON.stringify(B.Errors),this.MNa)}return h}HXl(b){let h=je.a.u9c;b=parseInt(b.Id);if(isNaN(b))h=je.a.DLj;else{switch(b){case 401:h=je.a.Fsg;break;case 403:h=je.a.BLj;break;case 500:h=je.a.CLj;break;case 503:h=je.a.FLj}h===
je.a.u9c&&(h=500<b?je.a.ELj:je.a.ALj)}return h}}Object(n.a)(ng,"TokenRefreshManager",null,[676]);class Sd{constructor(){this.akc=v.AFrameworkApplication.F5o;this.P4d=v.AFrameworkApplication.D5o;this.tokens=v.AFrameworkApplication.Hmm();this.priority=v.AFrameworkApplication.G5o;this.heh=this.Fno();this.FYe=v.AFrameworkApplication.Gmm()}SXc(b){b=JSON.stringify(b);if(this.FYe&&0<this.FYe.length)for(const h of this.FYe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}Cgi(b){try{if(b)for(let h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in
this.heh)return Number.parseInvariant(this.heh[r.Id].toString())}catch(h){t.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.akc}Fno(){const b={};try{if(!v.AFrameworkApplication.HVd()||0>=v.AFrameworkApplication.HVd().length||""===v.AFrameworkApplication.HVd()[0])return b;for(const h of v.AFrameworkApplication.HVd())0<h.length&&(b[h]=v.AFrameworkApplication.E5o)}catch(h){t.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(n.a)(Sd,"TokenRefreshPolicy",null,[675]);class rk{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){v.AFrameworkApplication.K.Nn(()=>{this.T3a()})}T3a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.W=b;b.register(674,"Common.App.SessionExpiration.ISessionLogger").ha().Ud(()=>new hb(Rg.a.instance));
b.register(675,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Ud(()=>new Sd);b.register(676,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Ud(()=>new ng(Rg.a.instance,v.AFrameworkApplication.kP(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),v.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa("Common.ISessionStatus"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),v.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(677,"Common.ISessionExpirationManagerFactory").ha().Ud(()=>new zd(v.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(678,"Common.ISessionExpirationManagerWithDialog").ha().Ud(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(679,"Common.ISessionExpirationManager").ha().Ud(()=>
b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){L.a.instance.Gc(new rk)}}Object(n.a)(rk,"SessionExpirationPackage",null,[1,2]);var Yi=c(765),dh=c(403),Nf=c(341),ei=c(208);class kf extends ei.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(kf,"PersonaButtonProps",ei.a,[]);class rn{f6b(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new Nf.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.$al(b,r.ControlList);
h.push(r)}}$al(b,h){const r=Object.assign(new Yi.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new dh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new Nf.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.Xdl(b,h.ControlList)}Xdl(b,h){for(let r=0;r<b.length;r++){const B=Object.assign(new kf,{ExternalId:String.format("CoauthorPersona_{0}",r),
Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,B)}}}Object(n.a)(rn,"PresenceContextMenuSectionBuilder",null,[688]);var Zi=c(100);class Ao{constructor(b,h,r,B){this.XAa=this.wt=this.Co=this.ai=this.IKa=null;this.Nxd=b;this.vkk=B;this.Nxd.aWc&&(this.Co=new Oe.a(3,2,5E3,Object(z.a)(this,this.XIk,"authenticationCheckTask"),2),v.AFrameworkApplication.lc.Wb(this.Co),this.Ub(h,r));this.Nxd.hxk(()=>
{this.sMb()});this.Nxd.Mqh(()=>{this.tMb()})}get UK(){return this.wt||(this.wt=Ya.a.instance.Oa("CommonUI.IBusinessBar"))}get aAh(){return this.XAa||(this.XAa=Ya.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Ub(b,h){const r=v.AFrameworkApplication.va;r.fb(eb.a.Vwh,Gd.a.frame,b,96);r.fb(eb.a.Wwh,Gd.a.frame,h,96);r.qa(eb.a.lCh,Gd.a.frame,nd.ActionManager.gR);r.qa(eb.a.mCh,Gd.a.frame,nd.ActionManager.gR);r.qa(eb.a.QKf,Gd.a.frame,nd.ActionManager.gR)}sMb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
v.AFrameworkApplication.va.processAction(eb.a.Vwh,2)}tMb(){this.vJo();v.AFrameworkApplication.va.processAction(eb.a.Wwh,2)}XIk(){this.Nxd.authenticationCheck()}vJo(){this.ai&&(this.ai.hide(),this.ai.dispose(),this.ai=null);this.IKa&&this.UK&&(v.AFrameworkApplication.Qk||this.UK.removeEntry(this.IKa),this.IKa.dispose(),this.IKa=null)}showDialog(b){Zi.a.jC(this.ai);this.ai=new Wh.StandardDialog;this.vkk||(this.ai.Kt=!1,this.ai.Cd=0);this.ai.ye(1,CommonUIStrings.l_SignIn);this.ai.IV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.eca,"dialogHandler"))}eca(b){1===b?(dk.a.$$d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),v.AFrameworkApplication.va.processAction(eb.a.QKf,2)):(this.wwo(),v.AFrameworkApplication.va.processAction(eb.a.mCh,2))}wwo(){this.UK&&this.aAh&&(this.IKa=this.aAh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.IKa.closeable=!0,this.IKa.addButton(CommonUIStrings.l_SignIn,Ao.Rfb,""),this.IKa.Nga=
Object(z.a)(this,this.fQk,"businessBarEntryCloseHandler"),this.UK.sA(this.IKa,!1))}fQk(){this.qpl();v.AFrameworkApplication.va.processAction(eb.a.lCh,2)}qpl(){this.Co&&(v.AFrameworkApplication.lc.ff(this.Co),this.Co=null)}dispose(){this.Co=this.ai=this.IKa=null}static Rfb(){dk.a.$$d();v.AFrameworkApplication.va.processAction(eb.a.QKf,2)}}Object(n.a)(Ao,"SignOutResponseUI",null,[10]);class gl{get name(){return"Common.App.UI"}wc(b){b.register(rn,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Zi.a.jC(gl.cua);
gl.cua=null}static main(){L.a.instance.Gc(new gl)}static pAm(b,h,r){gl.iwo()&&(gl.cua=new Ao(dk.a.instance,b,h,r))}static iwo(){return v.AFrameworkApplication.Z5d&&!v.AFrameworkApplication.ria}}gl.cua=null;Object(n.a)(gl,"CommonAppUIPackage",null,[1,2]);class Ga{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Ga)}}Object(n.a)(Ga,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var kb=c(67);class nc{constructor(b){this.By=b;this.py=
Array.indexOf(this.By,this.zha)}dispose(){this.By=null}get n4(){return this.By[this.py]}iz(b){this.C9c(b,!1);return!0}Z8b(b){this.C9c(b,!0)}C9c(b,h){b&&(this.n4!==b||h)&&(b.tabIndex=0,kb.FocusManager.kK(b));Array.contains(this.By,b)&&(this.py=Array.indexOf(this.By,b))}get s4i(){let b=this.py;do if(b)if(0<b&&b<this.By.length)b--;else break;else b=this.By.length-1;while(!le.DOMFocusListing.K1a(this.By[b])&&b!==this.py);return this.By[b]}get LRi(){let b=this.py;do if(b===this.By.length-1)b=0;else if(0<=
b&&b<this.By.length-1)b++;else break;while(!le.DOMFocusListing.K1a(this.By[b])&&b!==this.py);return this.By[b]}get zha(){let b=0;for(;!le.DOMFocusListing.K1a(this.By[b])&&b<this.By.length;)b++;return le.DOMFocusListing.K1a(this.By[b])?this.By[b]:null}get Vec(){let b=this.By.length-1;for(;!le.DOMFocusListing.K1a(this.By[b])&&0<b;)b--;return le.DOMFocusListing.K1a(this.By[b])?this.By[b]:null}}Object(n.a)(nc,"DialogFocusListing",null,[140]);var Kb=c(57);class ld extends Wh.StandardDialog{constructor(b,
h,r,B=null){super();this.Rfa=this.Sw=this.lbb=null;this.By=[];this.cud=h;this.sk=b;this.k6j=r;this.axd=B;this.qm=new dc.a("LoadResource","LoadPrintablePdf")}OEa(){this.Cd=5;this.width=40;const b=document.createElement("span");b.id=this.rj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Rfa=document.createElement("iframe");this.Rfa.name="pdfObjectFrame";this.Rfa.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Rfa.onload=Object(z.a)(this,this.xIn,"printablePdfLoaded");if(this.axd&&0<this.axd.count){var r=ka.a.Ptf(this.cud,this.axd);const B=ka.a.A8f(this.cud,this.axd);this.Sw=document.createElement("form");this.Sw.id="printPreviewPostForm";this.Sw.method="POST";this.Sw.target=this.Rfa.name;this.Sw.action=B;for(let P of r)r=document.createElement("input"),r.type="hidden",r.name=P.key,r.value=P.value,this.Sw.appendChild(r)}else this.Rfa.setAttribute("src",this.cud);
Sys.UI.DomElement.addCssClass(this.Rfa,Ai.a.p9g);this.k6j?(Sys.UI.DomElement.addCssClass(this.Rfa,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,qf.a.kr(this.Rfa,qf.a.uA,qf.a.xp)):(Sys.UI.DomElement.addCssClass(this.Rfa,"DirectPrintPdfObject"),this.By.push(this.Rfa));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Rfa);this.Sw&&b.appendChild(this.Sw);b.appendChild(document.createElement("br"));b.appendChild(this.d5k(this.Sw?
"#":this.cud));this.qm.start();this.anb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.M5(this.rj("DirectPrintHeaderContent"));this.Sw&&this.Sw.submit();this.abl();t.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}d5k(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);v.AFrameworkApplication.K&&(2===v.AFrameworkApplication.ta.Kb.xk&&v.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===v.AFrameworkApplication.ta.Kb.xk&&v.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===v.AFrameworkApplication.ta.Kb.xk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.ta.Kb.xk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,t.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.lbb=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.lbb=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.Sw&&De.a.addHandler(r,"click",Object(z.a)(this,this.zvn,"onSubmit")),this.sk.ob(Xc.a.click,this.lbb,Object(z.a)(this,this.zVh,"downloadPDFLinkClicked"),null));this.By.push(this.lbb);return h}zvn(b){this.Sw&&(this.Sw.target="_blank",this.Sw.submit());b.preventDefault()}abl(){if(0<
this.By.length){const b=new nc(this.By),h=kb.FocusManager.instance().at();h&&(this.lbb.focus(),h.hk=b,h.yP=!0)}}zVh(){t.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}K_c(){t.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}xIn(){t.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.qm&&this.qm.stop()}dispose(){this.lbb&&(this.sk.uc(Xc.a.click,this.lbb,Object(z.a)(this,this.zVh,"downloadPDFLinkClicked")),
this.lbb=null);Kb.a.rx(this.Rfa);this.Rfa=null;super.dispose()}}Object(n.a)(ld,"DirectPrintDialog",Wh.StandardDialog,[732]);class Kc{constructor(b){this.sk=b}sWl(b,h,r=null){return new ld(this.sk,b,h,r)}}Object(n.a)(Kc,"DirectPrintDialogFactory",null,[714]);class ue{constructor(b,h){this._url=b;this.qek=h}lUh(){this.qek?Qd.a.downloadFile(this._url):Qd.a.vm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(ue,"OpenUrlInTabDialogDownloadBehavior",null,
[738,10]);class Le extends Wh.StandardDialog{constructor(b,h=!0,r=!1,B=null,P=null,ca=!1,ra=null){super();this.zXb=this.yXb=this.Sw=this.p3=null;var Qa=this.Zmg?this.Zmg:CommonUIStrings.l_DefaultDialogTitle;Le.Xac=ca;this.OYj=ra;this.$ze=B||new ue(b,!0);const mb=[],Jb=[];Le.QL&&(this.PCd&&this.PCd.forEach(fc=>{Array.add(mb,fc)}),this.ksh&&this.ksh.forEach(fc=>{Array.add(Jb,fc)}));h?r?this.YZd?(this.Cd=12,this.ye(1,this.buttonText),this.ye(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.ye(3,
CommonUIStrings.l_DialogClose)):this.XZd?(this.Cd=12,this.ye(1,this.buttonText),this.ye(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.ye(3,CommonUIStrings.l_DialogClose)):this.i_d?(this.Cd=12,this.ye(1,this.buttonText),this.ye(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.ye(3,CommonUIStrings.l_DialogClose)):(this.Cd=4,this.ye(1,this.buttonText),this.ye(2,CommonUIStrings.l_DialogClose)):(this.Cd=6,this.ye(0,CommonUIStrings.l_DialogClose)):this.Cd=5;ca=document.createElement("span");
this.iLc&&(ca.className=this.iLc);B=document.createElement("a");B.innerText=this.lfc;B.href=b;B.target="_blank";B.id=this.m_c;B.className=Zd.AFrame.J1e;if(ra=!ba.a.Q4&&!!P&&0<P.count){const fc=ka.a.Ptf(b,P);P=ka.a.A8f(b,P);B.href="#";B.target="_self";this.Sw=document.createElement("form");this.Sw.id="printPreviewPostForm1";this.Sw.method="post";this.Sw.target="_blank";this.Sw.action=P;for(var Yb of fc)P=document.createElement("input"),P.type="hidden",P.name=Yb.key,P.value=Yb.value,this.Sw.appendChild(P)}else this.Sw=
null;this.Sw||Le.Xac?Le.Xac||Array.add(Jb,{["type"]:"AppLinkProps",["id"]:this.m_c,["text"]:this.lfc,["onExecute"]:()=>{this.R7i()}}):Array.add(Jb,{["type"]:"AppLinkProps",["id"]:this.m_c,["text"]:this.lfc,["handler"]:{["href"]:ra?"#":b,["target"]:ra?"_self":"_blank"}});this.W5a&&Array.add(mb,this.W5a);r?(b=document.createElement("span"),b.innerText=this.W5a.replace("{0}",""),ca.appendChild(b)):this.qPi?(b=document.createElement("span"),b.id=this.rj("message"),Yb=document.createElement("span"),P=
document.createElement("span"),ra=this.W5a.split("{0}"),Yb.innerText=ra[0],P.innerText=ra[1],b.appendChild(Yb),b.appendChild(B),b.appendChild(P),ca.appendChild(b)):(b=document.createElement("span"),b.innerText=this.W5a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(B),Le.Xac||Array.add(mb,"{0}"));this.Sw&&ca.appendChild(this.Sw);Le.QL&&(this.xmb&&(this.UZc?this.Xoh(this.xmb,this.UZc):(Array.add(mb,"{0}"),Array.add(Jb,{["type"]:"AppLinkProps",
["id"]:"LearnMoreLinkId",["text"]:this.xmb,["onExecute"]:()=>{}}))),this.UFc(mb,Jb));this.anb(Qa,null,this.HAf,null,Object(z.a)(this,this.eca,"dialogHandler"),Le.QL?null:ca);this.M5(this.rj("message"));!Le.QL&&this.UZc&&this.xmb&&(Qa=document.createElement("div"),Qa.className="WACDialogLearnMoreLinkContainer",this.p3=document.createElement("a"),this.p3.innerText=this.xmb,this.p3.href=this.UZc,this.p3.target="_blank",this.p3.id=this.rj("LearnMoreLinkId"),this.p3.className=Zd.AFrame.J1e,Qa.appendChild(this.p3),
h?this.Kc.insertBefore(Qa,this.Kc.lastChild):this.Kc.appendChild(Qa),this.M5(String.format("{0} {1}",this.rj("message"),this.rj("LearnMoreLinkId"))));this.Guc=B;r?this.G1(this.oH):this.G1(this.Guc);this.A3d();v.AFrameworkApplication.ta.X1.ob(Xc.a.click,this.Guc,Object(z.a)(this,this.yVh,"downloadLinkClicked"),null);this.p3&&v.AFrameworkApplication.ta.X1.ob(Xc.a.click,this.p3,Object(z.a)(this,this.hHi,"learnMoreLinkClicked"),null);this.pW=!1}get HAf(){return null}get Zmg(){return null}get W5a(){return null}get M6e(){return this.OYj}get UZc(){return null}get xmb(){return null}get qPi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get iLc(){return null}get PCd(){return null}get ksh(){return null}get YZd(){return!1}get XZd(){return!1}get i_d(){return!1}MKh(){this.U8({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}gvl(){this.U8({SourceControlId:"Share"},{ControlId:"Share"})}U8(b,h){const r=v.AFrameworkApplication.va;r.LC=8;r.Qb(eb.a.U8,2,b,h)}hna(){this.Sw&&(this.yXb||(this.yXb=Object(z.a)(this,this.Wkn,"onActionButtonClicked"),this.Pq.ob(Xc.a.click,this.oH,this.yXb)),this.zXb||(this.zXb=Object(z.a)(this,this.Xkn,"onActionButtonKeyUp"),this.ge.ob(Xc.a.zh,this.oH,this.zXb)));super.hna()}Wkn(b){this.$Yh(b);return!0}Xkn(b){return this.tZc(b,Object(z.a)(this,this.$Yh,"executeDismissActionButtonFromArgs"))}$Yh(b){this.Sw&&
this.Sw.submit();this.NEb(b.yf)}K_c(){}yVh(){this.uNf();this.Sw?this.Sw.submit():this.$ze.lUh();return!0}hHi(){return!1}dispose(){this.$ze.dispose();this.Guc&&(v.AFrameworkApplication.ta.X1.uc(Xc.a.click,this.Guc,Object(z.a)(this,this.yVh,"downloadLinkClicked")),this.Guc=null);this.p3&&(v.AFrameworkApplication.ta.X1.uc(Xc.a.click,this.p3,Object(z.a)(this,this.hHi,"learnMoreLinkClicked")),this.p3=null);this.Pq&&this.yXb&&(this.Pq.uc(Xc.a.click,this.oH,this.yXb),this.yXb=null);this.ge&&this.zXb&&(this.ge.uc(Xc.a.zh,
this.oH,this.zXb),this.zXb=null);super.dispose()}R7i(){this.Sw&&(document.body.appendChild(this.Sw),this.Sw.submit(),document.body.removeChild(this.Sw))}eca(b){1===b?(this.K_c(),this.Sw?Le.QL&&this.R7i():this.$ze.lUh()):2===b&&(this.XZd||this.YZd?this.MKh():this.i_d&&this.gvl());this.dispose()}static get QL(){return v.AFrameworkApplication.ta.Kb.uF&&v.AFrameworkApplication.ta.Kb.jCi}static get Xac(){return Le.bZg}static set Xac(b){Le.bZg=b}}Le.bZg=!1;Object(n.a)(Le,"ADialogWithLinkToResource",Wh.StandardDialog,
[]);class cf extends Le{constructor(b,h,r=null,B=!0,P=!1,ca=null){super(b,!0,!(cf.fsb&&B),new ue(b,h),r,P,ca);cf.fsb=cf.fsb&&B;if(cf.fsb){h=document.createElement("iframe");B=null;P=this.LSh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){ca=ka.a.Ptf(b,r);b=ka.a.A8f(b,r);B=document.createElement("form");B.id="printPreviewPostForm";B.method="POST";B.target=h.name;B.action=b;for(let ra of ca)b=document.createElement("input"),b.type="hidden",b.name=ra.key,b.value=ra.value,B.appendChild(b)}else h.src=
b;P.appendChild(h);B&&(P.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");qf.a.kr(h,qf.a.uA,qf.a.xp)}}get HAf(){return"Print_32x32x32"}get Zmg(){return cf.fsb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get W5a(){return cf.fsb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get PCd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Le.Xac){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.ta.Kb.LPh&&
(h=v.AFrameworkApplication.ta.Kb.LPh);Array.add(b,h)}return cf.fsb?b:null}get lfc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get m_c(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get iLc(){return v.AFrameworkApplication.t1a?"UIFontDialogTextLarge":null}A3d(){t.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}uNf(){v.AFrameworkApplication.Wl.Q3a(9540);t.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}K_c(){t.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get fsb(){return!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(ba.a.Q4||ba.a.ht||ba.a.Dj||ba.a.lda)&&!v.AFrameworkApplication.XYc&&v.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set fsb(b){}}Object(n.a)(cf,"PrintDialogWithLinkToPdf",Le,[]);class Mf{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||
"false");this.sTm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.SPm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.GRb=(b.DirectPrintSupportedMimeTypes||"").split(Mf.Vff);this.brb=(b.DirectPrintSupportedPlugins||"").split(Mf.Vff);this.qym=(b.DirectPrintImmersivePreviewPlugins||"").split(Mf.Vff);this.Rxi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.SJm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.YXk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||
"76");this.mQf=14;this.DPi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.mQf=parseInt(h[0]),this.DPi=parseInt(h[1])):t.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else t.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Mf.Vff=",";Object(n.a)(Mf,"DirectPrintBrsSettings",null,[]);class Vg{constructor(b,h){this.Ckg=
b;this.brb=h}}Object(n.a)(Vg,"DirectPrintProbeResults",null,[]);class Eg{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.BAd=null;this.p1j=b;this.Uzc=h;this.GLe=r;this.R8j=B;this.Y9j=P;this.LBc=new zf.a(Object(z.a)(this,this.Mam,"getProbeResults"));this.juc=ca;this.G5g=mb;this.BT=ra;this.Wxc=Qa;this.s$j=Jb}get fR(){return this.p1j}start(){}UIn(){this.fR.sTm&&this.M7m()}FNn(){const b=Array(this.fR.GRb.length);if(void 0!==this.Uzc&&null!==this.Uzc)for(let h=0;h<this.fR.GRb.length;h++)b[h]=this.fR.GRb[h]in
this.Uzc&&this.R8j(this.Uzc[this.fR.GRb[h]]);return b}GNn(){const b=Array(this.fR.brb.length),h=!(void 0===this.GLe||null===this.GLe);for(let r=0;r<this.fR.brb.length;r++){const B=this.fR.brb[r];b[r]=h&&B in this.GLe?!0:this.Y9j(B)}return b}Dgm(){const b=this.FNn(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.lBl(this.Uzc[this.fR.GRb[r]]):null;return h}lBl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}M7m(){t.ULS.sendTraceTag(4535643,
328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.LBc.value.Ckg,this.LBc.value.brb)}Mam(){var b=this.Dgm();const h=this.GNn(),r={},B={};for(let P=0;P<this.fR.GRb.length;P++)r[this.fR.GRb[P]]=b[P];for(b=0;b<this.fR.brb.length;b++)B[this.fR.brb[b]]=h[b];return new Vg(r,B)}awo(){return this.s$j||!this.fR.isEnabled||v.AFrameworkApplication.XYc?!1:this.rGo()}gwo(){if(null!=this.BAd)return this.BAd;const b=Eg.Qxi(this.fR);return this.BAd=this.fR.Rxi&&b||this.RJm()}RJm(){return ba.a.Er&&this.fR.SJm&&ba.a.XXk>=
this.fR.YXk?!0:!1}rGo(){if(!this.Wxc(this.fR))return!1;var b=zb.a.wHb(this.LBc.value.Ckg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=zb.a.wHb(this.LBc.value.brb);for(const h of b)if(h)return!0;return!1}Lsm(){const b=zb.a.wHb(this.LBc.value.Ckg);for(const h of b)if(Jj.a.contains(this.fR.qym,h))return!0;return!1}zyo(b,h=null){v.AFrameworkApplication.ta&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.G5g(b,h):this.awo()?this.wql(b,this.Lsm()&&!0,h):this.G5g(b,
h)}wql(b,h,r=null){const B=this.BT.Yf("UserAction","OpenDirectPrintDialog");this.juc.sWl(b,h,r).OEa();B.stop()}static eWm(b){try{return new ActiveXObject(b),!0}catch(h){t.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static QMm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Mf(v.AFrameworkApplication.K.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Jb){t.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(Jb){t.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const P=Eg.QMm,ca=Eg.eWm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ra=v.AFrameworkApplication.ta.Kq,Qa=Eg.fWm,mb=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF&&!v.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Eg(h,r,B,P,ca,b,ra,Qa,(Jb,Yb)=>new cf(Jb,!1,
Yb,!0,mb),v.AFrameworkApplication.ria)}static fWm(b){return ba.a.Er||ba.a.ht&&b.SPm||b.Rxi&&Eg.Qxi(b)?!0:!1}static Qxi(b){var h=ba.a.A7b;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.mQf||h===b.mQf&&r>=b.DPi}return!1}}Object(n.a)(Eg,"DirectPrintManager",null,[687]);class wi{constructor(){this.yub=this.W=null}get name(){return"Common.App.DirectPrint"}wc(b){this.W=b;b.register(Kc,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Ud(()=>new Kc(v.AFrameworkApplication.ta.X1));
b.register(687,"Common.App.DirectPrint.IDirectPrintManager").ha().Ud(()=>Eg.create(this.W))}init(){this.yub=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.yub.start()}dispose(){}}Object(n.a)(wi,"PackageManager",null,[1,2]);class sm{constructor(b,h=3E4){this.qng=9E5;this.sng=1E4;this.FMi=this.Mfc=null;this.DOf=0;this.ehb=Date.now;this.Jim=b;this.b9a=h;this.CQd()}Iji(b=!0){const h=this.ehb();if(h<this.DOf+this.qng)return h>this.DOf+this.sng&&this.CQd(),this.FMi;b&&this.CQd();return null}getToken(b=
!0){return(b=this.Iji(b))?Promise.resolve(b):this.CQd()}CQd(){return this.Mfc=this.Mfc||new Promise(b=>{this.Jim().then(h=>{this.Mfc=null;""!==h&&h&&(this.FMi=h,this.DOf=this.ehb(),b(h));b(null)}).catch(()=>{this.Mfc=null;b(null)});window.setTimeout(()=>{this.Mfc=null;b(null)},this.b9a)})}}Object(n.a)(sm,"OAuthCacheManager",null,[]);var sh=c(114),Rj=c(294);class Ni{constructor(){this.P9=null;this.EUg={};this.aoc=new Fa.a(Pa.a.ih())}getToken(b,h){if(this.aoc.nb(h))return this.aoc.J(h).getToken();const r=
new sm(()=>this.Jji(b,h));this.aoc.Z(h,r);return r.getToken()}Iim(b,h){if(this.aoc.nb(h))return this.aoc.J(h).Iji();const r=new sm(()=>this.Jji(b,h));this.aoc.Z(h,r);return null}Jji(b,h){if(!this.P9)try{this.P9=Ya.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){t.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.P9?new Promise(r=>{const B=Date.now();this.P9.RV(b,h).then(P=>{const ca=P.Token;!P.IsSuccess||this.fXm(ca)?(this.Okc("GetTokenInternalImplicitJS",
!1,Date.now()-B,b,P.ErrorCode,P.ErrorMessage,h),r(null)):(this.Okc("GetTokenInternalImplicitJS",!0,Date.now()-B,b,P.ErrorCode,P.ErrorMessage,h),r(ca))}).catch(P=>{P=P?I.c(P):"";this.Okc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,"Caught Exception",P,h);r(null)})}):new Promise(r=>{this.Okc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}Okc(b,h,r,B,P="",ca="",ra=""){var Qa="Search"===B;const mb=[];b=sh.a.b9(Qa?"Event":"EventName",b,2);B=sh.a.b9("AppName",
B,2);Array.add(mb,b);Array.add(mb,B);Qa&&(B=sh.a.b9("LatencyType","FetchToken",2),Array.add(mb,B));P&&""!==P&&(P=sh.a.b9("ErrorCode",P,2),Array.add(mb,P));ca&&""!==ca&&(ca=sh.a.b9("ErrorMessage",ca,2),Array.add(mb,ca));ra&&""!==ra&&(ca=!(ra in this.EUg),this.EUg[ra]=ca,ca=sh.a.b9("WarmUpCall",ca.toString(),1),Array.add(mb,ca),ra=sh.a.b9("Service",this.Dem(ra),2),Array.add(mb,ra));Qa=Qa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Rj.a,{name:Qa,
samplingPolicy:2,dataFields:mb,succeeded:h,durationMs:r});oa.a.sendActivityEvent(h)}Dem(b){return b===v.AFrameworkApplication.oOf?"Loki":b===v.AFrameworkApplication.ukg?"Substrate":v.AFrameworkApplication.K&&b===v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}fXm(b){return!b||!b.length}}Object(n.a)(Ni,"SearchOAuthManager",null,[659]);class xi{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.W=b;this.W.register(659,"Common.App.SearchCommon.ISearchOAuthManager").ha().Ud(()=>
new Ni)}init(){}dispose(){}static main(){L.a.instance.Gc(new xi)}}Object(n.a)(xi,"SearchOAuthPackage",null,[1,2]);var qe=c(15),Hh=c(225),xd=c(5),ye=c(18),Pd=c(17),Td=c(8);class ul{constructor(b,h,r){this.yMe=this.Ryb=this.vMe=this.Qyb=this.lJe=null;this.fpm=B=>{try{this.epm(B)}catch(P){B=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",P.message,P.stack),t.ULS.sendTraceTag(5285580,334,10,B)}};this.Xo=b;this.c2j=h;this.hb=r;this.init()}init(){this.c2j.ob(this.fpm);
this.Qyb=new Dh.a;this.vMe=new Dh.a;this.Ryb=new Dh.a;this.yMe=new Hh.a}tV(b){this.Qyb.add(b.key,b)}WOb(b){this.Ryb.add(b.key,b)}epm(b){let h;const r=this.hb.ib.lb;({xdf:h}=ul.xQo(r)).returnValue&&(b=ul.UTl(b,this.lJe,h),this.mJn(b,h,r),this.lJe=h)}mJn(b,h,r){b=this.uNl(b,h,r);let B;({notification:B}=ul.nQo(b)).returnValue&&this.Xo.sendNotification(B,!1)}uNl(b,h,r){const B=new Dh.a;B.Z(1,new Hh.a);B.Z(0,new Hh.a);b.forEach(P=>{3===P?(ul.Igg(h.node)||this.D6n(h,r),this.x9l(B,h)):P||this.sUl(B,h);return!0});
return B}D6n(b,h){this.Qyb.forEach((r,B)=>{B.reset(b,h);return!0})}sUl(b,h){let r=new Dh.a;ul.Igg(h.node)||(r=this.qUl(h.cpBegin));this.rUl(b,this.vMe,r,ul.qjj(this.lJe,h));this.vMe=r}qUl(b){const h=new Dh.a;this.Qyb.forEach((r,B)=>{r=null;({RE:r}=B.lAa(b)).returnValue&&h.Z(B.key,r);return!0});return h}rUl(b,h,r,B){const P=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ca,ra)=>{const Qa=this.Qyb.J(ca).Ku||ra.title;let mb;({value:mb}=r.Fc(ca)).returnValue?B&&mb.contentObject!==ra.contentObject&&
(Qa&&b.J(1).add(Qa),ca=this.Qyb.J(ca).Ku,ca=String.format(P,mb.title,ca),mb.description&&(ca+=", "+mb.description),b.J(0).add(ca)):Qa&&b.J(1).add(Qa);return!0});r.forEach((ca,ra)=>{h.nb(ca)||(ca=this.Qyb.J(ca).Ku,ca=String.format(P,ra.title,ca),ra.description&&(ca+=", "+ra.description),b.J(0).add(ca));return!0})}x9l(b,h){h=this.Vfm(h.node);h=this.K0k(h);this.Wfm(b,this.yMe,h);this.yMe=h}Vfm(b){const h=new xd.GraphIterator;h.set(b);if(!h.zb(1))return null;const r=new Hh.a;for(;1!==h.Xe;)this.Ryb.forEach((B,
P)=>{let ca;({Xba:ca}=P.ESb(h)).returnValue&&r.add(ca);return!0}),h.sc();r.reverse();return r}K0k(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.nE===b[h+1].nE&&(this.Ryb.J(r.nE),({N0k:r}={returnValue:!1,N0k:null}).returnValue)){b.splice(h,2,r);continue}h++}return new Hh.a(b)}Wfm(b,h,r){var B;for(B=0;B<Math.min(r.length,h.length)&&r.J(B).contentId.equals(h.J(B).contentId);B++){var P=this.Ryb.J(r.J(B).nE).ejb(r.J(B),h.J(B));P&&(r.J(B).description&&(P+=", "+r.J(B).description),b.J(0).add(P))}for(P=
B;P<r.length;P++){let ca=this.Ryb.J(r.J(P).nE).ejb(r.J(P),null);ca&&(r.J(P).description&&(ca+=", "+r.J(P).description),b.J(0).add(ca))}for(r=B;r<h.length;r++)(B=this.Ryb.J(h.J(r).nE).Ku)&&b.J(1).add(B)}static UTl(b,h,r){const B=new Hh.a;(b=b||ul.$do(h,r))?(B.add(3),B.add(0)):ul.qjj(h,r)&&B.add(0);return B}static $do(b,h){return!b||!b.node.id.equals(h.node.id)}static qjj(b,h){return!b||!b.equals(h)}static xQo(b){let h=null;if(!b||!(Pd.SelectionEditor.Pl(b)||(b=Pd.SelectionEditor.Jj(b,!0,!1),Pd.SelectionEditor.Pl(b)||
b.Pa&&ul.Igg(b.Pa.node))))return{returnValue:!1,xdf:h};h=b.Pa;return{returnValue:!!h,xdf:h}}static nQo(b){const h=new Hh.a;b.J(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.J(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static Igg(b){return ye.ImageReader.Mt(b)||Td.ParagraphReader.wva(b)}}Object(n.a)(ul,
"AccessibilityContextManager",null,[658]);class oi{constructor(b,h){this.U2g=!1;this.WCc=null;this.Ywd=this.rAd=!1;this.aUg=null;this.VCd=(r,B)=>{(B.EN||B.ora)&&this.ojn(B.EN,B.ora)};this.Ib=b;this.ON=h}get Dtm(){return!!this.WCc}ob(b){this.U2g||(this.ON.drh(this.VCd),this.U2g=!0);this.aUg=b}ojn(b,h){this.Dtm&&this.Ib.ff(this.WCc);this.rAd=this.rAd||b;this.Ywd=this.Ywd||h;this.WCc=new Oe.a(5,1,oi.izl,()=>{this.aUg(this.rAd,this.Ywd);this.reset()},126);this.Ib.Wb(this.WCc)}reset(){this.WCc=null;this.Ywd=
this.rAd=!1}}oi.izl=100;Object(n.a)(oi,"EditingViewOnAfterValidateEventsConsolidator",null,[653]);var lh=c(49);class Xk{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){qe.App.bwh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new oi(v.AFrameworkApplication.lc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();
b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new ul(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),lh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){L.a.instance.Gc(new Xk)}}Object(n.a)(Xk,"Box4AccessibilityPackage",null,[1,2]);var Ih=c(192),Ze=c(1078),If=c(1668),Ho=c(904),Me=c(174),Si=c(1556),sg=c(44),Fe=c(23),ch=c(101),Se=c(28),Mb=c(3);class hj extends Si.a{get Axa(){return null!=
this.wDg?this.wDg:this.wDg=Ya.a.instance.Oa("Box4.IInternalLinkManager")}get u3i(){return null!=this.yGg?this.yGg:this.yGg=Ya.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get aD(){return!0}get commandId(){return Mb.a.fJk}coa(b){Me.a.mark(7012);const h=new sg.GraphTransaction(15);h.Db(b);var r=this.YG,B=this.c1,P=Td.ParagraphReader.text(b),ca=P.substring(r,B);const ra=({x1c:Qa}=E.a.akg(ca)).returnValue;ca!==ra&&(r+=Qa,B=r+ra.length);ca=Se.a.createTextRange(b,r,B);var Qa=P.substring(r,
B);hj.LPm(P,r,B)&&(this.Md.Ge(Se.a.createTextRange(b,r-1,B+1),Qa,!0,!1),--r,--B,ca=Se.a.createTextRange(b,r,B),r=Fe.SelectionFactory.ne(b,B),lh.a.instance.Ac(r));r=ch.a.NFa(Qa);hj.jp.fF(ca,r,!1);P=Qa="";B=!1;this.Axa&&({P7f:Qa,EFb:P}=this.Axa.jog(r)).returnValue&&(r=Qa,B=!0,Qa=ch.a.Fz(ca,!1),hj.jp.jS(Qa[0].paragraph,Qa[0].hyperlink),""!==P&&(this.Md.Ge(ca,P,!0,!1),ca=Se.a.createTextRange(b,this.YG,this.YG+P.length),b=Fe.SelectionFactory.ne(b,this.YG+this.YG+P.length),lh.a.instance.Ac(b)),hj.jp.fF(ca,
r,!1));h.dispose();!B&&this.u3i&&this.u3i.aGn(ca,r);Me.a.mark(7013)}set aD(b){super.aD=b}static get jp(){return null!=hj.xBg?hj.xBg:hj.xBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static LPm(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(n.a)(hj,"HyperlinkAction",Si.a,[]);class ak{constructor(b){this.Md=b}Fbl(b,h,r){return new hj(null,b,h,r,this.Md)}}Object(n.a)(ak,"HyperlinkActionFactory",null,[650]);
var xj=c(238);class jo{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}wc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new If.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),xj.a.instance,v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>
new Ze.a(b.resolve("Box4.IRoamingServiceRequestManager"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Ho.a(b.resolve("Box4.IAutoCorrectRules"),lh.a.instance,Ih.a.instance,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();
b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new ak(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.W.resolve("Box4.IAutoCorrectRules").U2m();const b=v.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").ePl()}dispose(){}static main(){L.a.instance.Gc(new jo)}}Object(n.a)(jo,"Box4AutoCorrectPackage",null,[1,2]);class To{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){L.a.instance.Gc(new To)}}
Object(n.a)(To,"Box4ClipboardPackage",null,[1,2]);class ep{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new ep)}}Object(n.a)(ep,"Box4ImageEditorsPackage",null,[1,2]);var yn=c(624),ko=c(886),fq=c(723),Rp=c(838),yj=c(1168);class Io{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,r,B,P){const ca=new Io;ca.DocumentId=P;ca.UserId=r;ca.WACSessionId=B;ca.Revision=b;ca.ChangeStateList=yj.a.mkj(h);return ca}}Object(n.a)(Io,"LocalUnsavedChange",
null,[]);class Qm{constructor(){this.l3d=null}Eoe(b){return new Promise((h,r)=>{this.bMh().then(B=>{const P=B.transaction(Qm.F_c,"readwrite");P.objectStore(Qm.F_c).put(b);P.oncomplete=()=>h();P.onerror=()=>r(P.error.message)}).catch(r)})}JGd(b,h,r){return new Promise((B,P)=>{this.bMh().then(ca=>{const ra=ca.transaction(Qm.F_c,"readwrite");ra.objectStore(Qm.F_c).delete([b,h,r]);ra.oncomplete=()=>B();ra.onerror=()=>P(ra.error.message)}).catch(P)})}static isSupported(){return"indexedDB"in window}bMh(){return new Promise((b,
h)=>{if(Qm.isSupported())if(this.l3d)b(this.l3d);else{var r=window.indexedDB.open(Qm.c4m,Qm.d4m);r.onsuccess=()=>{this.l3d=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const B=r.result,P=B.createObjectStore(Qm.F_c,{keyPath:["DocumentId","UserId","WACSessionId"]});P.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});P.createIndex("UserId",["UserId"],{unique:!1});this.l3d=B;b(B)}}else h("This browser does not support IndexedDB.")})}}Qm.c4m="LocalUnsavedChangeDatabase";
Qm.d4m=1;Qm.F_c="LocalUnsavedChange";Object(n.a)(Qm,"LocalUnsavedChangeStore",null,[]);class Dl{constructor(b,h,r,B,P,ca){this.tKi=b;this.ffe=h;this.Ndi=r;this.tSd=B;this.uVk=P;this.wza=ca}initialize(){const b=ko.a.Buf(this.Ndi());this.nKd=this.lLc=b;this.wza.Yyk(this.nYi.bind(this));this.wza.Zyk(this.oYi.bind(this))}dispose(){this.wza.C2n(this.nYi.bind(this));this.wza.D2n(this.oYi.bind(this))}nYi(b,h){this.mYo(h.nUa)}oYi(b,h){this.UUo(h.nUa)}UUo(b){b.equals(this.lLc)||(this.lLc=b,b.equals(this.nKd)?
this.JGd():this.Eoe())}mYo(b){b.equals(this.nKd)||(this.nKd=b,b.equals(this.lLc)?this.JGd():this.Eoe())}zcl(){const b=new Rp.a(this.nKd,this.lLc,this.Ndi(),this.tSd().yr,this.tSd().kpb,this.tSd().contextId,this.lLc.id,this.ffe,fq.FolderReader.qJb(this.tSd()),!1);return Io.construct(b,this.uVk.sQc(),Dl.userId,Dl.sessionId,Dl.documentId)}Eoe(){const b=this.zcl();this.tKi.Eoe(b).then(()=>{t.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>
{t.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}JGd(){this.tKi.JGd(Dl.documentId,Dl.userId,Dl.sessionId).then(()=>{t.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{t.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return Qm.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Dl.Hyg?Dl.Hyg:
Dl.Hyg=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Dl.NJg?Dl.NJg:Dl.NJg=v.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=Dl.cHg?Dl.cHg:Dl.cHg=v.AFrameworkApplication.K.kb("SessionId")}}Object(n.a)(Dl,"LocalUnsavedChangeManager",null,[652]);class ek{get name(){return"Box4.LocalUnsavedChange"}init(){this.Bxi()&&Dl.isSupported()&&(this.eNf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.eNf.initialize())}dispose(){this.eNf&&
this.eNf.dispose()}wc(b){this.container=b;if(this.Bxi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new Qm).ha();var h=(r,B,P)=>new yn.a(r,B,P);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Dl(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>ab.StaticActiveAppFrame.za().jb.Zc.xd,()=>ab.StaticActiveAppFrame.za().jb.Zc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){L.a.instance.Gc(new ek)}Bxi(){return v.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(n.a)(ek,"LocalUnsavedChangePackage",null,[1,2]);class Zh{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Zh)}}Object(n.a)(Zh,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Fh=c(1568);class Xi{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",()=>Fh.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(n.a)(Xi,"PackageManager",null,[1,2]);class Oi{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Oi)}}
Object(n.a)(Oi,"Box4TableEditorsPackage",null,[1,2]);class nb{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new nb)}}Object(n.a)(nb,"Box4TextLevelEditorsPackage",null,[1,2]);var Bc=c(115),wc=c(359),Zc=c(175),Ne=c(620),df=c(1582);class Kf{constructor(b,h,r){this.fw=this.zLa=this.INa=null;this.uE=this.sye=this.RKa=0;this.Vla=this.ypd=this.HXa=this.GXa=!1;this.iod=this.e_g=this.h_g=0;this.NBa=b;this.ga=h;this.nn=r}tP(b){return!ab.StaticActiveAppFrame.za().jb.isEditingAllowed||
gc.SessionStatusManager.instance.Yj?!1:""!==this.UQc(b.yf)}BL(b){if(!this.tP(b))return!1;this.Dko(b);this.uE=this.NBa.M9b();this.zno(b);this.Ano();({adc:this.ypd,wec:this.Vla}=this.Enj(this.sye));this.Bno();this.INa=b.mI;this.fw=new Sys.UI.Point(0,0);[this.h_g,this.e_g]=this.NBa.getDimensions();t.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}gV(b){this.zLa=b.mI;this.ZQk();this.iod=df.b(this.fw.x,this.fw.y,this.h_g,this.e_g,this.ypd,this.Vla,this.iod,v.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));
this.NBa.sqg(this.iod,this.ypd,this.Vla);return!0}iE(){this.setSize();t.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}UY(){this.NBa.F$f();t.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Dko(b){this.NBa=Bc.a.Eb(b.yf,Ne.a)}Ano(){this.sye=(Math.floor((this.uE+22)/45)%8+this.RKa)%8}Enj(b){let h,r;if(this.uE&&90!==this.uE&&180!==this.uE&&270!==this.uE&&360!==this.uE||this.PPm(b))return{adc:!0,wec:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{adc:r,
wec:h}}Bno(){this.HXa=this.GXa=!1;switch(this.sye){case 0:this.HXa=this.GXa=!0;break;case 1:case 2:this.HXa=!0;break;case 7:case 6:this.GXa=!0}}PPm(b){return!(b%2)}UQc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}zno(b){switch(this.UQc(b.yf)){case "WACImageResizeHandleNW":this.RKa=
0;break;case "WACImageResizeHandleN":this.RKa=1;break;case "WACImageResizeHandleNE":this.RKa=2;break;case "WACImageResizeHandleE":this.RKa=3;break;case "WACImageResizeHandleSE":this.RKa=4;break;case "WACImageResizeHandleS":this.RKa=5;break;case "WACImageResizeHandleSW":this.RKa=6;break;case "WACImageResizeHandleW":this.RKa=7}}ZQk(){var b=1;this.nn.instance&&(b=this.nn.instance.oj);const h=(this.zLa.x-this.INa.x)/b;b=(this.zLa.y-this.INa.y)/b;this.fw.x=this.GXa?-h:h;this.fw.y=this.HXa?-b:b}setSize(){const b=
new wc.DictionaryPropertySet;b.setValue(Zc.a.IUc,100*this.iod);b.setValue(Zc.a.Oqi,!0);if(90===this.uE||270===this.uE){let h,r;({adc:h,wec:r}=this.Enj(this.RKa));b.setValue(Zc.a.bBf,h);b.setValue(Zc.a.cBf,r)}else b.setValue(Zc.a.bBf,this.ypd),b.setValue(Zc.a.cBf,this.Vla);this.ga.Qb(Mb.a.ubc,2,b)}}Object(n.a)(Kf,"ImageResizeDragAdapter",null,[151]);var af=c(127),Ji=c(891);class aj{constructor(b,h,r,B){this.TEe=this.zLa=this.INa=this.swd=null;this.rtd=this.ZAd=0;this.Gb=null;this.ga=b;this.hb=h;this.nn=
r;this.W5g=this.ACa=0;this.ld=B}tP(b){return ab.StaticActiveAppFrame.za().jb.isEditingAllowed&&!gc.SessionStatusManager.instance.Yj&&b&&this.wUm(b.yf)?(this.swd=this.hb.qg)?!0:!1:!1}lPd(){}Cuf(){return null}BL(b){if(!this.tP(b))return!1;this.NBa=Bc.a.Eb(b.yf,Ne.a);if(!this.NBa)return!1;this.Qwd=this.NBa.D$;if(!this.Qwd)return!1;this.swd=this.hb.qg;this.Gb=ye.ImageReader.sn(this.swd);if(!this.Gb)return!1;this.INa=this.gQa(b);this.TEe=Sys.UI.DomElement.getBounds(this.Qwd);this.ZAd=0<ye.ImageReader.fRc(this.Gb)?
ye.ImageReader.fRc(this.Gb):0;this.rtd=ye.ImageReader.cRc(this.Gb);return!0}gV(b){this.zLa=this.gQa(b);this.gRk();if(this.NBa)return this.NBa.Qoe(this.ACa,this.W5g),!0;t.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}iE(){this.ZAd=this.ACa=df.c(this.ACa);this.Q5()}UY(){this.NBa.Qoe(this.rtd,0)}wUm(b){return b.classList.contains(Ji.c)||b.classList.contains(Ji.b)||b.classList.contains(Ji.a)||!!b.parentElement&&b.parentElement.classList.contains(Ji.a)}gQa(b){return this.ld.yd.u2a(b)}gRk(){var b=
1;this.nn&&this.nn.instance&&(b=this.nn.instance.oj);var h=new Sys.UI.Point(this.TEe.x+this.Qwd.clientWidth/2*b,this.TEe.y+this.Qwd.clientHeight/2*b);b=df.a(this.INa,h);h=df.a(this.zLa,h);this.ACa=Math.round(af.a.lOn(h-b));0<this.ZAd&&(this.ACa+=this.ZAd-this.rtd);this.W5g=this.ACa;this.ACa+=this.rtd}Q5(){const b=new wc.DictionaryPropertySet;b.setValue(Zc.a.FUc,0);b.setValue(Zc.a.KU,this.ACa);this.ga.Qb(Mb.a.m9,2,b)}}Object(n.a)(aj,"ImageRotateDragAdapterSimplified",null,[649,151]);class ph{constructor(){this.W=
null}get name(){return"Box4.Images"}wc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",()=>new Kf(null,v.AFrameworkApplication.va,Ya.a.instance.Sa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new aj(v.AFrameworkApplication.va,lh.a.instance,Ya.a.instance.Sa("Common.IZoomManager"),Hb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");
this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){L.a.instance.Gc(new ph)}}Object(n.a)(ph,"Box4ImagesPackage",null,[1,2]);var ij=c(316),Ng=c(118),Oc=c(6),Sg=c(691),li=c(459),de=c(578),ke=c(258),Ti=c(263),Uf=c(1800),fk=c(1701),lk=c(1222);class dj extends fk.a{constructor(b,h,r){super(b,h,r);this.sud=this.Beb=null}get nS(){return v.AFrameworkApplication.ta.Kq}URd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}upe(b){return dj.Nka(b,this.rki())}rki(){return dj.VXe}Nka(b,h=null){b=this.upe(b);return 0!==b?(h&&h.WBd(),2===b&&(h=this.URd(b),this.Ep(this.L9h(b),h)),!1):!0}wwa(b,h){t.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.AZf=h;Me.a.mark(5576);this.sud=this.nS.Yf("LoadResource","PictureUploadTime");this.vYd()?this.y7c(b):this.zhc()}Ep(b,h){const r=new Wh.StandardDialog;r.Cd=0;r.wx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}zhc(){t.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.zhc();this.sud&&(this.sud.stop(),this.sud=null)}w8a(){this.Beb=(new lk.a).create();this.Beb.message=CommonUIStrings.l_ImageUploadWait;this.Beb.Cd=5;this.Beb.Kt=!1;this.Beb.KL(null,null,null)}Y4b(){this.Beb&&(this.Beb.close(),this.Beb=null)}static Stm(b,h){b=E.a.eh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static Nka(b,h=null){h||(h=dj.VXe);return b?dj.Stm(b,h)?0:2:1}}dj.VXe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(n.a)(dj,"PictureUploader",fk.a,[]);var ci=c(358),Sh;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";b[b.pictureTooLarge=3]="pictureTooLarge"})(Sh||(Sh={}));Object(n.b)("PictureValidationResult",Sh);var Xg=c(56),Pe=c(16),xe=c(47),pg=c(1035);class jm{constructor(){this.WO=null}}Object(n.a)(jm,"ImageData",null,[]);var vg=c(52),mh=c(1801),Nl=c(1640),sn=c(1676);class bn extends Pf.a{constructor(b,h=!0){super(!1,
!1,bn.QL);this.y_b=null;this.MVg=!1;this.By=[];this.gq=null;this.Deb=b;this.ujk=h;this.Daa=this.Tih=!1;this.p_a=null;this.BBe=!1;this.Vg=this.hol;this.zg="InsertFileDialog";this.ye(1,this.pBd);bn.QL?(this.y_b={["id"]:this.zg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Cwn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.spn,"onFrameReady")},this.Uh(this.titleText,
Object(z.a)(this,this.lYd,"insertDialogHandler"),this.y_b),this.pW=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.lYd,"insertDialogHandler")),h&&this.Npo(),(b=this.OQd(1))&&this.By.push(b),(b=this.OQd(0))&&this.By.push(b),this.iHj(),this.pW=!1)}get bJj(){return this.Deb}validate(){this.gq.WO||t.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.gq.WO.value?!0:(bn.wx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}spn(b){this.ujk&&(this.gq=this.Hoj(b,this.Deb))}Cwn(){this.gq&&
this.gq.WO&&(this.MVg||(this.gq.JXn(Object(z.a)(this,this.RWf,"onFileChosen")),this.MVg=!0),this.gq.K_h())}RWf(b){this.y_b.uploadStatusLabel=b;this.q6(this.titleText,Object(z.a)(this,this.lYd,"insertDialogHandler"),this.y_b)}lYd(b){1===b&&this.isEnabled()?bn.QL&&this.gq.WO&&!this.gq.WO.value?(this.y_b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.q6(this.titleText,Object(z.a)(this,this.lYd,"insertDialogHandler"),this.y_b)):(this.UWd(),this.Deb.wwa(this.gq,Object(z.a)(this,this.dispose,
"dispose"))):0===b&&this.hide()}Npo(){this.BBe=!1;this.gq=this.Hoj(document.getElementById("uploadFrameContainer"),this.Deb);v.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.p_a=Object(z.a)(this,this.BZf,"onUploadFrameLoad"),De.a.addHandler(this.gq.iFrame,"load",this.p_a));this.gq.WO||t.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.b5i()}BZf(){this.b5i()}b5i(){if(this.gq&&!this.BBe){var b=this.gq.WO;b&&(De.a.addHandler(b,Xc.a.gi,Object(z.a)(this,
this.onKeyDown,"onKeyDown")),b=[b],this.By=b.concat.apply(b,this.By),this.iHj(),this.BBe=!0)}}dispose(){if(this.gq&&!bn.QL){const b=this.gq.WO;b&&De.a.removeHandler(b,Xc.a.gi,Object(z.a)(this,this.onKeyDown,"onKeyDown"));this.p_a&&De.a.removeHandler(this.gq.iFrame,"load",this.p_a)}this.gq=null;super.dispose()}iHj(){if(0<this.By.length){const b=new nc(this.By),h=kb.FocusManager.instance().at();h&&(this.By[0].focus(),h.hk=b,h.yP=!0)}}onKeyDown(b){4!==kb.FocusManager.instance().f5i(b)&&b.preventDefault()}static get QL(){return v.AFrameworkApplication.ta.Kb.uF&&
v.AFrameworkApplication.ta.Kb.lCi}static wx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(n.a)(bn,"InsertFileDialog",Pf.a,[]);class Ol{static get Vg(){return Pf.a.Nx(Ol.Wm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Ol.Wm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(n.a)(Ol,"InsertImageDialogHtml",null,[]);class Dm extends bn{constructor(b,h=!0){super(b,h)}get pBd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get hol(){return Ol.Vg}validate(){this.gq.WO||t.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Na.a)(dj,this.bJj);const h=b.upe(this.gq.WO.value);return 0!==h?(b=b.URd(h),bn.wx(b),!1):!0}}Object(n.a)(Dm,"InsertImageDialog",bn,[]);class sc extends Dm{constructor(b){super(b)}Hoj(b,
h){const r=v.AFrameworkApplication.ta.Kb.uF&&v.AFrameworkApplication.ta.Kb.lCi;return new sn.a(b,Object(z.a)(h,h.t6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Nea,"uploadResponseReceived"),v.AFrameworkApplication.K,!r)}isEnabled(){return sc.oP.Kga(this.bJj.context)}static get oP(){return null!=sc.IBg?sc.IBg:sc.IBg=Ya.a.instance.resolve("Box4.Images.IImageEditor")}}Object(n.a)(sc,"Box4InsertImageDialog",Dm,[]);class Hm{n7k(b){return new Promise((h,r)=>{this.o7k(b).then(B=>{h(B)},B=>{r(B)})})}$Jh(b){return new Promise((h,
r)=>{const B=new FileReader;B.addEventListener("load",()=>{h(B.result)},!1);B.addEventListener("error",()=>{r("FileReader exception ("+B.error.name+")")});B.readAsDataURL(b)})}o7k(b){return new Promise((h,r)=>{this.$Jh(b).then(B=>{this.vaf(B,"image/jpeg").then(P=>{h(P)},P=>{r(P)})},B=>{r(B)})})}vaf(b,h){return new Promise((r,B)=>{const P=new Image;P.addEventListener("load",()=>{const ca=document.createElement("canvas"),ra=ca.getContext("2d");ca.width=P.width;ca.height=P.height;ra.drawImage(P,0,0);
r(ca.toDataURL(h))});P.addEventListener("error",()=>{B("Image failed to load")});P.src=b})}}Object(n.a)(Hm,"ImageFormatConverter",null,[]);var Rm=c(397);const hn=["ImageInsertFailed"];class km extends dj{constructor(b,h,r,B,P,ca,ra=!0){super(b,h,r);this.KBa=this.Zl=this.nH=this.Ef=null;this.uOd="wwpicturesfc";this.kpiName="ImageFileExtension";this.lyc="LocalDeviceUpload";this.Hia=new Map;this.Q_h=0;this.Ceb=null;this.zBe="";this.$sa=0;this.Xo=null;this.bxc="";this.Y6g=50;this.oXg=this.nvc=this.JDc=
this.iAc=!1;this.kbk=19922944;this.k9g=0;this.DBe=[];this.LVg=[];this.l9g=0;this.vYf=Qa=>{t.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Qa){var mb={},Jb=this.nH?this.nH.properties.Oc.toString():this.Ef.Oc.toString();mb[li.a.nodeId]=this.nH?this.nH.id.toString():this.Ef.id.toString();mb[li.a.classId]=Jb;this.Yg.hasProperty(Oc.a.imageType)&&(mb[Sg.a.imageType]=this.Yg.getValue(Oc.a.imageType));this.Yg.hasProperty(Oc.a.JU)&&(mb[Sg.a.JU]=this.Yg.getValue(Oc.a.JU));
this.Yg.hasProperty(Ng.a.kha)&&(mb[Sg.a.kha]=this.Yg.getValue(Ng.a.kha));this.Yg.hasProperty(Oc.a.Nmb)&&(mb[Sg.a.Nmb]=this.Yg.getValue(Oc.a.Nmb));Nl.d(Qa,this.Ef,this.Zl,mb)&&(this.rbd(Qa),km.Kgc++)}else t.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.bpn=Qa=>{if(!this.ECf){var mb=this.d$h(this.gq);mb&&(this.zBe=mb.name,this.$sa=mb.size);if(!this.Nka(Qa,this.gq)||!this.Hrg(mb,this.gq)){mb=Object.assign(new sb.a,{extendedProperties:new Map});mb.extendedProperties.set("type",
this.Nka(Qa,this.gq)?"Image too large":"FileType invalid");this.I3d(mb);this.B3d();return}}this.wwa(this.gq,null)};this.Yg=B;this.Pm=P;this.ga=ca;this.rg=ci.a.getInstance(Rm.a);this.X5g=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.p7g=r.nc("ImageUploadMaxByteSize",Number.MAX_VALUE);ra&&this.showDialog();qe.App.Mnc.addHandler(this)}get Nzi(){return this.K.$("JfifImageInsertIsEnabled")}get wP(){return this.lyc}get fileExtension(){return this.zBe}get fileSize(){return this.$sa}get aJj(){return this.Ceb}get Hv(){return this.Xo||
(this.Xo=Ya.a.instance.resolve("Common.Utils.IAriaNotifier"))}get ECf(){return this.wP===this.lyc}showDialog(){Nl.a(this.K)?(this.v1a=!1,this.gq=new sn.a(document.body,Object(z.a)(this,this.t6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Nea,"uploadResponseReceived"),this.K,!1,void 0,!0)):Nl.b()||this.knb&&ba.a.WG?(this.v1a=!1,this.gq=new sn.a(document.body,Object(z.a)(this,this.t6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Nea,"uploadResponseReceived"),this.K,!1)):(this.v1a=!0,this.gq=
(new sc(this)).gq)}L9h(b){switch(b){case Sh.noPictureSpecified:return vg.a.noPictureSpecified;case Sh.invalidExtension:return vg.a.eFm;case Sh.pictureTooLarge:return vg.a.XMf}return je.a.unknown}y7c(b){this.ECf||(this.Ef.Zi()?(t.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),mh.a.instance.Vqg(this.Ef.Zi()),this.Ef.Zi().contentReplicator.forceOutbound(this.vYf,Object(z.a)(this,this.bOb,"processFailure"),b)):this.bOb(b,157))}fTm(){return Nl.c(this.Ef)}rbd(b){b.rbd();this.Ceb=
b.Ceb}Nea(b){this.Q_h=+new Date-+this.aJj;this.B3d();t.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");Nl.e(this,b,this.Ef)}Rqg(){t.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.zhc();km.Kgc--;this.ga.processAction(eb.a.D9a,2);this.Ef?mh.a.instance.epc(this.Ef.Zi(),0):t.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Hv.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}bOb(b,h){var r;if(this.n9n(b))t.ULS.sendTraceTag(16798870,
352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new sb.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiFailure({kpiName:Rm.c.fGa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:Rm.c.sbc,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):xa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",hn,!1,!0,!1,!1,b);r=this.Fjf(h);t.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Ef.zJ();var B=new sg.GraphTransaction(15,Mb.a.CR);B.Db(this.Ef);km.oP.CUa(this.Yg,r);km.oP.B8f(this.Ef,this.nH);ye.ImageReader.wmj(this.Yg,pg.a.failed);B.dispose();this.Zsj(r);this.Pm.W4b(b,
!1);this.zhc();km.Kgc--;mh.a.instance.epc(this.Ef.Zi(),h)}}Zsj(b){const h=new Wh.StandardDialog;h.Cd=0;h.wx(vg.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}Fjf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}VPj(){if(this.bxc&&0<this.bxc.length){const b=new wc.DictionaryPropertySet;b.setValue(Zc.a.LP,this.bxc);b.setValue(Zc.a.R4,!0);this.ga.Qb(Mb.a.R_,2,b)}this.lxo()}lxo(){let b="";this.oXg?
b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.iAc&&this.nvc&&this.JDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.iAc&&this.nvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.iAc&&this.JDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.JDc&&this.nvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.JDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.nvc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.iAc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Zsj(b),this.BQj())}owk(b){this.bxc+=String.format('<img src="{0}"></img>',b);this.l9g++}B6m(){this.JDc=!0;t.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new sb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.I3d(b)}z6m(){this.nvc=!0;t.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const b=Object.assign(new sb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.I3d(b)}XKi(b){this.oXg=!0;t.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}hDo(b){const h=new Hm;if(this.upe(b.name)===Sh.validPicture)return h.$Jh(b);if(dj.Nka(b.name,sn.a.WXe)===Sh.validPicture)return h.n7k(b)}y7k(b){return new Promise(h=>{const r=this.hDo(b);void 0===r&&(this.XKi("Failed starting conversion work"),h());r.then(B=>
{B.length>this.kbk?this.B6m():this.owk(B);h()},B=>{this.XKi(B);h()})})}RXm(b){return this.upe(b.name)===Sh.validPicture||dj.Nka(b.name,sn.a.WXe)===Sh.validPicture}sEm(){const b=[];if(this.gq.WO.files){this.k9g=this.gq.WO.files.length;this.gq.WO.files.length>this.Y6g&&(this.iAc=!0);this.w8a();for(let h=0;h<this.gq.WO.files.length&&this.Y6g;h++){const r=this.gq.WO.files[h];this.DBe.push(r.name);this.LVg.push(r.size);r&&(this.RXm(r)?b.push(this.y7k(r)):this.z6m())}}Promise.all(b).then(()=>{this.Y4b();
this.VPj()});return!0}gFm(){this.Zl=Lb.a.create();this.Yg||(this.Yg=new wc.DictionaryPropertySet);this.X5g&&this.KBa&&this.Yg.setValue(Ng.a.rKi,this.KBa);var b=480;let h=320;const r=this.context.view.xh.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Yg.setValue(Ng.a.kha,r));this.Yg.setValue(Pe.a.Kia,Xg.a.Ql(b,0));this.Yg.setValue(Pe.a.Jia,Xg.a.Ql(h,1));this.Yg.setValue(xe.a.B0,pg.a.uploading);this.Yg.setValue(Zc.a.R4,!0);this.Yg.setValue(Oc.a.Nmb,Box4Intl.Box4Strings.l_Picture);
b=km.oP.oUh(this.context,this.Yg,this.Zl);if(!b)return!1;this.Ef=b.node;this.Yg=(this.nH=b.blob)?this.nH.properties:this.Ef.properties;qe.App.zd.Uo&&qe.App.zd.fq.iG(this.Ef);return!0}vYd(){return this.ECf?this.sEm():this.gFm()}BQj(){var b;this.Hia.set("FileExtensions",this.dTl());this.Hia.set("FileSizeInBytes",this.LVg.toString());this.Hia.set("Source",this.wP);this.Hia.set("NumberOfImagesAttemptedToInsert",this.k9g.toString());this.Hia.set("NumberOfImagesPasted",this.l9g.toString());(null===(b=v.AFrameworkApplication.K)||
void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.Hia.set("ErrorLevel","warning"),b=Object.assign(new sb.a,{extendedProperties:this.Hia}),this.rg.logKpiFailure({kpiName:Rm.c.fGa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):xa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.uOd,this.Hia)}dTl(){let b="";for(let h=0;h<this.DBe.length;++h)b=b+this.c$h(this.DBe[h])+",";return b}wwa(b,h){this.X5g&&(this.KBa=new jm,this.KBa.WO=b.WO);super.wwa(b,
h)}t6a(b){this.gq=b;if(!this.v1a){if(this.ned){if(Nl.a(this.K)||this.knb&&ba.a.WG){b.yMc(this.bpn);return}const h=b.yMc(null),r=this.d$h(b);r&&(this.zBe=r.name,this.$sa=r.size);if(!this.Nka(h,b)||!this.Hrg(r,b)){b=Object.assign(new sb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Nka(h,this.gq)?"Image too large":"FileType invalid");this.I3d(b);this.B3d();return}}this.wwa(b,null)}}KWd(){return!!km.Kgc}B3d(){var b;this.Hia.set("FileExtension",this.c$h(this.fileExtension));this.Hia.set("Source",
this.wP);this.Hia.set("FileSizeInBytes",this.fileSize.toString());this.Hia.set("RequestTimeInMs",this.Q_h.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiUsage({kpiName:Rm.c.fGa,kpiType:0,optionalProperties:{extendedProperties:this.Hia}}):xa.Health.instance.recordKpiUsage(this.kpiName,0,this.uOd,this.Hia)}c$h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}rki(){return this.Nzi?sn.a.Qlh:dj.VXe}d$h(b){return(b=
b.WO)?b.files[0]:null}Hrg(b,h){return b&&b.size>this.p7g?(h&&h.WBd(),b=this.URd(Sh.pictureTooLarge),this.Ep(this.L9h(Sh.pictureTooLarge),b),!1):!0}URd(b){switch(b){case Sh.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Sh.invalidExtension:return this.Nzi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Sh.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.p7g/1E6));
default:return""}}I3d(b){var h;(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Rm.c.sbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:Rm.c.fGa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):xa.Health.instance.recordQosError("PictureFromLocalInvalid",
hn,!0,!0,!1,!1,b)}static get oP(){return null!=km.HBg?km.HBg:km.HBg=Ya.a.instance.resolve("Box4.Images.IImageEditor")}}km.Kgc=0;Object(n.a)(km,"Box4PictureUploader",dj,[729,547]);var On=c(845),Ad=c(135);class Jo{constructor(){this.Pr=this.Op=this.wyb=this.Hjh=this.uhd=this.tZj=null;this.YQe=0;this.Rsa=this.gMe=this.Kyb=null;this.yQg=0;this.mue=this.Wfa=this.FIe=null;this.C0g=!1;this.qte=this.mte=this.rte=null}get assetId(){return this.uhd}get thumbnailUrl(){return this.Hjh}get mIn(){return this.wyb}get displayName(){return this.Rsa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Op,this.Pr)}get DAk(){if(this.mte&&this.qte&&this.rte){const b=document.createElement("a");b.setAttribute("href",this.rte);b.setAttribute("target","_blank");b.innerText=this.qte;return b}return null}get jsh(){return this.mte}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.yQg)}get aQn(){const b=document.createElement("span");var h=0;if(this.Kyb&&0<this.Kyb.length){var r=this.Kyb.indexOf("."),B=0>r?this.Kyb:this.Kyb.substring(0,r);for(B=Number.parseInvariant(B);h<
B&&5>h;h++)b.appendChild(ie.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Ad.a.xg("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.Kyb.substr(r+1)),3>r?b.appendChild(ie.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Ad.a.xg("box42.png"),"","",!0,"")):8>r?b.appendChild(ie.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Ad.a.xg("box42.png"),"","",!0,"")):b.appendChild(ie.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Ad.a.xg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(ie.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Ad.a.xg("box42.png"),"","",!0,""));this.gMe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.gMe),b.appendChild(h));return b}get T7n(){return 0<this.YQe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.YQe):""}get TIk(){if(this.C0g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.mue&&this.Wfa)return Jo.ocl(this.mue,this.Wfa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.FIe){const h=this.FIe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static CKl(b){const h=new Jo;for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];if(1===B.nodeType)try{const P=B.firstChild.nodeValue;switch(B.nodeName){case "src":h.tZj=P;break;case "assetid":h.uhd=
P;break;case "thumb":"64x64"===B.attributes.getNamedItem("size").nodeValue?h.Hjh=Jo.mCj(P):"192x192"===B.attributes.getNamedItem("size").nodeValue&&(h.wyb=Jo.mCj(P));break;case "imagedim":if(P){const ra=P.indexOf("x");0<ra&&ra<P.length&&(h.Op=P.substr(0,ra),h.Pr=P.substr(ra+1))}break;case "resolution":h.YQe=Number.parseInvariant(P);break;case "rating":h.Kyb=P;break;case "numofratings":h.gMe=P;break;case "displayname":h.Rsa=P;break;case "contentlength":h.yQg=Number.parseInvariant(P)/1024;break;case "subject":h.FIe=
P;break;case "provider":h.Wfa=P;break;case "attributionlink":h.mue=P;break;case "iscsc":h.C0g=1===Number.parseInvariant(P);break;case "additional":const ca=B.firstChild;if(B.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let ra=0;ra<B.childNodes.length;ra++){const Qa=B.childNodes[ra];switch(Qa.nodeName){case "caption":h.mte=Qa.text;break;case "value":h.rte=Qa.text;break;case "string":h.qte=Qa.text}}}}catch(P){}}return h}static ocl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static mCj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(n.a)(Jo,"ClipArtSearchResult",null,[]);class oq{static get Vg(){return Pf.a.Nx(oq.Wm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}oq.Wm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(n.a)(oq,"InsertClipartDialogHtml",null,[]);class lm extends Pf.a{constructor(b){super();this.IBa=this.Uvb=0;this.$bh=null;this.nPe=!1;this.l_b=this.fZa=this.aO=null;this.DYi=h=>{const r=this.aX.value;r&&0<r.trim().length&&(this.search(this.aX.value),this.qra(1,!1));h.preventDefault();h.stopPropagation()};this.Iun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.DYi(h),h.preventDefault(),h.stopPropagation())};this.EYi=h=>{100<=this.aX.value.length&&(h.preventDefault(),h.stopPropagation())};
this.btn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.p4i(h);this.Ndg(h)};this.onScroll=()=>{if(this.Qr&&this.Qr.children&&!(2>this.Qr.children.length)){var h=this.Qr.children[0].children[0],r=this.Qr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Qr.scrollTop,B=h.clientHeight+2,P=parseInt(String(this.Qr.scrollTop/B));h=parseInt(String(r/B));var ca=parseInt(String(this.Qr.clientWidth/B));h<r/B&&h<parseInt(String(this.aO.length/ca))&&h++;for(r=P;r<h;r++)for(B=
0;B<ca;B++){var ra=r*ca+B;P=this.aO[ra];(ra=document.getElementById("clip"+ra))&&!ra.childNodes.length&&(P=this.EOh(P),ra.appendChild(P))}}};this.Svn=h=>{h.target.setAttribute("src",Ad.a.xg("phthumb.64x64x32.png"))};this.ctn=h=>{h.target.setAttribute("src",Ad.a.xg("phpreview.96x96x32.png"))};this.bWi=h=>{Qd.a.vm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.dqn=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.bWi(h)};this.vWi=h=>{const r=h.target.innerText;this.aX&&(this.aX.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.qra(1,!1)};this.Sqn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.vWi(h)};this.GYi=h=>{this.aO&&(this.Nco(this.aO[this.Uvb]),h.stopPropagation(),h.preventDefault(),this.aX.value="",this.qra(1,!1))};this.Jun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.GYi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.IBa=this.IBa+r<this.Qr.children.length-1?0>this.IBa+r?0:this.IBa+r:this.Qr.children.length-1;this.Ndg(this.IBa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Qr.children.length&&this.Zij(h)):h.keyCode===Sys.UI.Key.tab&&
(this.IBa=h.shiftKey?Math.max(0,this.IBa-1):Math.min(this.IBa+1,this.Qr.children.length-1))};this.onError=()=>{this.Qr&&(this.Qr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.t5i=h=>{if(this.Qr)if(h.data.Qja){var r=h.data.Qja.lastChild.childNodes;this.aO||(this.aO=[]);for(h=0;h<r.length&&100>this.aO.length;h++){var B=r[h];1===B.nodeType&&"image"===B.nodeName&&(B=Jo.CKl(B),this.aO.push(B))}this.XTh();this.aO.length||(this.Qr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.te){h=
E.a.bxj(h.data.te);try{r=parseInt(h)}catch(P){r=14}this.Qr.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.XTh=()=>{if(this.aO){Kb.a.RQ(this.Qr);this.fZa&&(this.fZa.dispose(),this.fZa=null);this.Qr.focus();this.Qr.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.aO.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const B=document.createElement("span");B.id="clip"+r;B.classList.add("ClipartImageContainer");
h.appendChild(B);this.Qr.appendChild(h);r<parseInt(String(this.Qr.clientHeight/B.clientHeight))*parseInt(String(this.Qr.clientWidth/B.clientWidth))&&(h=this.EOh(this.aO[r]),B.appendChild(h))}this.nPe&&(this.Zij(this.Uvb),this.Ndg(this.Uvb))}};this.IDm=h=>{1===h&&this.aO&&lm.oP.Kga(this.vPg.context)&&(h=this.aO[this.Uvb])&&this.vPg.Uza(h)};this.vPg=b;this.Vg=oq.Vg;this.zg="InsertClipartDialog";this.ye(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.IDm);this.Qr=document.getElementById("clipartsearchresults");this.Lwd=this.onKeyDown;De.a.addHandler(this.Qr,"keydown",this.Lwd);this.Kwd=this.onScroll;De.a.addHandler(this.Qr,"scroll",this.Kwd);this.aX=document.getElementById("textInput");this.kzd=this.Iun;De.a.addHandler(this.aX,"keydown",this.kzd);this.lzd=this.EYi;De.a.addHandler(this.aX,"keypress",this.lzd);this.mzd=this.EYi;De.a.addHandler(this.aX,"paste",this.mzd);this.Nrc=document.getElementById("btnSearch");this.Nrc.setAttribute("src",
Ad.a.xg("search.16x16x32.png"));this.Jwd=this.DYi;De.a.addHandler(this.Nrc,"click",this.Jwd);this.CWb=document.getElementById("clipartpreviewimage");this.Eze=document.getElementById("clipartattributedisplayname");this.Uab=document.getElementById("clipartseesimilar");this.Dze=document.getElementById("clipartdimensions");this.wuc=document.getElementById("clipartadditionalvalue");this.Fze=document.getElementById("clipartratingvalue");this.mXa=document.getElementById("clipartattributionvalue");this.nXa=
document.getElementById("clipartkeywords");this.Bze=document.getElementById("clipartadditionalname");this.Gze=document.getElementById("clipartratingname");this.Cze=document.getElementById("clipartattributionname");this.pPe=this.btn;this.bWe=this.Svn;this.Ond=this.bWi;this.Pnd=this.dqn;this.DIe=this.vWi;this.EIe=this.Sqn;this.Nwd=this.GYi;this.Owd=this.Jun;this.aX.focus();this.qra(1,!1)}dispose(){this.Qr&&this.TEh();this.Qr&&this.Lwd&&(De.a.removeHandler(this.Qr,"keydown",this.Lwd),this.Lwd=null);
this.Qr&&this.Kwd&&(De.a.removeHandler(this.Qr,"scroll",this.Kwd),this.Kwd=null);this.Qr=null;this.aX&&this.kzd&&(De.a.removeHandler(this.aX,"keydown",this.kzd),this.kzd=null);this.aX&&this.lzd&&(De.a.removeHandler(this.aX,"keypress",this.lzd),this.lzd=null);this.aX&&this.mzd&&(De.a.removeHandler(this.aX,"paste",this.mzd),this.mzd=null);this.aX=null;this.Nrc&&this.Jwd&&(De.a.removeHandler(this.Nrc,"click",this.Jwd),this.Nrc=this.Jwd=null);this.Cze=this.Gze=this.Bze=this.nXa=this.mXa=this.Fze=this.wuc=
this.Dze=this.Uab=this.Eze=this.CWb=this.Owd=this.Nwd=this.EIe=this.DIe=this.Pnd=this.Ond=this.l_b=this.bWe=this.pPe=null;this.fZa&&(this.fZa.dispose(),this.fZa=null);super.dispose()}LL(){super.LL();document.getElementById(this.rj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.dQb(b,!1,this.t5i)}dQb(b,h,r){this.IBa=this.Uvb=0;this.TEh();if(this.aO&&b===this.$bh&&this.nPe===h)window.setTimeout(this.XTh,500);else{this.aO&&(Array.clear(this.aO),this.aO=null);this.$bh=b;this.nPe=
h;var B=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');B.append("<query>");B.append(E.a.zf(b));B.append("</query>");B.append("<mediatype>Illustration</mediatype>");B.append("<mediatype>Photo</mediatype>");B.append("<filetype>jpg</filetype>");B.append("<filetype>jpeg</filetype>");B.append("<filetype>gif</filetype>");B.append("<filetype>bmp</filetype>");B.append("<filetype>tif</filetype>");B.append("<filetype>tiff</filetype>");B.append("<filetype>png</filetype>");B.append("</search>");
b=v.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let P=b.length;4>P;P++)b="0"+b;v.AFrameworkApplication.He.nj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",qe.App.webServiceBase,b,Sg.a.Qzo,h.toString()),2,B.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}Nco(b){this.dQb(b.assetId,!0,this.t5i);this.aO||(this.aO=[],this.aO.push(b))}EOh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);De.a.addHandler(h,"click",this.pPe);De.a.addHandler(h,"error",this.bWe);return h}Xll(b){1===b.childNodes.length&&(b=b.childNodes[0],De.a.removeHandler(b,"click",this.pPe),De.a.removeHandler(b,"error",this.bWe))}p4i(b){const h=this.aO[b];var r=h.mIn;this.REh();this.l_b=this.ctn;var B=document.createElement("img");B.setAttribute("src",r);if(h.displayName)r=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;for(let P=0;P<h.keywords.length&&5>P;P++)P&&r.append(", "),r.append(h.keywords[P]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}B.setAttribute("title",r);B.setAttribute("alt",r);De.a.addHandler(B,"error",this.l_b);this.CWb.appendChild(B);B=document.getElementById("clip"+this.Uvb);B.classList.remove("ClipartSelectedImage");B=document.getElementById("clip"+
b);B.classList.add("ClipartSelectedImage");this.Uvb=b;h.displayName&&(this.Eze.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');De.a.addHandler(b,"click",this.Nwd);De.a.addHandler(b,"keydown",this.Owd);this.Uab.appendChild(b);this.Dze.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.T7n,h.fileSize);(b=h.DAk)&&h.jsh?(this.wuc.parentNode.style.display="block",this.Bze.innerText=h.jsh,this.wuc.appendChild(b)):
this.wuc.parentNode.style.display="none";this.Fze.appendChild(h.aQn);Kb.a.RQ(this.mXa);if(b=h.TIk)this.mXa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(De.a.addHandler(b,"click",this.Ond),De.a.addHandler(b,"keydown",this.Pnd));this.nXa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)B=h.keywords[b],r=document.createElement("a"),r.innerText=B,r.setAttribute("href",'""'),De.a.addHandler(r,"click",this.DIe),De.a.addHandler(r,"keydown",this.EIe),this.nXa.appendChild(r),
b<h.keywords.length-1&&(B=document.createElement("span"),B.innerText=", ",this.nXa.appendChild(B));this.Gze.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.Cze.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.qra(1,!0)}REh(){this.CWb&&1===this.CWb.childNodes.length&&(this.l_b&&(De.a.removeHandler(this.CWb.childNodes[0],"error",this.l_b),this.l_b=null),Kb.a.RQ(this.CWb));this.mXa&&0<this.mXa.childNodes.length&&"a"===this.mXa.childNodes[0].nodeName.toLowerCase()&&(this.Ond&&De.a.removeHandler(this.mXa.childNodes[0],
"click",this.Ond),this.Pnd&&De.a.removeHandler(this.mXa.childNodes[0],"keydown",this.Pnd));this.Uab&&0<this.Uab.children.length&&"a"===this.Uab.children[0].nodeName.toLowerCase()&&(this.Nwd&&De.a.removeHandler(this.Uab.children[0],"click",this.Nwd),this.Owd&&De.a.removeHandler(this.Uab.children[0],"keydown",this.Owd),Kb.a.RQ(this.Uab));if(this.nXa){for(let b=0;b<this.nXa.childNodes.length;b++){const h=this.nXa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(De.a.removeHandler(h,"click",this.DIe),De.a.removeHandler(h,
"keydown",this.EIe))}Kb.a.RQ(this.nXa)}this.Eze.innerText="";this.Dze.innerText="";Kb.a.RQ(this.wuc);Kb.a.RQ(this.Fze);Kb.a.RQ(this.mXa);this.nXa.innerText="";this.Bze.innerText="";this.Gze.innerText="";this.Cze.innerText=""}Zij(b){if(!(this.Qr.children.length<=b||0>b)){var h=this.Qr.children[b],r=this.Qr.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Qr.scrollTop+this.Qr.clientHeight<h.offsetTop+h.clientHeight?this.Qr.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Qr.scrollTop>h.offsetTop&&
(this.Qr.scrollTop=h.offsetTop-r/2);this.p4i(b)}}validate(){return!0}TEh(){if(kb.FocusManager.nK()){var b=kb.FocusManager.instance().getRegion(this.iL);b&&b.hk.iz(this.aX)}else this.aX.focus();for(b=0;b<this.Qr.childNodes.length;b++){const h=this.Qr.childNodes[b];1===h.childNodes.length&&this.Xll(h.childNodes[0])}Kb.a.RQ(this.Qr);this.REh();this.qra(1,!1);this.fZa=new On.a(Box4Intl.Box4Strings.l_ClipartSearching);this.fZa.lDi=!1;this.Qr.appendChild(this.fZa.element);this.Qr.classList.add("ClipartSearchInProgress")}Ndg(b){this.IBa=
b;b=this.Qr.children[this.IBa];kb.FocusManager.nK()?kb.FocusManager.instance().getRegion(this.iL).hk.iz(b):b.focus()}static get oP(){return lm.Vj=lm.Vj||Ya.a.instance.resolve("Box4.Images.IImageEditor")}}lm.Vj=null;Object(n.a)(lm,"InsertClipartDialog",Pf.a,[]);class Ko extends km{constructor(b,h,r,B,P,ca){super(b,h,r,B,P,ca,!1);this.Ksn=ra=>{if(this.fTm()){var Qa=this.Ef.Zi(),mb=Qa.contentReplicator.Su.toString(),Jb=new Sys.Net.WebRequest;Jb.set_url("ClipArtUpload.ashx");Jb=new Sys.StringBuilder(Jb.getResolvedUrl());
this.oX(Jb,Sg.a.assetId,ra.assetId,!0);this.oX(Jb,li.a.lcid,v.AFrameworkApplication.lcid.toString());this.oX(Jb,li.a.nodeId,this.nH?this.nH.id.toString():this.Ef.id.toString());this.oX(Jb,li.a.cellId,Qa.Fm.toString());this.oX(Jb,li.a.fileId,Qa.yr);this.oX(Jb,li.a.$ua,mb);this.oX(Jb,li.a.MX,this.Zl.toString());ra=this.Ef.ja(Ng.a.RJ,Ti.a.Qt);this.oX(Jb,li.a.RJ,ra.toString());this.oX(Jb,li.a.rsb,"1");Qa.VH&&this.oX(Jb,li.a.VH,Qa.VH);this.oX(Jb,li.a.classId,this.nH?this.nH.properties.Oc.toString():this.Ef.Oc.toString());
this.Yg.hasProperty(Oc.a.imageType)&&this.oX(Jb,Sg.a.imageType,this.Yg.getValue(Oc.a.imageType).toString());ke.a.instance.xwk(Jb);v.AFrameworkApplication.He.nj(Jb.toString(),2,"",{},!1,2,this.T0o,this.ZIj,null);km.Kgc++}};this.T0o=ra=>{if(({group:Qa}=de.a.d2(ra.data.te)).returnValue){var Qa=Qa.Responses[0];Qa.tpb=ra.data.bI;Qa.Vr=ra.data.jj?ra.data.jj[ij.a.ZQ]:"";this.Nea(Qa)}else this.ZIj(null)};this.ZIj=()=>{const ra=new Uf.a;ra.StatusCode=14;this.Nea(ra)};new lm(this)}Uza(b){this.vYd()&&this.Ef.Zi().contentReplicator.forceOutbound(this.Ksn,
null,b)}oX(b,h,r,B){b.append(B?"?":"&");b.append(E.a.Gj(h));b.append("=");b.append(E.a.Gj(r))}Fjf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.Fjf(b)}}Nea(b){super.Nea(b);km.Kgc--}}Object(n.a)(Ko,"ClipartUploader",km,[]);var zc=c(11);class Fn{constructor(b,h,r){this.JDm=(B,P,ca,ra,Qa)=>{if(!this.Vj||!this.Vj.value)return t.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;B=this.Vj.value.Kga(P);
return 2===ca&&B?(new Ko(P,Rg.a.instance,v.AFrameworkApplication.K,Qa,this.Pm,this.ga),32):1===ca?B&&qe.App.MFh?32:8:2};this.Vj=b;this.Pm=h;this.ga=r}Ub(){this.ga.fb(Mb.a.Usi,zc.a.view,this.JDm,260)}}Object(n.a)(Fn,"ClipArtActor",null,[]);class jd{constructor(){this.W=null}get name(){return"Box4.ClipArt"}wc(b){this.W=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new Fn(b.Ve("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va)).ha()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Ub();
const b=ab.StaticActiveAppFrame.za();b&&b.updateCommandUI()}dispose(){}}Object(n.a)(jd,"ClipartPackage",null,[1,2]);class Em{constructor(b){this.CZa=this.nZa=this.HZa=this.GZa=null;this.BYg=this.jTg=this.CYg=this.A4g=this.Zh=this.Oaa=!1;this.NQe=this.f5g=null;this.Q4g=0;this.Ca=this.a5g=null;this.ofa=b;this.KN=3;this.kYb=!0}initialize(b,h,r){this.GZa=this.Luf(b,h);this.HZa=CommonUIStrings.l_SavingStatus;this.nZa=CommonUIStrings.l_ReadOnlyStatus;this.CZa=CommonUIStrings.l_ReviewModeStatus;this.ofa&&
this.ofa.execute(B=>{B.bfb(Object(z.a)(this,this.ced,"updateToSavingStatus"))});this.Zh=!0;this.Ca=r;this.jTg=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}dsb(b,h){this.Oaa=b;this.KN=h;this.RVa(this.kYb)}RVa(b){!this.kYb&&b&&(this.a5g=new Date);this.kYb=b;this.BYg=!1;b=null;3===this.KN&&(b=this.kYb?this.GZa:this.HZa);this.nql(b)}Luf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}ced(){this.RVa(!1)}w5l(){switch(this.KN){case 1:return this.nZa;case 2:return this.CZa;default:return null}}v5l(){if(3!==this.KN)switch(this.KN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.BYg?"FailedToSave":this.kYb?"Saved":"Saving"}bMm(b){return this.A4g===this.Oaa&&this.Q4g===this.KN&&this.f5g===b}ogf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Oaa,b,this.w5l(),this.a5g,this.kYb,this.jTg?h.getHeaderSaveStatusIconProps(this.v5l()):
null);this.CYg=!0;return null});this.NQe=null}nql(b){this.Zh&&rh.c()&&!this.bMm(b)&&(!this.CYg&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.ogf(b):Qd.a.Hee()?(this.NQe&&t.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.NQe=window.requestIdleCallback(()=>{this.ogf(b)})):window.requestAnimationFrame(()=>{this.ogf(b)}),this.A4g=this.Oaa,this.f5g=b,this.Q4g=this.KN)}}Object(n.a)(Em,"ReactSaveStatusUIHandler",
null,[709]);class Pl{constructor(b,h){this.sY=null;this.GZa=CommonUIStrings.l_SavedStatus;this.HZa=CommonUIStrings.l_SavingStatus;this.nZa=CommonUIStrings.l_ReadOnlyStatus;this.CZa=CommonUIStrings.l_ReviewModeStatus;this.Lbb=h;this.ofa=b;this.KN=3;this.Ndb=!0}fC(){this.ofa&&this.ofa.execute(b=>{b.bfb(Object(z.a)(this,this.ced,"updateToSavingStatus"))});this.Lbb.execute(b=>{this.sY=b})}dsb(b,h){this.KN=h;3===h?this.RVa(this.Ndb):2===h?this.Gog(this.CZa):this.Gog(this.nZa)}ced(){this.RVa(!1)}RVa(b){this.Ndb=
b;this.Gog(this.Ndb?this.GZa:this.HZa)}Gog(b){this.sY&&this.sY.sendMessage(M.a.PRo,this.o5k(b))}o5k(b){const h={};h.StatusText=b;return h}}Object(n.a)(Pl,"SaveStatusPostMessageHandler",null,[709]);var Sp=c(219),vl=c(144);class fp{constructor(b,h,r,B){this.CZa=this.nZa=this.HZa=this.GZa=null;this.lxb=0;this.p_=this.VRe=this.gtb=this.Xte=this.oWe=null;this.ng=b;this.Gbb=h;this.ofa=r;this.nm=B;this.A1g=!0;this.Oaa=!1;this.KN=3;this.Ndb=!0}initialize(b,h){if(!this.ng)return!1;this.GZa=this.Luf(b,h);this.HZa=
CommonUIStrings.l_SavingStatus;this.nZa=CommonUIStrings.l_ReadOnlyStatus;this.CZa=CommonUIStrings.l_ReviewModeStatus;this.fC();return!0}Luf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}fC(){this.Gbb&&this.Gbb.execute(b=>{b.jzk(Object(z.a)(this,this.lOh,"createStatusAndModeElements"));b.Uyk(Object(z.a)(this,this.Mxo,"showHideSaveStatusElement"));b.QMo&&this.lOh(null,
null)});this.ofa&&this.ofa.execute(b=>{b.bfb(Object(z.a)(this,this.ced,"updateToSavingStatus"))})}p6(){this.p_&&this.ng&&this.ng.oAa(this.p_)}Mxo(b,h){this.dsb("true"===h,this.KN)}dsb(b,h){this.Oaa=b;this.KN=h;this.Xte&&(this.Xte.style.display=this.Oaa||3===this.KN||!this.oWe?"none":"");this.gtb&&(this.gtb.style.display=this.Oaa||3===this.KN?"none":"",this.gtb.innerText=1===this.KN?this.nZa:this.CZa,this.gtb.title=1===this.KN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.VRe&&(this.VRe.style.display=this.Oaa||1===this.KN||!this.oWe&&!this.gtb?"none":"");this.p_&&(this.p_.style.display=this.Oaa||1===this.KN?"none":"",this.RVa(this.Ndb),this.p_.title=CommonUIStrings.l_SaveStatusTooltip)}lOh(b,h){b=document.getElementById(Sp.CuiHelper.fum);h&&h.v5o||!b||""===this.GZa||""===this.HZa||""===this.nZa||""===this.CZa||(this.oWe=document.getElementById(Sp.CuiHelper.G5e),this.Xte=Sp.CuiHelper.sJd(b,"BreadcrumbAppModeDash","-"),this.gtb=Sp.CuiHelper.sJd(b,"BreadcrumbAppModeStatus",
1===this.KN?this.nZa:this.CZa),this.mGj(this.gtb),this.VRe=Sp.CuiHelper.sJd(b,"BreadcrumbSaveStatusDash","-"),this.p_=Sp.CuiHelper.sJd(b,"BreadcrumbSaveStatus",this.GZa),this.mGj(this.p_),this.dsb(this.Oaa,this.KN))}ced(){this.RVa(!1)}RVa(b){this.Ndb=b;this.j_o(this.Ndb?this.GZa:this.HZa)}j_o(b){!this.p_||3!==this.KN&&2!==this.KN||(this.A1g&&!this.Ndb?(this.lxb=this.p_.offsetWidth<this.lxb?this.lxb:this.p_.offsetWidth,this.GUo(this.HZa),this.A1g=!1):this.p_.innerText=b)}mGj(b){b.style.direction=this.nm?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.nm?"right":"left";b.style.display=this.Oaa?"none":"";b.setAttribute("Unselectable","on")}GUo(b){this.p_&&(this.p_.style.width="",this.p_.innerText=b,this.lxb=this.p_.offsetWidth<this.lxb?this.lxb:this.p_.offsetWidth,b=vl.a.BB(this.p_),this.p_.style.width=this.lxb-Kb.a.jN(b.paddingLeft)-Kb.a.jN(b.paddingRight)+1+"px")}}Object(n.a)(fp,"SaveStatusUIHandler",null,[709]);var to=c(94);class cn{constructor(){this.WRe=this.$Pe=this.zNa=this.W=null}get name(){return"Common.App.SaveStatus"}wc(b){this.W=
b;v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.qY?this.W.register(Pl,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new Pl(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),this.W.Sa("Postmessage.IHostPostmessenger"))):v.AFrameworkApplication.ta.Kb.IIf||(v.AFrameworkApplication.ta.Kb.NJ?this.W.register(Em,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>
new Em(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(fp,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new fp(to.EventHandlerManager.instance,this.W.Sa("Common.App.Header.HeaderEventSource"),this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)))}init(){v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.$x,"onFullAppSettingsReady"))}$x(){const b=v.AFrameworkApplication.K,
h=!!v.AFrameworkApplication.ta.Kb&&4===v.AFrameworkApplication.ta.Kb.xk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.qY?(this.WRe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.WRe.fC():v.AFrameworkApplication.ta.Kb.IIf||v.AFrameworkApplication.hideHeader||
(v.AFrameworkApplication.ta.Kb.NJ?(this.$Pe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.$Pe.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.K):(this.zNa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.zNa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}dispose(){this.zNa&&this.zNa.p6()}}Object(n.a)(cn,"PackageManager",null,[1,2]);var Pk=c(1673);class zq{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){Pk.a.instance.init()}dispose(){}static main(){L.a.instance.Gc(new zq)}}
Object(n.a)(zq,"EventsCachePackage",null,[1,2]);var Qk=c(134),kh=c(164),bm=c(89),mm=c(629),Df=c(311),Ym=c(450),jn=c(290),lf=c(26),mk=c(246),Af=c(24);class Tg{constructor(b){this.I0g=!1;this.Hgd=this.wm=null;this.Vse=!1;this.yE=b}get control(){return this.yE}get Sd(){return this.control.Sd}get root(){return this.control.root}get jI(){return this.control.jI}get y_a(){return this.control.y_a}get vk(){return this.control.vk}get dF(){return this.control.dF}eJ(){}initialize(){}gx(b,h,r){this.control.irl(b,
h,r)}Gm(){lf.c(this.control.Ih.Command)||this.yu(this.control.Ih.Command,null,null)}yu(b,h,r){let B=0;this.root&&(B=this.root.Qqa(b,h,r));this.control.enabled=0<(B&1);return B}F9a(){let b=this.control.visible;this.root.iVa&&(b=this.Sd[mk.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.ugc=!0));return b}dqg(){const b=Af.a.dsa(this.Sd[mk.a.labelText],this.control.Ih.LabelText);this.the(b)}the(b){this.control.labelText!==b&&(this.dF.forEach(h=>{h.the(b)}),this.control.labelText=
b,this.root.a6a=!0)}bTb(){const b=Af.a.dsa(this.Sd[mk.a.alt],this.control.Ih.Alt);this.Flc(b)}Flc(b){this.control.tooltip!==b&&(this.dF.forEach(h=>{h.Flc(b)}),this.control.tooltip=b)}Kka(){const b=Af.a.dsa(this.Sd[mm.a.Image16by16Class],this.control.Ih.Image16by16Class),h=Af.a.dsa(this.Sd[mm.a.Image32by32Class],this.control.Ih.Image32by32Class);var r=Af.a.dsa(this.Sd[mm.a.Image48by48Class],this.control.Ih.Image48by48Class);r=lf.b(r)?h:r;this.UGc(this.dF.small,b);this.UGc(this.dF.medium,b);this.UGc(this.dF.large,
h);this.UGc(this.dF.QAo,b);this.UGc(this.dF.Tec,r)}UGc(b,h){!b||lf.c(b.iR)||lf.c(h)||b.iR.className===h||(b.iR.className=h)}uWo(b){if(!lf.b(b)&&this.root.Gkg){for(const h of this.control.g$e){const r=h.mU===b;r&&(this.control.vZe=h);this.control.visible&&(h.$A=r)}this.control.visible&&(this.root.a6a=!0)}}WAk(){if(this.dF.Tec&&this.dF.Tec.QO&&this.dF.Tec.Khb){const b=this.dF.Tec.QO,h=Af.a.dsa(this.Sd[Df.a.Description],this.control.Ih.Description);lf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-
b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.vk;Object(uc.a)(Ym.a,b)?this.jI.Zrb(b):this.root.YCb=this.control;return!1}onBlur(){const b=this.vk;this.control.cKb()&&Af.a.Gw(b.Nc,"cui-ctl-menu-hovered-without-focus");this.root.YCb=null;return!1}JP(b){if(this.control.cKb()){var h=this.jI.Hra;const r=h===this.root.JLb-1;h=r?null:this.root.dD[h+1];this.a9e(!1);r||this.control===h||Af.a.Gw(h.NKb,jn.MenuLauncher.L0c);this.control.enabled&&this.control.Ou?r?this.control.mZ():(Af.a.$f(this.vk.Nc,
"cui-ctl-menu-hovered-without-focus"),h.lha=this.control.Ou):r?this.jI.setFocus(b.kg):(h.lha=this.jI.Nc,this.jI.dra())}return!1}TJ(){this.control.cKb()&&Af.a.Gw(this.vk.Nc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(uc.a)(Ym.a,this.vk)){const B=this.jI;if(!lf.c(B)){const P=B.Hra,ca=0===this.root.U1,ra=!lf.c(this.control.iBn);if(r!==Sys.UI.Key.tab&&r!==
Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Qd.a.C8e();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(B.gL(1),h=!0):r===Sys.UI.Key.left&&ca||r===Sys.UI.Key.right&&!ca?(ra?B.gL(2):0<P&&this.root.E0a(P,!0,!1),h=!0):r===Sys.UI.Key.right&&ca||r===Sys.UI.Key.left&&!ca?(ra&&B.gL(4),h=!0):r===Sys.UI.Key.up?(B.gL(5),h=!0):r===Sys.UI.Key.down?(B.gL(6),h=!0):r===Sys.UI.Key.esc&&(this.root.E0a(P,!0,!1),h=!0):(B.gL(0),h=!0)}}}return h}Wy(b){let h=!1;
if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;Tb.KeyInputManager.Sni(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.Ayf(b),h||(this.gx(b.yf,1,b.Hb),h=!0))}return h}fD(b){this.W9e();if(this.y_a){let h=!0;2===b.kg&&(h=b.Ada===Sys.UI.MouseButton.leftButton);h&&this.vk&&this.BBd(this.vk.Nc)}(b.Hb.type.toLowerCase()!==Xc.a.cQ||this.y_a)&&b.Hb.preventDefault();return!1}get lEf(){return this.I0g}Jvl(){this.I0g=!0}W9e(){this.lEf&&this.control.root.vgb()}Eya(b){Object(uc.a)(Ym.a,this.vk)&&
!this.y_a&&2===b.kg&&b.Ada===Sys.UI.MouseButton.leftButton?(this.gx(b.yf,b.kg,b.Hb),b=!0):b=this.control.Sva(b);return b}onClick(b){let h=!1;Object(uc.a)(Ym.a,this.vk)&&!this.y_a&&3===b.kg&&(this.gx(b.yf,b.kg,b.Hb),h=!0);return ba.a.vi?!1:h}job(b){return this.U6d(b)}VHa(b){this.Sva(b);return!1}U6d(b){return lf.c(this.wm)?!1:(this.adg(Qd.a.I0d(this.Wnh,b.clientPoint)),!0)}chc(b){let h=!1;this.Sva(b)&&(h=!0);3!==b.kg&&(b=!0,!this.root&&Tg.KUf&&(t.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=
!1),b&&this.root.g4(),h=!0);return h}fhc(b){return this.Sva(b)}dhc(b){return this.U6d(b)}ehc(b){return this.Sva(b)}ahc(b){return 3===b.kg?(this.root.g4(),!0):!1}bhc(){return!1}get Wnh(){!lf.c(this.wm)&&lf.c(this.Hgd)&&(this.Hgd=Qd.a.getElementBounds(this.wm));return this.Hgd}adg(b){this.Vse!==b&&(this.Vse=b,this.wZe(this.Vse))}wZe(b){lf.c(this.wm)||Af.a.k6(this.wm,bm.Control.EBd,b)}BBd(b){this.control.enabled&&(this.wm=b,this.root.QFc=this.control,this.adg(!0),this.root.Fga(this.control,!1))}Sva(b){if(!lf.c(this.wm)){this.adg(!1);
let h=!!this.root;if(Tg.KUf){const r=nd.ActionManager.xba(parseInt(this.control.Ih.Command))||"";t.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.ica(this.control,!1);lf.c(b)||Qd.a.I0d(this.Wnh,b.clientPoint)&&this.gx(this.wm,b.kg,b.Hb);h=!!this.root;Tg.KUf&&t.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.QFc=null);this.Hgd=this.wm=null;return!0}return!1}gL(b){return Object(uc.a)(Ym.a,this.vk)&&2!==b&&4!==b&&!Qd.a.ccc(this.control.Ou)?
this.mZ():!1}mZ(){try{if(this.control.visible){const b=this.control.Ou;if(!lf.c(b))return b.focus(),!0}}catch(b){}return!1}a9e(b){const h=this.jI;lf.c(h)||this.root.E0a(h.Hra+1,b)}yqa(){}Ayf(){return!1}jY(b){let h=null;b&&b.rawEvent&&(h={},h[Tg.triggerTime]=b.rawEvent.timeStamp);return h}static get KUf(){null==Tg.bMe&&(Tg.bMe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Tg.bMe}}Tg.triggerTime="TriggerTime";Tg.bMe=null;Object(n.a)(Tg,
"ControlBehavior",null,[719]);var hl=c(187);class Qq extends Tg{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Ih}eJ(b){const h=b.Xm;b=b.mU;lf.c(h)||(cd.a.instance.ob(Xc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),cd.a.instance.ob(Xc.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),kh.a.instance.ob(Xc.a.pointerOver,h,Object(z.a)(this,this.JP,"onPointerOver")),kh.a.instance.ob(Xc.a.pointerOut,h,Object(z.a)(this,this.TJ,"onPointerOut")),Tb.KeyInputManager.instance.oE(Xc.a.gi,
h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Tb.KeyInputManager.instance.oE(Xc.a.tu,h,Object(z.a)(this,this.$G,"onKeyPress"),b),Tb.KeyInputManager.instance.oE(Xc.a.zh,h,Object(z.a)(this,this.Wy,"onKeyUp"),b),kh.a.instance.ob(Xc.a.pointerDown,h,Object(z.a)(this,this.fD,"onPointerDown")),kh.a.instance.ob(Xc.a.kN,h,Object(z.a)(this,this.Eya,"onPointerUp")),ji.a.instance.ob(Xc.a.click,h,Object(z.a)(this,this.onClick,"onClick")),hl.a.instance.ob(Xc.a.bQ,h,Object(z.a)(this,this.job,"onTouchMove")),
hl.a.instance.ob(Xc.a.jK,h,Object(z.a)(this,this.VHa,"onTouchEnd")))}gx(b,h,r){this.control.enabled&&(b=null,this.vk&&this.vk.uXc()&&this.jI&&(b=this.root.dD[this.jI.Hra])&&!this.lEf&&(b.tUa(this.button),b=null),this.executeCommand(this.control.Ih.Command,h,!0,r),b&&b.tUa(this.button))}executeCommand(b,h,r,B){if(!lf.c(b)){const P=this.Sd;P.CommandValueId=this.button.WFb();P.MenuItemId=this.button.Ih.MenuItemId;P.SourceControlId=this.control.id;this.root.executeCommand(b,P,this.vk,h,r,null,this.jY(B))}}Gm(){lf.c(this.control.Ih.Command)||
0<(this.yu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.F9a()&&this.OVa()}OVa(){this.dqg();this.bTb();this.Kka()}onFocus(b){super.onFocus(b);this.Bjg();return!1}onBlur(b){super.onBlur(b);this.Eif();return!1}onKeyDown(b){let h=super.onKeyDown(b);lf.c(b.Hb)||this.ngg(b.Vo,b.Hb.keyCode)&&(h=!1);return h}$G(b){let h=!1;lf.c(b.Hb)||lf.c(b.Hb.rawEvent)||(this.ngg(b.Vo,b.Hb.rawEvent.keyCode)?(this.gx(b.yf,b.kg,b.Hb),h=!0):b.Hb.preventDefault());return h}ngg(b,h){if(ba.a.ht&&h===
Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Wy(b){let h=!1;lf.c(b.Hb)||this.ngg(b.Vo,b.Hb.keyCode)||(h=super.Wy(b));return h}Bjg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}Eif(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(n.a)(Qq,"ButtonBehavior",Tg,[]);var la=c(998);class bb{}bb.Color="Color";bb.IndexColorSelected="ColorSelected";Object(n.a)(bb,
"ColorPickerCommandProperties",null,[]);class qb extends Tg{constructor(b){super(b);this.eDc=this.Dv=-1}get GCb(){return this.control}get OOa(){return this.GCb.j1k.OOa}get properties(){return this.GCb.Ih}gx(b,h,r){if(this.control.enabled){const B=this.Sd;B.Color=qb.rTd(b)[la.ColorPicker.pHd];b=null;Af.a.hs(this.properties.Stateful)&&this.vk&&this.vk.uXc()&&this.jI&&(b=this.root.dD[this.jI.Hra]);this.root.executeCommand(this.properties.Command,B,this.vk,h,!0,null,this.jY(r));b&&b.tUa(this.GCb)}}Gm(){var b=
this.Sd;b.SourceControlId=this.properties.Id;if(0<(this.yu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,bb.IndexColorSelected in this.Sd&&(b=this.Sd[bb.IndexColorSelected]),b!==this.eDc)){const h=this.OOa;0<=b&&b<h.length&&this.BFj(h[b],!0);0<=this.eDc&&this.eDc<h.length&&this.BFj(h[this.eDc],!1);this.eDc=b}}BFj(b,h){h?Af.a.$f(b,"cui-colorpicker-selected"):Af.a.Gw(b,"cui-colorpicker-selected")}eJ(b){for(let h=0;h<b.aZe.length;++h){const r=b.aZe[h];cd.a.instance.ob(Xc.a.focus,
r,Object(z.a)(this,this.dWf,"onCellFocus"));cd.a.instance.ob(Xc.a.blur,r,Object(z.a)(this,this.Jmn,"onCellBlur"));Tb.KeyInputManager.instance.ob(Xc.a.gi,r,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,r,Object(z.a)(this,this.Wy,"onKeyUp"));ji.a.instance.ob(Xc.a.click,r,Object(z.a)(this,this.Kmn,"onCellClick"));kh.a.instance.ob(Xc.a.kN,r,Object(z.a)(this,this.fWf,"onCellPointerUp"));kh.a.instance.ob(Xc.a.pointerOver,r,Object(z.a)(this,this.eWf,"onCellPointerOver"));
kh.a.instance.ob(Xc.a.pointerDown,r,Object(z.a)(this,this.Lmn,"onCellPointerDown"))}}dWf(b){b=qb.rTd(b.yf);this.jI.Zrb(this.vk);this.ooe(b,!0);return!0}Jmn(b){this.ooe(qb.rTd(b.yf),!1);return!0}ooe(b,h){h?(this.Dv=parseInt(b.getAttribute("arrayPosition")),Af.a.$f(b,"cui-colorpicker-hoveredOver"),this.Bjg(b)):(this.Dv=-1,this.Eif(b),Af.a.Gw(b,"cui-colorpicker-hoveredOver"))}Kmn(b){3===b.kg&&this.gx(b.yf,b.kg,b.Hb);return!0}fWf(b){3!==b.kg&&this.gx(b.yf,b.kg,b.Hb);return!0}eWf(b){this.a9e(!1);b=parseInt(qb.rTd(b.yf).getAttribute("arrayPosition"));
this.I9c(b);return!0}Lmn(){return!1}Bjg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!lf.b(h)){const r=this.Sd;r.Color=b[la.ColorPicker.pHd];this.root.executeCommand(h,r,this.vk,0,!1)}}}Eif(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!lf.b(h)){const r=this.Sd;r.Color=b[la.ColorPicker.pHd];this.root.executeCommand(h,r,this.vk,0,!1)}}}gL(b){b=bm.Control.umf(this.Dv,this.GCb.width,this.OOa.length,b);if(b!==this.Dv&&this.I9c(b))return!0;this.ooe(this.OOa[this.Dv],
!1);return!1}mZ(){return this.I9c(0)}I9c(b){return this.OOa&&this.OOa.length>b&&(b=this.OOa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}yqa(){-1!==this.Dv&&this.ooe(this.OOa[this.Dv],!1)}static rTd(b){return qb.f6l(b)}static f6l(b){var h=["td"];const r=h.length;if(!b)return null;for(var B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;for(b=b.parentNode;b;){for(B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;b=b.parentNode}return null}}Object(n.a)(qb,"ColorPickerBehavior",
Tg,[]);var ac=c(342),yc=c(298),$c=c(1702),Vd=c(698),me=c(375),Md=c(1146);class Re{constructor(b,h){this.Pmk=b;this.s0g=h}bhe(b,h,r,B){if(lf.c(b)||lf.c(h))return null;const P=new Md.a;const ca=B.x;var ra=B.y;const Qa=B.width;var mb=B.height;let Jb;Re.$6b(h,"flyoutWidth");B=Re.$6b(h,"flyoutRealHeight");const Yb=Re.$6b(h,"viewportWidth");var fc=Re.$6b(h,"viewportHeight"),Mc=Re.$6b(h,"viewableLeft");const Wc=Re.$6b(h,"viewableTop"),id=this.Pmk;let Id=!1,ve=!1;const $d=1===r,be=4===r,he=this.s0g;b.style.maxHeight=
"none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Jb=this.JOi(b);P.HKj=fc;P.Zrg=Yb;if($d)id?h=ca+Qa:(h=ca-Jb,P.vmb=!0),mb=ra;else{var re="";Qa>Jb&&(Jb=Qa,re=(Jb-2*me.Menu.V4d).toString());id?h=ca:(h=ca+Qa-Jb,P.vmb=!0);mb=ra+mb;""!==re&&(b.style.minWidth=re+"px")}he&&(mb+=Wc,h+=Mc);b.style.top=mb+"px";b.style.left=h+"px";let Xf=!1;re=!1;Jb<=Yb?h+Jb>Mc+Yb?($d&&id&&ca-Jb>Mc||be&&ca-Jb>Mc?(h=ca-Jb,he&&(h+=Mc),re=P.vmb=!0):(h=Mc+Yb-Jb,Id=!0),Xf=!0):h<Mc&&($d&&!id&&ca+Qa+Jb<Mc+Yb?
(h=ca+Qa,he&&(h+=Mc),P.vmb=!1,re=!0):(h=Mc,ve=!0,P.vmb=!0),Xf=!0):id?(h=Mc,Xf=!0,P.vmb=!0):(h=Mc+Yb-Jb,Xf=!0,P.vmb=!1);Xf&&(b.style.left=h+"px");P.P8b=mb;mb+B<=Wc+fc&&3!==r||(P.UKf=!0,{whn:r,PHl:ra,HNm:fc,KUm:Mc}=this.Ulf(r,mb,B,ra,Wc,fc),mb!==r&&(b.style.top=r+"px",P.P8b=r),-1<ra&&(b.style.maxHeight=ra+"px"),fc&&(b.style.bottom="0px",b.style.height="auto"),Mc&&this.B$m(b,id,$d,re,ve,Id,Yb,ca,Qa));P.ZOc=h;P.qmf=Jb;P.mmf=B;return P}Ulf(b,h,r,B,P,ca){let ra,Qa,mb;ra=-1;mb=Qa=!1;const Jb=h,Yb=P+ca-h;
h=B-r;const fc=this.s0g;let Mc=!1;0>h&&(h=P);fc||(B-=P);r<=B&&1!==b||(4===b||1===b?r<ca?(h=ca-r,Qa=!0):(h=P,Mc=mb=Qa=!0):(B<Yb&&3!==b?(h=Jb,Qa=!0):ra=B,mb=!0));fc&&(Qa=!1,Mc?ra=ca:h+=P);return{whn:h,PHl:ra,HNm:Qa,KUm:mb}}B$m(b,h,r,B,P,ca,ra,Qa,mb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ca||B)b.style.left="",b.style.right=(ca?0:ra-Qa)+"px"}else P||B||(b.style.left="",b.style.right=(r?ra-Qa:ra-Qa-mb)+"px")}qWl(b){const h={};if(lf.c(b))return h;h.viewportWidth=Kb.a.yHb();h.viewportHeight=
Kb.a.kY();lf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);lf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;lf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);lf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,
h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*me.Menu.V4d:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.JOi(b);b.style.overflowY=r;return h}JOi(b){return b.offsetWidth}static $6b(b,h){return lf.c(b)?0:b[h]}}Object(n.a)(Re,"MenuPositioner",null,[]);var We=c(513),bg=c(612),yf=c(1148),Rf=c(1147),bf=c(1144),pl=c(1145),il=c(1150),Sk=c(387),Vj=c(996);class Ch extends Tg{constructor(b){super(b);this.YKe=
0;this.u4g=null;this.wOe=-1;this.Wkd=null;this.K1f=this.kYg=!1;this.Ebk=new Re(0===this.root.U1,Af.a.hs(this.root.properties.DivSyndicated))}get ZOi(){return this.Ebk}get Wu(){return this.control}get properties(){return this.control.Ih}get menu(){return this.Wu.menu}set menu(b){this.Wu.menu=b}get xL(){return this.Wu.xL}set xL(b){this.Wu.xL=b}get ixh(){lf.c(this.Wkd)&&(this.Wkd=Ch.Abl());return this.Wkd}get yrj(){let b=!this.root.mBf;Object(uc.a)(357,this.root)&&1===this.root.JLb&&(b=!0);return b}gx(b,
h){Object(uc.a)(357,this.root)&&this.root.Yif();this.Wu.U0(h)}U0(b){if(this.Wu.enabled&&!this.xL){var h=Ih.a.instance.Fp(eb.a.U0);h.properties.add("Id",this.Wu.Ih.Id);h.properties.add("InputMethod",ac.a[b]);h.end();Me.a.mark(10326);Qd.a.T4d(this.Wu.Ih.Id,"MenuOpen");this.Wu.Ou&&(this.Wu.lha=Qd.a.Pib(this.Wu.Ou.ownerDocument));this.YKe=b;this.b3i(b);this.qge();this.Wu.v9a(this.Wu.Ou,!0)}}qge(){lf.c(this.properties.PopulateAsyncTriggerCommand)||this.kYg||(this.gjn(),this.kYg=!0)}gjn(){const b={};b[$c.a.Callback]=
Object(z.a)(this,this.x9i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.vk,0,!1)}x9i(){this.Wu.OTa()}OTa(){this.xL&&this.b3i(this.YKe,!0)}b3i(b,h=!1){var r=!0;if(Af.a.hs(this.properties.PopulateDynamically)){r=!1;const B=this.i4c(b);B!==this.u4g&&(r=this.$1f(B,h));r=r||!this.xL}r&&(h=v.AFrameworkApplication.ta.Kq,r=null,h&&(r=h.Yf("LoadResource","Menu Initialization")),this.kGa(b),r&&r.stop(),this.f8d())}kGa(b){if(!lf.c(this.menu)){if(this.Wu.G6a){var h=
this.Wu.vk;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.menu.Mmo(String.format("{0} {1}",this.Wu.G6a,h.keytip.bif),this.Wu.rTa&&""!==this.Wu.rTa?String.format("{0}-{1}",this.Wu.rTa,r):r)}}this.menu.noa();Af.a.$f(this.menu.Nc,this.Wu.f1e);Af.a.k6(this.menu.Nc,"cui-touch",3===b||this.root.Xme);if(this.menu.hasItems()){this.menu.eJ();h=this.vk;h.HXh();h.mUc=!0;h.Bf(this.menu);h.mUc=!1;this.menu.Y2i();r=Object(uc.a)(Vj.a,this.root);var B=null,P=!1;r&&(B=this.root,P=B.o8a,B.o8a=!1);var ca=
this.menu.Nc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";ba.a.ht&&!ba.a.ylb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.$Ak();this.QFn(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.mrk();Af.a.$f(this.Wu.NKb,jn.MenuLauncher.L0c);var ra=this.root.JLb;this.vto&&this.root.Fga(this.control,!0);ca.style.zIndex=String(v.AFrameworkApplication.ta.Fua);this.root.Vtk(this.Wu);this.menu.Hra=ra;ca.style.visibility=
"visible";ra=this.$6h();if(Object(uc.a)(pl.a,this.menu)){ca.style.position="fixed";const Qa=this.root.dD[0];Qa&&Qa.menu&&Qa.menu.Nc?100!==Qd.a.DRc(this.root.dD[0].menu.Nc)&&yc.a.Nhg(ca,ra,Object(z.a)(this,this.q1e,"afterShowMenu")):yc.a.Nhg(ca,ra,Object(z.a)(this,this.q1e,"afterShowMenu"))}else yc.a.Nhg(ca,ra,Object(z.a)(this,this.q1e,"afterShowMenu"));this.xL=!0;this.menu.TKf=!0;!ba.a.vi&&this.Wu.Feo&&this.menu.setFocus(b);r&&(B.o8a=P);r=this.properties.CommandMenuOpen;lf.b(r)||this.root.executeCommand(r,
null,h,b,!1)}}Me.a.mark(10327)}f8d(){}mrk(){this.wOe=Af.a.mCb(this.wOe);this.wOe=window.setTimeout(Object(z.a)(this,this.nrk,"addAndPositionBackFrameInternal"),50)}nrk(){this.menu&&this.menu.Nc&&(document.body.appendChild(this.ixh),this.MFn())}MFn(){const b=this.ixh;var h=this.menu.Nc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;ba.a.ylb&&(r-=
4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get vto(){return this.root.JLb?!1:!0}q1e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Nc===b.element&&Object(uc.a)(bf.a,this.menu)&&yc.a.TCk(this.$6h()))}$6h(){const b=this.menu.children,h=[];if(Object(uc.a)(bf.a,this.menu))for(let r=0;r<b.count;r++){const B=b.J(r);Array.add(h,B.separator);for(let P=0;P<B.children.count;P++){const ca=B.children.J(P);Array.add(h,
ca.Nc)}}return h}$Ak(){var b=this.menu.children;for(let r=0;r<b.count;r++){const B=b.J(r).children;for(let P=0;P<B.count;P++){var h=B.J(P);if(Object(uc.a)(Ym.a,h)){const ca=h;if("Menu32"===ca.mU||"Menu48"===ca.mU)h=h.control,h.behavior&&(Object(uc.a)(bg.a,h)||Object(uc.a)(Rf.a,h))&&h.behavior.WAk()}}}0<b.count&&(b=b.J(0),lf.c(b.separator)||(b.separator.style.display="none"),lf.c(b.Cme)||Af.a.$f(b.Cme,"cui-menusection-titleAtTop"))}QFn(b){if(!lf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom=
"";b.style.right="";b.style.width="";b.style.minWidth="";var h=Vd.a.create();try{const r=this.ZOi.qWl(b),B=this.nRc();let P=this.root.bhe(b,r,this.Wu.W4d,B);P||(P=this.ZOi.bhe(b,r,this.Wu.W4d,B));this.root.$Oi=P}finally{h&&h.dispose()}}}nRc(){const b=Qd.a.getElementBounds(this.Wu.NKb);var h=this.jI;lf.c(h)||lf.c(h.Nc)||(h=Qd.a.getElementBounds(h.Nc),b.x=h.x+me.Menu.V4d,b.width=h.width-2*me.Menu.V4d);Object(uc.a)(Sk.a,this.Wu.G2d)&&(b.height=0);return b}nva(){if(this.Wu.xL){t.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Wu.Ih.Id});this.menu.yqa();this.Waj();this.xL=!1;this.menu.TKf=!1;this.root.ica(this.control,!0);this.yrj?v.AFrameworkApplication.ta.b8c(this.Wu.lha,this.YKe):this.B8n();this.Wu.lha=null;var b=this.Wu.NKb;Af.a.Gw(b,jn.MenuLauncher.L0c);this.Wu.v9a(this.Wu.Ou,!1);Af.a.Gw(b,"cui-ctl-menu-hovered-without-focus");this.menu.dra();lf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.vk,0,!1);this.Vaj()}}B8n(){const b=
this.Wu.lha;if(b)try{b.focus()}catch(h){}}Vaj(){Kb.a.rx(this.menu.Nc);Kb.a.rx(this.Wkd);Af.a.oAa(this.menu.Nc)}i4c(b){if(this.K1f&&Af.a.hs(this.properties.PopulateOnlyOnce)||lf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Wu.xpf();return 0<(this.root.Qqa(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}$1f(b,h=!1){if(this.K1f&&Af.a.hs(this.properties.PopulateOnlyOnce))return!0;let r=null;this.u4g=
b;lf.c(b)||(r=this.Lcl(b));lf.c(r)||(this.K1f=!0);if(h){this.root.kZk(this.Wu);if(lf.c(r)||!r.hasItems())return this.nva(),!1;this.Waj();this.Vaj()}this.Plo(r);return!0}tVi(){}Lcl(b){b=We.Builder.yKh(b);if(!lf.c(b)){const h=new il.a;h.UFh=!0;h.parentId=this.control.id;let r;r=Object(uc.a)(yf.a,this.control);return this.root.vO.i0a(b,h,r)}return null}Plo(b){lf.c(b)||(lf.c(this.menu)||this.menu.dispose(),this.menu=b,this.tVi())}Waj(){const b=this.menu.parent;b?(b.mUc=!0,b.removeChild(this.menu.id),
b.mUc=!1):t.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;lf.c(b.Hb)||lf.c(b.Hb.rawEvent)||Object(uc.a)(Ym.a,this.vk)||!b.Hb.rawEvent.altKey||b.Hb.keyCode!==Sys.UI.Key.down||(this.gx(b.yf,1,b.Hb),h=!0);h||(h=super.onKeyDown(b));return h}fD(b){this.W9e();2===b.kg&&b.Ada!==Sys.UI.MouseButton.leftButton||this.gx(b.yf,b.kg,b.Hb);b.Hb.preventDefault();return!1}Ayf(b){if(!this.jI||!this.jI.inKeytipMode||!this.Wu.GWi)return!1;this.Wu.GWi(this.vk,
b);return!0}static Abl(){const b=Af.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(n.a)(Ch,"MenuLauncherBehavior",Tg,[737,719]);var Qn=c(931);class zh extends Ch{constructor(b){super(b)}get rt(){return this.RMc.properties}get RMc(){return this.control}get rPa(){return this.RMc.rPa}eJ(){kh.a.instance.ob(Xc.a.pointerDown,this.rPa.Xm,Object(z.a)(this,this.fD,"onPointerDown"));Tb.KeyInputManager.instance.ob(Xc.a.gi,this.rPa.Xm,
Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,this.rPa.Xm,Object(z.a)(this,this.Wy,"onKeyUp"))}Gm(){const b=this.Sd[Qn.a.SelectedItemId];if(0<(this.yu(this.rt.Command,this.rt.QueryCommand,this.Sd)&2)){const h=this.Sd[Qn.a.SelectedItemId];lf.c(h)||b===h||this.RMc.$8c(h)||(this.Sd[Qn.a.SelectedItemId]=null)}}}Object(n.a)(zh,"DropDownBehavior",Ch,[]);var gk=c(527),sk=c(713);class wl extends zh{constructor(b){super(b);this.wXa=null;this.HLe=this.hwb=this.aCa=!1;
this.nBc=null;this.lBc=-1}get h4(){return this.control}get UQ(){return this.h4.UQ}get LH(){return this.h4.LH}get x_d(){return this.Sd[gk.a.IsFreeForm]}set x_d(b){this.Sd[gk.a.IsFreeForm]=b}eJ(b){kh.a.instance.ob(Xc.a.pointerDown,b.Xm,Object(z.a)(this,this.fD,"onPointerDown"));const h=b.xr;cd.a.instance.ob(Xc.a.focus,h,Object(z.a)(this,this.Unb,"onInputFocus"));cd.a.instance.ob(Xc.a.blur,h,Object(z.a)(this,this.Aya,"onInputBlur"));Tb.KeyInputManager.instance.ob(Xc.a.gi,h,Object(z.a)(this,this.vqn,
"onInputKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.tu,h,Object(z.a)(this,this.wqn,"onInputKeyPress"));Ye.a.instance.ob(Xc.a.Cda,h,Object(z.a)(this,this.uXf,"onInputMouseUp"));kh.a.instance.ob(Xc.a.pointerDown,h,Object(z.a)(this,this.yqn,"onInputPointerDown"));kh.a.instance.ob(Xc.a.pointerDown,b.nWh,Object(z.a)(this,this.SXf,"onMenuButtonPointerDown"))}Gm(){0<(this.yu(this.LH.Command,this.LH.QueryCommand,this.Sd)&2)&&(this.hwb||this.NIj(),this.XWo())}tVi(){this.h4.menuItems=null;var b;var h=b=
null;if(!lf.c(this.menu)){this.Fge();for(let B of this.menu.children)for(let P of B.children)if(Object(uc.a)(Ym.a,P)){var r=P;r=r.control;Object(uc.a)(733,r)&&(b=r,b=b.Ih.MenuItemId);Object(uc.a)(716,r)&&(h=r,h=h.m3a());lf.c(b)||lf.c(h)||(this.h4.menuItems[h]=b,b=h=null)}}}yqn(b){Object(uc.a)(357,this.root)&&2===b.kg&&(this.wXa=Qd.a.Pib(this.control.Ou.ownerDocument),this.control.Ou.focus());return!1}fD(b){this.W9e();let h=!1;3===b.kg&&(h=super.fD(b),this.Fge());h&&b.Hb.preventDefault();return!1}SXf(b){let h=
!1;if(2!==b.kg||b.Ada===Sys.UI.MouseButton.leftButton)this.gx(b.yf,b.kg,b.Hb),this.Fge(),h=!0;h&&b.Hb.preventDefault();return!1}vqn(b){let h=!1;if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;Af.a.hs(this.LH.AutoComplete);if(r===Sys.UI.Key.enter)this.bU(),this.S$f(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.tab){if(this.bU(),this.S$f(),Object(uc.a)(sk.Ribbon,this.root)&&(h=this.root.sqe(this.vk.Nc,!b)),Object(uc.a)(357,this.root))return!0}else r===
Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.control.enabled?(this.j7e(),this.nBc=null):h=!0:r===Sys.UI.Key.esc?(this.W$f(),this.S$f(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.down&&(this.U0(1),this.Fge(),h=!0)}return h}wqn(b){if(!this.control.enabled)return!0;!lf.c(b.Hb)&&b.Hb.charCode&&this.hkl();return!1}uXf(){return this.aCa?!1:this.aCa=!0}pzl(){this.lBc=-1;const b=this.UQ.xr,h=b.value,r=this.UYl(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,
b.value.length);else if(b.createTextRange){const B=b.createTextRange();B.moveStart("character",h.length);B.moveEnd("character",b.value.length);B.select()}this.nBc=r.value}else this.nBc=null}UYl(b){const h=this.h4.menuItems;for(let r in h){const B={key:r,value:h[r]};if(B.key.toLowerCase().startsWith(b.toLowerCase()))return B}return null}hkl(){Af.a.hs(this.LH.AutoComplete)&&-1===this.lBc&&(this.HLe&&(this.i4c(0),this.HLe=!1),this.lBc=window.setTimeout(Object(z.a)(this,this.pzl,"executeAutoComplete"),
this.h4.aJk))}j7e(){Af.a.hs(this.LH.AutoComplete)&&(this.lBc=Af.a.mCb(this.lBc))}Unb(b){if(this.xL)return this.menu.setFocus(0),!0;Object(uc.a)(357,this.root)&&(kb.FocusManager.instance().jD("ribbon"),this.root.yTc=!1);this.onFocus(b);this.hwb=!0;Af.a.$f(this.UQ.Xm,"cui-cb-focus");Af.a.hs(this.LH.PopulateDynamically)&&(this.HLe=!0);Qd.a.W8c(this.UQ.xr);lf.c(this.menu)||this.menu.Hm();return this.aCa=!1}Aya(){this.hwb=!1;this.bU();Af.a.Gw(this.UQ.Xm,"cui-cb-focus");return!1}S$f(){Object(uc.a)(357,
this.root)&&(void 0!==this.wXa&&null!==this.wXa&&v.AFrameworkApplication.ta.b8c(this.wXa,2),this.wXa=null)}bU(){if(this.control.enabled){this.j7e();var b=this.UQ.xr;if(void 0===this.Sd[gk.a.Value]||null===this.Sd[gk.a.Value]||b.value!==this.Sd[gk.a.Value].toString())if(this.h4.$8c(this.nBc))this.x_d=!1,this.Sd[gk.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.h4.e9c.WFb(),["MenuItemId"]:this.h4.e9c.Ih.MenuItemId},this.root.executeCommand(this.LH.Command,b,this.vk,0,!1);else{if(!Af.a.hs(this.LH.AutoComplete)){var h=
this.h4.menuItems[b.value];if(!lf.b(h)&&this.h4.$8c(h)){this.x_d=!1;this.Sd[gk.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.h4.e9c.WFb(),["MenuItemId"]:h};this.root.executeCommand(this.LH.Command,b,this.vk,0,!1);return}}h=!lf.b(b.value)&&""!==E.a.lza(b.value);this.h4.Wsh&&h?(this.x_d=!0,this.Sd[gk.a.Value]=b.value,this.root.executeCommand(this.LH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.vk,0,!1)):this.W$f()}}else this.W$f()}W$f(){this.j7e();this.nBc=null;this.NIj()}NIj(){const b=
this.Sd[gk.a.Value]||"";b!==this.UQ.xr.value&&(this.UQ.xr.value=b);this.h4.$8c(this.h4.menuItems[b])}XWo(){const b=this.Sd[gk.a.FontStyle]||"normal";b!==this.UQ.xr.style.fontStyle&&(this.UQ.xr.style.fontStyle=b)}Fge(){this.control.Ou&&this.menu&&this.control.Ou.setAttribute(qf.a.dwh,this.menu.id)}}Object(n.a)(wl,"ComboBoxBehavior",zh,[]);class Rn extends Ch{constructor(b){super(b)}get CId(){return this.control}nRc(){let b=0;this.menu&&this.menu.Nc&&2===this.menu.horizontalAlignment&&(b=this.menu.Nc.clientWidth);
return new Sys.UI.Bounds(this.CId.x-b,this.CId.y,this.CId.WKf,this.CId.VKf)}}Object(n.a)(Rn,"ContextMenuLauncherBehavior",Ch,[]);class nk extends Ch{constructor(b){super(b)}get yLd(){return this.control}nRc(){return new Sys.UI.Bounds(this.yLd.x,this.yLd.y,this.yLd.WKf,this.yLd.VKf)}}Object(n.a)(nk,"DialogMenuLauncherBehavior",Ch,[]);var Zm=c(611);class uo extends Ch{constructor(b){super(b);this.KLe=!1;this.mkk=!Af.a.sia(this.rt.ShouldRefreshWhenDropped)}get iFa(){return this.control}get rt(){return this.control.Ih}eJ(b){b=
b.Xm;lf.c(b)||(cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),cd.a.instance.ob(Xc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),kh.a.instance.ob(Xc.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver")),Tb.KeyInputManager.instance.ob(Xc.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Tb.KeyInputManager.instance.ob(Xc.a.zh,b,Object(z.a)(this,this.Wy,"onKeyUp")),kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.fD,"onPointerDown")))}Gm(){lf.c(this.control.Ih.Command)||
(this.iFa.xL&&!this.mkk?this.KLe=!0:(0<(this.yu(this.rt.Command,this.rt.QueryCommand,this.Sd)&2)&&this.F9a()&&this.OVa(),Af.a.hs(this.rt.RefreshableMenu)&&this.xL&&this.menu.EEn()))}OVa(){this.UWo();this.Kka();this.JXo();this.iFa.WAf=this.Sd[Zm.a.ImageIsVisible]}UWo(){const b=Af.a.dsa(this.Sd[Zm.a.LabelText],this.rt.LabelText),h=this.Sd[Zm.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.rt.LabelTextUserGeneratedPlaceholderReplacements!==h)this.dF.medium&&this.VWo(this.dF.medium.QO,
b,h),this.root.a6a=!0,this.control.labelText=b,this.rt.LabelTextUserGeneratedPlaceholderReplacements=h}VWo(b,h,r){const B=b.lastChild;Af.a.wlj(b,h+" ",r);h=lf.c(B);t.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":B.nodeType.toString());h||b.appendChild(B)}JXo(){const b=this.Sd[Zm.a.ImageBackColor];this.dF.forEach(h=>{uo.ZEk(h.iR,b)})}U0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(v.AFrameworkApplication.hqa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),
v.AFrameworkApplication.va.processAction(eb.a.CLd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||v.AFrameworkApplication.va.processAction(eb.a.CLd,2);Object(uc.a)(Ym.a,this.vk)&&(this.xL||this.a9e(!0),this.control.enabled&&this.mZ());super.U0(b)}nva(){super.nva();this.KLe&&(this.KLe=!1,this.Gm())}JP(b){return this.control.cKb()?(this.iFa.xL?(this.root.gCh(),Af.a.$f(this.iFa.NKb,jn.MenuLauncher.L0c),this.iFa.lha=
this.control.Ou):(super.JP(b),this.gx(b.yf,b.kg,b.Hb)),!1):super.JP(b)}onKeyDown(b){let h=!1;if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){if(Object(uc.a)(Ym.a,this.vk)){const r=b.Hb.rawEvent,B=b.Hb.keyCode,P=0===this.root.U1;r.shiftKey||r.ctrlKey||!(B===Sys.UI.Key.right&&P||B===Sys.UI.Key.left&&!P)||(h=this.Ayf(b),h||(this.gx(b.yf,1,b.Hb),h=!0))}h||(h=super.onKeyDown(b))}return h}static ZEk(b,h){lf.c(b)||lf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(n.a)(uo,"FlyoutAnchorBehavior",
Ch,[]);var Ui=c(958);class er extends Tg{constructor(b){super(b)}get h9b(){return this.control}get properties(){return this.h9b.properties}get Qga(){return this.h9b.Qga}eJ(b){b=b.xEb;cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));kh.a.instance.ob(Xc.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver"));kh.a.instance.ob(Xc.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut"));Tb.KeyInputManager.instance.ob(Xc.a.gi,
b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,b,Object(z.a)(this,this.Wy,"onKeyUp"));kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.fD,"onPointerDown"));kh.a.instance.ob(Xc.a.kN,b,Object(z.a)(this,this.Eya,"onPointerUp"));hl.a.instance.ob(Xc.a.bQ,b,Object(z.a)(this,this.job,"onTouchMove"));hl.a.instance.ob(Xc.a.jK,b,Object(z.a)(this,this.VHa,"onTouchEnd"))}Gm(){const b=this.Sd[Ui.a.On],h=this.Sd[Ui.a.IsRtl];this.sIj();if(0<(this.yu(this.properties.Command,
this.properties.QueryCommand,this.Sd)&2)){var r=!lf.c(this.Sd[Ui.a.InnerHTML])||!lf.c(this.properties.InnerHTML),B=!lf.c(this.properties.Image);r||B||(this.control.enabled=!1);B=this.Qga.xEb;if(!lf.c(B)){if(r){r=Af.a.dsa(this.Sd[Ui.a.InnerHTML],this.properties.InnerHTML);if(null===B.innerHTML||null===r||E.a.eh(B.innerHTML)!==E.a.eh(r))B.innerHTML=r;""===r&&(this.control.enabled=!1)}r=B.title;const P=Af.a.dsa(this.Sd[Ui.a.Alt],this.properties.Alt);P===r||this.control.ygg||(B.title=P)}B=this.Sd[Ui.a.IsRtl];
b===this.Sd[Ui.a.On]&&h===B||this.control.WMb()}}sIj(){const b=this.Sd;b[Ui.a.CommandValueId]=this.control.WFb();b.MenuItemId=this.control.Ih.MenuItemId;b.SourceControlId=this.properties.Id}gx(b,h,r){if((b=this.vk)&&this.control.enabled){const B=this.root;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.uXc()&&this.jI){const P=B.dD[this.jI.Hra];P?P.tUa(this.h9b):t.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.sIj();
this.Sd[Ui.a.On]||(this.Sd[Ui.a.On]=!0,this.control.WMb());"Menu"===b.mU&&Af.a.Gw(this.Qga.Xm,"cui-gallerybutton-focused");B.executeCommand(this.properties.Command,this.Sd,b,h,!0,null,this.jY(r))}}onFocus(b){super.onFocus(b);Af.a.$f(this.Qga.Xm,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);Af.a.Gw(this.Qga.Xm,"cui-gallerybutton-focused");return!1}}Object(n.a)(er,"GalleryButtonBehavior",Tg,[]);var wh=c(1151),ql=c(1411),Tk=c(647);class Pi extends Tg{constructor(b){super(b);this.JYa=
-1}get Qbc(){return this.control}get properties(){return this.Qbc.Ih}get wJc(){return this.Qbc.wJc}get sAf(){var b=null;if(this.vk&&(b=this.vk.parent,!Object(uc.a)(Tk.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get EIb(){return this.Qbc.yYd.EIb}get l3c(){return this.Qbc.yYd.l3c}gx(b,h,r){if(this.control.enabled){b=this.Yrf(this.y9b(b));const B=this.$Qd(b);this.wJc[ql.a.Rows]=this.xUd(b)+1;this.wJc[ql.a.Columns]=B+1;this.root.executeCommand(this.properties.Command,
this.wJc,this.vk,h,!0,null,this.jY(r))}}eJ(b){var h=b.Xm;const r=b.UCh;b=b.cells;kh.a.instance.ob(Xc.a.pointerOut,h,Object(z.a)(this,this.Nnn,"onControlPointerOut"));hl.a.instance.ob(Xc.a.bQ,h,Object(z.a)(this,this.Pnn,"onControlTouchMove"));hl.a.instance.ob(Xc.a.jK,h,Object(z.a)(this,this.Onn,"onControlTouchEnd"));for(h=0;h<b.length;++h)this.zIk(r[h],b[h])}zIk(b,h){cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.dWf,"onCellFocus"));kh.a.instance.ob(Xc.a.pointerOver,h,Object(z.a)(this,this.eWf,
"onCellPointerOver"));kh.a.instance.ob(Xc.a.kN,h,Object(z.a)(this,this.fWf,"onCellPointerUp"));Tb.KeyInputManager.instance.ob(Xc.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,h,Object(z.a)(this,this.Wy,"onKeyUp"));hl.a.instance.ob(Xc.a.cQ,h,Object(z.a)(this,this.Mmn,"onCellTouchStart"))}Yrf(b){return parseInt(b.id.substr(this.Qbc.id.length+1))}Gmi(b){this.Fmi(this.Yrf(b))}xUd(b){return Math.floor(b/wh.a.M1c)}$Qd(b){return b%wh.a.M1c}Fmi(b){if(b!==this.JYa){var h=
this.$Qd(b),r=this.xUd(b),B=-1;let P=-1;-1!==this.JYa&&(B=this.xUd(this.JYa),P=this.$Qd(this.JYa));for(;B!==r||P!==h;)B<r?this.Knj(++B,P,!0):B>r?(this.Knj(B,P,!1),B--):P<h?this.jlj(++P,B,!0):P>h&&(this.jlj(P,B,!1),P--);this.sAf?this.sAf.yoj(this.K6h(r+1,h+1)):(r=(h=this.control.g$e)&&0<h.length?h[0]:null,B=this.vk,t.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!B,["DispCompPar"]:!!B&&!!B.parent}));
this.JYa=b}}Knj(b,h,r){for(let B=0;B<=h;B++)this.blj(b,B,r)}jlj(b,h,r){for(let B=0;B<=h;B++)this.blj(B,b,r)}blj(b,h,r){h=b*wh.a.M1c+h;b=this.EIb[h];h=this.l3c[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}fWf(b){this.gx(b.yf,b.kg,b.Hb);return!0}y9b(b){for(;b.hasChildNodes();)b=b.childNodes[0];return lf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}zoj(b){const h=this.Yrf(b);
b.childNodes[0].childNodes[0].title=this.K6h(this.xUd(h)+1,this.$Qd(h)+1)}K6h(b,h){let r=this.properties.Alt;lf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}Ojc(){if(this.vk){for(var b=0;b<wh.a.Hgc;b++)this.EIb[b].className="cui-it-inactiveCell",this.l3c[b].className="cui-it-inactiveCellOuter";this.JYa=-1;b=this.properties.MenuSectionInitialTitle;lf.c(b)&&(b="");this.sAf.yoj(b)}}eWf(b){this.control.enabled&&(b=this.y9b(b.yf),this.I9c(b),this.Igf(b));
return!1}Igf(b){this.zoj(b);this.Gmi(b)}dWf(b){if(!this.control.enabled)return!1;b=this.y9b(b.yf);this.zoj(b);this.Gmi(b);return!1}Nnn(b){Qd.a.vHf(this.Qbc.yYd.Xm,b.clientPoint)||this.Ojc();return!1}Mmn(b){if(!this.control.enabled)return!1;b=this.y9b(b.yf);this.Igf(b);return!0}Pnn(b){if(!this.control.enabled)return!1;b=Qd.a.ORd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=this.y9b(b))?this.Igf(b):this.Ojc();return!0}Onn(b){if(!this.control.enabled)return!1;var h=Qd.a.ORd(b.clientPoint);
if(!h||"table"===h.tagName.toLowerCase())return this.Ojc(),!0;(h=this.y9b(h))?this.gx(h,3,b.Hb):this.Ojc();return!0}gL(b){b=bm.Control.umf(this.JYa,wh.a.M1c,wh.a.Hgc,b);if(b!==this.JYa)return this.EIb[b].firstChild.focus(),this.Fmi(b),!0;this.Ojc();this.JYa=-1;return!1}mZ(){const b=this.EIb[0];if(lf.c(b))return!1;b.firstChild.focus();return!0}I9c(b){if(lf.c(b))return!1;b.firstChild.firstChild.focus();return!0}yqa(){this.Ojc()}}Object(n.a)(Pi,"InsertTableBehavior",Tg,[]);class nm extends Ch{constructor(b){super(b)}Gm(){this.control.enabled=
!!this.menu}gx(b,h,r){v.AFrameworkApplication.va.Qb(eb.a.nSa,2,h,this.jY(r))}}Object(n.a)(nm,"JewelMenuLauncherBehavior",Ch,[]);var Kj=c(1086);class Ar extends Tg{constructor(b){super(b)}get properties(){return this.control.Ih}Gm(){0<(this.yu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.F9a()&&this.OVa()}OVa(){this.f0o();this.Kka();this.bTb()}f0o(){const b=this.control.labelText;let h=this.Sd[Kj.a.Value];lf.c(h)&&(h=this.properties.LabelText,lf.c(h)&&(h=""));h!==b&&this.the(h)}eJ(b){b=
b.Xm;lf.c(b)||(kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.fD,"onPointerDown")),kh.a.instance.ob(Xc.a.pointerOver,b,Object(z.a)(this,this.JP,"onPointerOver")),kh.a.instance.ob(Xc.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut")))}}Object(n.a)(Ar,"LabelBehavior",Tg,[]);var ys=c(884),Hk=c(213),rp=c(305);class Rq extends Ch{constructor(b){super(b);this.UEe=this.Fwe=!1;this.WXb=this.xUb=null;if(this.yYb=v.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.xUb=this.zu.Tja.LightImage16by16Class,
this.WXb=this.zu.Tja.DarkImage16by16Class}get zu(){return this.control}t6d(b,h,r,B){h&&(this.zu.lha=r,v.AFrameworkApplication.ta.Z7a());if(Object(uc.a)(Hk.a,b)&&B){r=new ys.a;r.CommandLocation=this.root.A$;r.InvocationMethod=0;const P={};(b=b.control)&&b.Ih&&(P.CommandId=b.Ih.Command,P.ControlId=b.Ih.Id,P.CloseAllMenus=h,b.jI&&b.jI.parent&&b.jI.parent.id&&(P.ParentControlId=b.jI.parent.id.split("-")[0]),this.root.IF&&this.root.IF.FPa(B,P,r))}}nva(){this.zu.lha||(this.zu.lha=this.zu.Ny);!this.zu.wfn&&
this.yYb&&(Af.a.Gw(this.zu.Ny,"cui-sb-focus"),Af.a.Gw(this.zu.c2,"cui-sb-focus"),Af.a.Gw(this.zu.Dza,this.xUb),Af.a.$f(this.zu.Dza,this.WXb));this.Fwe=!0;super.nva();this.Fwe=!1;this.L5f()}get yrj(){return!this.zu.yTa}f8d(){this.zu.f8d()}Uce(){this.UEe||this.Fwe||(this.UEe=!0,this.zu.raiseEvent(rp.a.g4a,null))}L5f(){this.xL||this.zu.pCf||(this.UEe=!1,this.zu.raiseEvent(rp.a.WIb,null))}sXf(b){Af.a.Gw(this.zu.Ny,"cui-sb-focus");Af.a.Gw(this.zu.c2,"cui-sb-focus");this.yYb&&!this.zu.xL&&(Af.a.Gw(this.zu.Dza,
this.xUb),Af.a.$f(this.zu.Dza,this.WXb));this.zu.raiseEvent(rp.a.blur,b);this.L5f();this.zu.lha=this.zu.Ny;return!1}tXf(b){Af.a.$f(this.zu.Ny,"cui-sb-focus");Af.a.$f(this.zu.c2,"cui-sb-focus");this.yYb&&(Af.a.Gw(this.zu.Dza,this.WXb),Af.a.$f(this.zu.Dza,this.xUb));this.zu.raiseEvent(rp.a.focus,b);this.Uce();return!1}UYf(){this.yYb&&(Af.a.$f(this.zu.c2,"cui-sb-hover"),Af.a.$f(this.zu.Ny,"cui-sb-hover"),Af.a.Gw(this.zu.Dza,this.WXb),Af.a.$f(this.zu.Dza,this.xUb));return!1}TYf(){this.yYb&&(Af.a.Gw(this.zu.c2,
"cui-sb-hover"),Af.a.Gw(this.zu.Ny,"cui-sb-hover"),this.zu.xL||this.zu.pCf||(Af.a.Gw(this.zu.Dza,this.xUb),Af.a.$f(this.zu.Dza,this.WXb)));return!1}}Object(n.a)(Rq,"SearchBoxBehavior",Ch,[721,719]);class Fm{}Fm.Value="value";Fm.MinValue="MinValue";Fm.MaxValue="MaxValue";Fm.Text="Text";Object(n.a)(Fm,"SliderCommandProperties",null,[]);class Pr extends Tg{constructor(b){super(b)}get Dig(){return this.control}get W5(){return this.Dig.W5}get properties(){return this.control.Ih}initialize(){}gx(){}eJ(b){b=
b.xr;cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));cd.a.instance.ob(Xc.a.xIc,b,Object(z.a)(this,this.Hda,"onChange"));cd.a.instance.ob(Xc.a.input,b,Object(z.a)(this,this.Hda,"onChange"))}onFocus(b){this.W5.Xm&&Sys.UI.DomElement.addCssClass(this.W5.Xm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.W5.Xm&&Sys.UI.DomElement.removeCssClass(this.W5.Xm,"cui-sldr-onfocus");return super.onBlur(b)}Hda(){this.q3k(this.W5.xr.value);
return!0}q3k(b){this.Sd[Fm.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Sd,this.vk,0,!1)}Gm(){const b=this.Sd[Fm.Value],h=this.Sd[Fm.MaxValue],r=this.Sd[Fm.Text];var B=this.yu(this.properties.Command,this.properties.QueryCommand,this.Sd);this.W5&&this.W5.xr&&(this.W5.xr.disabled=!this.control.enabled);if(0<(B&2)){B=this.Sd[Fm.Value];const P=this.Sd[Fm.MaxValue],ca=this.Sd[Fm.Text];(P!==h||B!==b||r!==ca)&&this.W5&&this.W5.xr&&(this.W5.xr.setAttribute(qf.a.ZDd,String.format("{0}",
P)),this.W5.xr.setAttribute("max",String.format("{0}",P)),this.W5.xr.value=B,this.W5.QO.innerText=this.Sd[Fm.Text])}}}Object(n.a)(Pr,"SliderBehavior",Tg,[]);var Gg=c(1405);class mj extends Tg{constructor(b){super(b);this.Jsd=0;this.zeb=null;this.eqd=!1;this.Slh=null;this.XTe=!1;this.Jvd=this.eud=-1;this.aCa=!1}get spinner(){return this.control}get dH(){return this.spinner.dH}get properties(){return this.control.Ih}initialize(){const b=this.spinner.Brg;this.Slh=this.NSo(b);this.Jsd=b[0].min;this.zeb=
b[0];this.eqd=!1}gx(){}eJ(b){const h=b.xr,r=b.L7b;b=b.cNc;cd.a.instance.ob(Xc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Tb.KeyInputManager.instance.ob(Xc.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.tu,h,Object(z.a)(this,this.$G,"onKeyPress"));Tb.KeyInputManager.instance.ob(Xc.a.zh,h,Object(z.a)(this,this.Wy,"onKeyUp"));cd.a.instance.ob(Xc.a.xIc,h,Object(z.a)(this,this.Hda,"onChange"));
Ye.a.instance.ob(Xc.a.Cda,h,Object(z.a)(this,this.uXf,"onInputMouseUp"));kh.a.instance.ob(Xc.a.pointerDown,r,Object(z.a)(this,this.eUi,"onArrowPointerDown"));kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.eUi,"onArrowPointerDown"));kh.a.instance.ob(Xc.a.kN,r,Object(z.a)(this,this.fUi,"onArrowPointerUp"));kh.a.instance.ob(Xc.a.kN,b,Object(z.a)(this,this.fUi,"onArrowPointerUp"));hl.a.instance.ob(Xc.a.bQ,r,Object(z.a)(this,this.hUi,"onArrowTouchMove"));hl.a.instance.ob(Xc.a.bQ,b,Object(z.a)(this,
this.hUi,"onArrowTouchMove"));hl.a.instance.ob(Xc.a.jK,r,Object(z.a)(this,this.gUi,"onArrowTouchEnd"));hl.a.instance.ob(Xc.a.jK,b,Object(z.a)(this,this.gUi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Af.a.$f(this.dH.Xm,"cui-spn-focus");this.control.enabled&&Qd.a.W8c(this.dH.xr);return this.aCa=!1}onBlur(b){super.onBlur(b);Af.a.Gw(this.dH.Xm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||
r===Sys.UI.Key.down)this.root.GEf(this.control)||this.ewj(r===Sys.UI.Key.up,b.kg),h=!0;else if(r===Sys.UI.Key.enter)this.bU(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.tab)this.bU(),Object(uc.a)(sk.Ribbon,this.root)&&(h=this.root.sqe(this.vk.Nc,!B));else if(r===Sys.UI.Key.esc)this.Qjc(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}$G(){return!this.control.enabled}Wy(){this.Eil();
return!1}Hda(){this.bU();return!1}uXf(){return this.aCa?!1:this.aCa=!0}eUi(b){var h=!1;let r=!0;2===b.kg&&(r=b.Ada===Sys.UI.MouseButton.leftButton);r&&(h=b.yf,this.ewj(h===this.dH.L7b||h===this.dH.yWh||h===this.dH.xWh,b.kg),h=!0);return h}fUi(b){return this.Sva(b)}hUi(b){return this.U6d(b)}gUi(b){return this.Sva(b)}Hym(b){if(this.control.enabled){var h=!1;if(!this.eqd){var r=this.q1l(b);r=b?r+this.zeb.step:r-this.zeb.step;r=Math.min(r,this.zeb.max);r=Math.max(r,this.zeb.min);r!==this.Jsd&&(this.V9e(r,
this.zeb),this.root.executeCommand(this.properties.Command,this.Sd,this.vk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Sd,r.Increment=b,lf.c(h)||this.root.executeCommand(h,r,this.vk,0,!1))}}q1l(b){const h=Math.pow(10,v.AFrameworkApplication.numberFormat.B6d),r=Math.round(this.zeb.step*h);let B=Math.round(this.Jsd*h)/r;B=b?Math.floor(B):Math.ceil(B);return B*r/h}ewj(b,h){if(this.control.enabled){this.bU();const r=b?this.dH.L7b:this.dH.cNc;switch(h){case 2:case 3:this.XTe=b;this.BBd(r);break;
case 1:this.XTe=b,this.Qqk(r)}}}Kwj(){this.hCh();this.hUk()}mRh(){-1===this.eud&&(this.eud=window.setTimeout(Object(z.a)(this,this.z4n,"repeatSpin"),500))}hCh(){this.eud=Af.a.mCb(this.eud)}z4n(){this.hCh();-1===this.Jvd&&(this.lke(),this.Jvd=window.setInterval(Object(z.a)(this,this.lke,"spin"),50))}hUk(){this.Jvd=Af.a.dUk(this.Jvd)}lke(){this.Hym(this.XTe)}Qqk(b){this.root.Fga(this.control,!1);Af.a.$f(b,bm.Control.EBd);this.lke();this.mRh()}Eil(){this.root.ica(this.control,!1);this.Kwj();Af.a.Gw(this.dH.L7b,
bm.Control.EBd);Af.a.Gw(this.dH.cNc,bm.Control.EBd)}plc(b){this.dH.xr.value!==b&&(this.dH.xr.value=b)}Qjc(){this.plc(this.Sd[Gg.a.Text])}zlj(b){this.plc(b);this.Sd[Gg.a.Text]=b;this.eqd=!0}pio(b,h,r){this.plc(r);this.Sd[Gg.a.Text]=r;this.Sd[Gg.a.Number]=b;this.Sd[Gg.a.UnitType]=h.type;this.Jsd=b;this.zeb=h;this.dH.xr.setAttribute(qf.a.z3e,r);this.dH.xr.setAttribute(qf.a.kwh,String.format("{0}",h.min));this.dH.xr.setAttribute(qf.a.ZDd,String.format("{0}",h.max));this.eqd=!1}LHh(b){var h;if(({Jin:h}=
this.KVm(b)).returnValue)this.zlj(h);else{({number:b,r9a:h}=E.a.n1i(b,this.Slh,v.AFrameworkApplication.numberFormat));let r=this.aoe(h);0===h&&lf.c(r)&&(r=this.aoe(this.Sd[Gg.a.UnitType]));this.V9e(b,r)}}V9e(b,h){b=this.pUf(b,h);if(isNaN(b)||lf.c(h))this.Qjc();else{const r=v.AFrameworkApplication.numberFormat;let B;B=E.a.mFa(b,h.type,r);B=B.replace(6===h.type?r.C6d:r.U0f,"");this.pio(b,h,B)}}KVm(b){let h,r=!1;h="";b=b.trim();const B=this.spinner.UJj;if(!lf.c(B))for(let P=0;P<B.length;P++)if(B[P].toLowerCase()===
b.toLowerCase()){h=B[P];r=!0;break}return{returnValue:r,Jin:h}}pUf(b,h){return isNaN(b)||lf.c(h)?Number.NaN:h.pUf(b)}aoe(b){let h=null;const r=this.spinner.Brg;for(let B=0;B<r.length;B++)if(r[B].type===b){h=r[B];break}return h}NSo(b){const h=b.length,r=Array(h);for(let B=0;B<h;B++)r[B]=b[B].type;return r}bU(){if(this.control.enabled){const b=this.Sd[Gg.a.Text],h=this.dH.xr.value;h!==b&&(this.LHh(h),this.Sd[Gg.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Sd,this.vk,0,!1))}else this.Qjc()}Gm(){var b=
this.Sd[Gg.a.Text],h=this.Sd[Gg.a.Number];const r=this.Sd[Gg.a.UnitType],B=this.Sd[Gg.a.MaxValue];if(0<(this.yu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)){const P=this.Sd[Gg.a.Text],ca=this.Sd[Gg.a.Number],ra=this.Sd[Gg.a.UnitType],Qa=this.Sd[Gg.a.MaxValue];Qa!==B&&(this.aoe(ra).max=Qa,this.dH.xr.setAttribute(qf.a.ZDd,String.format("{0}",Qa)));P!==b?""===P?this.zlj(P):this.LHh(P):isNaN(ca)||ca===h&&ra===r||this.V9e(ca,this.aoe(ra));b=this.dH.Xm.title;h=Af.a.dsa(this.Sd[Gg.a.Alt],
this.properties.Alt);h!==b&&(this.dH.xr.title=h,this.dH.L7b.title=h,this.dH.cNc.title=h)}}wZe(b){super.wZe(b);b?(this.lke(),this.mRh()):this.Kwj()}}Object(n.a)(mj,"SpinnerBehavior",Tg,[720,719]);var tk=c(408),zn=c(897);class Yk extends Ch{constructor(b){super(b);this.vZb=!0;this.vtb=!1}get Z5(){return this.control}get rt(){return this.Z5.properties}eJ(b){const h=b.Xm,r=b.Jhb;b=b.eNc;cd.a.instance.ob(Xc.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Tb.KeyInputManager.instance.ob(Xc.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,h,Object(z.a)(this,this.Wy,"onKeyUp"));ba.a.Nt&&16>this.bXl()&&(kh.a.instance.ob(Xc.a.pointerDown,h,Object(z.a)(this,this.$Yi,"onSplitbuttonPointerDownPointerUp")),kh.a.instance.ob(Xc.a.kN,h,Object(z.a)(this,this.$Yi,"onSplitbuttonPointerDownPointerUp")));kh.a.instance.ob(Xc.a.pointerOver,r,Object(z.a)(this,this.xmn,"onButtonPointerOver"));kh.a.instance.ob(Xc.a.pointerOut,
r,Object(z.a)(this,this.wmn,"onButtonPointerOut"));kh.a.instance.ob(Xc.a.pointerDown,r,Object(z.a)(this,this.wUi,"onButtonPointerDown"));kh.a.instance.ob(Xc.a.kN,r,Object(z.a)(this,this.xUi,"onButtonPointerUp"));hl.a.instance.ob(Xc.a.bQ,r,Object(z.a)(this,this.zmn,"onButtonTouchMove"));hl.a.instance.ob(Xc.a.jK,r,Object(z.a)(this,this.ymn,"onButtonTouchEnd"));kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.SXf,"onMenuButtonPointerDown"));kh.a.instance.ob(Xc.a.pointerOver,b,Object(z.a)(this,
this.wrn,"onMenuButtonPointerOver"));kh.a.instance.ob(Xc.a.pointerOut,b,Object(z.a)(this,this.vrn,"onMenuButtonPointerOut"))}gx(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.vtb&&(this.Z5.on=!this.Z5.on,b=this.Sd,b.CommandValueId=this.control.WFb(),this.root.executeCommand(this.rt.Command,b,this.vk,h,!0,null,this.jY(r))):this.vZb&&super.gx(b,h,r)}Wy(b){const h=b.Hb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Sd,b.CommandValueId=this.control.WFb(),this.root.executeCommand(this.rt.Command,
b,this.vk,1,!0),!0):super.Wy(b)}Gm(){const b=this.root.Qqa(this.rt.Command,this.rt.QueryCommand,this.Sd),h=0<(b&1);let r=!0;r=lf.c(this.rt.CommandMenuOpen)?h:0<(this.root.Qqa(this.rt.CommandMenuOpen,null,null)&1);if(r!==this.vZb||h!==this.vtb||(r||h)!==this.control.enabled)this.control.enabled=r||h,h!==this.vtb&&this.Kon(h),r!==this.vZb&&this.Lon(r),this.vZb=r,this.vtb=h;if(0<(b&2)){this.Kka();const B=Af.a.dsa(this.Sd[zn.a.LabelText],this.rt.LabelText);this.Sd[zn.a.ApplyLabelTextToControlOnly]?this.Z5.V8b(P=>
{P.Xm.title=B;P.Jhb.removeAttribute("title");P.eNc.removeAttribute("title")}):this.Z5.V8b(P=>{P.Jhb.title=B});this.Sd[zn.a.EnsureControlRoleIsButton]&&this.Z5.V8b(P=>{qf.a.kr(P.Xm,qf.a.uh,qf.a.Z3)});lf.c(this.Sd[zn.a.Visible])||this.F9a()&&this.OVa()}this.Z5.setState(this.Z5.on&&h)}OVa(){this.dqg();this.bTb();this.Kka()}Lon(b){this.Z5.V8b(h=>{Af.a.aqb(h.eNc,b)});this.U6c();this.vZb=b}Kon(b){this.Z5.V8b(h=>{Af.a.aqb(h.Jhb,b)});this.U6c();this.vtb=b}U6c(){const b=this.Z5.hjb();lf.c(b)||(Af.a.Gw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),Af.a.Gw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Af.a.Gw(b.childNodes[1],"cui-ctl-split-hovered-primary"),Af.a.Gw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}$Yi(b){if(0!==tk.a(b.Hb))return!1;let h=!1;b.eventName===Xc.a.pointerDown?h=this.wUi(b):b.eventName===Xc.a.kN&&(h=this.xUi(b));return h}wUi(b){let h=!1;const r=b.kg;switch(r){case 3:this.dwo()?this.gx(this.vk.Nc,r,b.Hb):this.BBd(this.Z5.$Th);h=!0;break;case 2:b.Ada===Sys.UI.MouseButton.leftButton&&
(this.BBd(this.Z5.$Th),h=!0)}h&&b.Hb.preventDefault();return!1}dwo(){const b=this.vk.mU;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}xUi(b){return this.Sva(b)}zmn(b){return this.U6d(b)}ymn(b){return this.Sva(b)}onFocus(b){super.onFocus(b);this.gAf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.U6c();return!1}xmn(){this.control.enabled&&this.vtb&&this.gAf(!0,this.Z5.on);return!1}wmn(){this.control.enabled&&this.vtb&&this.U6c();return!1}SXf(b){let h=!1;if(2!==b.kg||b.Ada===Sys.UI.MouseButton.leftButton)this.gx(b.yf,
b.kg,b.Hb),h=!0;h&&b.Hb.preventDefault();return!1}wrn(){this.control.enabled&&this.vZb&&this.gAf(this.Z5.on,!0);return!1}vrn(){this.U6c();return!1}gAf(b,h){const r=this.control.hjb();lf.c(r)||(Af.a.$f(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Af.a.$f(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}bXl(){var b=ba.a.A7b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(n.a)(Yk,"SplitButtonBehavior",Ch,[]);
var jl=c(1410);class fr extends Tg{constructor(b){super(b);this.hwb=this.aCa=!1;this.K2j=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Gea(){return this.textBox.Gea}get Plg(){return this.textBox.Ih}eJ(b){b=b.xr;cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Tb.KeyInputManager.instance.ob(Xc.a.gi,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.tu,b,Object(z.a)(this,this.$G,"onKeyPress"));Tb.KeyInputManager.instance.ob(Xc.a.zh,b,Object(z.a)(this,this.Wy,"onKeyUp"));cd.a.instance.ob(Xc.a.xIc,b,Object(z.a)(this,this.Hda,"onChange"));Ye.a.instance.ob(Xc.a.Cda,b,Object(z.a)(this,this.cTa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.hwb=!0;Af.a.$f(this.Gea.Xm,"cui-tb-focus");this.control.enabled&&Qd.a.W8c(this.Gea.xr);return this.aCa=!1}onBlur(b){this.hwb=!1;super.onBlur(b);Af.a.Gw(this.Gea.Xm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!lf.c(b.Hb)&&!lf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.bU(),Object(uc.a)(sk.Ribbon,this.root)&&(h=this.root.sqe(this.vk.Nc,!B))):r===Sys.UI.Key.enter?this.K2j&&(this.bU(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.esc?(this.Qjc(),Object(uc.a)(sk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.qva&&
(De.a.eCh(b.Hb),h=!1)}return h}$G(){return!this.control.enabled}Wy(){return!1}Hda(){this.bU();return!1}cTa(){return this.Gea.isEditable?this.aCa?!1:this.aCa=!0:(Qd.a.W8c(this.Gea.xr),!0)}plc(b){this.Gea.xr.value!==b&&(this.Gea.xr.value=b)}Qjc(){this.plc(this.Sd[jl.a.Text])}bU(){if(this.control.enabled&&this.Gea.isEditable){const b=this.Gea.xr.value;b!==this.Sd[jl.a.Text]&&(this.Sd[jl.a.Text]=b,this.root.executeCommand(this.Plg.Command,this.Sd,this.vk,0,!1))}else this.Qjc()}Gm(){const b=this.Sd[jl.a.Text];
if(0<(this.yu(this.Plg.Command,this.Plg.QueryCommand,this.Sd)&2)&&!this.hwb){const h=this.Sd[jl.a.Text];h!==b&&this.plc(h)}}}Object(n.a)(fr,"TextBoxBehavior",Tg,[718,719]);var sp=c(388);class ej extends Tg{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Ih}gx(b,h,r){this.control.enabled&&(Af.a.sia(this.properties.TogglesWhenExecuted)||this.toggle(),this.Sd.CommandValueId=this.toggleButton.WFb(),this.Sd.MenuItemId=this.toggleButton.Ih.MenuItemId,
this.Sd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Sd,this.vk,h,!Af.a.sia(this.properties.CloseMenuWhenExecuted),B=>{Af.a.hs(this.properties.UpdateHtmlPostToggle)&&(32===B?this.GAj():this.EAj())},this.jY(r)))}EAj(){this.Sd[Df.a.On]=!this.Sd[Df.a.On]}GAj(){this.toggleButton.setState(this.Sd[Df.a.On]);(this.toggleButton.wAa&&this.toggleButton.jpe||Af.a.hs(this.properties.UpdateHtmlPostToggle))&&this.OVa()}toggle(){this.EAj();Af.a.hs(this.properties.UpdateHtmlPostToggle)||
this.GAj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!lf.c(b.Hb)&&this.jI){const r=b.Hb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Hb.preventDefault()}return h}Gm(){lf.c(this.properties.MenuItemId)||(this.Sd.MenuItemId=this.properties.MenuItemId);0<(this.yu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.F9a()&&this.OVa()}OVa(){this.toggleButton.setState(this.Sd[Df.a.On]);this.uWo(Af.a.dsa(this.Sd[Df.a.DisplayMode],""));this.dqg();this.Kka();this.gYo();Df.a.Alt in
this.Sd&&this.bTb()}gYo(){const b=this.dF.Tec;if(b&&b.Khb){var h=Af.a.dsa(this.Sd[Df.a.Description],this.properties.Description);h!==b.Khb.innerText&&(b.Khb.innerText=h,b.QO&&!Object(uc.a)(sp.Jewel,this.root)&&(h=!lf.b(h),Af.a.k6(b.QO,"UIFontBold",h),Af.a.k6(b.QO,"cui-ctl-mediumlabel-nodescription",!h)))}}eJ(b){b=b.Xm;cd.a.instance.ob(Xc.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));cd.a.instance.ob(Xc.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));kh.a.instance.ob(Xc.a.pointerOver,b,Object(z.a)(this,
this.JP,"onPointerOver"));kh.a.instance.ob(Xc.a.pointerOut,b,Object(z.a)(this,this.TJ,"onPointerOut"));Tb.KeyInputManager.instance.ob(Xc.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Tb.KeyInputManager.instance.ob(Xc.a.zh,b,Object(z.a)(this,this.Wy,"onKeyUp"));kh.a.instance.ob(Xc.a.pointerDown,b,Object(z.a)(this,this.fD,"onPointerDown"));kh.a.instance.ob(Xc.a.kN,b,Object(z.a)(this,this.Eya,"onPointerUp"));ji.a.instance.ob(Xc.a.click,b,Object(z.a)(this,this.onClick,"onClick"));hl.a.instance.ob(Xc.a.bQ,
b,Object(z.a)(this,this.job,"onTouchMove"));hl.a.instance.ob(Xc.a.jK,b,Object(z.a)(this,this.VHa,"onTouchEnd"))}}Object(n.a)(ej,"ToggleButtonBehavior",Tg,[]);class Bp{constructor(b){this.ZZj=b;this.rBe={["Button"]:h=>new Qq(h),["FileMenuButton"]:h=>new Qq(h),["ColorPicker"]:h=>new qb(h),["ComboBox"]:h=>new wl(h),["ContextMenuControl"]:h=>new Rn(h),["ContextMenuLauncher"]:h=>new Rn(h),["DialogMenuLauncher"]:h=>new nk(h),["DropDown"]:h=>new zh(h),["FlyoutAnchor"]:h=>new uo(h),["GalleryButton"]:h=>new er(h),
["StatefulColorFlyoutAnchor"]:h=>new uo(h),["JewelMenuLauncher"]:h=>new nm(h),["Label"]:h=>new Ar(h),["Placeholder"]:h=>new Tg(h),["SearchBox"]:h=>new Rq(h),["Separator"]:h=>new Tg(h),["SplitButton"]:h=>new Yk(h),["StatefulColorSplitButton"]:h=>new Yk(h),["StatefulImageSplitButton"]:h=>new Yk(h),["TextBox"]:h=>new fr(h),["ToggleButton"]:h=>new ej(h)}}VWh(){this.rBe[bm.Control.Dti]=b=>new Pi(b)}uif(){this.rBe[bm.Control.fvj]=b=>new mj(b)}tPl(b){const h=this.rBe[b.controlType];(b=h?h(b):null)&&this.ZZj&&
b.Jvl();return b}static get instance(){return Bp._instance||(Bp._instance=new Bp(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Bp._instance=null;Object(n.a)(Bp,"ControlBehaviorFactory",null,[691]);var fj=c(997),uk=c(151);class vk extends jn.MenuLauncher{constructor(b,h,r,B){super(b,h,r,B);this.w5g=null;this.YNa=this.yFc=0;this.IF=null;this.Myc=this.Lyc=0;this.lh("Menu");this.enabled=!0}get x(){return this.yFc}get y(){return this.YNa}get VKf(){return this.Lyc}get WKf(){return this.Myc}get controlType(){return"DialogMenuLauncher"}a8a(){}v9a(){}xpf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.rt.DialogMoveCommand;b.DialogCloseCommand=this.rt.DialogCloseCommand;return b}j0m(b,h){this.yFc=b.x;this.YNa=b.y;this.Lyc=b.height;this.Myc=b.width;this.U0(h)}aR(b){this.w5g=Af.a.createElement("span");return new uk.a(b,this.w5g)}get rt(){return this.Ih}vva(b,h,r){return new vk(b,this.id,h,r)}}Object(n.a)(vk,"DialogMenuLauncher",jn.MenuLauncher,[]);var Wl=c(830);class wk extends fj.a{constructor(b,h){super(b,h);this.u$a=null}get AZe(){return this.u$a}get KSh(){return this.properties}get A$(){return 20}Hm(){super.Hm();
lf.c(this.Nc)&&this.RC();this.Nc=Af.a.XTa(this.Nc);this.sX(this.Nc);this.dirty=!1}UO(b){if(!Object(uc.a)(Wl.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}qbf(b,h,r,B){r=new me.Menu(this,h,r,B,null);b||(b={});b.CommandMenuOpen=this.KSh.CommandMenuOpen;b.CommandMenuClose=this.KSh.CommandMenuClose;b=new vk(this,h,b,r);this.CDb[h]=b;h=new Wl.a(this,"dock"+h);h.Bf(b.bR("Menu"));this.Bf(h);this.refresh()}vhg(b,h,r,B){const P=this.CDb[b];if(lf.c(P))throw Error.create('The dialog menu "'+
b+'" does not exist');P.j0m(new Sys.UI.Bounds(h,r,0,0),B);this.u$a=P.menu}b9e(b){b=this.CDb[b];lf.c(b)||(b.nva(),this.u$a=null)}g8d(){this.u$a=null}dispose(){const b=this.CDb;for(let h in b)b[h].dispose();super.dispose()}}Object(n.a)(wk,"DialogMenuRoot",fj.a,[]);class kn{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(n.a)(kn,"RootProperties",null,[]);class Gn extends kn{constructor(){super()}}Object(n.a)(Gn,"StandaloneRootProperties",kn,[]);class tm extends Gn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(n.a)(tm,"DialogMenuRootProperties",Gn,[]);class lo{constructor(){const b=new tm;b.ImageSideArrow=v.AFrameworkApplication.Ms;b.ImageSideArrowClass=ie.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Gd=new wk("DialogMenuRootId",b);this.Gd.IF=this;this.Gd.refresh();v.AFrameworkApplication.va.fb(eb.a.S1f,Gd.a.frame,Object(z.a)(this,this.S1f,"populateDialogMenu"),96)}get Y1(){return this.Gd}FPa(b,h,r,B,P=null){b=parseInt(b);B=v.AFrameworkApplication.va;
r&&(B.LC=r.CommandLocation,B.I0=r.InvocationMethod);h=B.Qb(b,2,h,P);this.Gd.refresh();return 32===h}VGa(b){return b?32===v.AFrameworkApplication.va.processAction(parseInt(b),1):!0}yu(){this.Y1.root.Gm()}qbf(b,h,r){const B={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};B.DialogMoveCommand=h;B.DialogCloseCommand=r;this.Y1.qbf(B,b,"","")}vhg(b,h,r,B){this.Y1.vhg(b,h,r,B)}b9e(b){this.Y1.b9e(b)}S1f(b,h,r,B,P){if(1===r)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',P.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',P.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");P.PopulationXML=b.toString();return 32}dispose(){this.Gd&&
(this.Gd.dispose(),this.Gd=null)}}Object(n.a)(lo,"DialogMenuRootUser",null,[322,10,654]);class Uo{constructor(b,h,r){this.dub=this.eyd=this.Pzc=this.El=null;this.$Ee=this.txd=!1;this.Tvc=b;this.ge=h;this.Bs=r;this.xYb=v.AFrameworkApplication.isRtl}get nBf(){return this.$Ee}xyl(b){b?(this.El=b,this.$Ee=!0,this.txd=!1,this.ge.capture(Object(z.a)(this,this.RZm,"keyEventHandler"),null),this.Bs.ob(Xc.a.pointerDown,this.Tvc,Object(z.a)(this,this.vic,"pointerDownHandler")),this.Pzc||this.Vcl(),this.El.appendChild(this.Pzc),
this.mBm()):t.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}dkf(){this.$Ee=!1;this.eyd=this.dub=null;this.K0n();this.R7f();this.El=null}R7f(){this.ge.releaseCapture();this.Bs.uc(Xc.a.pointerDown,this.Tvc,Object(z.a)(this,this.vic,"pointerDownHandler"))}mBm(){if(this.El.style.left.endsWith("px")&&this.El.style.right.endsWith("px"))this.dub=new Sys.UI.Point(vl.a.$Y(this.xYb?this.El.style.right:this.El.style.left),vl.a.$Y(this.El.style.top));else{const b=this.xYb?this.Tvc.offsetWidth-
(this.El.offsetLeft+this.El.offsetWidth+vl.a.$Y(this.El.style.marginRight)):this.El.offsetLeft-vl.a.$Y(this.El.style.marginLeft),h=this.El.offsetTop-vl.a.$Y(this.El.style.marginTop);this.foj(b,h);this.dub=new Sys.UI.Point(b,h)}this.eyd=this.dub}Vcl(){this.Pzc=ie.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}K0n(){this.Pzc.parentNode===this.El&&this.El.removeChild(this.Pzc)}RZm(b){if(!this.nBf)return!1;b.Hb.preventDefault();if(b.eventName===Xc.a.gi){const h=b.Hb.ctrlKey?
1:10;let r;switch(b.Hb.keyCode){case kc.a.w6:this.ogc(0,-1*h);break;case kc.a.Oea:this.ogc(0,1*h);break;case kc.a.npc:r=this.xYb?1:-1;this.ogc(r*h,0);break;case kc.a.lsb:r=this.xYb?-1:1;this.ogc(r*h,0);break;case kc.a.fKa:this.lQi(this.eyd.x,this.eyd.y);this.txd=!0;break;case kc.a.Rs:this.txd=!0}}b.eventName===Xc.a.zh&&this.txd&&this.dkf();return!0}vic(b){if(!this.nBf)return!1;b.Hb.preventDefault();this.dkf();return!0}ogc(b,h){this.lQi(this.dub.x+b,this.dub.y+h)}lQi(b,h){b=this.aBk(b,h);this.foj(b.x,
b.y);this.dub=b}foj(b,h){this.xYb?this.El.style.right=b+"px":this.El.style.left=b+"px";this.El.style.top=h+"px"}aBk(b,h){const r=this.xYb?vl.a.$Y(this.El.style.marginRight):vl.a.$Y(this.El.style.marginLeft),B=vl.a.$Y(this.El.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.Tvc.offsetWidth-this.El.offsetWidth-r),Math.min(Math.max(-B,h),this.Tvc.offsetHeight-this.El.offsetHeight-B))}}Object(n.a)(Uo,"KeyMoveAdapter",null,[655]);var $h=c(1140),gq=c(572);class Ql{get name(){return"CUI.Behavior"}wc(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(654,"Common.UI.IDialogMenuRootUser").ha().Ud(()=>new lo),b.register(655,"Common.IKeyMoveAdapter").ha().Ud(()=>new Uo(v.AFrameworkApplication.ta.Eoa(),Tb.KeyInputManager.instance,kh.a.instance)));b.register(gq.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Ud(()=>gq.a.instance)}init(){$h.a.qaf=Bp.instance;const b=gq.a.instance.Agj;for(let h=0;h<b.length;++h){const r=Object(Na.a)(656,b[h]);r&&r.zPa()}Qk.a.get_instance().oI(6)}dispose(){}static main(){L.a.instance.Gc(new Ql,
5)}}Object(n.a)(Ql,"CuiBehaviorPackage",null,[1,2]);class cm{constructor(b){const h=new Gn;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=ie.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=ie.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=ie.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=ie.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=
ie.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=ie.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=ie.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.feb=fj.a.ufl(h);this.feb.refresh()}get sea(){return this.feb}dispose(){this.feb.dispose()}}Object(n.a)(cm,"StandaloneRootController",null,[1072,10]);var Sq=c(1165),Gi=c(163);class Aq{constructor(b){this.nCc=b}create(b,h){const r=new Sys.StringBuilder;this.cLc(r,
b,h);this.Nbf(r,b);return r.toString()}rDb(b,h){const r=[];this.ycf(r,b,h);this.Obf(r,b);return r}cLc(b,h,r){switch(h.errorType){case 0:b.append(this.nCc.build());break;case 1:case 2:b.append(this.W5e(h,r))}}ycf(b,h,r){switch(h.errorType){case 0:b.push(this.nCc.Fzh());break;case 1:case 2:b.push(this.QNk(h,r))}}Nbf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Gi.a("btnIgrnoreSpellingError",(2===h.errorType?Mb.a.XJa:Mb.a.nxa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,
null));b.append("</Controls></MenuSection>")}Obf(b,h){const r=Object.assign(new Nf.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new ei.a,{ExternalId:h}));b.push(r)}W5e(b,h){b=this.TLl(b.suggestions,h);return 0<b.length?Gi.g("msUnknownWord",Gi.d(null,b),"Menu16"):Gi.g("msUnknownWord",Gi.d(null,[Gi.a("btnNoSuggestions",Mb.a.XJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}TLl(b,h){const r=[];if(b){const B=Math.min(h.length,
b.length);for(let P=0;P<B;++P)b[P]&&r.push(Gi.a("btnCorrectWord"+P,h[P].toString(),b[P]))}return r}QNk(b,h){const r=Object.assign(new Nf.a,{Id:"Suggestions",ControlList:[]});this.SLl(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new ei.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}SLl(b,h,r){if(b){const B=Math.min(h.length,b.length);for(let P=0;P<B;++P){if(!b[P])continue;const ca=Object.assign(new ei.a,{ExternalId:"btnCorrectWord"+P,Command:h[P].toString(),
LabelText:b[P]});r.push(ca)}}}}Object(n.a)(Aq,"DefaultProofingContextMenuCreator",null,[]);var Hn=c(718);class Cp{constructor(b,h){this.bSg=b;this.dUg=h;this.Fma=[Mb.a.qrb,Mb.a.rrb,Mb.a.srb,Mb.a.ZRb,Mb.a.$Rb]}create(b,h){return h?Object(uc.a)(Hn.a,h)?this.dUg.create(b,h,this.Fma):this.bSg.create(h,this.Fma):""}f6b(b,h){return h?Object(uc.a)(Hn.a,h)?this.dUg.rDb(b,h,this.Fma):this.bSg.rDb(h,this.Fma):null}}Object(n.a)(Cp,"ProofingContextMenuSectionFactory",null,[788]);class Sn{build(){const b=[Gi.a("btnDeleteRepeatedWord",
Mb.a.GEa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Gi.g("msRepeatedWord",Gi.d(null,b),"Menu16")}Fzh(){const b=Object.assign(new Nf.a,{ControlList:[]}),h=Object.assign(new ei.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(n.a)(Sn,"ProofingRepeatedWordSectionBuilder",null,[787]);class hq{static get Vg(){return Pf.a.Nx(hq.Wm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,
Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}hq.Wm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(n.a)(hq,"AutoCorrectOptionsDialogHTML",null,[]);class Yn{static get Vg(){return Pf.a.Nx(Yn.Wm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Yn.Wm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(n.a)(Yn,"AutoCorrectOptionsDialogHTML2",null,[]);class El extends Pf.a{constructor(b,h){super();this.kho=(r,B)=>{1!==r?t.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):B.ReplaceTextAsYouType!==this.cW.aUa||B.CapitalizeFirstLetterOfSentences!==this.cW.EFd||B.ReplaceOrdianalsWithSuperscript!==this.cW.uee||B.ReplaceHyphensWithDash!==this.cW.v7c||B.ReplaceFractionsWithFractionCharacter!==this.cW.see||this.Yfa&&B.ReplaceQuoteWithSmartQuote!==
this.cW.T9f?(r={},r.ReplaceTextAsYouType=B.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=B.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=B.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=B.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=B.ReplaceFractionsWithFractionCharacter,this.Yfa&&(r.ReplaceQuoteWithSmartQuote=B.ReplaceQuoteWithSmartQuote),this.cW.Wao(r),t.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:B.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:B.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:B.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:B.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:B.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Yfa,["ReplaceQuoteWithSmartQuote"]:this.Yfa&&B.ReplaceQuoteWithSmartQuote}),ab.StaticActiveAppFrame.za().updateCommandUI(!0)):t.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.cW=b;this.Yfa=h;this.zg="AutoCorrectOptionsDialog"}Mhg(){t.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Vg=this.Yfa?Yn.Vg:hq.Vg;const b={};b.ReplaceTextAsYouType=this.cW.aUa;b.CapitalizeFirstLetterOfSentences=this.cW.EFd;b.ReplaceOrdianalsWithSuperscript=this.cW.uee;b.ReplaceHyphensWithDash=this.cW.v7c;b.ReplaceFractionsWithFractionCharacter=this.cW.see;this.Yfa&&(b.ReplaceQuoteWithSmartQuote=
this.cW.T9f);this.Uh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.kho,b)}}Object(n.a)(El,"AutoCorrectOptionsDialog",Pf.a,[786]);class iq{static get Vg(){return Pf.a.Nx(iq.Wm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}iq.Wm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(iq,"AltTextDialogWithDescriptionHtml",null,[]);class jq{static get Vg(){return Pf.a.Nx(jq.Wm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}jq.Wm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(jq,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Zn extends Pf.a{constructor(b=!1,h=!1){super(!1,!1,b);this.ipi=!1;h?(this.ipi=!0,this.Vg=jq.Vg):this.Vg=iq.Vg;this.zg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Xaf(b){this.Uh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.FCk,"altTextDialogHandler"),this.wqf(b));b=document.getElementById(Zn.N1e)||document.getElementById(Zn.gDd);b.focus();b.select()}wqf(b){const h={};this.ipi?h[Zn.mvm]=!0:h[Zn.N1e]=
this.tof(b);h[Zn.gDd]=this.$Vl(b)||"";return h}Wva(b){return b.yf.id===Zn.gDd?!1:super.Wva(b)}}Zn.N1e="titleText";Zn.gDd="descriptionText";Zn.mvm="hideTitleField";Object(n.a)(Zn,"BaseAltTextDialogWithDescription",Pf.a,[]);var mi=c(33);class gr extends Zn{constructor(b,h,r,B,P){super();this.Lk=h;this.Sm=r;this.Yr=B;this.Qd=P;this.orb=this.eU=null;this.Xaf(b)}$Vl(b){this.eU=b.node;this.orb=mi.TableReader.Mii(b);return mi.TableReader.Evf(this.orb)}tof(b){this.eU=b.node;this.orb=mi.TableReader.Mii(b);
return mi.TableReader.Fvf(this.orb)}FCk(b,h){if(1===b){b=mi.TableReader.Fvf(this.orb);const r=mi.TableReader.Evf(this.orb),B=h[Zn.N1e];h=h[Zn.gDd];this.hide();const P=this.Yr.Pc(15);try{P.Db(this.eU),this.Lk.cfg(this.orb,B),this.Lk.koj(this.orb,h)}finally{P&&P.dispose()}B===b&&h===r||this.Qd.Zs(16)}this.Sm.Uo&&this.Sm.fq.iG(this.eU)}}Object(n.a)(gr,"TableAltTextDialog",Zn,[]);class mo{constructor(b,h,r){this.qA=b;this.Lc=h;this.Vd=r}create(b){return new gr(b,this.qA,qe.App.zd,this.Lc,this.Vd)}}Object(n.a)(mo,
"TableAltTextDialogFactory",null,[]);const dm=()=>{qe.App.Ysh=!0;return 32},Dp=(b,h,r,B,P)=>{if(1===r)return 32;if(!({point:b,Ux:h}=no(P)).returnValue)return 16;ab.StaticActiveAppFrame.za().cmc(b,h);return 32},cs=(b,h,r,B,P)=>{if(1===r)return 32;if(!({point:b,Ux:h}=no(P)).returnValue)return 16;ab.StaticActiveAppFrame.za().kka(b,h);return 32},no=b=>{let h=null,r=0;if(!b)return{returnValue:!1,point:h,Ux:r};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Ux:r};h=new Sys.UI.Point(parseInt(b[0]),
parseInt(b[1]));r=parseInt(b[2]);return{returnValue:!0,point:h,Ux:r}};var om=c(1852);class Bq extends Sys.EventArgs{constructor(b,h,r,B,P,ca=0,ra=0,Qa=null){super();this.controlId=b;this.eic=r;this.commandId=B;this.time=P;this.commandSurface=ca;this.Ux=ra;this.contentType=Qa}}Object(n.a)(Bq,"CommandClickEventArgs",Sys.EventArgs,[]);class qr{constructor(b,h){this.hta=b.hqf();this.ntc=b;this.o$a=h}FPa(b,h,r,B=null,P=null){r&&(this.o$a.LC=r.CommandLocation,this.o$a.I0=r.InvocationMethod,this.o$a.QOa=
r.CommandTabName);b=parseInt(b);let ca=this.ntc.P9h(b,h,r);ca.iTf&&(ca=this.ntc.P9h(ca.rM,h,r));if(void 0!==ca.I1a&&null!==ca.I1a)return ca.I1a;if(ca.WHb)P=32;else{var ra=null;this.hta&&this.hta.o2f&&(ra=this.hta.o2f(ca,P));ca.Cia||ca.cYc?ca.$Ea?P=16:(P=this.o$a.Qb(ca.rM,ca.Ldc?2:1,ca.vd,P),2===P&&(P=32)):ca.$Ea?P=this.o$a.Tqa(null,ca.rM,ca.vd,Qa=>{B&&B(Qa.response)},P):(P=this.o$a.Qb(ca.rM,2,ca.vd,P),B&&B(P));this.hta&&this.hta.h2f&&this.hta.h2f(ca,P,ra);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=
h.LegacyId;if(void 0===r||null===r)r="";ra=h.ParentMenuId;void 0!==ra&&null!==ra||!h.MenuId||(ra=h.MenuId);let Qa=h.SqmControlId;void 0!==Qa&&null!==Qa||!h.SourceControlId||(Qa=h.SourceControlId);(void 0!==Qa&&null!==Qa||void 0!==ra&&null!==ra)&&om.a.zOn(new Bq(Qa,r,ra,nd.ActionManager.xba(b),Date.now()))}}ca.Cia&&32===P&&this.hta&&this.hta.vDa&&this.hta.vDa(ca,h);ca.cYc&&32===P&&this.hta&&this.hta.T_a&&this.hta.T_a(ca,h);return 32===P||1===P}VGa(b,h=null){if(v.AFrameworkApplication.Qk||Rg.a.instance.Qv)return!1;
null!=h&&null!=h.UILocation&&(this.o$a.LC=h.UILocation);const r=parseInt(b);if(!b||r===nd.ActionManager.mif)return!0;b=this.ntc.F9h(r,h);b.iTf&&(b=this.ntc.F9h(b.rM,h));if(void 0!==b.I1a&&null!==b.I1a)return b.I1a;r===eb.a.B2b&&h&&(b.vd=h);return 32===this.o$a.Qb(b.rM,1,b.vd)}clearCache(){this.ntc.clearCache()}}Object(n.a)(qr,"GeneralCuiUser",null,[321,322]);var In=c(197),um=c(98),Rl=c(59),oo=c(1067);class Tq{get tE(){return null!=this.XJg?this.XJg:this.XJg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,r,B){this.tTg="DocumentProofingFailed";this.SVe=b;this.njh=h;this.Ahd=r;this.OI=B}Mdm(){const b=this.OI.Tam(this.SVe);return{returnValue:this.OI.FFa(this.SVe),eLn:b}}fYo(b,h){const r=um.a.zr();if(r){var B=new In.ScriptSharpLegacyMap;B.add(Pe.a.vL,b);B.add(Oc.a.noProof,h);b=new sg.GraphTransaction(15);b.Db(r);this.tE.LSa(Rl.StyleReader.wordStyleIdNormal,B,r)?oo.a.UBj():(t.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),oo.a.recordQosError(this.tTg,[oo.a.QBc],"Style could not be modified"));
b.dispose()}else t.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),oo.a.recordQosError(this.tTg,[oo.a.QBc],"PageContentNode not found")}Lio(b,h){this.fYo(b,h)}boo(b,h){if(this.njh){var r=new wc.DictionaryPropertySet;this.Ahd.execute(B=>{B.zNc(b)});r.setValue(Pe.a.vL,b);r.setValue(Oc.a.noProof,h);h=new sg.GraphTransaction(15);h.set(qe.App.li.Al);this.njh.O5(r);h.dispose()}}Ze(){return Pd.SelectionEditor.Ze(this.SVe)}}Object(n.a)(Tq,"LanguageEditor",null,[785]);var gp=c(613),Tp=c(251),
vo=c(105);class Lo{constructor(b=!1,h=0){this.languages=Lo.Nhi(Hi.a.QUl());this.ard=new Tp.a;this.ITa=[];this.A_b=new gp.a;this.m8i=b;this.$ch=0>=h?7:h;this.Zch=this.hQe=0;this.uYg=!1;b&&(this.vCm(),v.AFrameworkApplication.rI(()=>{this.T7m()}))}vCm(){for(var b of this.languages)this.ard.Z(b.LCID,b);b=[];try{const B=Gc.a.get("RecentlyUsedLcids");if(B&&""!==B){const P=decodeURIComponent(B).split(",").slice(0,this.$ch);for(const ca of P){let ra;({value:ra}=this.ard.Fc(parseInt(ca),ra)).returnValue&&
b.push(ra)}}}catch(B){t.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",B.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.A_b.contains(r)||(this.ITa.push(h),this.A_b.add(r))}else h=v.AFrameworkApplication.lcid,({value:r}=this.ard.Fc(h,r)).returnValue&&(this.ITa.push(r),this.A_b.add(h));this.Chj()}Chj(){const b=vo.toArray(vo.select(vo.asEnumerable(this.ITa),h=>h.LCID)).join(",");Gc.a.ZIa("RecentlyUsedLcids",
b,180)}H2l(b){let h,r=-1,B=null;var P=Lo.Nhi(this.ITa);this.m8i&&0<P.length&&(B=vo.toArray(vo.Si(vo.asEnumerable(P),(Qa,mb)=>{b===Qa.LCID&&-1===r&&(r=mb);return{["key"]:mb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}})));let ca=0;B&&(ca=B.length);P=ca;const ra=vo.toArray(vo.Si(vo.asEnumerable(this.languages),(Qa,mb)=>{b===Qa.LCID&&-1===r&&(r=ca+mb);return{["key"]:ca+mb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}}));h=r;return 0<ca?{returnValue:B.concat.apply(B,ra),selectedIndex:h,
vvj:P}:{returnValue:ra,selectedIndex:h,vvj:P}}Vko(b,h){if(this.m8i&&({value:r}=this.ard.Fc(b,r)).returnValue){h=b!==h;if(this.A_b.contains(b))b=Array.indexOf(this.ITa,r),0<=b&&(Array.removeAt(this.ITa,b),this.ITa.push(r)),h&&this.hQe++;else{this.A_b.add(b);this.ITa.push(r);if(this.ITa.length>this.$ch){var r=this.ITa.shift();this.A_b.remove(r.LCID)}h&&this.Zch++}this.Chj()}}T7m(){const b=this.hQe+this.Zch;!this.uYg&&0<b&&(t.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.hQe/b),this.uYg=!0)}static Nhi(b){b=Array.clone(b);b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(n.a)(Lo,"LanguageListHelper",null,[784]);var Fp=c(195);class Wj extends Fp.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Wj,"NumberButtonProps",Fp.a,[]);var Im=c(214);class ln{static get X5(){return null!=ln.sHg?ln.sHg:ln.sHg=Ya.a.instance.Oa("Box4.ISpacingCommands")}static get ah(){return Im.ContextSetEditor.instance}static get v5a(){return null!=
ln.pEg?ln.pEg:ln.pEg=Ya.a.instance.Oa("Box4.ILineSpacingHelper")}static get mrj(){return!!ln.X5}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.Bic,zc.a.view,ln.Bic);b.Xc(Mb.a.Bic,1124);b.qa(Mb.a.Bic,zc.a.paragraph,ln.nYo)}static Bic(b,h,r,B,P){if(1===r||!ln.mrj)return ln.mrj?32:8;if(!ln.xAi){var ca=[];ca.push(Object.assign(new Wj,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new Wj,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new Wj,
{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new Wj,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ca.push(Object.assign(new Wj,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new Wj,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));P.MenuItems=Gi.e(ca);ln.xAi=!0}t.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.mb;ca=null;h&&h.ib.lb&&(ca=h.ib.lb);h=ln.ah.$3h(ca.Pa);v.AFrameworkApplication.va.Mf(h,b,r,!0,B,P);return 32}static nYo(b,
h){let r=b=!0;h=ln.v5a.zQa(h.node);var B=h.beforeSpacing;let P=!1;1===B.unit&&(P=!0);if(P||0<B.value)b=!1;h=h.afterSpacing;B=!1;1===h.unit&&(B=!0);if(B||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(ln.Nvk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(ln.w1n,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(ln.Mvk,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(ln.v1n,r));return 32}}ln.Nvk="AddSpaceBeforeParagraph";
ln.Mvk="AddSpaceAfterParagraph";ln.w1n="RemoveSpaceBeforeParagraph";ln.v1n="RemoveSpaceAfterParagraph";ln.xAi=!1;Object(n.a)(ln,"LineSpacingRibbonMenu",null,[]);var Ik=c(183),Cq=c(1707),wo=c(1400),xk=c(125);const Br=(b,h,r)=>{if(1===r)return 32;b=ab.StaticActiveAppFrame.za().notificationBar.Eva("Automation test",!1);b.image=3;ab.StaticActiveAppFrame.za().notificationBar.sA(b);return 32},Dq=(b,h,r,B,P)=>{let ca;if(!({pJj:ca}=Uq(P)).returnValue)return 16;Ik.UISurfaces.MM().then(ra=>{let Qa=null;var mb=
Object.assign(new Cq.a,{label:"OK",onExecute:()=>{Qa&&ra.removeNotification(Qa)}});mb=Object.assign(new wo.a,{target:"#"+xk.AppFrame.Hag,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:mb,useTeachingStyles:ca});mb=ra.callout(mb);Qa=ra.addNotification(mb);return null},ra=>{t.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ra);return null});return 32},Uq=b=>{let h=!1;if(!b)return{returnValue:!1,pJj:h};h=Boolean.parse(b);return{returnValue:!0,
pJj:h}};var hr=c(1490);let Gp,rl,mn,Jn,Jm;class hp{constructor(){this.F7=new vb.a;this.T2g=!1}F_a(b){const h=this.F7.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.F7.removeAt(h)}this.F7.insert(0,b);t.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.F7.count&&(t.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.F7.J(10)),this.F7.removeAt(10));this.QZo();return r}Roe(b){let h="#";for(let B=0;B<this.F7.count;B++){var r=
"#"+this.F7.J(B).substring(4,6)+this.F7.J(B).substring(2,4)+this.F7.J(B).substring(0,2);r=Object.assign(new hr.a,{Color:this.F7.J(B),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const B of hp.Wch)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(B,h))}QZo(){t.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.F7.count;r++){var h="#"+this.F7.J(r).substring(4,
6)+this.F7.J(r).substring(2,4)+this.F7.J(r).substring(0,2);h=Object.assign(new hr.a,{Color:this.F7.J(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of hp.Wch)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.T2g||this.MYo();this.T2g=!0}MYo(){for(const b of Object.keys(hp.y7g)){t.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=hp.y7g[b],r=[];for(const B of h)r.push(appChrome.api.menuSection([B],
B in hp.$Ke?hp.$Ke[B].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,hp.$Ke[b].toString()))}}}hp.y7g={["FontColor"]:(Jm=new vb.a,Jm.add("AutomaticFontColor"),Jm.add("ThemeFontColorPickerMCU"),Jm.add("ThemeFontColorPicker"),Jm.add("StandardFontColorPicker"),Jm.add("RecentFontColorPicker"),Jm.add("MoreFontColors"),Jm),["CellShading"]:(Jn=new vb.a,Jn.add("ThemeShadingColorPickerMCU"),Jn.add("ThemeShadingColorPicker"),Jn.add("StandardShadingColorPicker"),Jn.add("RecentCellShadingColorPicker"),
Jn.add("ClearShadingColor"),Jn.add("MoreCellShadingColors"),Jn),["PictureBorders"]:(mn=new vb.a,mn.add("ThemePictureBorderColorPickerMCU"),mn.add("ThemePictureBorderColorPicker"),mn.add("StandardPictureBorderColorPicker"),mn.add("RecentPictureBorderColorPicker"),mn.add("MorePictureBorderColors"),mn.add("NoPictureBorder"),mn.add("PictureBorderWeightOptions"),mn.add("PictureBorderStyleOptions"),mn),["PageColor"]:(rl=new vb.a,rl.add("ThemePageColorPickerMCU"),rl.add("ThemePageColorPicker"),rl.add("StandardPageColorPicker"),
rl.add("RecentPageColorPicker"),rl.add("NoPageColor"),rl.add("MorePageColors"),rl)};hp.$Ke={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};hp.Wch=(Gp=new vb.a,Gp.add("RecentFontColorPicker"),Gp.add("RecentCellShadingColorPicker"),Gp.add("RecentPictureBorderColorPicker"),
Gp.add("RecentPageColorPicker"),Gp);Object(n.a)(hp,"RecentColorsSectionHandler",null,[]);var pq=c(1429),Sl=c(1074);class Zk{constructor(b){this.gfk=b}r5(){}p5(b){this.gfk.cjn(b)}}Object(n.a)(Zk,"DataBuddyActionListener",null,[29]);class fm{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(n.a)(fm,"DataBuddyTaskPaneProps",null,[]);class Gl{constructor(b){this.isVisible=!1;this.CZ=new vb.a;this.Qse=null;this.J3=b;this.lB=new pq.a;this.Vb=
kb.FocusManager.instance()}initialize(){this.Qse=new Zk(this);this.J3.dPa();this.lB.GL(this.Vuk());this.lB.GL(this.Xrk())}toggle(){this.isVisible?this.hide():this.show()}cjn(b){if(2===b.behavior){const h=nd.ActionManager.xba(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.CZ.add(h+": "+Gl.KMl(b.response)),this.Lm())}}hide(){Ik.UISurfaces.Pu().then(b=>{b.hideTaskPane(Gl.lC,2);return null})}show(){Ik.UISurfaces.Pu().then(b=>{b.showTaskPane(Gl.lC,this.xA());return null});this.isVisible&&
Ik.UISurfaces.Pu().then(b=>{b.setSelectedTaskPane(Gl.lC);return null})}Vuk(){return b=>{b.actions=this.CZ.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Xrk(){return b=>{b.onClearClick=()=>{this.CZ.clear();this.Lm()}}}Ub(){v.AFrameworkApplication.va.gZ(this.Qse)}s9a(){v.AFrameworkApplication.va.OSb(this.Qse)}xA(){const b=new fm;this.lB.iqb(b);return Object.assign(new Sl.a,{title:"Data Buddy",hideHeader:!1,width:Gl.width,location:2,contentProps:b,onOpen:()=>{this.G$();
this.Ub();this.isVisible=!0;v.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.nea();this.s9a();this.isVisible=!1;this.Lm();v.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}Lm(){Ik.UISurfaces.Pu().then(b=>{b.updateTaskPane(Gl.lC,this.xA());return null})}G$(){this.Vb.mg(Gl.lC)}nea(){this.e5a()&&this.Vb.mg(this.Vb.iU)}e5a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Gl.lC}static KMl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";
case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Gl.lC="DataBuddyTaskPane";Gl.width=300;Object(n.a)(Gl,"Box4DataBuddyTaskPane",null,[651]);class vm{constructor(b){this.Mh=b}$Ja(b){this.Mh&&this.Mh.lH(b)}Jdd(){this.Mh&&this.Mh.Ydd(void 0)}}Object(n.a)(vm,"RibbonButtonUpdater",null,[648]);var kl=c(373);class Vo{constructor(){this.bUe=this.W=null}get name(){return"Box4.UI"}wc(b){this.W=b;b.ia("Box4.IGeneralCuiUser",
()=>new qr(b.resolve("Box4.UI.CuiActionBridge"),v.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new mo(b.resolve("Box4.ITableEditor"),new kl.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.UI.ILanguageEditor",()=>new Tq(lh.a.instance.qg,b.Oa("Box4.ITextFormattingCommands"),b.Sa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",()=>new cm(v.AFrameworkApplication.Ms)).as("Common.IStandaloneRootController").ha();
b.ia("Box4.UI.IAutoCorrectOptionsDialog",()=>new El(b.resolve("Box4.IAutoCorrectOptionsInfo"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new Lo(v.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(Sn,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Aq(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();
b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new Cp(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",()=>new vm(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",()=>new hp).ha();b.ia("Common.IDataBuddyTaskPane",()=>new Gl(Sq.a.instance)).ha()}init(){var b=ab.StaticActiveAppFrame.za();
const h=b.Kb;gl.pAm(Object(z.a)(h,h.sMb,"onAuthenticationLost"),Object(z.a)(h,h.tMb,"onAuthenticationRestored"),b.STk);b=v.AFrameworkApplication.va;b.qa(Mb.a.aIn,zc.a.application,dm);b.fb(Mb.a.Owo,zc.a.application,Dp,96);b.fb(Mb.a.wxo,zc.a.application,cs,96);b=v.AFrameworkApplication.va;b.fb(Mb.a.izo,zc.a.application,Br,96);b.fb(Mb.a.Ewo,zc.a.application,Dq,96);ln.Ub();this.CCm();this.bUe=this.W.resolve("Common.IStandaloneRootController")}CCm(){this.W.Sa("Box4.IGeneralCuiUser").execute(b=>{this.W.Sa("Common.IStandaloneRootController").execute(h=>
{h.sea.IF=b})})}dispose(){this.bUe.dispose();this.bUe=null}static main(){L.a.instance.Gc(new Vo,6)}}Object(n.a)(Vo,"Box4UIPackage",null,[1,2]);var Hp=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},rr=c(1867);class Sm{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",
()=>new rr.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(n.a)(Sm,"Box4InsightsPackage",null,[1,2]);const Hl=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Xl=c(402),Tm=c(549),yk=c(705),Eq=c(1837);class Mo{nnb(){return!1}reset(){}update(){}}Object(n.a)(Mo,"NullTaskYieldStrategy",null,[647]);var sr=c(1414);class Vq{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(n.a)(Vq,"CatchUpConfiguration",null,[]);class No{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(n.a)(No,"SharedControllerFactoryParameters",null,[]);var Jk=c(172),V=c(14);class qa{constructor(b,h,r,B){this.awn=(P,ca)=>{(this.Qod=!this.Qod)&&ca.ik&&ca.ik.contextId===zc.a.Tc&&this.$Dh(ca.ik.node,ca.ik.Wj);return 32};this.ny=b;this.Xo=h;this.ga=r;this.Vb=B;this.Aqd=this.Bqd=null;this.Qod=!1;this.ga.qa(V.a.pAj,zc.a.view,this.awn);this.Vb.fe(Zd.AFrame.Ap).bindAction(Tb.KeyInputManager.ic(kc.a.Bqc,
6),V.a.pAj)}WY(b,h){this.Qod&&this.Xo&&h&&h.yl&&h.yl.lb&&h.yl.lb.Pa&&h.yl.lb.Pa.node&&h.yl.lb.Pa.contextId===zc.a.Tc&&this.$Dh(h.yl.lb.Pa.node,h.yl.lb.Pa.Wj)}$Dh(b,h){b&&(this.gSi(b)?(this.Bqd&&this.Bqd.id.equals(b.id)||(this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Bqd=b),this.y$m(b,h)):this.Aqd=this.Bqd=null)}gSi(b){return 0<this.ny.MGb(b).count}y$m(b,h){if(b){var r=-1,B=null,P=null;for(let ca=0;ca<b.ra.length;ca++){const ra=b.ra.J(ca);
if(!(null==P||ra.changeStart&&ra.changeStart.equals(B))&&h>=r&&h<=ra.cp&&!B.equals(this.Aqd))if(this.ny.FJb(B)){(b=this.ny.xPc(B,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Xo.sendNotification(b,!1),this.Aqd=B);break}else this.Aqd=null;ra.changeStart&&!ra.changeStart.equals(B)&&(r=ra.cp,B=ra.changeStart);P=ra.changeStart}}}}Object(n.a)(qa,
"ActivityAnnouncementManager",null,[]);var pb=c(1401),ec=c(541),Hc=c(777),bd=c(598);class vd{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(vd,"Activity",null,[]);var Fd=c(394);class Ae extends vd{constructor(){super();this.Jv=this.objectId=null}static hH(b){const h=new bd.a(new Fd.a);if(b.Jv)for(const r of b.Jv)h.add(r);return h}}Object(n.a)(Ae,"RevisionSetActivity",vd,[]);class Yf{constructor(b,
h,r,B=!1){this.pxe=null;this.dismiss=()=>{this.CSi.then(P=>{P.removeNotification(this.pxe);return this.pxe=null})};this.yX=b;this.oc=h;this.CSi=r;this.wdc=B}SQo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.oc.Qb(eb.a.f6a,2,null);break;default:this.hjn()}else t.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}hjn(){this.CSi.then(b=>{var h=Object.assign(new wo.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new pb.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new ec.a,{expirationOptions:Object.assign(new Hc.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.pxe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return t.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return t.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.oc.Qb(eb.a.lMd,2,h))return!1;break;case 1:return this.Prl(b)}return!0}Prl(b){b=Ae.hH(b);return b?0<this.yX.sSd(b).count:(t.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(n.a)(Yf,"ActivityContentManager",null,[747]);var tf=c(1502),gh=c(2068),Te=c(393),hf=c(710);class Ph{constructor(){this.Jv=this.rY=null}compare(b){if(!b)return!1;
if(this.rY&&b.rY){if(this.rY.count!==b.rY.count)return!1;for(const h of this.rY)if(!b.rY.contains(h))return!1}else if(!b.rY&&this.rY||!this.rY&&b.rY)return!1;if(b.Jv&&this.Jv){if(b.Jv.count!==this.Jv.count)return!1;for(const h of this.Jv)if(!b.Jv.contains(h))return!1}else if(!this.Jv&&b.Jv||!b.Jv&&this.Jv)return!1;return!0}}Object(n.a)(Ph,"ActivityHighlightableObject",null,[]);class Jh extends tf.a{constructor(b,h){super();this.sPe=this.o_b=null;this.Mgd=b;this.ny=h;this.h3=[new gh.a(Te.a.HCh,Te.a.GCh),
new gh.a(Te.a.ECh,Te.a.DCh),new gh.a(Te.a.JFd,Te.a.KFd),new gh.a(Te.a.LFd,Te.a.t7e)]}get qkb(){return 1}get J3a(){return this.h3}get Oca(){return!0}d3a(b,h){if(b=Object(Na.a)(Ph,b))if(b.rY)for(const r of b.rY)h.add(r);else t.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}QHa(b,h){if(this.Cr.tEa){var r=this.Mgd.S7a,B=this.Mgd.skb,P=!!r&&r.compare(B),ca=this.Cr.tEa,ra=ca.action,Qa=this.zto(ca,b),mb=!1;2!==ra&&ra&&(mb=(mb=this.Cr.FZc)?1===mb.type:!!r||!!B);h=h.nIa("*");
for(let Jb=0,Yb=h.length;Jb<Yb;Jb++){const fc=h[Jb],Mc=this.oXl(fc,Te.a.rIc);if(Mc&&Mc.nu)if(this.l0n(fc),1===ca.type)switch(ra){case 0:Qa&&r.Jv.contains(Mc.nu)&&this.GDd(fc,2,Mc,!1);break;case 2:Qa&&B.Jv.contains(Mc.nu)&&this.GDd(fc,P?2:1,Mc,!1);break;default:this.$ac(b,fc,Mc,!1)}else mb?this.$ac(b,fc,Mc,!1):this.$ac(b,fc,Mc,!0)}this.o_b&&(this.o_b.classList.add(Te.a.LFd),this.sPe=this.o_b=null)}}oXl(b,h){return Bc.a.Eb(b,h)}zto(b,h){if(b&&b.HA){const r=b.HA,B=b.action;if(1===b.type&&(2===B||!B)&&
r.rY)return r.rY.contains(h);if(r.Jv)for(const P of r.Jv){b=this.ny.SQc(P);for(const ca of b)if(ca===h)return!0}}return!1}$ac(b,h,r,B){const P=this.Mgd.S7a,ca=this.Mgd.skb;P&&P.Jv.contains(r.nu)&&(!P.rY||P.rY.contains(b))?this.GDd(h,2,r,B):ca&&ca.Jv.contains(r.nu)&&(!ca.rY||ca.rY.contains(b))&&this.GDd(h,1,r,B)}GDd(b,h,r,B){b&&hf.a(b)&&(b.classList.add(this.o0l(2===h,B)),this.hko(b,r,B))}hko(b,h,r){this.o_b?-1!==h.cpEnd&&this.sPe.cpEnd!==h.cpBegin&&(this.o_b.classList.add(r?Te.a.t7e:Te.a.LFd),b.classList.add(r?
Te.a.KFd:Te.a.JFd)):b.classList.add(r?Te.a.KFd:Te.a.JFd);b.classList.add(Te.a.FCh);this.o_b=b;this.sPe=h}l0n(b){this.Cr.UTa(b);this.b_n(b)}b_n(b){b.classList.remove(Te.a.JFd,Te.a.KFd,Te.a.FCh,Te.a.LFd,Te.a.t7e)}o0l(b,h){return h?b?Te.a.DCh:Te.a.GCh:b?Te.a.ECh:Te.a.HCh}}Object(n.a)(Jh,"ActivityHighlightActor",tf.a,[]);var xg=c(2069),ri=c(169);class Lj{constructor(b,h,r,B,P,ca,ra,Qa){this.yW=b;this.iO=h;this.ny=r;this.bfk=P;this.hb=ca;this.Xo=Qa;this.Vb=ra;this.iO.M0d=!1}IYi(b,h,r){b?this.wvm(b,h,r):
this.iO.S7a&&(b=Object.assign(new xg.a,{action:1,type:1,HA:null,WJ:this.iO.S7a}),this.iO.S7a=null,this.yW.KF(b))}wvm(b,h,r){if(h){b=new bd.a(new Fd.a);for(P of h){var B=this.ny.YPc(P);for(let ca=0;ca<B.length;ca++){const ra=B[ca];this.ny.FJb(ra)&&b.add(ra)}}var P=this.ny.sSd(b);P=this.uLh(P,b);B=this.iO.S7a;this.iO.S7a=P;P=Object.assign(new xg.a,{action:0,type:1,HA:this.iO.S7a,WJ:B});this.yW.KF(P);r&&!this.wco(h.J(0),b)||this.leo(h.J(0),b)}else t.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}wco(b,h){if(!b)return t.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return t.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.uUl(b,h);return this.bfk.rUa(b.id,h)?this.Ac(b,h)?!0:!1:(t.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}leo(b,h){b=this.p0l(b,h);h=new Sys.StringBuilder;for(let r=0;r<
b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.J(r)));this.Xo.sendNotification(h.toString(),!0)}Ac(b,h){if(!b||!Td.ParagraphReader.Xb(b))return t.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return t.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.iO.M0d=!0;b=Se.a.Uc(b,h);b=new ri.Selection([b],!0);this.hb.Ac(b);kb.FocusManager.nK()&&this.Vb.mg(Zd.AFrame.In);
return!0}uUl(b,h){if(h&&0<h.count)for(let r=0;r<b.ra.length;r++){const B=b.ra.J(r);if(B.changeStart&&h.contains(B.changeStart))return B.cp}t.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}p0l(b,h){const r=new vb.a;if(h&&0<h.count&&b){let B=-1;for(let P=0;P<b.ra.length;P++){const ca=b.ra.J(P);if(-1!==B&&ca.Dr)if(ca.changeStart&&h.contains(ca.changeStart))continue;else r.add(b.characterData.substring(B,ca.cp)),B=-1;ca.changeStart&&
h.contains(ca.changeStart)&&(B=ca.cp)}}return r}PXi(b,h){if(b)switch(b.type){case 1:if(h){b=new bd.a(new Fd.a);for(var r of h){h=this.ny.YPc(r);for(let B=0;B<h.length;B++){const P=h[B];this.ny.FJb(P)&&b.add(P)}}}else b=Ae.hH(b);h=this.ny.sSd(b);this.iO.skb=this.uLh(h,b);r=Object.assign(new xg.a,{action:2,type:1,HA:this.iO.skb,WJ:null});this.yW.KF(r)}else this.iO.skb&&(r=Object.assign(new xg.a,{action:3,type:1,HA:null,WJ:this.iO.skb}),this.iO.skb=null,this.yW.KF(r))}uLh(b,h){var r=null;if(b){r=new fa.a;
for(const B of b)12===B.type&&r.add(B)}b=new Ph;b.rY=r;b.Jv=h?h:this.m6l(r);return b}m6l(b){const h=new bd.a(new Fd.a);if(!b)return h;for(const r of b)for(const B of this.ny.MGb(r))h.add(B);return h}}Object(n.a)(Lj,"ActivityHighlightManager",null,[]);var tn=c(506),xl=c(465),ll=c(1500),Um=c(113),Vm=c(58);class Up{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(n.a)(Up,"CreateIndicatorTooltipParameters",null,[]);class ds{constructor(){this.clearSticky=
!1}}Object(n.a)(ds,"DismissIndicatorTooltipParameters",null,[]);class Wo{constructor(){this.target=null;this.isSticky=!1}}Object(n.a)(Wo,"UpdateIndicatorTooltipParameters",null,[]);class si extends Sys.EventArgs{constructor(b,h,r){super();this.iFb=b;this.Cri=h;this.Buo=r}}Object(n.a)(si,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class dl{constructor(){this.Dri=new Map;this.Eri=new Set}JNo(b,h){this.Eri.add(b);this.Dri.set(b,h)}xPm(b){return Qd.a.Yxi(b.htmlElement)}llm(){const b=new Set;for(const h of this.Eri){const r=
this.Dri.get(h);r&&this.wPm(r)&&b.add(h)}return b}wPm(b){return b.parentElement&&Qd.a.Yxi(b.parentElement)}}Object(n.a)(dl,"IndicatorVisibilityTracker",null,[]);class qq extends ll.a{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){super();this.sa=new wd.a;this.fwb=this.Kaa=null;this.erm=(fc,Mc,Wc,id,Id)=>{if(!Id)return t.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Mc=Ae.hH(Id.Activity);fc=null;if(Id.NodeId&&(Id=Um.b(Id.NodeId),!U.a.Cq(Id,U.a.nil)&&(Id=this.ny.aai(Id),
this.zog(Id,!1))))return 32;for(const ve of Mc)if(this.ny.FJb(ve)){Id=this.ny.V9b(ve);if(this.zog(Id,!0))return 32;Id&&!fc&&(fc=Id)}if(this.zog(fc,!1))return 32;t.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.crm=(fc,Mc,Wc,id,Id)=>{t.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Id&&Mc&&Mc.al&&(fc=Mc.node)&&((fc=this.Vqc.CSd(fc))?this.ABd(fc,!1,!1):t.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.kzo=fc=>{(fc=this.Vqc.CSd(fc.customData))&&this.ABd(fc,!1,!1)};this.onMouseEnter=fc=>this.SWi(fc.Yw,!0);this.zqa=fc=>{fc=fc.Yw;if(fc===this.Kaa)return!0;this.saj(fc);return!0};this.HHa=fc=>{this.fwb=null;return this.SWi(fc.Yw,!1)};this.i1=()=>{this.qig();this.HGd(!0);return!1};this.mt=()=>{this.y0i()};this.j$d=()=>{this.Kaa&&this.RGj(this.Kaa);this.fwb&&this.saj(this.fwb);this.rqn()};this.y0i=()=>{this.Kaa?
this.RGj(this.Kaa):this.u8e()};this.ny=b;this.$se=h;this.x_g=r;this.t7j=B;this.cyb=P;this.e7=null;this.Ib=ra;this.Vqc=Qa;this.eFe=new dl;this.Ax=mb;this.IK=Jb;this.NI=Yb;this.Ek&&(this.Ek.wga(this.j$d),this.Ek.Arh(this.y0i));ca&&ca.execute(fc=>{fc.hZ(this.mt)})}get Ek(){return this.cyb&&this.cyb.$i?this.cyb:(t.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Mna(b,h,r){if(this.Kaa){var B=Vm.a(this.Kaa);if(b===B)return this.Kaa}const P=b.Ag.ownerDocument;B=tn.a.createElement(P,
xl.a.div);B.className=Te.a.MFd;B.style.left=h+"px";B.style.top=r+"px";h=tn.a.createElement(P,xl.a.div);h.className=this.Ax?Te.a.NCh:Te.a.ICh;B.style.cursor="pointer";h.style.cursor="pointer";this.NI&&(h.style.backgroundColor=this.IK.bRl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.IK.cRl());B.appendChild(h);Ye.a.instance.ob(Xc.a.XR,B,this.onMouseEnter);Ye.a.instance.ob(Xc.a.yL,B,this.zqa);ji.a.instance.ob(Xc.a.click,B,this.HHa);Ye.a.instance.ob(Xc.a.contextMenu,
B,this.i1);t.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.E6m(b);h=this.g7l(b);this.eFe.JNo(h,B);this.eFe.xPm(b)&&this.hWi(h);return B}n8a(b){return this.tso(b)}$0a(b){const h=this.GRk(b),r=[];r.push(this.Mna(b.y5,h,b.Bpc[0].y-b.M4[0].y));return r}GRk(b){let h=Te.a.vzm+(0>b.VZc?-b.VZc:0);const r=Xg.a.Oi(b.leftMargin,0)/2;1>=r&&t.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<Te.a.JCh?Te.a.JCh:h;return v.AFrameworkApplication.isRtl?
b.M4[0].width/this.zoom+h:-h}zqj(b){if(b&&393230===b.Oc||393251===b.Oc){const h=this.ny.MGb(b);if(h)for(const r of h)if(b===this.ny.V9b(r))return!0}return!1}tso(b){for(const h of Td.ParagraphReader.yw(b.Cb,!0,!1))if(this.zqj(h))return!0;return!1}Ub(b){b.qa(V.a.jsj,zc.a.Tc,this.crm);b.qa(V.a.Ihg,zc.a.Tc,this.erm)}zog(b,h){if(!b)return!1;const r=this.Vqc.CSd(b);if(r)return this.ABd(r,!1,!0),!0;if(!h){let B;this.$5c((B=new vb.a,B.add(b),B),!1,!0,!0);h=new Oe.a(3,1,0,this.kzo,181);h.customData=b;this.Ib.Wb(h);
return!0}return!1}Obl(b,h=!1){h&&this.HGd(!0);if(b&&b.parentNode){var r=this.Pvf(b);r=this.WMl(r);this.e7||(this.e7=document.createElement("Div"),document.getElementById(v.AFrameworkApplication.t3b).appendChild(this.e7));this.$se.createActivityIndicatorTooltip(Object.assign(new Up,{target:b,container:this.e7,activityIds:r,isSticky:h,dirHint:9}));h&&(this.Kaa=b)}else t.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Awl(b){b&&
b.classList.add(Te.a.NFd)}SWi(b,h){return this.ABd(b,h,!1)}ABd(b,h,r){if(h&&b===this.Kaa)return!0;const B=this.Pvf(b);h||this.qig();this.Obl(b,!h);this.Awl(b.getElementsByClassName(this.Ax?Te.a.NCh:Te.a.ICh)[0]);this.$5c(B,h,!0,r);this.cLi(B,h?1:2);this.t7j.T3d();h&&(this.fwb=b);return!0}HGd(b=!1){this.$se.dismissActivityIndicatorTooltips(Object.assign(new ds,{clearSticky:b}));this.fwb=null;b&&(this.Kaa=null)}Rtj(b){b&&b.classList.remove(Te.a.NFd)}qig(){this.Kaa&&this.Rtj(this.Kaa.getElementsByClassName(Te.a.NFd)[0])}saj(b){const h=
this.Pvf(b);this.$5c(h,!0,!1,!1);this.Rtj(b.getElementsByClassName(Te.a.NFd)[0]);this.HGd(!1);this.fwb=null}Pvf(b){let h=null;(b=(b=Vm.a(b))?b.Cb:null)&&11===b.type&&(h=Td.ParagraphReader.yw(b,!0,!1));return h}u8e(){const b=!!this.fwb;if(this.Kaa||b)this.qig(),this.HGd(!0),this.$5c(null,!1,!1,!1),this.$5c(null,!0,!1,!1)}Xwk(b){this.sa.addHandler(qq.doh,b)}Ywk(b){this.sa.addHandler(qq.eoh,b)}$5c(b,h,r,B){let P=null;if(r&&b){for(const ca of b)if(r=this.ny.YPc(ca))for(let ra=0;ra<r.length;ra++){const Qa=
r[ra];if(this.ny.FJb(Qa)){P=this.ny.xPc(Qa,ca.id);break}}if(!P){t.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(qq.doh,new si(P,b,!1)):this.sa.raiseEvent(qq.eoh,new si(P,b,B))}WMl(b){const h=[];if(b)for(const B of b){var r=this.ny.MGb(B);for(const P of r)(r=this.ny.xPc(P,B.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&t.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}RGj(b){b&&b.parentNode?(this.$se.updateActivityIndicatorTooltip(Object.assign(new Wo,{target:b,isSticky:!0})),this.Kaa=b):t.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}rqn(){const b=this.eFe.llm();for(const h of b)this.hWi(h)}hWi(b){this.x_g.bLi(b,3)}g7l(b){return(b=Td.ParagraphReader.yw(b.Cb,!0,!1))&&b.count?b.J(0).id:null}E6m(b){b=Td.ParagraphReader.yw(b.Cb,!0,!1);this.cLi(b,0)}cLi(b,
h){b&&b.count&&this.D6m(b.J(0).id,h)}D6m(b,h){this.x_g.bLi(b,h)}}qq.doh="ActivityIndicatorPreviewed";qq.eoh="ActivityIndicatorSelected";Object(n.a)(qq,"ActivityIndicatorActor",ll.a,[]);var hg=c(37);class Oo{constructor(b,h,r){this.ny=b;this.Dzd=h;this.cyb=r}get Ek(){return this.cyb&&this.cyb.$i?this.cyb:(t.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}CSd(b){t.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.$ai(b);if(!h){t.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.ny.MGb(b);for(const r of b)if(b=this.ny.V9b(r),b=this.$ai(b))return b}return h}$ai(b){if(!b||12!==b.type)return t.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return t.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.Dzd.qHb(b);if(!h||11!==h.type)return t.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.qe(this.Ek.$b);if(!h||!h.htmlElement)return t.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=Kb.a.ZPc(h.htmlElement,Oo.coh);if(r)return r;h=h.TOd();if(!h)return t.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=Kb.a.QRl(h,Oo.coh);if(!h)return t.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const B=Vm.a(h[r]),P=hg.OutlineElementNavigator.Fl(b);if(B&&B.Cb&&P&&B.Cb.id.equals(P.id))return h[r]}t.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}D1l(b){b=this.ny.aai(b);if(!b||12!==b.type)return t.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
U.a.nil;b=this.CSd(b);if(!b)return t.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),U.a.nil;b=Vm.a(b);return b?b.Cb.id:(t.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),U.a.nil)}}Oo.coh="CatchUpActivityIndicatorContainer";Object(n.a)(Oo,"ActivityIndicatorHelper",null,[]);var An=c(1708);class Po{constructor(b,h,r,B,P,ca,ra){this.vxa=
b;this.pageContentNode=h;this.FZe=r;this.oc=B;this.yX=P;this.Re=ca;this.BZd=ra;this.eFi=!1;this.yan=(Qa,mb,Jb)=>{if(1===Jb)return this.wzf?32:8;2===Jb&&(this.wzf&&(this.FZe.u8e(),this.yYk()),t.ULS.sendTraceTag(38138719,377,50,I.c({["MarkAsRead invoked"]:!0})));ab.StaticActiveAppFrame.za().updateCommandUI();return 8};this.vxa.RTa(this.FZe)}initialize(){this.oc.qa(V.a.MNi,Gd.a.frame,this.yan)}get wzf(){return!!this.yX.YR&&0<this.yX.YR.count||!!this.yX.xgc&&0<this.yX.xgc.count}get OYm(){return this.eFi}JZf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.BZd||0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.Re.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.$kn(b.wywaActivities),this.eFi=!0):(t.ULS.shipAssertTag(36538305,377,!1),this.BZd||Object(An.a)(),this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}$kn(b){b?(t.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.Kqo(b),b=this.yX.qwk(b),this.Lqo(b)):t.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}Kqo(b){if(b){var h=new vb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.e1i:r.contentId,h.add(b),this.yX.xgc.add(b)}0<h.count&&(t.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.oc.Qb(eb.a.vRi,2,h.toArray()))}}Lqo(b){const h=new bd.a(new Fd.a),r=new sg.GraphTransaction(3);try{r.Db(this.pageContentNode);for(const B of b){const P=this.yX.V9b(B);P&&this.FZe.zqj(P)&&
(h.add(P.id),this.vxa.ZIb(P,!0))}}finally{r&&r.dispose()}0<b.count&&ab.StaticActiveAppFrame.za().updateCommandUI();b={};b.highlightedNodeCount=h.count;t.ULS.sendTraceTag(36509257,377,50,"{0}",I.c(b))}yYk(){t.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.yX.xgc.count&&(this.oc.Qb(eb.a.JTh,2,this.yX.xgc.toArray()),this.yX.xgc.clear());const b=this.A_k(this.yX.YR);this.WZn(b)}WZn(b){t.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new sg.GraphTransaction(3);try{h.Db(this.pageContentNode);for(const r of b){this.yX.YR.remove(r);for(const B of this.yX.SQc(r))this.vxa.ZIb(B,!0)}this.yX.KEh()}finally{h&&h.dispose()}}A_k(b){const h=new bd.a(new Fd.a);for(const r of b)h.add(r);return h}}Object(n.a)(Po,"ActivityIndicatorManager",null,[]);class Cr{constructor(){this.skb=this.S7a=null;this.isFirstDocumentOpen=this.M0d=!1}}Object(n.a)(Cr,"ActivityStateManager",null,[694]);class Ka{constructor(b,h){this.gid={};this.nVb=b;this.JK=
h;this.xgc=new vb.a}get YR(){return this.nVb.YR}MGb(b){const h=new bd.a(new Fd.a);if(!b)return h;b=this.nVb.SQd(b);for(let r=0;r<b.length;r++){const B=b[r];this.FJb(B)&&h.add(B)}return h}SQc(b){return this.nVb.SQc(b)}sSd(b){const h=new vb.a;if(b)for(const r of b)h.addRange(this.SQc(r));return h}qwk(b){const h=new bd.a(new Fd.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const B of b.Jv){h.add(B);this.YR.add(B);const P=B.toString();this.gid[P]||(this.gid[P]=new vb.a);this.gid[P].add(b)}this.KEh();
return h}FJb(b){return this.YR&&b?this.YR.contains(b):!1}xPc(b,h){if(b&&(b=this.gid[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.J(0)}return null}V9b(b){return this.nVb.V9b(b)}KEh(){this.nVb.kYk()}YPc(b){return this.nVb.YPc(b)}aai(b){if(!this.JK)return null;const h=this.JK.Mc;return h?h.Eb(b):null}}Object(n.a)(Ka,"ChangeIdCache",null,[]);var Fb=c(157),jc=c(103);class Qc extends Fb.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new jc.a,{T_:Qc.getTypeName(),B_:Qc.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(n.a)(Qc,"ChangeSummariesResponse",Fb.a,[]);var rd=c(446);class Yd extends rd.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new jc.a,{T_:Yd.getTypeName(),B_:Yd.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)(Yd,"ChangeSummariesRequest",rd.a,[]);var Ue=c(336),ze=c(372),Bf=c(243),Fg=c(371);class pi{constructor(){this.vjc=this.U7c=null}}Object(n.a)(pi,"ActionPair",null,[]);class Og{constructor(b,h,r,B){this.swl=P=>{P=P.customData;const ca=this.R$i(P);ca&&(t.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Xsf(P)),ca.vjc("Request timeout"))};this.nB=b;this.$V=h;this.Je=r;this.Ib=B;this.gFe=null;this.CPe=
new Rb.a;this.Sdh=new Rb.a}YFo(b){const h=Object.assign(new Ue.a,{parentPath:["Signal",Yd.getTypeName()],items:[Object.assign(new ze.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((B,P)=>{this.CPe.Z(b.requestId,Object.assign(new pi,{U7c:B,vjc:P}))});this.Sdh.Z(b.requestId,new Date);t.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Og.requestTimeoutMs);this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Fg.a,
{operation:h}));this.xno(b.requestId);return r})}initialize(){this.gFe||(this.gFe=this.nB.ll().then(()=>{this.Je.ob(this,Qc.getTypeName())}));return this.gFe}KB(b,h){if(b&&Bf.a.getTypeNameFor(b.content)===Qc.getTypeName())if(b=b.content){var r=this.R$i(b.correspondingRequest);r?h!==Ue.a.getTypeName()?r.vjc("Invalid operation type"):(t.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Xsf(b.correspondingRequest)),
r.U7c(b)):t.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Xsf(b.correspondingRequest))}else t.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else t.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}xno(b){const h=new Oe.a(3,1,Og.requestTimeoutMs,
this.swl,176);h.nBd=0;h.customData=b;this.Ib.Wb(h)}R$i(b){if(!b)return null;let h;if(!({value:h}=this.CPe.Fc(b,h)).returnValue)return null;this.CPe.remove(b);return h}Xsf(b){if(!b)return-1;let h;return({value:h}=this.Sdh.Fc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return v.AFrameworkApplication.K.nc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(n.a)(Og,"ChangeSummariesAugloopProvider",null,[55]);class Mj{constructor(){this.activityGroups=null}}Object(n.a)(Mj,
"FeaturedActivityGroupPayload",null,[]);class ck{constructor(b,h,r,B,P){this.Ohk=b;this.oXj=h;this.fZj=r;this.P1j=B;this.Usb=P}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.P1j.Cyb.then(()=>this.kYl(b)):ck.nif}wom(b,h,r){if(!h)return t.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Hl("TranslateFeaturedActivityGroups");r=this.fZj.wOo(b,h,r.wywaActivities);t.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.Usb.set(h.correspondingRequest,r);return Object.assign(new Mj,{activityGroups:r})}kYl(b){Hl("BuildFeaturedActivityGroupRequest");const h=this.Ohk.FNk();if(!h||!h.documentContent||!h.activityChanges)return t.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
ck.nif;if(!h.documentContent.length||!h.activityChanges.length)return ck.nif;t.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);Hl("SubmitFeaturedActivityGroupRequest");return this.oXj.YFo(h).then(r=>this.wom(h,r,b))}}ck.nif=Promise.resolve(Object.assign(new Mj,{activityGroups:[]}));Object(n.a)(ck,"ChangeSummariesDataProvider",null,[693]);class $m{constructor(b,h){this.ny=b;this.Bmk=h}FNk(){const b=new vb.a,
h=new vb.a,r=new bd.a(new Fd.a);var B=this.ny.YR;if(!B||!B.count)return $m.qif;B=this.ny.sSd(B);if(!B||!B.count)return t.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),$m.qif;for(const P of B)r.contains(P.id)||(r.add(P.id),this.XJn(P,b,h));return h.count&&b.count?Object.assign(new Yd,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Um.a(U.a.create())}):$m.qif}XJn(b,h,r){if(Td.ParagraphReader.Xb(b)){var B=
Td.ParagraphReader.Wda(b);if(B&&B.length){h.add(B);B=this.ny.MGb(b);B=this.Fnm(B);for(const P of B){B=new vb.a;const ca=this.getTextRanges(b,P);for(const ra of ca)B.add({changeEnd:ra.endIndex,changeSpanId:ra.tgo,changeStart:ra.startIndex,contentIndex:h.count-1,locationId:Um.a(b.id)});(B=this.y9k(P,B.toArray()))&&r.add(B)}}else t.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else t.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Fnm(b){const h=
new Rb.a;for(const r of b)(b=this.Zei(r))?(h.nb(b)||h.Z(b,new bd.a(new Fd.a)),h.J(b).add(r)):t.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}y9k(b,h){const r=[];let B=null;for(const P of b)if(b=this.ny.xPc(P,U.a.nil)){if(!B){const ca=this.Zei(P);if(!ca||!ca.length){t.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}B=
ca}r.push(b)}else t.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return r.length?B?h.length?{activityId:r[0].activityId,changes:h,personId:B,timestamp:r[0].displayTimestamp.toISOString()}:(t.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(t.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(t.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}Zei(b){b=this.ny.xPc(b,U.a.nil);if(!b)return t.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return t.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new vb.a;if(!h||!h.count||!b)return r;let B=-1,P=new bd.a(new Fd.a);for(let ca=0;ca<b.ra.length;ca++){const ra=b.ra.J(ca);if(-1!==B&&ra.Dr){if(ra.changeStart&&h.contains(ra.changeStart)){P.add(ra.changeStart);continue}r.add({startIndex:B,endIndex:ra.cp,tgo:this.Bmk.lkj(P)});B=-1;P=new bd.a(new Fd.a)}ra.changeStart&&h.contains(ra.changeStart)&&(B=ra.cp,P.add(ra.changeStart))}return r}}$m.qif=Object.assign(new Yd,{activityChanges:[],
documentContent:[],requestId:Um.a(U.a.nil)});Object(n.a)($m,"ChangeSummariesRequestBuilder",null,[]);class Aj{constructor(){this.changes=this.content=null}}Object(n.a)(Aj,"ContentChange",null,[]);class un{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(n.a)(un,"FeaturedActivityGroup",null,[]);class Ip{constructor(){this.end=this.start=0}}Object(n.a)(Ip,"TextRange",null,[]);class Ma{constructor(b){this.Vqc=b}wOo(b,h,r){if(!h)return t.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Ma.PMd;if(!h.inferences)return t.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Ma.PMd;if(!h.activityClassifications)return t.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Ma.PMd;if(!h.inferences.length||!h.activityClassifications.length)return t.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Ma.PMd;const B=[],P=new Fa.a(new Fd.a);for(const ca of h.inferences){const ra=this.vOo(ca,b,h,r);if(!ra)continue;const Qa=this.Vqc.D1l(Um.b(ra.locationId));Qa.equals(U.a.nil)?B.push(ra):P.nb(Qa)?P.J(Qa).ranking>ra.ranking&&P.Z(Qa,ra):P.add(Qa,ra)}b=[...Array.from(P.values),...B];b.sort((ca,ra)=>ca.ranking-ra.ranking);return b.slice(0,Ma.Obn)}vOo(b,h,r,B){if(!b||Jj.a.af(b.activitiesInGroup))return t.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const P=new vb.a,ca=new Rb.a;let ra=null;for(const mb of b.activitiesInGroup){if(!mb){t.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>mb.activityIndex||mb.activityIndex>=r.activityClassifications.length){t.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Jb=r.activityClassifications[mb.activityIndex];if(!Jb||Jj.a.af(Jb.contents))t.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Qa=this.ODl(B,Jb.activityId);if(Qa){P.add(Qa);for(const Yb of mb.changes){if(!Yb){t.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Qa=Yb.value;if(0>Qa||Qa>=Jb.contents.length){t.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Qa=Jb.contents[Qa];if(!Qa){t.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const fc=h.documentContent[Qa.contentIndex],Mc=Object.assign(new Ip,{start:Qa.changeStart,end:Qa.changeEnd});if(ca.nb(fc))ca.J(fc).add(Mc);else{let Wc;ca.Z(fc,(Wc=new vb.a,Wc.add(Mc),Wc))}ra||(ra=Qa.locationId)}}else t.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!P.count)return t.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.yjm(ca);return h.count?Object.assign(new un,{ranking:b.ranking.value,reasons:[1],activities:P.toArray(),contentChanges:h.toArray(),locationId:ra}):(t.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}ODl(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}yjm(b){const h=new vb.a;for(const B of b){b=B.key;const P=B.value;P.Sc((ca,ra)=>ca.start-ra.start);var r=P.J(0).start;if(r>Ma.nOi){r-=Ma.nOi;b=b.substring(r,b.length);for(const ca of P)ca.start-=r,ca.end-=r}h.add(Object.assign(new Aj,{content:b,changes:P.toArray()}))}return h}}Ma.PMd=[];Ma.nOi=10;Ma.Obn=4;Object(n.a)(Ma,"ChangeSummariesResponseTranslator",null,[]);class Za{constructor(){this.Usb=new Rb.a;this.MQe=
new Rb.a}set(b,h){if(h.length&&b){this.Usb.Z(b,h);for(const r of h)if(r.activities)for(const B of r.activities)B&&B.activityId?this.MQe.Z(B.activityId,b):t.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else t.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Usb.nb(b)?this.Usb.J(b):null}A9m(b){return b&&this.MQe.nb(b)?this.MQe.J(b):null}}Object(n.a)(Za,"FeaturedActivityGroupCache",null,
[]);class yb{constructor(b){this.n3d=(h,r,B,P,ca)=>{if(!ca)return t.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ca.Activity;if(!h)return t.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.Usb.A9m(h.activityId);if(!r)return t.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;B=Ae.hH(h);t.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,this.lkj(B));return 32};this.Usb=b;this.MOg=new Map}Ub(b){b.qa(V.a.n3d,Gd.a.frame,this.n3d)}lkj(b){let h=0;const r=Array(b.count);for(const B of b)b=this.a8l(B),r[h]=Um.a(b),h++;return r.join(",")}a8l(b){let h=this.MOg.get(b);if(h&&h!=U.a.nil)return h;h=U.a.create();this.MOg.set(b,h);return h}}Object(n.a)(yb,"FeaturedActivityGroupTelemetryActor",
null,[]);var qc=c(76);class Tc extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(n.a)(Tc,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class dd{constructor(b,h,r){this.gO=null;this.AOo=B=>{this.u_a.reset();B=this.pjm(B.customData);let P=null;for(;B.moveNext();){const ca=B.currentNode;if(ca&&(Td.ParagraphReader.Xb(ca)&&this.sa.raiseEvent("OPV",new Tc(ca)),this.u_a.update(),this.u_a.nnb())){P=ca;break}}P?this.Dqh(P):this.gO(!0)};this.Ib=b;this.u_a=h;this.JK=r;this.sa=new wd.a;this.Cyb=new Promise(B=>
{this.gO=B})}Lyk(b){this.sa.addHandler("OPV",b)}EKk(){this.Dqh(null)}Dqh(b){const h=new Oe.a(3,1,0,this.AOo,182);h.customData=b;this.Ib.Wb(h)}pjm(b){if(!b)return qc.a.gp(this.JK);b=xd.GraphIterator.eb(b);b.zb(7);return qc.a.Gs(b,this.JK)}}Object(n.a)(dd,"DocumentTraverser",null,[]);class Dd{constructor(b){this.oc=b}shouldShowEmptyExperienceButton(){return v.AFrameworkApplication.T1d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.oc.Qb(eb.a.Jje,
2,null)}onInviteOthersButtonClick(){this.oc.Qb(eb.a.U8,2,null)}}Object(n.a)(Dd,"EmptyCatchUpBehaviorManager",null,[692]);class ce{constructor(b,h){this.aIl=()=>{const r=document.getElementById("flyoutItem0");r&&(t.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.np=b;this.Vb=h}initialize(){const b=this.Vb.fe(Zd.AFrame.C4b);b.fI=!0;b.parent=Zd.AFrame.Ap;b.sga(this.aIl);this.np.MT(Zd.AFrame.C4b)}enableF6Focus(){this.np.aJ(Zd.AFrame.C4b)}disableF6Focus(){this.np.fx(Zd.AFrame.C4b)}}
Object(n.a)(ce,"FlyoutFocus",null,[690]);class He{constructor(b,h,r){this.ONg=this.mYg=this.Fxc=this.rpd=!1;this.ZBe=this.Qhd=null;this.itn=(B,P,ca,ra,Qa)=>{Qa[Df.a.Visible]=!0;Qa[Df.a.On]=this.Fxc&&this.rpd;return 32};this.bwn=(B,P,ca)=>{if(1===ca)return this.rpd?(this.mYg||(this.mYg=!0,t.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.Qhd)return t.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.ONg=!0;this.Qhd();return 32};this.ga=b;this.tWg=h;this.Vb=r}get omf(){return this.ZBe?this.ZBe:(t.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set omf(b){this.ZBe=b}initialize(){this.Ub()}registerButtonClickedEvent(b){this.Qhd&&t.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Qhd=b.buttonClickedCallback}onFlyoutInitialized(){this.rpd&&t.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.omf.getTime();t.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.rpd=!0;ne.c(eb.a.FUk,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.Fxc!==b.flyoutIsVisible&&(this.Fxc=b.flyoutIsVisible,ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().updateCommandUI(!0),this.Fxc&&this.ONg&&this.Vb.mg(Zd.AFrame.C4b),this.Fxc||this.tWg&&
this.tWg.V4m())}logFlightTriggers(b){b.hasFlyoutData&&v.AFrameworkApplication.se("WoCha187;WoCha187cf")}Ub(){this.ga.qa(eb.a.tAj,Gd.a.frame,this.bwn);this.ga.fb(eb.a.A6i,Gd.a.frame,this.itn,96)}}Object(n.a)(He,"FlyoutRibbonButton",null,[686]);var xf=c(153);class ai{constructor(b,h){this.YR=null;this.fZd=this.CBi=!1;this.yX=b;this.Re=h;this.Ykb=new xf.a;this.LYd=new Map;this.Ykb.Z(1,new bd.a(new Fd.a));this.Ykb.Z(0,new bd.a(new Fd.a));this.Ykb.Z(2,new bd.a(new Fd.a));this.Ykb.Z(3,new bd.a(new Fd.a));
this.LYd.set(3,"CatchUpIndicatorVisible");this.LYd.set(1,"CatchUpIndicatorPreviewed");this.LYd.set(2,"CatchUpIndicatorSelected");this.oee=0}bLi(b,h){if(this.Ykb.J(h).add(b)){this.F6m(h);switch(h){case 0:t.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:t.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:t.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:t.ULS.sendTraceTag(528593420,
377,50,"LogIndicatorTelemetry: indicator visible")}this.VDh()}}zsn(b){this.Gxl();b=this.yX.MGb(b);for(const h of b)if(this.YR.remove(h)){this.oee++;break}}Gxl(){if(!this.YR){this.YR=new bd.a(new Fd.a);for(const b of this.yX.YR)this.YR.add(b)}}iCk(){t.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.oee);this.VDh()}VDh(){this.oee&&(this.vWk(),this.fWk())}vWk(){!this.CBi&&.5<=this.Ykb.J(0).count/this.oee&&(this.CBi=!0,ne.c(eb.a.HUk),t.ULS.sendTraceTag(590926531,377,
50,"User started Catch Up Passive Session"))}fWk(){if(!this.fZd){var b="";1<=this.Ykb.J(1).count&&(this.fZd=!0,b="previews");1<=this.Ykb.J(2).count&&(this.fZd=!0,b="selections");this.fZd&&(ne.c(eb.a.AUk),t.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}F6m(b){(b=this.LYd.get(b))&&this.Re.logKpiUsage(b,0)}}Object(n.a)(ai,"IndicatorTelemetryActor",null,[]);var Bi=c(485);c(1093);class wg{constructor(b,h){this.A$c=b;this.sIc=h}olm(){return this.sIc.promise.then(b=>
b.getWywaActivitiesResponse)}getActivities(b,h){return Bi.b(this.A$c.requestActivities(b,h))}getRelevantActivities(b,h){return this.sIc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):Bi.b(this.A$c.requestRelevantActivities(b,h)))}updateActivityState(b){return Bi.b(this.A$c.updateActivityState(b))}getActivityFeed(){return this.sIc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Bi.b(this.A$c.requestActivityFeed()))}updateWaterline(){return Bi.b(this.A$c.p6n())}}
Object(n.a)(wg,"ActivityRepository",null,[]);var Qi=c(1094),hk=c(1602);class sj{constructor(b,h,r,B,P,ca=!1){this.activityContentManager=b;this.oc=h;this.Jsl=r;this.Re=B;this.wzm=P;this.wdc=ca}hOf(b){const h=new Map;h.set("activityType",b.type.toString());this.Re.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}wNf(b){this.Re.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}Ogn(b){try{const h=b.activity;
this.hOf(b.activity);1==h.type&&this.wzm.T3d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.SQo(h),this.wNf("Content does not exist"),Promise.resolve(2);const r={};let B=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);B=this.oc.Qb(eb.a.F9e,2,r);break;case 1:r.Activity=h,r.NodeId=b.locationId,B=this.oc.Qb(V.a.Ihg,2,r),r.NodeId&&this.oc.Qb(V.a.n3d,2,r)}8==B&&this.wNf("Action failed")}catch(h){return t.ULS.sendTraceTag(592237846,
3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.wNf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.Jsl.Cyb.then(()=>this.Ogn(b))}}Object(n.a)(sj,"WordActivityNavigationManager",null,[685]);var mf;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=
8]="D504X504";b[b.D648X648=9]="D648X648"})(mf||(mf={}));Object(n.b)("ProfilePhotoDimension",mf);var Ve=c(782),ef=c(1501);class og{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(n.a)(og,"ActivityFeedEntry",null,[]);const Ig=(b,h)=>h.dZc?vo.toArray(vo.select(vo.asEnumerable(b),r=>{if(!r||!r.activityFeedItemPayload)return r;const B=JSON.parse(r.activityFeedItemPayload);var P=B.actor;if(!P||P.pictureUrl)return r;const ca=
P.userPrincipalName||P.email;if(!ca)return r;P=h.BDb(ca,P.provider,v.AFrameworkApplication.em,0);if(!P)return r;B.actor.pictureUrl=P;return Object.assign(new og,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(B),timestamp:r.timestamp})})):b,Uk=(b,h)=>{const r=new Map,B=new Map;for(const P of b){if(!P||!P.activityFeedItemPayload)continue;b=JSON.parse(P.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;
ca&&!B.has(ca)&&B.set(ca,new Ve.a(ca,null,b.name))}B.forEach(P=>{const ca=h.qac(P,6);r.set(P.UserId,ca)});return r};var di=c(510);class zk{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(n.a)(zk,"ActivityRequestPayload",null,[]);class yl{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(n.a)(yl,"Person",null,[]);class $k extends vd{constructor(){super();
this.relationship=0}}Object(n.a)($k,"TaskActivity",vd,[]);class Vp extends vd{constructor(){super();this.contentId=null}}Object(n.a)(Vp,"CommentActivity",vd,[]);class Mt extends Vp{constructor(){super()}}Object(n.a)(Mt,"CommentReplyActivity",Vp,[]);class Xo extends Vp{constructor(){super();this.e1i=null}}Object(n.a)(Xo,"MentionActivity",Vp,[]);class Ys{constructor(b,h,r,B){this.Vsb=b;this.dNa=h;this.MBc=r;this.iO=B;this.iO.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Vsb.olm().then(b=>
{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.$bf("GetWYWAActivities",b);155===b.StatusCode&&(t.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.iO.isFirstDocumentOpen=!0);const h=this.Wng(b.People);return Object.assign(new zk,{activities:this.cne(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.Vsb.getActivities(b,
h).then(r=>{if(!r||r.StatusCode)throw this.$bf("GetActivities",r);const B=this.Wng(r.People);return Object.assign(new zk,{activities:this.cne(r.Activities,B),actors:B,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.Vsb.getRelevantActivities(b,this.iO.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.$bf("GetRelevantActivities",h);const r=this.Wng(h.People),B=this.cne(h.NewActivities,r,2);h=this.cne(h.OutstandingActivities,
r,3);for(const P of h)B.push(P);return Object.assign(new zk,{activities:B,actors:r})})}updateActivityState(b){return this.Vsb.updateActivityState(b)}requestActivityFeed(){return this.Vsb.getActivityFeed().then(b=>({activityFeedItems:this.eDm(b),personaColorMap:this.XOk(b)}))}cne(b,h,r=1){const B=[];if(!b)return B;for(const ra of b){var P=null;b=[];b.push(h[ra.CreatorIndex]);switch(ra.ActivityType){case 1:P=ra;var ca=new Ae;ca.Jv=new vb.a;for(const Qa of P.ChangeIds)ca.Jv.add(Um.b(Qa));ca.objectId=
Um.b(P.ObjectId);P=ca;break;case 2:P=ra;ca=new Vp;ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 4:P=ra;ca=new Xo;b.push(h[P.MentioneeIndex]);ca.e1i=P.ParentContentId;ca.navigationId=P.NavigationId;P=ca;break;case 3:case 10:P=ra;ca=new Mt;b.push(h[P.RepliedIndex]);ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 6:case 7:case 8:case 9:P=ra,ca=new $k,b.push(h[P.MentioneeIndex]),ca.navigationId=P.NavigationId,ca.relationship=P.Relationship,P=ca}P&&(P.actors=
b,P.displayTimestamp=new Date(ra.DisplayTimestamp),P.activityId=Um.b(ra.ActivityId).toString(),P.type=ra.ActivityType,1!==r&&(P.relevancy=r),B.push(P))}return B}$8n(b,h,r){return this.MBc&&this.MBc.dZc?this.MBc.BDb(h,r,v.AFrameworkApplication.em,mf.default):b}Wng(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const B=new yl;B.id=b[r].Id;B.provider=b[r].Provider;B.displayName=b[r].DisplayName;B.email=b[r].Email;B.imageUrl=this.$8n(b[r].PictureUrl,b[r].Email,
b[r].Provider);this.dNa&&(B.color=this.dNa.qac(new Ve.a(B.email,void 0,B.displayName),ef.a.catchUpFlyout));h[r]=B}return h}$bf(b,h){let r="null";h&&(r=di.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}eDm(b){return this.MBc?Ig(b,this.MBc):b}XOk(b){return this.dNa?Uk(b,this.dNa):new Map}}Object(n.a)(Ys,"WordActivityRequestManager",null,[684]);class es{constructor(b,h,r){this.osd=0;this.XBc=!1;this.B4g=null;this.updateWaterline=()=>{if(qe.App.lostSession)t.ULS.sendTraceTag(51217553,
391,100,"The session is lost. Stop fetching new activities.");else if(this.XBc||3>=this.osd){this.XBc?this.XBc=!1:this.osd++;const B=Math.max(this.Ca.nc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.B4g),0);t.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",B);kk.Task.delay(B).continueWith(()=>{this.Vsb.updateWaterline().then(()=>{this.Pfe();return null}).catch(()=>{this.Pfe();this.XBc=!0;this.osd=0})})}else this.Pfe()};this.Ca=b;this.Vsb=r;h.CCd(()=>
{this.XBc=!0;this.B4g=new Date;this.osd=0})}start(){this.Pfe()}Pfe(){window.setTimeout(this.updateWaterline,6E4)}}Object(n.a)(es,"WordEditorActivityScheduler",null,[]);class Zs{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}Dho(b){this.resolve(b)}}Object(n.a)(Zs,"CatchUpNetworkRequestWorkerCache",null,[]);class tr{constructor(b,h,r){this.Ohl=b;this.K=h;this.Re=r}JZf(b){b&&b.authors&&this.y6m(b.authors)}y6m(b){for(const h of b)h&&h.displayName===this.Ohl&&(this.Re.logKpiFailure("CatchUpActivitiesReady",
"CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),t.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(n.a)(tr,"WywaAuthorComparator",null,[]);class Av{constructor(b){this.L1=b}T3d(){this.L1&&this.L1.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(n.a)(Av,
"IndicatorSurveyActor",null,[]);var Nt=c(1065),Fq=c(1058);class dx{constructor(){this.IUk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get CUk(){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get bEf(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",!1)}get Mxi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",
!1)}get exi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get hZd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get BZd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",!1)}get DXm(){return v.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get wdc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",
!1)}wc(b){Hl("Configure");this.container=b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new Zs).ha()}init(){Hl("Init");this.CUk&&(L.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,v.AFrameworkApplication.rootQuerySignature,qe.App.webServiceBase+"OneNote.ashx",yk.a.word,this.hZd)}),Hl("HotStore"),qe.App.h6.U3a.execute(()=>{Hl("ChromeReady");Qk.a.get_instance().pk(7,()=>{Hl("ScriptDownload");
(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("catchUpActivity")).catch(b=>{t.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.Imn()).catch(b=>{t.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}Imn(){Hl("CreateObjectsAndInitializeState");this.O5m();
this.L9k();return this.xBm()}O5m(){t.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");t.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");t.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.bEf&&t.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.Mxi&&t.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.exi&&t.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");
t.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.DXm);this.hZd&&t.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}xBm(){this.cCm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").omf=new Date;Hl("InitializeCatchUpApp");return this.B4b.initialize(Object.assign(new Vq,{featuredActivityGroupsEnabled:this.bEf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Mxi,customDynamicEntryPointEnabled:this.exi,activityFeedDataEnabled:this.hZd})).then(()=>
{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}L9k(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Ka(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Jk.App.pn.jb.rc.ed)).ha();this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new Nt.a(xa.Health.instance,new Fq.a,this.IUk)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Cr).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",
()=>new Yf(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),v.AFrameworkApplication.va,Ik.UISurfaces.MM(),this.wdc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new wg(new Qi.a(Db.a.oAj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>v.AFrameworkApplication.rootQuerySignature,qe.App.webServiceBase+"OneNote.ashx",yk.a.word,Db.a.oAj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),
this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Ys(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.wdc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",
()=>new Lj(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),Jk.App.pn.jb.rc,new hk.a(Jk.App.pn.jb.rc),lh.a.instance,kb.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",
!1)?new Eq.a(50,Qd.a.$e):new Mo;return new dd(v.AFrameworkApplication.lc,b,Jk.App.pn.jb.rc.ed)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new Av(this.container.Sa("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new sj(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.wdc)).ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new He(v.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),kb.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new ce(Xl.a.instance,kb.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();
this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Za).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Oo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Jk.App.pn.jb.rc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new yb(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();
this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new ck(new $m(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Og(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.lc),new Ma(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),
this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.wdc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Dd(v.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();this.B4b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new No,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:v.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:v.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.hZd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):
null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Tm.a}));this.B4b.setWebpackPublicPath(v.AFrameworkApplication.b6);this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new Jh(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();
this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new es(v.AFrameworkApplication.K,sr.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new ai(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",
()=>new qq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.B4b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Jk.App.pn.jb.rc,this.container.Sa("Common.IZoomManager"),v.AFrameworkApplication.lc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!qe.App.instance&&qe.App.instance.Jpa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!qe.App.instance&&qe.App.instance.cD)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Po(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Jk.App.pn.jb.rc.ed,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.BZd)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new qa(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),v.AFrameworkApplication.va,kb.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new tr(v.AFrameworkApplication.userName,v.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}cCm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");
b.j7a(h);const r=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const B=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const P=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ca=lh.a.instance,ra=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");
ca.Xw(()=>{P.M0d?P.M0d=!1:(P.S7a&&r.IYi(null,null,!1),P.skb&&r.PXi(null,null),B.u8e())});ca.Xw(Object(z.a)(h,h.WY,"onSelectionChanged"));this.B4b.getWywaEvent().addListener(Object(z.a)(b,b.JZf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.B4b.getWywaEvent().addListener(Object(z.a)(b,b.JZf,"onWywaActivityReady"));const Qa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");ra.Lyk((mb,Jb)=>{Jb&&Qa.zsn(Jb.node)});ra.Cyb.then(()=>
{Qa.iCk()});this.B4b.getWywaEvent().addListener(()=>{ra.EKk()});B.Xwk((mb,Jb)=>{Jb&&r.PXi(Jb.iFb,Jb.Cri)});B.Ywk((mb,Jb)=>{Jb&&r.IYi(Jb.iFb,Jb.Cri,Jb.Buo)});B.Ub(v.AFrameworkApplication.va);this.bEf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Ub(v.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();
this.Myo()}Myo(){rh.c()&&(t.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(n.a)(dx,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Dr=c(189),Wq=c(401),ex=c(1532),Kk=c(457),Qo=c(1641),Yl=c(1538),Qx=c(1703),Bv=c(1704),Uu=c(645),$s=c(1705),ur=c(870),Ro=c(138),Bo=c(1541);class Vu{constructor(){this.nt=this.annotation=null}}Object(n.a)(Vu,
"AnnotationChangedData",null,[]);class Ot{constructor(b,h,r,B,P,ca,ra,Qa=!1,mb){this.annotationType=b;this.tA=h;this.eq=r;this.Tmc=B;this.zed=P;this.i2o=ca;this.jb=ra;this.wqj=Qa;this.K=mb;this.YA=null;this.FBi=!1;this.fd=new wd.a;this.P1c=0}jG(b){this.fd.addHandler("AnnotationChangedEvent",b)}kI(b){this.fd.removeHandler("AnnotationChangedEvent",b)}register(){return this.zed().then(()=>{0===this.P1c&&(this.wqj&&(this.YA=this.eq.Yf("WebServiceCall",this.annotationType)),this.tA.ob(this,this.annotationType));
this.P1c++})}unregister(){return this.zed().then(()=>(new Promise(b=>setTimeout(b,this.K.nc(Ro.a.gnl,3E3)))).then(()=>{0<this.P1c&&(this.P1c--,0===this.P1c&&this.tA.uc(this,this.annotationType))}))}q9b(){return this.zed().then(()=>this.tA.getAnnotationsByType(this.annotationType))}y5h(b){b=Wq.a.DJ(b);return(b=this.tA.zof(b))&&0<b.count?b.toArray().filter(h=>Bf.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.i2o(this.jb.Zc.xd,b.parentPath):
null:(t.ULS.shipAssertTag(575930380,3016,!1),null)}gwa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new ur.a,{parentPath:["Signal",Bf.a.getTypeNameFor(b)],items:[Object.assign(new ze.a,{body:b})]});this.Tmc.submitOperation(b)}uvl(b,h){b=Object.assign(new Ue.a,{parentPath:["Signal",h],items:b});this.Tmc.submitOperation(b)}KB(b,h){b?h?(this.wqj&&!this.FBi&&(this.YA.stop(),this.FBi=!0),this.fd.j9&&(b=new Bo.a(Object.assign(new Vu,{annotation:b,nt:h})),this.fd.raiseEvent("AnnotationChangedEvent",
b))):t.ULS.shipAssertTag(575930382,3016,!1):t.ULS.shipAssertTag(575930381,3016,!1)}}Object(n.a)(Ot,"AnnotationManager",null,[750,55]);class fs{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.pJ=b;this.ofe=h;this.CFb=r;this.n2a=B;this.J8=P;this.Gzj=ca;this.a2=ra;this.hSb=Qa;this.q7b=mb;this.iOb=Jb;this.HIo=Yb}}Object(n.a)(fs,"AnnotationManagerHolder",null,[751]);class ru{constructor(b,h){this.X3=b;this.zed=h}submitOperation(b){return this.zed().then(()=>{this.X3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Fg.a,
{operation:b}))})}}Object(n.a)(ru,"SubmitOperationHelper",null,[]);var fx=c(1088),su=c(1706),gx=c(1091),rg=c(91),ni=c(124),xo=c(78),Qr=c(774);class Vi{constructor(b,h,r){this.J8=b;this.sm=h;this.iNb=r;this.PEa={};this.GUh=!1;this.Knb=(B,P)=>{var ca;P.data.nt!==Ue.a.getTypeName()&&P.data.nt!==Qr.n.getTypeName()||!P.data.annotation||P.data.annotation.annotationType!==su.a.getTypeName()||(B=P.data.annotation.content)&&null!==(ca=B.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.FUh=B.documentTypeConfidences[0].documentTypeLabel,
t.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.FUh))};this.J8.jG(this.Knb);this.J8.register();this.PEa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}DSd(){this.GUh||(this.J8.gwa(new gx.a),t.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.GUh=!0);this.Mgf();this.PEa.docType=this.FUh;this.PEa.characterCount=
this.characterCount;this.PEa.paragraphCount=this.fS;this.PEa.imageCount=this.HJ;this.PEa.tableCount=this.X$;this.PEa.listElementsCount=this.BHi;this.PEa.blobsCount=this.zHc;this.PEa.pageCount=this.iNb.rHb();this.PEa.currentPage=this.iNb.qei();return this.PEa}Mgf(){this.fS=this.zHc=this.BHi=this.X$=this.HJ=this.characterCount=0;var b=this.sm.Joa(Jk.App.pn.jb.rc.ed,7,7).currentNode,h=xd.GraphIterator.eb(b);for(b=qc.a.Gs(h,b);b.moveNext();)if(h=b.currentNode)if(ye.ImageReader.Mt(h))this.HJ++;else if(mi.TableReader.LR(h))this.X$++;
else if(rg.ListItemReader.lg(h))this.BHi++;else if(Td.ParagraphReader.Xb(h)){var r=xo.e(h);for(let B=0;B<r.length;B++)5===r[B].vh?this.HJ++:this.zHc++;r=ni.AParagraphNode.QP(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!Td.ParagraphReader.N0(h)&&!Td.ParagraphReader.HR(h)&&this.fS++}}}Object(n.a)(Vi,"LoggingDocumentInfo",null,[748]);class Cv{constructor(){this.sa=new wd.a}gzk(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}I2n(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}byk(b){this.sa.addHandler("BlueDotClickedEvent",b)}n2n(b){this.sa.removeHandler("BlueDotClickedEvent",b)}pyk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}ryk(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}oyk(b){this.sa.addHandler("OnFormattingAccept",b)}qyk(b){this.sa.addHandler("OnFormattingReject",b)}Xyk(b){this.sa.addHandler("OnReviewInvalidated",b)}Krh(b){this.sa.addHandler("OnTraigeAction",b)}H0e(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}B2n(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}Zxk(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}Tyk(b){this.sa.addHandler("OnRegisterEnhancement",b)}izk(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}J2n(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}c6c(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Bo.a(b)):t.ULS.shipAssertTag(575930374,3016,!1)}fPn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Bo.a(b)):t.ULS.shipAssertTag(575930375,3016,!1)}iPn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new Bo.a(b)):t.ULS.shipAssertTag(575930376,3016,!1)}d7i(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Bo.a(b)):t.ULS.shipAssertTag(573850377,3016,!1)}hPn(b){b?this.sa.raiseEvent("OnFormattingAccept",new Bo.a(b)):t.ULS.shipAssertTag(575930377,3016,!1)}jPn(b){b?this.sa.raiseEvent("OnFormattingReject",new Bo.a(b)):t.ULS.shipAssertTag(575930378,3016,!1)}kPn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Bo.a(b)):t.ULS.shipAssertTag(575930379,3016,!1)}N5f(b){b?this.sa.raiseEvent("OnTraigeAction",
new Bo.a(b)):t.ULS.shipAssertTag(573850378,3016,!1)}e7i(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Bo.a(b)):t.ULS.shipAssertTag(573850379,3016,!1)}ePn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Bo.a(b)):t.ULS.shipAssertTag(573687395,3016,!1)}ijc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Bo.a(b)):t.ULS.shipAssertTag(555055117,3016,!1)}y7i(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Bo.a(b)):t.ULS.shipAssertTag(540587343,3016,!1)}}Object(n.a)(Cv,"ReviewEvents",
null,[667]);class Dv{constructor(b){this.hu=b;if(!b)throw Dr.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.W=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new ru(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Wq.a.ll)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new fx.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",
()=>new Cv).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new fs(this.lEa(Yl.DocumentRoleDetectionAnnotation.getTypeName()),this.lEa(Yl.RoleDetectionAnnotation.getTypeName()),this.lEa(ex.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.lEa(ex.FormattingSuggestionsAnnotation.getTypeName()),this.lEa(Kk.DocumentTypeClassifierAnnotation.getTypeName()),this.lEa(Bv.ThemeExtractorAnnotation.getTypeName()),this.lEa(Uu.ThemeGeneratorAnnotation.getTypeName()),this.lEa(Qx.TextToImageAnnotation.getTypeName()),
this.lEa(Qo.DocumentPullQuoteAnnotation.getTypeName()),this.lEa(Qo.PullQuoteAnnotation.getTypeName()),this.lEa($s.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new Vi(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}lEa(b,h=!1){return new Ot(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Wq.a.ll,Wq.a.vjb,this.hu,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(n.a)(Dv,"PackageManager",null,[1,2]);var Xq=c(1054),ir=c(1525),gs=c(1709);class kq extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.RTf=h}}Object(n.a)(kq,"RoleChangeArgs",Sys.EventArgs,[]);class lw{constructor(b){this.Oh=!1;this.H7=b;this.H7.Ood++}dispose(){this.Oh||(this.Oh=!0,this.H7.Ood--)}}Object(n.a)(lw,"InvalidationSuspension",
null,[10]);class pm{constructor(){this.Cbd=null;this.role=this.n5d=0;this.sBb=this.T0d=this.xia=this.rec=!1;this.u4d=this.k0c=this.UPa=null;this.t7a=this.placeholder=!1;this.BDd=this.Ocf=null;this.ADd=0}get A4a(){return!this.role||!this.UPa||!this.UPa.length}SGm(){this.sBb=this.T0d=!0}UXm(){return!!this.role||!!this.UPa||!!this.Cbd}}Object(n.a)(pm,"RoleState",null,[695]);class Zl{constructor(b,h,r,B,P){this.Zh=!1;this.TYd=null;this.hPf=new Dh.a;this.fZg=0;this.q$n=(ca,ra)=>{ra.data.nt===Ue.a.getTypeName()&&
(ra=ra.data.annotation,(ca=ra.content)?(ra=this.O_b.getParent(ra))&&this.V9c(ra,ir.f(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):t.ULS.shipAssertTag(575813856,3016,!1))};this.usl=(ca,ra)=>{if(ra.data.nt===Ue.a.getTypeName())if(ca=ra.data.annotation.content)for(t.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.hPf=new Dh.a,ra=0;ca.listInfos&&ra<ca.listInfos.length;ra++){const Qa=ca.listInfos[ra];this.hPf.Z(Qa.listID,Qa)}else t.ULS.shipAssertTag(556323522,
3016,!1)};this.tAi=(ca,ra)=>{ca=ca.UL;if(!ca||ca.ja(Oc.a.uB,!1))return!1;ca=ca.getValue(Oc.a.ma);if(!ca)return!1;ca=ir.g(ca);return 1!=ca&&ca!=ra.role};this.WJl=(ca,ra)=>{ca=ra.data.annotation;const Qa=this.Dmd.getParent(ca);if(Qa)if(ra.data.nt===Ue.a.getTypeName()){const mb=ra.data.annotation.content;mb?this.oea(Qa,Jb=>{this.TYd&&Jb.Ocf&&this.TYd>Jb.Ocf&&!Jb.sBb||Jb.role!==Jb.n5d||this.tAi(Qa,Jb)?(t.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.TYd,Jb.sBb,Jb.role===Jb.n5d),Jb.Cbd=mb.suggestions):(Jb.UPa=mb.suggestions,Jb.sBb=!1)}):t.ULS.shipAssertTag(575813859,3016,!1)}else ra.data.nt===Xq.a.getTypeName()&&this.oea(Qa,mb=>{mb.UPa=null;mb.Cbd=null});else t.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};this.opn=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.oea(ca,Qa=>{ra.data.FJj?(Qa.BDd=Qa.UPa,Qa.ADd=Qa.role):(Qa.BDd=null,Qa.ADd=0);Qa.xia=!0}):t.ULS.shipAssertTag(575930368,
3016,!1)};this.qpn=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.oea(ca,Qa=>{Qa.xia=!1;Qa.BDd=null;Qa.ADd=0;5!==ra.data.state&&(Qa.UPa=null)}):t.ULS.shipAssertTag(573850380,3016,!1)};this.mpn=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.oea(ca,Qa=>{Qa.xia=!0}):t.ULS.shipAssertTag(575930369,3016,!1)};this.ppn=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.V9c(ca,1,!0,!0):t.ULS.shipAssertTag(575930370,3016,!1)};this.rZf=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.V9c(ca,ra.data.RTf,!0,!0):t.ULS.shipAssertTag(575484484,
3016,!1)};this.gnm=(ca,ra)=>{if(ra.node){var Qa=ra.node;ca=this.GA(Qa);27==ca.role&&t.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.xia&&27!==ca.role&&28!==ca.role&&this.rpj(this.IPb-1);ca.A4a||27===ca.role||28===ca.role||this.kpj(this.inconsistenciesCount-1);this.oea(Qa,mb=>{mb.t7a=!0});setTimeout(()=>this.removeNode(Qa),1E4)}else t.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let ra;({value:ra}=this.Du.Fc(ca.id));(null===ra||void 0===ra?0:ra.t7a)&&this.Du.remove(ca.id)};
this.fnm=(ca,ra)=>{ra.node?(ca=ra.node,this.oHf(ca)?this.oea(ca,Qa=>{Qa.t7a=!1}):this.oea(ca,Qa=>{Qa.sBb=!1})):t.ULS.shipAssertTag(540672206,3016,!1)};this.hnm=(ca,ra)=>{ra.node?this.vgg(ra.property,ra.node)&&(ca=ra.node,this.Ood||ca.Nae?this.oea(ca,Qa=>{Qa.sBb=!1}):this.oea(ca,Qa=>{Qa.SGm();Qa.Cbd&&(Qa.UPa=Qa.Cbd,Qa.role=Qa.n5d)}).xia&&this.BZa.kPn(new gs.a(ra.node))):t.ULS.shipAssertTag(575930372,3016,!1)};this.Btn=(ca,ra)=>{switch(ra.data.role){case 27:const Qa=ra.data;this.oea(ra.data.paragraphNode,
Jb=>{Jb.role=27;Jb.rec=!0;Jb.placeholder=Qa.placeholder});break;case 28:const mb=ra.data;this.oea(ra.data.paragraphNode,Jb=>{Jb.role=28;Jb.rec=!0;Jb.placeholder=mb.placeholder;Jb.fpa=mb.fpa});break;case 2:this.oea(ra.data.paragraphNode,Jb=>{Jb.role=2})}};this.Dmd=b;this.O_b=h;this.Oze=r;this.Rq=B;this.BZa=P;this.Du=new Dh.a;this.sa=new wd.a;this.Ood=this.lwd=this.tod=0}get mHm(){return this.Ood}uyk(b){this.sa.addHandler(Zl.gWi,b)}azk(b){this.sa.addHandler(Zl.sYi,b)}$yk(b){this.sa.addHandler(Zl.rYi,
b)}get inconsistenciesCount(){return this.tod}kpj(b){this.tod!==b&&(this.tod=b,this.sa.raiseEvent(Zl.gWi,new Bo.a(this.tod)))}get IPb(){return this.lwd}rpj(b){this.lwd!==b&&(this.lwd=b,this.sa.raiseEvent(Zl.sYi,new Bo.a(this.lwd)))}get eAf(){return this.fZg}oHf(b){return this.Du.nb(b.id)}L4l(b){var h,r;return null===(r=null===(h=this.hPf)||void 0===h?void 0:h.Fc(b))||void 0===r?void 0:r.value}Hei(b,h){var r,B,P;const ca=new Map;for(const ra of h)if(h=ra){const Qa=null!==(P=null===(B=null===(r=this.Du.Fc(h.id))||
void 0===r?void 0:r.value)||void 0===B?void 0:B.role)&&void 0!==P?P:1;b.has(Qa)&&(ca.has(Qa)?ca.get(Qa).add(h):ca.set(Qa,new vb.a([h])))}return ca}GA(b){if(!b)return t.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Du.Fc(b.id)).returnValue?h:Object.assign(new pm,{role:1,rec:!1})}b6n(){this.TYd=new Date;return new lw(this)}register(){this.Dmd.register();this.O_b.register();this.Oze.register()}unregister(){this.Dmd.unregister();this.O_b.unregister();this.Oze.unregister()}initialize(){if(!this.Zh){const b=
this.Rq.Te(12);b.kw(this.gnm);b.ku(this.fnm);b.qo(this.hnm);this.Dmd.jG(this.WJl);this.O_b.jG(this.q$n);this.Oze.jG(this.usl);this.BZa.qyk(this.ppn);this.BZa.oyk(this.mpn);this.BZa.pyk(this.opn);this.BZa.ryk(this.qpn);this.BZa.Krh(this.rZf);this.BZa.Tyk(this.Btn);this.Zh=!0}}Od(){}V9c(b,h,r,B=!1,P=0,ca=0,ra){let Qa=0,mb=!1;this.oea(b,Jb=>{const Yb=Jb.T0d||!Jb.role||1==Jb.role;r||(Jb.n5d=h);if(B||Yb)mb=Jb.role!==h,Qa=Jb.role,Jb.role=h,Jb.rec=r,Jb.T0d=!1,Jb.k0c=P,Jb.u4d=ca,Jb.listItemPrefix=ra,Jb.Ocf=
new Date});if(mb){const Jb=h-4;Jb>this.eAf&&8>Jb&&(this.fZg=Jb);1===h&&this.oea(b,Yb=>{Yb.UPa=null});this.sa.raiseEvent(Zl.rYi,new Bo.a(new kq(b,h,Qa)))}}oea(b,h){let r;if(({value:r}=this.Du.Fc(b.id)).returnValue){b=r.A4a;const B=r.xia;h(r);if(27!==r.role&&28!==r.role){if(r.t7a)return r;b!==r.A4a&&this.kpj(this.inconsistenciesCount+(b?1:-1));B!==r.xia&&this.rpj(this.IPb+(B?-1:1))}}else h(r=new pm),r.UXm()&&this.Du.add(b.id,r);return r}vgg(b,h){({value:h}=this.Du.Fc(h.id));return 28===(null===h||void 0===
h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Pe.a.ho:!(null===h||void 0===h?0:h.placeholder)&&(b===Pe.a.ho||b===Pe.a.Rn||Array.contains(ni.AParagraphNode.cia(),b))}}Zl.gWi="OnInconsistenciesChanged";Zl.sYi="OnRoleReviewCount";Zl.rYi="OnRoleChanged";Object(n.a)(Zl,"RoleLifecycleManager",null,[671,672,673]);class Pt{constructor(b,h,r,B,P){this.BZa=b;this.O_b=h;this.Je=r;this.Rq=B;this.H7=P;this.Zh=!1;this.rZf=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.aGj(ca,()=>!0,Qa=>Qa.userSetRole=
ir.e(ra.data.RTf)):t.ULS.shipAssertTag(557057378,3016,!1)};this.vsn=(ca,ra)=>{0<this.H7.mHm||this.vgg(ra.property)&&this.aGj(ra.node,Qa=>!(Qa&&Qa.isInvalidated),Qa=>Qa.isInvalidated=!0)}}initialize(){this.Zh||(this.BZa.Krh(this.rZf),this.Rq.Te(12).qo(this.vsn),this.Zh=!0)}Od(){}aGj(b,h,r){if(b=(b=this.O_b.y5h(b))&&1===b.length&&b[0]){var B=b.content;B=B&&B.M_&&B.M_.customMetadata;h(B)&&(h=new Yl.RoleDetectionCustomMetadata,h.isInvalidated=B&&B.isInvalidated,h.userSetRole=B&&B.userSetRole,r(h),this.Je.JUo(b,
h))}}vgg(b){return b===Pe.a.ho||b===Pe.a.Rn||Array.contains(ni.AParagraphNode.cia(),b)}}Object(n.a)(Pt,"RoleDetectionMetadataUpdater",null,[670]);class mw{constructor(b,h){this.Tmc=b;this.nEb=h;this.n2c=(r,B)=>{r=B.data;if(r.nt==Qr.a.getTypeName()||r.nt==Qr.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.nEb.jG(this.n2c)}Od(){this.nEb.kI(this.n2c)}Tln(){if(void 0===this.runId)Promise.resolve();else{var b=new Yl.RoleDetectionSettings({acceptedRunId:this.runId});
b=new Qr.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Tmc.submitOperation(b)}}}Object(n.a)(mw,"RoleDetectionSettingsUpdater",null,[]);class st{constructor(b,h,r){this.VFm=b;this.tA=h;this.Zd=r;this.Pti=this.initialized=!1;this.bUi=()=>{this.Yqj()&&(this.psi(),this.tA.f2n(this.bUi))}}initialize(){this.initialized||(this.cCf(),this.initialized=!0)}Od(){}cCf(){this.Yqj()?this.psi():this.tA.Nxk(this.bUi)}Yqj(){return!this.Pti&&
(this.Zd.uxi()||this.tA.icc(Yl.DocumentRoleDetectionAnnotation.getTypeName())||this.tA.icc(Yl.RoleDetectionAnnotation.getTypeName()))}psi(){for(const b of this.VFm)b.initialize();this.Pti=!0}}Object(n.a)(st,"RLMInitializer",null,[]);class tp{constructor(b,h,r){this.DZ=b;this.hu=h;this.ohd=r;this.W=null;this.pka=()=>{this.JVc();this.hu.qpb(this.pka)};if(!b)throw Dr.a.argument("AppLifecycleManager is null");if(!h)throw Dr.a.argument("Workspace is null");if(!r)throw Dr.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>this.xn())}wc(b){this.W=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new mw(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Pt(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ofe,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Zl(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ofe,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new st([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}xn(){this.ohd.NJ?this.DZ.pk(16,()=>this.YUc()):this.YUc()}YUc(){this.hu.Cxa?this.JVc():this.hu.vga(this.pka)}JVc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(n.a)(tp,"PackageManager",null,[1,2]);class jr{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
h){const r=new jr;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(n.a)(jr,"DocumentSwayPreviewContent",null,[]);class Yo{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static k7k(b,h,r,B){const P=new Yo;P.RawText=b;P.ParagraphFormatting=h;P.TextRuns=r;P.IsRTL=B;P.ParagraphIndex=0;return P}}Object(n.a)(Yo,"ParagraphContent",null,[]);var wm=c(99),rq=c(1217);class Tn{constructor(){this.Name=null;this.Size=0}static construct(b,
h){const r=new Tn;r.Name=b;r.Size=h;return r}}Object(n.a)(Tn,"FontData",null,[]);class Vk{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,B,P,ca){const ra=new Vk;ra.IsBold=b;ra.IsUnderline=h;ra.IsUppercase=r;ra.Font=B;ra.Alignment=P;ra.LeftIndent=ca;return ra}}Object(n.a)(Vk,"TextFormatting",null,[]);class Wp{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new Wp;r.RawText=b;r.RunFormatting=
h;return r}}Object(n.a)(Wp,"TextRunContent",null,[]);var Bn=c(104),Zf=c(41);class Da{constructor(b,h){this.yab=null;this.iak=b;this.XN=h||""}get Xzn(){return this.iak.value}bBl(){var b=Date.now();const h=jr.construct(2,this.XN);h.Paragraphs=this.RNl();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();t.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}RNl(){const b=new vb.a;var h=0;let r=0,B=!1;var P=new xd.GraphIterator;P.set(this.Xzn);P=qc.a.gp(P.currentNode);const ca=new Dh.a(0);
for(;P.moveNext()&&2100>r&&25>h;){var ra=P.currentNode;if(Td.ParagraphReader.Xb(ra)&&!Td.ParagraphReader.N0(ra)){!B&&Td.ParagraphReader.HR(ra)&&(B=!0);let Qa=ni.AParagraphNode.QP(ra.characterData);Qa=Qa.trim();if(0<Qa.length){const mb=this.tR(ra);mb.ParagraphIndex=h;h++;r+=Qa.length;b.add(mb);this.eYo(ca,Td.ParagraphReader.language(ra))}}}this.yab=this.PUl(ca);h={};h.documentHasList=B;t.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}PUl(b){let h=-1,r=1033;for(const B of b.keys.toArray())B&&
b.J(B)>h&&(h=b.J(B),r=B);return Hi.a.ug(r)}eYo(b,h){b.nb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}tR(b){const h=ni.AParagraphNode.QP(b.characterData),r=this.s9l(b),B=this.jim(b);b=this.ESm(b);return Yo.k7k(h,r,B,b)}s9l(b){const h=Td.ParagraphReader.Zn(b,Pe.a.bold,!1),r=Td.ParagraphReader.Zn(b,Pe.a.underline,!1);var B=Td.ParagraphReader.Zn(b,Pe.a.fontSize,wm.a.HM);const P=Td.ParagraphReader.Zn(b,Pe.a.font,wm.a.PH);var ca=Td.ParagraphReader.Ox(b);ca=this.lof(ca);const ra=!!Td.ParagraphReader.Zn(b,xe.a.capitalization,
0);b=(new rq.a).yU(b).value/20;B=Tn.construct(P,B);return Vk.construct(h,r,ra,B,ca,b)}jim(b){const h=new vb.a;for(let P=0;P<b.ra.length-1;P++){var r=b.ra.J(P),B=b.ra.J(P+1);r.formatting&&(B=ni.AParagraphNode.QP(b.characterData.substr(r.cp,B.cp-r.cp)),r=this.kim(r.formatting),r=Wp.construct(B,r),h.add(r))}return h.toArray()}kim(b){const h=Bn.FormattingReader.hSc(b,Pe.a.bold,!1),r=Bn.FormattingReader.hSc(b,Pe.a.underline,!1);var B=Bn.FormattingReader.hSc(b,Pe.a.fontSize,wm.a.HM);const P=Bn.FormattingReader.hSc(b,
Pe.a.font,wm.a.PH);B=Tn.construct(P,B);b=!!Bn.FormattingReader.hSc(b,xe.a.capitalization,0);return Vk.construct(h,r,b,B,5,0)}lof(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}ESm(b){const h=new xd.GraphIterator;h.set(b);h.zb(11);return(b=h.jd(11))?Zf.OutlineElementReader.Pn(b):!1}}Object(n.a)(Da,"DocumentContentExtractor",null,[643]);class Ra{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",
()=>new Da(new zf.a(()=>Jk.App.pn.jb.rc.ed),v.AFrameworkApplication.Js.yz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){L.a.instance.Gc(new Ra)}}Object(n.a)(Ra,"DocumentContentExtractorPackage",null,[1,2]);class Ha{}Ha.Vg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(n.a)(Ha,"EmbedDialogHtml",null,[]);class Ba{constructor(b,h,r,B){this.Ehc=
b;this.N3a=h;this.K9d=r;this.value=B}}Object(n.a)(Ba,"OptionInfo",null,[]);class Va{constructor(b,h,r){this.Vbg=b;this.rbc=h;this.N3a=r}}Object(n.a)(Va,"SectionInfo",null,[]);var Gb=c(276);class Cb extends Pf.a{constructor(b,h=!1){super(!1,!1,h);this.ild=476;this.TWb=288;this.fze=798;this.ggk=476;this.fgk=288;this.R3c={};this.Mpb=[];this.sW=this.aZa=this.Rxb=this.xub=this.ptd=this.m_b=null;this.Uuc=v.AFrameworkApplication.WTc;this.wyb=b;this.pNe=Object(z.a)(this,this.oyn,"optionClickHandler");this.JAc=
Object(z.a)(this,this.pyn,"optionKeyHandler");this.iue=Object(z.a)(this,this.gIk,"arrowClickHandler");this.RUb=Object(z.a)(this,this.hIk,"arrowKeyHandler");this.jzd=Object(z.a)(this,this.YJo,"textAreaOnFocusHandler");this.F9j=h;this.Vg=Ha.Vg;this.Cd=0;this.zg="EmbedDialog"}get Pr(){return this.TWb}set Pr(b){this.TWb=b}utj(b){const h={["id"]:this.zg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ka.a.fp(this.wyb,"wdPreview","1"),["initialEmbedUrl"]:this.Uuc,["getEmbedCode"]:Cb.D9h,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Cd=1;this.ye(1,CommonUIStrings.l_CopyAction);this.ye(0,CommonUIStrings.l_Close);this.Uh(CommonUIStrings.l_Embed,null,h)}fmc(){if(this.F9j)this.utj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.m_b=document.getElementById("embedpreviewpane");
this.ptd=document.getElementById("embedoptionpane");this.m_b.style.width=String.format("{0}px",this.ggk);this.aZa=document.createElement("iframe");this.aZa.className=Cb.egk;this.aZa.frameBorder="0";this.aZa.style.height=String.format("{0}px",this.fgk);this.aZa.tabIndex=-1;this.m_b.appendChild(this.XJd(CommonUIStrings.l_Preview,this.aZa,Cb.cch,Cb.bch,Cb.cch,!0));this.sW=document.createElement("textarea");this.sW.className=Cb.i2j;Sys.UI.DomElement.addCssClass(this.sW,Gb.a.K1e);this.sW.id=Cb.mUg;ba.a.vi||
(this.sW.readOnly=!0);this.sW.rows=4;this.sW.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.sW.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.sW.setAttribute(qf.a.Bga,String.format("{0} {1}",Cb.lUg,Cb.kUg));this.m_b.appendChild(this.XJd(CommonUIStrings.l_EmbedCode,this.sW,Cb.lUg));De.a.addHandler(this.sW,"focus",this.jzd);var b=document.createElement("span");b.className=Cb.Y3j;b.innerText=CommonUIStrings.l_CopyText;b.id=Cb.kUg;this.m_b.appendChild(b);this.xub=document.createElement("div");
this.xub.className=Cb.o1j;this.ptd.appendChild(this.XJd(CommonUIStrings.l_Dimensions,this.xub));this.Rxb=document.createElement("div");this.ptd.appendChild(this.B$k(Cb.R$g,this.Rxb));this.Cd=0;this.ye(1,CommonUIStrings.l_Close);this.Ipg();this.THj();ba.a.vi||this.sW.focus()}}dispose(){if(this.R3c){var b=this.R3c;for(let h in b){const r=b[h];this.Pq.uc(Xc.a.click,r.Ehc,this.pNe);this.ge.uc(Xc.a.gi,r.Ehc,this.JAc);this.ge.uc(Xc.a.zh,r.Ehc,this.JAc)}this.JAc=this.pNe=this.R3c=null}if(this.Mpb){for(b=
0;b<this.Mpb.length;++b)this.Pq.uc(Xc.a.click,this.Mpb[b].rbc,this.iue),this.ge.uc(Xc.a.gi,this.Mpb[b].rbc,this.RUb),this.ge.uc(Xc.a.tu,this.Mpb[b].rbc,this.RUb),this.ge.uc(Xc.a.zh,this.Mpb[b].rbc,this.RUb);this.ge=this.iue=this.Mpb=null}this.jzd&&this.sW&&(De.a.removeHandler(this.sW,"focus",this.jzd),this.jzd=null);this.sW=this.aZa=this.Rxb=this.xub=this.ptd=this.m_b=null;super.dispose()}Yda(){super.Yda();this.Kc.style.width=String.format("{0}px",this.fze);this.LDa()}DWo(b,h){const r=ka.a.fp(this.Uuc,
b,h);return this.Uuc!==r?(this.Uuc=r,this.wyb=ka.a.fp(this.wyb,b,h),!0):!1}Ipg(){this.sW&&(this.sW.innerText=Cb.D9h(this.Uuc,this.ild,this.TWb))}THj(){this.aZa&&this.aZa.contentWindow.location.replace(ka.a.fp(this.wyb,"wdPreview","1"))}woe(b,h){this.DWo(b,h)&&(this.Ipg(),this.THj())}XJd(b,h,r=null,B=null,P=null,ca=!1){const ra=document.createElement("div");ra.className=Cb.Rik;B&&(ra.id=B);P&&ra.setAttribute(qf.a.Bga,P);ca&&(ra.tabIndex=0);B=document.createElement("span");B.className=Cb.Sik;B.innerText=
b;r&&(B.id=r);ra.appendChild(B);ra.appendChild(h);return ra}B$k(b,h){const r=this.XJd(CommonUIStrings.l_Interaction,h),B=this.kj.createElement("div");B.className=Cb.UWj;B.id=Cb.uMg+b;B.setAttribute(qf.a.uh,qf.a.Z3);B.tabIndex=0;r.insertBefore(B,h);b=ie.createClusteredImage(16,16,Cb.VWj,Cb.WWj,!0,"");B.appendChild(b);b=b.childNodes[0];b.className=ie.getImageClass(Cb.CTg);b.title=CommonUIStrings.l_Expand;B.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new Va(h,B,b);Array.add(this.Mpb,
h);this.Pq.oE(Xc.a.click,B,this.iue,h);this.ge.oE(Xc.a.gi,B,this.RUb,h);this.ge.oE(Xc.a.tu,B,this.RUb,h);this.ge.oE(Xc.a.zh,B,this.RUb,h);return r}gIk(b){this.cDh(b);return!0}hIk(b){return this.tZc(b,Object(z.a)(this,this.cDh,"changeArrowState"))}cDh(b){b=b.Vo;"visible"===b.Vbg.style.visibility?(b.Vbg.style.visibility="hidden",b.N3a.className=ie.getImageClass(Cb.CTg),b.N3a.title=CommonUIStrings.l_Expand,b.rbc.title=CommonUIStrings.l_Expand):(b.Vbg.style.visibility="visible",b.N3a.className=ie.getImageClass(Cb.iok),
b.N3a.title=CommonUIStrings.l_Collapse,b.rbc.title=CommonUIStrings.l_Collapse)}RLh(b,h){const r=document.createElement("div");r.className=Cb.O$g;r.id=b+Cb.P$g;var B=this.kj.createElement("div");B.tabIndex=0;B.className=Cb.ROg;B.id=b+Cb.tsc;B.setAttribute(qf.a.uh,qf.a.p3e);B.setAttribute(qf.a.xDa,qf.a.xp);B.setAttribute(qf.a.Bga,b+Cb.qWb);r.appendChild(B);r.setAttribute(qf.a.uh,qf.a.xz);var P=ie.createClusteredImage(16,16,Cb.XOg,Cb.WOg,!0,"");B.appendChild(P);P=P.childNodes[0];P.id=b+Cb.Q$g;P.className=
ie.getImageClass(Cb.dwe);B=new Ba(r,P,B,1);this.R3c[b]=B;this.Pq.oE(Xc.a.click,r,this.pNe,b);B=document.createElement("span");B.className=Cb.qWb;B.innerText=h;B.id=b+Cb.qWb;r.appendChild(B);this.ge.oE(Xc.a.gi,r,this.JAc,b);this.ge.oE(Xc.a.zh,r,this.JAc,b);return r}oyn(b){this.z_i(b);return!0}pyn(b){return this.tZc(b,Object(z.a)(this,this.z_i,"optionHandler"))}z_i(b){const h=this.R3c[b.Vo.toString()];h.value?(h.value=0,h.N3a.className=ie.getImageClass(Cb.hXe),h.K9d.setAttribute(qf.a.xDa,qf.a.yM)):
(h.value=1,h.N3a.className=ie.getImageClass(Cb.dwe),h.K9d.setAttribute(qf.a.xDa,qf.a.xp));this.woe(b.Vo.toString(),h.value.toString())}YJo(){this.sW.select()}static D9h(b,h,r){if(!Cb.SLe){const B=String.format('<a target="_blank" href="{0}">{1}</a>',E.a.ibc("https://office.com"),CommonUIStrings.l_Office),P=String.format('<a target="_blank" href="{0}">{1}</a>',E.a.ibc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Cb.SLe=String.format(CommonUIStrings.l_NoFrames,B,P)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
E.a.ibc(b),h,r,Cb.SLe)}}Cb.SLe=null;Cb.dwe="CheckboxChecked_16x16x32";Cb.hXe="CheckboxUnchecked_16x16x32";Cb.iok="OutlookSearchChevronUp_16x16x32";Cb.CTg="OutlookSearchChevronDown_16x16x32";Cb.XOg="CommentChecked";Cb.VWj="UpArrowServer";Cb.qWb="EmbedDescription";Cb.Rik="EmbedSectionHeader";Cb.Sik="EmbedSectionName UIFontBold";Cb.Y3j="EmbedCodeFooter";Cb.WOg="EmbedOptionImage";Cb.egk="EmbedPreviewFrame";Cb.i2j="EmbedCodeTextArea";Cb.O$g="EmbedOption";Cb.o1j="EmbedDimensionSection";Cb.WWj="EmbedArrowIcon";
Cb.UWj="WACGlyph EmbedArrowHolder";Cb.ROg="EmbedCheckBoxHolder";Cb.P$g="Option";Cb.Q$g="OptionImage";Cb.mUg="EmbedCode";Cb.lUg="EmbedCodeHeader";Cb.cch="Preview";Cb.bch="PreviewHeader";Cb.R$g="Options";Cb.uMg="Arrow";Cb.tsc="Check";Cb.kUg="EmbedCodeFooter";Object(n.a)(Cb,"EmbedDialog",Pf.a,[]);class G extends Ba{constructor(b,h,r,B,P){super(b,h,r,B);this.V3a=P}}Object(n.a)(G,"OptionInputInfo",Ba,[]);class ha extends Cb{constructor(b,h){super(b,ha.QL);this.nba=null;this.ouc=[];this.dyd=Object(z.a)(this,
this.KDo,"startOnOptionClickHandler");this.M0b=Object(z.a)(this,this.LDo,"startOnOptionKeyHandler");this.Htd=Object(z.a)(this,this.msn,"onPageNumberChanged");this.rze=Object(z.a)(this,this.son,"onDimensionChanged");this.sH=h}fmc(){if(ha.QL){var b=ha.HQn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.sH.y4i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.sH.n9i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",
["checkboxInitialValue"]:!1,["checkboxLabel"]:this.sH.Wvj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.sH.Xvj}});this.utj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.ild,["defaultHeight"]:this.TWb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.sH.sLj,["heightLabel"]:this.sH.Ooi},["interactionOptions"]:h})}else super.fmc(),this.Poh(this.sH.sLj,"EmbedWidthInput",this.ild),this.Poh(this.sH.Ooi,"EmbedHeightInput",this.TWb),this.Rxb.appendChild(this.RLh("wdPrint",
this.sH.y4i)),this.Rxb.appendChild(this.RLh("wdEmbedCode",this.sH.n9i)),this.Srk(this.sH.Wvj),this.LDa(),kb.FocusManager.nK()&&(b=kb.FocusManager.instance(),h=[document.getElementById(Cb.mUg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Cb.uMg+Cb.R$g),document.getElementById("wdPrint"+Cb.tsc),document.getElementById("wdEmbedCode"+Cb.tsc),document.getElementById("wdStartOn"+Cb.tsc),document.getElementById("wdStartOnText"),document.getElementById(Ai.a.Fgd),
document.getElementById(Cb.bch)],h=new nc(h),b.at().hk=h,ba.a.vi?this.G1(document.getElementById(Ai.a.Fgd)):this.sW.select())}dispose(){if(!ha.QL){if(this.ouc){for(let b=0;b<this.ouc.length;++b)De.a.removeHandler(this.ouc[b],"change",this.rze);this.ouc=this.rze=null}this.Htd&&(De.a.removeHandler(this.nba.V3a,"change",this.Htd),this.Htd=null);this.dyd&&(this.Pq.uc(Xc.a.click,this.nba.Ehc,this.dyd),this.dyd=null);this.M0b&&(this.ge.uc(Xc.a.gi,this.nba.Ehc,this.M0b),this.ge.uc(Xc.a.zh,this.nba.Ehc,this.M0b),
this.M0b=null);this.nba=null}super.dispose()}Poh(b,h,r){const B=document.createElement("label");B.className="EmbedInputPrefix";B.innerText=b;this.xub.appendChild(B);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");B.setAttribute("for",h);this.xub.appendChild(b);this.ouc.push(b);De.a.addHandler(b,"change",this.rze);this.xub.appendChild(document.createElement("br"))}son(b){"EmbedWidthInput"===b.target.id?this.ild=this.mNd(b.target,
375):this.TWb=this.mNd(b.target,250);this.Ipg()}mNd(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}msn(b){b=this.mNd(b.target,1);1===this.nba.value&&this.woe("wdStartOn",b.toString())}Srk(b){const h=document.createElement("div");h.className=Cb.O$g+" EmbedInlineOption";h.id="wdStartOn"+Cb.P$g;const r=this.kj.createElement("div");r.tabIndex=0;r.className=Cb.ROg;r.id="wdStartOn"+Cb.tsc;r.setAttribute(qf.a.uh,qf.a.p3e);r.setAttribute(qf.a.xDa,qf.a.yM);r.setAttribute(qf.a.Bga,
"wdStartOn"+Cb.qWb);h.appendChild(r);h.setAttribute(qf.a.uh,qf.a.xz);var B=ie.createClusteredImage(16,16,Cb.XOg,Cb.WOg,!0,"");r.appendChild(B);B=B.childNodes[0];B.id="wdStartOn"+Cb.Q$g;B.className=ie.getImageClass(Cb.hXe);const P=document.createElement("span");P.className=Cb.qWb;P.innerText=b;P.id="wdStartOn"+Cb.qWb;h.appendChild(P);this.Rxb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.sH.Xvj;b.setAttribute("data-lpignore",
"true");this.Rxb.appendChild(b);De.a.addHandler(b,"change",this.Htd);this.nba=new G(h,B,r,0,b);this.woe("wdStartOn","1");this.Pq.ob(Xc.a.click,h,this.dyd);this.ge.ob(Xc.a.gi,h,this.M0b);this.ge.ob(Xc.a.zh,h,this.M0b)}KDo(b){this.Uvj(b);return!0}LDo(b){return this.tZc(b,Object(z.a)(this,this.Uvj,"startOnOptionHandler"))}Uvj(){let b=1;this.nba.value?(this.nba.value=0,this.nba.N3a.className=ie.getImageClass(Cb.hXe),this.nba.K9d.setAttribute(qf.a.xDa,qf.a.yM)):(this.nba.value=1,this.nba.N3a.className=
ie.getImageClass(Cb.dwe),b=this.mNd(this.nba.V3a,1),this.nba.K9d.setAttribute(qf.a.xDa,qf.a.xp));this.woe("wdStartOn",b.toString())}static get QL(){return v.AFrameworkApplication.ta.Kb.uF}static HQn(b,h,r,B=null){if("wdPrint"===h||"wdEmbedCode"===h)return ka.a.fp(b,h,r?"1":"0");if("wdStartOn"===h){let P="1";r&&B&&(B=parseInt(B),!isNaN(B)&&1<=B&&(P=B.toString()));return ka.a.fp(b,h,r?P:"1")}return b}}Object(n.a)(ha,"WordEmbedDialog",Cb,[]);class La{constructor(b,h,r,B,P){this.zfa=null;this.ga=b;this.Lbb=
h;this.lQ=r;this.sH=B;this.Xea=P}Ub(){this.ga.qa(this.lQ,Gd.a.frame,Object(z.a)(this,this.gxo,"showEmbedCode"));this.Lbb.execute(Object(z.a)(this,this.lXf,"onHostPostmessengerCreated"))}lXf(b){t.ULS.shipAssertTag(4994850,332,!!b);this.zfa=b;v.AFrameworkApplication.ria||(this.zfa.Gv(M.a.PBh),this.zfa.eC(M.a.PBh,Object(z.a)(this,this.fmc,"showEmbedDialog")))}fmc(b){b=b.Values.HostEmbeddedViewUrl.toString();v.AFrameworkApplication.WTc=b;this.Xea.jif=b;(new ha(b,this.sH)).fmc()}gxo(b,h,r){if(2===r)if(v.AFrameworkApplication.WTc)(new ha(this.Xea.jif,
this.sH)).fmc();else return v.AFrameworkApplication.Wl.Q3a(La.POj),v.AFrameworkApplication.brg&&this.zfa.sendMessage(M.a.SCl,null)?32:v.AFrameworkApplication.ta.eV(!0,v.AFrameworkApplication.Ukf);return 32}}La.POj=10381;Object(n.a)(La,"EmbedActor",null,[]);class lb{}Object(n.a)(lb,"WordEmbedDialogStrings",null,[]);var Vb=c(224);class tc extends La{constructor(b,h){super(b,h,V.a.Bhg,Object.assign(new lb,{sLj:WordEditorIntl.WordEditorStrings.l_Width,Ooi:WordEditorIntl.WordEditorStrings.l_Height,y4i:WordEditorIntl.WordEditorStrings.l_PrintOption,
n9i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Wvj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Xvj:WordEditorIntl.WordEditorStrings.l_StartPage}),Vb.WoncaApp.instance)}}Object(n.a)(tc,"EmbedActor",La,[]);class Nc{constructor(){this.W=null}get name(){return"WordEditor.Embed"}wc(b){this.W=b;b.ia("WordEditor.Embed.EmbedActor",()=>new tc(v.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).ha()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Ub()}dispose(){}}Object(n.a)(Nc,
"EmbedPackage",null,[1,2]);class hd{constructor(b,h,r){this.fw=this.zLa=this.INa=null;this.oLa=0;this.BYb=this.vYb=this.hYb=this.KYb=this.HXa=this.GXa=!1;this.Vj=b;this.nn=r}tP(b){return ab.StaticActiveAppFrame.za().jb.isEditingAllowed?""!==this.UQc(b.yf):!1}BL(b){if(!this.tP(b))return!1;this.jio(b);this.kio();this.lio();this.INa=b.mI;this.fw=new Sys.UI.Point(0,0);t.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}gV(b){this.zLa=b.mI;this.oRk();this.Vj.OGj(this.fw.x,this.fw.y,
this.KYb,this.hYb,this.vYb,this.BYb,!1);return!0}iE(){this.Vj.OGj(this.fw.x,this.fw.y,this.KYb,this.hYb,this.vYb,this.BYb,!0);t.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}UY(){this.Vj.iUk();t.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}kio(){this.BYb=this.vYb=this.hYb=this.KYb=!1;switch(this.oLa){case 1:this.KYb=!0;break;case 5:this.hYb=!0;break;case 3:this.BYb=!0;break;case 7:this.vYb=!0;break;case 0:this.vYb=this.KYb=!0;break;case 2:this.BYb=this.KYb=!0;break;
case 6:this.vYb=this.hYb=!0;break;case 4:this.BYb=this.hYb=!0}}lio(){this.HXa=this.GXa=!1;switch(this.oLa){case 0:this.HXa=this.GXa=!0;break;case 1:case 2:this.HXa=!0;break;case 7:case 6:this.GXa=!0}}UQc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}jio(b){switch(this.UQc(b.yf)){case "WACImageCropHandleNW":this.oLa=
0;break;case "WACImageCropHandleN":this.oLa=1;break;case "WACImageCropHandleNE":this.oLa=2;break;case "WACImageCropHandleE":this.oLa=3;break;case "WACImageCropHandleSE":this.oLa=4;break;case "WACImageCropHandleS":this.oLa=5;break;case "WACImageCropHandleSW":this.oLa=6;break;case "WACImageCropHandleW":this.oLa=7}}oRk(){var b=1;this.nn.instance&&(b=this.nn.instance.oj);const h=(this.zLa.x-this.INa.x)/b;b=(this.zLa.y-this.INa.y)/b;this.fw.x=this.GXa?-h:h;this.fw.y=this.HXa?-b:b}}Object(n.a)(hd,"ImageCropDragAdapter",
null,[151]);class fd{constructor(b,h){this.ga=b;this.nn=h}W0l(b){return new hd(b,this.ga,this.nn)}}Object(n.a)(fd,"ImageCropDragAdapterFactory",null,[634]);var sd=c(302),Kd=c(244),Nd=c(42),we=c(443),Ce=c(706),te=c(82),fe=c(62),Cf=c(404),Th=c(992),Vf=c(519),Gj=c(911),Qh=c(141),zg=c(363),$i=c(254),xm=c(878),Xj=c(207),Dg=c(84),Qg=c(21),cg=c(285),jf=c(787),Cn=c(377),al=c(117);class nj{constructor(b,h,r,B,P,ca,ra,Qa,mb=null){this.Zb=mb;this.AVc=null;this.HK=b;this.rh=h;this.Lc=r;this.Xs=B;this.Md=P;this.hb=
ca;this.en=ra;this.ME=Qa}get zX(){return null!=this.dxg?this.dxg:this.dxg=Ya.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get qc(){return null!=this.sKg?this.sKg:this.sKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Hi(){return Qh.PageReader.instance}vko(b,h,r){const B=this.Lc.Pc(15);B.Db(h.node);this.CUa(b,r);B.dispose()}uko(b,h,r){const B=this.Lc.Pc(15);B.Db(h.node);this.qQb(b,r);B.dispose()}CUa(b,h){b.setValue(Pe.a.imageAltText,h)}qQb(b,h){b.setValue(Oc.a.vY,h)}Cko(b,
h){b.setValue(Pe.a.tkb,h)}vmj(b,h){var r=ye.ImageReader.ui(b);qe.App.instance&&qe.App.instance.IR(r)?(r=b.ja(Nd.a.K6d,null),h=jf.a.Bdl(h,r),b.setValue(Nd.a.K6d,h)):b.setValue(Oc.a.wY,h)}yko(b,h,r,B,P){let ca=0;var ra=0;({width:ca,height:ra}=ye.ImageReader.qjb(b));ra-=(h+r)/1E5*ra;this.VIa(b,ca-(B+P)/1E5*ca);this.UIa(b,ra);this.Omj(b);b.setValue(Oc.a.xUc,h);b.setValue(Oc.a.uUc,r);b.setValue(Oc.a.vUc,B);b.setValue(Oc.a.wUc,P)}Aoo(b,h,r,B){const P=this.Lc.Pc(15);P.Db(h.node);this.Vge(b,r,B);P.dispose()}Vge(b,
h,r){this.VIa(b,h);this.UIa(b,r);this.Omj(b);b.removeProperty(Zc.a.iae);b.removeProperty(Zc.a.gae)}VIa(b,h){b.setValue(Pe.a.Kia,h);b.setValue(Zc.a.eGa,-1)}UIa(b,h){b.setValue(Pe.a.Jia,h);b.setValue(Zc.a.dGa,-1)}pE(b,h){b.setValue(Oc.a.RTc,h);b.setValue(Pe.a.Jh,h);b.setValue(Pe.a.gr,h)}ppo(b,h){b.setValue(Oc.a.iSb,h)}oho(b,h){b.setValue(Oc.a.y4e,h)}tpo(b){if(!ye.ImageReader.S4(b)&&b.al){var h=b.node;if(ye.ImageReader.r9(h)){const P=this.Lc.Pc(15);P.Db(b.node);b=xd.GraphIterator.eb(h);b.zb(12);b=b.parentNode;
var r=b.properties.tf(Oc.a.uq),B=h.properties.getValue(Oc.a.runId);h.ja(Oc.a.Wc,Ti.a.zS);const ca=b.ra,ra=[Oc.a.RTc,Pe.a.Jh,Pe.a.gr,Oc.a.y4e,Oc.a.iSb,Oc.a.O_a];qe.App.instance&&qe.App.instance.IR(ye.ImageReader.ui(h))&&ra.push(Nd.a.qxf,Nd.a.pxf);h.Cg.apply(h,ra);r=this.$pf(B,r,ca);B=Se.a.Uc(b,r);this.Xs.YJh(h,B);(h=this.ME.mJ(b,r,r+1))&&this.hb.Ac(h);this.zX.rra(b,r,r+1);P.dispose()}}}fdg(b,h){if(b.properties.hasProperty(Oc.a.X7)){const r=b.properties.tf(Oc.a.X7);r.push(h);b.properties.setValue(Oc.a.X7,
Array.clone(r))}else b.properties.setValue(Oc.a.X7,[h])}fie(b,h,r=0,B=!1){if(b.al){var P=this.Lc.Pc(15),ca=b.node;P.Db(ca);if(ye.ImageReader.S4(b)){const Jb=this.Zb&&this.Zb.isFeatureEnabled(48)?new Gj.a:new Vf.a;Jb.ax(ye.ImageReader.sn(b));var ra=ca.ra,Qa=this.FEl(b.cpBegin,ra);this.rHk(b.cpEnd,ra,Qa)&&t.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ra=ra.J(Qa).blob;Qa=ra.pe;var mb=ca.properties.tf(Oc.a.uq);mb=this.gQn(mb);Qa=mb[Qa];mb=ca.ja(Oc.a.Wc,Ti.a.zS);
if(ra=Object(Na.a)(Th.ImageBlobObject,ra))ra.TQb=!1;this.Md.Ge(b,"");ra&&(ra.TQb=!0);Jb.properties.setValue(Oc.a.runId,Qa);Jb.properties.setValue(Oc.a.Wc,mb);b=xd.GraphIterator.eb(ca);b.zb(12);b.Bf(Jb,6);this.fdg(b.currentNode,Jb.anchor.node.id);ca=Jb}r&&this.pE(ca.properties,r);this.oho(ca.properties,B);this.ppo(ca.properties,h);this.zX.hlc(ca);(h=this.ME.Dq(ca))&&this.hb.Ac(h);P.dispose()}}Abg(b,h){if(!(0>=h)){var r=Xg.a.Ql(h,0),B=ye.ImageReader.oF(b),P=ye.ImageReader.KG(b);B>r&&(P*=r/B,this.VIa(b,
r),this.UIa(b,P),t.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}rHk(b,h,r){const B=h.length;if(r>=B||!h.J(r).Ue)return!1;const P=new gp.a;for(;r<B;r++){const ca=h.J(r);if(ca.cp>b||!ca.Ue)break;for(let ra=0;ra<ca.Ue.length;ra++){if(P.contains(ca.Ue.J(ra).Lj))return!0;P.add(ca.Ue.J(ra).Lj)}}return!1}gQn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var B=b[h];r=h-1;for(var P=B-1;0<=r;)b[r]=P,r--,
P--;P=0;for(r=h+1;r<b.length;)(h=b[r])?h<B?(B=h+P,b[r]=B):B=h:(P+=2,B++,b[r]=B),r++}return b}Elf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}$pf(b,h,r){let B=0;const P=this.Elf(b,h);let ca=0;if(P===h.length)ca=r.length-1;else for(;ca<r.length;){h=r.J(ca);if(h.formatting&&h.formatting.pe===P)break;ca++}ca<r.length?B=r.J(ca).cp:t.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return B}FEl(b,h){let r=
0;for(;r<h.length&&h.J(r).cp!==b;)r++;r===h.length&&t.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}Omj(b){b.setValue(Pe.a.Oxa,!0)}Kae(b,h,r,B=!1){h&&r?(h=Math.max(h,Ce.a.FPi),r=Math.max(r,Ce.a.FPi)):r=h=Ce.a.GQh;b.setValue(Pe.a.Kia,Xg.a.Ql(h,0));b.setValue(Pe.a.Jia,Xg.a.Ql(r,1));b.setValue(Pe.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(xe.a.B0,pg.a.uploading);
b.setValue(Oc.a.wia,B)}uYd(){return null}oUh(b,h,r){let B=null;h=({cMb:B}=this.pUh(b,h,r)).returnValue;B&&b.view.mb.Ac(B);return h}pUh(b,h,r){var B=null;if(!this.Kga(b))return{returnValue:null,cMb:B};var P=b.view;const ca=this.Lc.Pc(15,Mb.a.MIb);ca.Db(P.ed);h||(h=new wc.DictionaryPropertySet);h.setValue(Zc.a.gtl,!0);let ra=P.mb.qg;var Qa=new xm.a;if(!Pd.SelectionEditor.Ze(ra)){if(2===v.AFrameworkApplication.va.processAction(Mb.a.Wna,2))return ca.dispose(),{returnValue:null,cMb:B};ra=P.mb.qg}else if(ra.al&&
Td.ParagraphReader.Xb(ra.node)){qe.App.zd.Uo&&qe.App.zd.fq.iG(ra.node);P=Bn.FormattingReader.Xr(ra);if(!P)return ca.dispose(),{returnValue:null,cMb:B};P.cache.UB&&(P=P.wf(null),nj.rn.G5(P));Qa.formatting=P.Xj;Qa.languageId=Bn.FormattingReader.language(P);Qa.Rka=this.qc.hp(ra.node)}if(!ra.al)return ca.dispose(),{returnValue:null,cMb:B};if(!this.PCf(b.ik,h))return ca.dispose(),this.AVc=null,{returnValue:null,cMb:B};b=this.AVc;this.AVc=null;1===b.location?(B=b.node,h=Cn.a.instance.vwf(B),hg.OutlineElementNavigator.ns(h,
!1,!1)||(Xj.OutlineNavigator.cfe(h),this.HK.Z7(h,!0,Qa)),hg.OutlineElementNavigator.Ee(h),mi.TableReader.isTable(h)&&(Object(uc.a)(al.a,h)||Object(uc.a)(zg.a,h)?(Qa=new xd.GraphIterator,Qa.set(h.currentNode),Qg.moveToCellContent(Qa,0,0),h.set(Qa.currentNode)):Qg.moveToCellContent(h,0,0),Zf.OutlineElementReader.yh(h)?hg.OutlineElementNavigator.Ee(h):h=Cn.a.instance.vwf(B)),B=Td.ParagraphReader.Bt(h.currentNode)?this.ME.ne(h.currentNode,0):this.ME.Dq(h.currentNode)):b.location||(Qa=b.blob.Lb.cp+1,B=
this.ME.mJ(b.node,Qa-1,Qa));ca.mHa(r,1);ca.Uj=Mb.a.MIb;ca.dispose();return{returnValue:b,cMb:B}}PCf(){return!1}Kga(b){b.contextId===zc.a.view&&b.view.ue&&b.view.mb&&(b=b.view.mb.qg);if(!b)return nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.noSelection}),!1;if(nj.Xf.a0(b))return nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),!1;if(nj.Xf.yia(b))return nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.iti}),!1;if(this.en&&this.en.instance&&this.en.instance.TU(b))return nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.Y1a}),!1;if(this.Hi.P4)return nj.Ic.Yb(te.a.ef,
{["Reason"]:fe.a.compatMode}),!1;if(b.al)return Dg.OutlineReader.v0d(b)?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.P$e}),!1):ye.ImageReader.s_d(b)?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.H$e}),!1):cg.c(b)?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.I$e}),!1):$i.a.yFf(b)?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.G$e}),!1):Td.ParagraphReader.PU(b)||ye.ImageReader.CIm(b)?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),!1):!0;if(Cf.a.QGf(b)){let h=!0;for(let r=0;r<b.length;++r){const B=b.getContext(r);if(!B.al)return!1;h&&!Td.ParagraphReader.PU(B)&&
(h=!1)}return h?(nj.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),!1):!0}return!1}B8f(b,h){const r=this.Lc.Pc(7);r.Db(b);if(12===b.type){h=h.Lb.cp;var B=Td.ParagraphReader.textLength(b);B=Se.a.cR(h,h+1,h+1===B?!0:!1,b);this.Md.Ge(B,"");b=Se.a.Uc(b,h);this.hb.Ac(Fe.SelectionFactory.Xn(b))}else this.rh.mza(b);r.dispose()}static get rn(){return null!=nj.PAg?nj.PAg:nj.PAg=Ya.a.instance.resolve("Box4.IFormattingEditor")}static get Xf(){return xj.a.instance}static get Ic(){return Ih.a.instance}}Object(n.a)(nj,"ImageEditor",
null,[633]);class Un{constructor(b,h,r,B=0){this.node=b;this.blob=h;this.location=r;this.JU=B}}Object(n.a)(Un,"InsertPictureResult",null,[]);var Xp=c(833),Lk=c(291),Ff=c(106),po=c(507),Dn;(function(b){b[b.other=0]="other";b[b.picture=1]="picture"})(Dn||(Dn={}));Object(n.b)("ImageType",Dn);var Qt=c(1203);class tt extends nj{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc){super(b,h,r,B,P,ca,ra,Qa,Wc);this.m0j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.uab="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.tK=this.fMa=this.qBa=null;this.ola=Array(8);this.fod=this.MBa=null;this.gMa=!1;this.eod=this.NEe=null;this.Cjd=this.Nkd=!1;this.nT=this.mT=this.lT=this.oT=this.nW=this.mW=this.lW=this.oW=this.JW=this.KW=0;this.WY=()=>{this.gMa&&
this.Bif()};this.vya=id=>{this.gMa&&id.Hb.keyCode!==kc.a.Rs&&this.Bif(!0);return!1};this.b_g=Mc;ca.Xw(this.WY);this.ge=fc;this.U2=sd.a.instance;this.ga=v.AFrameworkApplication.va;this.Vd=Jb;this.zq=mb;this.rd=Wc}mhe(b,h,r,B,P){b.hasProperty(Zc.a.sSa)&&b.removeProperty(Zc.a.sSa);const ca=Array(4);ca[Ff.a.left]=h;ca[Ff.a.right]=r;ca[Ff.a.top]=B;ca[Ff.a.bottom]=P;b.setValue(Oc.a.Vda,ca)}S_n(b){b.setValue(Oc.a.gGa,po.a.notRendered);b.setValue(Oc.a.BNb,"");this.mhe(b,0,0,0,0)}aeg(b,h,r,B,P){b.setValue(Oc.a.xUc,
h);b.setValue(Oc.a.uUc,r);b.setValue(Oc.a.vUc,B);b.setValue(Oc.a.wUc,P)}ohe(b,h,r,B){b.setValue(Oc.a.KU,h);b.setValue(Oc.a.mzf,r);b.setValue(Oc.a.Jzf,B);b.setValue(Zc.a.KU,-1)}sYd(b,h){b=b.node;const r=xd.GraphIterator.eb(b);if(Td.ParagraphReader.Xb(b)&&Td.ParagraphReader.isEmpty(r)){var B=b.properties.tf(Oc.a.Wc);h.setValue(Oc.a.Wc,B);h.setValue(Oc.a.runId,1);B=new Qt.a;h&&B.ax(h);r.Bf(B,6);this.fdg(b,B.anchor.node.id);this.zX.hlc(B);return new Un(B,null,3)}return null}uYd(b,h){var r=Xp.a.instance.Wfd;
h&&r.ax(h);r.setValue(Oc.a.imageType,Dn.picture);let B=0;B=Kd.a.FF();r.setValue(Oc.a.JU,B);const P=b.node.Mc.Xu(r,r.id);r=this.Md.kia(b,ca=>new Th.ImageBlobObject(ca,P));Lk.GraphTransactionManager.instance.SWf(b.node);if(this.Vd.yg){const ca=new sg.GraphTransaction(15);ca.Db(b.node);this.zq.yra(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.zX.BOa&&!h.ja(Oc.a.wia,!1)&&this.zX.rra(b.node,b.cpBegin,b.cpBegin+1);return new Un(b.node,r,0,B)}PCf(b,h){if(!this.Kga(b))return!1;const r=this.Lc.Pc(7);
r.Db(b.node);v.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ja(Oc.a.uvi,!1)?this.AVc=this.sYd(b,h):this.AVc=this.uYd(b,h);r.dispose();return!0}Ajc(b,h,r,B){if(!r.Xb(b))return!1;r=this.Lc.Pc(7,Mb.a.vnm);r.Db(b);var P=b.properties.ja(Pe.a.Im,[]);P.push(0);for(const ca of P)if((P=B.Oof(b,ca))&&5===P.vh&&P.id.equals(h))return this.Md.Ge(Se.a.createTextRange(b,ca,ca+1),""),r.dispose(),!0;r.dispose();t.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");
return!1}e_n(b,h,r,B){if(!ye.ImageReader.r9(b))return!1;h.set(b);h.zb(12);const P=h.jo(12);if(!P)return t.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.KXc(P))return t.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;B(b);r=this.Lc.Pc(7);r.Db(b);h.tg();r.dispose();return!0}Q4n(b,h,r,B){return ye.ImageReader.i4a(b)?this.E4n(b,
r):ye.ImageReader.S4(b)?this.T4n(b,h,r,B):null}T4n(b,h,r,B){const P=Xp.a.instance.Wfd;r&&P.ax(r);r=0;r=Kd.a.FF();P.setValue(Oc.a.JU,r);r=b.node.Mc;b=b.node;B=B.OPc(b,5);for(const ca of B)if(ca.id.equals(h)){this.Md.Ge(Se.a.createTextRange(b,ca.Lb.cp,ca.Lb.cp+1),"");const ra=r.Xu(P,P.id);h=Se.a.Uc(b,ca.Lb.cp);this.Md.kia(h,Qa=>new Th.ImageBlobObject(Qa,ra));return P}return null}E4n(b,h){if(!ye.ImageReader.i4a(b))return null;h.setValue(Oc.a.JU,Kd.a.FF());b=b.node;var r=b.anchor.node.id;b=xd.GraphIterator.eb(b);
b.zb(12);const B=b.parentNode;let P;B.properties.hasProperty(Oc.a.X7)?(P=B.properties.tf(Oc.a.X7),r=U.a.indexOf(P,r),-1!==r&&Array.removeAt(P,r)):P=[];B.properties.setValue(Oc.a.X7,Array.clone(P));b.tg();r=this.rd&&this.rd.isFeatureEnabled(48)?new Gj.a:new Vf.a;r.ax(h);b.Bf(r,6);this.fdg(B,r.anchor.node.id);return r}rcd(b,h){this.gMa?this.Bif():this.kDo(b,h)}Eko(b,h){b.setValue(Zc.a.KU,h)}$0l(b){let h=null,r=null;if(!b)return t.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),
{returnValue:null,view:h,sj:r};if(!Hb.InteractiveViewManager.instance.yd)return t.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,sj:r};const B=b.node;if(!B)return t.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,sj:r};r=B.Mc;var P=B.qe(Hb.InteractiveViewManager.instance.yd.$b);if(!P)return t.ULS.sendTraceTag(23961792,322,
15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,sj:r};h=P.Ag;if(b.al&&ye.ImageReader.S4(b)){b=ye.ImageReader.BFa(b);if(!b)return t.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,sj:r};P=b.Uwa(h,P);if(!P)return t.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,
view:h,sj:r};P=P.element}else if(ye.ImageReader.Mt(B))P=P.htmlElement;else return t.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,sj:r};return{returnValue:P,view:h,sj:r}}Pqo(b){for(let B=0;B<this.ola.length;B++){this.ola[B]=b.Pk(xl.a.span);this.ola[B].className="WACImageCropHandles "+this.m0j[B];if(2>=B){var h=b.Pk(xl.a.span);h.className=this.uab[0];var r=b.Pk(xl.a.span);r.className=
this.uab[1];this.ola[B].appendChild(h);this.ola[B].appendChild(r)}else 4<B&&(h=b.Pk(xl.a.span),h.className=this.uab[2],r=b.Pk(xl.a.span),r.className=this.uab[3],this.ola[B].appendChild(h),this.ola[B].appendChild(r));if(!B||3===B||5===B)h=b.Pk(xl.a.span),h.className=this.uab[4],r=b.Pk(xl.a.span),r.className=this.uab[5],this.ola[B].appendChild(h),this.ola[B].appendChild(r);else if(2===B||4===B||7===B)h=b.Pk(xl.a.span),h.className=this.uab[6],r=b.Pk(xl.a.span),r.className=this.uab[7],this.ola[B].appendChild(h),
this.ola[B].appendChild(r)}}kDo(b,h){t.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.gMa)t.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,B=null;if((this.MBa=({view:r,sj:B}=this.$0l(h)).returnValue)&&r){this.MBa.classList.add("ImageCropMode");this.qBa=r.Pk(xl.a.div);this.qBa.className="WACImageCropMode";this.fMa=r.Pk(xl.a.O3a);this.fMa.className="WACImageCropBase";this.tK=r.Pk(xl.a.span);this.tK.className="WACImageCropSrcRect";
this.Pqo(r);this.qBa.appendChild(this.tK);for(r=0;r<this.ola.length;r++)this.tK.appendChild(this.ola[r]);this.qBa.appendChild(this.fMa);this.fMa.style.visibility="";this.fMa.style.display="";this.MBa.appendChild(this.qBa);this.PFn(b);B=ye.ImageReader.Twa(b,B);r=ye.ImageReader.n6(b,Zc.a.Eqa,null);this.fMa.src=r?r:ye.ImageReader.rjb(B);this.b_g&&this.b_g.execute(P=>{this.fod||(this.fod=P.W0l(this))});this.Nkd||(this.U2.PP(this.MBa,this.fod),this.Nkd=!0);this.ge&&this.ge.ob(Xc.a.mG,Hb.InteractiveViewManager.instance.we.editingElement,
this.vya);this.gMa=!0;this.NEe=b;this.eod=h;this.Cjd=!1;b=new sg.GraphTransaction(4);b.Db(this.eod.node);this.NEe.setValue(Zc.a.Ixa,this.gMa);b.dispose()}else t.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}PFn(b){const h=Xg.a.nf(ye.ImageReader.oF(b),0),r=Xg.a.nf(ye.ImageReader.KG(b),1);var B=ye.ImageReader.yca(b);const P=Math.max(B.top,0),ca=Math.max(B.bottom,0),ra=Math.max(B.left,0);B=Math.max(B.right,0);this.KW=
1E5*h/(1E5-(ra+B));this.JW=1E5*r/(1E5-(P+ca));this.oW=Math.floor(P*this.JW/1E5);this.lW=Math.floor(ca*this.JW/1E5);this.mW=Math.floor(ra*this.KW/1E5);this.nW=Math.floor(B*this.KW/1E5);this.tK.style.top=this.oW+"px";this.tK.style.bottom=this.lW+"px";this.tK.style.left=this.mW+"px";this.tK.style.right=this.nW+"px";this.fMa.style.width=this.KW+"px";this.fMa.style.height=this.JW+"px";ye.ImageReader.Qy(b)&&(this.qBa.style.width=this.KW+"px",this.qBa.style.height=this.JW+"px");this.oT=this.oW;this.lT=this.lW;
this.mT=this.mW;this.nT=this.nW}Bif(b=!1){t.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.gMa?(b||this.l3k(),this.fMa?Kb.a.MD(this.fMa):t.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.MBa?(this.qBa?this.qBa.parentNode===this.MBa?this.MBa.removeChild(this.qBa):t.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):t.ULS.sendTraceTag(23961794,
322,15,"Unable to clear Crop mode div because it was already null."),this.MBa.classList.remove("ImageCropMode"),this.gMa=!1,b=new sg.GraphTransaction(4),b.Db(this.eod.node),this.NEe.setValue(Zc.a.Ixa,this.gMa),b.dispose(),this.Nkd&&(this.U2.eQ(this.MBa,this.fod),this.Nkd=!1),this.ge&&this.ge.uc(Xc.a.mG,Hb.InteractiveViewManager.instance.we.editingElement,this.vya),this.MBa=this.qBa=null):t.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):
t.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}OGj(b,h,r,B,P,ca,ra){if(r){r=Math.max(this.oW-h,0);const Qa=Math.floor(this.JW)-this.lW-r;5<=Qa?(this.oT=r,this.lT=this.lW):5>Qa&&0<=Qa||0>Qa&&!this.lW?(this.oT=r-(5-Qa),this.lT=this.lW):0>Qa&&5>=Math.abs(Qa)?(this.oT=Math.floor(this.JW)-this.lW,this.lT=Math.max(this.lW-(r-(this.JW-this.lW))-(5-Math.abs(Qa)),0)):(this.oT=Math.floor(this.JW)-this.lW,this.lT=Math.max(this.lW-(r-(this.JW-this.lW)),0));this.tK.style.top=
this.oT+"px";this.tK.style.bottom=this.lT+"px";ra&&(this.oW=this.oT,this.lW=this.lT)}B&&(h=Math.max(this.lW-h,0),B=Math.floor(this.JW)-this.oW-h,5<=B?(this.lT=h,this.oT=this.oW):5>B&&0<=B||0>B&&!this.oW?(this.lT=h-(5-B),this.oT=this.oW):0>B&&5>=Math.abs(B)?(this.lT=Math.floor(this.JW)-this.oW,this.oT=Math.max(this.oW-(h-(this.JW-this.oW))-(5-Math.abs(B)),0)):(this.lT=Math.floor(this.JW)-this.oW,this.oT=Math.max(this.oW-(h-(this.JW-this.oW)),0)),this.tK.style.top=this.oT+"px",this.tK.style.bottom=
this.lT+"px",ra&&(this.oW=this.oT,this.lW=this.lT));P&&(P=Math.max(this.mW-b,0),h=Math.floor(this.KW)-this.nW-P,5<=h?(this.mT=P,this.nT=this.nW):5>h&&0<=h||0>h&&!this.nW?(this.mT=P-(5-h),this.nT=this.nW):0>h&&5>=Math.abs(h)?(this.mT=Math.floor(this.KW)-this.nW,this.nT=Math.max(this.nW-(P-(this.KW-this.nW))-(5-Math.abs(h)),0)):(this.mT=Math.floor(this.KW)-this.nW,this.nT=Math.max(this.nW-(P-(this.KW-this.nW)),0)),this.tK.style.left=this.mT+"px",this.tK.style.right=this.nT+"px",ra&&(this.mW=this.mT,
this.nW=this.nT));ca&&(b=Math.max(this.nW-b,0),ca=Math.floor(this.KW)-this.mW-b,5<=ca?(this.nT=b,this.mT=this.mW):5>ca&&0<=ca||0>ca&&!this.mW?(this.nT=b-(5-ca),this.mT=this.mW):0>ca&&5>=Math.abs(ca)?(this.nT=Math.floor(this.KW)-this.mW,this.mT=Math.max(this.mW-(b-(this.KW-this.mW))-(5-Math.abs(ca)),0)):(this.nT=Math.floor(this.KW)-this.mW,this.mT=Math.max(this.mW-(b-(this.KW-this.mW)),0)),this.tK.style.left=this.mT+"px",this.tK.style.right=this.nT+"px",ra&&(this.mW=this.mT,this.nW=this.nT));ra&&(this.Cjd=
!0,ab.StaticActiveAppFrame.za().updateCommandUI())}iUk(){this.oT=this.oW;this.lT=this.lW;this.mT=this.mW;this.nT=this.nW;this.tK.style.top=this.oT+"px";this.tK.style.bottom=this.lT+"px";this.tK.style.left=this.mT+"px";this.tK.style.right=this.nT+"px"}l3k(){if(this.Cjd){t.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.oW/this.JW),h=Math.floor(1E5*this.lW/this.JW),r=Math.floor(1E5*this.mW/this.KW),B=Math.floor(1E5*this.nW/this.KW),P=new wc.DictionaryPropertySet;
P.setValue(Zc.a.Bkb,b);P.setValue(Zc.a.ykb,h);P.setValue(Zc.a.zkb,r);P.setValue(Zc.a.Akb,B);this.ga.Mf(this.eod,V.a.Aqi,2,!1,null,P)}else t.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Ixa(){return this.gMa}UUl(){return{top:this.oT,bottom:this.lT,left:this.mT,right:this.nT}}LXo(b,h){if(0>b)t.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.oW=this.oT=Math.min(Math.floor(this.JW)-this.lT-5,b);this.tK.style.top=
this.oT+"px";break;case 1:this.lW=this.lT=Math.min(Math.floor(this.JW)-this.oT-5,b);this.tK.style.bottom=this.lT+"px";break;case 2:this.mW=this.mT=Math.min(Math.floor(this.KW)-this.nT-5,b);this.tK.style.left=this.mT+"px";break;case 3:this.nW=this.nT=Math.min(Math.floor(this.KW)-this.mT-5,b),this.tK.style.right=this.nT+"px"}this.Cjd=!0}}}Object(n.a)(tt,"ImageEditor",nj,[632,633]);class Yq{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",
()=>new fd(v.AFrameworkApplication.va,Ya.a.instance.Sa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.W.ia("WordEditor.ImageEditors.ImageEditor",()=>new tt(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Tb.KeyInputManager.instance,b.Sa("WordEditor.IImageCropDragAdapterFactory"),b.Oa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){L.a.instance.Gc(new Yq)}}Object(n.a)(Yq,"WordEditorImageEditorsPackage",
null,[1,2]);class zl{}Object(n.a)(zl,"FolderContentEditor",null,[1528]);class lq{}Object(n.a)(lq,"PageEditor",null,[1432]);class ut extends lq{constructor(){super()}}Object(n.a)(ut,"PageEditor",lq,[]);class zs{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new zl).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new ut).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){L.a.instance.Gc(new zs)}}
Object(n.a)(zs,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class As{get ZNb(){return v.AFrameworkApplication.privacyUrl}iva(){t.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Qd.a.vm(this.ZNb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(n.a)(As,"PrivacyLinkHandler",null,[282]);class vn{constructor(b,h){this.JMe=null;this.ijk=b;this.hjk=h}showDialog(b){this.JMe=b;this.hjk.create().Uh(Object(z.a)(this,this.$om,"handleDialog"))}$om(b){1===b&&
this.ijk.akj();this.JMe();this.JMe.prototype}}Object(n.a)(vn,"SendUsYourFileController",null,[256]);class Yp extends Wh.StandardDialog{constructor(b,h,r){super();this.r_b=null;this.ig=b;this.KBc=h;this.sH=r}Uh(b){this.Cd=1;this.ye(1,this.sH.send);this.ye(0,this.sH.bin);t.ULS.shipAssertTag(37034013,342,!this.r_b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.anb(this.sH.YDk,null,"CancelRequest_32x32x32",null,b,h);this.M5(this.rj(Yp.jkj))}dialogContent(){const b=
document.createElement("span");b.innerText=this.sH.VIn;const h=document.createElement("span");h.innerText=this.sH.IJo;h.style.fontWeight=this.sH.c2o;const r=document.createElement("span");r.innerText=this.sH.Zfo;const B=this.p5k(),P=document.createElement("span");P.id=this.rj(Yp.jkj);P.appendChild(b);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(h);P.appendChild(document.createElement("br"));P.appendChild(r);P.appendChild(document.createElement("br"));
P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(B);return P}p5k(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.sH.DIn;h.href=this.KBc.ZNb||"";b.appendChild(h);this.r_b=h;this.ig.ob(Xc.a.click,this.r_b,Object(z.a)(this.KBc,this.KBc.iva,"clickHandler"));return b}dispose(){this.r_b&&(this.ig.uc(Xc.a.click,this.r_b,Object(z.a)(this.KBc,this.KBc.iva,"clickHandler")),this.r_b=null);super.dispose()}}Yp.jkj="sendUsYourFileId";
Object(n.a)(Yp,"SendUsYourFileDialog",Wh.StandardDialog,[280]);class hs{create(){return Ya.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(n.a)(hs,"Factory",null,[279]);var Wm=c(594);class Er extends Wm.a{constructor(){super();this.FileId=null}ml(){return 38}static construct(b){const h=new Er;h.FileId=b;return h}}Object(n.a)(Er,"CreateSendUsYourFileRequest",Wm.a,[]);var Zo=c(1009);class Bs{constructor(b,h,r){this.E6=b;this.uQ=h;this.Uak=r}akj(b=!1){if(this.uQ){const h=
Er.construct(this.uQ()),r=new Zo.a;r.Iq=h;r.status=1;r.aH="BootErrorReport";b=b?this.E6(null):this.E6(B=>{this.Y7c(r,B)});b.JH(r);b.lU();this.Uak()}}Y7c(b){5===b.statusCode&&this.akj(!0)}}Object(n.a)(Bs,"SendUsYourFileManager",null,[255]);class vt{constructor(b,h){this.W=null;this.sH=b;this.uQ=h}wc(b){this.W=b;this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.sH).ha();this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Yp(ji.a.instance,new As,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));
this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Bs(h=>this.Hha(0,h),this.uQ,()=>{t.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new hs;return new vn(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(n.a)(vt,"SendUsYourFilePackageManager",null,[]);
var vr=c(517),bl=c(1053);class wr{get YDk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get bin(){return CommonUIStrings.l_NoThanks}get VIn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get IJo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get c2o(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Zfo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get DIn(){return CommonUIStrings.l_PrivacyStatement}}Object(n.a)(wr,
"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Rr extends vt{constructor(){super(new wr,()=>v.AFrameworkApplication.rootQuerySignature)}Hha(b,h){return new bl.a(b,h,"SendUsYourFile.ashx",yk.a.word,qe.App.webServiceBase,vr.a.amIAlone,vr.a.$7c,vr.a.L7c)}get name(){return"WordEditor.SendUsYourFile"}static main(){L.a.instance.Gc(new Rr)}}Object(n.a)(Rr,"PackageManager",vt,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Tl=c(551),Jg=c(651),sq=c(1868),Ul=c(121),qh=c(29),Co=c(155),$f=c(74),Il=c(955),Yg=c(149),ip=c(1019);class is{constructor(b,h,r,B,P,ca){this.T3h=b;this.gallerySectionId=h;this.JAl=r;this.cCk=B;this.commandId=P;this.queryCommandId=ca}}Object(n.a)(is,"BorderStyleMenuPropsArguments",null,[]);class dn{constructor(b,h,r,B,P,ca,ra){this.W3b=b;this.cxj=h;this.width=r;this.dTi=B;this.height=P;this.vHi=ca;this.altText=ra}}Object(n.a)(dn,"TableBorderStyleProperties",null,[]);class uf{constructor(){this.jyh=
[new dn(uf.Ouj,"","2",1,8,0,"Solid Line"),new dn(uf.WPh,"5,3","1",1,8,0,"Dashed Line"),new dn(uf.mVh,"1,1","1",1,8,0,"Dotted Line"),new dn(uf.oVh,"","1",2,8,3,"Double Line")];this.kyh=[new dn(uf.ryh,"","1",1,8,0,"0.25pt"),new dn(uf.oyh,"","1",1,8,0,"0.5pt"),new dn(uf.uyh,"","2",1,8,0,"0.75pt"),new dn(uf.pyh,"","2",1,8,0,"1pt"),new dn(uf.nyh,"","3",1,8,0,"1.5pt"),new dn(uf.vyh,"","4",1,8,0,"2.25pt"),new dn(uf.tyh,"","4",1,8,0,"3pt"),new dn(uf.myh,"","5",1,8,0,"4.5pt"),new dn(uf.syh,"","6",1,8,0,"6pt")]}initialize(){this.w7f()}uLl(){const b=
new is("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.jyh,Mb.a.oqb,Mb.a.v5f);return this.t4h(b)}vLl(){const b=new is("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.kyh,Mb.a.pqb,Mb.a.w5f);return this.t4h(b)}k6h(b){switch(b){case uf.Ouj:return Yg.a.X3b;case uf.WPh:return Yg.a.Jfb;case uf.mVh:return Yg.a.JHc;case uf.oVh:return Yg.a.d4;default:return Yg.a.ava}}l6h(b){switch(b){case uf.ryh:return Yg.a.qyh;case uf.oyh:return Yg.a.e5e;case uf.uyh:return Yg.a.V3b;
case uf.pyh:return Yg.a.Ifb;case uf.nyh:return Yg.a.jna;case uf.vyh:return Yg.a.DDa;case uf.tyh:return Yg.a.Hga;case uf.myh:return Yg.a.$_a;case uf.syh:return Yg.a.CDa;default:return Yg.a.qG}}t4h(b){const h=new dh.a,r=new Nf.a,B=Object.assign(new Jg.a,{Id:b.T3h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.JAl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.cCk){var P={};const ra={};ra.width=uf.N1m;ra.height=uf.M1m;P.root=ra;P=Object.assign(new sq.a,{Id:ca.W3b,ExternalId:String.format("{0}_GalleryButton",
ca.W3b),Icon:ca.W3b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.W3b,FullIconStyle:P,ShouldSetTitle:"true",Alt:ca.altText});B.GalleryItems.push(P)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(B);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}w7f(){const b={};for(const h of this.jyh)b[h.W3b]=appChrome.buildBorderStyleIcon(h.cxj,h.width,h.dTi,h.height,h.vHi);for(const h of this.kyh)b[h.W3b]=appChrome.buildBorderStyleIcon(h.cxj,h.width,
h.dTi,h.height,h.vHi);appChrome.api.registerIconProvider(()=>b)}yho(b,h,r){if(!b)return t.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==zc.a.f6)return t.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.J1(Ul.a.xU(b),b.node,5,r,h);break;case 0:this.J1(Ul.a.xU(b),b.node,3,r,h);break;case 1:this.J1(Ul.a.xU(b),b.node,4,r,h);break;case 3:this.J1(Ul.a.xU(b),
b.node,0,r,h);break;case 7:this.J1(Ul.a.xU(b),b.node,1,r,h);break;case 8:this.J1(Ul.a.xU(b),b.node,2,r,h);break;case 6:this.J1(Ul.a.xU(b),b.node,1,r,h);this.J1(Ul.a.xU(b),b.node,2,r,h);break;case 5:this.J1(Ul.a.xU(b),b.node,3,r,h);this.J1(Ul.a.xU(b),b.node,5,r,h);this.J1(Ul.a.xU(b),b.node,4,r,h);this.J1(Ul.a.xU(b),b.node,0,r,h);break;case 4:this.J1(Ul.a.xU(b),b.node,3,r,h),this.J1(Ul.a.xU(b),b.node,5,r,h),this.J1(Ul.a.xU(b),b.node,4,r,h),this.J1(Ul.a.xU(b),b.node,0,r,h),this.J1(Ul.a.xU(b),b.node,
1,r,h),this.J1(Ul.a.xU(b),b.node,2,r,h)}return!0}odg(b,h,r,B){if(!h)return t.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==zc.a.Q1)return t.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var P=h.node;const ca=new xd.GraphIterator;ca.set(P);ca.zb(14);P=qh.TableCellReader.fQa(ca);switch(h.border){case 2:this.xUa(b,h.node,5,B,r,P);this.Dhe(h.node,5,r);this.Ege(b,h.p2a(),3,r,B,P);
break;case 0:this.xUa(b,h.node,3,B,r,P);this.Dhe(h.node,3,r);this.Ege(b,h.p2a(),1,r,B,P);break;case 1:this.xUa(b,h.node,4,B,r,P);this.Dhe(h.node,4,r);this.Ege(b,h.p2a(),0,r,B,P);break;case 3:this.xUa(b,h.node,0,B,r,P),this.Dhe(h.node,0,r),this.Ege(b,h.p2a(),2,r,B,P)}return!0}HNn(b,h){if(Pd.SelectionEditor.KYc(b)&&h)switch(b=Object(Na.a)(Co.TableNodeBorderContext,b),b.border){case 2:this.gP(b.node,uf.Po.OM(5),h);break;case 0:this.gP(b.node,uf.Po.OM(3),h);break;case 3:this.gP(b.node,uf.Po.OM(0),h);
break;case 1:this.gP(b.node,uf.Po.OM(4),h);break;case 7:this.gP(b.node,uf.Po.OM(1),h);break;case 8:this.gP(b.node,uf.Po.OM(2),h);break;case 5:h=this.gP(b.node,uf.Po.OM(5),h);h=this.gP(b.node,uf.Po.OM(3),h);h=this.gP(b.node,uf.Po.OM(0),h);this.gP(b.node,uf.Po.OM(4),h);break;case 6:h=this.gP(b.node,uf.Po.OM(1),h);this.gP(b.node,uf.Po.OM(2),h);break;case 4:h=this.gP(b.node,uf.Po.OM(5),h),h=this.gP(b.node,uf.Po.OM(3),h),h=this.gP(b.node,uf.Po.OM(0),h),h=this.gP(b.node,uf.Po.OM(4),h),h=this.gP(b.node,
uf.Po.OM(1),h),this.gP(b.node,uf.Po.OM(2),h)}}fMn(b,h){if(Pd.SelectionEditor.LYc(b)&&h)switch(b=Object(Na.a)(Co.TableNodeBorderContext,b),b.border){case 2:this.gP(b.node,uf.Po.bP(5),h);break;case 0:this.gP(b.node,uf.Po.bP(3),h);break;case 3:this.gP(b.node,uf.Po.bP(0),h);break;case 1:this.gP(b.node,uf.Po.bP(4),h)}}Vof(b,h,r){r=null;if(!b)return t.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(h.size)&&(r=new ip.a,r.weight=b.properties.ja(h.size,Yg.a.qG),r.style=
b.properties.ja(h.style,Yg.a.ava),r.color=b.properties.ja(h.color,0));return r}ndg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):t.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):t.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}bPb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):t.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}J1(b,h,r,B,P){P=this.U_o(b,h,r,B,P);this.clc(h,uf.Po.OM(r),P);switch(r){case 5:this.npb(h,2,B,P);break;case 4:this.npb(h,1,B,P);break;case 0:this.npb(h,3,B,P);break;case 3:this.npb(h,0,B,P);break;case 1:this.npb(h,7,B,P);break;case 2:this.npb(h,8,B,P)}}U_o(b,h,r,B,P){if(3!==B){var ca=uf.Hg.MRd(b,h,r,3);void 0!==ca&&null!==ca&&ca!==Yg.a.P_&&(ca=$f.a.hkc(ca),P.color=uf.W8a.pva(h,ca))}1!==B&&(ca=uf.Hg.MRd(b,h,r,1),void 0!==ca&&null!==ca&&ca!==Yg.a.pG&&(P.weight=parseFloat(ca)*
Yg.a.IHc));2!==B&&(b=uf.Hg.MRd(b,h,r,2),void 0!==b&&null!==b&&b!==Yg.a.pG&&(P.style=b));return P}xUa(b,h,r,B,P,ca){B&&(P=this.qVo(b,h,ca,r,B,P));this.clc(h,uf.Po.bP(r),P)}qVo(b,h,r,B,P,ca){if(3!==P){var ra="",Qa=uf.Hg.jGb(b,h,B,!1,!0,r,3);Qa&&(ra=Qa.NBb);void 0!==ra&&null!==ra&&ra!==Yg.a.P_&&(ra=$f.a.hkc(ra),ca.color=uf.W8a.pva(h,ra))}if(1!==P){ra="";if(Qa=uf.Hg.jGb(b,h,B,!1,!0,r,1))ra=Qa.NBb;void 0!==ra&&null!==ra&&ra!==Yg.a.pG&&(ca.weight=parseFloat(ra)*Yg.a.IHc)}if(2!==P){P="";if(b=uf.Hg.jGb(b,
h,B,!1,!0,r,2))P=b.NBb;void 0!==P&&null!==P&&P!==Yg.a.pG&&(ca.style=P)}return ca}nfn(b){let h=0,r=0;({Oen:h,rcn:r}=this.q5l(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}q5l(b,h,r){switch(b){case Yg.a.X3b:case Yg.a.Jfb:case Yg.a.JHc:h=2;r=48;break;case Yg.a.d4:h=2;r=24;break;default:h=2,r=48}return{Oen:h,rcn:r}}Ege(b,h,r,B,P,ca){if(h)if(B)for(let ra=0;ra<h.length;ra++)switch(r){case 2:this.xUa(b,h[ra],5,P,B,ca);break;case 0:this.xUa(b,h[ra],3,P,B,ca);break;case 1:this.xUa(b,
h[ra],4,P,B,ca);break;case 3:this.xUa(b,h[ra],0,P,B,ca)}else t.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else t.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Dhe(b,h,r){const B=new xd.GraphIterator;B.set(b);B.zb(14);const P=qh.TableCellReader.Uoa(b);b=qh.TableCellReader.cP(b);Qg.forEachCell(B,P,b,(ca,ra,Qa)=>{ca=ca.currentNode;qh.TableCellReader.$r(ca)&&0==Qa&&0<ra&&this.clc(ca,uf.Po.bP(h),r)})}clc(b,h,r){b?(r=this.nfn(r),b.properties.setValue(h.color,
r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):t.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}npb(b,h,r,B){if(b){var P=mi.TableReader.gg(b),ca=mi.TableReader.hh(b),ra=new xd.GraphIterator,Qa=[];for(let mb=0;mb<P;mb++)for(let Jb=0;Jb<ca;Jb++)if(ra.set(b),Qg.moveToCell(ra,mb,Jb),ra&&ra.currentNode&&!qh.TableCellReader.hg(ra))switch(h){case 2:qh.TableCellReader.tia(ra)&&Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,2));break;case 0:qh.TableCellReader.uia(ra)&&
Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,0));break;case 3:qh.TableCellReader.qGf(b,ra.currentNode)&&Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,3));break;case 1:qh.TableCellReader.rGf(b,ra.currentNode)&&Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,1));break;case 7:qh.TableCellReader.rGf(b,ra.currentNode)||Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,1));break;case 8:qh.TableCellReader.qGf(b,ra.currentNode)||Qa.push(Co.TableNodeBorderContext.x8(ra.currentNode,3))}for(b=
0;b<Qa.length;b++)switch(h=Qa[b],h.border){case 2:this.Q6c(h.node,uf.Po.bP(5),r,B);this.Jde(h.p2a(),uf.Po.bP(0),r,B);break;case 0:this.Q6c(h.node,uf.Po.bP(3),r,B);this.Jde(h.p2a(),uf.Po.bP(4),r,B);break;case 1:this.Q6c(h.node,uf.Po.bP(4),r,B);this.Jde(h.p2a(),uf.Po.bP(3),r,B);break;case 3:this.Q6c(h.node,uf.Po.bP(0),r,B),this.Jde(h.p2a(),uf.Po.bP(5),r,B)}}else t.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}Jde(b,h,r,B){if(b)for(let P=0;P<b.length;P++)this.Q6c(b[P],h,r,B);else t.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}Q6c(b,h,r,B){if(b){var P=b.ja(h.color,uf.jef),ca=b.ja(h.size,uf.lef),ra=b.ja(h.style,uf.kef),Qa=new ip.a;Qa.weight=B.weight;Qa.style=B.style;Qa.color=B.color;2!==r||P===uf.jef&&ca===uf.lef?3!==r||ra===uf.kef&&ca===uf.lef?1!==r||P===uf.jef&&ra===uf.kef?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Qa.color=P,Qa.style=ra,this.clc(b,h,Qa)):(Qa.style=ra,Qa.weight=ca,this.clc(b,h,Qa)):(Qa.color=
P,Qa.weight=ca,this.clc(b,h,Qa))}else t.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}gP(b,h,r){var B=b.properties.ja(h.style,Yg.a.pG);B!==Yg.a.pG&&(r.lineStyle!==Yg.a.pG?r.lineStyle!==B&&(r.lineStyle=Yg.a.yMk):r.lineStyle=B);B=b.properties.ja(h.size,Yg.a.qG);B!==Yg.a.qG&&(r.j_c!==Yg.a.qG?r.j_c!==B&&(r.j_c=Yg.a.qMk):r.j_c=B);b=b.properties.ja(h.color,0);b=$f.a.eF(b);b!==Yg.a.P_&&(r.borderColor!==Yg.a.P_?r.borderColor!==b&&(r.borderColor=Yg.a.iMk):r.borderColor=b);return r}static get Po(){return null!=
uf.Twg?uf.Twg:uf.Twg=Yg.a.instance}static get Hg(){return null!=uf.NKg?uf.NKg:uf.NKg=Ya.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get W8a(){return null!=uf.AIg?uf.AIg:uf.AIg=Il.a.instance}}uf.N1m="110px";uf.M1m="20px";uf.Ouj="SolidLineStyle";uf.WPh="DashedLineStyle";uf.mVh="DottedLineStyle";uf.oVh="DoubleLineStyle";uf.ryh="BorderPointSizeOneQuarter";uf.oyh="BorderPointSizeOneHalf";uf.uyh="BorderPointSizeThreeQuarters";uf.pyh="BorderPointSizeOne";uf.nyh="BorderPointSizeOneAndHalf";uf.vyh=
"BorderPointSizeTwoAndQuarter";uf.tyh="BorderPointSizeThree";uf.myh="BorderPointSizeFourAndHalf";uf.syh="BorderPointSizeSix";uf.kef="single";uf.lef=4;uf.jef=0;Object(n.a)(uf,"TableBorderManager",null,[351]);var yo=c(862),Al=c(54),$o=c(209);class wt{constructor(b,h){this.gdh=this.R8g=null;this.DOa=b;this.mah=h}get N_i(){return this.mah}get uqa(){return this.R8g}get W6f(){return this.gdh}Bnj(b,h){this.gdh=b;this.R8g=h}zmo(b){this.mah=b}}Object(n.a)(wt,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var ti=c(80),ao=c(199),js=c(365),nn=c(148),Kn=c(255),at=c(601),bt=c(77),Wu=c(481),Xu=c(1069);class en extends yo.a{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb=null,fc=null){super(b,h,r,fc,Yb);this.fab=Xu.a.instance;this.sa=new wd.a;this.VCh=[Oc.a.jnc,Oc.a.mrb,Oc.a.WRb,Oc.a.hnc,Oc.a.krb,Oc.a.URb,Oc.a.gnc,Oc.a.jrb,Oc.a.TRb,Oc.a.inc,Oc.a.lrb,Oc.a.VRb];this.dZj=[Oc.a.ya,Oc.a.xa,Pe.a.Jh,Pe.a.gr];this.ji=B;this.Nzb=P;this.Yc=ca;this.hb=ra;this.d7=Qa;this.jm=mb;this.Yvc=Jb;this.lkh=Yb;this.znk=fc;this.VKn=
this.d4f.bind(this)}get sj(){return this.ji.value}get $s(){return this.d7?this.d7.instance:null}G0e(b){this.sa.addHandler("OnParagraphDelete",b)}get jh(){return!!this.Yvc.instance&&this.Yvc.instance.jh}wVc(b,h,r,B,P){h.setValue(Oc.a.Wc,Kd.a.FF());h.setValue(Oc.a.sKm,P);at.c(B,h,[Oc.a.S1]);super.wVc(b,h,r,B,P)}hYd(b,h,r,B,P){const ca=this.$Sc(h,r,B,P);this.WId(ca,h,!1);return super.hYd(b,h,r,B,P)}MBd(b,h,r,B,P){const ca=this.$Sc(h,r,B,P);this.WId(ca,h,!0);super.MBd(b,h,r,B,P);return ca}Iaf(b,h,r,B){h=
this.$Sc(b,h,r,B);this.WId(h,b,!0);return h}insertRows(b,h,r,B){const P=Al.a.Ls(b),ca=new xd.GraphIterator;ca.kd(b);const ra=ca.currentNode;ca.Tb(1);let Qa;Qa=h?b.RM(1):b.currentNode;const mb=b.sc();if(!mb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Jb=mi.TableReader.gg(mb),Yb=mb.$_.Hg;let fc=!1;try{mb.vza=1;const Mc=this.fab.$ib(mb,Yb.pF(mb));this.LUa(b.currentNode);this.$ra(b);this.iuk(r,b,Qa,ca,ra,h,B);const Wc=this.fab.$ib(mb,Yb.pF(mb));this.j8a(mb,
mi.TableReader.gg(mb)+r);fc=!0;this.RYd(mb,Mc,Wc)}finally{mb.vza=0,fc||this.j8a(mb,mi.TableReader.gg(mb)+r)}P+1!==Jb||h?!P&&h&&en.jDf(mb,r):en.jDf(mb,P);h=P+r+(h?0:1);h<Jb+r&&this.Uui(mb,h);return b.currentNode}iuk(b,h,r,B,P,ca,ra){let Qa=null,mb=null;for(var Jb=0;Jb<b;++Jb){var Yb=$o.a.instance.createInstance(393251);mb||(mb=Yb);Qa=Yb;this.wVc(h,Yb,r,P,ca)}b=mi.TableReader.hh(h.currentNode);r=!0;do{r?(h.Bj(Qa),r=!1):h.Lf(1);P=Array(b);for(Jb=0;Jb<b;++Jb){Yb=this.fPa();const fc=this.Iaf(Yb,B.currentNode,
ca,!0);let Mc=null;fc.hg||(Mc=ra(fc));P[Jb]=new wt(Yb,Mc);P[Jb].Bnj(fc,null);B.Lf(1)}for(Jb=0;Jb<b;++Jb)Yb=P[Jb].DOa,h.Q3(Yb,1,yo.a.ULa?yo.a.ULa():null),qh.TableCellReader.$r(Yb)||(this.lBb(h,Yb,P[Jb].N_i),this.HKh(P[Jb].W6f,Yb,!0));B.dia(1)}while(h.currentNode!==mb)}insertColumns(b,h,r,B,P){let ca=b.currentNode,ra=!1,Qa=mi.TableReader.hh(b.currentNode);const mb=Qa;try{this.LUa(b.currentNode);this.$ra(b);const Jb=ca.$_.Hg;ca.vza=1;const Yb=this.fab.$ib(ca,Jb.pF(ca));Qa=mi.TableReader.hh(b.currentNode);
-1===h&&(h=Qa);this.guk(b,B,r,h,P);ca=b.currentNode;Qa+=B;this.o6f(b,Qa,B,h);ra=!0;const fc=this.fab.$ib(ca,Jb.pF(ca));this.RYd(ca,Yb,fc)}finally{ca.vza=0,ra||this.o6f(b,Qa,B,h)}h!==mb||r?!h&&r&&en.iDf(ca,B):en.iDf(ca,h-1)}guk(b,h,r,B,P){var ca=b.currentNode;B=r?B:B-1;b.Tb(1);var ra=new vb.a;do{var Qa=b.OG(B,1);b.sc();var mb=Array(h);for(let Yb=0;Yb<h;++Yb){var Jb=this.fPa();const fc=this.h7l(b,Qa,r),Mc=this.Iaf(Jb,Qa,r,!1);Jb=new wt(Jb,null);Jb.Bnj(Mc,fc);mb[Yb]=Jb}ra.add(mb)}while(b.Ri(1));r=ra.toArray();
for(B=0;B<r.length;B++)for(ra=0;ra<h;ra++)Qa=r[B][ra],mb=Qa.W6f,mb.hg||Qa.zmo(P(mb));b.set(ca);b.Tb(1);P=0;do{for(ca=0;ca<h;++ca)B=r[P][ca],ra=B.DOa,b.IIb(ra,B.uqa,1,yo.a.ULa?yo.a.ULa():null),qh.TableCellReader.$r(ra)||(this.lBb(b,ra,B.N_i),this.HKh(B.W6f,ra,!1));P++}while(b.Ri(1))}RYd(b,h,r){if(h){var B=2===b.vza,P=[],ca=new xd.GraphIterator;ca.set(b);for(var ra=ca.Tb(1);ra;){for(ra=ca.Tb(1);ra;){const Qa=ra.id.toString();Qa in h&&h[Qa]===r[Qa]&&(!B||!qh.TableCellReader.uia(ca)&&!qh.TableCellReader.tia(ca))||
P.push(ra);ra=ca.Ri(1)}ra=ca.Ri(1)}if(0<P.length){h=new sg.GraphTransaction(3);try{h.set(b.yj);for(const Qa of P)Qa.kDf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=Al.a.Ls(b),B=r+h;let P=b.sc();const ca=P.$_.Hg;let ra=!1;t.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",P.id.toString(),P.type,r,h);const Qa=mi.TableReader.gg(P);try{P.vza=2;const mb=this.fab.$ib(P,ca.pF(P));this.LUa(b.currentNode);
this.$ra(b);for(let Yb=B-1;Yb>=r;--Yb){b.OG(Yb,1);let fc=b.Tb(1);for(;fc;)this.j2c(fc,!0),fc=b.Ri(1);this.z3a(b);t.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Xe);b.tg()}P=b.currentNode;const Jb=this.fab.$ib(P,ca.pF(P));this.j8a(P,mi.TableReader.gg(P)-h);this.s7d(b);ra=!0;this.RYd(P,mb,Jb)}finally{P.vza=0,ra||(this.j8a(b.currentNode,mi.TableReader.gg(b.currentNode)-h),this.s7d(b))}Qa===B&&0<=r-1&&en.jDf(P,r-1);r<Qa-h&&this.Uui(P,r)}deleteColumns(b,
h,r){b=Object(Na.a)(xd.GraphIterator,b);let B=Object(Na.a)(Wu.a,b.currentNode),P=mi.TableReader.hh(b.currentNode);const ca=B.$_.Hg;let ra=!1;t.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",B.id.toString(),B.type,h,r);const Qa=P;try{B.vza=2;const mb=this.fab.$ib(B,ca.pF(B));this.LUa(b.currentNode);this.$ra(b);-1===h&&(h=P-r);b.Tb(1);do for(let Yb=h+r-1;Yb>=h;--Yb)b.OG(Yb,1),this.j2c(b.currentNode,
!1),this.z3a(b),b.tg();while(b.Ri(1));P-=r;this.n6f(b,P,h,r);ra=!0;B=Object(Na.a)(Wu.a,b.currentNode);const Jb=this.fab.$ib(B,ca.pF(B));this.RYd(B,mb,Jb);this.r7d(b)}finally{B&&(B.vza=0),ra||(this.n6f(b,P,h,r),this.r7d(b))}Qa===h+r&&0<=h-1&&en.iDf(B,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var B=new xd.GraphIterator;B.kd(b);B.zb(14);this.Zbf(B,h,r);this.YUo(B,h,r);B.sc();B.sc();this.HWi(B)}}qvj(b,h,r){if(b&&(1!==h||1!==r)){var B=new xd.GraphIterator;B.kd(b);B.zb(14);this.sfl(B,h,r);B.sc();B.sc();
this.ZYi(B)}}j2c(b,h){t.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.Som(b,h,this.VKn)}d4f(b,h){const r=b.currentNode;r.hg=!1;this.WId(h.currentNode,b.currentNode,!0);r.removeProperty(Oc.a.skippedCell);r.removeProperty(Oc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.UIc();yo.a.HK.Z7(b,!0,yo.a.dei(h.currentNode));Qg.returnToCell(b);this.F8k(h,b)}Dyf(b,h,r){super.Dyf(b,h,r);1===h.BM.colSpan&&1===h.BM.rowSpan?h.BM.UIc():!r&&h.rfe&&(b.MQa?
1<b.colSpan&&(h=new xd.GraphIterator,h.set(b),h.zb(15),Qg.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(r=new xd.GraphIterator,r.set(h.BM),r.zb(15),h=bt.a(r),r=new xd.GraphIterator,r.set(b),r.zb(15),Qg.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}$Sc(b,h,r,B){const P=super.$Sc(b,h,r,B);if(b.hg&&!B){var ca=h.kya;ca.rfe&&(B=yo.a.z9b(ca.BM,B),!ca.gHd&&r||ca.gHd===B-1&&!r?b.colSpan=1:(r=new xd.GraphIterator,r.set(ca.BM),r.zb(15),ca=bt.a(r),r=new xd.GraphIterator,r.set(h),r.zb(15),Qg.moveToColumnByIndex(r,
ca),r.currentNode.colSpan+=1))}P.ja(Oc.a.skippedCell,!1)&&(b.hg=!0,b.b5=!0,b.Dqb=!0);return P}s7d(b){this.XSb(b,Oc.a.complexTable)}r7d(b){this.XSb(b,Oc.a.complexTable)}HWi(b){this.XSb(b,Oc.a.complexTable)}ZYi(b){this.XSb(b,Oc.a.complexTable)}F8k(b,h){if(b&&h){let r;b=xd.GraphIterator.eb(b.currentNode);Xj.OutlineNavigator.S9(b)&&(b.Tb(2),b=b.currentNode,12==b.type&&(r=b.tf(Pe.a.Jh)));r&&(b=new xd.GraphIterator,b.kd(h),Xj.OutlineNavigator.S9(b)&&b.Tb(2)&&(h=b.currentNode,12==h.type&&h.Gg(Pe.a.Jh,r)))}}WId(b,
h,r){b&&(at.c(b,h,this.VCh),at.c(b,h,[Pe.a.WK]),r&&at.c(b,h,[Oc.a.oS,Oc.a.LV,Oc.a.pVa,Oc.a.oVa,Oc.a.wJa,Oc.a.skippedCell,Oc.a.renderCell]))}HKh(b,h,r){b&&(b=xd.GraphIterator.eb(b),b.od(),b.Rd(),h=xd.GraphIterator.eb(h),h.od(),h.Rd(),Zf.OutlineElementReader.yh(b)&&hg.OutlineElementNavigator.Ee(b)&&Zf.OutlineElementReader.yh(h)&&hg.OutlineElementNavigator.Ee(h)&&at.c(b.currentNode,h.currentNode,this.dZj),r&&(hg.OutlineElementNavigator.Yd(b),hg.OutlineElementNavigator.Yd(h),rg.ListItemReader.lg(b)&&
(r=en.y2m.ww(b),r.UA=ti.a.Vl,{wxa:r}=en.Zm.Zma(r.propertySet,h,r))))}z3a(b){this.jh&&this.jm.HZn(b.currentNode);for(b=ao.a.Qp(b);b.moveNext();)if(Td.ParagraphReader.Xb(b.currentNode)){const h=xo.e(b.currentNode);for(const r of h)r.eja();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else rg.ListItemReader.lg(b.iterator)&&this.$s&&this.$s.$da(b.iterator)}pE(b,h){let r=null;if(this.lkh.yg){const B=Object(Na.a)(Wu.a,b);B&&(r=B.qV())}mi.TableReader.Pn(b)&&(1===h?h=3:3===h&&(h=1));super.pE(b,h);
this.lkh.yg&&this.znk.MUa(b,r);Object(uc.a)(Wu.a,b)&&yo.a.rh.noj(Object(Na.a)(Wu.a,b),(new js.a(1,0)).Xt)}xeg(b,h){const r=Array(h),B=this.Tii(b)/h;for(let P=0;P<h;P++)r[P]=Math.max(Xg.a.Ql(nn.a.Bea,0),B);b.setValue(Pe.a.Xz,r)}gnj(b){b.setValue(Oc.a.tableLayout,0)}ssh(b,h,r,B,P){const ca=Array(r);for(var ra=0,Qa=0;ra<B;++ra)ca[ra]=h[ra],Qa+=ca[ra];for(;ra<r;++ra)ca[ra]=0>ra-P?h[0]:h[ra-P],Qa+=ca[ra];ra=this.Tii(b.currentNode);if(Qa>ra)for(Qa=ra/Qa,ra=0;ra<r;++ra)ca[ra]=Math.max(Xg.a.Ql(nn.a.Bea,0),
ca[ra]*Qa);return ca}Tii(b){var h=xd.GraphIterator.eb(b);b=Xg.a.Ql(Xg.a.Oi(mi.TableReader.Gii(h),0),0);if(h.zb(16))return Qg.returnToCell(h),h=nn.a.ioc(h.currentNode),Xg.a.Ql(Xg.a.Oi(h,0),0)-b;h=Kn.a.Acd(h);return Xg.a.Ql(Xg.a.Oi(h,0),0)-b}cP(b,h,r){const B=new xd.GraphIterator;B.set(b);Qg.moveToCell(B,h,r);return B.currentNode.ja(Oc.a.colSpan,1)}jlc(b){var h=ab.StaticActiveAppFrame.za().jb.ju;if(h.ue&&(h=b.qe(h.$b))){var r=!1,B=mi.TableReader.hh(b),P=b.ja(Pe.a.Xz,Array(B));for(var ca of P)if(!ca){r=
!0;break}if(r){P=Jj.a.clone(P);ca=b.ja(Oc.a.complexTable,!1);t.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",B,P,ca);r=1;var ra=0;for(let mb=0;mb<B;)if(ca&&(r=this.cP(b,0,mb)),1<r){for(var Qa=0;Qa<r;Qa++)P[mb]||(P[mb]=this.Jci(0)),mb++;ra+=r-1}else(Qa=h.TUl(mb-ra))||t.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",mb,ra),P[mb]||(P[mb]=this.Jci(Qa)),mb++;b.setValue(Pe.a.Xz,P)}}}Jci(b){return Xg.a.Ql(Math.max(b,
nn.a.Bea),0)}LUa(b){b=xd.GraphIterator.eb(b);this.jlc(b.currentNode);b.zb(14)&&(Qg.returnToContainingTable(b),this.jlc(b.currentNode))}koj(b,h){h&&b.setValue(Oc.a.Y$,h)}cfg(b,h){h&&b.setValue(Oc.a.fnc,h)}fFh(b,h){const r=mi.TableReader.hh(b);yo.a.MYk(b,h,r)}wio(b,h,r){let B;if(!({tableNode:B}=this.jec(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.brl(B,h))return!1;for(let P=0;P<h.length;++P){const ca=this.Nzb.F9c(b,h[P],r[P]);if(ca)return t.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.x5d(B);return!0}return!1}yEk(b,h){let r;if(!({tableNode:r}=this.jec(b)).returnValue||mi.TableReader.RB(r))return!1;var B=Object(Na.a)(xd.GraphIterator,this.Yc.Rf(r));Qg.moveToLastRow(B);var P=mi.TableReader.gg(r);if(h&&0<h.length){this.insertRows(B,!1,h.length,()=>null);B=mi.TableReader.gg(r);var ca=this.Yc.Rf(r);P=this.Cii(ca,P,B-1);for(B=0;B<P.length;++B){ca=P[B];const ra=h[B];for(let Qa=0;Qa<ca.length;++Qa){let mb;if(mb=ra&&ra[Qa]?this.Nzb.F9c(b,ca[Qa],ra[Qa].toString()):this.Nzb.F9c(b,
ca[Qa],""))return t.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",mb),!1}}}this.x5d(r);return!0}gEk(b,h){let r;if(!({tableNode:r}=this.jec(b)).returnValue||mi.TableReader.RB(r))return!1;var B=this.Yc.Rf(r),P=mi.TableReader.hh(r);if(h&&0<h.length){this.insertColumns(Object(Na.a)(xd.GraphIterator,B),P,!1,h[1].length,()=>null);var ca=mi.TableReader.hh(r);B=this.ahm(B,P,ca-1);for(P=0;P<B.length;++P){ca=h[P];const ra=B[P];for(let Qa=
0;Qa<ra.length;++Qa){let mb;if(mb=ca&&ca[Qa]?this.Nzb.F9c(b,ra[Qa],ca[Qa].toString()):this.Nzb.F9c(b,ra[Qa],""))return t.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",mb),!1}}}this.x5d(r);return!0}Dkl(b){let h;if(!({tableNode:h}=this.jec(b)).returnValue)return!1;let r=this.O2a(h);const B=mi.TableReader.gg(h);var P=this.Yc.Rf(h);P=this.Cii(P,r,B-1);for(let ca=0;ca<P.length;++ca){const ra=P[ca];for(let Qa=0;Qa<ra.length;++Qa){const mb=
this.Nzb.G$i(b,ra[Qa]);if(mb)return t.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",mb),!1}}r=r?r:1;b=this.Yc.Rf(h);b.qF(r)&&15===b.Xe&&this.deleteRows(Object(Na.a)(xd.GraphIterator,b),B-r);this.x5d(h);return!0}O2a(b){let h=0;const r=this.Yc.Rf(b);let B=r.Rd();for(;B&&B.ja(Oc.a.Ylb,!1);)h++,B=r.It();return!h&&yo.a.Gx.q0(b)&32?1:h}YUo(b,h,r){var B,P;const ca=b.currentNode,ra=new xd.GraphIterator;ra.kd(b);let Qa=null,mb=null,Jb=null;
const Yb=Yg.a.instance.bP(3),fc=Yg.a.instance.bP(4),Mc=Yg.a.instance.bP(5),Wc=Yg.a.instance.bP(0);Qg.forEachCell(ra,h,r,(id,Id,ve)=>{id=id.currentNode;Id||ve||(Qa=en.Wz.Vof(id,Yb,Qa));Id||ve!==r-1||(mb=en.Wz.Vof(id,fc,mb));0<Id&&!ve&&(Qa?en.Wz.ndg(id,Yb,Qa):en.Wz.bPb(id,Yb),mb?en.Wz.ndg(id,fc,mb):en.Wz.bPb(id,fc),en.Wz.bPb(id,Mc),Id!==h-1&&en.Wz.bPb(id,Wc));ve||Id!==h-1||(Jb=en.Wz.Vof(id,Wc,Jb))});b=null===(P=null===(B=ab.StaticActiveAppFrame.za())||void 0===B?void 0:B.jb)||void 0===P?void 0:P.ju;
mb?(B=Co.TableNodeBorderContext.x8(ca,1),en.Wz.odg(Ul.a.oq(b),B,mb,0)):en.Wz.bPb(ca,fc);B=Co.TableNodeBorderContext.x8(ca,0);if(Qa)en.Wz.odg(Ul.a.oq(b),B,Qa,0);else for(B=Object(Na.a)(Co.TableNodeBorderContext,B).p2a(),P=0;P<B.length;P++)en.Wz.bPb(B[P],fc);Jb?en.Wz.ndg(ca,Wc,Jb):en.Wz.bPb(ca,Wc)}brl(b,h){for(let B=0;B<h.length;++B){var r=this.Yc.Rf(h[B]);if(r.zb(14)&&(r=r.jd(14),b.id===r.id))continue;return!1}return!0}jec(b){let h=null;if(b&&b.Au.toString()!==b.Ez.toString())return{returnValue:!1,
tableNode:h};h=this.sj.Eb(b.Au);return 14===h.type&&this.Nzb.jec(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}Cii(b,h,r){const B=[];Qg.forEachCellInTable(Object(Na.a)(xd.GraphIterator,b),(P,ca,ra)=>{if(ca>=h&&ca<=r)ra||B.push([]),qh.TableCellReader.hg(P)||Array.add(B[ca-h],P.currentNode);else if(ca>r)return!1;return!0});return B}ahm(b,h,r){const B=[];Qg.forEachCellInTable(Object(Na.a)(xd.GraphIterator,b),(P,ca,ra)=>{ra>=h&&ra<=r&&(ra===h&&B.push([]),qh.TableCellReader.hg(P)||Array.add(B[ca],
P.currentNode));return!0});return B}x5d(b){if(b&&14===b.type){b=Object(Na.a)(xd.GraphIterator,this.Yc.Rf(b));const h=new vb.a;Td.ParagraphReader.Bjb(b,!0,!1,h);b=Fe.SelectionFactory.ne(h.J(h.count-1),0);this.hb.Ac(b)}}static get Wz(){en.kua||(en.kua=Ya.a.instance.Oa("WordEditor.ITableBorderManager"));return en.kua}static get y2m(){return null!=en.CEg?en.CEg:en.CEg=Ya.a.instance.resolve("Box4.List.IListReader")}static get Zm(){return null!=en.wEg?en.wEg:en.wEg=Ya.a.instance.resolve("Box4.List.IListEditor")}Uui(b,
h){const r=new xd.GraphIterator;r.set(b);Qg.moveToFirstRow(r);Qg.moveToRowByIndex(r,h);do r.currentNode.nl(4,!0);while(Qg.moveToNextRow(r))}static jDf(b,h){if(b){var r=mi.TableReader.gg(b),B=mi.TableReader.hh(b);if(!(!ab.StaticActiveAppFrame.za().jb.ju.ue||0>h||h>=r))for(r=new xd.GraphIterator,r.set(b),b=0;b<B;b++){b?Qg.moveToNextColumn(r):Qg.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let P=r.currentNode;qh.TableCellReader.$r(P)&&(P=qh.TableCellReader.xha(P));P&&P.nl(4,
!0)}}else t.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static iDf(b,h){if(b){var r=mi.TableReader.gg(b),B=mi.TableReader.hh(b),P=new xd.GraphIterator;if(!(!ab.StaticActiveAppFrame.za().jb.ju.ue||0>h||h>=B))for(B=0;B<r;B++){P.set(b);Qg.moveToCell(P,B,h);if(!P||!P.currentNode)continue;let ca=P.currentNode;qh.TableCellReader.$r(ca)&&(ca=qh.TableCellReader.xha(ca));ca&&ca.nl(4,!0)}}else t.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}
en.kua=null;Object(n.a)(en,"TableEditor",yo.a,[349,350]);class Yu{get name(){return"WordEditor.TableEditors"}wc(b){v.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new en(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Tl.a,lh.a.instance,b.Sa("WordEditor.IFlatListEditor"),
b.resolve("Box4.ContentControl.IContentControlOperator"),b.Sa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new uf).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){L.a.instance.Gc(new Yu)}}Object(n.a)(Yu,"WordEditorTableEditorsPackage",
null,[1,2]);class ct{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new ct)}}Object(n.a)(ct,"WordEditorTextLevelEditorsPackage",null,[1,2]);var tu=c(1990);c(473);var Zu=c(776),ks=c(221),ym=c(253);class ls{constructor(b){this.Iek=b}Gdl(){const b=$o.a.instance.createInstance(393228);b.setValue(Pe.a.EL,ks.a.first);b.setValue(Pe.a.Oxh,0);b.setValue(Pe.a.Kia,Dg.OutlineReader.Ejl);(new Zu.OutlineIndentInfo(!0)).Lhj(b);return b}Z7(b,h,r=null){const B=
b.currentNode;if(!b.EJ(1))return this.Pkb(b,null,h,r);Zf.OutlineElementReader.tL(b)&&hg.OutlineElementNavigator.aRf(b,!0);return Zf.OutlineElementReader.yh(b)?ls.Pf.Oy(b,!1,h,r):(b.g8c(B),null)}pTk(b){return Dg.OutlineReader.kHf(b.currentNode)||Zf.OutlineElementReader.yh(b)||Zf.OutlineElementReader.tL(b)||qh.TableCellReader.isTableCell(b)}Pkb(b,h=null,r=!1,B=null){if(!this.pTk(b))return null;const P=ls.Pf.Tgb();this.Tno(P,b);b.IIb(P,h,1,null);b.Bj(P);r&&(ls.Pf.OH(b,B),hg.OutlineElementNavigator.Yd(b));
return P}Tno(b,h){if(h=this.ddm(h))switch(h.type){case 11:ls.Pf.Bhf(h,b,!0);break;case 8:h=ls.Hi.isRtl(h),ls.Pf.CQb(b,h)}}ddm(b){return this.Iek.edm(b)}BQb(b,h){b.setValue(Pe.a.gr,h?11:9)}Eio(b,h){const r=ym.WordSectionNavigator.instance.zL(b);return r?Dg.OutlineReader.aY(b)!==h?(r.setValue(Oc.a.wef,h),!0):!1:null}static get Hi(){return Qh.PageReader.instance}static get Pf(){return ls.rh||(ls.rh=Ya.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Pf(b){ls.rh=b}}ls.rh=null;ls.Ce=null;Object(n.a)(ls,
"OutlineEditor",null,[382]);const Ev=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new ls(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new tu.a(b.Ve("Box4.IOutlineEditor"),b.Ve("Box4.List.IListEditor"),b.Ve("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").ha()};class Rt{grj(){return{frj:!0,uLj:!1}}}Object(n.a)(Rt,"CursorMovementValidator",null,[348]);class Gy{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new Rt).as("Box4.List.ICursorMovementValidator").ha();Ev(b)}init(){}dispose(){}static main(){L.a.instance.Gc(new Gy)}}
Object(n.a)(Gy,"Box4OutlineLevelEditorsPackage",null,[1,2]);class Fv{constructor(b){this.uKd=null;this.wTi=b.kb("OfficeOnlineChromeExtensionId");this.FTi=b.kb("ChromeClipboardAccessExtensionId");this.AJm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.Fgh=!this.TRm();this.uKd=this.VQb?this.FTi:this.wTi}R6n(){this.uKd===this.wTi&&this.gAi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.uKd=this.FTi;this.Fgh=!0}get VQb(){return this.Fgh}TRm(){if(this.AJm&&
this.gAi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get gAi(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){t.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(n.a)(Fv,
"ChromeExtensionHelper",null,[1169]);var $u=c(1467),Ez=c(683),av=c(1419);class hx{create(b){return new av.a(b)}}Object(n.a)(hx,"Factory",null,[539]);var Do=c(146);class Rx{constructor(b,h,r){this.tok=b;this.De=h;this.e_a=r}Ub(){this.e_a.fb(Mb.a.zae,zc.a.application,this.zae.bind(this),96);this.e_a.qa(Mb.a.bpc,zc.a.view,this.L_o.bind(this));this.e_a.fb(Mb.a.E6i,zc.a.view,this.N_o.bind(this),96)}zae(b,h,r,B,P){if(1===r)return 32;b=Object.assign(new dh.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,
MenuSectionList:[]});h=[];r=Object.assign(new Nf.a,{ControlList:[]});r.ControlList.push(Object.assign(new ei.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);P.MenuItems=b;return 32}N_o(b,h,r,B,P){if(1===r)return 32;b=um.a.ixj();null==b&&8;b=this.De.vR(b);P[mm.a.LabelText]=String.format(E.a.zf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}L_o(b,h,r){b=um.a.eKb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");
r.set("Action","UpdateStyle");xa.Health.instance.recordKpiUsage(Do.a.HAa,0,Do.a.zB,r);this.tok.Fqg(h)?Rc.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new sb.a,{extendedProperties:h}),xa.Health.instance.recordKpiFailure(Do.a.HAa,"UpdateStyleFailed",!1,!0,h),Rc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(n.a)(Rx,"StyleContextMenuActor",
null,[]);var uu=c(1055),Hy=c(1540),Sr=c(449),Sx=c(1789);class Fz extends Sx.a{constructor(b,h,r,B,P,ca,ra=null,Qa=null){super(b,ca,ra,Qa);this._formatting=null;this.OLa=!1;this.lvb=v.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.xxb=0;this.lEc=new vb.a;Rc.a(8128527,307,Zf.OutlineElementReader.yh(b));this.pM=h;this.pM.N3b(this);this.qq=r;this.Zm=B;this.Jd=P;this.z5e=Qa;this.tOe=rg.ListItemReader.lg(this.zc)}get Sk(){return null!=this.aGg?this.aGg:this.aGg=Ya.a.instance.resolve("Box4.IParagraphEditor")}get mKd(){return null}get K5b(){return this.tOe&&
!this.pM.zEa}get PDb(){return 0<this.xxb}Kda(b,h){if(!this.HZ.rog(this.zc,h,!0)){Rc.a(8701077,307,Td.ParagraphReader.oh(this.zc));var r=this.zc.currentNode,B=Se.a.tw(r);this.lvb&&this._formatting.nR&&(r=r.ra.last,this.OLa&&(r.formatting=this._formatting.nR.wf(r),this.OLa=!1),b=this.HZ.Nyf(b,h),this.HZ.K$(this.zc.currentNode,this._formatting.Sda,h));this.jg.Ge(B,b)}}Jda(){Rc.a(8701078,307,Td.ParagraphReader.oh(this.zc));const b=Se.a.tw(this.zc.currentNode);this.jg.kia(b,h=>new Sr.a(h))}gob(){this.HZ.Tyf(this.zc)}KHa(){this.lvb&&
(this.OLa=!0)}XSa(){Rc.a(8701079,307,Td.ParagraphReader.oh(this.zc))}WSa(){Rc.a(8701080,307,Td.ParagraphReader.oh(this.zc))}jE(b){this.pM.zEa||(this.lvb?(this.n2e(b),this._formatting.pne(this.zc.currentNode),b&&"P"===b.f$.fXd&&this.z5e.pea(this.zc.currentNode,this._formatting.gS),this.HZ.K$(this.zc.currentNode,this._formatting.Sda,b)):this.GKk(b))}zF(){this.pM.zEa||this.rNc()}bTa(){}q6a(){}Dya(){Rc.a(8701081,307,Zf.OutlineElementReader.yh(this.zc)||Dg.OutlineReader.nx(this.zc)||Td.ParagraphReader.oh(this.zc)&&
this.pM.zEa);let b=!1;this.PDb||(b=this.K5b||!0);b||(this.oV+=1);this.xxb++}Bya(){this.xxb--;let b=!1;this.PDb||(b=this.K5b||!0,this.Zm.Taj(this.lEc));b||--this.oV}OHa(b){Rc.a(8701082,307,Zf.OutlineElementReader.yh(this.zc)||Dg.OutlineReader.nx(this.zc)||Td.ParagraphReader.oh(this.zc)&&this.pM.zEa);Rc.a(8701083,307,!!b.listStyleType)}Cya(){Rc.a(8701084,307,Zf.OutlineElementReader.yh(this.zc)||Td.ParagraphReader.oh(this.zc)&&this.pM.zEa);this.pM.zEa||Rc.a(8701085,307,this.zc.Jt(2))}b$(b){this.pM.b$(b)}Z9(){this.pM.Z9()}Mcd(b){this.lEc.add(b)}w5(b){this.pM.w5(b)}a$(){this.pM.a$()}Y9(b){this.pM.Y9(b)}X9(){this.pM.X9()}GKk(b){this.rgc(!1);
(new xd.GraphIterator).kd(this.zc);b=Sx.a.Pf.OH(this.zc,this.vRc(b));Rc.a(8128534,307,b===this.zc.currentNode);Rc.a(8128535,307,Td.ParagraphReader.Xb(b))}rNc(){Rc.a(8128536,307,Td.ParagraphReader.oh(this.zc));hg.OutlineElementNavigator.Yd(this.zc)}reset(){this.lvb&&(super.reset(),this._formatting=this.rqf(!0))}n2e(b){this.rgc(!1);(new xd.GraphIterator).kd(this.zc);b=Sx.a.Pf.OH(this.zc,this.vRc(b));Rc.a(36577367,307,b===this.zc.currentNode);Rc.a(36577368,307,Td.ParagraphReader.Xb(b));-1!==this._formatting.zw&&
this.Sk.pE(b,this._formatting.zw);this._formatting.lineSpacing&&this.z5e.lD(b,this._formatting.lineSpacing);this._formatting.Y5&&this.z5e.Uhe(b,this._formatting.Y5);this.OLa=!0;this._formatting.paragraph=b}static Baf(b,h){let r=0;switch(h){case 3:r=af.a.Nv(b);break;case 7:r=Xg.a.Yy(b,0);break;case 1:r=af.a.E7e(b);break;case 5:r=af.a.Nv(af.a.D1f(b));break;default:t.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}
Object(n.a)(Fz,"TextOnlyBox4PasteSteward",Sx.a,[]);class Tx extends Fz{constructor(b,h,r,B,P,ca,ra,Qa=null,mb=null){super(h,r,B,P,ca,ra,Qa,mb);this.Jxc=!1;this.lwb=[];this.rjh=b;h={};h.textOnlyPasteFlags=b;t.ULS.sendTraceTag(509088282,307,50,I.c(h))}reset(){super.reset();this.Jxc=!1;this.lwb.length=0;this.Rod=!1}jE(b){this.Jxc||(super.jE(b),this.Jxc=!0)}zF(){this.Rod?this.Rod=!1:this.Jda(null)}Jda(b){this.rjh&2||super.Jda(b)}Dya(){}Bya(){}OHa(){}Cya(){}b$(){}Z9(){}w5(b){this.Jxc||(super.w5(b),this.Jxc=
!0);this.lwb.push(!1)}a$(){this.rjh&1&&this.Jda(null);0<this.lwb.length?this.lwb.pop():Rc.a(509088281,307,!1)}Y9(){var b=this.lwb.length-1;0<=b?this.lwb[b]?(b=Se.a.tw(this.zc.currentNode),this.jg.Ge(b,", ")):this.lwb[b]=!0:Rc.a(509088280,307,!1);this.Rod=!0}X9(){this.Rod=!1}Mcd(){}}Object(n.a)(Tx,"StrictTextOnlyBox4PasteSteward",Fz,[]);class Gz{constructor(b,h,r,B){this.BNe=b;this.FK=h;this.Hf=r;this.HZ=B}create(b,h,r,B,P=null,ca=null,ra=null,Qa=null){return 1===b?null!==Qa&&0!==Qa?new Tx(Qa,h,B,
this.BNe,this.FK,this.Hf,P,ca,this.HZ):new Fz(h,B,this.BNe,this.FK,this.Hf,P,ca,this.HZ):new Hy.Box4PasteSteward(h,r,B,this.BNe,this.FK,this.Hf,P,ca,this.HZ,ra)}}Object(n.a)(Gz,"Box4PasteStewardFactory",null,[537]);var Hz=c(191),Bl=c(339),on=c(1625);class Jl{constructor(b,h,r,B,P,ca=null){this.kz=null;this.yxb=0;this.zc=b;this.Lk=r;this.Mo=ca}N3b(b){this.kz=b}get zEa(){return 0<this.yxb}b$(b){var h,r;Rc.a(7869459,307,!!this.kz);Rc.a(7869460,307,Zf.OutlineElementReader.yh(this.zc)||Dg.OutlineReader.nx(this.zc));
Rc.b(38563978,307,50,"Table pasting started");this.kz.rgc(!0);const B=new xd.GraphIterator;B.kd(this.zc);let P=on.a.zwm[b.styleId];P||(v.AFrameworkApplication.se("gdea6103;0df65435"),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.XDf?(t.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("CCPFloodgateSurvey"))&&this.Mo&&this.Mo.execute(ca=>
{ca.logActivity("CCPUsage","CCPFloodgateSurvey")}),P=on.a.win):P=on.a.bRh);h=this.Lk.vUn(this.zc,b.rowCount,b.pgb,P,b.tableLook,this.kz.vRc(b),b.XDf);b.flg&&(Rc.b(573691298,3022,100,"Applying table border properties"),on.a.Cuh(b.flg,this.zc,!1,!0));b.SXd&&(Rc.b(573691299,3022,100,"Applying indentation properties"),on.a.sFk(this.zc,b.SXd.spaceBefore,b.SXd.spaceAfter));b.hHd&&(Rc.b(573691328,3022,100,"Applying column widths"),on.a.$Ek(b.hHd,this.zc,Object(Na.a)(Bl.TableNode,h),b.X4a));this.kz.JDd(B,
!1);this.yxb++;rg.ListItemReader.lg(B)&&this.kz.Mcd(B.currentNode);Rc.a(7869461,307,mi.TableReader.isTable(this.zc))}Z9(){Rc.a(7869462,307,!!this.kz);Rc.a(7869463,307,Al.a.isTableRow(this.zc));Rc.b(38563979,307,50,"Table pasting finished");this.zc.Ps(14)&&on.a.Qhj(this.zc.Gn);hg.OutlineElementNavigator.Yd(this.zc);this.yxb--}w5(b){Rc.a(7869464,307,!!this.kz);Rc.b(573691329,3022,100,"Table row pasting started");mi.TableReader.isTable(this.zc)?Qg.moveToFirstRow(this.zc):Al.a.isTableRow(this.zc)&&Qg.moveToNextRow(this.zc);
b.height&&(Rc.b(573691330,3022,100,"Applying table row height"),on.a.iGk(this.zc,b.height));Rc.a(7869465,307,Al.a.isTableRow(this.zc))}a$(){Rc.a(7869466,307,!!this.kz);Rc.a(7869467,307,qh.TableCellReader.isTableCell(this.zc));Qg.returnToContainingRow(this.zc)}Y9(b){Rc.a(7869468,307,!!this.kz);Rc.a(7869469,307,!this.kz.oV);Al.a.isTableRow(this.zc)?Qg.moveToFirstColumn(this.zc):qh.TableCellReader.isTableCell(this.zc)?Qg.moveToNextColumn(this.zc):Rc.a(7869471,307,!1);if(this.zc.currentNode){Rc.b(573691331,
3022,100,"Table cell pasting started");var h=Object(Na.a)(Hz.TableCellNode,this.zc.currentNode);Rc.a(50689760,307,!h&&16!==this.zc.currentNode.type||!!h&&16===this.zc.currentNode.type);if(h){var r=new xd.GraphIterator;r.kd(this.zc);if(b.cec)Rc.b(573691332,3022,100,"Processing skipped cell"),on.a.wKn(r,b);else{if(1<b.colSpan||1<b.rowSpan){const B=Qg.returnToContainingTable(r);if(!B)return;B.setValue(Oc.a.complexTable,!0);r.kd(this.zc);Rc.b(573691333,3022,100,"Processing merged cell");on.a.NJn(r,b);
h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}on.a.oGk(this.zc,b.shadingColor);on.a.dHk(this.zc,b.verticalAlignment);on.a.OEk(this.zc,b.xle);on.a.Cuh(b.uka,this.zc,!b.colSpan&&!b.rowSpan,!1);(new xd.GraphIterator).kd(this.zc);Qg.forEachCell(r,b.rowSpan,b.colSpan,(B,P,ca)=>{Rc.b(573691334,3022,100,"Setting ghost cell borders");on.a.imj(B,b.uka,P,ca,b.rowSpan,b.colSpan)});on.a.fHk(this.zc,b.width,b.X4a);Rc.a(7869472,307,Dg.OutlineReader.nx(this.zc))}}}}X9(){Rc.a(7869473,307,!!this.kz);Rc.a(7869474,307,Zf.OutlineElementReader.yh(this.zc)||
qh.TableCellReader.isTableCell(this.zc));Qg.returnToCell(this.zc);Rc.a(7869475,307,0>=this.kz.oV);this.kz.A8e()}}Object(n.a)(Jl,"Box4TableSteward",null,[550,314]);class Vn{constructor(b,h,r){this.kz=null;this.yxb=0;this.zc=b;this.Lk=r}N3b(b){this.kz=b}get zEa(){return 0<this.yxb}b$(){this.zEa&&(Rc.a(8787101,307,Td.ParagraphReader.oh(this.zc)),hg.OutlineElementNavigator.Yd(this.zc));Rc.a(8701086,307,!!this.kz);Rc.a(8701087,307,Zf.OutlineElementReader.yh(this.zc)||Dg.OutlineReader.nx(this.zc));this.yxb++}Z9(){Rc.a(8701088,
307,!!this.kz);hg.OutlineElementNavigator.Yd(this.zc);this.yxb--;if(this.zEa){this.kz.rgc(!0);const b=Vn.Pf.OH(this.zc);Rc.a(8787102,307,b===this.zc.currentNode);Rc.a(8787103,307,Td.ParagraphReader.oh(this.zc))}}w5(b){Rc.a(8701089,307,!!this.kz);this.kz.rgc(!0);const h=new xd.GraphIterator;h.kd(this.zc);this.kz.JDd(h,!1);rg.ListItemReader.lg(h)&&this.kz.Mcd(h.currentNode);b=Vn.Pf.OH(this.zc,this.kz.vRc(b));Rc.a(8701090,307,b===this.zc.currentNode);Rc.a(8701091,307,Td.ParagraphReader.oh(this.zc))}a$(){Rc.a(8701120,
307,!!this.kz);Rc.a(8701121,307,Td.ParagraphReader.oh(this.zc));hg.OutlineElementNavigator.Yd(this.zc)}Y9(){Rc.a(8701122,307,!!this.kz);Rc.a(8701123,307,Td.ParagraphReader.oh(this.zc));Rc.a(8701124,307,!this.kz.oV);var b=this.zc.currentNode;Td.ParagraphReader.textLength(b)&&(b=Se.a.tw(b),this.kz.jg.Ge(b,", "))}X9(){Rc.a(8701125,307,!!this.kz);Rc.a(8701126,307,Td.ParagraphReader.oh(this.zc));Rc.a(8701127,307,0>=this.kz.oV);this.kz.A8e()}static get Pf(){return null!=Vn.pFg?Vn.pFg:Vn.pFg=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}}
Object(n.a)(Vn,"TextOnlyBox4TableSteward",null,[550,314]);class fn{constructor(b,h,r=!1,B=!1,P=null){this.FK=b;this.qA=h;this.pfk=r;this.wfk=B;this.Mo=P}create(b,h){return 1===b?new Vn(h,this.FK,this.qA):new Jl(h,this.FK,this.qA,this.pfk,this.wfk,this.Mo)}}Object(n.a)(fn,"Box4TableStewardFactory",null,[538]);class mq{create(){return new al.a}}Object(n.a)(mq,"Factory",null,[536]);class kr{constructor(b){this.ga=b}Hfn(b){if(4===b)b=Mb.a.cHa;else if(2===b)b=Mb.a.Sja;else if(1===b)b=Mb.a.QSb;else if(3===
b)b=Mb.a.F1a;else return;this.ga.processAction(b,2)}cib(){this.ga.processAction(Mb.a.cib,2)}}Object(n.a)(kr,"SelectionCommands",null,[535]);var Fr=c(231),Iz=c(1113),Iy=c(142),Ux=c(641);class xt{constructor(){this.kZc=!1;this.p4o=v.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.r4o=v.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.q4o=v.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");this.m4o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");
this.o4o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}uMo(){this.kZc=!this.kZc}tMo(b){this.uMo();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],B=b.getElementsByClassName("VisiFontPilcrowStyle")[0],P=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Kb.a.wv(h,""),b.appendChild(h));
r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",Kb.a.wv(r,""),b.appendChild(r));B||(B=document.createElement("Style"),B.className="VisiFontPilcrowStyle",Kb.a.wv(B,""),b.appendChild(B));P||(P=document.createElement("Style"),P.className="VisiFontCarriageReturnStyle",Kb.a.wv(P,""),b.appendChild(P));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",Kb.a.wv(ca,""),b.appendChild(ca));if(this.kZc)return t.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),
this.XGc(h)&&this.XGc(r)&&this.XGc(B)&&this.XGc(P)&&this.XGc(ca);t.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.g7c(h)&&this.g7c(r)&&this.g7c(B)&&this.g7c(P)&&this.g7c(ca)}XGc(b){return""===Kb.a.Jy(b)?("VisiFontStyle"===b.className?Kb.a.wv(b,this.JQc("WordVisi_MSFontService",this.p4o)):"VisiFontRtlStyle"===b.className?Kb.a.wv(b,this.JQc("WordVisiRtl_MSFontService",this.r4o)):"VisiFontPilcrowStyle"===b.className?Kb.a.wv(b,this.JQc("WordVisiPilcrow_MSFontService",
this.q4o)):"VisiFontCarriageReturnStyle"===b.className?Kb.a.wv(b,this.JQc("WordVisiCarriageReturn_MSFontService",this.m4o)):"VisiFontCarriageReturnRtlStyle"===b.className&&Kb.a.wv(b,this.JQc("WordVisiCarriageReturnRtl_MSFontService",this.o4o)),!0):!1}g7c(b){return""!==Kb.a.Jy(b)?(Kb.a.wv(b,""),!0):!1}JQc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(n.a)(xt,"VisiMarkersOperation",null,[533]);var Cs=c(453),
jp=c(379);class St extends Cs.a{constructor(b,h){super(b,h);this.iFe=-1;this.jvb=0;this.XBe=null;this.n_g=!1;this.kDe=[];this.Kpd=!1;this.x8g=!0;this.OMe=this.xnd=null;this.preventDismissOnScroll=this.Pae=this.Iic=!1;this.u8=null;this.Pzd=!1;this.yTc=!0;this.Vs=!1;this.D1g=v.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");St.mdh||(v.AFrameworkApplication.va.qa(eb.a.showFloatie,Gd.a.frame,nd.ActionManager.Nf),St.mdh=!0)}get J1h(){return this.vO}set J1h(b){this.vO=b}get aBj(){return this.Pzd}get KUc(){return this.n_g}set KUc(b){this.n_g=
b;this.jvb=0}get $A(){return!0}get cssClass(){return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.D9?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Vs}zUa(){for(let b of this.children)if(b.zUa())return!0;return!1}get A$(){return 9}Bf(b){this.kDe[this.kDe.length]=b;super.Bf(b)}Hm(){super.Hm();lf.c(this.Nc)&&this.RC();this.Nc=Af.a.XTa(this.Nc);this.sX(this.Nc);this.dirty=!1}chc(b){3===b.kg||this.Pae||this.dismissFloatie(b);return!1}fhc(){return!1}dhc(b){3!==b.kg&&
this.yTc&&!this.Iic&&this.dZo(b);return!1}ehc(){return!1}ahc(b){3===b.kg&&this.dismissFloatie(b);return!1}bhc(b){void 0!==this.u8&&null!==this.u8||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}fD(){this.Yif();return!1}g8d(){this.KUc=!0}dZo(b){if(b=Kd.a.k7b(b.clientPoint,this.XBe)){if(this.KUc){if(!this.jvb||b<this.jvb)this.jvb=b;b-=this.jvb}b-=this.iFe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():ba.a.setOpacity(this.Nc,Math.max(h/255,0))}else this.KUc=!1,this.jvb=
0,ba.a.setOpacity(this.Nc,1)}tXo(b){let h=null;void 0!==this.xnd&&null!==this.xnd&&(h=this.xnd(b));b=null;for(const r of this.kDe){let B=!this.aBj&&r.qEi;if(!B&&void 0!==h&&null!==h)for(let P=0;P<h.length;P++)if(r.id===h[P]){B=!0;break}r.Nc.style.display=B?"none":"";r.h7b=!B;B||(b=r)}b&&(b.h7b=!1)}z$h(){const b=this.Nc.style.top,h=this.Nc.style.left;this.Nc.style.top="0px";this.Nc.style.left="0px";const r=this.nGb();this.Nc.style.top=b;this.Nc.style.left=h;return r}nGb(){const b=this.Nc.style.visibility,
h=this.Nc.style.display;this.Nc.style.visibility="hidden";this.Nc.style.display="";const r=Qd.a.getElementBounds(this.Nc);this.Nc.style.display=h;this.Nc.style.visibility=b;return r}t9i(b){3===b||this.Xme?(Sys.UI.DomElement.addCssClass(this.Nc,jp.a.tSb),this.Pzd=!0):(Sys.UI.DomElement.removeCssClass(this.Nc,jp.a.tSb),this.Pzd=!1);this.tXo(b)}t8a(b,h,r,B=!1){this.isVisible||(this.u8||!this.x8g&&this.preventDismissOnScroll||(this.x8g=!1,Qd.a.T4d("ShowLegacyFloatie",""),v.AFrameworkApplication.va.processAction(eb.a.showFloatie,
2)),this.t9i(r),this.yTc=!0,this.jvb=0,this.KUc=!1,!this.D1g||void 0!==this.u8&&null!==this.u8?(this.Kpd=!1,this.Fga(this,!1)):(this.Kpd=!0,this.FKk(this)),h=B?b:this.NFn(b,h),this.Nc.style.top=h.y.toString()+"px",this.Nc.style.left=h.x.toString()+"px",this.yu(),this.XBe=this.nGb(),this.iFe=Kd.a.k7b(b,this.XBe),ba.a.setOpacity(this.Nc,1),this.Nc.style.zIndex=String(v.AFrameworkApplication.ta.Fua),this.Nc.style.display="",this.Vs=!0)}NFn(b,h){const r=this.aBj?30:17,B=this.z$h(),P=Kb.a.yHb(),ca=Kb.a.kY();
b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=B.height:3===h?(b.y-=B.height,b.x-=B.width):2===h&&(b.x-=B.width);b.x+B.width>P&&(b.x=Math.floor(P-B.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+B.height>ca&&(b.y=ca-B.height);return b}OFn(b,h){const r=b.$Oi;if(r){this.t9i(h);var B=this.z$h();this.u8=b;b=r.Zrg-r.ZOc>B.width;var P=r.ZOc+r.qmf>B.width,ca=r.P8b>B.height+17,ra=r.HKj-(r.P8b+r.mmf)>B.height+17;B=new Sys.UI.Point(r.ZOc,r.P8b);P||b||(P=!0,B.x=r.Zrg);b=r.vmb?r.UKf?ra?P?2:0:
P?3:1:ca?P?3:1:P?2:0:r.UKf?ra?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===b||2===b)B.x=r.ZOc+r.qmf;if(2===b||0===b)B.y=r.P8b+r.mmf;this.t8a(B,b,h);this.yTc=!1;h=this.u8.AZe.Nc;void 0!==h&&null!==h&&(h.style.zIndex=String(v.AFrameworkApplication.ta.Fua))}}q4(){let b=super.q4();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.QFc&&null!==this.QFc&&this.QFc.Sva(null);void 0!==this.u8&&null!==this.u8&&this.u8.g4();this.g4();this.D1g&&this.Kpd?this.kwl(this):
this.ica(this,!1);this.Kpd=!1;this.iFe=-1;this.u8=null;this.Nc.style.display="none";this.Vs=!1;this.OMe&&this.OMe(b);return!0}Yif(){void 0!==this.u8&&null!==this.u8&&(this.u8.z_a=null,this.u8.g4(),this.u8=null,this.m5d.style.zIndex=String(v.AFrameworkApplication.ta.fDa),this.Nc.style.zIndex=String(v.AFrameworkApplication.ta.Fua))}YWn(b){this.xnd=b}KXn(b){this.OMe=b}set $A(b){super.$A=b}}St.mdh=!1;Object(n.a)(St,"Floatie",Cs.a,[713,357,358]);class ix{constructor(b,h){this.Cv=this.LLa=null;this.pMi=
b;this.Tgj=h}get L1h(){return this.LLa}qqo(b){this.LLa=b}nGb(){return this.Cv.nGb()}M0(){return this.Cv?this.Cv.isVisible:!1}zxh(b){this.qqo(b)}showFloatie(b,h){this.t8a(h.location,h.Ux,h.isRtl)}t8a(b,h,r){r=r?this.Tgj:this.pMi;this.lNd();this.Cv&&this.Cv.t8a(b,r,h)}dismissFloatie(){this.Cv&&this.Cv.dismissFloatie()}lNd(){this.LLa&&!this.Cv&&(this.Cv=Object(Na.a)(St,this.LLa()))}$Nd(){}}Object(n.a)(ix,"AFloatieManager",null,[548]);class bv extends ix{constructor(){super(1,3);this.nzj=!1;this.qSh=
""}t8a(b,h,r){r=r?this.Tgj:this.pMi;this.lNd();this.Cv&&(this.Cv.isVisible&&this.Cv.dismissFloatie(),this.nzj||this.Cv.Gm(),this.Cv.t8a(b,r,h,!0))}lNd(){this.L1h&&!this.Cv&&(this.Cv=this.LLa())}$Nd(){if(this.Cv&&this.Cv.isVisible){const b=Object(Na.a)(bm.Control,this.Cv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.gx(b.hjb(),1,null)}}Xeg(b){this.qSh=b}r3n(b){b=b.pqf("Menu16",null);rh.a("renderIcon")&&b&&appChrome.api.renderIcon(bv.d1j,b.firstElementChild)}apc(b,h,r){if(this.Cv){const B=this.Cv.controls[this.qSh];
B&&(bv.b1g||(this.r3n(B),bv.b1g=!0),B.Sd[mk.a.labelText]=b,B.Sd[mk.a.alt]=h,r&&B.behavior.Gm())}}}bv.b1g=!1;bv.d1j="Designer_20";Object(n.a)(bv,"PasteFloatieManager",ix,[]);var vu=c(1063);class jx{constructor(){this.Nd=null}get Ku(){return null}getTitle(){return null}c9h(){return null}reset(b){this.Nd=b.node}lAa(b){b=xo.d(this.Nd,b);let h=null;if(!b||b.vh!==this.vh)return{returnValue:!1,RE:h};h=Object.assign(new vu.a,{nE:this.key,contentObject:b,title:this.getTitle(b),description:this.c9h(b)});return{returnValue:!0,
RE:h}}}Object(n.a)(jx,"BlobDetailsProvider",null,[345,346]);class yt extends jx{constructor(){super()}get key(){return"EQUATION"}get vh(){return 11}get Ku(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(n.a)(yt,"EquationDetailsProvider",jx,[]);class Tt{constructor(){this.QZg=null}get key(){return"LINK"}get Ku(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.QZg=ch.a.d$b(b.node)}lAa(b){let h=null;for(const r of this.QZg)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new vu.a,
{nE:this.key,contentObject:r.hyperlink}),{returnValue:!0,RE:h};return{returnValue:!1,RE:h}}}Object(n.a)(Tt,"HyperlinkDetailsProvider",null,[345,346]);var Vx=c(1398),dt=c(913);class xB{constructor(){this.L3g=!1}get key(){return"IFRAMENODE"}get Ku(){return this.L3g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}ESb(b){let h=null;b=b?Td.ParagraphReader.sQa(b.currentNode):null;if(!b)return{returnValue:!1,Xba:h};h=Object.assign(new Vx.a,{nE:this.key,contentId:b.id,
contentObject:b});return{returnValue:!0,Xba:h}}ejb(b,h){b=b?Object(Na.a)(dt.a,b.contentObject):null;h=h?Object(Na.a)(dt.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.L3g=b.h5a,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Ku,this.Ku));return r}}Object(n.a)(xB,"IFrameDetailsProvider",null,[549,346]);class yB extends jx{constructor(){super()}get key(){return"IMAGE"}get vh(){return 5}reset(b,h){super.reset(b,h);this.E9j=!Pd.SelectionEditor.Pl(h)}get Ku(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return ye.ImageReader.eY(b.properties)}c9h(b){var h;
b=ye.ImageReader.uQa(b.properties);return null!==(h=qe.App.instance)&&void 0!==h&&h.$1d&&this.E9j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(n.a)(yB,"ImageDetailsProvider",jx,[]);class Jz{get key(){return"IMAGENODE"}get Ku(){return Box4Intl.Box4Strings.l_ImageContentTitle}ESb(b){let h=null;if(!b||!ye.ImageReader.Mt(b.currentNode))return{returnValue:!1,Xba:h};h=Object.assign(new Vx.a,{nE:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,
Xba:h}}ejb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let B="";h&&b.id===h.contentObject.id||(B=String.format(r,ye.ImageReader.eY(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return B}}Object(n.a)(Jz,"ImageNodeDetailsProvider",null,[549,346]);let Jp,an;class nw{constructor(b,h){this.NUg=null;this.Dn=h;this.IPe=b;this.key=nw.keys.J(b);this.Ku=nw.gaf.J(b)}reset(b){this.NUg=this.Dn.G4(b.node)}lAa(b){var h=nw.Rlf(this.NUg||[],r=>this.$Km(b,r));h=this.U$k(h);
return{returnValue:!!h,RE:h}}$Km(b,h){return h.Bc<=b&&b<h.end&&(!h.errorDetails||this.IPe===h.errorDetails.proofingType)}U$k(b){return b?Object.assign(new vu.a,{nE:this.key,contentObject:b.errorDetails,description:this.hQa()}):null}hQa(){return oo.a.PGa()?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static Rlf(b,h){for(const r of b)if(h(r))return r;return null}}nw.keys=(an=new xf.a,an.add(1,"SPELLINGERROR"),an.add(2,"GRAMMATICALERROR"),an.add(3,"ADVANCEDERROR"),an);nw.gaf=(Jp=
new xf.a,Jp.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Jp.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Jp.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Jp);Object(n.a)(nw,"ProofingDetailsProvider",null,[345,346]);class Wx{constructor(){this.tableNode=null;this.fHd=this.qfe=this.columns=this.rows=0}}Object(n.a)(Wx,"TableInfo",null,[]);class zB{get key(){return"TABLE"}get Ku(){return Box4Intl.Box4Strings.l_TableContentTitle}ESb(b){var h=null;if(!qh.TableCellReader.isTableCell(b))return{returnValue:!1,
Xba:h};h=new xd.GraphIterator;h.kd(b);b=new Wx;b.qfe=Al.a.Ls(h)+1;b.fHd=bt.a(h)+1;Qg.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=mi.TableReader.hh(b.tableNode);b.rows=mi.TableReader.gg(b.tableNode);h=Object.assign(new Vx.a,{nE:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,Xba:h}}ejb(b,h){b=b.contentObject;const r=new Hh.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.fHd===b.fHd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,
b.fHd));h&&h.contentObject.qfe===b.qfe||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.qfe));return r.toArray().join(" ")}}Object(n.a)(zB,"TableDetailsProvider",null,[549,346]);class hh{constructor(b,h){this.QLa=b;this.Dn=h}get gTb(){return null!=this.FJg?this.FJg:this.FJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}l7f(){this.QLa.execute(b=>{b.tV(new Tt);oo.a.LDf()||(this.gTb||(b.tV(new nw(1,this.Dn)),
b.tV(new nw(2,this.Dn))),b.tV(new nw(3,this.Dn)));b.tV(new yt);b.tV(new yB);b.WOb(new zB);b.WOb(new Jz);b.WOb(new xB)})}}Object(n.a)(hh,"AccessibilityActor",null,[]);class CA{constructor(b,h,r){this.pxn=(B,P,ca)=>{if(1===ca)return 32;this.xXj().Mhg();return 32};this.e_a=b;this.xXj=r}Ub(){this.e_a.fb(Mb.a.$Zi,zc.a.view,this.pxn,1028)}}Object(n.a)(CA,"AutoCorrectActor",null,[]);var wu=c(1991);class Cm{constructor(){this.O4d=!0}zya(){}s6a(){}N3b(){}pYf(){}nhe(){}get oic(){return!1}get Anb(){return 0}get tOi(){return!1}get MX(){return Lb.a.nil}}
Object(n.a)(Cm,"TextOnlyBox4ImageSteward",null,[546]);class Az{constructor(b,h,r,B,P,ca,ra=!1){this.oP=b;this.taskManager=h;this.vg=r;this.gym=B;this.notificationBar=P;this.Zb=ca;this.w4m=ra}create(b,h,r,B){return 1===b?new Cm:new wu.a(h,this.oP,this.taskManager,this.vg,this.Zb,this.gym,this.notificationBar,this.w4m,r,B)}}Object(n.a)(Az,"Box4ImageStewardFactory",null,[531]);var Ck=c(38);class yA{constructor(b){this.E0d=b}qSm(b){if(!b||!b.LB||1>b.LB.count)return!1;const h=[Ck.a.fPh,Ck.a.ePh];return!!this.ZQd(b.LB,
1,r=>this.lId(r,h))}Nxi(b){return!b||!b.LB||1>b.LB.count?!1:!!this.ZQd(b.LB,1,h=>this.lId(h,[Ck.a.FG]))}nPm(b){return!b||!b.LB||1>b.LB.count?!1:!!this.ZQd(b.LB,2,h=>this.lId(h,[Ck.a.d_c]))}oh(b){return!b||!b.LB||1>b.LB.count?!1:!!this.ZQd(b.LB,1,h=>this.lId(h,[Ck.a.sja]))}w_d(b){if(!b||!b.LB)return!1;b=b.LB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).SIk)return!1;return!0}Tyl(b,h){return this.Nxi(h)||this.nPm(h)?"":b}ZQd(b,h,r){if(b&&0<b.count)for(let B=b.count-1;0<=B;--B){if(r(b.J(B)))return b.J(B);
if(b.count-B>=h)break}return null}lId(b,h){b=b&&b.Qpi?b.Qpi.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(n.a)(yA,"Box4PasteStewardUtils",null,[532]);var yv=c(738);class Mx{constructor(){this.Moc=0;this.ofc=Array(9)}}Object(n.a)(Mx,"FullListMetadata",null,[]);class Dy{constructor(b,h,r){this.Moc=this.level=0;this.c_h=null;this.gic=!1;this.level=b;this.lqe=h;this.vyn=r}}Object(n.a)(Dy,"ListItemMetadata",null,[]);var cr=c(1604);class Ey{constructor(){this.level=
0;this.tagName="UL";this.dnb=null;this.ignore=!1;this.bkn=0;this.listStyle="BulletListStyle1";this.Hmb=new cr.a;this.font=this.levelText=""}}Object(n.a)(Ey,"ListLevelMetadata",null,[]);class zA{constructor(){}}Object(n.a)(zA,"LevelLists",null,[]);class AA{constructor(b){this.nodes=b;this.hPa=0;this.lists={};this.Hmb=[];this.mGi=null;this.Dhl=[];this.Dhl[0]=new zA}}Object(n.a)(AA,"WordConverterArguments",null,[]);var pp=c(599);class Of{}Of.xil="data-ccp-timestamp";Of.EKd="data-clipservice-ccpid";Of.Ail=
"data-shapeids";Of.Wmm="docs-internal-guid-";Of.gxn="SCXO";Of.nGn="SCXP";Of.v6o="SCXW";Of.Agn="MsoListParagraphCxSpFirst";Of.Bgn="MsoListParagraphCxSpLast";Of.Ydf="data-pkey";Of.Zdf="data-clipservice-type";Of.Wdf="data-clipservice-count";Of.Xdf="data-clipservice-dc";Of.wLc="data-clipservice-client";Of.$df="data-clipservice-version";Object(n.a)(Of,"HtmlContentMetadataConstants",null,[]);class Oq{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(n.a)(Oq,"AbsolutePosition",null,[]);var dr=
c(869);class Go{constructor(b,h,r="",B=0){this.Bx=!1;this.DZg=this.EZg=null;let P=!1;Go.zOm(b)&&(P=!0,this.EZg=b);Go.ROm(h)&&(this.DZg=h);this.y6j=r;this.eXj=B;this.Bx=P&&this.fXd?!0:!1}get isValid(){return this.Bx}get Tpi(){return this.EZg}get fXd(){return this.DZg}get Qpi(){return this.y6j}get SIk(){return this.eXj}static zOm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static ROm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(n.a)(Go,"HtmlElementInfo",null,[]);class Vs{constructor(b){this.next=
null;this.data=b}}Object(n.a)(Vs,"StackNode",null,[]);class qu{constructor(){this.Uq=null;this.$j=0}get count(){return this.$j}get isEmpty(){return!this.count||!this.Uq}push(b){b=new Vs(b);b.next=this.Uq;this.Uq=b;this.$j=this.count+1}bZ(){return this.count&&this.Uq?this.Uq.data:null}pop(){if(!this.count||!this.Uq)return null;const b=this.Uq;this.Uq=b.next;this.$j=this.count-1;return b.data}clear(){this.Uq=null;this.$j=0}toArray(){const b=Array(this.count);let h=this.Uq;for(let r=this.count-1;0<=
r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(n.a)(qu,"Stack",null,[]);class Pj{constructor(b){this.aj=b;this.Rvc=this.Ssd=null;this.Vkd=!1}get mKd(){return this.Rvc.bZ()}reset(){this.aj.reset();this.Ssd=new qu;this.Rvc=new qu;this.Rvc.push(this.aj.GLc);this.Vkd=!1}Z6d(){this.Vkd=!1}$J(b){this.Vkd||(this.Ssd.push(null),this.Vkd=!0);this.Ssd.push(b)}onClose(){for(;;){const b=this.Ssd.pop();if(!b)break;b()}}gmj(){return!1}ujn(){this.mv(()=>!0)}mv(b){const h=this.mKd.clone();return b(h)?(this.Rvc.push(h),
this.aj.KHa(h),this.$J(Object(z.a)(this,this.npn,"onFormattingEnd")),!0):!1}yyf(b){return b.style?this.mv(h=>this.gmj(h,b))?1:2:2}npn(){this.Rvc.pop();this.aj.KHa(this.mKd)}Kda(){}T6d(){return 2}mVf(){return 2}nVf(){return 2}sVf(){return 2}HVf(){return 3}JVf(){}Y6d(){return 2}KVf(){}LVf(){}MVf(){return 2}a7d(){return 2}b7d(){return 2}$Vf(){return 2}c7d(){}bWf(){return 2}d7d(){return 2}e7d(){return 2}h7d(){return 2}i7d(){return 2}oWf(){}pWf(){return 2}p7d(){return 2}q7d(){return 2}t7d(){return 2}u7d(){return 2}w7d(){return 2}x7d(){return 2}z7d(){return 2}B7d(){return 2}QWf(){return 2}I7d(){return 2}XWf(){return 2}ZWf(){}$Wf(){return 2}L7d(){return 2}M7d(){return 2}N7d(){return 2}O7d(){return 2}P7d(){return 2}Q7d(){return 2}gXf(){return 3}R7d(){}nXf(){return 2}S7d(){return 2}pXf(){return 3}V7d(){}vXf(){}W7d(){return 2}BXf(){return 3}Y7d(){return 2}$7d(){return 2}b8d(){return 2}c8d(){return 2}MXf(){}QXf(){return 3}e8d(){return 2}onMenuOpen(){return 2}UXf(){}cYf(){return 2}dYf(){return 2}fYf(){return 3}q8d(){return 2}hYf(){return 2}r8d(){return 2}v8d(){return 2}oYf(){}C8d(){return 2}zYf(){return 2}J8d(){return 2}K8d(){return 2}RYf(){return 3}YYf(){return 2}S8d(){return 2}T8d(){return 2}V8d(){return 2}W8d(){return 2}bZf(){return 3}X8d(){return 2}$8d(){return 2}b9d(){return 2}eZf(){return 2}U2c(){return 2}hZf(){return 2}iZf(){return 2}e9d(){return 2}jZf(){return 2}mZf(){return 3}j9d(){return 2}k9d(){return 2}l9d(){return 2}m9d(){return 2}r9d(){return 2}o9d(){return 2}static Xha(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(E.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static Qfi(b){if(!b||""===b)return-1;const h=E.a.eh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(E.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(E.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static Ici(b){b=Pj.Qfi(b);return-1===b?0:0>b?(t.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static efm(b){return Pj.Qfi(b)}static nfi(b){return b&&
""!==b?Pj.Xha(b):null}static lE(b){let h=null,r=null,B=null,P=null;b&&b.kf&&(h=Pj.rR(b.kf,"id"),r=Pj.rR(b.kf,"lang"),B=b.kf.tagName,b.LEk&&(P=Object.assign(new Oq,{x:Pj.Xha(b.kf.style.left),y:Pj.Xha(b.kf.style.top),left:Pj.nfi(b.kf.style.left),top:Pj.nfi(b.kf.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new dr.a(new Go(h,B),b.LB,null,r,P)}static rR(b,h){return b[h]}}Object(n.a)(Pj,"AHtmlTranslator",null,[482]);class gj extends dr.a{constructor(b,h,r,B=0,P=0,ca=null){super(ca?ca.f$:
null,ca?ca.LB:null,ca?ca.Mya:null,ca?ca.cultureName:null,ca?ca.dDa:null);this.width=B;this.height=P}}Object(n.a)(gj,"AugmentationSemanticArgs",dr.a,[]);var Mn=c(1713);class ax{constructor(){this.stop=this.color=null}}Object(n.a)(ax,"ColorStopPair",null,[]);var kj=c(1997);class Or{constructor(){this.direction=null;this.rJc=new cr.a}Ini(){return!!this.direction&&0<this.direction.length}}Object(n.a)(Or,"LinearGradient",null,[]);class BA{constructor(){this.Ecc=!1}}Object(n.a)(BA,"HtmlTranslatorContext",
null,[]);var Bz=c(1871);class xC{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(n.a)(xC,"IndentationProperties",null,[]);var kp=c(1404);class ow extends dr.a{constructor(b,h,r,B,P=null,ca=0,ra=null,Qa=null,mb=!1,Jb=!1,Yb=69905,fc=null){super(fc?fc.f$:null,fc?fc.LB:null,fc?fc.Mya:null,fc?fc.cultureName:null,fc?fc.dDa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.cec=Jb;this.height=B;this.X4a=mb;this.shadingColor=P;this.verticalAlignment=ca;this.uka=ra;this.xle=Qa;this.k8=Yb}}
Object(n.a)(ow,"TableCellSemanticArgs",dr.a,[]);class wj extends dr.a{constructor(b,h=null){super(h?h.f$:null,h?h.LB:null,h?h.Mya:null,h?h.cultureName:null,h?h.dDa:null);this.height=b}}Object(n.a)(wj,"TableRowSemanticArgs",dr.a,[]);class bx extends dr.a{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb=null,Yb=-1,fc=null){super(fc?fc.f$:null,fc?fc.LB:null,fc?fc.Mya:null,fc?fc.cultureName:null,fc?fc.dDa:null);this.hHd=null;this.rowCount=b;this.pgb=h;this.width=r;if(P)for(this.hHd=Array(P.length),b=0;b<P.length;++b)this.hHd[b]=
P[b];this.XDf=ca;this.flg=Qa;this.sJm=ra;this.X4a=B;this.SXd=mb;this.styleId=Jb;this.tableLook=Yb}}Object(n.a)(bx,"TableSemanticArgs",dr.a,[]);var ho=c(1420);let Dk;class Wk extends Pj{get TNm(){if(null!=this.PDg)var b=this.PDg;else{var h;v.AFrameworkApplication.se("FontFamilyFix;FontFamilyFixCf");b=this.PDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,r=new BA,B=null){super(b);this.settings=
h;this.context=r;this.y_c=B;this.$wb=null;this.Fak=zb.a.i6("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.kmo=new Set(["DIV","P"])}get UHi(){return this.Fak}oci(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.UHi[E.a.eh(r)])||(r=Pj.rR(b,"type"))&&""!==r&&(r=this.UHi[r]))return r;
if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=b.className))if("ul"===r)switch(b=Wk.sVd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Wk.sVd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}hci(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===
r||"ul"===r){b=Kb.a.j$h(b,"li");if(!b)return h;r="li"}if("li"===r){h=(h=this.IQd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Kb.a.j$h(b,"p"))return Wk.K3l(b)-1}return h}IQd(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}drn(){this.$wb.pop();this.aj.Bya()}aTc(b,h){this.mv(P=>P.pea(0,0));const r=this.oci(b.kf,h?6:2);let B=1;h&&(B=this.IQd(b.kf,"start",1));h=!1;h=b.kf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.kf.removeAttribute("data-pasteFromRc");(ba.a.U4||ba.a.Dj)&&
Wk.KGd(b.kf);b=new kp.a(r,B,Pj.lE(b),0,-1,h);this.$wb.push(b);this.aj.Dya(b);this.$J(Object(z.a)(this,this.drn,"onListElementClose"));return 1}zfl(b,h,r){return(h=h.getAttribute(r))?b.Acf(h):!1}reset(){super.reset();this.$wb=new qu}static get PXc(){if(null!=Wk.VDg)var b=Wk.VDg;else{var h;v.AFrameworkApplication.se("ghdeg324;j91ib322");b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isPastedHtmlRenderingInIframeEnabled",!1);b=Wk.VDg=b}return b}gmj(b,
h){var r,B,P,ca;let ra=!1;try{var Qa=h.getAttribute("xml:lang")||Pj.rR(h,"lang")}catch(Yb){Qa=null}Qa&&""!==Qa&&(ra=b.ieg(Qa)||ra);(Qa=Pj.rR(h,"dir"))&&(ra=b.Elc(Qa)||ra);if(this.settings.oto(this.context)&&h.getAttribute)for(Qa=0;Qa<Wk.exj.length;Qa++)ra=this.zfl(b,h,Wk.exj[Qa])||ra;Qa=h.style;var mb=0;ho.a.QRa&&(mb=window.performance.now());const Jb=Wk.PXc?getComputedStyle(h):null;ho.a.QRa&&(ho.a.Ume+=window.performance.now()-mb,ho.a.m6d+=1);if(Qa){if(Qa.fontWeight){mb=E.a.ZA(Qa.fontWeight);const Yb=
parseInt(mb);isNaN(Yb)?"BOLD"===mb?ra=b.IL(!0)||ra:"NORMAL"===mb&&(ra=b.IL(!1)||ra):ra=600<=Yb?b.IL(!0)||ra:b.IL(!1)||ra}this.settings.Nqj&&Qa.fontSize&&(mb=null!==(r=null===Jb||void 0===Jb?void 0:Jb.fontSize)&&void 0!==r?r:Qa.fontSize,r=Pj.efm(mb),0<r&&(ra=b.ehe(Math.floor(2*r))||ra));(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.kmo.has(h.tagName)&&(B=Pj.Ici(null!==(P=null===Jb||void 0===Jb?
void 0:Jb.marginTop)&&void 0!==P?P:Qa.marginTop),P=Pj.Ici(null!==(ca=null===Jb||void 0===Jb?void 0:Jb.marginBottom)&&void 0!==ca?ca:Qa.marginBottom),ra=b.pea(B,P)||ra);this.settings.sto(this.context)&&(this.settings.Rqj&&h.getAttribute?(ca=h.getAttribute("data-indent"))&&0<ca.length&&(ca=Xg.a.Oi(parseInt(ca),0)+"px",ra=b.cie(ca)||ra):Qa.textIndent&&(ra=b.cie(Qa.textIndent)||ra));this.settings.nto(this.context)&&Qa.marginLeft&&(this.settings.Rqj&&h.getAttribute?(ca=h.getAttribute("data-margin"))&&
0<ca.length&&(ra=b.cka(Qa.marginLeft)||ra):"TABLE"!==h.tagName&&(ra=b.cka(Qa.marginLeft)||ra));if(this.settings.qto(this.context)&&(ca=h.getAttribute("style"))&&""!==ca)for(ca=ca.split(";"),P=0;P<ca.length;P++)B=ca[P].trim(),B.startsWith("tab-stops")&&(ra=b.bfg(B.replace("tab-stops:",""))||ra);this.settings.mto(this.context)&&Qa.lineHeight&&(ra=b.lD(Qa.lineHeight)||ra);this.settings.jto&&(ca=Qa.textTransform?E.a.eh(Qa.textTransform):null,P=Qa.fontVariantCaps?E.a.eh(Qa.fontVariantCaps):null,B=Qa.fontVariant?
E.a.eh(Qa.fontVariant):null,"uppercase"===ca?ra=b.j$c("uppercase")||ra:"small-caps"===P||B&&0<=B.indexOf("small-caps")?ra=b.j$c("small-caps")||ra:this.settings.rUk&&"none"===ca&&(ra=b.j$c("none")||ra));this.settings.rto(this.context)&&Qa.textAlign&&(ra=b.JQb(E.a.eh(Qa.textAlign))||ra);Qa.fontStyle&&(ca=E.a.ZA(Qa.fontStyle),"ITALIC"===ca||"OBLIQUE"===ca?ra=b.dqb(!0)||ra:"NORMAL"===ca&&(ra=b.dqb(!1)||ra));ca=Wk.dim(h);if(Qa.textDecoration||ca)P=E.a.eh(Qa.textDecoration||""),ca=E.a.eh(ca||""),h.parentNode&&
h.parentNode.tagName&&"a"===E.a.eh(h.parentNode.tagName)?(B=(h.querySelector(".TextRun")||h).className)&&-1<B.indexOf("Underlined")&&(ra=b.R5(!0)||ra):Qa.nup||Wk.isUnderline(P)||Wk.isUnderline(ca)?ra=b.R5(!0)||ra:this.settings.Yrj&&(ra=b.R5(!1)||ra),Qa.mup||Wk.Zzi(P)||Wk.Zzi(ca)?ra=b.fka(!0)||ra:this.settings.Yrj&&(ra=b.fka(!1)||ra);if(Qa.verticalAlign){ca=E.a.ZA(Qa.verticalAlign);P=this.ZQn(ca);if("SUB"===ca||this.settings.Qqj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>P&&
this.settings.vrj)ra=b.YIa(!0)||ra;else if("SUPER"===ca||this.settings.Qqj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<P&&this.settings.vrj)ra=b.xra(!0)||ra;this.settings.Nqj&&("SUB"===ca||"SUPER"===ca)&&h.getAttribute&&(ca=parseFloat(h.getAttribute("data-fontsize")),isNaN(ca)||(ra=b.ehe(Math.floor(2*ca))||ra))}ca=!1;v.AFrameworkApplication.K&&(ca=v.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.lto&&Qa.fontFamily&&(this.settings.uto&&h.getAttribute?
(P=h.getAttribute("data-usefontface"))&&"true"===P&&(ca&&t.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),ra=this.emj(b,Qa.fontFamily,ra)):ra=this.emj(b,Qa.fontFamily,ra));P=null;this.settings.kto&&Qa.color&&(P=kj.a.zva(Qa.color));B=!!P;this.settings.tto(this.context)&&h.getAttribute&&(P=h.getAttribute("data-scheme-color"),P=null!==P?P:"",B=""!==P||!this.context.Ecc||Wk.XWm(h));B&&(ra=b.Xv(P)||ra);this.settings.hto&&Qa.backgroundColor&&(h.tagName&&Wk.FIo.contains(E.a.ZA(h.tagName))||(ra=
b.Iza(kj.a.zva(Qa.backgroundColor))||ra));if(this.settings.ito&&Qa.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Qa=Wk.Rkm(Qa.backgroundImage))&&0<Qa.rJc.count){P=Qa.rJc.J(0).color;B=!0;for(r=0;r<Qa.rJc.count&&(B=B&&P===Qa.rJc.J(r).color,B);r++);B&&(ca&&t.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),ra=b.Iza(kj.a.zva(P))||ra)}}this.settings.Pqj(this.context)&&h.getAttribute&&(Qa=h.getAttribute("data-ccp-props"))&&(ra=b.K$(Qa)||ra);h.getAttribute&&((Qa=h.getAttribute("data-ccp-charstyle"))&&
this.settings.Bqb&&(ra=b.Lge(Qa)||ra),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Bqb&&(ra=b.Khe(h)||ra));return ra}nvo(b){if(this.settings.ovo)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<E.a.ZA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===E.a.ZA(b.tagName))break;b=b.parentNode}return!1}emj(b,h,r){if(this.TNm){h=Wk.GNl(h);let P=!1,ca=0;if(!h)return r;for(var B of h){if(P=b.AUa(B,this.settings.Dxj))break;ca++}1<h.length&&(P?t.ULS.sendTraceTag(508889217,
307,50,"Secondary font matched from font-family at : {0} out of {1}",ca+1,h.length):t.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return P||r}B=Wk.D$h(h);return b.AUa(B,this.settings.Dxj)||r}ZQn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Kda(b,h){"\u200b"===b&&(b="\u00a0");h&&h.kf&&this.nvo(h.kf)&&(b="");this.aj.Kda(b,Pj.lE(h))}T6d(b){const h=Pj.rR(b.kf,"href");return h&&""!==h?(this.aj.XSa(h,Pj.lE(b)),this.$J(Object(z.a)(this.aj,
this.aj.WSa,"onAnchorEnd")),1):2}Y6d(){return this.mv(b=>b.IL(!0))?1:2}a7d(){return this.mv(b=>b.tyf())?1:2}b7d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}c7d(b){this.aj.Jda(Pj.lE(b))}d7d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}h7d(){return this.mv(b=>b.dqb(!0))?1:2}e7d(b){this.mv(h=>h.JQb("center"));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}i7d(){return this.mv(b=>
b.AUa("consolas"))?1:2}q7d(){return this.mv(b=>b.fka(!0))?1:2}p7d(b){return this.aTc(b,!1)}t7d(){return this.mv(b=>b.dqb(!0))?1:2}u7d(b){return this.aTc(b,!1)}w7d(b){var h=b.kf.getAttribute("data-render-src");const r=b.kf.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const ra=b.kf.getAttribute("data-render-fallback");let Qa=0,mb=0;if(b.kf.currentStyle){var B=b.kf.currentStyle.width,P=b.kf.currentStyle.height;B&&-1!==B.indexOf("px")&&(B=parseInt(E.a.substring(B,0,B.indexOf("px"))),isNaN(B)||
(Qa=B));P&&-1!==P.indexOf("px")&&(P=parseInt(E.a.substring(P,0,P.indexOf("px"))),isNaN(P)||(mb=P))}b=new gj(h,r,ra,Qa,mb,Pj.lE(b));this.aj.s6a(b);return 2}(ba.a.U4||ba.a.Dj)&&(h=b.kf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Wk.KGd(b.kf);const ca=b.kf.getAttribute("align");this.mv(ra=>ra.JQb(ca));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}x7d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}z7d(b){this.aj.jE(Pj.lE(b));
this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}B7d(){return this.mv(b=>b.dqb(!0))?1:2}I7d(b){return this.mv(h=>{var r=Wk.D$h(b.kf.getAttribute("face"));r=h.AUa(r);h=h.Xv(kj.a.zva(b.kf.getAttribute("color")));return r||h})?1:2}L7d(b){this.mv(h=>this.settings.Bqb?h.fqb(1):h.hqb(1));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}M7d(b){this.mv(h=>this.settings.Bqb?h.fqb(2):h.hqb(2));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,
"onParagraphEnd"));return 1}N7d(b){this.mv(h=>this.settings.Bqb?h.fqb(3):h.hqb(3));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}O7d(b){this.mv(h=>this.settings.Bqb?h.fqb(4):h.hqb(4));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}P7d(b){this.mv(h=>this.settings.Bqb?h.fqb(5):h.hqb(5));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}Q7d(b){this.mv(h=>this.settings.Bqb?h.fqb(6):
h.hqb(6));this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}R7d(b){this.aj.Jda(Pj.lE(b))}V7d(b){var h=b.kf;const r=h.src,B=h.alt,P=h.unp,ca=h.getAttribute("data-external-content-url");let ra=0,Qa=0;h.style&&(ra=Pj.Xha(h.style.width),Qa=Pj.Xha(h.style.height));ra&&Qa||(ra=h.width,Qa=h.height);let mb=0,Jb=0;b.kf.currentStyle&&(ra||Qa||(ra=Pj.Xha(b.kf.currentStyle.width),Qa=Pj.Xha(b.kf.currentStyle.height)),mb=Pj.Xha(b.kf.currentStyle.maxWidth),Jb=Pj.Xha(b.kf.currentStyle.maxHeight));
let Yb=null;const fc=h.getAttribute(Of.EKd);if(fc&&(t.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Mc=h.getAttribute(Of.Ydf),Wc=h.getAttribute(Of.Zdf),id=h.getAttribute(Of.Wdf),Id=h.getAttribute(Of.Xdf),ve=h.getAttribute(Of.wLc);h=h.getAttribute(Of.$df);Mc&&Id&&(Yb=new Mn.a(fc,Mc,Wc,id,Id,ve,h))}b=new Bz.a(r,B,ra,Qa,Pj.lE(b),mb,Jb,P,null,ca,Yb);this.aj.zya(b)}S7d(){return this.mv(b=>b.dqb(!0))?
1:2}W7d(){return this.mv(b=>b.R5(!0))?1:2}Y7d(){return this.mv(b=>b.AUa("consolas"))?1:2}$7d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}b8d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}c8d(b){let h;const r=this.oci(b.kf,0);let B=this.IQd(b.kf,"value",0);0<this.$wb.count?h=this.$wb.bZ():(h=new kp.a(2,1,Pj.lE(b)),B||(B=1));var P=Wk.W3l(b.kf,kp.a.ZDj);3!==P&&(h.ks=P);P=h.listLevel;let ca=h.listId;this.settings.Oqj?
(P=this.hci(b.kf),P=0>P&&0>h.listLevel&&0<this.$wb.count?h.listLevel=this.$wb.count-1:h.listLevel=0<=P?P:h.listLevel,this.y_c&&this.y_c.b<P&&(this.y_c.b=P)):0>P&&(P=h.listLevel=this.hci(b.kf));1>ca&&(ca=h.listId=this.IQd(b.kf,kp.a.o_c,0));b.kf.getAttribute(kp.a.a3d)&&(h.levelText=b.kf.getAttribute(kp.a.a3d));var ra=b.kf.getAttribute(kp.a.GLf);ra&&(h.font=ra);ra=!1;v.AFrameworkApplication.K&&(ra=v.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ra){var Qa=b.kf.getAttribute("data-charcodes");
ra=[];if(Qa&&""!==Qa)if(-1<Qa.indexOf(",")){Qa=Qa.split(",");for(var mb=0;mb<Qa.length;mb++)ra.push(parseInt(Qa[mb]))}else ra.push(parseInt(Qa));if(ra&&0<ra.length){Qa=Array(ra.length);for(mb=0;mb<ra.length;mb++)Qa[mb]=ra[mb];h.R7e=Qa}(ra=b.kf.getAttribute("data-buAutoNum"))&&0<ra.length&&(h.buAutoNum=parseInt(ra))}(P=0<=P&&0<ca)&&Wk.KGd(b.kf);h.MFk(r,B,P);h.FLf=this.x3l(b.kf);this.aj.OHa(h.clone());this.$J(Object(z.a)(this.aj,this.aj.Cya,"onListItemEnd"));return 1}x3l(b){var h=b.getAttribute(kp.a.DHi);
if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{t.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new wc.DictionaryPropertySet;for(const r in b)h.Poj(+r,b[r]);return h}onMenuOpen(b){return this.aTc(b,!1)}e8d(b){if(this.mv(h=>h.tlc(!0))){const h=b.kf.getAttribute("OuterHtml");this.aj.bTa(h,Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.q6a,"onMathEnd"))}return 1}q8d(b){return this.aTc(b,
!0)}r8d(b){this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}v8d(b){const h=b.kf.getAttribute("align");this.mv(B=>B.JQb(h));const r=b.kf.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&Wk.KGd(b.kf,ba.a.U4||ba.a.Dj);this.aj.jE(Pj.lE(b));this.$J(Object(z.a)(this.aj,this.aj.zF,"onParagraphEnd"));return 1}C8d(){this.mv(b=>b.AUa("consolas"));this.aj.bob();this.$J(Object(z.a)(this.aj,this.aj.aob,"onPreFormattedTextEnd"));return 1}J8d(){return this.mv(b=>b.fka(!0))?
1:2}K8d(){return this.mv(b=>b.AUa("consolas"))?1:2}S8d(){return this.mv(b=>b.oig())?1:2}T8d(b){var h=b.kf.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=kj.a.OBn(r);if(0<h&&this.settings.oDm){for(r=0;r<h;r++)this.aj.gob(Pj.lE(b));return 3}return 2}V8d(){return this.mv(b=>b.fka(!0))?1:2}W8d(){return this.mv(b=>b.IL(!0))?1:2}X8d(){return this.mv(b=>b.YIa(!0))?1:2}$8d(){return this.mv(b=>b.xra(!0))?1:2}b9d(b){this.mv(Yb=>Yb.KC()&&Yb.B$f());kj.a.aWd(b.kf,this);const h=kj.a.Iki(b.kf),
r=kj.a.G6h(b.kf),B=kj.a.CJ(b.kf),P=kj.a.oL(b.kf),ca=!parseInt(Pj.rR(b.kf,"border")),ra=kj.a.xWm(b.kf);let Qa=-1,mb="";var Jb=-1;b.kf.attributes.hasOwnProperty("style")&&-1!==(Jb=b.kf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Qa=parseInt(b.kf.attributes.getNamedItem("style").value.substr(Jb+17)):b.kf.attributes.hasOwnProperty(pp.a.FKd.toString())&&(Qa=parseInt(b.kf.attributes.getNamedItem(pp.a.FKd.toString()).value));Jb=-1;b.kf.attributes.hasOwnProperty("class")&&-1!==(Jb=
b.kf.attributes.getNamedItem("class").value.indexOf("Mso"))?mb=b.kf.attributes.getNamedItem("class").value.substr(Jb).split(" ")[0]:b.kf.attributes.hasOwnProperty(pp.a.xLc.toString())&&(mb=b.kf.attributes.getNamedItem(pp.a.xLc.toString()).value);this.aj.b$(new bx(0,0,h.value,h.rCi,null,ca,ra,r,new xC(B.value,P.value),mb,Qa,Pj.lE(b)));this.$J(Object(z.a)(this.aj,this.aj.Z9,"onTableEnd"));v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");
return 1}U2c(b){const h=kj.a.rai(b.kf),r=kj.a.Iki(b.kf);if(!r.value&&r.z_d&&(v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.x1i))return 3;let B=parseInt(Pj.rR(b.kf,"colSpan"));if(void 0===B||null===B||""===B+"")B=r.value?1:0;let P=parseInt(Pj.rR(b.kf,"rowSpan"));if(void 0===P||null===P||""===P+"")P=h.value?1:0;let ca=!1;b.kf.attributes.hasOwnProperty("style")&&(ca=-1!==b.kf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||
-1!==b.kf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.kf.attributes.hasOwnProperty("class")&&(ca=-1!==b.kf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ra=69905;if(b.kf.attributes.hasOwnProperty(pp.a.Vdf.toString())){var Qa=parseInt(b.kf.attributes.getNamedItem(pp.a.Vdf.toString()).value);isNaN(Qa)||(ra=Qa)}Qa=kj.a.zva(b.kf.style.backgroundColor);const mb=kj.a.Wkm(b.kf);this.mv(fc=>fc.pea(0,0));kj.a.aWd(b.kf,this);const Jb=kj.a.G6h(b.kf),
Yb=this.settings.zCn?kj.a.hRl(b.kf):null;b=new ow(B,P,r.value,h.value,Qa,mb,Jb,Yb,r.rCi,ca,ra,Pj.lE(b));this.aj.Y9(b);this.$J(Object(z.a)(this.aj,this.aj.X9,"onTableCellEnd"));this.ujn();return 1}e9d(b){const h=this.U2c(b);if(3===h)return h;this.mv(r=>{const B=r.IL(!0);r=r.JQb("center");return B||r});kj.a.aWd(b.kf,this);return 1}j9d(b){kj.a.aWd(b.kf,this);const h=kj.a.rai(b.kf);if(h.z_d&&!h.value&&(v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.settings.x1i))return 3;this.aj.w5(new wj(h.value,Pj.lE(b)));this.$J(Object(z.a)(this.aj,this.aj.a$,"onTableRowEnd"));return 1}k9d(){return this.mv(b=>b.AUa("consolas"))?1:2}l9d(){return this.mv(b=>b.R5(!0))?1:2}m9d(b){return this.aTc(b,!1)}o9d(){return 2}r9d(){return this.mv(b=>b.R5(!0))?1:2}static hXl(b){if(!b)return null;b=b.split(",");1<b.length&&t.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static ENl(b){return b?b.split(","):null}static jCj(b){if(!b)return null;
b=E.a.O8f(b.trim(),'"');return b=E.a.O8f(b,"'")}static D$h(b){if(!b)return null;b=Wk.hXl(b);return b=Wk.jCj(b)}static GNl(b){var h;if(!b)return null;b=null===(h=Wk.ENl(b))||void 0===h?void 0:h.map(r=>Wk.jCj(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static nqh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.Ini())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<r.length){if(b.Ini())return!1;b.direction=h;return!0}var B=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===B?h:kj.a.zva(h.substr(0,B).trim());if(!r||""===r)return!1;h=-1===B?"":h.substr(B).trim();B=new ax;B.color=r;B.stop=h;b.rJc.add(B);return!0}static Rkm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new Or;for(;0<h.trim().length;){let B=h.indexOf(",");
const P=h.indexOf("(");if(0<P&&P<B){const ca=h.indexOf(")");if(ca<P)return null;B=h.indexOf(",",ca)}if(-1===B){if(!Wk.nqh(r,h))return null;h=""}else{const ca=h.substr(0,B);h=h.substr(B+1);if(!Wk.nqh(r,ca))return null}}return r}catch(h){return null}}static sVd(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static KGd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Wk.eFh(b,h))}static eFh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&Wk.eFh(b,h)),b=b.nextSibling}static K3l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static W3l(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static XWm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static dim(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static Zzi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Wk.FIo=(Dk=new vb.a,Dk.add("TABLE"),Dk.add("THEAD"),Dk.add("TBODY"),Dk.add("TFOOT"),Dk.add("TR"),Dk.add("TH"),Dk.add("TD"),Dk);Wk.exj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(n.a)(Wk,"DefaultHtmlTranslator",Pj,[]);var xq=c(1575);class Om{constructor(b=null){this.M3=b||xq.a.Nki("");this.J8g=Number.parseInvariant((new Date).format("HHmmss"))}get Jc(){return this.M3}process(b,h){if(b&&b.querySelectorAll){const ca=b.querySelectorAll("p");if(ca&&0<ca.length){for(var r=0,B=!1,P=ca[0].parentNode;5>r&&P&&P!==b;){r++;const ra=P.id.toLowerCase();if(ra&&ra.length&&-1!==ra.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(P,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(P,"EditingSurfaceBody")){B=!0;break}P=P.parentNode}if(B&&P!==b){r=b.firstChild;for(B=!1;0<P.children.length&&P.children[0]!==r;)b.insertBefore(P.children[0],r),B=!0;if(B)for(;r;)P=r.nextSibling,b.removeChild(r),r=P}b=new yv.a(h,Object(z.a)(this,this.QJn,"processNodesDiscovery"),new AA(ca));b.Rl("Word Converter Operation");b.Qh=!h||h.Qh;b.run()}}}QJn(b,h){const r=h.nodes[h.hPa];var B=Om.F3l(r);if(B){let ca=B.lqe.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?
ca:B.lqe;let ra=h.lists[ca];ra||(ra=new Mx,ra.Moc=this.J8g++);let Qa=ra.ofc[B.level-1];Qa||(Qa=new Ey,Qa.level=B.level);var P=r.parentNode;if(P&&"li"===P.tagName.toLowerCase()){if(P=P.parentNode)!(P=P.tagName.toUpperCase())||"OL"!==P&&"UL"!==P||(Qa.tagName=P)}else Qa.dnb=Om.X9h(r,5),Qa.dnb&&Qa.dnb.length||(Qa.dnb=Om.Avf(r,5)),Qa.ignore=!Qa.dnb||!Qa.dnb.length,Qa.tagName=Om.W9h(Qa.dnb),"UL"===Qa.tagName&&(Qa.font=this.G$h(r,5));B.Moc=ra.Moc;Qa.bkn++;Qa.ignore||"li"===r.parentNode.tagName.toLowerCase()||
(P=(P=Om.Avf(r,5))?P:Qa.dnb)&&P.length&&(B.c_h=P,(P=Om.Flo(r,P,Qa.listStyle,B.level-1))&&P.length&&(Qa.listStyle=P));h.Hmb[h.Hmb.length]=B;Qa.Hmb.contains(B)||Qa.Hmb.add(B);if(void 0===ra.ofc[B.level-1]||null===ra.ofc[B.level-1]||ra.ofc[B.level-1]!==Qa)ra.ofc[B.level-1]=Qa;h.lists[ca]&&h.lists[ca]===ra||(h.lists[ca]=ra);h.mGi=r}else if((B=h.mGi)&&Om.Hbm(r)===B&&r.tagName===B.tagName&&r.className===B.className){B.appendChild(B.ownerDocument.createElement("BR"));for(B.appendChild(B.ownerDocument.createElement("BR"));r.firstChild;)B.appendChild(r.firstChild);
r.parentNode.removeChild(r)}h.hPa++;if(h.nodes.length<=h.hPa){if(!h.Hmb.length)return!1;h.hPa=0;b.ri(Object(z.a)(this,this.PJn,"processNodeConvert"))}return!0}PJn(b,h){b=h.Hmb[h.hPa];var r=b.vyn,B=b.lqe.replace(RegExp("level[0-9]"),"").trim();B=B&&B.length?B:b.lqe;B=h.lists[B];var P=B.ofc[b.level-1],ca=r.parentNode.tagName.toLowerCase();if(!P.ignore&&r.parentNode&&"li"!==ca){if(ca=Om.rcl(r,P)){Om.QEh(r,5);const ra=r.ownerDocument.createElement("LI");ra.setAttribute("data-aria-level",String.format("{0}",
b.level));ra.setAttribute(kp.a.o_c,String.format("{0}",B.Moc));"UL"===P.tagName&&(ra.setAttribute(kp.a.a3d,String.format("{0}",b.c_h)),ra.setAttribute(kp.a.GLf,String.format("{0}",P.font)));for(;r.firstChild;)ra.appendChild(r.firstChild);ca.appendChild(ra);r.parentNode.removeChild(r);"UL"===P.tagName?this.Jc.b++:this.Jc.c++}}else"li"===ca&&(P=P.tagName,r=r.parentNode,b.gic&&(b=r.parentNode)&&b.tagName.toUpperCase()===P&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(kp.a.o_c,String.format("{0}",
B.Moc)),"UL"===P?this.Jc.b++:this.Jc.c++);h.hPa++;return h.hPa<h.Hmb.length}G$h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const P=b.childNodes[B];r=Om.CZl(P);!r&&1===P.nodeType&&1<h&&(r=this.G$h(P,h-1))}return r}static rcl(b,h){b=Om.qcl(b,h.tagName);return Om.O7k(b,h)}static O7k(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static qcl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Wk.sVd(r,"NumberListStyle"):Wk.sVd(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static QEh(b,h){for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];1===B.nodeType&&1<h&&Om.QEh(B,h-1);if(Om.IMm(B)||
Om.jzi(B))b.removeChild(B),r--}}static F3l(b){if(1===b.nodeType){var h=Om.vvf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const B=Number.parseInvariant(r[1].substr(5)),P=new Dy(B,h,b);P.gic=!0;return P}}catch(B){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+qf.a.XDd),r=r.getAttribute(kp.a.o_c),h&&r&&0<h.length&&0<r.length))return b=new Dy(Number.parseInvariant(h),r+" level"+h,b),b.gic=!1,b}return null}static Flo(b,h,r,B){if("p"===
b.tagName.toLowerCase()&&h&&h.length){if("UL"===Om.W9h(h))return r=Om.yQl(h),Sys.UI.DomElement.addCssClass(b,r),r;var P=h.match(RegExp("^[0-9]+"));return P&&P.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,r),b.setAttribute("start",P[0]),r):(P=h.match(RegExp("^[a-zA-Z]+")))&&P.length&&(P=P[0],B=(h=P.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Om.Ncm(r,B):1,1!==B&&((r=Om.JId(b,P,RegExp("^[ivxlcdm]+"),E.a.gKh,"NumberListStyle3"))||(r=Om.JId(b,P,RegExp("^[IVXLCDM]+"),E.a.gKh,"NumberListStyle5")))||
B&&((r=Om.JId(b,P,RegExp("^[a-z]+"),E.a.eKh,"NumberListStyle2"))||(r=Om.JId(b,P,RegExp("^[A-Z]+"),E.a.eKh,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static yQl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static Ncm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;
case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static JId(b,h,r,B,P){return(h=h.match(r))&&h.length?(B=B(h[0]),B=1>B?1:B,Sys.UI.DomElement.addCssClass(b,P),b.setAttribute("start",B+""),P):null}static W9h(b){return Om.BJm(b)?"UL":"OL"}static BJm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Avf(b,h){let r=null;var B;let P,ca;for(let ra=-1;!r&&ra<b.childNodes.length;ra++){const Qa=-1===ra?b:b.childNodes[ra];
if(Qa)if((B=Qa.innerHTML)&&0<B.length){if(P=B.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=P&&(ca=B.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){B=B.substring(P,ca+14);Qa.innerHTML=Qa.innerHTML.replace(B,"");if(B.length){b=b.ownerDocument.createElement("span");b.innerHTML=B;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=ra&&1===Qa.nodeType&&1<h&&(r=Om.Avf(Qa,h-1))}return r}static CZl(b){let h=null;1===b.nodeType&&((h=Om.F$h(b,"font-family"))||(h=Om.F$h(b,"mso-ascii-font-family")));return h}static F$h(b,
h){return(b=Om.vvf(b,h))&&0<b.length?b.trim():null}static X9h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const P=b.childNodes[B];Om.jzi(P)?(r="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),r.length||(r="o"),P.parentNode.removeChild(P)):1===P.nodeType&&1<h&&(r=Om.X9h(P,h-1))}return r}static jzi(b){return 1===b.nodeType&&(b=Om.vvf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static IMm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static vvf(b,
h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const B=b[r].split(":");if(2===B.length&&B[0].trim()===h)return B[1].trim()}}return null}static Hbm(b){do b=b.previousSibling;while(b&&Om.byi(b));return b}static byi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Om.yak,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Om.byi(b.firstChild):!0}}Om.yak=RegExp("[\n|\r]","gi");Object(n.a)(Om,
"WacAndRichClientWordConverter",null,[315]);class xu{constructor(){}create(b=null){return new Om(b)}}Object(n.a)(xu,"Box4WordConverterFactory",null,[530]);var Kz=c(1794);class Jy{constructor(b,h,r,B,P){this.GUg=0;this.R4o=ca=>{let ra=!0;const Qa=this.fga.Jxl;null!=Qa?(ca.Dqa=Qa,ra=!1):Date.now()-this.GUg>this.nwe&&(t.ULS.sendTraceTag(18354843,307,50,null),this.Ad.Yb(te.a.soa,{["Reason"]:fe.a.w_i}),ra=ca.Dqa=!1);return ra};this.Ad=b;this.Se=h;this.nwe=P;this.fga=r;this.GNa=B}zXk(b,h,r){t.ULS.sendTraceTag(9037318,
307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.Se.rG);b.Qh&&this.Se.Er&&window.chrome&&t.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.fga.GNc(!!(h&16));this.GNa.create(b,this.R4o,null).Rl("ClipboardPreProcess");this.GUg=Date.now()}B7n(){this.fga.reset()}}Object(n.a)(Jy,"ClipboardOperationClipboardAccessHelper",null,[529]);var bo=c(344);class cx{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,
Wc,id,Id){this.$Xa=null;this.ga=b;this.Ad=h;this.iA=r;this.rh=B;this.hb=P;this.fga=ca;this.gb=ra;this.Fe=Qa;this.Un=mb;this.Yc=Jb;this.Zcb=Yb;this.xQe=fc;this.ME=Mc;this.lk=id;this.VXb=Wc?Wc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.Ppd=Wc?Wc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.rd=Id;this.rg=ci.a.getInstance(bo.a.r0a)}get Pf(){return this.rh}get Ic(){return this.Ad}get vWc(){if(null==this.$Xa)if(this.rd)if(this.rd.pq.isCompleted)this.$Xa=this.rd.isFeatureEnabled(3);else return!1;
else this.$Xa=!1;return this.$Xa}J4o(b){b.FN();return!0}KKh(b,h){b=h.Vw;t.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let B=!1,P;ba.a.Uxa&&v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.vWc&&h.ke&&h.ke.xh&&(B=this.lk.qph(h.ke.xh.editingElement));P=this.lk.Wyf(h.ke.xh.editingElement,!1);var r=h.ke.xh.editingElement;this.lk.wDf(r,!1,1);this.VXb&&ba.a.Uxa?(r=h.ke.xh.editingElement,this.lk.Q9f(r,"data-src","data-srcurl"),b=this.fga.copy(),
this.lk.Q9f(r,"data-srcurl","data-src")):this.Ppd&&h.ke&&h.ke.xh?(r=this.lk.I7e(h.ke.xh.editingElement,h.ke.vB,!0),b=this.fga.copy(),r&&this.lk.I7e(h.ke.xh.editingElement,h.ke.vB,!1)):(this.lk.Mbj(h.ke.xh.editingElement),b=this.fga.copy());this.vWc&&B&&this.lk.y1n(h.ke.xh.editingElement);P&&this.lk.Wyf(h.ke.xh.editingElement,!0);r=h.ke.xh.editingElement;this.lk.wDf(r,!1,0);if(!b)return t.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:bo.a.RFd,
errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ic.Yb(te.a.UEb,{["Reason"]:fe.a.blg}),h.dS&&h.dS.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}Kaf(b,h){const r=h.ke;t.ULS.shipAssertTag(18130961,307,!!(h.Vw&16));h.oAo?this.iA.mFh():this.iA.cJd(r,b);return!0}IRh(b,h){var r=h.context,B=h.vd;const P=h.x$;var ca=!1;b=this.hb.ib.lb.Rc;if(this.gb.um(b)||this.Fe.Kk(b)){const ra=this.Yc.Rf(b.node),Qa=ra.od();t.ULS.shipAssertTag(18130962,
307,Qa);this.Un.Yd(ra);this.Zcb.zlb(ra)&&(ca=!0)}B=h.Vw&64?new wc.DictionaryPropertySet:B||new wc.DictionaryPropertySet;B.setValue(Zc.a.BMc,!1);r=this.ga.Mf(r,Mb.a.QH,2,!0,P,B);8===r&&(t.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ic.Yb(te.a.soa,{["Reason"]:fe.a.HRh}),h.dS&&h.dS.fail("DeleteKey failed",!1),this.rg.logKpiFailure({kpiName:bo.a.w7e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===r&&this.rg.logKpiSuccess({kpiName:bo.a.w7e});32===r&&ca&&(h=this.hb.ib.lb,this.Fe.Pl(h)&&
h.Pa.node===b.node&&!this.gb.textLength(h.Pa.node)&&(h=this.Yc.Rf(h.Pa.node),b=this.Fe.Bu(h),t.ULS.shipAssertTag(18130964,307,b),this.Un.Yd(h),this.Zcb.o_d(h)||(b=this.xQe.create(),b.kd(h),this.Un.g1(b,!1,!1),ca=this.Un.Ee(b),this.gb.Xb(ca)&&(this.Un.Yd(b),this.Pf.merge(b,h,!1,!1),this.hb.Ac(this.ME.ne(ca,this.gb.textLength(ca)))))));return!0}}Object(n.a)(cx,"ClipboardOperationCutCopy",null,[544]);class Nx{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id){this.ga=b;this.Ad=h;this.iA=r;this.fga=
ca;this.hb=P;this.rh=B;this.gb=ra;this.Fe=Qa;this.Un=mb;this.Yc=Jb;this.Zcb=Yb;this.xQe=fc;this.ME=Mc;this.Ca=Wc;this.lk=id;this.rd=Id}create(){return new cx(this.ga,this.Ad,this.iA,this.rh,this.hb,this.fga,this.gb,this.Fe,this.Un,this.Yc,this.Zcb,this.xQe,this.ME,this.Ca,this.lk,this.rd)}}Object(n.a)(Nx,"Factory",null,[528]);var Ox=c(1711),wn=c(143);class Qp{constructor(b,h){this.dtc=null;this.z8k=(r,B)=>{let P;if(wn.a.oda){if(!B.vd)return!1;P=B.vd.ESc;if(!P)return!1}else{if(!Object(uc.a)(88,B.vd))return!1;
const Qa=Object(Na.a)(88,B.vd);if(!Qa.hasProperty(Zc.a.ESc))return!1;P=Qa.getValue(Zc.a.ESc)}const ca=B.ke,ra=ca.mb;this.iA.rJj();ra.NPb(()=>{ra.Ac(P,void 0,!0);this.iA.cJd(ca,r)},!0);return!0};this.iA=b;this.LZ=h;this.FI=0}process(b,h){this.FI||(this.dtc=[this.z8k,Object(z.a)(this.LZ,this.LZ.sCn,"pasteGlossaryPlaceholder")],wn.a.oda&&this.dtc.push(Object(z.a)(this.LZ,this.LZ.Ueg,"setSelectionAfterPaste")));let r=!0;this.FI<this.dtc.length&&(r=this.dtc[this.FI++](b,h));return r?this.FI<this.dtc.length:
!1}}Object(n.a)(Qp,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[554]);class Su{constructor(b){this.iub=null;this.F2=b;this.FI=-1}process(b,h){-1===this.FI&&(this.hil(b,h),this.FI=0);let r=!1;this.FI<this.iub.length&&(r=this.iub[this.FI++](b,h));return r?this.FI<this.iub.length:!1}hil(b,h){ba.a.W4||h.Vw&512?(this.iub=[Object(z.a)(this.F2,this.F2.Kaf,"copyInternal")],t.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Qh&&
h.Vw&256?(this.iub=[Object(z.a)(this.F2,this.F2.J4o,"waitBeforeCopy"),Object(z.a)(this.F2,this.F2.KKh,"copyExternal"),Object(z.a)(this.F2,this.F2.Kaf,"copyInternal")],t.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.iub=[Object(z.a)(this.F2,this.F2.KKh,"copyExternal"),Object(z.a)(this.F2,this.F2.Kaf,"copyInternal")],t.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
h.Vw&32&&(b=Object(z.a)(this.F2,this.F2.IRh,"deleteForCut"),this.iub.push(b),t.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));bo.a.k5m(h)}}Object(n.a)(Su,"ClipboardOperationCutCopyProcessor",null,[553]);class yq{constructor(b,h,r,B){this.fsd=null;this.C8k=(P,ca)=>{ca=ca.ke;this.iA.y1o();this.iA.cJd(ca,P);return!0};this.c1c=(P,ca)=>{ca=new ri.Selection([ca.vd],!0);this.hb.Ac(ca,P);return!0};this.iA=b;this.hb=h;this.F2=r;this.LZ=B;this.FI=
0}process(b,h){this.FI||(this.fsd=[this.C8k,Object(z.a)(this.F2,this.F2.IRh,"deleteForCut"),this.c1c,Object(z.a)(this.LZ,this.LZ.C1i,"pasteInternal"),Object(z.a)(this.LZ,this.LZ.Ueg,"setSelectionAfterPaste")]);let r=!0;this.FI<this.fsd.length&&(r=this.fsd[this.FI++](b,h));return r?this.FI<this.fsd.length:!1}}Object(n.a)(yq,"ClipboardOperationMoveProcessor",null,[552]);var dq=c(1710);class Uj{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d){this.iA=b;this.ga=h;this.vsc=r;this.Ad=B;this.Fe=
P;this.Se=ca;this.Lc=ra;this.yid=Qa;this.yZj=mb;this.yVb=Jb;this.Bwe=Yb;this.hsc=fc;this.GNa=Mc;this.GD=Wc;this.Vd=id;this.Pm=Id;this.k_=ve;this.hga=$d}create(b,h,r,B,P,ca,ra,Qa,mb=!0){const Jb=this.yid.create(B,Object(Na.a)(88,Qa));var Yb=this.yZj.create();const fc=new Qp(this.iA,Jb),Mc=new yq(this.iA,lh.a.instance,Yb,Jb);Yb=new Su(Yb);B=new dq.a(v.AFrameworkApplication.K,$u.a.instance,B,Ih.a.instance,Jb,this.yVb);return new Ox.a(b,h,r,P,ca,ra,Qa,this.vsc,this.ga,this.Ad,this.Fe,this.Se,this.Lc,
fc,Mc,Yb,B,this.yVb,this.Bwe,this.hsc,this.GNa,this.GD,this.Vd,this.Pm,this.k_,this.hga,v.AFrameworkApplication.jhg(),mb)}}Object(n.a)(Uj,"Factory",null,[527]);var Fy=c(262);class eq{constructor(b,h){this.FHb=b.Brf(h);this.Saf=b.xUl(h);this.wCb=b.opf(h);this.Dfb=b.Pof(h)}static mF(b){return eq.Wr(b)}static Wr(b){return new eq(Ux.a.instance,b)}}Object(n.a)(eq,"CpUsageHelper",null,[]);class Cz{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc){this.A3=!1;this.Ad=b;this.iA=h;this.jBc=r;this.wua=B;this.hb=P;
this.ga=ca;this.kEe=ra;this.iXe=mb;this.qOe=Qa;this.Rze=Jb;this.zwe=Yb;this.Vd=fc;this.rg=ci.a.getInstance(bo.a.r0a);this.A3=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get vg(){return this.iXe.value}get bsa(){return this.wua}get Ic(){return this.Ad}get sTa(){return this.qOe.sTa}paste(b,h){const r=this.Vd.Z_a();try{const B=h.ke,P=h.Vw;this.hb&&this.hb.ib&&this.hb.ib.lb&&Fy.TableBorderSelectionCache.tqo(this.hb.ib.lb.Ov||this.hb.ib.lb.$lb);on.a.noo(this.hb);
t.ULS.shipAssertTag(18131010,307,!!(P&1));Object(uc.a)(88,h.vd)&&h.vd.setValue(Ng.a.kha,B.xh.editingElement.clientWidth);this.zwe.oRo(b,h);let ca;if(!({xId:ca}=this.kEe.value.PCj()).returnValue)return this.N_c(h,"HTML import strategy failed",!1),this.A3?this.rg.logKpiFailure({kpiName:bo.a.COa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:bo.a.Eob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("HtmlImportStrategyFailed",[bo.a.Eob],
!1,!0,!0,!1,null),!1;this.vg.sF();let ra=!0,Qa=null;const mb=this.Rze.create(ca),Jb=h.oJj;if(!B||!B.mb)return this.N_c(h,"Fail to set selection.",!1),this.A3?this.rg.logKpiFailure({kpiName:bo.a.COa,errorName:"SetSelectionFailed",optionalVeto:{name:bo.a.Eob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):xa.Health.instance.recordQosError("SetSelectionFailed",[bo.a.Eob],!1,!0,!0,!1,null),!1;B.mb.NPb(()=>{Jb&&2===this.ga.processAction(Mb.a.Wna,2)?ra=!1:(Qa=Jb?this.hb&&this.hb.ib&&
this.hb.ib.lb?this.hb.ib.lb.Pa:null:h.vd)?(t.ULS.shipAssertTag(18158338,307,Pd.SelectionEditor.Ze(Qa)),this.oLi(Qa,"paste")):t.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Jb)},this.qOe.EBi);if(!ra)return this.N_c(h,"fail to deleteForReplace.",!0),!1;if(!Qa)return this.N_c(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Qa.node||!Qa.node.isConnected)return this.N_c(h,"node is null or not connected in ip context.",!0),!1;B.we.disable(!0,25);mb.restore();
this.jBc.mCn(ca,Qa,b);return!0}finally{r&&r.dispose()}}N_c(b,h,r){b.failed=!0;b.dS&&b.dS.fail(h,r)}sCn(b,h){var r,B;let P;if(wn.a.oda){P=h.vd;var ca=P.IVd}else ca=Object(Na.a)(88,h.vd).getValue(Zc.a.IVd);t.ULS.shipAssertTag(20492440,307,Pd.SelectionEditor.Ze(ca));if(!this.qEh(ca,h))return!1;this.vg.sF();const ra=(new kl.a).Pc(15);ra.Db(this.iA.zka);const Qa=wn.a.oda?this.hb.ib.lb:null;this.jBc.uui(ca,b);wn.a.oda&&(b=null!==(B=null===(r=P.placeholderText)||void 0===r?void 0:r.length)&&void 0!==B?B:
0,r=h.cFa,ca=Qa&&Pd.SelectionEditor.Ze(Qa.Pa)&&r&&Pd.SelectionEditor.Ze(r.Pa)&&Qa.Pa.node===r.Pa.node&&Qa.Pa.cpBegin>ca.cpBegin?Fe.SelectionFactory.ne(Qa.Pa.node,Qa.Pa.cpBegin+b):Qa,h.cFa=ca);this.iA.mFh();ra.dispose();return!0}C1i(b,h){const r=this.hb.ib.lb.Pa;if(!this.qEh(r,h))return!1;this.vg.sF();this.ga.processAction(Mb.a.Wna,2);this.oLi(r,"intPaste");this.jBc.uui(r,b);return!0}qEh(b,h){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return t.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.RYc),h.dS&&(h.dS.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:bo.a.COa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Pd.SelectionEditor.Ze(b))return t.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.RYc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:bo.a.COa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.dS&&(h.dS.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}oLi(b,h){h=eq.mF(h);this.bsa.$Rn(h,b.node,b.cpBegin);this.bsa.m5m(h.Saf);this.bsa.FNf(h.FHb);this.bsa.rNf(h.wCb);this.bsa.oNf(h.Dfb)}Ueg(b,h){if(!h.oJj)return!1;
h.Vw&64&&this.iA.qJj();if(!h.cFa)return t.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ic.Yb(te.a.f2,{["Reason"]:fe.a.Zkb}),h.dS&&h.dS.fail("No selection after paste",!1),h.failed=!0,!1;this.qOe.Q0o(h);this.vg.sF();return!1}}Object(n.a)(Cz,"ClipboardOperationPaste",null,[542]);class Pq{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.Ad=b;this.iA=h;this.jBc=r;this.wua=B;this.hb=P;this.ga=ca;this.iXe=Qa;this.ufk=ra;this.Rze=mb;this.zwe=Jb;this.Vd=Yb}create(b,h){h=this.ufk.create(this.hb,
h);return new Cz(this.Ad,this.iA,this.jBc,this.wua,this.hb,this.ga,b,h,this.iXe,this.Rze,this.zwe,this.Vd)}}Object(n.a)(Pq,"Factory",null,[526]);var zv=c(1643);class rt{constructor(b,h){this.FFo=b;this.lBn=h}}Object(n.a)(rt,"ParagraphFormatStore",null,[]);class Ws{constructor(b,h,r){this.hb=b;this.gb=h;this.De=r}oRo(b,h){if(h.Cdc){h=b.Dqa;var r=this.hb.ib.lb.Pa.node,B=null;this.gb.Xb(r)&&(B=this.De.hp(r),r=this.gb.c3a(r),B=new rt(B,r));h=new zv.a(h.context,h.Vw,h.dS,h.x$,h.vd,B);b.Dqa=h}}}Object(n.a)(Ws,
"ClipboardOperationPasteOvertypeStrategy",null,[525]);class Tu{constructor(b){this.cKe=null;this.hb=b;b.NPb(h=>{this.cKe=h},!1)}get EBi(){return!1}Q0o(b){b=this.o1e(b);this.Ac(this.hb,b)}o1e(b){let h=b.cFa;(b.WVa||b.Yja)&&b.xke&&(h=Fe.SelectionFactory.Iy(b.xke,h.Pa));return h}Ac(b,h){b.Ac(h)}}Object(n.a)(Tu,"AClipboardOperationPasteStrategy",null,[558]);class Dz extends Tu{constructor(b){super(b)}get sTa(){return this.cKe}}Object(n.a)(Dz,"ClipboardOperationPasteToLiveSelectionStrategy",Tu,[]);class Px extends Tu{constructor(b,
h){super(b);this.mYe=null;this.Ibk=h;b.NPb(r=>{this.mYe=r},!0)}get EBi(){return!0}get sTa(){return this.mYe}o1e(b){let h=super.o1e(b);b.vd.setValue(Zc.a.H1i,h);return h=this.Ibk.Sci(this.cKe.lb,this.mYe.lb,h)}}Object(n.a)(Px,"ClipboardOperationPasteToVirtualSelectionStrategy",Tu,[]);class Xs{constructor(b){this.lYe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ja(Zc.a.WVa,!1)&&this.lYe?new Px(b,this.j4o):new Dz(b)}get j4o(){return null!=this.VJg?this.VJg:this.VJg=Ya.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}
Object(n.a)(Xs,"ClipboardOperationPasteStrategyFactory",null,[524]);class Nq{constructor(b,h,r,B){this.Ic=b;this.mb=h;this.Sm=r;this.Xf=B}gHn(b){(b&1||b&32)&&this.Sm.Uo&&this.mb.j2b()}YJm(b,h){return b&1&&this.Xf.a0(h,!0)?(this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),!1):!0}}Object(n.a)(Nq,"ClipboardOperationWordStrategy",null,[]);class pw{constructor(){}X7k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var B=h=0,P=0,ca=0;for(const Qa of r){r=Qa.style;var ra=Qa.selectorText;
r=r?r.cssText:null;ra=ra?ra.split(","):null;if(r&&ra&&Qa.type===Qa.STYLE_RULE){ca+=ra.length;for(const mb of ra){0<=mb.indexOf("#")&&h++;0<=mb.indexOf(".")&&B++;0>mb.indexOf("#")&&0>mb.indexOf(".")&&P++;ra=null;try{ra=b.querySelectorAll(mb)}catch(Jb){t.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",mb,Jb.message)}if(ra)for(let Jb=0;Jb<ra.length;Jb++)ra[Jb].setAttribute("style",r+(ra[Jb].getAttribute("style")||""))}}}t.ULS.sendTraceTag(51245663,
307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,h,B,P)}else this.NLi();else this.NLi()}NLi(){t.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",ba.a.rG)}}Object(n.a)(pw,"ExternalPasteCssConverter",null,[523]);class AB{constructor(b){this.hPa=0;this.LFh=null;this.node=b}}Object(n.a)(AB,"ChartConverterArguments",null,[]);class yu{constructor(b=null){this._imgNodesConverted=
0;this.M3=b||xq.a.U6h("")}get Jc(){return this.M3}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new yv.a(h,this.WAl.bind(this),new AB(b[0])),b.Rl("Chart Converter Operation"),b.Qh=!h||h.Qh,b.run())))}WAl(b,h){var r=h.node;if(1<h.hPa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const B=r.getAttribute(Of.EKd);if(B){const P=r.getAttribute(Of.Ydf),ca=r.getAttribute(Of.Zdf),ra=r.getAttribute(Of.Wdf),Qa=r.getAttribute(Of.Xdf),mb=r.getAttribute(Of.wLc);
r=r.getAttribute(Of.$df);P&&Qa&&ca&&"chart"===ca&&mb&&"XLO"===mb&&(h.LFh=new Mn.a(B,P,ca,ra,Qa,mb,r))}}b.ri(this.gfn.bind(this));return!0}gfn(b,h){var r=h.node;if(b=h.LFh)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Of.EKd,b.ccpId),r.setAttribute(Of.Ydf,b.pKey),r.setAttribute(Of.Zdf,b.type),r.setAttribute(Of.Xdf,b.dc),r.setAttribute(Of.wLc,b.client),b.version&&r.setAttribute(Of.$df,b.version),b.count&&r.setAttribute(Of.Wdf,b.count),
this._imgNodesConverted++):t.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.M3._imgNodesConverted=this._imgNodesConverted;h.hPa++;return!1}}Object(n.a)(yu,"ChartConverter",null,[]);class Yj{constructor(b,h=null,r=null){this.mf=b;this.M3=h||xq.a.phi("");this.mmk=r||xq.a.qhi("")}get Jc(){return this.M3}get Clg(){return this.mmk}b$(b){this.Clg.b++;this.mf.b$(b)}Z9(){this.mf.Z9()}w5(b){this.Clg.c++;this.mf.w5(b)}a$(){this.mf.a$()}Y9(b){this.Clg.d++;this.mf.Y9(b)}X9(){this.mf.X9()}reset(){this.mf.reset()}get GLc(){return this.mf.GLc}Kda(b,
h){this.Jc.b++;this.mf.Kda(b,h)}Jda(b){this.Jc.c++;this.mf.Jda(b)}gob(b){this.Jc.b++;this.mf.gob(b)}zya(b){this.Jc.d++;this.mf.zya(b)}KHa(b){this.Jc.f++;this.mf.KHa(b)}XSa(b,h){this.Jc.g++;this.mf.XSa(b,h)}WSa(){this.mf.WSa()}jE(b){this.Jc.h++;this.mf.jE(b)}zF(){this.mf.zF()}bob(){this.mf.bob()}aob(){this.mf.aob()}bTa(b,h){this.Jc.i++;this.mf.bTa(b,h)}q6a(){this.mf.q6a()}Dya(b){this.Jc.j++;this.mf.Dya(b)}Bya(){this.mf.Bya()}OHa(b){this.Jc.k++;this.mf.OHa(b)}Cya(){this.mf.Cya()}s6a(b){this.Jc.l++;
this.mf.s6a(b)}}Object(n.a)(Yj,"SemanticEventUsageCollector",null,[313,314]);class $g{constructor(b=null){this.Wd=b}c1k(b,h){var r,B;if(null!==(r=this.Wd)&&void 0!==r&&r.$h&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const P of h)h=P.replace(/[0-9]+/,""),this.Wd.Rke.has(b)||this.Wd.Rke.set(b,new Map),r=this.Wd.Rke.get(b),null===r||void 0===r?void 0:r.set(h,(null!==(B=r.get(h))&&void 0!==B?B:0)+1)}PKi(b){var h,r,B;v.AFrameworkApplication.se("ec3e8394;h715g427");null!==(h=this.Wd)&&void 0!==h&&h.Zxi&&(h=
b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.Wd.bUf+=null!==(r=null===b||void 0===b?void 0:b.length)&&void 0!==r?r:0,this.Wd.cUf+=null!==(B=null===h||void 0===h?void 0:h.length)&&void 0!==B?B:0)}Ld(b){const h=b.kf;if(h&&this.Wd){var r=h.tagName.toLowerCase();this.PKi(h.style);"font"===r&&this.x0f(b);if(b=h.style)for(0===b.length&&this.Wd.bRa(h.tagName,"no style present"),r=0;r<b.length;r++){const B=b[r];B&&0<B.length&&(this.Wd.bRa(h.tagName,B),this.c1k(B,b.getPropertyValue(B)))}}}x0f(b){if((b=
b.kf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-size")}}}Object(n.a)($g,"HtmlEventUsageCollectorHelper",null,[]);class co{constructor(b,h=null,r=null,B=null,P=null){this.ei=P;this.c_j="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.mf=b;this.M3=h||xq.a.Aai(ba.a.QBb,"");this.Bv=r;this.fkk=B?B.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.gkk=B?B.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.fQg=new bd.a(Pa.a.ih());for(const ca of this.c_j)this.fQg.add(ca)}get Jc(){return this.M3}get Wd(){return this.Bv}Dh(b){return b?b+1:1}reset(){this.mf.reset()}Z6d(){this.mf.Z6d()}yyf(b){if(b&&this.Wd&&(b.getAttribute&&(b.getAttribute(Of.xil)&&(this.Wd.s3h=!0),b.getAttribute(Of.EKd)&&(this.Wd.YJl=!0),b.getAttribute(Of.wLc)&&
(this.Wd.S8e=b.getAttribute(Of.wLc)),b.getAttribute(Of.Ail)&&(this.Wd.t3h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Of.Wmm)&&(this.Wd.u3h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Of.gxn)&&(this.Wd.y3h=!0);h.startsWith(Of.nGn)&&(this.Wd.z3h=!0);h.startsWith(Of.v6o)&&(this.Wd.A3h=!0);if(h.startsWith(ba.a.I5e)&&h.length===ba.a.I5e.length+1){const r=parseInt(E.a.substring(h,h.length-1,h.length));isNaN(r)||(this.Wd.pKc=r)}if(h===Of.Agn||h===Of.Bgn)this.Wd.hPc=
!0}return this.mf.yyf(b)}onClose(){this.mf.onClose()}KRm(b){for(const h of b)if("\n"!==h)return!0;return!1}Kda(b,h){this.Wd&&(this.Wd.$Jl=!0);this.Wd&&!this.Wd.lnf&&b&&(this.Wd.lnf=this.KRm(b));this.Jc.d=this.Dh(this.Jc.d);this.mf.Kda(b,h)}T6d(b){var h,r;this.Wd&&(this.Wd.w3h=!0);this.Jc.e=this.Dh(this.Jc.e);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.T6d(b)}mVf(b){var h,r;this.Jc.f=this.Dh(this.Jc.f);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.mVf(b)}nVf(b){var h,r;this.Jc.g=this.Dh(this.Jc.g);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.nVf(b)}sVf(b){var h,r;this.Jc.h=this.Dh(this.Jc.h);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.sVf(b)}HVf(b){var h,r;this.Jc.i=this.Dh(this.Jc.i);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.HVf(b)}JVf(b){var h,r;this.Jc.j=this.Dh(this.Jc.j);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.JVf(b)}Y6d(b){var h,r;this.Jc.k=this.Dh(this.Jc.k);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Y6d(b)}KVf(b){var h,r;this.Jc.l=this.Dh(this.Jc.l);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);this.mf.KVf(b)}LVf(b){var h,r;this.Jc.m=this.Dh(this.Jc.m);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.LVf(b)}MVf(b){var h,r;this.Jc.n=this.Dh(this.Jc.n);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.MVf(b)}a7d(b){var h,r;this.Jc.o=this.Dh(this.Jc.o);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);
return this.mf.a7d(b)}b7d(b){var h,r;this.Jc.p=this.Dh(this.Jc.p);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.b7d(b)}$Vf(b){var h,r;this.Jc.q=this.Dh(this.Jc.q);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.$Vf(b)}c7d(b){var h,r;this.Jc.r=this.Dh(this.Jc.r);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.c7d(b)}bWf(b){var h,
r;this.Jc.s=this.Dh(this.Jc.s);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.bWf(b)}d7d(b){var h,r;this.Jc.t=this.Dh(this.Jc.t);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.d7d(b)}e7d(b){var h,r;this.Jc.u=this.Dh(this.Jc.u);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.e7d(b)}h7d(b){var h,r;this.Jc.v=
this.Dh(this.Jc.v);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.h7d(b)}i7d(b){var h,r;this.Jc.w=this.Dh(this.Jc.w);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.i7d(b)}oWf(b){var h,r;this.Jc.x=this.Dh(this.Jc.x);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.oWf(b)}pWf(b){var h,r;this.Jc.y=this.Dh(this.Jc.y);
(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.pWf(b)}p7d(b){var h,r;this.Jc.z=this.Dh(this.Jc.z);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.p7d(b)}q7d(b){var h,r;this.Jc.ba=this.Dh(this.Jc.ba);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.q7d(b)}t7d(b){var h,r;this.Jc.bb=this.Dh(this.Jc.bb);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.t7d(b)}u7d(b){var h,r;this.Jc.bc=this.Dh(this.Jc.bc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.u7d(b)}w7d(b){var h,r;this.Jc.bd=this.Dh(this.Jc.bd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.w7d(b)}x7d(b){var h,r;this.Jc.be=this.Dh(this.Jc.be);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.x7d(b)}z7d(b){var h,r;this.Jc.bf=this.Dh(this.Jc.bf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.z7d(b)}B7d(b){var h,r;this.Jc.bg=this.Dh(this.Jc.bg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.B7d(b)}QWf(b){var h,r;this.Jc.bh=this.Dh(this.Jc.bh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.QWf(b)}I7d(b){var h,r;this.Jc.bi=this.Dh(this.Jc.bi);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.I7d(b)}XWf(b){var h,r;this.Jc.bj=this.Dh(this.Jc.bj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.XWf(b)}ZWf(b){var h,r;this.Jc.bk=this.Dh(this.Jc.bk);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.ZWf(b)}$Wf(b){var h,r;this.Jc.bl=this.Dh(this.Jc.bl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.$Wf(b)}L7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.L7d(b)}M7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.M7d(b)}N7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.N7d(b)}O7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.O7d(b)}P7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.mf.P7d(b)}Q7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Q7d(b)}gXf(b){this.Jc.bn=this.Dh(this.Jc.bn);return this.mf.gXf(b)}R7d(b){var h,r;this.Jc.bo=this.Dh(this.Jc.bo);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.R7d(b)}nXf(b){this.Jc.bp=this.Dh(this.Jc.bp);return this.mf.nXf(b)}S7d(b){var h,
r;this.Jc.bq=this.Dh(this.Jc.bq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.S7d(b)}pXf(b){var h,r;this.Jc.br=this.Dh(this.Jc.br);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.pXf(b)}V7d(b){var h,r;this.Wd&&(this.Wd.v3h=!0);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.Jc.bs=this.Dh(this.Jc.bs);this.mf.V7d(b)}vXf(b){var h,
r;this.Jc.bt=this.Dh(this.Jc.bt);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.vXf(b)}W7d(b){var h,r;this.Jc.bu=this.Dh(this.Jc.bu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.W7d(b)}BXf(b){var h,r;this.Jc.bv=this.Dh(this.Jc.bv);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.BXf(b)}Y7d(b){var h,r;this.Jc.bw=
this.Dh(this.Jc.bw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Y7d(b)}$7d(b){var h,r;this.Jc.bx=this.Dh(this.Jc.bx);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.$7d(b)}b8d(b){var h,r;this.Jc.by=this.Dh(this.Jc.by);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.b8d(b)}c8d(b){var h,r;this.Wd&&(this.Wd.hPc=
!0);this.Jc.bz=this.Dh(this.Jc.bz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.c8d(b)}MXf(b){var h,r;this.Jc.ca=this.Dh(this.Jc.ca);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.MXf(b)}QXf(b){var h,r;this.Jc.cb=this.Dh(this.Jc.cb);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.QXf(b)}e8d(b){var h,r;this.Wd&&
(this.Wd.ZJl=!0);this.Jc.cc=this.Dh(this.Jc.cc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.e8d(b)}onMenuOpen(b){var h,r;this.Jc.cd=this.Dh(this.Jc.cd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.onMenuOpen(b)}UXf(b){this.Jc.ce=this.Dh(this.Jc.ce);this.mf.UXf(b)}cYf(b){var h,r;this.Jc.cf=this.Dh(this.Jc.cf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.cYf(b)}dYf(b){var h,r;this.Jc.cg=this.Dh(this.Jc.cg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.dYf(b)}fYf(b){var h,r;this.Jc.ch=this.Dh(this.Jc.ch);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.fYf(b)}q8d(b){var h,r;this.Wd&&(this.Wd.hPc=!0);this.Jc.ci=this.Dh(this.Jc.ci);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.q8d(b)}hYf(b){var h,r;this.Jc.cj=this.Dh(this.Jc.cj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.hYf(b)}r8d(b){var h,r;this.Jc.ck=this.Dh(this.Jc.ck);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.r8d(b)}v8d(b){var h,r;this.Jc.cl=this.Dh(this.Jc.cl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.v8d(b)}oYf(b){var h,r;this.Jc.cm=this.Dh(this.Jc.cm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.oYf(b)}C8d(b){var h,r;this.Jc.cn=this.Dh(this.Jc.cn);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.C8d(b)}zYf(b){var h,r;this.Jc.co=this.Dh(this.Jc.co);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.zYf(b)}J8d(b){var h,r;this.Jc.cp=this.Dh(this.Jc.cp);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.J8d(b)}K8d(b){var h,r;this.Jc.cq=this.Dh(this.Jc.cq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.K8d(b)}RYf(b){this.Jc.cr=this.Dh(this.Jc.cr);return this.mf.RYf(b)}YYf(b){var h,r;this.Jc.cs=this.Dh(this.Jc.cs);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.YYf(b)}S8d(b){var h,r;this.Jc.ct=this.Dh(this.Jc.ct);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.S8d(b)}T8d(b){var h,r;this.Jc.cu=this.Dh(this.Jc.cu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.T8d(b)}V8d(b){var h,r;this.Jc.cv=this.Dh(this.Jc.cv);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.V8d(b)}W8d(b){var h,r;this.Jc.cw=this.Dh(this.Jc.cw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.W8d(b)}bZf(b){this.Jc.cx=this.Dh(this.Jc.cx);return this.mf.bZf(b)}X8d(b){var h,r;this.Jc.cy=this.Dh(this.Jc.cy);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.X8d(b)}$8d(b){var h,
r;this.Jc.cz=this.Dh(this.Jc.cz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.$8d(b)}b9d(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.da=this.Dh(this.Jc.da);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.b9d(b)}eZf(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.db=this.Dh(this.Jc.db);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):
this.Ld(b);return this.mf.eZf(b)}U2c(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.dc=this.Dh(this.Jc.dc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.U2c(b)}hZf(b){var h,r;this.Jc.dd=this.Dh(this.Jc.dd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.hZf(b)}iZf(b){var h,r;this.Jc.de=this.Dh(this.Jc.de);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.mf.iZf(b)}e9d(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.df=this.Dh(this.Jc.df);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.e9d(b)}jZf(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.dg=this.Dh(this.Jc.dg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.jZf(b)}mZf(b){var h,r;this.Jc.dh=this.Dh(this.Jc.dh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.mZf(b)}j9d(b){var h,r;this.Wd&&(this.Wd.Aoa=!0);this.Jc.di=this.Dh(this.Jc.di);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.j9d(b)}k9d(b){var h,r;this.Jc.dj=this.Dh(this.Jc.dj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.k9d(b)}l9d(b){var h,r;this.Jc.dk=this.Dh(this.Jc.dk);(null===(h=
this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.l9d(b)}m9d(b){var h,r;this.Wd&&(this.Wd.hPc=!0);this.Jc.dl=this.Dh(this.Jc.dl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.m9d(b)}r9d(b){var h,r;this.Jc.dm=this.Dh(this.Jc.dm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.r9d(b)}o9d(b){var h,r;this.Jc.dn=this.Dh(this.Jc.dn);
this.hxi&&((null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b));return this.mf.o9d(b)}get hxi(){if(null!=this.HDg)var b=this.HDg;else{var h;b=this.HDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForUnknownElementsEnabled",!1)}return b}Ld(b){var h;const r=b.kf;if(r&&this.Wd){var B=r.tagName.toLowerCase();null===(h=this.ei)||void 0===h?void 0:h.PKi(r.style);if(this.fkk&&this.Cwi(B)||
this.gkk&&!this.Cwi(B)||this.Wd.gxi)if("font"===B&&this.x0f(b),r.style&&(b=r.style)){0===b.length&&this.Wd.bRa(r.tagName,"no style present");for(const P of b)P&&0<P.length&&this.Wd.bRa(r.tagName,P)}}}x0f(b){if((b=b.kf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.bRa(b.tagName,"font-attr-size")}}Cwi(b){return this.fQg.contains(b)}}
Object(n.a)(co,"HtmlEventUsageCollector",null,[482]);class qo{constructor(b,h,r=!1){this.kf=b;this.LB=h;this.LEk=r}}Object(n.a)(qo,"TagEventParam",null,[]);class lp{constructor(b,h=null){this.Ikd=this._prunedElements=this.XWe=this._voidElements=null;this.ud=b;this.M3=h||xq.a.Bai("");this.Mpo()}get Jc(){return this.M3}Ijn(b,h,r){this.XWe[h]?this.QSi():(this.Jc.e++,(h=this.Ikd[h])&&h(new qo(b,r,!1)),this.Jc.b++)}QSi(){this.Jc.d++}Cjn(){this.Jc.c++}pjn(b,h,r){if(this.XWe[h])this.QSi();else{if(h=this.Ikd[h])return this.Jc.b++,
h(new qo(b,r,!1));this.Jc.f++;if(this.ud.hxi)return this.ud.o9d(new qo(b,null))}return 2}Mpo(){this._voidElements=zb.a.i6("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.XWe=zb.a.i6("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=zb.a.i6("APPLET",!0,"AREA",!0,
"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,r=this.ud,B=this.ud,P=this.ud,ca=this.ud,ra=this.ud,Qa=this.ud,mb=this.ud,Jb=this.ud,Yb=this.ud,fc=this.ud,Mc=this.ud,Wc=this.ud,id=this.ud,Id=this.ud,ve=this.ud,$d=this.ud,be=this.ud,he=this.ud;this.Ikd=zb.a.i6("A",Object(z.a)(this.ud,this.ud.T6d,"onAOpen"),"ABBR",Object(z.a)(this.ud,this.ud.mVf,"onAbbrOpen"),
"ACRONYM",Object(z.a)(this.ud,this.ud.nVf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.ud,this.ud.sVf,"onAddressOpen"),"APPLET",Object(z.a)(this.ud,this.ud.HVf,"onAppletOpen"),"AREA",Object(z.a)(this.ud,this.ud.JVf,"onAreaTag"),"B",Object(z.a)(this.ud,this.ud.Y6d,"onBOpen"),"BASE",Object(z.a)(this.ud,this.ud.KVf,"onBaseTag"),"BASEFONT",Object(z.a)(this.ud,this.ud.LVf,"onBasefontTag"),"BDO",Object(z.a)(this.ud,this.ud.MVf,"onBdoOpen"),"BIG",Object(z.a)(this.ud,this.ud.a7d,"onBigOpen"),"BLOCKQUOTE",
Object(z.a)(this.ud,this.ud.b7d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.ud,this.ud.$Vf,"onBodyOpen"),"BR",Object(z.a)(this.ud,this.ud.c7d,"onBrTag"),"BUTTON",Object(z.a)(this.ud,this.ud.bWf,"onButtonOpen"),"CAPTION",Object(z.a)(this.ud,this.ud.d7d,"onCaptionOpen"),"CENTER",Object(z.a)(this.ud,this.ud.e7d,"onCenterOpen"),"CITE",Object(z.a)(this.ud,this.ud.h7d,"onCiteOpen"),"CODE",Object(z.a)(this.ud,this.ud.i7d,"onCodeOpen"),"COL",Object(z.a)(this.ud,this.ud.oWf,"onColTag"),"COLGROUP",Object(z.a)(this.ud,
this.ud.pWf,"onColgroupOpen"),"DD",Object(z.a)(this.ud,this.ud.p7d,"onDdOpen"),"DEL",Object(z.a)(this.ud,this.ud.q7d,"onDelOpen"),"DFN",Object(z.a)(this.ud,this.ud.t7d,"onDfnOpen"),"DIR",Object(z.a)(this.ud,this.ud.u7d,"onDirOpen"),"DIV",Object(z.a)(this.ud,this.ud.w7d,"onDivOpen"),"DL",Object(z.a)(this.ud,this.ud.x7d,"onDlOpen"),"DT",Object(z.a)(this.ud,this.ud.z7d,"onDtOpen"),"EM",Object(z.a)(this.ud,this.ud.B7d,"onEmOpen"),"FIELDSET",Object(z.a)(this.ud,this.ud.QWf,"onFieldsetOpen"),"FONT",Object(z.a)(this.ud,
this.ud.I7d,"onFontOpen"),"FORM",Object(z.a)(this.ud,this.ud.XWf,"onFormOpen"),"FRAME",Object(z.a)(this.ud,this.ud.ZWf,"onFrameTag"),"FRAMESET",Object(z.a)(this.ud,this.ud.$Wf,"onFramesetOpen"),"H1",Object(z.a)(this.ud,this.ud.L7d,"onH1Open"),"H2",Object(z.a)(this.ud,this.ud.M7d,"onH2Open"),"H3",Object(z.a)(this.ud,this.ud.N7d,"onH3Open"),"H4",Object(z.a)(this.ud,this.ud.O7d,"onH4Open"),"H5",Object(z.a)(this.ud,this.ud.P7d,"onH5Open"),"H6",Object(z.a)(this.ud,this.ud.Q7d,"onH6Open"),"HEAD",Object(z.a)(this.ud,
this.ud.gXf,"onHeadOpen"),"HR",Object(z.a)(this.ud,this.ud.R7d,"onHrTag"),"HTML",Object(z.a)(this.ud,this.ud.nXf,"onHtmlOpen"),"I",Object(z.a)(this.ud,this.ud.S7d,"onIOpen"),"IFRAME",Object(z.a)(this.ud,this.ud.pXf,"onIframeOpen"),"IMG",Object(z.a)(this.ud,this.ud.V7d,"onImgTag"),"INPUT",Object(z.a)(this.ud,this.ud.vXf,"onInputTag"),"INS",Object(z.a)(this.ud,this.ud.W7d,"onInsOpen"),"ISINDEX",Object(z.a)(this.ud,this.ud.BXf,"onIsindexOpen"),"KBD",Object(z.a)(this.ud,this.ud.Y7d,"onKbdOpen"),"LABEL",
Object(z.a)(this.ud,this.ud.$7d,"onLabelOpen"),"LEGEND",Object(z.a)(this.ud,this.ud.b8d,"onLegendOpen"),"LI",Object(z.a)(this.ud,this.ud.c8d,"onLiOpen"),"LINK",Object(z.a)(this.ud,this.ud.MXf,"onLinkTag"),"MAP",Object(z.a)(this.ud,this.ud.QXf,"onMapOpen"),"MATH",Object(z.a)(this.ud,this.ud.e8d,"onMathOpen"),"MENU",Object(z.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.ud,this.ud.UXf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.ud,this.ud.cYf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.ud,
this.ud.dYf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.ud,this.ud.fYf,"onObjectOpen"),"OL",Object(z.a)(this.ud,this.ud.q8d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.ud,this.ud.hYf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.ud,this.ud.r8d,"onOptionOpen"),"P",Object(z.a)(this.ud,this.ud.v8d,"onPOpen"),"PARAM",Object(z.a)(this.ud,this.ud.oYf,"onParamTag"),"PRE",Object(z.a)(this.ud,this.ud.C8d,"onPreOpen"),"Q",Object(z.a)(this.ud,this.ud.zYf,"onQOpen"),"S",Object(z.a)(this.ud,this.ud.J8d,"onSOpen"),"SAMP",
Object(z.a)(this.ud,this.ud.K8d,"onSampOpen"),"SCRIPT",Object(z.a)(this.ud,this.ud.RYf,"onScriptOpen"),"SELECT",Object(z.a)(this.ud,this.ud.YYf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.S8d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.T8d,"onSpanOpen"),"STRIKE",Object(z.a)(r,r.V8d,"onStrikeOpen"),"STRONG",Object(z.a)(B,B.W8d,"onStrongOpen"),"STYLE",Object(z.a)(P,P.bZf,"onStyleOpen"),"SUB",Object(z.a)(ca,ca.X8d,"onSubOpen"),"SUP",Object(z.a)(ra,ra.$8d,"onSupOpen"),"TABLE",Object(z.a)(Qa,Qa.b9d,"onTableOpen"),
"TBODY",Object(z.a)(mb,mb.eZf,"onTbodyOpen"),"TD",Object(z.a)(Jb,Jb.U2c,"onTdOpen"),"TEXTAREA",Object(z.a)(Yb,Yb.hZf,"onTextareaOpen"),"TFOOT",Object(z.a)(fc,fc.iZf,"onTfootOpen"),"TH",Object(z.a)(Mc,Mc.e9d,"onThOpen"),"THEAD",Object(z.a)(Wc,Wc.jZf,"onTheadOpen"),"TITLE",Object(z.a)(id,id.mZf,"onTitleOpen"),"TR",Object(z.a)(Id,Id.j9d,"onTrOpen"),"TT",Object(z.a)(ve,ve.k9d,"onTtOpen"),"U",Object(z.a)($d,$d.l9d,"onUOpen"),"UL",Object(z.a)(be,be.m9d,"onUlOpen"),"VAR",Object(z.a)(he,he.r9d,"onVarOpen"))}}
Object(n.a)(lp,"AHtmlProcessor",null,[]);class Gv{constructor(b,h){this.childNodes=b.childNodes;this.LB=h;this.hdf=0;this.$Zd=!1}}Object(n.a)(Gv,"HtmlProcessorArguments",null,[]);class Gq extends lp{constructor(b,h=null){super(b,h);this.eHe=null}get PSm(){null==this.eHe&&(this.eHe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.eHe}process(b,h=null){b&&(this.ud.reset(),this.R4i(new Gv(b,new cr.a),h))}R4i(b,h){b.childNodes.length&&
(b=new yv.a(h,Object(z.a)(this,this.kJn,"processChild"),b),b.Rl("HTML Processing Operation"),h||(b.Qh=!0),b.run())}kJn(b,h){const r=h.childNodes[h.hdf];if(3===r.nodeType)return this.ud.Z6d(),this.ud.Kda(r.nodeValue,new qo(r,h.LB.q8h())),Gq.Hoc(h);if(1!==r.nodeType)return Gq.Hoc(h);if(!h.$Zd){const P=E.a.ZA(r.tagName);if(!Gq.ism(r))if(this._prunedElements[P])this.Cjn();else{Gq.uan(r);this.ud.Z6d();var B=r.id;const ca=r.tagName,ra=h.LB.q8h(),Qa=r.getAttribute?r.getAttribute("class"):null;B=new Go(B,
ca,Qa?Qa:"",r.attributes?r.attributes.length:0);B.isValid&&ra.add(B);if(this._voidElements[P])return this.Ijn(r,P,ra),Gq.Hoc(h);B=!1;switch(this.pjn(r,P,ra)){case 1:B=!0;break;case 3:return Gq.Hoc(h)}switch(this.ud.yyf(r)){case 1:B=!0}h.$Zd=B;this.R4i(new Gv(r,ra),b);if(!b.Qh)return!0}}if(h.$Zd){if(this.PSm&&!this.Ikd[E.a.ZA(r.tagName)])return Gq.Hoc(h);this.ud.onClose()}return Gq.Hoc(h)}static uan(b){3!==b.nodeType&&Bc.a.Sl(b,"alreadyPasted",!0)}static ism(b){return 3!==b.nodeType&&Bc.a.Eb(b,"alreadyPasted")}static Hoc(b){b.hdf++;
b.$Zd=!1;return b.hdf<b.childNodes.length}}Object(n.a)(Gq,"HtmlProcessor",lp,[]);var cv=c(547);const qw={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,
["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,
["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,
["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,
["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,
["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,
["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,
["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,
["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,
["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,
["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,
["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,
["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,
["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,
["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,
["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,
["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,
["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,
["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},Hv={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,
["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,
["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,
["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class tj{constructor(){this.Vw=0;this.pKc=6;this.YJl=this.s3h=!1;this.S8e=null;this.A3h=this.z3h=this.y3h=this.u3h=this.t3h=!1;this.progId=null;this.lnf=this.w3h=this.v3h=this.Aoa=this.hPc=
this.ZJl=this.$Jl=!1;this.L1i=this.fic=0;this.u_i=this.platform=null;this.Yvi=this.N1d=!1;this.cUf=this.bUf=0;this.Rke=new Map;this.flk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.Ggf=[1,3,4,2,5];this.Svb={}}get $h(){if(null!=this.cEg)var b=this.cEg;else{var h;v.AFrameworkApplication.se("h7cgh605;1hh5d387");b=this.cEg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:
h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isStyleUnitLoggingEnabled",!1)}return b}get qLm(){if(null!=this.FDg)var b=this.FDg;else{var h;b=this.FDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get rLm(){if(null!=this.GDg)var b=this.GDg;else{var h;v.AFrameworkApplication.se("diei0591;5a40j462");b=this.GDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent3Enabled",
!1)}return b}get gxi(){if(null!=this.EDg)var b=this.EDg;else{var h;b=this.EDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get Zxi(){if(null!=this.MDg)var b=this.MDg;else{var h;b=this.MDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get Gig(){if(null!==this.S8e)switch(this.S8e){case "XLO":return"Excel Online"}if(this.A3h)return"Word Online";
if(this.z3h||this.t3h)return"PowerPoint Online";if(this.s3h)return"Excel Online";if(this.u3h)return"Google Docs";if(this.y3h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}lJ(b,h){const r=new ma.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}j9c(b,h,r){const B=new cv.a;B.name=b;
B.dataFields=h;B.dnmInterval=r;B.dnmAllowedPartA=this.Ggf;oa.a.sendDirectNumericEvent(B)}s8m(){if(this.$h)for(const [b,h]of this.Rke)for(const [r,B]of h){const P=[this.lJ("style",b),this.lJ("unit",r),this.lJ("frequency",B)];Object(ne.a)("StylesAndUnitsFrequency",!0,0,P)}}q6m(){const b=this.tOk();if(this.qLm){var h=[];const r=[this.lJ("isUserConsumer",this.N1d),this.lJ("isDocumentBlank",this.Yvi),this.lJ("FoundText",this.lnf),this.lJ("FoundTable",this.Aoa),this.lJ("FoundImage",this.v3h),this.lJ("FoundList",
this.hPc),this.lJ("FoundLink",this.w3h),this.lJ("Browser",this.fic),this.lJ("SourceApp",this.flk[this.Gig])];for(const B of r)h.push(B);this.j9c("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.Zxi&&(h=[this.lJ("NumberOfEm",this.bUf),this.lJ("NumberOfRem",this.cUf)],Object(ne.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));t.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}Z$k(b,h){var r,B;const P=[];b=this.lJ("tag",null!==(r=Hv[b])&&void 0!==r?r:Hv.OTHERS);h=this.lJ("style",null!==(B=
qw[h])&&void 0!==B?B:qw.OTHERS);B=this.lJ("IsUserConsumer",this.N1d);P.push(b);P.push(h);P.push(B);this.j9c("Office.DNM.Word.Online.ExternalPasteEvent1",P,2)}$$k(b){var h;const r=[];b=this.lJ("tag",null!==(h=Hv[b])&&void 0!==h?h:Hv.OTHERS);h=this.lJ("IsUserConsumer",this.N1d);r.push(b);r.push(h);this.j9c("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}r6m(){const b=this.Svb;for(const B in b){var h=B,r=b[B];this.rLm&&this.$$k(h);if(this.gxi)for(const P of Object.keys(r))this.Z$k(h,P)}}bRa(b,h){b&&
b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Svb||(this.Svb[b]={}),this.Svb[b][h]=this.$fm(b,h)+1)}$fm(b,h){if(!(b&&b.length&&h&&h.length&&this.Svb&&b in this.Svb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Svb[b])&&h in b?b[h]:0}tOk(){const b={};b.ActionIdFlags=this.Vw;b.SourceApp=this.Gig;b.CopySourceBrowser=this.pKc;b.PasteBrowser=this.fic;b.IsSameBrowserPaste=this.DUm(this.pKc,this.fic);b.IsCrossBrowserPaste=this.eLm(this.pKc,this.fic);b.IsUncategorizedBrowserPaste=
this.tXm(this.pKc,this.fic);b.Platform=this.platform;b.OperationId=this.u_i;return b}DUm(b,h){return 5===b||6===b?!1:b===h}eLm(b,h){return 6===b?!1:b!==h}tXm(b,h){return 5===b&&5===h}}Object(n.a)(tj,"HtmlContentMetadata",null,[]);var rw=c(249),ms=c(1465),Ky=c(1079),Kp=c(378),oj=c(136),BB=c(1712),yC=c(137);class eo{get io(){return null!=this.JHg?this.JHg:this.JHg=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h,r,B,P,ca,ra){this.A8b=ra;this.f3g=!1;this.NAj=this.lGe=null;this.qCn=Qa=>{Me.a.mark(5568);
this.hZh(Qa);let mb=this.aPi;if(this.yAi){const Jb=this.Mrj();Jb&&(mb=this.Fob);t.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Jb)}Qa.ri(mb);return!0};this.aPi=Qa=>{Me.a.mark(5569);var mb=new xd.GraphIterator;this.O6a.restore(mb);var Jb=new xd.GraphIterator;this.ymf.restore(Jb);this.ymf=null;t.ULS.shipAssertTag(6305489,307,Zf.OutlineElementReader.yh(mb));t.ULS.shipAssertTag(6305490,307,Zf.OutlineElementReader.yh(Jb));hg.OutlineElementNavigator.Ee(mb);var Yb=Td.ParagraphReader.oh(mb)?
Td.ParagraphReader.textLength(mb.currentNode):0;hg.OutlineElementNavigator.Yd(mb);hg.OutlineElementNavigator.Ee(Jb);t.ULS.shipAssertTag(6305491,307,Td.ParagraphReader.oh(Jb));var fc=Td.ParagraphReader.textLength(Jb.currentNode);hg.OutlineElementNavigator.Yd(Jb);let Mc=this.O$c;var Wc=new al.a;Wc.kd(mb);hg.OutlineElementNavigator.ns(Wc,!1,!1);var id=Wc.currentNode===Jb.currentNode,Id=!!this.yi&&!!(this.yi.Vw&8192);let ve=!1;if(!Id&&this.yi.vd&&Object(uc.a)(wc.DictionaryPropertySet,this.yi.vd)){var $d=
this.yi.vd.tf(Zc.a.wNb);Id=$d&&""!==$d?!0:!1}$d=!1;this.yi.vd instanceof rw.APropertySet&&($d=this.yi.vd.ja(Zc.a.R4,!1));if(id){Yb=xd.GraphIterator.eb(mb.currentNode);Td.ParagraphReader.Bt(hg.OutlineElementNavigator.Ee(Yb))||(mb=Jb);mb.currentNode.id!==Jb.currentNode.id&&(t.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",rg.ListItemReader.lg(mb),rg.ListItemReader.lg(Jb)),Id=eo.Pf.merge(mb,Jb,!0,Id),t.ULS.shipAssertTag(6305492,
307,Id));Jb=mb;var be=!0}else{id=!!(this.yi.Vw&4);be=this.Qd.yg&&id&&this.yi.w4a;var he=!!(this.yi.Vw&262144);this.D0f&&this.yi&&!id&&!he&&(this.D0f.ani(mb,!1),this.D0f.ani(Jb,!0));hg.OutlineElementNavigator.Ee(Wc);id=Td.ParagraphReader.oh(Wc)?Td.ParagraphReader.textLength(Wc.currentNode):0;hg.OutlineElementNavigator.Yd(Wc);wn.a.vr&&this.yi.Vw&65536||this.ZGk(Wc,mb,Jb);he=new al.a;he.kd(Wc);hg.OutlineElementNavigator.ns(he,!1,!1);he.currentNode.id===Jb.currentNode.id&&(this.f3g=!0);if(this.zX.BOa||
this.pto)if(he.Gn.id!==Jb.Gn.id){for(;Wc.currentNode.id!==Jb.currentNode.id;)hg.OutlineElementNavigator.Ee(Wc,!1),this.zX.SIa(Se.a.create(Wc.currentNode)),Wc.sc(),hg.OutlineElementNavigator.ns(Wc,!1,!1);Wc.kd(mb);hg.OutlineElementNavigator.ns(Wc,!1,!1)}else ve=!0;this.OZ&&({O$c:Mc,ywa:Wc}=this.OZ.G3f(mb,Jb,Mc,Wc));yC.a.fL&&this.A8b&&(Wc=this.A8b.G3f(mb,Jb,Wc));if(this.yi.xee&&(t.ULS.shipAssertTag(6305493,307,this.yi.Cdc),he=new xd.GraphIterator,he.kd(Wc),he=hg.OutlineElementNavigator.Ee(he))){var re=
this.yi.xee.wf(he.ra.J(0));he.ra.J(0).formatting=re}he=0;Id&&this.rOe&&(he=1);re=this.Pto(mb,Wc,he);this.yi.xke=null;if(this.yi.Yja||this.yi.WVa)this.yi.xke=this.Gfm(re?mb.currentNode:Wc.currentNode,re);var Xf=!1;re&&(Xf=rg.ListItemReader.lg(mb),t.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Xf,rg.ListItemReader.lg(Jb)),this.lGe=Xf=eo.Pf.merge(mb,Wc,!0,Id,Jb,void 0,ve,be,this.rOe),this.Qto(mb,he)&&this.ndn(mb,Jb,he,Id));he=eo.FCn.mCm(mb,
Wc,Jb,Yb,Xf,this.HWc);var Mg=!1;if(Mc){const $l=new al.a;$l.kd(Jb);hg.OutlineElementNavigator.g1($l,!1,!1);Mg=rg.ListItemReader.lg($l);const Nm=rg.ListItemReader.lg(Jb),zp=$d;t.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",zp);be=eo.Pf.merge($l,Jb,!0,Id,void 0,!0,void 0,be,this.rOe,zp);t.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Mg,Nm,be?"True":"False, will cause IP to reset to zero.");
Jb=(Mg=be)?$l:Jb}else be=!1,t.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.zX.BOa&&ve&&(re&&!this.ENm(he,Xf)?(Wc=new xd.GraphIterator,Wc.kd(mb),mb=hg.OutlineElementNavigator.Ee(Wc),this.zX.rra(mb,Yb,Yb+id)):Mc&&!this.oQm(he,Mg)?(mb=new xd.GraphIterator,mb.kd(Wc),mb=hg.OutlineElementNavigator.Ee(mb),this.zX.rra(mb,0,id)):(mb=new xd.GraphIterator,mb.kd(Wc),mb=hg.OutlineElementNavigator.Ee(mb),this.zX.SIa(Se.a.create(mb))));this.dGn(he);this.B9&&!Id&&this.XH.eKn(he)}t.ULS.shipAssertTag(6305494,
307,Jb.isValid);Id=hg.OutlineElementNavigator.Ee(Jb);fc=be?Td.ParagraphReader.textLength(Id)-fc:0;this.yi.cFa=$d?Fe.SelectionFactory.mJ(Id,fc-1,fc):Fe.SelectionFactory.ne(Id,fc);this.yi&&this.yi.Cdc&&Td.ParagraphReader.Xb(Id)&&this.yi.M9d&&((fc=this.yi.M9d.FFo)&&this.tE.cK(fc,Id,!0),(fc=this.yi.M9d.lBn)&&this.Sk.gvh(Id,fc));Qa.ri(this.Fob);return!0};this.loo=Qa=>{const mb=xd.GraphIterator.eb(this.NAj);mb.EJ(1);this.yi.cFa=Fe.SelectionFactory.Eo(mb.currentNode,!1);Qa.ri(this.Fob);return!0};this.Fob=
()=>{var Qa=void 0===this.yi.Vw||null===this.yi.Vw?"not available":Object(ms.a)(BB.a,this.yi.Vw);t.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.yi.Vw,Qa);t.ULS.shipAssertTag(6305497,307,!!this.yi.cFa);this.HWc?Object(ne.a)("ExternalPasteAction",!0):Object(ne.a)("InternalPasteAction",!0);this.O6a&&(Qa=new xd.GraphIterator,this.O6a.restore(Qa),this.O6a=null,this.wrm(Qa));this.transaction.dispose();ho.a.QRa&&ho.a.z7m();Qa=this.hu.ju;if(!Qa.ue||!Qa.we.Zj)return!1;Qa.we.qJo();return!1};
this.CGa=b;this.ymf=this.O6a=null;this.yi=h;this.transaction=r;this.OZ=B;this.hu=P;this.h7=ca}get K(){return v.AFrameworkApplication.K}get rOe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get XH(){return null!=this.AAg?this.AAg:this.AAg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}get B9(){return this.io&&this.io.B9}get tE(){return null!=this.aKg?this.aKg:this.aKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.DKg?this.DKg:this.DKg=
Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Sk(){return null!=this.hGg?this.hGg:this.hGg=Ya.a.instance.resolve("Box4.IParagraphEditor")}get Jd(){return null!=this.PEg?this.PEg:this.PEg=Ya.a.instance.resolve("Box4.List.IListReader")}get Zm(){return null!=this.BEg?this.BEg:this.BEg=Ya.a.instance.resolve("Box4.List.IListEditor")}get yR(){return null!=this.kBg?this.kBg:this.kBg=Ya.a.instance.resolve("Box4.IBox4GraphWriter")}get Dad(){return null!=this.nHg?this.nHg:this.nHg=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Ej(){return null!=
this.TIg?this.TIg:this.TIg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Fh(){return null!=this.sJg?this.sJg:this.sJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Qd(){return null!=this.bJg?this.bJg:this.bJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get zX(){return null!=this.exg?this.exg:this.exg=Ya.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get D0f(){return null!=this.tGg?this.tGg:
this.tGg=Ya.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get T1i(){return!1}iZh(){}get HWc(){return!1}F1i(b){var h=void 0===this.yi.Vw||null===this.yi.Vw?"not available":Object(ms.a)(BB.a,this.yi.Vw);t.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.yi.Vw,h);t.ULS.shipAssertTag(6305487,307,Pd.SelectionEditor.Ze(this.CGa));if(this.s6d)return t.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.yi.cFa=Fe.SelectionFactory.Xn(this.CGa),b.ri(this.Fob),!0;if(!this.CGa.node)return t.ULS.sendTraceTag(572330334,
307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new xd.GraphIterator;h.set(this.CGa.node);Pd.SelectionEditor.Bu(h);hg.OutlineElementNavigator.Yd(h);this.NAj=h.origin;if(this.T1i)return h.Ps(10),this.iZh(h,b),b.ri(this.loo),!0;this.OZ&&this.OZ.lmn(this.CGa);if(!this.ACo(this.CGa))return this.yi.dS&&(this.yi.dS.fail("SplitLine Failed",!0),this.yi.failed=!0),this.yi.cFa=Fe.SelectionFactory.Xn(this.CGa),b.ri(this.Fob),!0;const r=new al.a;r.kd(h);hg.OutlineElementNavigator.ns(r,
!1,!1);this.O6a=new Ky.a(h);this.ymf=new Ky.a(r);b.ri(this.qCn);return!0}Mrj(){return!1}get yAi(){return this.K.$("PptCcpFix2IsEnabled")}get pto(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}ENm(b,h){return!h&&!!b&&Zf.OutlineElementReader.yh(b.ywa)&&Zf.OutlineElementReader.Bgb(b.ywa)}oQm(b,h){return!h&&!!b&&Zf.OutlineElementReader.yh(b.pmb)&&Zf.OutlineElementReader.Bgb(b.pmb)}dGn(b){eo.C3i&&b&&eo.C3i.aKn(b)}Pto(b,h,r){var B;rg.ListItemReader.lg(b)?(null===(B=this.Dad)||void 0===
B?void 0:B.DBf(b),h=rg.ListItemReader.lg(h)?this.erj:!0):Zf.OutlineElementReader.isEmpty(b,!0)&&!r?(eo.Pf.A1a(b),h=!1):h=!0;this.OZ&&(h=this.OZ.qXk(b,h));return h}Qto(b,h){return rg.ListItemReader.lg(b)||1===h?!0:!1}ndn(b,h,r,B){const P=rg.ListItemReader.lg(b);if(P){if(B=new al.a,B.kd(b),hg.OutlineElementNavigator.ns(B,!1,!1),B.Gn.id!==h.Gn.id){r=this.Jd.ww(b);this.Jd.EP(b);var ca=b.currentNode.ja(Oc.a.listID,0);b.sc();var ra=this.Jd.vuj,Qa=!0;for(r.UA=ti.a.Vl;B.currentNode.id!==h.currentNode.id;){if(!ra||
!Zf.OutlineElementReader.svo(B))if(!rg.ListItemReader.lg(B))oj.a.getInstance().es?(Zf.OutlineElementReader.Pac(B)||({wxa:r}=this.Zm.Zma(r.propertySet,B,r)),this.Zm.s6()):{wxa:r}=this.Zm.Zma(r.propertySet,B,r),Qa=!1;else if(P){Qa=this.Jd.Asf(B);var mb=this.Jd.Px(b.currentNode,ca,Qa);mb=mb?Kp.a.y8(mb,null):r;Qa=Kp.a.IX(mb.listType,r.listStyle,null,0,Qa,"","");Qa.Dnb=b.currentNode;this.Zm.Rmo(Qa);this.Zm.xhe(B,!0);Qa=!1}hg.OutlineElementNavigator.ns(B,!1,!1)}ra&&Qa&&this.Zm.hJk()}}else if(1===r)for(r=
new al.a,r.kd(b),hg.OutlineElementNavigator.Ee(r),b=Td.ParagraphReader.oh(r)?r.currentNode:null,ca=this.qc.qvf(r),hg.OutlineElementNavigator.Yd(r),hg.OutlineElementNavigator.ns(r,!1,!1);r.currentNode.id!==h.currentNode.id;)hg.OutlineElementNavigator.Ee(r),ra=Td.ParagraphReader.oh(r)?r.currentNode:null,hg.OutlineElementNavigator.Yd(r),ra&&b&&B&&(ca&&this.tE.cK(ca,ra,!0),this.h7.lPi(b,ra,P),this.h7.rHa(b,ra,1,!0)),hg.OutlineElementNavigator.ns(r,!1,!1)}ZGk(b,h,r){var B=!1;if(this.Qd.yg)if(wn.a.vr)B=
!0;else{var P=!1;this.OZ&&(P=h.currentNode,P=this.OZ.SSm(P)||this.OZ.sHf(P));P?this.Qd.K6a=4:B=!0}if(B){for(;b.currentNode!==r.currentNode;){hg.OutlineElementNavigator.Ee(b,!1);B=this.Fh.Qad(Se.a.create(b.currentNode));let ca;({type:ca}=B.tVd()).returnValue&&this.Qd.Zs(ca);for(P=0;P<B.length;P++){let ra;const Qa=({H1d:ra}=B.getContext(P)).returnValue;ra&&(eo.jp.vnb(Qa,1),this.Ej.rqb(Qa,1,null,!0))}b.sc();hg.OutlineElementNavigator.ns(b,!1,!1)}b.kd(h);hg.OutlineElementNavigator.ns(b,!1,!1)}}Gfm(b,
h){b=xd.GraphIterator.eb(b);hg.OutlineElementNavigator.Ee(b);return Td.ParagraphReader.Xb(b.currentNode)?(h=h?Td.ParagraphReader.textLength(b.currentNode):0,Fe.SelectionFactory.ne(b.currentNode,h)):mi.TableReader.LR(b.currentNode)?Fe.SelectionFactory.Dq(b.currentNode):null}wrm(b){if(b){if(this.HWc&&mi.TableReader.mx(b)&&this.f3g){if(null!=this.lGe&&0==this.lGe){var h=new al.a;h.kd(b);hg.OutlineElementNavigator.ns(h,!1,!1);b.kd(h)}h=on.a.$4n(b);const r=Td.ParagraphReader.$k(h);h&&r&&(this.yi.cFa=Fe.SelectionFactory.ne(r,
0),b=xd.GraphIterator.eb(h))}else eo.OSm&&on.a.yCn(b);b&&mi.TableReader.mx(b)&&Qg.returnToContainingCell(b)&&on.a.PAk(b.currentNode)}else t.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}oso(b,h){const r=new xd.GraphIterator;r.kd(b);b=hg.OutlineElementNavigator.Ee(r);h=Td.ParagraphReader.Xb(b)&&h===Td.ParagraphReader.textLength(b);t.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}ACo(b){var h;t.ULS.shipAssertTag(6305498,307,Pd.SelectionEditor.Ze(b));
if(null===(h=this.yR)||void 0===h?0:h.Sqb)return!!this.yR.Sqb(b.node,b.cpBegin,{AKl:!0,Fb:b.Fb,Sb:b.Sb});h=xd.GraphIterator.eb(b.node);var r=h.od();hg.OutlineElementNavigator.Yd(h);r&&b.isValid||t.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Zf.OutlineElementReader.yh(h)&&(t.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;
r=eo.Pf.ppa(h,!0);const B=this.oso(h,b.cpBegin);eo.Pf.S$(h,r,b,!1,!1,!0,B);return!0}static get jp(){return null!=eo.sBg?eo.sBg:eo.sBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get Hi(){return Qh.PageReader.instance}static get Pf(){return null!=eo.tFg?eo.tFg:eo.tFg=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get Jo(){return oj.a.getInstance()}static get Zb(){return null!=eo.Izg?eo.Izg:eo.Izg=Ya.a.instance.Oa("Box4.IFeatureHelper")}static get C3i(){return null!=eo.zGg?eo.zGg:
eo.zGg=Ya.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get FCn(){return null!=eo.sGg?eo.sGg:eo.sGg=Ya.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get OSm(){null==this.dHe&&(v.AFrameworkApplication.se("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.dHe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):
!1);return this.dHe}}eo.dHe=null;Object(n.a)(eo,"APasteExecutionManager",null,[]);class DA{constructor(b){this.Tj=b}reset(){this.Tj.reset()}get GLc(){return this.Tj.GLc}Kda(b,h){this.Tj.Kda(b,h)}Jda(b){this.Tj.Jda(b)}gob(b){this.Tj.gob(b)}zya(b){this.Tj.zya(b)}KHa(b){this.Tj.KHa(b)}XSa(b,h){this.Tj.XSa(b,h)}WSa(){this.Tj.WSa()}jE(b){this.Tj.jE(b)}zF(){this.Tj.zF()}bob(){this.Tj.bob()}aob(){this.Tj.aob()}Dya(b){this.Tj.Dya(b)}Bya(){this.Tj.Bya()}OHa(b){this.Tj.OHa(b)}Cya(){this.Tj.Cya()}s6a(b){this.Tj.s6a(b)}b$(b){this.Tj.b$(b)}Z9(){this.Tj.Z9()}w5(b){this.Tj.w5(b)}a$(){this.Tj.a$()}Y9(b){this.Tj.Y9(b)}X9(){this.Tj.X9()}bTa(b,
h){this.Tj.bTa(b,h)}q6a(){this.Tj.q6a()}}Object(n.a)(DA,"AHtmlNormalizer",null,[313,314]);class CB extends DA{constructor(b){super(b);this.XJ=!1}Kda(b,h){this.XJ?this.lN.JM(()=>{this.T3f(b,h)}):this.T3f(b,h)}T3f(b,h){this.Tj.Kda(b,h)}Jda(b){this.XJ?this.lN.JM(()=>{this.w3f(b)}):this.w3f(b)}w3f(b){this.Tj.Jda(b)}zya(b){this.XJ?this.lN.JM(()=>{this.O4c(b)}):this.O4c(b)}O4c(b){this.Tj.zya(b)}KHa(b){this.XJ?this.lN.JM(()=>{this.u3f(b)}):this.u3f(b)}u3f(b){this.Tj.KHa(b)}XSa(b,h){this.XJ?this.lN.JM(()=>
{this.p3f(b,h)}):this.p3f(b,h)}p3f(b,h){this.Tj.XSa(b,h)}WSa(){this.XJ?this.lN.JM(Object(z.a)(this,this.o3f,"processAnchorEnd")):this.o3f()}o3f(){this.Tj.WSa()}jE(b){this.XJ?this.lN.JM(()=>{this.F3f(b)}):this.F3f(b)}F3f(b){this.Tj.jE(b)}zF(){this.XJ?this.lN.JM(Object(z.a)(this,this.E3f,"processParagraphEnd")):this.E3f()}E3f(){this.Tj.zF()}bob(){this.XJ?this.lN.JM(Object(z.a)(this,this.I3f,"processPreFormattedTextStart")):this.I3f()}I3f(){this.Tj.bob()}aob(){this.XJ?this.lN.JM(Object(z.a)(this,this.H3f,
"processPreFormattedTextEnd")):this.H3f()}H3f(){this.Tj.aob()}Dya(b){this.XJ?this.lN.JM(()=>{this.A3f(b)}):this.A3f(b)}A3f(b){this.Tj.Dya(b)}Bya(){this.XJ?this.lN.JM(Object(z.a)(this,this.x3f,"processListEnd")):this.x3f()}x3f(){this.Tj.Bya()}OHa(b){this.XJ?this.lN.JM(()=>{this.z3f(b)}):this.z3f(b)}z3f(b){this.Tj.OHa(b)}Cya(){this.XJ?this.lN.JM(Object(z.a)(this,this.y3f,"processListItemEnd")):this.y3f()}y3f(){this.Tj.Cya()}b$(b){this.XJ?this.lN.JM(()=>{this.S3f(b)}):this.S3f(b)}S3f(b){this.Tj.b$(b)}Z9(){this.XJ?
this.lN.JM(Object(z.a)(this,this.P3f,"processTableEnd")):this.P3f()}P3f(){this.Tj.Z9()}w5(b){this.XJ?this.lN.JM(()=>{this.R3f(b)}):this.R3f(b)}R3f(b){this.Tj.w5(b)}a$(){this.XJ?this.lN.JM(Object(z.a)(this,this.Q3f,"processTableRowEnd")):this.Q3f()}Q3f(){this.Tj.a$()}Y9(b){this.XJ?this.lN.JM(()=>{this.O3f(b)}):this.O3f(b)}O3f(b){this.Tj.Y9(b)}X9(){this.XJ?this.lN.JM(Object(z.a)(this,this.N3f,"processTableCellEnd")):this.N3f()}N3f(){this.Tj.X9()}bTa(b,h){this.XJ?this.lN.JM(()=>{this.C3f(b,h)}):this.C3f(b,
h)}C3f(b,h){this.Tj.bTa(b,h)}q6a(){this.XJ?this.lN.JM(Object(z.a)(this,this.j5i,"processMathEnd")):this.j5i()}j5i(){this.Tj.q6a()}}Object(n.a)(CB,"AQueuingHtmlNormalizer",DA,[]);var zC=c(2002);class Ly{constructor(){this.SPe=new zC.a}JM(b){this.SPe.enqueue(b)}flush(b=!1){for(b&&this.Rge();!this.SPe.isEmpty;)this.SPe.dequeue()();b&&this.Lee()}Rge(){}Lee(){}}Object(n.a)(Ly,"QueuedEventManager",null,[]);class Iv extends Ly{constructor(b){super();this.id=void 0;this.vdf=null;this.S_d=!1;this.Iqa="";this.R_d=
this.K0d=!1;this.ldf=this.u6b=null;this.t1c=0;this.qXc=this.VYc=this.fJf=!1;this.table=null;this.xTf=0;this.i_=b}get FGc(){return!!this.table}Rge(){this.i_.Ihc.push(this.i_.currentState);this.i_.currentState=this}Lee(){this.i_.currentState=this.i_.Ihc.pop()}}Iv.nextId=void 0;Object(n.a)(Iv,"ContentState",Ly,[]);class sw{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.X4a=b.X4a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.uka=b.uka;this.xle=b.xle;this.cec=b.cec;this.k8=b.k8;this.contents=r;this.Mmm=h}}Object(n.a)(sw,"TableCell",null,[]);var AC=c(1714),tw=c(1715);class Jv extends Ly{constructor(b,h){super();this.i_=b;this.bjh=new cr.a;this.lla=new cr.a;this.aLe=[];this.twd=[];this.jLa=-1;this.VWa=0;this.x8j=h.XDf;this.w8j=h.sJm;this.cmk=h.flg;this.Op=h.width;this.V2g=h.X4a;this.B5j=new dr.a(new Go(h.f$.Tpi,h.f$.fXd),h.LB,h.Mya,h.cultureName,h.dDa);this.p7j=h.SXd;this.Wyd=h.styleId;this.hmk=h.tableLook}get Tj(){return this.i_.Tj}yHn(b){this.jLa++;
this.bjh.add(b);this.twd[this.jLa]=b.height;this.VWa=0}get whl(){for(;this.VWa>=this.lla.count;)this.lla.add(Array(this.jLa+1));return this.lla.J(this.VWa)}Ork(b,h,r,B,P,ca,ra){if(0>this.jLa)return!1;for(;this.aLe[this.VWa]>=this.jLa;)this.VWa++;b=new sw(b,new dr.a(h,r,B,P,ca),ra);this.whl[this.jLa]=b;if(1<b.rowSpan)for(h=this.jLa+b.rowSpan-1,B=this.VWa,r=this.VWa+b.colSpan-1;B<=r;B++)this.aLe[B]>=h||(this.aLe[B]=h);this.VWa+=b.colSpan;this.twd[this.jLa]<b.height&&(this.twd[this.jLa]=b.height);return!0}Rge(){this.i_.currentState.table=
this}Lee(){this.i_.currentState.table=null}W1h(){v.AFrameworkApplication.se("fd8b6402;j6e17681");this.flush(!0);const b=this.jLa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.lla.count);r=!0;var B=0;for(var P=0;P<this.lla.count;P++){var ca=this.lla.J(P),ra=!0;for(var Qa=0;Qa<b;Qa++){var mb=ca[Qa];mb&&(ra=!1,h[Qa][P+B]=new ow(mb.colSpan,mb.rowSpan,mb.width,mb.height,void 0,void 0,void 0,void 0,mb.X4a,mb.cec))}ra?(this.lla.removeAt(P),P--,++B):r=!1}if(!r){(h=this.V2g?this.i_.wBh(h,this.Op/100):
this.i_.wBh(h,1,this.Op))&&h.length!==this.lla.count&&(h=null);this.i_.Whb(!0);this.i_.$Gd();this.Tj.b$(new bx(b,this.lla.count,this.Op,this.V2g,h,this.x8j,this.w8j,this.cmk,this.p7j,this.Wyd,this.hmk,this.B5j));for(h=0;h<b;h++){r=this.bjh.J(h);this.Tj.w5(new wj(this.twd[h],new dr.a(r.f$,r.LB,r.Mya,r.cultureName,r.dDa)));for(r=0;r<this.lla.count;r++){B=this.lla.J(r)[h];var Jb=!!this.Wyd&&""!==this.Wyd&&"Custom"!==this.Wyd;P=B?B.colSpan:0;ca=B?B.rowSpan:0;B&&(P=Math.min(B.colSpan,this.lla.count-r),
ca=Math.min(B.rowSpan,b-h));ra=B?B.width:0;Qa=B?B.height:0;mb=B?B.k8:0;const Yb=B?B.X4a:!1,fc=B&&(65536&mb||!Jb)?B.shadingColor:"",Mc=B?B.verticalAlignment:0,Wc=B?B.cec:!1;Jb=B?this.i_.r7l(B.uka,r,h,this.lla,Jb,B.k8):new AC.a;const id=B?B.xle:new tw.a,Id=B?B.Mmm:null;this.Tj.Y9(new ow(P,ca,ra,Qa,fc,Mc,Jb,id,Yb,Wc,mb,new dr.a(Id?Id.f$:null,Id?Id.LB:null,Id?Id.Mya:null,Id?Id.cultureName:null,Id?Id.dDa:null)));B&&!B.cec&&(B.contents.Rge(),B.contents.flush(),this.i_.Whb(!1),this.i_.$Gd(),B.contents.Lee());
this.Tj.X9()}this.Tj.a$()}this.Tj.Z9();this.i_.currentState.qXc=!1;this.i_.aYh(!1)}}}Object(n.a)(Jv,"NormalizedTable",Ly,[]);class Xx{constructor(b=!1,h=!1){this.g9j=b;this.Ama=h}get BPm(){return this.g9j}get D8a(){return this.Ama}}Object(n.a)(Xx,"HtmlNormalizerSettings",null,[803]);class Hq extends CB{constructor(b,h=null){super(b);this.XHe=null;this.Ihc=new qu;this.TXb=h||new Xx}reset(){super.reset();this.currentState=new Iv(this);this.Ihc.clear();this.XJ=!1}get lN(){return this.currentState&&this.currentState.FGc?
this.currentState.table:this.currentState}pNd(b=!1){this.currentState.S_d||(this.$Gd(),this.Tj.jE(this.currentState.vdf),this.currentState.S_d=!0,this.currentState.qXc=!1);b||!this.currentState.u6b||this.currentState.R_d||(this.Tj.XSa(this.currentState.u6b,this.currentState.ldf),this.currentState.R_d=!0)}FNc(){this.currentState.R_d&&(this.Tj.WSa(),this.currentState.R_d=!1)}Kxl(){this.currentState.S_d&&(this.Tj.zF(),this.currentState.S_d=!1,this.currentState.Iqa="")}aYh(b){this.currentState.VYc&&(this.currentState.qXc?
b||(this.Tj.jE(null),this.Tj.zF(),this.Tj.Cya(),this.currentState.VYc=!1):(this.Tj.Cya(),this.currentState.VYc=!1,this.currentState.qXc=!0))}Whb(b){this.FNc();this.Kxl();this.aYh(b)}Wxn(b){this.Tj.Dya(new kp.a(2,1,b));this.currentState.t1c++;this.currentState.fJf=!0}$Gd(){!this.currentState.VYc&&this.currentState.fJf&&(this.Tj.Bya(),this.currentState.t1c--,this.currentState.fJf=!1)}T3f(b,h){b=this.Iin(b);if(""!==b)if(this.pNd(),this.currentState.K0d)this.U3f(b,h);else{b=b.split(Hq.FQk);for(let r=
0;r<b.length-1;r++)this.U3f(b[r],h),this.Tj.gob(h);this.U3f(b[b.length-1],h)}}C3f(b,h){""!==b&&(this.pNd(),this.Tj.bTa(b,h))}w3f(b){this.TXb.D8a||this.FNc();this.pNd(!0);this.Tj.Jda(b)}u3f(b){this.currentState.FGc||this.Tj.KHa(b)}O4c(b){this.currentState.u6b&&(b.href=this.currentState.u6b);super.O4c(b)}p3f(b,h){this.FNc();this.currentState.u6b=b;this.currentState.ldf=h}o3f(){this.FNc();this.currentState.u6b=null;this.currentState.ldf=null}F3f(b){this.currentState.vdf=b;this.Whb(!0)}E3f(){this.currentState.vdf=
null;this.Whb(!0)}I3f(){this.currentState.K0d=!0}H3f(){this.currentState.K0d=!1}A3f(b){this.Whb(!1);this.$Gd();this.Tj.Dya(b);this.currentState.t1c++}x3f(){this.Whb(!1);this.Tj.Bya();this.currentState.t1c--}z3f(b){this.Whb(!1);this.currentState.t1c||this.Wxn(b);this.Tj.OHa(b);this.currentState.VYc=!0;this.currentState.qXc=!0}y3f(){this.Whb(!1)}b$(b){this.currentState.FGc||(this.XJ=!0,this.currentState.table=new Jv(this,b))}S3f(){}Z9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.Ihc.isEmpty?(this.XJ=!1,b.W1h()):this.lN.JM(Object(z.a)(b,b.W1h,"flushTable"))}}P3f(){}w5(b){this.currentState.FGc&&this.currentState.table.yHn(b)}R3f(){}a$(){}Q3f(){}Y9(b){let h=!1;if(this.currentState.FGc){const r=new Iv(this);this.currentState.table.Ork(b,new Go(b.f$.Tpi,b.f$.fXd),b.LB,b.Mya,b.cultureName,b.dDa,r)?(this.Ihc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.xTf++}O3f(){}X9(){0<this.currentState.xTf?this.currentState.xTf--:this.currentState=
this.Ihc.pop()}N3f(){}wBh(b,h=1,r=0){if(!b)return null;const B=b.length;if(!B)return null;const P=b[0].length;for(var ca=1;ca<B;ca++)if(b[ca].length!==P)return null;ca=Array(P+1);ca[0]=0;const ra=Array(P+1);for(var Qa=0;Qa<ra.length;Qa++)ra[Qa]=!1;const mb=new vb.a;Qa=0;for(let Yb=0;Yb<P;Yb++){for(var Jb=0;Jb<B;Jb++){const fc=b[Jb][Yb];if(fc&&0<fc.width){const Mc=Math.min(Yb+fc.colSpan,P);ca[Mc]=ca[Yb]+fc.width*(fc.X4a?h:1);ra[Mc]=!0}}if(ra[Yb+1]){Jb=ca[Yb+1]-ca[Yb];if(0>=Jb)return null;mb.add(Jb)}else ca[Yb+
1]=ca[Yb],0<r&&this.MDi&&(mb.add(-1),Qa++)}b=mb.toArray();if(0<Qa&&0<r&&this.MDi)for(t.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),r=(r-ca[ca.length-1])/Qa,h=0;h<b.length;h++)-1===b[h]&&(b[h]=r);return b}get MDi(){null==this.XHe&&(v.AFrameworkApplication.se("2i46g603;2fc7g589"),this.XHe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.XHe}dbn(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}r7l(b,h,r,B,P,ca){if(!b)return null;P&&(b=this.dbn(b,ca));if(0>r||0>h||h>B.count-1)return b;0<=h-1&&r<=B.J(h-1).length-1&&1===b.borderLeftStyle&&(P=B.J(h-1)[r])&&1!==P.uka.borderRightStyle&&(b.borderLeftStyle=P.uka.borderRightStyle,b.borderLeftColor=P.uka.borderRightColor,b.borderLeftWidth=P.uka.borderRightWidth);0<=r-1&&r<=B.J(h).length-1&&1===b.borderTopStyle&&(h=B.J(h)[r-
1])&&1!==h.uka.borderBottomStyle&&(b.borderTopStyle=h.uka.borderBottomStyle,b.borderTopColor=h.uka.borderBottomColor,b.borderTopWidth=h.uka.borderBottomWidth);return b}Iin(b){this.currentState.K0d||(b=this.TXb.BPm?b.replace(Hq.Kwm," "):b.replace(Hq.Jwm," "));b.startsWith(" ")&&(this.currentState.Iqa.endsWith(" ")||""===this.currentState.Iqa)&&(b=E.a.substring(b,1,b.length));return b}U3f(b,h){""!==b&&(this.Tj.Kda(b,h),this.currentState.Iqa+=b)}}Hq.Jwm=RegExp("[ \t\f\u200b\r\n]+","g");Hq.Kwm=RegExp("[ \f\u200b\r\n]+",
"g");Hq.FQk="\t";Object(n.a)(Hq,"DefaultHtmlNormalizer",CB,[]);class Lz extends Hq{constructor(b,h,r){super(b,r);this.PYg=!1;this.Xvb=h}static LLm(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=Lz.Mml.exec(b))&&0<b.length:!1}O4c(b){this.Xvb.oic&&(v.AFrameworkApplication.dqa?this.PYg||(b=new Wh.StandardDialog,b.Cd=0,b.ye(1,CommonUIStrings.l_DialogClose),b.sv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.PYg=!0):this.Xvb.tOi?this.Xvb.O4d=!0:b.src&&""!==b.src?ka.a.getOrigin(b.src)!==ka.a.getOrigin(window.location.href)||Lz.LLm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?v.AFrameworkApplication.va.processAction(Mb.a.O1i,2):b.src.startsWith("webkit-fake-url")?v.AFrameworkApplication.va.processAction(Mb.a.N1i,2):(this.FNc(),this.pNd(!0),this.Tj.zya(b)):v.AFrameworkApplication.va.processAction(Mb.a.Q1i,2):v.AFrameworkApplication.va.processAction(Mb.a.P1i,2))}}Lz.Mml=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(n.a)(Lz,"Box4HtmlNormalizer",Hq,[]);class DB{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.htmlProcessor=b;this.dBf=h;this.DVk=r;this.KLj=B;this.VJl=P;this.eeo=ca;this.feo=ra;this.cUc=Qa;this.Cwm=mb;this.Fwm=Jb;this.y_c=Yb}}Object(n.a)(DB,"ExecutePasteArguments",null,[]);class Kv extends eo{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve){super(h,r,B,Jb,fc,id,ve);this.l3=null;this.Bin=$d=>{this.Lnd.YFi(this.Yaa)&&v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.nkk&&this.Lnd.mPo(this.Yaa);$d.ri(this.DHn);return!0};this.DHn=$d=>{if(this.Bjk){const be=this.Yaa.getElementsByTagName("style");if(be&&0<be.length){t.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let he=0;he<be.length;he++)this.lBe.X7k(this.Yaa,be[he]),be[he]&&(be[he].parentNode.removeChild(be[he]),he--)}}$d.ri(this.j8k);return!0};this.j8k=($d,be)=>{this.GYe.value.create(be.KLj).process(this.Yaa,$d);(be=Ya.a.instance.Oa("Box4.IFeatureHelper"))&&
be.isFeatureEnabled(10)?$d.ri(this.q7k):$d.ri(this.d5i);return!0};this.q7k=($d,be)=>{(new yu(be.DVk)).process(this.Yaa,$d);$d.ri(this.d5i);return!0};this.d5i=($d,be)=>{var he;if(Wk.PXc&&!document.getElementById("FrameContainingPastedDOM")){var re=window.performance.now(),Xf=document.createElement("iframe");Xf.style.display="none";Xf.style.contain="strict";Xf.setAttribute("sandbox","allow-same-origin");Xf.id="FrameContainingPastedDOM";document.body.appendChild(Xf);ho.a.QRa&&(ho.a.Pcf=window.performance.now()-
re)}Xf=null;Wk.PXc&&(Xf=document.getElementById("FrameContainingPastedDOM"));Wk.PXc&&Xf instanceof HTMLIFrameElement?(re=0,ho.a.QRa&&(re=window.performance.now()),Xf=null===(he=Xf.contentDocument)||void 0===he?void 0:he.querySelector("body"),null===Xf||void 0===Xf?void 0:Xf.appendChild(this.Yaa),ho.a.QRa&&(ho.a.idj=window.performance.now()-re),he=null===Xf||void 0===Xf?void 0:Xf.children,1!==(null===he||void 0===he?void 0:he.length)&&t.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),
be.htmlProcessor.process(1===(null===he||void 0===he?void 0:he.length)?he[0]:this.Yaa,$d)):be.htmlProcessor.process(this.Yaa,$d);$d.ri(be.dBf&&be.dBf.oic?this.oPb:this.mXh);return!0};this.oPb=($d,be)=>{if(be=be.dBf){let re=!1,Xf=!1,Mg=!1,$l=!1;var he=-1;const Nm=new wc.DictionaryPropertySet,zp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(uc.a)(88,this.yi.vd)?(re=this.yi.vd.ja(Oc.a.wia,!1),he=this.yi.vd.ja(Zc.a.LP,""),Mg=this.yi.vd.ja(Zc.a.R4,!1),$l=this.yi.vd.ja(Pe.a.Oxa,!1),zp.test(he)&&
(Xf=!0),he=this.yi.vd.ja(Ng.a.kha,-1)):this.yi.Vw&256&&this.Yaa&&(re=!0,zp.test(this.Yaa.innerHTML)&&(Xf=!0));Nm.setValue(Oc.a.wia,re);Nm.setValue(Zc.a.aZc,Xf);Nm.setValue(Zc.a.R4,Mg);Nm.setValue(Ng.a.kha,he);Nm.setValue(Pe.a.Oxa,$l);be.nhe(Nm);be.pYf();be.Anb&&(this.yi.eXc=!0,this.yi.yBf=be.MX,this.yi.RUf=be.Anb,re&&!Mg&&ne.c(Mb.a.PAl),v.AFrameworkApplication.va.processAction(Mb.a.oPb,2))}$d.ri(this.mXh);return!0};this.mXh=($d,be)=>{var he;$d=0;ho.a.QRa&&($d=window.performance.now());if(Wk.PXc){var re=
document.getElementById("FrameContainingPastedDOM");re instanceof HTMLIFrameElement&&(re=null===(he=re.contentDocument)||void 0===he?void 0:he.querySelector("body"),(null===re||void 0===re?0:re.firstElementChild)?(t.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===re||void 0===re?void 0:re.removeChild(null===re||void 0===re?void 0:re.firstElementChild)):t.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}ho.a.QRa&&(ho.a.zcj=window.performance.now()-
$d);xq.a.k9m(be.KLj);xq.a.t6m(be.Fwm);xq.a.d8m(be.eeo);xq.a.e8m(be.feo);xq.a.T6m(be.y_c);he="Others";be.cUc&&(be.cUc.q6m(),be.cUc.r6m(),be.cUc.s8m(),he=be.cUc.Gig);xq.a.s6m(be.Cwm,he);xq.a.c6m(be.VJl,he);return!1};this.Yaa=b;this.bve=P;this.REe=ca;this.rVe=ra;this.GYe=Qa;this.Iwc=mb;this.TXb=Wc;this.Ca=Yb;this.HZg=Object.assign(new BA,{Ecc:2===this.yi.N5b||3===this.yi.N5b});this.lBe=Mc;this.Lnd=Id;this.v0b=Yb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Bjk=Yb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.nkk=Yb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get s6d(){return!1}get HWc(){return!0}hZh(b){this.l3=new xd.GraphIterator;this.O6a.restore(this.l3);t.ULS.shipAssertTag(6305550,307,Zf.OutlineElementReader.yh(this.l3));this.yi.dS&&this.yi.dS.r3b("external");var h=this.yi.Vw&8192?1:0,r=this.REe.value.create(h,this.l3,this.yi.gJc,this.yi.Cpb),B=this.rVe.value.create(h,this.l3);const P=xq.a.U6h(v.AFrameworkApplication.userSessionId),ca=xq.a.Nki(v.AFrameworkApplication.userSessionId),ra=xq.a.vrf(ba.a.QBb,
this.yi.gJc),Qa=xq.a.phi(v.AFrameworkApplication.userSessionId),mb=xq.a.qhi(v.AFrameworkApplication.userSessionId),Jb=this.v0b?this.QBm():null,Yb=xq.a.Aai(ba.a.QBb,this.yi.gJc),fc=xq.a.Bai(v.AFrameworkApplication.userSessionId),Mc=this.Iwc.Oqj?xq.a.m4l(v.AFrameworkApplication.userSessionId):null;h=this.bve.value.create(h,this.l3,r,B,null,ra,this.QCk,this.yi.dme);h=new Yj(h,Qa,mb);h=new Lz(h,r,this.TXb);h=new Wk(h,this.Iwc,this.HZg,Mc);B=new $g(Jb);h=new co(h,Yb,Jb,this.Ca,B);h=new Gq(h,fc);r=new DB(h,
r,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc);r=new yv.a(b,this.Bin,r);r.Rl("paste and request pictures");r.Qh=!b||b.Qh;r.run()}get QCk(){return this.Yaa.getElementsByTagName("a").length}QBm(){const b=new tj;b.fic=ba.a.QBb;this.yi&&(b.Vw=this.yi.Vw,b.u_i=this.yi.gJc,this.yi.vd&&(b.progId=this.yi.vd.ja(Zc.a.M1i,"")));this.Yaa&&this.Yaa.innerHTML&&(b.L1i=this.Yaa.innerHTML.length,ho.a.QRa&&(ho.a.J1i=b.L1i));v.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=v.AFrameworkApplication.sessionStartInfoSettings.Platform,
b.N1d=v.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.Yvi=Td.ParagraphReader.Dba(ab.StaticActiveAppFrame.za().jb.rc.ed));return b}get erj(){return!0}get O$c(){t.ULS.shipAssertTag(6305551,307,!!this.l3);if(this.Iwc.Pqj(this.HZg)){var b=!1;Zf.OutlineElementReader.yh(this.l3)&&(this.l3.lY(),b=!0);var h=Td.ParagraphReader.oh(this.l3)&&!this.l3.currentNode.ja(Zc.a.gyi,!1);b&&this.l3.sc();return h}return this.yi.Vw&524288?(b=!1,Zf.OutlineElementReader.yh(this.l3)&&(this.l3.lY(),b=!0),h=Td.ParagraphReader.oh(this.l3),
b&&this.l3.sc(),h):Td.ParagraphReader.oh(this.l3)}}Object(n.a)(Kv,"ExternalPasteExecutionManager",eo,[]);class Yx{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc){this.A8b=fc;this.bve=b;this.REe=h;this.rVe=r;this.GYe=B;this.Iwc=P;this.OZ=ca;this.Ca=ra;this.lBe=Qa;this.TXb=mb;this.h7=Jb;this.Lnd=Yb}create(b,h,r,B){return new Kv(b,h,r,B,this.bve,this.REe,this.rVe,this.GYe,this.Iwc.value,this.OZ,this.Ca,ab.StaticActiveAppFrame.za().jb,this.lBe,this.TXb,this.h7,this.Lnd,this.A8b)}}Object(n.a)(Yx,"Factory",
null,[522]);class EB{YFi(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.SMm(b.childNodes[h-2])&&this.BYm(b.childNodes[h-1])}mPo(b){this.YFi(b)&&(b.removeChild(b.lastChild),t.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}nKm(b){return!!b&&8===b.nodeType}TWm(b){return!!b&&3===b.nodeType}SMm(b){return this.nKm(b)&&"EndFragment"===b.nodeValue}BYm(b){if(!this.TWm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(n.a)(EB,"HtmlNormalizerHelper",
null,[521]);var et=c(1989),uw=c(643);class EA extends eo{constructor(b,h,r,B,P,ca,ra,Qa,mb){super(b,h,r,P,ca,Qa,mb);this.iA=B;this.iM=ra}get sl(){return this.iM.value}get s6d(){return this.iA.s6d()}get T1i(){const b=this.iA;return b.Q$e&&!b.nui()}iZh(b,h){t.ULS.shipAssertTag(6305616,307,Dg.OutlineReader.nx(b));const r=uw.a(b.currentNode);if(Dg.OutlineReader.isEmpty(b)){var B=Se.a.create(b.currentNode);b.Ps(8);v.AFrameworkApplication.va.Mf(B,Mb.a.QH,2,!0,null,null)}else b.Ps(8);(B=b.EJ(1))&&b.sc();
this.iA.A1i(this.yi.ke,b.currentNode,B,-1,r,h)}hZh(b){const h=new xd.GraphIterator;this.O6a.restore(h);t.ULS.shipAssertTag(6305618,307,Zf.OutlineElementReader.yh(h));this.yi.dS&&this.yi.dS.r3b("internal");let r=-1;if(Object(uc.a)(88,this.yi.vd))r=this.yi.vd.ja(Ng.a.kha,-1);else{const B=this.sVl(h.currentNode);r=B?B.clientWidth:r}this.iA.A1i(this.yi.ke,h.parentNode,h.currentNode,r,null,b);this.yAi&&(this.O6a.restore(h),Zf.OutlineElementReader.yh(h)&&this.iA.JDi(h)&&(b=hg.OutlineElementNavigator.Ee(h)))&&
(this.yi.cFa=Fe.SelectionFactory.ne(b,0))}sVl(b){return b?(b=b?b.qe(this.sl.$b):null)?b.htmlElement:null:null}Mrj(){const b=new xd.GraphIterator;this.O6a.restore(b);return this.iA.JDi(b)}get erj(){return!0}get O$c(){return!this.iA.nwa&&!this.iA.Q$e}}Object(n.a)(EA,"InternalPasteExecutionManager",eo,[]);class zo{constructor(b,h,r,B,P){this.A8b=P;this.iA=b;this.OZ=h;this.iM=r;this.h7=B}create(b,h,r){return new EA(b,h,r,this.iA,this.OZ,ab.StaticActiveAppFrame.za().jb,this.iM,this.h7,this.A8b)}}Object(n.a)(zo,
"Factory",null,[520]);var Mz;(function(b){b[b.unknown=0]="unknown";b[b.eip=1]="differentBox4App";b[b.Mrp=2]="sameBox4AppDifferentSession";b[b.Nrp=3]="sameBox4AppSameSession"})(Mz||(Mz={}));Object(n.b)("CopySource",Mz);class ns{constructor(b,h,r,B){this.iA=b;this.b0g=h;this.T2j=r;this.Nk=B}mCn(b,h,r){t.ULS.shipAssertTag(6305620,307,!!b);t.ULS.shipAssertTag(6305621,307,Pd.SelectionEditor.Ze(h));t.ULS.shipAssertTag(6305622,307,!!r);t.ULS.shipAssertTag(6305623,307,Object(uc.a)(zv.a,r.Dqa));const B=r.Dqa;
B.N5b=this.iA.s8h(b);this.H6m(b,B);let P=!1;wn.a.vId&&this.Nk.yia(h,Qa=>P=Qa)&&(B.Vw|=8192,wn.a.wId&&(B.dme=1,P||(B.dme|=2)));const ca=this.RPm(B);var ra=new sg.GraphTransaction(7,Mb.a.paste);ra.Db(h.node);h.node.zJ().rF.f8(8);ca?(t.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",B.Vw,B.browserName),b=this.b0g.create(h,B,ra)):(t.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",B.Vw,B.N5b,B.browserName),ns.w6m(b),b=this.T2j.create(b,h,B,
ra));r=new yv.a(r,Object(z.a)(b,b.F1i,"pasteSetup"),null);r.Rl("Paste");r.run()}RPm(b){return!this.QSm(b)&&3===b.N5b}QSm(b){return 1===(b.Vw&8192?1:0)}uui(b,h){t.ULS.shipAssertTag(6305624,307,Pd.SelectionEditor.Ze(b));t.ULS.shipAssertTag(6305625,307,!!h);t.ULS.shipAssertTag(6305626,307,Object(uc.a)(zv.a,h.Dqa));const r=new sg.GraphTransaction(7,Mb.a.NYd);r.Db(b.node);b=this.b0g.create(b,h.Dqa,r);h=new yv.a(h,Object(z.a)(b,b.F1i,"pasteSetup"),null);h.Rl("InternalPasteAtIp");h.run()}H6m(b,h){if(b){let r=
!1,B=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?B=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||B)&&t.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Mz[h.N5b],r,B)}}static w6m(b){b&&ns.upk.test(b.innerText)&&t.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}ns.upk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(n.a)(ns,"PasteCoordinator",null,[]);class FA{constructor(b,h,r,B,P){this.ywa=b;this.pmb=h;this.ECn=r;this.DCn=B;this.HWc=P}}Object(n.a)(FA,"PastedContentsPostProcessorParams",null,[]);class dv{mCm(b,h,r,B,P,ca){b=this.fZl(b,h,P);r=this.T2l(r);if(!b||!r)return null;B=this.q$l(b,B,P);P=this.p$l(r);return new FA(b,r,B,P,ca)}fZl(b,h,r){b=r?b:h;if(!Zf.OutlineElementReader.yh(b))return null;h=new al.a;h.kd(b);return h}T2l(b){if(!Zf.OutlineElementReader.yh(b))return null;const h=new al.a;h.kd(b);
hg.OutlineElementNavigator.g1(h,!1,!1);return h}q$l(b,h,r){hg.OutlineElementNavigator.Ee(b);let B=-1;Td.ParagraphReader.oh(b)&&(B=r?h:0);hg.OutlineElementNavigator.Yd(b);return B}p$l(b){hg.OutlineElementNavigator.Ee(b);const h=Td.ParagraphReader.oh(b)?Td.ParagraphReader.textLength(b.currentNode):-1;hg.OutlineElementNavigator.Yd(b);return h}}Object(n.a)(dv,"PastedContentsPostProcessorHelper",null,[]);var BC=c(807),th=c(1108),vw=c(1107);class Pg{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc=null){this.Jqa=
b;this.i$=h;this.Nl=r;this.k4i=B;this.ta=P;this.H6a=ca;this.K=ra;this.rCn=Qa;this.Rda=mb;this.GHb=Jb;this.yva=Yb;this.mb=fc;this.Dia=Mc;this.cQh=100;this.pec=!1;this.cye=null;this.MGe=!1;this.$td=null;this.oqd=this.pMa=!1;this.pHl=(Wc,id)=>{this.dismissFloatie(id.KDl)};this.xxo=(Wc,id)=>{this.Yal(Wc,id)};this.IP=(Wc,id)=>{id.property===Pe.a.lastModifiedTime?(t.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.GHb.sdf.contains(Mb.a.rqg)||this.I5f(id)):t.ULS.sendTraceTag(520734532,
307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.dTa=(Wc,id)=>{this.I5f(id)};this.gja=(Wc,id)=>{id.MEf||this.I5f(id)};this.bXi=()=>{BC.a.instance.keyCode===kc.a.AAa&&this.i$.Y6i()};this.rDo()}rDo(){this.i$.Grh(this.xxo);this.i$.orh(this.pHl)}Yal(b,h){var r,B,P;(null===(B=null===(r=this.mb.ib)||void 0===r?void 0:r.lb)||void 0===B?0:B.NWc)?t.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.H6a.hDf(),1===this.rCn.mbl(h.Z3c)?t.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.pMa?this.pMa=!1:this.kZn(),this.A6c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Mb.a.BU(h.aZ)||"Unknown",h.correlationId),t.ULS.sendTraceTag(40379588,307,50,b),ne.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ma.a,{name:"PasteCommand",int64:Mb.a.BU(h.aZ)||"Unknown"}),Object.assign(new ma.a,
{name:"CorrelationId",string:null===(P=h.correlationId)||void 0===P?void 0:P.toString()})]),this.TSb()):t.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.MGe&&(this.pMa||(this.Dia?null===(h=this.yva)||void 0===h?0:h.M0:this.Jqa.M0()))&&(b&&(this.H6a.hDf(),this.GEj(),t.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.$td)),this.pMa=!b,this.eoe(),this.Dia?
v.AFrameworkApplication.va.processAction(Mb.a.dIb,2):this.Jqa.dismissFloatie())}kZn(){this.oqd||(this.cye=this.Nl.yd,De.a.addHandler(this.cye.container,"scroll",Object(z.a)(this,this.VPb,"scrollHandler")),this.ta.G_(Object(z.a)(this,this.Pja,"resizeHandler")),this.oqd=!0)}GEj(){this.oqd&&(De.a.removeHandler(this.cye.container,"scroll",Object(z.a)(this,this.VPb,"scrollHandler")),this.ta.cea(Object(z.a)(this,this.Pja,"resizeHandler")),this.oqd=!1)}TSb(){if(this.Dia)this.yva.M0&&v.AFrameworkApplication.va.processAction(Mb.a.dIb,
2),v.AFrameworkApplication.va.processAction(Mb.a.nad,2),this.pec=!1;else{const b=new vw.a(0,v.AFrameworkApplication.isRtl);b.location=this.H6a.qQa();this.H6a.LNm(b.location)?this.showFloatie(null,b):this.i$.qIa(new th.a(!1))}}Pja(){this.Dia?(v.AFrameworkApplication.va.processAction(Mb.a.dIb,2),this.ALc()):this.TSb()}VPb(){this.Dia?(v.AFrameworkApplication.va.processAction(Mb.a.dIb,2),this.ALc()):this.TSb()}A6c(){this.k4i.wyk(this.bXi);this.i$.trh(Object(z.a)(this.Jqa,this.Jqa.$Nd,"expandFloatie"));
this.i$.Crh(Object(z.a)(this,this.I1i,"pastedFloatieStatusChange"));this.Rda.ku(this.gja);this.Rda.kw(this.dTa);this.Rda.qo(this.IP)}eoe(){this.k4i.v2n(this.bXi);this.i$.hcj(Object(z.a)(this.Jqa,this.Jqa.$Nd,"expandFloatie"));this.i$.pcj(Object(z.a)(this,this.I1i,"pastedFloatieStatusChange"));this.Rda.xV(this.gja);this.Rda.bea(this.dTa);this.Rda.UP(this.IP)}I1i(b,h){this.MGe=h.MWc;h.aZ&&(this.$td=h.aZ);h.chg&&this.Jqa.M0()&&this.TSb()}I5f(b){b.node.loading||this.i$.qIa(new th.a(!0))}showFloatie(b,
h){h||(h=new vw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.H6a.qQa());if(!h.location)return!1;this.pMa&&(this.pMa=!1,this.A6c());this.Dia?v.AFrameworkApplication.va.processAction(Mb.a.nad,2):this.Jqa.showFloatie(b,h);return!0}ALc(){if(!this.pec){const b=new Oe.a(3,1,this.cQh,()=>{this.TSb()},215);Rg.a.instance.Wb(b);this.pec=!0}}}Object(n.a)(Pg,"PasteFloatieEventManager",null,[]);class Zx{constructor(b,h){this.lk=b;this.BI=h}mbl(b){return vo.any(vo.where(vo.asEnumerable(Zx.sGo),
h=>this.BI.mYc(h)))?(b=this.lk.Cob(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Zx.sGo=[Mb.a.MTa.toString(),Mb.a.NTa.toString(),Mb.a.fza.toString()];Object(n.a)(Zx,"PasteFloatieFeatureSetBuilder",null,[]);class Nz{constructor(){this.Rya=null;this.jic=0}}Object(n.a)(Nz,"PasteFloatieAnchorData",null,[]);class ww{constructor(b,h,r,B,P,ca=!1){this.jyb=null;this.hb=b;this.nua=h;this.ld=r;this.E4j=B;this.oOe=P;this.nHe=ca}hDf(){this.jyb=null}qQa(){const b=this.lrf(this.jyb)||this.iBh();if(!b){let h="null",
r="null";if(this.jyb&&this.jyb.Rya){if(!this.ld.yd)return t.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.jyb.Rya).getName();const B=this.ld.yd.Aj(this.jyb.Rya);B&&(r=Object.getType(B).getName())}t.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}LNm(b){if(!b)return!1;const h=this.oOe.nGb(),r=this.E4j(this.ld.yd.container);b=new Sys.UI.Bounds(b.x,
b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}iBh(){if(!this.hb||!this.hb.ib||!this.hb.ib.lb)return t.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.hb.ib.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.xfi(r);while(r&&Object(uc.a)(ni.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const P=Object(Na.a)(ni.AParagraphNode,r);P&&(B=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():
P.characterData.substring(0,b.cpBegin).trimEnd());h=P?B.length:b.cpBegin;b=Object.assign(new Nz,{Rya:Object(Na.a)(112,(P?Object(Na.a)(112,P):Object(Na.a)(112,r))||b.node),jic:h});return this.lrf(b)}xfi(b){const h=new xd.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.od())return null;h.jd(11);return h.FJ()?h.Tb(2):null}lrf(b){if(!b||!b.Rya)return null;this.jyb=b;const h=this.ld.yd;if(!h)return t.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;
b=this.Cai(b,h);if(!b)return null;v.AFrameworkApplication.isRtl&&this.oOe.M0()&&(b.x-=this.oOe.nGb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}Cai(b,h){h=h.qe(b.Rya);if(!h)return null;let r=null;if(Object(uc.a)(ni.AParagraphNode,b.Rya)){const B=Object(Na.a)(94,h);if(!B)return null;try{r=this.nua.Q_(b.jic,B,0<b.jic,!1,!1,!1),r.height+=this.nHe?ww.sQn:ww.sHl}catch(P){t.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",P),r=null}}else Object(uc.a)(Bl.TableNode,
b.Rya)&&(r=Object(Na.a)(122,h).Kvf());r||(r=h.getBounds());return r}}ww.sHl=2;ww.sQn=60;Object(n.a)(ww,"PasteFloatiePositionProvider",null,[]);class os{constructor(b,h){this.kuc=b;this.uZj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get q3h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get Qdf(){return CommonUIStrings.l_ClipboardCut}get $Of(){return CommonUIStrings.l_ClipboardCut_Mac}get Maf(){return CommonUIStrings.l_ClipboardCopy}get ZOf(){return CommonUIStrings.l_ClipboardCopy_Mac}get iic(){return CommonUIStrings.l_ClipboardPaste}get aPf(){return CommonUIStrings.l_ClipboardPaste_Mac}get j$(){return CommonUIStrings.l_ClipboardPasteText}get bPf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get T8e(){return this.uZj}get NFh(){return CommonUIStrings.l_ClipboardExtensionLink}get mgb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}CZh(){t.ULS.sendTraceTag(8716421,
307,50,null);Qd.a.vm(this.T8e,"_blank",void 0,"ClipboardAccessExtensionLink")}fea(b,h){let r=ba.a.el;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=ba.a.vi||r);return r?String.format(h,"\u2318"):b}dispose(){this.kuc=null}Y5f(b){this.RKh(b)}o1m(b){this.RKh(b)}RKh(b){this.kuc&&this.kuc(b)}}os.id="CopyPasteShortcutDialog";os.qzj="CopyPasteText";Object(n.a)(os,"ACopyPasteShortcutDialog",null,[10]);class CC extends os{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=os.qzj;var B=document.createElement("span");B.innerText=this.q3h;var P=document.createElement("span");P.className="UIFontBold";P.innerText=this.fea(this.Qdf,this.$Of);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.fea(this.Maf,this.ZOf);const ra=document.createElement("span");ra.className="UIFontBold";ra.innerText=this.fea(this.iic,this.aPf);h.appendChild(B);h.appendChild(document.createElement("br"));
h.appendChild(P);h.appendChild(ca);h.appendChild(ra);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.Er||ba.a.Dj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.fea(this.j$,this.bPf),h.appendChild(r));b.appendChild(h);this.T8e?(t.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.NFh,De.a.addHandler(h,"click",Object(z.a)(this,this.CZh,"extensionLinkHandler")),r.appendChild(h),P=this.mgb.indexOf("{0}"),
-1!==P&&(B=this.mgb.substring(0,P),P=this.mgb.substring(P+3,this.mgb.length),B=document.createTextNode(B),P=document.createTextNode(P),r.insertBefore(B,h),r.appendChild(P)),b.appendChild(document.createElement("br")),b.appendChild(r)):t.ULS.sendTraceTag(8716422,307,50,null);r=new Wh.StandardDialog;r.Cd=0;r.zg=os.id;r.sv(this.titleText,null,0,Object(z.a)(this,this.o1m,"legacyCopyPasteShortcutDialogHandler"),b);r.M5(os.qzj)}}Object(n.a)(CC,"CopyPasteShortcutDialog",os,[]);class xw extends os{constructor(b,
h){super(b,h);h={};b=this.TFm;h.extensionStartText=this.EAl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.Wro;h.cutText=this.fea(this.Qdf,this.$Of);h.copyText=this.fea(this.Maf,this.ZOf);h.pasteText=this.fea(this.iic,this.aPf);4!==v.AFrameworkApplication.ta.Kb.xk&&(h.pasteTextOnly=this.fea(this.j$,this.bPf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Pf.a(!1,!1,!0);r.zg="CopyPasteInstallDialog";r.Cd=0;r.ye(1,this.SFm);r.FV(1);r.Uh(b,Object(z.a)(this,
this.Y5f,"reactCopyPasteShortcutDialogHandler"),h)}get Wro(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get SFm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get TFm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get EAl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static ewo(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(n.a)(xw,"ReactCopyPasteInstallDialog",os,[]);class DC extends os{constructor(b){super(b,null);this.gHi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.Thn;var r="";let B="";this.messageText&&(r=this.messageText.split(" {")[0],B=this.messageText.split("} ")[1]);h.startText=r;h.endText=B;h.cutText=this.iil;h.copyText=this.B8k;h.pasteText=this.uCn;
h.cutShortcutText=this.fea(this.jil,this.n$m);h.copyShortcutText=this.fea(this.L8k,this.m$m);h.pasteShortcutText=this.fea(this.xCn,this.p$m);h.imageSrc=Jd.a.Sba("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.tIn;this.gHi&&(t.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.xmb,["onExecute"]:()=>{this.i1m()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Pf.a(!1,!1,!0);r.Cd=0;r.zg="CopyPasteNoClipboardAccessDialog";r.Uh(b,Object(z.a)(this,this.Y5f,"reactCopyPasteShortcutDialogHandler"),h)}get Thn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get xmb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get tIn(){return CommonUIStrings.l_DialogOk}get iil(){return CommonUIStrings.l_CutString}get jil(){return CommonUIStrings.l_CutShortcut}get n$m(){return CommonUIStrings.l_CutShortcut_Mac}get B8k(){return CommonUIStrings.l_CopyString}get L8k(){return CommonUIStrings.l_CopyShortcut}get m$m(){return CommonUIStrings.l_CopyShortcut_Mac}get uCn(){return CommonUIStrings.l_PasteString}get xCn(){return CommonUIStrings.l_PasteShortcut}get p$m(){return CommonUIStrings.l_PasteShortcut_Mac}i1m(){t.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Qd.a.vm(this.gHi,"_blank",void 0,"learnMoreLink")}}Object(n.a)(DC,"ReactCopyPasteNoClipboardAccessDialog",os,[]);class FB extends os{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.q3h;b.cutText=this.fea(this.Qdf,this.$Of);b.copyText=this.fea(this.Maf,this.ZOf);b.pasteText=this.fea(this.iic,this.aPf);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.Er||ba.a.Dj)&&(b.pasteTextOnly=this.fea(this.j$,this.bPf));this.T8e?(t.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.NFh,["onExecute"]:B=>{this.CZh(B)}},r=this.mgb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.mgb.substring(0,r),b.suggestionSuffixElement=this.mgb.substring(r+3,this.mgb.length))):t.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:os.id,["bodyControls"]:b};b=new Pf.a(!1,!1,!0);b.Cd=0;b.zg=os.id;b.Uh(this.titleText,Object(z.a)(this,this.Y5f,"reactCopyPasteShortcutDialogHandler"),r)}}Object(n.a)(FB,"ReactCopyPasteShortcutDialog",
os,[]);class Ds{constructor(){this.rMa=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF}lbf(b,h,r=!1){t.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.rMa,r));this.rMa?r?new xw(b,h):new FB(b,h,v.AFrameworkApplication.K):new CC(b,h,v.AFrameworkApplication.K)}static get instance(){return Ds._instance||(Ds._instance=new Ds)}}Ds._instance=null;Object(n.a)(Ds,"CopyPasteShortcutDialogFactory",null,[1262]);class My{constructor(b,h,r,B,
P,ca,ra,Qa){this.Pgh=this.W1g=this.wUe=!1;this.Vlk=b;this.ld=h;this.hu=r;this.Vb=B;this.Be=P;this.fg=ca;this.Se=ra;Qa&&(this.Pgh=Qa.$("ShouldLogExecCommandCopySuccess"))}get mVa(){return this.Vlk}get M4a(){return this.W1g}set M4a(b){this.W1g=b;this.fg.PAf=b}GNc(b){this.mVa.GNc(b);b||this.Wbd(!0)}get Jxl(){return this.mVa.Y$f}VNb(b){this.M4a=!0;this.mVa.VNb(b,this.Hlg)}reset(){this.M4a=!1}paste(){var b=null;let h=null;if(!this.mVa.KTb){(b=this.ld.yd)&&this.Vb.mg(b.uJ);var r=this.hu.ju;if(!r.ue||!r.we.Zj)return null;
h=r.we;b=this.Be.vw();this.M4a=!0;r.O9a()}r=null;try{h&&h.dHn(),r=b=this.mVa.VNc(this.Hlg,b)}catch(B){t.ULS.shipAssertTag(6305672,307,!1),this.pmi()}this.M4a=!1;return r}copy(){var b=this.ld.yd;b&&this.Vb.mg(b.uJ);b=this.hu.ju;if(!b.ue||1!==b.we.mode)return!1;this.M4a=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");xa.Health.instance.recordKpiUsage(bo.a.H4b,0,bo.a.TFd,r);const B=this.mVa.Wjf(this.Hlg);h=!0;this.Pgh&&t.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
B,this.Se.rG);if(!B){const P=Object.assign(new sb.a,{extendedProperties:r});xa.Health.instance.recordKpiFailure(bo.a.H4b,bo.a.v7e,!0,!0,P)}}catch(r){t.ULS.shipAssertTag(6305673,307,ba.a.Dj),t.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",ba.a.rG),h=!1}this.M4a=!1;return h?!0:!1}Wbd(){if(this.wUe)return!0;var b=this.hu.ju;if(!b.ue||!b.we.Zj)return!1;const h=b.we;b=this.Be.vw();this.M4a=!0;const r=new av.a(b);let B=!1;try{B=this.mVa.Wbd(b,()=>{h.NGd()},
()=>{h.MIa()})}catch(P){}r.restore();this.M4a=!1;B?this.wUe=!0:(t.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",ba.a.rG),this.pmi());return B}pmi(){this.wUe=!1;if(v.AFrameworkApplication.A4o)Ds.instance.lbf(null,null);else{const b=new Wh.StandardDialog;b.Cd=0;b.IV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get Hlg(){const b=this.Be.ijb();return b?b.Yn:null}}Object(n.a)(My,"SystemClipboard",null,
[518]);class ev{constructor(b,h,r){this.AAd=!1;this.$Ad=this.vT=this.P4g=this.ywe=this.xid=null;this.HFn=B=>{1===B?(t.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.mwe)),this.R1b&&(t.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.R1b)),Qd.a.vm(this.dDe+this.tMe,"_blank",void 0,"ChromeCCPInstallDialog"))):B||t.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.mwe))};this.mwe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.dDe=b.kb("ChromeClipboardAccessExtensionLink");this.ibb=h;this.lk=r;this.tMe=b.kb("ChromeClipboardAccessExtensionId");this.Dok=b.$("UseGetClipboardDataIsEnabled");this.bdh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.R1b=!1;b.$("CcpInstallDialogIsEnabled")&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF&&(this.R1b=xw.ewo()||b.$("IgnoreDomainCheckCcpInstallDialog"),t.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.R1b));this.mvc=null}GNc(b){b?this.vT=!0:(this.vT=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.mvc=this.ibb.uKd,this.ibb.VQb?(this.AAd=this.Dok,this.SDh()):(this.AAd=!0,this.SDh(),t.ULS.sendTraceTag(19256732,307,50,U.a.create().toString()))):(this.mRb(),this.vT=!1))}get Y$f(){return this.vT}get KTb(){return this.$Ad}Wbd(){return!0}Wjf(b){t.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Qd.a.OEb(b,"copy"))||t.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}qpf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const B=this.lk.Rij(!!h,!!r,b);let P=null;if(3===B){if(!b)return null;h=this.lk.LZh(b);(h=this.lk.SZh(h))&&(b+=h);P=this.lk.Cob(b)}else 2===B?P=this.lk.u0f(r,!0):1===B&&(P=this.lk.Cob(h));return P}VNc(b,h){if(this.KTb)h=this.qpf(this.ywe),this.ywe=null;else{if(!this.xid)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.xid;h=b.body;this.xid=null}return h}VNb(b){const h=U.a.create();this.P4g=
h;this.ibb.VQb?t.ULS.sendTraceTag(7377737,307,50,h.toString()):t.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.KTb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.mvc,r,B=>{h.equals(this.P4g)?this.KTb?this.ywe=B:this.xid=B:t.ULS.sendTraceTag(7385868,307,50,null);t.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.Htl(),this.ibb.VQb?t.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):t.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}mRb(){t.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.R1b?b=this.dDe+this.tMe:this.mwe&&(b=this.dDe+this.mvc);Ds.instance.lbf(this.HFn,b,this.R1b)}Htl(){this.ibb.R6n();this.mRb()}gkj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}QVk(){const b=U.a.create();this.ibb.VQb?t.ULS.sendTraceTag(592491466,307,50,b.toString()):t.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.mvc,{command:"getAvailableCommands"},
h=>{t.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(uc.a)(Array,h)?(t.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.$Ad=-1!==Array.indexOf(h,"getClipboardData")):(t.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.$Ad=!1):(t.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.$Ad=!1)})}SDh(){const b=U.a.create();this.ibb.VQb?t.ULS.sendTraceTag(7726105,
307,50,b.toString()):t.ULS.sendTraceTag(591984032,307,50,b.toString());this.AAd&&this.QVk();this.gkj(this.mvc,h=>{t.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.vT=!0:(h?"ping"!==h&&t.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):t.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.mRb(),this.vT=!1);this.AAd&&!this.KTb&&t.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}fLi(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;t.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.bdh&&(b&&xa.Health.instance.recordKpiSuccess(ev.y9g,null),h&&xa.Health.instance.recordKpiSuccess(ev.v9g,null))}J5m(){this.bdh&&(xa.Health.instance.recordKpiUsage(ev.y9g,1,ev.bVg,null),xa.Health.instance.recordKpiUsage(ev.v9g,
1,ev.bVg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.ibb.VQb;this.gkj(this.tMe,h=>{this.fLi(b,!!h)})}else this.fLi(!1,!1)}}ev.y9g="OfficeOnlineExtensionInstallationStatus";ev.v9g="OfficeClipboardExtensionInstallationStatus";ev.bVg="wwccp";Object(n.a)(ev,"ChromeSystemClipboardAccessManager",null,[541]);class GB{constructor(b,h){this.vT=null;this.Se=b;this.Ca=h;this.OXj=!this.Ca.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ca.$("BlockCopyCutOnFirefoxIsEnabled");this.tjk=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}GNc(b){this.OXj&&b&&this.Se.Dj?(this.mRb(),this.vT=!1):this.vT=!0}get Y$f(){return this.vT}get KTb(){return!1}Wjf(b){return Qd.a.OEb(b,"copy")}VNc(b,h){Qd.a.OEb(b,"paste");return h}VNb(b){b()}Wbd(b,h,r){if(this.Se.Q4)return this.tjk&&(this.vT=!1),!1;h();r();b=this.VNc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=Lb.a.create().toString();r();b=this.VNc(b.ownerDocument,b);return this.vT=b=h===b.innerHTML}mRb(){Ds.instance.lbf(null,null)}}
Object(n.a)(GB,"DefaultSystemClipboardAccessManager",null,[541]);class Ut{constructor(b,h,r){this.vT=this.Iaa=this.e_b=this.hma=this.VYa=this.nid=null;this.lk=h;this.eZa=r;this.obk=b.nc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Yjk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}GNc(b){this.Yjk&&b&&(this.vT=!0)}get Y$f(){return this.vT}get KTb(){return!1}Wjf(b){return b?Qd.a.OEb(b,Xc.a.copy):!1}VNc(b,h){this.VYa&&(h=this.VYa,this.VYa=
null);return h}VNb(b,h=null){if(b&&h){this.nid=b;this.e_b=h;$addHandler(this.e_b,Xc.a.paste,Object(z.a)(this,this.wXi,"onPasteEvent"));this.Iaa=this.hma=null;if(this.wDj(this.e_b)){if(this.Iaa&&0<this.Iaa.length&&(!this.hma||this.lk.hpe(this.hma))){this.eZa.hKh(this.Iaa,Object(z.a)(this,this.gqn,"onImageConverted"));this.VYa&&!this.VYa.hasChildNodes()&&t.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.hma&&this.hma.innerHTML&&((this.VYa=this.Upi(this.hma.innerHTML))&&
!this.VYa.hasChildNodes()&&t.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Kb.a.MD(this.hma))}this.b1h()}else b&&b()}Wbd(b){return this.vT=b=this.wDj(b.ownerDocument)}wXi(b){try{b&&b.rawEvent&&((this.hma=b.rawEvent.target)&&this.hma.id&&-1<this.hma.id.indexOf("Paste")?(t.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.hma.id),this.hma=null):this.Iaa=this.T0l(b.rawEvent))}catch(h){t.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}gqn(b){b&&(this.eZa.lrj&&(b=String.format('<img src="{0}">',b)),this.VYa=this.Upi(b));this.b1h()}b1h(){this.e_b&&($removeHandler(this.e_b,Xc.a.paste,Object(z.a)(this,this.wXi,"onPasteEvent")),this.e_b=null);this.nid&&(this.nid(),this.nid=null)}T0l(b){let h=null;(b=this.lk.n7h(b))&&({TAf:h}=this.lk.YCj(b,this.obk,this.eZa.kOi));return h}wDj(b){return Qd.a.OEb(b,Xc.a.paste)}Upi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}mRb(){}}Object(n.a)(Ut,
"EdgeSystemClipboardAccessManager",null,[541]);class Ny{constructor(b,h,r,B){this.Ca=b;this.jZj=h;this.lk=r;this.Se=B}create(){let b=null;v.AFrameworkApplication.fhg()&&this.Se.Er&&window.chrome?(t.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new ev(this.Ca,this.jZj,this.lk),this.Ca.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.J5m()):this.Ca.$("EdgeContextMenuPasteFixIsEnabled")&&this.Se.Nt?(t.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new Ut(this.Ca,Ya.a.instance.resolve("Box4.IClipboardDataHelper"),Ya.a.instance.resolve("Box4.IProcessImageStrategy"),Ya.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(t.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new GB(this.Se,this.Ca));return b}}Object(n.a)(Ny,"SystemClipboardAccessManagerFactory",null,[517]);class Oy{mzl(b){return b}}Object(n.a)(Oy,"DeleteTableSegmentStrategy",null,[516]);var Py=c(447),Tr=c(1056);class up{get qq(){return uu.a.TGb}get Sk(){return null!=
this.$Fg?this.$Fg:this.$Fg=Ya.a.instance.resolve("Box4.IParagraphEditor")}get p1(){return this.Sk.qq}get Ic(){return Ih.a.instance}get SA(){return null!=this.kGg?this.kGg:this.kGg=Ya.a.instance.resolve("Box4.IParagraphIndentationReader")}WGc(b,h,r,B,P,ca,ra){let Qa=2;if(!b.ue)return 2;const mb=b.mb;if(!mb)return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.Fda}),8;if(v.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.WBh(h===Mb.a.bH,r,!0);if(1===B)return b?32:8;b&&(Qa=Tr.a.mic(h,r,B,
P,ca,ra))}else Qa=Tr.a.mic(h,r,1,P,ca,ra),1!==B&&32===Qa?(b.mb.O8d(),b=new sg.GraphTransaction(15),b.Db(r.view.ed),Qa=this.WBh(h===Mb.a.bH,r,!1)?Tr.a.mic(h,r,B,P,ca,ra):8,b.dispose()):1!==B&&8===Qa&&(b.mb.O8d(),this.R3k(h,r,mb));return Qa}WBh(b,h,r){h=h.view.mb;if(!h||!h.ib.lb)return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.gMb}),!1;if(h.ib.MJ)return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.P$e}),!1;h=Py.OutlineElementGeneralizer.Cha(h.ib,!1);if(!h)return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.kOd}),!1;let B=
!1;for(let P=0;P<h.length;P++){const ca=h.getContext(P),ra=new xd.GraphIterator;ra.set(ca.node);Pd.SelectionEditor.Bu(ra);if(!Zf.OutlineElementReader.yh(ra))if(r)continue;else return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.oEb}),!1;if(b?!this.qq.jCb(ra):!this.qq.s4b(ra))if(r)continue;else return this.Ic.Yb(te.a.l7b,{["Reason"]:fe.a.n7e}),!1;B=!0}return r?B:!0}R3k(b,h,r){const B=new sg.GraphTransaction(15);try{B.Db(h.view.ed);h=!0;const P=Py.OutlineElementGeneralizer.Cha(r.ib,!1);for(let ca=0;ca<P.length;ca++){const ra=
P.getContext(ca),Qa=new xd.GraphIterator;Qa.set(ra.node);Pd.SelectionEditor.Bu(Qa);if(!Zf.OutlineElementReader.yh(Qa))h=!1;else if(b===Mb.a.bH?this.qq.jCb(Qa):this.qq.s4b(Qa))switch(h=!1,b){case Mb.a.bH:this.qq.zTa(Qa,-1,0);break;case Mb.a.JO:this.qq.TLc(Qa,1)}}if(h){const ca=r.ib.lb;for(r=0;r<ca.length;r++){const ra=ca.J(r);if(ra.al){const Qa=this.SA.sjb(ra.node),mb=Qa.vea;if(b===Mb.a.bH?Qa.OB>mb:Qa.OB<18*mb){const Jb=new xd.GraphIterator;Jb.set(ra.node);this.p1.Kza(Jb,1,b===Mb.a.bH?Qa.OB>=2.5*mb?
Qa.OB-2*mb:mb:Qa.OB<16*mb?Qa.OB+2*mb:18*mb)}}}}}finally{B&&B.dispose()}}}Object(n.a)(up,"IndentationActorExtension",null,[515]);var fv=c(758),Oz=c(1236);class EC{constructor(b,h){this.lo=new wc.DictionaryPropertySet;this.Nud=new wc.DictionaryPropertySet;this.rwb=!1;this.qCa=this.Ptb=null;this.f7=b;this.DWg=h}get vrb(){return null!=this.pIg?this.pIg:this.pIg=Ya.a.instance.Oa("Box4.ITextFormattingCommands")}get rn(){return null!=this.NAg?this.NAg:this.NAg=Ya.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=
this.wKg?this.wKg:this.wKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}y7a(){this.rwb||(0<this.pRa.cL()&&(this.Nud=this.lo.clone()),this.lo.$7f(),this.Ptb=null,this.x0n())}K8k(b){var h;const r=null!==(h=Bn.FormattingReader.Xr(b))&&void 0!==h?h:Bn.FormattingReader.gSd(b.node,b.cpBegin,-1);!r.cache.UB&&(b=r.Jn)&&(h=new wc.DictionaryPropertySet,h.ax(b),h.ax(this.lo),h.hasProperty(xe.a.qw)&&(this.Ptb=r.paragraph.Mc),this.lo=h)}hasProperty(b){return this.lo.hasProperty(b)}vTc(){return 0<this.lo.cL()}get pRa(){return this.lo}freeze(){this.rwb=
!0}BJa(){this.rwb=!1}MG(b,h){return this.pRa.ja(b,h)}WA(b){this.lo.setValue(Pe.a.fontSize,this.rn.u5b(b));this.I1();wm.a.D6f(this.Nud,this.lo)}fontSize(){return this.lo.ja(Pe.a.fontSize,wm.a.HM)}dhe(b){this.lo.setValue(Pe.a.font,b);this.DWg&&this.DWg.execute(h=>{null==h?t.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.dhe(this.lo)});this.f7&&this.f7.enabled&&(Rc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.f7.Pjo(this.lo,
b));this.I1();wm.a.D6f(this.Nud,this.lo)}hfg(b){this.lo.setValue(Oc.a.Ie,b);this.f7&&this.f7.enabled&&(Rc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.f7.qpo(this.lo,b));this.I1()}Xv(b){b=Il.a.instance.pva(lh.a.instance.ib.lb.Pa.node,b);this.lo.setValue(Pe.a.fontColor,b);this.I1();wm.a.D6f(this.Nud,this.lo)}Mga(){this.lo.setValue(Pe.a.fontColor,$f.a.auto);this.I1()}fontColor(){return this.lo.ja(Pe.a.fontColor,$f.a.nil)}Iza(b){this.lo.setValue(Pe.a.highlight,parseInt(b,
16));this.I1()}FGd(){this.lo.setValue(Pe.a.highlight,$f.a.auto);this.I1()}isBold(){return this.lo.ja(Pe.a.bold,!1)}IL(b){this.lo.setValue(Pe.a.bold,b);this.I1()}isItalic(){return this.lo.ja(Pe.a.italic,!1)}fz(b){this.lo.setValue(Pe.a.italic,b);this.I1()}isUnderline(){return this.lo.ja(Pe.a.underline,!1)}R5(b){this.lo.setValue(Pe.a.underline,b);this.lo.setValue(Pe.a.underlineType,b?wm.a.KSb:wm.a.TV);this.I1()}underlineType(){return this.lo.ja(Pe.a.underlineType,wm.a.TV)}hka(b){b<wm.a.KSb||b>wm.a.TV||
(this.lo.setValue(Pe.a.underline,b!==wm.a.TV),this.lo.setValue(Pe.a.underlineType,b),this.I1())}isSuperscript(){return this.lo.ja(Pe.a.superscript,!1)}xra(b){this.lo.setValue(Pe.a.superscript,b);b&&this.isSuperscript()&&this.lo.setValue(Pe.a.subscript,!1);this.I1()}isSubscript(){return this.lo.ja(Pe.a.subscript,!1)}YIa(b){this.lo.setValue(Pe.a.subscript,b);b&&this.isSubscript()&&this.lo.setValue(Pe.a.superscript,!1);this.I1()}isStrikethrough(){return this.lo.ja(Pe.a.strikethrough,!1)}fka(b){this.lo.setValue(Pe.a.strikethrough,
b);this.I1()}isDoubleStrikethrough(){return this.lo.ja(xe.a.Ht,!1)}Yge(b){this.lo.setValue(xe.a.Ht,b);this.I1()}T6h(){return this.lo.ja(xe.a.qw,null)}l8a(b,h){this.lo.$7f();this.lo.setValue(xe.a.qw,b.id);this.Ptb=h.Mc;this.I1()}O5(b){let h=Pe.a.vL;const r=fv.a.O2d(b);switch(r){case 1:h=Oc.a.Rec;break;case 2:h=Oc.a.Sec}this.lo.setValue(Oc.a.o5a,r);this.lo.setValue(h,b);this.I1()}language(){let b=Pe.a.vL;switch(this.lo.ja(Oc.a.o5a,0)){case 1:b=Oc.a.Rec;break;case 2:b=Oc.a.Sec}return this.lo.ja(b,0)}fmo(b){this.lo.setValue(Oc.a.noProof,
b);this.I1()}HJb(){return this.lo.ja(Oc.a.noProof,!1)}ERm(){return this.lo.hasProperty(Oc.a.noProof)}kQm(){return this.lo.hasProperty(Pe.a.vL)||this.lo.hasProperty(Oc.a.Rec)||this.lo.hasProperty(Oc.a.Sec)}I1(){if(ba.a.anc){var b=lh.a.instance.ib.lb.Pa,h=b.node;if(h===this.qCa)this.qCa.nl(16,!0);else{this.qCa=h;h=this.qCa.uZ();try{this.qCa.WX(b.cpBegin).Kxa=!0}finally{h&&h.dispose()}}}}x0n(){if(ba.a.anc&&this.qCa){var b=0,h=this.qCa.uZ();try{for(let r=this.qCa.ra.length-1;0<=r;r--){const B=this.qCa.ra.J(r);
B.Kxa&&(B.Kxa=!1,b++,B.isEmpty&&this.qCa.ra.removeAt(r))}}finally{h&&h.dispose()}this.qCa=null}}J6k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.ra.nh(b.cpBegin);return!!b&&b.Kxa}E2e(b){if(this.vrb){this.freeze();var h=new sg.GraphTransaction(7);h.Db(b.node);this.vrb.fhe(b);this.BJa();this.y7a();h.dispose()}}Uuf(b){const h=Td.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!E.a.Pv(h.charCodeAt(b.cpBegin))&&Oz.a.instance.L2a(h,b.cpBegin-1)!==b.cpBegin&&Pd.SelectionEditor.Vlb(b)?
(b=Pd.SelectionEditor.j0(b,!1))?1<b.length||Pd.SelectionEditor.vl(b.Pa)?b:null:null:null}}Object(n.a)(EC,"InsertionPointFormatting",null,[514]);class kx{constructor(b){this.ga=b}get oc(){return this.ga}dQk(b,h,r=null){const B=new wc.DictionaryPropertySet;B.setValue(Zc.a.MA,b);B.setValue(Zc.a.qSa,h);r&&B.ax(r);B.CommandSource="autobulleting";this.oc.Qb(Mb.a.qD,2,B)}kkn(b,h,r,B,P){const ca=new wc.DictionaryPropertySet;ca.setValue(Zc.a.MA,b);ca.setValue(Zc.a.qSa,h);ca.setValue(Zc.a.y5a,r);P&&ca.setValue(Ng.a.MQ,
P);B&&ca.setValue(Oc.a.Ot,B);oj.a.GY&&(ca.setValue(Ng.a.eqa,"autocorrect"),P&&ca.setValue(Ng.a.Mia,P));ca.CommandSource="autonumbering";return 32===this.oc.Qb(Mb.a.ML,2,ca)}}Object(n.a)(kx,"ListCommands",null,[513]);var Lv=c(299);class Qy extends Lv.a{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){super();this.v_b=this.kn=this.hLa=null;this.qJn=(fc,Mc)=>{Mc=this.Qta.Zae(this.hLa,Mc);fc.ri(this.zKl);return Mc};this.zKl=(fc,Mc)=>{if(this.kn.moveNext())return fc=this.kn.currentNode,12!==fc.type||fc===this.hLa.node?
!0:this.Qta.Q4c(fc,Mc);this.uPk();fc.ri(this.BKl);return!0};this.BKl=(fc,Mc)=>{if(this.kn.moveNext()){const Wc=this.kn.currentNode;return 12!==Wc.type?!0:Wc===this.hLa.node?(fc.ri(this.rJn),!0):this.Qta.Q4c(Wc,Mc)}return!1};this.rJn=(fc,Mc)=>{this.Qta.$ae(this.hLa,Mc);return!1};this.init(b);this.Rl(Yb);this.Jkb(Qa,h,B,P,ca);this.YL=ca;this._context=r;this.hb=mb;this.Fe=Jb;this.Qta=ra;this.oz=0}run(){this.$7e();this.oz||this.ero();1===this.oz&&this.xKn();2===this.oz&&this.tJo();3===this.oz&&this.WFl()}$7e(){this.hb.ib&&
this.hb.ib.lb?1===this.behavior&&(this.Qta.$7e(this._context)?this.sr=32:this.sr=2,this.oz=3):(t.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.sr=2,this.oz=3)}ero(){this.ZOk();this.Qta.Lfg(this.hLa)?(this.rOk(),this.oz=1):(this.sr=8,this.oz=3)}xKn(){this.JC||new yv.a(this,this.qJn,this.YL);do if(this.JC.run(),this.JC.inProgress&&!this.Qh)return;while(this.JC.inProgress);this.BGd();this.oz=2}tJo(){this.Qta.Slg(this)?this.sr=32:this.sr=8;this.oz=3}WFl(){this.vra()}ZOk(){let b=
this.hb.ib.lb;if(b=this.Fe.Jj(b,!0,!1))this.hLa=b.Pa;this.hLa&&this.hLa.node&&(this.v_b=this.Qta.Nfi(this.hLa.node))}rOk(){if(!this.v_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new al.a;b.set(this.hLa.node);b.zb(this.v_b.type);this.kn=ao.a.Gs(b,this.v_b);this.kn.xo(Object(z.a)(this.Qta,this.Qta.Bmc,"spellErrorFilter"),null)}uPk(){if(!this.v_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new al.a;b.set(this.v_b);this.kn=ao.a.Qp(b);this.kn.xo(Object(z.a)(this.Qta,
this.Qta.Bmc,"spellErrorFilter"),null)}}Object(n.a)(Qy,"ProofingWholeDocumentOperation",Lv.a,[]);var $x=c(280);class Gr extends Gn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(n.a)(Gr,"ContextMenuRootProperties",Gn,[]);var GA=c(1385);class HB{constructor(b){const h=new Gr;h.ImageSideArrow=v.AFrameworkApplication.Ms;h.ImageSideArrowClass=ie.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=
Mb.a.xae.toString();this.zjh=new GA.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.Y1.IF=r});this.Y1.refresh();v.AFrameworkApplication.va.qa(eb.a.showContextMenu,Gd.a.frame,nd.ActionManager.Nf);v.AFrameworkApplication.va.qa(eb.a.dmc,Gd.a.frame,nd.ActionManager.Nf)}get Y1(){return this.zjh}dispose(){this.Y1&&(this.Y1.dispose(),this.zjh=null)}showContextMenu(b,h){this.Eqb(b,h.clientPoint,h.kg)}S5b(b,h,r,B,P){this.Y1.S5b(b,h,r,B,P)}r8a(b,h,r){Qd.a.T4d(this.Y1.z_a?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");ab.StaticActiveAppFrame.za().tJl();this.yu();this.Y1.r8a(b,h,r);this.Y1.z_a?v.AFrameworkApplication.va.processAction(eb.a.dmc,2):v.AFrameworkApplication.va.processAction(eb.a.showContextMenu,2)}Eqb(b,h,r){this.r8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}yu(){this.Y1.root.Gm()}q4(){return this.Y1.q4()}dmc(b,h,r,B){const P=this.Y1;let ca=!1;r=Object(Na.a)(St,r);P.z_a=r;B.Oza(b,h);P.AZe?r&&(r.OFn(P,h),ca=!0):(t.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
B.Khl()),P.z_a=null);return ca}}Object(n.a)(HB,"AContextMenuController",null,[540,10]);class ps{}ps.Oic="faProofing";ps.aWh="EditorMenuSection";Object(n.a)(ps,"ContextMenuControlId",null,[]);var Mv=c(536);class hi{constructor(b){this.Fe=b}$7e(b){b=Object(Na.a)(Mv.a,b);return!!b&&!!b.view&&b.view.ue}Lfg(){return!0}Zae(){return!0}Q4c(){return!0}$ae(){}Slg(){return!0}Bmc(b){if(b.Zr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}Nfi(b){if(!b||!this.Fe)return b;const h=new al.a;h.set(b);if(this.Fe.Bu(h)){for(;!h.Zr;)h.sc();
return h.currentNode}return b}}Object(n.a)(hi,"SimpleProofingWholeDocumentCallBacks",null,[395]);class Nv{constructor(b){this.value=b}}Object(n.a)(Nv,"RefBool",null,[]);class ft{constructor(){this.PNc=this.eMb=null;this.kEj=new Nv(!1)}}Object(n.a)(ft,"FindNextErrorOperationParam",null,[]);class ay{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ay.Cvl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=
0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}ay.Cvl=[];Object(n.a)(ay,"Critique",null,[]);class Pz{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(Pz,"Suggestion",null,[]);var IB=c(609);class En extends Sys.EventArgs{constructor(b,h,r,B,P,ca){super();this.H5j=b;this.N7j=h;this.O7j=r;this.Pse=B;
this.$z=P;this.p$a=ca}}Object(n.a)(En,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var by=c(340);class qs{constructor(b,h,r){this.SAe=b;this.fn=h;this.sa=r}iKh(b){const [h,r,B]=this.ski(b);return this.M9h(h,r,B)}cLm(b){return Bf.a.getTypeNameFor(b.content)===by.a.getTypeName()}M9h(b,h,r){if(r&&this.cLm(r)){if(this.f3b(r.content))return null;const P=r.content;var B=new ay;B.ExplanationTitle=P.explanationTitle;B.Suggestions=this.ygm(r);B.CategoryTitle=P.categoryName;B.TypeId=P.typeId;B.CritiqueActions=
P.critiqueActions;B.Priority=P.priority;r=this.SAe.create(B);B=P.context;r.token=B.substring(P.range.start,P.range.start+P.range.length);r.lcid=Hi.a.ug(P.language).LCID;r.originalText=B;return new IB.a(b,h,r)}return null}ygm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new Pz,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}f3b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}ski(b){const h=this.fn.jRc(b,0),r=b.cpBegin,
B=b.cpEnd,P=Pd.SelectionEditor.Ze(b);b=Td.ParagraphReader.text(b.node,0);for(const ca of h)if(P){if(ca.Bc<=r&&ca.end>=B)return[ca.Bc,ca.end,ca.intent]}else if(ca.Bc<=r&&ca.end>=r&&E.a.oJh(b,ca.end,B))return[ca.Bc,ca.end,ca.intent];return[null,null,null]}static QB(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}zyf(b,h,r){const [B,P,ca]=this.ski(b);ca&&this.sa.raiseEvent(qs.Rwh,new En(b,B,P,h,ca,r))}Rxk(b){this.sa.addHandler(qs.Rwh,
b)}wCl(b,h,r){b=this.fn.j$b(b,0,0,b.characterData.length);for(let B=0;B<b.count;B++){const P=b.J(B);if(P.intent){const ca=P.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&P.Bc>=h&&(!r||r(P.intent)))return this.M9h(P.Bc,P.end,P.intent)}}return null}}qs.Rwh="augloopProofingContextMenuActionEventKey";Object(n.a)(qs,"AugLoopProofingErrorDetailHelper",null,[]);class Ry extends hi{constructor(b,h,r,B){super(h);this.Dn=b;this.uDc=r;this.mXj=B}Zae(b,h){return!this.gNf(b.node,b.cpBegin,
h)}Q4c(b,h){return!this.gNf(b,0,h)}$ae(b,h){this.gNf(b.node,0,h);Object(Na.a)(ft,h)}gNf(b,h,r){r=Object(Na.a)(ft,r);if(Td.ParagraphReader.Xb(b)&&!b.KJ)if(Bn.FormattingReader.Xr(Se.a.Uc(b,h)).cache.HJb)r.kEj.value=!0;else{if(qs.QB())return h=this.mXj.wCl(b,h,this.uDc),null!=h?(r.eMb=h,r.PNc=b,!0):!1;const B=this.Dn.G4(b);for(let P=0;P<B.length;P++){const ca=B[P];if(ca.Bc>=h&&!ca.errorDetails.H4a()&&(!this.uDc||this.uDc(ca.errorDetails)))return r.eMb=ca,r.PNc=b,!0}return!1}}}Object(n.a)(Ry,"FindNextErrorCallbackSteps",
hi,[]);var Eo=c(307);class HA{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id){this.J0k=(ve,$d,be,he,re)=>{$d=this.hb.ib.lb;if(!$d)return this.Ad.Yb(te.a.ef,{["Reason"]:fe.a.noSelection}),2;$d=this.Fe.Jj($d,!0,!1);return this.ga.Mf($d.Pa,ve,be,!1,he,re)};this.Qxn=(ve,$d,be)=>{if(1===be)return this.ga.processAction(Mb.a.O5,1);this.M$j().Mhg();return 32};this.GEa=(ve,$d,be)=>{if(1===be)return 32;Me.a.mark(4670);be=this.Dn.Hoa($d);if(this.yne(be))return 8;$d=$d.node;const he=this.Lc.Pc(15);let re=
be.Bc;" "===Td.ParagraphReader.text($d).charAt(re-1)&&re--;he.Db($d);const Xf=this.Md.Ge(Se.a.createTextRange($d,0<be.Bc?be.Bc-1:0,be.end),"",!0,!1);this.hb.Ac(Fe.SelectionFactory.ne($d,Xf+re));he.dispose();be.errorDetails.Jrb(ve);Me.a.mark(4671);return 32};this.nxa=(ve,$d,be)=>{if(1===be)return 32;t.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(qs.QB())return this.G$a.zyf($d,null,Eo.b.IgnoreOnce),32;Me.a.mark(4670);be=this.Dn.Hoa($d);if(this.yne(be))return 8;$d=$d.node;const he=
this.Lc.Pc(15);he.Db($d);this.Dn.ppb($d,[be],!0);$d.setValue(Pe.a.M$e,!0);he.dispose();be.errorDetails.Jrb(ve);Me.a.mark(4671);t.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.U7m(be);this.iZa.sqi(be,$d,!0);return 32};this.Y8k=(ve,$d,be)=>{var he,re=!this.Nk.x9($d);this.en&&this.en.instance&&this.en.instance.TU($d)&&(re=!1);if(1===be||!re)return re?32:8;this.ga.processAction(Mb.a.Nra,2);Me.a.mark(4670);re=this.mUl(ve);if(0>re)return 8;if(qs.QB())return this.G$a.zyf($d,
re,Eo.b.Apply),32;be=this.Dn.Hoa($d);if(this.yne(be))return 8;$d=$d.node;var Xf=be.errorDetails.suggestions;if(!Xf)return this.Ad.Yb(te.a.UEb,{["Reason"]:"NoSuggestionsFound"}),Me.a.mark(4671),8;re=re<Xf.length?Xf[re]:null;if(!re)return this.Ad.Yb(te.a.UEb,{["Reason"]:"RequestedSuggestionIsNull"}),Me.a.mark(4671),8;(null===(he=qe.App.zd)||void 0===he?0:he.Uo)&&qe.App.zd.fq.iG($d);re=re.replace("  "," \u00a0");he=this.Lc.Pc(15);he.Db($d);Xf=this.Md.Ge(Se.a.createTextRange($d,be.Bc,be.end),re,!0,!1,
Mb.a.Nra);this.hb.Ac(Fe.SelectionFactory.ne($d,be.Bc+re.length+Xf));he.dispose();be.errorDetails.Jrb(ve);Me.a.mark(4671);this.t4m(be);return 32};this.neo=(ve,$d)=>{$d=this.Dn.Hoa($d);if(this.yne($d))return 8;$d.errorDetails.Jrb(ve);return 32};this.$El=(ve,$d,be,he,re)=>{if(!$d.view.ue)return 2;const Xf=$d.view;if(!this.hb.ib.lb)return this.Ad.Yb(te.a.ef,{["Reason"]:fe.a.noSelection}),2;if(1===be)return 32;const Mg=new ft,$l=new Ry(this.Dn,this.Fe,this.uDc,this.G$a);$d=new Qy(null,ve,$d,be,he,Mg,$l,
this.ga,this.hb,this.Fe,null);$d.Qh=!0;$d.run();if($d.isCompleted&&Mg.eMb){if($d=Fe.SelectionFactory.ne(Mg.PNc,Mg.eMb.Bc),$d=Fe.SelectionFactory.Iy($d,Se.a.Uc(Mg.PNc,Mg.eMb.end)),!this.xch.instance||!this.xch.instance.MHn(Mg.eMb,$d,Xf)){this.hb.Ac($d);let Nm=0;re&&(Nm=re.Ux);Xf.Mie=!1;Rg.a.instance.Wb(new Oe.a(1,1,1,()=>{this.tco(Xf,Nm,Mg.PNc,Mg.eMb)}))}}else{const Nm=new Wh.StandardDialog;Nm.Cd=0;qe.App.yN.BYc?Nm.lka(CommonUIStrings.l_DefaultDialogTitle,Mg.kEj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:
Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Nm.lka(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),qe.App.yN.kCd(()=>{Nm.Opa&&(Nm.hide(),this.ga.processAction(ve,2))}))}return 32};this.xae=(ve,$d,be)=>{if(1===be)return 32;this.ifa&&this.ifa.Y1&&(ve=this.ifa.Y1.Gwf(ps.Oic))&&!ve.xL&&(ve.U0(0),ve.menu.gL(0));return 32};this.ga=h;this.Dn=b;this.M$j=r;this.Md=B;this.Lc=P;this.hb=ca;this.en=ra;this.Fe=Qa;this.ajk=mb;this.Nk=Jb;this.Ad=Yb;this.G$a=Id;this.ifa=
Object(Na.a)(HB,fc);this.wYb=Mc.aYc;this.xch=Wc;this.iZa=id;this.Gqc=new Map;this.Gqc.set(1,Mb.a.cjg);this.Gqc.set(2,Mb.a.gxf);this.Gqc.set(3,Mb.a.bkg);this.hCc=new Map;this.hCc.set(1,Mb.a.djg);this.hCc.set(2,Mb.a.hxf);this.hCc.set(3,Mb.a.ckg)}Ub(){const b=this.ga,h=this.Y8k,r=this.J0k;b.fb(Mb.a.B9d,zc.a.view,this.Qxn,1028);b.qa(Mb.a.GEa,zc.a.Tc,this.GEa);b.qa(Mb.a.nxa,zc.a.Tc,this.nxa);b.qa(Mb.a.qrb,zc.a.Tc,h);b.qa(Mb.a.rrb,zc.a.Tc,h);b.qa(Mb.a.srb,zc.a.Tc,h);b.qa(Mb.a.ZRb,zc.a.Tc,h);b.qa(Mb.a.$Rb,
zc.a.Tc,h);b.qa(Mb.a.GEa,zc.a.view,r);b.qa(Mb.a.nxa,zc.a.view,r);b.qa(Mb.a.qrb,zc.a.view,r);b.qa(Mb.a.rrb,zc.a.view,r);b.qa(Mb.a.srb,zc.a.view,r);b.qa(Mb.a.ZRb,zc.a.view,r);b.qa(Mb.a.$Rb,zc.a.view,r);b.Xc(Mb.a.GEa,1028);b.Xc(Mb.a.nxa,1028);b.Xc(Mb.a.qrb,1028);b.Xc(Mb.a.rrb,1028);b.Xc(Mb.a.srb,1028);b.Xc(Mb.a.ZRb,1028);b.Xc(Mb.a.$Rb,1028);b.qa(Mb.a.Nra,Gd.a.frame,nd.ActionManager.Nf);this.wYb&&b.fb(Mb.a.xae,zc.a.view,this.xae,1124);b.fb(Mb.a.y1c,zc.a.view,this.$El,1028);b.fb(Mb.a.e4f,zc.a.Fd,this.neo,
1124);this.wXn([Mb.a.kke,Mb.a.cjg,Mb.a.djg,Mb.a.OVd,Mb.a.gxf,Mb.a.hxf,Mb.a.Nke,Mb.a.bkg,Mb.a.ckg,Mb.a.D5i,Mb.a.YQi,Mb.a.dvj])}wXn(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],zc.a.view,nd.ActionManager.gR,1028)}LYn(b){this.uDc=b}yne(b){return b?b.errorDetails?!1:(t.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.Ad.Yb(te.a.UEb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Me.a.mark(4671),!0):(t.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.Ad.Yb(te.a.UEb,{["Reason"]:"RequestedErrorRangeNotFound"}),Me.a.mark(4671),!0)}U7m(b){b=b.errorDetails.proofingType;if(this.hCc.has(b)){const h=this.hCc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}mUl(b){switch(b){case Mb.a.qrb:return 0;case Mb.a.rrb:return 1;case Mb.a.srb:return 2;case Mb.a.ZRb:return 3;case Mb.a.$Rb:return 4;default:return-1}}t4m(b){b=b.errorDetails.proofingType;if(this.Gqc.has(b)){const h=
this.Gqc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}tco(b,h,r,B){b.D1();(b=r.qe(b.$b))?(B=$x.a.Vq(b,v.AFrameworkApplication.isRtl?B.Bc:B.end),this.ajk.Oza(new Sys.UI.Point(B.x,B.y+B.height),h)):t.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(n.a)(HA,"ProofingActor",null,[]);var Bj=c(409),Ur=c(1584),FC=c(1874),gv=c(544);class Vr{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.Smc=
null;this.zHl="StyleUsageActivity";this.AHl="StylesFloodgateSurveyIsEnabled";this.nOa=(fc,Mc,Wc,id)=>{fc=this.Zfm(fc);return 0>fc||fc>this.Smc.length?2:(fc=this.Smc[fc])?v.AFrameworkApplication.va.Mf(Mc,Mb.a.LQ,Wc,!0,id,fc):2};this.LNb=(fc,Mc,Wc,id,Id)=>{fc=!0;Mc.contextId!==zc.a.paragraph&&Mc.contextId!==zc.a.Fd&&Mc.contextId!==zc.a.Tc&&(fc=!1);if(1===Wc||!fc)return fc?32:8;if(2===Wc&&!Id)return 8;Mc=this.qc.ZC(Mc.node);Id.MenuItems=Bj.a.Q5l(Mc);return 32};this.CNn=(fc,Mc,Wc,id,Id)=>{fc=!0;Mc.contextId!==
zc.a.paragraph&&(fc=!1);if(1===Wc&&!fc)return 8;Mc=Mc.node;Wc=this.qc.hp(Mc);if(!Wc||!Id)return t.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Id,Mc,Wc),8;Id.dVa.ax(Wc.Gl());return 32};this.yGk=(fc,Mc,Wc,id,Id)=>{if(Mc.contextId!==zc.a.paragraph)return 8;if(this.Xf.U4a(Mc,!1))return this.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),8;if(1===Wc)return 32;const ve=Mc.node;if(Td.ParagraphReader.wva(ve)||!Id)return 8;const $d=this.uvf(Id,ve);if(!$d)return this.Ic.Yb(te.a.f2,
{["Reason"]:fe.a.VEb}),8;if(2!==this.qc.NG($d))return 2;Wc=new sg.GraphTransaction(15);this.io&&this.io.B9&&this.XH.nmc(Id);Wc.Db(ve);this.Cj.y7a();const be=[];fc!=Mb.a.KC&&be.push(Nd.a.$Va);this.d6.cK($d,ve,!1,void 0,void 0,void 0,new FC.a(be,!1,!0));(fc=this.qc.ZC(ve))&&this.qc.le($d,fc)&&Rc.b(593078098,3017,50,"Custom linked style applied by user");ve.Fr&&(fc=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})],ne.a("TOCFormatting",!0,void 0,fc));Wc.dispose();Id=E.a.PQ(Id);id.Hs=Id>>>
16^Id&65535;id&&Ur.a.trb&&(id.NC|=Ur.a.cjb(Mc.node));return 32};this.DNn=(fc,Mc,Wc,id,Id)=>{fc=!0;Mc.contextId!==zc.a.Fd&&(fc=!1);if(1===Wc&&!fc)return 2;Mc=Bn.FormattingReader.Xr(Mc);Mc=Bn.FormattingReader.Zwa(Mc);if(!Mc)return 2;if(!Id)return 8;Id.dVa.ax(Mc.Gl());return 32};this.zGk=(fc,Mc,Wc,id,Id)=>{if(Mc.contextId!==zc.a.Fd)return 8;this.Xf.U4a(Mc);if(1===Wc)return 32;fc=Mc;wn.a.vId&&(Mc=this.Lo.YTd(fc))&&(fc=Mc);Mc=fc.node;if(!Id)return 8;const ve=this.uvf(Id,fc.node);if(!ve)return this.Ic.Yb(te.a.f2,
{["Reason"]:fe.a.VEb}),8;if(1!==this.qc.NG(ve))return 2;Wc=this.qc.ZC(Mc);if(!Wc)return this.Ic.Yb(te.a.f2,{["Reason"]:fe.a.ZZh}),8;if(!Wc.pj(this.qc.Kg(ve)))return this.Ic.Yb(te.a.f2,{["Reason"]:fe.a.VEb}),8;const $d=new sg.GraphTransaction(7);try{if(this.io&&this.io.B9&&this.XH.nmc(Id),$d.Db(Mc),this.d6.Eqg(Mc,Wc),this.Hea.tX(fc,be=>{this.rn.Lga(be);this.rn.l8a(be,ve)}),Mc.Fr){const be=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})];ne.a("TOCFormatting",!0,void 0,be)}}finally{$d&&
$d.dispose()}Wc&&this.qc.le(ve,Wc)&&Rc.b(593078097,3017,50,"Custom linked style applied by user");Id=E.a.PQ(Id);id.Hs=Id>>>16^Id&65535;id&&Ur.a.trb&&(id.NC|=Ur.a.cjb(fc.node));return 32};this.BNn=(fc,Mc,Wc,id,Id)=>{fc=!0;Mc.contextId!==zc.a.Tc&&(fc=!1);if(1===Wc&&!fc)return 2;Mc=this.d6.fgm(Mc);if(!Mc)return 2;if(!Id)return 8;Id.dVa.ax(Mc.Gl());return 32};this.xGk=(fc,Mc,Wc,id,Id)=>{if(Mc.contextId!==zc.a.Tc)return 8;if(this.Xf.U4a(Mc,!1))return this.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),8;if(1===Wc)return 32;
var ve=Mc.node;if(!Id)return 8;Wc=this.uvf(Id,Mc.node);if(!Wc)return this.Ic.Yb(te.a.f2,{["Reason"]:fe.a.VEb}),8;const $d=this.qc.NG(Wc);if(1!==$d&&2!==$d)return 2;(Mc=this.Cj.Uuf(Mc))?(Mc=lh.a.sDb(Mc),fc=v.AFrameworkApplication.va.Mf(Mc,fc,2,!1,id,Id)):(fc=new sg.GraphTransaction(7),this.io&&this.io.B9&&this.XH.nmc(Id),fc.Db(ve),this.d6.Qoo(Wc,ve),fc.dispose(),fc=32);ve.Fr&&(Mc=[Object.assign(new ma.a,{name:"Source",string:"ApplyStyle"})],ne.a("TOCFormatting",!0,void 0,Mc));(ve=this.qc.ZC(ve))&&
this.qc.le(Wc,ve)&&Rc.b(593078096,3017,50,"Custom linked style applied by user");Id=E.a.PQ(Id);id.Hs=Id>>>16^Id&65535;return fc};this.ENn=(fc,Mc,Wc,id,Id)=>{const ve=this.Ked.Mqa(fc,Mc,Wc,id,Id,null,0);return 2!==ve?ve:this.Ked.Mqa(fc,Mc,Wc,id,Id,null,12)};this.AGk=(fc,Mc,Wc,id,Id)=>{var ve;const $d={};$d[this.Ked.mKa]=6168;$d[this.Ked.lKa]=6169;let be=12;if(!Mc.view.ue)return 2;var he=Mc.view.mb,re=he?he.qg:null;if(!re)return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.noSelection}),8;if(this.ah.fEa(ye.ImageReader.i4a,
re))return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.SJc}),8;if(this.ah.CAa(Td.ParagraphReader.PU,re))return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),8;if(this.Xf.Dcc(re,!1))return this.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),8;re=this.qc.Ar();if(Id&&re){const Xf=re.pj(Id);if(Xf){(null===(ve=v.AFrameworkApplication.K)||void 0===ve?0:ve.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("Style");ve=this.qc.GFa(Xf,re);let Mg=this.qc.NG(Xf);ve&&(he=he.ib.J(0),he.Zw&&
he.Pa.contextId===zc.a.Fd||2===he.length&&he.Pa.contextId===zc.a.Fd&&he.Rc.contextId===zc.a.Vc)&&(Mg=1,Id=ve.getValue(xe.a.la));1===Mg?be=0:3===Mg&&(be=14);!this.qc.le(Xf,re)&&this.qc.Hd(Xf)&&(he=this.qc.Kg(Xf),Rc.b(562317522,3017,50,String.format("{0}: style applied by user",he)));this.Tra(this.zHl,this.AHl)}}return this.Ked.Mqa(fc,Mc,Wc,id,Id,$d,be)};this.ev=h;this.Ce=r;this.QN=B;this.gA=P;this.Nk=ca;this.Ad=ra;this.$W=Qa;this.gpk=mb;this.De=Jb;this.Lo=Yb}get io(){return null!=this.NHg?this.NHg:
this.NHg=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}get d6(){return this.ev}get ah(){return this.QN}get Cj(){return this.gA}get rn(){return this.Ce}get Xf(){return this.Nk}get Ic(){return this.Ad}get Hea(){return this.$W}get Ked(){return this.gpk}get qc(){return this.De}Ub(){const b=v.AFrameworkApplication.va,h=qe.App.wVa.dMh(12);b.qa(Mb.a.LQ,zc.a.Fd,this.zGk);b.qa(Mb.a.pIa,zc.a.Fd,this.DNn);b.qa(Mb.a.LQ,zc.a.Tc,this.xGk);b.qa(Mb.a.pIa,zc.a.Tc,this.BNn);b.qa(Mb.a.LQ,zc.a.paragraph,this.yGk);b.qa(Mb.a.LQ,
zc.a.view,this.AGk);b.Xc(Mb.a.LQ,1036);b.qa(Mb.a.pIa,zc.a.view,this.ENn);b.qa(Mb.a.pIa,zc.a.paragraph,this.CNn);b.Xc(Mb.a.pIa,99);b.qa(Mb.a.LNb,zc.a.view,h);b.qa(Mb.a.LNb,zc.a.paragraph,this.LNb);b.Xc(Mb.a.LNb,1127);b.fb(Mb.a.Q2e,zc.a.view,this.nOa,4);b.fb(Mb.a.R2e,zc.a.view,this.nOa,4);b.fb(Mb.a.S2e,zc.a.view,this.nOa,4);b.fb(Mb.a.T2e,zc.a.view,this.nOa,4);b.fb(Mb.a.U2e,zc.a.view,this.nOa,4);b.fb(Mb.a.V2e,zc.a.view,this.nOa,4);b.fb(Mb.a.W2e,zc.a.view,this.nOa,4);b.fb(Mb.a.pvh,zc.a.view,this.nOa,
4);b.fb(Mb.a.qvh,zc.a.view,this.nOa,4);b.fb(Mb.a.rvh,zc.a.view,this.nOa,4);this.Smc=Array(10);this.qc.Ooo(this.Smc)}Zfm(b){switch(b){case Mb.a.Q2e:return 0;case Mb.a.R2e:return 1;case Mb.a.S2e:return 2;case Mb.a.T2e:return 3;case Mb.a.U2e:return 4;case Mb.a.V2e:return 5;case Mb.a.W2e:return 6;case Mb.a.pvh:return 7;case Mb.a.qvh:return 8;case Mb.a.rvh:return 9;default:return-1}}Tra(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");
r&&r.execute(B=>{B.logActivity(b,h)})},Vr.EEa)}uvf(b,h){if(b&&h&&Td.ParagraphReader.Xb(h))h=this.qc.ZC(h);else return null;return h.pj(b)}get XH(){return null!=this.BAg?this.BAg:this.BAg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}}Vr.EEa=5E3;Object(n.a)(Vr,"StyleActor",null,[]);var Es=c(1999);class Sy{constructor(b){this.ga=b}get oc(){return this.ga}fhe(b,h=!1){this.oc.Mf(b,Mb.a.pRa,2,!0,null,h)}O5(b){this.oc.Qb(Mb.a.O5,2,b)}}Object(n.a)(Sy,"TextFormattingCommands",null,[506]);class Zp{constructor(b,
h,r,B){this.KWe=this.hkh=!1;this.cNo=(P,ca,ra)=>{if(2!==ra)return 2;this.hkh||(this.hkh=!0);v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");return 32};this.EJn=(P,ca,ra,Qa,mb)=>{if(2!==ra)return 2;this.e5i(mb,!0);return 32};this.DJn=(P,ca,ra,Qa,mb)=>{if(2!==ra)return 2;this.e5i(mb,!1);return 32};this.yKn=(P,ca,ra)=>{if(2!==ra)return 2;if(!this.Ebb)return 8;
this.Ebb.Yum();return 32};this.xJn=(P,ca,ra)=>{if(2!==ra)return 2;if(!this.Ebb)return 8;this.Ebb.C8n();return 32};this.Aqa=(P,ca)=>{3===ca.Ux&&Pd.SelectionEditor.Pl(ca.yl.lb)&&(ne.c(Mb.a.YMo),v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),this.KWe=!0)};this.ga=b;this.Ca=h;this.Ebb=r;this.hb=B}get bNo(){return this.KWe}Ub(){var b;this.ga.fb(eb.a.cQ,zc.a.view,this.cNo,4);this.ga&&this.Ca&&(this.Ca.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Mb.a.Ing,
zc.a.view,this.EJn,4),this.ga.fb(Mb.a.Kng,zc.a.view,this.DJn,4)),this.ga.fb(eb.a.$vj,zc.a.application,this.yKn,4),this.ga.fb(eb.a.Hif,zc.a.application,this.xJn,4),to.EventHandlerManager.instance.QXn(()=>{this.iwn()}));(null===(b=ab.StaticActiveAppFrame.za().jb.rc)||void 0===b?0:b.ue)&&ab.StaticActiveAppFrame.za().jb.rc.wga(()=>{this.xco()});this.hb&&this.hb.Xw(this.Aqa)}YPn(){ne.c(Mb.a.aNo);this.KWe=!0}xco(){const b=window.performance.now();Zp.uJe&&250>b-Zp.uJe&&1E3<b-Zp.b5g&&(ne.c(Mb.a.$Mo),Zp.b5g=
b);this.Ebb&&Zp.Zb&&Zp.Zb.TB(116)&&this.Ebb.showFloatie()}QHm(b,h){if(h){var r=null;ba.a.gK&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.Ebb&&this.Ebb.rXo(b.getBoundingClientRect(),h)}}iwn(){Zp.uJe=window.performance.now()}e5i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Zp.cym)){for(b=b.firstChild;b;)this.VAk(b,h),b=b.nextSibling;break}b=b.nextSibling}}VAk(b,h){if(b.classList.contains(Zp.Lqi)){const r="WACImageResizeHandleTouch"+this.J_l(b);
h?b.classList.add(Zp.Mqi,r):b.classList.remove(Zp.Mqi,r)}}J_l(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Zp.Lqi)return E.a.substring(h,20,h.length);return""}static get Zb(){return null!=Zp.vzg?Zp.vzg:Zp.vzg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Zp.Lqi="WACImageResizeHandles";Zp.Mqi="WACImageResizeHandlesTouch";Zp.cym="WACImgSelection";Zp.uJe=0;Zp.b5g=0;Object(n.a)(Zp,"TouchInputActor",null,[505]);class yw{get mKa(){return Tr.a.mKa}get lKa(){return Tr.a.lKa}get Apc(){return Tr.a.Apc}Mqa(b,
h,r,B,P,ca,ra){return Tr.a.Mqa(b,h,r,B,P,ca,ra)}mic(b,h,r,B,P,ca){return Tr.a.mic(b,h,r,B,P,ca)}static get instance(){yw._instance||(yw._instance=new yw);return yw._instance}}yw._instance=null;Object(n.a)(yw,"ViewActionHandlerProxy",null,[504]);class GC{constructor(b,h){this.kpiName="VisiMarkersUsage";this.Q8="wwaengidc";this.lmb=new Map;this.Bzo=(r,B,P,ca,ra)=>{if(1===P)return 32;if(!ra)return 2;this.lmb.set("Source",ac.a[this.ga.I0]);this.nYe.kZc?this.lmb.set("Action","Removed"):this.lmb.set("Action",
"Applied");xa.Health.instance.recordKpiUsage(this.kpiName,1,this.Q8,this.lmb);r=document.getElementsByTagName("head")[0];if(!this.nYe.tMo(r))return t.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;ab.StaticActiveAppFrame.za().lH({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.UMn=(r,B,P,ca,ra)=>{if(1===P)return 32;ra[Df.a.On]=this.nYe.kZc;return 32};this.ga=b;this.nYe=h}Ub(){this.ga.fb(Mb.a.Kje,zc.a.application,this.Bzo,1);this.ga.fb(Mb.a.w6i,zc.a.application,this.UMn,
96)}}Object(n.a)(GC,"VisiMarkersActor",null,[]);var Qz=c(110);class zw{constructor(b,h,r,B,P){this.Zm=b;this.vkn=h;this.Ej=r;this.Qd=B;this.jg=P}get kTi(){return this.vkn.value}execute(b,h,r,B){const P=Ih.a.instance.Fp(Mb.a.slo);Zf.OutlineElementReader.isEmpty(b,!1)?this.Pzl(b):this.Qzl(b,h,r,B);P.end()}Pzl(b){this.kTi.W6e(b,-1)?this.kTi.zTa(b,-1,0):this.Zm.yIa(b,{Jaj:!0})}Qzl(b,h,r,B){h=B(b,h,r);b=Td.ParagraphReader.$k(b.currentNode);!this.Zm.uRb&&this.mXm(b)&&this.Awk(h);this.Zm.s6();(null===b||
void 0===b?0:b.ra)&&!b.ra.last.formatting&&this.jg.S1a(b)}mXm(b){return b.Ni&&!b.Zy.hasProperty(Oc.a.listID)}Awk(b){hg.OutlineElementNavigator.Ee(b);b=b.currentNode;const h=new Qz.a;b.Mc.Xu(h);this.Ej.GV(b,h,this.Qd.yg)}}Object(n.a)(zw,"ListNewLineStrategy",null,[]);var Vt=c(1228);class Ov{constructor(b,h,r,B,P,ca){this.Gcn=b;this.Gqa=h;this.W8a=r;this.Yr=B;this.u1=P;this.u_f=ca;this.lBi=!1;this.b3c=(ra,Qa,mb)=>{if(1===mb)return 32;ra=this.pageContentNode.ja(Pe.a.lV,$f.a.white);(new Vt.a(Ov.qJc,Mb.a.xlc)).bmc(ra);
return 32};this.Dic=(ra,Qa,mb,Jb,Yb)=>{if(1===mb)return 32;ra=this.pageContentNode.ja(Pe.a.lV,$f.a.white);ra=$f.a.eF(ra);this.kGa(this.u_f);this.u_f.$Pb=ra;this.u1.Roe(ra);ra=this.u_f.pPc(this.pageContentNode,qe.App.FCb);if(!ra)return 8;Yb.MenuItems=ra;t.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.M2e=(ra,Qa,mb,Jb,Yb)=>{if(1===mb)return 32;Qa=this.Yr.Pc(15);Qa.Db(this.pageContentNode);switch(ra){case Mb.a.LGd:this.pageContentNode.removeProperty(Pe.a.lV);
break;case Mb.a.FUa:Yb=this.W8a.pva(this.pageContentNode,Yb);this.pageContentNode.setValue(Pe.a.lV,Yb);break;case Mb.a.xlc:ra=this.W8a.pva(this.pageContentNode,Yb),this.pageContentNode.setValue(Pe.a.lV,ra),this.u1.F_a(Yb)}Qa.dispose();return 32}}kGa(b){this.lBi||(b.pX(2,Mb.a.LGd),b.pX(3,Mb.a.FUa),b.pX(4,Mb.a.FUa),b.pX(5,Mb.a.xlc),b.pX(6,Mb.a.b3c),b.aBb(this.Gcn,1),this.lBi=!0)}Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.b3c,zc.a.view,this.b3c);b.qa(Mb.a.Dic,zc.a.view,this.Dic);b.qa(Mb.a.FUa,
zc.a.view,this.M2e);b.qa(Mb.a.LGd,zc.a.view,this.M2e);b.qa(Mb.a.xlc,zc.a.view,this.M2e);b.Xc(Mb.a.Dic,1127)}get pageContentNode(){return this.Gqa.value}}Ov.qJc="Page";Object(n.a)(Ov,"PageColorActor",null,[]);var Fs=c(476),Jx=c(546),hv=c(1232);class zu{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new Gz(uu.a.TGb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ia("Box4.Actors.Box4PasteStewardUtils",
()=>new yA(v.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();b.ia("Box4.Actors.ClipboardActor",()=>new Kz.ClipboardActor(b.Ve("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),Ih.a.instance,b.resolve("Box4.IClipboardDataHelper"),lh.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,kb.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.jhg(),v.AFrameworkApplication.csj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ya.a.instance.resolve("Common.IReactContextualUILauncher"),!!qe.App.instance&&qe.App.instance.Dia)).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Fv(v.AFrameworkApplication.K)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",
()=>new Ny(v.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),$u.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new My(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Hb.InteractiveViewManager.instance,ab.StaticActiveAppFrame.za().jb,kb.FocusManager.instance(),
b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),$u.a.instance,v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Oy).ha();b.ia("Box4.ISelectionFactory",()=>new Iz.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new mq).ha();b.ia("Common.IDomElementContentStateFactory",()=>new hx).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Ws(lh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();
b.ia("Box4.Actors.PastedContentsPostProcessorHelper",()=>new dv).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new ww(lh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Hb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!qe.App.instance&&qe.App.instance.Dia)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Zx(b.resolve("Box4.IClipboardDataHelper"),qe.App.Iv.gJ)).ha();b.ia("Box4.Actors.PasteFloatieEventManager",()=>new Pg(b.resolve("Box4.UI.PasteFloatieManager"),
b.resolve("Box4.IPasteFloatieEventSource"),Hb.InteractiveViewManager.instance,Ez.a.instance(),v.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),qe.App.li.Al.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!qe.App.instance&&qe.App.instance.Dia)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",
()=>new Pq(Ih.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),Ux.a.instance,lh.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ve("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>
new Nx(v.AFrameworkApplication.va,Ih.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),lh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),Fr.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),
b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Jy(Ih.a.instance,$u.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),v.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Xs(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IClipboardOperationFactory",()=>new Uj(b.resolve("Box4.Actors.InternalClipboard"),
v.AFrameworkApplication.va,v.AFrameworkApplication.fhg(),Ih.a.instance,Fr.a.instance,$u.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Yx(b.Ve("Box4.Actors.IBox4PasteStewardFactory"),b.Ve("Box4.Actors.IBox4ImageStewardFactory"),b.Ve("Box4.Actors.IBox4TableStewardFactory"),b.Ve("Box4.Actors.IBox4WordConverterFactory"),b.Ve("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.Actors.InternalClipboard",()=>new et.a(b.resolve("Box4.Images.IImageEditor"),b.Ve("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),
qe.App.li,b.resolve("Box4.IParagraphIndentationReader"),v.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").kkj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new zo(b.resolve("Box4.Actors.InternalClipboard"),
b.Oa("Box4.IContentControlCopyPasteHelper"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new kx(v.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new zw(b.resolve("Box4.List.IListEditor"),b.Ve("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new ns(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),xj.a.instance)).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new Az(b.resolve("Box4.Images.IImageEditor"),v.AFrameworkApplication.lc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),ab.StaticActiveAppFrame.za().notificationBar,
b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();b.ia("Box4.Actors.Box4TableStewardFactory",()=>new fn(Ya.a.instance.resolve("Box4.List.IListEditor"),Ya.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"),b.Sa("Common.ISystemInitiatedFeedback"))).as("Box4.Actors.IBox4TableStewardFactory").ha();
b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new Nq(Ih.a.instance,lh.a.instance,qe.App.zd,xj.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",()=>new xu(v.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new pw(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new EB).ha();b.ia("Box4.ISelectionCommands",()=>new kr(v.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",
()=>new Sy(v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new hh(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();b.ia("Box4.Actors.InsertionPointFormatting",()=>new EC(b.Oa("Box4.IFontSlotProvider"),b.Sa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new bv).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new HA(Ya.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),
v.AFrameworkApplication.va,()=>Ya.a.instance.resolve("Box4.UI.ILanguageDialog"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),lh.a.instance,Ya.a.instance.Sa("Box4.IExternalSelectionManager"),Fr.a.instance,Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider"),xj.a.instance,Ih.a.instance,Ya.a.instance.resolve("Box4.IContextMenuController"),Ya.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ya.a.instance.Sa("Box4.Actors.IProofingErrorPresenter"),
Ya.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",()=>new Vr(Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ya.a.instance.resolve("Box4.IFormattingEditor"),Im.ContextSetEditor.instance,Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),xj.a.instance,Ih.a.instance,Ya.a.instance.resolve("Box4.TextFormattingHelper"),
yw.instance,Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",()=>new Rx(Ya.a.instance.resolve("Box4.IUpdateStyleManager"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new Es.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),
b.Oa("Box4.IContentControlChpHelper"),Ya.a.instance.resolve("Box4.IFormattingEditor"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.IParagraphEditor"),Ya.a.instance.resolve("Box4.ILineSpacingHelper"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.List.IListFormattingEditor"),Ya.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();
b.ia("Box4.Actors.AutoCorrectActor",()=>new CA(v.AFrameworkApplication.va,Ih.a.instance,()=>Ya.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",()=>new Zp(v.AFrameworkApplication.va,v.AFrameworkApplication.K,Iy.GrippersManager.instance,lh.a.instance)).as("Box4.ITouchInputActor").ha();b.register(xt,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new GC(v.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).ha();
b.ia("Box4.Actors.IndentationActorExtension",()=>new up).as("Box4.Actors.IIndentationActorExtension").ha();Object(Jx.a)()&&b.ia("Box4.Actors.PageColorActor",()=>new Ov(Fs.a.instance,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc.ed),Il.a.instance,kl.a.instance,Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new hv.a(Ov.qJc))).ha()}}Object(n.a)(zu,"Box4ActorsComponentConfiguration",null,[2]);var Kx=c(223),wB=c(1109);const Li=()=>{const b=zm;v.AFrameworkApplication.va.qa(Mb.a.mhf,zc.a.Ohb,b);
v.AFrameworkApplication.va.qa(Mb.a.mhf,zc.a.O8b,b);v.AFrameworkApplication.va.qa(Mb.a.lhf,zc.a.Ohb,fg);v.AFrameworkApplication.va.qa(Mb.a.lhf,zc.a.O8b,fg)},zm=(b,h,r)=>qe.App.GLd?8:2===r?(b=new Wh.StandardDialog,b.Cd=4,b.FV(1),b.ye(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.ye(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.Yhg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,xs),32):2,xs=b=>{1===b&&v.AFrameworkApplication.va.processAction(Mb.a.lhf,
2)},fg=(b,h,r)=>{if(qe.App.GLd)return 8;if(1===r)return h.node.hasProperty(Pe.a.embeddedFileContainer)?32:2;if(2===r&&(h.contextId===zc.a.view&&h.view.mb&&(h=h.view.mb.qg),Kx.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=wB.a.yYl(h.node);Gc.a.eqo();try{Wt(b)}catch(B){t.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",B)}}return 32},Wt=b=>{Qd.a.vm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Rz=c(790);class gt{constructor(b){this.TBa=this.gW=null;this.jja=(h,r,B,P,ca)=>
{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Mb.a.Z6a,2,ca);h=ca&&0<=ca.fontColor&&16777215>=ca.fontColor?ca.fontColor:0;ab.StaticActiveAppFrame.za().dismissFloatie();(new Vt.a(gt.qJc,Mb.a.ura)).bmc(h);return 32};this.KNb=(h,r,B,P,ca)=>{if(1===B)return 32;if(2===B&&!ca)return 8;h=gt.Hi.ETd(r);r=new Rz.a;B=null;32===v.AFrameworkApplication.va.Qb(Mb.a.Z6a,2,r)&&r&&(B=r.fontColor);P="";B&&!r.R8b&&(P=$f.a.eF(B)||"");this.o2h.$Pb=P;this.hYc&&this.u1.Roe(P);h=this.o2h.pPc(h,qe.App.FCb);if(!h)return 8;
ca.MenuItems=h;t.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.WKe=b}get o2h(){this.gW||(this.gW=new hv.a(gt.qJc),this.kGa(this.gW));return this.gW}kGa(b){b.pX(1,Mb.a.Mga);b.pX(3,Mb.a.Xv);b.pX(4,Mb.a.Xv);b.pX(5,Mb.a.ura);b.pX(6,Mb.a.jja);b.aBb(this.WKe,1)}Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.jja,zc.a.view,this.jja);b.qa(Mb.a.KNb,zc.a.view,this.KNb);b.Xc(Mb.a.KNb,1127)}static yZl(){return new gt(Fs.a.instance)}static get instance(){return null!=
gt.xCg?gt.xCg:gt.xCg=gt.yZl()}get u1(){return null!=this.HGg?this.HGg:this.HGg=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get Hi(){return Qh.PageReader.instance}get hYc(){null==this.TBa&&(v.AFrameworkApplication.se("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.TBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.TBa}}gt.qJc="Font";Object(n.a)(gt,"FontColorActor",
null,[]);class Aw{constructor(b){this.jja=(h,r,B,P,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Mb.a.Z6a,2,ca);h=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;ab.StaticActiveAppFrame.za().dismissFloatie();(new Vt.a("Highlighter",Mb.a.H$)).bmc(h);return 32};this.ga=b}Ub(){this.ga.qa(Mb.a.o_i,zc.a.view,this.jja)}static q0l(){return new Aw(v.AFrameworkApplication.va)}static get instance(){return null!=Aw.iDg?Aw.iDg:Aw.iDg=Aw.q0l()}}Object(n.a)(Aw,"HighlighterColorActor",null,[]);
var Zq=c(376),nq=c(88);class lx{static get Vg(){return Pf.a.Nx(lx.Wm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}lx.Wm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(lx,"InsertLinkDialogHtml",null,[]);class ap extends Pf.a{constructor(b){super();this.d8d=()=>{const h=document.getElementById("txtLink");this.qra(1,!h||!h.value.length||ch.a.cSa(h.value))};this.FCf=(h,r)=>{if(this.qh.ov){var B=this.qh.mb.ib.lb;if(B)if(B.equals(this.Fx)&&0!==h){h=new sg.GraphTransaction(15);h.Db(this.yT[0].node);for(B=0;B<this.yT.length;B++)this.yT[B].node.zJ().rF.f8(4);B=r.txtLink.trim();r=this.Ekl();B=this.oEm(B);(r||B)&&ap.Qd.Zs(7);this.hide();h.dispose()}else this.qh.e6()}};
this.yT=b;this.qh=Hb.InteractiveViewManager.instance.yd;this.Fx=this.qh.mb.ib.lb;this.Mlf=b[0].cpBegin;this.qKf=b[b.length-1].cpEnd;this.zg="InsertMultiParagraphLinkDialog";b=this.MWo();this.showDialog("",b)}showDialog(b,h){t.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Vg=lx.Vg;""===h.trim()&&this.ye(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.FCf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;ap.WFf&&(b=document.getElementById("txtLink"),De.a.addHandler(b,Xc.a.input,this.d8d),De.a.addHandler(b,Xc.a.xIc,this.d8d))}hide(){if(ap.WFf){const b=document.getElementById("txtLink");b&&(De.a.removeHandler(b,Xc.a.xIc,this.d8d),De.a.removeHandler(b,Xc.a.input,this.d8d))}super.hide()}Wva(b){return ap.WFf?this.BQl(this.Ntc)?super.Wva(b):!1:super.Wva(b)}MWo(){let b;var h="";const r=this.yT.length,B=ch.a.Fz(this.yT[0],!1);0<B.length&&({cpBegin:P,cpEnd:b}=
ap.z0.Sha(this.yT[0],B[0]),P<=this.yT[0].cpBegin&&(h=B[0].hyperlink.url),this.Mlf=Math.min(this.Mlf,P));var P=ch.a.Fz(this.yT[r-1],!1);0<P.length&&({cpBegin:P,cpEnd:b}=ap.z0.Sha(this.yT[r-1],P[P.length-1]),this.qKf=Math.max(this.qKf,b));this.OPo(this.Mlf,this.qKf);return h}OPo(b,h){const r=this.yT.length;if(b!==this.yT[0].cpBegin||h!==this.yT[r-1].cpEnd){b=Se.a.Uc(this.yT[0].node,b);b=Fe.SelectionFactory.Xn(b);h=Se.a.Uc(this.yT[r-1].node,h);h=Fe.SelectionFactory.Iy(b,h);b=this.qji(h.Pa.clone());const B=
this.qji(h.Rc.clone());b&&B&&(this.yT[0]=b,this.yT[r-1]=B,this.qh.mb.Ac(h),this.Fx=h)}}oEm(b){if(!b)return!1;b=ch.a.NFa(b);for(let r=0;r<this.yT.length;r++){var h=this.yT[r];if(ap.Iua&&Pd.SelectionEditor.vl(h)&&(h=Pd.SelectionEditor.eog(h),!Pd.SelectionEditor.vl(h)))continue;h=Se.a.createTextRange(this.yT[r].node,h.cpBegin,h.cpEnd);this.pPo(h);ap.jp.fF(h,b,!1)}return!0}pPo(b){nq.a.instance.J(1)&&ap.Qd.pCj(b)}qji(b){return Td.ParagraphReader.um(b)&&!Pd.SelectionEditor.v9(b)&&Td.ParagraphReader.textLength(b.node)?
Se.a.createTextRange(b.node,0,Td.ParagraphReader.textLength(b.node)):Pd.SelectionEditor.vl(b)?b:null}Ekl(){let b=!1;for(const h of this.yT){const r=ch.a.Fz(h,!1);r&&(b=ap.z0.Gaj(h,r)||b)}return b}static get z0(){return null!=ap.EBg?ap.EBg:ap.EBg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Qd(){return null!=ap.cJg?ap.cJg:ap.cJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get jp(){return null!=ap.vBg?ap.vBg:ap.vBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get Iua(){null==
ap.gaa&&(ap.gaa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ap.gaa}static get WFf(){null==ap.yGe&&(ap.yGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return ap.yGe}}ap.gaa=null;ap.yGe=null;Object(n.a)(ap,"InsertMultiParagraphLinkDialog",Pf.a,[]);var Ty;(function(b){b.Yap="Heading";b.Bookmark="Bookmark";b.Url="Url";b.Lcp="RecentLinks"})(Ty||(Ty={}));Object(n.b)("InsertLinkUserActivitySource",
Ty);class Nr{constructor(b,h,r,B,P){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=B;this.paragraphNode=P}}Object(n.a)(Nr,"HeadingDataForLinkDialog",null,[]);class cy{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(n.a)(cy,"BookmarkDataForLinkDialog",null,[]);class mx{constructor(b,h,r,B,P,ca){this.key=b;this.name=h;this.startIndex=r;this.count=B;this.level=P;this.isCollapsed=ca}}Object(n.a)(mx,"GroupHeaderDataForLinkDialog",null,[]);class Uy{constructor(b,h){this.selectedIndex=
b;this.selectedGroupId=h}}Object(n.a)(Uy,"SelectedItemFromLinkDialogGroupedList",null,[]);class JB{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.jr=b;this.vd=h;this.jsl=r;this.bookmarkManager=B;this.z0=P;this.jp=ca;this.jg=ra;this.Qd=Qa;this.Ej=mb;this.Hk=Jb;this.Axa=Yb;this.EFb=null;this.Cxi=!1;this.FCf=(Wc,id)=>{var Id;if(this.ke.ov){var ve=ch.a.cSc(this.jr),$d=this.ke.mb.ib.lb;if($d){$d=$d.Pa;Td.ParagraphReader.um($d)&&($d=Se.a.createTextRange($d.node,0,Td.ParagraphReader.textLength($d.node)));
var be=Pd.SelectionEditor.CSb($d);Pd.SelectionEditor.vl(be)&&($d=be);if(0!==Wc&&32===v.AFrameworkApplication.va.Mf($d,Mb.a.insertHyperlink,1,!0,null,null)&&this.jr.equals($d)){Me.a.mark(5562);(null===(Id=qe.App.zd)||void 0===Id?0:Id.Uo)&&this.ke.mb.j2b();Wc=new sg.GraphTransaction(15);Wc.Db(this.jr.node);this.jr.node.zJ().rF.f8(4);Id=id.txtDisplay;$d=!1;if(null!=id.linkurl)if($d=!0,id.isHeading){l(this.vd,"Heading");be=id.paragraphNode;const he=id.startCp,re=id.endCp;id=this.bookmarkManager.PPl(be);
this.bookmarkManager.WFc(id,he,re,be,be,!1)}else l(this.vd,"Bookmark"),id=id.linkurl;else l(this.vd,"Url"),id=id.txtLink.trim();this.insertLink(Id,id,ve,$d);Wc.Uj=Mb.a.insertHyperlink;Wc.dispose();Me.a.mark(5563);this.jr.node.Yhb()}else this.ke.e6()}else t.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ke=Hb.InteractiveViewManager.instance.yd;this.jr=b;r=Pd.SelectionEditor.CSb(this.jr);Pd.SelectionEditor.vl(r)&&(this.jr=r);const fc=
new Pf.a(!1,!1,!0);r=this.C_l();B={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};P=this.EFb="";P=Td.ParagraphReader.text(this.jr.node);ra=this.jr.cpBegin;Qa=this.jr.cpEnd;({gcg:P,ekf:ra,fkf:Qa,FAf:ca}=this.dWl(P));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ca);else{ca[0]&&this.lAl(ra,Qa,ca[0].paragraph);h=""===P.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;fc.ye(1,h);(null===P||void 0===P?0:P.startsWith(E.a.Efb))?(h=this.Sdm(P,r))?r.selectedItem=h:B.txtLink=P:B.txtLink=P;B.txtDisplay=this.EFb;1>=ca.length&&this.z0.F5k(b,ca[0],1===ca.length)&&(this.Cxi=!0,B.textDisplayDisabled=!0);var Mc={["id"]:"InsertLinkDialog",["bodyControls"]:B};
this.Hk.ie(()=>{fc.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.FCf,Mc)},"RILD:IAS")}}dWl(b){const h=ch.a.cSc(this.jr);let r=this.jr.cpBegin,B=this.jr.cpEnd,P="";if(!h.length)return this.EFb=b.substring(this.jr.cpBegin,this.jr.cpEnd),{returnValue:!0,gcg:P,ekf:r,fkf:B,FAf:h};if(h[0].hyperlink){let ca,ra=0,Qa=Math.max(0,b.length-1),mb=0;for(let Jb=0;Jb<h.length;Jb++)h[Jb].cpBegin>=ra&&({cpBegin:ca,cpEnd:ra}=this.z0.Sha(this.jr,h[Jb]),Qa=Math.min(ca,Qa),mb=Math.max(ra,mb));r=Math.min(Qa,r);B=Math.max(mb,
B);this.EFb=b.substring(r,B);r===Qa&&(P=h[0].hyperlink.url);return{returnValue:!0,gcg:P,ekf:r,fkf:B,FAf:h}}return{returnValue:!1,gcg:P,ekf:r,fkf:B,FAf:h}}lAl(b,h,r){if(h!==this.jr.cpEnd||b!==this.jr.cpBegin)b=Fe.SelectionFactory.mJ(r,b,h),this.ke.mb.Ac(b),this.jr=Pd.SelectionEditor.CSb(b.Pa.clone())}FNo(b,h,r,B,P,ca=!1){B?(B=Se.a.createTextRange(this.jr.node,this.jr.cpBegin,this.jr.cpBegin+b.length),this.jp.kul(B,r,h),b=Fe.SelectionFactory.ne(this.jr.node,this.jr.cpBegin+b.length)):(this.jp.vnb(this.jr,
2),this.Ej.rqb(this.jr,2),r=Se.a.Uc(this.jr.node,this.jr.cpEnd),this.jg.Ge(r,b,!0),B=Se.a.createTextRange(this.jr.node,this.jr.cpEnd,this.jr.cpEnd+b.length),this.jp.fF(B,h,P,!1,!0,ca),b=Fe.SelectionFactory.ne(this.jr.node,this.jr.cpEnd+b.length));b&&this.ke.mb.Ac(b)}insertLink(b,h,r,B=!1){var P=null;b||(b=h,v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!B){h=ch.a.NFa(h);
var ca="";this.Axa&&({P7f:ca}=this.Axa.jog(h)).returnValue&&(h=ca)}this.Cxi||(b=this.jp.e5n(b));ca=!1;if(h){P=0<r.length;const ra=Td.ParagraphReader.text(this.jr.node).substring(this.jr.cpBegin,this.jr.cpEnd)!==b,Qa=this.Qd.yg;if(Qa&&1===r.length&&!r[0].hyperlink.SG&&!(r[0].cpBegin>this.jr.cpBegin&&r[0].cpEnd<=this.jr.cpEnd)){this.FNo(b,h,r[0].hyperlink,!ra,P,B);return}if(P)for(let mb=0;mb<r.length;mb++)r[mb].hyperlink.SG&&(ca=!0),this.jp.jS(this.jr.node,r[mb].hyperlink,!1);ra?this.jg.Ge(this.jr,
b,!ca):Qa&&!ca&&this.Ej.rqb(this.jr,1);r=Se.a.createTextRange(this.jr.node,this.jr.cpBegin,this.jr.cpBegin+b.length);this.jp.fF(r,h,P,ca,!0,B);P=Fe.SelectionFactory.ne(this.jr.node,this.jr.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.SG&&(ca=!0),this.jp.jS(b.paragraph,b.hyperlink));ca&&this.Qd.Zs(ca?2:7);P&&this.ke.mb.Ac(P);qe.App.cPo()}Sdm(b,h){h=h.items;const r=b.substring(E.a.Efb.length),B=this.bookmarkManager.vei(r);b=-1;let P=0;for(let ca=0;ca<h.length;ca++)if(h[ca].isHeading&&0!=B.count&&
h[ca].paragraphNode.id==B.J(0).id){b=ca;break}else if(!h[ca].isHeading&&h[ca].linkurl==r){b=ca;P=1;break}h=new Uy(b,P);return-1!=b?h:null}C_l(){const b={};let h=[],r=0,B=0;var P=this.jsl.c0l();P&&(r=P.count,h=h.concat(this.h0l(P)));if(P=this.bookmarkManager.yQd(!1))B=P.count,h=h.concat(this.TPl(P));b.groups=this.X_l(r,B);b.items=h;return b}X_l(b,h){const r=[],B=new mx("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(B);b=new mx("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,
b,h,0,!0);r.push(b);return r}h0l(b){const h=[],r=/\uFFFC/;for(const B of b)b=B.characterData.replace(r," "),b=new Nr(b,!0,B.Bc,B.end,B.paragraphNode),h.push(b);return h}TPl(b){const h=[];for(const r of b)b=r.tf(Oc.a.At).toString(),b=new cy(b,!1),h.push(b);return h}}Object(n.a)(JB,"ReactInsertLinkDialog",null,[]);class ff{static get Xf(){return xj.a.instance}static get FX(){return null!=ff.Hxg?ff.Hxg:ff.Hxg=Ya.a.instance.Oa("Box4.IContentControlChpHelper")}static get z0(){return null!=ff.FBg?ff.FBg:
ff.FBg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static jx(){return ff.en||(ff.en=Ya.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Qd(){return null!=ff.oJg?ff.oJg:ff.oJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Fh(){return null!=ff.vJg?ff.vJg:ff.vJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get ah(){return Im.ContextSetEditor.instance}static get Ic(){return Ih.a.instance}static get i1c(){null==
ff.Osb&&(ff.Osb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return ff.Osb}static get Iua(){null==ff.gaa&&(ff.gaa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ff.gaa}static get jp(){return null!=ff.BBg?ff.BBg:ff.BBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get jg(){return null!=ff.txg?ff.txg:ff.txg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get T4a(){ff.YGe||
(ff.YGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return ff.YGe}static get dLo(){ff.Kjh||(ff.Kjh=v.AFrameworkApplication.K?v.AFrameworkApplication.K.nc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return ff.Kjh}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.insertHyperlink,zc.a.view,ff.nIb);b.qa(Mb.a.insertHyperlink,zc.a.Tc,ff.insertLink);b.qa(Mb.a.insertHyperlink,zc.a.Fd,ff.insertLink);b.Xc(Mb.a.insertHyperlink,
1028);b.qa(Mb.a.C7b,zc.a.view,ff.nIb);b.qa(Mb.a.C7b,zc.a.Tc,ff.insertLink);b.qa(Mb.a.C7b,zc.a.Fd,ff.insertLink);b.Xc(Mb.a.C7b,1028);b.qa(Mb.a.jS,zc.a.view,ff.nIb);b.qa(Mb.a.jS,zc.a.Tc,ff.Qaj);b.qa(Mb.a.jS,zc.a.Fd,ff.Qaj);b.Xc(Mb.a.jS,1028);b.qa(Mb.a.age,zc.a.view,ff.nIb);b.qa(Mb.a.age,zc.a.Tc,ff.Vij);b.qa(Mb.a.age,zc.a.Fd,ff.Vij);b.qa(Mb.a.v6a,zc.a.view,ff.nIb);b.qa(Mb.a.v6a,zc.a.Tc,ff.r_i);b.qa(Mb.a.v6a,zc.a.Fd,ff.r_i);b.qa(Mb.a.v6a,zc.a.image,ff.SZf);b.qa(Mb.a.v6a,zc.a.pFb,ff.SZf);b.qa(Mb.a.v6a,
zc.a.W7,ff.SZf);b.qa(Mb.a.$Ic,zc.a.application,ff.$Ic);b.qa(Mb.a.aJd,zc.a.view,ff.nIb);ff.T4a&&(b.fb(eb.a.f7a,zc.a.view,this.nIb.bind(this),1028),b.qa(eb.a.f7a,zc.a.Tc,this.f7a.bind(this)),b.qa(eb.a.f7a,zc.a.Fd,this.f7a.bind(this)),b.Xc(eb.a.f7a,1028),b.qa(eb.a.GCf,zc.a.Tc,this.f7a.bind(this)),b.qa(eb.a.GCf,zc.a.Fd,this.f7a.bind(this)),b.Xc(eb.a.GCf,1028),b.qa(eb.a.b2f,zc.a.view,this.b2f.bind(this)),b.qa(eb.a.W1f,zc.a.view,this.W1f.bind(this)),b.fb(eb.a.Qkb,zc.a.Tc,this.Qkb.bind(this),1028),b.fb(eb.a.Qkb,
zc.a.Fd,this.Qkb.bind(this),1028))}static $Ic(){return 32}static f7a(b,h,r){if(!ff.T4a)return 2;b=ff.bKj(h);if(32!=b)return b;if(!ff.bSa(h,!0).returnValue||ff.y5b(h))return 8;1!==r||ff.o1h||(ff.Noe(!0),ff.o1h=!0);return 32}static b2f(b,h,r,B,P){if(!ff.T4a)return 2;if(1===r)return 32;ff.lde(ff.Sfk,ff.Tfk,ff.Ych);Zq.a.instance.ie(()=>{ff.Noe();P.MenuItems=Object.assign(new dh.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.SNh();ca?(t.ULS.sendTraceTag(526242130,324,50,
"Recent Links data load success in ribbon"),P.MenuItems.MenuSectionList.push(ca)):ff.f3i(P,ff.Ych)},"HA:PRLF");return 32}static W1f(b,h,r,B,P){if(!ff.T4a)return 2;if(1===r)return 32;ff.lde(ff.Qfk,ff.Rfk,ff.Xch);Zq.a.instance.ie(()=>{ff.Noe();P.MenuItems=Object.assign(new dh.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});P.MenuItems.MenuSectionList.push(this.Sbl());const ca=this.SNh(!0);ca?(t.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),
P.MenuItems.MenuSectionList.push(ca)):ff.f3i(P,ff.Xch)},"HA:PILF");return 32}static f3i(b,h){t.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);ff.lde(ff.uck,ff.vck,h);b.MenuItems.MenuSectionList.push(this.vel());ff.Noe(!0)}static vel(){const b=this.ncf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new ei.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static Sbl(){const b=this.ncf("InsertLinkSection");
b.ControlList.push(Object.assign(new ei.a,{ExternalId:"InsertLink"}));return b}static SNh(b=!1){if(Gk.instance.svd){var h=this.ncf("RecentLinksSection",b);b=JSON.parse(Gk.instance.svd);this.rvd.clear();b.forEach((r,B)=>{this.rvd.set(B,[r.FileName,r.DocumentUrl]);const P=ff.Ibm(r.FileName);var ca=ff.YZl(r.TimeStamp),ra=h.ControlList,Qa=ra.push,mb=Object,Jb=mb.assign,Yb=new ei.a,fc=eb.a.Qkb,Mc=eb.a.Qkb;ca=P!==r.FileName?r.FileName+"\n"+ca:ca;var Wc=r.FileName;let id="SaveAsWordDocx_32";switch(r.App){case "Word":id=
"SaveAsWordDocx_32";break;case "PowerPoint":id="SaveAsPowerPointPptx_32";break;case "Excel":id="SaveAsExcelXlsx_32"}Qa.call(ra,Jb.call(mb,Yb,{ExternalId:B,Command:fc,CommandValueId:Mc,LabelText:P,Alt:ca,AriaDescription:Wc,ExternalImageId:id,KeyTip:r.FileName}))});return h}}static ncf(b,h=!1){return Object.assign(new Nf.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Qkb(b,h,r,B,P){if(!ff.T4a)return 2;
if(!P||P.CommandValueId!=eb.a.Qkb)return 32;ff.lde(ff.F7j,ff.G7j,ff.fhk);r=h;h=new sg.GraphTransaction(15);h.Uj=b;h.Db(r.node);B=ff.bSa(r,!0).hyperlink;r=Pd.SelectionEditor.CSb(r);if(B)ff.K8f(r),b=Fe.SelectionFactory.mJ(r.node,Math.min(r.cpBegin,B.cpBegin),Math.max(r.cpEnd,B.cpEnd)),lh.a.instance.Ac(b),r=b.Pa;else if(Pd.SelectionEditor.Ze(r)){var ca;Pd.SelectionEditor.Vlb(r)&&(ca=Pd.SelectionEditor.j0(r,!1));ca||(ca=this.rvd.get(P.SourceControlId)[0],ff.jg.Ge(r,ca,!0,void 0,b),ca=Fe.SelectionFactory.mJ(r.node,
r.cpBegin,r.cpBegin+ca.length));if(ca&&(lh.a.instance.Ac(ca),r=ca.Pa,ff.y5b(r)))return ff.Qd.lRb(!1),8}try{ff.jp.fF(r,this.rvd.get(P.SourceControlId)[1],0<ch.a.cSc(r).length);const ra=Fe.SelectionFactory.ne(r.node,r.cpEnd);ra&&lh.a.instance.Ac(ra);l(P,"RecentLinks")}finally{h&&h.dispose()}t.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static nIb(b,h,r,B,P){if(ff.i1c)return ff.Twm(b,h,r,B,P);if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.ib||!ca.ib.length)return 8;var ra=
ca.ib.lb;let Qa=ra.Pa.clone();if(2===ra.length){if(ra=ra.J(1),!Pd.SelectionEditor.vl(Qa)||!Pd.SelectionEditor.Kk(ra)||Qa.node!==ra.node)return 8}else if(2<ra.length)return 8;if(ca.ib.MJ)return 8;if(ff.ah.CAa(Td.ParagraphReader.PU,ca.qg))return ff.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),8;Td.ParagraphReader.um(Qa)&&!Pd.SelectionEditor.v9(Qa)&&(ca=Qa.node,Qa=Se.a.createTextRange(ca,0,Td.ParagraphReader.textLength(ca)));return b===Mb.a.aJd?ff.QKh(h,Qa,r,B):v.AFrameworkApplication.va.Mf(Qa,b,r,!0,B,P)}static Twm(b,
h,r,B,P){if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.ib||!ca.ib.length||ca.ib.MJ)return 8;var ra=ca.ib.lb;if(ca=ff.rIf(ra))ra=ff.Wvf(ra.Pa.clone(),!0);else{let Qa=ra.J(0).clone(),mb=1;for(;mb<ra.length&&(!Td.ParagraphReader.textLength(Qa.node)||Pd.SelectionEditor.Kk(Qa)||ff.Iua&&xo.l(Qa));)Qa=ra.J(mb).clone(),mb++;ra=ff.Wvf(Qa,!1)}return ff.Iua&&Pd.SelectionEditor.vl(ra)&&xo.l(ra)||!Pd.SelectionEditor.vl(ra)&&!ca?8:b===Mb.a.aJd?ff.QKh(h,ra,r,B):v.AFrameworkApplication.va.Mf(ra,b,r,!0,B,P)}static rIf(b){if(1===
b.length)return!0;if(2===b.length){const h=b.Pa.clone();b=b.J(1);return Pd.SelectionEditor.vl(h)&&Pd.SelectionEditor.Kk(b)&&h.node===b.node?!0:!1}return!1}static fIh(b){let h=null;const r=[];for(let B=0;B<b.length;B++){const P=ff.Wvf(b.J(B).clone(),!1);if(Pd.SelectionEditor.vl(P))ff.Iua&&xo.l(P)||r.push(P);else if(!Pd.SelectionEditor.Kk(P)&&!Td.ParagraphReader.um(P))return{returnValue:!1,Jgb:h}}h=r;return{returnValue:!ff.Iua||0<h.length?!0:!1,Jgb:h}}static insertLink(b,h,r,B,P){if(ff.i1c)return ff.wEm(h,
r,P);B=ff.bKj(h);if(32!==B)return B;let ca;if(!({hyperlink:ca}=ff.bSa(h,!0)).returnValue||ff.y5b(h)||!ca&&b==Mb.a.C7b)return 8;if(1===r)return 32;if(!ca&&Pd.SelectionEditor.Ze(h)&&Pd.SelectionEditor.Vlb(h)&&(b=Pd.SelectionEditor.j0(h,!1))&&(lh.a.instance.Ac(b),h=b.Pa,ff.y5b(h)))return ff.Qd.lRb(!1),8;ca&&t.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,P);return 32}static bKj(b){return!ff.U6e()||!ff.uFd(b)||b.node.Fr||lh.a.instance.ib.MJ?8:Pd.SelectionEditor.S4(b)||$i.a.AFf(b)?2:32}static wEm(b,
h,r){var B=lh.a.instance.ib.lb;const P=ff.rIf(B);if(P)b=[b];else if(!({Jgb:b}=ff.fIh(B)).returnValue)return 8;if(!ff.U6e())return 8;for(B=0;B<b.length;B++)if(!ff.uFd(b[B]))return 8;if(lh.a.instance.ib.MJ)return 8;B=Array(b.length);let ca=null;for(let ra=0;ra<b.length;ra++)if(B[ra]=b[ra],!({hyperlink:ca}=ff.bSa(B[ra],!0)).returnValue||ff.y5b(B[ra]))return 8;if(1===h)return 32;if(!ca&&1===B.length&&P&&Pd.SelectionEditor.Ze(B[0])&&Pd.SelectionEditor.Vlb(B[0])&&(h=Pd.SelectionEditor.j0(B[0],!1))&&(lh.a.instance.Ac(h),
B[0]=h.Pa,ff.y5b(B[0])))return ff.Qd.lRb(!1),8;P?a(B[0],r):new ap(B,r);return 32}static Qaj(b,h,r){if(ff.i1c)return ff.y0n(b,h,r);if(!ff.uFd(h)||Pd.SelectionEditor.S4(h))return 2;let B;if(!({hyperlink:B}=ff.bSa(h,!1)).returnValue)return 2;if(2===r){r=new sg.GraphTransaction(15);try{r.Uj=b,r.Db(B.paragraph),ff.K8f(h)}finally{r&&r.dispose()}B.hyperlink.SG&&ff.Qd.Zs(2)}return 32}static y0n(b,h,r){var B=lh.a.instance.ib.lb;if(ff.rIf(B))h=[h];else if(!({Jgb:h}=ff.fIh(B)).returnValue)return 8;if(!ff.U6e())return 8;
for(B=0;B<h.length;B++)if(!ff.uFd(h[B]))return 8;if(1===r&&!ff.bSa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!ff.bSa(h[r],!0).returnValue)return 2;r=new sg.GraphTransaction(15);try{const P=h[0];r.Uj=b;r.Db(P.node);for(b=0;b<h.length;b++)ff.K8f(h[b])}finally{r&&r.dispose()}ff.Qd.Zs(7)}return 32}static K8f(b){const h=ch.a.cSc(b);let r=0;for(let B=0;B<h.length;B++)if(h[B].cpBegin>=r){const P=({cpEnd:r}=ff.z0.Sha(b,h[B])).returnValue;ff.z0.Gaj(b,P)}}static Vij(b,h,r){if(ye.ImageReader.j4a(h)||
!({hyperlink:b}=ff.bSa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:B,cpEnd:P}=ff.z0.Sha(h,b);lh.a.instance.Ac(Fe.SelectionFactory.mJ(b.paragraph,B,P))}return 32}static r_i(b,h,r){if(({hyperlink:b}=ff.XXm(h)).returnValue)t.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=ff.bSa(h,!1)).returnValue)return 2;2===r&&qe.App.vFb(b.hyperlink.url);return 32}static SZf(b,h,r){b=ye.ImageReader.Sha(h.node);if(!b)return 2;2===r&&qe.App.vFb(b);return 32}static QKh(b,
h,r,B){if(ye.ImageReader.j4a(h)||!Hb.InteractiveViewManager.instance.we.Zj)return 2;let P;if(!({hyperlink:P}=ff.bSa(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:ca,cpEnd:ra}=ff.z0.Sha(h,P);lh.a.instance.Ac(Fe.SelectionFactory.mJ(P.paragraph,ca,ra));h=Hb.InteractiveViewManager.instance.UDa.ownerDocument.createElement("span");h.innerText=P.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return v.AFrameworkApplication.va.Mf(b,Mb.a.$Id,2,!0,B,h)}static bSa(b,h){if(Pd.SelectionEditor.vl(b)){const r=
xo.g(b),B=Jj.a.all(r,P=>6===P.vh);if(0<r.length&&(!ff.Iua||!B)||ff.Xf.jh&&ff.FX&&0<ff.FX.oRd(b).count)return{returnValue:!1,hyperlink:null}}return ff.MXm(b,h)}static XXm(b){let h=null;return ye.ImageReader.j4a(b)&&(h=ch.a.f$b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static MXm(b,h){let r=null;const B=ch.a.cSc(b);return B.length?B[0].hyperlink?(r=B[0],b.cpBegin<B[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static y5b(b){if(nq.a.instance.J(1)){b=
ff.Fh.BQa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Kd.changeType)return!0}return!1}static U6e(){return nq.a.instance.J(1)?!0:!nq.a.instance.J(1)||!qe.App.Iv.ySb}static uFd(b){return ff.Xf.a0(b)||ff.Xf.yia(b)||ff.jx()&&ff.jx().instance&&ff.jx().instance.TU(b)?!1:!0}static Wvf(b,h){return Td.ParagraphReader.um(b)&&!Pd.SelectionEditor.v9(b)&&(Td.ParagraphReader.textLength(b.node)||h)?Se.a.createTextRange(b.node,0,Td.ParagraphReader.textLength(b.node)):b}static Ibm(b){return b&&
b.length<=ff.l8i?b:b.substring(0,ff.l8i)+"..."}static YZl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Noe(b=!1){const h=Date.now();if(b||h-ff.iGi>ff.dLo)Gk.instance.D$m(),ff.iGi=h}static lde(b,h,r){const B=new Map;B.set("Source",r);B.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.EXa,B)}}ff.en=null;ff.Osb=null;
ff.gaa=null;ff.rvd=new Map;ff.YGe=null;ff.l8i=35;ff.iGi=Date.now();ff.o1h=!1;ff.EXa="wwaengidc";ff.fhk="RecentLinks";ff.Ych="RecentLinksRibbonOptions";ff.Xch="RecentLinksContextMenuOptions";ff.Sfk="PopulateRecentLinksRibbon";ff.Tfk="PopulateRecentLinksRibbonAction";ff.Qfk="PopulateRecentLinksContextMenu";ff.Rfk="PopulateRecentLinksContextMenuAction";ff.uck="PopulateRecentLinksContextMenu";ff.vck="PopulateRecentLinksContextMenuAction";ff.F7j="InsertRecentLinks";ff.G7j="InsertRecentLinksAction";Object(n.a)(ff,
"HyperlinkActor",null,[]);class IA{}IA.jmb=Object.freeze({gzm:"WordIndentationShortcutUsage"});IA.zB="wwaengidc";Object(n.a)(IA,"IndentationConstants",null,[]);class Km{static get qq(){return uu.a.TGb}static get ah(){return Im.ContextSetEditor.instance}static get Xf(){return xj.a.instance}static get Ic(){return Ih.a.instance}static get Nl(){return Hb.InteractiveViewManager.instance}static jx(){return Km.en||(Km.en=Ya.a.instance.Sa("Box4.IExternalSelectionManager"))}static get fzm(){return null!=Km.MBg?
Km.MBg:Km.MBg=Ya.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.bH,zc.a.view,Km.WGc);b.qa(Mb.a.bH,zc.a.KP,Km.mvh);b.Xc(Mb.a.bH,1036);b.qa(Mb.a.JO,zc.a.view,Km.WGc);b.qa(Mb.a.JO,zc.a.KP,Km.mvh);b.Xc(Mb.a.JO,1036)}static USn(b){const h=new Map;b=b?b.ja(Ng.a.rri,"Unknown"):"tab";h.set("actionCallSource",b);xa.Health.instance.recordKpiUsage(IA.jmb.gzm,1,IA.zB,h)}static WGc(b,h,r,B,P){const ca=h.view;if(!ca.ue)return 2;var ra=ca.mb;
if(!ra)return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.Fda}),8;ra=ra.qg;if(!ra)return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.noSelection}),8;if($i.a.via(h))return 8;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Km.Xf.Dcc(ra))return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),8;if(1===r)return 32;if(Km.ah.fEa(Km.S1e,ra))return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.SJc}),8;if(Km.ah.CAa(Td.ParagraphReader.PU,ra))return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),8;if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",
!1)&&Km.Xf.Dcc(ra))return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),8;if(Km.jx()&&Km.jx().instance&&Km.jx().instance.TU(ra))return Km.Ic.Yb(te.a.ef,{["Reason"]:fe.a.Y1a}),8;ra={};ra[Tr.a.mKa]=5794;ra[Tr.a.lKa]=5795;return Km.fzm.WGc(ca,b,h,r,B,P,ra)}static mvh(b,h,r,B,P){var ca,ra;if(h.contextId!==zc.a.KP)return 2;var Qa=h.clone().Zig();if(mi.TableReader.NDi(Qa)){if(Km.Xf.ODi(Qa))return Km.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),8}else if(Km.Xf.U4a(Qa))return Km.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),2;Qa=
new xd.GraphIterator;Qa.set(h.node);Pd.SelectionEditor.Bu(Qa);if(!Zf.OutlineElementReader.yh(Qa))return 2;let mb;switch(b){case Mb.a.bH:mb=Km.qq.jCb(Qa);break;case Mb.a.JO:mb=Km.qq.s4b(Qa);break;default:return 2}if(1===r||!mb)return mb?32:8;r=0;b===Mb.a.JO&&P&&P.ja(Zc.a.axh,!1)&&(r|=2);if(Zf.OutlineElementReader.YQ(Qa))return Km.Ic.Yb(te.a.wn,{["Reason"]:fe.a.zO}),2;(null===(ra=null===(ca=Km.Nl)||void 0===ca?void 0:ca.yd)||void 0===ra?0:ra.UU)&&Km.Nl.we&&(Km.Nl.we.qI=!0);switch(b){case Mb.a.bH:Km.qq.zTa(Qa,
-1,r);break;case Mb.a.JO:Km.qq.TLc(Qa,1)}B&&Ur.a.trb&&(B.Hs|=Ur.a.cjb(h.node,!0));Km.USn(P);return 32}}Km.en=null;Km.S1e=ye.ImageReader.i4a;Object(n.a)(Km,"IndentationActor",null,[]);var Lm=c(1605);class sl{static get Sk(){return null!=sl.YFg?sl.YFg:sl.YFg=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get Lk(){return null!=sl.hIg?sl.hIg:sl.hIg=Ya.a.instance.resolve("Box4.ITableEditor")}static get Xf(){return xj.a.instance}static get Ic(){return Ih.a.instance}static jx(){return sl.en||(sl.en=
Ya.a.instance.Sa("Box4.IExternalSelectionManager"))}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.ozj,zc.a.view,(h,r)=>$i.a.via(r)?8:32);b.qa(Mb.a.I9,zc.a.view,Lm.a.lw);b.qa(Mb.a.I9,zc.a.paragraph,sl.uDa);b.qa(Mb.a.I9,zc.a.table,sl.X2e);b.Xc(Mb.a.I9,1036);b.qa(Mb.a.Kba,zc.a.view,Lm.a.lw);b.qa(Mb.a.Kba,zc.a.paragraph,sl.uDa);b.qa(Mb.a.Kba,zc.a.table,sl.X2e);b.Xc(Mb.a.Kba,1036);b.qa(Mb.a.z$,zc.a.view,Lm.a.lw);b.qa(Mb.a.z$,zc.a.paragraph,sl.uDa);b.qa(Mb.a.z$,zc.a.table,sl.X2e);b.Xc(Mb.a.z$,
1036);b.qa(Mb.a.nFa,zc.a.view,Lm.a.lw);b.qa(Mb.a.nFa,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.nFa,1036);b.qa(Mb.a.vMc,zc.a.view,Lm.a.lw);b.qa(Mb.a.vMc,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.vMc,1036);b.qa(Mb.a.wKb,zc.a.view,Lm.a.lw);b.qa(Mb.a.wKb,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.wKb,1036);b.qa(Mb.a.k$c,zc.a.view,Lm.a.lw);b.qa(Mb.a.k$c,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.k$c,1036);b.qa(Mb.a.ifc,zc.a.view,Lm.a.lw);b.qa(Mb.a.ifc,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.ifc,1036);b.qa(Mb.a.K4b,zc.a.view,Lm.a.lw);b.qa(Mb.a.K4b,
zc.a.paragraph,sl.uDa);b.Xc(Mb.a.K4b,1036);b.qa(Mb.a.jkc,zc.a.view,Lm.a.lw);b.qa(Mb.a.jkc,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.jkc,1036);b.qa(Mb.a.g9b,zc.a.view,Lm.a.lw);b.qa(Mb.a.g9b,zc.a.paragraph,sl.uDa);b.Xc(Mb.a.g9b,1036)}static X2e(b,h,r,B){let P=!0;if(!h)return 8;mi.TableReader.NDi(h)?sl.Xf.ODi(h)?(sl.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),P=!1):sl.jx()&&sl.jx().instance&&sl.jx().instance.TU(h)&&(sl.Ic.Yb(te.a.wn,{["Reason"]:fe.a.Y1a}),P=!1):(sl.Ic.Yb(te.a.wn,{["Reason"]:fe.a.fhf}),P=!1);if(1===r||
!P)return P?32:8;h=h.node;switch(b){case Mb.a.I9:sl.Lk.pE(h,1);break;case Mb.a.Kba:sl.Lk.pE(h,2);break;case Mb.a.z$:sl.Lk.pE(h,3)}B&&Ur.a.trb&&(B.Hs|=2);return 32}static uDa(b,h,r,B,P){let ca=!0;h.contextId!==zc.a.paragraph?ca=!1:sl.Xf.U4a(h)?(sl.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),ca=!1):sl.jx()&&sl.jx().instance&&sl.jx().instance.TU(h)&&(sl.Ic.Yb(te.a.wn,{["Reason"]:fe.a.Y1a}),ca=!1);if(1===r||!ca)return ca?32:8;h=h.node;r=Td.ParagraphReader.Ox(h);switch(b){case Mb.a.I9:case Mb.a.ifc:sl.Sk.pE(h,
1===r&&sl.E1d(P)?6:1);break;case Mb.a.Kba:case Mb.a.K4b:sl.Sk.pE(h,2===r&&sl.E1d(P)?1:2);break;case Mb.a.z$:case Mb.a.jkc:sl.Sk.pE(h,3===r&&sl.E1d(P)?1:3);break;case Mb.a.nFa:case Mb.a.g9b:sl.Sk.pE(h,6===r&&sl.E1d(P)?1:6);break;case Mb.a.wKb:sl.Sk.pE(h,11);break;case Mb.a.vMc:sl.Sk.pE(h,7);break;case Mb.a.k$c:sl.Sk.pE(h,13)}B&&Ur.a.trb&&(B.Hs|=Ur.a.cjb(h));return 32}static E1d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}sl.en=null;
Object(n.a)(sl,"JustificationActor",null,[]);const KB=()=>{const b=v.AFrameworkApplication.va;b.qa(Mb.a.save,Gd.a.frame,JA);b.qa(Mb.a.sync,Gd.a.frame,Vy)},Vy=(b,h,r)=>{if(1===r)return 32;v.AFrameworkApplication.va.processAction(Mb.a.y4b,2);qe.App.li.sle();return 32},JA=(b,h,r)=>{if(1===r)return 2===ab.StaticActiveAppFrame.za().mode?32:8;v.AFrameworkApplication.va.processAction(Mb.a.y4b,2);if(2!==ab.StaticActiveAppFrame.za().mode)return 32;qe.App.li.zhj(null,null);return 32};class Bw{constructor(){this.activateRibbonTab=
(b,h,r,B,P)=>{qe.App.Iv.gJ.hfe(P.toString());return 32};this.z0m=(b,h,r,B,P)=>{v.AFrameworkApplication.hqa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");qe.App.Iv.gJ.yFi(1,P.toString());return 32};this.fwn=(b,h)=>{if(h.contextId!==Gd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.activateRibbonTab,zc.a.view,this.activateRibbonTab);b.Xc(Mb.a.activateRibbonTab,5);b.qa(Mb.a.zFi,zc.a.view,this.z0m);b.qa(Mb.a.nng,
Gd.a.frame,this.fwn)}static get instance(){return null!=Bw.nCg?Bw.nCg:Bw.nCg=Bw.fm()}static fm(){return new Bw}}Object(n.a)(Bw,"RibbonActor",null,[]);var ih=c(573);class zt{constructor(b,h){this.Pm=null;this.vSo=(r,B,P,ca,ra)=>{let Qa;ca=B.view;if(!ca.ue)return zt.Ic.Yb(te.a.ef,{["Reason"]:fe.a.gMb}),8;Qa=r===Mb.a.undo?this.vg.oY:this.vg.OQa;if(1===P)return $i.a.via(B)&&$i.a.Tcc()?8:Qa?32:8;if(!Qa)return t.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===Mb.a.undo?"undo":
"redo"),this.VKa.value.nEj(),zt.Ic.Yb(te.a.ef,{["Reason"]:fe.a.pSo}),2;B=new sg.GraphTransaction(3);B.Db(ca.ed);B.Gge();r=r===Mb.a.undo?this.vg.undo():this.vg.Gja();B.dispose();ra&&Iy.GrippersManager.instance.cTb(ra.Ux);if(r)return 32;zt.Ic.Yb(te.a.l7b,{["Reason"]:fe.a.YRi});return 8};this.Nma=b;this.VKa=h}get vg(){return this.Pm||(this.Pm=this.Nma())}Ub(){const b=v.AFrameworkApplication.va,h=this.vSo;b.fb(Mb.a.undo,zc.a.view,h,1028);b.fb(Mb.a.Gja,zc.a.view,h,1028)}static get instance(){return null!=
zt.YBg?zt.YBg:zt.YBg=zt.fm()}static fm(){const b=Ya.a.instance;return new zt(()=>b.resolve("Box4.IUndoManager"),b.Ve("Box4.ICoauthCashTelemetry"))}static get Ic(){return Ih.a.instance}}Object(n.a)(zt,"UndoActor",null,[]);class tq{constructor(){this.W=null}get name(){return"Box4.Actors"}wc(b){this.W=b;(new zu).wc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Object(Jx.a)()&&this.W.resolve("Box4.Actors.PageColorActor").Ub();b.Ub();b.F5();Li();gt.instance.Ub();ff.Ub();Km.Ub();sl.Ub();
this.W.resolve("Box4.Actors.TouchInputActor").Ub();Aw.instance.Ub();this.W.resolve("Box4.ISelectAllHandlers").Ub();KB();this.W.resolve("Box4.Actors.ProofingActor").Ub();Bw.instance.Ub();(b=this.W.Oa("Box4.IFeatureHelper"))?b.pq.continueWith(()=>{this.p$i()}):this.p$i();ih.a.Ub(qe.App.wVa);this.W.resolve("Box4.Actors.TextFormattingActor").Ub();zt.instance.Ub();this.W.resolve("Box4.Actors.AccessibilityActor").l7f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");
ab.StaticActiveAppFrame.za().updateCommandUI()}p$i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Ub();this.W.resolve("Box4.Actors.StyleActor").Ub()}dispose(){}static main(){L.a.instance.Gc(new tq)}}Object(n.a)(tq,"Box4ActorsPackage",null,[1,2]);class LB extends hi{constructor(b,h,r,B){super(b);this.poa=r;this.H7a=B;this.btg=0;this.YA=h.DSa("UserAction","WordOnlineAddToDictionary")}Lfg(b){this.CNd=this.poa.Hoa(b);if(!this.cWk())return!1;const h=this.CNd.errorDetails.token;this.H7a.Jqh(h);if(!this.H7a.Xbd(h))return t.ULS.sendTraceTag(541618644,
375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;t.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.YA.start();this.transaction=new sg.GraphTransaction(15);this.transaction.Db(b.node);return!0}Zae(b){this.cOb(b.node);return!0}Q4c(b){this.cOb(b);return!0}$ae(b){this.cOb(b.node)}Slg(b){this.transaction.dispose();this.CNd.errorDetails.Jrb(b.actionId);this.H7a.xbg("unused corelation id.");this.YA.stop();t.ULS.sendTraceTag(541618646,
375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.btg,this.YA.pi,this.CNd.errorDetails.proofingType));return!0}Bmc(b,h){const r=b.role;return super.Bmc(b,h)||9===r||10===r||13===r||7===r||8===r}cOb(b){if(b){var h=this.poa.G4(b,r=>this.H7a.Xbd(r.errorDetails.token));this.poa.ppb(b,h,!0);this.btg+=h.length}}cWk(){var b,h;return null!==(h=null===(b=this.CNd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(t.ULS.sendTraceTag(541618647,
375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(n.a)(LB,"AddToDictionaryCallbackSteps",hi,[]);class nx{constructor(b,h,r,B,P,ca,ra){this.oc=b;this.mb=h;this.VP=r;this.poa=B;this.eq=P;this.H7a=ca;this.$Kn=ra;this.$nm=(Qa,mb,Jb,Yb,fc,Mc)=>{const Wc=new LB(this.VP,this.eq,this.poa,this.H7a);return new Qy(Qa,mb,Jb,Yb,fc,Mc,Wc,this.oc,this.mb,this.VP,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Ub(){this.oc.KT(Mb.a.addToDictionary,zc.a.view,this.$nm,
1124);this.$Kn.DYn(this.H7a)}}Object(n.a)(nx,"PersonalDictionaryOrchestrator",null,[]);class MB{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=b;b.register(nx,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Ud(()=>new nx(v.AFrameworkApplication.va,lh.a.instance,Fr.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Ub()}dispose(){}static main(){Qk.a.get_instance().pk(7,
()=>{L.a.instance.Gc(new MB)})}}Object(n.a)(MB,"PersonalDictionaryPackage",null,[1,2]);var ro=c(178);class At{constructor(b,h,r,B,P,ca){this.TBa=this.aab=this.gW=null;this.vIc=(ra,Qa,mb,Jb,Yb)=>this.eDi(Qa,mb,Yb,!1)?32:8;this.WK=(ra,Qa,mb,Jb,Yb)=>{if(!({Dy:ra}=this.Iqj(Qa,mb,Yb,!0)).returnValue)return ra;t.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Yb=this.Ymk.pva(Qa.node,Yb);this.kDn(Qa.node,Yb);this.jQ();return 32};this.yCb=(ra,Qa,mb,Jb,Yb)=>
{if(!({Dy:ra}=this.Iqj(Qa,mb,Yb,!1)).returnValue)return ra;this.gDn(Qa.node);return 32};this.gMn=(ra,Qa,mb,Jb,Yb)=>{if(1===mb)return 32;if(!Qa||!Qa.view.ue)return 2;ra=Qa.view.mb;if(!ra)return 2;ra=ra.qg;if(!ra)return 2;ra=At.ah.pR(ra,16);if(!ra||!ra.length)return 2;Qa=null;for(mb=0;mb<ra.length;mb++){Jb=ra.getContext(mb);if(!Jb||Jb.contextId!==zc.a.Jw)return 2;const fc={};this.Vmi(Jb,fc);if(fc.CellShading)if(Qa&&Qa!==fc.CellShading){Qa=null;break}else Qa=fc.CellShading;else{Qa=null;break}}Yb.CellShading=
Qa;return 32};this.mOb=(ra,Qa,mb,Jb,Yb)=>1===mb?32:this.Vmi(Qa,Yb);this.INb=(ra,Qa,mb,Jb,Yb)=>{if(1===mb)return 32;ra=Qa.contextId===zc.a.view?this.mCa.ETd(Qa):this.Ftf(Qa);mb={};Qa=null;32===v.AFrameworkApplication.va.Qb(Mb.a.mOb,2,mb)&&mb&&(Qa=mb.CellShading);mb="";Qa&&(mb=$f.a.eF(Qa)||"");this.Fpj.$Pb=mb;this.hYc&&this.u1.Roe(mb);ra=this.Fpj.pPc(ra,qe.App.FCb);if(!ra)return 8;Yb.MenuItems=ra;t.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.jja=(ra,Qa,
mb,Jb,Yb)=>{if(1===mb)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();v.AFrameworkApplication.va.Qb(Mb.a.mOb,2,Yb);this.aab=new Vt.a("Shading",Mb.a.glc);this.aab.bmc(Yb&&Yb.CellShading?Yb.CellShading:0);return 32};this.XUk=(ra,Qa,mb,Jb,Yb)=>{if(1===mb)return 32;v.AFrameworkApplication.va.Qb(Mb.a.F$,2,Yb);this.u1.F_a(Yb)||t.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.Ymk=h;this.WKe=r;this.mCa=B;this.Vd=P;this.zq=
ca}get u1(){return null!=this.GGg?this.GGg:this.GGg=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get Fpj(){this.gW||(this.gW=new hv.a("Shading"),this.kGa(this.gW));return this.gW}kGa(b){b.pX(2,Mb.a.yCb);b.pX(3,Mb.a.F$);b.pX(4,Mb.a.F$);b.aBb(this.WKe,1)}Ub(){this.ga.qa(Mb.a.INb,zc.a.view,this.INb);this.ga.qa(Mb.a.INb,zc.a.Jw,this.INb);this.ga.Xc(Mb.a.INb,1126);this.ga.qa(Mb.a.vIc,zc.a.view,ih.a.tPc);this.ga.qa(Mb.a.vIc,zc.a.Jw,this.vIc);this.ga.Xc(Mb.a.vIc,1028);this.ga.qa(Mb.a.F$,zc.a.view,
ih.a.tPc);this.ga.qa(Mb.a.F$,zc.a.Jw,this.WK);this.ga.Xc(Mb.a.F$,1028);this.ga.qa(Mb.a.yCb,zc.a.view,ih.a.tPc);this.ga.qa(Mb.a.yCb,zc.a.Jw,this.yCb);this.ga.Xc(Mb.a.yCb,1028);this.ga.qa(Mb.a.mOb,zc.a.view,this.gMn);this.ga.qa(Mb.a.mOb,zc.a.Jw,this.mOb);this.ga.Xc(Mb.a.mOb,1124);this.ga.qa(Mb.a.glc,zc.a.view,ih.a.tPc);this.ga.qa(Mb.a.glc,zc.a.Jw,this.XUk);this.ga.Xc(Mb.a.glc,1028);this.ga.qa(Mb.a.UZf,zc.a.view,this.jja);this.ga.Xc(Mb.a.UZf,1028)}jQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}Iqj(b,h,r,B){return this.eDi(b,h,r,B)?{returnValue:2===h,Dy:32}:(2==h&&ih.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],fe.a.EBl),{returnValue:!1,Dy:8})}eDi(b,h,r,B){return b.contextId!==zc.a.Jw||2===h&&(B&&!r||!b.node)?!1:!0}kDn(b,h){const r=new sg.GraphTransaction(15);
r.Db(b);this.moj(b);b.properties.setValue(Pe.a.WK,h);r.dispose()}gDn(b){const h=new sg.GraphTransaction(15);h.Db(b);this.moj(b);b.properties.removeProperty(Pe.a.WK);h.dispose()}Ftf(b){return b.contextId!==zc.a.Jw?null:(b=At.hi.uu(b.node))?b:null}moj(b){if(this.Vd&&this.Vd.yg&&(b=Object(Na.a)(Hz.TableCellNode,b))){const h=b.qV();this.zq.i$c(b,h)}}Vmi(b,h){if(b.contextId!==zc.a.Jw)return 8;(b=b.node)&&b.hasProperty(Pe.a.WK)&&(h.CellShading=b.getValue(Pe.a.WK));return 32}static nRl(){return new At(v.AFrameworkApplication.va,
Il.a.instance,Fs.a.instance,Qh.PageReader.instance,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get hi(){return ro.PageNavigator.instance}static get ah(){return null!=At.gyg?At.gyg:At.gyg=Im.ContextSetEditor.instance}static get instance(){return null!=At.sDg?At.sDg:At.sDg=At.nRl()}get hYc(){null==this.TBa&&(v.AFrameworkApplication.se("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),
this.TBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.TBa}}Object(n.a)(At,"CellShadingActor",null,[]);class dy{constructor(){this.W=null}get name(){return"Box4.CellShading"}wc(b){this.W=b}init(){const b=this.W.Oa("Box4.IFeatureHelper");b?b.pq.continueWith(()=>{this.xn()}):this.xn()}xn(){At.instance.Ub();ab.StaticActiveAppFrame.za().updateCommandUI()}dispose(){}}Object(n.a)(dy,"CellShadingPackage",
null,[1,2]);var ht;(function(b){b[b.none=0]="none";b[b.AFo=1]="style1";b[b.BFo=2]="style2";b[b.CFo=3]="style3";b[b.DFo=4]="style4";b[b.EFo=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(ht||(ht={}));Object(n.b)("ListStyle",ht);const Xt={[ht.AFo]:{[1]:"disc",[0]:"decimal"},[ht.BFo]:{[1]:"circle",[0]:"lower-alpha"},[ht.CFo]:{[1]:"square",[0]:"lower-roman"},[ht.DFo]:{[0]:"upper-alpha"},[ht.EFo]:{[0]:"upper-roman"},[ht.bullet]:{[1]:"bullet"}};var Au;(function(b){b[b.number=0]="number";
b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(Au||(Au={}));Object(n.b)("ListType",Au);var KA=c(1644);class Fo{constructor(b,h){this.YB=this.a_c=null;this.levelText=b;this.font=h}get Qae(){return this.levelText}get listStyle(){return 6}get zw(){return"left"}}Object(n.a)(Fo,"ListMarkerBullet",null,[379]);class Ci{static get Zm(){return null!=Ci.tEg?Ci.tEg:Ci.tEg=Ya.a.instance.resolve("Box4.List.IListEditor")}static get Jd(){return Ci.Hf||
(Ci.Hf=Ya.a.instance.resolve("Box4.List.IListReader"))}static set Jd(b){Ci.Hf=b}static get Cj(){return null!=Ci.RBg?Ci.RBg:Ci.RBg=Ya.a.instance.resolve("Box4.IInsertionPointFormatting")}static jx(){return Ci.en||(Ci.en=Ya.a.instance.Sa("Box4.IExternalSelectionManager"))}static get ah(){return Im.ContextSetEditor.instance}static get Xf(){return xj.a.instance}static get Ic(){return Ih.a.instance}static get Jo(){return oj.a.getInstance()}static get Dad(){return null!=Ci.mHg?Ci.mHg:Ci.mHg=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Ub(){const b=
v.AFrameworkApplication.va;b.qa(Mb.a.qD,zc.a.view,Ci.SGc);b.qa(Mb.a.qD,zc.a.KP,Ci.Zma);b.Xc(Mb.a.qD,1036);b.qa(Mb.a.ML,zc.a.view,Ci.SGc);b.qa(Mb.a.ML,zc.a.KP,Ci.Zma);b.Xc(Mb.a.ML,1036);b.qa(Mb.a.Dda,zc.a.view,Ci.SGc);b.qa(Mb.a.Dda,zc.a.KP,Ci.Zma);b.Xc(Mb.a.Dda,1036);b.qa(Mb.a.J2e,zc.a.view,nd.ActionManager.Nf);b.qa(Mb.a.oFh,zc.a.view,nd.ActionManager.Nf);b.qa(Mb.a.HJf,zc.a.view,Ci.H6n);b.qa(Mb.a.t2e,zc.a.view,nd.ActionManager.Nf);b.qa(Mb.a.L2e,zc.a.view,nd.ActionManager.Nf);b.qa(Mb.a.Tkg,zc.a.view,
nd.ActionManager.Nf);b.qa(Mb.a.Xxj,zc.a.view,nd.ActionManager.Nf);b.qa(Mb.a.Pne,zc.a.view,nd.ActionManager.Nf)}static H6n(){KA.a.Jej();return 32}static SGc(b,h,r,B,P){var ca,ra,Qa;if(!h.view.ue)return 2;const mb=Ci.Ic.Fp(Mb.a.SGc);B.Hs=42;B.NC=42;const Jb={[Tr.a.mKa]:5796,[Tr.a.lKa]:5797};var Yb=h.view;if(Ci.ah.fEa(Ci.Cxm,Yb.mb.qg))return Ci.Ic.Yb(te.a.ef,{["Reason"]:fe.a.N$e}),mb.end(),8;if(Ci.ah.fEa(Ci.S1e,Yb.mb.qg))return Ci.Ic.Yb(te.a.ef,{["Reason"]:fe.a.SJc}),mb.end(),8;if(Ci.ah.CAa(Td.ParagraphReader.PU,
Yb.mb.qg))return Ci.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),mb.end(),8;if(Ci.Xf.Dcc(Yb.mb.qg))return Ci.Ic.Yb(te.a.ef,{["Reason"]:fe.a.cF}),mb.end(),8;if(null===(ra=null===(ca=Ci.jx())||void 0===ca?void 0:ca.instance)||void 0===ra?0:ra.TU(h))return Ci.Ic.Yb(te.a.ef,{["Reason"]:fe.a.Y1a}),mb.end(),8;if(1===r)return mb.end(),32;P||(P=new wc.DictionaryPropertySet);ca=null;if(2===r){ca=new sg.GraphTransaction(15);ca.Db(h.view.ed);Ci.IYc=!1;ra=Py.OutlineElementGeneralizer.Cha(Yb.mb.ib,!1);if(!ra)return ca.dispose(),
Ci.Ic.Yb(te.a.soa,{["Reason"]:fe.a.kOd}),mb.end(),8;1<ra.length&&P.setValue(Zc.a.ZQi,null);const fc=P.ja(Zc.a.PJ,-1),Mc=P.ja(Zc.a.MA,-1);null===(Qa=Ci.Dad)||void 0===Qa?void 0:Qa.BXk(ra);if(Qa=Ci.kso(fc,Mc,ra))P.setValue(Zc.a.MA,16),P.setValue(Zc.a.qSa,0);if(!Pd.SelectionEditor.Ze(Yb.mb.qg)&&!Qa&&0<ra.length&&fc){Yb=new xd.GraphIterator;Qa=Array(ra.length);for(let Wc=0;Wc<ra.length;Wc++)Yb.set(ra.getContext(Wc).node),Qa[Wc]=Ci.Jd.ww(Yb);Ci.jso(Qa,P)&&(Yb=new wc.DictionaryPropertySet,Yb.setValue(Zc.a.MA,
16),Yb.setValue(Zc.a.qSa,0),oj.a.GY&&(Yb.setValue(Ng.a.eqa,"clean-list-before-apply-new-list-style"),Yb.setValue(Ng.a.Mia,P.ja(Ng.a.eqa,"unknown")+"@"+P.ja(Ng.a.Mia,"undefined"))),Tr.a.Mqa(b,h,r,B,Yb,Jb,11),v.AFrameworkApplication.va.processAction(Mb.a.Xxj,2),t.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Ci.IYc=!0)}Yb=new xd.GraphIterator;Yb.set(ra.getContext(0).node);Yb=Ci.Jd.ww(Yb);Ci.S6m(fc,Mc,Yb,ra.length)}b=Tr.a.Mqa(b,h,r,B,P,Jb,11);32===b&&P.ja(Zc.a.axh,
!1)&&(b=Tr.a.Mqa(Mb.a.JO,h,r,B,P,Jb,11));ca&&ca.dispose();mb.end();return b}static jso(b,h){let r=null;var B=!1;for(let P=b.length-1;0<=P&&(r?(B=b[P],B=-1!==h.ja(Zc.a.PJ,-3)?B?r.listType!==B.listType||r.listStyle!==B.listStyle:!0:B?r.listType!==B.listType:!0):r=b[P],!B);P--);return r&&(b=!1,B||(b=h.ja(Zc.a.MA,42),h=h.ja(Zc.a.PJ,-3),b=b!==r.listType||0<h),B||b)?!0:!1}static S6m(b,h,r,B){0>=B||Ci.IYc||(b?r?(r=r.listType,-1===b&&h===r?(v.AFrameworkApplication.va.processAction(Mb.a.Pne,2),t.ULS.sendTraceTag(39715535,
393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(v.AFrameworkApplication.va.processAction(h?Mb.a.t2e:Mb.a.L2e,2),t.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(v.AFrameworkApplication.va.processAction(h?Mb.a.t2e:Mb.a.L2e,2),Ci.dPo(),t.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(v.AFrameworkApplication.va.processAction(Mb.a.Pne,2),t.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static kso(b,
h,r){if(-1!==b&&b||!r.length)return!1;b=new xd.GraphIterator;let B=null;for(let P=r.length-1;0<=P&&!(b.set(r.getContext(P).node),B=Ci.Jd.ww(b));P--);return B&&h===B.listType?!0:!1}static Zma(b,h,r,B,P){var ca;if(h.contextId!==zc.a.KP)return 2;var ra=h.clone().Zig();if(Ci.Xf.U4a(ra))return Ci.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),2;const Qa=new xd.GraphIterator;Qa.set(h.node);Pd.SelectionEditor.Bu(Qa);if(!Zf.OutlineElementReader.yh(Qa))return 2;if(1===r)switch(b){case Mb.a.qD:return 32;case Mb.a.ML:return 32;
case Mb.a.Dda:return 32;default:return 2}if(Zf.OutlineElementReader.YQ(Qa))return Ci.Ic.Yb(te.a.wn,{["Reason"]:fe.a.zO}),2;h=Ci.Jd.ww(Qa);var mb;oj.a.GY&&(mb=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Jb=P;if(!Jb)return 8;b===Mb.a.ML||b===Mb.a.qD||b===Mb.a.Dda?(Jb=Ci.Zm.HNc(b,Jb),ra=Kp.a.IX(Jb.getValue(Zc.a.MA),Jb.getValue(Zc.a.qSa))):ra=null;Ci.Z0(b,Jb);Ci.Clo(ra,Jb);let Yb=!1;b===Mb.a.qD&&Jb&&(Jb.hasProperty(Oc.a.Ot)&&(ra.levelText=Jb.ja(Oc.a.Ot,"")),Jb.hasProperty(Pe.a.font)&&(ra.font=
Jb.ja(Pe.a.font,"")),Jb.hasProperty(Zc.a.Rmf)&&(Yb=Jb.ja(Zc.a.Rmf,!1)));Ci.mno(Jb,Qa);ra=Ci.Zm.Zma(Jb,Qa,ra,Yb);if(!ra.returnValue)return Ci.Ic.Yb(te.a.wn,{["Reason"]:fe.a.JLf}),2;ra=ra.wxa;oj.a.GY&&Ci.$Sn(P,mb,ra);2===r&&(r=P.ja(Zc.a.MA,-1),ra&&-1!==r&&((mb=P.ja(Oc.a.ks,"Invalid MultiLevel Type"),b===Mb.a.ML&&t.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===P||void 0===P?void 0:P.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,
["listStyle"]:ht[null==(null===h||void 0===h?void 0:h.listStyle)?null===ra||void 0===ra?void 0:ra.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:Au[null==(null===h||void 0===h?void 0:h.listType)?null===ra||void 0===ra?void 0:ra.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ra||void 0===ra?void 0:ra.listType)})),h)?ra.listType&&1!==ra.listType||Ci.IYc||(v.AFrameworkApplication.va.processAction(Mb.a.Tkg,2),t.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",
r?"Bullet":"Numbering",mb)):16===ra.listType?(v.AFrameworkApplication.va.processAction(Mb.a.oFh,2),t.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",mb)):ra.listType&&1!==ra.listType||Ci.IYc||(v.AFrameworkApplication.va.processAction(Mb.a.J2e,2),t.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",mb))),(b=kb.FocusManager.instance())&&b.currentScope&&b.currentScope.name===xk.AppFrame.jra&&b.jD(Zd.AFrame.In));
B.Hs=ra.listType;B.NC=ra.listStyle;(null===(ca=v.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("List");return 32}static $Sn(b,h,r){var B,P,ca,ra,Qa,mb,Jb,Yb;const fc=new Map;fc.set("actionCallSource",b.ja(Ng.a.eqa,"unknown"));fc.set("actionCallSourceTrigger",b.ja(Ng.a.Mia,"undefined"));fc.set("fromListType",Au[null!==(B=null===h||void 0===h?void 0:h.listType)&&void 0!==B?B:16]);fc.set("fromListStyle",ht[null!==
(P=null===h||void 0===h?void 0:h.listStyle)&&void 0!==P?P:0]);fc.set("fromListMarkerType",null!==(Qa=k(null!==(ca=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ca?ca:0,null!==(ra=null===h||void 0===h?void 0:h.listType)&&void 0!==ra?ra:16))&&void 0!==Qa?Qa:"undefined");fc.set("fromLevelText",(null===h||void 0===h?0:h.Kca)?h.levelText:"undefined");fc.set("toListType",null!==(mb=Au[null===r||void 0===r?void 0:r.listType])&&void 0!==mb?mb:"undefined");fc.set("toListStyle",null!==(Jb=ht[null===r||
void 0===r?void 0:r.listStyle])&&void 0!==Jb?Jb:"undefined");fc.set("toListMarkerType",null!==(Yb=k(null===r||void 0===r?void 0:r.listStyle,null===r||void 0===r?void 0:r.listType))&&void 0!==Yb?Yb:"undefined");fc.set("toLevelText",(null===r||void 0===r?0:r.Kca)?r.levelText:"undefined");xa.Health.instance.recordKpiUsage(ti.a.jmb.G2m,0,ti.a.zB,fc)}static mno(b,h){var r=new xd.GraphIterator;r.kd(h);(h=r.Tb(2))&&Td.ParagraphReader.Xb(h)&&(r=lh.a.instance.ib.lb)&&r.Pa&&r.Pa.node===h&&Pd.SelectionEditor.d1d(r)&&
(Ci.Ojo(b),Ci.Mjo(b))}static Clo(b,h){h.hasProperty(Oc.a.ks)&&b.zhe(h.getValue(Oc.a.ks));h.hasProperty(Ng.a.MQ)&&(b.MQ=h.getValue(Ng.a.MQ));h.hasProperty(Oc.a.Ot)&&(b.levelText=h.getValue(Oc.a.Ot));b.PJ=h.ja(Zc.a.PJ,-1);let r=null;b.Rpa&&(r=Ci.M3l(b,h));b.Rpa&&r?Ci.hno(b,r):(b.Rpa?t.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.PJ,b.ks,b.Mz):t.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),
Ci.Cio(b))}static Cio(b){if(b.Mz)b.zWd&&-1===b.PJ||(b.levelText="%1.",b.propertySet.hasProperty(Pe.a.m5)||b.I$(0,1));else if(1===b.listType)b.zWd&&-1===b.PJ||(b.font=ti.a.ELc,b.levelText=ti.a.KKd,b.propertySet.hasProperty(Pe.a.m5)||b.I$(1,6));else return;b.zw="left"}static hno(b,h){1===b.ks?Ci.Ylo(b,h):Ci.mko(b,h)}static Ylo(b,h){(b.YB=h.YB)?b.o6=h.YB.o6:h.YB||t.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
b.PJ,b.ks,b.Mz)}static mko(b,h){b.levelText=h.levelText;b.Mz?b.I$(0,h.listStyle):(b.font=h.font,b.I$(1,1));b.zw=h.zw}static M3l(b,h){let r=null;2===b.ks?r=b.Mz?Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.ks&&(r=Ya.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let B=r.aLb.value;const P=b.PJ+"";P in B||(B=r.K9,t.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
P,b.ks,b.Mz));if(!(P in B)){t.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",P,b.ks,b.Mz);if(h.hasProperty(Pe.a.font))return t.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",P,b.ks,b.Mz),b=h.ja(Pe.a.font,""),new Fo(E.a.fromCharCode(parseInt(P)),b);t.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
P,b.ks,b.Mz)}return B[P]}static Mjo(b){Ci.Cj.hasProperty(Pe.a.fontColor)&&b.setValue(Pe.a.fontColor,Ci.Cj.fontColor())}static Ojo(b){Ci.Cj.hasProperty(Pe.a.fontSize)&&b.setValue(Pe.a.fontSize,Ci.Cj.fontSize())}static Z0(b,h){b=b===Mb.a.qD?0:b===Mb.a.ML?1:b===Mb.a.Dda?2:-1;h=h.ja(Zc.a.PJ,-1);t.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static dPo(){const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");if(b){var h=v.AFrameworkApplication.K.nc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else t.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Ci.Cxm=ye.ImageReader.cXc;Ci.S1e=ye.ImageReader.i4a;Ci.Hf=null;Ci.en=null;Ci.IYc=!1;Object(n.a)(Ci,"ListActor",null,[]);class Cw{constructor(){this.aLb=new zf.a(()=>this.Sbf());this.K9={}}I4h(b){return b}}Object(n.a)(Cw,"AListMarkerGalleryLoader",null,[383]);var Bt=c(1402),
Lx=c(445);class Ln extends Cw{constructor(){super();this.axb=new bd.a(Pa.a.ih())}I4h(b){Ln.OQ||this.Aho();b in Ln.OQ&&(b=Ln.OQ[b]);return b}Sbf(){const b={};b["0"]=new Fo(Box4Intl.Box4Strings.L_ListStyleNone,Bt.a.Fui);b["1"]=new Fo(String.fromCharCode(61623),"Symbol");b["2"]=new Fo(String.fromCharCode(111),"Courier New");b["3"]=new Fo(String.fromCharCode(61607),"Wingdings");b["4"]=new Fo(String.fromCharCode(9643),"Courier New");b["5"]=new Fo(String.fromCharCode(61611),"Wingdings");b["6"]=new Fo(String.fromCharCode(61614),
"Symbol");b["7"]=new Fo(String.fromCharCode(61483),"Symbol");b["8"]=new Fo(String.fromCharCode(61485),"Symbol");b["9"]=new Fo(String.fromCharCode(9830),"Courier New");b["10"]=new Fo(String.fromCharCode(61664),"Symbol");b["11"]=new Fo(String.fromCharCode(61558),"Wingdings");b["12"]=new Fo(String.fromCharCode(61656),"Wingdings");b["13"]=new Fo(String.fromCharCode(61514),"Wingdings");b["14"]=new Fo(String.fromCharCode(61516),"Wingdings");b["15"]=new Fo(String.fromCharCode(61692),"Wingdings");b["16"]=
new Fo(String.fromCharCode(61691),"Wingdings");b["17"]=new Fo(String.fromCharCode(61553),"Wingdings");return b}Doe(b){b&&b.length&&this.$5e(b)}C2f(){if(this.K9){var b=Lx.a(this.K9),h=b.length;for(let r=0;r<h;r++){const B=this.K9[b[r]];this.axb.add(B.levelText+"_"+B.font)}}}$5e(b){this.C2f();for(const h of b)if(h&&!h.Mz&&h.Kca&&h.oTc&&(b=h.levelText+"_"+h.font,!this.axb.contains(b))){const r=Lx.a(this.K9).length+Lx.a(this.aLb.value).length+"";this.K9[r]=new Fo(h.levelText,h.font);this.axb.add(b)}}Aho(){Ln.OQ=
{};Ln.OQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Ln.OQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Ln.OQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Ln.OQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Ln.OQ["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Ln.OQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Ln.OQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Ln.OQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Ln.OQ["Courier New 0x2666"]=
Box4Intl.Box4Strings.L_BlackDiamond;Ln.OQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Ln.OQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Ln.OQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Ln.OQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;Ln.OQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Ln.OQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Ln.OQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Ln.OQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}
Ln.OQ=null;Object(n.a)(Ln,"ListMarkerBulletLoader",Cw,[]);class uq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(uq,"InfoAtLevel",null,[]);class Pv{constructor(b){this.YB=b}get font(){return"Calibri"}get listStyle(){return 42}get zw(){return"left"}get Qae(){return this.YB?this.gIn():this.iIn()}get a_c(){return this.YB?this.hIn():null}get levelText(){return""}XYl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}gIn(){let b=
"";for(let h=0;3>h;h++)b+=this.SRc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Pv.eqf(),b)}hIn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new uq,{textAtLevel:this.wfi(h),styleAtLevel:this.bgm(h)}));return b}iIn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Pv.fqf(),Box4Intl.Box4Strings.L_ListStyleNone)}wfi(b){b=this.YB.b_c[b];for(let h=0;9>h;h++)b=E.a.replaceAll(b,"%"+(h+1),this.XYl(this.YB.dLb[h]));return b}bgm(b){const h=
{};h.fontFamily=6===this.YB.dLb[b]?this.YB.lFa[b]:this.font;return h}SRc(b){const h=this.wfi(b),r=new Sys.StringBuilder;6===this.YB.dLb[b]&&r.append(String.format("font-family:{0};",this.YB.lFa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static eqf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static fqf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Pv,"ListMarkerMultilevel",null,[379]);var Sz=c(1415);class iv extends Cw{constructor(){super()}Sbf(){const b=new Sz.a,h={};h["0"]=new Pv(null);h["1"]=new Pv(b.obf());h["2"]=new Pv(b.fcf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Pv(b.LLh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}Doe(){}}Object(n.a)(iv,"ListMarkerMultilevelLoader",Cw,[]);var bp=c(140);class Wn{constructor(b,h){this.YB=null;this.levelText=b;this.grd=h}get font(){return"Calibri"}get listStyle(){return this.grd}get zw(){switch(this.grd){case 3:case 5:return"right";default:return"left"}}get Qae(){switch(this.grd){case 1:return this.Jic("1",
"2","3");case 2:return this.Jic("a","b","c");case 3:return this.Jic("i","ii","iii");case 4:return this.Jic("A","B","C");case 5:return this.Jic("I","II","III");case 0:return this.jIn();default:return this.Jic("1","2","3")}}get a_c(){const b=[],h={};h.fontFamily=bp.FontUtils.jEa(this.font);switch(this.grd){case 1:return b.push(Object.assign(new uq,{textAtLevel:this.hY("1"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("2"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new uq,{textAtLevel:this.hY("a"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("b"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new uq,{textAtLevel:this.hY("i"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("ii"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new uq,
{textAtLevel:this.hY("A"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("B"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new uq,{textAtLevel:this.hY("I"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("II"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new uq,{textAtLevel:this.hY("1"),
styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("2"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.hY("3"),styleAtLevel:h})),b}}Jic(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Wn.eqf(),this.SRc(b),this.SRc(h),this.SRc(r))}jIn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Wn.fqf(),Box4Intl.Box4Strings.L_ListStyleNone)}SRc(b){b=this.hY(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}hY(b){return E.a.replaceAll(this.levelText,"%1",b)}static eqf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static fqf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Wn,"ListMarkerNumbering",null,[379]);class Qv extends Cw{constructor(){super();this.axb=new bd.a(Pa.a.ih())}BVm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Sbf(){const b=
{};b["0"]=new Wn(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Wn("%1.",5);b["2"]=new Wn("%1.",4);b["3"]=new Wn("%1.",1);b["4"]=new Wn("%1.",2);b["5"]=new Wn("%1.",3);b["6"]=new Wn("%1)",5);b["7"]=new Wn("%1)",4);b["8"]=new Wn("%1)",1);b["9"]=new Wn("%1)",2);b["10"]=new Wn("%1)",3);b["11"]=new Wn("(%1)",5);b["12"]=new Wn("(%1)",4);b["13"]=new Wn("(%1)",1);b["14"]=new Wn("(%1)",2);b["15"]=new Wn("(%1)",3);return b}Doe(b){b&&b.length&&this.$5e(b)}C2f(){if(this.K9){var b=Lx.a(this.K9),h=b.length;
for(let r=0;r<h;r++){const B=this.K9[b[r]];this.axb.add(B.levelText+"_"+B.listStyle)}}}$5e(b){this.C2f();for(const h of b)if(h&&h.Mz&&h.Kca&&this.BVm(h.levelText)&&h.listStyle&&(b=Bt.a.Fnf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.axb.contains(r)){const B=Lx.a(this.K9).length+Lx.a(this.aLb.value).length+"";this.K9[B]=new Wn(b,h.listStyle)}this.axb.add(r)}}}Object(n.a)(Qv,"ListMarkerNumberingLoader",Cw,[]);class ey{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Ci.Ub()}dispose(){}wc(b){this.W=
b;this.W.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Ln).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Qv).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new iv).ha()}static main(){L.a.instance.Gc(new ey)}}Object(n.a)(ey,"Box4ListMarkerPackage",null,[1,2]);class rs{static get Vg(){return Pf.a.Nx(rs.Wm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}rs.Wm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(n.a)(rs,"DefineNewBulletDialogHtml",null,[]);class lr extends Pf.a{constructor(b,h,r,B){super();this.Syc=this.YJe=this.$Yb=this.TYb=null;this.Hxb=0;this.mHc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.asi=!0;this.ckl=P=>{if(this.TYb&&P.target!==this.TYb){const ca=this.focusManager.at();ca&&ca.hk&&(ca.hk.iz(P.target),this.TYb=P.target)}this.Nun(P.target.id)};this.q2m=P=>{P=P.yf;if(!this.SEi(P))return!1;this.focusManager.at().hk.iz(P);P.focus();return!0};this.r2m=P=>{var ca=
P.yf;if(!this.SEi(ca))return!1;var ra=ca.id;ra=parseInt(ra.substr(ra.lastIndexOf("_")+1))-this.Hxb;if(P.Hb.ctrlKey||P.Hb.altKey||P.Hb.keyCode>=kc.a.kUb&&P.Hb.keyCode<=kc.a.lUb)return!1;const Qa=P.Hb.keyCode;if(P.eventName===Xc.a.gi){P=-1;if(Qa===Sys.UI.Key.enter)return this.focusManager.at().hk.iz(ca),ca.focus(),this.lWi(ca.id),this.hide(),!0;Qa===Sys.UI.Key.up?P=ra-17:Qa===Sys.UI.Key.down?P=ra+17:Qa===Sys.UI.Key.left?P=v.AFrameworkApplication.isRtl?ra+1:ra-1:Qa===Sys.UI.Key.right&&(P=v.AFrameworkApplication.isRtl?
ra-1:ra+1);0<=P&&(ca=this.jci(lr.P6b+"_"+(P+this.Hxb)))&&ca.focus()}return!0};this.bkl=P=>{1===P&&this.lWi(this.$Yb);this.hide()};this.Hu=b;this.focusManager=h;this.ga=r;this.ZS=!1;B&&(b=B.indexOf(","),-1!==b&&(B=B.substring(0,b)));this.fontName=B;this.zg="DefineNewBulletDialog";this.Vg=rs.Vg;this.ye(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ye(0,CommonUIStrings.l_DialogClose);this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.bkl,null);this.Daa=!1;this.tIa();document.getElementById(lr.EPd).focus()}tIa(){this.focusManager.at().scope.mr(kb.FocusManager.instance().YW);
this.focusManager.at().scope.mr(kb.FocusManager.instance().ZW);this.focusManager.at().scope.bindAction(kb.FocusManager.instance().YW,Mb.a.UKd);this.focusManager.at().scope.bindAction(kb.FocusManager.instance().ZW,Mb.a.TKd)}V9(){this.UEd(lr.EPd,"DefineNewBulletFontPlaceholder",Mb.a.SKd.toString(),Mb.a.qOb.toString(),Mb.a.m4c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.SNk()}LL(){super.LL();document.getElementById(this.rj("WACDialogPanel")).style.width="auto"}UEd(b,h,r,B,P,ca,ra){r=Gi.c(b,
r,!0,!0,B,P,E.a.zf(ca),!0,ra);this.yJd(b,h,r,"Medium")}SNk(){const b=document.getElementById(lr.P6b);b&&(b.innerHTML=this.Z8h(),this.a$i(b))}a$i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)De.a.addHandler(b[h],Xc.a.focus,this.ckl)}WWo(){var b=document.getElementById(lr.P6b);if(b){let h=this.fontName;const r=Bt.a.QDf(this.fontName);r&&61472!==this.Hxb||!r&&32!==this.Hxb?(b.innerHTML=this.Z8h(),this.a$i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.Sph(h),b[0].style.fontFamily=h)}}Nun(b){this.Zmj(this.$Yb,!1);this.$Yb=b;this.Zmj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.$Yb){let h=parseInt(this.$Yb.substr(this.$Yb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Hxb?61440:0,b.innerText=E.a.jJ(h,4))}}Zmj(b,h){(b=this.jci(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}jci(b){const h=document.getElementById(lr.P6b);return h?h.querySelector("#"+b):null}hna(){const b=document.getElementById(lr.P6b);
b&&(this.YJe||(this.YJe=this.q2m,this.Pq.ob(Xc.a.click,b,this.YJe)),this.Syc||(this.Syc=this.r2m,this.ge.ob(Xc.a.gi,b,this.Syc),this.ge.ob(Xc.a.tu,b,this.Syc),this.ge.ob(Xc.a.zh,b,this.Syc)));super.hna()}SEi(b){return b.classList.contains("DefineNewBulletTableCell")}lWi(b){if(b){b=b.split("_");const h=new wc.DictionaryPropertySet;h.setValue(Zc.a.PJ,parseInt(b[1]));h.setValue(Pe.a.font,this.fontName);h.setValue(Zc.a.MA,1);oj.a.GY&&(h.setValue(Ng.a.eqa,"command-ui"),h.setValue(Ng.a.Mia,"define-new-bullet-dialog"));
this.ga.Qb(Mb.a.qD,2,h)}this.focusManager.FL(this.iL,!0)}Z8h(){const b=new Sys.StringBuilder,h=Bt.a.QDf(this.fontName);let r=this.fontName;r=this.Sph(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.Hxb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Hxb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}Sph(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}yJd(b,h,r,B){h=document.getElementById(h);this.Hu.C_a(b,r);r=this.Hu.fGb(b,B);h.appendChild(r);this.Hu.Rqa(b)}dispose(){this.ZS||(this.Hu.iZ(lr.EPd),this.ZS=!0);super.dispose()}}lr.EPd="DefineNewBulletFontStyleComboBox";lr.P6b="DefineNewBulletTableContainer";Object(n.a)(lr,"DefineNewBulletDialog",Pf.a,[]);class ox{pRc(){return Mb.a.m2m}RRc(){return Mb.a.X1f}}Object(n.a)(ox,"ListMarkerGalleryBulletCommands",
null,[390]);class jv{pRc(){return Mb.a.o2m}RRc(){return Mb.a.oFn}}Object(n.a)(jv,"ListMarkerGalleryMultilevelCommands",null,[390]);class Wy{pRc(){return Mb.a.p2m}RRc(){return Mb.a.Y1f}}Object(n.a)(Wy,"ListMarkerGalleryNumberingCommands",null,[390]);class Bu{constructor(b,h,r,B,P){this.oBa=this.zMa=null;this.fRh=ca=>{if(!this.oBa)return 2;if(this.oBa.focusManager.at().hk.n4.id.startsWith(lr.P6b)){let ra=null;ca===Mb.a.UKd?ra=this.oBa.f0a:ca===Mb.a.TKd&&(ra=document.getElementById(lr.EPd));if(!ra)return 2;
this.oBa.focusManager.at().hk.iz(ra);ra.focus()}else if(ca===Mb.a.UKd)this.oBa.focusManager.at().pgc();else if(ca===Mb.a.TKd)this.oBa.focusManager.at().ngc();else return 2;return 32};this.OHi=(ca,ra)=>{ca=null;ra.view.ue&&(ca=ra.view);return ca&&ca.mb?32:(Rc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ra.toString()),8)};this.h0m=(ca,ra,Qa)=>{var mb;return 1===Qa?32:2===Qa?((null===(mb=v.AFrameworkApplication.K)||
void 0===mb?0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("ListDefine"),ca=this.W$b(ra),ca=Bn.FormattingReader.Xr(ca).cache.GG,this.oBa=new lr(this.llk,kb.FocusManager.instance(),v.AFrameworkApplication.va,ca),32):8};this.m4c=(ca,ra,Qa,mb,Jb)=>{if(1===Qa)return 32;if(2===Qa&&!Jb)return 8;if(this.oBa.asi){for(ca=0;ca<Bt.a.mHc.length;ca++)bp.FontUtils.JDj(Bt.a.mHc[ca]);this.oBa.asi=!1}wm.a.bYd(ra);Jb.PopulationXML=bp.FontUtils.n4h(wm.a.Sie,wm.a.enf,
Mb.a.SKd);return 32};this.nFn=(ca,ra,Qa,mb,Jb)=>{ca=ra.contextId===zc.a.KP;if(1===Qa||!ca)return ca?32:8;if(2===Qa&&!Jb)return 8;Jb.MenuItems=this.Bak.Q3l();return 32};this.akl=(ca,ra,Qa,mb,Jb)=>{if(1===Qa)return 32;if(2===Qa){ca=Object(Na.a)(26,Jb);if(!ca||!ca.vd)return 8;this.oBa.fontName=ca.vd.fontName;this.oBa.WWo();return 32}return 8};this.ga=b;this.Hf=B.resolve("Box4.List.IListReader");this.r7=h;this.llk=r;switch(this.r7){case 0:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.zMa=
new ox;break;case 1:b=B.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.zMa=new Wy;break;case 2:b=B.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.zMa=new jv;break;default:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.zMa=new ox}P=this.Hf?this.Hf.D3l(P):null;b.Doe(P);this.Bak=new Bt.a(h,b,P,!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.$Jb)}Ub(){this.ga.qa(this.zMa.RRc(),zc.a.view,qe.App.wVa.dMh(11));this.ga.qa(this.zMa.RRc(),zc.a.KP,
this.nFn);this.ga.Xc(this.zMa.RRc(),1124);this.r7||(this.ga.fb(Mb.a.JKf,zc.a.view,this.h0m,1028),this.ga.fb(Mb.a.m4c,zc.a.view,this.m4c,1124),this.ga.fb(Mb.a.SKd,zc.a.view,this.akl,1028),this.ga.fb(Mb.a.UKd,Gd.a.frame,this.fRh,64),this.ga.fb(Mb.a.TKd,Gd.a.frame,this.fRh,64));this.ga.qa(this.zMa.pRc(),zc.a.view,this.OHi);this.ga.qa(this.zMa.pRc(),zc.a.KP,this.OHi);this.ga.Xc(this.zMa.pRc(),1124)}W$b(b){return this.aRd(b).Pa}aRd(b){let h=null;b=b.view;return b?h=Pd.SelectionEditor.Jj(b.mb.ib.J(0),!1,
!1):h}}Object(n.a)(Bu,"ListMarkerGalleryActor",null,[344]);class Vl{constructor(){this.Ef=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Hb.InteractiveViewManager.instance){var b=Hb.InteractiveViewManager.instance;b.we&&(this.Ef=b.we.ed,this.tXn())}}dispose(){}wc(b){this.W=b}tXn(){(new Bu(v.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").sea,this.W,this.Ef)).Ub();(new Bu(v.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").sea,
this.W,this.Ef)).Ub();(new Bu(v.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").sea,this.W,this.Ef)).Ub()}static main(){L.a.instance.Gc(new Vl)}}Object(n.a)(Vl,"Box4ListMarkerGalleryPackage",null,[1,2]);var NB=c(428),Tz=c(494),Cu=c(454),ug=c(129);const Du=b=>{b.element.style.top=""};var it=c(721);class Xy{constructor(b,h,r){this.GH=!1;this.Dab=0;this.jfa=this.bah=null;this.El=b;this.pmk=h;this.wt=r;this.gT=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Rw=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uL)&&!this.wt.ygf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";ba.a.Dj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.gT}get visible(){return this.GH}set_visible(b){if(this.GH!==b)return(this.GH=b)?this.M3e():this.XLc(),b}dispose(){this.visible&&this.XLc();Kb.a.RQ(this.htmlElement);this.El=this.gT=null}wsj(b,h){const r=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.Yej();this.Dab+=b.htmlElement.clientHeight;var B=this.htmlElement.childNodes,P=b.eth,ca=Object(z.a)(this,this.tln,"onAfterShowEntry");ug.WacAirSpace.DV(r,"Shared_BasicClass");var ra=new Cu.a(r);ra.Pua(0,1);const Qa=new Tz.a(r);Qa.rDa(r.clientTop-30,r.clientTop);P?(ug.WacAirSpace.fnb(ra,null,null),ug.WacAirSpace.fnb(Qa,null,ca)):(ug.WacAirSpace.animate(ra,
null,null),ug.WacAirSpace.animate(Qa,null,ca));for(h+=1;h<B.length;h++)ca=B[h],ug.WacAirSpace.DV(ca,"Shared_BasicClass"),ra=new Tz.a(ca),ra.rDa(ca.clientTop-r.clientHeight,ca.clientTop),P?ug.WacAirSpace.fnb(ra,null,null):ug.WacAirSpace.animate(ra,null,null);b.ixo();this.set_visible(!0)}Zoi(b){const h=b.htmlElement;if(Kb.a.hdc(h)){this.Dab-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.eth;var B=Object(z.a)(this,this.mln,"onAfterHideEntry");ug.WacAirSpace.DV(h,"Shared_BasicClass");var P=
new NB.a(h);P.Pua(1,0);b?ug.WacAirSpace.fnb(P,null,B):ug.WacAirSpace.animate(P,null,B);B=!1;for(P=0;P<r.length;P++){if(B){const ca=r[P];ug.WacAirSpace.DV(ca,"Shared_BasicClass");const ra=new Tz.a(ca);ra.rDa(ca.clientTop,-h.clientHeight);b?ug.WacAirSpace.fnb(ra,null,Du):ug.WacAirSpace.animate(ra,null,Du)}B||r[P]!==h||(B=!0)}}}tln(b){b.element.style.top="";v.AFrameworkApplication.ta.L1c()}mln(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);v.AFrameworkApplication.ta.L1c()}M3e(){""===
this.El.style.top.trim()&&(this.El.style.top=this.El.offsetTop+"px");this.htmlElement.style.left=this.El.style.left;this.htmlElement.style.top=this.El.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.bah=this.El.style.top;this.Dab=b.height;this.Toe();v.AFrameworkApplication.ta.G_(Object(z.a)(this,this.onResize,"onResize"));De.a.addHandler(this.htmlElement,Xc.a.dge,De.a.x4b);this.jfa=Object(z.a)(this,
this.hEa,"contextMenuHandler");v.AFrameworkApplication.ta.eAa.ob(this.htmlElement,this.jfa,null);if(kb.FocusManager.nK()){var h=kb.FocusManager.instance();b=h.fe(it.a.xOa);b.parent=Zd.AFrame.Ap;const r=new le.DOMFocusListing(()=>this.htmlElement);r.Qm(1);r.Qm(2);r.Qm(8);h.nna(()=>this.htmlElement,b,r);h=h.getRegion(it.a.xOa);h.TTa();h.yP=!0;h.J0a=!0;const B=v.AFrameworkApplication.ta.xx;b.D_a(()=>{B.fx(it.a.xOa)});B.MT(it.a.xOa);(r.zha||v.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&B.aJ(it.a.xOa)}}XLc(){this.$rj()&&
(this.El.style.top=this.bah);this.htmlElement.style.visibility="hidden";v.AFrameworkApplication.ta&&(kb.FocusManager.nK()&&kb.FocusManager.instance().q7a(it.a.xOa),this.jfa&&(v.AFrameworkApplication.ta.eAa.uc(this.htmlElement,this.jfa),this.jfa=null));De.a.removeHandler(this.htmlElement,Xc.a.dge,De.a.x4b)}Toe(){if(this.$rj()&&this.visible){var b=this.El,h=this.Dab+this.pmk;const r=Kb.a.jN(b.style.top);ug.WacAirSpace.DV(b,"Shared_BasicClass");b=new Tz.a(b);b.rDa(r,h);ug.WacAirSpace.animate(b,null,
null)}}$rj(){return!this.Rw&&!this.wt.ygf}onResize(){const b=this.wt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let r;for(let B=0;B<b;++B)r=this.wt.entries[B],r.htmlElement&&r.Yej();this.Dab=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.Dab&&this.Toe()}hEa(){return!0}}Object(n.a)(Xy,"BusinessBarDom",null,[1298,10]);var Eu;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(Eu||(Eu={}));Object(n.b)("BusinessBarId",
Eu);class Fu{constructor(b,h=0,r=null,B=null){this.R2g=this.iTg=!1;this.p_b=null;this.eB=[];this.AWa=B||new Xy(b,h,this);this.nCm(r)}nCm(b){if(b){this.p_b={};b=b.ranking;for(let h=0;h<b.length;h++)this.p_b[Eu[b[h]]]=h}}dispose(){this.AWa.dispose();Zi.a.gbg(this.eB);this.eB=null}get htmlElement(){return this.AWa.htmlElement}get visible(){return this.AWa.visible}get ygf(){return this.iTg}set ygf(b){this.iTg=b}get KHf(){return this.R2g}set KHf(b){this.R2g=b}get entries(){return this.eB}set entries(b){this.eB=
b}EY(b){for(let h=0;h<this.eB.length;h++)if(this.eB[h].id===b)return!0;return!1}sA(b,h=!1,r=null,B=null,P=null){b.UK=this;let ca=this.v1l(b.id);h&&!this.p_b&&(ca=0);ca<Fu.HLb&&(this.AWa.wsj(b,ca),this.eB.length>=Fu.HLb&&this.AWa.Zoi(this.eB[Fu.HLb-1]),this.AWa.Toe());Array.insert(this.eB,ca,b);t.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Eu[b.id],void 0===b.K0a||null===b.K0a?"":b.K0a);b.errorCode&&v.AFrameworkApplication.mN(b.errorCode,r,B,P)}removeEntry(b){const h=
Array.indexOf(this.eB,b);-1!==h&&h<Fu.HLb&&(this.eB.length>Fu.HLb&&this.AWa.wsj(this.eB[Fu.HLb],Fu.HLb),this.AWa.Zoi(b),this.AWa.Toe());Array.remove(this.eB,b);b.UK=null;b.dispose()}v1l(b){if(!this.p_b||0===b)return this.eB.length;b=this.p_b[Eu[b]];if(void 0===b||null===b)return this.eB.length;for(let h=0;h<this.eB.length;h++)if(b<this.p_b[Eu[this.eB[h].id]])return h;return this.eB.length}}Fu.HLb=2;Object(n.a)(Fu,"BusinessBar",null,[1270,10,1271]);class Uz{create(b,h,r){return new uh.a(b,h,r)}}Object(n.a)(Uz,
"Factory",null,[1297]);class LA{static z4k(b,h){b.register(Fu,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Ud(()=>new Fu(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(Uz,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(n.a)(LA,"CommonUIComponentConfiguration",null,[]);var jt=c(1020);class kv extends jt.a{constructor(){super()}static get instance(){return kv._instance||kv.eCf()}static eCf(){kv._instance=new kv;return kv._instance}}
kv._instance=null;Object(n.a)(kv,"ReactRootManager",jt.a,[485,486]);class Yt extends ei.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(Yt,"CompoundButtonProps",ei.a,[]);class Yy{constructor(b,h,r,B,P,ca,ra){this.QW=h;this.nCc=b;this.d1g=h.cMm;this.wYb=h.aYc;this.BGe=ca;this.bod=B;this.cod=P;this.Xnd=r;this.AK=ra;this.Qbb=new xf.a;this.Qbb.Z(1,"SpellingIssue_16x16x32");this.Qbb.Z(2,"GrammarIssue_16x16x32");this.Qbb.Z(3,"WritingIssue_16x16x32");this.Qbb.Z(4,null);this.Qbb.Z(0,null)}create(b,
h,r){h=Object(Na.a)(Hn.a,h);if(!h)return t.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const B=new Sys.StringBuilder;b=this.Kbi(b);this.cLc(B,h,r,b);this.Nbf(B,h);this.jel(B,h,b);return B.toString()}rDb(b,h,r){const B=Object(Na.a)(Hn.a,h);if(!B)return t.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.Kbi(b);this.ycf(h,B,r,b);this.Obf(h,B);this.kel(h,B,b);for(r=0;r<h.length;r++)h[r].Id=`${ps.aWh}_${r}`;return h}cLc(b,h,r,B=null){h.errorType?
1===h.errorType&&(this.h8b(h)||b.append(this.W5e(h,r,B))):b.append(this.nCc.build())}ycf(b,h,r,B=null){h.errorType?1===h.errorType&&(this.h8b(h)||b.push(this.PNk(h,r,B))):b.push(this.nCc.Fzh())}Nbf(b,h){const r=new Sys.StringBuilder;this.ttj(h)?r.append(Gi.a("btnIgnoreAllSpellingError",(2===h.errorType?Mb.a.XJa:Mb.a.epa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.h8b(h)||r.append(Gi.a("btnIgrnoreSpellingError",this.Gai(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,
null));this.ztj(h)&&(this.QW.Dxi&&r.append(Gi.a("btnDoNotCheckForThisIssue",Mb.a.jEb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Gi.a("btnGrammarOptions",Mb.a.lob.toString(),E.a.zf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),b.append("</Controls></MenuSection>"))}Obf(b,h){const r=Object.assign(new Nf.a,{ControlList:[]});if(this.ttj(h)){var B=qs.QB()?
Object.assign(new ei.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Mb.a.epa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new ei.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(B)}else this.h8b(h)||(B=Object.assign(new ei.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.Gai(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(B));this.ztj(h)&&(this.QW.Dxi&&
(h=Object.assign(new ei.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new ei.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}Kbi(b){if(!this.AK)return null;b=this.AK.language(this.AK.Xr(b.Pa));return Hi.a.ug(b)?Hi.a.ug(b).name:null}Gai(b){return 2===b?Mb.a.XJa:this.QW.aPm?Mb.a.oxm:Mb.a.nxa}jel(b,h,r=null){if(this.lgg(h)){var B=E.a.zf(h.Ft.CategoryTitle);B=Gi.m(ps.Oic,eb.a.Wma,this.Qbb.J(h.proofingType),""!==B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
[b.toString()],this.bod,this.cod);B=Gi.d("cgProofingOuter",[B]);b.clear();b.append(Gi.g("msProofingOuter",B,"Menu16",void 0,void 0,r,"ariaLabelledById"));t.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}kel(b,h,r=null){if(this.lgg(h)){var B=E.a.zf(h.Ft.CategoryTitle);r=Object.assign(new Yi.a,{ExternalId:String.format("{0}_{1}",ps.Oic,h.proofingType),Command:eb.a.Wma.toString(),Image16by16Class:this.Qbb.J(h.proofingType),LabelText:""!==
B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new dh.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.WOl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);B=Object.assign(new Nf.a,{ControlList:[]});B.ControlList.push(r);b.push(B);t.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",
h.proofingType,h.typeId)}}W5e(b,h,r=null){const B=this.wXl(b);var P=[];let ca=!1;var ra=b.Ft.Suggestions;if(ra)if(ra=ra.slice(0,Math.min(3,ra.length)),this.d1g&&(ca=!Jj.a.any(ra,Qa=>!Qa||!Qa.Description)),1!==ra.length||ra[0].Action){let Qa=0,mb=null;ca&&(mb="font-weight: bold;");for(const Jb of ra){if(!Jb)continue;ra=null;let Yb="";const fc=E.a.zf(Jb.Text);ca&&(ra=this.t6h(Jb.Description),Yb=this.s6h(Jb.Description));P.push(Gi.a("btnCorrectWord"+Qa,h[Qa].toString(),fc,null,null,null,null,null,mb,
null,ra,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,B,fc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.rKh(b.token)),"ariaDescribedById",Yb));Qa++}}else h=E.a.zf(ra[0].Text),P.push(Gi.a("btnCorrectWord0",Mb.a.XJa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,B,h)));h="Menu16";
0<P.length?ca&&(h="Menu16DescriptionEnabled"):P=[Gi.a("btnNoSuggestions",Mb.a.XJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Gi.g("msUnknownWord",Gi.d(null,P),h,B,this.X4l(b),r,"ariaLabelledById")}PNk(b,h,r=null){var B=1!==b.proofingType&&0!==b.proofingType?b.Ft.ExplanationTitle:"";B=Object.assign(new Nf.a,{Title:B,Lang:r,ControlList:[]});let P=!1;var ca=b.Ft.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.d1g&&(P=!Jj.a.any(ca,ra=>!ra||!ra.Description)),1!==ca.length||
ca[0].Action){let ra=0;for(const Qa of ca){if(!Qa)continue;ca=null;let mb="";P&&(ca=this.t6h(Qa.Description),mb=this.s6h(Qa.Description));if(ra>=h.length)break;ca?(ca=Object.assign(new Yt,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),LabelText:Qa.Text,Description:ca,Lang:r,AriaDescription:mb}),B.ControlList.push(ca)):(ca=Object.assign(new ei.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),
LabelText:Qa.Text,Lang:r,RoleInMenu:"menuitem"}),B.ControlList.push(ca));ra++}}else b=ca[0],b=Object.assign(new ei.a,{ExternalId:"NoSuggestion",Command:Mb.a.XJa.toString(),LabelText:b.Text}),B.ControlList.push(b);0>=B.ControlList.length&&B.ControlList.push(Object.assign(new ei.a,{ExternalId:"btnNoSuggestions",Command:Mb.a.XJa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return B}wXl(b){return E.a.zf(0!==b.proofingType?b.Ft.ExplanationTitle:"")}X4l(b){return this.lgg(b)?null:this.Qbb.J(b.proofingType)}lgg(b){return this.wYb&&
2!==b.errorType&&(1!==b.errorType||!this.h8b(b))}ttj(b){return this.BGe&&!!b.errorType&&1===b.proofingType&&!this.h8b(b)}WOl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.rKh(b.token)):""}ztj(b){return this.QW.N0d&&this.wYb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}h8b(b){return!!b.errorType&&!!this.Xnd&&this.Xnd.contains(b.token,b.lcid)}t6h(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):
b}s6h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}rKh(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(n.a)(Yy,"EditorServiceProofingContextMenuCreator",null,[]);class MA{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(n.a)(MA,"BusinessBarRankProvider",null,[341]);class px{constructor(){this.W=
null}get name(){return"Wonca.UI"}wc(b){this.W=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>new MA).ha();LA.z4k(b,new zf.a(()=>ab.StaticActiveAppFrame.za().jha));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Yy(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),v.AFrameworkApplication.Pca,v.AFrameworkApplication.Ms,v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),
b.resolve("Box4.IFormattingReader"))).ha();b.ia("CommandUI.ReactRootManager",()=>kv.instance).as("Common.IReactRootManager").ha()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){L.a.instance.Gc(new px)}}Object(n.a)(px,"WoncaUIPackage",null,[1,2]);class fy{constructor(b){this.RN=this.rAc=null;this.Bn=b}get key(){return"BOOKMARK"}get Ku(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get o4(){return this.RN}reset(b){this.RN=b.node}lAa(b){let h=
null;v.AFrameworkApplication.se("bookmarks-core-ex;bookmarks-core-ex-cf");if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.rAc&&this.Bn.$wi(b,this.o4,this.rAc))return h=Object.assign(new vu.a,{nE:this.key,contentObject:this.rAc}),{returnValue:!0,RE:h};this.rAc=null;if(!this.o4.hasBookmark)return{returnValue:!1,RE:h};const r=new xd.GraphIterator;r.set(this.o4.Zi());this.Bn.f1c(r);if(this.Bn.nJm(r)){let B=r.Rd();
for(;B;){if(this.Bn.$wi(b,this.o4,B))return this.rAc=B,h=Object.assign(new vu.a,{nE:this.key,contentObject:B,description:this.hQa()}),{returnValue:!0,RE:h};B=r.Oj()}}}return{returnValue:!1,RE:h}}hQa(){return null}}Object(n.a)(fy,"BookmarkDetailsProvider",null,[345,346]);class NA{constructor(b,h,r,B,P=null){this.B0g=this.Zh=!1;this.ksd=this.Mtd=null;this.tUi=(ca,ra)=>{ca=ra.node;1074135152!==ca.Oc?t.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Oc):(t.ULS.sendTraceTag(24155019,324,
50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.DXh(!0))};this.lA=r;this.ti=B;this.Dx=h;this.pNg=b;this.ES=P}get px(){return this.Dx.value}initialize(){this.r7f();this.Zh=!0}DXh(b=!1){if(!this.Zh)return t.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.B0g)return!0;let h=!1;this.ti.ie(()=>{this.Mtd={};this.ksd={};if(this.px){const r=new xd.GraphIterator;r.set(this.px);if(this.bgn(r)){if(r.Tb(1)){do this.kuk(r.currentNode);while(r.Lf(1))
}h=this.B0g=!0}}},"BGM:EBGL");return h}Dwa(b){return this.DXh()?b in this.ksd?this.ksd[b]:null:null}dispose(){this.Zh?this.mTo():t.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}bgn(b){if(this.lA.GP(b))return(b=b.Tb(30))||t.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}r7f(){t.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.pNg.Brh(this.tUi)}mTo(){t.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.pNg.lcj(this.tUi)}kuk(b){var h,r,B,P;b?(this.Bph(null!==(r=this.ES.Hfb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:U.a.nil,b),this.Bph(null!==(P=this.ES.S3b.get(null===(B=b.id)||void 0===B?void 0:B.toString()))&&void 0!==P?P:U.a.nil,b),(h=b.properties.ja(Oc.a.At,null))&&(this.ksd[h]=b)):t.ULS.sendTraceTag(24155022,324,50,"Node is null")}Bph(b,h){b===U.a.nil?t.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.Mtd||(this.Mtd[b]=new vb.a),b=this.Mtd[b],b.contains(h)||b.add(h))}}Object(n.a)(NA,"BookmarkGraphManager",null,[347]);var OB=c(822),PB=c(1137);class gy{create(){return new PB.a}}Object(n.a)(gy,"BookmarkContainerNodeFactory",null,[380]);class OA{constructor(b,h,r,B=null){this.wsn=(P,ca)=>{this.Bn.qXi(ca)};this.mYf=(P,ca)=>{var ra=this.d0h(ca.clone);P=ca.original.Mc;const Qa=new Rb.a;for(const mb of ra)ra=mb.yn.toString(),Qa.nb(ra)||(Qa.add(ra,!0),(ra=P.Eb(mb.yn))&&!ra.anchor&&
(ra=this.Bn.QFb(mb.yn)),ra?ra.anchor?this.D8k(ra,ca.clone):t.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ra.id,ra.ja(Oc.a.LBb,-1))):t.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.nYf=(P,ca)=>{P=ca.clone;ca=this.d0h(P);this.Bn.P6c(P,ca)};this.qA=h;this.Bn=r;this.TXj=B||new gy}init(){OB.a.oVn(Object(z.a)(this.Bn,this.Bn.uVf,"onAfterFullBookmarkRangeDeleted"));this.qA.G0e(this.wsn);et.a.F0e(this.mYf);et.a.BCd(this.nYf)}d0h(b){const h=
new vb.a;for(let r=0;r<b.ra.length;r++){const B=b.ra.J(r);if(B.$g)for(let P=0;P<B.$g.length;P++)h.add(B.$g.J(P))}return h}D8k(b,h){var r=h.Zi().xd;r=at.b(b,r,!0);h=xd.GraphIterator.eb(h);this.Jwl(h);h.Tb(30);h.Q3(r,1,b.id);h.Bj(r)}Jwl(b){if(b.zb(25)&&b.jd(25)&&!b.Jt(30)){const h=this.TXj.create(1074135152);b.Bf(h,30)}}}Object(n.a)(OA,"BookmarksEventHandler",null,[]);var vq=c(206),Iq=c(257),lv=c(396),Dw=c(1192),PA=c(131),QB=c(1081);class qj{create(){return new QB.a}}Object(n.a)(qj,"BookmarkNodeFactory",
null,[380]);class Ct{constructor(b,h){this.Hba=b;this.cYj=h}get HOb(){return this.cYj}}Object(n.a)(Ct,"FoundBookmarkRangeObject",null,[378]);class Rv{constructor(b,h,r,B,P,ca,ra,Qa=null,mb,Jb=null){this.g3="_";this.sNg=40;this.hlk=" ";this.Dx=b;this.lA=h;this.Md=r;this.KJe=B;this.Lc=P;this.gb=ca;this.hb=ra;this.bYj=Qa||new qj;this.ES=Jb}JRc(b,h){return b?this.ES.Hfb.get(null===h||void 0===h?void 0:h.toString()):this.ES.S3b.get(null===h||void 0===h?void 0:h.toString())}get px(){return this.Dx.value}get pKa(){return this.KJe.value}MZe(b,
h){if(!h||!h.Pa||!h.Rc)return t.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Pa.node,B=h.Rc.node,P=vq.a.fjb(h,!0);h=vq.a.fjb(h,!1);return this.WFc(b,P,h,r,B)}WFc(b,h,r,B,P,ca=!1){t.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const ra=this.Dwa(b);if(ra)if(ca)this.aaj(ra);else return t.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!B||!P)return t.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ca=this.Lc.Pc(15);ca.Db(this.pKa);b=this.Erk(b);if(!b)return!1;this.Ark(B,h,b,P,r);ca.dispose();return!0}Dwa(b){t.ULS.shipAssertTag(34936482,3029,!!b);return this.g0h(h=>b===h.properties.ja(Oc.a.At,null))}QFb(b){return b&&b!==U.a.nil?this.g0h(h=>b.equals(h.id)):(t.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}uVf(b){const h=this.QFb(b);h?(t.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.$$i(h),this.O6c(h)):
t.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Ewa(b,h){var r;const B=null!==(r=this.JRc(h,b.id))&&void 0!==r?r:U.a.nil;if(B===U.a.nil)return t.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new Ct(null,2);r=this.px.xd.Eb(B);return r?r.isConnected?this.getBookmarkRange(r,b,h):(t.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Ct(null,3)):(t.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new Ct(null,2))}qXi(b){const h=this.yFl(b);h[Symbol.iterator]().next().done||this.Yfn(b,h)}P6c(b,h){const r=new vb.a;let B=0,P=!1;for(const ca of h)ca&&ca.Lb.$g?(B++,ca.Lb.$g.remove(ca),0<=ca.pe&&ca.pe<b.xe.length&&(ca.Lb.cp||(P=!0),r.add(ca.pe))):t.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.ara(r);t.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",B,r.count));P&&!b.xe.length&&b.xe.append(Iq.CharacterPropertiesEditor.bN,
1024)}yQd(b=!1){t.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new vb.a,r=xd.GraphIterator.eb(this.px);if(null!==this.f1c(r)){var B=r.Wp();t.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",B);if(0<B)for(B=r.Rd();null!==B;){const P=B.ja(Oc.a.At,"");E.a.af(P)||(b?h.add(B):P.startsWith(this.g3)||h.add(B));B=r.Oj()}}!b&&0<h.count&&t.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}ksm(){return this.px?this.G5k():!1}G5k(){t.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=xd.GraphIterator.eb(this.px);if(null!==this.f1c(b)&&0<b.Wp())for(var h=b.Rd();null!==h;){h=h.ja(Oc.a.At,"");if(!E.a.af(h)&&!h.startsWith(this.g3))return!0;h=b.Oj()}return!1}vei(b){var h=this.Dwa(b);const r=new vb.a;if(h){b=this.JRc(!0,h.id);h=this.JRc(!1,h.id);var B=this.px.xd.Eb(b);B&&r.add(B);if(b.equals(h))return r;b=B;do(b=B=this.gb.Wf(b,!1,!1,!0))&&r.add(B);while(B&&!B.id.equals(h))}else t.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return r}Z$i(b){if(null===b)return t.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.QFb(b);return this.aaj(b)}PPl(b){let h="";const r=b.id;b=b.characterData.split(this.hlk);for(let B=0;3>B&&B<b.length;B++)h+=this.g3+b[B];h.length>this.sNg&&(h=h.substring(0,this.sNg));return this.ONj(h,r)}ONj(b,h){const r=this.yQd(!0),B=[];let P;for(let ra=0;ra<r.count;ra++){var ca=r.J(ra);P=ca.ja(Oc.a.At,"");ca=this.JRc(!0,ca.id);P.startsWith(b)&&!h.equals(ca)&&B.push(P)}return 0<
B.length?(B.sort((ra,Qa)=>ra.localeCompare(Qa,void 0,{numeric:!0})),(h=B[B.length-1].substring(b.length+1))?b+this.g3+(parseInt(h)+1):b+this.g3+1):b}wli(b){E.a.af(b)?t.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.Dwa(b),null===b?t.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Ewa(b,!0))?(b=Fe.SelectionFactory.ne(b.Hba.paragraph,b.Hba.Lb.cp))&&this.hb.Ac(b):t.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}aaj(b){if(!b)return t.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;t.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Lc.Pc(15);h.Db(this.pKa);this.$$i(b);this.O6c(b);h.dispose();return!0}SRd(b,h){if(!b||0>h)return t.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let r=null;const B=new vb.a,P=new vb.a;var ca=b.ra;for(var ra=0;ra<ca.length;ra++){var Qa=ca.J(ra);if(Qa.cp>h||Qa.cp===h&&0<B.count)break;if(Qa.$g){var mb=
Qa.$g;if(2===mb.length&&mb.J(0).yn.equals(mb.J(1).yn)&&Qa.cp===h){B.add(mb.J(0).yn.toString());break}for(let Jb=0,Yb=mb.length;Jb<Yb;Jb++){Qa=mb.J(Jb);const fc=b.Mc.Eb(Qa.yn).ja(Oc.a.At,"");E.a.af(fc)||fc.startsWith(this.g3)||(Qa.Qc?B.add(Qa.yn.toString()):B.contains(Qa.yn.toString())?B.remove(Qa.yn.toString()):P.add(Qa.yn.toString()))}}}0<B.count&&(r=b.Mc.Eb(U.a.If(B.J(B.count-1))));if(!r)for(h=Td.ParagraphReader.Wf(b,!0);h&&!r;){for(ca=0;ca<h.ra.length;ca++)if(ra=h.ra.J(ca),ra.$g){ra=ra.$g;for(let Jb=
0,Yb=ra.length;Jb<Yb;Jb++)mb=ra.J(Jb),Qa=b.Mc.Eb(mb.yn).ja(Oc.a.At,""),E.a.af(Qa)||Qa.startsWith(this.g3)||(mb.Qc?P.contains(mb.yn.toString())?P.remove(mb.yn.toString()):B.add(mb.yn.toString()):B.contains(mb.yn.toString())?B.remove(mb.yn.toString()):P.add(mb.yn.toString()))}0<B.count?r=h.Mc.Eb(U.a.If(B.J(B.count-1))):h=Td.ParagraphReader.Wf(h,!0)}return r}WUo(b,h){if(null===b)return t.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.oJm(h)||this.Ssl(h))return!1;const r=this.Lc.Pc(15);
r.Db(this.pKa);this.VUo(b,h);r.dispose();return!0}g0h(b){if(!this.px)return t.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new xd.GraphIterator;h.set(this.px);if(!this.f1c(h))return t.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Tb(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Lf(1));return null}getBookmarkRange(b,h,r){for(let B=0;B<b.ra.length;B++){const P=b.ra.J(B);if(P.$g)for(let ca=0;ca<P.$g.length;ca++){const ra=
P.$g.J(ca);if(ra.yn.equals(h.id)&&r===ra.Qc)return new Ct(ra,0)}}t.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ja(Oc.a.LBb,-1),r,h.id,b.ra.length,this.DJ(b));return new Ct(null,1)}f1c(b){if(this.lA.GP(b))return b=b.Tb(30),t.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}yFl(b){const h=new Rb.a;
for(let r=0;r<b.ra.length;r++){const B=b.ra.J(r);if(B.$g)for(let P=0;P<B.$g.length;P++){const ca=B.$g.J(P),ra=ca.yn.toString();h.nb(ra)?(t.ULS.shipAssertTag(36218379,3029,ca.Qc!==h.J(ra).Qc),h.remove(ra)):h.add(ra,ca)}}return h.values}Yfn(b,h){this.P6c(b,h);this.Afn(b,h)}Afn(b,h){let r=Td.ParagraphReader.Wf(b,!1,!0);b=Td.ParagraphReader.Wf(b,!0,!0);r||b?(r||this.byh(h,!0)&&t.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.byh(h,!1)&&t.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.eQi(r,h,0,!0),this.eQi(b,h,b.ra.last.cp,!1)):t.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}byh(b,h){for(const r of b)if(h===r.Qc)return!0;return!1}eQi(b,h,r,B){const P=new vb.a;r=this.npf(b,r);for(const ca of h)ca.Qc===B&&(r?(h=this.Grk(b,B,r,ca.yn))&&P.add(h):t.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",B));
P.count&&(b.Xl(),this.Pqg(b,P),t.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",P.count,B)))}Grk(b,h,r,B){const P=this.QFb(B);return P?this.NZe(b,h,r,P):(t.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",B)),null)}NZe(b,h,r,B){var P;if(!B)return t.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return t.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.$g||(r.$g=new lv.a(r));const ca=new Dw.a(r,null,B.id,h);r.$g.add(ca);(h?this.ES.Hfb:this.ES.S3b).set(null===(P=B.id)||void 0===P?void 0:P.toString(),b.id);return ca}Pqg(b,h){if(h){t.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,B)=>r.pe-B.pe);for(let r=0;r<h.count;r++){const B=h.J(r);B.pe?b.xe.xY(B.pe-1,1024):b.xe.npa(B.pe,1024);b.xe.uq.Z(B.pe,Iq.CharacterPropertiesEditor.bN);b.xe.ot.Z(B.pe,Iq.CharacterPropertiesEditor.ZR)}}else t.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}npf(b,h){if(!b||!b.ra||!b.ra.last)return null;t.ULS.shipAssertTag(36471766,3029,h<=b.ra.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.ra.last.cp===h){var r=b.ra.length-1;if(!b.ra.J(r).formatting)for(var B=r-1;0<=B;B--){var P=b.ra.J(B);if(P.formatting){this.Md.sZ(b,r,h,P.formatting);break}}return b.ra.last}r=null;for(B=0;B<b.ra.length;B++){P=b.ra.J(B);if(P.cp>=h){if(P.cp>h||!P.formatting)this.Md.sZ(b,B,h,r),P=b.ra.J(B);P.$g||(P.$g=new lv.a(P));
t.ULS.shipAssertTag(36471768,3029,P!==b.ra.last);return P}P.formatting&&(r=P.formatting)}return null}Erk(b){const h=new xd.GraphIterator;h.set(this.px);if(!this.f1c(h))return t.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.j$k(b);h.Q3(b,1,null);h.Bj(b);return b}j$k(b){const h=this.bYj.create(1074135153);h.setValue(Oc.a.At,b);h.setValue(Oc.a.LBb,Kd.a.FF());return h}O6c(b){if(b&&b.anchor){t.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ja(Oc.a.LBb,-1),b.id);var h=new xd.GraphIterator;h.set(b);h.zb(64);h.tg()}}DJ(b){const h=[];let r=0;for(;b.anchor.Vp&&7!==b.type;)h[r]=PA.a[b.type],b=b.anchor.Vp.us.node,r++;h[r]=PA.a[b.type];return h.join(" ")}VUo(b,h){b.setValue(Oc.a.At,h)}$$i(b){const h=this.Ewa(b,!0).Hba;b=this.Ewa(b,!1).Hba;if(h&&b&&h.paragraph===b.paragraph){let r;this.P6c(h.paragraph,(r=new vb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.P6c(h.paragraph,(r=new vb.a,r.add(h),r))}if(b){let r;this.P6c(b.paragraph,(r=new vb.a,
r.add(b),r))}}}Ark(b,h,r,B,P){if(h=this.NZe(b,!0,this.npf(b,h),r)){b.Xl();var ca;this.Pqg(b,(ca=new vb.a,ca.add(h),ca));(r=this.NZe(B,!1,this.npf(B,P),r))?(B.Xl(),this.Pqg(b,(ca=new vb.a,ca.add(r),ca))):t.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else t.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}wei(b,h){var r;if(!b)return null;h=null!==(r=this.JRc(h,
b.id))&&void 0!==r?r:U.a.nil;return b.Mc.Eb(h)?b.Mc.Eb(h):null}nJm(b){return!!b&&64===b.Xe}Z_f(b){var h;if(0===b.T$)return!1;for(let r=0;r<(null===(h=b.ra)||void 0===h?void 0:h.length);r++){const B=b.ra.J(r);if(null!=B.$g)for(let P=0;P<B.$g.length;P++){const ca=B.$g.J(P),ra=b.Mc.Eb(ca.yn).cQa();if(!E.a.af(ra)&&!ra.startsWith(this.g3)&&ca.Qc)return!0}}return!1}h6h(b){var h;const r=[];if(0===b.T$)return r;for(let B=0;B<(null===(h=b.ra)||void 0===h?void 0:h.length);B++){const P=b.ra.J(B);if(null!=P.$g)for(let ca=
0;ca<P.$g.length;ca++){const ra=P.$g.J(ca),Qa=b.Mc.Eb(ra.yn),mb=Qa.cQa();E.a.af(mb)||mb.startsWith(this.g3)||!ra.Qc||r.push(Qa)}}return r}pvo(b){return b.ja(Oc.a.UG,!1)}oJm(b){return E.a.af(b)?(t.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}Ssl(b){return null!==this.Dwa(b)?(t.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}g6h(b,h,r){return this.getBookmarkRange(b,h,r).Hba}$wi(b,h,r){if(this.pvo(r)||this.KOm(r))return!1;
const B=this.wei(r,!0),P=this.wei(r,!1);if(B&&P&&this.gb.LXc(h,B,P)){if(h!==B&&h!==P)return!0;const ca=this.g6h(B,r,!0);if(ca&&(B!==h||ca.Lb.cp<=b)&&(r=this.g6h(P,r,!1))&&(P!==h||r.Lb.cp>=b))return!0}return!1}KOm(b){b=null===b||void 0===b?void 0:b.ja(Oc.a.At,"");return!E.a.af(b)&&b.startsWith(this.g3)?!0:!1}}Object(n.a)(Rv,"FullBookmarkManager",null,[343]);class Sv{constructor(){this.Uue=this.Rq=this.W=null}get name(){return"WordEditor.Bookmark"}wc(b){this.W=b;this.Rq=this.W.resolve("Box4.INotebookManager").Al;
const h=new Rv(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),ro.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc.ed),kl.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.W.ia("WordEditor.Bookmark.BookmarksEventHandler",
()=>new OA(this.Rq.Te(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();Jk.App.ZLj&&(this.Uue=new NA(this.Rq.Te(64),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),ro.PageNavigator.instance,Zq.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Uue).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}dispose(){this.Uue.dispose()}xn(){t.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();t.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.vVn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}vVn(b,h){b&&b.execute(r=>{r.tV(new fy(h))})}static main(){L.a.instance.Gc(new Sv)}}Object(n.a)(Sv,"BookmarkPackage",null,[1,2]);var qx=c(887),cp=c(1073),mv=c(1570),Gs=c(1427);class Gu extends Gs.a{constructor(b){super();
this.jok=b}get index(){return 3}run(){this.jok()}dK(){this.TY()}}Object(n.a)(Gu,"FootnoteEndnoteGraphUpdateTracker",Gs.a,[]);class Od{constructor(){this.$md=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){Od.Zb.pq.continueWith(()=>{this.xn()})}xn(){qx.a.Dib=mv.a.instance;this.kAf()}dispose(){}kAf(){this.$md=new Gu(()=>{mv.a.instance.av()});cp.a.yde(Object(z.a)(this.$md,this.$md.dK,"setUpdateNeeded"));Lk.GraphTransactionManager.instance.pra(this.$md,3)}static get Zb(){return Ya.a.instance.resolve("Box4.IFeatureHelper")}}
Object(n.a)(Od,"PackageManager",null,[1,2]);var Hs=c(779),Di=c(204),Zy=c(538),vp=c(475),rx=c(1671);class hy extends jx{constructor(){super()}get Ku(){return null}getTitle(b){b=b.Koa();if(!b||!Zy.a.instance.zpa(b))return"";const h=new Sys.StringBuilder,r=Zy.a.instance.H4(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Zy.a.instance.Y9b(b));return h.toString()}}Object(n.a)(hy,"FootnoteEndnoteBaseDetailsProvider",
jx,[]);class QA extends hy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get vh(){return 7}}Object(n.a)(QA,"FootnoteEndnoteDetailsProvider",hy,[]);var Vz=c(1628),Wz=c(1645),Zt=c(1718);class $t extends hy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get vh(){return 10}}Object(n.a)($t,"FootnoteEndnoteRefMarkDetailsProvider",hy,[]);class $y{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d){this.bti=(be,he,re,Xf,Mg)=>{Xf=he.view;if(!Xf.features.cle||this.wD.Vwi)return 8;
const $l=Xf.mb.qg;if(!$l)return 2;if(this.Nk.a0($l))return 8;Xf=be===V.a.insertFootnote?1:0;var Nm=this.aRd(he);if(!Nm)return t.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;he=!0;Nm=Nm.Pa;Mg&&Mg.Rdc&&Mg.CGa&&(Nm=Mg.CGa,he=!Mg.keepCurrentFocus);if(1===re&&$i.a.via($l)||!Nm||!Pd.SelectionEditor.Ze(Nm)||this.uQg.instance&&this.uQg.instance.ZPm(Nm)||ch.a.Lxa(Nm,!0))return 8;if(1===re)return 32;2===re&&(re=this.BT.Yf("UserAction","InsertFootnoteEndnote"),be=this.Z3j.EEm(Nm,Xf,be),
Mg&&Mg.Rdc&&(Mg.wSi=be),he&&this.A9d(be,!0,!0),re.stop(),this.Vd.Zs(6));return 32};this.Agc=(be,he,re)=>{const Xf=he.view;if(be===V.a.u8a||be===V.a.Fqb){if(!Xf.features.cle)return 8}else if(!Xf.features.Ikg)return 8;if(!Xf.mb.qg)return 2;he=this.W$b(he);return he?be!==V.a.u8a&&be!==V.a.Fqb||this.NLa.Gsm(he.node,be===V.a.u8a?1:0)?1===re?32:2===re&&32===this.ga.Qb(V.a.r4,2,!0)?(this.ga.Qb(V.a.mTf,2,be),32):8:8:2};this.QIl=(be,he,re,Xf,Mg)=>{if(1===re)return 32;if(2===re){be=this.lem(he);if(!be)return 8;
re=he=null;switch(Mg){case V.a.U5d:re=be.Rc;he=this.wXb.NVd(re,1);break;case V.a.T5d:re=be.Rc;he=this.wXb.NVd(re,0);break;case V.a.W5d:re=be.Pa;he=this.wXb.Mli(re,1);break;case V.a.V5d:re=be.Pa;he=this.wXb.Mli(re,0);break;case V.a.u8a:re=be.Pa;(he=this.wXb.NVd(re,1,!0))||(he=this.NLa.k$h(re.node,1));break;case V.a.Fqb:re=be.Pa,(he=this.wXb.NVd(re,0,!0))||(he=this.NLa.k$h(re.node,0))}if(he)this.A9d(he);else{if(!this.hu.rc)return 8;(Mg=xo.d(re.node,re.cpBegin))&&7===Mg.vh&&this.NLa.Tij(Mg)}}return 32};
this.Axo=(be,he,re,Xf,Mg)=>1===re?32:2===re?(t.ULS.shipAssertTag(4520066,308,!!Mg),t.ULS.shipAssertTag(4520067,308,!!Mg.O0a),be=Mg.O0a,t.ULS.shipAssertTag(4520068,308,this.EE.zpa(be)),this.A9d(be,Mg.yie)?32:8):32;this.Bxo=(be,he,re,Xf,Mg)=>{if(1===re)return 32;2===re&&(be=Mg.footnoteEndnoteNode,Mg=Mg.TIl)&&(this.dta.d8b(),he=this.EE.plb(be),Mg.title=this.EE.WZl(be)+(he?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.u6a=(be,he,re,Xf,Mg)=>2===re?(t.ULS.shipAssertTag(4520069,308,!!Mg),t.ULS.shipAssertTag(4520070,308,!!Mg.O0a),t.ULS.shipAssertTag(4520071,308,Td.ParagraphReader.Xb(Mg.O0a)),be=this.EE.K2a(Mg.O0a),this.A9d(be,Mg.yie)?32:8):32;this.xjo=(be,he,re)=>{2===re&&this.wD.mZ();return 32};this.Spl=(be,he,re,Xf,Mg)=>{if(1===re)return 32;if(2===re)return void 0!==Mg&&null!==Mg?this.wD.igf(Mg,Mg):this.wD.igf(),32;t.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.u0m=(be,he,re)=>{be=this.W$b(he);return be&&Pd.SelectionEditor.Ze(be)?1===re?32:2===re?(re=0<this.ep.o0(be.node).Xt,this.wD.wbf(),this.wD.dialog.fkb=re,32):8:(t.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.OIl=(be,he,re)=>1===re?32:2===re?(this.wD.dialog.fkb=!1,32):8;this.rMn=(be,he,re,Xf,Mg)=>this.J2h(be,re,Mg);this.pMn=(be,he,re,Xf,Mg)=>1===re?32:this.wD.dialog&&this.wD.dialog.fontName?(Mg[gk.a.Value]=this.wD.dialog.fontName,32):this.n0j.FPa(Mb.a.qOb.toString(),
Mg,null)?32:8;this.NIl=(be,he,re)=>1===re?32:2===re?(this.wD.dialog.fkb=!0,32):8;this.qMn=(be,he,re,Xf,Mg)=>this.J2h(be,re,Mg);this.LIl=(be,he,re)=>{if(1===re)return 32;if(2===re){be=this.W$b(he);if(!be)return t.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;he=this.EE.K2a(be.node);this.EE.zpa(he)&&(re=this.Lc.Pc(15),re.Db(he),this.uGj(be),this.NLa.Ouh(he,this.wD.dialog),re.dispose());this.wD.Q7c();return 32}return 8};this.KIl=(be,he,re)=>{if(1===re)return 32;if(2===re){be=
this.W$b(he);if(!be)return t.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;he=this.EE.K2a(be.node);this.EE.zpa(he)&&(re=this.Lc.Pc(15),re.Db(he),this.uGj(be),this.NLa.oFk(he,this.wD.dialog),re.dispose());this.wD.Q7c();return 32}return 8};this.MIl=(be,he,re)=>1===re?32:2===re?(this.wD.Q7c(),32):8;this.IIl=(be,he,re,Xf,Mg)=>{if(1===re)return 32;if(2===re){be=Object(Na.a)(26,Mg);if(!be||!be.vd)return 8;this.wD.dialog.fontName=be.vd.fontName;return 32}return 8};this.JIl=(be,
he,re,Xf,Mg)=>{if(1===re)return 32;if(2===re){be=Object(Na.a)(26,Mg);if(!be||!be.vd)return 8;this.wD.dialog.vXb=be.vd;return 32}return 8};this.ga=b;this.hu=h;this.n0j=r;this.ld=B;this.EE=P;this.Z3j=ca;this.NLa=ra;this.dta=Qa;this.wD=mb;this.ep=Jb;this.wXb=Yb;this.Lc=fc;this.Nk=Mc;this.Ib=Wc;this.BT=id;this.Vd=Id;this.bVj=ve;this.uQg=$d}uGj(b){(b=Bn.FormattingReader.Xr(b))?(this.wD.dialog.fontName||(this.wD.dialog.fontName=b.cache.GG),-1===this.wD.dialog.fontSize&&(this.wD.dialog.vXb=b.cache.fontSize)):
t.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}J2h(b,h,r){return 1===h&&this.wD.dialog?32:2===h&&this.wD.dialog?(r[Ui.a.On]=b===V.a.O4f?this.wD.dialog.fkb:!this.wD.dialog.fkb,32):8}Ub(){qe.App.instance.pqi([V.a.U5d,V.a.T5d,V.a.W5d,V.a.V5d,V.a.mTf,V.a.u8a,V.a.Fqb,V.a.r4]);this.ga.fb(V.a.insertFootnote,zc.a.view,this.bti,4);this.ga.fb(V.a.insertEndnote,zc.a.view,this.bti,4);this.ga.qa(V.a.U5d,zc.a.view,this.Agc);this.ga.qa(V.a.mTf,zc.a.view,this.QIl);
this.ga.qa(V.a.T5d,zc.a.view,this.Agc);this.ga.qa(V.a.W5d,zc.a.view,this.Agc);this.ga.qa(V.a.V5d,zc.a.view,this.Agc);this.ga.qa(V.a.u8a,zc.a.view,this.Agc);this.ga.qa(V.a.Fqb,zc.a.view,this.Agc);this.ga.qa(V.a.Gsj,zc.a.view,this.Axo);this.ga.fb(V.a.H2h,zc.a.view,this.NIl,4);this.ga.fb(V.a.O4f,zc.a.view,this.qMn,100);this.ga.fb(V.a.I2h,zc.a.view,this.OIl,4);this.ga.fb(V.a.h6i,zc.a.view,this.rMn,100);this.ga.qa(V.a.Hsj,zc.a.view,this.Bxo);this.ga.fb(V.a.u6a,zc.a.view,this.u6a,96);this.ga.fb(V.a.JPd,
zc.a.view,this.xjo,96);this.ga.qa(V.a.r4,zc.a.view,this.Spl);this.ga.fb(V.a.NGi,zc.a.view,this.u0m,4);this.ga.fb(V.a.E2h,zc.a.view,this.LIl,4);this.ga.fb(V.a.F2h,zc.a.view,this.KIl,4);this.ga.fb(V.a.G2h,zc.a.view,this.MIl,4);this.ga.fb(V.a.HPd,zc.a.view,this.IIl,4);this.ga.fb(V.a.g6i,zc.a.view,this.pMn,100);this.ga.fb(V.a.IPd,zc.a.view,this.JIl,4);this.ga.fb(V.a.p4c,zc.a.view,$y.p4c,100);this.ga.fb(V.a.q4c,zc.a.view,$y.q4c,100)}k7f(){this.bVj.execute(b=>{b.tV(new QA);b.tV(new $t)})}W$b(b){b=this.aRd(b);
return b?b.Pa:(t.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}aRd(b){let h=null;b=b.view;if(!b)return t.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.mb;if(!b)return t.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.ib;if(!b||!b.length)return t.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return t.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),
h;(h=Pd.SelectionEditor.Jj(b,!1,!1))||t.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}lem(b){return(b=b.view)?b.mb.ib.J(0):null}A9d(b,h=!0,r=!1){if(b){this.dta.d8b();var B=b.xoa;if(B){var P=B.Lb,ca=Fe.SelectionFactory.mJ(P.paragraph,P.cp,P.cp+1);P=this.hu.rc;if(!P)return!1;this.ld.rea(P,ca);P.Jpb=150;P.D1();b=new vp.a(b,h);ca=Di.a.c$b(B,P);B=B.Uwa(P,ca);if(!B)return t.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||B.element?this.wD.shg(b):
(this.wD.shg(new vp.a(b.O0a,!1)),h&&(h=new Oe.a(2,1,10,()=>{this.wD.mZ()}),this.Ib.Wb(h)));return!0}}return!1}static NZl(){return new $y(v.AFrameworkApplication.va,ab.StaticActiveAppFrame.za().jb,Ya.a.instance.resolve("Box4.IGeneralCuiUser"),Hb.InteractiveViewManager.instance,Zy.a.instance,Wz.a.instance,Vz.a.instance,mv.a.instance,rx.FootnoteEndnoteControlManager.instance,Ya.a.instance.resolve("Box4.IParagraphIndentationReader"),Zt.a.instance,new kl.a,xj.a.instance,Rg.a.instance,v.AFrameworkApplication.ta.Kq,
Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Ya.a.instance.Sa("Box4.IContentControlReader"))}static MZl(){return $y.NZl()}static p4c(b,h,r,B,P){if(1===r)return 32;if(2===r&&!P)return 8;wm.a.bYd(h);P.PopulationXML=bp.FontUtils.n4h(wm.a.Sie,wm.a.enf,V.a.HPd);return 32}static q4c(b,h,r,B,P){if(1===r)return 32;if(2===r&&!P)return 8;P.PopulationXML=bp.FontUtils.o4h(V.a.IPd);return 32}}Object(n.a)($y,"FootnoteEndnoteActor",
null,[422]);class RB extends Gs.a{constructor(b){super();this.BXe=b}get index(){return 1}run(){this.BXe()}dK(){this.TY()}}Object(n.a)(RB,"FootnoteEndnoteControlUpdateTracker",Gs.a,[]);var nv=c(355);class Ew extends nv.a{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r,B);this.mt=()=>{this.Idd(this.Cb)};this.CI=b.container;this.dw=document.createElement("div");b.container.appendChild(this.dw);this.cH(this.dw);this.Nhk=P;this.Go.execute(mb=>{mb.hZ(this.mt)});this.RLa=ca;this.IK=ra;this.NI=Qa;this.RLa.execute(mb=>
{mb.Kfg(this.mc,this.CI)});this.NI&&(this.CI.style.backgroundColor=this.IK.C$b())}dispose(){super.dispose();this.Go.instance&&this.Go.instance.ZTa(this.mt)}get Go(){return null!=this.dBg?this.dBg:this.dBg=Ya.a.instance.Sa("Common.IZoomManager")}pC(b){this.CI.classList.add("FootnoteEndnoteViewElement");this.Idd(b.currentNode)}Idd(b){this.Go.instance&&(this.Go.instance.pfd(this.dw),this.dw.style.width=Math.round(100/this.Go.instance.oj)+"%");this.Nhk(b)}}Object(n.a)(Ew,"FootnoteEndnoteViewElement",
nv.a,[]);class HC{constructor(){this._initialized=!1;this.qjd=this.cCe=this.W=null;this.VIl=(b,h,r,B)=>b.F4a?new Ew(b,h,r,B,P=>{rx.FootnoteEndnoteControlManager.instance.R5n(P)},this.W.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!qe.App.instance&&qe.App.instance.cD):null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){ym.WordSectionNavigator.instance.pTf=
Object(z.a)(Vz.a.instance,Vz.a.instance.Wgn,"navigateToWordSectionNodeWithFootnoteEndnote");Hs.a.zfg(this.VIl);rx.FootnoteEndnoteControlManager.instance.bind(ab.StaticActiveAppFrame.za().RF);this.cCe=$y.MZl();this.cCe.Ub();this.cCe.k7f();ab.StaticActiveAppFrame.za().updateCommandUI();this.kAf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,rx.FootnoteEndnoteControlManager.instance.dispose())}kAf(){this.qjd=new RB(()=>{rx.FootnoteEndnoteControlManager.instance.Jdd()});cp.a.yde(Object(z.a)(this.qjd,
this.qjd.dK,"setUpdateNeeded"));Lk.GraphTransactionManager.instance.pra(this.qjd,3)}}Object(n.a)(HC,"PackageManager",null,[1,2]);class Xz{constructor(b,h,r,B){this.hb=h;this.Gfa=B}get bookmarkManager(){return this.Gfa.value}QPm(b){return Jk.App.ZLj?b.startsWith(E.a.Efb):!1}Opm(b){try{this.Ppm(b)}catch(h){t.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}jog(b){return{returnValue:!1,P7f:b,EFb:""}}Ppm(b){if(this.bookmarkManager){b=b.split("/");var h=
this.bookmarkManager.Dwa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Ewa(h,!0).Hba,h=this.bookmarkManager.Ewa(h,!1).Hba,b||h?b?this.Wnj(b):(t.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Wnj(h)):(t.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.DFi(!1))):(t.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.DFi(!0))}}DFi(b){b=Fe.SelectionFactory.Eo(ab.StaticActiveAppFrame.za().jb.Zc.i8h(),b);this.hb.Ac(b)}Wnj(b){b.paragraph&&
b.Lb?(b=Fe.SelectionFactory.ne(b.paragraph,b.Lb.cp),b.cwi=!0,this.hb.Ac(b)):t.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(n.a)(Xz,"InternalLinkManager",null,[342]);class Wr{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new Xz(new zf.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new zf.a(()=>
b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){L.a.instance.Gc(new Wr)}}Object(n.a)(Wr,"WordEditorInternalLinksPackage",null,[1,2]);class Dt{constructor(b){this.wMa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){Me.a.mark(4763);var r=xd.GraphIterator.eb(h);if(r.zb(8)&&r.jd(8)&&r.gDj(h)===h){if(Dg.OutlineReader.isEmpty(r)){let B=!1;for(let P=0;P<lh.a.instance.ib.length;P++){const ca=
lh.a.instance.ib.J(P);for(let ra=0;ra<ca.length;ra++)if(ca.J(ra).node===h){B=!0;break}}B||this.MRh(r)}Me.a.mark(4764)}}};Dt.HK=b}NJd(b){if(!Dt.Hi.A0d(b))return null;b.Tb(1)&&(b.currentNode.nl(8,!0),b.sc());const h=Dt.HK.Gdl();Dt.Hi.isRtl(b.currentNode)?h.setValue(Pe.a.gr,11):h.setValue(Pe.a.gr,9);b.Bf(h,1);b.Bj(h);return h}Yko(b){if(this.wMa&&b!==this.wMa){const h=new Oe.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.wMa;v.AFrameworkApplication.lc.Wb(h)}this.wMa=b}MRh(b){this.wMa===
b.currentNode&&(this.wMa=null);const h=new sg.GraphTransaction(7);h.Ut(b);b.tg();h.dispose()}IEh(){if(this.wMa&&this.wMa.anchor){const b=xd.GraphIterator.eb(this.wMa);b.Ip()&&Dg.OutlineReader.GWc(b)&&this.MRh(b);this.wMa=null}}static get Hi(){return Qh.PageReader.instance}}Dt.HK=null;Object(n.a)(Dt,"PageContentEditor",null,[1433]);var Fw=c(1188),au=c(642);class kt extends Rt{constructor(){super()}grj(b,h,r,B,P){let ca=!1,ra=!0;Pd.SelectionEditor.Ze(P)&&(h=rg.ListItemReader.lg(b)&&h,P=Zf.OutlineElementReader.KA(b,
P,!1)&&!Zf.OutlineElementReader.KA(b,P,!0),h&&r.W6e(b,B)&&(ca=!0),qe.App.zd.Uo&&(P||h&&!ca)&&(ra=!1));return{frj:ra,uLj:ca}}}Object(n.a)(kt,"CursorMoveValidator",Rt,[]);class fo{constructor(b,h,r,B,P){this.Aw=P;this.dOe=b;this.d7=B;this.bta=h;this.rh=r}get Qd(){return null!=this.aJg?this.aJg:this.aJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.MIg?this.MIg:this.MIg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get qc(){return null!=
this.BKg?this.BKg:this.BKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get $s(){return this.d7.value}get Pf(){return this.rh.value}get ar(){return this.bta}Hnm(b){const h=window.performance.now(),r=new In.ScriptSharpLegacyMap,B=new gp.a,P=new In.ScriptSharpLegacyMap;if(b&&b.lx){var ca=null;for(let ra=0;ra<b.length;ra++){const Qa=b.getContext(ra);ca=ca||fo.hi.uu(Qa.node);let mb;if(!({groupId:mb}=this.iQo(Qa.node,ca)).returnValue)continue;let Jb;r.nb(mb)||(Jb=[],r.add(mb,Jb));Jb=r.J(mb);Jb.push(Qa)}for(const ra of vo.toArray(r.keys))b=
r.J(ra),ca=new xd.GraphIterator,ca.set(b[0].node),({rfj:b,kt:ca}=this.bta.GPo(ca)).returnValue?(r.Z(ra,b),P.add(ra,ca)):B.add(ra)}t.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,Knm:B,Jnm:P}}jCb(b){return this.GTk(b)}s4b(b){return this.dTk(b)}wFd(b,h,r=!0){return xd.GraphIterator.kca(()=>{var B=!1;if(rg.ListItemReader.lg(b))return this.W6e(b,h,r);B||(hg.OutlineElementNavigator.Ee(b),B=Td.ParagraphReader.oh(b)||
mi.TableReader.isTable(b),hg.OutlineElementNavigator.Yd(b),B=B&&this.ETk(b,h));return B})}W6e(b,h,r=!0){return xd.GraphIterator.kca(()=>{const B=Zf.OutlineElementReader.DFa(b),P=Dg.OutlineReader.aY(b.currentNode);if(r?!this.sRm(b,h):!this.tRm(b,h))return!1;var ca=xd.GraphIterator.eb(b.currentNode);if(0<h&&ca.zb(14)){ca.jd(16);var ra=ca.currentNode;const Qa=qh.TableCellReader.Hvf(ca);ca.jd(14);const mb=ca.currentNode;ca=nn.a.QM(ra,mb,Oc.a.oS,Oc.a.Aa,0);ra=nn.a.QM(ra,mb,Oc.a.LV,Oc.a.Ba,0);ca=Xg.a.Yy(ca,
0);ra=Xg.a.Yy(ra,0);return B+P<Qa-ca-ra}return!0})}ETk(b,h){const r=Zf.OutlineElementReader.DFa(b);var B=Zf.OutlineElementReader.JG(b);if(0<h){h=Dg.OutlineReader.aY(b.currentNode);B=0;const {Ko:Qa,marginLeft:mb,marginRight:Jb}=fo.CTd(b.currentNode);var P=xd.GraphIterator.eb(b.currentNode);hg.OutlineElementNavigator.Ee(b);if(mi.TableReader.isTable(b)){B=mi.TableReader.Jha(b);var ca=0;for(var ra of B)ca+=ra;B=Xg.a.Yy(Xg.a.nf(ca,0),0)}hg.OutlineElementNavigator.Yd(b);return P.zb(14)?(P.jd(16),ra=P.currentNode,
b=qh.TableCellReader.Hvf(P),P.jd(14),ca=P.currentNode,P=nn.a.QM(ra,ca,Oc.a.oS,Oc.a.Aa,0),ra=nn.a.QM(ra,ca,Oc.a.LV,Oc.a.Ba,0),P=Xg.a.Yy(P,0),ra=Xg.a.Yy(ra,0),r+h<b-P-ra-B):r+h<Qa-mb-Jb-B}return 0<r-B}zTa(b,h){this.O_i(b,-1*Math.abs(h))}TLc(b,h){this.O_i(b,Math.abs(h))}Inl(b,h,r,B,P){let ca=fo.APi;if(h>=fo.APi){ca=h-=r;const ra=B*P,Qa=Math.abs(ra),mb=Math.abs(h)%Qa;mb&&(ca=0>ca?0>B?ca+mb:ca-(Qa-mb):0<B?ca-mb:ca+(Qa-mb));ca+=ra;ca+=r;fo.v$d&&(r=Zf.OutlineElementReader.o0(b),ca=fo.v$d.o7h(b.currentNode,
h+r,ca+r,P,ca<h)-r)}return ca}CTk(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.b9h(b[0].node,h);return this.DTk(b,h,r)}Vyn(b,h,r){if(!b)return t.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return t.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return t.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return t.ULS.shipAssertTag(589592459,
338,!1,"The listIds are empty which are sent for indentation."),8;const B=b[0].node;h=this.b9h(B,h);if(!this.hfn(B,r[0],h)||!this.efn(b,h))return 8;this.$s.s6();return 32}efn(b,h){for(let r=0;r<b.length;r++){const B=new xd.GraphIterator;B.set(b[r].node);let P=null;hg.OutlineElementNavigator.Ee(B);if(Td.ParagraphReader.oh(B)){if(P=B.currentNode,!P)return t.ULS.shipAssertTag(589592461,338,!P,"The paraNode is null for the list OE node"),!1}else if(!Td.ParagraphReader.oh(B)&&!mi.TableReader.isTable(B))return t.ULS.shipAssertTag(589592460,
338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;B.sc();if(P){if(this.Msm(P)){const ca=P.aE(),ra=Zf.OutlineElementReader.DFa(B);this.Pf.Kza(B,1,ra+h);ca&&this.Ej.GV(P,ca,this.Qd.yg)}oj.a.getInstance().es||P.setValue(Pe.a.QR,new Date)}}return!0}hfn(b,h,r){for(let B=0;B<ti.a.h5;B++){const P=this.bta.Px(b,h,B);if(!P)return t.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ca=P.getValue(Oc.a.ee);ca&&P.setValue(Oc.a.ee,ca+r)}return!0}Msm(b){return b.hasProperty(Oc.a.ee)||
b.hasProperty(Oc.a.qt)||b.hasProperty(Oc.a.RA)}dTk(b){return this.wFd(b,1,!0)}GTk(b){return this.wFd(b,-1,!0)}b9h(b,h){var r=new xd.GraphIterator;r.set(b);const B=Zf.OutlineElementReader.DFa(r),P=Zf.OutlineElementReader.JG(r),ca=Zf.OutlineElementReader.o0(r);r=Dg.OutlineReader.aY(b);fo.CTd(b);b=(P?B-P:ca)%r;return h?-1*(b?b:r):r-b>fo.HQh?fo.HQh:r-b}iQo(b,h){let r;const B=new xd.GraphIterator;B.set(b);b=B.Tb(4).getValue(Oc.a.listID);return({id:r}=this.bta.Boc(b,h)).returnValue?{returnValue:!0,groupId:r}:
{returnValue:!1,groupId:r}}DTk(b,h,r){var B=!1;for(let P=0;P<b.length;P++){B=b[P];const ca=new xd.GraphIterator;ca.set(B.node);Pd.SelectionEditor.Bu(ca);if(!Zf.OutlineElementReader.yh(ca))return fo.Ic.Yb(te.a.ef,{["Reason"]:fe.a.oEb}),!1;if(this.wFd(ca,h,r))B=!0;else return fo.Ic.Yb(te.a.l7b,{["Reason"]:fe.a.n7e}),!1}return B}O_i(b,h){if(this.wFd(b,h,!0)){var r=!1;if(rg.ListItemReader.lg(b)){var B=new xd.GraphIterator;B.kd(b);this.ar.EP(B);var P=B.currentNode;B.sc();r=!0;const {listId:ra,listLevel:Qa}=
rg.ListItemReader.HGb(b);var ca=this.Xfm(ra,Qa+h);if(ca)hg.OutlineElementNavigator.Ee(B),Td.ParagraphReader.oh(B)&&fo.tE.cK(ca,B.currentNode,!1),B.sc();else{ca=null;let mb;hg.OutlineElementNavigator.Ee(B);Td.ParagraphReader.oh(B)&&(ca=B.currentNode);B.sc();mb=ca?ca.aE():null;ca||(hg.OutlineElementNavigator.Ee(B),Td.ParagraphReader.oh(B)&&(ca=B.currentNode),B.sc());ca&&(ca.hasProperty(Oc.a.ee)&&ca.removeProperty(Oc.a.ee),ca.hasProperty(Oc.a.qt)&&ca.removeProperty(Oc.a.qt));oj.a.getInstance().Ru||this.Aw.A9a(P,
Qa+h);oj.a.getInstance().es&&this.Aw.A9a(ca,Qa+h);oj.a.getInstance().Ru||P.removeProperty(Oc.a.aV);ca&&mb&&(this.Ej.GV(ca,mb,this.Qd.yg),this.$s.s6());this.qHo(b,P)}}r||(r=Zf.OutlineElementReader.DFa(b),B=Zf.OutlineElementReader.JG(b),P=Dg.OutlineReader.aY(b.currentNode),h=this.Inl(b,r,B,h,P),this.Pf.Kza(b,1,h))}}tRm(b,h){const r=Zf.OutlineElementReader.DFa(b),B=Zf.OutlineElementReader.JG(b),P=Zf.OutlineElementReader.o0(b),{Ko:ca,marginLeft:ra,marginRight:Qa}=fo.CTd(b.currentNode);if(0<h){if(b=ca-
ra-Qa,P&&P+h+qe.App.GAa>b||r+h+qe.App.GAa>b)return!1}else if(P&&0>r+h||0>r-B+h)return!1;return!0}sRm(b,h){var r=this.$s.GB(b);const B=r.level+h;if(ks.a.W_m<B||B<ks.a.uGl)return!1;r=this.ar.Px(b.currentNode,r.listID,B);if(!r)return t.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Oc.a.ee)){h=r.getValue(Oc.a.ee);const {Ko:P,marginLeft:ca,marginRight:ra}=fo.CTd(b.currentNode);if(h+qe.App.GAa>P-ca-ra)return!1}return!0}Xfm(b,h){const r=this.qc.Ar();for(let B=0;B<r.DO;B++){const P=r.PFa(B);
if(this.ar.whb(P)&&P.ja(Oc.a.listID,this.$s.H9+1)===b&&P.ja(Oc.a.listLevel,-1)===h)return P}return null}qHo(b,h){hg.OutlineElementNavigator.Ee(b);if(Td.ParagraphReader.oh(b)&&b.currentNode.hasProperty(Oc.a.ee)&&(h=this.ar.m$b(h))){if(h.hasProperty(Oc.a.qt)){var r=h.getValue(Oc.a.qt);this.dOe.bqb(b.currentNode,r)}h.hasProperty(Oc.a.ee)&&(r=h.getValue(Oc.a.ee),this.dOe.Kza(b,1,r));h.hasProperty(Oc.a.RA)&&(h=h.getValue(Oc.a.RA),this.dOe.mea(b.currentNode,h))}hg.OutlineElementNavigator.Yd(b)}static get tE(){return null!=
fo.bKg?fo.bKg:fo.bKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get v$d(){return null!=fo.oGg?fo.oGg:fo.oGg=Ya.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get Sk(){return fo.Xs||(fo.Xs=Ya.a.instance.resolve("Box4.IParagraphEditor"))}static set Sk(b){fo.Xs=b}static get Ic(){return Ih.a.instance}static get Uf(){return Kn.a.instance}static get hi(){return ro.PageNavigator.instance}static CTd(b){var h=ym.WordSectionNavigator.instance.zL(b);b=fo.Uf.ru(h);const r=fo.Uf.CJ(h);
h=fo.Uf.oL(h);return{Ko:b,marginLeft:r,marginRight:h}}}fo.HQh=af.a.Nv(.25);fo.Xs=null;fo.APi=af.a.Nv(-11);Object(n.a)(fo,"OutlineElementIndentationEditor",null,[490,491]);var az=c(235),bz;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(bz||(bz={}));Object(n.b)("StyleTargetType",bz);var Gw=c(218);class Tv{constructor(b,h){this.jX=null;this.FK=h;this.Hf=b}get Sk(){return null!=this.XFg?this.XFg:this.XFg=Ya.a.instance.resolve("Box4.IParagraphEditor")}get XH(){return null!=
this.yAg?this.yAg:this.yAg=Ya.a.instance.resolve("Box4.IFontStylesGalleryCache")}get io(){return null!=this.QHg?this.QHg:this.QHg=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}get rn(){return null!=this.QAg?this.QAg:this.QAg=Ya.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=this.EKg?this.EKg:this.EKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Tea(){return this.jX||(this.jX=new au.WACStyleSet)}set Tea(b){this.jX=b}get Zb(){return null!=this.bAg?this.bAg:this.bAg=Ya.a.instance.Oa("Box4.IFeatureHelper")}get Zm(){return this.FK.value}get Cj(){return null!=
this.UBg?this.UBg:this.UBg=Ya.a.instance.Oa("Box4.IInsertionPointFormatting")}get v_c(){return this.Hf||(this.Hf=Ya.a.instance.resolve("Box4.List.IListReader"))}get jg(){return null!=this.vxg?this.vxg:this.vxg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Qd(){return null!=this.rJg?this.rJg:this.rJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.SIg?this.SIg:this.SIg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get yR(){return null!=
this.jBg?this.jBg:this.jBg=Ya.a.instance.resolve("Box4.IBox4GraphWriter")}fgm(b){const h=b.node;var r=this.Cj?this.Cj.T6h():null;if(r&&!r.equals(U.a.nil)){b=h.Mc;if(!b)return null;r=b.Eb(r);if(!r||(r=new Gw.a(r),1!==this.qc.NG(r)))return null}else r=Bn.FormattingReader.Xr(b),r=Bn.FormattingReader.Zwa(r);return r}Qoo(b,h){const r=this.qc.ZC(h);r&&r.pj(this.qc.Kg(b))&&(this.Eqg(h,r),this.Cj&&(this.Cj.y7a(),this.Cj.l8a(b,h)))}PEk(b,h){if(h)if(h.DFb&&0<h.DFb.length){let P=new fa.a;for(var r of h.DFb)P.add(r);
if(h.IFi){r=Bn.FormattingReader.f5h(b);const ca=[];for(var B of r)B.formatting&&B.formatting.Jn&&ca.push(B.formatting.Jn);if(0<ca.length){B=rw.APropertySet.ubi(ca);r=new fa.a;for(const ra of P)(!B.hasProperty(ra)||h.JZm&&ra===Nd.a.$Va)&&r.add(ra);P=r}}this.Sk.ACb(b,!0,P)}else this.Sk.ACb(b,!0);else Rc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}cK(b,h,r,B=!1,P=!1,ca=!1,ra=null,Qa=!1){var mb,Jb,Yb,fc;oj.a.jda||(Qa=!1);if(Td.ParagraphReader.Xb(h))if(b)if(this.qc.pda(b.Gl()))if(2!==
this.qc.NG(b))t.ULS.shipAssertTag(593506381,324,!1);else{var Mc=this.qc.ZC(h);if(Mc){var Wc=this.qc.Kg(b);if(!Wc)t.ULS.shipAssertTag(593506377,324,!1);else if(Mc.pj(Wc)){var id=null,Id=nq.a.instance.J(1)&&!B?h.aE():null;r||((null===ra||void 0===ra?0:ra.VSk)&&(null===(mb=this.Zb)||void 0===mb?0:mb.isFeatureEnabled(102))?(this.PEk(h,ra),1==ra.DFb.length&&ra.DFb[0]==Nd.a.$Va?id=this.Zm.i8i(id,h):this.CYo(h,b,ra)):(id=this.Zm.i8i(id,h),this.Sk.ACb(h,!0)));this.Eqg(h,Mc);P&&(null===Id||void 0===Id?0:Id.hasProperty(xe.a.Uv))&&
Id.removeProperty(xe.a.Uv);rg.ListItemReader.Nj&&(h.removeProperty(xe.a.Uv),h.UL=null,this.eoj(b,h,id,Qa));(null===(Jb=this.yR)||void 0===Jb?0:Jb.K$)?this.yR.K$(h,xe.a.Uv,b.id):h.properties.setValue(xe.a.Uv,b.id);(Qa||this.v_c.Aca(h))&&(null===(Yb=this.Zb)||void 0===Yb?0:Yb.isFeatureEnabled(102))&&this.iGj(h,b,ra);h.UL=b;h.qJa=null;for(r=0;r<h.ra.length;r++)h.ra.J(r).formatting&&h.ra.J(r).formatting.YIb();rg.ListItemReader.Nj||this.eoj(b,h,id,Qa);(null===(fc=this.io)||void 0===fc?0:fc.B9)&&null!=
this.XH&&this.XH.nmc(Wc);B||!Id||ca||this.Ej.GV(h,Id,this.Qd.yg);rg.ListItemReader.Nj&&this.v_c.whb(b)&&this.Zm.s6()}}else t.ULS.shipAssertTag(593506379,324,!1)}else t.ULS.shipAssertTag(593506382,324,!1);else t.ULS.shipAssertTag(593506383,324,!1);else t.ULS.shipAssertTag(593506384,324,!1)}eoj(b,h,r,B){this.v_c.whb(b)&&(r||(r=new xd.GraphIterator,r.set(h),r.od(),hg.OutlineElementNavigator.Yd(r)),B||rg.ListItemReader.lg(r)||(h.Cg(Oc.a.ee,Oc.a.iN,Oc.a.RA,Oc.a.o1,Oc.a.oTa,Oc.a.Dw),this.IDd(r,b)))}CYo(b,
h,r){const B=this.v_c.Aca(b),P=this.v_c.whb(h);B&&(this.iGj(b,h,r),P||B.removeProperty(Oc.a.aV))}iGj(b,h,r){const B=b.Mc;if(b=this.jg.S1a(b)){var P=null==b.Jn?new az.a:b.Jn.clone();um.a.LZo(P,h,r&&!r.IFi&&r.DFb?r.DFb:null);P.XGa?h=B.uV(P,!0):(B.Xu(P,null),h=P);b.Xj=h.id}else t.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}IDd(){}h$c(b,h){if(h){t.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.qc.ZC(h);r?(b=r.QFa(b))?
this.qc.pda(b.Gl())?this.cK(b,h,!1,void 0,void 0,void 0,null):t.ULS.shipAssertTag(593506368,324,this.qc.pda(b.Gl())):t.ULS.shipAssertTag(593506369,324,!!b):t.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else t.ULS.shipAssertTag(593506372,324,!1)}F8e(b,h=!1,r=!1){const B=this.qc.ZC(b).pj(Rl.StyleReader.wordStyleIdNormal);this.cK(B,b,h,void 0,r)}Eqg(b,h){(b=Tv.hi.uu(b))&&h.Xhe(b)}ERh(b){var h=null;if(this.Zb&&this.Zb.isFeatureEnabled(37)){if(!b||!b.count)return t.ULS.sendTraceTag(592221652,
3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=um.a.zr(),!h))return t.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.Tea.iY(h);if(!r)return t.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var B=new Map;B.set("NumberOfStyles",b.count.toString());B.set("Source","DeleteStyleAPI");xa.Health.instance.recordKpiUsage(Do.a.bqe,0,Do.a.zB,B);B=0;const ra=(new Date).getTime();var P=null;let Qa=null,mb=null,Jb=null;
const Yb=this.Zb.isFeatureEnabled(36)&&!0;Yb&&(P=new vb.a,Qa=new vb.a,mb=new vb.a,Jb=new vb.a);for(var ca of b){if(!ca)return t.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const fc=r.pj(ca);if(!fc||!this.qc.le(fc,r))return t.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!fc,!!fc&&this.qc.le(fc,r)),!1;const Mc=this.qc.NG(fc);if(2!==Mc&&1!==Mc)return t.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Mc),!1;const Wc=
this.qc.GFa(fc,r);let id=0;if(Wc){if(!this.qc.le(Wc,r))return t.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;id=this.qc.NG(Wc);if(2!==id&&1!==id)return t.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Mc,id),!1}else t.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Id=this.aEb(fc,r);if(!Id)return!1;B++;Yb&&(1===Mc?(Qa.add(ca),Jb.add(fc.id)):(P.add(ca),
mb.add(fc.id)));if(Wc){Id=this.aEb(Wc,r);if(!Id)return!1;B++;Yb&&(1===id?(Qa.add(this.qc.Kg(Wc)),Jb.add(Wc.id)):(P.add(this.qc.Kg(Wc)),mb.add(Wc.id)))}}Bj.a.OVc();r=um.a.svf(r);ca=new sg.GraphTransaction(15);ca.Db(h);Yb&&this.A1n(P,Qa,mb,Jb,h);h.setValue(xe.a.fVa,r);Rc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));ca.Wge();ca.dispose();h=(new Date).getTime();P=new Map;P.set("Source","DeleteStyleAPI");P.set("NumberOfStyles",b.count.toString());P.set("TrueStyleCount",B.toString());
P.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new sb.a,{extendedProperties:P,durationMs:h-ra});xa.Health.instance.recordKpiSuccess(Do.a.bqe,b);return!0}return!1}A1n(b,h,r,B,P){if(b&&b.count||h&&h.count)if(P){var ca=(new Date).getTime();if(P=this.OWl(P)){for(;P.moveNext();){if(!Td.ParagraphReader.oh(P.iterator))continue;const ra=P.currentNode;this.k1n(ra,b,r);this.l1n(ra,h,B)}r=(new Date).getTime();t.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
r-ca));B=new Map;B.set("Source","DeleteStyleRemoveStylesReferences");B.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new sb.a,{extendedProperties:B,durationMs:r-ca});xa.Health.instance.recordKpiSuccess(Do.a.bqe,b)}}else Rc.b(577520338,3018,50,"PageContentNode not provided.");else Rc.b(577520337,3018,50,"No style IDs provided")}k1n(b,h,r){if(h&&h.count&&b){var B=b.Zy;B&&B.hasProperty(xe.a.Uv)&&r.contains(B.getValue(xe.a.Uv))&&(B.removeProperty(xe.a.Uv),b.Zy=B,b.aE()&&this.Ej.GV(b,
b.aE(),this.Qd.yg));(r=this.qc.hp(b))&&(r=this.qc.Kg(r))&&h.contains(r)&&this.F8e(b,!0,!0)}}l1n(b,h,r){if(b&&b.ra&&b.ra.length&&h&&h.count)for(let ra=0;ra<b.ra.length;ra++){var B=b.ra.J(ra);if(B&&B.formatting&&(B=B.formatting)&&B.Lb){var P=Bn.FormattingReader.Zwa(B);P&&(P=this.qc.Kg(P))&&h.contains(P)&&this.rn.w8e(B);if(P=B.Lb.fo){var ca=P.Jn;ca&&(ca=ca.clone(),ca.hasProperty(xe.a.qw)&&r.contains(ca.getValue(xe.a.qw))&&this.s_n(b,ca,P,B));nq.a.instance.J(1)&&(ca=ra===b.ra.length-1?b.characterData.length:
b.ra.J(ra+1).cp,this.Ej.oQb(b,B.Lb,B.Lb.cp,ca,P,B,this.Qd.yg))}}}}s_n(b,h,r,B){b&&h&&r&&B&&(b=b.Mc)&&(h.removeProperty(xe.a.qw),h.XGa?h=b.uV(h,!0):b.Xu(h,null),r.Xj=h.id,B.Lb.fo=r)}OWl(b){if(!b)return null;b=xd.GraphIterator.eb(b);return b.Ip()?qc.a.Gs(b,b.origin):null}aEb(b,h){if(!b)return t.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Gl();return this.qc.pda(r)?h.z1n(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",bz[this.qc.NG(b)]),r.set("IsCustomStyle",
this.qc.le(b,h).toString()),r.set("IsLinkedStyle",(!!this.qc.GFa(b,h)).toString()),b=Object.assign(new sb.a,{extendedProperties:r}),xa.Health.instance.recordKpiFailure(Do.a.bqe,"UnableToDeleteStyle",!1,!0,b),t.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(t.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}LSa(b,h,r,B){if(this.Zb&&this.Zb.isFeatureEnabled(83)){if(!b)return t.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),
!1;if(!r&&(r=um.a.zr(),!r))return t.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.Tea.iY(r);if(!ca)return t.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.pj(b);if(!b)return t.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var P=this.qc.NG(b);if(2!==P&&1!==P)return t.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",P),!1;xa.Health.instance.recordKpiUsage(Do.a.Tsg,
0,Do.a.zB,new Map([["Source","ModifyStyleAPI"]]));P=Date.now();const ra=new sg.GraphTransaction(15);let Qa,mb;try{ra.Db(r);if(!(B&&0!=B.length||h&&0!=h.count))return!1;if(B&&0!=B.length&&(Qa=um.a.ZSd(b),!ca.Rll(b,B)))return this.hya("ModifyStyleAPI",b,ca,P,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Wc=ca.K_o(b,h);mb=um.a.ZSd(b);if(!Wc)return this.hya("ModifyStyleAPI",b,ca,P,"UnableToModifyStyle"),!1}this.jfn(b,r,mb,Qa);Bj.a.OVc();const Jb=um.a.svf(ca);r.setValue(xe.a.fVa,Jb);Rc.b(572302818,
3018,50,String.format("Style Object Ids - {0}",Jb));const Yb=Date.now(),fc=new Map([["Source","ModifyStyleAPI"]]),Mc=Object.assign(new sb.a,{extendedProperties:fc,durationMs:Yb-P});xa.Health.instance.recordKpiSuccess(Do.a.Tsg,Mc);return!0}finally{ra&&ra.dispose()}}return!1}jfn(b,h,r,B){var P,ca;if(null!==b){var ra;B&&((ra=null===(P=this.Zm)||void 0===P?void 0:P.Ioe(h,B,b,!0))||Rc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((ra=null===(ca=
this.Zm)||void 0===ca?void 0:ca.Ioe(h,r,b,!1))||Rc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}hya(b,h,r,B,P){const ca=Date.now();b=new Map([["Source",b],["StyleType",bz[this.qc.NG(h)]],["IsCustomStyle",this.qc.le(h,r).toString()],["IsLinkedStyle",(!!this.qc.GFa(h,r)).toString()]]);B=Object.assign(new sb.a,{extendedProperties:b,durationMs:ca-B});xa.Health.instance.recordKpiFailure(Do.a.Tsg,P,!1,!0,B)}static get hi(){return ro.PageNavigator.instance}}
Object(n.a)(Tv,"WACStyleEditor",null,[1324]);class RA extends Tv{constructor(b,h,r){super(b,r);this.d7=h}get $s(){return this.d7.value}IDd(b,h){this.$s.IDd(b,h)}}Object(n.a)(RA,"WACStyleEditor",Tv,[]);class SA{f8a(b,h){b.properties.setValue(Oc.a.marginTop,h)}d8a(b,h){b.properties.setValue(Oc.a.marginBottom,h)}cka(b,h){b.properties.setValue(Oc.a.marginLeft,h)}e8a(b,h){b.properties.setValue(Oc.a.marginRight,h)}Beg(b,h){b.properties.setValue(Oc.a.Ko,h)}Aeg(b,h){b.properties.setValue(Oc.a.uv,h)}Jmj(b,
h){b.properties.setValue(Oc.a.VFi,h)}kQb(b,h){b.properties.setValue(Nd.a.aF,h)}Uho(b,h){b.properties.setValue(Nd.a.zna,h)}jlc(b,h){b.properties.setValue(Nd.a.uG,h)}too(b,h){b.properties.setValue(Nd.a.separator,h)}}Object(n.a)(SA,"WordSectionEditor",null,[339]);class Hw{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new SA).as("Box4.IWordSectionEditor").ha();v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new Dt(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new fo(uu.a.yQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementEditor"),b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>
new fo(uu.a.yQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementEditor"),b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new kt).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new Fw.a(new au.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",
()=>new RA(b.resolve("Box4.List.IListReader"),b.Ve("WordEditor.IFlatListEditor"),b.Ve("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){L.a.instance.Gc(new Hw)}}Object(n.a)(Hw,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var Hu=c(34),SB=c(600),TA=c(217);class Am{constructor(b,h){this.Jd=b;this.rh=h;this.cNa=null}tQb(b){var h=b.propertySet.ja(Oc.a.listID,0);const r=b.propertySet.ja(Oc.a.listLevel,-1);if(0<h&&0<=r)this.cNa=b;else{let B=1;const P=
b.listStyle;42!==P&&0<P&&(B=P);this.cNa=Kp.a.IX(b.listType,B,null,h,r,void 0,"")}h=new Sz.a;switch(b.o6){case 0:this.cNa.YB=h.obf();break;case 2:this.cNa.YB=h.LLh(h.Tzh,h.Szh);break;case 1:this.cNa.YB=h.fcf(h.WUf,h.XUf)}}Rmo(b){b&&(this.cNa=b)}UKc(b){const h=Ih.a.instance.Fp(Mb.a.pcl);Zf.OutlineElementReader.yh(b)||(t.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Ih.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:fe.a.oEb}));
rg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),Ih.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:fe.a.L5k}));const r=Zf.OutlineElementReader.tR(b);r&&!r.hasProperty(Oc.a.lwa)&&t.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const B=this.tcl();b.Bf(B,4);r&&(r.ND=B);h.end();return B}tcl(){return $o.a.instance.createInstance(393234)}$da(b){const h=
Ih.a.instance.Fp(Mb.a.$da);Zf.OutlineElementReader.yh(b)||Ih.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:fe.a.oEb});rg.ListItemReader.lg(b)&&(oj.a.getInstance().es?this.yIa(b):this.Yaj(b));h.end()}Yaj(b){this.Jd.EP(b);b.tg()}Zma(b,h,r,B=!1){const P=Ih.a.instance.Fp(Mb.a.WEk);this.Gnj(b,r,B);const ca=b.hasProperty(Zc.a.ZQi);var ra=b.ja(Zc.a.CZd,!1);let Qa=!1;1===r.ks&&r.Rpa&&!r.PJ&&(Qa=!0);const mb=r.propertySet.ja(Oc.a.Ot,null);mb&&mb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===r.listType?
Qa=r.Rpa&&!r.PJ:r.listType||(Qa=!r.listStyle));if(ra)Qa&&(r.I$(16,0),b.setValue(Zc.a.MA,16),b.setValue(Zc.a.qSa,0));else{ra=this.Jd.ww(h);this.Srj(r,ra,ca,Qa)&&(P.properties.Z("ToggledOff","true"),r.I$(16,0),this.Glo(b));if(!this.Y$d(b,h,r,B))return P.end(),t.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,wxa:r};!r.listType&&b.hasProperty(Zc.a.y5a)&&(r.UA=b.getValue(Zc.a.y5a),b.removeProperty(Zc.a.y5a))}if(ca&&(P.properties.Z("MultipleOESelection",
"true"),({wxa:r}=this.qvo(h,r)).returnValue))return P.end(),t.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,wxa:r};this.LAk(h,r,b,B);KA.a.Jej();b.hasProperty(Ng.a.MQ)&&KA.a.S9k(b.getValue(Ng.a.MQ),h,this.Jd);b.setValue(Zc.a.CZd,!0);P.end();return{returnValue:!0,wxa:r}}Srj(b,h,r,B){if(B)return!0;if(h){B=b.listType===h.listType;const P=!b.listStyle&&b.UA===ti.a.Vl;let ca=b.listStyle===h.listStyle&&b.UA===h.UA;b=(!b.Rpa||this.jbg(h,b))&&!r;ca=ca&&
b;return B&&(P||ca)}return!1}Glo(b){b.setValue(Zc.a.MA,16);b.setValue(Zc.a.qSa,0)}jbg(){return!0}Gnj(){}Y$d(){return!0}qvo(b,h){return{returnValue:16!==h.listType&&Zf.OutlineElementReader.isEmpty(b,!0),wxa:h}}WIc(b){const h=Ih.a.instance.Fp(Mb.a.WIc);Td.ParagraphReader.Xb(b)||Ih.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:fe.a.ehf});const r=new xd.GraphIterator;r.set(b);r.od();r.Ps(12);hg.OutlineElementNavigator.Yd(r);this.yIa(r);h.end()}merge(b,h,r){const B=Ih.a.instance.Fp(Mb.a.s2m);
Zf.OutlineElementReader.yh(h)||Ih.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Zf.OutlineElementReader.yh(b)||Ih.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});rg.ListItemReader.lg(h)&&(B.properties.Z("UseSourceListWithNonlistDestination",r.toString()),r&&rg.ListItemReader.lg(b)&&this.$da(b),rg.ListItemReader.lg(b)&&!r?this.k5i(h,b):r&&(r=this.fci(h),1===r.ks&&r.i8e(!0),this.u3b(b,r),B.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.$da(h),
B.properties.Z("RemoveListFromSrcOE","true"));B.end();return!0}k5i(){}fci(b){return this.Jd.ww(b)}HNc(b,h){h.hasProperty(Zc.a.MA)||(b===Mb.a.qD?h.setValue(Zc.a.MA,1):(b===Mb.a.ML||b===Mb.a.Dda)&&h.setValue(Zc.a.MA,0));h.hasProperty(Zc.a.qSa)||h.setValue(Zc.a.qSa,0);return h}J3b(b,h,r,B,P,ca,ra,Qa){const mb=Ih.a.instance.Fp(Mb.a.J3b),Jb=this.Jd.ww(h);r=Kp.a.IX(0,r,void 0,void 0,void 0,ra);r.UA=B;r.MQ=ca;Jb&&r.szf(Jb)&&r.UA===Jb.Tu||(B=new sg.GraphTransaction(15),B.Ut(h),Qa.kkn(r.listType,r.listStyle,
r.UA,r.levelText,r.MQ)&&(Am.jg.Ge(P,""),Td.ParagraphReader.Xb(b)&&TA.a.Dpa(b)&&(h=this.Jd.Aca(b))&&Am.jg.dxl(b,h)),B.dispose());mb.end()}Ioe(b,h,r,B=!1){if(null===r||null===b||null===h)return!1;b=this.Jd.Px(b,h.listId,h.listLevel);if(!b)return t.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(B){if(b.hasProperty(xe.a.Uv)){b.getValue(xe.a.Uv)instanceof U.a||t.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!U.a.Cq(b.getValue(xe.a.Uv),r.id))return t.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(xe.a.Uv);return!0}}else{r=r.id;r instanceof U.a||t.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(xe.a.Uv))return t.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(xe.a.Uv,
r);return!0}return!1}static get S8b(){return null!=Am.uAg?Am.uAg:Am.uAg=Ya.a.instance.Oa("Box4.IFontSlotProvider")}static get jg(){return null!=Am.nxg?Am.nxg:Am.nxg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Jo(){return oj.a.getInstance()}}Object(n.a)(Am,"ListEditor",null,[500]);var iy=c(826),bu=c(323);class Is{constructor(b,h,r,B,P,ca){this.Hf=P;this._pageContent=r;this.Axb=Array(Is.h5);this.K0b=Array(Is.h5);this.Rhh=Array(Is.h5);this.$Qe=Array(Is.h5);this.beh=Array(Is.h5);
this.x3=B;this.fFc=ca;for(B=0;B<Is.h5;B++){var ra=this.$bi(b,B,r,P);ra?(ca=ra.ja(Pe.a.Y0,ti.a.Vl),ra=ra.ja(Oc.a.a8c,ti.a.Vl)):ra=ca=ti.a.Vl;this.K0b[B]=ca!==ti.a.Vl?ca:ti.a.JLc;this.$Qe[B]=ra===ti.a.Vl?B-1:ra-1;Is.L9(h)&&(this.Rhh[B]=ti.a.Vl,this.beh[B]=ti.a.Vl);this.Axb[B]=this.K0b[B]}}$bi(b,h,r,B){B.v4(r);return oj.a.getInstance().lWc&&this.fFc?this.Hf.Hsf(b,h,this.x3,r):this.Hf.qRc(b,h,r.Mc,r)}restart(b){this.Axb[b]=this.K0b[b]}NRi(b){for(var h=0;h<b;h++)this.Axb[h]===this.K0b[h]&&this.Axb[h]++;
for(h=b+1;h<Is.h5;h++)this.$Qe[h]>=b&&this.restart(h);return this.Axb[b]++}static L9(b){return!!b&&b.isFeatureEnabled(73)}}Is.h5=9;Object(n.a)(Is,"AWordList",null,[42]);class sx{constructor(b,h,r,B){this.ycb=new In.ScriptSharpLegacyMap;this.Hf=b;this.JK=h;this.x3=r;this.fFc=B}ww(b,h){this.ycb.nb(b)||this.ycb.Z(b,new Is(b,h,this.JK,this.x3,this.Hf,this.fFc));return this.ycb.J(b)}ZTf(b,h,r){return this.ww(b,r).NRi(h)}}Object(n.a)(sx,"AListNumberingMap",null,[1500]);class TB extends Is{constructor(b,
h,r,B,P,ca){super(b,h,r,B,P,ca)}E8l(b,h,r,B){B.v4(r);return oj.a.getInstance().lWc&&this.fFc?this.Hf.b4l(b,h,this.x3):this.Hf.a4l(b,h,this._pageContent.Mc)}cGj(b,h,r){var B=this.E8l(b,h,this._pageContent,this.Hf);B?(b=B.ja(Pe.a.Y0,ti.a.JLc),B=B.ja(Oc.a.a8c,ti.a.Vl),this.Axb[h]=this.Rhh[h]=this.K0b[h]=b,B!==ti.a.Vl&&(this.beh[h]=this.$Qe[h]=B-1)):r&&(B=this.$bi(b,h,this._pageContent,this.Hf),b=ti.a.JLc,B&&(b=B.ja(Pe.a.Y0,ti.a.JLc)),this.Axb[h]=this.K0b[h]=b)}}Object(n.a)(TB,"WordList",Is,[]);class Iw extends sx{constructor(b){super(b.Jd,
b.pageContentNode,b.nUa,b.mJj);this.uch=new vb.a}C3l(b,h,r){let B;oj.a.getInstance().KY?{value:B}=this.Hf.wF.Fc(b,B):{value:B}=this.Hf.W0.Fc(b,B);this.ycb.nb(B)||this.ycb.Z(B,new TB(b,r,this.JK,this.x3,this.Hf,this.fFc));if(!this.uch.contains(b))for(this.uch.add(b);h<ti.a.h5;h++)this.ycb.J(B).cGj(b,h,!1);else if(!h)for(h+=1;h<ti.a.h5;h++)this.ycb.J(B).cGj(b,h,!0);return this.ycb.J(B)}ZTf(b,h,r){return Is.L9(r)?this.C3l(b,h,r).NRi(h):super.ZTf(b,h,r)}}Object(n.a)(Iw,"ListNumberingMap",sx,[]);class UA{constructor(){this.SSa=
0;this.YKj=!1}}Object(n.a)(UA,"LastNumber",null,[]);var cz=c(847),Uv=c(418),dz=c(901);class UB{constructor(){this.startAt=this.kUa=0}}Object(n.a)(UB,"WordListRestartInfo",null,[]);class wp{constructor(b,h,r,B){this.q6d=!1;this.$s=b;this.Ozi=r;this.fcc=B;this.Fw=this.$s.GB(h);this.KP=new xd.GraphIterator;this.KP.kd(h)}static get Jd(){return wp.Hf||(wp.Hf=Ya.a.instance.resolve("Box4.List.IListReader"))}static set Jd(b){wp.Hf=b}static get Jo(){return oj.a.getInstance()}static LEl(b,h,r,B=!1,P=!1){var ca=
h.currentNode;let ra=null,Qa=!1,mb=!1;h=h.pTb();const Jb=qc.a.gp(h);Jb.moveNext();for(h=Jb.iterator;h.currentNode!==ca;){let fc=mb=Qa=!1;var Yb=wp.Ysl(h);if(Zf.OutlineElementReader.yh(h)&&!Yb){Yb=!1;if(h.Jt(4))if(wp.lTi(h,r,!0,B,P)){if(fc=!0,ra=new wp(b,h,!1,!1),Jb.moveNext(),Jb.iterator===ca&&(Qa=!0),B)break}else Zf.OutlineElementReader.isEmpty(h,!1)||(Yb=!0),mb=!0;else!Zf.OutlineElementReader.isEmpty(h,!1)&&h.dkb(12)&&(Zf.OutlineElementReader.YQ(h)||(Yb=!0));!B&&Yb&&ra&&(r.propertySet.hasProperty(Oc.a.listLevel)?
ra.Fw.level=0:ra=null)}fc||Jb.moveNext();h=Jb.iterator}ra&&(ra.fcc=Qa);if(!ra&&h.Lf(1))for(ca=!0;h.currentNode;){if(Zf.OutlineElementReader.yh(h)){if(h.Jt(4)&&wp.lTi(h,r,!1,B,P)){ra=new wp(b,h,!0,ca);break}if(!Zf.OutlineElementReader.isEmpty(h,!1))break}if(!h.Lf(1))break;ca=!1}ra&&(ra.q6d=mb);return ra}static Ysl(b){var h=b.Tb(2);if(!h)return!1;h=Td.ParagraphReader.oh(b)&&wp.DSm(h);b.sc();return h}static DSm(b){return xo.a(b,8)}static lTi(b,h,r,B=!1,P=!1){if(!rg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508913603,
393,15,"Trying to call oeMatchesInfo for non list item"),rg.ListItemReader.Nj))return!1;if(rg.ListItemReader.Nj)var ca=rg.ListItemReader.e9(b);else wp.Jd.EP(b),ca=b.currentNode,b.sc();const ra=wp.Jd.gY(ca);(b=h.Mz===ra.Mz)&&h.listStyle&&1!==h.ks&&(b=h.listStyle===ra.listStyle);b&&(h.Rpa&&1!==h.ks||h.d9b||P)&&(b=wp.wQm(h,ra),h.Mz||(b=b&&h.font===ra.font));if(1===h.ks)if(1===ra.ks&&ra.propertySet.hasProperty(Ng.a.Kmb))b=h.o6===ra.o6;else return!1;b&&h.Mz&&h.UA!==ti.a.Vl&&(b=ra.Tu,r&&(B&&1===h.UA&&1===
b||b++),b=h.UA===b);b&&(B||h.d9b)&&(h=rg.ListItemReader.y3l(h).listId,ca=rg.ListItemReader.cE(ca,{FEa:0}).listId,0<h&&0<ca&&(b=h===ca));return b}static wQm(b,h){h=h.wLf;b.Rpa&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.wLf.toLocaleLowerCase()}static MEl(b,h,r){var B=h.currentNode;let P=null;const ca=new xd.GraphIterator,ra=b.Toa(B,r);var Qa=!1;let mb=!1;ca.kd(h);ca.sc();for(ca.Tb(1);ca.currentNode!==B;)mb=Qa=!1,Zf.OutlineElementReader.yh(ca)&&ca.Jt(4)&&(h=b.GB(ca),wp.mTi(h,
r,!0)?(P=new wp(b,ca,!1,!1),Qa=!0):(mb=!0,h.listID===r.listID&&h.level<=ra.kUa&&(P=null))),ca.Lf(1);P&&(P.fcc=Qa);if(!P&&ca.Lf(1))for(B=!0;ca.currentNode;){if(Zf.OutlineElementReader.yh(ca)&&ca.Jt(4)){Qa=b.GB(ca);if(Qa.listID===r.listID&&Qa.level<=ra.kUa)break;if(wp.mTi(Qa,r,!1)){P=new wp(b,ca,!0,B);break}}if(!ca.Lf(1))break;B=!1}P&&(P.q6d=mb);return P}static mTi(b,h,r){let B=b.listID===h.listID&&b.level===h.level;B&&h.Tu!==ti.a.Vl&&(b=b.Tu,r&&b++,B=h.Tu===b);return B}}wp.Hf=null;Object(n.a)(wp,"JoinTargetInfo",
null,[]);class Hr{constructor(b,h){this.Fw=null;this.action=b;h&&(this.Fw=h)}static Egc(){return new Hr(0)}static RHi(){return new Hr(1)}static U1m(b){return new Hr(3,b)}static k2m(b){return new Hr(2,b)}static CHi(b){return new Hr(4,b)}}Object(n.a)(Hr,"ApplyListInfoResult",null,[]);class Iu{constructor(b,h,r){this.Hmc=r;this.uyn=h;this.yaa=r-h.Tu;this.i3c=h.listID}get delta(){-1!==this.yaa&&(this.yaa=this.Hmc-this.uyn.Tu);return this.yaa}set delta(b){this.yaa=b}}Object(n.a)(Iu,"ListTransferInfo",
null,[]);const VA=()=>{Rc.b(509386772,393,15,"Encountered a list node but paragraph node is not present")},WA=()=>{t.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string.")};class Lp extends Am{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){super(b,r,mb);this.Aw=Mc;this.vhh=!1;this.Ptc=this.ikd=this.nWb=null;this.Oje=(Wc,id)=>id.listID===Wc.listID&&id.level===Wc.level;this.Jzo=(Wc,id,Id)=>id.listID!==Wc.listID&&id.listID!==Id.i3c||id.level!==Wc.level?
!1:!0;this.qbn=(Wc,id,Id)=>id.listID===Wc.listID||Id&&id.listID===Id.i3c?!0:!1;this.Vtj=(Wc,id,Id,ve,$d)=>{const be=Wc.ja(Am.Jo.s2,-1);this.Utj(Wc,id,be+Id,ve,$d)};this.Utj=(Wc,id,Id,ve,$d)=>{oj.a.getInstance().Ru||this.Aw.tAa(Wc,ve);id=rg.ListItemReader.Nj?id:Wc;Wc=this.KGb(id);id=xd.GraphIterator.eb(id);id.od();id.sc();this.aJl(id,Wc,this.qbn,this.XFo,$d)};this.Kzo=(Wc,id,Id,ve,$d)=>{const {Fw:be,iterator:he}=this.m7b(id,()=>{oj.a.getInstance().Ru||this.Aw.tAa(Wc,ve);oj.a.getInstance().es&&this.Aw.tAa(id,
ve);var re=rg.ListItemReader.Nj?id:Wc;const Xf=this.KGb(re);re=xd.GraphIterator.eb(re);re.od();re.sc();return{Fw:Xf,iterator:re}});this.OPd(he,be,this.oxj,this.Ske,$d)};this.VFo=(Wc,id,Id,ve,$d)=>{this.N7i(Wc,id,Id,ve,$d)};this.Ske=(Wc,id,Id,ve)=>{Id.listID=id.listID;ve.Tb(4);const $d=this.ar.JGb(ve.currentNode);this.m7b($d,()=>{this.mfb(ve.currentNode,Id,$d);ve.sc()})};this.XFo=(Wc,id,Id,ve)=>{rg.ListItemReader.lg(ve)&&(Wc=new xd.GraphIterator,Wc.kd(ve),Wc.od(),this.Jd.EP(Wc),this.Nui(ve.currentNode,
Wc.currentNode))};this.WFo=(Wc,id,Id,ve,$d)=>{Id.listID=id.listID;this.N7i(Wc,id,Id,ve,$d);this.Ske(Wc,id,Id,ve,$d)};this.nxj=(Wc,id)=>id.listID===Wc.listID;this.UFo=(Wc,id)=>id.level<=Wc.level;this.oxj=(Wc,id,Id)=>id.listID===Id.i3c;this.ep=P;this.bta=b;this.vod=h;this.Lc=B;this.T$d={};this.zak=ca;this.Vd=ra;this.zq=Qa;this.rd=Jb;this.rz=Yb;this.ev=fc}get L9(){return this.bta.zia}get uRb(){return this.vhh}set uRb(b){this.vhh=b}get ar(){return this.bta}get d6(){return this.ev}get qc(){return this.rz}get kt(){return this.ar.kt}get sq(){return this.ar.sq}get Dua(){return this.ar.Dua}get H9(){return this.ar.H9}set H9(b){this.ar.H9=
b}get jSa(){return this.ar.jSa}set jSa(b){this.ar.jSa=b}get Dad(){return null!=this.lHg?this.lHg:this.lHg=Ya.a.instance.Oa("Box4.List.ISingleLevelListEditor")}LAk(b,h,r,B){t.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const P=r.ja(Zc.a.CZd,!1);let ca=!1,ra=-1;!P||h.listStyle&&1!==h.ks||(ca=!r.ja(Zc.a.IJf,!1),ra=r.ja(Zc.a.vLf,-1));b=this.u3b(b,h,{Gri:ca,z1m:ra,kJl:B,propertySet:r});P||r.setValue(Zc.a.IJf,2===b.action);3===b.action&&!r.hasProperty(Zc.a.vLf)&&b.Fw&&
r.setValue(Zc.a.vLf,b.Fw.level)}merge(b,h,r,B=null){const P=rg.ListItemReader.lg(b)||rg.ListItemReader.lg(h);b=super.merge(b,h,r,B);P&&this.s6();return b}k5i(b,h){this.xUk(b,h)}xUk(b,h){b=this.Jd.Asf(b);const r=this.Jd.Asf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.vod.value.TLc(h,b):0>b&&this.vod.value.zTa(h,b,0))}Yaj(b){this.Jd.EP(b);b.tg();nq.a.instance.J(1)&&this.s6()}bOo(b,h,r,B){var P=xd.GraphIterator.eb(r);P=this.GB(P);this.cOo(P,b,h,r,B)}GB(b){if(!rg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508924048,
393,15,"Trying to fetch list Ref info for non list item"),rg.ListItemReader.Nj))return null;let h;rg.ListItemReader.Nj?h=rg.ListItemReader.e9(b):(this.Jd.EP(b),h=b.currentNode,b.sc());return this.KGb(h)}fnj(b,h){this.Jd.EP(b);const r=b.currentNode;b.sc();oj.a.getInstance().Ru||this.Aw.tAa(r,h);b=Zf.OutlineElementReader.tR(b);oj.a.getInstance().es&&this.Aw.tAa(b,h);return this.KGb(rg.ListItemReader.Nj?b:r)}KGb(b){var h;const r=new iy.a;rg.ListItemReader.Nj&&(b&&Td.ParagraphReader.Xb(b)||t.ULS.sendTraceTag(509141474,
393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=nq.a.instance.J(1)?rg.ListItemReader.Nj?rg.ListItemReader.cE(b)||rg.ListItemReader.LFa(b):this.Jd.fP(b,!1,!0):rg.ListItemReader.cE(b,{FEa:0,YDb:-1});r.listID=h.listId;r.level=h.listLevel;r.aV=rg.ListItemReader.rzf(b);h=this.dTd(b);r.Kjo(h);r.Tu=rg.ListItemReader.DVd(b);r.KMc=rg.ListItemReader.Twf(b);return r}yhe(b,h,r=!1){const B=r?null:Zf.OutlineElementReader.tR(b);
b=oj.a.getInstance().Ru?null:this.UKc(b);this.mfb(b,h,B,r);return b}mfb(b,h,r=null,B=!1){oj.a.getInstance().Ru||b||Ih.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!oj.a.getInstance().es||B||r||Rc.b(509364259,393,15,"Apply list info called without para node");h||Ih.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});oj.a.getInstance();oj.a.jda?(oj.a.getInstance().es&&r&&!B&&this.Aw.rlc(r,h.listID,h.level),oj.a.getInstance().Ru||(this.Aw.rlc(b,h.listID,h.level),
h.aV&&b.setValue(Oc.a.aV,!0),oj.a.getInstance().es||null==h.levelText||b.setValue(Oc.a.Ot,h.levelText))):(oj.a.getInstance().Ru||this.Aw.rlc(b,h.listID,h.level),oj.a.getInstance().es&&r&&!B&&this.Aw.rlc(r,h.listID,h.level),!oj.a.getInstance().Ru&&h.aV&&b.setValue(Oc.a.aV,!0))}hHj(b){this.ar.v4(b);b=Lp.hi.uu(b);let h=b.ja(Oc.a.sq,null);h=h?Array.clone(h):[];b.setValue(Oc.a.sq,h);this.ar.Ybc()}IFo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;
default:return 0}}I3l(b){b=b.view;if(!b.mb||!b.mb.ib)return null;b=Py.OutlineElementGeneralizer.Cha(b.mb.ib,!1);if(1!==b.length)return null;b=xd.GraphIterator.eb(b.getContext(0).node);if(!rg.ListItemReader.lg(b))if(14===b.Rd().type){const h=rg.ListItemReader.n$h(b.currentNode);h&&b.set(h)}else Rc.b(589177753,393,15,"Encountered an OE of non list type."),b.sc();b.od();return b}rNh(b,h,r,B){const P=b.zJ(),ca=new iy.a;ca.listID=this.qNh(b);this.L9?(ca.X2d=Am.Jo.KY?this.sNh(b):this.iNh(b),this.P8i(b,
ca.listID,ca.X2d)):this.R8i(b,ca.listID);ca.Rmj(h.propertySet,this.jfc(r));this.fNd(b);r=this.dci(b,h);for(let Qa=0;9>Qa;Qa++){const mb=new Qz.a;P.xd.Xu(mb);this.Q8i(b,this.L9?U.a.nil:mb.id,this.L9?mb.id:U.a.nil);this.Hsk(mb,h.Mz,Qa);this.Kph(mb,r,Qa);var ra=B.dLb[Qa];ra=6===ra?Kp.a.IX(1,1):Kp.a.IX(0,ra);ra.Nia&&mb.setValue(Pe.a.m5,ra.Nia);h.UA!==ti.a.Vl&&Qa===ca.level&&mb.setValue(Pe.a.Y0,h.UA);B.lFa&&B.lFa[Qa]&&mb.setValue(Pe.a.font,B.lFa[Qa]);ra=B.b_c[Qa];t.ULS.shipAssertTag(22127636,338,!!ra);
mb.setValue(Oc.a.Ot,ra);mb.setValue(Oc.a.wda,B.f2d[Qa]);bu.a.kie(B.o6,mb)}return ca}Zcl(b,h,r){const B=b.zJ(),P=new iy.a;P.listID=this.qNh(b);this.L9?(P.X2d=Am.Jo.KY?this.sNh(b):this.iNh(b),this.P8i(b,P.listID,P.X2d)):this.R8i(b,P.listID);P.Rmj(h.propertySet,this.jfc(r));if(!h.listStyle)switch(P.level%3){case 0:h.I$(h.listType,1);break;case 1:h.I$(h.listType,2);break;case 2:h.I$(h.listType,3)}this.fNd(b);r=this.dci(b,h);for(let ca=0;9>ca;ca++){const ra=new Qz.a;B.xd.Xu(ra);this.Q8i(b,this.L9?U.a.nil:
ra.id,this.L9?ra.id:U.a.nil);this.Gsk(ra,h.Mz,ca);this.Kph(ra,r,ca);2===ca%3&&h.Mz?ra.setValue(Oc.a.wda,"right"):ra.setValue(Oc.a.wda,"left");ca===P.level&&(h.Nia&&ra.setValue(Pe.a.m5,h.Nia),h.UA!==ti.a.Vl&&ra.setValue(Pe.a.Y0,h.UA),h.Mz?this.Vmj(h,ra,ca):(Lp.Smj(h,ra),Lp.Umj(h,ra)),Lp.Tmj(h,ra),h.d9b&&ra.bPa(h.propertySet,Oc.a.listID,Oc.a.listLevel))}return P}Vmj(b,h,r){b.Rpa?(b=b.levelText,b=E.a.replaceAll(b,"%1","%"+(r+1))):b=b.YVc||b.Kca?b.levelText:"%"+(r+1)+".";t.ULS.shipAssertTag(22127638,
338,!!b);h.setValue(Oc.a.Ot,b)}Srj(b,h,r,B){if(b.YVc)return!1;if(1===b.ks)return B;if(B)return!0;if(h){B=b.listType===h.listType;const P=!b.listStyle&&b.UA===ti.a.Vl;let ca=b.listStyle===h.listStyle&&b.UA===h.UA;b=(!b.Rpa||this.jbg(h,b))&&!r;ca=ca&&b;return B&&(P||ca)}return!1}fNd(b){this.nWb||(this.nWb=b.ja(Oc.a.sjl,null));this.ikd||(this.ikd=b.ja(Oc.a.rjl,null));this.Ptc||(this.Ptc=b.ja(Oc.a.tjl,null))}jfc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}s1l(b){return b?this.ep.yU(b).Xt-
this.ep.JG(b).Xt:-1}R8i(b,h){const r=b.ja(Oc.a.kt,null),B=r?r.length:0,P=Array(B+1);let ca=0;for(;ca<B;ca++)P[ca]=r[ca];P[ca]=h;b.setValue(Oc.a.kt,P);this.ar.Ybc()}P8i(b,h,r){this.r_e(Oc.a.kt,b,h);if(Am.Jo.KY){this.r_e(Nd.a.RSa,b,r);var B=this.ar.aTd(b);B.add(h,r);b.setValue(Nd.a.wF,Uv.b(SB.a.Znc(B)))}else this.r_e(Oc.a.Dua,b,r),B=this.ar.$Sd(b),B.add(h,r),b.setValue(Oc.a.W0,Uv.b(SB.a.Znc(B)))}Q8i(b,h,r){this.L9?(this.zph(Oc.a.sq,b,r),this.zph(Oc.a.e$,b,h)):(r=(r=b.ja(Oc.a.sq,null))?Array.clone(r):
[],r.push(h),b.setValue(Oc.a.sq,r),this.ar.Ybc())}r_e(b,h,r){const B=h.ja(b,null),P=B?B.length:0,ca=Array(P+1);let ra=0;for(;ra<P;ra++)ca[ra]=B[ra];ca[ra]=r;h.setValue(b,ca)}zph(b,h,r){let B=h.ja(b,null);B=B?Array.clone(B):[];B.push(r);h.setValue(b,B)}Gsk(b,h,r){var B=r%3+1;const P=h?this.Ptc:this.ikd;P&&r<P.length?b.setValue(Oc.a.qt,P[r]):b.setValue(Oc.a.qt,360);B=Kp.a.IX(h?0:1,this.IFo(B),null,0,r);b.ax(B.propertySet);b.setValue(Oc.a.n4e,h?-1:-2);h?b.setValue(Oc.a.Ot,"%"+(r+1)+"."):(b.setValue(Pe.a.font,
this.SVl(r)),b.setValue(Oc.a.Ot,String.fromCharCode(this.HVl(r))));bu.a.slc(2,b)}Hsk(b,h,r){const B=h?this.Ptc:this.ikd;B&&r<B.length?b.setValue(Oc.a.qt,B[r]):b.setValue(Oc.a.qt,360);b.setValue(Oc.a.n4e,h?-1:-2);bu.a.slc(1,b)}HVl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}SVl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}qNh(b){if(this.L9)this.H9<ti.a.p_c&&this.ar.v4(b),this.H9=this.cdi(this.kt,
this.H9,ti.a.p_c);else{if(this.H9<ti.a.p_c&&(this.ar.v4(b),this.kt&&this.sq)){b=this.kt.length;for(let h=0;h<b;h++)this.kt[h]>=this.H9&&(this.H9=this.kt[h])}this.H9+=1}return this.H9}iNh(b){this.jSa<ti.a.jBd&&this.ar.v4(b);return this.jSa=this.cdi(this.Dua,this.jSa,ti.a.jBd)}sNh(b){var h;this.ar.v4(b);do b=Math.floor(Math.random()*(Lp.Xbn-Lp.GPi))+Lp.GPi;while(null===(h=this.ar.jMb)||void 0===h?0:h.includes(b));return b}cdi(b,h,r){if(h<r&&b){r=b.length;for(let B=0;B<r;B++)b[B]>h&&(h=b[B])}h++;return h}x4n(b,
h){this.N2h(b,h,1,this.Oje,this.Vtj,null,!1)}w4n(b,h,r){this.bJl(b,h,r,this.Oje,this.Utj)}hJk(){this.s6()}s6(b=null){var h,r;if(nq.a.instance.J(1)){var B=new xd.GraphIterator;if(b)if(8===b.type)B.set(b);else{t.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else B.set(ab.StaticActiveAppFrame.za().jb.Zc),Lp.hi.yog(B),b=Lp.hi.uu(B.currentNode);if(B.zb(7)||B.jd(7)){B=qc.a.Gs(B,B.origin);var P=new Iw({Jd:this.ar,pageContentNode:b,nUa:null,
mJj:!1});for(b=new Iw({Jd:this.ar,pageContentNode:b,nUa:null,mJj:!1});B.moveNext();){var ca=B.iterator;let Qa;if(!oj.a.getInstance().Ru){if(!ca.Jt(4)&&!ca.Jt(31))continue;this.Jd.VLb(ca);Qa=ca.currentNode;ca.sc();if(!Qa){t.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const mb=rg.ListItemReader.Nj?rg.ListItemReader.ltf(ca):Qa;if(!this.L9&&!rg.ListItemReader.AGf(mb)&&this.Jd.gY(mb).listType)continue;var ra=void 0;
if(rg.ListItemReader.Nj){if(!mb){t.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}ra=rg.ListItemReader.cE(mb)}else ra=this.Jd.fP(Qa,!1,!1);if(this.L9&&ra&&this.Jd.U_d(ra.listId)){t.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ra.listId);continue}const Jb=rg.ListItemReader.Nj?mb:Zf.OutlineElementReader.tR(ca);Jb&&(Jb.ra?(null==Jb.ra.last&&t.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),
this.L9&&this.ar.v4(ca.currentNode),12===Jb.type&&(Jb.Ni&&Jb.Zy.hasProperty(Oc.a.listID)||null===(h=Jb.ra.last)||void 0===h||!h.zi)&&((ca=rg.ListItemReader.Nj?rg.ListItemReader.LFa(mb)||rg.ListItemReader.cE(mb):this.Jd.fP(Qa,!0,!0))?this.Xmj(Qa,mb,b,Am.Jo.nqc,ca):t.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Qa.type)),!ra||null!==(r=Jb.ra.last)&&void 0!==r&&r.Lh||!this.Xmj(Qa,mb,P,Am.Jo.s2,ra)||(ra=Qa.getValue(Am.Jo.s2),this.L9&&this.Jd.gY(mb).listType||
Qa.setValue(Am.Jo.Vka,ra))):t.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else t.ULS.shipAssertTag(593234060,376,7===B.Xe,"Couldnt reach to page manifest node")}}Xmj(b,h,r,B,P){B||t.ULS.shipAssertTag(571757918,393,!!B,"Prop definition is null");r=r.ZTf(P.listId,P.listLevel,this.rd);P=-1;b.hasProperty(B)&&(P=b.getValue(B));return r===P||this.L9&&!rg.ListItemReader.AGf(h)&&this.Jd.gY(h).listType&&(B!==Am.Jo.nqc||1!==this.Jd.gY(h).listType)?!1:(b.setValue(B,
r),!0)}gPm(b,h){let r=!1,B=!0,P=0;const ca=this.GB(b),ra=b.currentNode;b=b.pTb();b=qc.a.gp(b);for(b.xo(dz.a.t_c,null);b.moveNext();){var Qa=b.iterator.currentNode;if(Qa===ra)break;rg.ListItemReader.lg(Qa)&&(Qa=this.GB(b.iterator),Qa.listID===ca.listID&&(Qa.level>ca.level?(r=!0,P++):Qa.level===ca.level?(B=!1,P=0):Qa.level<=h.kUa&&(B=!0,P=0)))}return r&&B&&!0}fDh(b,h){this.Jd.EP(b);const r=b.currentNode;b.sc();const B=this.GB(b);B&&this.ar.s_c(r,B.listID,B.level)&&this.w4n(b.currentNode,B,h)}fci(b){const h=
this.Jd.ww(b);h.d9b=!0;this.Jd.EP(b);const r=b.currentNode.ja(Oc.a.listID,0);h.propertySet.setValue(Oc.a.listID,r);b.jd(11);return h}uKf(b,h,r){const B=new xd.GraphIterator,P=h.currentNode;let ca;var ra=ti.a.Vl;let Qa=!1,mb=!1,Jb=!1,Yb=null;var fc=h.pTb();fc=qc.a.gp(fc);for(fc.xo(dz.a.t_c,null);fc.moveNext();){B.kd(fc.iterator);if(B.currentNode===P)break;Qa=!1;B.Jt(4)&&(ca=this.GB(B),ca.listID===b.listID&&(ca.level===b.level?(this.Jd.EP(B),ra=B.currentNode,B.sc(),ra=ra.ja(Am.Jo.s2,ti.a.Vl),Qa=!0,
Yb=B.gpc(1),mb=!0):ca.level>b.level?Jb=!0:ca.level<=r.kUa&&(ra=ti.a.Vl,Jb=mb=!1)))}!mb&&Jb&&(ra=r.startAt);Qa&&(Qa=h.gpc(1)===Yb);b=new UA;b.SSa=ra;b.YKj=Qa;return b}s4n(b,h){var r=rg.ListItemReader.e9(b);if(Lp.VTm)this.uYo(r,h);else{b=this.KGb(r);const ca=this.Toa(r,b),ra=this.ar.U2a(r,b);var B=new xd.GraphIterator;const Qa=ra.Mz;let mb=ca.startAt,Jb=!1,Yb=!1;t.ULS.shipAssertTag(22127639,338,ra.Kca,"Info does not have a level Text.");B.set(r);if(B.od()&&(r=B.mUa()))for(r=qc.a.gp(r),r.xo(dz.a.t_c,
b);r.moveNext();){B=r.iterator.currentNode;if(!rg.ListItemReader.lg(B))continue;var P=this.GB(r.iterator);P.listID===h&&(P=this.fnj(r.iterator,b.listID));if(P.listID!==b.listID)continue;const fc=r.iterator.Tb(4);fc&&r.iterator.sc();P.level>b.level?(this.ar.s_c(fc,b.listID,P.level)&&this.Nui(B,fc),Yb=!0):(P.level<=ca.kUa?(mb=ca.startAt,Yb=Jb=!1):(P=r.iterator,this.Jd.EP(P),Am.Jo.es||P.currentNode.setValue(Oc.a.Ot,ra.wLf),{$co:Jb,SSa:mb}=this.v4n(Qa,Yb,Jb,P,mb,B)),Lp.OGm(r))}}}uYo(b,h){const r=this.KGb(b),
B=new xd.GraphIterator;B.set(b);if(B.od()&&(b=B.mUa())){b=qc.a.gp(b);for(b.xo(dz.a.t_c,r);b.moveNext();)rg.ListItemReader.lg(b.iterator.currentNode)&&this.GB(b.iterator).listID===h&&this.fnj(b.iterator,r.listID);t.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Nui(b,h){t.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(we.a.LHi,U.a.create().toString())}v4n(b,h,r,B,P,ca){b?(h&&!r&&P++,hg.OutlineElementNavigator.Yd(B),this.fDh(B,P),P++,r=!0,B.Tb(2),cz.a.CGf(B.currentNode)&&
B.currentNode.nl(4,!0)):(B.currentNode.removeProperty(Am.Jo.s2),hg.OutlineElementNavigator.Yd(B));ca.nl(4,!0);(b=B.jo(16))&&b.nl(8,!0);return{$co:r,SSa:P}}Toa(b,h){const r=Ih.a.instance.Fp(Mb.a.Toa),B=new UB;(b=this.ar.Px(b,h.listID,h.level))?(B.kUa=b.ja(Oc.a.a8c,h.level-1),B.startAt=b.ja(Pe.a.Y0,1)):Ih.a.instance.Yb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return B}efl(b){const h=$o.a.instance.createInstance(1074135151);b.Bf(h,31)}r1n(b){b.Tb(31)&&b.tg()}cOo(b,
h,r,B,P){let ca;if(oj.a.jda)ca=this.yhe(h,b,!0);else{const ra=this.UKc(h);this.mfb(ra,b,null,!0)}h=this.ar.U2a(h.currentNode,b);h.listType||(ca.setValue(Am.Jo.s2,b.Tu),ca.setValue(Am.Jo.Vka,b.KMc),this.kdj(ca,b,r?B:P));switch(h.listType){case 0:r="Numbering";break;case 1:r="Bullet";break;default:r="Invalid List Type"}v.AFrameworkApplication.va.processAction(Mb.a.HJf,2);t.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",r);oj.a.getInstance().Ru||this.Aw.rlc(ca,b.listID,b.level)}Saj(b){var h=
this.qc.hp(b);h?this.qc.Kg(h)===Rl.StyleReader.wordStyleIdListParagraph&&(h=this.qc.ZC(b),this.d6.cK(h.pj(Rl.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.uRb)):t.ULS.shipAssertTag(8271188,315,!1)}Alo(b){if(this.qc.Kg(this.qc.hp(b))===Rl.StyleReader.wordStyleIdNormal){const h=this.qc.ZC(b);this.d6.cK(h.pj(Rl.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Cg(Oc.a.ee,Oc.a.iN,Oc.a.RA,Oc.a.o1,Oc.a.qt,Oc.a.pja);b.setValue(Oc.a.oTa,0)}nVk(b,h){const r=b.getValue(Oc.a.listID),
B=b.getValue(Oc.a.listLevel);for(let ca=0;9>ca;ca++){const ra=this.ar.Px(b,r,ca);if(!ra)return Ih.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var P=h.dLb[ca];P=6===P?Kp.a.IX(1,1):Kp.a.IX(0,P);P.Nia&&ra.setValue(Pe.a.m5,P.Nia);ra.hasProperty(Pe.a.font)&&ra.removeProperty(Pe.a.font);h.lFa&&h.lFa[ca]&&ra.setValue(Pe.a.font,h.lFa[ca]);P=h.b_c[ca];t.ULS.shipAssertTag(22127641,338,!!P);ra.setValue(Oc.a.Ot,P);ra.setValue(Oc.a.ks,bu.a.tgc);bu.a.kie(h.o6,ra);ra.setValue(Oc.a.wda,
h.f2d[ca]);ra.Cg(Oc.a.a8c,Pe.a.Y0);this.hHj(b)}b=new iy.a;b.listID=r;b.level=B;return b}lVk(b,h,r,B){if(B)return this.nVk(b,B);B=b.getValue(Oc.a.listID);const P=b.getValue(Oc.a.listLevel),ca=this.ar.Px(b,B,P);if(!ca)return Ih.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&t.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,B,P),null;h.d9b&&(ca instanceof rw.APropertySet?ca.bPa(h.propertySet,
Oc.a.listID,Oc.a.listLevel):t.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var ra=ca.ja(Oc.a.ks,null);ra&&ra===bu.a.tgc&&this.kVk(b,B);if(!h.listStyle){ra=0;if(-1!==r){for(ra+=P-r;0>ra;)ra+=3;ra%=3}switch(ra){default:r=1;break;case 1:r=2;break;case 2:r=3}h.I$(h.listType,r)}h.Nia&&ca.setValue(Pe.a.m5,h.Nia);h.Mz?(this.Vmj(h,ca,P),ca.hasProperty(Pe.a.font)&&ca.removeProperty(Pe.a.font)):
(Lp.Smj(h,ca),Lp.Umj(h,ca));Lp.Tmj(h,ca);ca.Cg(Oc.a.a8c,Pe.a.Y0,Oc.a.VXc);this.hHj(b);b=new iy.a;b.listID=B;b.level=P;return b}kVk(b,h){let r;for(let B=0;9>B;B++){r=this.ar.Px(b,h,B);if(!r){t.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,B);break}r.setValue(Oc.a.ks,bu.a.iXd);r.removeProperty(Ng.a.Kmb)}}xhe(b,h){const r=Ih.a.instance.Fp(Mb.a.xhe);this.vod.value||Ih.a.instance.Yb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});
this.cNa?(r.properties.Z("PendingListInfo","true"),rg.ListItemReader.lg(b)&&(r.properties.Z("RemoveCurrentListInfo","true"),this.uRb=!0,this.yIa(b),this.vod.value.zTa(b,-1,0),this.uRb=!1),16!==this.cNa.listType&&this.u3b(b,this.cNa,{Gri:!0,KKl:!0}),this.cNa=null):h||(r.properties.Z("CurrentlyUnderPastedList","true"),this.yIa(b,{Jaj:!0}));r.end()}uie(b,h){var r;if(rg.ListItemReader.lg(b))return!1;b.Tb(2);var B=If.a.IJk;const P=[!0,!1].map(ca=>Td.ParagraphReader.Wf(b.currentNode,ca,void 0,!1));b.sc();
for(let ca=0;ca<P.length;ca++){const ra=P[ca];if(ra&&!TA.a.Dpa(ra))for(const Qa of B)if(Qa.test(ra.characterData))return B=null===(r=Qa.exec(ra.characterData))||void 0===r?void 0:r[0],this.rTn(h,ca?"nextPara":"prevPara",B),!1}return!0}rTn(b,h,r){const B=new Map;B.set("CurrentAutoListPreventedAutoListText",b);B.set("UndoAutoListPreferenceFoundIn",h);B.set("UndoAutoListPreferenceAutoListText",r);xa.Health.instance.recordKpiUsage(ti.a.jmb.QZn,0,ti.a.zB,B)}Fvo(b,h){return b&&h}Taj(b){for(let h=0;h<b.count;h++){const r=
xd.GraphIterator.eb(b.J(h));r.Ip();this.$da(r)}b.clear()}u4n(b){rg.ListItemReader.lg(b)&&this.s6()}i8i(b,h){b=new xd.GraphIterator;b.set(h);b.od();hg.OutlineElementNavigator.Yd(b);b.ckb(h)||Ih.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.yIa(b);return b}flo(b,h,r){this.rh.Kza(b,h,r,!0)}nlo(b){b.I$(1,1)}IDd(b,h){const r=Ih.a.instance.Fp(Mb.a.HFk);if(this.qc.pda(h.Gl())){if(rg.ListItemReader.lg(b)&&this.yIa(b),h=this.ar.mci(h)){r.properties.Z("EarlyReturn",
"False");this.ar.U2a(b.currentNode,h);var B=wp.MEl(this,b,h);if(B)if(oj.a.jda)var P=this.Wmj(b,B,!0);else P=this.UKc(b),this.Qdd(b,B,!0);else{P=this.UKc(b);if(B=this.OPd(b,h,this.nxj,this.VFo)){const ca=this.GB(B);if(ca.listID===h.listID&&ca.level<h.level&&this.Jd.ww(B).Mz){const ra=this.Toa(B.currentNode,ca);ca.Tu===(ra.startAt===ti.a.Vl?1:ra.startAt)&&(ca.KMc=ca.Tu,this.kdj(P,ca,B.currentNode))}}B=this.Toa(P,h);b=this.uKf(h,b,B);b=b.SSa!==ti.a.Vl?b.SSa+1:B.startAt===ti.a.Vl?1:B.startAt;oj.a.getInstance().Ru||
this.mfb(P,h,null,!0);P.setValue(Am.Jo.s2,b);P.setValue(Am.Jo.Vka,b)}oj.a.getInstance().Ru||P.setValue(Oc.a.aV,!0);r.end()}}else Ih.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}kdj(b,h,r){this.ar.s_c(b,h.listID,h.level)&&this.x4n(r,h)}cvh(b,h,r,B,P=null){if(oj.a.jda){if(!rg.ListItemReader.lg(h)&&(t.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),rg.ListItemReader.Nj))return;var ca=null;oj.a.getInstance().Ru||
(ca=h.Tb(4),h.sc());(h=Zf.OutlineElementReader.tR(h))||VA();P=this.dcf(b,r,B,P);this.mfb(ca,P,h);return P}b=P?this.rNh(b,r,B,P):this.dcf(b,r,B);B=h.Tb(4);h.sc();Am.Jo.es?(h&&h.currentNode&&(393229==h.currentNode.Oc?ca=Zf.OutlineElementReader.tR(h):Rc.b(509367497,393,15,"Expected a OE node to extract para node")),ca?this.mfb(B,b,ca):(VA(),Hu.Debug.Lfp(!1,"Encountered a list node but paragraph node is not present",509367496))):this.mfb(B,b);r.listType||(h=r.UA,h===ti.a.Vl&&(h=1),B.setValue(Am.Jo.s2,
h),B.setValue(Am.Jo.Vka,h));Am.Jo.es||(r.Kca?(r=r.levelText,P||(r=r.replace("%1","%"+(b.level+1))),B.setValue(Oc.a.Ot,r)):(WA(),B.setValue(Oc.a.Ot,"")));return b}dcf(b,h,r,B=null){b=B?this.rNh(b,h,r,B):this.Zcl(b,h,r);Am.Jo.es||(h.Kca?(h=h.levelText,B||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(WA(),b.levelText=""));return b}Qdd(b,h,r,B=null){if(rg.ListItemReader.lg(b)){var P=b.Tb(4);b.sc();var ca=Zf.OutlineElementReader.tR(b);this.m7b(ca,()=>{this.mfb(P,h.Fw,ca,r);this.mUh(P,h,r,B)})}else t.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}Wmj(b,h,r,B=null){const P=Zf.OutlineElementReader.tR(b);return this.m7b(P,()=>{const ca=this.yhe(b,h.Fw,r);this.mUh(ca,h,r,B);return ca})}mUh(b,h,r,B=null){if(this.ar.U2a(b,h.Fw).Mz){const P=new xd.GraphIterator;P.set(b);P.od();P.sc();const ca=this.eHl(P,h,B);b=this.WGl(P,b,h,r,B,ca);this.bHl(h,r,B,ca,b)}}eHl(b,h,r){if(h.Ozi)h=h.KP;else{let B,P;r?(B=this.oxj,P=this.Ske):h.fcc?(B=this.nxj,P=this.Ske):(B=this.UFo,P=this.WFo);h=this.OPd(b,
h.Fw,B,P,r)}!h&&r&&(r=new xd.GraphIterator,r.kd(b),r.HSc()&&rg.ListItemReader.lg(r)&&(h=r));return h}WGl(b,h,r,B,P,ca){B?(P?b=P.Hmc:(ca=this.Toa(h,r.Fw),r=this.uKf(r.Fw,b,ca),b=r.SSa!==ti.a.Vl?r.SSa+1:ca.startAt===ti.a.Vl?1:ca.startAt),h.setValue(Am.Jo.s2,b),h.setValue(Am.Jo.Vka,b)):(b=ti.a.Vl,this.hmo(h,ca,r));return b}bHl(b,h,r,B,P){if(B){var ca=!1,ra=this.GB(B),Qa=ra.level===b.Fw.level,mb=!!r&&ra.listID===r.i3c;(ra.listID===b.Fw.listID||mb)&&Qa&&(Qa=this.Toa(B.currentNode,ra),mb=Qa.startAt===ti.a.Vl?
1:Qa.startAt,ra.Tu===mb+1&&(ca=h?P===mb:this.gPm(B,Qa)));if(!ca||r)r?(h=r.delta,P=this.Jzo,ca=this.Kzo):(h=1,P=this.Oje,ca=this.Vtj),ra=new xd.GraphIterator,ra.set(B.currentNode),ra.od(),this.Jd.EP(ra),ra.sc(),this.N2h(B.currentNode,b.Fw,h,P,ca,r)}}hmo(b,h,r){let B=null;h&&(B=this.GB(h));if(B&&B.listID===r.Fw.listID&&B.level===r.Fw.level){const P=this.Jd.ww(h),ca=P.Tu;b.setValue(Am.Jo.s2,ca);b.setValue(Am.Jo.Vka,ca);P.propertySet.setValue(Oc.a.listID,B.listID);P.propertySet.setValue(Oc.a.listLevel,
B.level);if(!r.fcc||r.q6d)r.Ozi&&!r.q6d&&(this.Jd.EP(h),b=h.currentNode,hg.OutlineElementNavigator.Yd(h)),b.setValue(Am.Jo.Vka,b.getValue(Am.Jo.s2))}else h=r.Fw.Tu+1,b.setValue(Am.Jo.s2,h),b.setValue(Am.Jo.Vka,h)}u3b(b,h,{Gri:r=!1,z1m:B=-1,kJl:P=!1,KKl:ca=!1}={}){return h&&16!==h.listType?xd.GraphIterator.kca(()=>{if(!Zf.OutlineElementReader.yh(b))return t.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),Hr.Egc();const ra=Zf.OutlineElementReader.tR(b);return ra&&
xo.a(ra,8)?(t.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Hr.Egc()):nq.a.instance.J(1)&&(null===ra||void 0===ra?0:ra.ra.last.Lh)?(t.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),Hr.Egc()):this.m7b(ra,()=>{var Qa=Lp.hi.uu(b.currentNode);const mb=h.YB,Jb=this.infoAtLevel(b,h);var Yb=b.Tb(4);if(Yb)return b.sc(),Qa=this.K2e(Jb,Yb,B,mb),Qa.Fw=this.GB(b),Qa;Yb=null;oj.a.jda?this.r1n(b):Yb=this.ucl(b);const fc=h.propertySet.ja(Oc.a.listID,
-1),Mc=this.B3l(fc,ca),Wc=this.s1l(ra),id=this.r2l(h,b,Jb,ca,P,r);this.Ljo(id,Jb);ra&&this.Alo(ra);if(null!=id&&!P&&Jb.Mz===this.Jd.U2a(oj.a.jda?b.currentNode:Yb,id.Fw).Mz)return Jb.listStyle||(id.fcc=!0),this.LFk(Mc,id,b);if(this.Xsl(Jb,Mc,id,oj.a.jda?b.currentNode:Yb)){if(oj.a.jda)return this.KFk(b,Jb,Mc,Wc,mb);this.Dlo(Yb,Jb,Mc,Wc,ra);return this.K2e(Jb,Yb,-1,mb)}return oj.a.jda?this.IFk(b,Jb,Qa,Wc,mb,Mc,fc):this.JFk(Yb,Jb,b,Qa,Wc,mb,Mc,fc,ra)})}):(h||t.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+
h),this.yIa(b))}JFk(b,h,r,B,P,ca,ra,Qa,mb){if(!oj.a.jda){var Jb=Zf.OutlineElementReader.o0(r);0<Jb&&(P+=Jb);h=this.cvh(B,r,h,P,ca);this.tYo(ra,Qa,h,b,mb);return Hr.CHi(h)}}tYo(b,h,r,B,P){oj.a.jda||(0>=b?this.T$d[h+""]=r.listID:(oj.a.getInstance().Ru||this.Aw.tAa(B,b),oj.a.getInstance().es&&this.Aw.tAa(P,b),r.listID=b))}Dlo(b,h,r,B,P){var ca;oj.a.jda||(oj.a.getInstance().Ru||this.Aw.tAa(b,r),oj.a.getInstance().es&&this.Aw.tAa(P,r),b.properties.hasProperty(Oc.a.listLevel)||(r=(null===(ca=h.propertySet)||
void 0===ca?0:ca.hasProperty(Oc.a.listLevel))?h.propertySet.tf(Oc.a.listLevel):this.jfc(B),oj.a.getInstance().Ru||this.Aw.A9a(b,r),oj.a.getInstance().es&&this.Aw.A9a(P,r),h.propertySet&&h.Kca&&!Am.Jo.es&&(h=h.levelText.replace("%1","%"+(r+1)),b.setValue(Oc.a.Ot,h))))}ucl(b){if(!oj.a.jda)return b.Tb(31)&&b.tg(),this.UKc(b)}KFk(b,h,r,B,P){r=this.d4l(h,r,B);b=this.yhe(b,r);return this.K2e(h,b,-1,P)}r2l(b,h,r,B,P,ca){var ra;P=b.Dnb?new wp(this,xd.GraphIterator.eb(b.Dnb),!1,!0):wp.LEl(this,h,r,B,P);if(!P)return null;
ca?(P.Fw.level=this.E1l(h,r,B),this.IGl(h,P)):P.Fw&&(null===(ra=b.propertySet)||void 0===ra?0:ra.hasProperty(Oc.a.listLevel))&&(P.Fw.level=b.propertySet.getValue(Oc.a.listLevel));return P}B3l(b,h){return h&&0<b&&b+""in this.T$d?this.T$d[b+""]:-1}d4l(b,h,r){var B,P;const ca=new iy.a;ca.listID=h;ca.level=null!==(P=null===(B=b.propertySet)||void 0===B?void 0:B.tf(Oc.a.listLevel))&&void 0!==P?P:this.jfc(r);b.propertySet&&b.Kca&&!Am.Jo.es&&(ca.levelText=b.levelText.replace("%1","%"+(ca.level+1)));return ca}K2e(b,
h,r,B){b=this.lVk(h,b,r,B);return Hr.U1m(b)}LFk(b,h,r){let B=null;0<b&&(B=new Iu(0,h.Fw,-1),B.i3c=b,B.delta=-1);oj.a.jda?this.Wmj(r,h,!1,B):this.Qdd(r,h,!1,B);return Hr.k2m(h.Fw)}IFk(b,h,r,B,P,ca,ra){const Qa=Zf.OutlineElementReader.o0(b);0<Qa&&(B+=Qa);r=this.dcf(r,h,B,P);this.sYo(ca,ra,r);b=this.yhe(b,r);Am.Jo.Ru||h.listType||(h=h.UA,h===ti.a.Vl&&(h=1),b.setValue(Am.Jo.s2,h),b.setValue(Am.Jo.Vka,h));return Hr.CHi(r)}yIa(b,{Jaj:h=!1}={}){return xd.GraphIterator.kca(()=>{if(!Zf.OutlineElementReader.yh(b))return t.ULS.sendTraceTag(509678220,
393,15,"Iterator not pointing to OE in remove list info word."),Hr.Egc();const r=Zf.OutlineElementReader.tR(b);if(nq.a.instance.J(1)&&(null===r||void 0===r?0:r.ra.last.Lh))return t.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),Hr.Egc();const B=b.Tb(4);return B?r?this.m7b(r,()=>{var P;this.Saj(r);this.A0n(r);r.ND=null;this.Jd.U_d(rg.ListItemReader.Nj?rg.ListItemReader.cE(r,{FEa:0}).listId:B.ja(Oc.a.listID,0))?(B.Y$c=!1,b.tg(),oj.a.getInstance().es&&this.Aw.$da(r)):
b.sc();h||this.Bio(b);b.Tb(4)&&(B.Y$c=!1,b.tg(),oj.a.getInstance().es&&this.Aw.$da(r));(this.Vd.yg&&!this.uRb||!this.Vd.yg&&r.Ni)&&(!r.Ni||(null===(P=r.Zy)||void 0===P?0:P.hasProperty(Oc.a.listID)))&&this.efl(b);return Hr.RHi()}):(t.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),B.Y$c=!1,b.tg(),Hr.RHi()):Hr.Egc()})}Bio(b){const h=Lp.hi.uu(b.currentNode),r=Zf.OutlineElementReader.DFa(b),B=Zf.OutlineElementReader.JG(b),P=Zf.OutlineElementReader.o0(b);
this.fNd(h);this.rh.Kza(b,1,Math.max(0,r+(P||-1*B)-this.Ptc[0]))}m7b(b,h){let r=null;nq.a.instance.J(1)&&b&&(r=b.aE());h=h();nq.a.instance.J(1)&&!this.uRb&&(b&&r&&this.zq.GV(b,r,this.Vd.yg),this.s6());return h}A0n(b){b.hasProperty(Oc.a.ee)&&b.removeProperty(Oc.a.ee);b.hasProperty(Oc.a.RA)&&b.removeProperty(Oc.a.RA);b.hasProperty(Oc.a.qt)&&b.removeProperty(Oc.a.qt)}infoAtLevel(b,h){if(!h)return null;const r=h.YB;if(1===h.ks){if(h.Rpa&&!h.PJ||!h.i8e(!1))return h;b=Zf.OutlineElementReader.DFa(b);const B=
this.jfc(b),P=r.dLb[B];b=Kp.a.y8(h.propertySet,h.propertySet);6===P?b.I$(1,1):b.I$(0,P);b.zhe("multilevel");b.levelText=r.b_c[B];r.lFa&&r.lFa[B]&&(b.font=r.lFa[B]);b.zw=r.f2d[B];b.o6=r.o6;b.Y2d=h.Y2d}else b=h;return b}Ljo(b,h){null!==b&&void 0!==b&&b.Fw&&(h.levelText=b.Fw.levelText,h.Mz||(h.font=b.Fw.font))}E1l(b,h,r){let B=Zf.OutlineElementReader.DFa(b);const P=Zf.OutlineElementReader.o0(b);0<P?B+=P:(b=Zf.OutlineElementReader.JG(b),0<b&&(B-=b));h=h.propertySet.ja(Oc.a.listLevel,-1);return r&&0<=
h?h:this.jfc(B)}IGl(b,h){if(!this.ar.U2a(b.currentNode,h.Fw).listType){const r=this.Toa(b.currentNode,h.Fw);b=this.uKf(h.Fw,b,r);h.Fw.KMc=h.Fw.Tu=b.SSa===ti.a.Vl?r.startAt-1:b.SSa;h.fcc=b.YKj}}sYo(b,h,r){0>=b?this.T$d[h+""]=r.listID:r.listID=b}Xsl(b,h,r,B){if(0>=h)return!1;const P=(ca,ra)=>ca.length!==ra.length||ca.some((Qa,mb)=>Qa!==ra[mb]);if(r)return h=this.Jd.U2a(B,r.Fw),b.Mz!==h.Mz||P(b.Nia,h.Nia);r=b.propertySet.ja(Oc.a.listLevel,-1);return 0<=r&&(h=this.ar.Px(B,h,r))&&(h=h.ja(Pe.a.m5,null))&&
b.Nia?P(h,b.Nia):!1}z0n(b,h){var r,B;const P=!!h&&Td.ParagraphReader.Xb(h);let ca=0,ra=0;P&&(ca=this.ep.yU(rg.ListItemReader.Nj?h:this.Jd.Gsf(b)).Xt,ra=this.ep.JG(h).Xt);P&&this.Saj(h);null!==(r=oj.a.getInstance())&&void 0!==r&&r.Ru||(b.Tb(4),b.tg());(null===(B=oj.a.getInstance())||void 0===B?0:B.es)&&this.Aw.$da(h);P&&this.rh.Kza(b,1,ca-ra)}Yba(b,h,r,B=-1,P=!1,ca=null,ra=!1){t.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Qa=Ih.a.instance.Fp(Mb.a.Yba),
mb=this.Lc.Pc(15);mb.Ut(b);let Jb=null,Yb=0;({sZm:Jb,Rjn:Yb,returnValue:B}=this.lFl(b,h,B,Jb,Yb,P,ca));if(!Jb||ra&&(1===r||0>r-Jb.Fw.Tu||2<r-Jb.Fw.Tu))return mb.dispose(),Qa.end(),!1;for(;0<Yb;)b.HSc(),Yb--;this.oYo(b,h,B,Jb);mb.dispose();Qa.end();return!0}oYo(b,h,r,B){for(;b.HSc();){var P=rg.ListItemReader.e9(b);if(P&&(P=this.KGb(P),P.listID===h.listID)){h=new Iu(0,h,r);oj.a.getInstance().es?this.Qdd(b,B,P.aV,h):this.Qdd(b,B,!0,h);break}}}lFl(b,h,r,B,P,ca=!1,ra=null){for(var Qa;b.MVd();){if(b.Jt(4)){const mb=
this.GB(b),Jb=this.Jd.ww(b);if(Jb.listType!==ra.listType){P++;continue}if(ca&&Jb.listStyle!==ra.listStyle||!ca&&h.level<mb.level){P++;continue}-1===r&&(r=mb.Tu+1);B=null;if(h.level===mb.level||ca)null===(Qa=this.Dad)||void 0===Qa?void 0:Qa.DBf(b),B=new wp(this,b,!1,!1);ca&&mb.level!==h.level&&b.Jt(4)&&(b.Tb(4).setValue(Oc.a.listLevel,mb.level),b.sc());break}P++}return{returnValue:r,sZm:B,Rjn:P}}c4l(b){b=rg.ListItemReader.e9(b);return this.dTd(b)}dTd(b){let h;nq.a.instance.J(1)&&(h=rg.ListItemReader.Nj?
rg.ListItemReader.cE(b)||rg.ListItemReader.LFa(b):this.Jd.fP(b,!1,!0));return this.Jd.Px(b,h.listId,h.listLevel)}startNewList(b,h,r){t.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var B=Ih.a.instance.Fp(Mb.a.startNewList),P=this.Lc.Pc(15);P.Ut(b);var ca=Kp.a.IX(0,h.listStyle,null,0,h.propertySet.ja(Oc.a.listLevel,-1));if(rg.ListItemReader.Nj)({listId:ra,listLevel:Qa}=rg.ListItemReader.HGb(b,{FEa:0,YDb:-1}));else{b.Tb(4);var ra=b.currentNode.ja(Oc.a.listID,
0);var Qa=b.currentNode.ja(Oc.a.listLevel,-1);b.sc()}ca.Y2d=ra;var mb=h.propertySet.ja(Oc.a.ee,0);0<mb&&ca.propertySet.setValue(Oc.a.ee,mb);-1===ca.propertySet.ja(Oc.a.listLevel,-1)&&ca.propertySet.setValue(Oc.a.listLevel,Qa);1===h.ks&&((Qa=new Sz.a,ra=h.fki(b.currentNode,ra),ra)?1===ra&&(ca.zhe(bu.a.tgc),ca.YB=Qa.fcf(Qa.WUf,Qa.XUf),ca.o6=ca.YB.o6):(ca.zhe(bu.a.tgc),ca.YB=Qa.obf(),ca.o6=ca.YB.o6));h.Ooa()&&1>r&&(r=1);ca.UA=r;ra=new wc.DictionaryPropertySet;ra=this.HNc(Mb.a.ML,ra);Qa=Zf.OutlineElementReader.tR(b);
h=this.GB(b);if(mb=this.c4l(b))ca.levelText=mb.ja(Oc.a.Ot,""),ca.PJ=42,ca.zw=mb.ja(Oc.a.wda,"left");this.z0n(b,Qa);({wxa:ca}=this.Zma(ra,b,ca,!0));b.Tb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&t.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);oj.a.getInstance().Ru||this.Aw.A9a(b.currentNode,h.level);oj.a.getInstance().es&&this.Aw.A9a(Qa,h.level);b.sc();ca=new wp(this,b,!1,!1);r=new Iu(1,h,r);this.Qdd(b,ca,!!oj.a.getInstance().es,r);P.dispose();
B.end()}else t.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}mHf(b){if(!b)return!1;const h=b.Tb(2);h&&b.sc();return nq.a.instance.J(1)&&h&&12===h.type&&h.ra&&h.ra.last&&h.ra.last.Lh?!0:!1}Y$d(b,h,r,B){return this.zak.Y$d(b,h,r,B)}jbg(b,h){if(!b||!h)return!1;const r=b.propertySet.ja(Oc.a.Ot,null);h=h.propertySet.ja(Oc.a.Ot,null);if(!r||!h)return!1;const B=b.propertySet.ja(Pe.a.font,null);b=b.propertySet.ja(Pe.a.font,null);return r===h&&B===b}Gnj(b,h,r){r||h.listType||
(h.UA=b.ja(Pe.a.Y0,ti.a.Vl))}dci(b,h){if(!h)return null;const r=Array(9),B=h.Y2d;if(!this.DQm(h,b)||1>B)return null;for(h=0;9>h;h++){const P=this.Jd.Px(b,B,h);if(null===P||void 0===P?0:P.hasProperty(Oc.a.ee))r[h]=P.getValue(Oc.a.ee);else return null}return r}DQm(b,h){if(!b)return!1;const r=b.propertySet.ja(Oc.a.listLevel,-1);b=b.propertySet.ja(Oc.a.ee,-1);if(0>r||0>b)return!1;this.fNd(h);return b!==this.nWb[r]}Kph(b,h,r){b&&b.setValue(Oc.a.ee,h?h[r]:this.nWb&&r<this.nWb.length?this.nWb[r]:720*(r+
1))}N2h(b,h,r,B,P,ca=null,ra=!1){const Qa=new xd.GraphIterator,mb=this.Toa(b,h);Qa.set(b);Qa.od();b=ao.a.Gs(Qa,Qa.pTb());b.xo(dz.a.t_c,null);let Jb=-1;for(;b.moveNext();){if(!rg.ListItemReader.lg(Qa))continue;const Yb=this.GB(Qa),fc=Zf.OutlineElementReader.tR(Qa);this.Jd.EP(Qa);const Mc=Qa.currentNode;Qa.sc();if(B!==this.Oje||Yb.listID===h.listID){if(ra){if(-1!==Jb&&Jb>Yb.level)break;if(-1===Jb)Jb=Yb.level;else if(Yb.level!==Jb)continue}else{if(Yb.level<=mb.kUa)break;if(!B(h,Yb,ca))continue}P(Mc,
fc,r,h.listID,ca)}}}bJl(b,h,r,B,P){const ca=new xd.GraphIterator,ra=this.Toa(b,h);ca.set(b);ca.od();if(rg.ListItemReader.lg(ca)){b=this.GB(ca);var Qa=Zf.OutlineElementReader.tR(ca);this.Jd.EP(ca);var mb=ca.currentNode;ca.sc();b.level<=ra.kUa||B(h,b,null)&&P(mb,Qa,r,h.listID,null)}}aJl(b,h,r,B,P=null){const ca=new xd.GraphIterator;ca.kd(b);B(b,h,this.GB(ca),ca,0);this.OPd(b,h,r,B,P)}OPd(b,h,r,B,P=null){let ca=new xd.GraphIterator;const ra=this.Toa(b.currentNode,h);let Qa=null,mb=0;var Jb=new xd.GraphIterator;
Jb.kd(b);Jb.zb(10);const Yb=qc.a.Gs(Jb,Jb.origin);for(Yb.moveNext();Yb.moveNext();)if(Qa=null,ca=Yb.iterator,1===ca.role&&(Qa=Yb.currentNode,ca.Jt(4)&&(Jb=this.GB(ca),r(h,Jb,P))))if(Jb.level>h.level)B(b,h,Jb,ca,mb),mb++;else if(Jb.level===h.level||Jb.level<=ra.kUa)break;return Qa?ca:null}N7i(b,h,r,B,P){b=this.Toa(b.currentNode,r);b.kUa>=h.level&&this.fDh(B,b.startAt+P)}static get VTm(){null==Lp.zvd&&(v.AFrameworkApplication.K?(v.AFrameworkApplication.se("i75ig452;a229j208"),Lp.zvd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",
!1)):Lp.zvd=!1);return Lp.zvd}static get hi(){return ro.PageNavigator.instance}static Smj(b,h){h.setValue(Pe.a.font,b.Rpa||b.YVc||b.oTc?b.font:"Symbol")}static Umj(b,h){b=b.Rpa||b.YVc||b.Kca?b.levelText:ti.a.KKd;t.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Oc.a.Ot,b)}static Tmj(b,h){b=b.propertySet.ja(Oc.a.wda,"left");h.setValue(Oc.a.wda,b)}static OGm(b){b=b.iterator.parentNode;const h=xd.GraphIterator.eb(b);b&&Zf.OutlineElementReader.iHf(h,null)&&b.nl(8,!0)}}Lp.Xbn=2147450879;Lp.GPi=1;Lp.zvd=
null;Object(n.a)(Lp,"FlatListEditorCssVersion",Am,[499,500]);class ez{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){this.ar=b;this.Wyn=h;this.Pf=r;this.Yr=B;this.SA=P;this.Q1m=ca;this.Qd=ra;this.Ej=Qa;this.c2m=mb;this.Zb=Jb;this.qc=Yb;this.tE=fc;this.Aw=Mc}create(){return new Lp(this.ar,this.Wyn,this.Pf,this.Yr,this.SA,this.Q1m,this.Qd,this.Ej,this.c2m,this.Zb,this.qc,this.tE,this.Aw)}}Object(n.a)(ez,"FlatListEditorFactory",null,[]);class XA{constructor(){this.startAt=this.listLevel=this.listId=
0;this.Dnb=null}}Object(n.a)(XA,"ListAutoCorrectionRefInfo",null,[]);class VB{constructor(b,h){this.Y$j=b;this.Hf=h}Y$d(b,h,r,B){if(!b.hasProperty(Zc.a.y5a))return!0;h=xd.GraphIterator.eb(h.currentNode);Pd.SelectionEditor.Bu(h);let P=!0;if(!r.listType&&!B){23===h.Xe&&h.EJ(1);B=b.ja(Zc.a.y5a,1);if(1<B){var ca=new xd.GraphIterator;ca.kd(h);ca.zb(10);ca=qc.a.gp(ca.origin);B=this.kFl(ca,B,r,h.currentNode);r.Dnb||(P=!1)}b.setValue(Zc.a.y5a,B)}return P}kFl(b,h,r,B){const P=new vb.a;for(;b.moveNext()&&b.iterator.currentNode!==
B;){const ca=b.iterator;if(!ca.Jt(4))continue;const ra=this.Y$j.value.GB(ca),Qa=this.Hf.ww(ca);this.XLn(P,ra);Qa.listType===r.listType&&Qa.listStyle===r.listStyle&&(0>h-ra.Tu||2<h-ra.Tu||P.add(Object.assign(new XA,{listId:ra.listID,listLevel:ra.level,Dnb:ca.currentNode,startAt:ra.Tu+1})))}0<P.count&&(h=P.J(P.count-1).startAt,r.Dnb=P.J(P.count-1).Dnb);return h}XLn(b,h){let r=0;for(;r<b.count;){const B=b.J(r);B.listId===h.listID&&B.listLevel>=h.level?b.removeAt(r):r++}}}Object(n.a)(VB,"ListAutoCorrector",
null,[489]);class Yz{constructor(b,h,r,B,P){this.G8a=(ca,ra,Qa)=>{var mb;ca=rg.ListItemReader.Nj?rg.ListItemReader.HQc(ra):this.SKc(ra);if(!ca||this.$s.mHf(ca))return 8;ra=this.$s.GB(ca);if(1===ra.Tu||this.jXc(ra.level))return 8;ra=null===(mb=this.Jd)||void 0===mb?void 0:mb.ww(ca);if(!ra||this.cAi(ra))return 8;if(1===Qa)return 32;this.$s.startNewList(ca,ra,1);return 32};this.F8a=(ca,ra,Qa)=>{ca=rg.ListItemReader.Nj?rg.ListItemReader.HQc(ra):this.SKc(ra);if(!ca||this.$s.mHf(ca))return 8;ra=this.$s.GB(ca);
if(this.jXc(ra.level))return 8;const mb=this.Jd.ww(ca);if(!mb||this.cAi(mb))return 8;if(1===Qa)return 32;this.bMc.s6l(ca.currentNode,ra.Tu,this.Jd,this.$s,this.xVa);return 32};this.Yba=(ca,ra,Qa)=>{ca=rg.ListItemReader.Nj?rg.ListItemReader.HQc(ra):this.SKc(ra);if(!ca||this.$s.mHf(ca))return 8;ra=this.$s.GB(ca);if(1!==ra.Tu||this.jXc(ra.level))return 8;if(1===Qa)return 32;Qa=this.Jd.ww(ca);return this.$s.Yba(ca,ra,Qa.UA,-1,!1,Qa)?32:8};this.Vqb=(ca,ra,Qa,mb,Jb)=>{ca=rg.ListItemReader.Nj?rg.ListItemReader.HQc(ra):
this.SKc(ra);if(!ca)return 8;ra=this.$s.GB(ca);if(this.jXc(ra.level))return 8;if(1===Qa)return 32;Qa=this.Jd.ww(ca);this.$s.startNewList(ca,Qa,Jb);return 32};this.Kgb=(ca,ra,Qa,mb,Jb)=>{ca=rg.ListItemReader.Nj?rg.ListItemReader.HQc(ra):this.SKc(ra);if(!ca)return 8;ra=this.$s.GB(ca);return this.jXc(ra.level)?8:1===Qa?32:this.$s.Yba(ca,ra,ra.Tu,Jb)?32:8};this.oc=b;this.Jd=r;this.$s=B;this.bMc=P}jXc(b){return 0>b}Ub(){this.oc.qa(Mb.a.G8a,zc.a.KP,this.G8a);this.oc.qa(Mb.a.G8a,zc.a.Tc,this.G8a);this.oc.qa(Mb.a.G8a,
zc.a.view,this.G8a);this.oc.Xc(Mb.a.G8a,12);this.oc.qa(Mb.a.F8a,zc.a.KP,this.F8a);this.oc.qa(Mb.a.F8a,zc.a.Tc,this.F8a);this.oc.qa(Mb.a.F8a,zc.a.view,this.F8a);this.oc.Xc(Mb.a.F8a,12);this.oc.qa(Mb.a.Yba,zc.a.KP,this.Yba);this.oc.qa(Mb.a.Yba,zc.a.Tc,this.Yba);this.oc.qa(Mb.a.Yba,zc.a.view,this.Yba);this.oc.Xc(Mb.a.Yba,12);this.oc.qa(Mb.a.Vqb,zc.a.KP,this.Vqb);this.oc.qa(Mb.a.Vqb,zc.a.Tc,this.Vqb);this.oc.qa(Mb.a.Vqb,zc.a.view,this.Vqb);this.oc.Xc(Mb.a.Vqb,12);this.oc.qa(Mb.a.Kgb,zc.a.KP,this.Kgb);
this.oc.qa(Mb.a.Kgb,zc.a.Tc,this.Kgb);this.oc.qa(Mb.a.Kgb,zc.a.view,this.Kgb);this.oc.Xc(Mb.a.Kgb,12)}get xVa(){return Ya.a.instance.resolve("Common.IStandaloneRootController").sea}SKc(b){return this.$s.I3l(b)}cAi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(n.a)(Yz,"ListContextMenuSectionActor",null,[]);var Bm=c(603);class jy{static get a2m(){return Pf.a.Nx(jy.Wm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}
jy.Wm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(jy,"ListSetStartValueDialogHtml",null,[]);class lt extends Pf.a{constructor(b,h,r,B,P){super();this.Tsd=this.yxe=this.ktd=this.fUe=null;this.sze=!0;this.ZS=!1;this.Icb=0;this.evj=[Mb.a.neg,Mb.a.fjg,Mb.a.W4f];this.Goo=(ca,ra)=>{ca=ra[Gg.a.Number];this.vaa=Number.isInteger(ra[Gg.a.Number])&&ca>=this.Icb?ca:this.Icb};this.sfm=(ca,ra)=>{this.vaa=this.vaa>=this.Icb?this.vaa:this.Icb;ra[Gg.a.Number]=this.vaa;ra[Gg.a.UnitType]=0};this.Elo=(ca,ra)=>{if(1===ca){var Qa=ra.ListRadioStartNew,mb=ra.ListRadioContinue,
Jb=xd.GraphIterator.eb(this.Ef);Jb.od();ra=this.$s.GB(Jb);ca=this.Hf.ww(Jb);if(Qa)this.$s.startNewList(Jb,ca,this.vaa);else if(mb)if(this.sze)this.$s.Yba(Jb,ra,this.tNe,-1,!1,ca);else{Qa=!0;for(mb=null;Jb.FJ();)if(rg.ListItemReader.lg(Jb)){mb=new wp(this.$s,Jb,!1,!1);break}if(!mb||this.$s.GB(Jb).Tu>=this.vaa)Qa=!1;Qa?(Jb=xd.GraphIterator.eb(this.Ef),Jb.od(),this.$s.Yba(Jb,ra,this.tNe,this.vaa,!1,ca)):(this.dispose(),this.TIa(CommonUIStrings.l_ErrorDialogMessage,this.$1m))}}};this.$1m=()=>{new lt(this.Ef,
this.tNe,this.Hf,this.$s,this.Gd)};this.tvn=()=>{document.getElementById(lt.SHi).style.visibility="visible"};this.Knn=()=>{document.getElementById(lt.SHi).style.visibility="hidden"};this.zg="ListSetStartValueDialog";this.Vg=jy.a2m;this.Ef=b;this.vaa=h;this.Hf=r;this.tNe=h;this.d7=B;h=new xd.GraphIterator;b?(h.set(b),h.od(),Zf.OutlineElementReader.yh(h)||hg.OutlineElementNavigator.Yd(h),rg.ListItemReader.lg(h)&&(h.Tb(4),b=h.currentNode,22===b.type&&(this.Hf.gY(b).Ooa()?this.Icb=1:this.Icb=0))):this.Icb=
1;this.Gd=P;this.Uh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.Elo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.sze&&(this.fUe=document.getElementById("ListRadioStartNew"),this.ktd=this.tvn,this.yxe=document.getElementById("ListRadioContinue"),this.Tsd=this.Knn,De.a.addHandler(this.fUe,"click",this.ktd),De.a.addHandler(this.yxe,"click",this.Tsd));for(const ca of this.evj)Object(Bm.a)(ca,this.Goo,this.sfm);this.Gd.Gm()}get $s(){return this.d7}dispose(){if(!this.ZS){for(const b of this.evj)Object(Bm.b)(b);
this.sze&&(this.ktd&&De.a.removeHandler(this.fUe,"click",this.ktd),this.Tsd&&De.a.removeHandler(this.yxe,"click",this.Tsd));this.Gd.iZ("ListStartSpinner");super.dispose();this.ZS=!0}}BOk(){const b=Gi.l("none",this.Icb+"","100","1");return Gi.j(lt.THi,Mb.a.neg,Mb.a.W4f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Mb.a.fjg)}xBb(b){const h=document.getElementById(lt.THi);this.Gd.C_a("ListStartSpinner",b);b=this.Gd.fGb("ListStartSpinner","Medium");h.appendChild(b)}V9(){const b=this.BOk();this.xBb(b)}}lt.THi=
"SetListStartSpinnerContainer";lt.SHi="ListStartAtSpinnerBox";Object(n.a)(lt,"ListSetStartValueDialog",Pf.a,[]);class Jw{s6l(b,h,r,B,P){new lt(b,h,r,B,P)}static get instance(){return Jw._instance||(Jw._instance=new Jw)}}Jw._instance=null;Object(n.a)(Jw,"ListDialogFactory",null,[488]);class Vv{constructor(b,h,r){this.d7=b;this.Hf=h;this.Lc=r}DBf(b){t.ULS.shipAssertTag(40420184,393,Zf.OutlineElementReader.yh(b));if(rg.ListItemReader.lg(b)){const h=this.Hf.ww(b);h.ks||this.xzm(b,h)}}BXk(b){for(let h=
0;h<b.length;h++){const r=new xd.GraphIterator;r.set(b.getContext(h).node);this.DBf(r)}}xzm(b,h){const r=ro.PageNavigator.instance.uu(b.currentNode),B=this.d7.GB(b),P=this.Lc.Pc(15);P.Ut(b);h=this.d7.cvh(r,b,h,0,null);this.d7.s4n(b,B.listID);P.dispose();this.Hf.U2a(b.currentNode,h)}}Object(n.a)(Vv,"SingleLevelListEditor",null,[340]);var fz=c(313);class mt{V4i(b,h,r,B,P,ca){return b?v.AFrameworkApplication.va.Mf(b,h,r,!0,P,ca):8}}Object(n.a)(mt,"ListContextManager",null,[1490]);class mr extends mt{constructor(b){super();
mr.dxc=b}V4i(b,h,r,B,P,ca){if(!b||!b.length)return 8;let ra;const Qa=({Knm:b,Jnm:ra}=mr.qq.Hnm(b)).returnValue;let mb=1;for(const Yb of Qa.keys){var Jb=b.contains(Yb);const fc=Qa.J(Yb);mr.qq.CTk(Qa.J(Yb),this.KIc(h),Jb)?Jb?(t.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.KIc(h)?"Promote":"Demote"),Jb=v.AFrameworkApplication.va.Mf(fz.a.rEa(fc),h,r,B,P,ca)):(t.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.KIc(h)?"Promote":
"Demote"),Jb=mr.qq.Vyn(Qa.J(Yb),this.KIc(h),ra.J(Yb))):(t.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.KIc(h)?"Promote":"Demote"),Jb=8);mb=nd.ActionManager.R0c(mb,Jb)}return mb}KIc(b){return b===Mb.a.bH?!0:!1}static get qq(){return mr.dxc||(mr.dxc=Ya.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}mr.dxc=null;Object(n.a)(mr,"WordEditorListContextManager",mt,[]);class Et{get name(){return"WordEditor.ListEditors"}wc(b){v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new VB(b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new ez(b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new kl.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new Vv(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new mr(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new Yz(v.AFrameworkApplication.va,new Tl.a,Et.Jd,Et.$s,Jw.instance)).Ub();const b=v.AFrameworkApplication.va;b.fb(Mb.a.W4f,zc.a.view,Bm.d,96);b.fb(Mb.a.fjg,zc.a.view,Bm.c,96);b.fb(Mb.a.neg,zc.a.view,Bm.c,96)}dispose(){}static get Jd(){return null!=Et.JEg?Et.JEg:Et.JEg=Ya.a.instance.resolve("Box4.List.IListReader")}static get $s(){return null!=Et.nAg?Et.nAg:
Et.nAg=Ya.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){L.a.instance.Gc(new Et)}}Object(n.a)(Et,"WordEditorListEditorsPackage",null,[1,2]);var YA=c(1719),Wv=c(508),go=c(2070);class Wi extends Ub.a{constructor(b,h,r,B,P,ca){super(b,h);this.styleId=null;this.Eh=0;this.pSa=null;this.characterData=r;this.paragraphNode=B;this.listMarker=P;this.k9=ca}}Object(n.a)(Wi,"HeadingText",Ub.a,[]);var gz=c(352),ZA=c(1038);class $A{constructor(b,h,r,B,P,ca,ra){this.u_g=!0;this.J6g=0;this.mlh=8;this.oja=
null;this.zum=Qa=>{if(Qa.Zr)return!0;Qa=Qa.role;return 1===Qa||2===Qa||4===Qa};this.S$j=b;this.lA=h;this.De=r;this.Hf=B;this.cG=P;this.E6=ca;this.JJe=ra}get px(){return this.S$j.value}get tBf(){return this.u_g}set tBf(b){this.u_g=b}get sLb(){return this.J6g}set sLb(b){this.J6g=b}get eTb(){return this.mlh}set eTb(b){this.mlh=b}async b0l(){var b=this.JJe.value;if(!isNullOrUndefined(b)&&b.Py)return b=await this.Q8l(),this.B2f(b,!0);b=this.oja;return isNullOrUndefined(b)?null:Promise.resolve(this.B2f(b,
!0))}c0l(){return this.B2f([],!1)}B2f(b,h){const r=window.performance.now(),B=this.pai();if(!B)return null;const P=new vb.a;let ca=0;for(;B.moveNext();){var ra=B.iterator;if(11===ra.Xe){const Qa=this.Hf.Gsf(ra),mb=hg.OutlineElementNavigator.Ee(ra,!0);h&&b[ca]&&b[ca].ParaId===Td.ParagraphReader.uR(mb)&&ca++;hg.OutlineElementNavigator.Yd(ra);if(!mb||!Td.ParagraphReader.Xb(mb)||mb.Fr||""===mb.characterData||"\ufffc"===mb.characterData)continue;const Jb=this.uSd(mb);Jb&&(Qa&&(Jb.listMarker=this.cG.Lmb(Qa,
!1).J9,ra=this.Hf.ww(ra),1===ra.listType&&ra.oTc&&(Jb.pSa=ra.font)),h&&(b[ca-1]&&b[ca-1].ParaId===Td.ParagraphReader.uR(mb)?Jb.Eh=ca:Jb.Eh=ca+1),P.add(Jb))}}t.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return P}Q8l(){const b=new jg.a;var h=go.a.Uba(v.AFrameworkApplication.rootQuerySignature,null);const r=new Zo.a;r.Iq=h;r.status=ZA.a.requestReady;this.uek=window.performance.now();h=this.E6.Hha(0,()=>{if(2!=r.statusCode||
null==r.Mj||0==r.Mj.length||null==r.Mj[0]){const B=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(B));t.ULS.sendTraceTag(543802465,3019,10,B)}else b.Dg(r.Mj[0].PageEnds),t.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.uek))});h.JH(r);h.lU();return Bi.b(b.task)}oai(){const b=this.pai();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.Xe){const B=
hg.OutlineElementNavigator.Ee(r,!0);hg.OutlineElementNavigator.Yd(r);B&&Td.ParagraphReader.Xb(B)&&!B.Fr&&""!==B.characterData&&"\ufffc"!==B.characterData&&this.uSd(B)&&h++}}return h}pai(){if(!this.px)return t.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.lA.hP(this.px);if(!b)return t.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=xd.GraphIterator.eb(b);if(!b.Ip())return t.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=qc.a.Gs(b,
b.origin);b.xo(this.zum,null);return b}uSd(b){var h;return null!==(h=this.zlm(b))&&void 0!==h?h:this.i9l(b)}zlm(b){if(!this.CYm(b))return null;var h=Object(gz.c)(9);h=Object(gz.a)(h);h=[...Td.ParagraphReader.dlf(b,h)];if(0===h.length)return null;const r=Td.ParagraphReader.Qwa(b)+1;return this.LIh(b,h,r)}i9l(b){var h,r,B,P,ca=Object(gz.c)(9);ca=Object(gz.a)(ca);const ra=Td.ParagraphReader.XRc(b),Qa=this.De.ZC(b),{Bum:mb,qGl:Jb}=this.Ngm(ra,Qa,ca);ca=null!==(P=null!==(r=null===(h=Jb.linkedStyle)||void 0===
h?void 0:h.k9)&&void 0!==r?r:null===(B=Jb.qw)||void 0===B?void 0:B.k9)&&void 0!==P?P:10;return this.JXc(ca-1)?this.LIh(b,mb,ca):null}LIh(b,h,r){var B;if(!this.JXc(r-1))return null;const {uCj:P,tCj:ca}=this.nPo(b,h);return 0===P.length?null:(h=null===(B=Td.ParagraphReader.gVd(b,P))||void 0===B?void 0:B.trim())&&""!=h?new Wi(ca.Bd,ca.endCp,h,b,null,r):null}Ngm(b,h,r){const B=[];let P={linkedStyle:null,qw:null},ca=null,ra=null;for(const Qa of b)if(ca=Qa.f4.formatting?this.Z_l(h,Qa.f4):ca,b=r(Qa)){if(!ra&&
b){ra=ca;if(!ra)break;P=ca}else if(!this.GOm(ca,ra))break;B.push(Qa)}return{Bum:B,qGl:P}}nPo(b,h){var r;let B=-1,P;for(P=0;P<h.length;P++){var ca=h[P],ra=b.characterData.substring(ca.f4.cp,ca.cpEnd),Qa=null===ra||void 0===ra?void 0:ra.trimStart();if(Qa){B=ca.f4.cp+(ra.length-Qa.length);break}}if(-1===B)return{uCj:[],tCj:{Bd:-1,endCp:-1}};ca=-1;for(ra=h.length;0<ra;ra--){Qa=h[ra-1];const mb=b.characterData.substring(Qa.f4.cp,Qa.cpEnd),Jb=null===mb||void 0===mb?void 0:mb.trimEnd();if(Jb){ca=Qa.cpEnd-
(mb.length-Jb.length);break}}return{uCj:null!==(r=h.slice(P,ra))&&void 0!==r?r:[],tCj:{Bd:B,endCp:ca}}}GOm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.k9===b.linkedStyle.k9||h.qw&&b.qw&&h.qw.uDh==b.qw.uDh?!0:!1}Z_l(b,h){h=Bn.FormattingReader.Zwa(h.formatting);b=this.a0l(b,h);h=this.Y_l(h);return b||h?{linkedStyle:b,qw:h}:null}a0l(b,h){b=this.De.GFa(h,b);if(!b)return null;h=b.ja(Oc.a.Ti,9);return this.srj(h)?{mnp:b.id,k9:h+1}:null}Y_l(b){var h;
b=this.De.Kg(b);if(!b||!um.a.QEi(b))return null;const r=null!==(h=um.a.XQc(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.JXc(h-1)?{uDh:b,k9:h}:null}CYm(b){const h=Td.ParagraphReader.Qwa(b);if(!this.JXc(h))return!1;if(this.srj(h))return!0;b=this.De.hp(b);b=this.De.Kg(b);return um.a.tec(b)?!0:!1}srj(b){return this.tBf&&this.JXc(b)}JXc(b){return b>=this.sLb&&b<=this.eTb}}Object(n.a)($A,"StyleBasedDocumentHeadings",null,[375]);var WB=c(1031);class ky{constructor(){this.startTime=0}}Object(n.a)(ky,
"TocCallbackData",null,[]);class cu{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.Gqg=(fc,Mc,Wc)=>{const id=Mc.node;if(!id)return t.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==id.type)return t.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!id.Fr)return 2;if(1===Wc)return gc.SessionStatusManager.instance.Yj?8:32;this.rd&&this.rd.isFeatureEnabled(121)?this.EEc.PWo(id).then(Id=>{Id||this.IIj(id)}):
this.IIj(id);return 32};this.s0o=fc=>{fc=window.performance.now()-fc.startTime;t.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",fc));fc=Object.assign(new sb.a,{durationMs:fc});xa.Health.instance.recordKpiSuccess(cu.rMj,fc);cu.k9a()};this.Eti=(fc,Mc,Wc,id,Id)=>{if(Td.ParagraphReader.Xb(Mc.node)&&Mc.node.Fr)return 2;if(1===Wc)return gc.SessionStatusManager.instance.Yj?8:32;if(Mc.contextId!==zc.a.Tc||this.Nk.x9(Mc)||!Td.ParagraphReader.Xb(Mc.node))return 32;this.Vd.Zs(17);
(null===Id||void 0===Id?0:Id.resolve)?this.EEc.WLh(Mc,Id.resolve):this.EEc.WLh(Mc);return 32};this.Q8f=(fc,Mc,Wc)=>{fc=Mc.node;if(!fc)return t.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==fc.type)return t.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!fc.Fr)return 2;if(1===Wc)return gc.SessionStatusManager.instance.Yj?8:32;Wc=null;fc.isConnected&&(Wc=WB.a.v$b(fc,!0),Wc.moc(fc));Mc=new xd.GraphIterator;
Mc.set(fc);Mc.zb(8);Mc.jd(8);const id=this.Lc.Pc(15);id.Ut(Mc);this.EEc.$_n(fc)?(id.dispose(),Wc&&Wc.normalize(),cu.k9a()):(Wc&&Wc.cancel(),id.dispose(),t.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.Dhd=h;this.Yc=B;this.Lc=P;this.Nk=ca;this.EEc=ra;this.Vd=Qa;this.rd=mb;this.hXg=Jb;this.WI=Yb}Ub(){this.ga.qa(Mb.a.$Sb,zc.a.paragraph,this.Gqg);this.ga.qa(Mb.a.$Sb,zc.a.Fd,this.Gqg);this.ga.qa(Mb.a.$Sb,zc.a.Tc,this.Gqg);this.ga.Xc(Mb.a.$Sb,1028);this.ga.qa(V.a.UCf,
zc.a.Tc,this.Eti);this.ga.Xc(V.a.UCf,1028);this.ga.qa(V.a.c7c,zc.a.paragraph,this.Q8f);this.ga.qa(V.a.c7c,zc.a.Fd,this.Q8f);this.ga.qa(V.a.c7c,zc.a.Tc,this.Q8f);this.ga.Xc(V.a.c7c,1028)}IIj(b){xa.Health.instance.recordKpiUsage(cu.rMj,1,cu.zB,null);const h=this.gPl(b),r=new ky;r.startTime=window.performance.now();this.Dhd.bkj(h,Oc.a.Npg,this.akm(this.f9l(b)),this.s0o,null,r);this.EEc.bWk()}CQj(b){if(null!=b&&b.Fr)if(null==this.hXg.instance)t.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");
else{var h=this.hXg.instance.qei();b=this.dFl(b);var r=!1;1===this.WI.ou&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ma.a,{name:"TOCPageNo",string:b}),Object.assign(new ma.a,{name:"HeadingPageNo",string:h}),Object.assign(new ma.a,{name:"isMainView",string:r})],ne.a("TOCPageNoMismatch",!0,void 0,h))}}dFl(b){for(let h=0;h<b.ra.length;h++){const r=b.ra.J(h);if(null!=r.Hc)for(let B=0;B<r.Hc.length;B++){const P=r.Hc.J(B);if(1===P.vf&&P.NU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,
b.characterData.length-r.cp))}}return 0}f9l(b){return b?b.ja(Oc.a.BN,null):(t.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}gPl(b){return this.Yc.Joa(b,7,7).Tb(35)}akm(b){const h=[];h.push(b+",TOC,0");return h}static k9a(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
cu.EEa)}}cu.EEa=5E3;cu.rMj="WordUpdateTOC";cu.zB="wwaengidc";Object(n.a)(cu,"TableOfContentsActor",null,[374]);class XB{}Object(n.a)(XB,"FieldData",null,[]);class YB extends XB{constructor(){super();this.Crb=null}}Object(n.a)(YB,"TOCFieldData",XB,[]);class tx{constructor(b,h,r,B,P,ca=null){this.Dum=b;this.At=h;this.Eh=r;this.gxj=B;this.listMarker=P;this.pSa=ca}}Object(n.a)(tx,"TOCHeadingData",null,[]);class IC{constructor(b,h){this.qXa=b;this.Bn=h}async qai(b){this.qXa.tBf=b.uBf;this.qXa.sLb=b.sLb;
this.qXa.eTb=b.eTb;return this.qXa.b0l()}RPl(b){if(b=this.QPl(b))return this.Bn.Dwa(b)}QPl(b){const h=b.ra.length;for(let r=0;r<h;r++){const B=b.ra.J(r);if(B.hyperlink&&B.hyperlink.bda&&B.hyperlink.url.startsWith(E.a.Efb))return B.hyperlink.url.substr(B.hyperlink.url.indexOf("_Toc"))}return null}Mde(b){(b=this.RPl(b))&&this.Bn.uVf(b.id)}Ogm(){return this.qXa.oai()}Y3i(b,h){const r=new YB,B=new vb.a;for(const P of b){b=this.Mgm(P,h);if(!b)return null;B.add(b)}r.Crb=B;return r}Mgm(b,h){let r;if(h&&
(r=this.h$k(b),!r))return t.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=ni.AParagraphNode.QP(b.characterData.trim());const B=this.Fim(b.k9);return new tx(h,r,b.Eh,B,b.listMarker,b.pSa)}h$k(b){const h=String.format("{0}{1}","_Toc",Kd.a.FF());return this.Bn.WFc(h,b.Bc,b.end,b.paragraphNode,b.paragraphNode)?h:null}Fim(b){return String.format("toc {0}",b)}}Object(n.a)(IC,"TOCDataManager",null,[373]);class Xr{Shg(){const b=Object.assign(new Wh.StandardDialog,
{Kt:v.AFrameworkApplication.cda,Cd:0,fJa:!1});b.FV(1);b.lka(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Xr.bDg?Xr.bDg:Xr.bDg=new Xr}}Object(n.a)(Xr,"TOCDialogHelper",null,[]);var hz=c(180),aB=c(498),Zz=c(240),Kw=c(152);class iz{constructor(b,h,r,B,P,ca,ra){this.Thg=b;this.tlb=h;this.uBf=r;this.sLb=B;this.eTb=P;this.UAb=ca;this.Ddd=[];this.NU=ra}toString(){return"showPageNumber:"+this.Thg+
"  isHyperlink:"+this.tlb+" includeOutlineLevels:"+this.uBf+" lowerOutlineLevel:"+this.sLb+" upperOutlineLevel:"+this.eTb+" addContentControl:"+this.UAb+" unsupportedSwitches:"+this.Ddd.toString()}}Object(n.a)(iz,"TOCSettings",null,[]);class uj{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d,be){this.Z_g="TOC";this.Qkf=this.lye=this.sWe=null;this.Z8a=b;this.rh=h;this.zD=r;this.ev=B;this.rz=P;this.Nk=ca;this.hb=ra;this.Md=Qa;this.Wjh=mb;this.Ce=Jb;this.qWe=Yb;this.$o=Mc;this.XI=Wc;this.Un=
id;this.Lc=Id;this.Ib=ve;this.Mg=$d;this.gb=be}get EVc(){return this.Z_g}set EVc(b){this.Z_g=b}get Drb(){this.sWe||(this.sWe=this.Y8h());return this.sWe}Y8h(){return new iz(!0,!0,!0,0,8,!0,this.aHn())}async WLh(b,h){ne.a(uj.agl);const r=window.performance.now();if(this.gb.Xb(b.node))if(this.Nk.x9(b))t.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),uj.vSa("IP is in locked range");else{var B=await this.Z8a.qai(this.Drb);if(B){var P=
new Oe.a(2,1,0,()=>{this.cgl(b,B,this.Drb.tlb,r);h&&h()});this.Ib.Wb(P)}else t.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),uj.vSa("Failed to get TOC data")}else t.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),uj.vSa("Context should be paragraph")}cgl(b,h,r,B=0){let P;try{if(0==B&&(B=window.performance.now()),this.A_h(b.node)){var ca=new xd.GraphIterator;ca.set(b.node);ca.zb(7);ca.jd(7);P=this.Lc.Pc(15);
P.Ut(ca);var ra=this.Z8a.Y3i(h,r);ra||uj.vSa("Failed to prepare TOC Field data");var Qa=ra.Crb?ra.Crb.count:0;if(Qa){h=null;var mb;for(r=0;r<Qa;r++){const Mc=ra.Crb.J(r);if(!({KDb:mb}=this.Bti(b,h,r,Qa,Mc,Yb?Yb.toString():void 0)).returnValue){uj.vSa("Failed to populate new TOC paragraph");return}if(0==r){var Jb=mb.currentNode;var Yb=Td.ParagraphReader.uR(Jb)}h=mb}if(this.Drb.UAb&&!this.hbf(Jb.id,h.Gn.id))uj.vSa("Failed to add content control block");else{var fc=window.performance.now()-B;ne.a(uj.Gcf,
!0,fc)}}else if(this.qWe.Shg(),this.Gal(b)){const Mc=window.performance.now()-B;ne.a(uj.Gcf,!0,Mc)}}else uj.vSa("Failed to fetch style set")}catch(Mc){uj.vSa(String.format("{0} {1}",Mc.message,Mc.stack))}finally{P&&P.dispose()}}A_h(b){this.lye=this.rz.ZC(b);return this.lye?!0:(t.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static kHa(b){b=[Object.assign(new ma.a,{name:uj.q0o,string:b})];ne.a(uj.Iqg,!1,void 0,b)}static cOf(b){b=[Object.assign(new ma.a,{name:uj.H1n,string:b})];
ne.a(uj.Dbj,!1,void 0,b)}static vSa(b){b=[Object.assign(new ma.a,{name:uj.bgl,string:b})];ne.a(uj.Gcf,!1,void 0,b)}async PWo(b){const h=this.Aii(b);if(null==h)uj.kHa("Cannot update TOC when firstTocPara = null");else{var r=this.Qgm(h);if(0<r.Ddd.length)return this.V8m(r.Ddd),!1;ne.a(uj.p0o);var B=window.performance.now(),P=await this.Z8a.qai(r);if(!P)return t.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),uj.kHa("Failed to fetch TOC data"),!1;b=new Oe.a(1,1,0,()=>{this.r0o(h,
P,r,B)});this.Ib.Wb(b);return!0}}r0o(b,h,r,B=0){let P;try{if(null==b)uj.kHa("Attempt to update TOC when firstTocPara = null");else{0==B&&(B=window.performance.now());var ca=new xd.GraphIterator;ca.set(b);ca.zb(7);ca.jd(7);P=this.Lc.Pc(15);P.Ut(ca);var ra=this.Z8a.Y3i(h,r.tlb);if(null==ra)uj.kHa("Attempt to update TOC when tocFieldData = null");else{var Qa;if(({u7e:Qa}=this.Zaj(b,r)).response){t.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));
var mb=ra.Crb?ra.Crb.count:0;if(this.A_h(b)){var Jb;this.rBi(b)&&(this.Cbj(b),(b=this.gb.Wf(b,!1,!0))&&(Jb=b.ja(Oc.a.Wc,null).toString()));var Yb=b.ja(Oc.a.BN,null);h=Yb;Jb=null!==Jb&&void 0!==Jb?Jb:Yb;if(mb){for(var fc=0,Mc;b.Fr&&h==Yb&&fc<mb;){const Id=ra.Crb.J(fc);r.tlb&&this.Z8a.Mde(b);if(!this.T_o(b,fc,mb,Id,r)){t.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");uj.kHa("Failed to update TOC paragraph");return}b.setValue(Oc.a.BN,Jb);fc++;Mc=b;b=this.gb.Wf(Mc,!1,!0);if(!b){h=
null;break}this.yBi(b)&&this.Bbj(b);h=b.ja(Oc.a.BN,null)}h==Yb&&this.G8f(b);var Wc;if(({vKf:Wc}=this.$uk(ra,fc,mb,Mc,Jb)).response)if(r.UAb&&!this.hbf(Qa,Wc.id))uj.kHa("Failed to add content control block");else{var id=window.performance.now()-B;ne.a(uj.Iqg,!0,id)}else uj.kHa("Failed to add new paragraph")}else this.qWe.Shg(),this.m0o(b,r.UAb,Qa,r.NU,Jb)&&(fc=window.performance.now()-B,ne.a(uj.Iqg,!0,fc))}else uj.kHa("Failed to fetch style set")}else uj.kHa("Failed to remove Content Control")}}}catch(Id){uj.kHa(String.format("{0} {1}",
Id.message,Id.stack))}finally{P&&P.dispose()}}$uk(b,h,r,B,P){let ca=new xd.GraphIterator;for(ca.set(B);h<r;){B=b.Crb.J(h);if(!({KDb:B}=this.Bti(null,ca,h,r,B,P)).returnValue)return{vKf:ca.currentNode,response:!1};ca=B;h++}return{vKf:ca.currentNode,response:!0}}Zaj(b,h){var r;let B,P;const ca=null===(r=null===b||void 0===b?void 0:b.ra)||void 0===r?void 0:r.first.Jb;if(ca&&0<ca.length)if(b=b.ra.first.Jb.J(0),b.Of){r=b.contentControlNode.getValue(Oc.a.$w);B=this.Mg.Fq(b.contentControlNode.id,!0);P=this.Mg.Fq(b.contentControlNode.id,
!1);if(0!=this.$o.ZOb(r))return t.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,u7e:B,SCh:P};h.UAb=!0}else t.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.UAb=!1;else h.UAb=!1;return{response:!0,u7e:B,SCh:P}}m0o(b,h,r,B,P){t.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.Z8a.Mde(b);const ca=this.sRd(b);if(!this.g3i(ca,h,r,B))return uj.kHa("Failed to populate empty TOC."),!1;if(h=this.gb.Wf(b,!1,!0))r=b.ja(Oc.a.BN,
null),B=h.ja(Oc.a.BN,null),r==B&&this.G8f(h);b.setValue(Oc.a.BN,P);return!0}g3i(b,h,r,B){this.Md.Ge(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.uQi(b);const P=b.ra.first;this.Ce.IL(P.formatting,!0);this.sbf(b,0,1,B);P.egg&&b.xe.uq.Z(P.formatting.pe,Iq.CharacterPropertiesEditor.bN);return h&&r&&!this.hbf(r,b.id)?!1:!0}sRd(b){b.ra.reset();b.IOa();const h=new hz.a(b,0);h.formatting=new Kw.a(h,U.a.nil);h.Ph=!0;b.ra.add(h);return Se.a.createTextRange(b,0,b.characterData.length)}rBi(b){if(Td.ParagraphReader.mP(b)){var h=
b.ra.last.Hc;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).vf;const r=1===h.J(h.length-3).vf&&h.J(h.length-3).NU.trim().startsWith(this.EVc),B=2===h.J(h.length-2).vf;h=5===h.J(h.length-1).vf;return b&&r&&B&&h}}return!1}yBi(b){if(Td.ParagraphReader.mP(b)){var h=b.ra.first.Hc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).vf,h=3===h.J(1).vf,b&&h}return!1}Cbj(b){const h=b.ra.last.Hc,r=h.J(h.length-4),B=h.J(h.length-3),P=h.J(h.length-2),ca=h.J(h.length-1);h.remove(r);h.remove(B);
h.remove(P);h.remove(ca);b.removeProperty(Oc.a.BN)}Bbj(b){const h=b.ra.first.Hc,r=h.J(0),B=h.J(1);h.remove(r);h.remove(B);b.removeProperty(Oc.a.BN)}G8f(b){if(b){var h=b.ja(Oc.a.BN,null),r=b.ja(Oc.a.Wc,null).toString(),B=h;r==h&&this.rBi(b)&&(this.Cbj(b),(b=this.gb.Wf(b,!1,!0))&&(B=b.ja(Oc.a.BN,null)));r=new xd.GraphIterator;r.set(b);r.zb(8);t.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var P;b&&b.Fr&&B==h&&P!=b;){if(this.yBi(b)){this.Bbj(b);break}this.Z8a.Mde(b);
this.Un.Yd(r);B=this.Un.ns(r,!1,!0);this.rh.mza(b);if(!B)return null;P=b;r.Tb(2);B=(b=r.currentNode)?b.ja(Oc.a.BN,null):null}return b}}Qgm(b){var h=b.ra,r=h?h.length:0,B=null;b=new iz(!0,!1,!1,0,8,!0,void 0);for(let P=0;P<r&&(B=this.Pgm(h.J(P)),b.NU=B,B=this.Idm(B),B[0]!==this.EVc);P++);h=B?B.length:0;for(r=1;r<h;r++)switch(B[r]){case "\\h":b.tlb=!0;break;case "\\u":b.uBf=!0;break;case "\\o":this.Bmo(B[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.Thg=!1;b.Ddd.push(B[r]);break;default:b.Ddd.push(B[r])}return b}Bmo(b,
h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.sLb=Number.parseInvariant(b[1])-1,h.eTb=Number.parseInvariant(b[2])-1,!0):!1}$_n(b){try{ne.a(uj.G1n);const h=window.performance.now(),r=this.Aii(b);if(null==r){uj.cOf("Attempt to remove TOC when firstTocPara = null");return}let B,P,ca;const ra=this.Y8h();if(!({u7e:B,SCh:P}=this.Zaj(r,ra)).response)return uj.cOf("Failed to remove content control"),!1;if(void 0==B&&void 0==P)ca=this.G8f(r);else{ca=r.Mc.Eb(B);const mb=new xd.GraphIterator;
mb.set(ca);mb.zb(8);b=!1;let Jb;for(;!b&&ca&&Jb!=ca;){ca.id.equals(P)&&(b=!0);ca&&ca.Fr&&this.Z8a.Mde(ca);this.Un.Yd(mb);const Yb=this.Un.ns(mb,!1,!0);this.rh.mza(ca);if(!Yb){ca=null;break}mb.Tb(2);Jb=ca;ca=mb.currentNode}}ca&&this.c1c(ca);const Qa=window.performance.now()-h;ne.a(uj.Dbj,!0,Qa)}catch(h){uj.cOf(String.format("{0} {1}",h.message,h.stack))}return!0}c1c(b){b=Se.a.Uc(b,0);b=new ri.Selection([b],!0);this.hb.Ac(b)}hbf(b,h){return this.$o.Uma(b,h,null,uj.DUh,!0).returnValue?(t.ULS.sendTraceTag(573653840,
3019,10,"Failed to create content control block for table of contents."),!1):!0}bWk(){this.Z8a.Ogm()||this.qWe.Shg()}Aii(b){if(!b.Fr)return t.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ja(Oc.a.BN,null);return this.XI.p9l(b)}V8m(b){b.length&&(b=[Object.assign(new ma.a,{name:"UnsupportedSwitches",string:b.toString()})],ne.a("UnsupportedTocInstruction",void 0,void 0,b))}Pgm(b){const h=(b=b.Hc)?b.length:0;for(let r=0;r<h;r++)if(1===b.J(r).vf&&b.J(r).NU.trim().startsWith(this.EVc))return b.J(r).NU.trim();
return null}Idm(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}Gal(b){b=this.tNh(b,null,!0,void 0).returnValue;if(!b)return uj.vSa("Failed to create paragraph"),!1;const h=Se.a.Uc(b,0);if(!this.g3i(h,!0,b.id,this.Drb.NU))return uj.vSa("Failed to populate empty TOC"),!1;t.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}tNh(b,h,r,B){let P,ca;r&&b?(P=this.Wal(b),ca=P.currentNode,B=Td.ParagraphReader.uR(ca).toString()):h&&(P=this.u6l(h),ca=this.rh.OH(P));
if(!ca)return t.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,KDb:P};ca.setValue(Oc.a.BN,B);return{returnValue:ca,KDb:P}}aHn(){const b=new Sys.StringBuilder(this.EVc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}qHn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Drb.tlb&&h.append(" \\h");return h.toString()}u6l(b){b.od();this.Un.Yd(b);return this.rh.ppa(b,!1)}Wal(b){const h=new xd.GraphIterator;h.set(b.node);
h.od();this.Un.Yd(h);let r=this.ddi(h);const B=!b.cpBegin;if(Zf.OutlineElementReader.isEmpty(h,!0))return this.kti(r);if(B)return this.rh.Oy(r,!0,!1),this.rh.S$(h,r,b,!1,!1,!1),b=this.ddi(r),this.kti(b);r=this.rh.ppa(h);this.rh.S$(h,r,b,!1,!1,!0);b=this.rh.ppa(h);this.rh.CQb(b.currentNode,!1);this.rh.OH(b);this.Un.Ee(b);return b}ddi(b){const h=new xd.GraphIterator;h.kd(b);h.od();return h}kti(b){this.rh.Oy(b,!0,!0);this.rh.CQb(b.currentNode,!1);this.Un.Ee(b);return b}uQi(b){const h=b.ra;1===h.length&&
(h.first.Ph=!1,b.dNd().Ph=!0)}T_o(b,h,r,B,P){const ca=this.sRd(b);this.Md.Ge(ca,"");this.k3i(b,B,P);this.sbf(b,h,r,P.NU);return P.tlb&&!this.fF(b,B.At)?!1:!0}Bti(b,h,r,B,P,ca){h=({KDb:b}=this.tNh(b,h,0==r,ca)).returnValue;if(!h)return{returnValue:!1,KDb:b};this.k3i(h,P,this.Drb);this.sbf(h,r,B,this.Drb.NU);return this.Drb.tlb&&!this.fF(h,P.At)?{returnValue:!1,KDb:b}:{returnValue:!0,KDb:b}}k3i(b,h,r){this.hEm(b,h.Dum,h.listMarker,h.gxj,h.pSa);this.Wjh.JFm(b,b.characterData.length);r.Thg&&this.aFm(b,
h);this.uQi(b);this.Woo(b,h.gxj)}R3l(b,h){if(!b)return 0;const r=uj.Gim();return 4<b.length?r.J(h)+.5*Math.floor(b.length/3):r.J(h)}hEm(b,h,r,B,P){r&&this.xEm(b,r,B);r=Se.a.Uc(b,b.characterData.length);this.Md.Ge(r,h);P&&(b=b.ra.nh(0),this.Ce.bka(b.formatting,P))}xEm(b,h,r){r=this.R3l(h,r);const B=Se.a.Uc(b,0);this.Md.Ge(B,h);this.Wjh.yEm(b,h.length,r)}aFm(b,h){var r=Se.a.Uc(b,b.characterData.length);this.Md.Ge(r,h.Eh.toString());r=b.ra.nh(b.characterData.length-h.Eh.toString().length);h=this.qHn(h.At);
this.hRa(b,r,0,2,h);this.hRa(b,r,1,2,h);this.hRa(b,r,2,2,h);r=b.ra.nh(b.characterData.length);this.hRa(b,r,3,2,h)}Woo(b,h){h=this.lye.pj(h);this.ev.cK(h,b,!0)}sbf(b,h,r,B){const P=b.ra.first,ca=b.ra.last;h?this.hRa(b,P,4,1,B):(this.hRa(b,P,0,1,B),this.hRa(b,P,1,1,B),this.hRa(b,P,2,1,B));h===r-1?this.hRa(b,ca,3,1,B):this.hRa(b,ca,5,1,B)}hRa(b,h,r,B,P=null){r=new aB.a(h,null,r,B,!0,!1,!1,P);h.Hc||(h.Hc=new Zz.a(h));h.Hc.add(r);b.Xl();this.Igl(r,b)}Igl(b,h){b.pe?h.xe.xY(b.pe-1,2):h.xe.npa(b.pe,2);h.xe.uq.Z(b.pe,
Iq.CharacterPropertiesEditor.bN);h.xe.ot.Z(b.pe,Iq.CharacterPropertiesEditor.ZR)}fF(b,h){b=Se.a.createTextRange(b,0,b.characterData.length);return this.zD.fF(b,h,!1,!1,!1,!0)?!0:(t.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static Gim(){uj.sua||(uj.sua=new Rb.a,uj.sua.Z("toc 1",1),uj.sua.Z("toc 2",1.5),uj.sua.Z("toc 3",2),uj.sua.Z("toc 4",2.5),uj.sua.Z("toc 5",3),uj.sua.Z("toc 6",3.5),uj.sua.Z("toc 7",4),uj.sua.Z("toc 8",4.5),uj.sua.Z("toc 9",
5));return uj.sua}}uj.sua=null;uj.DUh="Table of Contents";uj.agl="CreateTocClient";uj.Gcf="CreateTocSuccess";uj.bgl="CreateTocFailureCause";uj.p0o="UpdateTocClient";uj.Iqg="UpdateTocSuccess";uj.q0o="UpdateTocFailureCause";uj.G1n="RemoveTocClient";uj.Dbj="RemoveTocSuccess";uj.H1n="RemoveTocFailureCause";Object(n.a)(uj,"TOCField",null,[371,372]);var jz=c(646);class ux{constructor(b,h){this.mBa=b;this.EKa=h}JFm(b,h){if(Td.ParagraphReader.Xb(b)&&!(0>h)){var r=Kn.a.q4b(b);r=new jz.a(r,4,1,1);this.mBa.jYd(b,
r);b=Se.a.Uc(b,h);this.EKa.xYd(b)}}yEm(b,h,r){var B=wm.a.HM/2;const P=b.ra.ljb(h);B=Bn.FormattingReader.Zn(P.formatting,Pe.a.fontSize,2*B)/2;r=new jz.a(af.a.Nv(B/36)*r,1,0,1);this.mBa.jYd(b,r);b=Se.a.Uc(b,h);this.EKa.xYd(b)}}Object(n.a)(ux,"TOCTabUtility",null,[370]);class vx{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.W=b;this.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new YA.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Wv.a.mR)).ha();this.W.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",
()=>new $A(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),ro.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new vr.a,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc))).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new IC(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();
this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new ux(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new uj(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),xj.a.instance,this.W.resolve("Box4.ISelectionManager"),
this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),Xr.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Oa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),kl.a.instance,v.AFrameworkApplication.lc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();
this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new cu(v.AFrameworkApplication.va,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),kl.a.instance,xj.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Sa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Ub()}dispose(){}}
Object(n.a)(vx,"PackageManager",null,[1,2]);class So{constructor(b,h,r,B,P,ca,ra,Qa){this.FTa=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!0,!0)).returnValue)return mb;this.Xyd.CMh(Mc,Jb.node);return 32};this.bza=(mb,Jb,Yb,fc,Mc)=>this.hni(Jb,Yb,fc,Mc,!0);this.MNb=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!1,!0)).returnValue)return mb;this.Xyd.Mcl(Mc,Jb.node);t.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.bna=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:fc}=this.zqb(Jb,Yb,Mc,!1,
!0)).returnValue)return 2==Yb&&8==fc&&ih.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],fe.a.VEb),fc;const Wc=Jb.node;let id=null;(id=mb===Mb.a.bna?this.Xyd.DTb(Mc[Df.a.SourceControlId],Wc):this.Gx.OUd(Wc,Mc))?(this.X$d(Wc,()=>{this.TAd.HQb(id,Wc)}),this.jQ(),fc=32):(ih.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],fe.a.VEb),fc=8);mb===Mb.a.bna&&32===fc&&t.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");t.ULS.shipAssertTag(0,
324,32===fc);return fc};this.Tua=(mb,Jb,Yb,fc,Mc)=>this.hni(Jb,Yb,fc,Mc,!1);this.Hle=(mb,Jb,Yb,fc,Mc)=>Tr.a.Mqa(mb,Jb,Yb,fc,Mc,{},14);this.BCb=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!1,!1)).returnValue)return mb;const Wc=Jb.node;this.X$d(Wc,()=>{this.TAd.PZk(Wc)});return 32};this.Gx=b;this.Xyd=h;this.ga=r;this.TAd=B;this.Lc=P;this.gA=ca;this.c$j=Qa}Ub(){this.sjc(qe.App.wVa.eMh())}sjc(b){this.ga.qa(Mb.a.FTa,zc.a.view,b);this.ga.qa(Mb.a.FTa,zc.a.table,this.FTa);this.ga.Xc(Mb.a.FTa,1127);
this.ga.qa(Mb.a.bna,zc.a.view,this.Hle);this.ga.qa(Mb.a.bna,zc.a.table,this.bna);this.ga.Xc(Mb.a.bna,1030);this.ga.qa(Mb.a.LQ,zc.a.table,this.bna);this.ga.qa(Mb.a.Tua,zc.a.view,this.Hle);this.ga.qa(Mb.a.Tua,zc.a.table,this.Tua);this.ga.Xc(Mb.a.Tua,1038);this.ga.qa(Mb.a.bza,zc.a.view,b);this.ga.qa(Mb.a.bza,zc.a.table,this.bza);this.ga.Xc(Mb.a.bza,1127);this.ga.qa(Mb.a.MNb,zc.a.view,b);this.ga.qa(Mb.a.MNb,zc.a.table,this.MNb);this.ga.Xc(Mb.a.MNb,1126);this.ga.qa(Mb.a.BCb,zc.a.view,this.Hle);this.ga.qa(Mb.a.BCb,
zc.a.table,this.BCb);this.ga.Xc(Mb.a.BCb,1028)}jQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}hni(b,h,r,B,P){if(!({Dy:ca}=this.zqb(b,h,B,P,!0)).returnValue)return 2==h&&8==ca&&ih.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
fe.a.FBl),ca;b=b.node;h=this.Gx.q0(b);var ca=B[Df.a.On];const ra=So.ihm(B.MenuItemId);P?B[Df.a.On]=So.Muo(h,ra):(this.EGk(h,ra,ca,b),r.Hs=ra,r.NC=ca?0:1,t.ULS.shipAssertTag(0,324,!!ra));return 32}X$d(b,h){const r=this.Lc.Pc(15);try{r.Db(b),this.gA.y7a(),h()}finally{r&&r.dispose()}}zqb(b,h,r,B,P){return this.IWm(b,h,r,B,P)?{returnValue:B||2===h,Dy:32}:{returnValue:!1,Dy:8}}IWm(b,h,r,B,P){if(b.contextId!==zc.a.table)return!1;if(B||2===h)if(P&&!r||!Object(uc.a)(Bl.TableNode,b.node)||this.c$j(b.node))return!1;
return!0}EGk(b,h,r,B){const P=(512===h||1024===h?!r:r)?b|h:b&~h;P!==b&&this.X$d(B,()=>{this.TAd.Mza(P,B)})}static sD(){So.jeb[So.kGl]=32;So.jeb[So.cGl]=128;So.jeb[So.L_m]=64;So.jeb[So.D_m]=256;So.jeb[So.gKk]=512;So.jeb[So.fKk]=1024}static Muo(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static ihm(b){let h=0;b in So.jeb&&(h=So.jeb[b]);return h}}So.kGl="buttonFirstRow";So.cGl="buttonFirstColumn";So.L_m="buttonLastRow";So.D_m="buttonLastColumn";So.gKk="buttonBandedRow";So.fKk="buttonBandedColumn";
So.jeb={};Object(n.a)(So,"TableStyleActor",null,[]);So.sD();var kz=c(784),ov=c(405);class Ju extends ov.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(Ju,"TableGalleryButtonProps",ov.a,[]);class lz extends Ju{constructor(){super()}get Type(){return 6}}Object(n.a)(lz,"TableStyleGalleryButtonProps",Ju,[]);class $z{}$z.Nin=2147483647;Object(n.a)($z,"TableStyleUtil",null,[]);class Js{constructor(b,h,r){this.H8e="Clear";this.TEb=null;this.kmk=b;this.De=h;
this.Gx=r;this.Pca=v.AFrameworkApplication.Pca;this.Ms=v.AFrameworkApplication.Ms}R1a(){}ntk(b,h){this.R1a(b);const r=this.p5h(b),B=r.length;if(!(0>=B)){var P=$z.Nin,ca=null;for(let mb=0;mb<B;mb++){var ra=r[mb],Qa=this.Gx.xhm(ra);P!==Qa&&(P=Object.assign(new Nf.a,{Id:"msMoreTableStyles"+Qa,Title:this.yhm(Qa),ControlList:[]}),ca=Object.assign(new Jg.a,{Type:6,Id:"galleryMoreTableStyles"+Qa,ExternalGalleryId:"TableStylesGallery",Width:Js.kkg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.TEb&&
(ca.ExternalId=this.TEb[Qa.toString()]),P.ControlList.push(ca),h.MenuSectionList.push(P),P=Qa);Qa=this.De.vR(ra);ra=Js.zlg+mb;Qa=Object.assign(new lz,{Id:ra,ExternalId:ra,Command:Mb.a.bna.toString(),QueryCommand:Mb.a.FTa.toString(),LabelText:Qa?E.a.zf(Qa):"",Alt:Qa,VerticalCenterAlign:"true"});Qa.TableCellStyles=this.WUd(ra,b);Qa.TableStyles=this.kSc(ra,b);ca&&ca.GalleryItems.push(Qa)}}}mtk(b){const h=Object.assign(new Nf.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new ei.a,{Id:"fseaClearTableFormatting",Command:Mb.a.BCb.toString(),LabelText:E.a.zf(this.H8e),Alt:E.a.zf(this.H8e),Image16by16:this.Ms,Image16by16Class:ie.getImageClassWithCluster(this.Pca,Js.OZk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}CMh(b,h){this.R1a(h);const r=b[Df.a.SourceControlId];var B=this.DTb(r,h);if(B){var P=this.Gx.pF(h);P=P?this.De.Kg(P):null;var ca=this.De.vR(B);B=this.De.Kg(B);b[Ui.a.Alt]=
ca;b[Ui.a.On]=B===P;h=Object.assign(new lz,{Id:r,ExternalId:r,Command:Mb.a.bna.toString(),QueryCommand:Mb.a.FTa.toString(),TableCellStyles:this.WUd(r,h),TableStyles:this.kSc(r,h),Alt:ca});b[Ui.a.GalleryButtonProps]=h}else b[Ui.a.InnerHTML]=null,b[Ui.a.Alt]=null,b[Ui.a.On]=!1,b[Ui.a.GalleryButtonProps]=null}WUd(b,h){this.R1a(h);return(b=this.DTb(b,h))?this.kmk.M6h(b,h):null}kSc(b,h){this.R1a(h);return this.DTb(b,h),null}Mcl(b,h){b.MenuItems=this.R5l(h)}R5l(b){const h=Object.assign(new dh.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.ntk(b,h);this.mtk(h);return h}DTb(b,h){return b?b.startsWith(Js.zlg)?this.Rwf(parseInt(b.substr(Js.zlg.length)),h):this.d8n(parseInt(b.substr(Js.BIo.length)),h):null}}Js.zlg="buttonTableStyleMenu";Js.BIo="buttonTableStyleRibbon";Js.kkg=7;Js.OZk="ClearTableStyle_16x16x32";Object(n.a)(Js,"ATableStyleRibbonControl",null,[425]);class bB extends Js{constructor(b,h,r){super(null,h,r);this.djh=b}CMh(b,h){this.R1a(h);const r=b[Df.a.SourceControlId];var B=this.DTb(r,h);if(B){var P=
this.Gx.pF(h);P=P?this.De.Kg(P):null;var ca=this.De.vR(B);B=this.De.Kg(B);b[Ui.a.Alt]=ca;b[Ui.a.On]=B===P;h=Object.assign(new lz,{Id:r,ExternalId:r,Command:Mb.a.bna.toString(),QueryCommand:Mb.a.FTa.toString(),TableCellStyles:this.WUd(r,h),TableStyles:this.kSc(r,h),Alt:ca});b[Ui.a.GalleryButtonProps]=h}else b[Ui.a.InnerHTML]=null,b[Ui.a.Alt]=null,b[Ui.a.On]=!1,b[Ui.a.GalleryButtonProps]=null}WUd(b,h){this.R1a(h);return(b=this.DTb(b,h))?this.djh.M6h(b,h,5,5):null}kSc(b,h){this.R1a(h);return this.DTb(b,
h),null}}Object(n.a)(bB,"ATableStyleRibbonControlVariableSizePreviews",Js,[]);var JC=c(1488),ZB=c(1125);class Lw{constructor(b,h,r,B){this.hQl=(P,ca)=>this.getBorder(P,this.C2.OM(ca));this.gQl=(P,ca)=>this.getBorder(P,this.C2.bP(ca));this.rz=b;this.Ay=h;this.Ozb=r;this.C2=B;this.gYj=new zf.a(()=>this.fQl());this.P$a=new zf.a(()=>this.eQl())}fQl(){const b={},h=v.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}eQl(){const b={};b[Yg.a.EDa]=Yg.a.Kfb;b[Yg.a.Kfb]=Yg.a.Kfb;b[Yg.a.a0a]=Yg.a.a0a;return b}H$k(b,h,r,B){const P=new ZB.a;P.rowCount=r;P.pgb=B;P.gVa=this.Ozb.Egm(b);P.Ja=b.ja(Oc.a.Ja,1);P.Ia=b.ja(Oc.a.Ia,1);P.tableLook=h;P.Ble=1;return P}M6h(b,h,r,B){if(!this.rz.Kg(b)||!Object(uc.a)(105,b)||!Object(uc.a)(Wu.a,h))return null;const P=this.Ay.q0(h);r=this.H$k(b,P,r,B);B=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.rvk(b,
h,r,B);return B}kSc(){return null}nia(){}rvk(b,h,r,B){r.xbc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.pgb;r.cellIndex++)this.Prk(b,h,r,B)}Prk(b,h,r,B){h=this.Ozb.L3k(r,this.Ozb.Fpf(r),h,b);const P={};var ca=this.Ay.upf(b,h,Pe.a.fontColor,!0,Ul.a.hL(),"None");P.color=ca?ca:"inherit";ca=this.Ay.upf(b,h,Pe.a.WK,!0,Ul.a.hL(),"None");P["background-color"]=ca?ca:"inherit";this.Tvk(r,b,h,P);B.push(P)}Tvk(b,h,r,B){b=this.Ozb.fQa(b);this.TBd(5,b,h,r,B);this.TBd(3,b,h,r,B);this.TBd(0,b,h,r,B);this.TBd(4,
b,h,r,B)}TBd(b,h,r,B,P){h=this.fXl(b,h,r,B);h!==Yg.a.pG&&(P[this.gYj.value[JC.a[b]]]=h)}fXl(b,h,r,B){let P=Yg.a.pG;if(({kna:P}=this.QJa(B,b,1,h,this.gQl,P)).returnValue)return P;({kna:P}=this.QJa(r,b,3,h,this.hQl,P));return P}QJa(b,h,r,B,P,ca){return this.C2.Kqj(r,h,B)&&(ca=P(b,h))!==Yg.a.pG||!h&&({kna:ca}=this.QJa(b,1,r,B,P,ca)).returnValue||4===h&&({kna:ca}=this.QJa(b,2,r,B,P,ca)).returnValue?{returnValue:!0,kna:ca}:{returnValue:ca!==Yg.a.pG,kna:ca}}getBorder(b,h){let r="",B,P;({borderStyle:B,borderWidth:P}=
this.jQl(b,h));if(B===Yg.a.a0a)return r;r=String.format(Yg.a.GEd,P,B,this.MQd(b,h));return r.trim()}MQd(b,h){if(!h)return Yg.a.P_;b=this.Ay.kOc(b,h.color,$f.a.auto);return b!==$f.a.auto?$f.a.eF(b):Yg.a.P_}jQl(b,h){var r=Yg.a.ava;let B=Yg.a.qG+Yg.a.$3b;if(!h)return{borderStyle:r,borderWidth:B};r=this.Ay.kOc(b,h.style,Yg.a.a0a);b=this.Ay.kOc(b,h.size,Yg.a.qG);B=this.iQl(r,b)+Yg.a.$3b;r=this.$Pl(r);return{borderStyle:r,borderWidth:B}}iQl(b,h){let r=2;b===Yg.a.X3b&&h<Yg.a.jna&&(r=1);return r}$Pl(b){return this.P$a.value[b]||
Yg.a.Y3b}static Bhm(){return new Lw(Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),Xu.a.instance,Yg.a.instance)}static get instance(){return null!=Lw.kCg?Lw.kCg:Lw.kCg=Lw.Bhm()}}Object(n.a)(Lw,"TableStylePreviewGenerator",null,[426]);var qm;(function(b){b[b.Ofp=0]="background1";b[b.kup=1]="text1";b[b.Pfp=2]="background2";b[b.lup=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.mkp=11]="followedHyperlink";b[b.Ehp=12]="dark1";b[b.fnp=13]="light1";b[b.Fhp=14]="dark2";b[b.gnp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(qm||(qm={}));Object(n.b)("ThemeColor",qm);class Ft{constructor(b){this.BZb=b}cOl(b,h,r){let B;({J7i:h,nxh:B}=this.zbm(h));b=[];const P=[];for(let ra=0;16>ra;ra++){if(!(qm[ra]in r.Yzb))continue;const Qa=ra,mb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[B[Qa]],this.E2l(ra));var ca=h[Qa];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;P.push(Object.assign(new hr.a,{Color:Qa.toString(),DisplayColor:"#"+E.a.jJ(ca,6),Alt:E.a.zf(mb)}));b[b.length]=ra}return{returnValue:P,HKo:b}}E2l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}zbm(b){let h=null,r=null;b=this.BZb(b);if(!b)return{J7i:h,nxh:r};h=b.properties.ja(Oc.a.xrb,null);r=b.properties.getValue(Oc.a.nme).split(" ");return{J7i:h,nxh:r}}static Dhm(){return new Ft(Object(z.a)(Ft.hi,Ft.hi.uu,"navigateToPageContentNode"))}static get hi(){return ro.PageNavigator.instance}static get instance(){return null!=
Ft.DCg?Ft.DCg:Ft.DCg=Ft.Dhm()}}Object(n.a)(Ft,"TableStyleThemeHelper",null,[443]);var ly=c(903);class aA{constructor(b,h){this.sVe={};this.Yzb={};this.De=b;this.Gx=h}sjf(b,h){const r=this.sVe[qm[h]];return r&&r.length?r:this.VLl(b,h)}Zai(b,h,r){if(h=this.sjf(h,r))for(b=this.De.Kg(b),r=0;r<h.length;r++)if(this.De.Kg(h[r])===b)return r;return-1}nia(){this.sVe={};this.Yzb={}}VLl(b,h){const r=[];this.Yzb={};b=this.Gx.gSc(b);this.xDd(r,this.Yzb,0,h,b);this.xDd(r,this.Yzb,1,h,b);this.xDd(r,this.Yzb,2,h,
b);this.xDd(r,this.Yzb,3,h,b);return this.sVe[qm[h]]=r}xDd(b,h,r,B,P){const ca=P.DO;for(let ra=0;ra<ca;ra++){const Qa=P.PFa(ra);if(3!==this.De.NG(Qa))continue;const mb=this.Gx.whm(Qa),Jb=this.Gx.bVd(Qa);h[qm[Jb]]=!0;mb!==r||Jb!==B&&16!==Jb||this.De.Kg(Qa)===ly.a.hMb||(b[b.length]=Qa)}}static nlm(){return new aA(Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static Cgl(){return aA.nlm()}}Object(n.a)(aA,"WACTableStyleRibbonList",null,[444]);
class pv extends bB{constructor(b,h,r,B,P){super(b,h,r);this.bWb=4;this.rzd=[];this.hHm=()=>{this.X1b.nia();this.djh.nia()};this.lmk=P;this.X1b=B;this.H8e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.fFn()}C$k(b,h){b.MenuItems=this.dLl(h)}fFn(){this.TEb={};this.TEb["0"]="CustomTableStyles";this.TEb["1"]="PlainTableStyles";this.TEb["2"]="GridTableStyles";this.TEb["3"]="ListTableStyles"}dLl(b){const h=Object.assign(new dh.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.XVm(b))return h;
const r=Object.assign(new Nf.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),B=Object.assign(new kz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:V.a.ofb.toString(),QueryCommand:V.a.COb.toString(),Width:pv.IKo});B.Colors=({HKo:this.rzd}=this.lmk.cOl(this.rzd,b,this.X1b)).returnValue;r.ControlList.push(B);h.MenuSectionList.push(r);return h}R1a(b){if(b=this.Gx.pF(b))b=this.Gx.bVd(b),16!==b&&(this.bWb=b)}p5h(b){return this.X1b.sjf(b,this.bWb)}Rwf(b,
h){h=this.X1b.sjf(h,this.bWb);return 0>b||b>=h.length?null:h[b]}d8n(b,h){var r=this.Gx.pF(h);r=this.X1b.Zai(r,h,this.bWb);r=-1!==r?Math.floor(r/Js.kkg)*Js.kkg:0;return this.Rwf(r+b,h)}yhm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}XVm(b){this.R1a(b);
return 0>=this.p5h(b).length}k0o(b,h){if(!b||!h)return null;b=parseInt(b[bb.Color]);var r=this.Gx.pF(h);const B=this.Gx.bVd(r);if(B===b)return null;if(16===B)return this.bWb=b,null;r=this.X1b.Zai(r,h,B);this.bWb=b;return this.Rwf(r,h)}Onl(b){b=this.Gx.pF(b);b=this.Gx.bVd(b);if(16!==b)for(let h=0;h<this.rzd.length;h++)if(this.rzd[h]===b)return h;return-1}aBb(b){b.PZe(this.hHm,2)}static Chm(){return new pv(Lw.instance,Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),
aA.Cgl(),Ft.instance)}static get instance(){return null!=pv.hDg?pv.hDg:pv.hDg=pv.Chm()}}pv.IKo=4;Object(n.a)(pv,"TableStyleRibbonControls",bB,[424,425]);var Ku=c(1585);class my extends So{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r,B,P,ca,ra,Qa);this.Cic=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!1,!0)).returnValue)return mb;this.Blg.C$k(Mc,Jb.node);return 32};this.ofb=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!1,!0)).returnValue)return 2==Yb&&8==mb&&ih.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],fe.a.GBl),mb;const Wc=Jb.node,id=this.Blg.k0o(Mc,Wc);id&&this.X$d(Wc,()=>{this.TAd.HQb(id,Wc)});return 32};this.COb=(mb,Jb,Yb,fc,Mc)=>{if(!({Dy:mb}=this.zqb(Jb,Yb,Mc,!0,!0)).returnValue)return mb;Mc[bb.IndexColorSelected]=this.Blg.Onl(Jb.node);return 32}}sjc(b){super.sjc(b);this.ga.qa(V.a.ofb,zc.a.view,this.Hle);this.ga.qa(V.a.ofb,zc.a.table,this.ofb);this.ga.Xc(V.a.ofb,1030);this.ga.qa(V.a.Cic,zc.a.view,b);this.ga.qa(V.a.Cic,zc.a.table,this.Cic);this.ga.Xc(V.a.Cic,1126);
this.ga.qa(V.a.COb,zc.a.view,b);this.ga.qa(V.a.COb,zc.a.table,this.COb);this.ga.Xc(V.a.COb,1127)}get Blg(){return this.Xyd}static vhm(){return new my(Ya.a.instance.resolve("WordEditor.IWACTableStyleReader"),pv.instance,v.AFrameworkApplication.va,Ku.a.instance,new kl.a,Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(xj.a.instance,xj.a.instance.Zlb,"isTableNodeInLockedRange"))}static get instance(){return null!=
my.rCg?my.rCg:my.rCg=my.vhm()}}Object(n.a)(my,"TableStyleActor",So,[]);class Mw{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}wc(b){this.W=b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Lw.instance).ha();this.W.ia("Box4.TableEditors.IWACTableStyleEditor",()=>Ku.a.instance).ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(my.instance.Ub(),pv.instance.aBb(Fs.a.instance),
ab.StaticActiveAppFrame.za().updateCommandUI())}dispose(){}}Object(n.a)(Mw,"TableStylePackage",null,[1,2]);var KC=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",
Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",
PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",
Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",
MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",
attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},wx=c(1479);class mz{constructor(b,h){this.aMa=b;this.hBa=h}MXn(b){this.aMa.zCd(b)}aEa(b){this.hBa.aEa(b)}ZQb(b,h){return this.hBa.ZQb(b,h)}YQb(b,h){return this.hBa.YQb(b,h)}hne(b,h,r){this.hBa.hne(b,h,r)}}Object(n.a)(mz,
"ClientPaginationHeaderFooterBridge",null,[466]);class $B{constructor(b,h){this.lm=b;this.ga=h;this.Uaa=new Tp.a;this.Vaa=new Tp.a}aEa(b){b=xd.GraphIterator.eb(b);if(b.Ip()&&b.Wp()){b.Rd();do 10===b.Xe&&this.U1f(b.currentNode),b.It();while(8!==b.Xe)}}ZQb(b,h){var r=this.iHb(h);if(!this.Uaa.nb(r))return t.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Uaa.J(r);t.ULS.shipAssertTag(573400389,336,this.Vaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
r=this.Vaa.J(r);return this.Nzf(h,b,r)}YQb(b,h){var r=this.iHb(h);if(!this.Uaa.nb(r))return t.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Uaa.J(r);t.ULS.shipAssertTag(573400391,336,this.Vaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.Vaa.J(r);return this.Emf(h,b,r)}hne(b,h,r){h=this.Rvf(h,r);this.ga.Qb(b?V.a.Fpe:V.a.Led,2,
h)}Rvf(b,h){h=this.lm.oGb(h);if(!h)return t.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.lm.$ha(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}U1f(b){if(10===b.type){var h=new Tp.a,r=this.lm.oGb(b);t.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var B=this.lm.$ha(r);b=this.iHb(b);this.zqg(b,B);this.yqg(b,
h);r=xd.GraphIterator.eb(r);if(r.Wp()){r.Rd();do b=r.currentNode,B=this.lm.WQc(b),b=this.lm.Ioi(b),h.add(B,b),r.It();while(36===r.Xe)}}}zqg(b,h){this.Vaa.nb(b)?this.Vaa.Z(b,h):this.Vaa.add(b,h)}yqg(b,h){this.Uaa.nb(b)?this.Uaa.Z(b,h):this.Uaa.add(b,h)}iHb(b){t.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ja(Oc.a.Xja,0)}Nzf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);
break;case 3:if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(B){if(b.nb(2))return b.J(2)}else if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}Emf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(B){if(b.nb(5))return b.J(5)}else if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);
break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(n.a)($B,"ClientPaginationPageAdornmentContentManager",null,[465]);class ik{constructor(b,h,r,B,P,ca){this.H4k=ra=>{1===ra&&this.yE.GE&&(ra=this.Yc.Joa(this.yE.GE,8,8),this.lm.$Sk(ra)?this.pll(ra):this.Fwo())};this.gSo=ra=>{1===ra&&this.ga.Qb(Mb.a.openInClient,2,!1)};this.yE=b;this.lm=h;this.Yc=r;this.Lc=B;this.pwc=P;this.ga=ca}Vwo(){const b=new Wh.StandardDialog;b.Cd=1;b.ye(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.FV(0);b.sv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.H4k)}pll(b){b.jd(8);const h=this.Lc.Pc(15);h.set(b.Gn.yj);this.pwc.$Zn(b);this.yE.dismiss();h.dispose();t.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}Fwo(){const b=new Wh.StandardDialog;b.Cd=1;b.ye(1,Box4Intl.Box4Strings.L_OpenInWord);b.ye(0,CommonUIStrings.l_Close);b.FV(0);b.sv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.gSo);t.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(n.a)(ik,"DeleteHeaderFooterDialog",null,[]);class aC{constructor(b,h,r,B,P){this.lm=b;this.Yc=h;this.Lc=r;this.pwc=B;this.ga=P}create(b){return new ik(b,this.lm,this.Yc,this.Lc,this.pwc,this.ga)}}Object(n.a)(aC,"DeleteHeaderFooterDialogFactory",null,[464]);class bA{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.Caa=null;this.lng=(Yb,fc,Mc,Wc,id)=>{var Id=this.Uwf(fc);return Id?1===Mc?32:(Mc=this.control)?
(fc=this.Lc.Pc(15),fc.Db(Id),fc.Uj=Yb,Mc.gca?this.ga.processAction(V.a.kU,2):(Id=this.fYh(Id),Wc.Hs=Id?1:0,Wc=Yb!==V.a.Led,(Yb=this.Frf(Yb,id))&&Mc.Hza(Yb),this.ga.Qb(V.a.QLd,2,Wc)),fc.dispose(),32):8:8};this.Hef=(Yb,fc,Mc)=>{if(1===Mc)return 32;this.Y0j.create(this.control).Vwo();return 32};this.CMn=(Yb,fc,Mc,Wc,id)=>1===Mc?32:(Yb=this.control)?(id[Df.a.On]=Yb.gca,32):8;this.qqb=(Yb,fc,Mc,Wc,id)=>{if(1===Mc||!this.control.gca)return 32;fc=this.nai(Yb,id);Mc=bA.Qki(this.control.GE);Wc=this.Lc.Pc(15);
Wc.Db(Mc);Wc.Uj=Yb;Yb=this.Yc.Dk();Yb.set(Mc);this.bMa.qjf(Yb.currentNode,fc);this.lm.TLb(Yb);this.pwc.qoj(Yb,fc);Wc.dispose();return 32};this.Hza=(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;Yb=this.Frf(Yb,id);this.control.gca&&this.control.Hza(Yb);return 32};this.Cge=(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;Yb=this.dhi(Yb,id);Wc.Hs=Yb;fc=this.Uwf(fc);if(!fc)return 8;Wc=this.Yc.Dk();Wc.set(fc);Wc.zb(8);Wc.Ps(8);if(!this.Yk.ign(Wc,Yb))return 8;this.lm.TLb(Wc);this.control.rha(Wc.currentNode);return 32};this.V1f=
(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;Yb=this.tnk.Yel(this.Uwf(fc));id.PopulationXML=Yb;return 32};this.rce=(Yb,fc,Mc,Wc,id)=>{Yb=this.nai(Yb,id);fc=this.control.GE;Mc=this.lm.$ha(fc);id[Df.a.On]=Yb===Mc;1===Yb&&(id[Df.a.LabelText]=this.Sli(fc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.wbe=(Yb,fc,Mc,Wc,id)=>{if(1===Mc||!this.control.gca)return 32;fc=this.control.GE;void 0!==fc&&null!==fc&&(fc=this.lm.$ha(fc),
Yb=this.Frf(Yb,id),Mc=this.control.dWb,id[Df.a.Visible]=this.JJo(Yb,fc),id[Df.a.On]=Yb===Mc);return 32};this.RMn=(Yb,fc,Mc,Wc,id)=>{if(1===Mc||!this.control.gca)return 32;Yb=this.control.GE;void 0!==Yb&&null!==Yb&&this.AFn(Yb,id);return 32};this.bMn=(Yb,fc,Mc,Wc,id)=>{if(1===Mc||!this.control.gca)return 32;Yb=this.dhi(Yb,id);fc=this.control.GE;Mc=0;void 0!==fc&&null!==fc&&(Mc=fc.getValue(Oc.a.Xja));id[Df.a.On]=Yb===Mc;return 32};this.kU=(Yb,fc,Mc)=>{if(1===Mc)return 32;this.control.dismiss();return 32};
this.OWd=()=>32;this.QLd=(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;this.control.show(id);return 32};this.umb=(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;if(!id)return 8;fc=id.O0a;if(!fc||!fc.isConnected)return 8;Yb=this.lm.l1c(fc);if(!({isHeader:Mc,kmg:fc}=this.lm.jji(fc)).returnValue)return 8;this.control.rha(Yb);this.control.Hza(fc);this.control.show(Mc,id.yie);return 32};this.ga=b;this.lm=h;this.pwc=r;this.bMa=B;this.Yk=P;this.Yc=ca;this.Lc=ra;this.tnk=Qa;this.z5j=mb;this.Y0j=Jb}get control(){return this.Caa}set control(b){this.Caa=
b}Ub(){this.ga.qa(V.a.mYd,zc.a.view,this.lng);this.ga.fb(V.a.T4f,zc.a.application,this.CMn,96);this.ga.qa(V.a.Fpe,zc.a.view,this.lng);this.ga.qa(V.a.Led,zc.a.view,this.lng);this.ga.fb(V.a.OWd,zc.a.view,this.OWd,64);this.ga.qa(V.a.QLd,zc.a.view,this.QLd);this.ga.fb(V.a.kU,zc.a.application,this.kU,96);this.ga.fb(V.a.umb,zc.a.application,this.umb,96);this.ga.fb(V.a.Mgo,zc.a.view,this.Hza,96);this.ga.qa(V.a.Bkj,zc.a.view,this.Hza);this.ga.qa(V.a.Dkj,zc.a.view,this.Hza);this.ga.qa(V.a.Ckj,zc.a.view,this.Hza);
this.ga.qa(V.a.Ekj,zc.a.view,this.Hza);this.ga.fb(V.a.eko,zc.a.view,this.qqb,100);this.ga.fb(V.a.nmj,zc.a.view,this.qqb,4);this.ga.fb(V.a.mmj,zc.a.view,this.qqb,4);this.ga.fb(V.a.kmj,zc.a.view,this.qqb,4);this.ga.fb(V.a.lmj,zc.a.view,this.qqb,4);this.ga.qa(V.a.Cge,zc.a.view,this.Cge);this.ga.qa(V.a.cdg,zc.a.view,this.Cge);this.ga.fb(V.a.V1f,zc.a.view,this.V1f,96);this.ga.fb(V.a.Hef,zc.a.view,this.Hef,4);this.ga.fb(V.a.T5i,zc.a.view,this.wbe,97);this.ga.fb(V.a.V5i,zc.a.view,this.wbe,97);this.ga.fb(V.a.U5i,
zc.a.view,this.wbe,97);this.ga.fb(V.a.W5i,zc.a.view,this.wbe,97);this.ga.fb(V.a.l6i,zc.a.view,this.rce,97);this.ga.fb(V.a.k6i,zc.a.view,this.rce,97);this.ga.fb(V.a.i6i,zc.a.view,this.rce,97);this.ga.fb(V.a.j6i,zc.a.view,this.rce,97);this.ga.fb(V.a.wMn,zc.a.view,this.RMn,97);this.ga.fb(V.a.p4f,zc.a.view,this.bMn,97)}fYh(b){const h=this.lm.oGb(b),r=this.lm.$ha(h);b=this.bMa.qjf(b,r);this.control.rha(h);return b}nai(b,h){switch(b){case V.a.nmj:case V.a.l6i:b=1;break;case V.a.mmj:case V.a.k6i:b=2;break;
case V.a.kmj:case V.a.i6i:b=3;break;case V.a.lmj:case V.a.j6i:b=4;break;default:b=h}return b}Frf(b,h){switch(b){case V.a.Bkj:case V.a.T5i:b=1;break;case V.a.Dkj:case V.a.V5i:b=2;break;case V.a.Ckj:case V.a.U5i:b=3;break;case V.a.Ekj:case V.a.W5i:b=4;break;case V.a.Fpe:case V.a.Led:b=h;break;case V.a.mYd:b=0;break;default:b=h}return b}dhi(b,h){return b===V.a.cdg||b===V.a.p4f?parseInt(h.MenuItemId):h}Uwf(b){return this.Yk.g9(b.ik)}JJo(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===
b||2===b||3===b;case 3:return 4===b||3===b}return!0}AFn(b,h){const r=this.Sli(b);if(h[Zm.a.Visible]=r)b=this.Yk.Rki(this.z5j(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[Zm.a.LabelText]=b}Sli(b){const h=this.Yc.Dk();h.set(b);h.zb(8);h.Ps(8);return 1<this.Yk.owf(h)}static Qki(b){const h=new xd.GraphIterator;h.set(b);h.zb(10);return ym.WordSectionNavigator.x9n(h)}}Object(n.a)(bA,"HeaderFooterActor",null,[]);var nt=c(806),ny=c(717);class Mp{constructor(b,
h,r,B,P){this.yck=b;this.lm=h;this.Yk=r;this.Yc=B;this.ga=P}TXh(b,h){this.lm.TLb(b);h=this.rxl(b,h);b.sc();return h}qjf(b,h){b=this.Yc.Joa(b,8,8);let r=!1;this.Yk.RPa(b,B=>{const P=this.Yc.Dk();P.set(B);r=(B=this.TXh(P,h))||r;return B});return r}rxl(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=ny.a.vff(h);for(let B=0;B<h.length;++B)r=this.yck.qxl(b,h[B])||r;return r}}Mp.Tjl=1;Object(n.a)(Mp,"HeaderFooterInserter",null,[441]);class Xv{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.mgh=this.kTg=!1;this.GE=
null;this.uGe=!1;this.dWb=0;this.zMb=()=>{this.uGe=!0};this.P6=b;b.bind(this);this.zXe=B;this.x1j=mb;this.U9g=P;this.odk=ca;this.Bbb=ra;this.header=h;this.footer=r;this.header.egl();this.P6.Qz();this.FVe=Mp.Tjl;this.bMa=Qa;Xv.ga=Jb;this.ON=Yb}get gca(){return this.kTg}show(b=!0,h=!0){this.gca||(this.DIj(),this.Jlj(!0),this.header.aVn(),this.x1j(),this.EDo(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa&&(rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new nt.a,
{state:0,disablePopover:!0}))):t.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.mgh=h)&&this.U9g(b)}dismiss(b=!1){this.gca&&(this.odk(b),this.Jlj(!1),this.fEb(),this.dWb=0,this.OEo(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa&&(rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new nt.a,{disablePopover:!1}))):t.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}Jlj(b){this.kTg=
b;Xv.ga.processAction(Mb.a.anf,2);this.P6.F1(b);this.header.F1(b);this.footer.F1(b);this.zXe()}rha(b){this.GE!==b&&(this.GE=b,this.header.rha(b),this.footer.rha(b),this.dWb=0,this.qqb(this.Bbb.$ha(b)))}fEb(){this.GE&&(this.header.phb(),this.footer.phb(),this.GE=null)}update(){this.gca&&this.WSb()}WSb(){this.GE&&(this.Bbb.Usl(this.GE)&&this.Bbb.mum(this.GE)?this.DIj():this.dismiss())}DIj(){const b=this.Bbb.$ha(this.GE);b!==this.FVe&&this.qqb(b)}qqb(b){this.FVe=b;this.Hza(this.aim(b))}aim(b){switch(b){case 2:return 2;
case 3:return 3;case 4:return 2}return 1}Hza(b,h=!0){this.dWb!==b&&(this.bMa.qjf(this.GE,this.FVe),this.header.Akj(b),this.header.Cwh(xk.AppFrame.Mca),this.footer.Akj(b),this.footer.Cwh(xk.AppFrame.qca),this.dWb=b,this.gca&&this.mgh&&this.$xl(h))}$xl(b){this.U9g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.P6.caa();this.header.dispose();this.footer.dispose()}EDo(){this.ON.pGc(this.zMb);this.uGe=!1}OEo(){this.ON.cee(this.zMb);this.uGe&&Xv.ga.processAction(V.a.OWd,
2)}static Xpl(){Xv.ga.Qb(eb.a.mkb,2,!0);Xv.ga.processAction(V.a.r4,2)}}Xv.ga=null;Object(n.a)(Xv,"HeaderFooterControl",null,[484,10]);class Nw{constructor(b,h,r,B,P){this.zXe=b;this.Bbb=h;this.bMa=r;this.ga=B;this.ON=P}create(b,h,r,B,P){return new Xv(b,h,r,this.zXe,B,P,this.Bbb,this.bMa,Xv.Xpl,this.ga,this.ON)}}Object(n.a)(Nw,"Factory",null,[463]);class cA{constructor(){this.Caa=null}get control(){return this.Caa}set control(b){this.Caa=b}Nnf(b){return this.Onf(this.control.GE,this.control.dWb,b.isHeader,
b)}Onf(b,h,r,B){return()=>{if(!b.isConnected)return null;this.control.rha(b);this.control.Hza(h);this.control.show(r);return B}}dismiss(){this.Caa.gca&&this.Caa.dismiss()}}Object(n.a)(cA,"HeaderFooterControlLauncher",null,[]);var Lg=c(1176),u=c(659),C=c(252),W=c(820);class pa{constructor(b,h,r){this.doc=null;const B=h?"Header":"Footer";this.Mr=b.ownerDocument.createElement("div");this.Mr.id=h?"HeaderPane":"FooterPane";this.Mr.classList.add(pa.pum,B);this.yAb=(new W.a(this.Mr,"WACViewPanel_"+B)).vI;
this.Mr.appendChild(this.yAb);b.appendChild(this.Mr);h&&(this.doc=b.ownerDocument.createElement("div"),this.doc.classList.add(pa.vum),this.Mr.appendChild(this.doc));this.VLg=r.a9l(this.Mr)}bind(){}F1(b){b?this.VLg.SCk():this.VLg.UCk()}dLk(b){b.GBb(this.yAb)}}pa.vum="HeaderToolbarContainer";pa.pum="HeaderFooterPane";Object(n.a)(pa,"PaneControlDom",null,[498]);class Oa{constructor(b,h,r,B,P){this.yE=this.Sq=null;this.iXi=()=>{this.yE.dismiss(!0);if(this.eXb){const ca=new th.a(!0);this.eXb.qIa(ca)}return!0};
this.aC=ca=>{ca.Hb.preventDefault();return!1};this.Mr=b.ownerDocument.createElement("div");this.Mr.id=Oa.UJh;this.Mr.className=Oa.UJh;this.k_=B;this.eXb=P;this.Goi=new pa(this.Mr,!0,h);this.Idl(this.Mr);this.D2h=new pa(this.Mr,!1,h);this.F1(!1);b.appendChild(this.Mr)}Idl(b){this.Sq=b.ownerDocument.createElement("div");this.Sq.id=Oa.jzn;this.Sq.className=Oa.hzn;this.Sq.tabIndex=0;this.Sq.setAttribute(qf.a.uh,qf.a.Z3);this.Sq.setAttribute(qf.a.Aga,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);
b.appendChild(this.Sq)}bind(b){this.yE=b}F1(b){if(!b&&this.k_){var h=new th.a(!0);this.k_.qIa(h)}!b&&this.eXb&&(h=new th.a(!0),this.eXb.qIa(h));this.Mr.style.display=b?"":"none";this.Goi.F1(b);this.D2h.F1(b)}yjo(){this.Sq.focus()}Qz(){ji.a.instance.ob(Xc.a.click,this.Sq,this.iXi);Ye.a.instance.ob(Xc.a.Zx,this.Mr,this.aC)}caa(){ji.a.instance.uc(Xc.a.click,this.Sq,this.iXi);Ye.a.instance.uc(Xc.a.Zx,this.Mr,this.aC)}}Oa.UJh="HeaderFooterControl";Oa.jzn="HeaderFooterOverlay";Oa.hzn="EditingSurfaceOverlay HeaderFooterOverlay";
Object(n.a)(Oa,"HeaderFooterControlDom",null,[483]);class jb{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.P6=null;this.sa=new wd.a;this.yE=this.Hwd=null;this.iXf=Yb=>{this.G$(Yb);this.sa.raiseEvent("OnShowEventKey")};this.hXf=Yb=>{this.Ek&&(this.Hwd=new Lg.a(this.Ek));this.Vb.zLc(xk.AppFrame.Mca);this.Vb.zLc(xk.AppFrame.qca);this.nea(Yb);this.sa.raiseEvent("OnDismissEventKey")};this.j$d=()=>{this.Hwd&&(this.Hwd.dispose(),this.Hwd=null)};this.Vb=b;this.np=h;this.Hah=r;this.a6j=B;this.hfk=P;this.ga=ca;
this.HQg=u.a.create();this.HUg=Tb.KeyInputManager.ic(kc.a.Rs,0);this.$Z=Tb.KeyInputManager.ic(kc.a.l2,0);this.ilk=Tb.KeyInputManager.ic(kc.a.gKa,0);this.iM=ra;this.Ca=Qa;this.k_=mb;this.eXb=Jb;this.Ek&&this.Ek.wga(this.j$d)}Frh(b){this.sa.addHandler("OnShowEventKey",b)}E2n(b){this.sa.removeHandler("OnShowEventKey",b)}zCd(b){this.sa.addHandler("OnDismissEventKey",b)}fcj(b){this.sa.removeHandler("OnDismissEventKey",b)}get Ek(){const b=this.iM.value;return b?b.$i?b:(t.ULS.sendTraceTag(25474004,317,10,
"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(t.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.yE}get b7k(){return this.HQg}bind(b){this.yE=this.i5k(b);this.HQg.instance=this.yE}i5k(b){this.P6=new Oa(b,this.hfk.value,this.Ca,this.k_,this.eXb);b=this.Hah.value.create(this.ga,this.P6.Goi,!0,xk.AppFrame.Mca);const h=this.Hah.value.create(this.ga,this.P6.D2h,!1,xk.AppFrame.qca);this.yE=this.a6j.value.create(this.P6,
b,h,this.iXf,this.hXf);this.$Bf();this.MT();return this.control}$Bf(){var b=3===this.ga.mode?xk.AppFrame.VD:xk.AppFrame.njc;const h=this.Vb.fe(xk.AppFrame.Mca);h.parent=b;this.Vb.b_e(xk.AppFrame.Mca);const r=this.Vb.fe(xk.AppFrame.qca);r.parent=b;this.Vb.b_e(xk.AppFrame.qca);b=this.Vb.fe(C.a.$Hb);b.parent=Zd.AFrame.Ap;b.sga(()=>{this.P6.yjo()});b.bindAction(this.HUg,V.a.kU);b.bindAction(this.$Z,V.a.kU);b.bindAction(this.ilk,V.a.kU);h.bindAction(this.$Z,V.a.kU);r.bindAction(this.$Z,V.a.kU)}MT(){this.np.MT(xk.AppFrame.Mca);
this.np.MT(C.a.E3a);this.np.MT(xk.AppFrame.qca);this.np.MT(C.a.$Hb)}G$(b){this.np.aJ(xk.AppFrame.Mca);this.np.aJ(C.a.E3a);this.np.aJ(xk.AppFrame.qca);this.np.aJ(C.a.$Hb);this.np.fx(Zd.AFrame.In);this.Vb.MFc(xk.AppFrame.Mca);this.Vb.MFc(xk.AppFrame.qca);b?this.Vb.mg(xk.AppFrame.Mca):this.Vb.mg(xk.AppFrame.qca)}nea(b){this.np.fx(xk.AppFrame.Mca);this.np.fx(C.a.E3a);this.np.fx(xk.AppFrame.qca);this.np.fx(C.a.$Hb);this.np.aJ(Zd.AFrame.In);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===xk.AppFrame.Mca||
this.Vb.currentScope.name===C.a.E3a||this.Vb.currentScope.name===xk.AppFrame.qca||this.Vb.currentScope.name===C.a.$Hb))&&this.Vb.mg(Zd.AFrame.In)}dispose(){const b=this.Vb.fe(C.a.$Hb);b.mr(this.HUg);b.mr(this.$Z);this.Vb.fe(xk.AppFrame.Mca).mr(this.$Z);this.Vb.fe(xk.AppFrame.qca).mr(this.$Z);this.Ek&&this.Ek.n7c(this.j$d);this.control.dispose()}}Object(n.a)(jb,"HeaderFooterControlOwner",null,[461,462]);var Wb=c(1123);class Cc{constructor(b,h,r,B,P,ca,ra,Qa){this.rba=b;this.fmk=h;this.Rve=r;this.nm=
B;this.Jek=P;this.Ckk=ca;this.Q5j=ra;Cc.rh=Qa}WDm(b,h){this.fmk(b,1,3,null,!1);this.rba.Whe(ly.a.hMb,1696,b.currentNode);this.Rve(b,0,this.nm?3:1,h);this.Rve(b,1,2,h);this.Rve(b,2,this.nm?1:3,h);this.Jek(b);this.Ckk(b,!1,!0,null);this.Q5j(b,h)}static get tE(){return null!=Cc.ZJg?Cc.ZJg:Cc.ZJg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Sk(){return null!=Cc.fGg?Cc.fGg:Cc.fGg=Ya.a.instance.resolve("Box4.IParagraphEditor")}static Iho(b,h,r){Qg.moveToCellContent(b,0,h);hg.OutlineElementNavigator.Ee(b);
Cc.tE.h$c(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Cc.Sk.pE(b.currentNode,r);h||Cc.Sk.qq.Kza(b,1,-115);2===h&&Cc.Sk.qq.rQb(b.currentNode,1,-115);Qg.returnToContainingTable(b)}static cko(b,h){hg.OutlineElementNavigator.Ee(b);Cc.tE.h$c(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);hg.OutlineElementNavigator.Yd(b)}static mRl(){return(b,h,r)=>{Cc.Iho(b,h,r)}}static G_l(){return(b,h)=>{Cc.cko(b,h)}}static fhm(b){return(h,r,B,P,ca)=>b.sEa(h,
r,B,P,ca)}static Yem(){return(b,h,r,B,P)=>Cc.rh.Oy(b,h,r,B,P)}}Cc.rh=null;Object(n.a)(Cc,"HeaderFooterDefaultTableInserter",null,[460]);class Vc{constructor(b,h,r,B){this.lm=b;this.Ftd=h;this.Yc=r;this.Yk=B}qoj(b,h){b.Gn.properties.setValue(Oc.a.hzf,2===h||4===h);b.zb(8);b.oed(8).properties.setValue(Oc.a.wWd,3===h||4===h)}$Zn(b){this.Yk.RPa(b,h=>{const r=this.Yc.Dk();r.set(h);this.lm.TLb(r);this.qoj(r,1);this.a_n(r);return!0})}a_n(b){for(;b.Rd();)b.tg()}}Object(n.a)(Vc,"HeaderFooterEditor",null,[457]);
var Bd=c(1130);class td extends Gs.a{constructor(b){super();this.BXe=b}get index(){return 0}run(){this.BXe()}kum(b,h){h.property===Oc.a.hzf&&this.dK()}Ezn(b,h){h.property===Oc.a.wWd&&this.dK()}dK(){this.TY()}}Object(n.a)(td,"ControlUpdateNeededTracker",Gs.a,[]);class Ed{constructor(b,h,r,B,P,ca){this.kab=null;this.b6j=r;this.pnd=h;this.MXb=b;this.Yek=B;this.YMa=ca}start(){this.MXb.bind(ab.StaticActiveAppFrame.za().RF);this.pnd.control=this.MXb.control;this.pnd.Ub();this.b6j.control=this.MXb.control;
this.Yek.value.create(this.MXb.control,Object(z.a)(this.pnd,this.pnd.fYh,"ensureSectionHeaderFooterAttachedToControl")).Ub();this.Svm()}Svm(){this.kab=new td(()=>{this.MXb.control.update()});const b=qe.App.li.Al;b.Te(35).qo(Object(z.a)(this.kab,this.kab.kum,"headerFooterContainerNodePropertyChanged"));b.Te(8).qo(Object(z.a)(this.kab,this.kab.Ezn,"pageContentNodePropertyChanged"));Bd.a.yde(Object(z.a)(this.kab,this.kab.dK,"setUpdateNeeded"));Lk.GraphTransactionManager.instance.pra(this.kab,3)}dispose(){this.MXb.dispose();
this.YMa.GTh()}}Object(n.a)(Ed,"HeaderFooterManager",null,[]);class Ke{constructor(b,h,r,B){this.Yk=b;this.lm=h;this.xck=r;this.Fye=B}qxl(b,h){let r=!1;const B=ny.a.mtf(h);b.Jt(B)||(this.gEm(b,h),this.Fye.VDm(b.currentNode,h),r=!0);return r}gEm(b,h){const r=this.xck.create(1074135123),B=b.currentNode.ja(Oc.a.Xja,0);r.properties.setValue(Oc.a.Xja,B);r.properties.setValue(Oc.a.Rac,h);h=ny.a.mtf(h);b.Bf(r,h)}}Object(n.a)(Ke,"HeaderFooterNodeLevelInserter",null,[440]);var Gf=c(227),Kg=c(389);class qg extends Gf.a{constructor(b,
h,r){super(b,h,"","");this.Wxb=null;this.Roi=qg.FQh;this.HTc=[];this.TDe=r}get $A(){return!0}get cssClass(){return"cui-herodock"}Hm(){this.UUn();super.Hm()}zPa(){for(const b of this.HTc)b.cNd();super.zPa()}yCo(){let b,h,r;b=[];h=[];r=[];for(let B=0;B<this.HTc.length;B++){const P=this.HTc[B];P.visible?b.length<this.Roi?b.push(P):Object(uc.a)(Kg.FlyoutAnchor,P)?Array.addRange(h,P.eUl()):h.push(P):r.push(P)}return{MMo:b,fzn:h,oHm:r}}Hdl(b){if(!b||!b.length)return null;const h=new me.Menu(this.root,this.id+
"OverflowMenu",null,null,null),r=new Tk.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const B of b)r.Bf(B.bR("Menu20"));h.Bf(r);return h}UUn(){this.bra();this.Nc=Af.a.XTa(this.Nc);this.RC();var b;({MMo:r,fzn:b,oHm:B}=this.yCo());for(var h of r){var r=h.bR("Medium20");r.enabled=!0;this.s2b(r,this.children.count);this.Nc.appendChild(r.Nc);r.noa()}if(b=this.Hdl(b))this.Wxb?this.Wxb.menu=b:(h=this.id+"OverflowMenuLauncher",r=
{},r.Image20by20=this.TDe.OverflowMenuImage20by20,r.Image20by20Class=this.TDe.OverflowMenuImage20by20Class,r.PopulateDynamically="false",r.HideDefaultArrow="true",r.Alt=this.TDe.OverflowMenuTooltip,r.Command="798637440",r.Id=h,this.Wxb=new Kg.FlyoutAnchor(this.root,h,r,b)),b=this.Wxb.bR("Small20"),b.enabled=!0,this.s2b(b,this.children.count),this.Nc.appendChild(b.Nc),b.noa();if(v.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const P of B){var B=P.bR("Medium20");
this.Bf(B);B.noa()}}dispose(){this.Wxb&&(this.Wxb.dispose(),this.Wxb=null);for(const b of this.HTc)b.dispose();this.bra();super.dispose()}set $A(b){super.$A=b}}qg.FQh=4;Object(n.a)(qg,"HeroDock",Gf.a,[]);var Ag=c(610);class bj extends Ag.a{constructor(){super();this.ble=this.YRm=this.pEo=!1;this.Ibn=v.AFrameworkApplication.MGf?1:qg.FQh}}Object(n.a)(bj,"ToolbarBuildOptions",Ag.a,[]);var Ug=c(45),Ri=c(883),$p=c(725);class Ks extends Gf.a{constructor(b,h,r){super(b,h,"","");this.drc=r.Alignment;this.QTg=
r.ScalingDirection===Ug.a.pPj}Hm(){this.owa();this.sX(this.Nc);super.Hm()}sX(b){for(let h of this.children){h.RC();switch(this.drc){case Ug.a.lre:Af.a.$f(h.Nc,"cui-toolbar-button-left");break;case Ug.a.b$a:Af.a.$f(h.Nc,"cui-toolbar-button-center");break;case Ug.a.dUb:Af.a.$f(h.Nc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.drc);}h.visible&&b.appendChild(h.Nc);h.noa()}}UO(b){if(!Object(uc.a)(Hk.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.drc){case Ug.a.lre:return"cui-toolbar-buttondock alignleft";case Ug.a.b$a:return"cui-toolbar-buttondock aligncenter";case Ug.a.dUb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.drc);}}get $A(){return!0}get alignment(){return this.drc}rac(){let b=0;if(this.alignment===Ug.a.b$a)for(let h of this.children){const r=h;r.visible&&(b+=r.Nc.offsetWidth)}else b=this.Nc.offsetWidth;return b}MUd(){let b=null;if(this.alignment===Ug.a.b$a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Nc);break}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.U1?b.x:b.x+b.width:0}TRd(){let b=null;if(this.alignment===Ug.a.b$a){if(0<this.children.count){const h=this.children.Rqf(this.children.count-1);for(;h.inb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Nc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.U1?b.x+b.width:b.x:0}jjf(){for(let b of this.children){const h=b;if(!Object(uc.a)(Hk.a,
h)||h.control.visible)h.visible=!0}}Gbo(b){const h=this.children.toArray(),r=new $p.a;let B=this.QTg?0:h.length-1;const P=this.children.count,ca=this.root.iVa;for(;this.rac()>=b&&!(B>=P||0>B);){const ra=h[B];ca&&Object(uc.a)(Hk.a,ra)&&ra.control.visible&&(r.add(ra),ra.Ruh());B+=this.QTg?1:-1}for(let ra of r)ra.Faj(),ra.visible=!1}set $A(b){super.$A=b}}Object(n.a)(Ks,"ButtonDock",Gf.a,[]);class ii extends Vj.a{constructor(b,h,r,B,P,ca,ra=!1){super(b,h,ca);this.Vsa=this.JZ=this.Cma=null;this.ALe=!1;
this.c5a=B;this.ble=P;this.Hzd=0;lf.c(h.Size)||(h.Size===Ug.a.Rug||r.options.YRm?this.Hzd=0:h.Size===Ug.a.XRj&&(this.Hzd=1));this.unk=ra}get iVa(){return!0}Bf(b){super.Bf(b);Object(uc.a)(Ks,b)&&!this.ALe&&(b.alignment===Ug.a.lre?(this.Cma&&this.weg(),this.Cma=b):b.alignment===Ug.a.b$a?(this.JZ&&this.weg(),this.JZ=b):b.alignment===Ug.a.dUb&&(this.Vsa&&this.weg(),this.Vsa=b))}weg(){this.ALe=!0;this.Vsa=this.JZ=this.Cma=null}Zpb(b,h){b=this.mQc(b);lf.c(b)||b.visible===h||(b.visible=h,this.refresh())}Hm(){super.Hm();
this.u9i(!0)}u9i(b){const h=this.root.YCb;lf.c(this.Nc)&&this.fgl();this.Nc=Af.a.XTa(this.Nc);this.ITc&&this.Nc.appendChild(this.ITc);for(let r of this.children)r.visible&&(r.RC(),this.Nc.appendChild(r.Nc),r.noa());this.JZ&&b&&this.Owl();h&&h.mZ();this.dirty=!1}Owl(){if(this.JZ.visible&&this.JZ.children.count&&(this.bvh(0,0),this.Tsl(this.Cma,this.JZ,this.Vsa))){let b=0,h=0;const r=this.Cma?this.Cma.rac():0,B=this.Vsa?this.Vsa.rac():0;if(0<B||0<r)B>r?(b=0,h=B-r):(b=r-B,h=0);this.bvh(b,h)}}Tsl(b,h,
r){let B=!1;0===this.root.U1?(b&&(B=b.TRd()>h.MUd()),!B&&r&&(B=h.TRd()>r.MUd())):(b&&(B=b.TRd()<h.MUd()),!B&&r&&(B=h.TRd()<r.MUd()));return B}bvh(b,h){0===this.U1?(this.JZ.Nc.style.marginLeft=b+"px",this.JZ.Nc.style.marginRight=h+"px"):(this.JZ.Nc.style.marginRight=b+"px",this.JZ.Nc.style.marginLeft=h+"px")}fgl(){this.RC()}yu(){this.xUh(()=>{Cs.a.prototype.yu.call(this)})}Rqa(b){b=this.mQc(b);lf.c(b)||this.xUh(Object(z.a)(b,b.Gm,"pollForStateAndUpdate"))}xUh(b){this.ugc=this.a6a=!1;b();if(this.a6a||
this.ugc)this.unk||this.refresh(),this.scale()}UO(b){if(!Object(uc.a)(qg,b)&&!Object(uc.a)(Ks,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(uc.a)(Ks,b)&&b.alignment===Ug.a.b$a)for(let h of this.children)if(h.alignment===Ug.a.b$a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.Hzd?(b+="cui-toolbar-onerow ",v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.D9||
(b+="UITextTranformUpperCase ")):1===this.Hzd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get awa(){return"div"}get A$(){return 26}get JAj(){return this.vO}set JAj(b){this.vO=b}p$k(b){b=b[Ug.a.Lw];return new Ks(this.root,b.Id,b)}RC(){super.RC();this.Nc.setAttribute("role","toolbar");this.properties.Title&&this.Nc.setAttribute("title",this.properties.Title)}cKa(b){return this.root&&this.root.rjc(b)?!0:!1}Bjo(){this.zUa()}scale(){super.scale();if(!Af.a.hs(this.properties.Scale)||this.ALe)return!1;
lf.c(this.Cma)||(this.Cma.visible=!0,this.Cma.jjf());lf.c(this.JZ)||(this.JZ.visible=!0,this.JZ.jjf());lf.c(this.Vsa)||(this.Vsa.visible=!0,this.Vsa.jjf());this.u9i(!1);const b=this.Nc.offsetWidth,h=lf.c(this.Cma)?0:this.Cma.rac(),r=lf.c(this.JZ)?0:this.JZ.rac(),B=lf.c(this.Vsa)?0:this.Vsa.rac();B+r+h>=b&&(B+h>=b?(this.Woi(this.JZ),B>=b?(this.Woi(this.Cma),this.zbg(this.Vsa,b)):this.zbg(this.Cma,b-B)):this.zbg(this.JZ,b-B-h));this.a6a=!1;this.Hm();return!1}Woi(b){b&&(b.visible=!1)}zbg(b,h){b&&b.Gbo(h)}}
Object(n.a)(ii,"Toolbar",Vj.a,[1061]);class Lu extends ii{constructor(b,h,r,B,P=!1){super(b,h,r,!1,!1,B,P);this.v5g=!0}get A$(){return 7}get cssClass(){return Lu.qEo+" "+super.cssClass}static get qEo(){let b="cui-statusbar";v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.D9||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(n.a)(Lu,"StatusBar",ii,[]);var du=c(486);class qv extends du.a{constructor(){super();this.toolbar=null;this.n1d=!1}}Object(n.a)(qv,"ToolbarBuildContext",du.a,
[]);class rv extends We.Builder{constructor(b,h,r,B){super(b,h,kk.Task.C4(r),B);if(lf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}Gfg(b){this.root=b}get wng(){return this.options}MPk(){const b=new qv,h=new Ri.a;h.id="toolbar";h.U5c=1;h.handler=Object(z.a)(this,this.dun,"onReturnToolbarData");h.data=b;this.Rva.Dfe(h)}dun(b){this.Gfg(this.OPk(b.n5c,b.dKc));this.toolbar.JAj=this;this.toolbar.Hm();this.placeholder.appendChild(this.toolbar.Nc);
Af.a.$f(this.placeholder,"loaded");this.bva.continueWith(()=>{this.bva.result.xMb(this.toolbar)},11)}OPk(b,h){var r=Ug.a.Pha(b,Ug.a.KSj);lf.c(r)&&(r=Ug.a.Pha(b,Ug.a.dSj),h.n1d=!0);if(lf.c(r))throw Error.create("No toolbar element was present in the data");b=new Ug.a(r);r=v.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.n1d?this.Gfg(new Lu(b.attributes[Ug.a.id],b.attributes,this,this.gba,r)):this.Gfg(new ii(b.attributes[Ug.a.id],b.attributes,this,this.wng.pEo,this.wng.ble,
this.gba,r));this.toolbar.kva=this.options.kva;this.toolbar.epe=!0;this.toolbar.Hm();b=Ug.a.xw(Ug.a.Pha(b.node,Ug.a.YOj));h=this.tNk(b,h);for(const B of h)this.toolbar.Bf(B);return this.toolbar}tNk(b,h){const r=[];for(let B=0;B<b.length;B++)this.MRa(b[B])||Array.add(r,this.VNk(b[B],h));return r}VNk(b,h){const r=Ug.a.BRc(b);let B=null;r===Ug.a.uNj?B=this.CNk(b,h):r===Ug.a.EPj&&(B=this.sOk(b,h));return B}sOk(b,h){var r=new Ug.a(b);r=new qg(this.root,r.attributes[Ug.a.id],b[Ug.a.Lw]);r.Roi=this.wng.Ibn;
b=Ug.a.Pha(b,Ug.a.Dsb);b=Ug.a.xw(b);const B=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];this.MRa(P)||(P=this.Jga(P,h),Array.add(B,P))}r.HTc=B;return r}CNk(b,h){new Ug.a(b);const r=this.toolbar.p$k(b);b=Ug.a.Pha(b,Ug.a.Dsb);b=Ug.a.xw(b);for(let B=0;B<b.length;B++){if(this.MRa(b[B]))continue;const P=this.NPk(b[B],h);r.Bf(P)}return r}NPk(b,h){var r=new Ug.a(b);const B=r.name;r=r.attributes[Ug.a.dqc];let P;P=h.n1d?"Small14":"Small";switch(B){case Ug.a.button:return b=this.Jga(b,h),b.bR(lf.b(r)?P:r);
case Ug.a.iFa:return P=h.n1d?"Medium14":"Medium",b=this.Jga(b,h),b.bR(lf.b(r)?P:r);case Ug.a.label:return b=this.Jga(b,h),b.bR(lf.b(r)?P:r);case Ug.a.separator:return b=this.Jga(b,h),b.bR("Small");case Ug.a.toggleButton:return b=this.Jga(b,h),b.bR(lf.b(r)?P:r);default:throw Error.create("Invalid control type.");}}}Object(n.a)(rv,"ToolbarBuilder",We.Builder,[]);var nz=c(1494);class Yv{constructor(b,h,r,B,P,ca){this.Jnb=()=>{this.toolbar.Gm()};this.CI=b;b=new Sp.CuiHelper(Ad.a.d0a,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);B=new bj;B.iH={};ca=3!==ca.mode;B.iH.HeaderToolbarControlsRight=ca;B.iH.HeaderToolbarButtonDockRight=ca;B.iH.HeaderToolbarButtonRemovePageNumbers=ca;P=new rv(B,this.CI,this,P);P.Rva=new nz.a(Yv.wum,b);P.MPk();this.Mma=P.toolbar;r.execute(ra=>{this.toolbar.IF=ra});this.toolbar.refresh();this.toolbar.Gm();this.Mh=h;h.I_a(this.Jnb)}get toolbar(){return this.Mma}dispose(){this.Mh.Gjc(this.Jnb);this.toolbar&&(this.toolbar.dispose(),this.Mma=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.Bjo()}Wpl(){this.toolbar.q4()}xMb(){}}
Yv.wum="WordEditorHeaderToolbarData";Object(n.a)(Yv,"HeaderFooterToolbar",null,[221,449]);class oz{constructor(b,h,r,B,P){this.Mh=b;this.Uxe=h;this.rd=r;this.gba=B;this.ga=P}create(b){return new Yv(b,this.Mh,this.Uxe,this.rd,this.gba,this.ga)}}Object(n.a)(oz,"Factory",null,[439]);class xx{constructor(b,h){this.Yc=b;this.Yk=h}Yel(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.Xel(b)+
"</Controls></MenuSection></Menu>"}q_l(b){const h=this.Yc.Dk();h.set(b);h.zb(8);h.jd(8);return h}Xel(b){if(!b)return"";let h="";b=this.q_l(b);this.Yk.RPa(b,r=>{const B=this.Yk.Rki(r);r=r.getValue(Oc.a.Xja);h+=Gi.k(r.toString(),r.toString(),V.a.cdg.toString(),V.a.p4f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,B));return!0});return h}}Object(n.a)(xx,"HeaderFooterToolbarGenerator",null,[438]);var oy=c(126);class pz extends nv.a{constructor(b,h,r,B,P,ca,
ra,Qa){super(b,h,r,B);this.mt=()=>{this.Idd(this.Cb)};this.CI=b.container;this.dw=document.createElement("div");this.cH(this.dw);this.tCa=P;this.RLa=ca;this.Go.execute(mb=>{mb.hZ(this.mt)});this.IK=ra;if(this.NI=Qa)this.CI.style.backgroundColor=this.IK.C$b()}dispose(){super.dispose();this.Go.instance&&this.Go.instance.ZTa(this.mt)}get Go(){return null!=this.$Ag?this.$Ag:this.$Ag=Ya.a.instance.Sa("Common.IZoomManager")}pC(b){this.CI.classList.add("HeaderFooterViewElement");this.dw.classList.add("HeaderFooterViewContent");
this.Idd(b.currentNode)}r6(b){this.dw.parentNode&&this.dw.parentNode===this.CI||(this.CI.appendChild(this.dw),this.RLa.instance&&this.RLa.instance.Kfg(this.mc,this.CI));super.r6(b)}VSb(b){oy.a.ie(()=>{oy.a.prototype.VSb.call(this,b);this.RFj();this.RLa.instance&&this.RLa.instance.WEj(this.mc,this.dw.style.paddingLeft,this.dw.style.paddingTop)},"HFVE:UFO")}Idd(b){this.Go.instance&&this.Go.instance.pfd(this.dw);this.RFj();b=this.tCa.Y$b(b);this.dw.style.paddingLeft=b.G5b+"px";this.dw.style.width=b.cKc+
"px";this.RLa.instance&&this.RLa.instance.WEj(this.mc,this.dw.style.paddingLeft,this.dw.style.paddingTop)}RFj(){if(this.Go.instance){this.dw.style.paddingTop="";var b=vl.a.BB(this.dw);b.paddingTop&&(b=Kb.a.jN(b.paddingTop),this.dw.style.paddingTop=Math.round(b/this.Go.instance.oj)+"px")}}}Object(n.a)(pz,"HeaderFooterViewElement",nv.a,[]);class dA{constructor(b,h,r,B){this.tCa=b;this.RLa=h;this.IK=r;this.NI=B}create(b,h,r,B){return new pz(b,h,r,B,this.tCa,this.RLa,this.IK,this.NI)}}Object(n.a)(dA,
"Factory",null,[437]);var qz=c(353),Yr=c(198),ui=c(985),Mu=c(588);class py extends qz.a{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d){super(h,ca,ra,Qa,mb,Yr.a.Vpi,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d);this.isHeader=this.isHeader=b;this.uZa=P;this.uZa.Qbd=this;B(this);this.ljd=r;this.xBa=document.createElement("div");this.xBa.setAttribute("Unselectable","on");this.xBa.setAttribute("hideselection","hideselection");this.xBa.setAttribute("style","outline:none;");this.xBa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.xBa.tabIndex=0;this.features.Krj=!0;this.features.b7e=!0}get SFf(){return!0}Nwf(){const b=this.ljd.Nnf(this);return ui.ViewReference.mF(this,b)}lgf(b){Object(uc.a)(py,b)||this.ljd.dismiss()}get Rzf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}bSc(){return Mu.a.SPi}onResize(){super.onResize();this.uZa.eYh()}YE(b,h=null){this.xBa.parentNode&&this.xBa.parentNode.removeChild(this.xBa);super.YE(b,h);this.uZa.SXh(this.ed.yj)}detach(){this.uZa.dYh();super.detach();this.xBa.parentNode||
this.container.insertBefore(this.xBa,this.container.firstChild)}c$c(){this.ov?super.c$c():this.xBa.focus()}TPd(){this.onResize()}}Object(n.a)(py,"HeaderFooterView",qz.a,[448,123,124,113,10,125,126,127,128]);class eu{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id){this.ljd=b;this.jpk=h;this.ipk=r;this.hu=B;this.ld=P;this.Nma=ca;this.ga=ra;this.VXa=Qa;this.oua=mb;this.I7=Jb;this.Ppk=Yb;this.$t=fc;this.dB=Mc;this.Qf=Wc;this.Nh=id;this.ejd=Id}create(b,h){return new py(b,h,this.ljd,this.jpk,this.ipk(),
this.hu,this.ld,this.Nma,this.ga,this.VXa,this.oua,this.I7,this.Ppk,this.$t,this.dB,this.Qf,this.Nh,this.ejd)}}Object(n.a)(eu,"Factory",null,[436]);class qy{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d){this.Bah=!1;this.Ghh="SourceControlId";this.ZKo=1;this.$Ko=1E3;this.Tbe=(be,he,re,Xf,Mg)=>{if(1===re)return 32;this.Smd(Mg[this.Ghh]);Mg[Ui.a.Text]=this.WNe.Wzn(this.cdb.wIb);return 32};this.BMn=(be,he,re,Xf,Mg)=>{if(1===re)return 32;Mg[Df.a.On]=this.cdb.wIb;return 32};this.Lym=(be,
he,re,Xf,Mg)=>{if(1===re)return 32;this.cdb.SXo(Mg[Df.a.On]);return 32};this.cbj=(be,he,re)=>{if(1===re)return 32;if(this.Caa){he=qy.hi.uu(he.view.ed);re=xd.GraphIterator.eb(he);const Xf=this.Vd.Z_a();try{const Mg=this.Lc.Pc(15);try{Mg.Db(he),Mg.Uj=be,Kn.a.instance.RPa(re,$l=>{this.ZZb.$6c($l,this.dVl,this.Oko);return!0})}finally{Mg&&Mg.dispose()}}finally{Xf&&Xf.dispose()}}return 32};this.r4c=(be,he,re,Xf,Mg)=>{if(1===re)return 32;Mg.MenuItems=this.$ek.value;this.Bah?this.cdb.X6n():this.Bah=!0;return 32};
this.bFm=(be,he,re,Xf,Mg)=>{if(1===re)return 32;const $l=this.Smd(Mg[this.Ghh]);if(this.Caa){he=qy.hi.uu(he.view.ed);re=xd.GraphIterator.eb(he);Xf=this.Lc.Pc(15);try{Xf.Db(he);Xf.Uj=be;let Nm=null;const zp=this.je.Yf("UserAction","InsertPageNumber");Kn.a.instance.RPa(re,vv=>{this.Caa.gca||this.y2j(vv);Nm=this.VNe.$Em(vv,$l,this.cdb.wIb)||Nm;return!0});zp.stop();if(!Nm)return 8;this.Hxo(Nm,$l)}finally{Xf&&Xf.dispose()}this.Vd.Zs(12)}return 32};this.Vzn=()=>32;this.pyo=(be,he,re,Xf,Mg)=>{if(1===re)return 32;
2===re&&this.YMa.showCallout(Mg);return 32};this.oyo=(be,he,re,Xf,Mg,$l)=>this.pTe.create(be,he,re,Xf,Mg,$l);this.Zpl=(be,he,re)=>{if(1===re)return 32;this.YMa.GTh();return 32};this.zwo=be=>{v.AFrameworkApplication.va.Tqa(null,V.a.otj,be.customData,null)};this.dVl=be=>{const he=lh.a.instance.ib.lb;let re=-1;for(const Xf of he)if(Xf.node===be){re=Xf.cpBegin;break}return{returnValue:re,Y_d:Pd.SelectionEditor.Pl(he)}};this.Oko=(be,he)=>{be=Fe.SelectionFactory.ne(be,he);lh.a.instance.Ac(be)};this.ga=
b;this.Lc=h;this.Ib=r;this.cdb=B;this.Caa=P;this.lm=ca;this.WNe=ra;this.VNe=Qa;this.ZZb=mb;this.YMa=Jb;this.hb=Yb;this.pTe=fc;this.je=Mc;this.Vd=Wc;this.Smd=id;this.y2j=$d;this.$ek=new zf.a(()=>this.cdb.V8l())}Ub(){this.ga.fb(V.a.r4c,zc.a.view,this.r4c,100);this.ga.fb(V.a.r0i,zc.a.view,this.Vzn,68);this.ga.fb(V.a.rti,zc.a.view,this.bFm,4);this.ga.fb(V.a.wIb,zc.a.view,this.Lym,4);this.ga.fb(V.a.$6c,zc.a.view,this.cbj,4);this.ga.fb(V.a.Y0n,zc.a.view,this.cbj,4);this.ga.fb(V.a.R4f,zc.a.application,this.BMn,
97);this.ga.fb(V.a.Tbe,zc.a.application,this.Tbe,97);this.ga.fb(V.a.ntj,zc.a.view,this.pyo,4);this.ga.KT(V.a.otj,zc.a.view,this.oyo,100);this.ga.fb(V.a.Ypl,zc.a.view,this.Zpl,4)}Hxo(b,h){const r=b.Lb.paragraph;if(r){var B=this.lm.l1c(r);B&&this.Caa.rha(B)}B=this.Caa.gca;this.Caa.show(4>h);r&&this.dko(r)&&(this.moo(b,r),this.bwk(b,B))}dko(b){let h;if(!({isHeader:h,kmg:b}=this.lm.jji(b)).returnValue)return!1;this.Caa.Hza(b,h);return!0}moo(b,h){b=Fe.SelectionFactory.ne(h,b.Lb.cp);this.hb.Ac(b)}bwk(b,
h){h=new Oe.a(2,1,h?this.ZKo:this.$Ko,this.zwo);h.customData=b;this.Ib.Wb(h)}static get hi(){return ro.PageNavigator.instance}}Object(n.a)(qy,"PageNumbersActor",null,[447]);class eA{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){this.ga=b;this.Ib=h;this.cdb=r;this.WNe=B;this.VNe=P;this.ZZb=ca;this.YMa=ra;this.pTe=Qa;this.lm=mb;this.Vd=Jb;this.Smd=Yb;this.sok=fc;this.lga=Mc}create(b,h){return new qy(this.ga,new kl.a,this.Ib,this.cdb,b,this.lm,this.WNe,this.VNe,this.ZZb,this.YMa,lh.a.instance,this.pTe,
ab.StaticActiveAppFrame.za().Kq,this.Vd,this.Smd,this.sok,this.lga,h)}}Object(n.a)(eA,"Factory",null,[434]);var cB=c(1993),yx;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(yx||(yx={}));Object(n.b)("ModalCalloutSize",yx);var fu;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=
6]="bottomRight"})(fu||(fu={}));Object(n.b)("BeakLocation",fu);class rz{constructor(b,h,r){this.YKo=1;this.rQe=!1;this.j0b=null;this.zWn=()=>{this.hb.Xw(this.Uqa);this.rQe=!0;this.j0b=null};this.Uqa=(B,P)=>{if(B=P.yl.lb)1<B.length||!B.length?B=!0:(B=B.Pa,B=B.cpEnd-B.cpBegin,B=1<B||!B),B&&this.v1j()};this.Ib=b;this.hb=h;this.v1j=r}Qz(){this.awk()}caa(){this.rQe?(this.hb.jZ(this.Uqa),this.rQe=!1):this.j0b&&(this.Ib.ff(this.j0b),this.j0b=null)}awk(){this.j0b=new Oe.a(2,1,this.YKo,this.zWn);this.Ib.Wb(this.j0b)}}
Object(n.a)(rz,"CalloutDismissManager",null,[]);class gu{constructor(b,h,r,B){this.dismiss=()=>{this.cI&&(this.suc.caa(),this.Y0c.dismiss())};this.Y0c=b;this.Xo=B;this.suc=new rz(h,r,this.dismiss)}get cI(){return this.Y0c.cI}show(){if(!this.cI){const b=document.createElement("div");b.classList.add(gu.Uzn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.Y0c.content=b;this.Y0c.show();this.Xo&&this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,
!0);this.suc.Qz()}}dispose(){this.dismiss();this.Y0c.dispose()}static Scl(b,h){h=cB.a.fNh(Qd.a.getElementBounds(b.targetElement),h,ab.StaticActiveAppFrame.za().RF,yx.small);h.Ega=gu.gpf(b);h.Kt=!1;return h}static gpf(b){let h=fu.bottomCenter;Object(uc.a)(448,b.view)&&b.view.isHeader&&(h=fu.topCenter);return h}}gu.Uzn="PageNumbersCalloutControl";Object(n.a)(gu,"PageNumbersCallOutControl",null,[446]);class fA{constructor(b,h,r){this.rT=null;this.jT=!1;this.dismiss=()=>{this.cI&&this.rT&&Ik.UISurfaces.MM().then(B=>
{this.suc.caa();B.removeNotification(this.rT);this.jT=!1;return null},B=>{t.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})};this.El=b;this.suc=new rz(h,r,this.dismiss)}get cI(){return this.jT}show(){this.cI||Ik.UISurfaces.MM().then(b=>{const h=b.callout(Object.assign(new wo.a,{target:this.El,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new ec.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.jT=!0},expirationOptions:Object.assign(new Hc.a,
{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.rT=b.addNotification(h,r);this.suc.Qz();return null},b=>{t.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(n.a)(fA,"ReactPageNumbersCallOutControl",null,[446]);class dB{constructor(b,h,r){this.hb=h;this.Ib=b;this.Xo=r}create(b,h){if(v.AFrameworkApplication.ta.Kb&&v.AFrameworkApplication.ta.Kb.TRa)return new fA(h.targetElement,this.Ib,this.hb);b=gu.Scl(h,b);return new gu(b,this.Ib,this.hb,
this.Xo,v.AFrameworkApplication.ta.aQ)}}Object(n.a)(dB,"Factory",null,[435]);class sz{constructor(b,h){this.yE=null;this.Zek=b;this.Yi=h}get control(){return this.yE}showCallout(b){this.control&&this.control.cI&&this.control.dismiss();this.yE=this.rHn(b);this.control.show()}GTh(){this.control&&(this.control.dismiss(),this.yE=null)}rHn(b){const h=this.Yi.Eoa();this.yE=this.Zek.value.create(h,b);return this.control}}Object(n.a)(sz,"PageNumbersCalloutControlManager",null,[432]);var ry=c(771);class Zv extends ov.a{constructor(){super();
this.Text=null}get Type(){return 7}}Object(n.a)(Zv,"PageNumberGalleryButtonProps",ov.a,[]);const hu=(b,h,r)=>{b=b.Dk();b.set(r);h.TLb(b);return b};class Zr{constructor(b,h,r){this.dFe=!1;this.lga=h;this.nm=r}get wIb(){return this.dFe}V8l(){const b=Object.assign(new dh.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.Jtk());b.MenuSectionList.push(this.yuk());b.MenuSectionList.push(this.avk());return b}SXo(b){this.dFe=b;this.s9i()}X6n(){this.dFe=!1;const b={};b[Zr.jri]=
"CheckboxModel";this.lga(b);this.s9i()}Jtk(){const b=Object.assign(new Nf.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:E.a.zf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new ry.a,{Id:Zr.Mym,Command:V.a.wIb.toString(),QueryCommand:V.a.R4f.toString(),LabelText:E.a.zf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:E.a.zf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),
KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}yuk(){const b=Object.assign(new Nf.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Jg.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.nm){for(var r=3;1<=r;r--)h.GalleryItems.push(this.yrf(r));for(r=6;4<=
r;r--)h.GalleryItems.push(this.yrf(r))}else for(r=1;6>=r;r++)h.GalleryItems.push(this.yrf(r));b.ControlList.push(h);return b}avk(){const b=Object.assign(new Nf.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new ei.a,{Id:"btnRemovePageNumber",Command:V.a.$6c.toString(),LabelText:E.a.zf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:E.a.zf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:v.AFrameworkApplication.Ms,
Image16by16Class:ie.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}yrf(b){const h=Zr.D_f+b.toString();var r=Object,B=r.assign,P=new Zv,ca=V.a.rti.toString(),ra=V.a.Tbe.toString(),Qa=E.a,mb=Qa.zf;let Jb="";switch(b){case 1:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;
break;case 4:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return B.call(r,P,{Id:h,Command:ca,QueryCommand:ra,Alt:mb.call(Qa,Jb)})}s9i(){const b={};for(let h=1;6>=h;h++)b[Zr.D_f+h.toString()]="PageNumberGalleryButtonModel";b[Zr.jri]="CheckboxModel";this.lga(b)}static W8l(b){return b?parseInt(b.substr(Zr.D_f.length)):1}}Zr.Mym=
"btnIncludePageCount";Zr.jri="IncludePageCount";Zr.D_f="btnPageNumbersPosition";Object(n.a)(Zr,"PageNumbersControl",null,[433]);class Ls{constructor(b,h,r,B,P=null,ca=null,ra=null,Qa=null){this.S_l=(mb,Jb)=>{const Yb=new Hh.a;mb=4>mb;switch(Jb){case 1:case 2:Yb.add(mb?0:3);break;case 3:case 4:Yb.add(mb?0:3),Yb.add(mb?1:4)}return Yb};this.ITl=(mb,Jb,Yb)=>{var fc=hu(this.Yc,this.lm,mb);this.lm.ULb(fc,Yb);let Mc=this.N_j(fc,Jb);if(Mc)this.ZZb.Fbj(Mc);else{fc=hu(this.Yc,this.lm,mb);this.lm.ULb(fc,Yb);
fc.Rd();if(Zf.OutlineElementReader.yh(fc)&&(hg.OutlineElementNavigator.Ee(fc),Td.ParagraphReader.oh(fc))){fc=fc.currentNode;const Wc=this.oji(Jb);Td.ParagraphReader.Ox(fc)===Wc&&this.ZZb.Fbj(fc)&&(Mc=fc)}Mc||(fc=hu(this.Yc,this.lm,mb),this.lm.ULb(fc,Yb),this.CL.Pkb(fc,null,!0),Mc=hg.OutlineElementNavigator.Ee(fc),this.pE(Jb,Mc))}return Mc};this.JTl=(mb,Jb)=>{let Yb=null;mb.Tb(1);if(Zf.OutlineElementReader.yh(mb)&&(mb.Tb(2),mi.TableReader.isTable(mb))){var fc=mb.currentNode;if(3===mi.TableReader.hh(fc)){let Mc=
0;fc=mi.TableReader.Pn(fc);switch(Jb){case 1:case 4:Mc=fc?2:0;break;case 2:case 5:Mc=1;break;case 3:case 6:Mc=fc?0:2}Qg.moveToCellContent(mb,0,Mc);mb.currentNode&&Zf.OutlineElementReader.yh(mb)&&(mb=hg.OutlineElementNavigator.Ee(mb),Td.ParagraphReader.Xb(mb)&&(Yb=mb))}}return Yb};this.COm=(mb,Jb)=>{const Yb=hu(this.Yc,this.lm,mb);mb=Yb.currentNode.ja(Oc.a.Xja,0);this.lm.ULb(Yb,Jb);Jb=Yb.currentNode.ja(Oc.a.Xja,0);return mb===Jb};this.Yc=b;this.afk=h;this.ZZb=r;this.lm=B;this.qwc=P||this.S_l;this.O_j=
ca||this.ITl;this.N_j=ra||this.JTl;this.a9j=Qa||this.COm}get CL(){return null!=this.hFg?this.hFg:this.hFg=Ya.a.instance.resolve("Box4.IOutlineEditor")}$Em(b,h,r){var B=hu(this.Yc,this.lm,b).Gn;B=this.lm.$ha(B);B=this.qwc(h,B);let P=null;for(let ra=0;ra<B.length;ra++){var ca=B.eg(ra);this.a9j(b,ca)&&(ca=this.O_j(b,h,ca),P=this.afk.xuk(ca,r)||P)}return P}pE(b,h){Ls.d6.h$c(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);Ls.Sk.pE(h,this.oji(b))}oji(b){let h=1;switch(b){case 1:case 4:h=
1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get Sk(){return null!=Ls.dGg?Ls.dGg:Ls.dGg=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get d6(){return null!=Ls.BHg?Ls.BHg:Ls.BHg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(n.a)(Ls,"PageNumbersInserter",null,[429]);var Jq=c(894),gA=c(902);class $r{constructor(b,h,r=null,B=null,P=null){this.K9k=(ca,ra)=>{ca=Se.a.Uc(ca,Td.ParagraphReader.textLength(ca));const Qa=ca.node.Mc;return Qa?$r.jg.kia(ca,mb=>{mb=gA.a.getInstance(mb);
this.qJd(mb,15,Qa,ra);this.qJd(mb,47,Qa,ra);this.qJd(mb,16,Qa);this.qJd(mb,17,Qa);return mb}):null};this.EFm=(ca,ra)=>{ca=Se.a.Uc(ca,Td.ParagraphReader.textLength(ca));$r.jg.Ge(ca,ra)};this.Lc=b;this.Gtd=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Pxe=B||this.K9k;this.tjh=P||this.EFm}xuk(b,h){const r=this.Lc.Pc(15);r.Db(b);var B=Td.ParagraphReader.text(b),P=!1;0<B.length&&" "!==B.charAt(B.length-1)&&(P=!0);if(h){h=String.format(this.Gtd,"#","$");P&&(h=" "+h);P=
h.indexOf("#");B=h.indexOf("$");t.ULS.shipAssertTag(4256717,309,-1!==P,"{0}",{["PageNumberIndex"]:P});t.ULS.shipAssertTag(4256718,309,-1!==B,"{0}",{["PageCountIndex"]:B});t.ULS.shipAssertTag(4256719,309,P!==B,"{0}",{["PageNumberIndex"]:P,["PageCountIndex"]:B});let Qa;let mb;if(P<B){var ca=P;Qa=B;var ra=Jq.a.EQc(0);mb=Jq.a.EQc(1)}else ca=B,Qa=P,ra=Jq.a.EQc(1),mb=Jq.a.EQc(0);this.VCf(b,h,0,ca);ra=this.Pxe(b,ra);this.VCf(b,h,ca+1,Qa);ca=this.Pxe(b,mb);this.VCf(b,h,Qa+1,h.length);b=P<B?ra:ca}else P&&
this.tjh(b," "),b=this.Pxe(b,Jq.a.EQc(0));r.dispose();return b}qJd(b,h,r,B=null){const P=new Qz.a;P.setValue(Pe.a.Z$,!0);P.setValue(Oc.a.bFb,1);P.setValue(Oc.a.Ns,h);switch(h){case 15:P.setValue(Oc.a.YRa,!0);P.setValue(Oc.a.XX,B);break;case 47:P.setValue(Oc.a.XX,B);break;case 17:P.setValue(Oc.a.fKb,!0)}h=r.Xu(P,U.a.create());this.uvk(b,h)}uvk(b,h){b.Jua(h,U.a.nil,ni.AParagraphNode.QC,null)}VCf(b,h,r,B){h=h.substring(r,B);0<h.length&&this.tjh(b,h)}static get jg(){return $r.Md||($r.Md=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set jg(b){$r.Md=
b}}$r.Md=null;Object(n.a)($r,"PageNumbersNodeLevelInserter",null,[431]);class Ow{Wzn(b){return Ow.ram(b)}static ram(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Ow.h0i,Ow.h0i)}}Ow.h0i="1";Object(n.a)(Ow,"PageNumbersPositionPreviewGenerator",null,[430]);class Ms{constructor(){this.jQg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.g_j=this.jQg.length}Htm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===Td.ParagraphReader.textLength(b)?{returnValue:!0,u4c:h}:{returnValue:!1,u4c:-1}}osm(b){let h=b.characterData.lastIndexOf(this.jQg);return-1!==h&&h+this.g_j===Td.ParagraphReader.textLength(b)?{returnValue:!0,u4c:h}:{returnValue:!1,u4c:-1}}ftm(b){return xo.a(b,9)?!0:!1}}Object(n.a)(Ms,"PageNumbersReader",null,[427]);class zx{constructor(b,h,r,B,P,ca=null,ra=null){this.X0n=(Qa,mb,Jb,Yb)=>{Qa=hu(this.Yc,this.lm,
Qa);this.lm.ULb(Qa,mb);mb=ao.a.Qp(Qa);for(Qa=!1;mb.moveNext();){const fc=mb.currentNode;if(Td.ParagraphReader.Xb(mb.currentNode)&&xo.a(mb.currentNode,9)){Qa=!0;let Mc;const Wc=({Y_d:Mc}=Jb(fc,Mc)).returnValue;let id=Wc;id=this.z_n(fc,id);id=this.s1n(fc,id);-1<Wc&&(id===Wc&&Mc||Yb(fc,id))}}Qa&&this.Vd.Zs(12)};this.Yc=b;this.lm=h;this.XNe=r;this.Vd=B;this.pCc=P;this.qwc=ca||ny.a.vff;this.qhk=ra||this.X0n;this.Gtd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.UWg=String.format(this.Gtd,
"#","$");this.r7j=this.UWg.indexOf("#");this.q7j=this.UWg.indexOf("$");this.lCe=String.format(this.Gtd,"\ufffc","\ufffc");this.NWg=this.lCe.length}$6c(b,h,r){var B=hu(this.Yc,this.lm,b).Gn;B=this.lm.$ha(B);B=this.qwc(B);for(const P of B)this.qhk(b,P,h,r)}Fbj(b){if(this.XNe.ftm(b)){let h=-1;if(({u4c:h}=this.XNe.osm(b)).returnValue&&this.GDh(b,h)||({u4c:h}=this.XNe.Htm(b)).returnValue&&this.LVk(b,h))return!0}return!1}s1n(b,h){var r=b.ra.length;for(let P=0;P<r;P++){var B=b.ra.J(P);B.blob&&9===B.blob.vh&&
(B=B.cp,r=Se.a.createTextRange(b,B,B+1),this.pCc(r,""),r=b.ra.length,P--,h=this.vsh(h,B,1))}return h}z_n(b,h){let r=b.characterData.indexOf(this.lCe);for(;-1!==r;)this.GDh(b,r)&&(h=this.vsh(h,r,this.NWg)),r=b.characterData.indexOf(this.lCe);return h}LVk(b,h){const r=b.ra.nh(h);return r&&r.blob&&9===r.blob.vh?(b=Se.a.createTextRange(b,h,h+1),this.pCc(b,""),!0):!1}GDh(b,h){const r=b.ra.nh(h+this.r7j),B=b.ra.nh(h+this.q7j);return r&&r.blob&&9===r.blob.vh&&B&&B.blob&&9===B.blob.vh?(b=Se.a.createTextRange(b,
h,h+this.NWg),this.pCc(b,""),!0):!1}vsh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(n.a)(zx,"PageNumbersRemover",null,[366]);class Ax{constructor(b,h){this.ftb=this.etb=null;this.Mr=b;this.Ib=h}SCk(){this.Mr.style.display="";this.etb||(this.ftb&&(this.Ib.ff(this.ftb),this.ftb=null),this.etb=new Oe.a(0,1,10,()=>{this.Mr.classList.add("Displayed");this.etb=null}),this.Ib.Wb(this.etb))}UCk(){this.Mr.classList.remove("Displayed");this.ftb||(this.etb&&(this.Ib.ff(this.etb),this.etb=null),
this.ftb=new Oe.a(0,1,200,()=>{this.Mr.style.display="none";this.ftb=null}),this.Ib.Wb(this.ftb))}}Object(n.a)(Ax,"PaneControlAnimationHelper",null,[393]);class ss{constructor(b){this.Ib=b}a9l(b){return new Ax(b,this.Ib)}}Object(n.a)(ss,"PaneControlAnimationHelperFactory",null,[365]);class sy{constructor(b,h,r,B,P,ca,ra,Qa,mb=!1){this.eLg=this.Mma=this.qnd=null;this.oum=()=>{this.Hv.sendNotification(this.eLg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.P6=h;this.P6.bind(this);this.tGe=r;this.Tta=P;this.wWe=ra;this.Vb=Qa;this.Pod=mb;this.ufa=ca.value.create(r,B);this.P6.dLk(this.ufa);this.$Z=Tb.KeyInputManager.ic(kc.a.l2,0)}get Hv(){return null!=this.Jwg?this.Jwg:this.Jwg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}F1(b){this.P6.F1(b);this.Mma&&!b&&this.Mma.Wpl()}rha(b){this.qnd!==b&&(this.phb(),this.qnd=b)}Akj(b){if(this.qnd){var h=this.Tta.N2a(this.qnd,ny.a.R_l(b,this.tGe));this.Pod?(this.eLg=this.U4h(b,this.tGe),this.ufa.nQb(qf.a.UDd)):
this.uUo(b);h&&this.N3e(h)}}Cwh(b){this.Pod&&this.Vb&&(b=this.Vb.fe(b))&&b.S3(this.oum)}U4h(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}uUo(b){this.ufa.Nlj(this.U4h(b,this.tGe),qf.a.UDd)}setInitialSelection(){this.ufa.c$c()}N3e(b){this.phb();this.ufa.YE(b,b.yj)}phb(){this.ufa.detach()}egl(){this.Mma=
this.wWe.value.create(this.P6.doc);this.lro(this.Mma)}lro(b){if(this.Vb){const h=this.Vb.fe(C.a.E3a);h.parent=Zd.AFrame.Ap;h.sga(()=>{b.setFocus();this.wpo()});h.bindAction(this.$Z,V.a.kU)}}wpo(){if(this.Vb){var b=this.Vb.fe(C.a.E3a);const h=new le.DOMFocusListing(()=>this.P6.doc);h.Lja=!0;h.Qm(1);this.Vb.Qfb(this.P6.doc,b,h);b=this.Vb.getRegion(C.a.E3a);b.TTa();b.yP=!0;h.zha&&h.iz(h.zha)}}dispose(){void 0!==this.Mma&&null!==this.Mma&&(this.Vb.fe(C.a.E3a).mr(this.$Z),this.Mma.dispose())}aVn(){void 0!==
this.Mma&&null!==this.Mma&&this.Mma.refresh()}}Object(n.a)(sy,"PaneControl",null,[392]);class ty{constructor(b,h,r,B){this.lm=b;this.d6j=h;this.wWe=r;this.Vb=B}create(b,h,r,B){return new sy(b,h,r,B,this.lm,this.d6j,this.wWe,this.Vb,v.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(n.a)(ty,"Factory",null,[364]);var ot=c(1121);class wq extends Lv.a{constructor(b,h,r,B,P,ca,ra,Qa,mb){super();this.init(b);this.Rl("ShowCalloutForPageNumberOperation");this.kVj=Qa;
this.Jkb(this.kVj,h,B,P,ca);this.oz=0;this.bdb=ca;this.YMa=ra;this.Mh=mb;1===this.behavior&&(this.sr=32,this.vra())}get owl(){if(null!=this.Qyg)var b=this.Qyg;else{var h;b=this.Qyg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.Mh.jb.ju;if(!this.oz){var h=Di.a.c$b(this.bdb,b);this.bdb.uTc(b,h)?this.bdb.Uwa(b,h).element&&(this.oz=1):this.owl&&(this.oz=2)}1===this.oz&&(h=Di.a.c$b(this.bdb,
b),h=this.bdb.Uwa(b,h),b=new ot.a(h.element,b),this.YMa.showCallout(b),this.oz=2);2===this.oz&&(this.sr=32,this.vra())}}Object(n.a)(wq,"ShowCalloutForPageNumberOperation",Lv.a,[]);class $v{constructor(b,h,r){this.YMa=b;this.ga=h;this.uUb=r}create(b,h,r,B,P,ca){return new wq(b,h,r,B,P,ca,this.YMa,this.ga,this.uUb)}}Object(n.a)($v,"Factory",null,[363]);class Pw{get CL(){return null!=this.fFg?this.fFg:this.fFg=Ya.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",
()=>new Ed(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ve("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new eu(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),
wx.a.r$e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),ab.StaticActiveAppFrame.za().jb,Hb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Sa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Sa("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),
b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new dA(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!qe.App.instance&&qe.App.instance.cD)).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",
()=>new oz(Jk.App.pn,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Jk.App.pn,v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new ty(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),kb.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new Nw(()=>{ab.StaticActiveAppFrame.za().updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),v.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new eA(v.AFrameworkApplication.va,Rg.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),
b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Zr.W8l,Object(z.a)(ab.StaticActiveAppFrame.za(),
ab.StaticActiveAppFrame.za().Ydd,"updateRibbonControl"),Object(z.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().lH,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new cA).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new ss(Rg.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new jb(kb.FocusManager.instance(),ab.StaticActiveAppFrame.za().xx,
b.Ve("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ve("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),v.AFrameworkApplication.va,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc),v.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new Vc(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
Qh.PageReader.instance,new Tl.a,Kn.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new xx(new Tl.a,Kn.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",()=>new bA(v.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Kn.a.instance,new Tl.a,new kl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),
bA.Qki,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Cc(Ku.a.instance,Cc.fhm(b.resolve("Box4.ITableEditor")),Cc.mRl(),v.AFrameworkApplication.isRtl,hg.OutlineElementNavigator.Yd,Cc.Yem(),Cc.G_l(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new Wb.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Tl.a,h=>this.CL.Pkb(h,
null,Wb.a.Agg),v.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").CQb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),b.resolve("Box4.Styles.IWACStyleEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Ke(Kn.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();
b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new aC(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Tl.a,new kl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new Mp(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Kn.a.instance,new Tl.a,v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",
()=>new Zr(Object(z.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().Ydd,"updateRibbonControl"),Object(z.a)(ab.StaticActiveAppFrame.za(),ab.StaticActiveAppFrame.za().lH,"updateRibbonControls"),v.AFrameworkApplication.isRtl)).ha();b.register(Ow,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new $r(new kl.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new Ls(new Tl.a,
b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",()=>new Ms).ha();b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new zx(new Tl.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(Pw.jg,
Pw.jg.Ge,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new sz(b.Ve("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),ab.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new dB(Rg.a.instance,lh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",
()=>new $v(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),v.AFrameworkApplication.va,ab.StaticActiveAppFrame.za())).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new $B(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",
()=>new mz(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get jg(){return null!=Pw.mxg?Pw.mxg:Pw.mxg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(n.a)(Pw,"HeaderFooterComponentConfiguration",null,[2]);class aw{constructor(){this.tnd=this.W=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.W=b;(new Pw).wc(b)}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{this.xn()})}xn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(112)&&(this.tnd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.tnd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.tnd&&this.tnd.dispose()}static main(){L.a.instance.Gc(new aw)}}Object(n.a)(aw,"PackageManager",null,[1,2]);var hA=c(330),bi=c(499);class Qw{constructor(b,h){this.Qf=b;this.jm=h}create(){return new bi.a(this.Qf.instance,this.jm.instance)}}Object(n.a)(Qw,
"ContentControlNodeFactory",null,[380]);var eB=c(1720),mp=c(386),tz=c(1080);class uy{create(){return new tz.a}}Object(n.a)(uy,"ContentControlContainerNodeFactory",null,[380]);var as=c(200),fB=c(392),uz=c(247),vz=c(1136);const wz=b=>b?(b=b.ja(Oc.a.ZOa,null))&&b.includes(as.a.UQh):!1;class gB{constructor(b,h,r,B,P,ca,ra){this.Yoa=b;this.Pf=h;this.jg=r;this.Uga=B;this.Hea=P;this.rn=ca;this.i6k=ra;this.amn=(Qa,mb)=>{wn.a.oda&&(Qa=mb.node,mb=xd.GraphIterator.eb(Qa),mb.zb(7)&&(mb=mb.jd(54)))&&(mb=mb.getValue(Oc.a.contentControlNode),
Qa=Qa.id,1==(null===mb||void 0===mb?void 0:mb.length)&&Qa.equals(mb[0])&&(Qa=this.Yoa.U8h(),this.SRh(Qa)))};this.AWf=(Qa,mb)=>{if(wn.a.oda)for(const Jb of mb.YPh)wz(Jb.contentControlNode)||(Qa=Jb.contentControlNode.ja(Oc.a.ZOa,null),this.SRh(Qa))}}get JEf(){return v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Uga.Q9i(this.AWf);this.i6k.pO(this.amn)}SRh(b){const h=this.Yoa.AGb();h&&b&&this.Yoa.BHb(h,b)&&(b=new sg.GraphTransaction(7),b.Ut(h),h.tg(),
b.dispose())}LKc(){const b=new vz.a;b.setValue(Oc.a.Omm,!0);var h=(h=Lb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Oc.a.tac,h);b.setValue(Oc.a.b6k,this.JEf);h=Lb.a.create();b.setValue(Oc.a.uli,h);return b}kPk(b){const h=b.currentNode.getValue(Oc.a.uli);b.Bf(new fB.a,1);b.lY();b.currentNode.setValue(Oc.a.EUh,h);b.Bf(this.Pf.Tgb(),1);b.lY();return this.Pf.OH(b)}Roo(b){var h=this.Yoa.hsf();h.zb(7);if(h.sc()&&h.EQa(0,B=>8==B.type)){h=h.currentNode;const B=(new au.WACStyleSet).iY(h);
if(B){var r=B.pj(as.a.s1f);if(!r&&(r=this.Luk(h),t.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=Se.a.createTextRange(b,0,Td.ParagraphReader.textLength(b));this.Hea.tX(b,P=>{this.rn.Lga(P);this.rn.l8a(P,r)})}}}bdl(b){var h=this.Yoa.hsf();const r=this.LKc();h.Bf(r,29);h.lY();h=this.kPk(h);this.jg.Ge(Se.a.Uc(h,0),b,!1,!1);this.Roo(h);return r}G_k(b){const h=this.Yoa.AGb();this.Yoa.BHb(h,b);b=this.LKc();const r=this.Yoa.hsf();
r.Bf(b,29);r.Bj(b);at.a(h.currentNode,r.currentNode,!1);return b}CZo(b,h){const {r$d:r,koi:B}=this.Yoa.dZl(b);if(r){var P=Se.a.createTextRange(r,0,Td.ParagraphReader.textLength(r));this.jg.Ge(P,h,!1,!1);B&&this.Mll(b);this.jYo(b)}}Mll(b){const h=this.Yoa.AGb();if(h&&b&&this.Yoa.BHb(h,b))for(h.Rd(),b=h.Wp(),--b;0<b;b--)h.qF(b),h.tg()}jYo(b){const h=this.Yoa.AGb();this.Yoa.BHb(h,b)&&h.currentNode.setValue(Pe.a.QR,new Date)}Luk(b){const h=new Gw.a(new uz.a);h.setValue(xe.a.la,"Placeholder Text");h.setValue(xe.a.na,
1);h.setValue(Oc.a.ma,"PlaceholderText");h.setValue(Nd.a.oa,99);h.setValue(Oc.a.pa,"Default Paragraph Font");h.setValue(Oc.a.zn,!0);h.setValue(Pe.a.fontColor,8421504);return um.a.$Fc([h],b)?h:null}}Object(n.a)(gB,"GlossaryEditor",null,[332]);class bC{constructor(b,h,r,B,P){this.Uga=b;this.wJh=h;this.VCb=r;this.VJ=B;this.Ej=P;this.$5k=new uy;this.cmn=(ca,ra)=>{this.VJ.ie(()=>{if(ra){ra.So.selectedContentControls||(ra.So.selectedContentControls={});var Qa=ra.So.selectedContentControls,mb=ra.uUa;if(mb&&
mb.length){var Jb=mb[0];mb=mb[mb.length-1];Jb=this.Uga.Spf(Se.a.Uc(Jb.node,Jb.Wj),Se.a.Uc(mb.node,mb.vp),!1);for(const Yb of Jb)wn.a.Jx&&Yb.contentControlNode.ja(Oc.a.RU,!1)||(Qa[Yb.contentControlNode.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.mYf=(ca,ra)=>{this.VJ.ie(()=>{if(ra){var Qa=ra.clone,mb=ra.original;try{const Jb=ra.So.selectedContentControls,Yb=this.Uga.apf(mb,0,mb.characterData.length,!0,!0,!1);for(const fc of Yb){const Mc=fc.me.toString();Jb[Mc]?fc.zp&&!this.u8k(fc.contentControlNode,
Qa,Jb)&&(t.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Mc)),this.g8f(Qa,fc.me)):this.g8f(Qa,fc.me)}}catch(Jb){t.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Jb.toString()),this.wJh.YZn(Qa)}}},"CC:onParagraphCopy")};this.nYf=(ca,ra)=>{this.VJ.ie(()=>{if(ra){var Qa=ra.clone,mb=ra.original;try{const Jb=this.Uga.apf(Qa,0,mb.characterData.length);ra.So.ccObjectIdMapping||(ra.So.ccObjectIdMapping={});const Yb=
ra.So.ccObjectIdMapping;for(let fc=0;fc<Jb.count;fc++){const Mc=Jb.J(fc),Wc=Mc.me.toString();if(this.OTm(Mc))if(Mc.Qc){const id=mb.Zi().xd.Eb(Wc),Id=this.o$l(Mc),ve=this.x_k(id,Id.d1i,Id.Nsi,Qa.Zi().xd);Yb[Wc]=ve.id;this.VCb.QFj(Yb[Wc],Qa.id,null);this.Ej.Pfc(ve)}else this.VCb.QFj(Yb[Wc],null,Qa.id);Yb[Wc]?(Mc.me=Yb[Wc],Mc.jv=null):this.g8f(Qa,Mc.me)}}catch(Jb){t.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Jb.toString())}}},"CC:onParagraphPaste")}}init(){et.a.kxk(this.cmn);
et.a.F0e(this.mYf);et.a.BCd(this.nYf)}eSl(b){if(!b.zb(25)||!b.jd(25))return null;if(!b.Jt(25)){const h=this.$5k.create(1074135144);b.Bf(h,25)}return b.Tb(25)}u8k(b,h,r){var B=b.ja(Oc.a.s8,null);const P=xd.GraphIterator.eb(h);h=h.Zi().xd;r=B&&r[B.toString()]?h.Eb(B):this.eSl(P);if(!r)return t.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;B=at.b(b,h,!0);xd.GraphIterator.eb(r).Q3(B,26,b.id);54!==r.type&&B.setValue(Oc.a.s8,
r.id);wn.a.Jx&&mp.a.ZCf(null,B);return B}g8f(b,h){this.wJh.Ykl(new vb.a([b]),h)}OTm(b){var h=b.Lb.paragraph.Mc;if(!h)return t.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.me.toString())),!1;h=h.Eb(b.jv);if(!h)return t.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.me.toString())),!1;b=h.getValue(Oc.a.Ns);return 38===b||39==b}LQl(b,h){var r,B=b.ra.J(b.ra.length-
1);let P=b.characterData.length;B=(null===(r=null===B||void 0===B?void 0:B.Jb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Lb.paragraph.id)&&(P=h.Lb.cp,B=h.Lb.Jb.AJ(h.me,h.Qc));return this.Uga.bpf(b,0,P,0,B)}o$l(b){let h=null,r=b.Lb.paragraph;const B={};for(;r;){const P=this.LQl(r,b);for(let ca=P.count-1;0<=ca;ca--){const ra=P.J(ca);if(!ra.zp)continue;const Qa=ra.me.toString();if(ra.Qc){if(!B[Qa])return{d1i:ra.contentControlNode,Nsi:h}}else B[Qa]=!0,h||(h=ra.contentControlNode)}r=Td.ParagraphReader.Wf(r,
!0,!0)}return{d1i:null,Nsi:h}}x_k(b,h,r,B){let P;h?P=this.VCb.Hwa(h):(P=this.VCb.Iwa(),h=P.currentNode);B=at.b(b,B,!0);B.Gg(Oc.a.$w,Kd.a.FF());54!==h.type&&B.setValue(Oc.a.s8,h.id);P.aI(B,r,26);wn.a.oda&&!wz(b)&&this.VCb.D_k(b,B);return B}}Object(n.a)(bC,"ContentControlCCP",null,[]);var Rw=c(731);class vy{constructor(b,h,r,B){this.Md=b;this.Qf=h;this.gb=r;this.Mg=B}get AY(){return!!this.Qf.instance&&this.Qf.instance.AY}get jJb(){return!!this.Qf.instance&&this.Qf.instance.jJb}Hua(b,h,r,B,P,ca=as.a.XDb,
ra=as.a.J6b,Qa=null,mb=as.a.nef,Jb=-1){(b=this.ERc(b,r))?(b.Jb||(b.Jb=new hA.a(b)),this.usk(h,b.Jb,B,P,ca,ra,Qa,mb,Jb)):t.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}CRh(b,h,r){if(b){new vb.a;for(let P=0;P<b.count;P++){var B=this.Opf(b.J(P),h,!1);for(const ca of B)this.A_n(ca,r)}}}Xkl(b,h){this.CRh(b,h,!0)}Ykl(b,h){this.CRh(b,h,!1)}Ge(b,h,r){this.Md.Ge(b,h,r===Mb.a.fad)}ERc(b,h){var r=Se.a.Uc(b,h);this.Md.C8a(r);for(r=0;r<b.ra.length;r++){const B=
b.ra.J(r);if(B.cp>h)break;if(B.cp===h)return B}return null}usk(b,h,r,B,P=as.a.XDb,ca=as.a.J6b,ra=null,Qa=as.a.nef,mb=-1){const Jb=h.Lb.paragraph;b=new Rw.a(h.Lb,!0,!0,!0,null,b,B,r,P,ca,ra,Qa,null,this.Mg);if(!this.AY||-1>=mb||mb>h.length)mb=h.length;h.insert(b,mb);Jb.Xl();b.pe?Jb.xe.xY(b.pe-1,512):Jb.xe.npa(b.pe,512);Jb.xe.uq.Z(b.pe,Iq.CharacterPropertiesEditor.bN);Jb.xe.ot.Z(b.pe,Iq.CharacterPropertiesEditor.ZR)}Opf(b,h,r){const B=new vb.a;for(let P=0;P<b.ra.length;P++){const ca=b.ra.J(P);if(ca.Jb)for(let ra=
0;ra<ca.Jb.length;ra++)if(ca.Jb.J(ra).me.equals(h)&&(B.add(ca.Jb.J(ra)),r))return B}return B}Fdd(b,h,r){if(this.jJb&&b){var B=b.node,P=b.Wj,ca=b.vp,ra=this.Z7h(B,P,h,!0);h=this.Z7h(B,ca,h,!1);r?-1!==ra&&ra++:-1!==h&&h++;P||-1===ra||(ra=Math.max(ra,this.gb.ix(B)));ca===this.gb.textLength(B)&&-1!==h&&(h=Math.min(h,this.gb.uw(B)));b.Fb=ra;b.Sb=h}}Z7h(b,h,r,B){return(b=(b=b.ra.nh(h))?b.Jb:null)&&b.length?b.AJ(r,B):-1}A_n(b,h){b&&b.Lb.Jb&&(h?b.Lb.Jb.remove(b):b.Lb.Jb.cra(b),h=b.Lb.paragraph,0<=b.pe&&b.pe<
h.xe.length&&(b.Lb.cp||1!==h.xe.length||(h.xe.xY(0,512),h.xe.uq.Z(1,Iq.CharacterPropertiesEditor.bN),h.xe.ot.Z(1,Iq.CharacterPropertiesEditor.ZR)),h.xe.removeAt(b.pe,512)),h.Xl())}YZn(b){const h=b.ra;if(h){var r=new vb.a;for(let B=0;B<h.length;B++){const P=h.J(B);if(P&&P.Jb){for(let ca=0;ca<P.Jb.length;ca++)r.add(P.Jb.J(ca).pe);P.Jb=null}}b.ara(r)}}JSo(b,h,r){if(!(0>h||0>r))for(this.Md.C8a(Se.a.Uc(b,h)),this.Md.C8a(Se.a.Uc(b,r)),h=b.ra.zca(h),r=b.ra.zca(r),--r;r>h;r--){const B=b.ra.J(r);B.gFf?b.ra.removeAt(r):
B.formatting=null}}}Object(n.a)(vy,"ContentControlChpManager",null,[568]);class iA{constructor(b,h,r,B,P){this.gb=b;this.Lo=h;this.Nh=r;this.rd=B;this.Mg=P}Qof(b){if(!b||!Pd.SelectionEditor.Ze(b))return null;if(!b.cpBegin){const h=this.c6h(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.gb.textLength(b.node)?this.c6h(b.node,b.Fb-1,!1):null}IPl(b,h){b=this.TMh(b,h);return this.Qof(b)}c6h(b,h,r){return b.ra&&b.ra.length?(b=r?b.ra.first.Jb:b.ra.last.Jb)&&0<=h&&h<b.length&&b.J(h).Of&&b.J(h).Qc===
r&&this.sEf(b.J(h))?b.J(h):null:null}bsf(b){if(!b||!Pd.SelectionEditor.pv(b))return null;var h=this.Lo.pRd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Of&&this.sEf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Of&&this.sEf(h)?null:b:null}sEf(b){if(!b)return!1;var h=this.tei(b);if(!h)return!1;if(b.Qc)var r=b;else r=h,h=b;var B=this.gb.textLength(b.Lb.paragraph);if(r.Lb.cp||h.Lb.cp!==B||!r.zp||r.Wxa||!h.zp||h.Wxa)return!1;r=r.Lb.Jb;h=h.Lb.Jb;for(B=0;B<r.length&&!r.J(B).me.equals(b.me);B++)if(!r.J(B).Qc)return!1;
for(r=h.length-1;0<=r&&!h.J(r).me.equals(b.me);r--)if(h.J(r).Qc)return!1;return!0}kdd(b){b=this.Qof(b);this.IId(b,!1)}NDj(b,h){b=this.TMh(b,h);this.kdd(b)}RJa(b){b=this.bsf(b);return this.IId(b,!0)?b:null}kJm(b,h){b=this.Qof(b);return!!b&&b.me.equals(h)}rcc(b,h,r){b=this.IPl(b,h);return!!b&&b.me.equals(r)}cGf(b,h){b=this.bsf(b);return!!b&&b.me.equals(h)}IId(b,h){if(!b)return!1;const r=this.tei(b);return this.bKh(b,h)&&(!r||this.bKh(r,h))}bKh(b,h){if(!b||b.Of===h)return!1;var r=this.Lo.Ine(b.Lb.paragraph,
b.Qc);const B=b.Lb.Jb;-1!==r||b.Qc||(r=B.length);const P=h===b.Qc?1:-1;r+=h?P:0;b=B.AJ(b.me,b.Qc)+P;if(r===b||0<P!==b>r)return t.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,P),t.ULS.shipAssertTag(24933848,368,0<P===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,P),!1;for(var ca=r;ca!==b;ca+=P){var ra=
B.J(ca);B.cra(ra);ra.Of=h;B.NFm(ra,ca);this.WXo(B.J(ca))}if(this.L0)for(B.Lb.paragraph.Xl(),ca=r;ca!==b;ca+=P)ra=B.J(ca),ra.paragraph.xe.uq.Z(ra.pe,Iq.CharacterPropertiesEditor.bN),ra.paragraph.xe.ot.Z(ra.pe,Iq.CharacterPropertiesEditor.ZR);h||this.E_o(B,r,b,P);t.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}WTd(b){return b.Qc&&this.Mg.Fq(b.contentControlNode.id,!0).equals(b.Lb.paragraph.id)?38:!b.Qc&&this.Mg.Fq(b.contentControlNode.id,
!1).equals(b.Lb.paragraph.id)?39:b.Of&&b.Qc?40:b.Of&&!b.Qc?41:!b.Of&&b.Qc?38:39}WXo(b){const h=b.Lb.paragraph.Mc;if(h){var r=h.Eb(b.jv),B=b.contentControlNode;if(r){r=r.clone();r.setValue(Oc.a.KIf,b.Of);const P=this.WTd(b);r.setValue(Oc.a.Ns,P);h.Xu(r,null);b.jv=r.id}B&&B.setValue(Oc.a.u9,b.Of)}}tei(b){if(b.Lb.cp&&b.Lb.cp!==this.gb.textLength(b.Lb.paragraph)||!b.Lb.paragraph.ra||!b.Lb.paragraph.ra.length)return null;const h=b.Qc?b.Lb.paragraph.ra.last:b.Lb.paragraph.ra.first;if(!h.Jb)return null;
b=h.Jb.AJ(b.me,!b.Qc);return-1===b?null:h.Jb.J(b)}E_o(b,h,r,B){var P=b.J(h).contentControlNode;if(P){var ca=b.J(h).Qc;P=this.Mg.Fq(P.id,ca);if(!P.equals(U.a.nil))if(b.Lb&&b.Lb.paragraph&&b.Lb.paragraph.id.equals(P)){for(h+=B;h!==r;h+=B){const ra=b.J(h).contentControlNode;if(!ra)return;this.Mg.sE(ra.id,P,ca)}0<=r&&r<b.length&&b.J(r).Of&&this.yIf(b.J(r))&&(b=b.J(r).contentControlNode)&&this.Mg.sE(b.id,P,ca)}else t.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}yIf(b){return b.zp&&
!b.Wxa}TMh(b,h){if(!b||!this.Nh)return null;const r=h?Se.a.Uc(b,0):Se.a.tw(b);b=this.Nh.er(b,h);r.Sb=r.Fb=b;return r}get L0(){return this.rd.isFeatureEnabled(32)}}Object(n.a)(iA,"ContentControlConverter",null,[567]);var Ir;(function(b){b[b.y$o=0]="BoundingBox";b[b.Bdp=1]="Tags";b[b.$ap=2]="Hidden";b[b.gcp=3]="NumberOfContentControlAppearance"})(Ir||(Ir={}));Object(n.b)("ContentControlAppearance",Ir);var iu=c(1646);class jA{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.ebb=this.JCa=this.nld=this.cyd=
this.Lsd=null;this.bla=this.ek=this.iBc=this._id=0;this.DWb=this.idb=this.Yyd=this._title=this.bBa=null;this.Mpd=this.Lpd=this.t3g=this.Bvd=this.Bxc=this.xxc=this.Dkd=!1;this.K4g=null;this.Of=!1;this.fjd=null;this.ji=r;this.Dx=h;this.Tg=B;this.pr=P;this.jm=ca;this.L2=ra;this.tfa=Qa;this.nga=mb;this.IAb=Jb;this.Mg=Yb;b?(this.Lsd=b.id,this.fjd=b,this.qU(!1)):this._id=Kd.a.FF()}get sj(){return this.ji.value}get id(){this.qU();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.$w,
this._id),this.xZ())}get parentId(){this.qU();return this.iBc}set parentId(b){this.iBc=b}get title(){this.qU();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.Dgb,this._title),this.xZ(),this.Hdd(h=>{h.title=this._title?this._title:as.a.XDb}))}get tag(){this.qU();return this.Yyd}set tag(b){this.Yyd=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.Ggb,this.Yyd),this.xZ())}get type(){this.qU();return this.ek}set type(b){this.ek=b;this.isValid()&&
(this.contentControlNode.setValue(Oc.a.Hgb,iu.a[this.ek]),this.xZ())}get appearance(){this.qU();return this.bla}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.bla=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.Egb,Ir[this.bla].toLowerCase()),this.xZ(),this.Hdd(h=>{h.appearance=Ir[this.bla].toLowerCase()}))}get color(){this.qU();return this.bBa}set color(b){if(b&&16777215>=b)this.bBa=b,this.isValid()&&(this.contentControlNode.setValue(Oc.a.XJc,
this.bBa),this.xZ(),this.Hdd(h=>{h.color=this.bBa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.qU();return this.idb}set placeholderText(b){this.idb=b;wn.a.oda&&this.Tg.yGj(b,this.fjd)&&(this.xZ(),this.OJ&&this.jm.pBb(this,!0))}get XLd(){this.qU();return this.DWb}set XLd(b){this.DWb=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.UCb,this.DWb),this.xZ())}get Sgf(){this.qU();return this.Dkd}set Sgf(b){b&&(this.Dkd=b,this.isValid()&&
(this.contentControlNode.setValue(Oc.a.tId,this.Dkd),this.xZ()))}get removeWhenEdited(){this.qU();return this.Bvd}set removeWhenEdited(b){if(b&&!this.qia)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.Bvd=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.zJh,this.Bvd),this.xZ())}get qia(){this.qU();return this.xxc}set qia(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");
this.xxc=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.D5b,this.xxc),this.Hdd(h=>{h.dL=this.xxc}),this.xZ())}get isEditable(){this.qU();return this.Bxc}set isEditable(b){this.Bxc=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.WCb,this.Bxc),this.Hdd(h=>{h.editable=this.Bxc}),this.xZ())}get isSupported(){this.qU();return this.t3g}get TTm(){return this.isSupported&&11!==this.type&&10!==this.type}get eXm(){this.qU();return this.DWb&&"table of contents"===this.DWb.toLowerCase()?!0:
!1}get u0d(){this.qU();return this.Lpd}set u0d(b){this.Lpd=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.DJh,this.Lpd),this.xZ())}get Bdc(){this.qU();return this.Mpd}set Bdc(b){this.Mpd=b;this.isValid()&&(this.contentControlNode.setValue(Oc.a.EJh,this.Mpd),this.xZ())}get OJ(){return this.contentControlNode.ja(Oc.a.t8,!1)}set OJ(b){this.isValid()&&this.contentControlNode.setValue(Oc.a.t8,b)}get Au(){this.qU();return this.cyd}set Au(b){this.cyd=b}get Ez(){this.qU();return this.nld}set Ez(b){this.nld=
b}get objectId(){return this.Lsd}set objectId(b){this.Lsd=b;this.fjd=this.sj.Eb(this.Lsd)}get start(){this.pIj();return this.JCa}set start(b){this.JCa=b}get end(){this.pIj();return this.ebb}set end(b){this.ebb=b}get contentControlNode(){return this.fjd}ABn(b){for(let h=0;3>h;++h)if(Ir[h].toLowerCase()===b)return h;return 0}xZ(){const b=this.start.node;b&&b.setValue(Pe.a.QR,new Date)}Udd(){this._id=this.contentControlNode.ja(Oc.a.$w,0);this.bla=this.ABn(this.contentControlNode.ja(Oc.a.Egb,null));this.bBa=
this.contentControlNode.ja(Oc.a.XJc,null);this._title=this.contentControlNode.ja(Oc.a.Dgb,null);this.Yyd=this.contentControlNode.ja(Oc.a.Ggb,null);this.Of=this.contentControlNode.ja(Oc.a.u9,!1);this.xxc=this.contentControlNode.ja(Oc.a.D5b,!1);this.Bxc=this.contentControlNode.ja(Oc.a.WCb,!1);this.t3g=this.contentControlNode.ja(Oc.a.Tga,!1);this.DWb=this.contentControlNode.ja(Oc.a.UCb,null);this.Dkd=this.contentControlNode.ja(Oc.a.tId,!1);this.cyd=this.Mg.Fq(this.contentControlNode.id,!0);this.nld=
this.Mg.Fq(this.contentControlNode.id,!1);this.Mpd=this.contentControlNode.ja(Oc.a.EJh,!1);this.Lpd=this.contentControlNode.ja(Oc.a.DJh,!1);this.Bvd=this.contentControlNode.ja(Oc.a.zJh,!1);this.ek=Object(iu.b)(this.contentControlNode.ja(Oc.a.Hgb,"RichText"));let b=null;try{const h=this.contentControlNode.ja(Oc.a.s8,U.a.nil);if(U.a.Cq(h,U.a.nil))this.iBc=0;else if(b=this.sj.Eb(h))this.iBc=b.ja(Oc.a.$w,0)}catch(h){this.iBc=0}this.BZo()}BZo(){if(this.IAb){var b=this.contentControlNode.ja(Oc.a.ZOa,"");
if((b=this.tfa.Eki(b))&&0<b.length){this.idb=this.n5h(b.Pa,b.Rc);return}}this.idb=(b=this.Tg.Iwa())&&b.currentNode?b.currentNode.ja(Oc.a.YJc,null):null}qU(b=!0){if(!b||this.isValid())b=this.contentControlNode.ja(Pe.a.lastModifiedTime,new Date(0)),this.K4g!==b?(t.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.Udd(),this.K4g=b):t.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}D_o(b,
h){this.cyd=b;this.nld=h;this.Mg.sE(this.contentControlNode.id,b,!0);this.Mg.sE(this.contentControlNode.id,h,!1)}pIj(){if(this.contentControlNode){var b=this.Au,h=this.Ez;if(!b||!h||b.equals(U.a.nil)||h.equals(U.a.nil))t.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.Tg.Boa(b,!0),h=this.Tg.Boa(h,!1),b&&h)if(b.isConnected&&h.isConnected||t.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),
this.Of)b=Se.a.create(b),this.pr.Fdd(b,this.objectId,!0),this.start=b,b=Se.a.create(h),this.pr.Fdd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.ra){for(let B=0;B<b.ra.length&&(-1===h||-1===r);B++){const P=b.ra.J(B);if(P.Jb)for(let ca=0;ca<P.Jb.length&&(-1===h||-1===r);ca++){const ra=P.Jb.J(ca);U.a.Cq(ra.me,this.objectId)&&(ra.Qc?h=P.cp:r=P.cp)}}0<=h&&0<=r&&(b=Se.a.cR(h,r,!1,b),this.pr.Fdd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||
!r)return b;this.Of?b=this.n5h(h,r):(h=Td.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=ni.AParagraphNode.QP(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}bie(b){return this.nga?this.jm.toj(this,b)?0:2:2}clear(){return this.nga?this.jm.toj(this,"")?0:2:2}f7h(){const b=new vb.a;var h=this.contentControlNode.ja(Oc.a.contentControlNode,[]);for(const r of h)if(!U.a.Cq(r,U.a.nil)){h=this.ji.value.Eb(r);try{b.add(this.L2.iDb(h,this.Dx,this.ji,
this.Tg,this.pr,this.jm,this.tfa,this.nga,this.IAb))}catch(B){}}return b}nof(){const b=new vb.a;this.e5h(this,b);return b}e5h(b,h){b=b.f7h();if(b.count)for(const r of b)h.add(r),this.e5h(r,h)}lF(b=!1){const h=new vb.a;if(this.Of){var r=this.jm.uU(this.start,this.end);for(var B of r)r=Se.a.create(B),this.pr.Fdd(r,this.objectId,b),h.add(r)}else B=this.start.clone(),this.pr.Fdd(B,this.objectId,b),h.add(B);return h}Hdd(b){const h=this.jm.uU(this.start,this.end);for(let r=0;r<h.count;r++){const B=this.pr.Opf(h.J(r),
this.objectId,!1);if(B){for(let P=0;P<B.count;P++)b(B.J(P));h.J(r).jk()}}}n5h(b,h){const r=new Sys.StringBuilder;h=this.jm.uU(b,h);for(const B of h)B.id.equals(b.node.id)||r.append("\r"),r.append(Td.ParagraphReader.Wda(B));return r.toString()}}Object(n.a)(jA,"ContentControl",null,[428]);class Sw{constructor(b){this.Mg=b}iDb(b,h,r,B,P,ca,ra,Qa,mb){return new jA(b,h,r,B,P,ca,this,ra,Qa,mb,this.Mg)}}Object(n.a)(Sw,"ContentControlFactory",null,[566]);class kA{constructor(b,h,r,B,P){this.ji=b;this.pr=
h;this.Qmk=r;this.$W=B;this.Ca=P}YVo(b,h,r){var B,P;if(!(wn.a.X$e&&b&&h&&r))return!1;const ca=b.contentControlNode;if(!ca)return!1;var ra=ca.ja(Oc.a.XCb,U.a.nil);ra&&!ra.equals(U.a.nil)?b=this.ji.value.Eb(ra):(b=this.pr.ERc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(B=null===b||void 0===b?void 0:b.formatting)||void 0===B?void 0:B.Jn,b||(b=new az.a,this.ji.value.Xu(b,null)),ca.setValue(Oc.a.XCb,b.id));B=this.ji.value.Eb(b.id);ra="boolean"===typeof r&&r;const Qa=null===(P=this.Ca)||
void 0===P?void 0:P.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.Qmk.urf(ca,B,h,r,Qa?null:ra);h=this.$W.tpe(h);for(const [mb,Jb]of h)b.setValue(mb,Jb);return!0}}Object(n.a)(kA,"ContentControlFormattingManager",null,[565]);var LC=c(941);class Tw{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){this.Dx=b;this.ji=h;this.Yc=r;this.$xb=B;this.E_j=P;this.HK=ca;this.rh=ra;this.gb=Qa;this.Std=mb;this.Gmd=Jb;this.Mg=Yb;this.$Ce=fc;this.tfa=Mc}get px(){return this.Dx.value}Iwa(){const b=
this.Yc.Dk();b.set(this.px);this.$xb.GP(b);if(b.Tb(25))return b;this.Gmd.instance&&this.Gmd.instance.ypa&&t.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");t.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}TQc(b,h,r=!1){this.c8b();const B=new vb.a;let P;if(b){P=b.Tb(26);if(!P)return B;for(;P&&(!h(P)||(B.add(P),!r));){B.addRange(this.TQc(b,h));if(r&&0<B.count)break;P=b.Lf(26)}b.sc()}return B}S8l(){const b=this.Yc.Dk();b.set(this.Dx.value);
this.$xb.GP(b);return b.currentNode}RRa(b,h,r){let B;B=b.equals(h);B||(B=(b=this.Boa(b,r))?b.id.equals(h):!1);return B}ZPa(b,h){b=this.qu(b);if(!b)return null;let r=null;for(;55===b.type;){const B=this.Mg.Fq(b.id,h);if(B.equals(r)){b=null;break}else b=this.qu(B);r=B}return b}Boa(b,h){return(b=this.ZPa(b,h))?Td.ParagraphReader.Xb(b)?b:h?this.gb.$k(b):this.gb.XC(b):null}ARh(b,h=!1){this.cVo(b);this.BRh(b,h)}cVo(b){var h=this.Hwa(b);h=this.Hwa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:
null;let r,B;r=this.qu(this.Mg.Fq(b.id,!0));for(B=this.qu(this.Mg.Fq(b.id,!1));r&&55===r.type;)r=this.qu(this.Mg.Fq(r.id,!0));for(;B&&55===B.type;)B=this.qu(this.Mg.Fq(B.id,!1));r&&B&&this.PFj(r.id,B.id,h,P=>{P=P.ja(Oc.a.GX,U.a.nil);return!P||P.equals(U.a.nil)||b.id.equals(P)})}BRh(b,h=!1){t.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var r=this.Hwa(b);const B=this.Hwa(r.parentNode);let P=U.a.nil,ca=U.a.nil;var ra=B.currentNode.ja(Oc.a.contentControlNode,[]);const Qa=
new vb.a;for(var mb=0;mb<ra.length;mb++)Qa.add(ra[mb]);if(h){if(54!==B.currentNode.type){P=this.Mg.Fq(B.currentNode.id,!0);ca=this.Mg.Fq(B.currentNode.id,!1);ra=this.qu(P);for(mb=this.qu(ca);ra&&55===ra.type;)P=this.Mg.Fq(ra.id,!0),ra=this.qu(P);for(;mb&&55===mb.type;)ca=this.Mg.Fq(mb.id,!1),mb=this.qu(ca)}ra=this.Hwa(b);if(ra.Tb(26)){mb=new vb.a;for(mb.add(ra.currentNode);ra.Lf(26);)mb.add(ra.currentNode);for(var Jb of mb)this.BRh(Jb,h)}}else if(P=this.Mg.Fq(b.id,!0),ca=this.Mg.Fq(b.id,!1),h=this.y1l(Qa,
b.id),Jb=this.Hwa(b),Jb.Tb(26)){ra=this.Hwa(Jb.currentNode);mb=ra.currentNode;let Yb=b;for(;mb;){const fc=Jb.currentNode;Qa.insert(h++,fc.id);mb=ra.Lf(26);const Mc=this.Hwa(fc);54!==B.currentNode.type?fc.setValue(Oc.a.s8,B.currentNode.id):fc.removeProperty(Oc.a.s8);at.h(Mc,B,Yb,26);Yb=Mc.currentNode;mb&&(Jb.set(mb),Jb.e2(this.Iwa().currentNode))}}54!==B.currentNode.type&&(h=this.Mg.Fq(B.currentNode.id,!0),Jb=this.Mg.Fq(B.currentNode.id,!1),h.equals(b.id)&&this.Mg.sE(B.currentNode.id,P,!0),Jb.equals(b.id)&&
this.Mg.sE(B.currentNode.id,ca,!1));r.tg();t.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Qa,b.id);ra=Array(Qa.count);for(r=0;r<Qa.count;r++)ra[r]=Qa.J(r);B.currentNode.setValue(Oc.a.contentControlNode,ra);LC.a.iHa(b.id)}tsk(b,h,r,B,P,ca,ra=null){let Qa;if(h){var mb=this.qu(h.objectId);Qa=this.Hwa(mb)}else Qa=this.Iwa(),mb=Qa.currentNode;const Jb=this.E_j.create(1074135145);ra&&Jb.properties.ax(ra.properties);54!==mb.type&&Jb.setValue(Oc.a.s8,mb.id);ra?Qa.IIb(Jb,r,26,
ra.id):Qa.aI(Jb,r,26);wn.a.TCb?(this.qIj(b,Jb.id,P,!0),this.qIj(b,Jb.id,ca,!1)):(this.Mg.sE(Jb.id,P,!0),this.Mg.sE(Jb.id,ca,!1));b.Of&&(h&&(r=this.Mg.Fq(mb.id,!0),ra=this.Mg.Fq(mb.id,!1),r.equals(P)&&this.Mg.sE(mb.id,Jb.id,!0),ra.equals(ca)&&this.Mg.sE(mb.id,Jb.id,!1)),this.PFj(P,ca,Jb.id,Yb=>{Yb=Yb.ja(Oc.a.GX,U.a.nil);const fc=h?h.objectId:null;return!Yb||Yb.equals(U.a.nil)||Yb.equals(fc)}));P=this.Hwa(Jb);ca=Array(B.count);for(mb=B.count-1;0<=mb;mb--)ca[mb]=B.J(mb).objectId,r=this.qu(B.J(mb).objectId),
r=this.Hwa(r),r.currentNode.setValue(Oc.a.s8,Jb.id),at.h(r,P,null,26);0<ca.length&&Jb.setValue(Oc.a.contentControlNode,ca);Tw.Zb.isFeatureEnabled(39)&&(b.XLd&&Jb.setValue(Oc.a.UCb,b.XLd),b.Sgf&&Jb.setValue(Oc.a.tId,!0));return Jb}qIj(b,h,r,B){12===this.qu(r).type?this.Mg.sE(h,r,B):(this.Mg.Dqg(h,r,B),this.Mg.sE(h,B?b.start.node.id:b.end.node.id,B))}Dio(b,h,r,B,P){b.setValue(Oc.a.u9,h);b.setValue(Oc.a.D5b,!0);b.setValue(Oc.a.WCb,!0);b.setValue(Oc.a.$w,r);b.setValue(Oc.a.Egb,Ir[0]);b.setValue(Oc.a.Tga,
!0);b.setValue(Oc.a.Hgb,iu.a[P]);B&&b.setValue(Oc.a.Frb,B);b.setValue(Oc.a.E5b,0)}QFj(b,h=null,r=null){h&&this.Mg.sE(b,h,!0);r&&this.Mg.sE(b,r,!1)}QRh(b){if(!b||!b.count||!b.J(0))return null;const h=this.fuf(b);for(let r=0;r<b.count;r++)this.rh.mza(b.J(r));return h}fuf(b){if(!b||!b.J(0))return null;const h=this.Yc.Dk();h.set(b.J(0));h.od();h.sc();return h.FJ()?h.currentNode:null}c$l(b){const h=this.Yc.Dk();h.set(b);h.od();h.sc();h.sc();return h}Lph(b,h,r){const B=new vb.a;for(let P=0;P<r;P++){h=this.HK.Pkb(b,
h,!0,null);if(!h||!b.Rd())return null;const ca=b.currentNode;b.sc();b.sc();B.add(ca)}return B}nac(b){const h=this.Yc.Dk();h.set(b);for(h.zb(7);h.sc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}gei(b){const h=this.Yc.Dk();h.set(b);h.od();return(b=h.mUa())?b.id:null}isf(b){const h=this.Yc.Dk();h.set(b);return h.zb(7)?h:null}qu(b){return this.ji.value.Eb(b)}c8b(){if(!Tw.R0g){var b=this.Iwa();b&&this.Xng(b);Tw.R0g=!0}}YUa(b){return this.Std.YUa(b)}QAk(b,
h){const r=this.Yc.Dk();r.set(b.node);const B=this.Yc.Dk();B.set(h.node);r.od();B.od();const P=this.Yc.Dk();P.set(r.currentNode);const ca=this.Yc.Dk();ca.set(B.currentNode);const ra=Qg.returnToLowestCommonTableCell(r,B);return ra?(P.od(),ca.od(),{returnValue:({ul:b}=this.vCb(P,!0,ra,b)).returnValue&&({ul:h}=this.vCb(ca,!1,ra,h)).returnValue,abd:b,pNc:h}):{returnValue:({ul:b}=this.vCb(r,!0,null,b)).returnValue&&({ul:h}=this.vCb(B,!1,null,h)).returnValue,abd:b,pNc:h}}vCb(b,h,r,B){let P=null,ca=b.jd(16);
for(;ca!==r;){if(h&&qh.TableCellReader.zyi(b)||!h&&qh.TableCellReader.sGf(b))P=b.jd(14);else return{returnValue:!1,ul:B};ca=b.jd(16)}P&&(B=Se.a.create(P));return{returnValue:!0,ul:B}}Xng(b){if(b.Tb(26)){for(this.Xng(b);b.Lf(26);)this.Xng(b);b.sc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.J(r).toString()===h.toString()){b.removeAt(r);break}}Hwa(b){const h=this.Yc.Dk();h.set(b);h.e2(this.Iwa().currentNode);return h}y1l(b,h){for(let r=0;r<b.count;r++)if(b.J(r).equals(h))return r;return-1}PFj(b,h,
r,B){b=this.qTl(b,h);for(h=0;h<b.count;h++)B(b.J(h))&&(r?b.J(h).setValue(Oc.a.GX,r):b.J(h).removeProperty(Oc.a.GX),this.Gmd.instance&&this.Gmd.instance.Iwi&&b.J(h).nl(16,!0))}qTl(b,h){const r=new vb.a;var B=this.qu(b);const P=this.qu(h);if(!B||!P)return r;const ca=({YZc:ra}=this.zQd(B,P)).returnValue;B=ra[ca];if(14===B.type)r.add(B);else if(15===B.type&&1<=ca){const Qa=ra[ca-1];1===mi.TableReader.gg(Qa)&&r.add(Qa)}var ra=xd.GraphIterator.eb(ca>=ra.length-1?B:ra[ca+1]);ra.zb(7);for(B=qc.a.Gs(ra,B);B.moveNext()&&
B.currentNode!==P;)14===B.currentNode.type&&r.add(B.currentNode);if(!U.a.Cq(h,b)&&14===P.type)for(ra=xd.GraphIterator.eb(P),B=qc.a.Gs(ra,P);B.moveNext();)14===B.currentNode.type&&r.add(B.currentNode);return r}zQd(b,h){b=this.Rib(b);h=this.Rib(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,YZc:b,Iag:h}}Rib(b){const h=[];h.push(b);b=xd.GraphIterator.eb(b);for(b.zb(7);b.sc();)h.push(b.currentNode);h.reverse();return h}static get Zb(){return null!=Tw.tzg?Tw.tzg:
Tw.tzg=Ya.a.instance.Oa("Box4.IFeatureHelper")}LKc(b,h,r=!1){b=this.$Ce.instance.bdl(b);r?(r=as.a.Gjl,b.setValue(Oc.a.tac,r)):r=b.ja(Oc.a.tac,null);h.setValue(Oc.a.ZOa,r)}D_k(b,h){this.M2i(b)&&(b=b.ja(Oc.a.ZOa,null),b=this.$Ce.instance.G_k(b).ja(Oc.a.tac,null),h.setValue(Oc.a.ZOa,b))}yGj(b,h){if(!this.M2i(h))return!1;var r=h.ja(Oc.a.ZOa,null);r?wz(h)?this.LKc(b,h):this.$Ce.instance.CZo(r,b):(r=this.tfa.U8h())?h.setValue(Oc.a.ZOa,r):this.LKc(b,h,!0);return!0}M2i(b){if(!b)return!1;var h=b.getValue(Oc.a.Hgb);
if(!h)return!1;h=Object(iu.b)(h);b=b.getValue(Oc.a.UCb);return(0==h||1==h)&&b!==uj.DUh}}Tw.R0g=!1;Object(n.a)(Tw,"ContentControlGraphManager",null,[564]);class Nu{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.nxe=Jb;this.ala=null;this.dSm=(Yb,fc)=>{if(this.AY)return this.eSm(Yb,fc);if(!Yb||!Yb.count)return t.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Mc=!0;switch(fc){case 0:fc=this.lL(Yb.J(0),Yb.J(Yb.count-1),1);if((Yb=this.lL(Yb.J(0),Yb.J(Yb.count-1),3))&&0<
Yb.count){if(!Yb.J(0).isSupported||!Yb.J(0).isEditable){Mc=!1;break}for(Yb=Yb.J(0);Yb;)this.T6c(fc,Yb.id),Yb=this.getById(Yb.parentId)}if(fc)for(var Wc of fc)if(!Wc.isSupported||!Wc.isEditable){Mc=!1;break}break;case 1:if(Yb.J(0).contextId!==zc.a.Tc){t.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Mc=!1;break}(fc=this.lL(Yb.J(0),Yb.J(0),1))&&0<fc.count&&(Mc=!1);break;case 2:if(Yb.J(0).contextId!==zc.a.Tc){t.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Mc=!1;break}(fc=this.lL(Yb.J(0),Yb.J(0),3))&&0<fc.count&&(Mc=!1);break;case 3:case 4:fc=this.ISd(Yb.J(0),!0);Wc=this.ISd(Yb.J(Yb.count-1),!1);if(!fc||!Wc){t.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Mc=!1;break}if((fc=this.lL(fc,fc,3))&&0<fc.count){Mc=!1;break}if((fc=this.lL(Wc,Wc,3))&&0<fc.count){Mc=!1;break}if(fc=
this.jm.lL(Yb.J(0),Yb.J(Yb.count-1),1))for(const id of fc)if(!id.qia){Mc=!1;break}break;default:Mc=!1}return Mc};Nu.Dx=b;Nu.ji=h;this.Tg=r;this.pr=B;this.jm=P;this.L2=ca;this.tfa=ra;this.Qf=Qa;this.Lo=mb}get vRa(){return!!this.Qf.instance&&this.Qf.instance.vRa}get ypa(){return!!this.Qf.instance&&this.Qf.instance.ypa}get NZd(){return!!this.Qf.instance&&this.Qf.instance.NZd}get AY(){return!!this.Qf.instance&&this.Qf.instance.AY}get QZd(){return!!this.Qf.instance&&this.Qf.instance.QZd}jJb(){return!!this.Qf.instance&&
this.Qf.instance.jJb}Uma(b,h,r=null,B=null,P=!1){if(!this.vRa)return{returnValue:2,id:0};b=this.Tg.Boa(b,!0);h=this.Tg.Boa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Se.a.create(b);h=Se.a.create(h);return this.xoh(b,h,r,B,P,0,!1)}zrk(b,h,r=0,B=!1){return this.vRa&&b&&h?this.xoh(b,h,null,null,!1,r,B):{returnValue:2,id:0}}E_a(b,h=null,r=0,B=!1){let P=0;if(!this.vRa)return{returnValue:2,id:P};const ca=this.L2.iDb(h,Nu.Dx,Nu.ji,this.Tg,this.pr,this.jm,this.tfa,this.vRa,this.NZd);ca.type=r;ca.start=
b;ca.end=b;ca.Au=b.node.id;ca.Ez=b.node.id;ca.Of=!1;return this.jm.yph(ca,h,B)?(P=ca.id,{returnValue:0,id:P}):{returnValue:2,id:P}}ssk(b,h=null){if(!this.vRa||!this.qOm(b))return{returnValue:2,id:0};var r=b.J(0).contextId===zc.a.Vc?b.J(1):b.J(0);const B=b.J(b.count-1);if(this.D$e(b,zc.a.paragraph)||this.D$e(b,zc.a.Vc)){b=r.node.id;let P=B.node.id;const ca=b.equals(P);r=this.jm.uvj(r,!0);void 0!==r&&null!==r&&(b=r,P=ca?b:P);this.jm.uvj(B,!1);h.setValue(Oc.a.u9,!0);return this.Uma(b,P,h)}return r!==
B||r.contextId!==zc.a.Fd&&r.contextId!==zc.a.Tc?{returnValue:2,id:0}:(h.setValue(Oc.a.u9,!1),this.E_a(r,h))}getById(b){if(!this.ypa)return null;const h=this.Tg.TQc(this.Tg.Iwa(),r=>r.getValue(Oc.a.$w)===b,!0);return 0<h.count?this.jm.qR(h.J(0)):null}getByTitle(b){if(!this.ypa)return null;const h=this.Tg.TQc(this.Tg.Iwa(),B=>B.ja(Oc.a.Dgb,null)===b,!1),r=new vb.a;for(const B of h)r.add(this.jm.qR(B));return r}getByTag(b){if(!this.ypa)return null;const h=this.Tg.TQc(this.Tg.Iwa(),B=>B.ja(Oc.a.Ggb,null)===
b,!1),r=new vb.a;for(const B of h)r.add(this.jm.qR(B));return r}lL(b,h,r,B=!1){return this.ypa?this.AY?this.jm.Doa(b,h,r):this.jm.lL(b,h,r,B):null}uU(b,h){return this.jm.uU(b,h)}CNl(){if(!this.ypa)return null;const b=this.Tg.TQc(this.Tg.Iwa(),()=>!0,!1),h=new vb.a;for(const r of b)h.add(this.jm.qR(r));return h}ZOb(b){if(!this.vRa)return t.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.jm.jza(b)?0:2}Nkl(b){if(!this.vRa)return 2;
b=this.getById(b);return this.jm.deleteContentControl(b)?0:2}Ksk(b){this.jm.Q9i(b)}TKk(b){this.ala=b;this.ala.RXn(this.dSm)}ETl(b){if(!this.jJb())return null;let h;var r=b.lF();h=this.ISd(r.J(r.count-1),!1);r=this.pr.ERc(r.J(r.count-1).node,h.cpBegin).Jb;b=this.Mhm(r,b);if(-1===b)return null;h.Fb=b;h.Sb=h.Fb;return h}eSm(b,h){if(!b||!b.count)return t.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.yMm(b);case 3:case 4:case 6:return this.dUm(b,
6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==zc.a.Tc?(t.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.yzi(b.J(0),5===h,!1);default:return!1}}yMm(b){const h=this.jm.Doa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var r=h.J(0);if(!r.isSupported||!r.isEditable)return!1}b=this.jm.Doa(b.J(0),b.J(b.count-1),1);for(r=0;h&&r<h.count;r++)this.T6c(b,h.J(r).id);if(b)for(const B of b)if(!B.isSupported||
!B.isEditable)return!1;return!0}dUm(b,h){var r=b.J(0),B=b.J(b.count-1),P=r.Wj,ca=B.vp;if(-1===P||-1===ca)return!1;P=this.Lo.a9(r.node,P,r.Fb);ca=this.Lo.a9(B.node,ca,B.Sb);var ra=-1,Qa=Math.min(P.count,ca.count);for(--Qa;0<=Qa;Qa--){const mb=P.J(Qa).me,Jb=ca.J(Qa).me;if(mb.equals(Jb)){ra=Qa;break}}if(-1<ra&&(Qa=this.jm.qR(P.J(ra).contentControlNode),!Qa.isEditable||!Qa.isSupported||Qa.OJ&&!this.$Lm(Qa,b)))return!1;r=this.jm.Doa(r,B,1);for(B=0;B<=ra;B++)this.T6c(r,this.jm.qR(P.J(B).contentControlNode).id);
for(B=ra+1;B<P.count;B++){Qa=this.jm.qR(P.J(B).contentControlNode);if(!Qa.isEditable||!Qa.qia||!Qa.isSupported||Qa.OJ)return!1;this.T6c(r,Qa.id)}for(P=ra+1;P<ca.count;P++){ra=this.jm.qR(ca.J(P).contentControlNode);if(!ra.isEditable||!ra.qia||!ra.isSupported||ra.OJ)return!1;this.T6c(r,ra.id)}if(r)for(const mb of r)if(!mb.isSupported||!mb.qia)return!1;return h&&(b=this.ISd(b.J(0),!0))?this.yzi(b,!0,!0):!0}$Lm(b,h){h=this.Lo.Z9l(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.me)}yzi(b,h,
r){return(b=this.jm.Doa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.QZd&&h&&!b.Of||!r&&b.OJ||wn.a.z1f&&h&&1===b.type)?!1:!0}ISd(b,h){if(!b)return null;let r=null;switch(b.contextId){case zc.a.paragraph:r=h?Se.a.Uc(b.node,0):Se.a.tw(b.node);break;case zc.a.Vc:r=Se.a.tw(b.node);break;case zc.a.Fd:r=h?Se.a.Uc(b.node,b.cpBegin):Se.a.Uc(b.node,b.cpEnd);break;case zc.a.Tc:r=b}r&&(r.Sb=r.Fb=h?b.Fb:b.Sb);return r}T6c(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}Mhm(b,
h){if(!b)return-1;let r=-1;for(let B=0;B<b.length;B++)if(b.J(B).me.equals(h.objectId)&&!1===b.J(B).Qc){r=B;if(h.Of&&0<B&&b.J(B-1).Of&&!b.J(B-1).Qc)return-1;break}return r}qOm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.J(h).contextId;if(r!==zc.a.paragraph&&r!==zc.a.Vc&&r!==zc.a.Fd&&r!==zc.a.Tc||0<h&&h<b.count-1&&r===zc.a.Fd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===zc.a.Vc&&1===b.count||this.D$e(b,zc.a.Tc)&&1<
b.count?!1:!0}D$e(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}xoh(b,h,r=null,B=null,P=!1,ca=0,ra=!1){let Qa=0;var mb=h.node;let Jb=Se.a.create(b.node);mb=Se.a.create(mb);if(wn.a.TCb){if(!({abd:Jb,pNc:mb}=this.nxe.rEh(Jb,mb)).success)return{returnValue:2,id:Qa}}else if(!({abd:Jb,pNc:mb}=this.Tg.QAk(Jb,mb)).returnValue)return{returnValue:2,id:Qa};const Yb=this.L2.iDb(r,Nu.Dx,Nu.ji,this.Tg,this.pr,this.jm,this.tfa,this.vRa,this.NZd);Yb.type=ca;Yb.start=b;Yb.end=h;Yb.Au=Jb.node.id;Yb.Ez=
mb.node.id;Yb.Of=!0;Yb.XLd=B;Yb.Sgf=P;return this.jm.yph(Yb,r,ra)?(Qa=Yb.id,{returnValue:0,id:Qa}):{returnValue:2,id:Qa}}}Nu.Dx=null;Nu.ji=null;Object(n.a)(Nu,"ContentControlManager",null,[563]);var lA=c(634),MC=c(147),xr=c(193);class mA extends Sys.EventArgs{constructor(b){super();this.YPh=b}}Object(n.a)(mA,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var Uw=c(1515);class hB{constructor(){this.jSi=0;this.h1i=null}}Object(n.a)(hB,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,
[]);const Bx=b=>!(null===b||void 0===b?0:b.length),nA=b=>null==b?!1:[...b].some(h=>h.Qc),iB=b=>null==b?!1:[...b].some(h=>!h.Qc);class Ou{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d,be,he,re,Xf,Mg,$l,Nm){this.Ej=$l;this.Ich=[];this.TPe=[];this.Dx=b;this.ji=h;this.Tg=r;this.pr=B;this.L2=P;this.Ce=mb;this.rz=Jb;this.hb=ca;this.ME=ra;this.mCa=Qa;this.tfa=Wc;this.IAb=id;this.nga=Yb;this.DI=fc;this.ga=Mc;this.Lo=Id;this.Qf=ve;this.Nh=$d;this.gb=be;this.Lc=he;this.bmh=re;this.rd=Xf;this.Mg=
Mg;this.DI&&(this.DI.addHandler(lA.a.YOb,Object(z.a)(this,this.RYi,"onShowingPlaceholder")),this.DI.addHandler(lA.a.Zde,Object(z.a)(this,this.ZXi,"onRemoveWhenEdited")),Nm.execute(zp=>{this.KE=zp}))}get px(){return this.Dx.value}get sj(){return this.ji.value}get AY(){return!!this.Qf.instance&&this.Qf.instance.AY}get L0(){return!!this.rd&&this.rd.isFeatureEnabled(32)}dispose(){this.DI&&(this.DI.removeHandler(lA.a.YOb,Object(z.a)(this,this.RYi,"onShowingPlaceholder")),this.DI.removeHandler(lA.a.Zde,
Object(z.a)(this,this.ZXi,"onRemoveWhenEdited")))}lL(b,h,r,B=!1){if(this.AY)return this.Doa(b,h,r);if(!b||!h)return null;const P=this.Tg.Boa(b.node.id,!0);var ca=this.Tg.Boa(h.node.id,!1);if(!P||!ca)return null;b=b.contextId===zc.a.Vc?b:Se.a.Uc(P,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===zc.a.Vc?h:Se.a.Uc(ca,-1===h.cpEnd?ca.characterData.length:h.cpEnd);ca=null;switch(r){case 0:ca=this.PXl(b,h);break;case 1:ca=this.i$l(b,h);break;case 3:ca=this.Lei(b,h,B);break;case 2:ca=this.Pim(b,h);break;case 4:ca=
this.Spf(b,h,!1)}return ca}Doa(b,h,r){if(!b||!h||b.contextId!==zc.a.Vc&&(b=this.cKh(b,!0),!b)||h.contextId!==zc.a.Vc&&(h=this.cKh(h,!1),!h))return null;let B=null;switch(r){case 0:B=this.QXl(b,h);break;case 1:B=this.j$l(b,h);break;case 3:B=this.Mei(b,h);break;case 2:B=this.Qim(b,h);break;case 4:B=this.Spf(b,h,!0)}return B}cKh(b,h){var r=this.Tg.Boa(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Sb);r=Se.a.Uc(r,h);r.Fb=b;r.Sb=
b;return r}PXl(b,h){const r=new vb.a;if(b.contextId===zc.a.Vc||h.contextId===zc.a.Vc||b.equals(h))return r;const B=new gp.a,P=this.TFb(b,b),ca=this.TFb(h,h);for(let ra=0;ra<P.count;ra++)if(P.J(ra).Qc)for(let Qa=0;Qa<ca.count;Qa++)ca.J(Qa).Qc||P.J(ra).me.equals(ca.J(Qa).me)&&(!P.J(ra).Of||this.Tg.RRa(P.J(ra).me,b.node.id,!0)&&this.Tg.RRa(ca.J(Qa).me,h.node.id,!1))&&this.QBd(r,B,P.J(ra).me);return r}QXl(b,h){const r=new vb.a;if(b.contextId===zc.a.Vc||h.contextId===zc.a.Vc||b.equals(h)&&b.Fb===b.Sb||
-1===b.Fb||-1===h.Sb)return r;var B=b.node.ra.nh(b.cpBegin),P=h.node.ra.nh(h.cpEnd);B&&B.Jb&&0<B.Jb.length&&b.Fb<=B.Jb.length&&P&&P.Jb&&0<P.Jb.length&&h.Sb<=P.Jb.length&&(b=b.Fb,h=h.Sb,b===B.Jb.length&&b--,0<h&&h--,B=B.Jb.J(b),P=P.Jb.J(h),B.Qc&&!P.Qc&&U.a.Cq(B.me,P.me)&&B.zp&&P.zp&&(P=B.contentControlNode)&&r.add(this.qR(P)));return r}i$l(b,h){const r=new vb.a,B=new gp.a,P=this.TFb(b,h);for(let ca=0;ca<P.count;ca++)this.QBd(r,B,P.J(ca).me);b=this.Lei(b,h,!1,!1);for(const ca of b)B.contains(ca.objectId)||
(r.add(ca),B.add(ca.objectId));return r}j$l(b,h){const r=new vb.a,B=new gp.a,P=this.$of(b,h);for(let ca=0;ca<P.count;ca++)this.SZe(r,B,P.J(ca));b=this.Mei(b,h);for(const ca of b)B.contains(ca.objectId)||(r.add(ca),B.add(ca.objectId));return r}Lei(b,h,r,B=!0){const P=new vb.a;b.equals(h)&&(r=!1);const ca=new gp.a;let ra=!1;b=this.TFb(null,b,!0,r);h=this.TFb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Qa=0;Qa<h.count&&!(b.J(r).me.equals(h.J(Qa).me)&&(b.J(r),this.QBd(P,ca,b.J(r).me)&&(ra=!this.Tg.qu(b.J(r).me).ja(Oc.a.s8,
null),B||ra)));Qa++);if(0<P.count&&(B||ra))break}return P}Mei(b,h){const r=new vb.a,B=new gp.a,P=b.node;var ca=h.node;const ra=h.contextId===zc.a.Vc?ca.characterData.length:h.cpEnd;b=this.Lo.a9(P,b.contextId===zc.a.Vc?P.characterData.length:b.cpBegin,b.Fb);h=this.Lo.a9(ca,ra,h.Sb);ca=b.count>h.count?h.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).me.equals(h.J(ca).me)&&this.SZe(r,B,b.J(ca));return r}Pim(b,h){const r=new vb.a;let B=new gp.a;const P=this.TFb(b,h);let ca=0,ra=null;if(b.equals(h))return r;
for(b=0;b<P.count;b++)!P.J(b).Qc||P.J(b).Of&&!this.Tg.RRa(P.J(b).me,P.J(b).Lb.paragraph.id,!0)?P.J(b).Qc||P.J(b).Of&&!this.Tg.RRa(P.J(b).me,P.J(b).Lb.paragraph.id,!1)||(ca--,0>ca?(ca=0,B=new gp.a):!ca&&ra&&P.J(b).me.equals(ra)&&this.QBd(r,B,ra)):(ca||(ra=P.J(b).me),ca++);return r}Qim(b,h){const r=new vb.a;if(b.equals(h)&&b.Fb===h.Sb)return r;let B=new gp.a;b=this.$of(b,h);h=0;let P=null;for(let ca=0;ca<b.count;ca++){const ra=b.J(ca);!ra.Qc||ra.Of&&!this.Tg.RRa(ra.me,ra.Lb.paragraph.id,!0)?ra.Qc||
ra.Of&&!this.Tg.RRa(ra.me,ra.Lb.paragraph.id,!1)||(h--,0>h?(h=0,B=new gp.a):!h&&P&&ra.me.equals(P.me)&&this.SZe(r,B,P)):(h||(P=ra),h++)}return r}Spf(b,h,r){const B=new vb.a;b=r?this.$of(b,h):this.TFb(b,h);h=0;for(r=0;r<b.count;r++){var P=b.J(r);P.zp&&(P.Qc?h++:(h--,0>h?h=0:(P=this.qR(P.contentControlNode))&&B.add(P)))}return B}TFb(b,h,r=!0,B=!0){const P=new vb.a,ca=this.uU(b,h);if(!ca.count)return P;let ra,Qa,mb,Jb;for(let Yb=0;Yb<ca.count;Yb++){ra=0;Qa=ca.J(Yb).characterData.length;mb=Jb=!0;if(b&&
ca.J(Yb).id.equals(b.node.id)){if(b.contextId===zc.a.Vc)continue;0<=b.cpBegin&&(ra=b.cpBegin)}h&&ca.J(Yb).id.equals(h.node.id)&&0<=h.cpEnd&&(Qa=h.cpEnd);Yb||(mb=r);Yb!==ca.count-1||h&&h.contextId===zc.a.Vc||(Jb=B);P.addRange(this.apf(ca.J(Yb),ra,Qa,mb,Jb))}return P}$of(b,h){const r=new vb.a,B=this.uU(b,h);let P,ca,ra;for(let mb=0;mb<B.count;mb++){const Jb=B.J(mb);if(Jb.ra.length){var Qa=Jb.ra.J(Jb.ra.length-1);P=0;ca=Jb.characterData.length;ra=0;Qa=Qa&&Qa.Jb?Qa.Jb.length:0;b&&Jb.id.equals(b.node.id)&&
(P=b.Wj,ra=b.Fb);h&&Jb.id.equals(h.node.id)&&(ca=h.vp,Qa=h.Sb);r.addRange(this.bpf(Jb,P,ca,ra,Qa))}}return r}apf(b,h,r,B=!0,P=!0,ca=!0){const ra=new vb.a;b=b.ra;for(let Qa=0;Qa<b.length;Qa++){if(b.J(Qa).cp<h)continue;if(b.J(Qa).cp>r)break;const mb=b.J(Qa);if(mb.Jb&&0<mb.Jb.length&&(mb.cp!==h||B)&&(mb.cp!==r||P))for(let Jb=0;Jb<mb.Jb.length;Jb++){const Yb=mb.Jb.J(Jb);(ca||Yb.Qc)&&ra.add(Yb)}}return ra}bpf(b,h,r,B,P){const ca=new vb.a;b=b.ra;for(let ra=0;ra<b.length;ra++){if(b.J(ra).cp<h)continue;if(b.J(ra).cp>
r)break;const Qa=b.J(ra);if(Qa.Jb&&0<Qa.Jb.length){let mb=0,Jb=Qa.Jb.length;Qa.cp===h&&-1!==B&&(mb=B);for(Qa.cp===r&&-1!==P&&(Jb=P);mb<Jb&&mb<Qa.Jb.length;mb++)ca.add(Qa.Jb.J(mb))}}return ca}QBd(b,h,r){let B=null;if(h.contains(r)||!(B=this.sj.Eb(r)))return!1;b.add(this.qR(B));h.add(r);return!0}SZe(b,h,r){let B=null;!h.contains(r.me)&&(B=r.contentControlNode)&&(b.add(this.qR(B)),h.add(r.me))}JCj(b,h){let r,B=!1;r=({y6a:h,x6a:b,K$c:B}=this.KCj(b,h,!1,B)).returnValue||B;B&&(r=r||({y6a:h,x6a:b,K$c:B}=
this.KCj(h,b,!0,B)).returnValue);return{returnValue:r,y6a:h,x6a:b}}KCj(b,h,r,B){let P,ca;if(r)return P=ca=null,{returnValue:!1,y6a:ca,x6a:P,K$c:!1};let ra=!1;ca=b;P=h;const Qa=b.cpBegin,mb=h.cpEnd;B=!1;var Jb=r?this.i5h(h):this.SNl(b);let Yb=!1,fc=!1,Mc=0,Wc=0;for(const id of Jb)for(Jb=0;Jb<id.ra.length;Jb++){const Id=id.ra.J(Jb);!fc&&id.id.equals(h.node.id)&&(fc=!0);if(!Yb&&(id.id.equals(h.node.id)&&-1!==mb&&Id.cp>mb||fc&&!id.id.equals(h.node.id)))if(Yb=!0,Mc!==Wc)ra=!0;else return{returnValue:!1,
y6a:ca,x6a:P,K$c:B};if((!id.id.equals(b.node.id)||Id.cp>=Qa||-1===Qa)&&Id.Jb)for(let ve=0;ve<Id.Jb.length;ve++){const $d=Id.Jb.J(ve),be=this.sj.Eb($d.me);if(!be.getValue(Oc.a.u9)||(!$d.Qc||this.Tg.RRa(this.Mg.Fq(be.id,!0),id.id,!0))&&($d.Qc||this.Tg.RRa(this.Mg.Fq(be.id,!1),id.id,!1))){$d.Qc?Mc++:Mc--;if(ra&&Mc===Wc)return{y6a:ca,x6a:P}=this.R$k(b.node,id,b.cpBegin,Id.cp),{returnValue:!0,y6a:ca,x6a:P,K$c:B};!r&&Mc<Wc&&(B=!0,Wc--)}}}return{returnValue:ra,y6a:ca,x6a:P,K$c:B}}R$k(b,h,r,B){let P;h.id.equals(b.id)?
b=0<r||B<Td.ParagraphReader.textLength(h)?P=Se.a.createTextRange(h,r,B):P=Se.a.create(h):(P=0<r?Se.a.createTextRange(b,r,Td.ParagraphReader.textLength(b)):Se.a.create(b),b=B<Td.ParagraphReader.textLength(h)?Se.a.createTextRange(h,0,B):Se.a.create(h));return{y6a:P,x6a:b}}g6l(b){const h=b.cpBegin,r=this.i5h(b);for(let P=r.count-1;0<=P;P--){const ca=r.J(P);for(let ra=ca.ra.length-1;0<=ra;ra--){const Qa=ca.ra.J(ra);if((!ca.id.equals(b.node.id)||Qa.cp<=h||-1===h&&!Qa.cp)&&Qa.Jb){var B=Qa.Jb.length-1;for((Qa.cp===
h||-1===h&&!Qa.cp)&&this.AY&&ca.id.equals(b.node.id)&&(B=b.Fb-1);0<=B;B--){const mb=Qa.Jb.J(B),Jb=this.sj.Eb(mb.me);if(mb.Qc){if(Jb.getValue(Oc.a.u9)&&!this.Tg.RRa(this.Mg.Fq(Jb.id,!0),ca.id,!0))continue;return null}if(!Jb.getValue(Oc.a.u9)||this.Tg.RRa(this.Mg.Fq(Jb.id,!1),ca.id,!1))return this.qR(Jb)}}}}return null}qR(b){if(!b)return null;this.Tg.c8b();return this.L2.iDb(b,this.Dx,this.ji,this.Tg,this.pr,this,this.tfa,this.nga,this.IAb)}uU(b,h){b=this.h5h(b,h,Ou.zGb(12));if(!b)return null;h=new vb.a;
for(const r of b)h.add(r);return h}QNl(b,h){const r=Ou.l2l();return this.h5h(Se.a.create(b.node),Se.a.create(h.node),r)}h5h(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var B=b.node;if(B&&r(B)){var P;return P=new vb.a,P.add(B),P}}B=Object.assign(new hB,{jSi:35,h1i:r});b=b?b.node:null;h=h?h.node:null;P=this.vdm(b,h);if(!P)return null;h=this.TAk(h,r,Ou.kAh,B);return this.MNl(b,h,P,r,Ou.kAh,B)}vdm(b,h){return(b=b?this.Ebi(b):this.Ebi(h))?b.jd(35):this.Tg.S8l()}TAk(b,
h,r,B){if(!b)return null;h(b)||(h=this.NNl(b,h,r,B),h.count&&(b=h.J(h.count-1)));return b}MNl(b,h,r,B,P,ca){b?(b=xd.GraphIterator.eb(b),b.zb(7),r=qc.a.Gs(b,r)):r=qc.a.gp(r);P&&r.xo(P,ca);for(P=new vb.a;r.moveNext()&&(B(r.currentNode)&&P.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return P}NNl(b,h,r,B){b=qc.a.gp(b);r&&b.xo(r,B);for(r=new vb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}Ebi(b){b=xd.GraphIterator.eb(b);return b.zb(35)?b:null}$ni(b,h){b=this.uU(b,h);for(const r of b)if((b=
this.Tg.isf(r))&&b.dia(4))return!0;return!1}yph(b,h=null,r=!1){if(!b)return!1;let B=b.start;var P=b.end;if(!Pd.SelectionEditor.pv(B)&&B.contextId!==zc.a.paragraph||!Pd.SelectionEditor.pv(P)&&P.contextId!==zc.a.paragraph||!this.AY&&({y6a:B,x6a:P}=this.JCj(b.start,b.end)).returnValue||this.AY&&!({start:B,end:P}=this.nTk(B,P)).returnValue)return!1;b.start=B;b.end=P;const ca=this.HMm(B,P);if(this.AY){var ra=this.Doa(b.start,b.end,3);var Qa=this.Doa(b.start,b.end,2)}else ra=this.lL(b.start,b.end,3),Qa=
this.lL(b.start,b.end,2);const mb=ra&&0<ra.count?ra.J(0):null,Jb=Qa&&0<Qa.count?Qa.J(0):null;if(r)return this.uWc(b,0,ra)?!0:!1;if(this.uWc(b,0,ra)){r=(r=Object(Na.a)(jA,this.g6l(b.start)))?this.Tg.qu(r.objectId):null;Qa=this.Tg.tsk(b,mb,r,Qa,b.Au,b.Ez,h);this.Ej.Pfc(Qa);if(b.Of)for(P=this.uU(b.start,b.end),r=0;r<P.count;r++)if(this.AY){ra=mb?mb.objectId:null;const Yb=this.jbi(ra,P.J(r),!0);this.pr.Hua(P.J(r),Qa.id,0,!0,!0,void 0,void 0,void 0,void 0,Yb);ra=this.jbi(ra,P.J(r),!1);this.pr.Hua(P.J(r),
Qa.id,P.J(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ra)}else this.pr.Hua(P.J(r),Qa.id,0,!0,!0),this.pr.Hua(P.J(r),Qa.id,P.J(r).characterData.length,!0,!1);else this.AY?(r=-1===B.Fb?0:B.Fb,this.pr.Hua(b.start.node,Qa.id,B.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.pr.Hua(b.end.node,Qa.id,P.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?r+1:P.Sb)):(this.pr.Hua(b.start.node,Qa.id,b.start.cpBegin,!1,!0),this.pr.Hua(b.start.node,Qa.id,b.start.cpEnd,!1,!1));h||this.Tg.Dio(Qa,b.Of,b.id,
this.Tg.nac(this.Tg.qu(b.Au)),b.type);1===b.type&&this.pr.JSo(b.start.node,B.Wj,B.vp);b.objectId=Qa.id;h=this.Tg.Iwa().currentNode;h.hasProperty(Oc.a.YJc)||h.setValue(Oc.a.YJc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);wn.a.oda&&this.Tg.yGj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Qa);mb&&this.IHj(mb.contentControlNode,b);Jb&&this.IHj(Qa,Jb);ca&&this.ga.Qb(Mb.a.fad,2,b.id);Uw.a.xJh()&&this.KE&&this.KE.fireEvent(3,{node:Qa});return!0}return!1}deleteContentControl(b){if(!this.uWc(b,
3))return t.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Ej.hdd(b.contentControlNode))return!0;b.OJ&&(b.OJ=!1);const h=this.hb.ib.lb;b=b.lF();const r=new ri.Selection(b.toArray(),!0);let B=!1;this.hb.NPb(()=>{this.hb.Ac(r);if(32===this.ga.processAction(Mb.a.QH,2)){if(this.bmh.instance){const P=this.bmh.instance.Sci(h,r,this.hb.ib.lb);this.hb.AUo(new MC.SelectionCollection([P],0))}B=!0}});return B}jza(b,h=!1,r=!1){if(this.uWc(b,2)){if(b.OJ)return t.ULS.sendTraceTag(528537615,
368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const B=wn.a.vr?b.contentControlNode:this.Tg.qu(b.objectId);let P=new vb.a;h&&(P=b.nof());P.add(b);if(r||!this.Ej.hdd(b.contentControlNode)){B&&B.anchor&&this.Tg.ARh(B,h);for(const ca of P)b=this.uU(ca.start,ca.end),this.pr.Xkl(b,ca.objectId);this.V6i(P)}t.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}t.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");
return!1}toj(b,h){if(this.uWc(b,1)){let Qa=!1;h||(Qa=!0,{duo:r,returnValue:h}=this.bHb(b),r&&this.Tg.Iwa().currentNode.setValue(Oc.a.YJc,h));var r=b.f7h().toArray();for(var B=0;B<r.length;B++)this.jza(r[B],!0);r=this.uCo(h);if(b.Of){B=this.uU(b.start,b.end);if(!B.count)return!1;if(1===B.count&&v.AFrameworkApplication.pu)this.pr.Ge(Se.a.createTextRange(B.J(0),0,B.J(0).characterData.length),h);else{var P=this.Tg.c$l(B.J(0));h=B.J(0).u9b();B=this.Tg.QRh(B);B=this.Tg.Lph(P,B,r.length);for(P=0;P<B.count;P++){this.pr.Ge(Se.a.createTextRange(B.J(P),
0,0),r[P]);for(var ca=0;ca<h.count;ca++)this.pr.Hua(B.J(P),h.J(ca),0,!0,!0),this.pr.Hua(B.J(P),h.J(h.count-ca-1),B.J(P).characterData.length,!0,!1)}b.D_o(B.J(0).id,B.J(B.count-1).id);r=this.ME.ne(B.J(0),0);this.hb.Ac(r)}}else{P=0;1<r.length&&t.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;B=h.node;for(var ra=0;ra<B.ra.length&&h.contextId===zc.a.Fd;ra++)if(ca=B.ra.J(ra),ca.cp===h.cpBegin&&ca.blob){P++;for(ra+=1;ra<
B.ra.length;ra++)if(ca=B.ra.J(ra),ca.cp>h.cpBegin&&ca.cp<=h.cpEnd)if(ca.blob)P++;else break;else if(ca.cp>h.cpEnd)break;break}if(0<P&&P+h.cpBegin<h.cpEnd)B=Se.a.createTextRange(h.node,h.cpBegin,h.cpBegin+P),h=Se.a.createTextRange(h.node,h.cpBegin+P,h.cpEnd),this.pr.Ge(h,r[0]),this.pr.Ge(B,"");else if(0<P&&P+h.cpBegin===h.cpEnd)for(this.pr.Ge(b.start,r[0]),r=0;r<B.ra.length;r++){if(P=B.ra.J(r),P.cp===h.cpBegin){P.blob=null;break}}else v.AFrameworkApplication.pu?(r=r.join(" "),this.pr.Ge(b.start,r)):
this.pr.Ge(b.start,r[0])}this.pBb(b,Qa);let mb;this.DOn((mb=new vb.a,mb.add(b),mb));return!0}return!1}pBb(b,h){const r=this.pr.ERc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const B=this.Tg.qu(b.objectId);if(h){h=this.rz.ZC(b.start.node);let P=h.pj(as.a.s1f);P||(P=h.QFa(as.a.oEn));P&&(this.Ce.Lga(r.formatting),this.Ce.l8a(r.formatting,P));B&&(b.OJ=!0)}else B&&b.OJ&&(this.E8n(b,r),b.OJ=!1)}else t.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}E8n(b,
h){b=this.Tg.qu(b.objectId);let r=null;b&&(r=b.ja(Oc.a.XCb,U.a.nil));this.Ce.Lga(h.formatting);r&&!r.equals(U.a.nil)&&(b=this.ji.value.Eb(r),h.formatting=b)}bHb(b){let h=!1;b=b.placeholderText;this.WVm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,duo:h}}FZn(b,h=!0){this.nga&&(h&&this.BZn(b),this.JZn(b))}GZn(b){if(this.nga&&(b=this.lL(b,b,4)))for(const h of b)this.jza(h,!1)}Fnn(b,h){if(h&&!b.Qc&&(this.Tg.c8b(),(b=b.Lb.paragraph.Mc.Eb(b.me))&&b.anchor)){this.Tg.ARh(b);
b=this.L2.iDb(b,this.Dx,this.ji,this.Tg,this.pr,this,this.tfa,this.nga,this.IAb);let r;this.V6i((r=new vb.a,r.add(b),r))}}ZXi(b,h){this.Tg.c8b();b=this.Tg.qu(h.me);const r=this.qR(b);if(r&&r.isValid()&&r.removeWhenEdited){const B=this.Lc.Pc(7);B.Db(b);this.jza(r,!1);h.state=2;B.dispose()}}RYi(b,h){this.Tg.c8b();b=this.Tg.qu(h.me);this.FKm(b)&&(b=b.ja(Oc.a.$w,0),this.ga&&(this.ga.Qb(Mb.a.fad,2,b),Ou.Qd.C1e()))}FKm(b){return b&&b.isConnected&&!b.ja(Oc.a.t8,!1)?wn.a.vr?this.PZd(b)&&!b.Zu:this.PZd(b):
!1}PZd(b){b=this.L2.iDb(b,this.Dx,this.ji,this.Tg,this.pr,this,this.tfa,this.nga,this.IAb);if(!b.isValid())return!1;if(b.Of){if(b.Au.toString()===b.Ez.toString()){var h=this.Tg.qu(b.Au);if(!h)return t.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.ra.length)return this.Jwi(h.ra.J(0),b.objectId)}}else{h=b.start;if(!h)return t.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(h.cpBegin===h.cpEnd)return h=this.Tg.qu(b.Au).ra.nh(h.cpBegin),this.Jwi(h,b.objectId)}return!1}Jwi(b,h){b=b?b.Jb:null;if(!b)return!1;const r=b.AJ(h,!0);return-1<r&&r+1<b.length&&b.J(r+1).me.toString()===h.toString()}Q9i(b){this.TPe.push(b)}uvj(b,h){if(void 0===b||null===b||b.contextId!==zc.a.Fd)return null;b=Se.a.Uc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<Td.ParagraphReader.textLength(b.node)?this.Tg.YUa(b):null}select(b,h){if(b&&!b.equals(U.a.nil)){var r=this.Tg.qu(b);if(r&&
55===r.type){r=this.qR(r);if(r.Of)r=this.JPl(r);else{r=r.start;if(!r)return;r.contextId=zc.a.Fd;r=this.ME.Xn(r)}if(r&&r.length)return this.slj(r.Pa,b,h,!0,!0),this.slj(r.Rc,b,h,!1,!1),this.hb.Ac(r),r}}}ado(b,h){if(!Pd.SelectionEditor.Ze(b)||b.Fb!==b.Sb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Lo.y2a(b.node,b.cpBegin,r,!h))&&h===b.Qc?(h=this.qR(b.contentControlNode),this.select(b.me,!h.isEditable),!0):!1}JPl(b){var h=this.Tg.ZPa(b.Au,!0);b=this.Tg.ZPa(b.Ez,!1);if(!h||!b)return null;h=this.QNl(Se.a.create(h),
Se.a.create(b));if(!h||!h.count)return null;b=new vb.a;for(let r=0;r<h.count;r++){let B;if(12===h.J(r).type)B=r===h.count-1?Se.a.createTextRange(h.J(r),0,Td.ParagraphReader.textLength(h.J(r))):Se.a.create(h.J(r)),this.Nh&&(B.Fb=this.Nh.er(B.node,!0),B.Sb=this.Nh.er(B.node,!1));else if(15===h.J(r).type)B=xr.TableNodeContext.create(h.J(r));else continue;b.add(B)}return new ri.Selection(b.toArray(),!0)}aio(b){if(b&&!b.equals(U.a.nil)&&(this.Tg.c8b(),(b=this.Tg.qu(b))&&55===b.type&&b.isConnected)){var h=
b.ja(Oc.a.t8,!1);b.setValue(Oc.a.t8,!1);h&&this.EUn(b)}}EUn(b){var h=this.Mg.Fq(b.id,!0);h.equals(U.a.nil)||(h=this.Tg.Boa(h,!0))&&(b=this.pr.Opf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Lb,h.formatting=b.nR?b.nR.wf(h):new Kw.a(h,U.a.nil))}J$i(b){if(b=this.g8h(b))for(const h of b)this.Ej.agg()&&(h.OJ=!1),this.jza(h,!1)}d8h(b){const h=new vb.a;if(b=this.g8h(b))for(const r of b)h.add(r.contentControlNode);return h}HZn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.gb.$k(b),r=
this.gb.XC(b);if(this.Nh&&h&&r){b=this.Nh.er(h,!0);const B=this.Nh.er(r,!1);h=Se.a.create(h);r=Se.a.create(r);h.Fb=b;r.Sb=B;if(b=this.Doa(h,r,4))for(const P of b)this.jza(P,!1)}}}TNl(b){var h=this.Mg.Fq(b.id,!0,b.loading);b=this.Mg.Fq(b.id,!1,b.loading);if(h.equals(U.a.nil)||b.equals(U.a.nil))return new vb.a;h=this.Tg.Boa(h,!0);b=this.Tg.Boa(b,!1);return h&&b?this.uU(Se.a.create(h),Se.a.create(b))||new vb.a:new vb.a}ZPa(b,h){return this.Tg.ZPa(b,h)}Rrf(b,h){if(b&&55===b.type&&(b=this.qR(b),b=h?b.start:
b.end)){const r=Se.a.Uc(b.node,h?b.Wj:b.vp);r.Fb=r.Sb=(h?b.Fb:b.Sb)+(h?-1:1);return r}return null}BTl(b){return(b=this.qR(b))?b.start:null}slj(b,h,r,B,P){if((b.contextId===zc.a.Fd||b.contextId===zc.a.Tc||b.contextId===zc.a.paragraph)&&(P=b.node.ra.nh(P?b.Wj:b.vp))&&P.Jb)for(let ca=0;ca<P.Jb.length;ca++){const ra=P.Jb.J(ca);if(ra.me.equals(h)&&ra.zp)if(B&&ra.Qc){b.Fb=r?ca:ca+1;break}else if(!B&&!ra.Qc){b.Sb=r?ca+1:ca;break}}}DOn(b){for(let h=0;h<this.Ich.length;++h)(0,this.Ich[h])(this,new mA(b))}V6i(b){for(let h=
0;h<this.TPe.length;++h)(0,this.TPe[h])(this,new mA(b))}JZn(b){b=Se.a.create(b);if(b=this.lL(b,b,4))for(const h of b)h.Of||this.jza(h,!1)}BZn(b){if(b=b.u9b())for(let r=0;r<b.count;r++){var h=this.Tg.qu(b.J(0));h=this.L2.iDb(h,this.Dx,this.ji,this.Tg,this.pr,this,this.tfa,this.nga,this.IAb);this.jza(h)}}SNl(b){return this.uU(b,null)}uWc(b,h,r=null){let B=!0;try{if(!b)return t.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;t.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",
h,b.isSupported,b.qia));if(!wn.a.vr&&this.mCa&&nq.a.instance.J(1)&&this.mCa.MR(this.Dx.value))return t.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.fSm(h)&&this.gSm(h)&&!this.GKm(b))return!1;if(!r){const ra=this.Y9l(b);ra&&(r=new vb.a,r.add(ra))}var P=this.Tg.gei(b.start.node);const ca=this.Tg.gei(b.end.node);if(P&&ca&&!P.equals(ca)||!P&&ca||P&&!ca)return!1;P=!0;if(r&&0<r.count){if(!r.J(0).isSupported)return!1;P=r.J(0).isEditable}switch(h){case 0:B=
this.eIm(b,P);break;case 1:B=(this.L0||!this.Q_d(b))&&b.isSupported&&b.isEditable&&this.Gvh(b)&&this.Mwi(b);v.AFrameworkApplication.pu||(B=B&&!this.$ni(b.start,b.end));break;case 2:const ra=b.eXm?!0:b.isSupported;B=(this.L0||!this.Q_d(b))&&ra&&b.qia&&P;t.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:B=b.isSupported&&b.qia&&P&&this.Gvh(b)&&this.Mwi(b)&&!this.$ni(b.start,b.end)}}catch(ca){t.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+
", Exception: "+ca),B=!1}return B}gSm(b){return!(v.AFrameworkApplication.pu&&1===b)}fSm(b){return!(this.AY&&(!b||2===b||3===b))}eIm(b,h){if(wn.a.z1f)return this.fIm(b,h);let r=!0;if(!this.L0&&this.Q_d(b))r=!1;else if(this.AY)this.AY?b.Of||Pd.SelectionEditor.pv(b.start)||b.start.contextId===zc.a.Vc?b.Of&&(b.start.contextId!==zc.a.paragraph&&b.start.contextId!==zc.a.Vc||b.end.contextId!==zc.a.paragraph&&b.end.contextId!==zc.a.Vc)&&(r=!1):r=!1:r=h?this.awi(b):!1;else if(!(b.Of||-1!==b.start.cpBegin&&
-1!==b.end.cpEnd&&b.start.equals(b.end)))r=!1;else if(b.Of&&(b.start.contextId!==zc.a.paragraph||b.end.contextId!==zc.a.paragraph||b.start.equals(b.end)&&!Td.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===zc.a.Tc||b.end.contextId===zc.a.Tc||b.start.contextId===zc.a.Vc||b.end.contextId===zc.a.Vc)r=!1;return r}fIm(b,h){return(this.L0||!this.Q_d(b))&&this.gIm(b)&&this.sOm(b)&&h&&!this.MPm(b)&&this.awi(b)?!0:!1}sOm(b){var h;const r=b.start,B=r.contextId,P=null===(h=b.end)||
void 0===h?void 0:h.contextId;return b.Of?B!==zc.a.paragraph&&B!==zc.a.Vc||P!==zc.a.paragraph&&P!==zc.a.Vc?!1:!0:Pd.SelectionEditor.pv(r)||B===zc.a.Vc?!0:!1}g8h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.Nh&&(this.gb.um(h)&&12===h.node.type&&(h.Fb=this.Nh.er(h.node,!0)),this.gb.um(b)&&12===b.node.type&&(b.Sb=this.Nh.er(b.node,!1)));return this.Doa(h,b,4)}Gvh(b){b=b.nof();for(const h of b)if(!h.isSupported||!h.qia)return!1;return!0}GKm(b){if(this.JCj(b.start,b.end).returnValue)return!1;
const h=this.lL(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.Of&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===Td.ParagraphReader.textLength(r.end.node)))||!r.Of&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:
r.end.cpEnd===Td.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Mwi(b){if(b.Of){var h=this.Tg.qu(b.Au),r=this.Tg.qu(b.Ez);let B=null;if(12===h.type&&12===r.type){h=this.Tg.nac(h);h=this.Tg.qu(h);r=this.Tg.nac(r);r=this.Tg.qu(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(B=h)}b=this.uU(b.start,b.end);if(!b.count)return!1;for(const P of b)if(b=this.Tg.nac(P),b=this.Tg.qu(b),!b||!(16!==b.type||B&&b.id.equals(B.id)))return!1}return!0}Q_d(b){return b.Of?!1:(b=b.start.node)?
!b.ja(Oc.a.qlb,!0):!0}gIm(b){return 1!==b.type?!0:b.Au.equals(b.Ez)&&Td.ParagraphReader.Xb(b.start.node)&&!this.qtm(b)?!0:!1}qtm(b){const h=b.start;var r=h.node;const B=r.ra;if(b.Of){if(r.su||r.$oa||r.hasBookmark)return!0;for(var P of B)if(this.eoi(P))return!0;return!1}b=h.Wj;r=h.vp;let ca=P=null;for(const ra of B.uFi(b,r))if(!(ra.cp<b))if(ra.cp===b)P=ra;else if(ra.cp===r)ca=ra;else if(this.eoi(ra))return!0;return this.rtm(h,P,ca)?!0:!1}eoi(b){return Bx(b.Jb)&&Bx(b.Ue)&&Bx(b.$g)&&Bx(b.Hc)&&null==
b.hyperlink&&!b.Bm&&null==b.blob?!1:!0}rtm(b,h,r){if(null==h&&null==r)return!1;const B=b.Fb;b=b.Sb;return null!=h&&(h.Jb&&B<h.Jb.length||null!=h.blob)||null!=r&&r.Jb&&0<b||null!=h&&null!=r&&(nA(h.Ue)&&iB(r.Ue)||nA(h.$g)&&iB(r.$g)||!Bx(h.Hc)&&!Bx(r.Hc)&&[...h.Hc].some(P=>0===P.vf)&&[...r.Hc].some(P=>3===P.vf)||null!=h.hyperlink&&r.Bm)?!0:!1}MPm(b){var h,r;return(null!==(r=null===(h=this.lL(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==r?r:[]).some(B=>1===B.type)?!0:!1}awi(b){if(!b.Of)return!0;
var h=this.Tg.qu(b.Au);b=this.Tg.qu(b.Ez);if(qh.TableCellReader.Xxa(h)||qh.TableCellReader.Xxa(b)||Al.a.Upa(h)||Al.a.Upa(b))return!1;h=this.Tg.nac(h);h=this.Tg.qu(h);b=this.Tg.nac(b);b=this.Tg.qu(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}Y9l(b){if(!b)return null;b=this.Tg.qu(b.objectId);if(!b)return null;b=b.ja(Oc.a.s8,U.a.nil);return b.equals(U.a.nil)?null:(b=this.Tg.qu(b))?this.qR(b):null}i5h(b){return this.uU(null,b)}uCo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}WVm(b){return b&&
""!==b?!1:!0}jbi(b,h,r){h=h.ra.nh(r?0:h.characterData.length);if(!h)return t.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return r?0:h.Jb.length;for(let B=0;B<h.Jb.length;B++){const P=h.Jb.J(B);if(U.a.Cq(P.me,b)&&P.Qc===r)return r?B+1:B}return r?0:h.Jb.length}nTk(b,h){var r=b.node,B=h.node,P=b.contextId===zc.a.paragraph?0:b.cpBegin,ca=h.contextId===zc.a.paragraph?Td.ParagraphReader.textLength(B):h.cpEnd;r=this.Lo.a9(r,
P,b.Fb);B=this.Lo.a9(B,ca,h.Sb);ca=!r||!r.count;P=!B||!B.count;if(ca&&P)return{returnValue:!0,start:b,end:h};if(ca)return{returnValue:this.Hne(b,B.J(B.count-1).me,!0),start:b,end:h};if(P)return{returnValue:this.Hne(h,r.J(r.count-1).me,!1),start:b,end:h};if(r.count===B.count)return r=r.J(r.count-1),B=B.J(B.count-1),{returnValue:r.me.equals(B.me),start:b,end:h};r=(ca=r.count<B.count)?B.J(B.count-1):r.J(r.count-1);return{returnValue:ca?this.Hne(b,r.me,!0):this.Hne(h,r.me,!1),start:b,end:h}}Hne(b,h,r){var B=
b.node;let P;if(r){P=b.contextId===zc.a.paragraph?0:b.cpBegin;var ca=b.Fb}else P=b.contextId===zc.a.paragraph?Td.ParagraphReader.textLength(B):b.cpEnd,ca=b.Sb;B=B.ra.nh(P);if(-1===ca||!B||!B.Jb||!B.Jb.length)return!1;B=B.Jb;if(r)for(r=ca;r<B.length;r++){ca=B.J(r);if(!ca.Qc)break;if(ca.me.equals(h))return b.Fb=r+1,!0}else for(r=ca-1;0<=r;r--){ca=B.J(r);if(ca.Qc)break;if(ca.me.equals(h))return b.Sb=r,!0}return!1}HMm(b,h){return this.vHk(b,h)&&b.Fb===b.Sb&&(b.contextId===zc.a.Tc||b.contextId===zc.a.paragraph&&
!b.node.characterData.length)}vHk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Sb===h.Sb}IHj(b,h){if(b&&h.Of){var r=this.Mg.Fq(b.id,!0),B=this.Tg.Boa(h.Au,!0);r.equals(B?B.id:null)&&this.Mg.sE(b.id,h.objectId,!0);r=this.Mg.Fq(b.id,!1);B=this.Tg.Boa(h.Ez,!1);r.equals(B?B.id:null)&&this.Mg.sE(b.id,h.objectId,!1)}}static get Qd(){return null!=Ou.$Ig?Ou.$Ig:Ou.$Ig=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static zGb(b){return h=>h.type===b}static l2l(){return b=>12===b.type||
15===b.type}static kAh(b,h){return b.Xe===h.jSi||b.parentNode&&h.h1i(b.parentNode)?!1:!0}}Object(n.a)(Ou,"ContentControlOperator",null,[334,10,335]);class bw{constructor(b,h,r){this.Yc=b;this.Dx=h;this.$xb=r}Eki(b){const h=this.AGb();return h&&b&&this.BHb(h,b)?this.hlm(h):null}BHb(b,h,r=!1){if(!b||!h)return!1;do{var B=b.currentNode;if(!B)break;B=B.ja(Oc.a.tac,null);if(B===h||r&&B&&B.includes(h))return!0}while(b.Lf(29));return!1}hlm(b){var h=b.Tb(1);b.sc();b=b.EJ(1);if(!h||!b)return null;h=Fe.SelectionFactory.$el(h,
b);b=Pd.SelectionEditor.Jj(h,!1,!1);return wn.a.oda&&!b?null:Fe.SelectionFactory.Iy(h,b.Rc)}AGb(){const b=this.Yc.Dk();b.set(this.Dx.value);this.$xb.GP(b);return b.Tb(28)&&b.Tb(29)?b:null}hsf(){const b=this.Yc.Dk();b.set(this.Dx.value);this.$xb.GP(b);return b.Tb(28)?b:null}dZl(b){var h=this.AGb();if(!h||!b||!this.BHb(h,b,!1))return null;h.Rd();b=1<h.Wp();h.Rd();h.Rd();h=h.currentNode;return Td.ParagraphReader.Xb(h)?{r$d:h,koi:b}:{r$d:null,koi:b}}U8h(){const b=this.AGb();return this.BHb(b,as.a.UQh,
!0)?b.currentNode.getValue(Oc.a.tac):null}}Object(n.a)(bw,"GlossaryNavigator",null,[331]);class Vw{constructor(b,h,r,B,P,ca){this.pr=b;this.Tg=h;this.jm=r;this.gb=B;this.sh=P;this.nga=ca}F9c(b,h,r){if(!this.nga)return 1;if(!({tableNode:P}=this.MIf(b)).returnValue||!this.sh.IDi(P,h)||this.G$i(b,h))return 2;var B=this.sh.j5h(h);var P=B.J(0).u9b();P&&P.count||(P=new vb.a,P.add(b.objectId));b=this.Tg.QRh(B);r=r.split("\n");h=Object(Na.a)(xd.GraphIterator,this.Tg.isf(h));h=this.Tg.Lph(h,b,r.length);for(b=
0;b<h.count;++b){B=h.J(b);this.pr.Ge(Se.a.createTextRange(B,0,0),r[b]);for(let ca=0;ca<P.count;++ca)this.pr.Hua(B,P.J(ca),0,!0,!0),this.pr.Hua(B,P.J(P.count-ca-1),B.characterData.length,!0,!1)}return 0}G$i(b,h){if(!this.nga)return 1;let r;if(!({tableNode:r}=this.MIf(b)).returnValue||!this.sh.IDi(r,h))return 2;h=this.sh.j5h(h);if(0<h.count&&(h=this.jm.lL(Se.a.create(h.J(0)),Se.a.create(h.J(h.count-1)),2)))for(const B of h)if(B.id!==b.id&&!this.jm.jza(B,!0))return 2;return 0}jec(b){if(!this.nga||!({tableNode:r}=
this.MIf(b)).returnValue)return!1;b=b.nof();for(var h of b)if(!h.qia||!h.isSupported)return!1;if(this.sh.wKm(r))return!1;var r=Object(Na.a)(xd.GraphIterator,this.Tg.isf(r));h=new vb.a;this.gb.Bjb(r,!0,!1,h);for(const B of h)if(0<B.ja(Oc.a.bFb,0)||this.gb.c3a(B).Wx)return!1;return!0}MIf(b){let h=null;return b&&b.Au.toString()===b.Ez.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Tg.qu(b.Au))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}
Object(n.a)(Vw,"TableContentControlEditor",null,[330]);class oA{wKm(b){let h=!1;const r=new xd.GraphIterator;r.set(b);Qg.forEachCellInTable(r,B=>{if(!qh.TableCellReader.hg(B)){let P=Xj.OutlineNavigator.S9(B);for(;P;){if(Zf.OutlineElementReader.Pac(B))return h=!0,!1;P=B.Ri(1)}}return!0});return h}IDi(b,h){const r=new xd.GraphIterator;r.set(h);return qh.TableCellReader.Xxa(h)&&r.zb(14)&&r.jd(14).id===b.id?!0:!1}j5h(b){const h=new vb.a,r=new xd.GraphIterator;r.set(b);b=new vb.a;Td.ParagraphReader.Bjb(r,
!0,!1,b);for(const B of b)h.add(B);return h}}Object(n.a)(oA,"TableReader",null,[329]);class wy{constructor(){this.jm=null}get name(){return"WordEditor.ContentControl"}init(){v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(hA.a.QTa(Object(z.a)(Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").Fnn,"onContentControlRangeChanged")),this.jm=Ya.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),
Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Ya.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.jm&&(this.jm.dispose(),this.jm=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new eB.a(Qd.a.$e)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new Sw(Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();b.ia("WordEditor.ContentControlNodeFactory",
()=>new Qw(Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.Sa("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new Tw(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),new Tl.a,ro.PageNavigator.instance,Ya.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ya.a.instance.resolve("Box4.IOutlineEditor"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),
Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ya.a.instance.Sa("WordEditor.ContentControl.GlossaryEditor"),Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new bw(new Tl.a,new zf.a(()=>
ab.StaticActiveAppFrame.za().jb.Zc),ro.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new Ou(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
lh.a.instance,Ya.a.instance.resolve("Box4.ISelectionFactory"),Qh.PageReader.instance,Ya.a.instance.resolve("Box4.IFormattingEditor"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ya.a.instance.Oa("Box4.IContentControlDataChangedManager"),v.AFrameworkApplication.va,Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"),
Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.Oa("Box4.IContentControlReader"),Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ya.a.instance.Sa("Box4.Actors.IVirtualSelectionMerger"),Ya.a.instance.resolve("Box4.IFeatureHelper"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ya.a.instance.Sa("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new Nu(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ya.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.IContentControlChpHelper"),Ya.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new vy(Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new gB(Ya.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("Box4.TextFormattingHelper"),Ya.a.instance.resolve("Box4.IFormattingEditor"),qe.App.li.Al.Te(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new Vw(Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.resolve("Box4.IParagraphReader"),new oA,v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();v.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new iA(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new bC(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new kA(new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),Ya.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ya.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ya.a.instance.resolve("Box4.TextFormattingHelper"),v.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){L.a.instance.Gc(new wy)}}
Object(n.a)(wy,"ContentControlPackage",null,[1,2]);var cC=c(1432),dC=c(509),ju=c(1791),Gt=c(792);class pA{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(n.a)(pA,"UxManagerMenuActionTelemetryData",null,[]);class Ht extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.r3k=r}}Object(n.a)(Ht,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class sv extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(n.a)(sv,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class ku{constructor(b,h,r,B,P,ca,ra=!1,Qa=null,mb=null,Jb=null,Yb=!1,fc=null,Mc=!1,Wc=!0,id=null,Id=!1,ve=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.t2c=this.g2c=this.GZh=this.onScroll=this.onResize=this.j1=this.vya=this.SHa=this.documentElement=this.kS=this.editingElement=null;this.isFocused=!1;this.JLd=null;this.M0f=this.mFf=!1;this.Uoe=null;this.Fae=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=
B;this.Iqk=P;this.hSa=ca;this.pPa=ra;this.hsj=Qa;this.$na=mb;this.hostServices=Jb;this.Ywo=Yb;this.V_i=fc;this.usj=Mc;this.Vpl=Wc;this.GZh=id;this.showDictationCommandUx=Id;this.source=ve}}Object(n.a)(ku,"UxManagerState",null,[]);var tv=c(1647);class dp{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.Vb=b;this.hb=h;this.bA=r;this.ld=B;this.ge=P;this.Ib=ca;this.Yi=ra;this.sk=Qa;this.YI=mb;this.lVb=Jb;this.rTe=!1;this._state=this.s2g=null;this.shouldIgnoreFocusEvent=Yb=>{var fc;return this.ld.yd.Py&&!this.ld.yd.UU&&
Yb===(null===(fc=this.ld.we)||void 0===fc?void 0:fc.editingElement)};this.sa=new wd.a;this.Hxd=new Rb.a;this.xCd((Yb,fc)=>{dp.Z6m(r,fc.definition,fc.source)});this.Yqh((Yb,fc)=>{dp.Y6m(r,fc.definition,fc.source,fc.r3k)});this.Vb.fe(dp.xPd).fI=!0;v.AFrameworkApplication.va.qa(V.a.oMc,zc.a.view,this.oMc.bind(this))}xCd(b){this.sa.addHandler(dp.PPf,b)}Z8f(b){this.sa.removeHandler(dp.PPf,b)}bPn(b,h){this.sa.raiseEvent(dp.PPf,new sv(b,h))}Yqh(b){this.sa.addHandler(dp.OPf,b)}c2n(b){this.sa.removeHandler(dp.OPf,
b)}aPn(b,h,r){this.sa.raiseEvent(dp.OPf,new Ht(b,h,r))}b0o(b){var h;if(!b.isDismissed&&b.kS){var r=tv.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=tv.b(r);var B=Qd.a.getElementBounds(b.kS);r.width||r.height?r.x+r.width<B.x||r.x>B.x+B.width||r.y+r.height<B.y||r.y>B.y+B.height?this.dismiss():(B=b.target,B.style.left=r.x+"px",B.style.top=r.y+"px",B.style.width=r.width+"px",B.style.height=r.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||t.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(t.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else t.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}N6i(b){b.isDismissed||b.Uoe||(b.Uoe=new Oe.a(2,1,1,()=>{b.Uoe=null;this.b0o(b)},147),this.Ib.Wb(b.Uoe))}SHa(b,h){!b.isDismissed&&b.Vpl&&0<h.bK.length&&(this.dismiss(),t.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}nCk(b){return!!b&&
b.id===dp.Lqk}vya(b,h){if(b.isDismissed||!h||!h.Hb)return!1;h=h.Hb;const r=h.keyCode,B=!b.isFocused&&!!b.menu,P=h.altKey||h.ctrlKey||h.shiftKey;let ca=!1;r===kc.a.l2?(this.dismiss(),t.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):r!==kc.a.Rs&&r!==kc.a.Kw||!B||P||!this.nCk(b.definition)?r!==kc.a.ksb&&r!==kc.a.qpc||!B||P||(this.n4f(b),b.menu?(b.menu.focus(),ca=!0,t.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):t.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),t.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(h.preventDefault(),h.stopPropagation());return ca}g2c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);t.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}t2c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);t.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}j1(b,h){if(b.isDismissed||!h||!h.Hb||!b.menu)return t.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Hb),!b.menu),!1;const r=b.target;b=b.menu.getElementBounds();var B=h.Hb;h=B.clientX;B=B.clientY;r&&dp.Q2i(h,B,Qd.a.getElementBounds(r),16)||b&&dp.Q2i(h,B,dp.HMk(b),4)||this.dismiss();return!1}Uqo(b){var h=tv.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=tv.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=dp.FKc();b.target=h;b.editingElement=this.ld.we.editingElement;b.kS=this.ld.yd.container;b.documentElement=document.documentElement;b.SHa=(r,B)=>{this.SHa(b,B)};b.vya=
r=>this.vya(b,r);b.j1=r=>this.j1(b,r);b.onScroll=()=>{this.N6i(b)};b.onResize=()=>{this.N6i(b)};b.showDictationCommandUx&&(b.g2c=r=>this.g2c(b,r),b.t2c=r=>this.t2c(b,r),this.lVb&&this.lVb.execute(r=>{r.nmo(b.g2c);r.pmo(b.t2c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.Xw(b.SHa);this.Yi.G_(b.onResize);this.ge.ob(Xc.a.mG,b.editingElement,b.vya);b.pPa&&this.sk.ob(Xc.a.Bda,b.documentElement,b.j1);De.a.addHandler(b.kS,"scroll",b.onScroll);b.hSa||this.n4f(b);return!0}HHb(b,
h){const r=!!b.menu;this.aPn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===dp.xPd&&this.Vb.hS(dp.xPd);b.SHa&&this.hb.jZ(b.SHa);b.vya&&b.editingElement&&this.ge.uc(Xc.a.mG,b.editingElement,b.vya);this.lVb&&this.lVb.execute(B=>{b.showDictationCommandUx&&(B.g7n(),B.h7n());B.Gmj(!1,b.showDictationCommandUx)});b.j1&&b.documentElement&&b.pPa&&this.sk.uc(Xc.a.Bda,b.documentElement,b.j1);
b.onScroll&&b.kS&&De.a.removeHandler(b.kS,"scroll",b.onScroll);b.onResize&&this.Yi.cea(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.kS=null;b.SHa=null;b.vya=null;b.j1=null;b.onScroll=null;b.onResize=null;b.g2c=null;b.t2c=null;r&&b.$na&&(b.mFf?b.M0f=!0:b.$na(b.JLd))}w3a(b,h){var r;if(!h)return!1;switch(h.actionType){case Eo.b.Toggle:if(h.objectFulfillment===dp.hMo)return this.rTe=!this.rTe,this.gqg(),this.kMc(b),!0;if(h.objectFulfillment===
dp.lMo)return{value:r}=this.Hxd.Fc(h.suggestionGroup.type,!1),this.Hxd.Z(h.suggestionGroup.type,!r),this.kMc(b),!0;break;case Eo.b.GiveFeedback:if(ju.a.NLm(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||Gt.a.cWm(h.objectName))break;this.focus();this.gqg();this.kMc(b);return!0;case Eo.b.RevealSuggestions:this.kMc(b)}b.mFf=!0;h=b.Iqk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.mFf=!1;h&&this.kMc(b);b.M0f&&(b.M0f=!1,b.$na(b.JLd),b.JLd=null);return h}kMc(b){b.j1&&b.documentElement&&
b.pPa&&(this.sk.uc(Xc.a.Bda,b.documentElement,b.j1),b.pPa=!1)}Ruo(b,h){return b.id===dC.a.Peb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}GDj(b){var h;if(this.Uqo(b)){var r=1;v.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var B=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(B=b.definition.suggestionGroups[0].type,B=this.Hxd.nb(B)?this.Hxd.J(B):b.Ywo);h=!1;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:P=>this.w3a(b,P),onDismiss:P=>{this.HHb(b,P)},keepCurrentFocus:b.hSa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.rTe,showDescription:B,showEditorButton:b.usj,showEditorBranding:this.Ruo(b.definition,b.usj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.GZh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.V_i&&b.V_i(r);this.bA.createContextualUi(r).then(P=>{this.bPn(b.definition,b.source);b.menu=P;t.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.hsj&&b.hsj();this.lVb&&9!==b.source&&this.lVb.execute(ca=>ca.Gmj(!0,b.showDictationCommandUx))}).catch(P=>{this.HHb(b,{ffp:cC.a.Unknown});t.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",P)});0<b.Fae&&t.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.Fae)}else 5<
++b.Fae?(t.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Ib.Wb(new Oe.a(2,1,Math.pow(3,b.Fae),()=>{b.isDismissed||this.GDj(b)},146))}get fE(){return!!this._state&&!this._state.isDismissed}set rhe(b){this.s2g=b}get WQm(){return this.s2g}Cpg(b,h){this.fE&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.fE?this._state.definition:null}set definition(b){this.fE&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.fE&&this._state.menu&&(this._state.isFocused||this.n4f(this._state),this._state.menu.focus())}gqg(){this.fE&&this._state.menu&&this._state.menu.updatePosition()}n4f(b){this.Vb.FL(dp.xPd,!1);b.isFocused=!0}mka(b,h,r,B,P,ca=null,ra=null,Qa=null,mb=!1,Jb=null,Yb=!1,fc=!0,Mc=null,Wc=!1,id=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Id,ve;if(!({paragraphNode:ve,start:b,end:Id}=dp.IPo(b)).returnValue)return!1;this._state=new ku(ve,b,Id,h,
r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id);this.GDj(this._state);return!0}mQb(b){this._state&&(this._state.JLd=b)}oMc(b,h,r){if(1===r)return this.fE?32:0;this.fE&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static Z6m(b,h,r){r=new pA(r);b.logAction({actionType:Eo.b.SessionStart,engagement:Eo.a.Try,objectName:dp.dzj,objectId:h.id,data:r});if(h.suggestionGroups)for(const B of h.suggestionGroups)b.logAction({actionType:Eo.b.Presented,
engagement:Eo.a.See,objectName:B.type,objectId:B.id,data:r})}static Y6m(b,h,r,B){r=new pA(r);b.logAction({actionType:Eo.b.SessionEnd,engagement:Eo.a.None,objectName:dp.dzj,objectId:h.id,data:r},B)}static FKc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static HMk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static Q2i(b,h,r,B){const P=r.y-B,ca=r.x+r.width+B,ra=r.y+r.height+B;return r.x-B<=b&&b<=ca&&P<=h&&h<=ra}static IPo(b){let h,r;if(!b||!Td.ParagraphReader.Xb(b.node)||
b.contextId!==zc.a.Tc&&b.contextId!==zc.a.Fd&&b.contextId!==zc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==zc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}Afc(){this.YI&&this.YI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}dp.Lqk="ActionSet";dp.dzj="IntentGroup";dp.xPd="CanvasContextualUxReact";dp.hMo="Context";dp.lMo="Description";dp.PPf="MenuDidOpen";dp.OPf="MenuDidClose";
Object(n.a)(dp,"UxManager",null,[]);class NC{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=v.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(64)||oo.a.PGa()||v.AFrameworkApplication.K.$("RewriteIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasContextual")).then(()=>{this.W.ia("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:v.AFrameworkApplication.uiCulture,dataCulture:v.AFrameworkApplication.dataCulture,isRightToLeft:v.AFrameworkApplication.isRtl,ulsLogger:new Tm.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Sa("Common.IInProductMessagingUIManager").execute(r=>{r.hIi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async r=>{this.W.Sa("Common.ISystemInitiatedFeedback").execute(B=>B.logActivity(r,null))}})).ha();this.W.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new dp(kb.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Hb.InteractiveViewManager.instance,Tb.KeyInputManager.instance,v.AFrameworkApplication.lc,
v.AFrameworkApplication.ta,v.AFrameworkApplication.ta.X1,this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.Sa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Tm.a})).ha(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),
this.W.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new Tm.a})).ha(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new Tm.a})).ha(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(r=>{t.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",
r)})}dispose(){}static main(){L.a.instance.Gc(new NC)}}Object(n.a)(NC,"PackageManager",null,[1,2]);class zD{constructor(b,h,r,B){this.tEm=(P,ca,ra)=>{P=null;ca.view.ue&&(P=ca.view);if(!P||!P.mb)return 8;if(!this.MI.hGf())return 2;if(1===ra)return 32;this.Dfk.nal();return 32};this.NNi=(P,ca,ra)=>{let Qa=null;ca.view.ue&&(Qa=ca.view);if(!Qa||!Qa.mb)return 8;if(!this.MI.hGf())return 2;if(1===ra)return 32;if(1!==this.MI.X$b(this.hb.ib,!0).count)return 2;ca=new sg.GraphTransaction(15);try{if(ca.Db(Qa.ed),
!this.MI.LQo(P===V.a.nPf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.hb=h;this.MI=r;this.Dfk=B}Ub(){this.ga.qa(V.a.pYd,zc.a.view,this.tEm);this.ga.qa(V.a.nPf,zc.a.view,this.NNi);this.ga.qa(V.a.ONi,zc.a.view,this.NNi)}}Object(n.a)(zD,"IntelligentPlaceholderActor",null,[]);class eC{constructor(){this.Hrc=new Rb.a;this.Mid=new Rb.a}Drk(b,h){let r;({value:r}=this.Hrc.Fc(b,r)).returnValue||this.Hrc.Z(b,r=new fa.a);r.add(h)}isk(b,h){this.Mid.nb(b)&&t.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");
this.Mid.Z(b,h)}Brk(b,h,r){this.Drk(b,h);this.isk(h,r)}SPl(b){let h;return({value:h}=this.Hrc.Fc(b,h)).returnValue?h:null}NSl(b){let h;return({value:h}=this.Mid.Fc(b,h)).returnValue?h:null}N1n(b){let h;if(({value:h}=this.Hrc.Fc(b,h)).returnValue){for(const r of h)this.Mid.remove(r);this.Hrc.remove(b)}else t.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(n.a)(eC,"IntelligentPlaceholderAtMentionManager",null,[574]);var AD=c(1699);class BD extends AD.a{constructor(b,h){super(b,
h)}get key(){return"FOLLOW UP"}get Ku(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}Lrj(b){return!b.ja(Oc.a.UG,!1)}hQa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(n.a)(BD,"IntelligentPlaceholderDetailsProvider",AD.a,[]);var jB=c(1844),OC=c(2064),xz=c(1848);class iD{constructor(){this.eBa=""}Yca(b){this.eBa+=b}RCf(b){this.eBa+=b}tCf(b){this.eBa+=b}insertImage(b){this.eBa+=b}cti(b){this.eBa+=b}}Object(n.a)(iD,"PlainTextFormatCreator",null,[1094]);
var CD=c(1638),np=c(2063);c(329);var f=c(1698),w=c(1535);class F{constructor(){this.muc=new Rb.a}contains(b){return this.muc.nb(F.XJf(b))}add(b){this.muc.Z(F.XJf(b),b)}remove(b){this.muc.remove(F.XJf(b))}KSo(b){for(const h of b.muc)this.add(h.value)}BZh(){const b=new vb.a;for(const h of this.muc)b.add(h.value.Lj);return b}static XJf(b){return b.Lj.toString()}}Object(n.a)(F,"CommentRangeSet",null,[]);class Z extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(n.a)(Z,"OnFollowUpEventArgs",
Sys.EventArgs,[]);class ja extends Z{constructor(b,h){super(b);this.kEn=h}}Object(n.a)(ja,"OnCreateEventArgs",Z,[]);class Ja extends Z{constructor(b,h){super(b);this.WTm=h}}Object(n.a)(Ja,"OnResolveEventArgs",Z,[]);var gb=c(220);class ub{}ub.rre="MentionExperienceDegraded";Object(n.a)(ub,"AtMentionsConstants",null,[]);class Sb{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.K0c=b;this.yIk=h;this.$bd=r;this.HFd=B;this.mb=P;this.Nl=ca;this.IYd=ra;this.eui=Qa;this.Hv=mb;this.C3b=Jb;this.tTa=null;this.Stn=
(Yb,fc,Mc)=>{t.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Yb=this.IYd.b4a(Yb,Mc.displayName,Mc.email,Mc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,fc),!0);Yb?t.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.C3b.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:ub.rre,isInternal:!0})};this.Esn=(Yb,fc)=>{t.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");
fc&&this.C3b.Sv(V.a.pUk);this.IYd.wqm(Yb.id,fc)};this.won=()=>{this.Nl.yd.Py&&!this.Nl.yd.UU&&this.Nl.we.Dhf?this.vCh=!0:(this.K0c.reset(),t.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.gvn=()=>{t.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Fuk()};this.Dsn=(Yb,fc,Mc,Wc=new Map)=>{Wc=Object.assign(new sb.a,{extendedProperties:Wc});this.C3b.logKpiFailure("LPPWordEditorKPI",Yb,{isIntentional:fc,isInternal:Mc,additionalValues:Wc},{name:ub.rre,
errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:fc,isInternal:Mc,additionalValues:Wc})};(b=Ya.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(gb.a.Mua,this.H8n.bind(this))}F0d(){return!!this.tTa}H8n(){this.F0d()&&this.vCh&&(this.tTa.updateInputText(this.zZc,!1),this.vCh=!1)}ariaNotify(b,h){this.Hv.sendNotification(b,h)}Fuk(){const b=this.Nl.we.editingElement;if(b){var h=b.getAttribute(qf.a.eHc);b.setAttribute(qf.a.eHc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else t.ULS.sendTraceTag(51218125,
323,15,"Cannot find editing element")}d1n(){const b=this.Nl.we.editingElement;if(b){var h=b.getAttribute(qf.a.eHc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(qf.a.eHc,h.join(" ")):b.removeAttribute(qf.a.eHc)):t.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else t.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}hYk(){this.d1n();this.tTa&&this.tTa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");
b&&document.body.removeChild(b);this.tTa=null;this.eui.Plj(!0)}xde(){this.K0c.H7f(()=>{this.hYk()});this.K0c.x7f((b,h)=>{this.zZc=b;if(this.tTa)1<this.zZc.length&&"@"===this.zZc.trimEnd()?(this.C3b.Sv(V.a.oUk),this.K0c.reset()):this.tTa.updateInputText(this.zZc,!1);else if(this.C3b.logKpiUsage("LPPWordEditorKPI",0),this.C3b.Sv(V.a.txn),(b=this.K0l(h))&&b.height){h=b.y;const r=b.height,B=document.createElement("div");B.id="PeoplePicker";B.style.position="absolute";B.style.top=h-5+"px";B.style.left=
b.x+"px";B.style.height=r+10+"px";document.body.appendChild(B);this.yIk.createPeoplePicker({editingElementId:this.Nl.we.editingElement.id,containerElement:B,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.Stn,onPermissionsReceivedCallback:this.Esn,onDismiss:this.won,onShow:this.gvn,onFailure:this.Dsn}).then(P=>{P.updateInputText(this.zZc,!1);this.tTa=P;this.eui.Plj(!1)})}});this.K0c.y7f(b=>{if(this.tTa)this.tTa.onKeyDown(b.Hb.rawEvent)})}K0l(b){var h=this.mb.ib;if(!h)return null;
h=h.lb;if(!h)return null;h=h.Pa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Na.a)(112,h);if(!h)return null;h=Object(Na.a)(209,h.Aj(this.Nl.yd.$b));if(!h)return null;h=Object(Na.a)(94,h);if(!h)return null;let r=null;try{r=this.$bd.Q_(this.HFd.x9b(2,b),h,!1,!1,!1,!1)}catch(B){t.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",B)}return r}}Object(n.a)(Sb,"WordEditorAtMentionsHandler",null,[56]);var mc=c(1527);class Uc{constructor(b,h,
r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id){this.ga=b;this.Yc=h;this.aNa=r;this.hb=B;this.kq=P;this.Md=ca;this.zD=ra;this.Fod=Qa;this.Vd=mb;this.zq=Jb;this.ZWj=fc;this.ji=Mc;this.Lc=Yb;this.sa=new wd.a;this.Sg=Wc;this.AMg=id;w.a.x0e((Id,ve)=>{this.UG(ve.commentNode,!0)&&this.sa.raiseEvent(Uc.m2c)})}mrh(b){this.sa.addHandler(Uc.VUi,b)}Vyk(b){this.sa.addHandler(Uc.gYi,b)}Byk(b){this.sa.addHandler(Uc.urn,b)}x0e(b){this.sa.addHandler(Uc.m2c,b)}UG(b,h){let r=b.ja(Oc.a.UG,!1);h&&(r=r&&!b.ja(Oc.a.Qba,!1));return r}tdc(b){return this.kq.tdc(b)}C7l(b){for(const h of b)for(const r of h)if(Uc.lJf(r.contextId))return r.node.Mc;
return null}Qdm(b,h,r){const B=new F,P=b.Mc;for(let ca=0;ca<b.ra.length;ca++){const ra=b.ra.J(ca);if(ra.cp>=h)break;if(ra.Ue&&ra.Ue.length)for(let Qa=0;Qa<ra.Ue.length;Qa++){const mb=ra.Ue.J(Qa);this.UG(P.Eb(mb.Lj),r)&&(mb.Qc?B.add(mb):B.remove(mb))}}return B}Rdm(b,h,r,B){const P=new F,ca=b.Mc;for(let ra=0;ra<b.ra.length;ra++){const Qa=b.ra.J(ra);if(Qa.cp>r)break;if(Qa.Ue&&Qa.Ue.length)for(let mb=0;mb<Qa.Ue.length;mb++){const Jb=Qa.Ue.J(mb);this.UG(ca.Eb(Jb.Lj),B)&&(Jb.Qc?Qa.cp<r&&P.add(Jb):Qa.cp<=
h&&P.remove(Jb))}}return P}hhi(b,h){let r;const B=b.node;b.contextId!==zc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=B.characterData.length);return r===b?this.Qdm(B,r,h):this.Rdm(B,r,b,h)}dSc(b,h){return Uc.lJf(b.contextId)?this.hhi(b,h).BZh():new vb.a}X$b(b,h){const r=new F;for(const B of b)for(const P of B)Uc.lJf(P.contextId)&&r.KSo(this.hhi(P,h));return r.BZh()}hGf(){var b=this.hb.ib;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Pa.node;return Td.ParagraphReader.Xb(b)&&!Td.ParagraphReader.wva(b)&&
this.kq.glb(this.ga,!0)?!0:!1}eti(b,h){if(!this.hGf())return null;if(this.kq.vsm())return t.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var B=this.hb.ib.J(0).Pa;B.contextId===zc.a.Tc?(b=b?Pd.SelectionEditor.j0(B,!1):null)&&b.Zw&&b.Pa.contextId===zc.a.Fd?this.hb.Ac(b):(this.Md.Ge(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.hb.Ac(Fe.SelectionFactory.mJ(B.node,B.cpBegin,B.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):
r=!0;this.Sg.$Db||jB.a.instance.fVc();b=this.kq.tDb(this.hb.ib.lb);if(!b)return null;this.tdc(b)&&this.AMg.Sv(eb.a.yHa,{succeeded:!0,p9a:29});var P=this.Yc.Rf(b);const ca=P.Tb(1);if(!ca||393229!==ca.Oc)return null;P=P.Tb(2);if(!P||393230!==P.Oc)return null;this.ypg(b.Mc,b.id);this.sa.raiseEvent(Uc.VUi,new ja(b,h));r&&(h=B.node,B=B.contextId!==zc.a.paragraph?B.cpEnd:h.characterData.length,this.hb.Ac(Fe.SelectionFactory.mJ(h,B,B)));return b}pYd(b){return!!this.eti(!0,b)}rVc(b,h,r,B,P,ca){if(0>h)return!1;
B="@"+B;const ra=B+" ",Qa=new sg.GraphTransaction(15);try{Qa.Db(b);this.Md.Ge(Se.a.createTextRange(b,h,r),ra);this.Vd.yg&&(this.zq.K8e(b,h,h+B.length),this.zq.yra(b,h+B.length,h+ra.length,1));const mb=this.zD.fF(Se.a.createTextRange(b,h,h+B.length),"mailto:"+P,!1,!0,!1);if(!mb)return!1;const Jb=mb.mw;if(!Jb)return t.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.hb.Ac(Fe.SelectionFactory.mJ(b,h,h+B.length));const Yb=this.eti(!1,2);if(!Yb)return!1;
ca&&this.Fod.Brk(ca,Jb,Yb.id);this.hb.Ac(Fe.SelectionFactory.ne(b,h+ra.length))}finally{Qa&&Qa.dispose()}return!0}b4a(b,h,r,B){const P=this.hb.qg;return Pd.SelectionEditor.Ze(P)?this.rVc(P.node,P.cpBegin-b,P.cpBegin,h,r,B):!1}Q$l(b){if(1===b.length&&b.J(0).Zw&&(b=b.J(0).Pa,b.contextId===zc.a.Tc&&Td.ParagraphReader.Xb(b.node))){const h=b.node;for(let r=0;r<h.ra.length;r++){const B=h.ra.J(r);if(B.cp===b.cpBegin){b=B.cUd(!0,!0);if(0<b.length)return b[0].Lj;break}}}return null}eDb(b,h,r){return this.kq.yKc(b,
h,r).returnValue}BQd(b,h,r,B,P){let ca=!1;const ra=b.characterData;if(h>=ra.length||r>ra.length||r<h)return{returnValue:!1,VPa:ca};let Qa=h,mb=null;for(let Yb=0;Yb<b.ra.length;Yb++){const fc=b.ra.J(Yb),Mc=fc.cp;if(!(Mc<h)){if(fc.Bm&&mb)try{const Wc=ra.substring(Qa,Mc),id=new OC.a;id.fullName=Wc.startsWith("@")?Wc.substr(1):Wc;f.a(mb,id);const Id=new xz.a;f.b(mb,Id);P&&(Id.contentId=this.ZWj.Hnf());B.tCf(Wc,id,Id);ca=!0;mb=null;Qa=Mc}catch(Wc){var Jb=Object.assign(new sb.a,{extendedProperties:new Map});
Jb.extendedProperties.set("exception",Wc.message);this.AMg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Jb},{name:ub.rre,isInternal:!0,additionalValues:Jb})}Mc<=r&&!mb&&(Jb=Math.min(Mc,r),Jb>Qa&&B.Yca(ra.substring(Qa,Jb)),Qa=Mc);fc.hyperlink&&fc.hyperlink.SG&&(mb=fc.hyperlink);if(Mc>=r)break}}return{returnValue:!0,VPa:ca}}u5h(b,h,r,B,P=-1){var ca=!1,ra=b.Eb(h),Qa=b.Eb(mc.k(ra));ra=b.Eb(mc.h(ra));P=0<P?P:Number.MAX_VALUE;b=this.eDb(Qa,h,!0);h=this.eDb(ra,
h,!1);if(-1===b||-1===h)return{returnValue:!1,VPa:ca};if(Qa===ra)return this.BQd(Qa,b,h,r,B);const mb=this.aNa.Nna(Qa,!1,!1);if(!mb)return{returnValue:!1,VPa:ca};Qa=new vb.a;let Jb=0;do Qa.add(mb.ex),Jb+=mb.ex.characterData.length;while(mb.ex!==ra&&mb.h9()&&Jb<P);for(P=0;P<Qa.count;P++)if(ca=Qa.J(P),ra=ca.characterData,P)if(P===Qa.count-1){if(!({VPa:ca}=this.BQd(ca,0,h,r,B)).returnValue)return{returnValue:!1,VPa:ca}}else{if(!({VPa:ca}=this.BQd(ca,0,ra.length,r,B)).returnValue)return{returnValue:!1,
VPa:ca};r.Yca("\n")}else{if(!({VPa:ca}=this.BQd(ca,b,ra.length,r,B)).returnValue)return{returnValue:!1,VPa:ca};r.Yca("\n")}return{returnValue:!0,VPa:ca}}AQd(b,h){const r=new iD;return this.u5h(b,h,r,!1,-1).returnValue?r.eBa:null}YNd(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(mc.h(r));if(!b)return null;h=this.eDb(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!E.a.qda(r.charAt(h))){r=this.Lc.Pc(15);try{r.Db(b),this.Md.Ge(Se.a.Uc(b,h)," ")}finally{r&&r.dispose()}}return Fe.SelectionFactory.ne(b,
h+1)}ypg(b,h){const r=b.Eb(h),B=new CD.a;this.u5h(b,h,B,!0).returnValue&&(B.Yca("\n"),this.kq.HFj(r,B.yaa),this.sa.raiseEvent(Uc.ywn))}Tdo(b,h){for(const r of b){if(r.contains(h))return!0;for(const B of r)for(const P of h)if(B.node===P.node&&B.Wj>=P.Wj)return!0}return!1}zRh(b,h,r,B,P){const ca=this.hb.ib.clone(),ra=new Mv.a(ab.StaticActiveAppFrame.za().jb.rc);b=Fe.SelectionFactory.ne(b,h);r=Se.a.Uc(r,B);b=Fe.SelectionFactory.Iy(b,r);this.hb.Ac(b);r=!this.Tdo(ca,b);return 32===this.ga.Mf(ra,Mb.a.QH,
2,!0,null,null)?(r?this.hb.oZ(ca):P!==U.a.nil&&(P=this.YNd(this.ji.value,P),this.hb.Ac(P)),!0):!1}H_n(b,h){var r=b.Eb(h);const B=b.Eb(mc.k(r));b=b.Eb(mc.h(r));if(B===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var P=B.characterData.indexOf(r);-1!==P&&this.zRh(B,P,b,P+r.length,h)}}JRh(b,h,r){var B=b.Eb(h);if(!B)return!1;const P=b.Eb(mc.k(B));b=b.Eb(mc.h(B));B=this.eDb(P,h,!0);const ca=this.eDb(b,h,!1);if(-1===B||-1===ca||!this.zRh(P,B,b,ca,U.a.nil))return!1;r&&
this.TRh(h);return!0}TRh(b){this.kq.C8f(b,!0)}LQo(b){var h=this.C7l(this.hb.ib);if(!h)return!1;const r=this.X$b(this.hb.ib,!0);if(1!==r.count)return!1;const B=h.Eb(r.J(0));if(b)h=this.JRh(h,r.J(0),!1);else{const P=mc.k(B),ca=mc.h(B);U.a.Cq(P,ca)||t.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.N7k(r.J(0));h.Eb(P).nl(16,!0);h=!0}h&&(B.setValue(Oc.a.Qba,!0),this.sa.raiseEvent(Uc.gYi,new Ja(B,b)));return h}sxh(b,h){b=this.X$b(this.hb.ib,
!1);h.So[Uc.tTh]=!!b.count}nWi(b,h){if(h.So[Uc.tTh]&&Td.ParagraphReader.Xb(h.clone)&&(h=h.clone,b=h.Mc)&&(h=Se.a.createTextRange(h,0,h.characterData.length),h=this.dSc(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Oc.a.UG,!1)}yUl(b,h,r){let B;const P=({PIc:mb}=this.kq.yKc(h,r,!0)).returnValue;r=({PIc:B}=this.kq.yKc(h,r,!1)).returnValue;let ca=null,ra=-1,Qa=-1;for(;mb<B;mb++){const Jb=h.ra.J(mb);if(Jb.hyperlink&&Jb.hyperlink.SG&&Jb.hyperlink.mw===b){ca=Jb.hyperlink;ra=Jb.cp;break}}if(!ca||
ra<P)return{returnValue:!1,nLh:ra,mLh:Qa};for(b=mb;b<h.ra.length;b++){var mb=h.ra.J(b);if(mb.cp>r)break;if(mb.IU){Qa=mb.cp;break}}return{returnValue:-1!==Qa,nLh:ra,mLh:Qa}}J0n(b){var h=this.Fod.NSl(b);if(h){var r=null;ab.StaticActiveAppFrame.za()&&(r=ab.StaticActiveAppFrame.za().jb.Zc.xd);if(r){var B=r.Eb(h);h=r.Eb(mc.k(B));var P=r.Eb(mc.h(B));if(h!==P)t.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({nLh:b,mLh:P}=this.yUl(b,h,B.id)).returnValue){var ca=new sg.GraphTransaction(7);
try{ca.Db(h);const ra=Se.a.createTextRange(h,b,P);this.Md.Ge(ra,"");this.ypg(r,B.id)}finally{ca&&ca.dispose()}this.hb.ib&&0<this.hb.ib.length?(r=this.hb.ib.J(0).Pa,r.node===h?t.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):t.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):t.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.Ac(Fe.SelectionFactory.ne(h,b))}else t.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else t.ULS.sendTraceTag(50954438,
323,15,"Unable to find object space for removing mention")}else t.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}wqm(b,h){if(!h){h=this.Fod.SPl(b);if(!h){t.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const r of h)this.J0n(r)}this.Fod.N1n(b)}INl(){jB.a.instance.fVc();const b=new vb.a;for(const r of this.kq.H1e)if(r.Zq!==np.a.beingCreated){var h=U.a.If(r.objectId);h=this.ji.value.Eb(h);this.UG(h,!0)&&b.add(h)}return b}sdo(b){b=this.kq.Tuf(b);
this.hb.Ac(b)}N7k(b){b?this.ji.value.Eb(b).setValue(Oc.a.UG,!1):t.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static lJf(b){return b===zc.a.Fd||b===zc.a.Tc||b===zc.a.paragraph}}Uc.tTh="DisableNestedIntelligentPlaceholder";Uc.VUi="CreateIntelligentPlaceholder";Uc.gYi="ResolveIntelligentPlaceholder";Uc.ywn="UpdateIntelligentPlaceholder";Uc.m2c="DeleteIntelligentPlaceholder";Uc.urn="MentionAddedToFollowUpEventKey";Object(n.a)(Uc,"IntelligentPlaceholderEditor",
null,[570,571,572]);class od{constructor(b,h,r,B){this.rta=!1;this.zs=!0;this.ge=null;this.tOa=P=>{if(!this.zs||!this.hTk(P,this.hb.ib))return!1;P.Hb.preventDefault();P.Hb.stopPropagation();this.ld.yd&&this.ld.yd.CNc(!1);P=this.YNd(this.hb.ib);if(!P)return!1;this.hb.Ac(P);return!0};this.ld=b;this.ji=h;this.hb=r;this.n7=B}Afb(b,h){this.rta||(b.Cxa?(this.Bfb(h),this.rta=!0):b.vga(()=>{this.rta||(this.Bfb(h),this.rta=!0)}))}dispose(){this.ge&&this.ge.uc(Xc.a.mG,this.ld.we.editingElement,this.tOa)}Bfb(b){this.ge=
b;this.ld.yd.$i&&this.ge.ob(Xc.a.mG,this.ld.we.editingElement,this.tOa)}hTk(b,h){if(b.Hb.keyCode!==kc.a.Kw&&b.Hb.keyCode!==kc.a.Rs||1!==h.length||!h.J(0).Zw)return!1;var r=this.n7.X$b(h,!0);if(1!==r.count)return!1;const B=h.J(0).Pa.node;if(!Td.ParagraphReader.Xb(B))return!1;b=this.n7.eDb(B,r.J(0),!0);r=this.n7.eDb(B,r.J(0),!1);return h.J(0).Pa.cpBegin<b||h.J(0).Pa.cpEnd>r?!1:!0}YNd(b){b=this.n7.X$b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.n7.YNd(this.ji.value,b)}Plj(b){this.zs=b}}Object(n.a)(od,
"IntelligentPlaceholderKeyboardListener",null,[569,10]);class Wd{constructor(b,h){this.lGm=r=>{1===r&&this.ga.processAction(eb.a.yHa,2);2===r&&(this.cfh.instance?this.cfh.instance.Eoc("https://go.microsoft.com/fwlink/?linkid=2154656")&&E.a.vP("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):t.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new ma.a,
{name:"DialogResult",int64:r})];ne.d(V.a.n2h,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.cfh=h}nal(){const b=new Wh.StandardDialog;b.Cd=11;b.ye(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.ye(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.sv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.lGm);ne.a("FollowUpsPhaseOutDialogShown")}}Object(n.a)(Wd,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var oe=
c(1505);class Ee{constructor(b,h,r,B,P,ca){this.C7=this.POe=null;this.v5=()=>{this.C7||(this.C7=new Oe.a(3,1,0,()=>{this.C7=null;this.nWd(this.hb.ib)},130),this.Ib.Wb(this.C7))};this.Lc=b;this.MI=h;this.hb=r;this.Ib=B;this.kXe=P;this.ji=ca;this.Y2=new Fd.a;this.Oq=new oe.a;this.Tah=new bd.a(this.Y2);this.MI.mrh((ra,Qa)=>{this.Muk(Qa.commentNode)})}Muk(b){b=b.id;const h=this.hfi(this.ji.value,b);h&&this.Oq.Z(b,h)}hfi(b,h){const r=b.Eb(h);return!r||this.MI.tdc(r)?null:this.MI.AQd(b,h)}DNk(b){const h=
new oe.a;var r=this.MI.X$b(b,!0);if(!r)return h;b=this.ji.value;for(const B of r)(r=this.hfi(b,B))&&h.Z(B,r);return h}C8f(b){if(this.POe){const h=this.Lc.Pc(15);try{h.Db(this.kXe()),this.MI.TRh(this.POe)}finally{h&&h.dispose()}}this.POe=b?this.MI.Q$l(b):null}Yqm(b){const h=this.ji.value;if(b=b?this.DNk(b):new oe.a){var r=new bd.a(this.Y2),B=new bd.a(this.Y2);Ee.CXl(this.Oq,b,r,B);for(var P of r)this.Oq.Z(P,b.J(P));for(const ca of B)if(r=this.Oq.J(ca),B=this.MI.AQd(h,ca),this.Oq.remove(ca),B&&(b=P=
!1,Pa.a.DSc().equals(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<B.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?P=!0:!Pa.a.DSc().equals(r,B),r||P||b)){B=this.Lc.Pc(15);try{B.Db(this.kXe()),b?this.MI.JRh(h,ca,!0):(P&&this.MI.H_n(h,ca),r&&this.MI.ypg(h,ca))}finally{B&&B.dispose()}}}}P9l(b){const h=new bd.a(this.Y2);for(const r of b)for(const B of r)b=B.node,Td.ParagraphReader.Xb(b)&&h.add(b.id);return h}ppm(b){var h=
this.ji.value;const r=b?this.P9l(b):new bd.a(this.Y2);if(r){b=new vb.a;for(const ca of this.Tah)if(!r.contains(ca)){var B=h.Eb(ca);if(B){B=B.ra;for(let ra=0;ra<B.length;ra++){const Qa=B.J(ra).Ue;if(Qa)for(let mb=0;mb<Qa.length;mb++){var P=Qa.J(mb);P.Qc&&(P=h.Eb(P.Lj))&&P.ja(Oc.a.CEi,!1)&&U.a.Cq(ca,mc.h(P))&&this.MI.tdc(P)&&b.add(P)}}}}this.Tah=r;if(b.count){h=this.Lc.Pc(7);try{h.Db(this.kXe());for(const ca of b)ca.Cg(Oc.a.CEi)}finally{h&&h.dispose()}}}}nWd(b){this.C8f(b);this.Yqm(b);this.ppm(b)}kCh(){this.C7&&
(this.Ib.ff(this.C7),this.C7=null)}uMb(){if(this.C7||this.ji.Izf)this.kCh(),this.nWd(null)}fC(){this.hb.Xw(this.v5);v.AFrameworkApplication.rI(()=>{this.uMb()})}dispose(){this.hb.jZ(this.v5);this.kCh()}static CXl(b,h,r,B){for(const P of h){const ca=P.key;b.nb(ca)||r.add(ca)}for(const P of b)b=P.key,h.nb(b)||B.add(b)}}Object(n.a)(Ee,"IntelligentPlaceholderSelectionCache",null,[10]);var Jf;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.oup=3]=
"textGesture";b[b.paste=4]="paste";b[b.Y8o=5]="workItemIntent";b[b.Egp=6]="characterTrigger"})(Jf||(Jf={}));Object(n.b)("IntelligentPlaceholderCreation",Jf);class Qf{constructor(b,h,r,B){this.uBa=b;this.Pm=h;this.iVb=r;this.Dx=B}Gie(b){return b&&b.Mc&&b.Mc.id.equals(this.Dx.value.xd.id)?!0:!1}brj(b){return this.Gie(b)&&b.ja(Oc.a.UG,!1)?!0:!1}v7m(){this.iVb.execute(b=>{b.logAction({actionType:Eo.b.SessionStart,engagement:Eo.a.Offer,objectName:Qf.ync})})}z3d(b,h){const r=2==h&&this.Gie(b);if(this.brj(b)||
r){var B=b.getValue(Oc.a.hF);this.iVb.execute(P=>{P.logAction({actionType:Eo.b.Created,engagement:Eo.a.None,objectName:Qf.ync,objectId:B.toString(),objectFulfillment:Jf[h]})})}}q5m(b){if(this.brj(b)){var h=b.getValue(Oc.a.hF);this.iVb.execute(r=>{r.logAction({actionType:Eo.b.Deleted,engagement:Eo.a.None,objectName:Qf.ync,objectId:h.toString()})})}}W7m(b,h){if(this.Gie(b)){var r=b.getValue(Oc.a.hF);this.iVb.execute(B=>{B.logAction({actionType:Eo.b.Resolved,engagement:Eo.a.None,objectName:Qf.ync,objectId:r.toString(),
objectFulfillment:h?"RemoveText":"KeepText"})})}}Q8m(b){b===V.a.pYd&&this.iVb.execute(h=>{h.logAction({actionType:Eo.b.Deleted,engagement:Eo.a.None,objectName:Qf.ync,objectFulfillment:Qf.DJo})})}X6m(b){if(this.Gie(b)){var h=b.getValue(Oc.a.hF);this.iVb.execute(r=>{r.logAction({actionType:Eo.b.Modified,engagement:Eo.a.None,objectName:Qf.ync,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}CKk(){this.v7m();this.uBa.mrh((b,h)=>{this.z3d(h.commentNode,h.kEn)});this.uBa.Vyk((b,h)=>{this.W7m(h.commentNode,
h.WTm)});this.uBa.Byk((b,h)=>{this.X6m(h.commentNode)});this.Pm.R2b((b,h)=>{this.Q8m(h.actionId)});w.a.x0e((b,h)=>{this.q5m(h.commentNode)})}}Qf.ync="IntelligentPlaceholder";Qf.DJo="Undo";Object(n.a)(Qf,"IntelligentPlaceholderTelemetry",null,[]);class kg{constructor(){this.n7=this.uqd=this.Xwd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.W=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new Wd(v.AFrameworkApplication.va,b.Sa("Common.App.SafeLinks.ISafeLinksManager"))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new eC).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Uc(v.AFrameworkApplication.va,new Tl.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),
b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new zD(v.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Ee(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),v.AFrameworkApplication.lc,()=>ab.StaticActiveAppFrame.za().jb.rc.ed,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new od(Hb.InteractiveViewManager.instance,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc.xd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new Qf(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Sa("CanvasContextual.ICanvasContextualController"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Sa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Ub();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").CKk();this.n7=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");et.a.mxk(Object(z.a)(this.n7,this.n7.sxh,"beforeIntelligentPlaceholderPaste"));et.a.BCd(Object(z.a)(this.n7,this.n7.nWi,"onIntelligentPlaceholderPaste"));this.Xwd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(99)||this.Xwd.fC();this.uqd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.uqd.Afb(ab.StaticActiveAppFrame.za().jb,Tb.KeyInputManager.instance);this.nXn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Xwd&&this.Xwd.dispose();this.uqd&&this.uqd.dispose();this.n7&&(et.a.U1n(Object(z.a)(this.n7,this.n7.sxh,"beforeIntelligentPlaceholderPaste")),et.a.z2n(Object(z.a)(this.n7,this.n7.nWi,"onIntelligentPlaceholderPaste")))}nXn(b,h,r){b&&b.execute(B=>
{B.tV(new BD(h,r))})}static main(){L.a.instance.Gc(new kg)}}Object(n.a)(kg,"PackageManager",null,[1,2]);var ud=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",
attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},
children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",
attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",
Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Ge=c(2113),qi=c(1988),fi=c(2071);class jh{}jh.pCo="Search_16x16x32";jh.hCo="ClosePaneGlyph_16x16x32";
Object(n.a)(jh,"SearchBoxIcons",null,[]);var vh=c(2074),zj=c(2075),Rk=c(2073);class bk{constructor(){this.VVg=null}get key(){return"FIND_HIT"}get Ku(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.VVg=b.node.rQa()}lAa(b){let h=null;for(const r of this.VVg)if(r.Bc<=b&&b<r.end)return h=Object.assign(new vu.a,{nE:this.key,contentObject:r}),{returnValue:!0,RE:h};return{returnValue:!1,RE:h}}}Object(n.a)(bk,"FindHitDetailsProvider",null,[345,346]);var yi=c(1670),nh=c(1608),
Fj=c(1650);class jj{constructor(b,h,r,B,P,ca,ra,Qa=null,mb=null){this.qm=null;this.find=(Jb,Yb,fc,Mc,Wc)=>1===fc?32:void 0===Wc||null===Wc?8:Wc.length?this.Cjg(Wc):(this.h7e(fi.a.initial),32);this.findInDocument=(Jb,Yb,fc,Mc,Wc)=>this.qtj(V.a.Gqb,Jb,Yb,fc,Mc,Wc);this.TDl=(Jb,Yb,fc,Mc,Wc)=>this.qtj(V.a.Iqb,Jb,Yb,fc,Mc,Wc);this.L0h=(Jb,Yb,fc)=>1===fc?32:this.Cjg(this.Ao.oQa());this.o5c=(Jb,Yb,fc,Mc,Wc)=>{Jb=!this.Ao.zG;Wc[zn.a.Image16by16Class]=Jb?ie.getImageClass(jh.pCo):ie.getImageClass(jh.hCo);Wc[zn.a.LabelText]=
Jb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Wc[zn.a.ApplyLabelTextToControlOnly]=!0;Wc[zn.a.EnsureControlRoleIsButton]=!0;Wc[zn.a.On]=!1;return 32};this.XEl=(Jb,Yb,fc)=>{if(1===fc)return 32;this.Eli(!1);return 32};this.hFl=(Jb,Yb,fc)=>{if(1===fc)return 32;this.Eli(!0);return 32};this.Z4f=(Jb,Yb,fc,Mc,Wc)=>{Wc[mm.a.Visible]=this.Ao.xtj;return 32};this.i5f=(Jb,Yb,fc,Mc,Wc)=>{Wc[mm.a.Visible]=this.Ao.xtj;return 32};this.JVd=(Jb,
Yb,fc,Mc,Wc)=>{if(1===fc)return 32;this.fB.d8c.Kli(Wc);return 32};this.cancelSearch=(Jb,Yb,fc)=>{if(1===fc)return 32;this.h7e(fi.a.initial);return 32};this.jJc=(Jb,Yb,fc)=>{if(1===fc)return 32;this.h7e(fi.a.initial);this.Ao.kC(!1);return 32};this.clearSearch=(Jb,Yb,fc)=>{if(1===fc)return this.UJm(Jb===eb.a.yFh);this.Ao.clearSearch();return 32};this.xoe=(Jb,Yb,fc)=>{if(1===fc)return 32;switch(Jb){case eb.a.qlf:this.Ao.matchCase=!this.Ao.matchCase;break;case eb.a.Ilf:this.Ao.matchWholeWord=!this.Ao.matchWholeWord}return this.Cjg(this.Ao.oQa())};
this.Cbe=(Jb,Yb,fc,Mc,Wc)=>{Wc[Df.a.On]=this.Ao.matchCase;return 32};this.Ebe=(Jb,Yb,fc,Mc,Wc)=>{Wc[Df.a.On]=this.Ao.matchWholeWord;return 32};this.K4f=(Jb,Yb,fc,Mc,Wc)=>{Jb=this.Ao.matchCase;Yb=this.Ao.matchWholeWord;fc="";Jb&&Yb?fc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Jb?fc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Yb&&(fc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Wc[Kj.a.Value]=fc;Wc[Kj.a.Visible]=Jb||Yb;return 32};this.ajc=(Jb,Yb,fc,Mc,Wc)=>{Jb=this.Ao.i3;Yb="";switch(this.Ao.zG){case fi.a.startSearch:Yb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case fi.a.searching:Yb=Jb?this.xuf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case fi.a.searchComplete:Yb=
this.xuf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case fi.a.tooManyResults:Yb=this.xuf(this.Ao.OGa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case fi.a.noMatchesFound:Yb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case fi.a.replaceAllInProgress:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case fi.a.replaceAllComplete:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Wc[Kj.a.Value]=
Yb;return 32};this.Dbe=(Jb,Yb,fc,Mc,Wc)=>{Wc&&(Wc.CommandValueId=this.Ao.oQa());return 32};this.replace=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return this.SHf()?32:8;if(!this.SHf())return 8;Jb=this.Ao.eHb();"string"===typeof Wc&&Wc&&(Jb=Wc);t.ULS.sendTraceTag(6033813,312,50,"Replace Called");ne.a("NavigationPaneReplace");Wc=this.Vyb.replace(Jb);this.Ao.gho(Wc);return 32};this.replaceAll=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return this.cUm()?32:8;Jb=this.Ao.eHb();"string"===typeof Wc&&Wc&&(Jb=Wc);ne.a("NavigationPaneReplace");
this.qm=this.je.Yf("UserAction","ReplaceAll");this.Ao.l8(fi.a.replaceAllInProgress);t.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");Fj.a.D4n(this.Ao.oQa(),this.Ao.eHb());this.Vyb.replaceAll(Jb,this.Qtn);return 32};this.Qtn=(Jb,Yb)=>{this.qm&&(this.qm.stop(),this.qm=null);t.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Jb,["TotalCount"]:Yb});Fj.a.A4n(Jb,Yb);this.Ao.l8(fi.a.replaceAllComplete)};this.f6i=(Jb,Yb,fc,Mc,Wc)=>{Yb=!1;if(!Wc)return 8;
this.Ao.mj.isVisible&&(Yb=Jb===V.a.I5c===this.Ao.ZRc());Jb!==V.a.I5c||this.Z2g||(Yb=!1);Wc[Df.a.On]=Yb;return 32};this.L4f=(Jb,Yb,fc,Mc,Wc)=>{if(!Wc||!this.Ao.mj.isVisible)return 32;Wc[Df.a.On]=this.Ao.OGa;return 32};this.N4f=(Jb,Yb,fc,Mc,Wc)=>{if(!Wc)return 32;Wc.currentFindReplaceViewType=this.Ao.zG;return 32};this.IMn=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return 32;Jb=Wc[Df.a.On];Wc&&(Wc[Df.a.On]=this.Ao.mj.isVisible);Jb&&!Wc[Df.a.On]&&(jj.aCj(),ne.a("NavigationPaneCrossClick"));return 32};this.$8a=(Jb,
Yb,fc,Mc,Wc)=>{const id=this.Ao.mj.isVisible;t.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",id);return id?this.jJc(Jb,Yb,fc,Mc,Wc):this.hmc(Jb,Yb,fc,Mc,Wc)};this.hmc=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return gc.SessionStatusManager.instance.bD?32:8;if(2===fc){v.AFrameworkApplication.hqa("AutoDetectedHeadingsIsEnabled");jj.aCj();this.F5();yi.FindReplaceUIManager.TQk(Jb,Wc,this.Ao.mj.isVisible);Yb=!0;Jb===V.a.lmc&&void 0!==Wc&&null!==Wc&&(Yb=Wc);this.Ao.kC(!0,Yb);Wc=Rk.a.initial;switch(Jb){case V.a.imc:t.ULS.sendTraceTag(42501022,
367,50,"");Wc=Rk.a.headings;break;case V.a.Gqb:Wc=Rk.a.find;break;case V.a.Iqb:Wc=Rk.a.replace;break;case V.a.lmc:Wc=Rk.a.intelligentPlaceholder;break;case V.a.$8a:Wc=this.Ao.B6b,Wc||(t.ULS.sendTraceTag(42501023,367,50,""),Wc=Rk.a.headings)}this.Ao.$lo(Wc,Yb);return 32}return 8};this.EHa=()=>{this.Ao.zG&&!this.Ao.OGa&&t.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.Ao=h;this.fB=r;this.Vyb=B;this.Z2g=P;this.je=ra;mb&&mb(1,this.EHa,null);this.QLa=Qa}F5(){}Ub(){this.ga.fb(V.a.y5f,
zc.a.view,this.IMn,96);this.ga.qa(V.a.$8a,zc.a.view,this.$8a);this.ga.qa(V.a.imc,zc.a.view,this.hmc);this.ga.qa(V.a.Gqb,zc.a.view,this.hmc);this.ga.qa(Mb.a.vlf,zc.a.view,this.find);this.ga.qa(eb.a.findInDocument,zc.a.view,this.findInDocument);this.ga.qa(Mb.a.ulf,zc.a.view,this.L0h);this.ga.fb(eb.a.iMn,zc.a.view,this.o5c,97);this.ga.qa(Mb.a.XTf,zc.a.view,this.XEl);this.ga.qa(Mb.a.S2f,zc.a.view,this.hFl);this.ga.fb(Mb.a.Z4f,zc.a.view,this.Z4f,97);this.ga.fb(Mb.a.i5f,zc.a.view,this.i5f,97);this.ga.qa(V.a.JVd,
zc.a.view,this.JVd);this.ga.qa(Mb.a.y4b,zc.a.view,this.cancelSearch);this.ga.qa(eb.a.clearSearch,zc.a.view,this.clearSearch);this.ga.qa(eb.a.yFh,zc.a.application,this.clearSearch);this.ga.qa(V.a.jJc,zc.a.view,this.jJc);this.ga.qa(eb.a.qlf,zc.a.view,this.xoe);this.ga.qa(eb.a.Ilf,zc.a.view,this.xoe);this.ga.fb(eb.a.Cbe,zc.a.view,this.Cbe,97);this.ga.fb(eb.a.Ebe,zc.a.view,this.Ebe,97);this.ga.fb(V.a.K4f,zc.a.view,this.K4f,97);this.ga.fb(V.a.ajc,zc.a.view,this.ajc,97);this.ga.fb(V.a.L4f,zc.a.view,this.L4f,
97);this.ga.fb(V.a.N4f,zc.a.view,this.N4f,97);this.ga.fb(V.a.M4f,zc.a.view,this.f6i,97);Object(nh.b)()&&this.ga.fb(V.a.Dbe,zc.a.view,this.Dbe,96);this.Z2g&&(this.ga.fb(V.a.Iqb,zc.a.view,this.hmc,1028),this.ga.fb(V.a.I5c,zc.a.view,this.f6i,97),this.ga.fb(V.a.replace,zc.a.view,this.replace,1028),this.ga.fb(V.a.replaceAll,zc.a.view,this.replaceAll,1028),v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb(eb.a.Clf,zc.a.view,this.TDl,1028));this.ga.qa(V.a.lmc,zc.a.view,this.hmc)}k7f(){this.QLa&&this.QLa.execute(b=>{b.tV(new bk)})}qtj(b,h,r,B,P,ca){if(1===B)return gc.SessionStatusManager.instance.bD?32:8;if(void 0===ca||null===ca)return 8;this.hmc(b,r,2,P,ca);b=this.Ao;b.Mdg(ca.CommandValueId);Object(nh.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.L0h(h,r,B,P,ca)}Cjg(b){if(void 0===b||null===b||!b.length)return 32;
b=vh.a.createQuery(b,this.nMn);if(void 0===b||null===b)return t.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.fB.find(b);return 32}get nMn(){let b=zj.a.none;this.Ao.matchCase&&(b|=zj.a.matchCase);this.Ao.matchWholeWord&&(b|=zj.a.wholeWordOnly);return b}Eli(b){this.Ao.B6b!==Rk.a.headings&&this.Ao.i3&&(b?this.fB.d8c.Smm():this.fB.d8c.Gli())}h7e(b){this.Ao.zG&&(this.Ao.OGa||t.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.fB.p0a(),this.Ao.l8(b))}UJm(b){return this.Ao.zG===
fi.a.replaceAllInProgress||b&&!this.Ao.zG?8:32}xuf(b){return String.format(b,this.Ao.Jjd,this.Ao.i3)}SHf(){return this.Ao.ZRc()&&0<this.Ao.i3}cUm(){return this.SHf()&&this.Ao.OGa}static aCj(){null!=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},jj.EEa)}static EYl(b,h,r,B){return new jj(v.AFrameworkApplication.va,
b,h,r,B,kb.FocusManager.instance(),ab.StaticActiveAppFrame.za().Kq,Ya.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(v.AFrameworkApplication.ta.aQ,v.AFrameworkApplication.ta.aQ.ob,"registerHandler"))}static DYl(b,h,r,B){return jj.EYl(b,h,r,B)}}jj.EEa=5E3;Object(n.a)(jj,"FindReplaceActor",null,[]);var Pn=c(912),gi=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.zK},set:function(h){this.zK=h},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.iYa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,rV:this.iYa,next:void 0,data:r};this.first||(this.first=r);this.iYa&&(this.iYa.next=r);this.iYa=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,rV:h,next:h.next,
data:B};var P=h.next;P&&(P.rV=B);h.next=B;this._map.set(r,B);return!0};b.prototype.insertBefore=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,rV:h.rV,next:h,data:B};var P=h.rV;P&&(P.next=B);h.rV=B;this._map.set(r,B);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.iYa===r&&(this.iYa=r.rV),r.rV&&(r.rV.next=r.next),r.next&&(r.next.rV=r.rV),this._map.delete(h))};return b}();class d{constructor(){this.type="heading"}}Object(n.a)(d,
"NavPaneHeadingItem",null,[]);class m{constructor(){this.type="bookmark"}}Object(n.a)(m,"NavPaneBookmarkItem",null,[]);class A{constructor(b,h,r,B,P,ca,ra){this.gb=b;this.hb=h;this.Vb=r;this.Bn=B;this.nV=P;this.cG=ca;this.e6j=ra;this.jZa=0;this.Fsd=new Map;this.UYg=!1;this.TAa=new Map}get headingsReady(){return this.UYg}set headingsReady(b){this.UYg=b}get jOb(){return this.jZa}get h$(){this.b_b&&0!=this.b_b.length()||(this.b_b=this.jHn());return this.b_b}set h$(b){this.b_b=b}get Lkc(){return this.Vik}set Lkc(b){this.Lkc&&
(this.Lkc.isSelected=!1);b.isSelected=!0;this.Vik=b}Zsf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}jHn(){const b=new gi;if(!this.nV)return b;this.Fsd=new Map;let h;const r=[];for(const B of this.nV.paragraphs()){const P=this.adi(B,r);null===P||void 0===P?void 0:P.forEach(ca=>{(h=this.Qei(ca,r))&&"heading"===h.type&&h.indentLevel<ca.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ca.isHidden=!1):(h.isCollapsed=!0,ca.isHidden=!0));b.insert(this.Zsf(ca,B),ca)})}return b}Qei(b,h){return"heading"===
b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}iqg(b){var h;let r=Td.ParagraphReader.Qwa(b),B=!1;9===r&&this.TAa.has(b.id.toString())&&(r=this.TAa.get(b.id.toString()),B=!0);const P=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(P){if(P.indentLevel===r){h=ni.AParagraphNode.QP(b.characterData.trim());b=this.Bn.value.Z_f(b);if(h!==P.text||P.hasBookmark!==b)return P.text=h,P.hasBookmark=b,!0;!B&&P.isPurelyADH&&(P.isPurelyADH=!1,--this.jZa);return!1}this.A4c();
return!0}if(9===r)return this.FIm(b)?(this.A4c(),!0):!1;this.A4c();return!0}FIm(b){var h;const r=this.Bn.value.h6h(b);b=null!==(h=this.Fsd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=0;h<b;++h)if(!this.h$.get(r[h].cQa()))return!0;return!1}tll(b){if(this.h$.get(b.id.toString())||this.Bn.value.Z_f(b))return this.A4c(),!0;this.TAa.has(b.id.toString())&&(this.TAa.delete(b.id.toString()),--this.jZa);return!1}A4c(){const b=new gi;this.jZa=0;if(this.nV){this.Fsd=new Map;var h=[],
r,B;for(const P of this.nV.paragraphs()){const ca=this.adi(P,h);null===ca||void 0===ca?void 0:ca.forEach(ra=>{var Qa=this.Zsf(ra,P);B=this.Qei(ra,h);this.U8n(Qa,ra,B);b.insert(Qa,ra);"heading"===(null===r||void 0===r?void 0:r.type)&&(Qa=r,Qa.indentLevel>=ra.indentLevel&&(Qa.isCollapsed=void 0));r=ra})}}this.h$=b}U8n(b,h,r){var B,P;if(b=null===(B=this.b_b.get(b))||void 0===B?void 0:B.data)b.isSelected&&(h.isSelected=!0,this.Lkc=h),h.isHidden=b.isHidden;if(r){if(B=null===(P=this.b_b.get(this.Zsf(r,
r.paragraphNode)))||void 0===P?void 0:P.data)r.isCollapsed=B.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}adi(b,h){var r=Td.ParagraphReader.Qwa(b),B=!this.TFf(b);const P=this.FOm(r)&&B?!0:!1;B=this.TAa.has(b.id.toString())&&B;const ca=[];if(P)ca.push(this.HMh(b,r,!1,h));else if(B)this.jZa+=1,this.XNc&&(r=this.TAa.get(b.id.toString()),ca.push(this.HMh(b,r,!0,h)));else{let ra=0;this.Bn.value.h6h(b).forEach(Qa=>{const mb=new m;
mb.text=Qa.cQa();mb.isSelected=!1;mb.bookmarkManager=this.Bn;mb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ra+=1;ca.push(mb)});this.Fsd.set(b.id.toString(),ra)}return ca}HMh(b,h,r,B){var P,ca;const ra=new d;ra.text=ni.AParagraphNode.QP(b.characterData.trim());ra.indentLevel=h;ra.paragraphNode=b;ra.isSelected=!1;ra.isPurelyADH=r;ra.listMarker=this.qtf(b);ra.hasBookmark=this.Bn.value.Z_f(b);for(b=null===(P=B[B.length-1])||void 0===P?void 0:P.indentLevel;b&&b>=h;)B.pop(),b=null===(ca=B[B.length-
1])||void 0===ca?void 0:ca.indentLevel;(!b||b<h)&&B.push(ra);return ra}TFf(b){return this.gb.Xb(b)&&0===this.gb.textLength(b,9)}bAl(b){(b=this.h$.get(b))&&(1==b.data.isCollapsed?this.Ctj(b):this.ivm(b))}onClickHeading(b){var h;this.Lkc=b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data;h=Fe.SelectionFactory.ne(b.paragraphNode,0);this.hb.Ac(h);this.Vb.mg(Zd.AFrame.In)}onClickBookmark(b){var h;this.Lkc=b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data;this.Bn.value.wli(b.text);this.Vb.mg(Zd.AFrame.In)}onShareHeadingClick(b){var h;
v.AFrameworkApplication.se("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");ne.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Oc.a.Wc),this.e6j.value.IMh(h)}upg(b,h){const r=b.id.toString(),B=this.TAa.has(r);if(!B||this.TAa.get(r)!==h){this.TAa.set(r,h);if(this.XNc)return this.iqg(b);B||this.h$.get(r)||(this.jZa+=1)}return!1}Lkl(b){const h=b.id.toString(),r=this.TAa.has(h);if(r){this.TAa.delete(h);if(this.XNc)return this.iqg(b);
r&&!this.h$.get(h)&&--this.jZa}return!1}cMo(b){this.XNc=b;this.A4c()}Upg(b){var h;const r=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.qtf(b);if(r.listMarker===b)return!1;this.DUo();return!0}fLd(b){var h;b=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}Ctj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=
b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.xAo(r):this.Ctj(r));return b}ivm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}xAo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}FOm(b){return 0<=b&&8>=b}DUo(){let b=this.h$.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.qtf(h.paragraphNode)}b=b.next}}qtf(b){var h;if(b.ND instanceof
Pn.a)return this.Gkm(null===(h=this.cG.Lmb(b.ND))||void 0===h?void 0:h.J9)}Gkm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(n.a)(A,"NavPaneHeadingsManager",null,[]);var R=c(1609);class da{constructor(){this.Vyb=this.fB=this.Dvc=this.Xld=this.W=null}get name(){return"WordEditor.FindReplace"}wc(b){this.W=b;const h=new A(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),kb.FocusManager.instance(),b.Ve("WordEditor.Bookmark.IBookmarkManager"),
b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.Ve("WordEditor.Actors.HeadingsActor"));this.W.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){da.Zb.pq.continueWith(()=>{this.xn()})}xn(){if(qe.App.Lsg){const b=qe.App.fqe;this.Dvc=yi.FindReplaceUIManager.getInstance(b);this.fB=qi.FindManager.createInstance(this.Dvc,Ge.a.instance,R.a.instance,!0);this.Vyb=this.fB.jPb;this.Xld=jj.DYl(this.Dvc,this.fB,
this.Vyb,b);this.Xld.Ub();this.Xld.F5();this.Xld.k7f();ab.StaticActiveAppFrame.za().updateCommandUI()}}dispose(){this.Dvc&&this.Dvc.dispose()}static get Zb(){return null!=da.ozg?da.ozg:da.ozg=Ya.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(da,"FindReplacePackageManager",null,[1,2]);class Ea{constructor(){}Hnf(){return"_@_"+Lb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}wXo(b,h,r,B){h.iho(b,B);h.hm(b,Pe.a.Z$,!0);h.hm(b,Oc.a.YRa,!0);h.hm(b,Oc.a.XX,Ea.E_h(r));h.hm(b,
Oc.a.Ns,15)}FAk(b,h,r,B){const P=b.pJd(B);h.hm(P,Pe.a.Z$,!0);h.hm(P,Oc.a.Ns,47);h.hm(P,Oc.a.XX,Ea.E_h(r));b=b.pJd(B);h.hm(b,Pe.a.Z$,!0);h.hm(b,Oc.a.Ns,16);return[P.Xj,b.Xj]}rLl(b,h,r){b=b.pJd(r);h.hm(b,Pe.a.Z$,!0);h.hm(b,Oc.a.fKb,!0);return b.Xj}static E_h(b){return String.format(' HYPERLINK "{0}"',b)}}Object(n.a)(Ea,"AtMentionHyperlinkConfigurator",null,[470]);class ib{constructor(b,h,r){this.YBa=b;this.hb=h;this.rni=this.Pvi=this.DGe=!1;this.KMb=this.KMb.bind(this);this.LMb=this.LMb.bind(this);
this.UMb=this.UMb.bind(this);r&&r.execute(B=>{this.RWa=B});Wq.a.hEd.kqf.then(B=>{this.rni=!0;this.Pvi=B.isSuccess})}xde(){this.YBa.x7f(this.KMb);this.YBa.y7f(this.LMb);this.YBa.H7f(this.UMb)}F0d(){return!1}KMb(b,h,r){var B,P;h=Date.now();if(this.RWa)if(this.rni&&!this.Pvi)t.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(P=null===(B=this.hb.ib)||void 0===B?void 0:B.lb)||void 0===P?void 0:P.Rc;ca?(B=ca.node,Td.ParagraphReader.Xb(B)?
(P=Td.ParagraphReader.text(B),0>r||r>P.length?t.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(ne.c(V.a.K6k,!0,void 0,void 0,void 0,void 0),this.YBa.reset()):(this.DGe?this.RWa.ZXo():(this.DGe=!0,this.RWa.xzo(ca)),this.RWa.Cpg(r,r+b.length),b=P.substring(0,r)+b,this.RWa.Unf(B,b,r,h))):t.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):
t.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else t.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}LMb(b){if(this.RWa)this.RWa.onKeyDown(b)}UMb(){this.DGe=!1;this.RWa&&this.RWa.fGh()}}Object(n.a)(ib,"ContextIQUserInitHandler",null,[56]);var Qb=c(1680);class pc{constructor(){this.bA=null}get name(){return"WordEditor.AtMentions"}wc(b){this.W=
b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new Ea(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:pc.GNj,featureName:pc.oPj,topLevelKpiName:pc.LSj,vetoPillar:7};b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Nt.a(xa.Health.instance,new Fq.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}dispose(){}xn(){this.W.Sa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>
{v.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&v.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||Qb.a.Lfd())&&this.O2m()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}O2m(){(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasAtMentions")).then(()=>{v.AFrameworkApplication.K.Nn(()=>{this.KVn()})})}KVn(){const b=
{peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:v.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.SWm()};this.bA=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&Qb.a.Mfd()||!r&&Qb.a.Lfd()?(Qb.a.oEf=!r,this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",
()=>new ib(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Sa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Sb(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.bA,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),Hb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").xde()})})}SWm(){var b,h;const r=null!==(b=v.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=v.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===
pc.tNj&&b===pc.sNj}}pc.tNj="-4";pc.sNj="DC2";pc.GNj="webasynccollabeng";pc.oPj="AtMentions";pc.LSj="AtMentionsFeatureUsage";Object(n.a)(pc,"PackageManager",null,[1,2]);var Pc=c(1716),gd=c(1416);class Cd{constructor(b,h,r,B){this.ga=b;this.Je=h;this._augLoopRuntimeManager=r;this.Bpk=B;this.rua=0;this.iBd=this.u0b=!1;this.vOg=this.Odh=this.ZKe=this.Pdh=0;this.Ttb=null;this.U1j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],
["ChangePicture",!0]]);this.G0j=[{id:`${ps.Oic}_${1}`},{id:`${ps.Oic}_${2}`},{id:`${ps.Oic}_${3}`},{id:gd.a.BKd},{id:gd.a.YId},{id:gd.a.Q$d},{id:gd.a.N$d}];this.MVj=[{id:"OpenCopilotCompose"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.Jid=new Map;this.h8j=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",
!1);this.xbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.YYj=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Je.ob(this,Pc.SearchSuggestionAnnotation.getTypeName());(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.Jid.set("InsertLink","InsertLinkFlyout");this.Jid.set("GraphicsEditor","");this.kFj();this.Ub(this.ga)}wJn(b,
h){const r=Date.now();this.ZKe&&1250>r-this.ZKe||this.Vxb||(this.ZKe=r,this.Ttb=b,this.$xd=this.Dfm(h),this.K7n(),this.Y5n())}KB(b,h){if(b.annotationType===Pc.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===Qr.a.getTypeName()&&(h=Date.now(),b=b.content,this.Vxb&&this.Vxb===b.correlationId)){window.clearTimeout(this.rua);this.Vxb=void 0;var r=this.u0b,B=this.Y4l(b),P=B&&0<B.length;P&&(this.NYo(B),this.iBd&&(r=!1));r&&this.edj();h={["description"]:"[Zero term context menu] augloop response latency",
["correlationId"]:b.correlationId,["requestPreparationTime"]:this.Odh,["canvasContextRetrievalTime"]:this.vOg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.Pdh,["containsZTM"]:P,["shouldFallBack"]:this.u0b,["fallBack"]:r};t.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}Y4l(b){const h=this.getSuggestions(b.intentSuggestions,Pc.IntentIds.ZeroTermMenu,Pc.ObjectSemantic.GenericSuggestions,Pc.ObjectSchemaType.RankedSuggestion);
return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,r,B){return Array.isArray(b)?b.filter(P=>P.intent===h&&P.result.semantic===r&&P.result.type===B).map(P=>P.result.value):[]}Ub(b){b.fb(eb.a.GKi,zc.a.application,this.Z5n.bind(this),96)}Dfm(b){const h=[],r=new Map,B=Date.now();for(const P of b){if(!P)continue;b=[];const ca={itemsMetadata:new Rb.a};for(let ra=0;ra<P.ControlList.length;ra++){const Qa=P.ControlList[ra];if(Qa&&!Qa.ExternalId)continue;b.push(Qa.ExternalId);const mb={timeStamp:B,
source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Qa.ExternalId]=mb;r.set(Qa.ExternalId,mb)}h.push(appChrome.api.menuSection(b,P.Title,P.Lang,P.Id,ca))}return{sections:h,commands:r}}FBj(b){return this.Jid.has(b)?this.Jid.get(b):b}$Ja(b){const h={};for(const r of b)b=this.FBj(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));ab.StaticActiveAppFrame.za().WPd(h)}kKm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?
!1:this.U1j.has(b)?this.$xd.commands.has(b):!0}ROh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.Ttb})}Nib(b=!1){b=b?Pk.a.instance.Avc:Pk.a.instance.Nib();const h=[],r=Date.now();for(const B of b)B.commandId&&h.push({Id:B.commandId,TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Ux});return h}eQc(){const b=Pk.a.instance.eQc(),h=[],r=Date.now();for(const B of b)B.controlId&&h.push({Id:B.controlId,
TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Ux});return h}ipf(){const b={semantic:Pc.ObjectSemantic.CanvasContext,type:Pc.ObjectSchemaType.WordCanvasContext,value:{contentType:this.Ttb}};if(this.YYj){const h=Date.now(),r=this.Bpk.ipf(lh.a.instance.ib.lb);r&&r.value.contentType&&(b.value=r.value);this.vOg=Date.now()-h}return b}n8h(){const b=this.eQc(),h=this.Nib(),r=this.Nib(!0),B=[];B.push({semantic:Pc.ObjectSemantic.ControlIdHistory,
type:Pc.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Pc.SequenceType.ControlId,Sequence:b}});B.push({semantic:Pc.ObjectSemantic.CommandIdHistory,type:Pc.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Pc.SequenceType.CommandId,Sequence:h}});B.push({semantic:Pc.ObjectSemantic.FilteredCommandIdHistory,type:Pc.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Pc.SequenceType.CommandId,Sequence:r}});B.push(this.ipf());return B}kFj(){this._augLoopRuntimeManager.getSession().then(b=>
this.yhd=b).catch(()=>{this.yhd=void 0})}Y5n(){const b=Date.now(),h=this.n8h(),r=[Pc.IntentIds.ZeroTermMenu,Pc.IntentIds.Logging];this.Odh=Date.now()-b;this.rxj(r,h,"ContextualMenu")}Z5n(b,h,r){2===r&&(b=this.n8h(),this.rxj([Pc.IntentIds.Logging],b,"Floatie"));return 32}rxj(b,h,r){if(0===b.length||0===h.length)t.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var B=new Pc.SearchSuggestionSignal({correlationId:this.vRd("ACM"),intents:b,contextObjects:h,
entryPoint:r});this.u0b=0<=b.indexOf(Pc.IntentIds.ZeroTermMenu);this.Pdh=Date.now();this.Vxb=B.correlationId;this.rua=window.setTimeout(()=>{this.Vtn(B.correlationId)},750);h=new Qr.l({parentPath:["Signal",Pc.SearchSuggestionSignal.getTypeName()],items:[{id:Lb.a.create().toString(),body:B}]});this.yhd&&!this.yhd.isClosed?this.yhd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.kFj());t.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:B.correlationId,["shouldFallBack"]:this.u0b,["intents"]:b}))}}vRd(b){const h=Lb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}Vtn(b){this.Vxb&&this.Vxb===b&&(this.Vxb=void 0,this.u0b&&this.edj(),t.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.u0b})))}edj(){const b=this.ROh(this.$xd.sections);appChrome.api.dispatch(b);this.WHh()}WHh(){this.iBd=
!0}Q_n(b){var h,r;const B=[],P=new Map;if(!b||0===b.length)return B;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new Rb.a}};const ra="CommandsZTM"===ca.id;for(const Qa of ca.controlIds){if(P.has(Qa))continue;if(ra&&b.controlIds.length>=this.xbk)break;const mb=null===(r=null===(h=ca.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Qa];P.set(Qa,mb);b.controlIds.push(Qa);mb&&(b.data.itemsMetadata[Qa]=
mb)}0<b.controlIds.length&&B.push(b)}return B}K7n(){this.iBd=!1;if(this.h8j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}NYo(b){this.iBd||(b=this.oMl(b),0<b.length&&appChrome.api.dispatch(b))}oMl(b){const h=[];let r=[];var B=this.k$l();B&&0<B.length&&r.push(...B);(B=this.jLl())&&r.push(B);Array.isArray(b)&&0<b.length&&(b=this.Fva(b))&&(b.id="CommandsZTM",r.push(b));(b=
this.$Kl())&&r.push(b);r=this.Q_n(r);if(0===r.length)return[];h.push(this.ROh(r));this.WHh();return h}k$l(){var b,h;const r=null===(b=this.$xd)||void 0===b?void 0:b.sections.filter(B=>{var P;return null===(P=B.id)||void 0===P?void 0:P.startsWith(ps.aWh)});for(const B of r)if(null===(h=B.data)||void 0===h?0:h.itemsMetadata)for(const P in B.data.itemsMetadata)B.data.itemsMetadata[P].source="PassThroughZeroTermMenu";return r}jLl(){const b=this.m4h(this.G0j,"DefaultZeroTermMenu");return this.Fva(b)}$Kl(){const b=
this.m4h(this.MVj,"AdvertizedZeroTermMenu");return this.Fva(b)}m4h(b,h){const r=[];for(const B of b)B&&this.Wuo(B)&&this.$xd.commands.has(B.id)&&r.push({suggestion:B.id,rankingScore:-1,suggestionSource:h});return r}Wuo(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Fva(b){const h=[],r={itemsMetadata:new Rb.a},B=Date.now();this.$Ja(b);for(const P of b)b=this.FBj(P.suggestion),this.kKm(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:B,source:P.suggestionSource,
confidenceScore:P.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}}Object(n.a)(Cd,"AugLoopSearchSuggestionManager",null,[55,328]);class ae{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.W=b;this.W.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new Cd(v.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{Wq.a.ll().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){L.a.instance.Gc(new ae)}}Object(n.a)(ae,"PackageManager",null,[1,2]);var Xd=c(440),se=c(960);class Xe extends se.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(n.a)(Xe,"BootMessage",se.a,[]);var Be=c(1077);class Hg{constructor(){this.JQ=null;this.Arn=b=>{if(b.target===this.JQ)if(void 0===b.data||null===b.data)t.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=I.a(b.data);this.Zke(h.api)?this.khd.J(h.api).d5d(h.method,h):t.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){t.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.khd=new xf.a}zJf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let r=!1;try{this.JQ=new Worker(b);this.JQ.onmessage=this.Arn;const B=Object.assign(new Xe,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(B);this.zJf()&&Be.a.tUj(this.JQ);r=!0}catch(B){t.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",B)}return r}postMessage(b){try{const h=I.c(b);this.JQ.postMessage(h)}catch(h){t.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}Zke(b){return this.khd.nb(b)}grk(b,
h){this.Zke(b)&&t.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.khd.Z(b,h)}HOl(b){return this.Zke(b)?this.khd.J(b):null}}Object(n.a)(Hg,"WebWorker",null,[65]);class Xh{constructor(){this.ctg=[]}Egl(b,h){if(h){var r=v.AFrameworkApplication.Sz(b.kij,7),B=[];for(let P=0;P<b.HRb.length;P++){let ca;switch(b.HRb[P].format){case 5:case 6:ca=Xd.a.hHb(b.HRb[P].name);break;default:ca=b.HRb[P].name}B.push(v.AFrameworkApplication.Sz(ca,
b.HRb[P].format))}try{const P=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ca=new Hg;if(ca.create(P,B))for(this.ctg.push(ca),r=0;r<b.Yke.length;r++){const ra=h.V9k(ca,b.Yke[r]);ra&&ca.grk(b.Yke[r],ra)}}catch(P){t.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",P.message)}}else t.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(n.a)(Xh,"WebWorkerCollection",null,
[]);class Fl{constructor(b,h){this.QYe=new Xh;if(b){b=b.create();for(let r=0;r<b.length;r++)this.QYe.Egl(b[r],h)}else t.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let B=!1;for(let ca=0;ca<this.QYe.ctg.length;ca++){var P=this.QYe.ctg[ca];P.Zke(b)&&((P=P.HOl(b))?B=P.callMethod(h,r)||B:t.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}B||t.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(n.a)(Fl,"WebWorkerRouter",null,[22]);class Gm extends se.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(n.a)(Gm,"SettingsMessage",
se.a,[]);class em{constructor(b){this.JQ=b}}Object(n.a)(em,"WebWorkerApiMain",null,[]);class $n extends em{constructor(b){super(b)}zJf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.ASk(h);t.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}d5d(b,h){switch(b){case 14:this.Hpm(h);break;default:t.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}ASk(b){if(2!==b.length)return t.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return t.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new Gm,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:v.AFrameworkApplication.userSessionId,LocalCobaltSessionId:ke.a.instance.xP,LocalCobaltMachineId:ke.a.instance.Mmb,LocalCobaltClusterId:ke.a.instance.gLb,LocalCobaltSessionHasBackup:ke.a.instance.fqa,WaciiEnabledRequests:ke.a.instance.Ska,SettingsRoutedToServer:ke.a.instance.Jfg,WacClusterId:v.AFrameworkApplication.He.zZ});this.JQ.postMessage(b);return!0}Hpm(b){this.zJf()&&
b&&b.result&&(t.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.S1o())}async S1o(){try{const b=await new Be.a.uUj.WorkerUtilsTestClass(10);await b.Dh(5);15==await b.counter?t.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):t.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){t.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(n.a)($n,"InitializeWorkerApiMain",em,[]);class Ep extends se.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=yk.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(n.a)(Ep,"CatchUpNetworkRequestWorkerRequestMessage",se.a,[]);class Mm extends em{constructor(b,h){super(b);this.sIc=h}callMethod(b,h){if(4===b)return b=Object.assign(new Ep,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.JQ.postMessage(b),!0;t.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}d5d(b,h){switch(b){case 5:t.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.sIc.Dho(h);break;default:t.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(n.a)(Mm,"CatchUpNetworkRequestWorkerExternalApi",em,[]);class Mk extends se.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(n.a)(Mk,"LocalInferenceMessage",se.a,[]);class gm{constructor(){this.prediction=this.context=null}}Object(n.a)(gm,"LocalInferenceOutput",null,[]);class cl{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(n.a)(cl,"TextPredictionConfig",null,[]);class Sj{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(n.a)(Sj,"TextPredictionSettings",null,[]);class xp{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(n.a)(xp,
"TextPredictionDynamicPayload",null,[]);class vj extends em{constructor(b,h){super(b);this.Ipk=h}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.GSk(h);case 7:return this.BSk(h);case 9:return this.FSk(h);case 10:return this.CSk(h);case 13:return this.DSk(h);case 14:return this.ESk(h);default:return t.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}d5d(b,h){switch(b){case 9:this.Oqm(h);break;default:t.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Oqm(b){b&&b.prediction&&(b=Object.assign(new gm,{prediction:b.prediction,context:b.context}),this.Ipk.Owh().HJn(b))}BSk(b){if(1>b.length)return t.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mk,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.JQ.postMessage(b);return!0}GSk(b){if(1>b.length)return t.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mk,{api:4,method:8,paragraphContent:b});this.JQ.postMessage(b);
return!0}FSk(b){if(2>b.length)return t.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Mk,{api:4,method:9,paragraphContent:b,context:h});this.JQ.postMessage(h);return!0}CSk(b){if(1>b.length)return t.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mk,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.JQ.postMessage(b);return!0}DSk(b){if(1>b.length)return t.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Mk,{api:4,method:13,textPredictionConfig:this.w9h(b)});this.JQ.postMessage(b);return!0}ESk(b){if(1>
b.length)return t.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(uc.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Mk,{api:4,method:14,textPredictionConfig:this.w9h(b)});this.JQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new cl,{scriptDirectory:v.AFrameworkApplication.b6+"/intelligence/",settings:Object.assign(new Sj,{extendedRankLimit:0}),modelFilesUrl:b})}w9h(b=
null){return Object.assign(new cl,{scriptDirectory:v.AFrameworkApplication.b6+"/intelligence/",settings:Object.assign(new Sj,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(n.a)(vj,"LocalInferenceWorkerApiMain",em,[]);class Jr extends em{constructor(b){super(b);v.AFrameworkApplication.rI(()=>{this.uMb()})}callMethod(b){t.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}d5d(b){t.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}uMb(){const b=Object.assign(new se.a,{api:3,method:6});this.JQ.postMessage(b)}}Object(n.a)(Jr,"ShutdownWorkerApiMain",em,[]);class PC{constructor(b){this.container=b}V9k(b,h){let r=null;switch(h){case 0:r=new $n(b);break;case 2:r=new Mm(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:r=new Jr(b);break;case 4:r=new vj(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:t.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return r}}Object(n.a)(PC,"WordWebWorkerApiFactory",null,[577]);var QC=c(325);class Ww{constructor(b,h){this.name=b;this.format=h}}Object(n.a)(Ww,"ImportedScript",null,[]);class fC{constructor(){this.Yke=this.HRb=this.kij=null}}Object(n.a)(fC,"WebWorkerConfig",null,[]);var gC=c(1471);class qA{constructor(b){this.Fih=[];this.l9j=b;if(v.AFrameworkApplication.K){b=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
v.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const r=v.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5;var h=v.AFrameworkApplication.K.kb("AppScriptBaseName");const B=b?"":".";if(h){const P=b?"":"{0}";h+=`${B}${P}worker.js`;this.Fih.push(new Ww(`MicrosoftAjax${b?"":"DS"}.${P}js`,r),new Ww(h,r))}else t.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else t.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new fC,{kij:"workerboot",HRb:this.Fih,Yke:[0,2,3,4]});this.l9j&&this.rMm()&&h.HRb.push(new Ww("intelligence/edge-inference-web.js",5));b.push(h);return b}rMm(){return(new QC.a("arrowFunction",()=>{try{Object(gC.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(n.a)(qA,"WordWebWorkerConfigFactory",null,[327]);class nE{constructor(){this.Ca=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ca.appSettings,v.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.W=b;this.Ca=this.W.resolve("Common.IAppSettingsManager");const h=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new Fl(new qA(h),new PC(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){L.a.instance.Gc(new nE)}}Object(n.a)(nE,"WordEditorWorkersPackage",null,[1,2]);var cw=c(1196);class oE{constructor(){this.Vvd=
[]}zgi(b,h){let r=-1,B=null;B=P=>{P?h(this.Vvd[r]):(++r,r<this.Vvd.length?this.Vvd[r].u4b(b,B):h(null))};B(!1)}u4b(b,h){this.zgi(b,r=>{h(!!r)})}Tjc(b,h,r){this.zgi(b,B=>{if(!B)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");B.Tjc(b,h,r)})}Yph(b){this.Vvd.push(b)}}Object(n.a)(oE,"CompositeExternalContentURLResolver",null,[580,237]);var fF=c(1466);class hC extends fF.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(n.a)(hC,"ExternalContentEmbedResponse",fF.a,[]);var DD=c(1482),gF=c(1873),ED=c(1872),pE=c(1384),rA=c(724),dw=c(503),gn=c(165),FD=c(875),xy;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.ijp=3]="externalContentFloatieConversion"})(xy||(xy={}));Object(n.b)("ExternalContentConversionContext",xy);class eh{constructor(){this.IKb=this.HKb=null;
this.skf=new pE.ExternalContentEmbedRetriever;this.tDc=!0;this.ovc=this.uo=this.bqi=this.aqi=this.Zl=this.As=null;this.picturePasteRequestSucceeded=()=>{t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.qic=()=>{t.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=eh.roa&&eh.roa.p8h()}get TQb(){return this.tDc}set TQb(b){this.tDc=b}V6e(b,h){let r=!1;if(b){switch(b.contextId){case zc.a.Tc:r=!h;break;case zc.a.Fd:r=
!0}r&&!FD.a(b.node)&&(r=!1)}return r}kYm(b){const h=b.startsWith(ch.a.Qic),r=b.startsWith(ch.a.e5c),B=b.startsWith(ch.a.sbe);return(h||r||B)&&ch.a.cSa(b)}M7i(){this.uo=U.a.create();eh.qf.uDb(this.uo,4);eh.qf.E5(this.uo,0,eh.qf.so());this.LIb(this.HKb,3,this.IKb,!0)}gRa(b,h,r){this.uo=U.a.create();eh.qf.uDb(this.uo,r?0:2);eh.qf.E5(this.uo,0,eh.qf.so());this.ovc();this.LIb(b,r?0:2,h)}P$d(b,h){this.uo=U.a.create();eh.qf.uDb(this.uo,1);eh.qf.E5(this.uo,0,eh.qf.so());this.LIb(b,1,h)}oYd(b,h,r,B){if(!b||
!b.isConnected||!ye.ImageReader.Mt(b))return null;const P=new rA.a;P.setValue(xe.a.lbc,r);P.setValue(xe.a.ZQa,h);P.N0a=this.aqi;P.Ku=this.bqi;P.providerName=B;P.h5a=1===r;xd.GraphIterator.eb(b).Bf(P,2);this.o0c(P);return P}H9i(b){this.ovc=b}cse(b,h){const r=eh.N1.Z6b(h)||0;h=eh.N1.s1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}Aug(b,h,r){if(null!=b&&null!=h&&!E.a.af(r)){var B=eh.Q1c.B$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Cra=!1:B.Cra=!0;B.hideFloatie=!0;this.cse(b,h.node);this.Nbc(b,h,!1,!1,B,r)}}Jjb(b){return b?b.Ne:0}Crg(b,h,r){let B=null;const P=b.node;if(!Td.ParagraphReader.Xb(P)||!P.isConnected)return{returnValue:!1,csa:B};if(r)return{returnValue:!0,csa:b};r=b.cpBegin;const ca=b.cpEnd,ra=Td.ParagraphReader.text(P);if(0<=r&&ca<=ra.length&&ra.substring(r,ca)===h)return{returnValue:!0,csa:b};const Qa=ra.indexOf(h);return 0<=Qa?(B=Se.a.createTextRange(P,Qa,Qa+h.length),{returnValue:!0,csa:B}):0<=r&&ca<=ra.length&&
this.Oac(b)?{returnValue:!0,csa:b}:{returnValue:!1,csa:B}}Oac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Se.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ch.a.Fz(h,!1);if(1===h.length){h=h[0];const r=Td.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}pJf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}k9a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const r=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},eh.EEa)}Vqf(b,h){const r=!E.a.o8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}LIb(b,
h,r,B=!1){if(this.kYm(r)){var P=eh.Q1c.B$b(r);if(P)if(this.pJf(P)){t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Na.a)(Se.a,b);var ca=!h;this.V6e(b,ca)?this.OWc(r)?(h=1===h,B=this.uZl(b),P.hideFloatie=!0,this.Nbc(B,b,ca,h,P,r)):this.z2f(b,h,P,r,B):eh.qf.kR(this.uo,2,"URL inserted in Non-Embedable context",eh.qf.so())}else t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),eh.qf.kR(this.uo,2,"Size provided is not valid for OEmbed",
eh.qf.so())}else t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),eh.qf.kR(this.uo,2,"URL inserted is not valid for ExternalContent",eh.qf.so())}uZl(b){const h=new hC;h.Width=eh.N1.Z6b(b.node)||0;h.Height=eh.N1.s1a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}OWc(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=eh.N9&&eh.N9.CDi(b)}z2f(b,h,r,B,P){const ca=
!h,ra=1===h,Qa=eh.N1.Z6b(b.node)||0,mb=eh.N1.s1a(b.node)||0,Jb=DD.a.z$e(r.Wqg,!0,Qa,mb);this.O_c(b,B,h,!0);this.skf.FDh(Jb,Yb=>{eh.qf.E5(this.uo,4,eh.qf.so());eh.qf.M9c(this.uo,this.Jjb(Yb.data));if(Yb=this.F2f(Yb)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var fc=gn.q(Yb.MediaType);eh.qf.jde(this.uo,7,fc);fc=b;({csa:fc}=this.Crg(b,B,ra)).returnValue?(this.O_c(fc,B,h,!1),null==r.width?0<Qa&&Yb.Width>Qa&&(t.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Qa):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Yb.Width=this.Ded(r.width,Yb.Width,Qa)),null==r.height?0<mb&&Yb.Height>mb&&(t.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Yb.Height=mb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Yb.Height=this.Ded(r.height,Yb.Height,mb)),eh.roa.lab||P?this.Nbc(Yb,fc,ca,ra,r,B):(this.HKb=b,this.IKb=B,this.JKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),eh.qf.kR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",eh.qf.so()));ra&&this.z0a(fc.node)}else ra&&this.z0a(b.node),eh.qf.kR(this.uo,1,"URL not oEmbedable",eh.qf.so())},Yb=>{eh.qf.E5(this.uo,
4,eh.qf.so());eh.qf.M9c(this.uo,this.Jjb(Yb.data));ra&&this.z0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.te);eh.qf.kR(this.uo,2,"ExternalContentEmbedRequest failed",eh.qf.so())},Yb=>{ra&&this.z0a(b.node);t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.uo)}Ded(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}Nbc(b,h,r,B,P,ca){this.Zl=Lb.a.create();b.Width=b.Width/b.Height*(b.Height-(dw.a.GTc+dw.a.e4))+2*dw.a.e4;const ra=new sg.GraphTransaction(15);ra.Db(h.node);ra.Uj=V.a.gRa;const Qa=this.Oac(h);null!=P.Cra&&!P.Cra||B||Qa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.WCf(h,ra,b.Title,ca,r));if(h){B&&(h=this.Mef(h));var mb=this.FJd(h,B);if(mb){r=gn.q(b.MediaType);var Jb=this.mUd(b,r);this.aqi=b.IFrameHtml;this.bqi=b.Title;if(mb=this.DCf(mb,
Jb,ra,B,ca,r,b.ProviderName))ra.mHa(this.Zl,1),ra.dispose(),this.HKb=h,this.IKb=ca,this.m_f(P,b,mb),this.m2f(ca,B||P.hideFloatie,Qa,r,b.Title,b.ProviderName)}else ra.dispose(),t.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),eh.qf.kR(this.uo,2,"Could not create IP context on splitting the paragraph",eh.qf.so())}else eh.qf.kR(this.uo,2,"GraphNodeContext is null",eh.qf.so())}mUd(b,h){const r=new wc.DictionaryPropertySet;
eh.oP.Kae(r,b.Width,b.Height);b=this.Uqf(h,b.Title);r.setValue(Pe.a.imageAltText,b);r.setValue(Oc.a.JU,Kd.a.FF());r.setValue(Oc.a.imageType,Dn.other);return r}DCf(b,h,r,B,P,ca,ra){if(!b)return null;b=eh.oP.sYd(b,h);if(!b)return r.dispose(),t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),eh.qf.kR(this.uo,2,"The anchored image could not be inserted",eh.qf.so()),null;r=b.node;P=this.oYd(r,P,ca,ra);eh.qf.Zpg(this.uo,P.id);B||this.Edg(r);
return r}m_f(b,h,r){E.a.o8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(eh.qf.E5(this.uo,8,eh.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.VLd(r,h.Thumbnail))}m2f(b,h,r,B,P,ca){h||this.JKc(b);this.k9a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.P9d("IsHyperlinkWithNonURLDisplayText",r,ca);this.ariaNotify(B,P);eh.qf.E5(this.uo,5,eh.qf.so())}P9d(b,h,r){t.ULS.sendTraceTag(591267585,
324,50,"OtelLogging: ExternalContent transaction successfully completed");oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ma.a,{name:b,bool:h}),Object.assign(new ma.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.TQb&&eh.Hv&&(b=this.Vqf(b,h),eh.Hv.sendNotification(b,!0))}WCf(b,h,r,B,P){if(P){if((P=ch.a.Fz(b,!1))&&1!==P.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;eh.jp.jS(P[0].paragraph,P[0].hyperlink)}return this.O9f(b,r,B)}Mef(b){const h=b.node,r=Td.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Se.a.createTextRange(h,0,r.length),eh.jg.Ge(b,""),Se.a.Uc(h,0)):b}FJd(b,h){return h?b:this.Qrf(b)}Qrf(b){const h=Td.ParagraphReader.text(b.node),r=xd.GraphIterator.eb(b.node);if(r.od()){b=Se.a.Uc(b.node,b.cpEnd);hg.OutlineElementNavigator.Yd(r);const B=eh.Pf.ppa(r);eh.rh.S$(r,B,b,!0,!0,!0,!0);""!=h&&eh.rh.Oy(r,!1,!0);r.Rd();return Se.a.Uc(r.currentNode,
0)}return null}F2f(b){if(!({group:b}=de.a.d2(b.data.te)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}O9f(b,h,r){const B=b.cpBegin+h.length;eh.jg.Ge(b,h);b=Se.a.createTextRange(b.node,b.cpBegin,B);eh.jp.fF(b,r,!1);return b}Uqf(b,h){const r=!E.a.o8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}VLd(b,h){b.Zi().contentReplicator.forceOutbound(()=>{this.D2f(h,b)},()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}o0c(b){b=xd.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.YQ=!0}z0a(b){b.kic=null}Edg(b){b=xd.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.od()&&b.Oj()&&b.Rd()&&Td.ParagraphReader.Xb(b.currentNode)&&(b=Fe.SelectionFactory.ne(b.currentNode,
0),lh.a.instance.Ac(b)))}O_c(b,h,r,B){const P=b.cpBegin,ca=b.cpEnd;b=Td.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xy[r],B):0<P&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xy[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xy[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xy[r],B)}JKc(b){this.f7b();const h=new vw.a(1,v.AFrameworkApplication.isRtl);h.Z3c=b;eh.fib.e6c(h)}f7b(){const b=
new th.a(!0);eh.i$.qIa(b)}D2f(b,h){if(b=this.Utf(b,h))h=Array(1),h[0]=b,b=gF.a.construct(h,!1,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null),h=this.Hcf(),this.Spb(h,b)}Utf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.As=h.Zi();(new xd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Vp||!h.anchor.Vp.us)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.Vp.us.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(Ng.a.RJ,Ti.a.Qt);const B=h.getValue(Pe.a.bL),P=Xg.a.nf(ye.ImageReader.WC(h.properties),0),ca=Xg.a.nf(ye.ImageReader.YH(h.properties),1);return ED.a.construct(h.id.toString(),b,h.ja(Pe.a.imageAltText,""),P,ca,h.ja(Oc.a.vY,""),r,h.ja(Oc.a.JU,0),h.ja(Oc.a.wia,!1),h.ja(Ng.a.kha,-1),h.ja(Oc.a.Nmb,Box4Intl.Box4Strings.l_Picture),h.ja(Pe.a.Oxa,
!1),B,h.ja(Oc.a.runId,1),h.ja(Oc.a.Wc,0))}Spb(b,h){v.AFrameworkApplication.He.nj(b,2,I.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.qic,null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}Hcf(){let b=ka.a.l9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ka.a.Oo(b,li.a.fileId,this.As.yr));b=ka.a.Oo(b,li.a.cellId,this.As.Fm.toString());this.Zl||
(this.Zl=Lb.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ka.a.Oo(b,li.a.MX,this.Zl.toString());b=ka.a.Oo(b,li.a.classId,(393233).toString());this.As.VH&&(b=ka.a.Oo(b,li.a.VH,this.As.VH));b=ka.a.Oo(b,li.a.rsb,"1");b=ka.a.Oo(b,Sg.a.imageType,Dn.other.toString());b=ke.a.instance.$_e(b);b=ka.a.Oo(b,li.a.$ua,this.As.contentReplicator.Su.toString());b=ka.a.Oo(b,li.a.hic,"0");return b=ka.a.Oo(b,li.a.sTb,"1")}static get fib(){return null!=
eh.Yyg?eh.Yyg:eh.Yyg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get roa(){eh.zBa||(eh.zBa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return eh.zBa}static get i$(){return null!=eh.qGg?eh.qGg:eh.qGg=Ya.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Hv(){return null!=eh.Lwg?eh.Lwg:eh.Lwg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}static get N1(){return null!=eh.qHg?eh.qHg:eh.qHg=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get oP(){return null!=
eh.KBg?eh.KBg:eh.KBg=Ya.a.instance.resolve("WordEditor.IImageEditor")}static get Pf(){return eh.rh||(eh.rh=Ya.a.instance.resolve("Box4.IOutlineElementEditor"))}static get jp(){return null!=eh.CBg?eh.CBg:eh.CBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get jg(){return null!=eh.uxg?eh.uxg:eh.uxg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get qf(){return null!=eh.gzg?eh.gzg:eh.gzg=Ya.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get Q1c(){return null!=
eh.cFg?eh.cFg:eh.cFg=Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get N9(){return null!=eh.WEg?eh.WEg:eh.WEg=Ya.a.instance.resolve("Fluid.Host.LoopComponentManager")}}eh.rh=null;eh.EEa=5E3;eh.zBa=null;Object(n.a)(eh,"ExternalContentEditor",null,[224]);var RC=c(264),qE=c(1234);class hF{constructor(b,h){this.lab=!0;this.r6a=r=>{if(null!=r.result)return r.result.Value;t.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");
return this.lab};this.LHa=r=>{r.Ho||r.Gi?t.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.uAh(r.result),t.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.lab};this.Fv=b;this.NK=h}p8h(){const b=new jg.a;this.FCi()&&this.NK?this.NK.k7a(RC.a.iKc).CWRCo(this.r6a,0).CWRCo(this.LHa,8):b.Dg(this.lab)}j2(b){this.NK&&this.NK.j2(RC.a.iKc,
new qE.a(RC.a.iKc,b))}bbo(b){this.FCi()&&(this.Fv.ika("saveConvertExternalContentIsEnabled",b.toString()),t.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.uAh(b),this.j2(b))}FCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}uAh(b){this.lab=b}}Object(n.a)(hF,"ExternalContentSettingInfo",
null,[583]);var fG=c(1167);class iF{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(n.a)(iF,"FluidComponentProperties",null,[]);class jF{constructor(){this.loopType=this.Ku=this.N0a=this.url=null;this.mediaType=0;this.iMi=null}}Object(n.a)(jF,"IFrameProps",null,[]);class Nj{static get N1(){return null!=Nj.oHg?Nj.oHg:Nj.oHg=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get oP(){return Nj.Vj||
(Nj.Vj=Ya.a.instance.resolve("WordEditor.IImageEditor"))}static get Hv(){return null!=Nj.Kwg?Nj.Kwg:Nj.Kwg=Ya.a.instance.resolve("Common.Utils.IAriaNotifier")}static get jp(){return null!=Nj.wBg?Nj.wBg:Nj.wBg=Ya.a.instance.resolve("Box4.IHyperlinkEditor")}static get Pf(){return null!=Nj.wFg?Nj.wFg:Nj.wFg=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get jg(){return null!=Nj.sxg?Nj.sxg:Nj.sxg=Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static cSa(b){const h=b.startsWith(ch.a.Qic),
r=b.startsWith(ch.a.e5c),B=b.startsWith(ch.a.sbe);return(h||r||B)&&ch.a.cSa(b)}static V6e(b,h){let r=!1;if(b){switch(b.contextId){case zc.a.Tc:r=!h;break;case zc.a.Fd:r=!0}r&&!FD.a(b.node)&&(r=!1)}return r}static Oac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Se.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=ch.a.Fz(h,!1);if(1===h.length){h=h[0];const r=Td.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static Uqf(b,h){const r=
!E.a.o8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static o0c(b){b=xd.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.YQ=!0}static mUd(b,h,r,B){const P=
new wc.DictionaryPropertySet;Nj.oP.Kae(P,h,b);b=Nj.Uqf(B,r);P.setValue(Pe.a.imageAltText,b);P.setValue(Oc.a.JU,Kd.a.FF());P.setValue(Oc.a.imageType,Dn.other);return P}static oYd(b,h,r){if(!b||!b.isConnected||!ye.ImageReader.Mt(b))return null;const B=new rA.a;B.setValue(xe.a.lbc,h.mediaType);B.setValue(xe.a.ZQa,h.url);B.setValue(Zc.a.loopComponentType,h.loopType);B.N0a=h.N0a;B.Ku=h.Ku;B.providerName=r;B.h5a=1===h.mediaType;B.createMode=h.iMi;xd.GraphIterator.eb(b).Bf(B,2);Nj.o0c(B);return B}static FJd(b,
h){return h?b:Nj.Qrf(b)}static Qrf(b){const h=Td.ParagraphReader.text(b.node),r=xd.GraphIterator.eb(b.node);if(r.od()){b=Se.a.Uc(b.node,b.cpEnd);hg.OutlineElementNavigator.Yd(r);const B=Nj.Pf.ppa(r);Nj.Pf.S$(r,B,b,!0,!0,!0,!0);""!=h&&Nj.Pf.Oy(r,!1,!0);r.Rd();return Se.a.Uc(r.currentNode,0)}return null}static Edg(b){b=xd.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.od()&&b.Oj()&&b.Rd()&&Td.ParagraphReader.Xb(b.currentNode)&&(b=Fe.SelectionFactory.ne(b.currentNode,0),lh.a.instance.Ac(b)))}static Vqf(b,
h){const r=!E.a.o8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Nj.Hv&&(b=Nj.Vqf(b,
h),Nj.Hv.sendNotification(b,!0))}static P9d(b,h,r,B=""){t.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:r,dataFields:[Object.assign(new ma.a,{name:b,bool:h}),Object.assign(new ma.a,{name:"ProviderName",string:B})]}))}}Object(n.a)(Nj,"ExternalContentHelper",null,[]);var iC=c(746);class rE{constructor(){this.Zl=this.As=null}VLd(b,h,r){b.Zi().contentReplicator.forceOutbound(()=>{this.D2f(h,b,r)},
()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}D2f(b,h,r){if(b=this.Utf(b,h))h=Array(1),h[0]=b,r=gF.a.construct(h,r,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null),b=this.Hcf(),this.Spb(b,r)}Utf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.As=h.Zi();(new xd.GraphIterator).set(h);if(!h.anchor||!h.anchor.Vp||
!h.anchor.Vp.us)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Vp.us.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(Ng.a.RJ,Ti.a.Qt);const B=h.getValue(Pe.a.bL),P=Xg.a.nf(ye.ImageReader.WC(h.properties),0),ca=Xg.a.nf(ye.ImageReader.YH(h.properties),1);return ED.a.construct(h.id.toString(),b,h.ja(Pe.a.imageAltText,
""),P,ca,h.ja(Oc.a.vY,""),r,h.ja(Oc.a.JU,0),h.ja(Oc.a.wia,!1),h.ja(Ng.a.kha,-1),h.ja(Oc.a.Nmb,Box4Intl.Box4Strings.l_Picture),h.ja(Pe.a.Oxa,!1),B,h.ja(Oc.a.runId,1),h.ja(Oc.a.Wc,0))}Spb(b,h){v.AFrameworkApplication.He.nj(b,2,I.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.qic.bind(this),null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}qic(){t.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}Hcf(){let b=ka.a.l9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ka.a.Oo(b,li.a.fileId,this.As.yr));b=ka.a.Oo(b,li.a.cellId,this.As.Fm.toString());this.Zl||(this.Zl=Lb.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ka.a.Oo(b,li.a.MX,this.Zl.toString());b=ka.a.Oo(b,li.a.classId,(393233).toString());
this.As.VH&&(b=ka.a.Oo(b,li.a.VH,this.As.VH));b=ka.a.Oo(b,li.a.rsb,"1");b=ka.a.Oo(b,Sg.a.imageType,Dn.other.toString());b=ke.a.instance.$_e(b);b=ka.a.Oo(b,li.a.$ua,this.As.contentReplicator.Su.toString());b=ka.a.Oo(b,li.a.hic,"0");return b=ka.a.Oo(b,li.a.sTb,"1")}}Object(n.a)(rE,"ExternalContentThumbnailHelper",null,[]);class Np extends rE{constructor(){super(...arguments);this.uo=null}static get qf(){return null!=Np.fzg?Np.fzg:Np.fzg=Ya.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}qKj(b,
h,r){return Nj.cSa(h)?Nj.V6e(b,r)?!0:(Np.qf.kR(this.uo,2,"URL inserted in Non-Embedable context",Np.qf.so()),!1):(t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Np.qf.kR(this.uo,2,"URL inserted is not valid for ExternalContent",Np.qf.so()),!1)}}Object(n.a)(Np,"AbstractExternalContentEditor",rE,[224]);var Kr=c(1194),jC=c(1197);class aq extends Np{constructor(b){super();aq.wYa=b;this.RMf()}RMf(){this.lrg&&jC.a.RMf(aq.wYa.X8h())}static get Sk(){return null!=
aq.VFg?aq.VFg:aq.VFg=Ya.a.instance.resolve("Box4.IParagraphEditor")}Zal(b,h){h=this.Cci(b,h);this.ati(h,b,5)}gRa(b,h,r){if(this.qKj(b,h,r)){var B=this.Cci(b,null);B.url=h;this.ati(B,b,r?0:2)}}P$d(b,h){this.gRa(b,h,!1)}ati(b,h,r){this.Zl=Lb.a.create();const B=new sg.GraphTransaction(15);B.Db(h.node);B.Uj=V.a.dEm;const P=Nj.Oac(h),ca=gn.q(b.mediaType),ra=Nj.mUd(b.height,b.width,b.title,ca);h=this.nXo(h,1==r);(h=Nj.Vj.sYd(h,ra))?(h=h.node,Nj.oYd(h,{url:b.url,mediaType:ca,Ku:b.title,loopType:b.type,iMi:r},
void 0)||t.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),B.mHa(this.Zl,1),B.dispose(),this.VLd(h,b.thumbnail,!1),this.gGn(P,ca,b.type)):t.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}nXo(b,h){Nj.jg.Ge(b,"");return Nj.FJd(b,h)}gGn(b,h,r){Nj.P9d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Nj.ariaNotify(h,this.XOl(r))}XOl(b){switch(b){case iC.a.CheckList:return"Checklist Component";
case iC.a.TaskAssignment:return"Task List Component";case iC.a.Poll:return"Poll Component";default:return"Fluid Component"}}Cci(b,h){const r=new iF;r.width=Nj.N1.Z6b(b.node)||0;gn.j()?r.height=null!=aq.wYa&&aq.wYa.V8h(h)||Nj.N1.s1a(b.node)||0:r.height=null!=aq.wYa&&aq.wYa.V8h(h)+2*dw.a.e4||Nj.N1.s1a(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.vZl();r.url=null!=aq.wYa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";
return r}vZl(){return aq.wYa.X8h()}get lrg(){return null!=this.LJg?this.LJg:this.LJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static OWc(b){v.AFrameworkApplication.se("2cejb611;b0jjh576");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=aq.wYa&&aq.wYa.CDi(b)&&Kr.a.EXk(b)}}Object(n.a)(aq,"FluidComponentEditor",Np,[]);class yp{get IAl(){return null!=this.Xyg?
this.Xyg:this.Xyg=Ya.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get rPd(){return null!=this.pAg?this.pAg:this.pAg=Ya.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}aGn(b,h){b&&(aq.OWc(h)?this.rPd.gRa(b,h,!0):this.IAl.gRa(b,h,!0))}}Object(n.a)(yp,"PostHyperlinkAutoCorrectStrategy",null,[581]);class SC{u4b(b,h){h(SC.lGn.test(b))}Tjc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new hC,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:SC.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}SC.lGn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");SC.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(n.a)(SC,"PowerBIURLResolver",null,[580,237]);class TC{constructor(b){this.qlh=b}u4b(b,h){let r=!1;try{if(TC.lWm(b)){const B=this.qlh.B$b(b);r=null!=B.width&&null!=B.height&&
!!B.thumbnailUrl&&!!B.title&&null!=B.Cra}}catch(B){}h(r)}Tjc(b,h){var r=this.qlh.B$b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new hC,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static lWm(b){for(const h of TC.xGo)if(b.startsWith(h))return!0;return!1}static w8(){return new TC(Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}TC.xGo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(n.a)(TC,"WedgeComponentExperimentsURLResolver",null,[580,
237]);var kF=c(888);let sE=!1;class Pu{static etj(b){Pu.dAi||Pu.addEventListener();const h=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(Pu.eHo,Pu.dHo,!0);Pu.dAi=!0}static e_k(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();sE=!0}}Pu.nJo="LoopsTeachingCalloutOnInsertTabActivity";Pu.D9m="LoopHomeTabFlightActivity";Pu.eHo="switchToInsertTabAndClickLoopButtonEvent";
Pu.dAi=!1;Pu.dHo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const r=null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.nc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Oe.a(0,1,r,()=>{Pu.e_k()});null===(h=v.AFrameworkApplication.lc)||void 0===h?void 0:h.Wb(b)};Object(n.a)(Pu,"FluidComponentsTUIHelper",null,[]);class tE{constructor(b,h,r){this.ga=b;this.P3j=h;this.Nk=r;this.m2g=!1;this.G6g=1E3;this.H6g=15E3;this.vTe=this.mTe=!0;this.vTe=!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.G6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.H6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Ub(){this.ga.fb(V.a.gti,zc.a.Tc,this.AEm.bind(this),1028);this.ga.fb(V.a.vae,zc.a.Tc,
this.vae.bind(this),1028);this.ga.fb(V.a.yVc,zc.a.Tc,this.HCf.bind(this),1028);this.ga.fb(V.a.kVc,zc.a.Tc,this.HCf.bind(this),1028);this.ga.fb(V.a.wYd,zc.a.Tc,this.HCf.bind(this),1028);this.ga.fb(V.a.fHi,zc.a.Tc,this.nQj.bind(this),1028)}AEm(){return 32}vae(b,h,r){if(2!==r)return 32;this.vTe&&(this.vbj(),this.POo());return 32}HCf(b,h,r){var B,P,ca;if(1===r){if(!this.t_d(b)||!kF.a.Hyi())return t.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(B=v.AFrameworkApplication.K)||
void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&Pu.etj(Pu.nJo);if(!h.al||!Pd.SelectionEditor.Ze(h)||(null===(P=this.Nk)||void 0===P?0:P.a0(h))||(null===(ca=this.Nk)||void 0===ca?0:ca.yia(h)))return 2;if(h&&h.node&&FD.a(h.node))return 32}else if(2===r)return this.P3j.Zal(h,tE.tZl(b)),this.vbj(),32;return 2}POo(){if(null!=Ua.a.instance.getItem("LoopComponentSurveyShowed")||sE)this.mTe=!1;if(this.mTe){let b=this.Bci();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&
(this.m2g=!0)},this.G6g);this.ohk=window.setTimeout(()=>{const h=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");this.m2g&&h&&h.execute(r=>{(b=this.Bci())&&"hidden"===b.visibility&&!sE&&(t.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),r.iJa("WordLoopFeedbackSurvey",null),this.mTe=!1,Ua.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.H6g)}}Bci(){var b,h;let r=null;try{const B=document.getElementById("Ribbon-LoopComponentDropdown");B&&(r=vl.a.BB(null===
(h=null===(b=B.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(B){t.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=B?B.toString():""))}return r}vbj(){this.vTe&&window.clearTimeout(this.ohk)}t_d(b){return b===V.a.kVc||b===V.a.yVc?Kr.a.t_d():!0}nQj(b,h,r){2===r&&E.a.vP("https://go.microsoft.com/fwlink/?linkid=2194838")&&qe.App.hbg.Eoc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static tZl(b){switch(b){case V.a.yVc:return iC.a.TaskAssignment;
case V.a.kVc:return iC.a.CheckList;case V.a.wYd:return iC.a.Poll;default:return null}}}Object(n.a)(tE,"FluidComponentsActor",null,[]);class Cj extends Np{constructor(){super();this.IKb=this.HKb=null;this.skf=new pE.ExternalContentEmbedRetriever;this.ovc=null;null!=Cj.roa&&Cj.roa.p8h()}M7i(){this.uo=U.a.create();Cj.qf.uDb(this.uo,4);Cj.qf.E5(this.uo,0,Cj.qf.so());this.LIb(this.HKb,3,this.IKb,!0)}gRa(b,h,r){this.uo=U.a.create();Cj.qf.uDb(this.uo,r?0:2);Cj.qf.E5(this.uo,0,Cj.qf.so());this.ovc();this.LIb(b,
r?0:2,h)}P$d(b,h){this.uo=U.a.create();Cj.qf.uDb(this.uo,1);Cj.qf.E5(this.uo,0,Cj.qf.so());this.LIb(b,1,h)}H9i(b){this.ovc=b}cse(b,h){const r=Cj.N1.Z6b(h)||0;h=Cj.N1.s1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}Aug(b,h,r){if(null!=b&&null!=h&&!E.a.af(r)){var B=Cj.Q1c.B$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?B.Cra=!1:B.Cra=!0;B.hideFloatie=
!0;this.cse(b,h.node);this.Nbc(b,h,!1,!1,B,r)}}Jjb(b){return b?b.Ne:0}Crg(b,h,r){let B=null;const P=b.node;if(!Td.ParagraphReader.Xb(P)||!P.isConnected)return{returnValue:!1,csa:B};if(r)return{returnValue:!0,csa:b};r=b.cpBegin;const ca=b.cpEnd,ra=Td.ParagraphReader.text(P);if(0<=r&&ca<=ra.length&&ra.substring(r,ca)===h)return{returnValue:!0,csa:b};const Qa=ra.indexOf(h);return 0<=Qa?(B=Se.a.createTextRange(P,Qa,Qa+h.length),{returnValue:!0,csa:B}):0<=r&&ca<=ra.length&&Nj.Oac(b)?{returnValue:!0,csa:b}:
{returnValue:!1,csa:B}}pJf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}k9a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},Cj.EEa)}LIb(b,h,r,B=!1){if(this.qKj(b,r,!h)){var P=Cj.Q1c.B$b(r);P&&(this.pJf(P)?(t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.z2f(b,
h,P,r,B)):(t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Cj.qf.kR(this.uo,2,"Size provided is not valid for OEmbed",Cj.qf.so())))}}z2f(b,h,r,B,P){const ca=!h,ra=1===h,Qa=Cj.N1.Z6b(b.node)||0,mb=Cj.N1.s1a(b.node)||0,Jb=DD.a.z$e(r.Wqg,!0,Qa,mb);this.O_c(b,B,h,!0);this.skf.FDh(Jb,Yb=>{Cj.qf.E5(this.uo,4,Cj.qf.so());Cj.qf.M9c(this.uo,this.Jjb(Yb.data));if(Yb=this.F2f(Yb)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var fc=gn.q(Yb.MediaType);Cj.qf.jde(this.uo,7,fc);fc=b;({csa:fc}=this.Crg(b,B,ra)).returnValue?(this.O_c(fc,B,h,!1),null==r.width?0<Qa&&Yb.Width>Qa&&(t.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Qa):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Yb.Width=this.Ded(r.width,Yb.Width,Qa)),null==r.height?0<mb&&Yb.Height>mb&&(t.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Yb.Height=mb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Yb.Height=this.Ded(r.height,Yb.Height,mb)),Cj.roa.lab||P?this.Nbc(Yb,fc,ca,ra,r,B):(this.HKb=b,this.IKb=B,this.JKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Cj.qf.kR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",Cj.qf.so()));ra&&this.z0a(fc.node)}else ra&&this.z0a(b.node),Cj.qf.kR(this.uo,1,"URL not oEmbedable",Cj.qf.so())},Yb=>{Cj.qf.E5(this.uo,4,Cj.qf.so());Cj.qf.M9c(this.uo,this.Jjb(Yb.data));ra&&this.z0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.te);Cj.qf.kR(this.uo,2,"ExternalContentEmbedRequest failed",Cj.qf.so())},Yb=>{ra&&this.z0a(b.node);
t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.uo)}Ded(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}Nbc(b,h,r,B,P,ca){this.Zl=Lb.a.create();b.Width=b.Width/b.Height*(b.Height-(dw.a.GTc+dw.a.e4))+2*dw.a.e4;const ra=new sg.GraphTransaction(15);ra.Db(h.node);ra.Uj=V.a.gRa;const Qa=Nj.Oac(h);null!=P.Cra&&!P.Cra||
B||Qa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.WCf(h,ra,b.Title,ca,r));if(h){B&&(h=this.Mef(h));var mb=Nj.FJd(h,B);if(mb){r=gn.q(b.MediaType);var Jb=Nj.mUd(b.Height,b.Width,b.Title,r);(mb=this.DCf(mb,Jb,B,{url:ca,N0a:b.IFrameHtml,Ku:b.Title,mediaType:r},b.ProviderName))?(ra.mHa(this.Zl,1),ra.dispose(),this.HKb=h,this.IKb=ca,this.m_f(P,b,mb),this.m2f(ca,B||P.hideFloatie,Qa,r,b.Title,b.ProviderName)):ra.dispose()}else ra.dispose(),t.ULS.sendTraceTag(590455041,
324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Cj.qf.kR(this.uo,2,"Could not create IP context on splitting the paragraph",Cj.qf.so())}else Cj.qf.kR(this.uo,2,"GraphNodeContext is null",Cj.qf.so())}DCf(b,h,r,B,P){if(!b)return null;b=Cj.oP.sYd(b,h);if(!b)return t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Cj.qf.kR(this.uo,2,"The anchored image could not be inserted",Cj.qf.so()),
null;b=b.node;B=Nj.oYd(b,B,P);Cj.qf.Zpg(this.uo,B.id);r||Nj.Edg(b);return b}m_f(b,h,r){E.a.o8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Cj.qf.E5(this.uo,8,Cj.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.VLd(r,h.Thumbnail,!1))}m2f(b,h,r,B,P,ca){h||this.JKc(b);this.k9a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Nj.P9d("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",
ca);Nj.ariaNotify(B,P);Cj.qf.E5(this.uo,5,Cj.qf.so())}WCf(b,h,r,B,P){if(P){if((P=ch.a.Fz(b,!1))&&1!==P.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Nj.jp.jS(P[0].paragraph,P[0].hyperlink)}return this.O9f(b,r,B)}Mef(b){const h=b.node,r=Td.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Se.a.createTextRange(h,0,r.length),Nj.jg.Ge(b,""),Se.a.Uc(h,0)):b}F2f(b){if(!({group:b}=
de.a.d2(b.data.te)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}O9f(b,h,r){const B=b.cpBegin+h.length;Nj.jg.Ge(b,h);b=Se.a.createTextRange(b.node,b.cpBegin,B);Nj.jp.fF(b,r,!1);return b}z0a(b){b.kic=null}O_c(b,h,r,B){const P=b.cpBegin,ca=b.cpEnd;b=Td.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xy[r],B):0<P&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xy[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xy[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xy[r],B)}JKc(b){this.f7b();const h=new vw.a(1,v.AFrameworkApplication.isRtl);h.Z3c=b;Cj.fib.e6c(h)}f7b(){const b=new th.a(!0);Cj.i$.qIa(b)}static get fib(){return null!=Cj.Zyg?Cj.Zyg:Cj.Zyg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get roa(){Cj.zBa||(Cj.zBa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Cj.zBa}static get i$(){return null!=Cj.rGg?Cj.rGg:Cj.rGg=Ya.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get N1(){return null!=
Cj.pHg?Cj.pHg:Cj.pHg=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get oP(){return null!=Cj.JBg?Cj.JBg:Cj.JBg=Ya.a.instance.resolve("WordEditor.IImageEditor")}static get Q1c(){return null!=Cj.bFg?Cj.bFg:Cj.bFg=Ya.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Cj.EEa=5E3;Cj.zBa=null;Object(n.a)(Cj,"ExternalContentEditorV2",Np,[]);class kB{constructor(){this.rd=this.W=null}get name(){return"WordEditor.ExternalContent"}get Zb(){return this.rd?
this.rd:this.rd=this.W.resolve("Box4.IFeatureHelper")}wc(b){var h;this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new cw.a(Kn.a.instance,ym.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new yp).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new hF(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Cj).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",()=>new aq(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",
()=>new tE(v.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),xj.a.instance)).ha(),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Pu.etj(Pu.D9m)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new eh).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.Zb.pq.continueWith(()=>{this.xn()});v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Ub()}dispose(){}Qal(){const b=new oE;this.UWh()&&b.Yph(TC.w8());b.Yph(new SC);return b}xn(){null==v.AFrameworkApplication.K||v.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new fG.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();this.UWh()&&(this.W.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",
()=>this.Qal()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}UWh(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){L.a.instance.Gc(new kB)}}Object(n.a)(kB,"ExternalContentPackage",null,[1,2]);var nr;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";
b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.Qfp=7]="bar";b[b.SSa=8]="num"})(nr||(nr={}));Object(n.b)("TabStopValues",nr);class Op{}Op.RQh=8;Op.Yjl=1;Op.Q8="wwaengidc";Op.kpiName="WordRuler";Op.precision=.0625;Op.iIo=1;Op.j2o="ShowHideRuler";Object(n.a)(Op,"Constants",null,[]);var GD=c(770);class Os{static T$b(b,h){if(!Os.nYc)return null;switch(b){case "Left":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{TKb:0,GPb:B.scale-(B.margins[1].value+
r[2].value+Math.max(r[0].value,r[1].value)+8*B.precision)}};case "Right":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{TKb:0,GPb:B.scale-(r[2].value+(B.margins[0].value+Math.max(r[0].value,r[1].value))+8*B.precision)}};case "MoveTableColumn":return()=>{let r=0,B=0;if(0===h){var P={};32===Os.oc.Qb(Mb.a.cjc,2,P)&&(r=af.a.Yz(P.MinIndent),B=af.a.Yz(P.MaxIndent))}else P={Do:h-1},32===Os.oc.Qb(Mb.a.bjc,2,P)&&(r=af.a.Yz(P.MinResize),B=af.a.Yz(P.MaxResize));return{TKb:r,GPb:B}};case "Top":return r=>
{r=r.rulerCanvasProps;return{TKb:0,GPb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{TKb:0,GPb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static zUd(b){if(!Os.nYc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,P=h.ipContextIndex;h=r.margins;var ca=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){P=h[0].value;h=h[1].value+B[2].value;var ra=P;
"LeftIndent"===b&&(ra+=Math.max(B[0].value,B[1].value));B=-1*P;r=ca-(ra+h+8*r)}else{ca=0;for(ra=0;ra<=P;ra++)ca+=h[ra].value;ra=0;if("LeftIndent"===b){ra=B[0].value;const Qa=B[1].value;ca+=Math.max(ra,Qa);ra=Math.max(ra,Qa)}h=h[P+1].value;ra+=B[2].value;B=-1*ca;r=h-ra-r}return{TKb:B,GPb:r}};case "RightIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,P=h.ipContextIndex,ca=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ca[0].type){var ra=ca[0].value;ca=ca[1].value;P=B[0].value;var Qa=
B[1].value;B=-1*ca;h-=ra+ca+Math.max(P,Qa)+8*r}else{ra=0;for(Qa=0;Qa<=P;Qa++)ra+=ca[Qa].value;ca=ca[P+1].value;P=B[0].value;Qa=B[1].value;B=-1*(h-ra-ca);h=ca-Math.max(P,Qa)-r}return{TKb:B,GPb:h}}}return null}static mdm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,B=b.ipContextIndex,P=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==P[0].type?(B=P[0].value,P=P[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(B+P+b)):(h=r[2].value,P=P[B+1].value,r=Math.min(r[0].value,r[1].value)+
b,b=P-(h+b));return{TKb:r,GPb:b}}}static get oc(){return null!=Os.Dwg?Os.Dwg:Os.Dwg=v.AFrameworkApplication.va}static get nYc(){null==this.kcb&&(v.AFrameworkApplication.Ria("WoRul910;WoRul910cf"),this.kcb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.kcb}}Os.kcb=null;Object(n.a)(Os,"RulerPropertyBoundaryHelper",null,[]);var uE=c(937),lF=c(1503),jD=c(1076),gG=c(1260),hG=c(1261);class Qu{constructor(b,
h,r,B,P,ca){this.Pyn="OutlineContainer";this.mok="UpdateCustomTabFailed";this.Nyb="ReadRulerPropertiesFailed";this.qok="UpdateIndentFailed";this.dlh="UpdateMarginFailed";this.I8d=ra=>{ra.button===Sys.UI.MouseButton.rightButton&&this.JRe.show(new Sys.UI.Point(ra.clientX,ra.clientY),2)};this.eIj=()=>{this.QVa()};this.nn=b;this.FZb=h;this.ga=r;this.JRe=B;this.qz=P;this.qT=ca;this.PWb=null;this.Rw=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uL;this.hXi=this.t8d.bind(this);this.RZi=this.mt.bind(this);
this.dIj=this.QVa.bind(this)}fC(){this.L_e();this.dqh();this.FZb.Al.Te(10).qo(this.hXi);De.a.addHandler(this.qYe,Xc.a.scroll,this.eIj);this.nn.execute(h=>{h.hZ(this.RZi)});const b=[this.Htf(),document.getElementById(xk.AppFrame.Ned),document.getElementById("PageContentContainer")];this.PWb?this.PWb.register(b,this.dIj):jD.a(lF.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.PWb=h.createResizeObserver();this.PWb.register(b,this.dIj);return null})});ab.StaticActiveAppFrame.za().bJ.registerBoundingWindowRectsChanged("documentPanel",
(h,r)=>{"undefined"!==r&&this.C9a([1,0])})}Htf(){return 1===this.qT.ou?this.ffk:this.Dek}get qYe(){return document.getElementById(xk.AppFrame.oKa)}get Dek(){const b=document.getElementsByClassName(this.Pyn);return b&&0<b.length?b[0]:null}get ffk(){var b=this.qz.kFb;if(!b)return null;b=this.Lco(Td.ParagraphReader.uR(b));return uE.a.rei(b)}Lco(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get SN(){return this.nn&&this.nn.instance?this.nn.instance.oj:Op.Yjl}k$b(){const b=
{};return 32!==this.ga.Qb(Mb.a.mIa,2,b)?(t.ULS.sendTraceTag(529065947,gG.a.msoulscat_Wac_WordRuler,hG.a.warning,"Unable to read page properties for Ruler"),Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to read page properties for Ruler"),null):b}dispose(){this.Uoi();this.FZb.Al.Te(10).UP(this.hXi);De.a.removeHandler(this.qYe,Xc.a.scroll,this.eIj);this.nn.execute(b=>{b.ZTa(this.RZi)});this.PWb&&this.PWb.dispose();ab.StaticActiveAppFrame.za().bJ.unregisterBoundingWindowRectsChanged("documentPanel",(b,
h)=>{"undefined"!==h&&this.C9a([1,0])})}get DAi(){null==Qu.UGe&&(Qu.UGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&v.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Qu.UGe}}Qu.UGe=null;Object(n.a)(Qu,"ARuler",null,[405]);var lB=c(296);class Pp extends Qu{constructor(b,h,r,B,P,ca,ra){super(b,h,r,P,ca,ra);this.wP="HorizontalRuler";this.uOj="CustomTabModificationFromRuler";
this.WPj="IndentModificationFromRuler";this.qre="MarginModificationFromRuler";this.pZg=this.oZg=this._tabStops=null;this.Xnn=(Qa,mb,Jb)=>{if(!(Qa>=this._tabStops.length)){Qa=this._tabStops[Qa];var Yb="Modify"===Jb?this.ga.Qb(V.a.mgc,2,{["tabStop"]:Qa,["value"]:af.a.Nv(mb)}):this.ga.Qb(V.a.n7a,2,Qa);if(32===Yb){mb=1;var fc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Jb,nr[Qa.Aea]);t.ULS.sendTraceTag(591213271,3014,50,fc)}else mb=0,fc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",
Jb,nr[Qa.Aea]),t.ULS.sendTraceTag(591213272,3014,15,fc),Cl.recordQosError(this.mok,[Cl.aga],"Unable to modify custom tab using ruler");ne.a(this.uOj,32===Yb,void 0,[Object.assign(new ma.a,{name:"Operation",string:Jb}),Object.assign(new ma.a,{name:"TabType",int64:nr[Qa.Aea]})]);Jb=new Map;Jb.set("Command","OnCustomTabChange");Jb.set("Source",this.wP);Jb.set("Response",fc);xa.Health.instance.recordKpiUsage(Op.kpiName,mb,Op.Q8,Jb)}};this.pqn=(Qa,mb)=>{var Jb=new GD.a;Jb.unit=1;Jb.value=af.a.Nv(mb);mb=
8;switch(Qa){case "FirstLineIndent":mb=this.ga.Qb(Mb.a.e$c,2,Jb);break;case "HangingIndent":mb=this.ga.Qb(Mb.a.f$c,2,Jb);break;case "LeftIndent":mb=this.ga.Qb(Mb.a.S3a,2,Jb);break;case "RightIndent":mb=this.ga.Qb(Mb.a.R3a,2,Jb)}let Yb;32===mb?(Jb=1,Yb=String.format("Indents set using Ruler. Indent: {0}",Qa),t.ULS.sendTraceTag(592517017,3014,50,Yb)):(Jb=0,Yb=String.format("Unable to set indent using Ruler. Indent: {0}",Qa),t.ULS.sendTraceTag(592496523,3014,15,Yb,Qa),Cl.recordQosError(this.qok,[Cl.aga],
"Unable to set indent using Ruler."));ne.a(this.WPj,32===mb,void 0,[Object.assign(new ma.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnIndentChange");Qa.set("Source",this.wP);Qa.set("Response",Yb);xa.Health.instance.recordKpiUsage(Op.kpiName,Jb,Op.Q8,Qa)};this.RXf=(Qa,mb,Jb)=>{let Yb;Yb="Left"===Qa?this.ga.Qb(Mb.a.cka,2,af.a.Nv(mb)):"Right"===Qa?this.ga.Qb(Mb.a.e8a,2,af.a.Nv(mb)):Jb?this.ga.Qb(Mb.a.zle,2,{["columnIndex"]:Jb-1,["width"]:af.a.Nv(mb)}):this.ga.Qb(Mb.a.Dlc,2,af.a.Nv(mb));
32===Yb?(mb=1,Jb=String.format("Margins set using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(592517018,3014,50,Jb)):(mb=0,Jb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(592496524,3014,15,Jb),Cl.recordQosError(this.dlh,[Cl.aga],"Unable to set margins using Ruler."));ne.a(this.qre,32===Yb,void 0,[Object.assign(new ma.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",this.wP);Qa.set("Response",Jb);xa.Health.instance.recordKpiUsage(Op.kpiName,
mb,Op.Q8,Qa)};this.xNa=B;this.rr={}}get HU(){return this.oZg}get $Fa(){return this.pZg}renderRuler(){this.HU.classList.remove("HideWACHorizontalRulerContainer");this.HU.classList.add("ShowWACHorizontalRulerContainer");var b=this.k$b();if(b){var h=this.RXf,r=this.pqn,B=this.Xnn,P=this.bdd(),ca=this.BCj(),ra=this.ACj();P&&ca&&ra||(this.rr.disabled=!0);this.rr.onIndentChange=r;this.rr.onMarginChange=h;this.rr.onTabChange=B;this.QVa();b=Xg.a.Oi(b.Ko,0);this.$Fa.style.width=(b*this.SN).toString()+"px";
return this.xNa().then(Qa=>{Qa.renderRuler(this.$Fa,this.rr)})}}ACj(){const b=[];var h={};if(32!==this.ga.Qb(V.a.nOb,2,h))return t.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.rr.tabs=b,!0;this._tabStops=r;h="";for(const B of r){switch(B.Aea){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";
break;case 7:h="BarTab"}r=Xg.a.L6a(B.sJa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:Os.mdm()})}this.rr.tabs=b;return!0}C9a(b){var h;if(this.HU){this.HU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.rr&&delete this.rr.disabled;for(const r of b)switch(r){case 0:b=this.BCj();const B=this.ACj();b&&B||(this.rr.disabled=!0);break;case 1:this.bdd()||(this.rr.disabled=!0)}if(null===(h=this.qz.lb)||void 0===h?0:h.NWc)this.rr.disabled=!0;this.xNa().then(r=>{r.renderRuler(this.$Fa,
this.rr);return null})}}bdd(){const b={};var h=this.k$b();if(!h)return!1;b.scale=af.a.Yz(h.Ko);b.precision=Op.precision;b.rulerType="Horizontal";if(!this.kxn())return this.rr.ipContextIndex=0,this.rr.permittedUnits=Op.RQh,h=[{["type"]:"Left",["value"]:af.a.Yz(h.marginLeft),["getRulerPropertyBoundary"]:Os.T$b("Left",0)},{["type"]:"Right",["value"]:af.a.Yz(h.marginRight),["getRulerPropertyBoundary"]:Os.T$b("Right",1)}],b.margins=h,this.rr.rulerCanvasProps=b,!0;var r={};h={};var B=this.ga.Qb(Mb.a.P5c,
2,r);const P=this.ga.Qb(Mb.a.AOb,2,h);if(32!==B||32!==P)return t.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;B=h.TablePosition;if(!B||!r||0>=r.length)return t.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Cl.recordQosError(this.Nyb,[Cl.aga],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+
1);h[0]={["type"]:"MoveTableColumn",["value"]:af.a.Yz(B.x/this.SN),["getRulerPropertyBoundary"]:Os.T$b("MoveTableColumn",0)};for(B=0;B<r.length;B+=1)h[B+1]={["type"]:"MoveTableColumn",["value"]:af.a.Yz(r[B]),["getRulerPropertyBoundary"]:Os.T$b("MoveTableColumn",B+1)};this.rr.ipContextIndex=this.chm();this.rr.permittedUnits=Op.iIo;b.margins=h;this.rr.rulerCanvasProps=b;return!0}BCj(){var b={};if(32!==this.ga.Qb(Mb.a.b7a,2,b))return t.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Os.zUd("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=Os.zUd("HangingIndent");const B={type:"RightIndent"};B.getRulerPropertyBoundary=Os.zUd("RightIndent");const P={type:"LeftIndent"};P.getRulerPropertyBoundary=Os.zUd("LeftIndent");this.rr.rtl=b.isRtl;b=b.Lt;h.value=1===b.specialIndentType?af.a.Yz(b.vea+b.OB):2===b.specialIndentType?
af.a.Yz(b.OB-b.vea):af.a.Yz(b.OB);r.value=af.a.Yz(b.OB);P.value=af.a.Yz(b.OB);B.value=af.a.Yz(b.lpa);this.rr.indents=[h,r,B,P];return!0}dqh(){De.a.addHandler(this.HU,Xc.a.Zx,this.I8d)}Uoi(){this.HU&&(this.HU.classList.remove("ShowWACHorizontalRulerContainer"),this.HU.classList.add("HideWACHorizontalRulerContainer"),De.a.removeHandler(this.HU,Xc.a.Zx,this.I8d));this.xNa().then(b=>{b.dispose(this.$Fa);return null})}mt(){this.gIj();this.QVa();this.C9a([1,0])}t8d(b,h){b=h.property;if(b===Oc.a.Ko||b===
Oc.a.marginLeft||b===Oc.a.marginRight)this.gIj(),this.QVa(),this.C9a([1])}gIj(){var b=this.k$b();b&&(b=Xg.a.Oi(b.Ko,0),this.$Fa.style.width=Math.round(b*this.SN).toString()+"px")}QVa(){window.requestAnimationFrame(()=>{var b=this.Htf();b&&(b=Qd.a.getElementBounds(b),v.AFrameworkApplication.isRtl?this.$Fa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.$Fa.style.marginLeft=b.x.toString()+"px")})}chm(){const b=xd.GraphIterator.eb(this.qz.kFb);if(b.zb(14))return b.jd(16),
bt.a(b,!0);t.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to read table column index for Ruler");return 0}kxn(){let b=!0;const h=this.qz.lb.GO();if(null===h)return t.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Cl.recordQosError(this.Nyb,[Cl.aga],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=xd.GraphIterator.eb(h.current.node);r.od();b=b&&mi.TableReader.mx(r)}return b}L_e(){if(!this.$Fa&&
!this.HU){this.oZg=document.createElement("div");this.HU.id=Pp.q6j;this.HU.className=Pp.p6j;this.HU.setAttribute(qf.a.Aga,WordEditorIntl.WordEditorStrings.L_Ruler);this.HU.setAttribute(qf.a.uh,qf.a.gwh);this.HU.classList.add("HideWACHorizontalRulerContainer");if(this.DAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Gc.a.tca(b,!h)&&this.HU.classList.add(Pp.Qbk)}this.pZg=document.createElement("div");
this.$Fa.className=Pp.o6j;this.$Fa.id=Pp.r6j;this.HU.appendChild(this.$Fa);b=null;this.Rw&&((b=Object(lB.a)("EditorBars"))&&b.appendChild(this.HU),this.HU.classList.add("regionComposer"));b||(b=document.getElementById(xk.AppFrame.Ned),b.insertBefore(this.HU,b.firstChild))}}static gF(){return new Pp(Ya.a.instance.Sa("Common.IZoomManager"),qe.App.li,v.AFrameworkApplication.va,Ik.UISurfaces.Xgi,Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),vq.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Pp.eDg?Pp.eDg:Pp.eDg=Pp.gF()}}Pp.q6j="WACHorizontalRulerContainer";Pp.p6j="WACHorizontalRulerContainer";Pp.r6j="WACHorizontalRuler";Pp.o6j="WACHorizontalRuler";Pp.Qbk="ModernUxWACHorizontalRulerContainer";Object(n.a)(Pp,"HorizontalRuler",Qu,[]);var mB=c(961);class us extends Qu{constructor(b,h,r,B,P,ca,ra){super(b,h,r,P,ca,ra);this.wP="VerticalRuler";this.qre="MarginModificationFromRuler";this.Wlh=this.Vlh=null;this.RXf=(Qa,mb)=>{let Jb=8;"Top"===Qa?Jb=this.ga.Qb(Mb.a.f8a,2,af.a.Nv(mb)):"Bottom"===
Qa&&(Jb=this.ga.Qb(Mb.a.d8a,2,af.a.Nv(mb)));let Yb;32===Jb?(mb=1,Yb=String.format("Margins set using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(529065945,3014,50,Yb)):(mb=0,Yb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(529065946,3014,15,Yb),Cl.recordQosError(this.dlh,[Cl.aga],"Unable to set margins using Ruler."));ne.a(this.qre,32===Jb,void 0,[Object.assign(new ma.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",
this.wP);Qa.set("Response",Yb);xa.Health.instance.recordKpiUsage(Op.kpiName,mb,Op.Q8,Qa)};this.xNa=B;this.rr={}}get q2(){return this.Vlh}get kKa(){return this.Wlh}renderRuler(){this.q2.classList.remove("HideWACVerticalRulerContainer");this.q2.classList.add("ShowWACVerticalRulerContainer");var b=this.k$b();if(b){var h=this.RXf;this.bdd()||(this.rr.disabled=!0);this.rr.onMarginChange=h;this.QVa();b=Xg.a.Oi(b.uv,1);this.kKa.style.height=(b*this.SN).toString()+"px";this.xNa().then(r=>{r.renderRuler(this.kKa,
this.rr);return null})}}C9a(b){var h;if(this.q2){this.q2.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.rr&&delete this.rr.disabled;for(const r of b)switch(r){case 1:this.bdd()?this.QVa():this.rr.disabled=!0}if(null===(h=this.qz.lb)||void 0===h?0:h.NWc)this.rr.disabled=!0;this.xNa().then(r=>{r.renderRuler(this.kKa,this.rr);return null})}}bdd(){const b={},h=this.k$b();if(!h)return!1;b.scale=af.a.Yz(h.uv);b.precision=Op.precision;b.rulerType="Vertical";this.rr.ipContextIndex=0;this.rr.permittedUnits=
Op.RQh;b.margins=[{["type"]:"Top",["value"]:af.a.Yz(h.marginTop),["getRulerPropertyBoundary"]:Os.T$b("Top",0)},{["type"]:"Bottom",["value"]:af.a.Yz(h.marginBottom),["getRulerPropertyBoundary"]:Os.T$b("Bottom",1)}];this.rr.rulerCanvasProps=b;return!0}dqh(){this.L_e();De.a.addHandler(this.q2,Xc.a.Zx,this.I8d)}Uoi(){this.q2&&(this.q2.classList.remove("ShowWACVerticalRulerContainer"),this.q2.classList.add("HideWACVerticalRulerContainer"),De.a.removeHandler(this.q2,Xc.a.Zx,this.I8d));this.xNa().then(b=>
{b.dispose(this.kKa);return null})}mt(){this.cIj();this.QVa();this.C9a([1])}t8d(b,h){b=h.property;if(b===Oc.a.uv||b===Oc.a.marginTop||b===Oc.a.marginBottom)this.cIj(),this.QVa(),this.C9a([1])}cIj(){var b=this.k$b();b&&(b=Xg.a.Oi(b.uv,1),this.kKa.style.height=Math.round(b*this.SN).toString()+"px")}QVa(){window.requestAnimationFrame(()=>{var b=this.Htf();if(b){const h=Qd.a.getElementBounds(b);this.kKa.style.height=h.height.toString()+"px";b=this.Tim(b);this.kKa.style.marginTop=b+"px"}})}Tim(b){b=b.getBoundingClientRect().y;
const h=this.qYe.getBoundingClientRect().y;return b-h}L_e(){if(!this.kKa&&!this.q2){this.Vlh=document.createElement("div");this.q2.id=us.dpk;this.q2.className=us.cpk;this.q2.setAttribute(qf.a.Aga,WordEditorIntl.WordEditorStrings.L_Ruler);this.q2.setAttribute(qf.a.uh,qf.a.gwh);this.q2.classList.add("HideWACVerticalRulerContainer");if(this.DAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Gc.a.tca(b,
!h)&&Sys.UI.DomElement.addCssClass(this.q2,us.Rbk)}this.Wlh=document.createElement("div");this.kKa.className=us.bpk;this.kKa.id=us.epk;this.q2.appendChild(this.kKa);b=document.getElementById(xk.AppFrame.Ned);b.insertBefore(this.q2,b.firstChild)}}static gF(){return new us(Ya.a.instance.Sa("Common.IZoomManager"),qe.App.li,v.AFrameworkApplication.va,Ik.UISurfaces.Xgi,Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),vq.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
us.dDg?us.dDg:us.dDg=us.gF()}}us.dpk="WACVerticalRulerContainer";us.cpk="WACVerticalRulerContainer";us.epk="WACVerticalRuler";us.bpk="WACVerticalRuler";us.Rbk="ModernUxWACVerticalRulerContainer";Object(n.a)(us,"VerticalRuler",Qu,[]);class Cl{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.XDe=this.vGe=!1;this.wP="RulerActor";this.Veh=null;this.Mpa=!1;this.oZj="ClearAllTabStopsFailed";this.hhh="ShowHideRulerFailed";this.hIe=null;this.zGd=(Jb,Yb,fc)=>{if(1===fc)return 32;Jb=this.ga.processAction(V.a.$Ob,2,
null);32===Jb?(fc=1,Yb=String.format("Clear all tab stops from ruler"),t.ULS.sendTraceTag(591213266,3014,50,Yb)):(fc=0,Yb=String.format("Unable to clear all tab stop from ruler"),t.ULS.sendTraceTag(591213267,3014,15,Yb),Cl.recordQosError(this.oZj,[Cl.aga],Yb));const Mc=new Map;Mc.set("Command","ClearAllTabStops");Mc.set("Source",this.wP);Mc.set("Response",Yb);xa.Health.instance.recordKpiUsage(Op.kpiName,fc,Op.Q8,Mc);return Jb};this.nVc=(Jb,Yb,fc)=>{if(1===fc)switch(Jb){case V.a.l4e:case V.a.gef:return 2;
default:return 32}Yb=this.JRe.Wbm();switch(Jb){case V.a.sLf:var Mc=1;break;case V.a.Jag:Mc=4;break;case V.a.C7e:Mc=3;break;default:return t.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Jb=new jz.a(Yb,Mc,0,1);Jb=this.ga.Qb(V.a.E9c,2,Jb);32===Jb?(fc=1,Yb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",nr[Mc],Yb.toString()),t.ULS.sendTraceTag(591213269,3014,50,Yb)):(fc=0,Yb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",
nr[Mc],Yb.toString()),t.ULS.sendTraceTag(591213270,3014,15,Yb));Mc=new Map;Mc.set("Command","InsertCustomTabStopRuler");Mc.set("Source",this.wP);Mc.set("Response",Yb);xa.Health.instance.recordKpiUsage(Op.kpiName,fc,Op.Q8,Mc);return Jb};this.nRb=(Jb,Yb,fc,Mc,Wc)=>this.vGe||1===fc&&$i.a.via(Yb.ik)?8:this.Mpa?this.KTc(Jb,Yb,fc,Mc,Wc):this.Nyo(Yb,fc);this.T$n=()=>{this.Mpa?t.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),
32!==this.ga.processAction(Mb.a.nRb,2)?(t.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Cl.recordQosError(this.hhh,[Cl.aga],"Ruler could not be enabled")):t.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.KTc=(Jb,Yb,fc)=>{if(1===fc||!this.Mpa)return 32;this.Mpa=!1;this.KRe.Dhj(!1);this.Kbb.dispose();this.U1d()&&this.Egf();this.fIj();t.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Jb=new Map;Jb.set("Command","HideRuler");Jb.set("Source",
this.wP);Jb.set("Response","");xa.Health.instance.recordKpiUsage(Op.kpiName,1,Op.Q8,Jb);return 32};this.hce=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return 32;Wc&&(Wc[Df.a.On]=this.Mpa);return 32};this.lAm=Jb=>{this.Mpa=Jb.result};this.ZHb=()=>{this.vGe=!1};this.Joi=()=>{this.vGe=!0};this.ga=b;this.Kbb=h;this.dYe=r;this.uUb=B;this.JRe=P;this.KRe=ca;Cl.Yk=Qa;this.aMa=ra;this.qT=mb;this.aMa.Frh(this.Joi);this.aMa.zCd(this.ZHb)}initialize(){this.Ub();this.Veh=this.T$n;window.addEventListener("TurnRulerOnAction",
this.Veh,!0);return this.KRe.ldm().continueWith(this.lAm,8)}Ub(){this.ga.qa(Mb.a.nRb,zc.a.view,this.nRb);this.ga.fb(Mb.a.hce,zc.a.view,this.hce,96);this.ga.qa(V.a.l4e,zc.a.view,this.nVc);this.ga.qa(V.a.C7e,zc.a.view,this.nVc);this.ga.qa(V.a.zGd,zc.a.view,this.zGd);this.ga.qa(V.a.gef,zc.a.view,this.nVc);this.ga.qa(V.a.KTc,zc.a.view,this.KTc);this.ga.qa(V.a.sLf,zc.a.view,this.nVc);this.ga.qa(V.a.Jag,zc.a.view,this.nVc);mB.a.fd.addHandler(mB.a.l8d,this.X2c.bind(this));this.qT.fBb(this.DZf)}tsi(){this.Mpa&&
(this.Kbb.fC(),this.Kbb.renderRuler(),this.U1d()&&this.cdj())}cdj(){this.dYe.fC();this.dYe.renderRuler()}Egf(){this.dYe.dispose()}U1d(){return this.bFi()&&this.isPaginatedView()}bFi(){null==this.hIe&&null!=v.AFrameworkApplication.K&&(this.hIe=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.hIe}HVa(){this.Mpa||Ya.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}BX(){this.aMa.E2n(this.Joi);
this.aMa.fcj(this.ZHb);this.Mpa&&(this.Kbb.dispose(),this.U1d()&&this.Egf())}fIj(){if(this.uUb){const b={};b[Op.j2o]="ToggleButtonModel";this.uUb.lH(b)}}Nyo(b,h){if(!Cl.Yk.g9(b.ik))return t.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Cl.recordQosError(this.hhh,[Cl.aga],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Mpa=!0;this.KRe.Dhj(!0);this.tsi();this.fIj();t.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;
b.set("Command","ShowRuler");b.set("Source",this.wP);b.set("Response","");xa.Health.instance.recordKpiUsage(Op.kpiName,1,Op.Q8,b);return 32}isPaginatedView(){return 1===this.qT.ou}X2c(b,h){switch(h.documentMode){case "View":this.Mpa&&(this.ga.processAction(Mb.a.nRb,2),this.XDe=!0);break;case "Edit":this.XDe&&(this.ga.processAction(Mb.a.nRb,2),this.XDe=!1)}}DZf(b,h){if(Cl.instance.Mpa&&Cl.instance.bFi())switch(h.rnb){case 1:Cl.instance.cdj();break;case 0:Cl.instance.Egf()}}static recordQosError(b,
h,r){const B=Object.assign(new sb.a,{extendedProperties:new Map});r&&B.extendedProperties.set("exception",r);xa.Health.instance.recordQosError(b,h,!1,!0,!1,!1,B)}static gF(){return new Cl(v.AFrameworkApplication.va,Pp.instance,us.instance,ab.StaticActiveAppFrame.za(),Ya.a.instance.resolve("WordEditor.IRulerContextMenu"),Ya.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Ya.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Kn.a.instance,Ya.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Cl.fCg?Cl.fCg:Cl.fCg=Cl.gF()}}Cl.Yk=null;Cl.aga="RulerInteractionFailed";Object(n.a)(Cl,"RulerActor",null,[]);class kC{constructor(b,h){this.KCc=null;this.r6a=r=>r.result?r.result.Value.toString():"";this.LHa=r=>{r.Ho||r.Gi?(t.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.KCc=!1):(r=r.result,""===r&&v.AFrameworkApplication.K&&(r=v.AFrameworkApplication.K.kb("RulerDefaultOn")),this.KCc="true"===r.toLowerCase(),t.ULS.sendTraceTag(591541279,
3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.KCc};this.Fv=b;this.NK=h}ldm(){const b=new jg.a;if(null==this.KCc){if(this.JCi())return this.NK.k7a(RC.a.F8c).CWRCo(this.r6a,0).CWRCo(this.LHa,8);b.Dg(!1)}else b.Dg(this.KCc);return b.task}j2(b){this.NK.j2(RC.a.F8c,new qE.a(RC.a.F8c,b))}Dhj(b){this.JCi()&&(this.Fv.ika("saveRulerIsEnabled",b.toString()),t.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));
this.j2(b)}JCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(n.a)(kC,"RulerSettingInfo",null,[361]);class Hj{constructor(){this.J_g=this.W=null}get name(){return"WordEditor.Ruler"}wc(b){this.W=b;t.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new kC(this.W.resolve("Box4.IRoamingServiceRequestManager"),
this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()});this.J_g=Cl.instance.initialize();t.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}xn(){this.J_g.continueWith(()=>{Cl.instance.tsi();Cl.instance.HVa()});t.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Cl.instance.BX();t.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}
Object(n.a)(Hj,"PackageManager",null,[1,2]);class vE{constructor(){this.Abc=this.b3b=null}}Object(n.a)(vE,"CreatePickerCustomizationDictionaryOptions",null,[1136]);class wE{}wE.Vg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(wE,"InsertMediaM365DialogHtml",null,[]);class kD{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,
fc,Mc,Wc,id,Id,ve){this.IO=ve;this.oab=null;this.qFf=this.mqd=!1;this.ktj=$d=>{if($d.rawEvent&&($d=$d.rawEvent.data))try{const be=Sys.Serialization.JavaScriptSerializer.deserialize($d,!0),he=be.MessageId?be.MessageId.toString():null;be&&he&&(he===M.a.insertImage||he===M.a.yCf)&&this.EAc.start(he===M.a.insertImage?this.Ybb:this.V_g)}catch(be){}};this.GWo=($d,be,he,re,Xf)=>{if(1===he)return 32;this.I2g?$d=CommonUIStrings.l_OneDriveName:""!==this.Fnd?$d=this.Fnd:($d=CommonUIStrings.l_HostGeneric,t.ULS.sendTraceTag(20509841,
352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Xf[mm.a.LabelText]=$d;return 32};this.JWo=($d,be,he,re,Xf)=>{if(1===he)return 32;if(!v.AFrameworkApplication.fGf())return Xf[mm.a.Visible]=!1,32;this.I2g?$d=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Fnd?$d=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Fnd):($d=CommonUIStrings.l_ChangePictureFromHostGeneric,t.ULS.sendTraceTag(577835747,
352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Xf[mm.a.LabelText]=$d;return 32};this.HWo=($d,be,he,re,Xf)=>{if(1===he)return 32;v.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Xf[mm.a.Visible]=!1);return 32};this.IWo=($d,be,he,re,Xf)=>{if(1===he)return 32;v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Xf[mm.a.Visible]=!1);return 32};this.rje=($d,be,he)=>{var re;be=this.$wc.value.Kga(be);
if(1===he)return be&&this.Xbb.FPm?32:8;if(2!==he||!be)return 8;(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("PictureBing");this.oab=Lb.a.create();t.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");$d=this.U1l($d,this.oab);$d=this.WZe($d);$d=this.Aod.iRc($d);$d.correlationId=this.oab;$d.QCf=this.W_g;$d.pqa=1;return this.pje($d,CommonUIStrings.L_PictureInsertTitle,
this.Ybb)};this.Uxo=($d,be,he)=>{$d=32===this.ga.Mf(be,Mb.a.insertHyperlink,1,!1,null,null);if(1===he)return $d&&this.Xbb.wzi?32:8;if(2!==he||!$d)return 8;t.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.pje(this.U_g.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.V_g)};this.Wsj=($d,be,he)=>{$d=this.$wc.value.Kga(be);if(1===he)return $d&&this.Xbb.eGf?32:8;if(2!==he||!$d)return 8;t.ULS.sendTraceTag(17838539,
352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.pje(this.U_g.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Ybb)};this.nje=($d,be,he)=>{var re;be=this.$wc.value.Kga(be);if(1===he)return be&&this.Xbb.HPm?32:8;if(2!==he||!be)return 8;t.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&gv.a.instance.p7a("PictureStock");this.oab=Lb.a.create();he=v.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.zI.isFreemiumUpsellEnabled();he=this.mqd?1:he?0:-1;$d=this.H4l($d,this.oab,he);$d=this.Aod.iRc($d);$d.Vg=wE.Vg;$d.correlationId=this.oab;$d.pqa=2;$d.QCf=this.W_g;$d.Aba=this.zI;$d.DJj=he;return this.pje($d,CommonUIStrings.L_PictureInsertTitle,this.Ybb)};this.sje=($d,be,he)=>{var re;be=this.$wc.value.Kga(be);$d=Ya.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===he)return be&&!this.Xbb.eGf&&$d&&$d.nIf()?32:8;if(2!==he||!be||!$d)return 8;t.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("PictureOneDrive");this.oab=Lb.a.create();he=kD.Rlh;re=!1;v.AFrameworkApplication.gGf()&&(re=this.EMl());be=new vE;be.b3b=re;be.Abc=!0;he=$d.Bbf(CommonUIStrings.L_ImageUploadButtonText,
"Select Images",!0,!1,!0,he,"Insert Media",1,be);$d.aSd(he).then(Xf=>{if(null!=Xf&&0<Xf.length){const Mg=[];for(let $l=0;$l<Xf.length;$l++){const Nm=Xf[$l][H.a.G2i],zp=Xf[$l][H.a.F2i],vv={};vv.Extension=Nm;vv.OriginalUrl=zp;vv.caption=Nm;Mg.push(vv)}this.Ybb.iRa=Mb.a.R_;this.Ybb.a4a(Mg)}});return 32};this.qje=($d,be,he)=>{var re;const Xf=this.$wc.value.Kga(be);be=Ya.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===he)return Xf&&be&&be.nIf()?32:8;if(2!==he||!Xf||!be)return 8;he=
Ya.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=he&&he.yCl(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));t.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("PictureMobile");this.oab=Lb.a.create();
re=kD.Rlh;he=new vE;he.b3b=!0;he.Abc=!0;re=be.Bbf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,re,"InsertPictureFromMobile",3,he);be.aSd(re).then(Mg=>{if(null!=Mg&&0<Mg.length){var $l=[];const Nm=$d===Mb.a.tYd;let zp=!1;const vv=v.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let cD=0;cD<Mg.length;cD++){const sB=Mg[cD][H.a.G2i],ZD=Mg[cD][H.a.F2i],zz={};zz.Extension=sB;zz.OriginalUrl=ZD;zz.caption=sB;$l.push(zz);zp||(zp=-1!==zz.OriginalUrl.indexOf(vv))}this.Ybb.iRa=
Mb.a.R_;this.Ybb.a4a($l);$l={};$l.InsertImageCount=Mg.length;zp&&ne.c(Nm?Mb.a.BEm:Mb.a.mVk,void 0,void 0,void 0,void 0,void 0,$l)}});return 32};this.EAc=B;this.ntd=P;this.Aod=ra;this.U_g=Qa;this.m3=mb;this.ga=b;this.$wc=ca;this.I2g=Mc;this.Fnd=id;this.Xbb=r;this.Ybb=Jb;this.V_g=Yb;this.W_g=Id;(this.zI=fc)&&this.zI.isFeatureEnabled("MsoPremiumStockImages",!1).catch($d=>t.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
$d)).then($d=>{(this.mqd=$d)||this.zI.iza("MsoPremiumStockImages",()=>{this.mqd=!0;t.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Ub(){(this.Xbb.eGf||this.Xbb.wzi)&&this.Xbb.GPm&&this.nHn();this.mXn();this.lXn();this.ga.fb(Mb.a.mDh,zc.a.view,this.Wsj,1284);this.ga.fb(Mb.a.$5i,zc.a.view,this.JWo,1124);this.ga.fb(Mb.a.KCf,zc.a.view,this.Wsj,1284);this.ga.fb(Mb.a.U4f,zc.a.view,this.GWo,1124);this.ga.fb(Mb.a.JEm,zc.a.view,this.Uxo,
1284)}mXn(){this.ga.fb(Mb.a.insertOnlinePicture,zc.a.view,this.rje,1284);this.ga.fb(Mb.a.qYd,zc.a.view,this.nje,1284);this.ga.Mja("word_insertOnlinePictures",Mb.a.insertOnlinePicture,zc.a.view,this.rje,b=>{ab.StaticActiveAppFrame.za().Zoc(b,Object(z.a)(new gd.a,(new gd.a).VFb,"getCommandById"))});this.ga.Mja("word_insertOnlinePictures",Mb.a.qYd,zc.a.view,this.nje,b=>{ab.StaticActiveAppFrame.za().Zoc(b,Object(z.a)(new gd.a,(new gd.a).VFb,"getCommandById"))});this.ga.fb(Mb.a.L7e,zc.a.view,this.rje,
1284);this.ga.fb(Mb.a.N7e,zc.a.view,this.sje,1284);this.ga.Mja("word_insertOnlinePictures",Mb.a.N7e,zc.a.view,this.sje);this.ga.fb(Mb.a.O7e,zc.a.view,this.nje,1284);this.ga.fb(Mb.a.Y5i,zc.a.view,this.HWo,1284);this.ga.fb(Mb.a.Z5i,zc.a.view,this.IWo,1284);this.ga.Mja("word_insertOnlinePictures",Mb.a.L7e,zc.a.view,this.rje);this.ga.Mja("word_insertOnlinePictures",Mb.a.O7e,zc.a.view,this.nje);this.ga.fb(Mb.a.MCf,zc.a.view,this.sje,1284);this.ga.Mja("word_insertOnlinePictures",Mb.a.MCf,zc.a.view,this.sje,
b=>{ab.StaticActiveAppFrame.za().Zoc(b,Object(z.a)(new gd.a,(new gd.a).VFb,"getCommandById"))})}lXn(){v.AFrameworkApplication.gGf()&&(this.ga.fb(Mb.a.tYd,zc.a.view,this.qje,1284),this.ga.fb(Mb.a.M7e,zc.a.view,this.qje,1284),this.ga.Mja("mso_insertMobileDevicePictures",Mb.a.tYd,zc.a.view,this.qje,b=>{ab.StaticActiveAppFrame.za().Zoc(b,Object(z.a)(new gd.a,(new gd.a).VFb,"getCommandById"))}),this.ga.Mja("mso_insertMobileDevicePictures",Mb.a.M7e,zc.a.view,this.qje,b=>{ab.StaticActiveAppFrame.za().Zoc(b,
Object(z.a)(new gd.a,(new gd.a).VFb,"getCommandById"))}))}nHn(){v.AFrameworkApplication.ta.get_element().appendChild(this.ntd.Z1a);De.a.addHandler(this.ntd.Z1a.contentWindow,"message",this.ktj);this.qFf=!0}U1l(b,h){let r=0;v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb&&5===v.AFrameworkApplication.ta.Kb.xk&&(r=12);const B=Hi.a.ug(v.AFrameworkApplication.lcid);return String.format(v.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Mb.a.insertOnlinePicture?1:0,v.AFrameworkApplication.lcid,
B?B.name:"en-us",v.AFrameworkApplication.buildVersion,h,r,v.AFrameworkApplication.K.kb("UserId"))}pje(b,h,r){try{return b.oje(h,r,void 0),t.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(B){return t.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",B.toString()),this.Ep(vg.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),
8}}H4l(b,h,r){if(Mb.a.qYd===b)return b=this.m3.uzh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),1,r),this.WZe(b);b=this.m3.uzh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.WZe(b)}Ep(b,h,r){const B=new Wh.StandardDialog(!0);B.Kt=v.AFrameworkApplication.cda;B.Cd=0;B.ye(1,CommonUIStrings.l_DialogClose);B.wx(b,h,r,()=>{})}EMl(){const b=Ya.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.OQl():!1}dispose(){this.qFf&&
this.ntd.Z1a.contentWindow&&(De.a.removeHandler(this.ntd.Z1a.contentWindow,"message",this.ktj),this.qFf=!1)}WZe(b){return this.IO&&this.IO.nJ?(b=new xb.QueryStringBuilder(b),b.Ae("theme","4"),b.toString()):b}}kD.Rlh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(kD,"InsertMediaActor",null,[10]);var UC=c(975);class mF extends UC.a{constructor(b,h){super(b,ka.a.getOrigin(h))}aq(b,h){this.isEnabled()&&this.yba(this.S8a)&&(this.Gv(b),this.eC(b,h))}}Object(n.a)(mF,"InsertMediaCrossDocumentMessenger",
UC.a,[495,70,10]);class nF{getInstance(b,h){return new mF(b,h)}}Object(n.a)(nF,"InsertMediaCrossDocumentMessengerFactory",null,[478]);var iG=c(778);class HD{}HD.Vg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(HD,"InsertMediaDialogHtml",null,[]);var lD;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";
b[b.open=3]="open"})(lD||(lD={}));Object(n.b)("HubbleAction",lD);var sA;(function(b){b[b.unknown=0]="unknown";b[b.Vfp=1]="bing";b[b.Ibp=2]="M365";b[b.Slp=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.kbc=5]="hubble"})(sA||(sA={}));Object(n.b)("InsertMediaProviders",sA);class ID extends Pf.a{constructor(b,h,r,B=null,P=!1){super(!1,!1,P);this.xy=null;this.qvc=!1;this.d0c=this.a1=null;this.v6e="KeepFocusDiv";this.eFd="KeepFocusStartDiv";this.correlationId=null;this.pqa=0;this.Aba=this.QCf=null;this.DJj=
0;this.QJe=null;this.Bqn=()=>{this.a1&&(this.a1.style.visibility="visible",window.setTimeout(()=>{if(this.kj){const ca=this.kj.getElementById(this.eFd);ca&&ca.focus()}},0))};this.sda=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.v6e||ca.shiftKey?ca.target.id===this.eFd&&ca.shiftKey&&(ca.preventDefault(),this.kj.getElementById(this.v6e).focus()):(ca.preventDefault(),this.kj.getElementById(this.eFd).focus()))};this.AUi=()=>{t.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");
this.NEb(this.f0a);this.Tpb(1)};this.bXf=()=>{this.xy&&(t.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.xy.sendMessage(M.a.Clj,{["CustomHeaders"]:""}))};this.SVi=()=>{this.xy&&(t.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.xy.sendMessage(M.a.woo,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.PVi=()=>{this.xy&&(t.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.xy.sendMessage(M.a.Cho,
{["CID"]:""}))};this.Zqn=()=>{this.Aba&&(t.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.Aba.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Bod=b;this.tWb="";this.m3=r;this.Yta=[];this.yud=h;this.Vg=B||HD.Vg;this.zg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async oje(b,h){this.tWb=b;this.qvc=!1;this.showDialog(this.tWb,
null);this.a1=this.Q9b(this.rj("insertmediaframe"));if(!this.a1)throw this.NEb(this.f0a),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.eFd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.a1.parentNode.insertBefore(b,this.a1.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.v6e);b.setAttribute("tabindex","0");
this.a1.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.wff,"keydown",this.sda);this.a1.src=this.Bod;this.a1.style.width="100%";this.a1.style.height="100%";this.a1.frameBorder="0";v.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&ba.a.Dj?(this.a1.style.visibility="hidden",this.d0c=this.Bqn,De.a.addHandler(this.a1,"load",this.d0c)):this.a1.style.visibility="visible";this.Q9b(this.rj("WACDialogButtonPanel")).style.display=
"none";this.Q9b(this.rj("WACDialogTitleText")).style.display="none";2===this.pqa&&(this.Q9b(this.rj("WACDialogTitlePanel")).style.display="none",this.Q9b(this.rj("WACDialogBodyPanel")).style.padding="0");kb.FocusManager.instance().at().scope.fI=!0;this.xy=this.yud.getInstance(this.a1.contentWindow,this.Bod);this.xy.yba("https://osiziwuspersimmon002.blob.core.windows.net");this.xy.yba("https://osizewuspersimmon001.blob.core.windows.net");this.xy.yba("https://osizpscuspersimmon000.blob.core.windows.net");
this.xy.yba("https://cdn.hubblecontent.msit.osi.office.net");this.xy.yba("https://cdn.hubblecontent.osi.office.net");this.xy.aq(M.a.nph,r=>{this.PTi(r,Object(z.a)(h,h.a4a,"insertMediaCallback"))});this.xy.aq(M.a.insert,r=>{this.X7d(r,Object(z.a)(h,h.a4a,"insertMediaCallback"))});this.xy.aq(M.a.Iph,r=>{this.eXi(r)});this.xy.aq(M.a.O8h,this.bXf);this.xy.aq(M.a.getSessionId,this.SVi);this.xy.aq(M.a.w6h,this.PVi);this.xy.aq(M.a.AFd,this.AUi);2!==this.pqa||this.DJj||(this.xy.aq(M.a.A0m,this.Zqn),this.QJe=
this.Aba.iza("MsoPremiumStockImages",r=>{t.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.xy.sendMessage(M.a.R0o,{["LicenseTier"]:r.toString()})}));this.Tpb(3)}dispose(){this.Aba&&this.QJe&&this.Aba.yjc("MsoPremiumStockImages",this.QJe);this.xy&&(this.xy.dispose(),this.xy=null);this.d0c&&(De.a.removeHandler(this.a1,"load",this.d0c),this.d0c=null);super.dispose()}PTi(b,h){t.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.m3.PBn(b))this.Yta.push(b),
this.qvc&&(h(this.Yta),this.qvc=!1)}Ep(){const b=new Wh.StandardDialog(!0);b.Kt=v.AFrameworkApplication.cda;b.Cd=0;b.ye(1,CommonUIStrings.l_DialogOk);b.sv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Tpb(b){if(2===this.pqa){const r=v.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new ma.a,{name:"InsertedFiles",int64:this.Yta.length}));h.push(Object.assign(new ma.a,{name:"MediaDetails",
string:JSON.stringify(this.Yta)}));h.push(Object.assign(new ma.a,{name:"DialogResult",string:lD[b]}));h.push(Object.assign(new ma.a,{name:"DialogMode",string:this.Kci()}));h.push(Object.assign(new ma.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ma.a,{name:"Provider",string:sA[this.pqa]||"Unknown"}));oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:h}))}}}Kci(){return 3===this.pqa?"Icons":
5===this.pqa?"ExternalContent":"Images"}Q9b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}X7d(b,h){t.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.NEb(this.f0a);h?this.Yta&&50<this.Yta.length?(this.Ep(),this.Tpb(0),t.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Yta.length,sA[this.pqa])):this.Yta&&0<this.Yta.length?(h(this.Yta),this.Tpb(0),t.ULS.sendTraceTag(578140105,
352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Yta.length,sA[this.pqa])):(t.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.qvc=!0,h(this.Yta),this.Tpb(2)):this.Tpb(2)}eXi(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,t.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),oa.a.sendOtelEvent(Object.assign(new iG.a,{otelEvent:b})))}}Object(n.a)(ID,"InsertMediaDialog",Pf.a,[475,10]);class oF{constructor(b,
h){this.rFe=b;this.m3=h}iRc(b,h=!1){return new ID(b,this.rFe,this.m3,HD.Vg,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(oF,"InsertMediaDialogFactory",null,[477]);class pF{constructor(b,h,r){this.iwi=!1;this.correlationId=null;this.pqa=0;this.QCf=null;this.v6j=b;this.YEc=[];this.Gnd=h;this.Dih=r.split(";")}async oje(b,h){Array.clear(this.YEc);b=this.v6j.value;b.yba(this.Gnd);b.Gv(h.VTc);this.iwi||(b.eC(h.VTc,r=>{this.X7d(r,h)}),this.iwi=!0);t.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");
b.sendMessage(h.$Oh,{["FileExtensionFilterList"]:this.Dih})}Cwk(b){Array.contains(this.YEc,b)||this.YEc.push(b)}X7d(b,h){t.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.m1i(b);const r=[];for(let B=0;B<b.length;B++){const P=b[B];h.m_d(P,this.Dih)?r.push(P):this.Cwk(h.Agi(P))}r&&r.length?h.a4a(r):t.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.YEc.length&&(h=this.YEc.join(", "),t.ULS.sendTraceTag(20509844,
352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.uzo(h))}uzo(b){const h=new Wh.StandardDialog;h.Cd=0;h.IV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(n.a)(pF,"InsertMediaFromHostManager",null,[475,10]);class xE{constructor(b){this.E7j=b}iRc(){throw Error.notImplemented();}getInstance(){return this.E7j}}Object(n.a)(xE,"InsertMediaFromHostManagerFactory",null,[476,477]);
class qF{constructor(){this.Z1a=document.createElement("iframe");this.Z1a.src="about:blank";this.Z1a.style.visibility="hidden";this.Z1a.style.position="absolute";this.Z1a.style.zIndex="-100"}}Object(n.a)(qF,"InsertMediaFromHostOneDriveHostFrame",null,[474]);class yy extends UC.a{constructor(b,h){super(b,"*"===h?h:ka.a.getOrigin(h));this.qoh(M.a.insertImage);this.qoh(M.a.yCf)}Bee(){}}Object(n.a)(yy,"InsertMediaFromOneDriveCrossDocumentMessenger",UC.a,[283,70,10]);class pt{}Object(n.a)(pt,"OnlineMediaSearchResult",
null,[]);class Dj{uzh(b,h,r,B){const P=Hi.a.ug(v.AFrameworkApplication.lcid).name,ca=v.AFrameworkApplication.buildVersion,ra=E.a.PQ(v.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Qa=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;v.AFrameworkApplication.se("ShIns226;ShIns226cf");return String.format(b,v.AFrameworkApplication.lcid,P,ca,h,Dj.nse,ra,B,r,Qa)}return String.format(b,v.AFrameworkApplication.lcid,
P,ca,h,Dj.nse,ra,B,r)}PBn(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new pt,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",
Html:b.html||"",ProviderName:b.providerName||""})}QBn(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let B=0;B<b.length;B++){var r=b[B];r&&(r=Object.assign(new pt,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}v0f(b){const h=[];for(let B=0;B<b.data.files.length;B++){var r=b.data.files[B];r&&(r=Object.assign(new pt,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?
r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),h.push(r))}return h}m_d(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}iHn(b){let h="";if(b)for(let r=0;r<b.length;r++){const B=b[r];B&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',B.OriginalUrl,B.Width,B.Height))}return h}}Dj.nse=0;Object(n.a)(Dj,"InsertMediaHelper",null,[473]);class rF{constructor(b,h,r,B,P){this.FPm=b;this.eGf=h;this.wzi=r;this.GPm=
B;this.HPm=P}}Object(n.a)(rF,"InsertMediaSettingsManager",null,[]);class yE{constructor(b){this.kxc=Mb.a.insertHyperlink;this.ga=b}get iRa(){return this.kxc}set iRa(b){this.kxc=b}a4a(b){try{t.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.iRa,2,b[h]);t.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){t.ULS.sendTraceTag(21612193,
352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(n.a)(yE,"InsertOneDriveFileHandler",null,[472]);class sF extends yE{constructor(b){super(b)}get $Oh(){return M.a.yCf}get VTc(){return M.a.bEm}m1i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}Agi(){Rc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}m_d(){return!0}n5i(b,h,r){b=r(b);b.length&&(r={},
r.Items=b,h.sendMessage(this.VTc,r))}o1i(b){const h=[];for(let r=0;r<b.data.files.length;r++){const B=b.data.files[r];if(B){const P={};P.DisplayText=String.format("{0}{1}",B.name,B.extension);P.Url=this.tGl([B.urls.viewInBrowser,B.urls.open,B.urls.download]);h.push(P)}}return h}tGl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];t.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(n.a)(sF,"InsertOneDriveFileHelper",yE,[471,472]);class zE{constructor(b,
h,r){this.kxc=Mb.a.R_;this.Xo=null;this.ga=b;this.m3=h;this.hga=r}get oc(){return this.ga}get Hv(){return this.Xo||(this.Xo=Ya.a.instance.resolve("Common.Utils.IAriaNotifier"))}get iRa(){return this.kxc}set iRa(b){this.kxc=b}a4a(b){try{t.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.m3.iHn(b);let r=2;if(h&&0<h.length){const B=new wc.DictionaryPropertySet;B.setValue(Zc.a.LP,h);B.setValue(Zc.a.R4,!0);if(this.hga){const P=
this.hga.bbd();P.r3b("insertOnlineImage");B.setValue(Zc.a.lva,P)}r=this.ga.Qb(this.iRa,2,B)}t.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){t.ULS.Vz(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(n.a)(zE,"InsertOnlineImageHandler",null,[472]);class JD extends zE{constructor(b,h,r=null){super(b,h,r)}get $Oh(){return M.a.insertImage}get VTc(){return M.a.pEm}m1i(b){return this.m3.QBn(b)}Agi(b){return b.Type}m_d(b,
h){return this.m3.m_d(b.Type,h)}o1i(b){return this.m3.v0f(b)}n5i(b,h,r){r=r(b);if(r.length){b=[];for(let B=0;B<r.length;B++){const P=r[B],ca={};ca.Extension=P.Type;ca.SourceUrl=P.OriginalUrl;ca.caption=P.Type;ca.SourceUrl=P.OriginalUrl;ca.Width=P.Width;ca.Height=P.Height;b.push(ca)}r={};r.Items=b;h.sendMessage(this.VTc,r)}}}Object(n.a)(JD,"InsertOnlineImageHelper",zE,[471,472]);class KD{constructor(b,h){this.fvb=b;this.yud=h}start(b){this.fvb.start({mode:"open",select:"multi",lightbox:"white"},(h,
r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){t.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.yud.getInstance(window.frames[0].parent,window.document.URL),r.n5i(h,b,B=>r.o1i(B))):t.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(n.a)(KD,"OneDriveFilePickerHelperV5",
null,[360]);class tF{constructor(){this.zod=this.W=null}get name(){return"Box4.Media"}wc(b){this.W=b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new qF).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new rF(Boolean.parse(v.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),v.AFrameworkApplication.fGf(),!1,v.AFrameworkApplication.ghg(),v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",
()=>new KD(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();b.ia("Box4.Media.InsertMediaActor",()=>new kD(v.AFrameworkApplication.va,v.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new zf.a(()=>Ya.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),
b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.aKb,v.AFrameworkApplication.dqa,v.AFrameworkApplication.fwm,v.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",
()=>new oF(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",()=>new xE(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManager",()=>new pF(new zf.a(()=>{if(v.AFrameworkApplication.ghg()){var r=Ya.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").Z1a;
r=new yy(r.contentWindow,"*")}else r=v.AFrameworkApplication.sY;return r}),v.AFrameworkApplication.ghg()?ka.a.getOrigin(window.document.URL):ka.a.getOrigin(v.AFrameworkApplication.QNb),v.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(nF,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();b.register(Dj,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new JD(v.AFrameworkApplication.va,
b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new sF(v.AFrameworkApplication.va)).ha()}init(){this.zod=this.W.resolve("Box4.Media.InsertMediaActor");this.zod.Ub()}dispose(){this.zod&&this.zod.dispose()}}Object(n.a)(tF,"MediaPackage",null,[1,2]);var jG=c(1114);class AE{get name(){return"Box4.PlaceholderText"}wc(b){const h=v.AFrameworkApplication.VG&&(!v.AFrameworkApplication.AHa||"blank"===v.AFrameworkApplication.AHa);
this.W=b;this.W.ia("Box4.PlaceholderText.PlaceholderTextProvider",()=>new jG.a(ab.StaticActiveAppFrame.za().jb.rc,this.W.resolve("Box4.ObjectSpaceParagraphCollection"),qe.App.li.Al.Te(12),h)).ha()}init(){this.W.resolve("Box4.PlaceholderText.PlaceholderTextProvider").init()}dispose(){}static main(){L.a.instance.Gc(new AE,4)}}Object(n.a)(AE,"PlaceholderTextPackage",null,[1,2]);var uF=c(349);class yz{constructor(){this.m$n="getAddinShortcutsPreference";this.n$n="saveAddinShortcutsPreference";this.o$n=
"{0}RoamingServiceHandler.ashx?action={1}&{2}";this.iNl=6E4;this.j6d=this.Una=this.P$=null}Igi(b){return String.format(this.o$n,v.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,v.AFrameworkApplication.em)}executeRequest(b,h,r,B,P=null){return yz.SQ.H2b(b,h,P,null,r,B,!1,null,this.iNl)}saveSetting(b,h,r,B,P){return this.Ehj(b,h,r,null,B,P)}startBatchUpdateScope(){this.j6d=[]}saveShortcutInfoArrayBatch(b,h,r){this.qbo(r,b,h)}qbo(b,h,r){const B={action:"",addinId:"",ownerType:0};
B.timestamp=(new Date).toUTCString();const P=this.getShortcutInfoArray(h.toString(),r.toString());b?(B.shortcutInfoArray=b,this.VZe(h,r,b)):P&&(B.shortcutInfoArray=P);b={};b[h.toString()]=B;h=new uF.a(r.toString(),b);this.j6d.push(h)}commitBatchUpdateScope(){return this.bad()?this.sbo().then(()=>{this.g4b();return Promise.resolve(!0)}):this.ubo().then(()=>{this.g4b();return Promise.resolve(!0)})}sbo(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=I.d(b)).returnValue)return t.ULS.sendTraceTag(522739852,
0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.j6d){(b=h[r.key])||(b={});const B=r.value;for(const P of zb.a.eP(B))b[P]=B[P];h[r.key]=b}this.P$=h;try{return localStorage.setItem("AddinShortcutPreferenceData",I.c(h)),Promise.resolve(!0)}catch(r){return t.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}ubo(){return this.ogo().then(b=>this.Mfe(b))}ogo(){return this.Yuf().then(b=>
{let h=null;b&&(({Gt:h}=I.d(b)).returnValue||t.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.j6d){(b=h[r.key])||(b={});const B=r.value;for(const P of zb.a.eP(B))b[P]=B[P];h[r.key]=b}this.P$=h;return I.c(h)})}saveShortcutInfoArray(b,h,r){return this.Ehj(0,"","",r,b,h)}Ehj(b,h,r,B,P,ca){const ra=this.bad(),Qa={};Qa.action=r;Qa.addinId=h;Qa.ownerType=b;Qa.timestamp=(new Date).toUTCString();
h=this.getShortcutInfoArray(P.toString(),ca.toString());0===b&&B?(Qa.shortcutInfoArray=B,this.VZe(P,ca,B)):h&&(Qa.shortcutInfoArray=h);b={};b[P.toString()]=Qa;P=new uF.a(ca.toString(),b);return ra?this.rbo(P):this.tbo(P)}rbo(b){return this.getSetting().then(h=>{let r=null;if(h&&!({Gt:r}=I.d(h)).returnValue)return t.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.P$=r;try{return localStorage.setItem("AddinShortcutPreferenceData",
I.c(r)),Promise.resolve(!0)}catch(B){return t.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",B),Promise.resolve(!1)}})}tbo(b){return this.ngo(b).then(h=>this.Mfe(h))}ngo(b){return this.Yuf().then(h=>{let r=null;h&&(({Gt:r}=I.d(h)).returnValue||t.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));r||(r={});r[b.key]=b.value;this.P$=r;return I.c(r)})}saveSettings(b){this.P$=I.a(b);this.g4b();return this.bad()?
this.Hhj(b):this.Mfe(b)}Hhj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return t.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}Mfe(b){const h={};h.Wac=b;const r=I.c(h);return new Promise(B=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)B(!1);else{var P=this.executeRequest(this.Igi(this.n$n),2,"SaveAddinShortcutsPreferenceRequest","38",r);P.continueWith(()=>{if(P.Ho||P.Gi)t.ULS.sendTraceTag(522739859,
0,10,"SaveAddinShortcutsPreference: Request failure"),B(!1);else{var ca=P.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Ne===wa.a.Zz?B(!0):B(!1)}})}}catch(ca){t.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),B(!1)}})}getSetting(){const b=this.bad();return this.P$?Promise.resolve(I.c(this.P$)):b?this.Hem():this.Yuf()}bad(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser"),h=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");
return b||!h}Hem(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return t.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}Yuf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.Igi(this.m$n),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.Ho||r.Gi)t.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let P="";var B=r.result;B&&B.args&&B.args.data?B.args.data.Ne!==
wa.a.Zz?t.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",B.args.data.Ne):B.args.data.te?(B=I.a(B.args.data.te),B.Wac&&(P=B.Wac)):t.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):t.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(P)}})}catch(r){t.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=
this.bad(),r=this;return this.getSetting().then(B=>{let P=null;B&&(P=I.a(B));if(!P)return t.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ca of zb.a.eP(P)){B=P[ca.toString()];for(const ra of zb.a.eP(B)){const Qa=B[ra];if(Qa.addinId===b)delete B[ra.toString()];else if(0===Qa.ownerType&&Qa.shortcutInfoArray){const mb=Qa.shortcutInfoArray,Jb=new vb.a;for(let Yb=0;Yb<mb.length;++Yb)mb[Yb].addinId!==b&&Jb.add(mb[Yb]);Qa.shortcutInfoArray=
Jb.toArray()}}zb.a.count(B)||delete B[ca]}r.P$=P;r.E_n(b);return h?r.Hhj(I.c(P)):r.Mfe(I.c(P))})}g4b(){if(this.P$){this.Una=null;const r=this.P$;for(let B in r){var b=B;const P=r[B];for(let ca in P){var h=ca;const ra=P[ca];ra.shortcutInfoArray&&this.VZe(parseInt(h),parseInt(b),ra.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=I.d(b)).returnValue)return t.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),
Promise.resolve(!1);this.P$=h;this.g4b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.P$&&(r=this.P$[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.P$&&(h=this.P$[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.g4b();
return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Una)return Promise.resolve(!0);var r=this.Una[b];if(!r)return Promise.resolve(!0);var B=r[h];r=B.modifiers;B=B.keyCode;const P=this.getShortcutInfoArray(r.toString(),B.toString());if(!P||!P.length)return Promise.resolve(!0);let ca=0;for(const ra of P){if(ra.addinId===b&&ra.action===h)break;++ca}if(ca>=P.length)return Promise.resolve(!0);P.splice(ca,1);return this.saveShortcutInfoArray(r,B,P).then(()=>{this.g4b();return Promise.resolve(!0)})}VZe(b,
h,r){this.Una||(this.Una={});for(const B of r){r=B.addinId;const P=B.action;let ca=this.Una[r];ca||(ca={});const ra={};ra.modifiers=b;ra.keyCode=h;ca[P]=ra;this.Una[r]=ca}}E_n(b){b in this.Una&&delete this.Una[b]}isActionCustomized(b,h){return this.Una&&(b=this.Una[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Una&&(b=this.Una[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.P$}static instance(){yz.a1e||(t.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),
yz.a1e=new yz,yz.SQ=v.AFrameworkApplication.He);return yz.a1e}}yz.a1e=null;yz.SQ=null;Object(n.a)(yz,"AddinShortcutsPreferenceSettingHelper",null,[]);class LD{constructor(b,h){this.Bjd=null;new vb.a;this.O1g=!0;this.Vmd=b;this.UXg=h}m0e(b){this.UXg.addHandler("GoalChangedEvent",b)}qjn(){this.UXg.raiseEvent("GoalChangedEvent")}DEf(b,h){return this.Bjd&&this.O1g?b in this.Bjd?this.Bjd[b]:"Formality"===h&&this.Vmd.Puf().formality?!1:!0:!0}hio(b,h){h===this.Vmd.Puf().formality&&(this.Bjd=b,this.qjn())}lXo(b){this.O1g=
b}}Object(n.a)(LD,"GoalChangeSource",null,[560,561,562]);var mD=c(1001),BE=c(933),kG=c(711);class MD{constructor(b,h,r,B,P,ca){this.VLa=h;this.GBa=r;this.Je=b;this.nB=B;this.Eg=P;this.F5j=ca;this.GBa.tJb()&&this.initialize()}initialize(){return this.nB.ll().then(()=>{this.Je.ob(this,mD.a.getTypeName());this.Je.addHandler(this,BE.a.getTypeName())}).catch(b=>{this.Eg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}KB(b,h){if(h===
Ue.a.getTypeName()||h===kG.a.getTypeName())if(!b||!b.content)this.Eg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Bf.a.getTypeNameFor(b.content)===mD.a.getTypeName()||Bf.a.getTypeNameFor(b.content)===BE.a.getTypeName())if(Bf.a.getTypeNameFor(b.content)===mD.a.getTypeName()){var r=b.content;this.Eg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.VLa.hio(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(Bf.a.getTypeNameFor(b.content)===
BE.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.F5j.lXo(!!r.supportType);return}this.Eg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Eg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(n.a)(MD,"GoalsAnnotationHandler",null,[55]);class vF{constructor(b){this.Ca=b}tJb(){return this.Ca.$("EditorGoalsEnabled")}}Object(n.a)(vF,"GoalsGate",null,[559]);var VC=c(1200),
ND=c(1201),lC=c(885);class vs{}vs.LKd=0;vs.PKd="1.0";vs.settingType="Goals";Object(n.a)(vs,"GoalsConstants",null,[]);var nB=c(1090);class mC{constructor(b,h,r,B,P){this.h_b=null;this.Wyi=!1;this.tbh=b;this.Xmd=h;this.Eg=r;this.GBa=B;this.aDe=P;this.GBa.tJb()?this.PQn():this.GBa.tJb()&&this.Fcg(vs.LKd,vs.PKd)}PQn(){new Promise(b=>{this.tbh.Xei(vs.settingType,h=>{this.QQn(h)?(this.Fcg(this.h_b.formality,this.h_b.version),b(this.h_b)):(this.Fcg(vs.LKd,vs.PKd),b(null))})})}QQn(b){this.Wyi=!0;if(!b||!b.wqb)return this.Eg.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;b=b.wqb.properties;var h=b.getValue(Oc.a.Qti);h=parseInt(h);b=b.getValue(Oc.a.Rti);if(!this.Xmd.Mrg(b))return this.Eg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.h_b=b=Object.assign(new nB.a,{formality:h,version:b});this.Eg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}Fcg(b,h){b=Object.assign(new lC.a,
{formality:b,version:h});this.aDe.dkj(b)}o9o(b){if(this.Xmd.Mrg(b.version)){var h=VC.a.tbl(b.version,b.formality.toString());this.tbh.Oph(Object.assign(new ND.a,{wqb:h,settingType:vs.settingType}))?this.h_b=b:this.Eg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Eg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}Pbi(){this.Wyi||this.Eg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");
return this.h_b}}Object(n.a)(mC,"GoalsPersistenceHandler",null,[492]);class tA{constructor(b,h,r,B){this.Eg=b;this.bDe=h;this.Xmd=r;this.GBa=B;this.Wmd=Object.assign(new nB.a,{formality:vs.LKd,version:vs.PKd});this.gTe=this.GBa.tJb()}Puf(){this.gTe&&(this.gTe=!1,this.bDe.Pbi()&&(this.Wmd=this.bDe.Pbi()));return this.Wmd}coo(b){this.gTe=!1;this.Xmd.Mrg(b.version)?(this.GBa.tJb()&&this.bDe.o9o(b),this.Wmd=b):(this.Eg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",
b.version),this.Wmd=Object.assign(new nB.a,{formality:vs.LKd,version:vs.PKd}))}}Object(n.a)(tA,"GoalsProvider",null,[337,338]);class OD{constructor(b,h,r,B){this.Je=b;this.nB=h;this.$V=r;this.Eg=B}dkj(b){b=Object.assign(new Ue.a,{parentPath:["Signal",lC.a.getTypeName()],items:[Object.assign(new ze.a,{body:b})]});this.aNd(b)}aNd(b){this.nB.ll().then(()=>{this.qZe(b)}).catch(h=>{this.Eg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}qZe(b){this.Je.activateAnnotation(mD.a.getTypeName(),
OD.h3b).then(()=>{this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Fg.a,{operation:b}))}).catch(h=>{this.Eg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}OD.h3b="GoalSelected";Object(n.a)(OD,"GoalsSignalSender",null,[336]);class ew{constructor(){ew.cYe=new RegExp(ew.$ok)}Mrg(b){return!!b.match(ew.cYe)&&1===b.match(ew.cYe).length}}ew.$ok="[0-9]+[.]?[0-9]*";ew.cYe=null;Object(n.a)(ew,"GoalsValidator",null,[333]);class Ps{constructor(){this.W=
null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new ew).as("WordEditor.Goals.IGoalsValidator").ha();this.W.ia("WordEditor.Goals.IGoalsGate",()=>new vF(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new tA(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),
this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new LD(this.W.resolve("WordEditor.Goals.IGoalReader"),new wd.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.W.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new mC(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),
this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new MD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),
this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new OD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){L.a.instance.Gc(new Ps)}}Object(n.a)(Ps,"WordEditorGoalsPackage",
null,[1,2]);var Ak=c(761),PD=c(411);class QD{constructor(){this.annotation=null;this.languages=new bd.a(Pa.a.ih())}}Object(n.a)(QD,"CritiqueCountWrapper",null,[]);class uA{constructor(){this.Isa=new Rb.a}wRd(){return this.Isa}nri(b,h,r,B){if(this.Isa.nb(r)){this.Isa.J(r).annotation.count+=h;r=this.Isa.J(r).languages;for(var P of B)r.add(P)}else P=U.a.create().toString(),b=Object.assign(new PD.a,{id:P,categoryName:b,count:h}),this.Isa.add(r,Object.assign(new QD,{annotation:b,languages:B}))}}uA.Ii=
389;Object(n.a)(uA,"BaseCritiquesByTypeCounter",null,[325]);class wF extends uA{constructor(b){super();this.Syb=new fa.a;this.Lxe=new fa.a;this.SAd=b}iom(b){const h=b.annotation;if(h&&Ak.a(Bf.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===Ue.a.getTypeName()){this.SAd.P1n(h.parentPath,r);b=r.M_.state;if(60!==b&&70!==b)return this.Syb.contains(h.id)&&this.Syb.remove(h.id),this.Yym(h.id,r),!0;this.Syb.add(h.id)}else if(b.opType===Xq.a.getTypeName())if(this.Syb.contains(h.id))this.Syb.remove(h.id);
else return this.hQh(r.typeId,h.id)}return!1}hom(b){if((b=b.annotation)&&Ak.a(Bf.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.Syb.contains(b.id))return this.Syb.add(b.id),this.hQh(h.typeId,b.id)}return!1}Yym(b,h){this.Lxe.add(b);b=new bd.a(Pa.a.ih());h.language&&b.add(h.language);this.nri(h.categoryName,1,h.typeId,b)}hQh(b,h){if(!this.Lxe.contains(h))return!1;if(!this.Isa.nb(b))return t.ULS.sendTraceTag(589866503,uA.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Isa.J(b).annotation.count)return t.ULS.sendTraceTag(589866504,uA.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.Lxe.remove(h);this.Isa.J(b).annotation.count--;return!0}}Object(n.a)(wF,"AlCritiquesByTypeCounter",uA,[589,325]);var lG=c(1022);class xF extends Gs.a{constructor(b,h,r,B,P,ca,ra,Qa,mb){var Jb;super();this.Je=b;this.SAd=h;this.xte=
r;this.VSg=B;this.VLa=P;this.Nta=ca;this.ti=ra;this.Naa=this.mRg=!1;this.uMe=new Rb.a;this.Ron=(Yb,fc)=>{this.SAd.kpm(fc)&&(this.Naa=!0,this.TY())};this.Mln=(Yb,fc)=>{this.xte.iom(fc)&&this.cQb()};this.hVi=()=>{this.cQb()};this.DVf=(Yb,fc)=>{this.xte.hom(fc)&&this.cQb()};this.Nnb=()=>{this.cQb()};this.cQb=()=>{let Yb=!1;this.ti.ie(()=>{var fc=this.DUl();const Mc=new vb.a;for(const Wc of fc)fc=Object.assign(new lG.a,{id:Wc.id,parentPath:Wq.a.lEb,content:Wc,annotationType:Bf.a.getTypeNameFor(Wc)}),
Mc.add(fc),Yb||(Yb=0<Wc.count);this.Je.gio(Mc)},"CC:SATH");!this.mRg&&Yb&&(oa.a.sendTelemetryEvent({...(new ea.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.mRg=!0)};this.dLm=(Yb,fc,Mc)=>{const Wc=!this.VLa||this.VLa.DEf(Yb,Mc);Yb=this.Nta&&this.Nta.instance?this.Nta.instance.CEf(Yb,Mc,fc.substr(1,fc.length-2)):!0;return Wc&&Yb};null===Qa||void 0===Qa?void 0:Qa.m0e(this.Nnb);mb.pra(this,7);null===(Jb=this.Nta)||void 0===Jb?void 0:Jb.execute(Yb=>{Yb.M0e(this.cQb)})}get index(){return 3}run(){this.Naa&&
(this.cQb(),this.Naa=!1)}KXi(){this.cQb()}f9k(b){let h=0;if(({value:h}=this.uMe.Fc(b.categoryName,0)).returnValue)if(h!==b.count)this.uMe.Z(b.categoryName,b.count);else return!1;else this.uMe.add(b.categoryName,b.count);return!0}DUl(){const b=new Rb.a;var h=this.SAd.wRd();const r=this.xte.wRd();this.Dpg(b,h);this.Dpg(b,r);this.VSg&&(h=this.VSg.wRd(),this.Dpg(b,h));h=new vb.a;for(const B of b.values)this.f9k(B)&&h.add(B);return h}Dpg(b,h){for(const P of h){h=P.value.annotation;const ca=P.key;var r=
this.mgo(P.value.languages);if(!b.nb(h.categoryName)){var B=U.a.create().toString();B=Object.assign(new PD.a,{id:B,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,B)}this.dLm(ca,r,h.categoryName)&&(r=b.J(h.categoryName),r.count+=h.count,r.countsByTypeId[ca]=(r.countsByTypeId[ca]?r.countsByTypeId[ca]:0)+h.count)}}mgo(b){const h=[];let r=0;for(const B of b)h[r++]=B;return I.c(h)}}Object(n.a)(xF,"CritiquesCounter",Gs.a,[587,588]);class yF{constructor(b){this.Q2=b}wRd(){const b=
new Rb.a,h=new bd.a(Pa.a.ih()),r=Object.assign(new PD.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.Q2.htc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new QD,{annotation:r,languages:h}));return b}}Object(n.a)(yF,"DictationCritiquesByTypeCounter",null,[326,325]);class RD extends uA{constructor(b){super();this.V$a=new Rb.a;this.Je=b}kpm(b){const h=Wq.a.RTd(b.nodeId);if(!Wq.a.af(h)){if(b.Zhb&&b.Zhb.length){let r=null;for(const B of b.Zhb)B.errorDetails.H4a()||
(b=this.A8h(B),Wq.a.af(b)||(r||(r=new Rb.a),r.nb(b)||r.add(b,new vb.a),r.J(b).add(B)));this.iQh(h);r?this.dmo(h,r):this.V$a.remove(h)}else{if(!this.V$a.nb(h))return!1;this.iQh(h);this.V$a.remove(h)}return!0}return!1}P1n(b,h){var r;if(({value:r}=this.V$a.Fc(b,r)).returnValue)for(const P of r)if(b=P.value,0<b.count&&this.bqf(b.J(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var B=b.J(r).end-b.J(r).Bc;b.J(r).Bc===h.range.start&&B===h.range.length&&(B=this.A8h(b.J(r)),this.Isa.nb(B)&&(B=this.Isa.J(B).annotation,
B.count=Math.max(0,B.count-1)),b.removeAt(r))}}iQh(b){if(this.V$a.nb(b))for(const r of this.V$a.J(b)){var h=r.key;b=r.value;this.Isa.nb(h)&&(h=this.Isa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}dmo(b,h){const r=new Rb.a,B=new Rb.a;for(const P of h){h=P.key;B.add(h,new bd.a(Pa.a.ih()));for(const ca of P.value){const ra=ca.end-ca.Bc,Qa=this.bqf(ca);this.mWk(b,Qa,ca.Bc,ra)?t.ULS.sendTraceTag(589866513,uA.Ii,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,ca.Bc,ra):(r.nb(h)||r.add(h,new vb.a),r.J(h).add(ca),B.J(h).add(this.FUl(ca)))}}this.V$a.Z(b,r);for(const P of this.V$a.J(b))0<P.value.count&&(b=this.bqf(P.value.J(0)),this.nri(b,P.value.count,P.key,B.J(P.key)))}A8h(b){let h=null;b&&(b=Object(Na.a)(323,b.errorDetails))&&b.Ft&&(h=b.Ft.TypeId);return h}bqf(b){let h=null;b&&(b=Object(Na.a)(323,b.errorDetails))&&b.Ft&&(h=b.Ft.CategoryTitle);return h}FUl(b){let h="";b&&b.errorDetails&&(h=Hi.a.ug(b.errorDetails.lcid).name);return h}mWk(b,h,r,B){if((b=
this.Je.zof(b))&&0<b.count)for(const P of b)if(b=Bf.a.getTypeNameFor(P.content),P&&Ak.a(b)&&(b=P.content,b.categoryName===h&&b.range.start===r&&b.range.length===B))return!0;return!1}}Object(n.a)(RD,"WacCritiquesByTypeCounter",uA,[324,325]);class nD{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new RD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.W.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new wF(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new yF(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.W.ia("WordEditor.CritiqueCounts.ICritiquesCounter",
()=>new xF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Sa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Zq.a.instance,this.W.Oa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).ha();
b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").srh(b.Ron);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Oxk(b.Mln);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").erh(b.DVf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.Oqh(b.hVi),h.Pqh(b.hVi))}}dispose(){}static main(){L.a.instance.Gc(new nD)}}Object(n.a)(nD,"WordEditorCritiqueCountsPackage",null,[1,2]);class CE{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new CE)}}
Object(n.a)(CE,"PackageManager",null,[1,2]);var mG=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",
attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class zF{constructor(b){this.m2j={};this.Vb=b;this.bzb=new Dh.a}FPa(b,h){const r=this.Vb.Kic,B=parseInt(b);return b&&B!==nd.ActionManager.mif?this.bzb.nb(r)?(b=this.bzb.J(r).zac(B,h,2),32===b||1===b):!1:!1}VGa(b){const h=parseInt(b),r=this.Vb.Kic;return b&&h!==nd.ActionManager.mif?this.bzb.nb(r)?
32===this.bzb.J(r).zac(h,this.m2j,1):!1:!0}s$i(b,h){this.bzb.Z(b,h)}Sqj(b){b=parseInt(b);const h=this.Vb.Kic;return!!h&&!!this.bzb.J(h)&&this.bzb.J(h).jKm(b)}}Object(n.a)(zF,"NonCanvasCuiUser",null,[1102,322]);var Ru=c(1227),so=c(48),WC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";
b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(WC||(WC={}));Object(n.b)("GalleryType",WC);class uv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(uv,"CommonGalleryButtonProps",null,[]);class SD extends uv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(n.a)(SD,"AdditionalTableStyleGalleryButtonProps",uv,[]);class AF extends SD{constructor(){super()}}
Object(n.a)(AF,"AdditionalChangeColorsGalleryButtonProps",SD,[]);class nC extends uv{constructor(){super();this.character=null}}Object(n.a)(nC,"AdditionalCharacterCodeGalleryButtonProps",uv,[]);class or extends uv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(or,"AdditionalFontStyleGalleryButtonProps",uv,[]);class DE{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}
Object(n.a)(DE,"AdditionalGalleryProperties",null,[]);class EE extends uv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(EE,"AdditionalIconButtonProperties",uv,[]);class BF extends uv{constructor(){super();this.styleDisplayName=null}}Object(n.a)(BF,"AdditionalInkThicknessGalleryButtonProps",uv,[]);class CF extends uv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(CF,
"AdditionalListGallerButtonProps",uv,[]);class oC extends uv{constructor(){super();this.text=null}}Object(n.a)(oC,"AdditionalPageNumberGalleryButtonProps",uv,[]);var zy=c(1156);const fw=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(Na.a)(Object,r[b])){if((b=Object(Na.a)(String,r.value))&&b===h)return!1;b=Object(Na.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let B=null;for(let P=0;P<r.length;P++){const ca=Object(Na.a)(Object,
r[P]);if(Object(Na.a)(String,ca.key)===b){B=ca;break}}if(B&&Object(Na.a)(String,B.text)===h)return!1}}return!0},lu=(b,h,r,B)=>{if(0<(B&2)){B=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":B.push(Lr(b,r[Df.a.On]));break;case "CheckboxModel":B.push(appChrome.actions.toggleCheckbox(b,r[Df.a.On]));break;case "ComboBoxModel":if(v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!fw(b,r[gk.a.Value]))break;(h=r[gk.a.Key])?B.push(appChrome.actions.updateComboBoxKey(b,h,r[gk.a.Value])):B.push(appChrome.actions.updateComboBoxValue(b,r[gk.a.Value]));break;case "FontPickerModel":B.push(appChrome.actions.updateFontPickerSelectedFont(b,r[zy.a.SelectedFont]));break;case "SplitButtonModel":B.push(Lr(b,r[zn.a.On]));break;case "SpinButtonModel":B.push(appChrome.actions.updateSpinButton(b,r[Gg.a.Number],af.a.R0a(r[Gg.a.UnitType]),r[Gg.a.Text],r[Gg.a.MaxValue],r[Gg.a.Alt]));break;
case "ColorPickerModel":B.push(appChrome.actions.updateColorPickerSelectedColor(b,r[bb.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":B.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[Ui.a.Text]));break;case "CompoundButtonModel":r[Df.a.Description]&&B.push(appChrome.actions.updateCompoundButtonDescription(b,r[Df.a.Description]));Df.a.On in r&&B.push(Lr(b,r[Df.a.On]));break;case "SliderModel":r.snapToStep?B.push(appChrome.actions.updateSliderSelectedValue(b,r[Fm.Value])):
B.push(appChrome.actions.updateSliderValue(b,r[Fm.Value],r[Fm.MinValue]||0,r[Fm.MaxValue],r[Fm.Text]));break;case "FlyoutAnchorModel":Zm.a.ImageIsVisible in r&&B.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[Zm.a.ImageIsVisible]));Df.a.On in r&&B.push(Lr(b,r[Df.a.On]));break;case "InputBoxModel":B.push(appChrome.actions.updateInputBoxValue(b,r[jl.a.Text]))}h=B;var P=Object(Na.a)(String,r[mk.a.iconColor]);void 0!==P&&null!==P&&h.push(appChrome.actions.updateIconColor(b,P));pC(b,r,B);h=B;(P=Object(Na.a)(Object,
r[mk.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,P));h=B;P=Object(Na.a)(String,r[mk.a.customTooltip]);void 0!==P&&null!==P&&h.push(appChrome.actions.setControlCustomTooltip(b,P));b=B;(r=Array.isArray(r[mk.a.U6f])?r[mk.a.U6f]:null)&&b.push.apply(b,r);return B}return null},oB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),Lr=(b,h)=>appChrome.actions.toggleButton(b,h),pC=(b,h,r)=>{h=Object(Na.a)(String,h[mk.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,
h))};class oD{constructor(b,h,r,B){this.rl=B;this.Wta=b;this.mA=h;this.Q_b=r;this.hyc={}}kFn(b,h,r,B,P=null){const ca=b.ExternalGalleryId||b.ExternalId;var ra=b.ExternalId;B.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&rh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ca,Object.assign(new DE,{columns:b.Width,sections:[appChrome.api.gallerySection([],ra)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}r=0;B=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(rh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ra=[];const mb=[],Jb=[],Yb={};for(var Qa of b.GallerySections){ra.push(appChrome.api.gallerySection([],Qa.SectionId,Qa.Title));0===r&&Qa.GalleryButtons&&0<Qa.GalleryButtons.length&&
(r=Qa.GalleryButtons[0].Type);B&&this.mfi(Qa.GalleryButtons,P,Yb);const fc=this.e_e(mb,Qa.GalleryButtons,Yb);mb.push.apply(mb,this.$tf(fc,ca,Qa.SectionId,!1,r,P,!0,Yb));Jb.push.apply(Jb,fc)}h.push(appChrome.actions.setGallerySections(ca,ra));h.push.apply(h,mb);h.push.apply(h,this.zrf(ca,WC[r],Jb,null,5===b.Type,!0,null,Yb))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Qa=B?this.mfi(b.GalleryItems,P,null):null,h.push.apply(h,this.$tf(this.e_e(h,b.GalleryItems,Qa),ca,ra,
!1,r,P,!1,Qa))}qam(b,h){const r=[];let B=null,P=!1;if(!b)return null;const ca=this.Wta.j4c(this.mA,b.commandId,h);r.push(oB(b.externalUxCommand,!ca));if(b.previewControlIds){const mb=[];for(let Jb=0;Jb<b.previewControlIds.length;Jb++){var ra={},Qa=b.previewControlIds[Jb];ra.SourceControlId=Qa;const Yb=this.rl.getCommandByExternalUxId(Qa);this.eUd(Yb||b,ra);ra[Ui.a.On]&&(B=ra.SourceControlId,ra[Ui.a.HighlightOn]&&(P=!0));pC(Qa,ra,r);if(ra=Object(Na.a)(ov.a,ra[Ui.a.GalleryButtonProps]))mb.push(ra),
ca&&(Qa=this.Wta.j4c(this.mA,ra.Command,h),ra.IsDisabled=!Qa)}0<mb.length&&r.push.apply(r,this.$tf(this.e_e(r,mb),b.externalUxCommand,b.externalUxCommand,!0,mb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,B));P&&(t.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",B),r.push(appChrome.actions.highlightSelectedFontStyle(B)))}return r}e_e(b,h,r=null){const B=[],P=[];for(let ra=0;ra<h.length;ra++){const Qa=h[ra],mb=lf.b(Qa.ExternalId)?
Qa.Id:Qa.ExternalId;B.push(mb);const Jb=r&&r[mb]?r[mb].result:-1;switch(Qa.Type){case 1:var ca=Qa;P.push(appChrome.api.createCharacterCodeGalleryButtonModel(mb,Object.assign(new nC,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Qa;P.push(appChrome.api.createFontStylesGalleryButtonModel(mb,Object.assign(new or,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Qa;P.push(appChrome.api.createInkThicknessGalleryButtonModel(mb,Object.assign(new BF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Qa;P.push(appChrome.api.createIconGalleryButtonModel(mb,Object.assign(new EE,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Qa;P.push(appChrome.api.createListGalleryButtonModel(mb,Object.assign(new CF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Qa;P.push(appChrome.api.createTableStyleGalleryButtonModel(mb,Object.assign(new SD,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Qa;P.push(appChrome.api.createChangeColorsGalleryButtonModel(mb,Object.assign(new AF,
{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Qa,P.push(appChrome.api.createPageNumberGalleryButtonModel(mb,Object.assign(new oC,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.rl.addCommandToMaps(Object.assign(new so.a(mb,Qa.Command),{queryCommandId:Qa.QueryCommand,menuItemId:Qa.MenuItemId}))}b.push(appChrome.actions.addControls(P));return B}$tf(b,h,r,B,P,ca=null,ra=!1,Qa=null){const mb=
[];B?mb.push(appChrome.actions.populateGalleryItems(h,b)):(this.hyc[h]=!1,ra||(B=!0,appChrome.selectors.isControlDefined(h)&&(B=appChrome.selectors.getGalleryState(h),B=B.disableIndividualButtons?B.disableIndividualButtons:!0),mb.push.apply(mb,this.zrf(h,WC[P],b,null,5===P,B,ca,Qa))),mb.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return mb}l_l(b){return this.zrf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}zrf(b,
h,r,B,P,ca=!0,ra=null,Qa=null){const mb=[];if(b in this.hyc){if(this.hyc[b])return delete this.hyc[b],mb;this.hyc[b]=!0}let Jb=null,Yb=-1;if(r)({U3h:Yb,returnValue:Jb}=this.fph(h,r,mb,ca,ra,Qa));else if(B)for(const fc of B)(r=({U3h:Yb}=this.fph(h,fc.galleryButtons,mb,ca,null,Qa)).returnValue)&&(Jb=r);mb.push(appChrome.actions.updateGallerySelectedId(b,Jb));ca&&mb.push(oB(b,!1));P&&0<Yb&&mb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Yb));return mb}lfi(b,h=null){const r={},B={};B.SourceControlId=
b;B.Location=h;b=this.rl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=B,r;b=this.eUd(b,B);r.result=b;r.props=B;return r}mfi(b,h=null,r=null){r||(r={});for(const B of b)b=lf.b(B.ExternalId)?B.Id:B.ExternalId,r[b]=this.lfi(b,h);return r}fph(b,h,r,B,P=null,ca=null){let ra,Qa=null;ra=-1;let mb=!1;for(const Yb of h){var Jb=this.i_l(b);h=ca&&ca[Yb]&&-1!==ca[Yb].result?ca[Yb]:this.lfi(Yb,P);const fc=h.result;h=h.props;B&&r.push(oB(Yb,1>(fc&1)));(Jb=lu(Yb,Jb,h,fc))&&r.push.apply(r,Jb);h[Ui.a.On]&&
(Qa=Yb,h[Ui.a.HighlightOn]&&h[Ui.a.HighlightOn]&&(mb=!0));void 0!==h[mk.a.labelText]&&null!==h[mk.a.labelText]&&(Jb=this.rl.getCommandByExternalUxId(Yb),r.push(appChrome.actions.setControlLabel(Jb.externalUxCommand,h[mk.a.labelText])));h[Ui.a.IsRtl]&&0>ra&&(ra=h[Ui.a.IsRtl])}mb&&(t.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Qa),r.push(appChrome.actions.highlightSelectedFontStyle(Qa)));return{returnValue:Qa,U3h:ra}}i_l(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}eUd(b,h){h.MenuItemId=b.menuItemId;return this.Wta.Qqa(this.mA,this.Q_b,
b.commandId,b.queryCommandId,h)}}Object(n.a)(oD,"ReactGalleryPoller",null,[]);var pD=c(701),FE=c(663),pB=c(1725),GE=c(772),Xw=c(1726);class XC{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(XC,"PopulateFontPickerDataProps",null,[]);var gw=c(287),qt=c(1889);class mu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(n.a)(mu,"CommonOptionalButtonProperties",null,[]);class $q extends mu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(n.a)($q,"OptionalButtonProperties",mu,[]);class TD extends mu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(TD,"OptionalCompoundButtonProperties",mu,[]);class HE extends mu{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(n.a)(HE,"OptionalErrorViewProperties",mu,[]);class qC extends mu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(qC,"OptionalFlyoutAnchorProperties",mu,[]);class YC extends mu{constructor(){super();this.isBanner=null}}Object(n.a)(YC,"OptionalLabelProperties",
mu,[]);class Wf extends mu{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(n.a)(Wf,"OptionalMultipActionButtonProperties",mu,[]);class UD extends $q{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(UD,"OptionalPersonaButtonProperties",$q,[]);class vA extends mu{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(vA,"OptionalToggleButtonProperties",mu,[]);var DF=c(1728),IE=c(1727),rC=c(478);class VD{constructor(){this.$Gh=this.actions=null;this.bLj=!1}}Object(n.a)(VD,"PopulateActions",null,[]);class qD{bii(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.jbm(b);case "InkButtonModel":return this.ibm(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}jbm(b){const h={};h[Df.a.On]=appChrome.selectors.getButtonToggleState(b);return h}ibm(b){const h={};h[Df.a.On]=rh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(n.a)(qD,"ReactStatePropsSelector",null,[]);class Vh{constructor(b,h,r,B,P){this.Wta=b;this.mA=h;this.Q_b=r;this.rl=B;this.LUe={};this.Zgk=new qD;this.Myb=P}wuj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.LUe}Kbm(b,h,r=null){const B=[],P={};if(!this.wuj(b)){const ca=b.populationProps.populateQueryCommandId,ra={};ra.MenuId=b.externalUxCommand;ra.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Wta.Qqa(this.mA,this.Q_b,ca,ca,ra,this.S1l(r))&1))if("FontPickerModel"===h)this.LUe[ca]=!0,B.push(Vh.W$l(b,ra)),P[b.externalUxCommand]="FontPickerModel";else if(ra.MenuItems)switch(this.LUe[ca]=!0,h){case "ComboBoxModel":B.push(Vh.U$l(b,ra));P[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":B.push.apply(B,this.kki(b.externalUxCommand,h,ra.MenuItems,P,r&&"location"in r?r.location:null))}}return Object.assign(new VD,{actions:B,$Gh:P,bLj:this.isShadowMenuOpen(r)})}Mci(b,h,r,B,P,ca,ra,Qa,mb=null){let Jb=null;const Yb=[];lf.c(b.Title)||(Jb=b.Title);for(let fc=0;fc<b.ControlList.length;fc++){const Mc=Object(Na.a)(Fp.a,b.ControlList[fc]);
if(!Mc||Mc.ExternalId)ca&&this.ESl(Mc,ca),h.push.apply(h,this.V$l(Mc,ra,Yb,P,r,B,mb))}return Qa?appChrome.api.menuSection(Yb,Jb,b.Lang):null}kki(b,h,r,B,P=null){const ca=[],ra=[],Qa=[],mb=[];for(var Jb=0;Jb<r.MenuSectionList.length;Jb++){var Yb=Object(Na.a)(Nf.a,r.MenuSectionList[Jb]);Yb&&(Yb=this.Mci(Yb,ca,b,h,mb,B,ra,r.UpdateDynamically,P),r.UpdateDynamically&&Qa.push(Yb))}Jb=null;r.MenuFooterSection&&(Jb=this.Mci(r.MenuFooterSection,ca,b,h,mb,B,ra,r.UpdateDynamically,P));r.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Qa,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,Jb,r.IsFlexLayout));0<ra.length&&ca.splice(0,0,appChrome.actions.addControls(ra));0<mb.length&&rh.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,mb));return ca}ESl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]=
"CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Na.a)(kz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}V$l(b,h,r,B,P,ca,ra=null){const Qa=[];switch(b.ControlType){case 14:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(B=Object(Na.a)(GE.a,b),null!=B.IsBanner&&B.IsBanner&&this.TEn(Object(Na.a)(GE.a,b),Qa,h,r));break;case 1:case 3:b=Object(Na.a)(ei.a,b);this.VEn(b,
Qa,h,r);b.MenuItemsStatefulData&&rh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Qa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(P,b.MenuItemsStatefulData));break;case 2:this.FFn(Object(Na.a)(rC.a,b),Qa,h,r);break;case 6:this.WEn(Object(Na.a)(ry.a,b),Qa,h,r);break;case 4:this.yFn(Object(Na.a)(kf,b),Qa,h,r);break;case 7:this.YEn(Object(Na.a)(kz.a,b),Qa,h,r);break;case 12:this.eFn(Object(Na.a)(pB.a,b),Qa,h,r);break;case 13:this.vFn(Object(Na.a)(Xw.a,b),Qa,h,r);break;case 9:b=
Object(Na.a)(Yi.a,b);this.gFn(b,Qa,h,r);"StatefulSplitButtonModel"===ca&&B.push(b.ExternalId);break;case 8:this.Myb.kFn(Object(Na.a)(Jg.a,b),Qa,h,r,ra)}return Qa}TEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new qt.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,
b.LabelText,b.Id,Object.assign(new YC,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}VEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.cDd()&&((r=this.tQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new qt.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(uc.a)(Yt,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new TD,{iconSet:(new qt.a(this.tQa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(B=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,
b.LabelText,Object.assign(new $q,{iconSet:(new qt.a(this.tQa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==B&&null!==B?B:!0})))),this.rl.addCommandToMaps(Object.assign(new so.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&rh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}WEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.cDd()&&((r=this.tQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qt.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new vA,{iconSet:(new qt.a(this.tQa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.rl.addCommandToMaps(Object.assign(new so.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}eFn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new qt.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new HE,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}vFn(b,h,r,B){B.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new Wf,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.rl.addCommandToMaps(new so.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&
this.rl.addCommandToMaps(new so.a(b.ActionId,b.ActionIdMapped)))}FFn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.cDd()&&((r=this.tQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qt.a(r)).iconSet)),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new vA,{iconSet:(new qt.a(this.tQa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new vA,{iconSet:(new qt.a(this.tQa(b))).iconSet,
iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.rl.addCommandToMaps(Object.assign(new so.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}yFn(b,h,r,B){B.push(b.ExternalId);B=this.w$l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,B,b.LabelText)):rh.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,
B,b.LabelText,Object.assign(new UD,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}gFn(b,h,r,B){B.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.cDd()&&((r=this.tQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new qt.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,
!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{B=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const P=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new qC,{iconSet:(new qt.a(this.tQa(b))).iconSet,keytip:b.KeyTip,hideIcon:B,toggled:P,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));
this.rl.addCommandToMaps(Object.assign(new so.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new pD.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.kki(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}YEn(b,h,r,B){b.McuLayout&&B.push(b.McuExternalId);B.push(b.ExternalId);B=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(B=this.Zgk.bii(b.ExternalId,"ColorPickerModel").columnCount):
(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.rl.addCommandToMaps(Object.assign(new so.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),B=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.rl.addCommandToMaps(Object.assign(new so.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const P=[];for(let ca=0;ca<b.Colors.length;ca++){const ra=
b.Colors[ca];ca<B?r.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt)):P.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,P));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,
b.SelectedColorId)))}tQa(b){return b.Image32by32Class?this.rl.T9h(b.Image32by32Class):b.Image16by16Class?this.rl.T9h(b.Image16by16Class):b.ExternalImageId}w$l(b){return b?Object.assign(new IE.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new DF.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}S1l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}cDd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static W$l(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,B)=>{Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled(gw.a.VKb,!1).then(ca=>{let ra=h.fonts;ca||P.isFreemiumUpsellEnabled()||(ra=Jj.a.Asg(ra,Qa=>Qa.fontType!==gw.a.w2f));ca=Object.assign(new XC,{commandId:b.externalUxCommand,fonts:ra,isSubscriber:ca,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
r(ca)}).catch(B)})}))}static U$l(b,h){const r=[];for(let B=0;B<h.MenuItems.MenuSectionList.length;B++){const P=h.MenuItems.MenuSectionList[B];P.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+B.toString(),P.Title));for(let ca=0;ca<P.ControlList.length;ca++){const ra=Object(Na.a)(FE.a,P.ControlList[ca]);ra&&r.push(appChrome.api.comboBoxItem(ra.MenuItemId,ra.LabelText,ra.Styles,ra.CommandValueId,ra.AriaLabel,ra.Data,ra.Disabled))}B<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+
B.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(n.a)(Vh,"ReactPopulateQueryCommandPoller",null,[]);class WD{constructor(b,h,r,B,P){this.rl=r;this.Wta=b;this.mA=h;this.Q_b=B;this.Myb=P}Jbm(b,h,r){const B=[];if(this.yKm(h))b=this.Jfm(b,h,r),void 0!==b&&null!==b&&B.push.apply(B,b);else if(b){var P=this.eUd(b,r);mk.a.visible in r&&B.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[mk.a.visible]));B.push(oB(b.externalUxCommand,1>(P&1)));
void 0!==r[mk.a.labelText]&&null!==r[mk.a.labelText]&&B.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[mk.a.labelText]));void 0!==h&&null!==h&&(P=lu(b.externalUxCommand,h,r,P),void 0!==P&&null!==P&&B.push.apply(B,P),"PeopleWell"===h&&this.Guk(b.externalUxCommand,r,B))}return B}uXl(b,h,r){const B=[];switch(h){case "FlyoutAnchorModel":var P=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.rl.getCommandByExternalUxId(ca.command))r=
this.Wta.j4c(this.mA,ca.commandId,r),B.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),B.push(oB(b,!1));return B;default:return null}h=!1;for(ca in P)if(P=this.rl.getCommandByExternalUxId(ca),lf.c(P))h=!0;else if(r.SourceControlId=P.externalUxCommand,this.Wta.j4c(this.mA,P.commandId,r))return B.push(oB(b,!1)),B;B.push(oB(b,!h));return B}Jfm(b,h,r){switch(h){case "PreviewGalleryModel":return this.Myb.qam(b,r);case "GalleryModel":return this.Myb.l_l(r)}return null}yKm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}eUd(b,h){h.MenuItemId=b.menuItemId;return this.Wta.Qqa(this.mA,this.Q_b,b.commandId,b.queryCommandId,h)}Guk(b,h,r){const B=h[Zm.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Zm.a.LabelText];B&&0<B.length&&(h=String.format.apply(null,[h].concat(B)));r.push(this.$jm(b,h))}$jm(b,h){return appChrome.actions.updatePeopleWell(this.lSl(b),h)}lSl(b){const h=[];var r={};b=this.rl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Wta.Qqa(this.mA,this.Q_b,
"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const B=r.ControlList[b],P={};P.name=B.Alt;P.id=B.MenuItemId;P.description=B.Description;P.color=B.ImageBackColor;P.joinTime=B.JoinTimeInMS;P.imageUrl=B.ImageUrl;P.activeStatus=B.ActiveStatus;P.isAnonymous=B.IsAnonymous;P.canJump=B.CanJump;P.upn=B.Upn;h.push(P)}return h}}Object(n.a)(WD,"ReactQueryCommandPoller",null,[]);var EF=c(1143);class Oj{constructor(b,h,r){this.rl=b;this.mA=h;b=new EF.a;
this.slk=new qD;this.Myb=new oD(b,this.mA,r,this.rl);this.Qch=new Vh(b,this.mA,r,this.rl,this.Myb);this.Fch=new WD(b,this.mA,this.rl,r,this.Myb)}KFa(){const b=[];if(!rh.c())return b;b.push.apply(b,this.Yjm());var h=this.uWl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.vWl();for(const B of r)b.push(appChrome.actions.updateControlEnabledDisabledState(B,!0)),delete h[B];b.push.apply(b,this.uVd(h))}return b}k4c(b,h){rh.c()&&
(b=this.uVd(b,h),appChrome.api.dispatch(b))}Q1f(b,h,r=null){if(!lf.c(b)&&b.populationProps&&!this.Qch.wuj(b)){b=this.Qch.Kbm(b,h,r);if(!b.bLj){let B;(B=b.actions).push.apply(B,this.uVd(b.$Gh,rh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}uVd(b,h=0){const r=[],B={};if(rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var P of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(P))B[ca]=
!0;for(let ra in b)P=ra,ca=b[ra],0===h&&B[P]&&(h=2),r.push.apply(r,this.Xjm(P,ca,h));return r}Xjm(b,h,r=0){const B=[],P=this.rl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.slk.bii(b,h));ca[Ru.a.p9a]=r;lf.c(P)?(ca.ExternalUxId=b,(b=this.Fch.uXl(b,h,ca))&&0<b.length&&B.push.apply(B,b)):(ca.MenuItemId=P.menuItemId,ca.SourceControlId=b);B.push.apply(B,this.Fch.Jbm(P,h,ca));return B}Yjm(){const b=[],h=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),r=appChrome.selectors.getContextualTabIds();let B=[];h&&(B=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<r.length;ca++){var P=this.rl.Dvf(r[ca]);if(P){P=this.mA.VGa(P);let ra=!0;h&&(ra=0<=Array.indexOf(B,r[ca]));h&&ra===P||b.push(appChrome.actions.activateDeactivateContextualTab(r[ca],P))}}return b}uWl(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.rl.Dvf(b);
r&&(this.mA.VGa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}vWl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.rl.D_l(r))for(const B of b)this.mA.VGa(B.commandId)||((b=B.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(B.externalUxGroupId)),h.push.apply(h,b));return h}}Object(n.a)(Oj,"ReactRibbonRootPoller",null,[1084]);class XD{constructor(b,h,r=null){this.mA=this.VBa=this.wdb=null;this.x_b=
h;b.dOa(this);this.IF=r}get aqa(){this.VBa||(this.VBa=new Date,this.VBa.setTime(0));return this.VBa}set aqa(b){this.VBa=b}get A$(){return 2}get IF(){return this.mA}set IF(b){this.mA=b}get ljc(){this.wdb||(this.wdb=new Oj(this.x_b,this.IF,this.A$));return this.wdb}vgb(){const b=document.activeElement;Kb.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,B,P,ca,ra,Qa=2){lf.c(this.IF)||(P=new ys.a,P.CommandLocation=Qa,P.InvocationMethod=B,P.CommandTabName=r,h[Ru.a.p9a]=Qa,this.IF.FPa(b,h,P,ca,ra),this.$4m(b,
h))}KFa(){return lf.c(this.IF)?[]:this.ljc.KFa()}Gm(){const b=this.KFa();0<b.length&&(this.aqa=new Date,appChrome.api.dispatch(b))}Sdd(){rh.c()&&this.ljc.k4c({PeopleWell:"PeopleWell"},18)}Jdd(){}$4m(b,h){try{const r=Ya.a.instance.Oa("Common.ISystemInitiatedFeedback");if(r&&h){const B=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let P=(B?"_"+B:"")+(h.SqmControlId?"_"+h.SqmControlId:"");P=P.length?P:"_"+b;r.kNf("Ribbon"+P)}}catch(r){t.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(r?r.toString():""))}}}Object(n.a)(XD,"ReactRibbonRoot",null,[712,1085]);var rD=c(1652);class YD{constructor(b){this.rYe=this.zDe=!1;this.jab=null;this.pOg=!1;this.kQ=null;this.qta=!1;this.ZPe=b;Ye.a.instance.ob(Xc.a.Zx,this.lQc(),Object(z.a)(this,this.Jnn,"onContextualUIMouseDown"));(b=Ya.a.instance.Sa("Common.IActionContextProvider"))&&b.execute(h=>{this.kQ=h});v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ta.Kb.NJ?Qk.a.get_instance().pk(16,
()=>{this.a5?this.initializeContextualUI(this.lQc()):Qk.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.lQc())})}):Qk.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.lQc())})}get M0(){return this.qta}get a5(){return v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ta.Kb.NJ?Qk.a.get_instance().isCompleted(16)&&Qk.a.get_instance().isCompleted(7):Qk.a.get_instance().isCompleted(7)}lTk(){if(this.pOg)return!0;try{return Promise.resolve(null),
this.pOg=!0}catch(b){return!1}}Tog(b){if(!this.a5||this.rYe)return this.fOf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.lTk())return this.fOf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(v.AFrameworkApplication.YLd||""!==v.AFrameworkApplication.pu)if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===v.AFrameworkApplication.pu||"ContentAssemblyView"===v.AFrameworkApplication.pu)return this.fOf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.rYe=!0;let h=eb.a.Jg;switch(b){case 1:h=eb.a.showContextMenu;break;case 0:h=eb.a.showFloatie;break;case 2:h=eb.a.dmc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.rYe=!1;ne.c(h)},0)});return!1}Fki(b){return Ik.UISurfaces.z2a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const B of b)Array.contains(h,B)||r.push(B);return r}return b})}showFloatie(b,h,r,B=null){this.Tog(0)||this.Fki(h).then(P=>
{if(0>=P.length)return null;this.Mfg(P).then(()=>{const ca={};ca.target=b;Ik.UISurfaces.z2a().then(ra=>{appChrome.api.dispatch(ra.showFloatie(ca,r,void 0,this.Osf(),B));this.qta=!0;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&v.AFrameworkApplication.va&&v.AFrameworkApplication.va.processAction(eb.a.GKi,2);return null})});return null})}showContextMenu(b,h,r=null,B=null){this.Tog(1)||this.qsj(b,h,r,B)}qsj(b,h,r=null,B=null){this.Mfg(null).then(()=>
{const P={};P.target=b;B&&(P.directionalHint=B);Ik.UISurfaces.z2a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(P,h,r,void 0,this.Osf()));return null})})}cmc(b,h,r,B=null){this.Tog(2)||this.Fki(h).then(P=>{0>=P.length?this.qsj(b,r,B):this.Mfg(P).then(()=>{const ca={};ca.target=b;const ra={};ra.target=b;Ik.UISurfaces.z2a().then(Qa=>{appChrome.api.dispatch(Qa.showContextualUI(ca,ra,r,void 0,B,this.Osf()));this.qta=!0;return null})});return null})}fOf(b){t.ULS.sendTraceTag(561394519,340,15,b)}pMc(){this.a5&&
Ik.UISurfaces.isLoaded()&&Ik.UISurfaces.z2a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.a5&&Ik.UISurfaces.isLoaded()&&Ik.UISurfaces.z2a().then(b=>{this.qta=!1;appChrome.api.dispatch(b.hideFloatie());return null})}e7b(){this.a5&&Ik.UISurfaces.isLoaded()&&Ik.UISurfaces.z2a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.qta=!1;return null})}initializeContextualUI(b){return Ik.UISurfaces.z2a().then(h=>{this.zDe||(h.initializeContextualUI(b),
this.zDe=!0);return null})}Mfg(b){if(!this.zDe)return this.initializeContextualUI(this.lQc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];Ik.UISurfaces.z2a().then(B=>{r.push.apply(r,this.ZPe.ljc.uVd(B.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}lQc(){if(this.jab)return this.jab;
this.jab=rD.a("div");this.jab.id="ReactContextualUIDiv";this.jab.style.position="absolute";this.jab.style.zIndex="1001";document.body.insertBefore(this.jab,document.body.firstChild);return this.jab}Jnn(b){b.Hb&&b.Hb.target&&"input"===b.Hb.target.tagName.toLowerCase()&&kb.FocusManager.instance().jD("ribbon");return!1}Osf(){return this.kQ?this.kQ.contentType:"Unknown"}}Object(n.a)(YD,"ReactContextualUILauncher",null,[1087]);class FF extends Ag.a{constructor(){super()}}Object(n.a)(FF,"FloatieBuildOptions",
Ag.a,[]);class GF extends du.a{constructor(){super()}}Object(n.a)(GF,"FloatieBuildContext",du.a,[]);var nG=c(655);class HF extends We.Builder{constructor(b,h,r){super(b,h,r,null);if(lf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}pqo(b){this.root=b}bOk(){const b=new GF,h=new Ri.a;h.U5c=1;h.handler=Object(z.a)(this,this.aun,"onReturnFloatieData");h.data=b;this.Rva.Dfe(h)}aun(b){this.cOk(b.n5c,b.dKc);this.floatie.J1h=this;this.floatie.Hm();
this.floatie.Nc.style.display="none";this.placeholder.appendChild(this.floatie.Nc);this.bva.continueWith(()=>{this.bva.result.xMb(this.floatie)},11);kh.a.instance.ob(Xc.a.pointerDown,this.floatie.Nc,Object(z.a)(this.floatie,this.floatie.fD,"onPointerDown"))}cOk(b,h){b=Ug.a.Pha(b,Ug.a.qPj);if(lf.c(b))throw Error.create("No floatie element was present in the data");b=new Ug.a(b);this.pqo(new St(b.attributes[Ug.a.id],b.attributes));b=Ug.a.Pha(b.node,Ug.a.bre);this.R5e(b,h)}R5e(b,h){b=Ug.a.xw(b);for(let r=
0;r<b.length;r++){if(this.MRa(b[r]))continue;const B=this.Y5e(b[r],h);this.floatie.Bf(B)}}Y5e(b,h){var r=new Ug.a(b);b=new nG.Group(this.floatie,r.attributes[Ug.a.id],r.attributes[Ug.a.rWa],r.attributes[Ug.a.cqc],r.attributes[Ug.a.mWa],!1,r.name===Ug.a.MSj,!1,r.attributes);r=Ug.a.xw(r.node);for(let B=0;B<r.length;B++)b.Bf(this.YEd(r[B],h));return b}YEd(b,h){b=new Ug.a(b);var r=b.attributes[Ug.a.id];b=Ug.a.xw(b.node);var B=2;2===b.length&&(B=3);r=new Sk.a(this.floatie,r,B,2,1);for(B=0;B<b.length;B++){const ca=
new Ug.a(b[B]);var P=Ug.a.Pha(ca.node,Ug.a.Dsb);P=Ug.a.xw(P);this.d6e(r.wUd(B+1),P,ca.attributes[Ug.a.id],h)}return r}d6e(b,h,r,B){for(r=0;r<h.length;r++){if(this.MRa(h[r]))continue;const P=new Ug.a(h[r]),ca=this.Jga(h[r],B);ca&&b.Bf(ca.bR(P.attributes[Ug.a.dqc]))}}}Object(n.a)(HF,"FloatieBuilder",We.Builder,[]);class ZC{constructor(b,h){this.Cv=null;this.T1k=b;this.Uxe=h;this.gpn=this.G7d.bind(this)}get floatie(){return this.Cv}xgb(b,h,r){h=new Sp.CuiHelper(Ad.a.d0a,Box4Intl.Box4Strings,null,null,
h);const B=new FF;B.iH=r||{};B.iH.floatieshadingColor=!1;const P=new HF(B,document.body,this.T1k.ugj);P.Rva=new nz.a(b,h);P.bOk();this.Uxe.execute(ca=>{P.floatie.IF=ca});P.floatie.KXn(this.gpn);P.floatie.YWn(()=>[]);this.Cv=P.floatie;return this.floatie}}Object(n.a)(ZC,"AFloatieInitializer",null,[]);class IF extends ZC{constructor(b,h,r,B){super(h,r);this.H1f=()=>{this.floatie.Gm()};this.Mh=b;this.KI=B}xgb(b,h,r){if(b=super.xgb(b,h,r))b.Iic=!0,b.Pae=!0,b.preventDismissOnScroll=!0;this.Mh.I_a(this.H1f);
return b}$Uc(b,h,r=null){this.KI.zxh(()=>this.xgb(b,h,r))}G7d(){this.floatie.Iic=!0}}Object(n.a)(IF,"PasteFloatieInitializer",ZC,[]);var JF=c(821);class Cx{Oza(b,h){this.OTk&&this.Pwo(b,h,Cx.SPf,Cx.lb)}Pwo(b,h,r,B){switch(r){case 1:case 6:case 2:case 3:case 4:Cx.Khf.show(B,b,h)}}SOi(){switch(Cx.SPf){case 5:case 1:return!0;default:return!1}}Khl(){return Cx.SPf}get OTk(){return 1!==ab.StaticActiveAppFrame.za().state}static get Khf(){return null!=Cx.Nyg?Cx.Nyg:Cx.Nyg=Ya.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static Z4l(b){if(!b)return 0;
if(2===ab.StaticActiveAppFrame.za().mode){const h=b.Pa.node,r=xd.GraphIterator.eb(h);r.Ip();return cg.e(r.currentNode)?2:v.AFrameworkApplication.vTb||!Kx.isEmbeddedFileNode(h)||Kx.isInvalid(h)?$i.a.WOm(b.Pa)||$i.a.yFf(b.Pa)?6:1:3}return 4}static get lb(){return lh.a.instance.ib.lb}static get SPf(){return Cx.Z4l(Cx.lb)}}Object(n.a)(Cx,"SelectionContextMenuProvider",null,[1377]);var sD=c(1869);class $C{constructor(b,h){this.Pae=this.Iic=!1;this.yTc=!0;this.aM=b;this.rl=h}get isVisible(){return this.aM.M0}get controls(){return null}dismissFloatie(){this.aM.dismissFloatie();
return!0}Yif(){}t8a(b,h,r,B,P=null){this.aM.showFloatie(Object.assign(new sD.a,{x:b.x,y:b.y}),this.gof(r),r,P)}nGb(){return new Sys.UI.Bounds(0,0,0,0)}q4(){return this.dismissFloatie()}gof(){return[]}}Object(n.a)($C,"ReactFloatie",null,[357,358]);class aD{constructor(b){this.Ijd=null;this.aM=b}dispose(){}q4(){this.aM.e7b();return!0}showContextMenu(b,h){this.Eqb(b,h.clientPoint,h.kg)}Eqb(b,h,r){this.r8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);t.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}r8a(b,h,r,B=null){this.Ijd?this.aM.cmc(Object.assign(new sD.a,{x:h.x,y:h.y}),this.Ijd.gof(r),r,b):this.aM.showContextMenu(Object.assign(new sD.a,{x:h.x,y:h.y}),r,b,B);this.Ijd=null}dmc(b,h,r,B){this.Ijd=Object(Na.a)($C,r);B.Oza(b,h);return!0}S5b(){}}Object(n.a)(aD,"ReactContextMenuController",null,[540,10]);var JE=c(466);class bD{constructor(){this.Uja=this.text=this.upa=null}}Object(n.a)(bD,"BusinessBarButtonData",null,[]);class KE{constructor(){this.text=this.upa=null}}Object(n.a)(KE,"BusinessBarLinkData",
null,[]);var KF=c(248);class LE{constructor(b,h,r,B){this.EVg=this.WSg=this.Oab=this.WQg=null;this.wt=b;this.XAa=h;this.ga=r;this.Ca=B}c1f(){this.DIc();this.EIc();this.P4b()}EIc(){}DIc(){const b=ab.StaticActiveAppFrame.za().jb.Zc;b&&(this.WQg=this.E9a(this.WQg,1,2===ab.StaticActiveAppFrame.za().mode&&b.yEf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}oYm(){return v.AFrameworkApplication.ta&&1===v.AFrameworkApplication.ta.mode}P4b(){let b=null;const h=ab.StaticActiveAppFrame.za().jb.activeSection;
if(h){const r=h.k3c;KF.a.uZd(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=ba.a.vi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=ba.a.vi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):KF.a.woi(h.v_a)||qe.App.Cm||this.oYm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.EVg=
this.E9a(this.EVg,5,!!b,b)}Ksj(b,h,r,B){b=this.XAa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.dCd(h,()=>{Qd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});B&&(b.Nga=B);this.wt.sA(b,!0)}Dxo(b,h,r){this.Ksj(b,h,r,null)}Pxo(b){b=this.XAa.create(null,b,null);b.closeable=!0;b.id=20;this.wt.sA(b)}$wo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Oab||(this.Oab=this.XAa.create(b,h,null),this.Oab.closeable=
!0,this.Oab.id=27,this.wt.sA(this.Oab))}Rum(){this.Oab&&(this.Oab=this.E9a(this.Oab,27,!1,""))}xhg(b){this.WSg=this.E9a(this.WSg,30,!0,b)}E9a(b,h,r,B,P=!1,ca="",ra=null,Qa=null,mb=null){r?b?b.message=B:(b=this.XAa.create(ca,B,null),b.id=h,b.closeable=P,ra&&b.addButton(ra.text,ra.upa,ra.Uja),Qa&&b.dCd(Qa.text,Qa.upa),mb&&(b.Nga=mb),this.wt.sA(b,!1)):b&&(this.wt.removeEntry(b),b=null);return b}OZe(b){this.wt.sA(b,void 0)}}Object(n.a)(LE,"BusinessBarController",null,[239]);class qB extends LE{constructor(b,
h,r,B){super(b,h,r,B);this.vta=null}jsf(b,h,r=null,B=null,P=null,ca=2){if(this.vta)return null;this.vta=this.XAa.create(h,r||"",null);this.vta.id=6;this.vta.image=ca;this.vta.n0d=!1;b&&(this.vta.errorCode=b);this.vta.closeable=!1;h=v.AFrameworkApplication.LF&&this.Ca.$("ShowFeedbackButtonOnKickoutBusinessBar");B?(this.vta.addButton(B,P,""),h&&this.vta.hqh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.pli(b)})):h&&this.vta.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.pli(b)},"");this.wt.sA(this.vta,
void 0,null,null,null);return this.vta}pli(b){t.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(eb.a.giveFeedback,2,{["ErrorCode"]:b})}static get Hi(){return Qh.PageReader.instance}}Object(n.a)(qB,"BusinessBarController",LE,[238,239]);class rB{static get jTi(){const b=E.a.Gj(Hi.a.ug(v.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(n.a)(rB,"OdtUtils",null,[]);
class LF extends qB{constructor(b,h,r,B){super(b,h,r,B);this.Ctb=this.hwc=this.Q6g=this.XNa=this.W6g=this.shh=null;this.uak="https://go.microsoft.com/fwlink/?linkid=2134357"}c1f(){super.c1f();this.gXk()}EIc(){const b=ab.StaticActiveAppFrame.za().jb.Zc;if(b){var h=qe.App.S0;if(qe.App.Fs||qe.App.Cm||h&&v.AFrameworkApplication.qv)this.shh=this.E9a(this.shh,4,qB.Hi.a5a(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.W6g=this.E9a(this.W6g,3,qB.Hi.R4a(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,
!0),this.Q6g=this.E9a(this.Q6g,8,qB.Hi.N5k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),qB.Hi.qKb(b)?this.XNa||(this.XNa=this.XAa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.XNa.id=14,this.XNa.closeable=!0,this.XNa.image=3,this.XNa.addButton(Box4Intl.Box4Strings.L_LearnMore,xk.AppFrame.g1m,""),this.wt.sA(this.XNa,!1)):this.XNa&&(this.wt.removeEntry(this.XNa),this.XNa=null)}}gXk(){if(Jk.App.FXc){const b=
rB.jTi,h=this.XAa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);h.id=9;h.closeable=!0;h.Ptk(b);this.wt.sA(h,!0)}}Exo(b,h){if(ab.StaticActiveAppFrame.za().jb.Zc){const r=new bD;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.upa=()=>{b()};const B=new KE;B.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;B.upa=()=>{Qd.a.openWindow(4,v.AFrameworkApplication.privacyUrl)};this.hwc=
this.E9a(this.hwc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,B,()=>{h()})}}$um(){this.hwc&&(this.hwc=this.E9a(this.hwc,25,!1,""))}Hwo(){if(ab.StaticActiveAppFrame.za().jb.Zc){const b=new KE;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.upa=()=>{Qd.a.openWindow(4,this.uak)};this.Ctb||(this.Ctb=this.XAa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,
null),this.Ctb.id=32,this.Ctb.closeable=!0,this.Ctb.image=3,this.Ctb.dCd(b.text,b.upa),this.wt.sA(this.Ctb,!1))}}EY(b){return this.wt.EY(b)}sA(b,h){this.wt.sA(b,h)}}Object(n.a)(LF,"BusinessBarController",qB,[599,238,239]);class ME{constructor(){this.menuTargetType=null}}Object(n.a)(ME,"MenuTargetDescriptor",null,[]);var Dx=c(579);class Ej extends Dx.a{constructor(b,h,r,B=!1,P,ca=null,ra){super();this.pae=(Qa,mb,Jb,Yb,fc)=>{if(1===Jb)return 32;Qa=fc.Ux;fc=fc.vd;mb=Object.assign(new dh.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]});this.Ncl(mb,Qa,fc.IsShadowMenuOpen);fc.MenuItems=mb;return 32};this.aLn=h;this.Dn=r;this.Zdb=ca;this.cHe=B;this.Ub(b);this.G$a=ra;Ej.KZa[1]=Mb.a.kke;Ej.KZa[2]=Mb.a.OVd;Ej.KZa[3]=Mb.a.Nke}get nul(){return gd.a.BKd}get mul(){return gd.a.YId}get oul(){return gd.a.Q$d}get Ihf(){return gd.a.w1i}Ub(b){b.fb(Mb.a.T1f,zc.a.application,this.pae,96);b.fb(Mb.a.e3i,zc.a.application,this.pae,96)}show(b,h,r){let B=null,P=new Sys.UI.Bounds(0,0,0,0);const ca=this.Vam(b);if(ca&&
(b=b.Pa.node)&&(b=b.qe(Hb.InteractiveViewManager.instance.yd.$b))){P=$x.a.Vq(b,ca.end);if(v.AFrameworkApplication.isRtl&&P.x>h.x||!v.AFrameworkApplication.isRtl&&P.x+P.width<h.x||P.y+P.height<h.y)P=$x.a.Vq(b,ca.end-1);h.x=P.x+(v.AFrameworkApplication.isRtl?0:P.width);h.y=P.y+P.height;B=6}Dx.a.r8a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,P.width,P.height),r,B)}v0(b,h){return this.vad(b)||Ej.BIc(Mb.a.mergeCells)||Ej.BIc(Mb.a.nJa)||this.jig(b)||this.lsj(b,h)||Ej.atj()||Ej.Psj(b).returnValue}vad(b){return 2===
ab.StaticActiveAppFrame.za().mode&&this.wXc(b)}cLc(b,h,r=null){if(qs.QB()&&2===ab.StaticActiveAppFrame.za().mode){h=this.G$a.iKh(b.Pa);if(!h||!this.qUm()&&!this.NVm(h.errorDetails))return;h=h.errorDetails}else{if(!this.vad(b))return;h=this.Lfi(b)}var B=Hi.a.ug(h.lcid);const P=B?B.name:"UNKNOWN";B=Object(uc.a)(Hn.a,h)?h.typeId:"";t.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,B,P);if(b=this.aLn.f6b(b,h))r.push.apply(r,
b),this.z8m(h,B)}NVm(b){return b&&(1===b.proofingType||2===b.proofingType)}qUm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}z8m(b,h){const r=Ej.KZa[b.proofingType];r&&(v.AFrameworkApplication.va.processAction(r,2),t.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,qs.QB()))}Lfi(b){return this.Dn.Hoa(b.Pa).errorDetails}wXc(b){return this.Dn.jge(b)}R9b(){return null}wJd(){}Vam(b){return this.wXc(b)?
this.Dn.Hoa(b.Pa):(b=this.R9b(b))?new Ub.a(b.Pp,b.cpEnd):null}jig(b){if(2!==ab.StaticActiveAppFrame.za().mode||!b)return!1;b=fz.a.rEa(b.toArray());return!!Ej.ah.YT(b,14)}Ftj(b,h){return 2===h||3===h&&!this.wXc(b)}lsj(b,h){return 3!==h||this.wXc(b)}r$k(){const b=[];b.push(Object.assign(new ei.a,{ExternalId:this.nul}));b.push(Object.assign(new ei.a,{ExternalId:this.mul}));b.push(Object.assign(new ei.a,{ExternalId:this.oul}));return b}Sdl(){const b=[];this.cHe&&b.push(Object.assign(new ei.a,{ExternalId:this.Ihf}));
return b}static get Jd(){return null!=Ej.IEg?Ej.IEg:Ej.IEg=Ya.a.instance.resolve("Box4.List.IListReader")}static get ah(){return Im.ContextSetEditor.instance}static get VOm(){null==Ej.xGe&&(Ej.xGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Ej.xGe}static get i1c(){null==Ej.Osb&&(Ej.Osb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Ej.Osb}static get Iua(){null==Ej.gaa&&(Ej.gaa=v.AFrameworkApplication.K?
v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ej.gaa}static BIc(b){return 32===v.AFrameworkApplication.va.processAction(b,1)}static atj(){return 2===ab.StaticActiveAppFrame.za().mode&&!!qe.App.Iv.gJ&&qe.App.Iv.gJ.mYc(Mb.a.B9d.toString())}static ctj(b){if(1!==b.length||!b.Pa.al)return!1;b=xd.GraphIterator.eb(b.Pa.node);b.zb(11);b.sc();return b.Jt(4)&&!Ej.Jd.ww(b).listType?!0:!1}static Psj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,hkb:h,gUc:r};if(Ej.i1c)return Ej.Oxo(b,
r);if(!(b.Zw||Ej.VOm&&2===b.length&&b.Rc.contextId===zc.a.Vc))return{returnValue:!1,hkb:h,gUc:r};b=b.Pa.clone();h=32===v.AFrameworkApplication.va.Mf(b,Mb.a.v6a,1,!0,null,null);r=32===v.AFrameworkApplication.va.Mf(b,Mb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||r,hkb:h,gUc:r}}static Oxo(b,h){let r;h=b.Pa.clone();r=Ej.Iua&&xo.l(h);let B=!r&&32===v.AFrameworkApplication.va.Mf(h,Mb.a.v6a,1,!0,null,null);if(b.Zw||2===b.length&&b.Rc.contextId===zc.a.Vc)h=!r&&32===v.AFrameworkApplication.va.Mf(h,
Mb.a.insertHyperlink,1,!0,null,null);else{h=!0;const P=b.length;for(let ca=0;ca<P;ca++){const ra=b.J(ca).clone();if(ra.contextId===zc.a.paragraph||ra.contextId===zc.a.Fd)(r=Ej.Iua&&xo.l(ra))||(h=32===v.AFrameworkApplication.va.Mf(ra,Mb.a.insertHyperlink,1,!0,null,null)&&h);else if(ra.contextId!==zc.a.Vc)return h=B=!1,{returnValue:!1,hkb:B,gUc:h}}}return{returnValue:B||h,hkb:B,gUc:h}}static mTd(b){const h=Object.assign(new Nf.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new ei.a,
{ExternalId:r}));return h}static nF(b){const h=[];for(const r of b)h.push(Object.assign(new ei.a,{ExternalId:r}));return h}}Ej.xGe=null;Ej.Osb=null;Ej.gaa=null;Ej.KZa=[];Object(n.a)(Ej,"AEditSurfaceContextMenu",Dx.a,[]);var ts=c(604),Ns=c(874),nM=c(1798);class oG{static dam(b,h,r){h=[];r.FHn.f6b(r.UNl(b),h);return h}static nWl(b,h,r){const B=[];if(r.vad(b))return B;oo.a.PGa()&&!ba.a.ht||r.Cff.wJd(b,null,h,B);return B}static rfm(b,h,r){const B=[];r.cLc(b,h,B);return B}}Object(n.a)(oG,"ContextMenuSectionHelper",
null,[]);class Kq{static aWl(b,h,r){h=[];r.vnl(b)&&h.push(Object.assign(new ei.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.tcm(b)}));return h}static h5l(){return Ej.BIc(Mb.a.mergeCells)?Ej.nF(["MergeCells"]):Ej.BIc(Mb.a.pke)?Ej.nF(["SplitCells"]):[]}static cjm(b,h,r){h=[];if(!r.Fh.ZIh(b))return h;b=r.Fh.Sji(b);h.push(Object.assign(new ei.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,
b)}));h.push(Object.assign(new ei.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static aRl(b,h,r){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Pa&&b.Pa.node&&r.Ic&&r.Ic.gSi(b.Pa.node)?Ej.nF(["ShowCatchUpActivitiesForParagraph"]):[]}static VWl(b){return Ap.dxo(b)?Ej.nF(["Draw"]):Ap.Tsj(b)?Ej.nF(["EditIllustration"]):[]}static Xlm(b){return Ap.Czo(b)?
[Object.assign(new Yi.a,{ExternalId:"WrapTextMenu"})]:[]}static nUd(b,h,r){return r.Mnl(b)?Ej.nF(["CreatePullQuote"]):[]}static getContentControls(b,h,r){return r.unl()?Ej.nF(["RemoveContentControl"]):[]}static KSl(){return Ej.nF(["NewComment"])}static uRl(b){const h=[];!Ap.iig(b)&&Ap.Khg(b)&&gc.SessionStatusManager.instance.bD&&b.dI&&h.push(Object.assign(new Yi.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static Y1l(b,h,r){h=[];!Ap.iig(b)&&Ap.Khg(b)&&
gc.SessionStatusManager.instance.bD&&(t.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.dI&&!v.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...Ej.nF(["ChangePicture"])):h.push(...r.Ubl().ControlList),(b=Ap.lbi())&&0<b.length&&(r=r.Hfl(b),null!=r&&h.push(...r.ControlList)));return h}static Sam(){return Ej.atj()?Ej.nF(["SetProofingLanguage"]):[]}static Dcm(b,h,r){return r.pUm&&r.Lyo(b)?Ej.nF(["Rewrite"]):[]}static H3l(b){return Ej.ctj(b)?Ej.nF(["StartNewList",
"ContinueNumbering","SetNumberingValue"]):[]}static H9l(){return Ap.rtj()?Ej.nF(["ParagraphOptions"]):[]}static R0l(b){return Ap.Tsj(b)?Ej.nF(["EditIllustration"]):[]}static ifm(b){return Ap.iig(b)?Ej.nF(["ShowSmartLookupPane"]):[]}static mjm(b){return Ap.gtj(b)?Ej.nF(["ModernTranslatorSplitButton"]):[]}static $_l(b,h,r){h=[];if(b.Zw){const B=b.Pa;if(B.contextId===zc.a.paragraph||B.contextId===zc.a.Tc||B.contextId===zc.a.Fd){b=b.Pa.node;if(!r.Vi.Xb(b)||b.Fr||""===b.characterData)return h;r.Xgf.uSd(b)&&
h.push(...Ej.nF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Zw){const B=b.Pa;(Pd.SelectionEditor.Ze(B)||Pd.SelectionEditor.l4a(B))&&r.ZLk.SRd(b.Pa.node,b.Pa.cpBegin)&&(h.push(...Ej.nF(["DeleteBookmarkContextMenu"])),h.push(...Ej.nF(["EditBookmarkNameContextMenu"])))}return h}static Sha(b){let h=!1,r=!1;const B=[];({hkb:h,gUc:r}=Ej.Psj(b)).returnValue&&(h?r?B.push(...Ej.nF(["EditHyperlink",
"SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):B.push(...Ej.nF(["OpenHyperlink"])):r&&(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost")?B.push(...Ej.nF(["InsertLinkFlyout"])):B.push(...Ej.nF(["InsertLink"]))));return B}static fSl(b,h,r){const B=[];if(!r.lsj(b,h))return B;2===ab.StaticActiveAppFrame.za().mode?(B.push(...r.r$k()),B.push(...r.Sdl()),3===h&&r.wXc(b)&&B.push(Object.assign(new ei.a,{ExternalId:"Delete"}))):(!v.AFrameworkApplication.eZ&&
!v.AFrameworkApplication.DF||v.AFrameworkApplication.CEb)&&B.push(Object.assign(new ei.a,{ExternalId:"Copy"}));return B}static tof(b,h,r){return r.jig(b)&&r.Ftj(b,h)?Ej.nF(["EditTableAltText"]):[]}static pbi(b,h,r){return r.Fnl(b)?Ej.nF(["ShowIntentSuggestion"]):[]}static hhm(b,h,r){const B=[];r.jig(b)&&!r.Ftj(b,h)&&(B.push(Object.assign(new Yi.a,{ExternalId:"InsertTableMenu"})),B.push(Object.assign(new Yi.a,{ExternalId:"DeleteTableMenu"})),B.push(Object.assign(new Yi.a,{ExternalId:"SelectTableMenu"})));
return B}static nhm(b,h,r){return r.dzo(b)?Ej.nF(["UpdateTableOfContents"]):[]}static GXl(b){return Ap.jxo(b)?Ej.nF(["ShowHideEquationToolsPane"]):[]}static gUl(b,h,r){return r.Rwo?Ej.nF(["OpenCopilotCompose"]):[]}}Object(n.a)(Kq,"ContextMenuSectionItemHelper",null,[]);class Ap extends Ej{get Vi(){return this.gb}get Xgf(){return this.qXa}constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id,ve,$d,be=!1,he=null,re=null,Xf,Mg,$l,Nm){super(b,h,r,be,void 0,he,Xf);this.tLd=Nm;this.gPe=this.kQ=null;this.NYg=
!1;this.Xfe=new Map;this.kD={};this.Ymb={};this.ga=b;this.K=B;this.Fh=P;this.QW=Qa;this.OI=mb;this.fn=Jb;this.Gok=!!he;this.Cff=Yb;this.FHn=fc;this.FSg=Id;this.sla=ve;this.ZLk=$d;this.qXa=$l;this.gb=Mg;id&&id.execute(zp=>{this.ofh=zp});Mc&&Mc.execute(zp=>{this.gPe=zp});this.Ic=ra;this.dv=Wc;re&&re.execute(zp=>{this.kQ=zp});this.bAm();this.CFn();this.ACl();this.BFn()}get Ihf(){return this.Gok?gd.a.N$d:super.Ihf}hvo(){const b=Jk.App.pn.jb.rc.mb.ib.lb;return this.vad(b)&&2!==this.Lfi(b).errorType}v0(b,
h){return super.v0(b,h)||Ap.rtj()||Ej.ctj(b)||Ap.Khg(b)||Ap.gtj(b)}Ncl(b,h,r){const B=[];let P=null;try{P=Jk.App.pn.jb.rc.mb.ib.lb}catch(ca){t.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.qFn(P,h,B,this.VTl(P));b.MenuSectionList.push(...B);this.Qlo(b);!r&&this.ofh&&this.ofh.wJn(b.MenuTargetDescriptor.menuTargetType,B)}VTl(b){return Ej.BIc(Mb.a.mergeCells)?Yw.Lvg:b.NWc?Yw.iug:b.dI?Yw.Zug:b.Ydc()?Yw.dug:Ap.XEf&&b.t4a?Yw.Ytg:Yw.nug}Vbl(b){b=
Ap.icl(b);return Object.assign(new ei.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}Ifl(b){return(b=Ap.rOj(b))?Object.assign(new ei.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}Ubl(){const b=Object.assign(new Nf.a,{ControlList:[]}),h=Ap.lbi();b.ControlList.push(this.Vbl(h));return b}Hfl(b){const h=Object.assign(new Nf.a,{ControlList:[]});if(b&&0<b.length){b=this.Ifl(b);if(null==b)return null;h.ControlList.push(b)}return h}uec(b){return b.dI||2<b.length||!b.length||2===b.length&&!Pd.SelectionEditor.Kk(b.Rc)||
1===b.length&&Pd.SelectionEditor.Kk(b.Rc)?!1:this.oJf(b.Pa)}oJf(b){return Td.ParagraphReader.Xb(b.node)?""!==Td.ParagraphReader.text(b.node).trim():!1}dzo(b){var h=xd.GraphIterator.eb(b.Pa.node);h=Object(Na.a)(ts.a,h.currentNode);return b.dI?!1:!!h&&h.Fr}ACl(){v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.dv.execute(b=>{b.isFeatureEnabled(Ns.a.rRi,
!1).then(h=>{h||t.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.NYg=h;return null})}):t.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get pUm(){v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.NYg:!1}Lyo(b){if(!this.uec(b)||
b.t4a||b.Ydc())return!1;b=b.Pa;if(Td.ParagraphReader.um(b)||Pd.SelectionEditor.Ze(b)||Pd.SelectionEditor.vl(b)){b=this.OI.FFa(b);b||(b=v.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Fnl(b){if(1!==b.length||ba.a.ht)return!1;const h=oo.a.PGa();if(h&&this.hvo()||qs.QB()&&!this.G$a.iKh(b.Pa))return!1;const r=Ap.Zb.isFeatureEnabled(64);return b.J(0).contextId===zc.a.Tc&&
(h||r)&&0<this.fn.jRc(b.J(0),0).count||h&&this.R9b(b)?!0:!1}vnl(b){return 1===b.length&&this.FSg.GA(b.Pa.node).xia}tcm(b){var h,r;const B=null===(h=this.tLd)||void 0===h?void 0:h.DU(null===(r=null===b||void 0===b?void 0:b.Pa)||void 0===r?void 0:r.node);return nM.a.Mji(B)}get Mv(){return null!=this.zyg?this.zyg:this.zyg=Ya.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}get m8k(){return null!=this.hyg?this.hyg:this.hyg=Ya.a.instance.Oa("WordEditor.Copilot.Compose.CopilotComposeIndicatorActor")}Mnl(b){if(!this.sla.uxi()||
!this.Mv||this.Mv.isVisible||!(1===b.length||2===b.length&&Pd.SelectionEditor.Kk(b.Rc))||b.emb||!Pd.SelectionEditor.vl(b.Pa)&&b.Pa.contextId!==zc.a.paragraph||b.TCi()||this.FSg.GA(b.Pa.node).xia)return!1;const h=Td.ParagraphReader.text(b.Pa.node),r=b.Pa.contextId===zc.a.paragraph?0:b.Pa.cpBegin,B=b.Pa.contextId===zc.a.paragraph?h.length:b.Pa.cpEnd-r;return 1>B||1500<B||E.a.af(E.a.lza(h.substr(r,B)))||1!=Ur.a.cjb(b.Pa.node)?!1:!0}unl(){return 32==this.ga.processAction(Mb.a.S6c,1)}R9b(b){return this.Cff.R9b(b)}wJd(b,
h,r,B=null){this.vad(b)||this.Cff.wJd(b,h,r,B)}UNl(b){return this.gPe?this.gPe.VNl(b):[]}Qlo(b){const h=this.kQ?this.kQ.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new ME,{menuTargetType:h})}static get Zb(){return null!=Ap.Tzg?Ap.Tzg:Ap.Tzg=Ya.a.instance.resolve("Box4.IFeatureHelper")}static get XEf(){if(null!=Ap.KDg)var b=Ap.KDg;else{var h;b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);
b=Ap.KDg=b}return b}static Khg(b){return v.AFrameworkApplication.E0&&!b.t4a&&Ya.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").TXm()}static oUd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=E.a.Lz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static icl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=Ap.oUd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static rOj(b){b=
Ap.oUd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static lbi(){const b=(new rr.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static Tsj(b){const h=Ap.Zb.isFeatureEnabled(51);return!b.WJc&&h&&!ba.a.ht&&(b.t4a||h&&!Ap.XEf&&b.dI)}static dxo(b){const h=Ap.Zb.isFeatureEnabled(51);return!b.WJc&&h&&!ba.a.ht&&Ap.XEf&&b.dI}static iig(b){return v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&
!b.Ydc()}static gtj(b){return v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.t4a&&!b.Ydc()}static jxo(b){return b.UCi()&&v.AFrameworkApplication.ta.Kb.eYc}static rtj(){return 2===Jk.App.pn.mode}static Czo(b){return b.dI}get Rwo(){var b,h;return null!==(h=null===(b=this.m8k)||void 0===b?void 0:b.vPm)&&void 0!==h?h:!1}qFn(b,h,r,B){this.Ymb[B].forEach(P=>{const ca=Object.assign(new Nf.a,{ControlList:[]}),ra=ca.ControlList;P.forEach(Qa=>{Qa instanceof nu?r.push(...this.Xfe.get(Qa)(b,
h,this)):ra.push(...this.kD[Qa](b,h,this))});(null===ra||void 0===ra?0:ra.length)&&r.push(ca)})}BFn(){this.Xfe.set(nu.$Tb,oG.dam);this.Xfe.set(nu.Wqe,oG.nWl);this.Xfe.set(nu.Lre,oG.rfm)}CFn(){this.kD[Kh.Esb]=Kq.fSl;this.kD[Kh.Qre]=Kq.hhm;this.kD[Kh.Rre]=Kq.nhm;this.kD[Kh.Vqe]=Kq.aWl;this.kD[Kh.pre]=Kq.h5l;this.kD[Kh.Hqe]=Kq.tof;this.kD[Kh.hre]=Kq.Y1l;this.kD[Kh.Vfd]=Kq.pbi;this.kD[Kh.gre]=Kq.R0l;this.kD[Kh.Kre]=Kq.ifm;this.kD[Kh.Tre]=Kq.mjm;this.kD[Kh.wre]=Kq.Sam;this.kD[Kh.zre]=Kq.Dcm;this.kD[Kh.Xfd]=
Kq.H3l;this.kD[Kh.$fd]=Kq.H9l;this.kD[Kh.xre]=Kq.nUd;this.kD[Kh.Hfd]=Kq.getContentControls;this.kD[Kh.mse]=Kq.Xlm;this.kD[Kh.Xqe]=Kq.VWl;this.kD[Kh.Oqe]=Kq.uRl;this.kD[Kh.Sre]=Kq.cjm;this.kD[Kh.Nqe]=Kq.aRl;this.kD[Kh.Ffd]=Kq.getBookmark;this.kD[Kh.cre]=Kq.$_l;this.kD[Kh.ere]=Kq.Sha;this.kD[Kh.Csb]=Kq.KSl;this.kD[Kh.Vfd]=Kq.pbi;this.kD[Kh.Yqe]=Kq.GXl;this.kD[Kh.Ltg]=Kq.gUl}bAm(){const b=[Kh.pre,Kh.Hqe,Kh.Qre];this.Ymb[Yw.Lvg]=[[Kh.Esb],b,[Kh.Csb],[nu.$Tb],[Kh.Hfd]];this.Ymb[Yw.Zug]=[[Kh.Esb],[Kh.Oqe,
Kh.Xqe,Kh.mse],b,[Kh.Csb],[nu.$Tb]];this.Ymb[Yw.dug]=[[Kh.Yqe],[Kh.Xfd,Kh.$fd],[Kh.Ffd,Kh.Csb],[nu.$Tb]];this.Ymb[Yw.nug]=[[Kh.Vfd],[Kh.Vqe],[nu.Lre],[nu.Wqe],[Kh.Esb],[Kh.hre,Kh.gre,Kh.Kre,Kh.Tre],[Kh.wre,Kh.zre,Kh.$fd],[Kh.Ltg],[Kh.Xfd],b,[Kh.Hfd],[Kh.ere,Kh.Ffd,Kh.cre,Kh.Csb],[Kh.xre],[Kh.Sre],[Kh.Nqe],[Kh.Rre],[nu.$Tb]];this.Ymb[Yw.iug]=[[Kh.Esb],[Kh.Csb]];this.Ymb[Yw.Ytg]=[[Kh.Esb],[Kh.gre]];this.Ymb[Yw.lQj]=[[Kh.Vfd],[Kh.Vqe],[nu.Lre],[nu.Wqe],[Kh.Esb],[Kh.Oqe],[Kh.Xqe],[Kh.mse],[Kh.hre],[Kh.Kre],
[Kh.Tre],[Kh.wre],[Kh.zre],[Kh.Yqe],[Kh.Xfd],[Kh.$fd],[Kh.ere],[Kh.pre],[Kh.Hqe],[Kh.Qre],[Kh.Ffd],[Kh.cre],[Kh.Csb],[Kh.xre],[Kh.Hfd],[Kh.Sre],[Kh.Nqe],[Kh.Rre],[nu.$Tb]]}}Object(n.a)(Ap,"EditSurfaceContextMenu",Ej,[]);var Yw;(function(b){b[b.Lvg=1]="TABLE_MULTI_CELL";b[b.nug=2]="GENERIC";b[b.Zug=3]="PICTURE";b[b.dug=4]="EQUATION";b[b.lQj=5]="LEGACY";b[b.iug=6]="FLUID";b[b.Ytg=7]="DRAWING"})(Yw||(Yw={}));Object(n.b)("Scenarios",Yw);class nu{}nu.$Tb=new nu;nu.Wqe=new nu;nu.Lre=new nu;Object(n.a)(nu,
"Sections",null,[]);var Kh;(function(b){b[b.Vfd=1]="INTENT_SUGGESTION";b[b.Esb=2]="ESSENTIALS";b[b.hre=3]="INSIGHT";b[b.gre=4]="ILLUSTRATION";b[b.Kre=5]="SMART_LOOKUP";b[b.Tre=6]="TRANSLATE";b[b.wre=7]="PROOFING";b[b.zre=8]="REWRITE_SUGGESTIONS";b[b.Xfd=9]="LISTS";b[b.$fd=10]="PARAGRAPH_OPTIONS";b[b.pre=11]="MERGE_SPLIT_CELLS";b[b.Hqe=12]="ALT_TEXT";b[b.ere=13]="HYPERLINK";b[b.Ffd=14]="BOOKMARK";b[b.cre=15]="HEADING_LINK";b[b.Csb=16]="COMMENT";b[b.xre=17]="PULL_QUOTE";b[b.mse=18]="WRAP_TEXT";b[b.Xqe=
19]="DRAW";b[b.Sre=20]="TRACK_CHANGE";b[b.Nqe=21]="CATCHUP_ACTIVITIES";b[b.Rre=22]="TABLE_OF_CONTENTS";b[b.Vqe=23]="DESIGNER_REVIEW";b[b.Qre=24]="TABLE_ITEMS";b[b.Oqe=25]="CHANGE_PICTURE";b[b.Yqe=26]="EQUATION_TOOLS";b[b.Hfd=27]="CONTENT_CONTROL";b[b.Ltg=28]="COPILOT_COMPOSE"})(Kh||(Kh={}));Object(n.b)("SectionItem",Kh);class dD extends Dx.a{constructor(b,h,r){super();this.El=null;this.yae=(B,P,ca,ra,Qa)=>{if(1===ca)return 32;B=[];P=[];this.ivo()&&P.push("InsertTabStopMenuSplitButton");this.Tuo()&&
P.push("ClearAllTabStops");P.push("HideRuler");B.push(dD.mTd(P));P=Object.assign(new dh.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});P.MenuSectionList.push(...B);Qa.MenuItems=P;return 32};this.ga=b;this.nn=h;this.qz=r;this.Ub()}get Kbb(){return document.getElementById("WACHorizontalRuler")}get SN(){return this.nn&&this.nn.instance?this.nn.instance.oj:1}get target(){return this.El}show(b,h){this.El=b;Dx.a.Eqb("RulerContextMenu",b,h);t.ULS.sendTraceTag(592307397,3014,50,
"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",dD.wP);b.set("Response","Ruler Context menu invoked.");xa.Health.instance.recordKpiUsage(dD.kpiName,1,dD.Q8,b)}Wbm(){var b=0,h=(this.target.x-Qd.a.Xof(this.Kbb))/this.SN;h=Xg.a.Yy(h,0);var r={},B=this.qz.kFb,P=xd.GraphIterator.eb(B);P.od();if(!mi.TableReader.mx(P))return 32===this.ga.Qb(Mb.a.mIa,2,r)&&(b=r.marginLeft),h-b;b={};P={};r=this.ga.Qb(Mb.a.P5c,2,b);var ca=this.ga.Qb(Mb.a.AOb,2,P);if(32!==r||32!==ca)return t.ULS.sendTraceTag(559252943,
3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ca=P.TablePosition;if(!ca||!b||0>=b.length)return t.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;P=xd.GraphIterator.eb(B);P.zb(14)&&(P.jd(16),r=bt.a(P,!0));B=ca.x/this.SN;for(P=0;P<r;P++)B+=b[P];return h-B}Ub(){this.ga.fb(V.a.yae,zc.a.application,this.yae,96)}ivo(){var b={},h={},r=this.ga.Qb(Mb.a.mIa,2,b),B=this.ga.Qb(Mb.a.b7a,2,h);if(32===r&&32===B){B=h.Lt;r=Xg.a.Oi(B.lpa,
0);B=1===B.specialIndentType?Xg.a.Oi(B.OB,0):Xg.a.Oi(B.OB-B.vea,0);const P=Xg.a.Oi(b.marginLeft,0);b=Xg.a.Oi(b.marginRight,0);const ca=Qd.a.Xof(this.Kbb),ra=Qd.a.n6h(this.Kbb);h.isRtl?(h=ca+this.SN*Math.max(b,b+r),r=ra-this.SN*Math.max(P,P+B)):(h=ca+this.SN*Math.max(P,P+B),r=ra-this.SN*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}Tuo(){var b={};if(32!==this.ga.Qb(V.a.nOb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static mTd(b){const h=Object.assign(new Nf.a,
{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new ei.a,{ExternalId:r}));return h}}dD.Q8="wwaengidc";dD.kpiName="WordRuler";dD.wP="RulerContextMenu";Object(n.a)(dD,"RulerContextMenu",Dx.a,[598]);let tB;class Lq{static get qc(){return null!=Lq.hKg?Lq.hKg:Lq.hKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get tE(){return null!=Lq.$Jg?Lq.$Jg:Lq.$Jg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Cj(){return null!=Lq.SBg?Lq.SBg:Lq.SBg=Ya.a.instance.resolve("Box4.IInsertionPointFormatting")}static A5i(b,
h,r){if(1===h)return(b?Lq.FTk(r):Lq.cTk(r))?32:8;(b=Lq.kgm(b,r))&&Lq.WFk(b,r);return 32}static WFk(b,h){const r=new sg.GraphTransaction(15);r.Db(h);Lq.Cj.y7a();Lq.tE.cK(b,h,!1);r.dispose()}static FTk(b){b=Lq.qc.hp(b);return!!b&&Lq.qc.Kg(b)!==Rl.StyleReader.wordStyleIdHeading1}static cTk(b){b=Lq.qc.hp(b);return!!b&&Lq.qc.Kg(b)!==Rl.StyleReader.PTb}static kgm(b,h){const r=Lq.qc.hp(h);return r?Lq.qc.ZC(h).pj(Lq.igm(b,Lq.qc.Kg(r))):null}static igm(b,h){h=Lq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=
b&&b<Lq.headingsList.count?Lq.headingsList.J(b):null}}Lq.headingsList=(tB=new vb.a,tB.add(Rl.StyleReader.wordStyleIdHeading1),tB.add(Rl.StyleReader.wordStyleIdHeading2),tB.add(Rl.StyleReader.wordStyleIdHeading3),tB.add(Rl.StyleReader.MTb),tB.add(Rl.StyleReader.NTb),tB.add(Rl.StyleReader.OTb),tB.add(Rl.StyleReader.Kpc),tB.add(Rl.StyleReader.Lpc),tB.add(Rl.StyleReader.PTb),tB);Object(n.a)(Lq,"NavigationPaneEditor",null,[]);class MF extends Dx.a{constructor(){super();this.n4=null;this.pae=(b,h,r,B,P)=>
{if(1===r)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Dx.a.d4h("promoteHeading",V.a.ebe,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Dx.a.d4h("demoteHeading",V.a.oLd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");P.PopulationXML=b.toString();
return 32};this.ebe=(b,h,r)=>Lq.A5i(!0,r,this.n4.Cb);this.oLd=(b,h,r)=>Lq.A5i(!1,r,this.n4.Cb)}show(b){MF.Zh||(this.S5b(),MF.Zh=!0);Dx.a.showContextMenu("mnuNavPaneWordEditor",b)}S5b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+V.a.m3i;b.Command=""+eb.a.Wma;Dx.a.O$k(b);v.AFrameworkApplication.va.qa(V.a.m3i,zc.a.application,this.pae);v.AFrameworkApplication.va.qa(V.a.ebe,zc.a.view,this.ebe);v.AFrameworkApplication.va.qa(V.a.oLd,zc.a.view,this.oLd)}}MF.Zh=
!1;Object(n.a)(MF,"WordEditorNavigationPaneContextMenu",Dx.a,[597]);var Ex=c(284),sC=c(1497),oM=c(455),pM=c(759),pG=c(1211),eH=c(1724),fH=c(1018),tC=c(704);class qG{constructor(){this.t9=this.pzi=!1;this.iSb=tC.a.none;this.zw=0;this.X9a=1}}Object(n.a)(qG,"WrapTextPropertiesData",null,[]);class hm extends pG.a{constructor(b=null){super(b);this.ufh=new eH.a;this.Smh=new qG;this.Vih=new fH.a;this.wDe=!1;this.rqi=h=>{const r=new Ex.a;r.$Ea=!0;r.rM=h;return r};this.E1=()=>{const h=new Ex.a;h.WHb=!1;h.rM=
Mb.a.mIa;h.vd=this.ufh;h.Ldc=!0;h.Cia=!0;return h};this.y6i=()=>{const h=new Ex.a;h.WHb=this.wDe;this.wDe=!0;h.rM=Mb.a.c7a;h.vd=this.Vih;h.Ldc=!0;h.Cia=!0;return h};this.ifd=()=>{const h=new Ex.a;h.WHb=!1;h.rM=V.a.gjc;h.vd=this.Smh;h.Ldc=!0;h.Cia=!0;return h};this.uXd=(h,r)=>{const B=new Ex.a;B.vd=new wc.DictionaryPropertySet;switch(h){case V.a.yUc:B.vd.setValue(Zc.a.Bkb,r[Gg.a.Number]);break;case V.a.rUc:B.vd.setValue(Zc.a.ykb,r[Gg.a.Number]);break;case V.a.sUc:B.vd.setValue(Zc.a.zkb,r[Gg.a.Number]);
break;case V.a.tUc:B.vd.setValue(Zc.a.Akb,r[Gg.a.Number])}return B};this.yMn=()=>{const h=new Ex.a;h.vd=new wc.DictionaryPropertySet;h.Cia=!0;return h}}initialize(){super.initialize();this.nd.Z(V.a.IKf,sC.a.Mkb);this.nd.Z(V.a.NKf,sC.a.Mkb);this.nd.Z(V.a.PKf,sC.a.Mkb);this.nd.Z(V.a.T4f,hm.CTa);this.nd.Z(V.a.I5c,hm.CTa);this.nd.Z(V.a.M4f,hm.CTa);this.nd.Z(eb.a.DOb,hm.CTa);this.nd.Z(Mb.a.Qbe,this.E1);this.nd.Z(Mb.a.Pbe,this.E1);this.nd.Z(Mb.a.Obe,this.E1);this.nd.Z(Mb.a.Sbe,this.E1);this.nd.Z(Mb.a.Rbe,
this.E1);this.nd.Z(Mb.a.Nbe,this.E1);this.nd.Z(Mb.a.Zbe,this.E1);this.nd.Z(Mb.a.Ybe,this.E1);this.nd.Z(Mb.a.Xbe,this.E1);this.nd.Z(Mb.a.Ube,this.E1);this.nd.Z(Mb.a.Vbe,this.E1);this.nd.Z(Mb.a.Wbe,this.E1);this.nd.Z(Mb.a.f5f,this.E1);this.nd.Z(Mb.a.e5f,this.E1);this.nd.Z(Mb.a.v4f,this.E1);this.nd.Z(Mb.a.x4f,this.E1);this.nd.Z(Mb.a.w4f,this.E1);this.nd.Z(Mb.a.u4f,this.E1);this.nd.Z(Mb.a.g8a,hm.ran);this.nd.Z(Mb.a.GUa,hm.bAn);this.nd.Z(Mb.a.Ypb,hm.z1k);this.nd.Z(Mb.a.bna,hm.CTa);this.nd.Z(Mb.a.MNb,hm.CTa);
this.nd.Z(Mb.a.FTa,hm.CTa);this.nd.Z(Mb.a.Tua,hm.CTa);this.nd.Z(Mb.a.bza,hm.CTa);this.nd.Z(V.a.r4c,hm.CTa);this.nd.Z(V.a.HPd,sC.a.Amf);this.nd.Z(V.a.IPd,this.M4h);this.Ym.Z(V.a.p4c,sC.a.oPa);this.Ym.Z(V.a.q4c,sC.a.oPa);this.nd.Z(Mb.a.FQb,sC.a.X1a);this.nd.Z(Mb.a.EQb,sC.a.X1a);this.nd.Z(Mb.a.mqb,sC.a.X1a);this.nd.Z(Mb.a.r5f,this.EF);this.nd.Z(Mb.a.p5f,this.EF);this.nd.Z(Mb.a.q5f,this.EF);this.nd.Z(Mb.a.KL,hm.RKn);this.Ym.Z(V.a.Ace,hm.N6c);this.Ym.Z(V.a.Bce,hm.N6c);this.Ym.Z(V.a.Cce,hm.N6c);this.Ym.Z(V.a.yce,
hm.N6c);this.Ym.Z(V.a.zce,hm.N6c);this.nd.Z(V.a.Ace,this.ifd);this.nd.Z(V.a.Bce,this.ifd);this.nd.Z(V.a.Cce,this.ifd);this.nd.Z(V.a.yce,this.ifd);this.nd.Z(V.a.zce,this.ifd);this.nd.Z(V.a.tqe,hm.Tpc);this.nd.Z(V.a.uqe,hm.Tpc);this.nd.Z(V.a.vqe,hm.Tpc);this.nd.Z(V.a.wqe,hm.Tpc);this.nd.Z(V.a.xqe,hm.Tpc);this.nd.Z(V.a.yqe,hm.Tpc);this.nd.Z(V.a.eJa,hm.a9b);this.nd.Z(V.a.Isj,hm.a9b);this.nd.Z(V.a.Jsj,hm.a9b);this.nd.Z(V.a.kje,hm.a9b);this.nd.Z(V.a.lje,hm.a9b);this.nd.Z(V.a.had,hm.a9b);this.nd.Z(V.a.Zob,
this.yMn);this.nd.Z(V.a.s5c,hm.qQd);this.nd.Z(V.a.Gbe,hm.qQd);this.nd.Z(V.a.Hbe,hm.qQd);this.nd.Z(V.a.Ibe,hm.qQd);this.nd.Z(V.a.yUc,this.uXd);this.nd.Z(V.a.rUc,this.uXd);this.nd.Z(V.a.sUc,this.uXd);this.nd.Z(V.a.tUc,this.uXd);this.nd.Z(Mb.a.epa,this.rqi);this.nd.Z(Mb.a.jEb,this.rqi);this.nd.Z(V.a.Xob,hm.Xob);this.nd.Z(V.a.tje,sC.a.X1a);this.nd.Z(Mb.a.v5f,this.y6i);this.nd.Z(Mb.a.w5f,this.y6i)}clearCache(){super.clearCache();this.wDe=!1;this.ufh=new eH.a;this.Smh=new qG;this.Vih=new fH.a}hqf(){const b=
super.hqf();b.vDa=hm.vDa;b.T_a=hm.T_a;return b}static get Azn(){return null!=hm.GFg?hm.GFg:hm.GFg=Ya.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get Wz(){hm.kua||(hm.kua=Ya.a.instance.Oa("WordEditor.ITableBorderManager"));return hm.kua}static CTa(b,h){b=new Ex.a;b.vd=h;return b}static T9c(b,h,r){h[Df.a.Description]=b?b.nan(r):null}static vDa(b,h){const r=Object(Na.a)(eH.a,b.vd),B=Object(Na.a)(oM.a,b.vd),P=Object(Na.a)(qG,b.vd),ca=Object(Na.a)(fH.a,b.vd);let ra=!0;const Qa=hm.Azn;
switch(b.nob){default:ra=pG.a.vDa(b,h);break;case Mb.a.Qbe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Df.a.On]=!r.BLb;hm.T9c(Qa,h,0);break;case Mb.a.Pbe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Df.a.On]=1===r.BLb;hm.T9c(Qa,h,1);break;case Mb.a.Obe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Df.a.On]=2===r.BLb;hm.T9c(Qa,h,2);break;case Mb.a.Sbe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeWide_48":
"PageMarginsPortraitWide_48";h[Df.a.On]=3===r.BLb;hm.T9c(Qa,h,3);break;case Mb.a.Rbe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Df.a.On]=4===r.BLb;hm.T9c(Qa,h,4);break;case Mb.a.Nbe:h[mk.a.Icon]=r.Mxa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Df.a.On]=5===r.BLb;break;case Mb.a.Zbe:h[Df.a.On]=!r.jNb;h[Df.a.Description]=Qa?Qa.x3c(0):null;break;case Mb.a.Ybe:h[Df.a.On]=1===r.jNb;h[Df.a.Description]=Qa?Qa.x3c(1):null;break;case Mb.a.Xbe:h[Df.a.On]=
2===r.jNb;h[Df.a.Description]=Qa?Qa.x3c(2):null;break;case Mb.a.Ube:h[Df.a.On]=3===r.jNb;h[Df.a.Description]=Qa?Qa.x3c(3):null;break;case Mb.a.Vbe:h[Df.a.On]=4===r.jNb;h[Df.a.Description]=Qa?Qa.x3c(4):null;break;case Mb.a.Wbe:h[Df.a.On]=5===r.jNb;break;case Mb.a.f5f:h[Df.a.On]=!r.Mxa;break;case Mb.a.e5f:h[Df.a.On]=r.Mxa;break;case Mb.a.v4f:h[Df.a.On]=1===r.tJc;break;case Mb.a.x4f:h[Df.a.On]=2===r.tJc;break;case Mb.a.w4f:h[Df.a.On]=3===r.tJc;break;case Mb.a.u4f:h[Df.a.On]=0===r.tJc;break;case Mb.a.r5f:h[Df.a.On]=
B.Lt?!B.Lt.specialIndentType:!1;break;case Mb.a.p5f:h[Df.a.On]=B.Lt?1===B.Lt.specialIndentType:!1;h[mm.a.Image16by16Class]=B.isRtl?ie.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):ie.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Mb.a.q5f:h[Df.a.On]=B.Lt?2===B.Lt.specialIndentType:!1;h[mm.a.Image16by16Class]=B.isRtl?ie.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):ie.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case V.a.Ace:h[Df.a.On]=1===
P.X9a;break;case V.a.Bce:h[Df.a.On]=8===P.X9a;break;case V.a.Cce:h[Df.a.On]=9===P.X9a;break;case V.a.yce:h[Df.a.On]=3===P.X9a;break;case V.a.zce:h[Df.a.On]=4===P.X9a;break;case V.a.Zob:h[Df.a.On]=b.vd.ja(Zc.a.Ixa,!1);break;case V.a.Xob:h[gk.a.IsFreeForm]=!0;h[gk.a.Value]=b.vd[Kj.a.Value];break;case Mb.a.v5f:h[Ui.a.On]=hm.Wz.k6h(h.MenuItemId)===ca.lineStyle;break;case Mb.a.w5f:h[Ui.a.On]=hm.Wz.l6h(h.MenuItemId)===ca.j_c}return ra}static ran(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=
0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Ex.a;h.vd=b;return h}static bAn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Ex.a;h.vd=b;return h}static z1k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=
2;break;case "buttonThreeColumns":b=3}h=new Ex.a;h.vd=b;return h}static Xob(){const b=new Ex.a;b.rM=V.a.Xob;b.vd={};b.Cia=!0;b.Ldc=!0;return b}static Tpc(b,h){const r=new Ex.a;r.vd=new wc.DictionaryPropertySet;let B=1;switch(b){case V.a.wqe:B=1;break;case V.a.xqe:B=8;break;case V.a.yqe:B=9;break;case V.a.uqe:B=3;break;case V.a.vqe:B=4}r.vd.setValue(Zc.a.X9a,B);r.vd.setValue(Zc.a.lJa,h[Df.a.SourceControlId]);return r}static a9b(b,h,r){b=new Ex.a;b.vd=r.InvocationMethod;return b}static RKn(b,h){b=new Ex.a;
b.vd=h;return b}static N6c(){const b=new pM.a;b.rM=V.a.gjc;return b}static qQd(){const b=new Ex.a;b.vd=new wc.DictionaryPropertySet;b.cYc=!0;return b}static T_a(b,h){let r=!0;switch(b.nob){case V.a.s5c:b=b.vd.ja(Zc.a.Bkb,0);h[Gg.a.Number]=b;h[Gg.a.UnitType]=7;break;case V.a.Gbe:b=b.vd.ja(Zc.a.ykb,0);h[Gg.a.Number]=b;h[Gg.a.UnitType]=7;break;case V.a.Hbe:b=b.vd.ja(Zc.a.zkb,0);h[Gg.a.Number]=b;h[Gg.a.UnitType]=7;break;case V.a.Ibe:b=b.vd.ja(Zc.a.Akb,0);h[Gg.a.Number]=b;h[Gg.a.UnitType]=7;break;default:r=
pG.a.T_a(b,h)}return r}}hm.kua=null;Object(n.a)(hm,"CuiActionBridge",pG.a,[]);class gH extends Pf.a{constructor(b){super();this.W1k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.Uro=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.wLd=this.jzb=this.V6=this.BYa=this.XSe=null;this.Vb=b;this.Vg="<div id='AccessibilityHelpDialogBody'></div>";this.zg="AAccessibilityHelpDialog";this.Cd=6;this.ye(0,CommonUIStrings.l_DialogClose)}get Bff(){return null}get sie(){this.XSe||(this.XSe=this.qBm());
return this.XSe}get $Ho(){return 300}get cQi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get bQi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get g1a(){return this.Vb.at()}yUa(b){super.yUa(b);this.bFn()}RUa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.fqk,"accHelpDialogResultHandler"));this.tIa();this.setFocus()}setFocus(){this.V6?(this.jzb=this.V6.tBodies[0].firstChild,this.G1(this.jzb)):this.oH&&"none"!==this.oH.style.display?this.G1(this.oH):this.G1(this.aA)}hna(){this.ge.ob(Xc.a.gi,
this.wLd,Object(z.a)(this,this.mnh,"accHelpDialogKeydownHandler"));if(this.V6){this.ge.ob(Xc.a.zh,this.V6,Object(z.a)(this,this.Fyj,"tableOnKeyUpHandler"));const b=this.V6.tBodies[0].children;for(let h=0;h<b.length;h++)if(De.a.addHandler(b[h],Xc.a.focus,Object(z.a)(this,this.Jgj,"rowOnFocusHandler")),De.a.addHandler(b[h],Xc.a.blur,Object(z.a)(this,this.Igj,"rowOnBlurHandler")),ba.a.ht){const r=b[h].children;for(let B=0;B<r.length;B++)De.a.addHandler(r[B],Xc.a.focus,Object(z.a)(this,this.YCh,"cellOnFocusHandler"))}}super.hna()}ohb(){this.ge&&
(this.ge.uc(Xc.a.gi,this.wLd,Object(z.a)(this,this.mnh,"accHelpDialogKeydownHandler")),this.V6&&this.ge.uc(Xc.a.zh,this.V6,Object(z.a)(this,this.Fyj,"tableOnKeyUpHandler")));if(this.V6){const b=this.V6.tBodies[0].children;for(let h=0;h<b.length;h++)if(De.a.removeHandler(b[h],Xc.a.focus,Object(z.a)(this,this.Jgj,"rowOnFocusHandler")),De.a.removeHandler(b[h],Xc.a.blur,Object(z.a)(this,this.Igj,"rowOnBlurHandler")),ba.a.ht){const r=b[h].children;for(let B=0;B<r.length;B++)De.a.removeHandler(r[B],Xc.a.focus,
Object(z.a)(this,this.YCh,"cellOnFocusHandler"))}}super.ohb()}tIa(){this.g1a.scope.mr(this.Vb.YW);this.g1a.scope.mr(this.Vb.ZW);this.g1a.scope.bindAction(this.Vb.YW,eb.a.IFc);this.g1a.scope.bindAction(this.Vb.ZW,eb.a.HFc)}nrm(b){if(!this.g1a.hk||!this.g1a.hk.n4)return 2;var h=this.g1a.hk.n4;if(this.V6&&(h===this.aA&&b===eb.a.IFc||h===this.BYa&&b===eb.a.HFc))this.G1(this.jzb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===eb.a.IFc?h=this.BYa:b===eb.a.HFc&&(h=this.aA),h&&this.G1(h);else if(b===
eb.a.IFc)this.g1a.pgc();else if(b===eb.a.HFc)this.g1a.ngc();else return 2;return 32}Jgj(b){b.target.setAttribute(qf.a.sfb,qf.a.xp);Sys.UI.DomElement.removeCssClass(this.jzb,"inactiveRowSelection");this.jzb=b.target}Igj(b){b.target.removeAttribute(qf.a.sfb);Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}YCh(b){(b=b.target.parentNode)&&b!==this.jzb&&this.G1(b)}Fyj(b){return b.Hb.keyCode===kc.a.Rs?(b.Hb.stopPropagation(),!0):!1}mnh(b){if(!b.Hb)return!1;const h=b.Hb.keyCode;if(b.eventName===
Xc.a.gi){b=this.B1l(this.jzb);let r=-1;const B=zb.a.count(this.sie)-1;h===Sys.UI.Key.down?r=b<B?b+1:0:h===Sys.UI.Key.up?r=0<b?b-1:B:h===Sys.UI.Key.home?r=0:h===Sys.UI.Key.end&&(r=B);-1!==r&&this.G1(this.V6.tBodies[0].children[r])}return!0}fqk(){}bFn(){this.wLd=document.getElementById("AccessibilityHelpDialogBody")||this.hq;this.Efl();this.gfl();this.Ucl()}Efl(){if(this.Bff){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.Bff;
b.appendChild(h);this.wla.appendChild(b)}}gfl(){if(this.sie&&!zb.a.isEmpty(this.sie)){this.V6=document.createElement("table");this.V6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(qf.a.uh,qf.a.iHc);b.appendChild(h);var r=Kb.a.HKc(14,this.W1k);h.appendChild(r);r=Kb.a.HKc(14,this.Uro);h.appendChild(r);this.V6.appendChild(b);b=document.createElement("tbody");h=0;r=this.sie;for(let ca in r){var B=ca,P=r[ca];const ra=document.createElement("tr");
ra.tabIndex=0;ra.setAttribute(qf.a.uh,qf.a.iHc);ra.id="SelectableTableRow"+h++;B=Kb.a.HKc(15,B);ra.appendChild(B);P=Kb.a.HKc(15,P);ra.appendChild(P);b.appendChild(ra)}b.style.maxHeight=this.$Ho+"px";this.V6.appendChild(b);this.wLd.appendChild(this.V6)}}Ucl(){if(this.bQi&&this.cQi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.BYa=document.createElement("a");this.BYa.innerText=this.bQi;this.BYa.href=this.cQi;this.BYa.target="_blank";this.BYa.id=this.rj("AccessibilityHelpDialogLink");
this.BYa.className=Zd.AFrame.J1e;b.appendChild(this.BYa);this.Kc.insertBefore(b,this.Kc.lastChild)}}B1l(b){return Number.parseInvariant(b.id.substr(18))}C_(b,h,r,B=null){b&&h&&r&&(r=B?String.format(r,B):r,b[h]=r)}Thi(b,h){return ba.a.el?h:b}}Object(n.a)(gH,"AAccessibilityHelpDialog",Pf.a,[1176]);class $D extends gH{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get Bff(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}qBm(){const b=
this.Thi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.Thi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.C_(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.C_(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.C_(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);
this.C_(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.C_(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,
b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,
b);this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.C_(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.C_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);($D.Zb&&$D.Zb.isFeatureEnabled(64)||oo.a.PGa())&&this.C_(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get Zb(){return null!=$D.Gzg?$D.Gzg:$D.Gzg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(n.a)($D,"AccessibilityHelpDialog",gH,[]);var hI=c(334);class rG{static get Vg(){return Pf.a.Nx(rG.Wm,WordEditorIntl.WordEditorStrings.l_StyleName,
WordEditorIntl.WordEditorStrings.l_BadStyleName)}}rG.Wm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";Object(n.a)(rG,"ApplyStylesDialogHtml",
null,[]);class NE extends Pf.a{constructor(b,h){super();this.CH=null;this.eEc=!1;this.vAb=this.H$a=this.zAc=this.CAc=this.uEc=null;this.BGk=(r,B)=>{if(this.qh.ov){if(r){r=B.styleList;B=B.styleText;if(-1===r||E.a.eh(B)!==E.a.eh(this.CH[r]))r=this.mii(B);B=this.CH[r];r=this.qc.Ar();B=this.qc.Kg(r.QFa(B));v.AFrameworkApplication.va.Mf(this._context,Mb.a.LQ,2,!1,new hI.a,B)}this.qh.e6()}};this.Qvn=r=>{this.eEc?(this.eEc=!1,this.validate()):"value"===r.rawEvent.propertyName&&(this.eEc=!0,this.t_.value!==
this.uEc&&(this.uEc=this.t_.value,this.Zwh()))};this.ern=()=>{-1!==this.Ema.selectedIndex&&(ba.a.X4&&(this.eEc=!0),this.uEc=this.CH[this.Ema.selectedIndex],this.t_.value=this.CH[this.Ema.selectedIndex],this.validate())};this.onKeyDown=r=>{ba.a.gK?r.keyCode!==kc.a.qC&&r.keyCode!==kc.a.k2||this.H$a||this.vAb||(this.vAb=new Oe.a(0,1,1,this.d3o),v.AFrameworkApplication.lc.Wb(this.vAb)):ba.a.X4&&r.keyCode===kc.a.qC&&(this.eEc=!0)};this.$G=()=>{this.H$a||(this.H$a=new Oe.a(0,1,1,this.bJk),v.AFrameworkApplication.lc.Wb(this.H$a));
this.vAb&&(v.AFrameworkApplication.lc.ff(this.vAb),this.vAb=null)};this.bJk=()=>{this.H$a=null;this.Zwh()};this.d3o=()=>{this.vAb=null;this.validate()};this._context=b;this.rd=h;this.zg="ApplyStylesDialog";this.qh=this._context.view;this.rvf();b=this.LFo();h="";this.CH.length>b&&(h=this.CH[b]);h={["styleText"]:h,["styleList"]:b};this.Vg=rG.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.BGk,h);this.Ema=document.getElementById("styleList");this.e2f();this.Ema.selectedIndex=b;this.t_=
document.getElementById("styleText");this.t_.focus();this.t_.select();this.ctd=this.ern;De.a.addHandler(this.Ema,"change",this.ctd);this.btd=this.onKeyDown;De.a.addHandler(this.t_,"keydown",this.btd);ba.a.X4?(this.CAc=this.Qvn,De.a.addHandler(this.t_,"propertychange",this.CAc),this.uEc=this.CH[b]):(this.zAc=this.$G,De.a.addHandler(this.t_,"keypress",this.zAc))}get qc(){return null!=this.iKg?this.iKg:this.iKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}LFo(){var b=this.qh.mb;if(!b||!b.ib)return Rc.b(579216408,
3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.ib.lb;if(!b)return Rc.b(579216409,3018,15,"CurrentSelection is null"),0;Td.ParagraphReader.um(b.Pa)&&(b=Pd.SelectionEditor.Jj(b,!0,!1));b=b.Pa;if(!b||!Pd.SelectionEditor.pv(b))return Rc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Bn.FormattingReader.Xr(b);(h=Bn.FormattingReader.Zwa(h))||(h=this.qc.hp(b.node));if(!h)return 0;b=this.qc.vR(h);b=Array.indexOf(this.CH,b);0>b&&(b=0);return b}e2f(){const b=this.CH.length;
for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.CH[h];this.Ema.add(r,null)}}rvf(){var b=um.a.zr();if(b){b=(new au.WACStyleSet).iY(b);var h=b.DO,r=this.rd.isFeatureEnabled(112)&&!!this.qc.Hg;this.CH=[];for(let B=0;B<h;B++){const P=b.PFa(B);if(this.qc.isHidden(P))continue;const ca=this.qc.NG(P);if(!r){if(3===ca)continue}else if(3===ca&&this.qc.Kg(P)===ly.a.hMb)continue;Array.add(this.CH,this.qc.vR(P))}this.CH.sort(NE.G3k)}else Rc.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.CAc&&
De.a.removeHandler(this.t_,"propertychange",this.CAc);this.btd&&De.a.removeHandler(this.t_,"keydown",this.btd);this.ctd&&De.a.removeHandler(this.Ema,"change",this.ctd);this.zAc&&De.a.removeHandler(this.t_,"keypress",this.zAc);this.H$a&&v.AFrameworkApplication.lc.ff(this.H$a);this.H$a=this.zAc=this.Ema=this.t_=this.btd=this.CAc=this.ctd=null;super.dispose()}Zwh(){var b=this.t_.value,h=this.izm(b);const r=-1===h?b:this.CH[h];b=b.length;const B=r.length;this.uEc=r;this.t_.value=r;this.Ema.selectedIndex=
h;B>b&&(ba.a.gK?this.t_.setSelectionRange(b,B):ba.a.X4&&(h=this.t_.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",B-b),h.select()));this.validate();this.t_.focus()}izm(b){let h=0,r=this.CH.length,B=-1;for(b=E.a.eh(b);h<r;){const P=Math.floor((h+r)/2),ca=NE.$9e(b,this.CH[P]);if(!ca){B=P;break}0<ca?h=P+1:r=P}if(B>h)for(;!NE.$9e(b,this.CH[B-1])&&(B--,B!==h););return B}validate(){const b=-1===this.mii(this.t_.value),h=document.getElementById("badStyleError");b?(h.style.display=
"inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}mii(b){b=E.a.eh(b);const h=this.CH.length;for(let r=0;r<h;r++)if(b===E.a.eh(this.CH[r]))return r;return-1}static $9e(b,h){const r=Math.min(b.length,h.length);b=E.a.eh(b);h=E.a.eh(h);for(let B=0;B<r;B++){const P=E.a.charCodeAt(b,B),ca=E.a.charCodeAt(h,B);if(P!==ca)return P-ca}return b.length<=h.length?0:1}static G3k(b,h){return NE.$9e(b,h)}}Object(n.a)(NE,"ApplyStylesDialog",
Pf.a,[]);var OE=c(322);class iI extends Wh.StandardDialog{constructor(b){super();this.Fv=b;this.Wwo()}Wwo(){this.Cd=1;this.FV(1);this.ye(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.sv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.Vef.bind(this))}Vef(b){1===b&&this.Fv.ika("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Gi?Rc.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",
h.exception,h.exception.stack):(this.G7n(),Rc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}G7n(){OE.a.isb="{}"}}Object(n.a)(iI,"DeleteSavedStylesConfirmationDialog",Wh.StandardDialog,[]);class jI extends Wh.StandardDialog{constructor(b,h){super();this.Vef=P=>{if(1===P){P=new Map;P.set("Source","DeleteStyleConfirmationDialog");P.set("Action","DeleteStyle");xa.Health.instance.recordKpiUsage(Do.a.HAa,0,Do.a.zB,P);var ca=um.a.zr();P=new sg.GraphTransaction(15);P.Db(ca);P.Uj=Mb.a.aEb;
this.tE.ERh(this.mih)?Rc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new sb.a,{extendedProperties:ca}),xa.Health.instance.recordKpiFailure(Do.a.HAa,"DeleteStyleFailed",!1,!0,ca),Rc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));P.dispose()}};h||Rc.b(590128417,3018,10,"styleId is null");let r=null,B=null;if(this.qh=b.view)B=this.qh.mb;B&&
(r=B.ib.lb.Pa);r?(b=r.node)?(this.JK=this.hi.uu(b))?(this.mih=new vb.a,this.mih.add(h),this.Xwo(h)):Rc.b(590128448,3018,10,"_pageContenNode is null."):Rc.b(590128419,3018,10,"node is null."):Rc.b(590128418,3018,10,"nodeContext is null.")}get tE(){return null!=this.YJg?this.YJg:this.YJg=Ya.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.pKg?this.pKg:this.pKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get hi(){return null!=this.UFg?this.UFg:this.UFg=ro.PageNavigator.instance}Xwo(b){const h=
(new au.WACStyleSet).iY(this.JK);h?((b=h.pj(b))||Rc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.qc.vR(b),this.Cd=4,this.FV(2),this.sv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.Vef)):Rc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(n.a)(jI,"DeleteStyleConfirmationDialog",Wh.StandardDialog,[]);class sG{static get Vg(){return Pf.a.Nx(sG.Wm)}}sG.Wm=
"<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(n.a)(sG,"DeleteStyleDialogHtml",null,[]);class kI extends Pf.a{constructor(b){super();this.JK=this.CH=null;this.Pll=(h,r)=>{this.qh.ov&&(h?(h=r.styleList,-1!==h&&(h=this.CH[h],r=this.qc.Ar(),h=this.qc.Kg(r.QFa(h)),this.bMc.Oll(this._context,h),this.qh.e6())):this.qh.e6())};this._context=b;this.zg="DeleteStyleDialog";this.Cd=1;this.ye(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);
this.qh=this._context.view;this.rvf();this.Vg=sG.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.Pll,{["styleList"]:0});this.Ema=document.getElementById("styleList");this.e2f();this.Ema.selectedIndex=0;this.Ema.focus()}get qc(){return null!=this.kKg?this.kKg:this.kKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get bMc(){return null!=this.Byg?this.Byg:this.Byg=Ya.a.instance.resolve("WordEditor.UI.IDialogFactory")}e2f(){const b=this.CH.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");
r.value=h.toString();r.text=this.CH[h];this.Ema.add(r,null)}}rvf(){if(this.JK=um.a.zr()){var b=(new au.WACStyleSet).iY(this.JK),h=b.DO;this.CH=[];for(let B=0;B<h;B++){const P=b.PFa(B);if(!this.qc.isHidden(P)&&this.qc.le(P,b)){var r=this.qc.NG(P);if(2===r||1===r)P.hasProperty(Oc.a.linkedStyle)&&2!==r||(r=P.ja(Oc.a.XK,null))&&0<r.length||this.CH.push(this.qc.vR(P))}}this.CH.sort()}else Rc.b(578650370,3018,15,"PageContentNode is null")}}Object(n.a)(kI,"DeleteStyleDialog",Pf.a,[]);var qM=c(783);class lI{constructor(b){this.customData=
null;this.XO=b}}Object(n.a)(lI,"PropertySetChangedState",null,[]);class mI{static jJn(b,h,r){if(b&&h){var B=new lI(h),P=(ca,ra,Qa)=>{r.iJn(ca,ra,Qa,B)};b=new qM.a(h,b);b.ICd=P;b.bGd=P;b.gee=P;b.Lic()}}}Object(n.a)(mI,"PropertySetChangedManager",null,[]);class nI{constructor(b){this.lNa=b}iJn(b,h,r,B){const P=this.lNa[b.id.toString()];P&&P(b,h,r,B)}}Object(n.a)(nI,"PropertyChangedProcessor",null,[]);const tG=(b,h,r)=>{const B=vq.a.instance.kFb;if(B){const P=new sg.GraphTransaction(15);P.Db(B);mI.jJn(b,
h,new nI(r));P.dispose()}};class uG{static get Vg(){return Pf.a.Nx(uG.Wm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}uG.Wm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(n.a)(uG,"MarginsDialogHtml",null,[]);class pr{static get z5(){return null!=pr.HFg?pr.HFg:pr.HFg=Ya.a.instance.Oa("WordEditor.IPageCommands")}static man(b,h,r){pr.z5&&null!==r&&pr.z5.Ahe(0,r)}static ian(b,h,r){pr.z5&&null!==r&&pr.z5.Ahe(3,r)}static kan(b,h,r){pr.z5&&null!==r&&pr.z5.Ahe(1,r)}static lan(b,h,r){pr.z5&&null!==r&&pr.z5.Ahe(2,r)}static kAn(b,h,r){pr.z5&&null!==r&&pr.z5.GUa(0,r)}static Mzn(b,h,r){pr.z5&&null!==r&&pr.z5.GUa(1,r)}static A1k(b,h,r){pr.z5&&null!==r&&(b==Nd.a.aF?pr.z5.Mge(0,
r):b==Nd.a.uG?pr.z5.Mge(1,r):b==Nd.a.zna?pr.z5.Mge(2,r):b==Nd.a.separator&&pr.z5.Mge(3,r))}}Object(n.a)(pr,"PageLevelPropertyChangedHandlers",null,[]);const oI=[V.a.a3c,V.a.$2c,V.a.C9d,V.a.D9d,V.a.Mbe,V.a.Jbe,V.a.Kbe,V.a.Lbe];class wA extends Pf.a{constructor(b,h,r,B,P){super();this.zPc=(ca,ra)=>{var Qa=wA.b5c(ca);ca=qe.App.Pia;this.Kp.hasProperty(Qa)?(Qa=this.Kp.getValue(Qa),ra[Gg.a.Number]=af.a.P9a(Qa,ca)):ra[Gg.a.Number]=0;ra[Gg.a.UnitType]=ca};this.y9c=(ca,ra)=>{this.Kp.setValue(wA.b5c(ca),af.a.UJa(ra[Gg.a.Number],
ra[Gg.a.UnitType]));this.Hu.Gm()};this.oan=ca=>{let ra=!1;1===ca&&(Math.abs(this.Kp.getValue(Oc.a.marginTop))+Math.abs(this.Kp.getValue(Oc.a.marginBottom))+qe.App.GAa<=this.xua.getValue(Oc.a.uv)&&this.Kp.getValue(Oc.a.marginLeft)+this.Kp.getValue(Oc.a.marginRight)+qe.App.GAa<=this.xua.getValue(Oc.a.Ko)?tG(this.OBa,this.Kp,wA.N$b()):ra=!0);this.dispose();ra&&this.TIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.jan)};this.jan=()=>{Ya.a.instance.resolve("WordEditor.UI.IDialogFactory").cNh(this.OBa,
this.xua,this.p7)};this.zg="MarginsDialog";this.xua=h.clone();this.OBa=b.clone();this.Kp=b.clone();this.p7=r;this.pW=!1;this.Hu=P;this.Vg=uG.Vg;r&&(this.Htc=jp.a.tSb);this.Uh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.oan,null);this.eVc();this.pUe=document.getElementById("DialogMarginTopSpinner");this.G1(this.pUe)}V9(){this.WEd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",V.a.a3c,V.a.Mbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.WEd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",V.a.$2c,V.a.Jbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.WEd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",V.a.C9d,V.a.Kbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.WEd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",V.a.D9d,V.a.Lbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}eVc(){for(const b of oI)Object(Bm.a)(b,this.y9c,this.zPc);this.Hu.Rqa("DialogMarginTopSpinner");
this.Hu.Rqa("DialogMarginBottomSpinner");this.Hu.Rqa("DialogMarginLeftSpinner");this.Hu.Rqa("DialogMarginRightSpinner")}dispose(){for(const b of oI)Object(Bm.b)(b);this.Hu.iZ("DialogMarginTopSpinner");this.Hu.iZ("DialogMarginBottomSpinner");this.Hu.iZ("DialogMarginLeftSpinner");this.Hu.iZ("DialogMarginRightSpinner");super.dispose()}WEd(b,h,r,B,P){r=wA.COk(h,r,B,P);this.xBb(r,b,h)}xBb(b,h,r){h=document.getElementById(h);this.Hu.C_a(r,b);b=this.Hu.fGb(r,"Medium");h.appendChild(b)}static N$b(){return wA.lNa||
(wA.lNa=wA.e6b())}static e6b(){const b={};b[Oc.a.marginTop.id.toString()]=pr.man;b[Oc.a.marginBottom.id.toString()]=pr.ian;b[Oc.a.marginLeft.id.toString()]=pr.kan;b[Oc.a.marginRight.id.toString()]=pr.lan;return b}static COk(b,h,r,B){let P=!0;if(h===V.a.a3c||h===V.a.$2c)P=!1;return Gi.j(b,h,r,B,[wA.EOk(P),wA.DOk(P)])}static EOk(b){return Gi.l("inch",b?"0":"-22","22",".1")}static DOk(b){return Gi.l("centimeter",b?"0":"-55.8","55.8","1")}static b5c(b){let h=null;switch(b){case V.a.a3c:case V.a.Mbe:h=
Oc.a.marginTop;break;case V.a.$2c:case V.a.Jbe:h=Oc.a.marginBottom;break;case V.a.C9d:case V.a.Kbe:h=Oc.a.marginLeft;break;case V.a.D9d:case V.a.Lbe:h=Oc.a.marginRight}return h}}wA.lNa=null;Object(n.a)(wA,"MarginsDialog",Pf.a,[]);class vG{static get Vg(){return Pf.a.Nx(vG.Wm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}vG.Wm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(vG,"PaperSizeDialogHtml",null,[]);const pI=[V.a.G9d,V.a.F9d,V.a.ace,V.a.$be];class It extends Pf.a{constructor(b,h,r,B,P){super();this.zPc=(ca,ra)=>{var Qa=this.b5c(ca);ca=qe.App.Pia;this.Kp.hasProperty(Qa)?(Qa=this.Kp.getValue(Qa),ra[Gg.a.Number]=af.a.P9a(Qa,ca)):ra[Gg.a.Number]=0;ra[Gg.a.UnitType]=ca};this.y9c=(ca,ra)=>{this.Kp.setValue(this.b5c(ca),af.a.UJa(ra[Gg.a.Number],ra[Gg.a.UnitType]));this.Hu.Gm()};this.xAn=ca=>{let ra=!1;1===ca&&(this.Kp.getValue(Oc.a.uv)>=qe.App.GAa+this.xua.getValue(Oc.a.marginTop)+
this.xua.getValue(Oc.a.marginBottom)&&this.Kp.getValue(Oc.a.Ko)>=qe.App.GAa+this.xua.getValue(Oc.a.marginLeft)+this.xua.getValue(Oc.a.marginRight)?tG(this.OBa,this.Kp,It.N$b()):ra=!0);this.dispose();ra&&this.TIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.wAn)};this.wAn=()=>{Ya.a.instance.resolve("WordEditor.UI.IDialogFactory").HNh(this.OBa,this.xua,this.p7)};this.zg="PaperSizeDialog";this.xua=h.clone();this.OBa=b.clone();this.Kp=b.clone();this.p7=r;this.pW=!1;this.Hu=P;this.Vg=vG.Vg;
r&&(this.Htc=jp.a.tSb);this.Uh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.xAn,null);this.eVc();this.pUe=document.getElementById("DialogWidthSpinner");this.G1(this.pUe)}V9(){this.Bzh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",V.a.G9d,V.a.ace,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Bzh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",V.a.F9d,V.a.$be,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}eVc(){for(const b of pI)Object(Bm.a)(b,
this.y9c,this.zPc);this.Hu.Rqa("DialogWidthSpinner");this.Hu.Rqa("DialogHeightSpinner")}dispose(){for(const b of pI)Object(Bm.b)(b);this.Hu.iZ("DialogWidthSpinner");this.Hu.iZ("DialogHeightSpinner");super.dispose()}Bzh(b,h,r,B,P){r=It.TOk(h,r,B,P);this.xBb(r,b,h)}xBb(b,h,r){h=document.getElementById(h);this.Hu.C_a(r,b);b=this.Hu.fGb(r,"Medium");h.appendChild(b)}b5c(b){let h=null;switch(b){case V.a.F9d:case V.a.$be:h=Oc.a.uv;break;case V.a.G9d:case V.a.ace:h=Oc.a.Ko}return h}static N$b(){return It.lNa||
(It.lNa=It.e6b())}static e6b(){const b={};b[Oc.a.Ko.id.toString()]=pr.kAn;b[Oc.a.uv.id.toString()]=pr.Mzn;return b}static TOk(b,h,r,B){return Gi.j(b,h,r,B,[It.VOk(),It.UOk()])}static VOk(){return Gi.l("inch",It.Huj,It.z_m,It.SAo)}static UOk(){return Gi.l("centimeter",It.Huj,It.y_m,It.RAo)}}It.Huj="0";It.z_m="22";It.SAo=".1";It.RAo="1";It.y_m="55.8";It.lNa=null;Object(n.a)(It,"PaperSizeDialog",Pf.a,[]);const rM=RegExp("[{|}|;|\\\\]"),qI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
r=b.DO;let B;for(B=1;B<=r;B++){const P=h+B;if(!(b.iii(P)||b.PUd(P)||b.iii(P+"Char")||b.PUd(P+"Char")))break}return h+B};class rI extends Pf.a{constructor(b,h,r,B,P){var ca,ra,Qa,mb;super(!1,!1,!0);this.context=b;this.oc=h;this.W8=r;this.qc=B;this.hi=P;this.ENd=null;this.Q7i=(Jb,Yb)=>{if(this.ke.ov){if(0!==Jb){Jb="string"===typeof Yb.styleText?Yb.styleText:null;Yb=this.lbd;var fc=Jb;const Mc=E.a.lza(fc);let Wc=null;if(0===Mc.length)Wc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<fc.length)Wc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(rM.test(fc))Wc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Yb.agm(fc)||Yb.PUd(Mc))Wc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Yb=Wc)?(this.ENd=Yb,Yb=qI(this.lbd),Jb=this.eGb(Jb,Yb),this.ENd=null,this.pW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Q7i,Jb),this.pW=!0):(this.hide(),Yb=new Map,Yb.set("Source","ReactCreateNewStyleDialog"),Yb.set("Action","CreateStyle"),
xa.Health.instance.recordKpiUsage(Do.a.HAa,0,Do.a.zB,Yb),this.n_e(Jb)||(Jb=new Map,Jb.set("Source","ReactCreateNewStyleDialog"),Jb.set("Action","CreateStyle"),Jb=Object.assign(new sb.a,{extendedProperties:Jb}),xa.Health.instance.recordKpiFailure(Do.a.HAa,"CreateStyleFailed",!1,!0,Jb)))}else this.hide();this.ke.e6()}};this.zg="CreateNewStyleDialog";this.ke=b.view;(b=null===(mb=null===(Qa=null===(ra=null===(ca=this.ke)||void 0===ca?void 0:ca.mb)||void 0===ra?void 0:ra.ib)||void 0===Qa?void 0:Qa.lb)||
void 0===mb?void 0:mb.Pa)?(ca=b.node)?(this.pageContentNode=this.hi.uu(ca))?(this.lbd=(new au.WACStyleSet).p9h(this.pageContentNode),(this.dMb=this.W8.yOd(b))?(ca=this.dMb.ja(Pe.a.fontSize,22),16>ca?Rc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Rc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Rc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Rc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.R8f(this.dMb),this.pageContentNode&&this.dMb&&(this.Daa=!1,ca=qI(this.lbd),ca=this.eGb(ca,ca),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Q7i,ca))):Rc.b(592737758,3018,10,"_newStyleProperties is null.")):Rc.b(592737757,3018,10,"_pageContenNode is null."):Rc.b(592725466,3018,10,"node is null."):Rc.b(556917206,3018,10,"nodeContext is null.")}R8f(b){b.Cg(xe.a.Uv,xe.a.qw,...Do.a.Ica())}eGb(b,h){const r=52<=this.dMb.ja(Pe.a.fontSize,
wm.a.HM),B=Bj.a.gqf(this.dMb,"97%",26,!1,!0,r);B["padding-left"]="5px";r||(B["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>B};this.ENd&&(b.errorMessage=this.ENd);return{["id"]:this.zg,["bodyControls"]:b}}n_e(b){const h=new sg.GraphTransaction(15);h.Db(this.pageContentNode);h.Uj=Mb.a.vDb;
const r=um.a.n_e(b,um.a.Pfi(this.dMb),null,this.pageContentNode);r&&(Rc.b(593078046,3018,50,"User created linked style"),this.lbd=(new au.WACStyleSet).p9h(this.pageContentNode),b=E.a.lza(E.a.uY(b)),b=this.lbd.PUd(b),this.oc.Mf(this.context,Mb.a.LQ,2,!1,new hI.a,this.qc.Kg(b)));h.dispose();return r}}Object(n.a)(rI,"ReactCreateNewStyleDialog",Pf.a,[]);class tD extends Pf.a{constructor(b,h=!1,r){super(!1,!1,h);let B=h=this.AK=null;this.zg=tD.id;this.qh=b.view;this.Bn=r;this.qh&&(B=this.qh.mb);B&&B.ib&&
B.ib.lb&&(h=B.ib.lb.Pa);h?(b=h.node)?(this.JK=tD.hi.uu(b))||t.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):t.ULS.sendTraceTag(539762889,3029,10,"node is null"):t.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}O2o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.zNl();const B=""===E.a.lza(b),P=b.length>tD.zbn;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let ca=null;if(B||P||r||b||!h)ca=B?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
P?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}pJm(b,h){return b?b===h:!1}static get hi(){return ro.PageNavigator.instance}zNl(){const b=this.Bn.yQd(!1),h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Oc.a.At,"");h.push(B)}return h}}tD.id="BookmarkEditDialog";tD.zbn=40;Object(n.a)(tD,
"AEditBookmarkDialog",Pf.a,[]);class sI extends tD{constructor(b,h,r){super(b,!0,r);this.VAe=null;this.EXa="wwaengidc";this.lyc="ReactCreateEditBookmarkNameDialog";this.b4g="EditBookmarkName";this.wta="EditBookmarkNameDialog";this.Tue=h;this.Bn=r;this.JK&&(this.Daa=!1,b=this.eGb(h.properties.ja(Oc.a.At,null)),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.S7i.bind(this),b))}S7i(b,h){if(this.qh.ov){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.Tue.hasProperty(Oc.a.At)?
r=this.Tue.getValue(Oc.a.At):t.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.O2o(b);this.pJm(b,r)?(t.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.VAe=h,r=this.eGb(b),this.VAe=null,this.pW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.S7i.bind(this),r),this.pW=!0):(this.hide(),r=new Map,r.set("Source",this.lyc),r.set("Action",this.b4g),xa.Health.instance.recordKpiUsage(this.wta,
0,this.EXa,r),this.dVk(b)||(r=new Map,r.set("Source",this.lyc),r.set("Action",this.b4g),r=Object.assign(new sb.a,{extendedProperties:r}),xa.Health.instance.recordKpiFailure(this.wta,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.qh.e6()}}dVk(b){b=E.a.lza(E.a.uY(b));try{const h=this.Bn.WUo(this.Tue,b);if(h)t.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return t.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return t.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}eGb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.VAe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.zg,["bodyControls"]:h}}}Object(n.a)(sI,"ReactEditBookmarkNameDialog",tD,[]);var sM=c(414);const wG=(b,h,r)=>{const B=[];if(b.length!==h.length||r&&r.length!==h.length)return B;for(let P=0;P<b.length;P++){const ca=
{};ca.key=h[P];ca.text=b[P];ca.type="AppComboBoxItem";r&&(ca.ariaLabel=r[P]);B[P]=ca}return B},uC=(b,h,r,B,P)=>({["unitType"]:b,["unitPlaceholder"]:E.a.fae(h),["minValue"]:r,["maxValue"]:B,["step"]:P}),hH=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),tI=(b,h,r)=>{let B=!1;b.hasProperty(h)&&b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,B=!0):(b=b.getValue(h),h=2===r?
4:5)):(b=Number.NaN,h=qe.App.LGa?4:5);return{Amc:b,r9a:h,lcc:B}};class uI{constructor(){this.$uj=this.L0i=this.J0i=this.CAn=this.W_f=!1}}Object(n.a)(uI,"Box4PropertySetChangedState",null,[]);class Xm{static get Fbc(){return null!=Xm.NBg?Xm.NBg:Xm.NBg=Ya.a.instance.Oa("Box4.IIndentationCommands")}static get FFi(){return null!=Xm.fEg?Xm.fEg:Xm.fEg=Ya.a.instance.Oa("Box4.IJustificationCommands")}static get X5(){return null!=Xm.uHg?Xm.uHg:Xm.uHg=Ya.a.instance.Oa("Box4.ISpacingCommands")}static BZm(b,
h,r){Xm.FFi&&r&&(null===h||11!==r||10!==h&&9!==h)&&Xm.FFi.pE(r)}static K1m(b,h,r){Xm.X5&&r&&Xm.X5.lD(r)}static Q6k(b,h,r){h!=r&&Xm.X5.llc(r)}static MZm(b,h,r){h!=r&&Xm.X5.R9c(r)}static o5o(b,h,r){h!=r&&Xm.X5.s$c(r)}static KZm(b,h,r){h!=r&&Xm.X5.Q9c(r)}static Q0i(b,h,r,B){Xm.X5&&void 0!==r&&null!==r&&(b=Xm.RPc(B),!b.W_f&&B.XO.hasProperty(Zc.a.Vhc)&&B.XO.hasProperty(Zc.a.Whc)&&(h=B.XO.getValue(Zc.a.Whc),B=B.XO.getValue(Zc.a.Vhc),b.W_f=!0,Xm.X5.pea(1,h,B)))}static P0i(b,h,r,B){Xm.X5&&void 0!==r&&null!==
r&&(b=Xm.RPc(B),!b.CAn&&B.XO.hasProperty(Zc.a.Thc)&&B.XO.hasProperty(Zc.a.Uhc)&&(h=B.XO.getValue(Zc.a.Uhc),B=B.XO.getValue(Zc.a.Thc),b.W_f=!0,Xm.X5.pea(0,h,B)))}static I0i(b,h,r,B){Xm.Fbc&&void 0!==r&&null!==r&&(b=Xm.RPc(B),!b.J0i&&B.XO.hasProperty(Zc.a.$Ha)&&B.XO.hasProperty(Zc.a.aIa)&&(h=B.XO.getValue(Zc.a.aIa),B=B.XO.getValue(Zc.a.$Ha),b.J0i=!0,Xm.Fbc.rnj(1,h,B)))}static K0i(b,h,r,B){Xm.Fbc&&void 0!==r&&null!==r&&(b=Xm.RPc(B),!b.L0i&&B.XO.hasProperty(Zc.a.xob)&&B.XO.hasProperty(Zc.a.yob)&&(h=B.XO.getValue(Zc.a.yob),
B=B.XO.getValue(Zc.a.xob),b.L0i=!0,Xm.Fbc.rnj(0,h,B)))}static Xig(b,h,r,B){Xm.Fbc&&void 0!==r&&null!==r&&(b=Xm.RPc(B),!b.$uj&&B.XO.hasProperty(Zc.a.WUa)&&B.XO.hasProperty(Zc.a.XUa)&&(h=0,B.XO.hasProperty(Zc.a.Y5)&&(h=B.XO.getValue(Zc.a.Y5)),r=B.XO.getValue(Zc.a.XUa),B=B.XO.getValue(Zc.a.WUa),b.$uj=!0,Xm.Fbc.Uhe(h,r,B)))}static RPc(b){b.customData||(b.customData=new uI);return b.customData}}Object(n.a)(Xm,"ParagraphLevelPropertyChangedHandlers",null,[]);class uD{constructor(){this.lNa=null}q9l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=uC("Point",5,0,1584,1),B=uC("Line",4,0,327,1),P=[r,B];B=hH();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({Amc:Qa,r9a:ra,lcc:mb}=tI(b,Zc.a.Whc,Zc.a.Vhc));var ra={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:af.a.R0a(ra),["validUnits"]:P,["numberFormatInfo"]:B,["validReservedValues"]:ca};mb?ra.reservedValue=ca[0]:ra.value=isNaN(Qa)?"":Qa;h.beforeSpacingSpinButtonProps=ra;({Amc:Qa,r9a:ra,lcc:mb}=tI(b,Zc.a.Uhc,Zc.a.Thc));P={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:af.a.R0a(ra),["validUnits"]:P,["numberFormatInfo"]:B,["validReservedValues"]:ca};
mb?P.reservedValue=ca[0]:P.value=isNaN(Qa)?"":Qa;h.afterSpacingSpinButtonProps=P;if(ca=P=b.hasProperty(Zc.a.xa))ca=uD.v5a.GGb(b),ca=b.hasProperty(Zc.a.xa)&&b.hasProperty(Zc.a.w5a)&&2===b.getValue(Zc.a.w5a)?!Kd.a.Fxa(ca,1)&&!Kd.a.Fxa(ca,1.5)&&!Kd.a.Fxa(ca,2):!1;if(P){var Qa=uD.v5a.GGb(b);P=0;var mb=!1;b.hasProperty(Zc.a.xa)&&b.hasProperty(Zc.a.w5a)||(mb=!0);mb||(2!==b.getValue(Zc.a.w5a)&&(mb=!0),P=Qa,1>P&&(mb=!0));mb?P="":(Qa="multiple",ca||(Kd.a.Fxa(P,1)?Qa="1.00":Kd.a.Fxa(P,1.5)?Qa="1.50":Kd.a.Fxa(P,
2)&&(Qa="2.00")),P=Qa)}else P=null;Qa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:wG([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};P?Qa.selectedKey=P:Qa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Qa;P=0;Qa=!1;b.hasProperty(Zc.a.xa)&&b.hasProperty(Zc.a.w5a)&&2===b.getValue(Zc.a.w5a)&&ca&&(P=uD.v5a.GGb(b),Qa=!0,1>P&&(P=Number.NaN));b=[uC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:B,["validReservedValues"]:r};Qa?b.value=P:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}N$b(){return this.lNa||(this.lNa=this.e6b())}e6b(){const b={};b[Zc.a.xa.id.toString()]=Xm.K1m;b[Zc.a.Uhc.id.toString()]=Xm.P0i;b[Zc.a.Thc.id.toString()]=Xm.P0i;b[Zc.a.Whc.id.toString()]=Xm.Q0i;b[Zc.a.Vhc.id.toString()]=Xm.Q0i;return b}static get v5a(){return null!=uD.oEg?uD.oEg:uD.oEg=Ya.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(n.a)(uD,"ReactParagraphDialog",null,[]);const vI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,iH=(b,h,r,B)=>{let P=qe.App.Pia;b.hasProperty(h)&&b.hasProperty(r)&&!B?(h=b.getValue(h),b=b.getValue(r),h?2===b?P=2:h=af.a.P9a(h,P):qe.App.LGa&&(P=2)):(h=Number.NaN,qe.App.LGa&&(P=2));return{Amc:h,r9a:P}},tM=b=>{let h="0";b.hasProperty(Zc.a.Y5)&&(b=b.getValue(Zc.a.Y5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},wI=(b,h)=>{if(h.hasProperty(Zc.a.Y5)&&2===h.getValue(Zc.a.Y5)&&h.hasProperty(Zc.a.XUa)&&h.hasProperty(Zc.a.WUa)&&
b.hasProperty(Zc.a.aIa)&&b.hasProperty(Zc.a.$Ha)){var r=b.getValue(Zc.a.aIa),B=b.getValue(Zc.a.$Ha);r=(new js.a(B,r)).Xt;B=h.getValue(Zc.a.XUa);h=h.getValue(Zc.a.WUa);h=(new js.a(h,B)).Xt;b.setValue(Zc.a.aIa,r+h);b.setValue(Zc.a.$Ha,1)}},xI=b=>{const h=b.getValue(Zc.a.aIa);b=b.getValue(Zc.a.$Ha);return(new js.a(b,h)).Xt},yI=b=>{const h=b.getValue(Zc.a.yob);b=b.getValue(Zc.a.xob);return(new js.a(b,h)).Xt},zI=(b,h)=>h.hasProperty(Zc.a.aIa)&&h.hasProperty(Zc.a.$Ha)&&h.hasProperty(Zc.a.yob)&&h.hasProperty(Zc.a.xob)&&
b.hasProperty(Oc.a.marginLeft)&&b.hasProperty(Oc.a.marginRight)&&b.hasProperty(Oc.a.Ko),uM=b=>b.hasProperty(Zc.a.E3c)?b.getValue(Zc.a.E3c):!1,vM=b=>b.hasProperty(Nd.a.keepWithNext)?b.getValue(Nd.a.keepWithNext):!1,wM=b=>b.hasProperty(Nd.a.widowControl)?b.getValue(Nd.a.widowControl):!1,xM=b=>b.hasProperty(Nd.a.keepTogether)?b.getValue(Nd.a.keepTogether):!1;class AI extends Pf.a{constructor(b,h,r,B){super(!1,!1,!0);this.Rmh=null;this.KAn=()=>{Ya.a.instance.resolve("Box4.UI.IBox4DialogFactory").PJd(this.OBa,
this.xua,this.p7)};this.MAn=(mb,Jb)=>{if(Jb&&(1===mb||2===mb)){if(Jb.alignmentComboBoxProps){var Yb=parseInt(Jb.alignmentComboBoxProps.selectedKey);isNaN(Yb)||vI(Yb)&&this.Kp.setValue(Zc.a.zw,Yb)}var fc=Jb.bySpinButtonProps;Yb=!!fc&&""!==fc.value;var Mc=Jb.didChangeSpecialIndentationComboBoxValue;if(Jb.specialIndentationComboBoxProps){var Wc=parseInt(Jb.specialIndentationComboBoxProps.selectedKey);1!==Wc&&2!==Wc&&Wc||!(Wc||Mc||Yb)||this.Kp.setValue(Zc.a.Y5,Wc)}if(fc){Wc=fc.value;fc=af.a.$Oa(fc.unitType.toLowerCase());
let id;0<=Wc||(Wc=0);2===fc?id=2:(id=1,Wc=af.a.UJa(Wc,fc));if(Yb||Mc)this.Kp.setValue(Zc.a.XUa,Wc),this.Kp.setValue(Zc.a.WUa,id)}Jb.beforeTextSpinButtonProps&&(Mc=Jb.beforeTextSpinButtonProps,Yb=af.a.$Oa(Mc.unitType.toLowerCase()),Mc=""===Mc.value?Number.NaN:Mc.value,isNaN(Mc)||(Wc=Mc,2===Yb?fc=2:(fc=1,Wc=af.a.UJa(Mc,Yb)),this.Kp.setValue(Zc.a.aIa,Wc),this.Kp.setValue(Zc.a.$Ha,fc)));Jb.afterTextSpinButtonProps&&(Mc=Jb.afterTextSpinButtonProps,Yb=af.a.$Oa(Mc.unitType.toLowerCase()),Mc=""===Mc.value?
Number.NaN:Mc.value,isNaN(Mc)||(Wc=Mc,2===Yb?fc=2:(fc=1,Wc=af.a.UJa(Mc,Yb)),this.Kp.setValue(Zc.a.yob,Wc),this.Kp.setValue(Zc.a.xob,fc)));Jb.beforeSpacingSpinButtonProps&&(Yb=Jb.beforeSpacingSpinButtonProps,Mc=af.a.$Oa(Yb.unitType.toLowerCase()),Wc=Yb.reservedValue,""!==Yb.value&&(Wc===Box4Intl.Box4Strings.L_SpinnerAuto?(Mc=1,Yb=0):(Mc=4===Mc?2:4,Yb=Yb.value),this.Kp.setValue(Zc.a.Whc,Yb),this.Kp.setValue(Zc.a.Vhc,Mc)));Jb.afterSpacingSpinButtonProps&&(Yb=Jb.afterSpacingSpinButtonProps,Mc=af.a.$Oa(Yb.unitType.toLowerCase()),
Wc=Yb.reservedValue,""!==Yb.value&&(Wc===Box4Intl.Box4Strings.L_SpinnerAuto?(Mc=1,Yb=0):(Mc=4===Mc?2:4,Yb=Yb.value),this.Kp.setValue(Zc.a.Uhc,Yb),this.Kp.setValue(Zc.a.Thc,Mc)));if(Jb.atSpinButtonProps||Jb.lineSpacingComboBoxProps)if(Yb=Jb.atSpinButtonProps.value,1<Yb)this.Kp.setValue(Zc.a.xa,Yb),this.Kp.setValue(Zc.a.w5a,2);else if(Yb=Jb.lineSpacingComboBoxProps.selectedKey)Yb="1.00"===Yb?1:"1.50"===Yb?1.5:"2.00"===Yb?2:0,Yb=1<=Yb?Yb:1,this.Kp.setValue(Zc.a.xa,Yb),this.Kp.setValue(Zc.a.w5a,2);Jb.contextualSpacingCheckboxProps&&
this.Kp.setValue(Zc.a.E3c,Jb.contextualSpacingCheckboxProps.checked);Jb.keepWithNextCheckboxProps&&this.Kp.setValue(Nd.a.keepWithNext,Jb.keepWithNextCheckboxProps.checked);Jb.widowOrphanCheckboxProps&&this.Kp.setValue(Nd.a.widowControl,Jb.widowOrphanCheckboxProps.checked);Jb.keepTogetherCheckboxProps&&this.Kp.setValue(Nd.a.keepTogether,Jb.keepTogetherCheckboxProps.checked);wI(this.OBa,this.OBa);wI(this.Kp,this.OBa);Jb="";Yb=this.xua;Mc=this.Kp;if(Wc=zI(Yb,Mc))Wc=Mc.hasProperty(Zc.a.XUa)&&Mc.hasProperty(Zc.a.WUa);
Wc?(Wc=Mc.getValue(Zc.a.XUa),fc=Mc.getValue(Zc.a.WUa),Wc=(new js.a(fc,Wc)).Xt,Yb=xI(Mc)+yI(Mc)+Yb.getValue(Oc.a.marginRight)+Yb.getValue(Oc.a.marginLeft)+Wc+qe.App.GAa<=Yb.getValue(Oc.a.Ko)):Yb=zI(Yb,Mc)?xI(Mc)+yI(Mc)+Yb.getValue(Oc.a.marginRight)+Yb.getValue(Oc.a.marginLeft)+qe.App.GAa<=Yb.getValue(Oc.a.Ko):!0;Yb?tG(this.OBa,this.Kp,this.Plm(this.TSe?this.TSe.e6b():{})):Jb=""!==Jb?Jb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Jb?this.TIa(Jb,this.KAn):2===mb&&(ne.c(V.a.emc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(V.a.emc,2,null))}};this.OBa=b.clone();this.Kp=b.clone();this.xua=h.clone();this.p7=r;this.ga=B;this.TSe=new uD;b=this.TSe.q9l(this.Kp);h=uC("Inch",3,-11,22,.1);r=uC("Inch",3,0,22,.1);var P=uC("Centimeter",1,-27.94,55.88,1);B=uC("Centimeter",1,0,55.88,1);var ca=uC("Character",2,-316.8,316.8,.5),ra=uC("Character",2,0,316.8,.5);h=[h,P,ca];B=[r,B,ra];r=hH();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};P=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ca=["1","2","3","6","7"];let Qa=5;ra=this.Kp.hasProperty(Zc.a.zw)?this.Kp.getValue(Zc.a.zw):0;if(10===ra||9===ra)ra=11;if(v.AFrameworkApplication.lcid===Hi.a.ug("AR-SA").LCID||11===ra)b.isKashidaSupported=!0,P[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ca[Qa]="11",Qa=6;if(v.AFrameworkApplication.lcid===Hi.a.ug("TH-TH").LCID||13===ra)b.isThaiSupported=!0,P[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ca[Qa]="13";P={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:wG(P,ca),["allowFreeForm"]:!1};vI(ra)?P.selectedKey=ra.toString():P.defaultSelectedKey="";b.alignmentComboBoxProps=
P;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:vM(this.Kp)};b.keepWithNextCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:wM(this.Kp)};
b.widowOrphanCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:xM(this.Kp)};b.keepTogetherCheckboxProps=ra;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};P=tM(this.Kp);ra="0"===P;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:wG([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:P,["allowFreeForm"]:!1};ca=qe.App.Pia;P=0;({Amc:P,r9a:ca}=iH(this.Kp,Zc.a.XUa,Zc.a.WUa,ra));B={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:af.a.R0a(ca),["validUnits"]:B,["numberFormatInfo"]:r};B=this.OQb(P,B);b.bySpinButtonProps=B;ra=qe.App.Pia;B=0;({Amc:B,r9a:ra}=iH(this.Kp,Zc.a.aIa,Zc.a.$Ha,!1));ra={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:af.a.R0a(ra),["validUnits"]:h,["numberFormatInfo"]:r};
ra=this.OQb(B,ra);b.beforeTextSpinButtonProps=ra;ra=qe.App.Pia;B=0;({Amc:B,r9a:ra}=iH(this.Kp,Zc.a.yob,Zc.a.xob,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:af.a.R0a(ra),["validUnits"]:h,["numberFormatInfo"]:r};h=this.OQb(B,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:uM(this.Kp)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=sM.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.Uh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.MAn,h)}Plm(b){return this.Rmh||(this.Rmh=this.Lcf(b))}Lcf(b){b[Zc.a.zw.id.toString()]=Xm.BZm;b[Zc.a.$Ha.id.toString()]=Xm.I0i;b[Zc.a.aIa.id.toString()]=Xm.I0i;b[Zc.a.xob.id.toString()]=Xm.K0i;b[Zc.a.yob.id.toString()]=Xm.K0i;b[Zc.a.Y5.id.toString()]=Xm.Xig;b[Zc.a.WUa.id.toString()]=Xm.Xig;b[Zc.a.XUa.id.toString()]=Xm.Xig;b[Zc.a.E3c.id.toString()]=Xm.Q6k;b[Nd.a.keepWithNext.id.toString()]=Xm.MZm;b[Nd.a.widowControl.id.toString()]=
Xm.o5o;b[Nd.a.keepTogether.id.toString()]=Xm.KZm;return b}OQb(b,h){h.value=isNaN(b)?"":b;return h}}Object(n.a)(AI,"WordReactParagraphDialog",Pf.a,[]);class Zw extends Pf.a{constructor(b,h,r,B){super(!1,!1,!0);this.x1k=()=>{this.bMc.TLh(this.Yri,this.wpe,this.RYc)};this.y1k=(P,ca)=>{ca&&1===P&&(ca.columnsCountSpinButtonProps&&this.MY.setValue(Nd.a.aF,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(P=ca.columnsWidthSpinButtonProps,this.MY.setValue(Nd.a.uG,[af.a.UJa(P.value,af.a.$Oa(P.unitType.toLowerCase()))])),
ca.columnsSpacingSpinButtonProps&&(P=ca.columnsSpacingSpinButtonProps,this.MY.setValue(Nd.a.zna,af.a.UJa(P.value,af.a.$Oa(P.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.MY.setValue(Nd.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.B1k()&&(ca=Zw.BEd,this.zHk()?tG(this.Yri,this.MY,this.N$b):ca=ca!==Zw.BEd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==Zw.BEd&&this.TIa(ca,this.x1k)))};this.B1k=()=>this.MY.hasProperty(Nd.a.aF)&&this.MY.hasProperty(Nd.a.uG)&&
this.MY.hasProperty(Nd.a.zna)&&this.MY.hasProperty(Nd.a.separator);this.PQd=(P,ca,ra)=>Math.floor((P-(ca-1)*ra)/ca);this.fpf=(P,ca,ra)=>1==ca?0:Math.floor((P-ca*ra)/(ca-1));this.lBk=(P,ca,ra,Qa)=>{const mb=P/ca;ra<Zw.zmc?(ra=Zw.zmc,Qa=this.fpf(P,ca,ra)):ra>mb&&(ra=mb,Qa=this.fpf(P,ca,ra));return[ra,Qa]};this.hBk=(P,ca,ra,Qa)=>{const mb=(P-Zw.zmc*ca)/(ca-1);0>Qa?(Qa=0,ra=this.PQd(P,ca,Qa)):Qa>mb&&(Qa=mb,ra=this.PQd(P,ca,Qa));return[ra,Qa]};this.UJa=(P,ca)=>af.a.UJa(P,af.a.$Oa(ca));this.fLc=(P,ca,ra,
Qa,mb)=>({["unitType"]:P,["unitPlaceholder"]:E.a.fae(ca),["minValue"]:ra,["maxValue"]:Qa,["step"]:mb});this.Yri=b.clone();this.MY=b.clone();this.wpe=h.clone();this.tob=this.wpe.getValue(Oc.a.Ko)-this.wpe.getValue(Oc.a.marginLeft)-this.wpe.getValue(Oc.a.marginRight);this.ILb=Math.floor(this.tob/Zw.zmc);this.RYc=r;this.bMc=B;this.zg=Zw.id;b={};b.getUnitValue=3==qe.App.Pia?af.a.Yz:af.a.IVa;b.getCalculatedWidthValue=this.PQd;b.getCalculatedSpacingValue=this.fpf;b.twipsFromValueAndUnits=this.UJa;b.adjustWidthForLimits=
this.lBk;b.adjustSpacingForLimits=this.hBk;b.pageContentWidth=this.tob;b.maxColumnCount=this.ILb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.vSl();b.columnsWidthSpinButtonProps=this.zSl();b.columnsSpacingSpinButtonProps=this.xSl();b.columnsLineBetweenCheckboxProps=this.wSl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Uh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,
this.y1k.bind(this),b)}vSl(){var b=[this.fLc("None",0,1,this.ILb,1)];const h=this.fvf(Nd.a.aF);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:af.a.R0a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};
return b=this.OQb(h,b)}zSl(){var b=[this.fLc("Inch",3,.5,af.a.Yz(this.tob),.1),this.fLc("Centimeter",1,1.27,af.a.IVa(this.tob),1)];const h=qe.App.Pia,r=this.fvf(Nd.a.uG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:af.a.R0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.OQb(r,b)}xSl(){var b=[this.fLc("Inch",3,0,af.a.Yz(this.tob-2*Zw.zmc),.1),this.fLc("Centimeter",1,0,af.a.IVa(this.tob-2*Zw.zmc),1)];const h=qe.App.Pia,r=this.fvf(Nd.a.zna);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:af.a.R0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.OQb(r,b)}wSl(){const b=this.MY.getValue(Nd.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get N$b(){return null!=this.gBg?this.gBg:this.gBg=(()=>this.Lcf())()}Lcf(){const b=
{};b[Nd.a.aF.id.toString()]=b[Nd.a.uG.id.toString()]=b[Nd.a.zna.id.toString()]=b[Nd.a.separator.id.toString()]=pr.A1k;return b}zHk(){const b=this.MY.getValue(Nd.a.uG),h=this.MY.getValue(Nd.a.aF),r=this.MY.getValue(Nd.a.zna);let B=0;for(let P=0;P<h;P++)B+=b[0];if(h<=this.ILb&&(h-1)*r+B<=this.tob)return!0;t.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}fvf(b){if(this.MY.hasProperty(b)){if(b==
Nd.a.aF)return this.MY.getValue(b);if(b==Nd.a.uG){var h=qe.App.Pia;b=this.MY.getValue(Nd.a.zna);const r=this.MY.getValue(Nd.a.aF);return af.a.P9a(this.PQd(this.tob,r,b),h)}if(b==Nd.a.zna){if(1==this.MY.getValue(Nd.a.aF))return 0;h=qe.App.Pia;b=this.MY.getValue(b);return af.a.P9a(b,h)}}return 0}OQb(b,h){h.value=isNaN(b)?Zw.BEd:b;return h}}Zw.id="ColumnsDialog";Zw.BEd="";Zw.zmc=720;Object(n.a)(Zw,"WordReactColumnsDialog",Pf.a,[]);class BI{$9k(b){new NE(b,Ya.a.instance.resolve("Box4.IFeatureHelper"))}edl(b,
h){new rI(b,h,Ya.a.instance.resolve("Box4.IFormattingReader"),Ya.a.instance.resolve("Box4.Styles.IWACStyleReader"),ro.PageNavigator.instance)}hul(b,h,r){new sI(b,h,r)}cNh(b,h,r){new wA(b,h,r,Ya.a.instance.resolve("WordEditor.IPageCommands"),Ya.a.instance.resolve("Common.IStandaloneRootController").sea)}HNh(b,h,r){new It(b,h,r,Ya.a.instance.resolve("WordEditor.IPageCommands"),Ya.a.instance.resolve("Common.IStandaloneRootController").sea)}TLh(b,h,r){new Zw(b,h,r,Ya.a.instance.resolve("WordEditor.UI.IDialogFactory"))}t9k(b){return new $D(b)}PJd(b,
h,r){new AI(b,h,r,v.AFrameworkApplication.va)}Jll(){const b=Ya.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Rc.b(524834398,3018,10,"Roaming service not resolved."):new iI(b)}Oll(b,h){new jI(b,h)}Wef(b){return new kI(b)}}Object(n.a)(BI,"DialogFactory",null,[594,595]);class NF extends Pf.a{constructor(b,h){super(!1,!1,!0);this.sUh="DoNotCheckSpellingCheckbox";this.HUh="DocumentChoiceGroup";this.Kjd=0;this.WFi="LanguageList";this.documentContext="DocumentContext";this.ir="RangeContext";
this.Wko=(r,B)=>{const P=Ih.a.instance.Fp(Mb.a.Kmj);if(1!==r)P.properties.Z("canceled","true");else{r=B[this.WFi].replace(NF.gvg,"");var ca=parseInt(r),ra=Boolean.parse(B[this.sUh]);B=B[this.HUh];B===this.documentContext?this.yqd.Lio(ca,ra):this.yqd.boo(ca,ra);P.properties.Z("PreviousLCID",this.Kjd.toString());P.properties.Z("ChangedLCID",ca.toString());P.properties.Z("NoProof",ra.toString());this.f4g.Vko(ca,this.Kjd);ne.d(Mb.a.Kmj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"SelectedLcid",
string:r}),Object.assign(new ma.a,{name:"NoProof",string:ra.toString()}),Object.assign(new ma.a,{name:"Context",string:B})]);ab.StaticActiveAppFrame.za().updateCommandUI(!0)}P.end()};this.f4g=h;this.yqd=b}Mhg(){const b=Array(2);b[0]={["key"]:this.ir,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.HUh,["defaultSelectedKey"]:this.OVl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.Kjd=({eLn:this.q0j}=this.yqd.Mdm()).returnValue;h.languageListPropsProvider=this.I2l();h.spellingCheckboxProps={["id"]:this.sUh,["checked"]:!this.q0j,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Uh(Box4Intl.Box4Strings.l_Language,this.Wko,{["id"]:"LanguageDialog",["bodyControls"]:h})}OVl(){return this.yqd.Ze()?this.documentContext:
this.ir}I2l(){return()=>{let b,h;const r=({selectedIndex:b,vvj:h}=this.f4g.H2l(this.Kjd)).returnValue;for(let B=0;B<r.length&&B<h;B++)r[B].value=NF.gvg+r[B].value;return{["id"]:this.WFi,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}NF.gvg="recent-";Object(n.a)(NF,"ReactLanguageDialog",Pf.a,[596]);class CI extends ZC{constructor(b,h,r,B){super(h,r);this.H1f=()=>{this.floatie.Gm()};this.Mh=b;this.KI=B}xgb(b,h,r){if(b=super.xgb(b,h,r))b.Iic=!0,b.Pae=!0,b.preventDismissOnScroll=!0;
this.Mh.I_a(this.H1f);return b}$Uc(b,h,r=null){this.KI.zxh(()=>this.xgb(b,h,r))}G7d(){this.floatie.Iic=!0}}Object(n.a)(CI,"ExternalContentFloatieInitializer",ZC,[]);class DI{HNb(){Cl.instance.Mpa&&(Pp.instance.C9a([1,0]),Cl.instance.U1d()&&us.instance.C9a([1]))}}Object(n.a)(DI,"RulerUser",null,[593]);class EI{constructor(){this.whitelistedControlIds=null}}Object(n.a)(EI,"StatusBarProps",null,[]);class OF{constructor(b,h,r=!0){this.sa=new wd.a;this.kvd=!1;this.aQe=null;this.lga=h.lH;this.sUe=h.qwj;
r?Qk.a.get_instance().pk(7,()=>{this.Ezh(b,h)}):this.Ezh(b,h)}Ezh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();Zq.a.instance.ie(()=>{Ik.UISurfaces.Mfm().then(B=>{r.StatusBarApiResolutionTime=Date.now();const P=Object.assign(new EI,{whitelistedControlIds:h.whitelistedControlIds});B.initializeNewStatusBar(b,P,this.sUe);this.aQe=B;this.kvd=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=
Date.now();Zq.a.instance.ie(()=>{const ca=[];if(h.iH){const ra=h.iH;for(let Qa in ra)ca.push(appChrome.actions.updateControlHiddenState(Qa,ra[Qa]));appChrome.api.dispatch(ca)}r.PollingStartTime=Date.now();this.HNb();r.PollingEndTime=Date.now();t.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.tPn();return null}).catch(()=>{t.ULS.sendTraceTag(51656736,
324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Jra&&b){OF.zYg||(v.AFrameworkApplication.va.qa(eb.a.swj,Gd.a.frame,Object(z.a)(this,this.twj,"statusBarTabAction")),v.AFrameworkApplication.va.qa(eb.a.rwj,Gd.a.frame,Object(z.a)(this,this.twj,"statusBarTabAction")),OF.zYg=!0);const B=jp.a.$Xd(h.Jra,h.Zlj,b,!1);B.fI=!0;this.ojc(B,eb.a.swj,eb.a.rwj)}},0)}HNb(){this.kvd&&this.lga&&window.setTimeout(()=>{this.lga(this.aQe.selectors.getStatusBarControlsMap(this.sUe),7)},0)}Zpb(b,
h){this.kvd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}pV(b){this.kvd&&this.lga&&window.setTimeout(()=>{const h=this.aQe.selectors.getStatusBarControlsMap(this.sUe);if(h[b]){const r={};r[b]=h[b];this.lga(r,7)}},0)}ojc(b,h,r){const B=Tb.KeyInputManager.ic(kc.a.Kw,0),P=Tb.KeyInputManager.ic(kc.a.Kw,4);b.mr(B);b.mr(P);b.bindAction(B,h);b.bindAction(P,r)}twj(){return 4}tPn(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}
OF.zYg=!1;Object(n.a)(OF,"ReactStatusBar",null,[]);class FI{constructor(){this.whitelistedControlIds=this.iH=this.lH=null;this.nYm=!1;this.Zlj=this.Jra=this.qwj=null}}Object(n.a)(FI,"ReactStatusBarInitOptions",null,[]);var aE=c(448);class GI{constructor(b,h,r,B,P){this.x_b=this.mNa=this.Ca=null;this.xEo=()=>{const ca=ab.StaticActiveAppFrame.za().Hp.getRegion(xk.AppFrame.Jra);ca&&ca.LQf()};this.Nrm=(ca,ra,Qa,mb,Jb)=>{if(!Jb)return t.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Qa)return 32;Jb&&2===Jb.length&&this.mNa&&this.mNa.Zpb(Jb[0],Jb[0]);return 32};this.bed=ca=>{ab.StaticActiveAppFrame.za().lH(ca)};this.ga=B;Zq.a.instance.ie(()=>{this.Ca=P;this.x_b=this.mNa=null;const ca={};v.AFrameworkApplication.ytj||(ca[aE.a.M$n]=!0);ca.GiveFeedback=!v.AFrameworkApplication.LF;this.Ca.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[aE.a.g0i]=!0;this.Ca.$("WPMPackageIsEnabled")&&this.Ca.$("WPMStatusBarLabelIsEnabled")||(ca[aE.a.ftg]=!0);this.Ca.$("AddInCommandsIsEnabled")||
(ca[aE.a.Ftk]=!0);this.Ca.$("WordEditorShowOcsConnectionStatus")||(ca[aE.a.dVf]=!0);ca[aE.a.V5o]=!0;this.Ca.$("ReadingTimeIsEnabled")||(ca[aE.a.f8i]=!0);window.setTimeout(()=>{this.uCm(b,ca)},0)},"SBU:I")}Ub(){this.ga.fb(Mb.a.Fke,zc.a.application,this.Nrm,96)}uCm(b,h){this.x_b=Ya.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(const P in h){var B=h[P];r[this.kuf(P)]=B}this.mNa=new OF(b,Object.assign(new FI,{iH:r,lH:this.bed,nYm:!1,qwj:"WordEditorStatusBar",Jra:xk.AppFrame.Jra,
Zlj:this.xEo}))}kuf(b){let h="";if(this.x_b){const r=this.x_b.Wqf(b);r&&0<r.count&&(h=r.J(0))}return h&&""!==h?h:b}HNb(){this.mNa&&this.mNa.HNb()}Zpb(b,h){this.mNa&&this.mNa.Zpb(this.kuf(b),h)}pV(b){this.mNa&&this.mNa.pV(this.kuf(b))}dispose(){}}Object(n.a)(GI,"StatusBarUser",null,[592,10]);var HI=c(1085);class jH{constructor(b){this.ga=b;this.ga.qa(eb.a.G7c,Gd.a.frame,Object(z.a)(this,this.G7c,"reportFileMenuPageSwitch"));this.ga.qa(eb.a.Hdj,Gd.a.frame,nd.ActionManager.Nf)}G7c(b,h,r,B,P){this.ga.processAction(this.uYl(P[HI.a.e$d]),
2);return 32}}Object(n.a)(jH,"FileMenuSQMInformation",null,[1127]);class II extends jH{constructor(b){super(b);this.kWn()}kWn(){this.ga.qa(eb.a.a$f,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Bdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.b$f,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Cdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Ddj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.c$f,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Edj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Fdj,
Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Gdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.gej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.hej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Kdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Ldj,Gd.a.frame,nd.ActionManager.Nf)}uYl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return eb.a.a$f;case "tabHome":case "FileHomePage":return v.AFrameworkApplication.se("1ba3i132;45gid285"),eb.a.Bdj;case "menuJewelInfo":case "FileInfoPage":return eb.a.b$f;
case "menuJewelNew":case "FileNewPage":return eb.a.Cdj;case "menuJewelOpen":case "FileOpenPage":return eb.a.Ddj;case "menuJewelPrint":case "FilePrintPage":return eb.a.c$f;case "menuJewelSaveAs":case "FileSaveAsPage":return eb.a.Edj;case "menuJewelShare":case "FileSharePage":return eb.a.Fdj;case "menuJewelTransform":case "FileTransformPage":return eb.a.Gdj}return eb.a.Hdj}}Object(n.a)(II,"WordEditorFileMenuSQMInformation",jH,[]);var JI=c(1083);class kH{constructor(b){this.ga=b;this.ga.qa(eb.a.H7c,
Gd.a.frame,Object(z.a)(this,this.H7c,"reportTabSwitch"));this.ga.qa(eb.a.bej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.dej,Gd.a.frame,nd.ActionManager.Nf)}H7c(b,h,r,B,P){this.ga.processAction(this.Gcm(P[JI.a.clg]),2);return 32}}Object(n.a)(kH,"RibbonSQMInformation",null,[1080]);class KI extends kH{constructor(b){super(b);this.CYn()}CYn(){this.ga.qa(eb.a.Tdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Vdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.e$f,Gd.a.frame,nd.ActionManager.Nf);
this.ga.qa(eb.a.Wdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.Xdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.Ydj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.Zdj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.$dj,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.aej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.f$f,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.cej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(eb.a.eej,Gd.a.frame,nd.ActionManager.Nf);this.ga.qa(V.a.fej,Gd.a.frame,nd.ActionManager.Nf);
this.ga.qa(V.a.Udj,Gd.a.frame,nd.ActionManager.Nf)}Gcm(b){switch(b){case "tabAddins":case "Addins":return eb.a.Tdj;case "tabHome":case "Home":return eb.a.Wdj;case "tabInsert":case "Insert":return eb.a.Xdj;case "tabDeveloper":case "Developer":return eb.a.Vdj;case "tabPageLayout":case "Layout":return V.a.Ydj;case "tabReferences":case "References":return V.a.aej;case "tabReview":case "Review":return V.a.f$f;case "tabView":case "View":return eb.a.eej;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return V.a.cej;
case "tabMailings":case "Mailings":return V.a.Zdj;case "tabWordDesign":case "Design":return V.a.fej;case "tabHelp":case "Help":return V.a.e$f;case "ctabPictureTools":case "Picture":return V.a.$dj;case "Copilot":return V.a.Udj}return eb.a.dej}}Object(n.a)(KI,"WordEditorRibbonSQMInformation",kH,[]);class LI{constructor(b=null,h=null,r=null){this.iH=b||{};this.rCj=h||[];this.vCj=r||{}}}Object(n.a)(LI,"RibbonTrimmingProperties",null,[]);class MI{constructor(b,h,r){this.Rva=b;this.iH=h;this.GJf=r}}Object(n.a)(MI,
"ReactRibbonJewelProperties",null,[]);class NI{constructor(){v.AFrameworkApplication.va.qa(eb.a.nSa,Gd.a.frame,Object(z.a)(this,this.rQn,"reactFileMenuOpenFromTellMe"))}rQn(b,h,r,B,P){if(1===r)return 32;v.AFrameworkApplication.Ria("54hi9858;4f638686");if(!P)return 32;b=P.SourceControlId;17!==P.UILocation||"New"!==b&&"Open"!==b||(P=[],rh.d("setFileMenuSelectedPage")&&("New"===b&&v.AFrameworkApplication.ta?2===v.AFrameworkApplication.ta.Kb.xk?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
P.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&v.AFrameworkApplication.ta&&(2===v.AFrameworkApplication.ta.Kb.xk?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),P.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(P));return 32}MGi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}OTa(){return!1}W2i(){}bUh(){}}Object(n.a)(NI,"ReactFileMenu",
null,[389]);class OI{tbf(){const b=new NI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(n.a)(OI,"ReactFileMenuFactory",null,[356]);class PE{constructor(b,h,r,B=!1){this.Knc=b;this.L1g=this.Knc.C4a;this.P6d=Ya.a.instance.Oa("Common.IOfficeTrialExperience");this.zLb=Ya.a.instance.Oa("Common.IMacOfficeOffer");PE.Bve=!1;this.NSm=B;this.ga=h;this.Vb=r}get oc(){return this.ga}get focusManager(){return this.Vb}j3e(){return this.L1g&&
!!this.P6d&&!!this.zLb}eWa(b,h){this.Knc.Nn(()=>{t.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.L1g=!0;this.Vjf(b,h)});Ya.a.instance.Sa("Common.IOfficeTrialExperience").execute(r=>{t.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.P6d=r;this.Vjf(b,h)});Ya.a.instance.Sa("Common.IMacOfficeOffer").execute(r=>{t.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.zLb=r;this.Vjf(b,h)})}Vjf(b,h){PE.Bve||(this.j3e()?(t.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),PE.Bve=!0):t.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}PE.Bve=!1;Object(n.a)(PE,"RibbonDependencies",null,[254]);class lH{constructor(b,h,r){this.vvb=b;this.ga=h;this.Vb=r}}Object(n.a)(lH,"WoncaRibbonUserFactory",null,[211]);class PI{constructor(b,h){this.Rwe=b;this.d2b=h}sqb(b){this.Rwe.sqb(b);this.d2b&&this.d2b.sqb(b)}P9c(b){this.Rwe.P9c(b);this.d2b&&this.d2b.P9c(b)}eed(b){this.Rwe.eed(b);this.d2b&&this.d2b.eed(b)}}
Object(n.a)(PI,"RibbonCommandTrimmer",null,[212]);var yM=c(1257),zM=c(1174);class QI{constructor(b,h){this.Ca=b;this.L_b=h}sqb(b){ba.a.vi&&6>ba.a.K3a&&(b.fseaInsertPicture=!0);this.Ca.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ca.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ca.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);kF.a.WAi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ca.$("InsertOnlinePictureEnabled"),r=v.AFrameworkApplication.fGf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;v.AFrameworkApplication.gGf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);v.AFrameworkApplication.uoc&&(b.btnOpenInClient=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")&&
this.voc(b)}P9c(b){b.menuJewel=!0;v.AFrameworkApplication.LF||(b.jbtnGiveFeedback=!0)}voc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}eed(b){delete b.menuJewel;v.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);v.AFrameworkApplication.E7c||(b.jbtnReportAbuse=!0);v.AFrameworkApplication.ame||(b.jbtnTermsOfUse=!0);v.AFrameworkApplication.FOd||(b.jbtnFileSharing=
!0);v.AFrameworkApplication.rpb||(b.jbtnShareRWC=!0);v.AFrameworkApplication.clf||v.AFrameworkApplication.drg||(b.jbtnVersion=!0);this.L_b.P6d&&this.L_b.P6d.ykn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.L_b.zLb&&this.L_b.zLb.Vto||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);v.AFrameworkApplication.uoc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[qe.App.Fs?"btnjOpenInClient":"btnjEditInClient"]=!0;v.AFrameworkApplication.iPo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?this.voc(b):v.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;v.AFrameworkApplication.DF&&(this.voc(b),b.faShare=!0);if(v.AFrameworkApplication.eZ||ba.a.ZRa||!v.AFrameworkApplication.WTc&&!v.AFrameworkApplication.Ukf&&!v.AFrameworkApplication.brg)b.jbtnFileEmbed=!0;yM.a.Jym()||(b.btnjClose=!0);v.AFrameworkApplication.aKb?(b.jbtnVersion=
!0,t.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):v.AFrameworkApplication.T1d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);v.AFrameworkApplication.d6f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ca.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&
b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.kCi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(v.AFrameworkApplication.eL||".ODT"===qe.App.oOc.toUpperCase()||!v.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!zM.a.dDd||v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(n.a)(QI,"WoncaCommandTrimmer",null,[212]);var AM=c(1021);c(441);var BM=c(1084),CM=c(1173);class RI{constructor(b,h){this.X2=this.BK=null;this._clientId=b;this.gba=h}oyl(){if(!lf.c(this.X2))return this.X2;this.gjf();this.X2.style.display="block";this.gba&&this.gba.G_(Object(z.a)(this,this.onResize,"onResize"));return this.X2}onResize(){this.Aza()}Aza(){this.Nif()?(document.getElementById("application").style.minWidth="0px",(new CM.a(this.X2,null,v.AFrameworkApplication.isRtl)).Jbo(this.X2)):
v.AFrameworkApplication.ta.Kb.NJ||BM.a.Kbo(this.X2,v.AFrameworkApplication.isRtl)}Nif(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}gjf(){if(lf.c(this.BK)){var b;({DTc:b}=jp.a.cdd(!v.AFrameworkApplication.qY)).returnValue?(this.BK=rD.a("div"),this.BK.className=jp.a.KAl,this.BK.id=Sp.CuiHelper.cOd,b.appendChild(this.BK),this.$if(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.C9&&!v.AFrameworkApplication.qY&&this.ajf(),this.nyl()):v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&t.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}nyl(){lf.c(this.X2)&&(this.X2=rD.a("div"),this.X2.className=jp.a.zng,this.X2.style.display="none",this.BK.appendChild(this.X2))}$if(){Sys.UI.DomElement.addCssClass(this.BK,jp.a.LAl);v.AFrameworkApplication.isRtl&&rD.b(this.BK,"cui-rtl")}ajf(){Sys.UI.DomElement.addCssClass(this.BK,"FlexBoxLayout")}}Object(n.a)(RI,"HeaderSkeleton",
null,[]);var QE=c(628);class mH{constructor(){this.Hqc=null}hRo(){this.Hqc||(this.Hqc=Ya.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||t.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}FMl(){this.hRo();return this.Hqc?this.Hqc.getCustomAuthConfig():null}static lLm(){return v.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(n.a)(mH,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class nH{constructor(){this.yKb=this.cultureName=null}}
Object(n.a)(nH,"HeaderCultureInfo",null,[]);var xG=c(1653);class SI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(SI,"SearchInitializationSettings",null,[]);var RE=c(297);class TI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(n.a)(TI,"DocumentTitleAppProps",null,[]);class UI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(UI,"DocumentTitleCalloutAppProps",null,[]);class VI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(VI,"HeaderAppProps",null,[]);class WI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(WI,"HeaderControls",null,[]);class XI{constructor(){this.command=
this.label=null}}Object(n.a)(XI,"WorkflowButtonAppProps",null,[]);var yG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(yG||(yG={}));Object(n.b)("RenameDisableReason",yG);class YI{constructor(b=""){this.Rbg=this.documentTitleAppProps=this.dtg=null;this.tlk=""!==b?b:Jd.a.a6}Abm(b){const h=Ya.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").VFb(b);
if(h&&0<h.length)return h[0].externalUxCommand;t.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Vwf(){if(!this.dtg){const b=QE.a();if(b){const h=this.Abm(b.command);h&&(this.dtg=Object.assign(new XI,{command:h,label:b.label}))}}return this.dtg}dUl(){return Object.assign(new WI,{workflowButton:this.Vwf()})}Bon(){Qk.a.get_instance().oI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;v.AFrameworkApplication.va.Qb(eb.a.SLb,
2,b)}$bm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}EWl(){let b=null,h=null;var r=Ya.a.instance.Oa("Common.IRenameProps");r?(r=r.qgi(),0!==r&&(b=this.$bm(r),h=yG[r])):t.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new UI,{breadcrumbBrandName:v.AFrameworkApplication.Js.breadcrumbBrandName,
breadcrumbBrandUrl:v.AFrameworkApplication.Js.breadcrumbBrandUrl,breadcrumbFolderName:v.AFrameworkApplication.Js.breadcrumbFolderName,breadcrumbFolderUrl:v.AFrameworkApplication.Js.breadcrumbFolderUrl,hideDocumentTitleInput:v.AFrameworkApplication.ta.Kb.Wum,isVersionHistoryEnabled:this.kvo(),documentExtension:E.a.Oha(v.AFrameworkApplication.fileName),isMoveEnabled:32===v.AFrameworkApplication.va.processAction(eb.a.SLb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:v.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}s9h(){if(!this.documentTitleAppProps){const b=v.AFrameworkApplication.Js.yz;this.documentTitleAppProps=Object.assign(new TI,{documentTitle:v.AFrameworkApplication.$Ld?b:E.a.yJ(b),onFirstRender:Object(z.a)(this,this.Bon,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.EWl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}kvo(){return!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.iDi}Vso(){return!!v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Kb.hDi}Suo(){const b=!QE.b()&&!v.AFrameworkApplication.hideHeader&&!v.AFrameworkApplication.Vzf&&(v.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||v.AFrameworkApplication.K.$("TeamsChatIsEnabled"));t.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}X6k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});t.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}yVn(b=!1){appChrome.getHeaderApi().then(h=>
{const r=Ya.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",B=>{r.onFlexPaneOpen(B)});h.setHeaderCommandHandler("OnFlexPaneClose",B=>{r.onFlexPaneClose(B)});h.setHeaderCommandHandler("SetCookie",B=>Gc.a.set(B.cookieName,B.value));h.setHeaderCommandHandler("GetCookie",B=>this.fUl(B));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.Vwf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.s9h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Con();return null}));xG.a.Z0d()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.bhi,"getSearchInitializationSettings"))})}Con(){Ya.a.instance.Sa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.dsb(!1,v.AFrameworkApplication.va.mode)})}fUl(b){b=
Gc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}zgm(){return RE.AppChromeOverrideUtilities.isEnabled?RE.AppChromeOverrideUtilities.TTd("suiteux-shell",!1):this.tlk+v.AFrameworkApplication.Vja+"suiteux-shell"}onFirstRender(){Ya.a.instance.Sa("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.Mro.continueWith(Object(z.a)(this,this.X6k,"continueShellServiceDataAsync"),3)});Qk.a.get_instance().oI(15)}onFullyLoaded(){Qk.a.get_instance().oI(16)}Yha(b=!1){a:{try{var h=
Hi.a.ug(v.AFrameworkApplication.lcid);if(h){var r=Object.assign(new nH,{cultureName:h.name,yKb:h.yKb});break a}}catch(B){t.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+v.AFrameworkApplication.lcid.toString())}r=Object.assign(new nH,{cultureName:"en-us",yKb:"en"})}h=Ya.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new VI,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.yKb,isConsumer:!v.AFrameworkApplication.grg,
showAppLauncher:QE.h(),showMeControl:QE.g(),hideUserName:v.AFrameworkApplication.TWd,defaultDocumentTitleToLeft:v.AFrameworkApplication.BQh,assetsContainerOverride:this.zgm(),controls:this.dUl(),documentTitleAppProps:b?null:this.s9h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.Vwf(),showChatControl:this.Suo(),showGoPremiumControl:QE.i(),showDiscoverPremiumButton:QE.f(),enableSearchControl:xG.a.MUm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.Vso(),testTraffic:v.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:v.AFrameworkApplication.Wso()});!v.AFrameworkApplication.vTb||v.AFrameworkApplication.uig?(r.userDisplayName=v.AFrameworkApplication.userName,r.emailAddress=v.AFrameworkApplication.K.kb("UserPrincipalName"),
r.userID=v.AFrameworkApplication.K.kb("Puid")||"",r.signOutLink=v.AFrameworkApplication.uig):v.AFrameworkApplication.signInUrl&&(r.signInLink=v.AFrameworkApplication.signInUrl);xG.a.Z0d()&&(h=this.bhi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=v.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);mH.lLm()&&(h=new mH,r.shellAuthProviderConfigPromise=Object(z.a)(h,h.FMl,"getAccountSwitchingConfig"));
this.yVn(b);v.AFrameworkApplication.se("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}bhi(){if(!this.Rbg){const b=new xG.a;let h=v.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.Rbg=Object.assign(new SI,{loadTellMeResources:b.K3m(),getTokenRequestDictionary:Object(z.a)(b,b.Mim,"getTokenRequestDict"),userRing:h})}return this.Rbg}}Object(n.a)(YI,"ReactSharedHeaderPropsHelper",null,[1275]);class oH{constructor(){this.label=
this.value=null}}Object(n.a)(oH,"TextInfoSectionField",null,[]);var PF=c(951),DM=c(1237);class pH{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(n.a)(pH,"CommandDefinition",null,[]);class ZI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(n.a)(ZI,"CommandDefinitionMapping",null,[]);const EM=b=>Object.assign(new ZI,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?
Object.assign(new pH,{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new pH,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(eb.a.Jg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var FM=c(1409);class $I{}Object(n.a)($I,"RibbonInitState",null,[]);var aJ=c(416),GM=c(1346);class bJ{constructor(){}flatten(b){const h=
[];for(const r of b)h.push.apply(h,r);return h}}Object(n.a)(bJ,"ReactAsyncDispatcher",null,[]);var HM=c(1693);class cJ{constructor(b,h){this.Okk=b;this.OZj=h}}Object(n.a)(cJ,"ReactExecuteCommandContext",null,[]);class Ay{}Ay.Trigger="FontTrigger";Ay.Name="FontName";Ay.Action="FontAction";Ay.Level="FontLevel";Ay.IsPinned="FontIsPinned";Object(n.a)(Ay,"FontPickerLogProperties",null,[]);class dJ{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb=null,Yb=null){this.h_=null;this.Hgh=!1;this.MAe=[];this.Gjd=-1;this.hzd=
!1;this.Zlk=0;this.Ksc=null;this.pch=!1;this.kjd=null;this.A6g=!1;this.Zfa=b;this.wdb=h;this.wRe=Object(Na.a)(1085,b);this.rl=r;this.Vb=B;P&&(this.h_=new HM.a(P,B));this.pik=ca;this.k3j=ra;this.Mo=Jb;this.ga=Qa;this.Mwb={};this.Ca=mb;this.vwg=Yb;mb&&(mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||mb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&Rh.a.instance.pDd.CWR(()=>this.Hgh=!0);mb&&(b=this.Ca.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&
({Gt:this.Ksc}=I.d(b));this.Ksc||(this.Ksc={})}get lge(){return!!window.appChrome&&!!appChrome.selectors}gij(){-1!==this.Gjd&&window.clearTimeout(this.Gjd);this.Gjd=window.setTimeout(()=>{for(this.Gjd=-1;0<this.MAe.length;){if(Rg.a.instance.Qv){this.gij();break}const b=this.MAe.shift();b&&this.executeCommand(b.Okk,b.OZj)}},0)}executeCommand(b,h){if(Rg.a.instance.Qv){if(this.Hgh){this.MAe.push(new cJ(b,h));this.gij();return}t.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
b,h.modelType,zb.a.toJSON(h.payload));if(this.Ca.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.rl.getCommandByExternalUxId(b),B=h.modelType;this.vwg&&this.vwg.b5m(b,h);r?this.vzl(b,r,B,h):this.wzl(b,B,h);this.iWk(h);this.VOo(h);this.W$m(b,h)}}wzl(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.bZh(r,b);break;case "ButtonModel":this.qzl(r,b)}}wZo(b,h,r,B,P){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;
break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,lf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.g4()):this.g4();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;P=h.commandPreviewId;break;
case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;P=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=B;return P}xZo(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.rl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.rl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=
h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.g4();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}vzl(b,h,r,B){var P=this.aFn(B,r),ca=h.commandId;const ra={},Qa={};switch(r){case "SplitButtonModel":if(this.bTc(B.payload,Object(z.a)(this,this.B_o,"updateSplitButtonMenuState"),P))return;ra.MenuItemId=h.menuItemId;
this.lfg(B,ra);break;case "StatefulSplitButtonModel":if(this.bTc(B.payload,Object(z.a)(this,this.H_o,"updateStatefulSplitButtonMenuState"),P))return;r=B.payload.statefulData;P=B.payload.statefulMode;"color"===P?ra.Color=r:"icon"===P&&(r=this.rl.getCommandByExternalUxId(r))&&(ra.MenuItemId=r.menuItemId);break;case "FileMenu":ra.MenuItemId=h.menuItemId;ra.SourceControlId=b;B.payload&&"FileMenuPageSwitchPayload"===B.payload.type&&this.tpm(ca,B.payload,b);break;case "TellMe":ca=this.xZo(ca,B,ra);ra.SourceControlId=
b;ra.Location=B.payload.location;break;case "ButtonModel":B.payload&&"TabSwitchPayload"===B.payload.type?this.qrm(ra,B):ca=this.wZo(ra,h,B,b,ca);break;case "CompoundButtonModel":ra.MenuItemId=h.menuItemId;ra.CommandValueId=B.payload.commandValueId;ra.SourceControlId=b;this.lfg(B,ra);this.g4();break;case "ToggleButtonModel":case "InkButtonModel":ra.MenuItemId=h.menuItemId;ra.SourceControlId=b;this.lfg(B,ra);this.g4();break;case "FontPickerModel":switch(B.payload.type){case "MenuOpenPayload":ca=this.rl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
ra[zy.a.FontPickerId]=B.payload.launcherId;break;case "MenuClosePayload":ca=this.rl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ra[zy.a.FontPickerId]=B.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=B.payload.font;P=null;"string"===typeof r?(P=bp.FontUtils.QSa(r),ra.CommandValueId=P,P=bp.FontUtils.MJd(P)):(r.data?(ra.CommandValueId=r.data.fontToApply,ra.MenuItemId=r.data.themeIndex,ra[zy.a.Formatting]=r.data):ra.CommandValueId=r.name,P=r);ra.SourceControlId=b;ra[zy.a.RequestUpdateMru]=
P;Qa[Ay.Name]=B.payload.nameToLog?B.payload.nameToLog:"string"===typeof r?bp.FontUtils.JZd(r)?"*"+r:bp.FontUtils.eFf(r)?"[EF]":"[MF]":"";Qa[Ay.IsPinned]=B.payload.isPinned;Qa[Ay.Level]=B.payload.level;this.BNf();break;case "FontPickerFontInfoRequestedPayload":ra.CommandValueId=B.payload.font.name;ra[zy.a.Trigger]=B.payload.trigger;Qa[Ay.Trigger]=B.payload.trigger;Qa[Ay.Name]=B.payload.nameToLog;this.BNf();break;case "FontPickerFontPinningPayload":r=B.payload.isPinned;ra.CommandValueId=B.payload.fontKey;
ra[zy.a.IsPinned]=r;Qa[Ay.Name]=B.payload.nameToLog;Qa[Ay.Action]=r?"pin":"unpin";Qa[Ay.Level]=B.payload.level;this.BNf();break;default:return}break;case "ComboBoxModel":var mb=B.payload.type;switch(mb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Tlc(B.payload.launcherId,P)&&(ca={},ca[B.payload.launcherId]=r,this.wdb.k4c(ca,rh.g(B.payload)),this.Mwb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=B.payload.newValue;if(!r)return;
r.value?(ra[gk.a.Value]=r.value,ra[gk.a.IsFreeForm]=!0):(ra[gk.a.Value]=r.text,ra.MenuItemId=r.key,ra.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===mb&&(ca=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(B.payload.type){case "ZeroTermContextMenuClosePayload":r=zb.a.eP(B.payload);for(mb of r)ra[mb]=B.payload[mb];break;default:this.bTc(B.payload,Object(z.a)(this,this.TWo,"updateFlyoutAnchorMenuState"),
P),ra.launcherId=B.payload.launcherId}break;case "InkFlyoutAnchorModel":this.bTc(B.payload,Object(z.a)(this,this.VXo,"updateInkFlyoutAnchorMenuState"),P);ra.launcherId=B.payload.launcherId;break;case "ColorPickerModel":switch(B.payload.type){case "ColorPickerPayload":ra[bb.Color]=B.payload.selectedColorId;ra.colorRGB=B.payload.color;break;case "ColorPickerPreviewPayload":ca=h.commandPreviewId;ra[bb.Color]=B.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":ra[Gg.a.Number]=B.payload.value;ra[Gg.a.UnitType]=af.a.$Oa(B.payload.unitType.toLowerCase());ra[Gg.a.Text]=B.payload.reservedValue;break;case "SliderModel":ra[Fm.Value]=B.payload.value;break;case "InsertTableModel":ra[ql.a.Rows]=B.payload.rows;ra[ql.a.Columns]=B.payload.columns;break;case "CheckboxModel":ra[Df.a.On]=B.payload.checked;ra.MenuItemId=h.menuItemId;ra.TerminalParentControlId=B.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.bTc(B.payload,
Object(z.a)(this,this.JZo,"updatePreviewGalleryMenuState"),P)){ra.launcherId=B.payload.launcherId;break}this.bZh(B,b);return;case "DocumentTitleModel":switch(B.payload.type){case "DocumentTitleRenamePayload":ra.getNewDocumentTitle=B.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[B.payload.launcherId]=r;this.wdb.k4c(ca,rh.g(B.payload));this.Mwb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ra.MenuItemId=B.payload.url;this.S5m(B.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ra.MenuItemId=B.payload.assetId;ra.SourceControlId=b;v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ra.IsPremium=B.payload.isPremium||!1);this.T5m(B.payload.pageId);break;case "CoauthorGallery":ra.RenderTime=B.triggerTime;break;case "PeopleWell":ra.RenderTime=B.triggerTime;break;case "SyncStatus":ra.SourceControlId=b;break;case "InputBoxModel":ra.Text=B.payload.newValue;break;case "PersonaButtonModel":ra.CommandValueId=
B.payload.commandValueId;this.yqm(B.payload);break;case "MultiActionButtonModel":ra.CommandValueId=B.payload.commandValueId;ra.Href=B.payload.href;ra.SourceControlId=b;ra.Type=B.payload.type;ra.TerminalParentControlId=B.payload.terminalParentControlId;this.g4();break;default:return}ca&&!this.isShadowMenuOpen(B.payload)&&(B.payload&&"terminalParentControlId"in B.payload&&(ra.ParentMenuId=B.payload.terminalParentControlId),ra.CommandValueId||(ra.CommandValueId=ra.MenuItemId),h.legacyControlId&&(ra.LegacyId=
h.legacyControlId),ra.SourceControlId||(ra.SqmControlId=b),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ra.launcherId&&(h=this.rl.getCommandByExternalUxId(ra.launcherId))&&(ra.launcherCommandId=parseInt(h.commandId)),B.payload&&!lf.c(B.payload.PRIReadinessCheck)&&(ra.PRIReadinessCheck=B.payload.PRIReadinessCheck,this.pch=!0),B.payload&&!lf.c(B.payload.shouldTakeFocus)&&(ra[Ru.a.OUa]=B.payload.shouldTakeFocus),h=this.l_e(B,ra),lf.c(B.triggerTime)||
(Qa.TriggerTime=B.triggerTime),B.payload&&!lf.c(B.payload.userActionKey)&&(Qa.userActionKey=B.payload.userActionKey),this.zdg(Qa,B,b,ca),this.wRe.executeCommand(ca,ra,this.getSelectedTabId(),h,!0,()=>{this.IQf(ra,b)},Qa,rh.g(B.payload)))}zdg(b,h,r,B){if(this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&B&&h.payload){const P=!lf.c(h.payload.launcherId);r=this.phj(this.o7l(P?h.payload.launcherId:r,B),B,!1);b.ControlId=r;const ca=h.payload.inputMethod,
ra=h.payload.location;lf.c(ca)||lf.c(ra)||this.j5m(1===ca,2===ca||3===ca||4===ca,P||"TabSwitchPayload"===h.payload.type,r,ra)}this.Ca&&this.Ca.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.phj(h.payload.terminalParentControlId,B,!0))}j5m(b,h,r,B,P){this.kjd||(this.kjd={});const ca=[];P=sh.a.b9("UILocation",P,2);Array.add(ca,P);if(P=this.getSelectedTabId())P=sh.a.b9("Tab",P,2),Array.add(ca,P);this.kjd[B]||
(this.kjd[B]=1,h?r?this.zfc("DistinctUserInitiatedNavigationalCommand",ca):this.zfc("DistinctUserInitiatedTerminalCommand",ca):b&&this.zfc("DistinctUserInitiatedKeyboardCommand",ca));h?r?this.zfc("UserInitiatedNavigationalCommand",ca):this.zfc("UserInitiatedTerminalCommand",ca):b&&this.zfc("UserInitiatedKeyboardCommand",ca)}zfc(b,h){ne.b(b,null,0,!0,0,h)}phj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;t.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":
"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}o7l(b,h){h=parseInt(h);h=nd.ActionManager.A9e(h)||nd.ActionManager.xba(h)||"";return!lf.c(h)&&h in this.Ksc?this.Ksc[h]:100<b.length?"":b}BNf(){this.Mo&&this.Mo.execute(b=>{b.kNf("ModernFontPickerExperience")})}l_e(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[Ru.a.Ux]=r);return r}IQf(b,h){const r=Object(Na.a)(Zd.AFrame,v.AFrameworkApplication.ta);
if(this.Vb&&this.hrj(b)){if(!this.Vb.currentScope&&r){let B="null";if(b){const P=b.Value;delete b.Value;B=zb.a.toJSON(b);lf.c(P)||(b.Value=P)}t.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,B,r.G7a)}this.Vb.smf()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==Zd.AFrame.Xqa&&r&&this.Vb.currentScope.name!==r.G7a||this.hrj(b))&&this.M0k(b)}hrj(b){return!!b&&
!lf.c(b[Ru.a.OUa])&&b[Ru.a.OUa]}M0k(b){Ru.a.Ux in b&&1===b[Ru.a.Ux]&&PF.ShyRibbon.cgb(1,0)}qrm(b,h){rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.g4();this.Zfa.Gm();if(this.pik&&this.ga){const r={};r[JI.a.clg]=h.payload.tabId;this.ga.Qb(eb.a.H7c,2,r,this.jY(h));lf.c(h.payload.inputMethod)||(this.ga.processAction(eb.a.bej,2),this.hzd||this.gzo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.rl.Dvf(h);
t.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Mo&&h){const r=h+"TabSwitchActivity";this.Mo.execute(B=>{B.kNf(r)})}}bTc(b,h,r){const B=b.type;return"MenuClosePayload"===B?!0:"MenuOpenPayload"===B?(h(b,r),!0):!1}yqm(b){b=b.type;"MenuOpenPayload"===b?v.AFrameworkApplication.zbd=!0:"MenuClosePayload"===b&&(v.AFrameworkApplication.zbd=!1)}aFn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=
b.payload.launcherId,B=this.rl.getCommandByExternalUxId(r);return B&&B.populationProps?((b=this.wdb.Q1f(B,h,b.payload))&&r in this.Mwb&&delete this.Mwb[r],b):!1}TWo(b,h){const r=b.launcherId;this.Tlc(r,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Yoc(h,r,rh.g(b)))}VXo(b,h){const r=b.launcherId;this.Tlc(r,h)&&(h=rh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(r):appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Yoc(h,r,rh.g(b)))}JZo(b,h){const r=
b.launcherId;this.Tlc(r,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(r),this.Yoc(h,r,rh.g(b)))}B_o(b,h){const r=b.launcherId;this.Tlc(r,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(r),this.Yoc(h,r,rh.g(b)))}H_o(b,h){const r=b.launcherId;this.Tlc(r,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(r),this.Yoc(h,r,rh.g(b)))}getSelectedTabId(){return this.lge?appChrome.selectors.getSelectedTabId():null}Yoc(b,h,r){this.wdb.k4c(b,r);this.Mwb[h]=new Date}Tlc(b,h){let r=!0;b in this.Mwb&&
(r=this.Mwb[b].getTime()<this.Zfa.aqa.getTime());return r&&!h&&this.lge}bZh(b,h){const r={};var B=b.payload.selectedGalleryId;const P=this.rl.getCommandByExternalUxId(B);if(P){r.SourceControlId=B;r.MenuItemId=P.menuItemId;r.SqmControlId=h;P.legacyControlId&&(r.LegacyId=P.legacyControlId);b.payload&&!lf.c(b.payload.shouldTakeFocus)&&(r[Ru.a.OUa]=b.payload.shouldTakeFocus);this.U9l(b.payload,r);(B=this.jY(b))||(B={});this.zdg(B,b,h,P.commandId);const ca=this.l_e(b,r);this.wRe.executeCommand(P.commandId,
r,this.getSelectedTabId(),ca,!0,()=>{this.IQf(r,h)},B,rh.g(b.payload))}}qzl(b,h){const r=this.rl.getCommandByExternalUxId(h);if(r){const B={};B.SourceControlId=h;B.MenuItemId=h;B.SqmControlId=h;b.payload&&!lf.c(b.payload.shouldTakeFocus)&&(B[Ru.a.OUa]=b.payload.shouldTakeFocus);let P=this.jY(b);P||(P={});this.zdg(P,b,h,r.commandId);const ca=this.l_e(b,B);this.wRe.executeCommand(r.commandId,B,this.getSelectedTabId(),ca,!1,()=>{this.IQf(B,h)},P,rh.g(b.payload))}}U9l(b,h){"CharacterGalleryPayload"===
b.type&&(h.MenuItemId=b.character)}lfg(b,h){b.payload&&"toggled"in b.payload&&(h[Df.a.On]=b.payload.toggled)}W$m(b,h){if("MenuOpen"===b){if(this.h_&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.h_.onMenuOpen()}else if("MenuClose"===b&&this.h_)this.h_.onMenuClose()}g4(){this.h_&&this.h_.jWf()}jY(b){let h=null;lf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}tpm(b,h,r){if(this.k3j&&this.ga){const B={};B[HI.a.e$d]=r;this.ga.Qb(eb.a.G7c,2,B)}this.Yoc(h.pageControlIdMap,
b,rh.g(h))}T5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(eb.a.gej,2);break;case "FileNewPage":this.ga.processAction(eb.a.hej,2)}}S5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(eb.a.Kdj,2);break;case "FileOpenPage":this.ga.processAction(eb.a.Ldj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}gzo(b){if(v.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Mo.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",
null)}),this.hzd=!0;else{if(v.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Mo.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.Zlk)){this.hzd=!0;return}v.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(eb.a.qRb,2)&&(this.hzd=!0)}}iWk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.pch&&appChrome.PRIToastManager.dismissToast()}VOo(b){!this.A6g&&this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",
!1)&&(b=rh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.A6g=!0)}}Object(n.a)(dJ,"ReactExecuteCommandHandler",null,[]);class eJ{constructor(){this.fileMenu=null}get esb(){return 0}get J5a(){return 0}get vHa(){return!1}Aza(){}yAj(){}g0(){return!1}amj(){}q4(){return!1}cKa(b){return this.fileMenu&&
this.fileMenu.OTa(b)?!0:!1}get tka(){return!1}Zpb(){}VZd(){return!1}get FId(){return null}set FId(b){}Fga(){}ica(){}Gwf(){return null}zPa(){}refresh(){}get controls(){return null}rjc(){return!1}vgb(){}Gm(){}get IF(){return null}set IF(b){}Jdd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(n.a)(eJ,"ReactRibbonExternal",null,[711,656,712]);class fJ{constructor(b,h,r,B){this.Vb=b;this.ga=h;this.kmh=r;this.M_b=B}initialize(){this.ga.qa(eb.a.o8c,Gd.a.frame,Object(z.a)(this,
this.egj,"ribbonMoveForwardAction"));this.ga.qa(eb.a.n8c,Gd.a.frame,Object(z.a)(this,this.dgj,"ribbonMoveBackwardAction"));this.ga.qa(eb.a.ife,Gd.a.frame,Object(z.a)(this,this.agj,"ribbonEscAction"));var b=jp.a.$Xd(this.M_b,null,this.kmh,!1);b.fI=!0;this.ojc(b,eb.a.o8c,eb.a.n8c);b.bindAction(Tb.KeyInputManager.ic(kc.a.fKa,0),eb.a.ife);b=this.Vb.fe(Zd.AFrame.Xqa);b.fI=!0;this.ojc(b,eb.a.C1a,eb.a.C1a);Ye.a.instance.ob(Xc.a.Zx,this.kmh,Object(z.a)(this,this.gun,"onRibbonMouseDown"));b=Xl.a.instance;
rh.a("enterKeytipMode")&&b.smo(this.M_b,()=>{appChrome.api.enterKeytipMode(!1)});rh.a("exitKeytipMode")&&b.omo(this.M_b,()=>{appChrome.api.exitKeytipMode();PF.ShyRibbon.cgb(1,0)});v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa&&(b=Object(Na.a)(kb.FocusManager,this.Vb))&&b.myk(Object(z.a)(this,this.kpn,"onFocusScopeChanged"))}kpn(b,h){if((b=Object(Na.a)(Zd.AFrame,v.AFrameworkApplication.ta))&&h.ORi&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa){const r=appChrome.selectors.getShyState();
r.isActive&&h.ORi.name===b.G7a&&PF.ShyRibbon.cgb(r.state,1)}}egj(){return 4}dgj(){return 4}agj(){rh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa&&appChrome.selectors.getShyState().isActive&&PF.ShyRibbon.cgb(1,0),this.Vb.mg(Zd.AFrame.In));return 4}ojc(b,h,r){const B=Tb.KeyInputManager.ic(kc.a.Kw,0),P=Tb.KeyInputManager.ic(kc.a.Kw,4);b.mr(B);b.mr(P);b.bindAction(B,h);b.bindAction(P,r)}gun(b){b.Hb&&b.Hb.target&&"input"!==b.Hb.target.tagName.toLowerCase()&&
b.Hb.preventDefault();return!1}dispose(){this.ga.Vv(eb.a.o8c,Gd.a.frame,Object(z.a)(this,this.egj,"ribbonMoveForwardAction"));this.ga.Vv(eb.a.n8c,Gd.a.frame,Object(z.a)(this,this.dgj,"ribbonMoveBackwardAction"));this.ga.Vv(eb.a.ife,Gd.a.frame,Object(z.a)(this,this.agj,"ribbonEscAction"))}}Object(n.a)(fJ,"ReactRibbonFocusManager",null,[10]);class vC{constructor(b,h,r,B,P,ca,ra,Qa=null,mb=!0,Jb=null,Yb=null){this.nbb=this.eAd=this.Mwe=this.Zfa=null;this.igh=[];this.hwd=null;this.sNa=b;this.lLe=h;this.M_b=
r;this.Vb=B;this.ga=P;this.rl=ca;this.Zfa=Jb?Jb:new XD(kv.instance,this.rl);this.fyc=ra;this.xeh=new eJ;this.tNa=Qa;this.hTe=mb;new bJ;this.JVg=Yb;Qk.a.get_instance().pk(7,Object(z.a)(this,this.Ino,"setRibbonPostInteractiveReady"));Qk.a.get_instance().pk(7,Object(z.a)(this,this.a8m,"logRibbonLoadedActivity"));Qk.a.get_instance().pk(19,Object(z.a)(this,this.H4m,"logAppLoadedActivity"));Qk.a.get_instance().pk(7,Object(z.a)(this,this.QYn,"registerSubComponentReporting"));Qk.a.get_instance().pk(7,Object(z.a)(this,
this.aOn,"queueSettingsDependentActions"))}initialize(b,h,r=null){this.hTe||this.oI(5);r?r.then(()=>{this.Xcj()}).catch(()=>t.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):aJ.a.ecd(aJ.a.ecd(kk.Task.WAA(this.qIi(b),this.pIi(vC.d_j)),()=>this.pIi(vC.wWj)),()=>this.qIi(h)).continueWith(()=>{this.Xcj()},11)}dispose(){this.lSo();this.nbb&&this.nbb.bUh();this.hwd&&this.hwd.dispose();for(const b of this.igh)Qk.a.get_instance().CYk(b);v.AFrameworkApplication.va.Vv(eb.a.J5n,
Gd.a.frame,nd.ActionManager.Nf)}pIi(b){return Ya.a.instance.resolve("Common.ISharedDependencyLoader").sfc(v.AFrameworkApplication.Sz(b,2))}qIi(b){return""===b?kk.Task.C4(!0):Ya.a.instance.resolve("Common.ISharedDependencyLoader").sfc(v.AFrameworkApplication.Sz(b,3))}xCm(){(this.tNa||this.fyc)&&appChrome.api.dispatch(this.dki());this.Ipo();rh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(v.AFrameworkApplication.b6);this.Zfa.Gm()}Xcj(){this.xCm();this.hTe&&(appChrome.renderAppChrome(this.sNa,
rh.e()),this.oI(10));this.uoh();this.S5e();this.hTe&&this.oI(5);this.msi()}msi(){this.Vb&&this.ga&&this.M_b&&(this.hwd=new fJ(this.Vb,this.ga,this.sNa,this.M_b),this.hwd.initialize())}get m8c(){return this.xeh}setCommandDefinitionMapping(){if(rh.a("setCommandDefinitionMapping")){const b=EM(this.rl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Ppa&&rh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,
h)=>{0===h&&this.Aic()})}uoh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Na.a)(XD,this.Zfa);this.Mwe=new dJ(this.Zfa,b.ljc,this.rl,this.Vb,this.lLe,Ya.a.instance.Oa("Common.IRibbonSQMInformation"),Ya.a.instance.Oa("Common.IFileMenuSQMInformation"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,Ya.a.instance.Sa("Common.ISystemInitiatedFeedback"),null);this.$Kk();this.pom()}$Kk(){this.eAd=appChrome.api.bindCommandHandler((b,h)=>{this.Mwe.executeCommand(b,
h)})}lSo(){this.eAd&&(this.eAd(),this.eAd=null)}Ipo(){appChrome.api.initializeLogger(new Tm.a)}KFa(){return this.Zfa?this.Zfa.KFa():[]}Aic(){Zq.a.instance.ie(()=>{let b=null;Zq.a.instance.ie(()=>{b=this.KFa()},"RB:GA");b&&0<b.length&&(this.Zfa.aqa=new Date,Zq.a.instance.ie(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.nbb&&Zq.a.instance.ie(()=>{this.nbb.W2i()},"RB:J")},"RB:PFSU")}Sdd(){this.Zfa.Sdd()}xMb(){}Nqk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];
appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}dki(){var b=v.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(B=>{B&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",
!0));h.push.apply(h,this.e$h());b=new FM.a(this.rl);this.tNa.iH&&(GM.a.lPo(this.tNa.iH),h.push.apply(h,b.tQd(this.tNa.iH)));if(this.tNa.rCj)for(const r of this.tNa.rCj)h.push(appChrome.actions.updateGallerySectionHiddenState(r.T3h,r.bsp,r.Nup));h.push.apply(h,b.V4h(this.tNa.vCj));return h}e$h(){const b=[];if(this.fyc&&this.fyc.iH){const r=this.fyc.iH;for(let B in r){var h=r[B];const P=this.rl.Wqf(B);if(P)for(let ca of P)b.push(appChrome.actions.updateControlHiddenState(ca,h))}}return b}$Ja(b){b&&
this.Zfa.ljc.k4c(b,0)}Q1f(b){this.Zfa.ljc.Q1f(this.rl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}pql(){const b=v.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=v.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.w_o(b,"Shared"===(h.SharingStatus||"")))}aOn(){v.AFrameworkApplication.K.Nn(()=>{this.pql()})}w_o(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}oI(b){Qk.a.get_instance().oI(b);this.igh.push(b)}Ino(){rh.d("updateRibbonInitializationState")&&
appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new $I,{postRibbonInteractiveReady:!0})))}S5e(){this.fyc&&this.JVg&&(this.nbb=this.JVg.tbf(),this.xeh.fileMenu=this.nbb)}y0m(b,h){this.nbb&&this.nbb.MGi(b,h)}Fag(b,h,r){if(1===r)return 32;this.Inj(!0);this.Aic();v.AFrameworkApplication.ta.updateCommandUI();return 32}Gag(b,h,r){if(1===r)return 32;this.Inj(!1);this.Uno();this.Aic();v.AFrameworkApplication.ta.updateCommandUI();return 32}aog(b,h,r){if(1===r)return 32;
(b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback"))&&b.execute(B=>{B.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}Uno(){Gc.a.ZIa(v.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",Gc.a.pHa)}Inj(b){Gc.a.ZIa(v.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Gc.a.pHa)}a8m(){if(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Gr){const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?
(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),v.AFrameworkApplication.hqa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),v.AFrameworkApplication.hqa("69a7h198;dfd7j584"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>
{h.isFreemiumUpsellEnabled()&&v.AFrameworkApplication.hqa("5fjej882;e0jjh200")})}}Ohg(){const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("SingleLineToolBarOptOut",null)});return 32}H4m(){this.ga.qa(eb.a.aog,Gd.a.frame,Object(z.a)(this,this.aog,"triggerModeSwitcherTUI"));this.ga.fb(eb.a.Ohg,Gd.a.frame,Object(z.a)(this,this.Ohg,"showMultilineRibbonFromToolbar"),96);const b=Gc.a.tca(v.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>
{const h=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&(v.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(r=>{r.logActivity("VNextStylesOn",null)}),h.execute(r=>{r.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):v.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(r=>{r.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}QYn(){Qk.a.get_instance().pk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let r in b){var h=r;const B=b[r];if(B)for(const P of B)v.AFrameworkApplication.va.l0(P)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):v.AFrameworkApplication.va.lmo(P,this.tdl(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}tdl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}pom(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&v.AFrameworkApplication.lic.tZe){const b=v.AFrameworkApplication.lic.tZe,h=v.AFrameworkApplication.lic.Unh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;vC.ggj.nb(r)?vC.ggj.J(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.Mwe.executeCommand(b,h))}}}vC.d_j="common";vC.wWj=
"appChrome";vC.ggj=new DM.a(Pa.a.DSc());Object(n.a)(vC,"ReactRibbonUser",null,[220,221,10]);class qH extends vC{constructor(b,h,r,B,P,ca,ra,Qa,mb=null,Jb=!0,Yb=null,fc=null){super(b,h,B,P,ca,ra,Qa,mb,Jb,Yb,fc);this.Lmd=null;this.vvb=r;this.vvb.execute(Mc=>{this.Lmd=Mc});this.vvb.execute(Mc=>{this.Zfa.IF=Mc})}KFa(){return this.Lmd?(this.Lmd.clearCache(),super.KFa()):[]}xMb(b){if(!b)throw Error.argumentNull();this.vvb.execute(h=>{b.IF=h})}}Object(n.a)(qH,"ReactRibbonUser",vC,[]);var IM=c(1015);class QF extends qH{constructor(b,
h,r,B,P,ca,ra,Qa,mb,Jb=!0,Yb=null,fc=null){super(h,b.s4,B,xk.AppFrame.jra,P.focusManager,P.oc,ra,Qa,mb,Jb,Yb,fc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.jEe=b;this.gba=ca;P.eWa(()=>{this.d_o();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Qk.a.get_instance().pk(7,()=>{this.dsi()}):this.dsi()},null)}get LEf(){return!!v.AFrameworkApplication.K.appSettings.BootActivityNavigationId}dsi(){this.xbl();
this.tbf();this.AVn()}d_o(){this.sNa.classList.add("FlexBoxLayout");this.jEe.Eoa().classList.add("cui-exth");this.jEe.Eoa().classList.add("FlexBoxLayout");this.jEe.Eoa().classList.add("ScrollableRibbon")}xbl(){v.AFrameworkApplication.qY||this.Gfl()}Gfl(){if(!v.AFrameworkApplication.qY){var b=(new RI(QF.nik,this.gba)).oyl(),h=jp.a.$Xd(xk.AppFrame.RQa,null,b,!0);h.fI=!0;this.ojc(h,eb.a.o8c,eb.a.n8c);h.bindAction(Tb.KeyInputManager.ic(kc.a.fKa,0),eb.a.ife);jD.a(1,()=>{this.Y3n(b)})}}Y3n(b){const h=new YI;
appChrome.renderSharedHeader(b,h.Yha()).then(this.jgf.bind(this))}Caj(){v.AFrameworkApplication.ta.Kb.gDi?appChrome.getHeaderApi().then(b=>{document.getElementById(v.AFrameworkApplication.hib).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new IM.a).jgf()}jgf(){this.LEf&&v.AFrameworkApplication.hqa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.LEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Qk.a.get_instance().pk(12,this.Caj.bind(this),
11),t.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.Caj()}ojc(b,h,r){const B=Tb.KeyInputManager.ic(kc.a.Kw,0),P=Tb.KeyInputManager.ic(kc.a.Kw,4);b.mr(B);b.mr(P);b.bindAction(B,h);b.bindAction(P,r)}tbf(){const b=!!this.tNa&&"FileMenu"in this.tNa.vCj;v.AFrameworkApplication.ta.Kb.SRa&&!b&&jD.a(1,this.w3n.bind(this))}w3n(){const b=[];if(v.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new oH,
{label:CommonUIStrings.L_DiagnosticsSessionId,value:v.AFrameworkApplication.userSessionId}),Object.assign(new oH,{label:CommonUIStrings.L_DiagnosticsBuild,value:v.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.e$h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}AVn(){this.ga.qa(eb.a.nVa,zc.a.view,this.nVa.bind(this));this.ga.qa(eb.a.Fag,zc.a.view,this.Fag.bind(this));
this.ga.qa(eb.a.Gag,zc.a.view,this.Gag.bind(this))}activateRibbonTab(b){this.Nqk(b)}Aic(){Qk.a.get_instance().isCompleted(7)&&this.Lmd&&(Me.a.mark(4893),Bj.a.IZo(),super.Aic(),Me.a.mark(4894))}nVa(b,h,r,B,P){if(2===P[Ru.a.Ux]){if(r=Object(Na.a)(Mv.a,h))B=Object(Na.a)(qz.a,r.view);else return t.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,zb.a.join(P," ",":")),8;if(B&&""!==B.uJ)$i.a.via(h)&&
$i.a.Tcc()||(this.Vb.mg(B.uJ),appChrome.selectors.getShyState().isActive&&PF.ShyRibbon.cgb(0,1));else return t.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,zb.a.join(P," ",":"),this.f2l(r.view)),8}return 32}f2l(b){return b?"is ContentEditableView: "+b.Zj+" is Editing View: "+b.Exa+" is HtmlView: "+b.F4a+" is InteractiveView: "+b.ue+" is NavigationPaneView: "+
b.oRm+" is PageView: "+b.$i+" is WordNavigationPaneHeadingsView "+b.a2d:"null view"}}QF.nik="WACRibbon";Object(n.a)(QF,"ReactRibbonUser",qH,[219,220,221,10]);class gJ extends QF{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc=null,id,Id){super(b,h,r,B,P,ca,ra,Qa,mb,!1,Jb,Wc);this.KCk=()=>{this.Mo&&this.Mo.execute(ve=>{ve.logActivity("WordShyRibbon",null)});return 32};this.LBm=()=>{ki.a.instance.pf(Cg.a.XCm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(ve=>{var $d;this.tNa&&
ve.push.apply(ve,this.dki());(this.Xgh||this.Ygh)&&this.Zdb&&ve.push.apply(ve,this.dRl());ve.push(appChrome.actions.setControlCustomTooltip(gd.a.f1m,CommonUIStrings.l_LoopsLearnMoreTooltip));var be=null===($d=v.AFrameworkApplication.K)||void 0===$d?void 0:$d.kb("ReactShyRibbonPreferenceCookieName");$d=Gc.a.get(be);this.dro($d);v.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.NJ&&
""===$d&&v.AFrameworkApplication.se("66h8i182;1ha8c781");ve.push.apply(ve,this.KFa());ve.push(appChrome.actions.setControlBehaviorAttached(!0));const he=Ya.a.instance.resolve("WordEditor.IModeSwitcherControl");$d=he.J1l();v.AFrameworkApplication.se("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(be=appChrome.selectors.getModeSwitcherMode())&&be!==$d.activeMode&&t.ULS.sendTraceTag(527778651,
306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${$d.activeMode}, Actual: ${be}`);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(be=jp.a.$Xd(C.a.kuj,null,document.getElementById("WACToolbarContainer"),!1),be.fI=!0,this.jRn(be,eb.a.o8c,eb.a.n8c));"Suggest"===$d.activeMode||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===$d.activeMode?
appChrome.getUpdateAppModeAndTabsActions($d,!0).then(re=>{appChrome.api.dispatch(ve.concat(re));he.BOi();this.rsi()}):(ve.push(appChrome.actions.updateModeSwitcher($d)),appChrome.api.dispatch(ve),he.BOi(),this.rsi())})};this.Zdb=Yb;this.Xgh=fc;this.Ygh=Mc;this.Mo=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");this.Ib=id;this.xCe=Id}WCm(){t.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Qk.a.get_instance().oI(5);const b=this.LEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;Qk.a.get_instance().pk(b,this.LBm,11);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.Euk()}Euk(){this.Ib.Wb(new Oe.a(5,1,0,()=>{this.xCe.execute(b=>{b.Qmo()})}))}dRl(){const b=[];this.Xgh&&(b.push(appChrome.actions.setButtonSecondaryText(gd.a.BKd,this.Zdb.Ivm)),b.push(appChrome.actions.setButtonSecondaryText(gd.a.YId,this.Zdb.Hvm)),b.push(appChrome.actions.setButtonSecondaryText(gd.a.Q$d,this.Zdb.Jvm)));this.Ygh&&b.push(appChrome.actions.setButtonSecondaryText(gd.a.N$d,
this.Zdb.Kvm));return b}dro(b){var h;b&&(null===(h=v.AFrameworkApplication.ta)||void 0===h?0:h.Kb.Ppa)?this.Mo.execute(r=>{r.logActivity("OptInShyRibbonNormalScreenActivity",null)}):appChrome.api.isSmallDevice()&&!b&&this.Mo.execute(r=>{r.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});v.AFrameworkApplication.va.fb(eb.a.bth,Gd.a.frame,this.KCk,96)}jRn(b,h,r){const B=Tb.KeyInputManager.ic(kc.a.Kw,0),P=Tb.KeyInputManager.ic(kc.a.Kw,4);b.mr(B);b.mr(P);b.bindAction(B,h);b.bindAction(P,r)}rsi(){v.AFrameworkApplication.lic.kSo();
this.uoh();this.S5e();this.msi();Qk.a.get_instance().oI(7);ki.a.instance.rga(Cg.a.MGc,Cg.a.Z9n,(new Date).getTime())}$Ja(b){if(b){const h=this.fai();try{super.$Ja(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}KFa(){const b=this.fai();try{return super.KFa()}finally{null===b||void 0===b?void 0:b.dispose()}}fai(){var b;let h=void 0;const r=null===(b=qe.App.li)||void 0===b?void 0:b.Al;r&&(h=new sg.GraphTransaction(qe.App.Vxi()&&qe.App.YFf?0:2),h.set(r));return h}}Object(n.a)(gJ,"ReactRibbonUser",
QF,[]);class hJ extends lH{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r);this.cHe=v.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&ba.a.U4;this.rl=P;this.ZPe=ca;this.Ib=ra;this.xCe=Qa}Oel(b,h){const r=new PE(v.AFrameworkApplication.K,this.ga,this.Vb,this.cHe),B=new AM.a(r);return this.lfl(b,h,B,r)}lfl(b,h,r,B){var P=new PI(new QI(v.AFrameworkApplication.K,B),r);r=this.tCm(P);const ca={};P.sqb(ca);P=!ba.a.U4;const ra=ba.a.Er||ba.a.Dj;var Qa=ba.a.el;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&
(Qa=ba.a.vi||Qa);Qa=new JF.a(Qa);b=new gJ(b,h,WordEditorIntl.WordEditorStrings,this.vvb,B,b,this.rl,r,new LI(ca),this.ZPe,Qa,P,ra,new OI,this.Ib,this.xCe);b.WCm();return b}tCm(b){const h={};b.P9c(h);b.eed(h);return new MI(null,h,"jewelWordEditor")}}Object(n.a)(hJ,"WordEditorRibbonUserFactory",lH,[]);class rH{constructor(b,h){this.mA=b;this.ysd=h}FPa(b,h,r,B=null,P=null){return this.ysd.Sqj(b)?this.ysd.FPa(b,h,r,B,P):this.mA.FPa(b,h,r,B,P)}VGa(b,h=null){return this.ysd.Sqj(b)?this.ysd.VGa(b):this.mA.VGa(b,
h)}}Object(n.a)(rH,"RootCuiUser",null,[322]);class iJ extends rH{constructor(b,h){super(b,h)}clearCache(){this.mA.clearCache()}}Object(n.a)(iJ,"WordGeneralCuiUser",rH,[321,322]);var JM=c(1484);class zG{static getSelectedText(){const b=(new rr.a).Quf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static oUd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=E.a.Lz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(n.a)(zG,"SearchUtils",null,[]);class hw extends $C{constructor(b,
h,r){super(b,r);this.BI=h}gof(b){const h=[];var r=lh.a.instance.ib.lb;const B=!!this.BI&&this.BI.mYc(Mb.a.F7e.toString()),P=!!this.BI&&this.BI.mYc(Mb.a.BOb.toString()),ca=!B&&!r.t4a&&hw.T7a.SOi(),ra=!(v.AFrameworkApplication.pu&&hw.xzi)&&(!!this.BI&&this.BI.mYc(eb.a.yHa.toString())||!!jB.a.instance&&(3===jB.a.instance.mode||2===jB.a.instance.mode)),Qa=r.UCi()&&v.AFrameworkApplication.ta.Kb.eYc;var mb=!1;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1)){mb=!!r&&(r.Zw||2===r.length&&Pd.SelectionEditor.Kk(r.Rc));var Jb=zG.getSelectedText();mb=mb&&0<Jb.length&&60>Jb.length}b=(Jb=3===b||ba.a.vi||v.AFrameworkApplication.Xmf)&&hw.Khf.v0(r,b);r=hw.xzi&&r&&1===r.length&&r.J(0).contextId===zc.a.Tc;Jb&&h.push(this.rl.Mwa("ClipboardGroup")[0].externalUxGroupId);ca&&(h.push(this.rl.Mwa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.rl.Mwa("StylesGroup")[0].externalUxGroupId));mb&&h.push(this.rl.Mwa("DefineGroup")[0].externalUxGroupId);B&&h.push(this.rl.Mwa("PictureToolsGroup")[0].externalUxGroupId);
P&&h.push(this.rl.Mwa("TableToolsGroup")[0].externalUxGroupId);Qa&&h.push(this.rl.Mwa("EquationToolsGroup")[0].externalUxGroupId);ra&&h.push(this.rl.Mwa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.rl.Mwa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.rl.Mwa("ContextMenuGroup")[0].externalUxGroupId);JM.a.Gwi&&hw.MLm&&h.push(this.rl.Mwa("DesignerGroup")[0].externalUxGroupId);return h}static get Khf(){return null!=hw.Myg?hw.Myg:hw.Myg=Ya.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get T7a(){return null!=
hw.$Gg?hw.$Gg:hw.$Gg=Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static $Uc(b,h,r,B){b.WKk(()=>hw.xgb(h,r,B))}static xgb(b,h,r){return new hw(b,h,r)}static get MLm(){null===this.ZFe&&(v.AFrameworkApplication.se("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.ZFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.ZFe}static get xzi(){null!==
this.FGe||"Templatization"!==v.AFrameworkApplication.pu&&"ContentAssemblyEdit"!==v.AFrameworkApplication.pu||(v.AFrameworkApplication.se("insertSnippetTreatment;insertSnippetControl"),this.FGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.FGe}}hw.ZFe=null;hw.FGe=null;Object(n.a)(hw,"WordReactFloatie",$C,[]);class sH{constructor(){this.ifa=this.VDc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;
this.W.resolve("WordEditor.UI.BusinessBarController").c1f();const h=qe.App.Iv.gJ,r=ab.StaticActiveAppFrame.za();hw.$Uc(r,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.ifa=this.W.Oa("Box4.IContextMenuController");const B=new IF(r,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),P={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};
switch(null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:P["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:P["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:P["floatie.gbUseSmartPasteButton"]=!1}B.$Uc("PasteFloatieData",null,P);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new CI(r,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).$Uc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Qk.a.get_instance().pk(7,()=>{this.VDc=this.W.resolve("WordEditor.UI.StatusBarUser");this.VDc.Ub()})}dispose(){this.VDc&&(this.VDc.dispose(),this.VDc=null);this.ifa&&(this.ifa.dispose(),this.ifa=null)}wc(b){this.W=b;b.ia("WordEditor.UI.BusinessBarController",()=>new LF(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),v.AFrameworkApplication.va,v.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();
let h=ba.a.el;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=ba.a.vi||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new JF.a(h));const r=ba.a.Er||ba.a.Dj,B=v.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(ba.a.U4||r),P=v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new qs(Ya.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ya.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new wd.a)).ha();
b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new Ap(v.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,P?b.Sa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Sa("Box4.IPresenceDataManager"),b.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Sa("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
B,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ya.a.instance.Sa("Common.IActionContextProvider"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new Cx).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new hm(v.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").ha();
b.ia("WordEditor.UI.DialogFactory",()=>new BI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new zF(kb.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",()=>new iJ(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new GI(ab.StaticActiveAppFrame.za().Mjg,b.Sa("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,ab.StaticActiveAppFrame.za())).as("WordEditor.IStatusBarUser").ha();b.ia("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new MF).ha();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new XD(kv.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).ha();const ra=b.Sa("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new hJ(ra,v.AFrameworkApplication.va,kb.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),v.AFrameworkApplication.lc,b.Sa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new NF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");
b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new KI(v.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new II(v.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new DI).as("WordEditor.IRulerUser");b.ia("WordEditor.UI.RulerContextMenu",()=>new dD(v.AFrameworkApplication.va,Ya.a.instance.Sa("Common.IZoomManager"),vq.a.instance)).as("WordEditor.IRulerContextMenu").ha();
b.ia("Common.IReactContextualUILauncher",()=>new YD(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new aD(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){v.AFrameworkApplication.se("5b6i5792;30d4f535");Bp.instance.VWh();Bp.instance.uif();L.a.instance.Gc(new sH,6)}}Object(n.a)(sH,"WordEditorUIPackage",null,[1,2]);var KM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",
LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",
Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},vD={};vD.Zpc=function(){function b(){return ra()&&(id()||3<=(fc()?Id("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function B(Hf){Hf=(new RegExp(Hf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ei=-1;null!=Hf&&2<=Hf.length&&(Ei=parseFloat(Hf[1]),isNaN(Ei)&&(Ei=-1));return Ei}function P(){jJ||(jJ=!0,kJ=B("Windows Phone"));return 8<=kJ}function ca(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Wc()&&!Qa()}function ra(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Qa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function mb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function Jb(){return mb()?8==window.document.documentMode:!1}function Yb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function fc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Mc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Wc(){var Hf=window.navigator.userAgent.toLowerCase();return 0<=Hf.indexOf("android")&&0<=Hf.indexOf("chrome")}function id(){return 3<=(Yb()?Id("firefox/"):
0)}function Id(Hf){var Ei=window.navigator.userAgent.toLowerCase(),Ij=Ei.indexOf(Hf);return 0<=Ij?parseInt(Ei.substring(Ij+Hf.length,Ei.length)):0}function ve(Hf,Ei,Ij,Nk,op){if(Nk&&null!=Ei)Ei();else if(ca())navigator.msLaunchUri(Hf,Ei,Ij);else if(!(Mc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ra())||Qa())be(Hf,Ei,Ij);else if(Mc()&&op)a:{try{window.open(Hf,"_self")}catch(ws){null!=Ij&&Ij();break a}null!=Ei&&Ei()}else $d(Hf,
Ei,Ij)}function $d(Hf,Ei,Ij){var Nk=document.getElementById("OICLinkTag");null==Nk&&(Nk=document.createElement("a"),Nk.id="OICLinkTag",Nk.style.visibility="hidden",Nk.href="",0==(Mq.Options&By.SupportsTopTargetNavigation)||Mq.NoBrowserModalDialogs?Nk.target="_blank":Nk.target="_top",document.body.appendChild(Nk),null!=Nk.addEventListener&&Nk.addEventListener("click",function(op){null!=op.stopPropagation&&op.stopPropagation()},!1));try{Nk.href=Hf,Nk.dispatchEvent(new MouseEvent("click"))}catch(op){null!=
Ij&&Ij();return}null!=Ei&&Ei()}function be(Hf,Ei,Ij){var Nk=document.getElementById("OICFrame");null==Nk&&(Nk=document.createElement("iframe"),Nk.className="ObjectInDialog",Nk.style.visibility="hidden",Nk.src="about:blank",document.body.appendChild(Nk),Nk.id="OICFrame");try{Nk.contentWindow.location.href=Hf}catch(op){null!=Ij&&Ij();return}null!=Ei&&Ei()}function he(Hf){return 0!=(Hf.Options&By.SkipProtocolHandler)||Jb()}function re(Hf){return Hf===wD.ReadOnly||Hf===wD.ReadWrite}function Xf(Hf,Ei,
Ij,Nk){var op;try{var ws=new ActiveXObject("SharePoint.OpenDocuments.4");return(op=ws.ViewDocument3(window.self,Hf,Ei,Nk))?(SE(wC.O14ActiveX),bq.None):bq.Failed}catch(Mr){}if(By.O14Only===(Ij&By.O14Only))return Mq.DescriptiveUnattemptedEnums?bq.O14AttemptFailure:bq.Unattempted;try{return ws=new ActiveXObject("SharePoint.OpenDocuments.3"),(op=ws.ViewDocument3(window.self,Hf,Ei,Nk))?(SE(wC.O12ActiveX),bq.None):bq.Failed}catch(Mr){}if(By.O12UpOnly===(Ij&By.O12UpOnly))return Mq.DescriptiveUnattemptedEnums?
bq.O12UpOnlyFail:bq.Unattempted;try{return ws=new ActiveXObject("SharePoint.OpenDocuments.2"),(op=re(Ei)?ws.ViewDocument2(window.self,Hf,Nk):ws.EditDocument2(window.self,Hf,Nk))?(SE(wC.O11ActiveX),bq.None):bq.Failed}catch(Mr){}return Mq.DescriptiveUnattemptedEnums?bq.ActiveXUnattempted:bq.Unattempted}function Mg(Hf,Ei,Ij,Nk,op){Hf==yr.Visio&&Ij==wD.ReadWrite&&(Ij=wD.WriteOnly);Nk=Nk||r()&&!P();if(!Nk){Nk="";if(Hf==yr.PowerPoint){Hf=Nk;Nk=Mq.DocumentExtension;Ij=re(Ij);var ws=new Set([".pot",".potm",
".potx"]),Mr=new Set([".pps",".ppsm",".ppsx"]);Ij=Ij&&ws.has(Nk)?"nft|ofc|":Ij&&Mr.has(Nk)?"ofv|ofs|t|":!Ij&&Mr.has(Nk)?"ofe|ofs|t|":Ij?"ofv|ofc|":"ofe|";Ij=Hf+Ij}else Ij=re(Ij)?Nk+"ofv|ofc|":Nk+"ofe|";Nk=Ij;Mq.NewTelemetryDataIsEnabled&&(Ij=Mq.SessionOrigin?"or|"+Mq.SessionOrigin+"|":"",Ij+=Mq.ClickTime?"ct|"+Mq.ClickTime+"|":"",Ij+=Mq.CorrelationId?"cid|"+Mq.CorrelationId+"|":"",Nk+=Nm(Ij));op+=Nm(Nk+"u|")}op+=Nm(Ei);Ei=window.location.href;Ij=Ei.toLowerCase().indexOf("&wdlor=");-1!=Ij?(Ij+=7,Hf=
Ei.indexOf("&",Ij),Ei=-1==Hf?Ei.substr(Ij):Ei.substring(Ij,Hf)):Ei=void 0;if(null!=Ei&&"undefined"!=typeof Ei){Ij="";try{Ij=decodeURIComponent(Ei)}catch(TE){}0<Ij.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ij)&&(op=op+"|f|"+Ij)}return op}function $l(Hf,Ei,Ij,Nk,op,ws){var Mr=lJ(Hf);if(null==Mr)return bE(Mq.DescriptiveUnattemptedEnums?bq.ProtocolHandlerIsNull:bq.Unattempted,Mq.Application),!1;Hf=Mg(Hf,Ei,Ij,Nk,Mr);ve(Hf,zp,vv,op,ws);return!0}function Nm(Hf){if(ra()&&
Mc()){var Ei="";try{Ei=decodeURI(Hf)}catch(Ij){}if(Ei==Hf)return encodeURI(Hf)}return Hf}function zp(){SE(wC.ProtocolHandler)}function vv(){Mq.Options|=By.SkipProtocolHandler;mJ(Mq,UE,VE)}function cD(){null!=tH&&tH(wC.RoamingProtocolHandler)}function sB(){null!=uH&&uH(bq.ControlNeeded)}function ZD(){var Hf=document.getElementById("npSharePointPlugin");if(null==Hf){Hf="application/x-sharepoint";ra()&&3<=(fc()?Id("version/"):0)&&zz("application/x-sharepoint-webkit",!0)&&(Hf="application/x-sharepoint-webkit");
if(!zz(Hf,!0))if(ra()&&zz("application/officelive",!0))Hf="application/officelive";else return null;var Ei=document.createElement("object");Ei.id="npSharePointPlugin";Ei.type=Hf;Ei.style.width="0px";Ei.style.height="0px";Ei.style.setProperty("visibility","hidden","");document.body.appendChild(Ei);Hf=document.getElementById("npSharePointPlugin")}return Hf}function zz(Hf,Ei){var Ij=window.navigator.mimeTypes;if(null==Ij)return!1;Hf=Ij[Hf];return!Hf||Ei&&!Hf.enabledPlugin?!1:!0}function AG(Hf){try{if(null!=
new ActiveXObject(Hf))return!0}catch(Ei){}return!1}function vH(Hf){switch(Hf){case yr.OneNote:return"OneNote.Notebook";default:return""}}function lJ(Hf){if(Hf!=yr.OneNote&&r()&&!P())return"office:";switch(Hf){case yr.Excel:return"ms-excel:";case yr.OneNote:return"onenote:";case yr.PowerPoint:return"ms-powerpoint:";case yr.Visio:return"ms-visio:";case yr.Word:return"ms-word:";case yr.Project:return"ms-project:";case yr.Publisher:return"ms-publisher:";case yr.Infopath:return"ms-infopath:";case yr.Access:return"ms-access:";
default:return""}}function LM(Hf){switch(Hf){case yr.Excel:return"root\\office15\\excel.exe";case yr.PowerPoint:return"root\\office15\\powerpnt.exe";case yr.Visio:return"root\\office15\\visio.exe";case yr.Word:return"root\\office15\\winword.exe";case yr.Project:return"root\\office15\\winproj.exe";case yr.Publisher:return"root\\office15\\mspub.exe";case yr.Infopath:return"root\\office15\\infopath.exe";case yr.Access:return"root\\office15\\msaccess.exe";default:return null}}function mJ(Hf,Ei,Ij){Mq=
Hf;UE=Ei;VE=Ij;if(Hf.DocumentUrl){var Nk=Ij=Ei=Hf.DocumentUrl;try{Nk=decodeURIComponent(Hf.DocumentUrl)}catch(WE){}try{Ij=encodeURI(Hf.DocumentUrl)}catch(WE){}Ei=Ei+""+Hf.CorrelationIdForWinClient;Nk+=Hf.CorrelationIdForWinClient;Ij+=Hf.CorrelationIdForWinClient;Hf.Mode===wD.ReadWrite&&By.CheckoutRequired===(Hf.Options&By.CheckoutRequired)&&(Hf.Mode=wD.ForceCheckout);By.HostIsEditOnly===(Hf.Options&By.HostIsEditOnly)&&(Hf.Mode=wD.WriteOnly);if(he(Hf)?0:ra()&&(Hf.Application==yr.OneNote||zz("application/x-sharepoint-protocolhandler",
!1)||zz("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Wc()||!(b()||id()||"ActiveXObject"in window&&!r()||Mc())||15<=BG())$l(Hf.Application,Hf.EncodeUrl?Ij:Ei,Hf.Mode,Hf.Application==yr.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen);else{var op;if(op=Jb())a:{var ws=Hf.EncodeUrl?Ei:Nk,Mr=Hf.Mode,TE=vH(Hf.Application);try{op=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,ws,Mr,TE);break a}catch(WE){}op=!1}if(op)SE(wC.O15ActiveX);else{if(b()||
id()){var Jt=Hf.EncodeUrl?Ei:Nk;Nk=Hf.Mode;op=vH(Hf.Application);ws=ZD();if(null==ws)Jt=Mq.DescriptiveUnattemptedEnums?bq.PluginIsNull:bq.Unattempted;else{Mr=!1;try{Mr=ws.ViewDocument3(window.self,Jt,Nk,op)}catch(WE){}if(!Mr)try{Mr=re(Nk)?ws.ViewDocument2(window.self,Jt,op):ws.EditDocument2(window.self,Jt,op)}catch(WE){}Mr?(SE(wC.NpapiPlugin),Jt=bq.None):Jt=bq.Failed}}else{try{Jt=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Jt&&Jt.SaveSSOCreds()}catch(WE){}Jt=Xf(Hf.EncodeUrl?Ei:Nk,Hf.Mode,Hf.Options,
vH(Hf.Application))}if(Jt!=bq.None){if(Nk=Hf.CouldUseRoamingApps)nJ||(nJ=!0,oJ=B("Windows NT")),Nk=6.1<=oJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(mb()||id()||Mc());if(Nk&&Hf.Application!=yr.OneNote){if(!vD.Zpc.E$o()){bE(bq.ControlNeeded,Mq.Application);return}if(Hf.RoamingAppsLauncher){"undefined"==typeof Hf.RoamingAppsLauncher||null==Hf.RoamingAppsLauncher?bE(Mq.DescriptiveUnattemptedEnums?bq.RoamingLauncherIsNull:bq.Unattempted,Mq.Application):"undefined"==typeof Hf.RoamingBitsUrl||
null==Hf.RoamingBitsUrl?vD.Zpc.Cbp(Hf.DocumentUrl,Hf.RoamingAppsLauncher,Hf.Application,Hf.ApplicationParameters,UE,VE):vD.Zpc.mQj(Hf.DocumentUrl,Hf.RoamingAppsLauncher,Hf.RoamingApplicationExe,Hf.ApplicationParameters,Hf.RoamingPlatform,Hf.RoamingBitsUrl,UE,VE);return}if(!Hf.ContinueIfLauncherIsNull){bE(bq.LauncherNeeded,Mq.Application);return}}By.NoProtocolHandlerFallback==(Hf.Options&By.NoProtocolHandlerFallback)||he(Hf)||mb()||ra()&&!(Mq.DescriptiveUnattemptedEnums?Jt>=bq.O14Unattempted&&Jt<=
bq.DocumentUrlIsNull:Jt==bq.Unattempted)?bE(Jt,Mq.Application):$l(Hf.Application,Hf.EncodeUrl?Ij:Ei,Hf.Mode,Hf.Application==yr.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen)}}}}else bE(Mq.DescriptiveUnattemptedEnums?bq.DocumentUrlIsNull:bq.Unattempted,Mq.Application)}function SE(Hf){null!=UE&&UE(Hf)}function bE(Hf,Ei){"undefined"==typeof Ei&&(Ei=null);null!=VE&&VE(Hf,Ei)}function BG(){var Hf=0;if(b()||id()||Mc()){var Ei=ZD();try{null!=Ei&&(Hf=Ei.GetOfficeVersion())}catch(Ij){}}else AG("SharePoint.OpenDocuments.5")?
Hf=15:AG("SharePoint.OpenDocuments.4")?Hf=14:AG("SharePoint.OpenDocuments.3")?Hf=12:AG("SharePoint.OpenDocuments.2")&&(Hf=11);return Hf}function pJ(){return ra()&&(zz("application/x-sharepoint",!0)||zz("application/x-sharepoint-webkit",!0))}var qJ="",rJ="",sJ="",UE,VE,tH,uH,Mq,nJ,oJ,jJ,kJ,wD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},By={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
bq={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},wC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},yr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:wD,OpenDocumentOptions:By,OpenDocumentFailureType:bq,OpenDocumentControl:wC,OfficeApplication:yr,EditDocumentInClient:mJ,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=yr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:BG,IsO14MacPluginInstalled:pJ,OfferOfficeInDialog:function(){return h()&&11>=BG()},OfferOfficeNoIntrusive:function(){return h()&&15>BG()},OfferMacOffice:function(){return ra()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!pJ()},InstallRoamingControl:function(){Yb()?window.InstallTrigger.install({Office:{URL:rJ}}):be(sJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(Mc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Yb()){var Hf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Hf);var Ei=document.createEvent("Events");Ei.initEvent("RoamingOfficeInstalled",!0,!1);Hf.dispatchEvent(Ei);
return!!Hf.getAttribute("installed")}if(mb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Ij){}return!1},InitUrls:function(Hf,Ei,Ij){qJ=Hf;rJ=Ij;sJ=Ei},LaunchRoamingApps:function(Hf,Ei,Ij,Nk,op,ws){vD.Zpc.mQj(Hf,Ei,LM(Ij),Nk,"x86",qJ,op,ws)},LaunchRoamingApps2:function(Hf,Ei,Ij,Nk,op,ws,Mr,TE){var Jt="";null!=Nk&&(Jt+=" "+Nk);null!=Hf&&(Jt+=' "'+Hf+'"');if(ca()||Mc())tH=Mr,uH=TE,Mr='office: "'+(ws+'" "')+(Ij+'" "ROAMING"'),Mr+=' "'+Ei+'"',Mr+=' "'+op+'"',Mr+=
" "+Jt,ve(Mr,cD,sB,!1,!1);else if(Yb())Hf=document.createElement("RoamingExtensionElement"),Hf.setAttribute("cabUrl",ws),Hf.setAttribute("app",Ij),Hf.setAttribute("licensingEntitlements",Ei),Hf.setAttribute("platform",op),Hf.setAttribute("args",Jt),document.documentElement.appendChild(Hf),Ei=document.createEvent("Events"),Ei.initEvent("RoamingOfficeLaunch",!0,!1),Hf.dispatchEvent(Ei),null!=Mr&&Mr(wC.RoamingFFExtension);else if(mb()){if(Hf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Hf)try{Hf.HrConfigureSingle(ws,Ij,Ei,op,Jt),null!=Mr&&Mr(wC.RoamingActiveX)}catch(WE){}}else null!=TE&&TE(bq.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:$d,OpenDocumentWithProtocolHandler:$l,OpenDocumentWithProtocolHandlerNoCallBack:function(Hf,Ei,Ij,Nk){var op=lJ(Hf);if(null==op)return bE(Mq.DescriptiveUnattemptedEnums?bq.ProtocolHandlerNoCallbackIsNull:bq.Unattempted,Mq.Application),!1;Hf=Mg(Hf,Ei,Ij,Nk,op);ve(Hf,null,null,!1,!1);return!0}}}();vD.ClientUtils=
vD.Zpc;var MM=c(1507);class CG{constructor(b,h,r){this.ga=b;this.o9j=h;this.q7=r}Ub(){this.ga.qa(eb.a.tryMacOffice,Gd.a.frame,Object(z.a)(this,this.uwn,"onTryMacOffice"));this.ga.qa(eb.a.nDj,Gd.a.frame,Object(z.a)(this,this.DZi,"onTryMacOfficeFromViewer"));this.ga.qa(eb.a.mDj,Gd.a.frame,Object(z.a)(this,this.DZi,"onTryMacOfficeFromViewer"))}uwn(b,h,r,B,P){if(1===r)return 32;P?(b=P.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Qd.a.vm(ka.a.M2a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===b&&Qd.a.vm(ka.a.M2a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.PGi();return 32}DZi(b,h,r){if(1===r)return 32;switch(b){case eb.a.nDj:Qd.a.vm(ka.a.M2a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case eb.a.mDj:Qd.a.vm(ka.a.M2a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}PGi(){Qd.a.vm(CG.o$m,"_blank",void 0,"LaunchMacTrialWindow")}get P$c(){return this.o9j&&ba.a.el&&!ba.a.xHf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Vto(){const b=
this.P$c;b||v.AFrameworkApplication.Wl.vho();return b}get Uto(){return this.P$c}static get o$m(){return ka.a.d9("522401")}}Object(n.a)(CG,"MacOfficeOffer",null,[1184]);class DG{constructor(b,h,r){this.ga=b;this.u9j=h;this.zI=null;(this.vAd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{this.zI=B});this.q7=r}Ub(){this.ga.qa(eb.a.tryOffice,
Gd.a.frame,Object(z.a)(this,this.vwn,"onTryOffice"));this.ga.qa(eb.a.Aog,Gd.a.frame,Object(z.a)(this,this.Aog,"tryOfficeThroughTellMe"));this.ga.qa(eb.a.sDj,Gd.a.frame,Object(z.a)(this,this.tDj,"tryOfficeThroughViewer"));this.ga.qa(eb.a.rDj,Gd.a.frame,Object(z.a)(this,this.tDj,"tryOfficeThroughViewer"))}vwn(b,h,r,B,P){if(this.vAd&&1===r)return this.isFreemiumUpsellEnabled&&this.Q$c?32:8;2===r&&(P?(b=P.SourceControlId,"btnjTryOfficeForWordEditor"===b?Qd.a.vm(ka.a.M2a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===b?Qd.a.vm(ka.a.M2a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.OKf()):this.OKf());return 32}Aog(b,h,r,B,P){if(this.vAd&&1===r)return this.isFreemiumUpsellEnabled&&this.Q$c?32:8;2===r&&(P?(b=P.SourceControlId,Qd.a.vm(ka.a.d9("862405")+this.S9l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Qd.a.vm(ka.a.d9("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}tDj(b,h,r){if(this.vAd&&1===r)return this.isFreemiumUpsellEnabled&&
this.Q$c?32:8;if(2===r)switch(b){case eb.a.sDj:Qd.a.vm(ka.a.M2a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case eb.a.rDj:Qd.a.vm(ka.a.M2a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get ykn(){return this.Q$c}get xkn(){return this.Q$c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get Q$c(){return this.u9j&&!ba.a.el}get isFreemiumUpsellEnabled(){let b=!1;this.zI&&(b=this.zI.isFreemiumUpsellEnabled());return b}OKf(b=null){let h=0;b&&(h=b);Qd.a.vm(DG.s3l(h),"_blank",void 0,"LaunchOfficeOffer")}S9l(b){let h=
0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static s3l(b){if(ba.a.vi)switch(b){case 1:return ka.a.d9("393806");case 2:return ka.a.d9("393810");case 3:return ka.a.d9("393809");case 5:return ka.a.d9("393805")}else if(ba.a.QG)switch(b){case 1:return ka.a.d9("521979");case 3:return ka.a.d9("521980");case 5:return ka.a.d9("521978");case 2:return ka.a.d9("522490")}else{if(2===b)return ka.a.d9("517778");
if(1===b)return ka.a.M2a(30)}return ka.a.d9("522402")}}Object(n.a)(DG,"OfficeTrialExperience",null,[1183]);class tJ{wc(b){b.register(DG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Ud(()=>new DG(v.AFrameworkApplication.va,v.AFrameworkApplication.cHf,v.AFrameworkApplication.lcid));b.register(CG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Ud(()=>new CG(v.AFrameworkApplication.va,v.AFrameworkApplication.rAi,v.AFrameworkApplication.lcid))}}
Object(n.a)(tJ,"OpenInClientConfiguration",null,[2]);class uJ{constructor(b=!1,h=!1,r=!1,B=!1,P=!0,ca=!1,ra=!0,Qa=!0,mb=!0,Jb=!1,Yb=!1,fc=!1,Mc=!1,Wc=!1,id=!1,Id=!1,ve=!1,$d=!1,be=null,he=null,re=null,Xf=null,Mg=null,$l=null,Nm=null,zp=null,vv=null){this.Ecc=!1;this.qfk=b;this.vfk=h;this.Mjk=r;this.Kjk=B;this.Fjk=P;this.Gjk=ca;this.Ijk=ra;this.Jjk=Qa;this.Hjk=mb;this.Xjk=Jb;this.rkk=Yb;this.Wjk=fc;this.Mlk=Mc;this.Qjk=Wc;this.C7j=id;this.kkk=Id;this.skk=ve;this.$Yj=$d;this.Ojk=be;this.Vjk=he;this.Ljk=
Mg;this.Tjk=re;this.Njk=Xf;this.Sjk=$l;this.Ujk=Nm;this.Pjk=zp;this.Rjk=vv}get x1i(){return this.qfk}get zCn(){return this.vfk}get Oqj(){return this.Mjk}get Nqj(){return this.Kjk}get hto(){return this.Fjk}get ito(){return this.Gjk}get kto(){return this.Ijk}get lto(){return this.Jjk}get jto(){return this.Hjk}get Bqb(){return this.Qjk}get oDm(){return this.C7j}get vrj(){return this.kkk}get Yrj(){return this.skk}get rUk(){return this.$Yj}get Rqj(){return this.Xjk}get ovo(){return this.rkk}get uto(){return this.Wjk}get Dxj(){return this.Mlk}get Pqj(){return this.Ojk||
Object(z.a)(this,this.bkc,"returnFalse")}get tto(){return this.Vjk||Object(z.a)(this,this.bkc,"returnFalse")}get sto(){return this.Tjk||Object(z.a)(this,this.pag,"returnTrue")}get nto(){return this.Njk||Object(z.a)(this,this.pag,"returnTrue")}get mto(){return this.Ljk||Object(z.a)(this,this.bkc,"returnFalse")}get rto(){return this.Sjk||Object(z.a)(this,this.pag,"returnTrue")}get Qqj(){return this.Ujk||Object(z.a)(this,this.bkc,"returnFalse")}get oto(){return this.Pjk||Object(z.a)(this,this.bkc,"returnFalse")}get qto(){return this.Rjk||
Object(z.a)(this,this.bkc,"returnFalse")}pag(){return!0}bkc(){return!1}}Object(n.a)(uJ,"HtmlTranslatorSettings",null,[790]);class uB{constructor(b,h,r,B,P,ca,ra){this.Xf=b;this.jg=h;this.uX=r;this.xkf=B;this.Ej=P;this.Qd=ca;this.yR=ra}vEm(b,h){var r;b=h.view;h=h.ik;if(!h||!this.Xf.fyi(h,!0)||this.xkf&&this.xkf.instance&&this.xkf.instance.TU(h))return 2;var B=uB.D8a?!uB.z0.Lxa(h):!0;this.uX&&B&&this.uX.Goc(h.node,kc.a.Rs,h.cpBegin);B=h.node;(null===(r=this.yR)||void 0===r?0:r.replaceText)&&this.yR.Idc(B)?
(r=B.ra.E1a(h.cpBegin),this.yR.replaceText(B,r,r,Sr.a.e_c)):this.jg.kia(h,P=>new Sr.a(P));if(this.Qd.yg){r=new sg.GraphTransaction(15);try{r.Db(h.node),this.Ej.yra(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}B=h.node;r=h.cpEnd+1;" "===Td.ParagraphReader.text(B).charAt(r)&&(B=Se.a.createTextRange(B,r,r+1),this.jg.Ge(B,"\u00a0"));h=Se.a.Uc(h.node,r);b.mb.Ac(Fe.SelectionFactory.Xn(h));return 32}static get z0(){return null!=uB.DBg?uB.DBg:uB.DBg=Ya.a.instance.resolve("Box4.IHyperlinkStrategy")}static get D8a(){null==
uB.Ama&&(uB.Ama=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return uB.Ama}}uB.Ama=null;Object(n.a)(uB,"InsertLineBreakStrategy",null,[]);class iw{static get Pf(){return null!=iw.oFg?iw.oFg:iw.oFg=Ya.a.instance.resolve("Box4.IOutlineElementEditor")}static get ah(){return Im.ContextSetEditor.instance}static get Ej(){return null!=iw.IIg?iw.IIg:iw.IIg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Qd(){return null!=
iw.lJg?iw.lJg:iw.lJg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static TEm(b,h,r,B,P){if(P&&P.hasProperty(Zc.a.targetObject)){var ca=h.view.ed.Mc.Eb(P.getValue(Zc.a.targetObject));ca=Se.a.create(ca)}else ca=iw.ah.YT(h.ik,11);if(!ca)return 8;b=v.AFrameworkApplication.va.Mf(ca,b,r,!0,B,P);if(32===b&&2===r){if(!h.view.ue)return 2;h=h.view;B=h.mb.qg;if(B=iw.ah.YT(B,11)){r=new al.a;r.set(B.node);r.od();if(P&&P.hasProperty(Zc.a.targetObject))for(P=P.tf(Zc.a.targetObject);!r.currentNode.id.equals(P)&&
r.sc()&&(hg.OutlineElementNavigator.Yd(r),11===r.Xe););hg.OutlineElementNavigator.g1(r,!1,!1);P=Pd.SelectionEditor.dFa(r,!0);P=Td.ParagraphReader.Bt(P)?Fe.SelectionFactory.ne(P,0):Fe.SelectionFactory.Dq(P);h.mb.Ac(P)}}return b}static rYd(b,h,r,B,P){b=b===Mb.a.uVc;h=h.node;if(P&&P.hasProperty(Zc.a.targetObject)&&!h.id.equals(P.tf(Zc.a.targetObject)))return 2;if(1===r)return 32;r=new xd.GraphIterator;r.set(h);r.zb(10);iw.Pf.Oy(r,b,!0);iw.Qd.yg&&(r=hg.OutlineElementNavigator.Ee(r),iw.Ej.MQb(r,1));return 32}}
Object(n.a)(iw,"InsertOutlineElementStrategy",null,[]);class EG{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.pti=(fc,Mc,Wc)=>{var id,Id;if(null===(id=this.Baa)||void 0===id?0:id.Sqb)return this.Baa.Sqb(Wc,Mc.cpBegin,{Fb:Mc.Fb,Sb:Mc.Sb});id=!Mc.cpBegin;Wc=Mc.cpBegin===Td.ParagraphReader.textLength(Wc);const ve=!(null===(Id=qe.App.zd)||void 0===Id||!Id.Uo);let $d=!0;ve&&id&&!Wc?($d=!1,Id=new xd.GraphIterator,Id.kd(fc),Id.od(),this.rh.Oy(Id,!0,!1)):Id=this.rh.ppa(fc);this.rh.S$(fc,Id,Mc,!1,!0,$d,!1,
!0);!ve||id||Wc||(fc=Im.ContextSetEditor.instance.mRd(Mc),qe.App.zd.fq.iG(fc));return Id};this.FZ=h;this.z2j=b;this.gA=ca;this.Dak=P;this.rh=r;this.r0j=B;this.Nk=ra;this.hb=Qa;this.ME=mb;this.etc=Jb;this.Baa=Yb}yhn(b,h,r,B,P){if(!h.view.ue)return 2;h=h.view;let ca=null;h.$i&&(ca=h);const ra=h.mb.qg;var Qa=!0;let mb=!1,Jb=null;if(!ra)return 2;const Yb=new sg.GraphTransaction(15);Yb.Db(h.ed);let fc=null;2===r&&(fc=new al.a,fc.set(ra.node),fc.od(),Jb=new Ky.a(fc),hg.OutlineElementNavigator.Yd(fc),Qa=
Zf.OutlineElementReader.isEmpty(fc,!1),{frj:Qa,uLj:mb}=this.r0j.grj(fc,Qa,uu.a.TGb,-1,ra));b=v.AFrameworkApplication.va.Mf(ra,b,r,!1,B,P);Qa&&32===b&&2===r&&(mb||hg.OutlineElementNavigator.wHa(fc,!1,!Pd.SelectionEditor.Ze(ra),!1),mb&&Jb&&Jb.restore(fc),this.gA.freeze(),(r=Fe.SelectionFactory.Eo(fc.currentNode,!0))||t.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.mb.Ac(r),this.gA.BJa(),this.z2j.vg.sF());ca&&(Qa||ca.D1(),ca.we&&ca.UU&&(ca.we.qI=!0));Iy.GrippersManager.instance.cTb(1);
Yb.dispose();return b}newLine(b,h,r){b=!1;if(ye.ImageReader.S4(h)||ye.ImageReader.i4a(h))h=this.M7k(h),b=!0;const B=h;if((h=Pd.SelectionEditor.Ze(h))&&this.Nk.jh&&!this.Nk.uRm(B))return 2;if(1===r)return 32;const P=B.node,ca=new xd.GraphIterator;ca.set(P);ca.od();hg.OutlineElementNavigator.Yd(ca);r=new sg.GraphTransaction(15);r.Ut(ca);h?(this.etc.instance&&this.etc.instance.RJa(B),Td.ParagraphReader.Xb(P)&&B.cpBegin===Td.ParagraphReader.textLength(P)&&xo.m(B)&&9===Td.ParagraphReader.Qwa(P)&&this.gA.K8k(B),
rg.ListItemReader.lg(ca)?this.Dak.execute(ca,B,P,this.pti):this.pti(ca,B,P),this.FZ&&this.FZ.Goc(P,kc.a.Rs,B.cpBegin),b&&(hg.OutlineElementNavigator.ns(ca,!1,!1),b=ca.Tb(2),(b=this.ME.ne(b,0))&&this.hb.Ac(b))):this.rh.Oy(ca,!0,!0);r.dispose();ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().updateCommandUI();return 32}M7k(b){if(ye.ImageReader.S4(b))var h=Se.a.Uc(b.node,b.cpBegin);else{h=Td.ParagraphReader.XQ(b.node);var r=h.properties.tf(Oc.a.uq);b=b.node.properties.getValue(Oc.a.runId);
r=EG.$pf(b,r,h.ra);h=Se.a.Uc(h,r)}return h}static Elf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static $pf(b,h,r){let B=0;b=EG.Elf(b,h);let P=0;if(b===h.length)P=r.length-1;else for(;P<r.length;){h=r.J(P);if(h.formatting&&h.formatting.pe===b)break;P++}P<r.length&&(B=r.J(P).cp);return B}}Object(n.a)(EG,"NewLineStrategy",null,[]);class cE{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id,Id){this.Pm=null;this.Nma=b;this.rld=ra;this.rsd=new EG(this,h,r,B,P,ca,Qa,Yb,fc,id,Id);this.T_g=new uB(Qa,
mb,h,Jb,Mc,Wc,Id)}get vg(){return this.Pm||(this.Pm=this.Nma())}Ub(){const b=v.AFrameworkApplication.va,h=Object(z.a)(this.rsd,this.rsd.newLine,"newLine");b.fb(Mb.a.enter,zc.a.view,Object(z.a)(this.rld.value,this.rld.value.Ayl,"enterView"),1124);b.fb(Mb.a.mqj,zc.a.view,Object(z.a)(this.rld.value,this.rld.value.Rro,"shiftEnterView"),1124);b.qa(Mb.a.newLine,zc.a.view,Object(z.a)(this.rsd,this.rsd.yhn,"newLineView"));b.qa(Mb.a.newLine,zc.a.Tc,h);b.qa(Mb.a.newLine,zc.a.image,h);b.qa(Mb.a.newLine,zc.a.Fd,
h);b.qa(Mb.a.newLine,zc.a.W7,h);b.qa(Mb.a.newLine,zc.a.Ohb,h);b.qa(Mb.a.newLine,zc.a.ink,h);b.qa(Mb.a.newLine,zc.a.paragraph,h);b.qa(Mb.a.newLine,zc.a.iFrame,h);b.qa(Mb.a.newLine,zc.a.unsupportedObject,h);b.Xc(Mb.a.newLine,1124);b.fb(Mb.a.qVc,zc.a.view,Object(z.a)(this.T_g,this.T_g.vEm,"insertLineBreakView"),1028);b.qa(Mb.a.uVc,zc.a.view,iw.TEm);b.qa(Mb.a.uVc,zc.a.KP,iw.rYd);b.Xc(Mb.a.uVc,1092)}static get instance(){return null!=cE.GCg?cE.GCg:cE.GCg=cE.fm()}static fm(){return new cE(()=>Ya.a.instance.resolve("Box4.IUndoManager"),
Ya.a.instance.Oa("Box4.IAutoCorrectScheduler"),Ya.a.instance.resolve("Box4.IOutlineElementEditor"),Ya.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ya.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ya.a.instance.resolve("Box4.IInsertionPointFormatting"),Ya.a.instance.Ve("Box4.Actors.IEnterViewStrategy"),xj.a.instance,Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.Sa("Box4.IExternalSelectionManager"),lh.a.instance,Ya.a.instance.resolve("Box4.ISelectionFactory"),
Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.Sa("Box4.IContentControlConverter"),Ya.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(n.a)(cE,"EnterActor",null,[]);var wH=c(1412),xH=c(892);class Bk{static get Sk(){return null!=Bk.WFg?Bk.WFg:Bk.WFg=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get X5(){return null!=Bk.tHg?Bk.tHg:Bk.tHg=Ya.a.instance.Oa("Box4.ISpacingCommands")}static get eVa(){return null!=
Bk.EHg?Bk.EHg:Bk.EHg=Ya.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get v5a(){return null!=Bk.qEg?Bk.qEg:Bk.qEg=Ya.a.instance.Oa("Box4.ILineSpacingHelper")}static get Ej(){return null!=Bk.QIg?Bk.QIg:Bk.QIg=Ya.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Qd(){return null!=Bk.qJg?Bk.qJg:Bk.qJg=Ya.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.ALf,zc.a.view,Lm.a.lw);b.Xc(Mb.a.ALf,1028);b.qa(Mb.a.lD,zc.a.view,Lm.a.lw);
b.qa(Mb.a.lD,zc.a.paragraph,Bk.NDd);b.Xc(Mb.a.lD,1036);b.qa(Mb.a.llc,zc.a.paragraph,Bk.bFk);b.qa(Mb.a.llc,zc.a.view,Lm.a.lw);b.Xc(Mb.a.llc,1036);b.qa(Mb.a.R9c,zc.a.paragraph,Bk.G2e);b.qa(Mb.a.R9c,zc.a.view,Lm.a.lw);b.qa(Mb.a.s$c,zc.a.paragraph,Bk.b3e);b.qa(Mb.a.s$c,zc.a.view,Lm.a.lw);b.qa(Mb.a.Q9c,zc.a.paragraph,Bk.F2e);b.qa(Mb.a.Q9c,zc.a.view,Lm.a.lw);b.qa(Mb.a.Q_e,zc.a.view,Bk.AAk);b.Xc(Mb.a.Q_e,1036);b.qa(Mb.a.N8f,zc.a.view,Bk.f3n);b.Xc(Mb.a.N8f,1036);b.qa(Mb.a.P_e,zc.a.view,Bk.zAk);b.Xc(Mb.a.P_e,
1036);b.qa(Mb.a.M8f,zc.a.view,Bk.e3n);b.Xc(Mb.a.M8f,1036);b.qa(Mb.a.JUa,zc.a.view,Lm.a.lw);b.qa(Mb.a.JUa,zc.a.paragraph,Bk.NDd);b.Xc(Mb.a.JUa,1036);b.qa(Mb.a.IUa,zc.a.view,Lm.a.lw);b.qa(Mb.a.IUa,zc.a.paragraph,Bk.NDd);b.Xc(Mb.a.IUa,1036);b.qa(Mb.a.oke,zc.a.view,Bk.nke);b.qa(Mb.a.oke,zc.a.paragraph,Bk.nke);b.Xc(Mb.a.oke,1028);b.qa(Mb.a.gjg,zc.a.view,Bk.nke);b.qa(Mb.a.gjg,zc.a.paragraph,Bk.nke);b.Xc(Mb.a.gjg,1028);b.qa(Mb.a.fke,zc.a.view,Lm.a.lw);b.qa(Mb.a.fke,zc.a.paragraph,Bk.ovh);b.Xc(Mb.a.fke,1028);
b.qa(Mb.a.eke,zc.a.view,Lm.a.lw);b.qa(Mb.a.eke,zc.a.paragraph,Bk.ovh);b.Xc(Mb.a.eke,1028)}static ovh(b,h,r,B,P){if(1===r)return 32;b===Mb.a.fke?b=Mb.a.JUa:b===Mb.a.eke&&(b=Mb.a.IUa);return Bk.NDd(b,h,r,B,Bk.YBn(P))}static YBn(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new wH.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static nke(b,h,r,B,P){if(2===r){h=P[Gg.a.Text];r=P[Gg.a.Number];P=P.Increment;B=new wH.a;let ca=!1;""===h||P&&h===Box4Intl.Box4Strings.L_SpinnerAuto?
(B.value=0,B.unit=qe.App.LGa?2:4,ca=!0):r||P||(B.value=0,B.unit=1,ca=!0);ca&&(v.AFrameworkApplication.va.Qb(b===Mb.a.oke?Mb.a.JUa:Mb.a.IUa,2,B),ab.StaticActiveAppFrame.za().updateCommandUI())}return 32}static NDd(b,h,r,B,P){if(!({Dy:r}=Lm.a.sgg(r,h)).returnValue)return r;h=h.node;switch(b){case Mb.a.lD:Bk.Sk.lD(h,new xH.a(2,P));break;case Mb.a.JUa:b=new xH.a(P.unit,P.value);Bk.Sk.Xpb(h,b);break;case Mb.a.IUa:b=new xH.a(P.unit,P.value),Bk.Sk.Wpb(h,b)}B&&Ur.a.trb&&(B.Hs|=Ur.a.cjb(h));return 32}static AAk(b,
h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Bk.jii(h);if(!b)return t.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ja(Oc.a.Ui,240)/20)?b:Bk.Qjl;Bk.X5.pea(1,b,4);return 32}static f3n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Bk.X5.pea(1,0,4);return 32}static zAk(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");
b=Bk.jii(h);if(!b)return t.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ja(Oc.a.ua,240)/20;Bk.X5.pea(0,b?b:12,4);return 32}static e3n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Bk.X5.pea(0,0,4);return 32}static G2e(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=h.node;h=null;nq.a.instance.J(1)&&(h=b.aE());Bk.Sk.G2e(b,P);h&&Bk.Ej.GV(b,h,Bk.Qd.yg)}return 32}static b3e(b,h,r,B,P){if(2==r){if("boolean"!==
typeof P)return 16;b=h.node;h=null;nq.a.instance.J(1)&&(h=b.aE());Bk.Sk.b3e(b,P);h&&Bk.Ej.GV(b,h,Bk.Qd.yg)}return 32}static F2e(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=h.node;h=null;nq.a.instance.J(1)&&(h=b.aE());Bk.Sk.F2e(b,P);h&&Bk.Ej.GV(b,h,Bk.Qd.yg)}return 32}static bFk(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=new Map;b.set("Value",P.toString());xa.Health.instance.recordKpiUsage(ti.a.jmb.iMo,0,ti.a.zB,b);h=h.node;b=null;nq.a.instance.J(1)&&(b=h.aE());h.hasProperty(Oc.a.sw)&&
h.removeProperty(Oc.a.sw);Bk.v5a.tRd(h)!==P&&h.setValue(Oc.a.sw,P);(P=Bk.v5a.q$b(h,!0))&&P.nl(4,!0);(P=Bk.v5a.q$b(h,!1))&&P.nl(4,!0);b&&Bk.Ej.GV(h,b,Bk.Qd.yg)}return 32}static jii(b){b=b.view;return b.ue&&(b=b.mb)&&b.ib.lb?Bk.eVa.hp(b.ib.lb.Pa.node):null}}Bk.Qjl=12;Object(n.a)(Bk,"SpacingActor",null,[]);class vJ{process(){}}Object(n.a)(vJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[39]);class wJ{constructor(b){this.Ce=b}Vjo(b,h){b&&h&&h.cache&&(this.Ce.bka(b,h.cache.GG),this.Ce.WA(b,
h.cache.fontSize))}GGb(){return null}zQa(){return null}aac(){return null}yU(){return null}}Object(n.a)(wJ,"FormattingStewardBridge",null,[44]);class xJ{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new vJ).ha();b.ia("Box4.Actors.IFormattingStewardBridge",()=>new wJ(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(n.a)(xJ,"WoncaActorsConfiguration",null,[2]);class yJ{constructor(b,h,r,B,P,ca,ra,Qa){this.ga=b;this.qYj=h;this.pYj=r;this.GNg=B;this.tfk=P;this.$td=ca;this.xfk=
ra;this.yfk=Qa}get oc(){return this.ga}WMk(b){this.oc.Tqa(b,this.qYj,null,null)}UMk(b){this.oc.Tqa(b,this.pYj,null,null)}R_(b,h,r){r?this.oc.Tqa(b,this.GNg,h,null):this.oc.Qb(this.GNg,2,h)}CCn(b,h){this.oc.Tqa(b,this.$td,h,null)}j$(b,h){this.oc.Tqa(b,this.xfk,h,null)}Gob(b,h){this.oc.Tqa(b,this.yfk,h,null)}A0f(b,h=!1){const r=new wc.DictionaryPropertySet;r.setValue(Zc.a.LP,b);r.setValue(Zc.a.S1i,!0);r.setValue(Zc.a.w4a,h);this.oc.Qb(this.tfk,2,r)}}Object(n.a)(yJ,"ClipboardCommands",null,[1558]);class zJ{}
Object(n.a)(zJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1462]);class AJ{constructor(b){this.ga=b}get oc(){return this.ga}rnj(b,h,r){let B=0;b?1===b&&(B=Mb.a.S3a):B=Mb.a.R3a;b=new GD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}Uhe(b,h,r){let B=0;1===b?B=Mb.a.EQb:2===b?B=Mb.a.mqb:b||(B=Mb.a.FQb);b=new GD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}}Object(n.a)(AJ,"IndentationCommands",null,[1495]);var FG;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=
2]="center";b[b.right=3]="right";b[b.bmp=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.nip=7]="distribute";b[b.margin=8]="margin";b[b.Elp=9]="highKashida";b[b.vnp=10]="lowKashida";b[b.Gnp=11]="mediumKashida";b[b.Jop=12]="numTab";b[b.vup=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(FG||(FG={}));Object(n.b)("Justification",FG);class BJ{constructor(b){this.uMa={};this.ga=b;this.Yzm()}get oc(){return this.ga}pE(b){b=this.uMa[FG[b]];void 0!==b&&null!==b&&this.oc.processAction(b,
2)}Yzm(){this.uMa.left=Mb.a.I9;this.uMa.center=Mb.a.Kba;this.uMa.right=Mb.a.z$;this.uMa.both=Mb.a.nFa;this.uMa.lowKashida=Mb.a.wKb;this.uMa.mediumKashida=Mb.a.wKb;this.uMa.highKashida=Mb.a.wKb;this.uMa.distribute=Mb.a.vMc;this.uMa.thaiDistribute=Mb.a.k$c}}Object(n.a)(BJ,"JustificationCommands",null,[1491]);class CJ{constructor(b){this.ga=b}lD(b){this.ga.Qb(Mb.a.lD,2,b)}llc(b){this.ga.Qb(Mb.a.llc,2,b)}R9c(b){this.ga.Qb(Mb.a.R9c,2,b)}s$c(b){this.ga.Qb(Mb.a.s$c,2,b)}Q9c(b){this.ga.Qb(Mb.a.Q9c,2,b)}pea(b,
h,r){this.ga.Qb(b?Mb.a.JUa:Mb.a.IUa,2,Object.assign(new wH.a,{value:h,unit:r}))}}Object(n.a)(CJ,"SpacingCommands",null,[1371]);class DJ{constructor(b,h,r){this.oc=b;this.ZMc=h;this.Jul=r;this.zxn=(B,P,ca)=>{if(1===ca)return this.ZMc.K_?32:8;this.ZMc.y3m();this.Jul().exo(this.ZMc.dXl());return 32}}Ub(){this.oc.fb(Mb.a.lob,zc.a.application,this.zxn,1028)}}Object(n.a)(DJ,"EditorSettingsUIActor",null,[]);class EJ extends Pf.a{constructor(b,h){super(!1,!1,!0);this.Lul=b;this.oSa=h;this.Kul=r=>{1!==r?t.ULS.sendTraceTag(527434075,
340,50,"Editor Settings closed without changes"):(this.Lul.HUo(),t.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async exo(b){const h=await this.oSa.WKb;b={["id"]:"SettingsDialog",["uiLanguage"]:v.AFrameworkApplication.uiCulture,["selectedLanguage"]:Hi.a.ug(v.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.cZc,["editorSettings"]:b};this.Uh(Box4Intl.Box4Strings.l_EditorSettings,this.Kul,b);t.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}
Object(n.a)(EJ,"EditorSettingsDialog",Pf.a,[]);var NM=c(234);class FJ{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id){this.hyb=this.hBc=this.qsc=null;this.OTe=0;this.LFe=!1;this.sa=new wd.a;this.y_d=!1;this.ev=b;this.gA=h;this.Ce=r;this.Xs=B;this.gb=P;this.Hf=ra;this.Md=Qa;this.Nk=mb;this.rd=Jb;this.Vd=Yb;this.zq=fc;this.$W=Mc;this.rz=Wc;this.Lo=id}get mwl(){return this.rd?this.rd.isFeatureEnabled(43):!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get bnf(){return null!=
this.DAg?this.DAg:this.DAg=Ya.a.instance.resolve("Box4.IFormatPainterStrategy")}get FR(){return this.LFe}set FR(b){this.LFe!==b&&(this.LFe=this.y_d=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}oxk(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}E2i(b){const h=b.Pa;t.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var r=h.node;b=this.IAi(b);if(this.bnf.auo(h.contextId,b))try{this.hyb=this.gb.c3a(r)}catch(B){throw t.ULS.sendTraceTag(22832029,
354,10,"GetParagraphProperties error: {0}",B.message),B;}this.hBc=this.rz.hp(r);r=Bn.FormattingReader.Xr(h);r.Jn&&(this.qsc=Object(Na.a)(az.a,r.Jn.clone()));this.OTe=b?zc.a.paragraph:h.contextId}Luh(b){if(b){const r=this.IAi(b);for(let B=0;B<b.length;B++){const P=b.J(B);if(null===P||void 0===P?0:P.al)this.nBb(P,r);else if(0==(null===P||void 0===P?void 0:P.length))t.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",P);else if(P)for(let ca=0;ca<P.length;ca++){var h=
P.getContext(ca);if(null===h||void 0===h?0:h.lx){if(h)for(let ra=0;ra<h.length;ra++)P.addContext(h.getContext(ra))}else(null===h||void 0===h?0:h.al)?this.nBb(h,r):t.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}Puh(b,h){if(h){var r=b.node,B=r.ra.last,P=this.Md.S1a(r),ca=P.wf(P.Lb);this.Quh(P,h,null);nq.a.instance.J(1)&&this.zq.oQb(r,B,b.cpBegin,b.cpEnd,ca,P,this.Vd.yg)}}pFk(b,h,r){if(h||r)0<xo.g(b).length&&t.ULS.sendTraceTag(22832071,354,
50,"User tried to apply format on Blob objects"),this.$W.tX(b,B=>{this.Quh(B,h,r)})}Quh(b,h,r){this.Ce.Lga(b);b.Jn&&b.Jn.removeProperty(Pe.a.highlight);this.Ce.w8e(b);r&&(r=r.clone(),r.Cg(...Do.a.Ica()),this.ax(b,r.Gl()));this.ax(b,h)}ax(b,h){if(h){var r=b.paragraph.Mc;if(r){var B=b.Jn;B=B?Object(Na.a)(Qz.a,B.clone()):az.a.XOa(1179725);for(const ca of h.xl())if(ca!==Oc.a.mw&&ca!==Oc.a.XX&&ca!==Pe.a.UB&&ca!==Pe.a.V4&&ca!==Oc.a.p4a&&ca!==Pe.a.vL&&ca!==Oc.a.o5a&&ca!==Oc.a.noProof){if(ca===xe.a.qw){var P=
h.ja(xe.a.qw,U.a.nil);if(P!==U.a.nil)if(P=r.Eb(P)){if(P=new Gw.a(P),P=this.rz.vR(P),P===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(P=this.rz.ZC(b.paragraph).QFa(P)){B.bPa(P.Gl(),...Do.a.Ica());continue}else t.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else t.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(ca,h.tf(ca))}B.XGa?h=r.uV(B,!0):(r.Xu(B),h=B);b.Xj=h.id}}}IAi(b){return!b.Zw&&
b.Rc.contextId!==zc.a.Vc}reset(){this.hyb=this.hBc=this.qsc=null;this.OTe=zc.a.none}nBb(b,h){if(b.contextId===zc.a.Tc||b.contextId===zc.a.Fd)var r=this.Nk.x9(b);else if(b.contextId===zc.a.paragraph)r=this.Nk.C0d(b);else if(b.contextId===zc.a.Vc)r=this.Nk.j_d(b);else{t.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}t.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)t.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");
else{r=Object(Na.a)(ni.AParagraphNode,b.node);var B=!1;r&&(B=b.contextId===zc.a.Fd&&!!r&&!b.cpBegin&&b.cpEnd===this.gb.textLength(r));if(h=this.bnf.cso(this.OTe,b.contextId,h,B))try{Td.ParagraphReader.Xb(r)?(this.hBc&&this.ev.cK(this.hBc,r,!0),this.Xs.gvh(r,this.hyb)):t.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(P){throw t.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",P.message),P;}B=b;b.contextId===
zc.a.paragraph?B=Se.a.createTextRange(r,0,Td.ParagraphReader.textLength(r)):b.contextId===zc.a.Tc&&(B=this.gA.Uuf(b),B=lh.a.sDb(B));if(B&&B.contextId===zc.a.Fd){if(wn.a.vId){const P=this.Lo.YTd(B);P&&(B=P)}try{this.pFk(B,this.qsc,h?null:this.hBc)}catch(P){throw t.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",P.message),P;}}if(b.contextId===zc.a.paragraph||b.contextId===zc.a.Vc)h=new xd.GraphIterator,h.set(r),h.od(),h.jd(11),B=rg.ListItemReader.lg(h),r=!Td.ParagraphReader.textLength(r),
t.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",B,r),B?(this.Hf.EP(h),this.Hf.hda(h.currentNode)&&this.Puh(b,this.qsc)):this.mwl&&this.Puh(b,this.qsc)}}}Object(n.a)(FJ,"FormatPainter",null,[1524]);var OM=c(112);class dE{constructor(b,h,r,B,P,ca,ra,Qa=!1,mb,Jb,Yb){this.Vpd=!1;this.kCe=new cr.a;this.xpm=()=>{this.dT.FR=!1;return 32};this.ypm=(fc,Mc,Wc)=>{fc=!1;if(Mc=this.qz.y4){switch(Mc.contextId){case zc.a.Fd:case zc.a.paragraph:case zc.a.Vc:case zc.a.Tc:fc=
!0}fc&&Pd.SelectionEditor.vl(Mc)&&xo.b(Mc)&&(this.Ad.Yb(te.a.wn,{["Reason"]:fe.a.UJc}),fc=!1);fc&&Td.ParagraphReader.PU(Mc)&&(this.Ad.Yb(te.a.wn,{["Reason"]:fe.a.zO}),fc=!1)}if(1===Wc||!fc)return fc?32:8;6!==this.ga.LC?(this.dT.FR?t.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(t.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.dT.E2i(this.qz.lb),this.Vpd||(this.Mh.H_a(this.$Fj),(Wc=this.Mh.jb.ju)&&Wc.$i&&Wc.Sqh(this.ZFj),this.Vpd=
!0)),this.dT.FR=!this.dT.FR):(t.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.dT.E2i(this.qz.lb),this.dT.FR=!1);return 32};this.wpm=(fc,Mc,Wc,id,Id)=>{if(6===this.ga.LC||this.dT.FR){t.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.LC);fc=this.Mh.Kq.Yf("UserAction","FormatPainterApply");if(dE.Zb&&dE.Zb.TB(116)){Id=Id?Id.KeepBrushActive:!1;Wc=null;this.qz.lb&&2===this.qz.lb.trigger&&(Id=Id||this.dT.y_d,this.dT.y_d&&
Pd.SelectionEditor.Pl(this.qz.lb)&&(Wc=Pd.SelectionEditor.j0(this.qz.lb.Pa,!1)))&&(Wc.trigger=2);this.dT.y_d=!1;if(Id||2!==this.qz.lb.trigger)Mc=new sg.GraphTransaction(15),Wc&&Wc.Pa?(Mc.set(Wc.Pa.node.yj),this.hb.Ac(Wc)):Mc.set(this.qz.kFb.yj),Wc=Fe.SelectionFactory.Xn(this.hb.qg),this.dT.Luh(Wc),Mc.dispose();this.dT.FR=Id}else Id=new sg.GraphTransaction(15),Id.set(this.qz.kFb.yj),Mc=Fe.SelectionFactory.Xn(this.hb.qg),this.dT.Luh(Mc),this.dT.FR=!1,Id.dispose();fc.stop()}return 32};this.$Fj=()=>{this.p9d(this.dT.FR)};
this.ZFj=()=>{this.p9d(this.dT.FR)};this.Mh=b;this.Vb=h;this.ga=r;this.Ad=B;this.qz=P;this.dT=ca;this.hb=ra;this.J8j=Qa;this.oy=mb;this.Ax=Jb;this.z0j=Yb}get MWg(){return ba.a.Nt||ba.a.V0d?"url("+this.K$h()+"), pointer":'url("'+this.K$h()+'"), pointer'}K$h(){return this.Ax?this.oy.Jwa(Ad.a.xg("FormatPainterText.cur"),Ad.a.xg("FormatPainterTextDarkMode.cur"),new OM.a(Ul.a.hL())):Ad.a.xg("FormatPainterText.cur")}Ub(){const b=this.Vb.fe(xk.AppFrame.VD);b.bindAction(Tb.KeyInputManager.ic(kc.a.fKa,0),
Mb.a.anf);b.bindAction(Tb.KeyInputManager.ic(kc.a.Jsb,6),Mb.a.YPd);this.J8j||b.bindAction(Tb.KeyInputManager.ic(kc.a.Nsb,6),Mb.a.l2a);this.ga.fb(Mb.a.YPd,zc.a.view,this.ypm,1028);this.ga.fb(Mb.a.l2a,zc.a.view,this.wpm,1028);this.ga.fb(Mb.a.anf,zc.a.view,this.xpm,1028);this.dT.oxk(()=>{this.Jqg(this.dT.FR)});this.Ax&&this.z0j.yCd(()=>{this.p9d(this.dT.FR)})}Jqg(b){const h=this.Mh.Kq.Yf("UserAction","FormatPainterUpdateCursor");this.p9d(b);this.Mh.updateCommandUI();h.stop()}YFj(b,h){for(let r=0;r<b.length;r++)this.XFj(b[r],
h);(b=this.Mh.jb.ju)&&b.ue&&this.XFj(b.xh.editingElement,h)}XFj(b,h){b.style.cursor=h?this.MWg:""}p9d(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.MWg;if(this.Mh.jb.isEditingAllowed||this.Mh.jb.Ry){if(b&&!r||!b&&r)this.YFj(h,b),this.wGj(b);b||!this.Vpd||this.kCe.count||(this.Mh.Ubj(this.$Fj),(b=this.Mh.jb.ju)&&b.$i&&b.$1n(this.ZFj),this.Vpd=!1)}else r&&(this.YFj(h,!1),this.wGj(!1))}}wGj(b){const h=this.Mh.jb.ju;h&&(b?this.kCe.add(h.ed.Uk):
this.kCe.remove(h.ed.Uk))}static get Zb(){return null!=dE.yzg?dE.yzg:dE.yzg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(n.a)(dE,"FormatPainterActor",null,[]);class xA{constructor(b,h,r){this.en=r}Ayl(b,h,r,B,P){var ca;if(!({ke:r,selected:ca,Dy:mb,nXc:Qa}=this.prj(h,r,!1)).returnValue)return mb;Me.a.mark(5013);var ra=xA.ah.uO(ca);for(let Jb=0;Jb<ra.length;++Jb){if(!ra[Jb].isValid)continue;const Yb=ra[Jb].iterator;Yb.Ip();if(Dg.OutlineReader.nx(Yb))return this.qYh(r,Yb)}var Qa=wn.a.wId&&Qa?Mb.a.qVc:
this.BXl();if(ca.lx||Pd.SelectionEditor.vl(ca)||Td.ParagraphReader.um(ca)&&!Pd.SelectionEditor.v9(ca)){if(xA.Zb&&xA.Zb.isFeatureEnabled(26)&&Im.ContextSetEditor.instance.nig(ca).returnValue)return 8;var mb=this.rYh(h,r,b,B,P,Qa)}else if(Pd.SelectionEditor.Kk(ca))mb=this.pYh(h,r,b,B,P,Qa);else if(Pd.SelectionEditor.Ze(ca)){mb=new xd.GraphIterator;mb.set(ca.node);mb.zb(10);ra=ch.a.Fz(ca,!1);if(0<ra.length){if(!ra[0].hyperlink)return t.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
ra[0].cpBegin,ra[0].cpEnd),8;qe.App.vFb(ra[0].hyperlink.url);return 32}qh.TableCellReader.P0(mb)&&(Qg.returnToContainingCell(mb),qh.TableCellReader.uia(mb)&&(ra=new xd.GraphIterator,ra.kd(mb),Qg.returnToContainingRow(ra),Dg.OutlineReader.KA(mb,ca,!1)&&Al.a.Byi(ra)&&0>=ca.Fb&&(Qa=Mb.a.uVc,Qg.returnToContainingTable(mb),hg.OutlineElementNavigator.Yd(mb),P||(P=new wc.DictionaryPropertySet),P.Gg(Zc.a.targetObject,mb.currentNode.id))));mb=this.sYh(h,r,b,B,P,Qa)}else Pd.SelectionEditor.v9(ca)&&(mb=v.AFrameworkApplication.va.Mf(h,
Mb.a.newLine,2,!1,B,P));Me.a.mark(5014);return mb}prj(b,h,r){let B=null,P=null,ca=!1;if(1===h)return{returnValue:!1,ke:B,selected:P,Dy:32,nXc:ca};if(!b.view.ue)return{returnValue:!1,ke:B,selected:P,Dy:2,nXc:ca};B=b.view;P=B.mb.qg;return!P||!xA.Xf.fyi(P,r)||wn.a.wId&&xA.Xf.yia(P,ra=>ca=ra)&&!ca?{returnValue:!1,ke:B,selected:P,Dy:2,nXc:ca}:this.en&&this.en.instance&&this.en.instance.TU(P)?{returnValue:!1,ke:B,selected:P,Dy:4,nXc:ca}:{returnValue:!0,ke:B,selected:P,Dy:2,nXc:ca}}Rro(b,h,r,B,P){let ca,
ra;if(!({ke:r,selected:ca,Dy:ra}=this.prj(h,r,!0)).returnValue)return ra;const Qa=xA.ah.uO(ca);for(let mb=0;mb<Qa.length;++mb){if(!Qa[mb].isValid)continue;const Jb=Qa[mb].iterator;Jb.Ip();if(Dg.OutlineReader.nx(Jb))return this.qYh(r,Jb)}ca.lx||Pd.SelectionEditor.vl(ca)?ra=this.rYh(h,r,b,B,P,Mb.a.qVc):Pd.SelectionEditor.Kk(ca)?ra=this.pYh(h,r,b,B,P,Mb.a.qVc):Pd.SelectionEditor.Ze(ca)?ra=this.sYh(h,r,b,B,P,Mb.a.qVc):Pd.SelectionEditor.v9(ca)&&(ra=v.AFrameworkApplication.va.Mf(h,Mb.a.newLine,2,!1,B,
P));return ra}qYh(b,h){b.mb.Ac(Fe.SelectionFactory.Eo(h.currentNode,!1));return 32}rYh(b,h,r,B,P,ca){const ra=new sg.GraphTransaction(15);ra.Uj=r;ra.Db(h.ed);h=new wc.DictionaryPropertySet;h.setValue(Zc.a.BMc,!0);h=v.AFrameworkApplication.va.Mf(b,Mb.a.QH,2,!0,B,h);32===h&&(h=v.AFrameworkApplication.va.Mf(b,ca,2,!1,B,P));ra.dispose();return h}pYh(b,h,r,B,P,ca){const ra=new sg.GraphTransaction(15);ra.Uj=r;ra.Db(h.ed);h.mb.Ac(Pd.SelectionEditor.Jj(h.mb.ib.J(0),!1,!1));b=v.AFrameworkApplication.va.Mf(b,
ca,2,!1,B,P);ra.dispose();return b}sYh(b,h,r,B,P,ca){const ra=new sg.GraphTransaction(15,r);ra.Uj=r;ra.Db(h.ed);b=v.AFrameworkApplication.va.Mf(b,ca,2,!1,B,P);ra.dispose();return b}static get ah(){return Im.ContextSetEditor.instance}static get Xf(){return xj.a.instance}static get Zb(){return null!=xA.uzg?xA.uzg:xA.uzg=Ya.a.instance.Oa("Box4.IFeatureHelper")}}Object(n.a)(xA,"AEnterViewStrategy",null,[1557]);class GJ extends xA{constructor(b,h,r){super(b,h,r)}BXl(){return Mb.a.newLine}}Object(n.a)(GJ,
"EnterViewStrategy",xA,[]);class yH{constructor(b){this.yl=this.transaction=null;this.ke=b;this.fKc=this.yo=0}}Object(n.a)(yH,"SelectAllArguments",null,[]);class eD{constructor(b,h,r){this.Gzn=b;this.$0m=h;this.Yr=r;this.mAl=(B,P,ca)=>P.view.$i?this.cib(P,ca,this.Vvj):this.ddo(P,ca);this.U4c=(B,P)=>P.yo?1===P.yo?(P.ke.mb.d$c(P.yl,B),P.yo=2,!0):2===P.yo?(P.ke.mb.ib.f1a=P.yl.f1a,this.vg.sF(),P.transaction.RIa(B),P.yo=3,P.transaction.dispose(),Me.a.mark(5799),!0):!1:(P.transaction=this.Yr.Pc(2),P.transaction.Db(P.ke.ed),
P.yo=1,!0);this.ddo=(B,P)=>{if(1===P)return 32;if(!B.view.ue)return 2;B=B.view;return B.mb&&B.mb.ib&&B.mb.ib.lb?this.Vvj(B).inProgress?1:32:8};this.Vvj=B=>{v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");B.$i&&t.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");B=new yv.a(null,this.lKn,new yH(B));B.Rl("SelectAllInOutline");B.run();return B};this.lKn=(B,P)=>{if(!P.yo)return P.yl=Fe.SelectionFactory.fdo(P.ke.mb.ib.lb),P.transaction=this.Yr.Pc(2),
P.transaction.Db(P.ke.ed),P.yo=1,!0;if(1===P.yo){if(!P.fKc)return P.ke.mb.Ac(P.yl.J(0),B),++P.fKc,!0;if(P.fKc<P.yl.length)return P.ke.mb.Avk(P.yl.J(P.fKc),B),++P.fKc,!0;P.yo=2}return 2===P.yo?(P.ke.mb.ib.f1a=P.yl.f1a,this.vg.sF(),P.transaction.RIa(B),P.yo=3,P.transaction.dispose(),!0):!1}}get vg(){return this.$0m.value}Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.Oza,Gd.a.frame,eD.psj);b.qa(Mb.a.Yfg,Gd.a.frame,eD.psj);b.fb(Mb.a.cib,zc.a.view,this.mAl,2);b.fb(Mb.a.qDa,zc.a.view,Zd.AFrame.Jg,100);
b.fb(Mb.a.NQf,zc.a.view,eD.NQf,4)}cib(b,h,r){if(1===h)return 32;if(!b.view.ue)return 2;h=b.view;if(!h.mb)return 8;const B=h.mb.ib;if(!B||!B.length)return 8;Me.a.mark(5798);ab.StaticActiveAppFrame.za().jb.isEditingAllowed||ab.StaticActiveAppFrame.za().jb.Ry||h.$i?b=Pd.SelectionEditor.ktf(B):(kb.FocusManager.instance().jD(Zd.AFrame.In),b=Fe.SelectionFactory.Iij(h.ed));if(!b)return 8;B.f1a||t.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.Gzn.KJb(Pd.SelectionEditor.L8h(b))?r=r(h):
(r=new yH(h),r.yl=b,r=new yv.a(null,this.U4c,r),r.Rl("ExpandSelection"),r.run());return r.inProgress?1:32}static get T7a(){return null!=eD.ZGg?eD.ZGg:eD.ZGg=Ya.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static NQf(b,h,r){if(1===r)return 32;if(!h.view.ue)return 8;b=h.view;h=Fe.SelectionFactory.Eo(b.root.graphNode,!0);if(!h)return 8;b.mb.Ac(h);return 32}static psj(){var b=ab.StaticActiveAppFrame.za().jb.ju;if(!b.ue)return 2;if(b.ue&&1!==ab.StaticActiveAppFrame.za().state){Me.a.mark(4668);
var h=b.mb.ib.lb;if(!h&&v.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Pd.SelectionEditor.NQ(h);let r=h.x,B=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,B=b.y;eD.T7a.Oza(new Sys.UI.Point(r,B),1);Me.a.mark(4669)}return 32}}Object(n.a)(eD,"SelectAllHandlers",null,[1376]);class HJ{dhe(){}}Object(n.a)(HJ,"FontNameFormattingStrategyNoop",null,[1525]);var IJ=c(880);class GG{constructor(b,
h,r,B,P,ca){this.$xh=this.cyh=null;this.ps=b;this.Zxh=h;this.MLk=r;this.VLk=B;this.cyh=P;this.$xh=ca}}Object(n.a)(GG,"BookmarkHighlightContext",null,[]);class JJ extends tf.a{constructor(){super()}get Oca(){return!0}get qkb(){return 5}get J3a(){if(null!=this.h3)return this.h3;this.h3=[];this.h3.push(new gh.a(Ck.a.DEd,Ck.a.DEd));this.h3.push(new gh.a(Ck.a.X4e,Ck.a.X4e));this.h3.push(new gh.a(Ck.a.GHc,Ck.a.GHc));return this.h3}QHa(b,h){this.Oca&&Zq.a.instance.ie(()=>{const r=this.Cr.tEa;var B=this.Cr.FZc;
if(r)if(5===r.type){B=r.HA;if(r.WJ&&r.WJ.ps.includes(b))for(const P of h.nIa("*"))this.Cr.UTa(P);B&&B.ps.includes(b)&&this.gqb(h,r.action,B,b)}else B&&5===B.type&&3===r.action&&B.HA.ps.includes(b)&&this.gqb(h,0,B.HA,b)},"BHA:OPHC")}aSa(b){return Object(uc.a)(GG,b)}d3a(b,h){if(b)for(const r of b.ps)h.add(r)}gqb(b,h,r,B){0===h&&b.htmlElement&&Zq.a.instance.ie(()=>{const P=b.nIa("*"),ca=P.length,ra=Ck.a.DEd;var Qa=B.id===r.cyh,mb=B.id===r.$xh;let Jb=!1;var Yb=0,fc=[];const Mc=Array(ca);for(let Id=0;Id<
ca;Id++){var Wc=P[Id];const ve=hf.a(Wc);Mc[Id]=ve;const $d=Wc.classList;if(0!=Mc[Id]){const be=!$d.contains(Ck.a.FG),he=Bc.a.Eb(Wc,Ck.a.JBb);he&&fc.push(...he);if(Qa){let re;if((re=Bc.a.Eb(Wc,Ck.a.FEd))&&he&&1===re.length&&1===he.length&&re[0].equals(he[0]))continue;re&&(Yb+=re.length,1===ve?$d.add(Ck.a.X4e):$d.add(ra));if(he)for(const Xf of he)this.wZd(r,Xf)&&(Yb--,Jb&&$d.add(Ck.a.GHc));0!==Yb&&be&&$d.add(ra)}if(!Qa&&!mb&&r.VLk.has(B.id))if((Wc=Bc.a.Eb(Wc,Ck.a.JBb))&&Jb){$d.add(ra);for(const re of Wc)if(this.wZd(r,
re)){$d.add(Ck.a.GHc);break}}else be&&$d.add(ra)}Jb=!$d.contains(Ck.a.M1a)}if(mb&&!Qa){Qa=new Set;for(var id of fc)this.wZd(r,id)&&Qa.add(id);Jb=!1;for(fc=0;0!==Qa.size&&fc<ca;fc++){Yb=P[fc];id=Yb.classList;if(0!=Mc[fc])if(mb=!1,Yb=Bc.a.Eb(Yb,Ck.a.JBb)){for(const Id of Yb)this.wZd(r,Id)&&(Qa.delete(Id),mb=!0);0!==Qa.size&&id.add(ra);Jb&&mb&&id.add(Ck.a.GHc)}else id.contains(Ck.a.FG)||id.add(ra);Jb=!id.contains(Ck.a.M1a)}}},"BHA:SPH")}wZd(b,h){for(const r of b.MLk)if(h.equals(r))return!0;return!1}}
Object(n.a)(JJ,"BookmarkHighlightActor",tf.a,[617]);var HG=c(1892),RF;(function(b){b[b.jsonToDocumentXml=0]="jsonToDocumentXml";b[b.documentXmlToJson=1]="documentXmlToJson";b[b.documentXmlToThemeJson=2]="documentXmlToThemeJson";b[b.unsupported=3]="unsupported"})(RF||(RF={}));Object(n.b)("GraphicsEditorConversionRequestType",RF);var KJ=c(1675);class IG{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.Zf=b;this.lA=h;this.gb=P;this.dW=ca;this.Vj=ra;this.je=Qa;this.rd=Jb;this.Ca=mb}xcg(b,h,r,B){const P=b.Gnh(h);
if(P){var ca=Object(uc.a)(KJ.a,b),ra=this.je.Yf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,r)),Qa=h.ik.node,mb=()=>{r||this.removeImage(h.ik,P.getId())};ca=IG.rzh();B=this.Ozh(P.getId().toString(),Qa,B,r);try{b.Vth(B,h)}catch(Jb){t.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Jb.message);this.Ep(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
return}this.Zf.nj(ca,2,B.toString(),{},!0,0,Jb=>{t.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.phc(Jb,P,()=>{this.Ep(b.tUd())},mb,Qa,h,ra)},Jb=>{const Yb=415===Jb.data.Ne;let fc="";Jb&&Jb.data&&Jb.data.jj&&"X-CorrelationId"in Jb.data.jj&&Jb.data.jj["X-CorrelationId"]&&(fc=Jb.data.jj["X-CorrelationId"]);b.Bqa(`Graphics editor request failed. HttpStatus [${Jb.data.Ne}], ResponseData [${Jb.data.te}], CorrelationId [${fc}]`,
P,Qa,mb,()=>{this.Ep(Yb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.tUd())},ra,Yb)},null)}else this.Ep(b.tUd())}Meo(b,h,r){return new Promise((B,P)=>{var ca=b.ik,ra=null;ra=Cf.a.QGf(ca)?ca.getContext(0).node:ca.node;ca=IG.rzh();ra=this.Ozh(h.toString(),ra,r,!1);ra.Ae(HG.a.taf,RF.documentXmlToThemeJson.toString());this.Zf.nj(ca,2,ra.toString(),{},!0,0,Qa=>{t.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");
B(Qa.data.te)},Qa=>{t.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Qa.data.Ne}, ResponseData ${Qa.data.te}`);this.Ep(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);P(null)},null)})}Ozh(b,h,r,B){const P=h.Zi(),ca=new xb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.qga(ca);ca.Ae(HG.a.strict,this.sPm(h)?"true":"false");ca.Ae(li.a.nodeId,b);ca.Ae(li.a.cellId,P.Fm.toString());
ca.Ae(li.a.fileId,P.yr);ca.Ae(li.a.MX,r.toString());ca.Ae(HG.a.Wzl,B?"true":"false");if(b=!!this.rd&&this.rd.isFeatureEnabled(51)){ca.Ae(Sg.a.I2i,b.toString());if(b=this.rd.isFeatureEnabled(91))ca.Ae(Sg.a.RDn,b.toString()),ca.Ae(Sg.a.nxm,"true");this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ca.Ae(Sg.a.$Dn,"true")}ca.Ae(Sg.a.kxh,"true");ke.a.instance.bBb(ca);return ca}sPm(b){if(!this.lA)return!1;b=this.lA.uu(b);return!!b&&b.tf(Oc.a.AIf)}removeImage(b,h){b.cpBegin===
b.cpEnd-1&&this.Vj.Ajc(b.node,h,this.gb,this.dW)}Ep(b){const h=new Wh.StandardDialog;h.Cd=0;h.wx(vg.a.whf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);ab.StaticActiveAppFrame.za().updateCommandUI()}static rzh(){const b=new xb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.qga(b);return b.toString()}}Object(n.a)(IG,"GraphicsEditorRequestManager",null,[616]);class LJ extends JD{constructor(b,
h,r){super(b,h);this.iRa=Mb.a.insertHyperlink;this.q$j=r}a4a(b){null!=b&&0<b.length&&this.oc.Qb(this.iRa,2,b[0])}zNj(b,h,r){const B=Hi.a.ug(v.AFrameworkApplication.lcid).name;b=String.format(b,v.AFrameworkApplication.lcid,B,v.AFrameworkApplication.buildVersion,h,Dj.nse,r);b+="&flipgrid=1&ted=1";this.q$j&&(b+="&resize_picker=1");v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new xb.QueryStringBuilder(b),b.cJ("stream2",
"1"),v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&b.cJ("enablegetcustomheader","1"),b=b.toString());return b}}Object(n.a)(LJ,"InsertHubbleMediaHelper",JD,[]);class MJ{constructor(b,h,r,B,P,ca,ra){this.ga=b;this.Ca=h;this.Aod=r;this.m3=B;this.Dld=P;this.Nk=ca;this.qXj=ra}Ub(){this.ga.fb(V.a.p_i,zc.a.Tc,this.Xxn.bind(this),1028);this.ga.fb(V.a.mti,zc.a.Tc,this.LEm.bind(this),1028)}LEm(b,h,r,B,P){if(1!==r){if(null==P)return 16;if(!h.al||!Pd.SelectionEditor.Ze(h))return 2;b=this.pXl(P);P=P.OriginalUrl;
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Dld.Aug(b,h,P)}return 32}bTj(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}pXl(b){const h=new hC;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;
h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}Xxn(b,h,r){var B,P;if(1!==r)h=E.a.PQ(this.Ca.kb("UserId")).toString(),h=this.m3.zNj(this.Ca.appSettings.InsertVideoHubbleEndpoint,Lb.a.create().toString(),h),this.m3.iRa=V.a.mti,h=this.Aod.iRc(h,!0),h.correlationId=Lb.a.create(),h.pqa=5,h.oje(null,this.m3,this.qXj),oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ma.a,{name:"ActionId",int64:b})]})),
this.bTj();else if(!(h&&h.node&&FD.a(h.node))||(null===(B=this.Nk)||void 0===B?0:B.a0(h))||(null===(P=this.Nk)||void 0===P?0:P.yia(h)))return 2;return 32}}Object(n.a)(MJ,"OnlineMediaActor",null,[]);const PM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net",
"https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class fD extends ID{constructor(b,h,r,B=null,P=!1){super(b,h,r,B,P);this.uwc=null;this.bXf=()=>{this.xy&&(t.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!fD.RCa} time: ${(new Date).getTime()-this.ki}`),this.xy.sendMessage(M.a.Clj,{["CustomHeaders"]:fD.RCa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}PFb(){const b={};b.insertMediaServiceEndpoint=this.Bod;
b.iFrameId="mediaiframe";return b}async oje(b,h,r){r&&(this.ki=(new Date).getTime(),Date.now()>fD.Yjh&&await this.refreshToken(r));this.tWb=b;this.uwc=h;this.qvc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.PFb(),["componentIsVisibleCallback"]:this.nRj.bind(this)};this.Uh(this.tWb,null,b)}nRj(){this.a1=this.Q9b(this.rj("mediaiframe"));let b=this.Bod;if(v.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),r=PM[h.protocol+"//"+h.host];r?b=r:t.ULS.sendTraceTag(508937025,
352,10,`Target URL: ${h.host} not found`)}this.xy=this.yud.getInstance(this.a1.contentWindow,b);this.xy.aq(M.a.nph,h=>{this.PTi(h,this.uwc.a4a.bind(this.uwc))});this.xy.aq(M.a.insert,h=>{this.X7d(h,this.uwc.a4a.bind(this.uwc))});this.xy.aq(M.a.Iph,this.eXi.bind(this));this.xy.aq(M.a.O8h,this.bXf.bind(this));this.xy.aq(M.a.getSessionId,this.SVi.bind(this));this.xy.aq(M.a.w6h,this.PVi.bind(this));this.xy.aq(M.a.AFd,this.AUi.bind(this));this.Tpb(3)}Tpb(b){const h=[];h.push(Object.assign(new ma.a,{name:"DialogResult",
string:lD[b]}));h.push(Object.assign(new ma.a,{name:"DialogMode",string:this.Kci()}));h.push(Object.assign(new ma.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ma.a,{name:"Provider",string:sA[this.pqa]||"Unknown"}));oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.RV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(fD.Yjh=h.Telemetry.expiresOn?1E3*
(h.Telemetry.expiresOn-10):0,fD.RCa=h.Token);t.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!fD.RCa} time: ${(new Date).getTime()-this.ki}`)}catch(h){t.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ki} error: ${h} `)}}}fD.Yjh=0;Object(n.a)(fD,"OnlineMediaDialog",ID,[]);class NJ{constructor(b,h){this.rFe=b;this.m3=h}iRc(b,h=!1){return new fD(b,this.rFe,
this.m3,null,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(NJ,"OnlineMediaDialogFactory",null,[619]);class OJ extends ix{constructor(){super(1,3);this.aM=Ya.a.instance.resolve("Common.IReactContextualUILauncher");this.nzj=!1}t8a(){v.AFrameworkApplication.va.processAction(V.a.gmc,2)}lNd(){this.L1h&&!this.Cv&&(this.Cv=this.LLa())}$Nd(){if(this.Cv&&this.Cv.isVisible){var b=Object(Na.a)(bm.Control,this.Cv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.gx(b.hjb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");
if(null==b)t.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(qf.a.VDd)||"",qf.a.yM===h&&b.click())}}M0(){return this.aM.M0}}Object(n.a)(OJ,"ExternalContentFloatieManager",ix,[]);class bs{constructor(){bs.jCm()}get qc(){return null!=this.oKg?this.oKg:this.oKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Ku(){return null}ESb(b){var h=
null;if(!Td.ParagraphReader.oh(b))return{returnValue:!1,Xba:h};if((b=this.qc.hp(b.currentNode))&&2===this.qc.NG(b)){const r=this.qc.Kg(b);bs.IQ.contains(r)&&(h=this.qc.vR(b),h=Object.assign(new Vx.a,{nE:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Xba:h}}ejb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static jCm(){bs.IQ=new gp.a;bs.IQ.add(Rl.StyleReader.styleIdHeading1);bs.IQ.add(Rl.StyleReader.styleIdHeading2);bs.IQ.add(Rl.StyleReader.styleIdHeading3);
bs.IQ.add(Rl.StyleReader.DRb);bs.IQ.add(Rl.StyleReader.mbd);bs.IQ.add(Rl.StyleReader.nbd);bs.IQ.add(Rl.StyleReader.Pke);bs.IQ.add(Rl.StyleReader.Oke);bs.IQ.add(Rl.StyleReader.wordStyleIdHeading1);bs.IQ.add(Rl.StyleReader.wordStyleIdHeading2);bs.IQ.add(Rl.StyleReader.wordStyleIdHeading3);bs.IQ.add(Rl.StyleReader.MTb);bs.IQ.add(Rl.StyleReader.NTb);bs.IQ.add(Rl.StyleReader.OTb);bs.IQ.add(Rl.StyleReader.Kpc);bs.IQ.add(Rl.StyleReader.Lpc);bs.IQ.add(Rl.StyleReader.PTb);bs.IQ.add(Rl.StyleReader.wsb);bs.IQ.add(Rl.StyleReader.hfd)}}
bs.IQ=null;Object(n.a)(bs,"ParagraphStyleDetailsProvider",null,[549,346]);class PJ{constructor(b,h,r,B){this.QLa=b;this.gak=h;this.pak=r;this.qak=B}l7f(){this.QLa.execute(b=>{b.WOb(this.gak.value);b.WOb(new bs);b.WOb(this.qak.value);b.tV(this.pak.value)})}}Object(n.a)(PJ,"AccessibilityActor",null,[]);class QJ{constructor(b,h,r){this.ai=null;this.dad=(B,P,ca)=>{if(1===ca)return 32;this.ai=this.juc.value.t9k(this.Vb);if(!this.ai)return t.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),
8;this.ai.RUa();return 32};this.nnh=B=>this.ai?this.ai.nrm(B):2;this.ga=b;this.juc=h;this.Vb=r}Ub(){if(v.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Tb.KeyInputManager.ic(kc.a.Isb,5);this.Vb.fe(Zd.AFrame.In).mr(b);this.Vb.fe(Zd.AFrame.Ap).bindAction(b,eb.a.dad);this.ga.qa(eb.a.dad,Gd.a.frame,this.dad);this.ga.qa(eb.a.IFc,Gd.a.frame,this.nnh);this.ga.qa(eb.a.HFc,Gd.a.frame,this.nnh)}}}Object(n.a)(QJ,"AccessibilityHelpDialogActor",null,[]);var QM=c(1064),RM=c(1425);class RJ{constructor(b,
h){this.U5j=b.nc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.iVj=QM.a.mF(26,5,new RM.a)}gZ(){this.ga.gZ(this)}r5(){}p5(b){const h=+b.endTime-+b.startTime;if(h>this.U5j){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=nd.ActionManager.xba(b.actionId))&&b.length||(b="UnknownAction");this.iVj.track(h,b+"_"+r)}}}Object(n.a)(RJ,"ActionHangDetector",null,[29]);var SJ=c(1510);class TJ extends Le{constructor(b,h=null){super(b,void 0,v.AFrameworkApplication.t1a,
new ue(b,!1),void 0,void 0,h)}get W5a(){return this.XZd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.i_d?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get lfc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get m_c(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get iLc(){return v.AFrameworkApplication.t1a?"UIFontDialogTextLarge":null}get XZd(){return"VersionHistory"===this.M6e?
!1:1===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get i_d(){return"VersionHistory"===this.M6e?!1:2===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}A3d(){t.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");v.AFrameworkApplication.Ria("t1shrdnl;t2shrdnl;c-shrdnl")}uNf(){t.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}K_c(){t.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");v.AFrameworkApplication.va.processAction(eb.a.pVh,2)}}Object(n.a)(TJ,"DownloadACopyDialog",Le,[]);var JG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(JG||(JG={}));Object(n.b)("OfficeApplication",JG);var SF;(function(b){b[b.ReadWrite=0]="ReadWrite";
b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(SF||(SF={}));Object(n.b)("OpenDocumentMode",SF);class UJ extends Pf.a{constructor(){super(!1,!1,!0)}dNb(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};
const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Uh("Send feedback to Microsoft",
this.umo.bind(this),b);return new Promise(r=>{this.HMe=r})}umo(b,h){1===b&&this.fK(h.selectedReason)}dispose(){super.dispose();this.HMe()}fK(b){const h={},r={},B={},P={},ca={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=Lb.a.create().toString();ca.reason=b;const ra={},Qa={numberOfOptions:5};Qa.selectedRating=b;ra.rating=[Qa];P.surveySpecificData=JSON.stringify(ra);B.extendedManifestData=JSON.stringify(P);h.application=
B;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ca;h.telemetry=this.g0a();h.web=this.UBb();r["Content-Type"]="application/json";this.Eja(JSON.stringify(h),r)}vM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}g0a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.vM(h,b,"audienceGroup","AudienceGroup");this.vM(h,b,"osBuild","OsVersion");this.vM(h,b,"platform","Platform");this.vM(h,b,"processSessionId",
"WACSessionID");return h}UBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.vM(h,b,"browser","Browser");this.vM(h,b,"browserVersion","BrowserVersion");this.vM(h,b,"dataCenter","WACDatacenter");return h}Eja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Oe.a(2,1,B,()=>{v.AFrameworkApplication.He.nj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{t.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},
()=>{this.Eja(b,h,r+1);t.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(n.a)(UJ,"WordOpenInClientFeedbackDialog",Pf.a,[]);var xD=c(1483),VJ=c(1793);const XE=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},KG=b=>b.Hb.keyCode===kc.a.Rs||b.Hb.keyCode===kc.a.gKa?(b.yf.click(),!0):!1,TF=(b,h,r,B,P,ca,ra)=>{const Qa=document.createElement("a");
Qa.className="ProtocolLaunchingDialogButtonAnchor";Qa.className+=" OICDialog";Qa.id=b;Qa.setAttribute(qf.a.uh,qf.a.Z3);Qa.style.padding="0";Qa.style.margin="0";B&&WJ(P,h,r,B,Qa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=P;Qa.appendChild(b);Qa.tabIndex=0;ca&&ji.a.instance.ob(Xc.a.click,Qa,ca);ra&&Tb.KeyInputManager.instance.ob(Xc.a.zh,Qa,ra);return Qa},WJ=(b,h,r,B,P)=>{var ca=document.createElement("img");ca.alt=b;ca.className=ie.getImageClassWithCluster(r,
B);ca.src=h;ca.setAttribute(qf.a.uh,qf.a.xz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);P.appendChild(ca)};class LG{static get Vg(){return Pf.a.Nx(LG.Wm,CommonUIStrings.l_OICLaunchDialogTitle)}}LG.Wm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(LG,"OICLaunchDialogHtml",null,[]);class XJ extends Pf.a{constructor(b){super();this.aVb=this.stb=null;this.ZS=!1;this.Lp=b;this.Vg=LG.Vg;this.Cd=5;this.zg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.Mkn,"oicLaunchDialogResultHandler"));this.Imj();this.M5("ProtocolLaunchingDialogTitle");4!==v.AFrameworkApplication.ta.Kb.sPa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.G1(this.stb);t.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}V9(){this.stb=TF("BtnRichClient",this.Lp.xMc,this.Lp.JUc,this.Lp.fBf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.qYi,"onRichClientButtonClick"),KG);document.getElementById("OICLaunchRichClient").appendChild(this.stb);XE(this.stb);this.aVb=TF("BtnReturn",this.Lp.xMc,this.Lp.JUc,this.Lp.Uqi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.kYi,"onReturnButtonClick"),
KG);document.getElementById("OICReturnToApp").appendChild(this.aVb);XE(this.aVb)}kYi(){this.hide();this.Lp.Ujc();return!0}qYi(){t.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();v.AFrameworkApplication.va.processAction(eb.a.BPb,2);return!0}Mkn(){this.Lp.Ujc()}dispose(){this.ZS||(this.stb&&(ji.a.instance.uc(Xc.a.click,this.stb,Object(z.a)(this,this.qYi,"onRichClientButtonClick")),Tb.KeyInputManager.instance.uc(Xc.a.zh,this.stb,KG)),this.aVb&&(ji.a.instance.uc(Xc.a.click,
this.aVb,Object(z.a)(this,this.kYi,"onReturnButtonClick")),Tb.KeyInputManager.instance.uc(Xc.a.zh,this.aVb,KG)),super.dispose(),this.ZS=!0)}}Object(n.a)(XJ,"OICLaunchDialog",Pf.a,[]);class MG{static get Vg(){return Pf.a.Nx(MG.Wm,CommonUIStrings.l_OICDialogTitle)}}MG.Wm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(MG,"ProtocolLaunchingDialogV2Html",null,[]);class YJ extends Pf.a{constructor(b){super();this.$Ub=this.zWa=null;this.ZS=!1;this.Q$a=null;this.Lp=b;this.Vg=MG.Vg;this.Cd=5;this.zg="ProtocolLaunchingDialog";this.Htc="OICRetryDialog";v.AFrameworkApplication.lc.UHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.lc.Wb(new Oe.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.j4f,"protocolLaunchingDialogResultHandler"));this.Imj();this.M5("Issues");
this.c2h();t.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}V9(){const b=document.getElementById("Issues");if(b){WJ("",this.Lp.xMc,this.Lp.JUc,this.Lp.fBf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Lp.a_i?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);XE(b);b.style.display="none"}v.AFrameworkApplication.ta.Kb.rli?
(this.$Ub=TF("GiveFeedback",this.Lp.xMc,this.Lp.JUc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.J7d,"onGiveFeedbackClick"),Object(z.a)(this,this.UVi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.$Ub),XE(this.$Ub)):document.getElementById("ButtonGiveFeedback").style.display="none";0===v.AFrameworkApplication.ta.Kb.sPa||v.AFrameworkApplication.cpl?document.getElementById("ButtonEdit").style.display="none":(this.zWa=
TF("Edit",this.Lp.xMc,this.Lp.JUc,"",2===v.AFrameworkApplication.ta.Kb.xk?4===v.AFrameworkApplication.ta.Kb.sPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===v.AFrameworkApplication.ta.Kb.sPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.vVi,"onEditClick"),Object(z.a)(this,this.yVi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.zWa),XE(this.zWa));0===v.AFrameworkApplication.ta.Kb.sPa&&
!v.AFrameworkApplication.cHf&&b&&(b.style.display="none")}d2h(){return this.Q$a?(this.G1(this.Q$a),!0):!1}c2h(){return this.zWa?(this.G1(this.zWa),!0):!1}yVi(b){return this.aWf(b,0)}UVi(b){return this.aWf(b,2)}jYi(b){return this.aWf(b,1)}aWf(b,h){let r=!1;if(b.Hb.keyCode===kc.a.Rs||b.Hb.keyCode===kc.a.gKa)b.yf.click(),r=!0;else if(b.Hb.keyCode===Sys.UI.Key.down||b.Hb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.c2h();break;case 0:r=this.d2h()}return r}vVi(){this.hide();4===v.AFrameworkApplication.ta.Kb.sPa?
(t.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Lp.Ujc()):(t.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Lp.XSc());return!0}J7d(){t.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}KXf(){JE.Redirect.showHelp("OICFailure");return!0}H8d(){t.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";v.AFrameworkApplication.va.processAction(eb.a.BPb,2);return!0}j4f(){this.Lp.Ujc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.Q$a=TF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.H8d,"onRetryOICClick"),Object(z.a)(this,this.jYi,"onRetryOICKeyUp")),b.appendChild(this.Q$a),XE(this.Q$a),this.zWa||this.d2h())}}dispose(){this.ZS||(this.zWa&&
(ji.a.instance.uc(Xc.a.click,this.zWa,Object(z.a)(this,this.vVi,"onEditClick")),Tb.KeyInputManager.instance.uc(Xc.a.zh,this.zWa,Object(z.a)(this,this.yVi,"onEditKeyUp"))),this.$Ub&&(ji.a.instance.uc(Xc.a.click,this.$Ub,Object(z.a)(this,this.J7d,"onGiveFeedbackClick")),Tb.KeyInputManager.instance.uc(Xc.a.zh,this.$Ub,Object(z.a)(this,this.UVi,"onGiveFeedbackKeyUp"))),this.Q$a&&(ji.a.instance.uc(Xc.a.click,this.Q$a,Object(z.a)(this,this.H8d,"onRetryOICClick")),Tb.KeyInputManager.instance.uc(Xc.a.zh,
this.Q$a,Object(z.a)(this,this.jYi,"onRetryOICKeyUp"))),super.dispose(),this.ZS=!0)}}Object(n.a)(YJ,"ProtocolLaunchingDialog",Pf.a,[]);class NG extends Wh.StandardDialog{constructor(b){super();this.Lp=b;this.zg="ProtocolLaunchingDialog";v.AFrameworkApplication.lc.UHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.ta.Kb.rli&&this.etk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.J7d,"onGiveFeedbackClick"));NG.wni?(this.Cd=12,this.ye(1,CommonUIStrings.l_CloseFile),
this.ye(2,CommonUIStrings.l_OICDialogContinueHere),this.ye(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Cd=4,this.ye(1,CommonUIStrings.l_OICDialogContinueHere),this.ye(2,CommonUIStrings.l_OICDialogLaunchAgain));this.anb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Lp.a_i?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.j4f,"protocolLaunchingDialogResultHandler"),null)}J7d(b){t.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.EVi(b)}H8d(){t.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");v.AFrameworkApplication.va.processAction(eb.a.BPb,2)}j4f(b){NG.wni?3===b?this.Ffj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.Ffj():(1===b||0===b)&&this.continueEditing()}closeDocument(){t.ULS.sendTraceTag(577783557,211,50,"Closing the document");v.AFrameworkApplication.va.Qb(eb.a.close,2,zi.a)}Ffj(){t.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.H8d,
"onRetryOICClick"),0)}continueEditing(){4===v.AFrameworkApplication.ta.Kb.sPa||v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===v.AFrameworkApplication.ta.mode?(t.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Lp.Ujc()):(t.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Lp.XSc())}static get wni(){return v.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===v.AFrameworkApplication.va.processAction(eb.a.close,
1)}}Object(n.a)(NG,"StandardProtocolLaunchingDialog",Wh.StandardDialog,[]);class ZJ{}Object(n.a)(ZJ,"EditDocumentInClientParams",null,[]);class zH{static SVh(b,h,r,B,P,ca,ra=!1,Qa=!1,mb="",Jb=!1,Yb=!1,fc=!1,Mc="",Wc="",id="",Id=!1,ve=""){const $d=new ZJ;$d.DocumentUrl=b;$d.DocumentExtension=ve;$d.Mode=h;$d.Options=r;$d.Application=B;$d.SilentExternalHandler=ra;$d.EncodeUrl=Qa;$d.CorrelationIdForWinClient=mb;$d.NavigateUsingWindowOpen=Jb;$d.DescriptiveUnattemptedEnums=Yb;$d.NoBrowserModalDialogs=fc;
$d.SessionOrigin=Mc;$d.CorrelationId=Wc;$d.ClickTime=id;$d.NewTelemetryDataIsEnabled=Id;MSOJS.ClientUtils.EditDocumentInClient($d,P,ca)}}Object(n.a)(zH,"ClientUtils",null,[]);var SM=c(550),$J=c(957);class eE{constructor(b){this.ZYa=this.Huc=this.Bsc=null;this.Qvc=!1;this.Jze=this.yKe=this.z9g=null;this.lid=this.lz=this.fxd="";this.application=this.nz=0;this.MGo=this.Okg=!1;this.D1o=b&&v.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");v.AFrameworkApplication.va.l0(eb.a.BPb)||v.AFrameworkApplication.va.qa(eb.a.BPb,
Gd.a.frame,Object(z.a)(this,this.m9n,"retryOpenInClientAction"));this.$tj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("SilentExternalHandler")}get a_i(){return this.nz}lpo(b,h="",r=""){this.lz=r||Lb.a.create().toString();this.fxd=h||SM.a.Bdi();this.lid=b}m9n(b,h,r){return h.contextId!==Gd.a.frame?2:1===r?32:this.BPb()}get options(){let b=0;v.AFrameworkApplication.s6n&&(b|=1);v.AFrameworkApplication.i_i&&(b|=4);this.FGo()&&(b|=64);return b}FGo(){return!(2===this.application&&v.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get xMc(){return v.AFrameworkApplication.Ms}get JUc(){return v.AFrameworkApplication.Pca}get Uqi(){return""}get fBf(){return""}get LGo(){return v.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get vKo(){return this.z9g||
(this.z9g=Ya.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.Okg||this.szl()}Ujc(){this.MGo||this.mZh()}h8i(b){return this.D1o&&ba.a.vi?(new XJ(this),32):this.UHh(b)}UHh(b){const h=({Nrb:b}=this.f0m(b)).returnValue;t.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Bc(b,h,r,B,P,ca,ra=""){this.Bsc=b;this.Jze=ra;this.Huc=h;this.ZYa=ca;this.application=r;this.nz=B;return v.AFrameworkApplication.wVh?(this.JGi(),32):v.AFrameworkApplication.dqa&&
!v.AFrameworkApplication.wpi?(v.AFrameworkApplication.cig(),8):this.qxh(P)}get Lkn(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}BPb(){this.Lkn&&this.J4m();return this.UHh(this.Qvc)}Ujj(){const b=new $J.a(M.a.openInClient);b.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();b.Values[UC.a.yPh]=v.AFrameworkApplication.userSessionId;return this.ZYa.value.send(b)?32:8}J4m(){xa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new sb.a,{inStaging:!0}))}Efo(b){const h=new $J.a(M.a.z4o);h.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();h.Values[UC.a.yPh]=v.AFrameworkApplication.userSessionId;h.Values[H.a.y4o]=b;this.ZYa.value.send(h)}f0m(b){this.Qvc=b;this.Efo(5===this.nz?eE.Gxn:eE.Mxn);return 5===this.nz?this.e0m():this.i0m()}e0m(){this.TGi();return{returnValue:32,Nrb:"HostEditUrl,"}}i0m(){let b;var h=b="";v.AFrameworkApplication.jqh&&(h="|f|"+v.AFrameworkApplication.userSessionId);
const r=v.AFrameworkApplication.K.$("IsAssignmentMode")&&v.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||v.AFrameworkApplication.XYc||ba.a.ZRa,B=v.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),P=v.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(v.AFrameworkApplication.va.i6d){var ca=v.AFrameworkApplication.va.jY(3588168074);ca&&this.lpo(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.vLi()}if(v.AFrameworkApplication.N3i){b+="NewOrder,";
ca=8;this.ZYa&&this.ZYa.value&&this.ZYa.value.isEnabled()&&v.AFrameworkApplication.oTb&&(b+="Post,",ca=this.Ujj());if(32===ca)return{returnValue:ca,Nrb:b};t.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return v.AFrameworkApplication.Js.c$?(t.ULS.shipAssertTag(5566816,211,!!v.AFrameworkApplication.Js.c$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ta.eV(!0,v.AFrameworkApplication.Js.c$),Nrb:b}):this.Bsc?(t.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
v.AFrameworkApplication.userSessionId),b+="DocUrl,",zH.SVh(this.Bsc,this.nz,this.options,this.application,Object(z.a)(this,this.xVi,"onEditInClientSuccess"),Object(z.a)(this,this.wVi,"onEditInClientFailure"),this.$tj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,P,this.fxd,this.lz,this.lid,v.AFrameworkApplication.va.i6d,this.Jze),{returnValue:32,Nrb:b}):{returnValue:8,Nrb:b}}b+="OldOrder,";if(!this.Bsc&&v.AFrameworkApplication.Js.c$)return this.ZYa&&this.ZYa.value&&this.ZYa.value.isEnabled()&&
v.AFrameworkApplication.oTb?(b+="Post,",h=this.Ujj()):(t.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(t.ULS.shipAssertTag(22595484,211,!!v.AFrameworkApplication.Js.c$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ta.eV(!0,v.AFrameworkApplication.Js.c$),Nrb:b}):{returnValue:h,Nrb:b};t.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId);b+="DocUrl,";zH.SVh(this.Bsc,
this.nz,this.options,this.application,Object(z.a)(this,this.xVi,"onEditInClientSuccess"),Object(z.a)(this,this.wVi,"onEditInClientFailure"),this.$tj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,P,this.fxd,this.lz,this.lid,v.AFrameworkApplication.va.i6d,this.Jze);return{returnValue:32,Nrb:b}}w5n(b){v.AFrameworkApplication.Wl.setDw(8981,b)}xVi(b){this.w5n(b);t.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.LGo||this.TGi(),
this.vLi()):this.Okg||this.closeApplication()}wVi(b,h=0){t.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.Huc&&!this.Qvc;let B=0;1===b&&(B=2);6<=b&&13>=b&&(B=1,1===h&&(this.Okg=!0));this.vKo.xkn?(t.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",B),VJ.a.instance.sdl(this.Qvc?Object(z.a)(this,this.ATi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.BTi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.wWi,"onLaunchDownload"):null,this.mTh(!1)?Object(z.a)(this,this.Vwm,"iHaveOfficeButtonHandler"):null,B,h)):(t.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",B),VJ.a.instance.qdl(this.Qvc?Object(z.a)(this,this.ATi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.BTi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.wWi,"onLaunchDownload"):null,B))}}vLi(){try{const b=
[Object.assign(new ma.a,{name:"CorrelationId",string:this.lz}),Object.assign(new ma.a,{name:"SessionOrigin",string:this.fxd}),Object.assign(new ma.a,{name:"ClickTime",string:this.lid}),Object.assign(new ma.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];ne.a("OpenInClientCompleted",!0,0,b)}catch(b){t.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}TGi(){v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.uF&&v.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new NG(this):new YJ(this)}ATi(){this.closeApplication()}BTi(){this.Ujc()}wWi(){this.JGi()}Vwm(){return this.mTh(!0)}mTh(b){const h=(ba.a.hXc||ba.a.Nt)&&!!v.AFrameworkApplication.DLd;h&&b&&(Qd.a.vm(v.AFrameworkApplication.DLd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}eE.Mxn="OpenInDesktop";eE.Gxn="OpenInBrowser";Object(n.a)(eE,"AOpenInClientOperation",null,[]);class AH extends eE{constructor(b,h,r=!1){super(r);this.f7j=b;this.e7j=h}get Uqi(){return this.e7j}get fBf(){return this.f7j}szl(){v.AFrameworkApplication.va.Qb(eb.a.close,
2,zi.a)}mZh(){}qxh(b){return this.h8i(b)}JGi(){t.ULS.shipAssertTag(5566817,211,!!this.Huc);v.AFrameworkApplication.cda?v.AFrameworkApplication.ta.eV(!0,this.Huc):Qd.a.vm(this.Huc,void 0,void 0,"LaunchDownload")}XSc(){v.AFrameworkApplication.ta.Kb.XSc()}}Object(n.a)(AH,"OpenInClientOperation",eE,[]);class aK extends AH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.KZn=b=>{t.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");qe.App.sS.forceOutbound(this.t_i,
this.i4m,b)};this.i4m=b=>{t.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new Wh.StandardDialog;h.Cd=0;h.wx(vg.a.QSo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.g4m:this.h4m)};this.g4m=()=>{v.AFrameworkApplication.va.Qb(eb.a.close,2,zi.c)};this.h4m=()=>{ab.StaticActiveAppFrame.za().refreshDocument(null)};this.t_i=b=>{v.AFrameworkApplication.zbd=!0;t.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",
b);this.h8i(b)}}LKk(b){qe.App.li.e6a.zbc||qe.App.zd.nC.Io?(t.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.t_i(b)):Wv.a.mR(xD.a.openInWord,!0,this.KZn,null,b)}qxh(b){this.LKk(b);return 32}mZh(){ab.StaticActiveAppFrame.za().refreshDocument(null)}}Object(n.a)(aK,"OpenInWordOperation",AH,[]);const bK=(b,h)=>{t.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[Df.a.On]=Qh.PageReader.instance.qv(h);Qh.PageReader.instance.qv(h)?
b[Df.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Df.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},TM=(b,h,r,B,P)=>{if(!ab.StaticActiveAppFrame.za()||!ab.StaticActiveAppFrame.za().jb||!v.AFrameworkApplication.Sm.r2a)return 8;h=ab.StaticActiveAppFrame.za().jb.Zc;if(!h)return 8;if(b===Mb.a.rbe&&2===r){b=new sg.GraphTransaction(15);try{b.Db(h),Qh.PageReader.instance.pMo(h)}finally{b&&b.dispose()}bK(P,h)}return 32},UM=(b,h,r,B,P)=>{if(!ab.StaticActiveAppFrame.za()||
!ab.StaticActiveAppFrame.za().jb)return 8;b=ab.StaticActiveAppFrame.za().jb.Zc;if(!b)return 8;P[Df.a.Alt]=v.AFrameworkApplication.Sm.r2a?"":CommonUIStrings.l_ProtectDocumentToolTip;bK(P,b);return 32};var VM=c(1129);class cK extends SJ.a{constructor(b,h){super(b,h);this.G2g=!1;this.CGc=new vb.a("docx doc docm dot dotx odt dotm".split(" "));this.u0c=100;this.cXi=(r,B,P,ca,ra)=>{var Qa;if(B.contextId!==Gd.a.frame)return 2;if(!(qe.App.dJc||v.AFrameworkApplication.Js.c$||v.AFrameworkApplication.oTb||this.G2g))return t.ULS.sendTraceTag(50857163,
211,15,"OIC entry is hidden"),this.G2g=!0,8;if(1===P)return gc.SessionStatusManager.instance.Yj?8:32;let mb=!1;void 0!==ra&&null!==ra&&(mb=ra);if(null===(Qa=v.AFrameworkApplication.K)||void 0===Qa?0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new UJ).dNb().then(()=>this.cNb(r,mb));else return this.cNb(r,mb);return 32};this.dTb=(r,B,P)=>{if(1==P){if(!VM.a.HGe)return 64}else if(2==P)return ne.a("OpenFileFromPC"),(r=this.hfl(r))?this.Txo(P,r):2;return 32};this.lrl=
r=>{this.w5m();if(!v.AFrameworkApplication.XYc&&v.AFrameworkApplication.ta.Kb.kgg(eb.a.downloadACopy.toString()))this.Fza(!0,M.a.download,!0,{});else if(v.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let B=v.AFrameworkApplication.rEb,P=null;r&&(r.FileDownloadUrl&&(B=r.FileDownloadUrl.toString()),r.CallSource&&(P=r.CallSource.toString()));new TJ(B,P)}else super.downloadACopy(0,null,2,null,null)};this.QSk=r=>{super.workflow(0,null,2,null,r)};this.YI=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback")}get zCf(){this.S_g||
(this.S_g=Ya.a.instance.resolve("Common.IInsertFileUploader"));return this.S_g}Ub(){super.Ub();this.ga.qa(Mb.a.openInClient,Gd.a.frame,this.cXi);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Xc(Mb.a.openInClient,12288);var b=this.ga;b.fb(Mb.a.rbe,zc.a.application,TM,4);b.fb(Mb.a.k5f,zc.a.application,UM,96);this.ga.qa(eb.a.TZf,Gd.a.frame,this.cXi);this.ga.qa(Mb.a.dTb,zc.a.view,this.dTb)}cNb(b,h){t.ULS.sendTraceTag(50857164,
211,50,"OpenInClient begin. Expect saving starting soon.");return(new aK).Bc(qe.App.dJc,v.AFrameworkApplication.rEb,JG.Word,b===eb.a.TZf?SF.OpenInBrowser:SF.WriteOnly,h,new zf.a(()=>this.sY))}sEd(b){return bh.a.instance.gva()?!0:ab.StaticActiveAppFrame.za().thj(xD.a.closeDocument,xk.AppFrame.b0k,b)}hfl(b){return b===Mb.a.dTb?()=>{this.zCf.Olo(this.u0c);this.zCf.Tgo(this.CGc);this.zCf.showDialog()}:null}Txo(b,h){return 2===b?(h(),32):2}downloadACopy(b,h,r,B,P){if(2===r){if(!v.AFrameworkApplication.rEb&&
!v.AFrameworkApplication.ta.Kb.kgg(eb.a.downloadACopy.toString()))return 8;Wv.a.mR(xD.a.downloadACopy,!0,this.lrl,null,P);this.nre();return 32}return super.downloadACopy(b,h,r,B,P)}nre(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}w5m(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.YI&&this.YI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,B,P){return 2===r?(Wv.a.mR(xD.a.workflow,!0,this.QSk,null,P),32):super.workflow(b,h,r,B,P)}}Object(n.a)(cK,"AppFrameCommandUIActor",SJ.a,[]);class dK extends Wh.StandardDialog{constructor(){super();this.Cd=0;this.anb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",
CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(n.a)(dK,"WheresTheSaveButtonDialog",Wh.StandardDialog,[]);const WM=(b,h,r)=>{if(1===r)return 32;new dK;return 32};var BH=c(552),eK=c(1393);class Qs extends ll.a{constructor(b,h,r,B,P,ca,ra=null){var Qa;super();this.dLf=ra;this.$Xj=50;this.aYj=56;this.yBc="px";this.fue="aria-label";this.HKa="BookmarkIndicator";this.iZg="HighlightBookmarkedContent";this.m6j="HighlightBookmark";this.EXa="wwaengidc";this.XLk="Bookmark_24";this.gb=b;this.ig=
r;this.sk=h;this.yW=B;this.hA=P;this.eYj=null===(Qa=v.AFrameworkApplication.K)||void 0===Qa?void 0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.hA&&this.hA.wCd(this.aC.bind(this));this.NI=ca}uso(b){if(b.gk){for(const h of b.Xg.ij)if(this.Aqj(h))return!0;return!1}return this.Aqj(b.htmlElement)}n8a(b){let h=!1;v.AFrameworkApplication.se("bookmarks-core-ex;bookmarks-core-ex-cf");this.eYj&&Zq.a.instance.ie(()=>{h=this.uso(b)},"BIA:SCIVE");return h}Aqj(b){return Qs.oTe?
(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}$0a(b){const h=[];Zq.a.instance.ie(()=>{const r=b.m0a(0,this.NI?this.aYj:this.$Xj,this.zoom);h.push(this.Mna(b.y5,r,b.Bpc[0].y-b.M4[0].y))},"BIA:CIs");return h}Mna(b,h,r){const B=b.Ag.ownerDocument,P=tn.a.createElement(B,xl.a.div);P.className=this.NI?Qs.dYj:Qs.Vue;Qs.Vue;P.style.left=h+this.yBc;P.style.top=r+this.yBc;this.NI?(h=tn.a.createElement(B,xl.a.div),rh.a("renderIcon")&&appChrome.api.renderIcon(this.XLk,
h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=tn.a.createElement(B,xl.a.O3a),h.src=Ad.a.xg(Qs.Hhd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.fue,"Bookmark");P.appendChild(h);b={context:new GG([],P,new Set,new Set,null,null),gVf:b,container:P};this.NI||(this.sk.ob(Xc.a.XR,h,this.onMouseEnter),this.sk.ob(Xc.a.yL,h,this.zqa));this.ig.oE(Xc.a.click,P,this.HHa.bind(this),b);return P}GGd(){const b=Object.assign(new xg.a,{action:1,type:5,HA:null,WJ:this.efa});this.efa=
null;this.yW.KF(b)}aC(b,h){this.efa&&(h.U1a.yf.classList.contains("BookmarkHighlightSelected")||this.GGd())}onMouseEnter(b){if(null==b)return!1;b=b.yf;b.parentElement.classList.add(Qs.rNg);b.src=Ad.a.xg(Qs.YXj);return!0}zqa(b){if(null==b)return!1;b=b.yf;b.parentElement.classList.remove(Qs.rNg);b.src=Ad.a.xg(Qs.Hhd);return!0}HHa(b){this.g7a(this.iZg,this.m6j);if(null==b){var h=new Map;h.set("Source",this.HKa);h=Object.assign(new sb.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.iZg,
"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.Vo.context;if(Qs.Z4a(h,this.efa))return!0;h=this.Irf(b.Vo.gVf,h,b.Vo.container);b=Object.assign(new xg.a,{action:0,type:5,HA:h,WJ:this.efa});this.efa=h;this.yW.KF(b);return!0}Irf(b,h,r){h={ayh:new Set,mNb:new Set,dyh:null,V4e:null};const B=this.gb.yw(b.Cb,!0,!1),P=[];if(B)for(const ca of B)P.push(ca);this.zuk(b,h,P);h=new GG(P,r,h.ayh,h.mNb,h.dyh,h.V4e);this.efa&&this.efa.ps===P&&(r.className+=String.format(" {0}",Qs.ZXj),this.efa=h);
return h}zuk(b,h,r){if(b.gk){const P=new Set;for(const ca of b.Xg.ij)ca.querySelectorAll("*").forEach(P.add,P);b=Array.from(P.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let B=[];h.mNb.add(r[0].id);h.dyh=r[0].id;h.V4e=r[0].id;b.forEach(P=>{const ca=Bc.a.Eb(P,Ck.a.FEd);if(ca)for(const ra of ca)B.push(ra),h.ayh.add(ra);if(!B.length)return!0;P=Bc.a.Eb(P,Ck.a.JBb);if(!P)return!0;B=eK.a.xjc(B,P)});for(b=this.gb.Wf(r[r.length-1],!1,!0);B.length&&b;)h.mNb.add(b.id),
h.V4e=b.id,r.push(b),this.dLf.value.Aj(b).htmlElement.querySelectorAll("."+Ck.a.U4e).forEach(P=>{(P=Bc.a.Eb(P,Ck.a.JBb))&&(B=eK.a.xjc(B,P))}),b=this.gb.Wf(b,!1,!0)}g7a(b,h){const r=new Map;r.set("Source",this.HKa);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.EXa,r)}static Z4a(b,h){return!!h&&!!b&&b.Zxh===h.Zxh}}Qs.rNg="WordBookmarkIndicatorContainerHovered";Qs.ZXj="WordBookmarkIndicatorContainerSelected";Qs.Hhd="BookmarkDefault.png";Qs.YXj="BookmarkHover.png";Qs.oTe=!0;Qs.Vue="WordBookmarkIndicatorContainer";
Qs.dYj="WordBookmarkSvgIndicatorContainer";Object(n.a)(Qs,"BookmarkIndicatorActor",ll.a,[609]);class fK{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb=null,Yb=null,fc=null,Mc=null,Wc=null,id=null,Id=null){this.g3="_";this.xue="Bookmark";this.yXj=/^BOOKMARK\d+$/i;this.HKa="BookmarkRibbonOptions";this.VXj="BookmarkFloatieOptions";this.eRg="CreateBookmarkOnRange";this.fRg="CreateBookmarkOnView";this.dRg="CreateBookmarkOnIP";this.Qxe="CreateBookmark";this.EXa="wwaengidc";this.ghh="ShowHideBookmarksOnDocument";
this.sSg="DeleteBookmark";this.X0j="DeleteBookmarkAction";this.xkk="ShowHideBookmarks";this.fhh="ShowBookmarksFloatie";this.ukk="ShowBookmarksFloatieAction";this.YTg="EditBookmark";this.X1j="EditBookmarkAction";this.Z4e="BookmarksUsage";this.$Lk="InsertTabSwitchActivity";this.uFm="Insert";this.uUb=b;this.ga=h;this.hb=r;this.Bn=B;this.Dx=P;this.m7=ca;this.Lc=ra;this.aM=Qa;this.Mo=Yb;this.qNg=mb;this.Fe=Jb;this.U6=Wc;this.Un=fc;this.ld=Mc;this.ES=id;this.Nk=Id}get px(){return this.Dx.value}Ub(){this.WDf()&&
(this.ga.qa(V.a.cPa,zc.a.view,this.cPa.bind(this)),this.ga.fb(eb.a.nVa,zc.a.application,this.XOo.bind(this),96),this.ga.qa(V.a.cPa,zc.a.Fd,this.l$k.bind(this)),this.ga.qa(V.a.cPa,zc.a.Tc,this.k$k.bind(this)),this.ga.qa(V.a.deleteBookmark,zc.a.view,this.deleteBookmark.bind(this)),this.ga.qa(V.a.Fhf,zc.a.view,this.gul.bind(this)),this.ga.fb(V.a.gsj,zc.a.view,this.Jxo.bind(this),1028),this.ga.fb(V.a.ybe,zc.a.application,this.ybe.bind(this),96),this.ga.fb(V.a.aje,zc.a.Tc,this.aje.bind(this),1028),this.ga.fb(Mb.a.V2d,
zc.a.view,this.V2d.bind(this),1028),this.ga.fb(V.a.YWd,zc.a.view,this.YWd.bind(this),1028),this.ga.Xc(V.a.cPa,1028))}XOo(b,h,r,B,P){return P&&P.NewContextId===this.uFm?(this.p3d(this.$Lk),32):2}cPa(b,h,r,B,P){var ca,ra;b=this.hb.qg;if(!b||b.contextId===zc.a.W7)return 2;if(1===r)return $i.a.via(h)||(null===(ca=this.Nk)||void 0===ca?0:ca.a0(b))||(null===(ra=this.Nk)||void 0===ra?0:ra.yia(b))?8:32;h=this.hb.ib.lb;if(!h||this.Fe.Pl(h))return 2;this.S_c(P,"User is trying to create bookmark from UILocation : {0}");
this.g7a(this.fRg,this.Qxe);if(h&&this.Bn.MZe(this.cQa(),h))return this.p3d(this.Z4e),32;P=new Map;P.set("Source",this.HKa);P=Object.assign(new sb.a,{additionalValues:P});xa.Health.instance.recordKpiFailure(this.fRg,"Unable to create bookmark",!1,!0,P);return 8}l$k(b,h,r,B,P){if(1===r)return 32;if(zc.a.Fd!==h.contextId)return 8;this.S_c(P,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.lb;if(!b)return 2;this.g7a(this.eRg,this.Qxe);if(this.Bn.MZe(this.cQa(),b))return this.p3d(this.Z4e),
32;b=new Map;b.set("Source",this.HKa);b=Object.assign(new sb.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.eRg,"Unable to create bookmark for range",!1,!0,b);return 8}k$k(b,h,r,B,P){if(1===r)return 32;if(zc.a.Tc!==h.contextId)return 8;this.S_c(P,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.lb;if(!b)return 2;this.Fe.Pl(b)&&(h=b.Pa,this.Fe.Vlb(h)?(b=this.Fe.j0(h,!1),b||(t.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Fe.j0(h,
!0))):t.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.g7a(this.dRg,this.Qxe);if(this.Bn.MZe(this.cQa(),b))return this.p3d(this.Z4e),32;b=new Map;b.set("Source",this.HKa);b=Object.assign(new sb.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.dRg,"Unable to create bookmark for IP",!1,!0,b);return 8}ybe(b,h,r,B,P){1===r&&32;P[Df.a.On]=Qs.oTe;return 32}Jxo(b,h,r,B,P){if(1===r)return 32;this.g7a(this.ghh,this.xkk);(b=P[Df.a.On])||
t.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Qs.oTe=b;b=ro.PageNavigator.instance.hP(this.px);if(null!==b)return this.i6c(b),this.uUb.lH({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.HKa);b=Object.assign(new sb.a,{additionalValues:b});xa.Health.instance.recordKpiFailure(this.ghh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,B,P){if(this.WDf()){b=this.hb.ib.lb;if(!b)return 2;b=b.Pa;b=this.Bn.SRd(b.node,
b.cpBegin);if(1===r)return b?32:8;this.S_c(P,"User is trying to delete bookmark from UILocation : {0}");this.aM.M0&&(t.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.aM.dismissFloatie());this.g7a(this.sSg,this.X0j);b||t.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.Bn.Z$i(b.id))return this.qNg&&this.qNg.GGd(),32;r=new Map;r.set("Source",this.HKa);r=Object.assign(new sb.a,{additionalValues:r});xa.Health.instance.recordKpiFailure(this.sSg,
"Unable to delete bookmark",!1,!0,r);return 8}return 2}gul(b,h,r,B,P){b=this.hb.ib.lb;if(!b)return 2;b=b.Pa;b=this.Bn.SRd(b.node,b.cpBegin);if(1===r)return b?32:8;this.S_c(P,"User is trying to edit bookmark from UILocation : {0}");this.aM.M0&&(t.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.aM.dismissFloatie());this.g7a(this.YTg,this.X1j);b||t.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.U6.value.hul(h,
b,this.Bn),32;h=new Map;h.set("Source",this.HKa);h=Object.assign(new sb.a,{additionalValues:h});xa.Health.instance.recordKpiFailure(this.YTg,"Unable to edit bookmark",!1,!0,h);return 8}S_c(b,h){b&&b.UILocation&&t.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}aje(b,h,r,B,P){1===r&&32;this.g7a(this.fhh,this.ukk);if(h.contextId===zc.a.Tc)return b=Array(1),b.push("Bookmarks"),this.aM.showFloatie(P.location,b,1),32;P=new Map;P.set("Source",this.VXj);P=Object.assign(new sb.a,{additionalValues:P});
xa.Health.instance.recordKpiFailure(this.fhh,"Unable to show bookmark floatie",!1,!0,P);return 8}V2d(b,h,r,B,P){let ca;return 1===r?(Zq.a.instance.ie(()=>{ca=this.ga.Mf(h,Mb.a.insertHyperlink,r,!0,B,P);32!==ca&&(ca=this.ga.Mf(h,V.a.cPa,r,!0,B,P))},"BA:LFE"),ca):8}YWd(b,h,r){var B;if(1===r)return 32;if(b=this.hb.ib.lb){b=b.Pa.node;if(h=this.MZh(b))return h.click(),32;t.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.Bn.SRd(b,0)){b=this.ES.Hfb.get(null===(B=
b.id)||void 0===B?void 0:B.toString());B=ro.PageNavigator.instance.hP(this.px).Mc.Eb(b);if(B=this.MZh(B))return B.click(),32;t.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else t.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}MZh(b){let h;b=this.Un.Fl(b).Aj(this.ld.yd.$b);b.slb&&(b=b.htmlElement.querySelectorAll("div."+Qs.Vue),0<b.length&&(h=b[0]));return h}i6c(b){const h=BH.b(b);if(h){var r=this.Lc.Pc(2);
try{for(r.Db(b);h.moveNext();){if(!Td.ParagraphReader.oh(h.iterator))continue;const B=h.currentNode;this.Zsl(B)&&this.m7.ZIb(B,!0)}}finally{r&&r.dispose()}}}Zsl(b){for(let r=0;r<b.ra.length;r++){const B=b.ra.J(r);if(null!=B.$g)for(let P=0;P<B.$g.length;P++){var h=B.$g.J(P);if(null!=h&&(h=b.Mc.Eb(h.yn).ja(Oc.a.At,""),!E.a.af(h)&&!h.startsWith(this.g3)))return!0}}}cQa(){var b=this.Bn.yQd(!1);const h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Oc.a.At,"");this.yXj.test(B)&&h.push(B)}return 0<h.length?
(h.sort((r,B)=>r.localeCompare(B,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.xue.length)),this.xue+(b+1)):this.xue+1}g7a(b,h){const r=new Map;r.set("Source",this.HKa);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.EXa,r)}p3d(b){this.WDf()&&this.Mo&&this.Mo.execute(h=>{h.logActivity(b,null)})}WDf(){v.AFrameworkApplication.se("bookmarks-core-ex;bookmarks-core-ex-cf");return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",
!1)}}Object(n.a)(fK,"BookmarkActor",null,[]);class gK{constructor(b,h,r){this.oc=b;this.bol=h;this.Uf=r;this.y9e=this.y9e.bind(this)}Ub(){this.oc.qa(V.a.IKf,zc.a.view,this.y9e)}y9e(b,h,r,B,P){return 1===r?32:(b=this.Uf.g9(h.ik))?(P=3===P.Ux,this.bol.value.TLh(this.Xam(b),this.Nkm(b),P),32):2}Xam(b){const h=new wc.DictionaryPropertySet;h.setValue(Nd.a.aF,this.Uf.hh(b));h.setValue(Nd.a.uG,this.Uf.Jha(b));h.setValue(Nd.a.zna,this.Uf.bjb(b));h.setValue(Nd.a.separator,this.Uf.FUd(b));return h}Nkm(b){const h=
new wc.DictionaryPropertySet;h.setValue(Oc.a.marginLeft,this.Uf.CJ(b));h.setValue(Oc.a.marginRight,this.Uf.oL(b));h.setValue(Oc.a.Ko,this.Uf.ru(b));return h}}Object(n.a)(gK,"ColumnsDialogActor",null,[]);var hK=c(471);class iK{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){this.$o=b;this.tfa=h;this.Ce=r;this.pr=B;this.jm=P;this.Md=ca;this.Lc=ra;this.De=Qa;this.ga=mb;this.K8j=Jb;this.D_j=Yb}get JEf(){return this.K8j}Ub(){this.ga.fb(Mb.a.fad,zc.a.view,this.QDm.bind(this),96);this.ga.fb(Mb.a.S6c,zc.a.view,
this.S6c.bind(this),4);this.ga.fb(Mb.a.FDd,zc.a.view,this.FDd.bind(this),1028)}FDd(b,h,r,B,P){if(!wn.a.X$e)return 8;b=P.FormattingActionId;P=P.FormattingActionData;if(!h.view||!h.view.ue)return 2;h=h.view;if(!(b&&P&&h.mb&&h.mb.ib.lb))return 8;h=this.jm.d8h(h.mb.ib.lb.toArray());for(const ca of h){h=ca.ja(Oc.a.$w,0);r=this.$o.getById(h);if(!r)return t.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.D_j.YVo(r,b,P))return t.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+
h+"' failed to update formatting."),8}return 32}QDm(b,h,r,B,P){h=this.$o.getById(P);if(!h)return 8;r=h.contentControlNode;if(!r)return 8;if(r.ja(Oc.a.t8,!1))return 2;B=this.$o.ETl(h);if(!B)return 8;P=this.Lc.Pc(7);P.Db(B.node);if(!this.JEf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Md.Ge(B,b),wn.a.oda?this.jm.pBb(h,!0):this.pBb(h),r.setValue(Oc.a.t8,!0),P.dispose(),32;const ca=new wc.DictionaryPropertySet;ca.setValue(Zc.a.IVd,B);var ra=r.ja(Oc.a.ZOa,
"");ra=this.tfa.Eki(ra);if(!ra)return this.pr.Ge(B,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,wn.a.vr?b:void 0),wn.a.oda?this.jm.pBb(h,!0):this.pBb(h),r.setValue(Oc.a.t8,!0),P.dispose(),32;ca.setValue(Zc.a.ESc,ra);if(1<ra.length&&!h.Of)return P.dispose(),8;wn.a.oda?this.ga.Qb(Mb.a.oad,2,{ESc:ra,IVd:B,placeholderText:h.placeholderText}):this.I8k(ca);r.setValue(Oc.a.t8,!0);P.dispose();return 32}S6c(b,h,r){b=h.view.ue?h.view:null;if(!b||!b.mb)return 8;const [B,P]=this.fem(b.mb.ib);
if(0===B.length)return 8;if(1===r){for(var ca of B){var ra=P.get(ca.parentId);if(this.Nwi(ca,ra))return 32}return 8}if(2===r){r=this.$Ao(B,P);ca=this.Lc.Pc(15);ca.Db(b.ed);for(ra of r)r=P.get(ra.parentId),this.Nwi(ra,r)&&this.$o.ZOb(ra.id);ca.dispose();Object(hK.l)()&&Object(hK.o)("RemoveContentControl");return 32}return 2}fem(b){var h,r,B=[];for(const ca of b)B.push(...(null!==(h=this.jm.Doa(ca.Pa,ca.Rc,1))&&void 0!==h?h:[]));if(0===B.length)return[B,new Map];h=[];for(const ca of b)h.push(...(null!==
(r=this.jm.Doa(ca.Pa,ca.Rc,3))&&void 0!==r?r:[]));b=new Map(B.map(ca=>[ca.id,ca]));if(0===h.length)return[B,b];const P=new Map(h.map(ca=>[ca.id,ca]));B=B.filter(ca=>!P.has(ca.id));b=new Map([...b,...P]);return 0==B.length?[[h[0]],b]:[B,b]}pBb(b){const h=this.pr.ERc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.De.ZC(b.start.node).pj(as.a.s1f))this.Ce.Lga(h.formatting),this.Ce.l8a(h.formatting,b)}else t.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}I8k(b){this.ga.Qb(Mb.a.oad,
2,b)}Nwi(b,h){return b.qia&&b.TTm&&(!h||h.isEditable)}$Ao(b,h){const r=(B,P)=>null==B||null==P||B.id===P.id?!1:B.id===P.parentId||r(h.get(B.parentId),P);return b.slice().sort((B,P)=>r(B,P)?1:r(P,B)?-1:0)}}Object(n.a)(iK,"ContentControlActor",null,[]);class UF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.GAk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it",
"status updates. Thank you."];this.DLo="Interested in this feature?"}Ub(){this.ga.qa(V.a.Ldf,zc.a.view,this.SVc.bind(this))}SVc(b,h,r){2===r&&(Object(ne.c)(V.a.Ldf),b=new Wh.StandardDialog,b.Cd=4,b.ye(1,this.primaryButtonText),b.ye(2,this.secondaryButtonText),b.UFc(this.GAk,null),b.sv(this.DLo,null,0,this.eca));return 32}eca(b){1===b&&(Object(ne.a)("CountMeIn_CustomizeRibbon",!0),E.a.vP(UF.cJj)&&Qd.a.vm(UF.cJj))}}UF.cJj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";
Object(n.a)(UF,"CustomizeRibbonActor",null,[]);var vB=c(1096);class CH extends Pf.a{constructor(b,h,r){super(!1,!1,!0);this.E5g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,vB.a.F1e,vB.a.E1e,vB.a.G1e];this.MWj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,vB.a.$Bk,vB.a.ZBk,vB.a.bCk];this.JLg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.emc=()=>{new CH(this.ga,this.kVe,this.Vtc)};this.G1l=
()=>{const B=[];for(const P of this.kVe)B.push(this.i6(P));return B};this.F_o=B=>{const P=new Set;this.qfa="";for(const ca of B)if(""!==ca.position){const ra=this.Fdi(ca.position);if(0>ra||22<ra){this.qfa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(P.has(ra)){this.qfa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.SLo(ca)),P.add(ra)}else{this.qfa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.qfa&&
(this._tabStops=[],this.kVe=B)};this.bil=(B,P)=>{try{if(1===B){if(""!==this.qfa)throw Error.create(this.qfa);P.DefaultTabStop&&(this.Vtc=vB.a.Vag(P.DefaultTabStop),this.T2o(this.Vtc));if(32!==this.ga.Qb(V.a.SSb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:af.a.Nv(this.Vtc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.TIa(ca.message,this.emc)}};this.ga=b;this.kVe=h;this._tabStops=[];this.Vtc=r;this.qfa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.PFb()};
this.Uh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.bil,b)}i6(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}Fdi(b){return Math.floor(100*parseFloat(b))/100}SLo(b){return new jz.a(af.a.Nv(this.Fdi(b.position)),vB.a.Vgm(b.alignment),vB.a.Tgm(b.leader),1)}T2o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(Mb.a.mIa,2,h)){var r=h.marginLeft;const B=Xg.a.Oi(h.marginRight,0);r=Xg.a.Oi(r,0);
h=Xg.a.Oi(h.Ko,0);if(Xg.a.Uca(b,0,!1)>=h-B-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}PFb(){return{["getInitState"]:this.G1l,["updateState"]:this.F_o,["validPositions"]:this.Uhi(-Infinity,Infinity,"Position"),["validAlignments"]:this.z7h(this.JLg,this.JLg,null,"Alignment"),["validLeaders"]:this.z7h(this.E5g,this.E5g,this.MWj,"Leader"),["defaultTabStopSpinButtonProps"]:this.Uhi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.Vtc,["DefaultTabStop"]:"DefaultTabStop",
["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,
["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}Uhi(b,h,r){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:r,["unitType"]:"Inch",["validUnits"]:[uC("Inch",3,b,h,.1)],["numberFormatInfo"]:hH()}}z7h(b,h,r,B){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:B,["options"]:wG(b,h,r)}}}Object(n.a)(CH,"CustomTabDialog",
Pf.a,[]);class jK{constructor(b,h,r){this.mgc=(B,P,ca,ra,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;B=Qa.tabStop;Qa=Qa.value;if(!B)return 16;ne.c(V.a.mgc);Qa=new jz.a(Qa,B.Aea,B.cqa,B.dlg);P=P.node;this.mBa.n7a(P,B);this.mBa.jYd(P,Qa);return 32};this.E9c=(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;this.mBa.jYd(P.node,Qa);return 32}return 8};this.nOb=(B,P,ca,ra,Qa)=>{B=this.mBa.b8i(P.node);if(!("customTabs"in Qa))return Qa.customTabs=B,32;P=Qa.customTabs;if(!P||0>=P.length||!B||0>=B.length)return Qa.customTabs=
null,32;ca=[];for(const mb of P)for(const Jb of B)if(Jb.sJa===mb.sJa&&Jb.dlg===mb.dlg&&Jb.Aea===mb.Aea){ca.push(mb);break}Qa.customTabs=ca;return 32};this.n7a=(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;ne.c(V.a.n7a);this.mBa.n7a(P.node,Qa);return 32}return 8};this.$Ob=(B,P)=>{this.mBa.$Ob(P.node);return 32};this.SSb=(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;B=Qa.tabStops;ca=Qa.defaultTabStopLength;P=P.node;ra=!1;const mb=this.mBa.B4n(P,B);Qa.defaultTabStopLengthSaved||(ra=this.HK.Eio(P,ca),Qa.defaultTabStopLengthSaved=
!0);mb&&ne.d(V.a.SSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"Custom Tab Stops Count",string:B.length.toString()})]);if(null==ra)return t.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ra&&(this.q7c&&this.q7c.Wui(),this.Qd.Zs(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),ne.d(V.a.SSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"Default Tab Stop Length",string:ca.toString()})]));return 32}return 8};this.rsj=
(B,P,ca)=>{if(2!==ca)return 8;B={};if(32!==this.ga.Qb(V.a.aY,2,B))return t.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;P={};if(32!==this.ga.Qb(Mb.a.mIa,2,P))return t.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;B=vB.a.Vag(af.a.Yz(B.defaultTabStop));ca={};ca.defaultTabStopLength=B;ca.sectionPropertiesData=P;if(32!==this.ga.Qb(V.a.Jrg,2,ca))return t.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),
16;if(!ca.isParagraphValid)return t.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.mBa.TIa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;P={};if(32!==this.ga.Qb(V.a.nOb,2,P))return t.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(P=P.customTabs)||(P=[]);P=vB.a.Ugm(P);new CH(this.ga,P,B);ne.c(V.a.emc,!0);return 32};this.ISm=(B,P,ca,ra,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;if(Qa.isParagraphValid)return 32;
ca={};if(32!==this.ga.Mf(P,Mb.a.b7a,2,!1,null,ca))return 16;B=Qa.sectionPropertiesData;P=Qa.defaultTabStopLength;var mb=ca.Lt;ra=mb.lpa;mb=1===mb.specialIndentType?mb.OB:mb.OB-mb.vea;const Jb=B.marginLeft,Yb=B.marginRight;ca.isRtl?(ca=Xg.a.Oi(Math.max(Yb,Yb+ra),0),ra=Xg.a.Oi(Math.max(Jb,Jb+mb),0)):(ca=Xg.a.Oi(Math.max(Jb,Jb+mb),0),ra=Xg.a.Oi(Math.max(Yb,Yb+ra),0));B=Xg.a.Oi(B.Ko,0);P=Xg.a.Uca(P,0,!1);Qa.isParagraphValid=P<B-ca-ra;return 32};this.ga=b;this.mBa=h;this.HK=r}get Qd(){return null!=this.VIg?
this.VIg:this.VIg=Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get q7c(){return null!=this.JGg?this.JGg:this.JGg=Ya.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Ub(){const b=r=>Py.OutlineElementGeneralizer.Cha(r.ib,!0),h=qe.App.wVa.GKc(b,!0);this.ga.qa(V.a.nOb,zc.a.view,qe.App.wVa.GKc(b,!1));this.ga.fb(V.a.nOb,zc.a.paragraph,this.nOb,96);this.ga.qa(V.a.n7a,zc.a.view,h);this.ga.fb(V.a.n7a,zc.a.paragraph,this.n7a,96);this.ga.qa(V.a.$Ob,zc.a.view,
h);this.ga.fb(V.a.$Ob,zc.a.paragraph,this.$Ob,96);this.ga.qa(V.a.E9c,zc.a.view,h);this.ga.fb(V.a.E9c,zc.a.paragraph,this.E9c,96);this.ga.qa(V.a.mgc,zc.a.view,h);this.ga.fb(V.a.mgc,zc.a.paragraph,this.mgc,96);this.ga.qa(V.a.SSb,zc.a.view,h);this.ga.fb(V.a.SSb,zc.a.paragraph,this.SSb,96);this.ga.qa(V.a.Jrg,zc.a.view,h);this.ga.fb(V.a.Jrg,zc.a.paragraph,this.ISm,96);this.ga.qa(V.a.emc,zc.a.view,this.rsj);this.ga.qa(V.a.Cti,zc.a.view,this.rsj)}}Object(n.a)(jK,"CustomTabActor",null,[]);var XM=c(120),OG=
c(630);class kK{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.ga=b;this.KAd=r;this.MKa=(this.s0b=P)&&B;this.Cn=ca;this.BT=ra;this.A0j=Qa;this.Ax=mb;this.nMg=h;this.nMg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.YNf(!0),this.qNf(!0)):(this.s0b&&rh.a("isSharedUXDarkModeOn")?(this.Cn.nJ=appChrome.api.isSharedUXDarkModeOn(),this.YNf(!0)):this.Cn.nJ=!1,this.MKa?this.qNf(!0):this.Cn.lVa=!1);v.AFrameworkApplication.rI(()=>{this.uMb()});this.MKa&&rh.a("dispatch")&&
appChrome.api.dispatch(this.Wxj([]))}Ub(){this.MKa&&(this.ga.qa(V.a.jMo,zc.a.view,this.qil.bind(this)),this.ga.qa(V.a.C$c,zc.a.view,this.C$c.bind(this)),this.ga.fb(V.a.L5c,zc.a.view,this.L5c.bind(this),96));this.s0b&&(this.ga.qa(V.a.D$c,zc.a.view,this.D$c.bind(this)),this.ga.fb(V.a.lce,zc.a.view,this.lce.bind(this),96))}jHm(b){if(!this.Gto(b))return!1;const h=kl.a.instance.Pc(2);try{h.Db(b.root);const r=xd.GraphIterator.eb(b.root.graphNode),B=ao.a.Qp(r);for(;B.moveNext();){const P=Object(Na.a)(XM.a,
B.currentNode);P&&P.IJ(b.$b,20,!0)}}finally{h&&h.dispose()}return!0}Gto(b){return b&&b.root&&b.ov?b.$i||b.SFf||b.Myi||b.Zj:!1}v6n(){let b=!1;this.KAd.forEach(h=>{this.jHm(h)&&(b=!0)});return b}kMo(){t.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Cn.nJ?"dark":"light");return this.Cn.nJ?OG.a.aGc(1):OG.a.kaj(1)}jng(){const b=this.Cn.j8;t.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.v6n()||(b?!OG.a.aGc(0):
!OG.a.kaj(0)))return!1;this.A0j.gPn(b);return!0}Wxj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Cn.nJ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.yii(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Cn.lVa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):t.ULS.sendTraceTag(527283228,
3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){t.ULS.sendTraceTag(527282835,3023,10,h)}return b}qil(){return this.jng()?32:8}D$c(b,h,r){if(1===r)return 32;b=this.BT.Yf("UserAction","sharedUXDarkModeToggle");if(rh.a("toggleSharedUXDarkMode"))t.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),rh.a("isSharedUXDarkModeOn")?this.Cn.nJ=appChrome.api.isSharedUXDarkModeOn():this.Cn.nJ=!this.Cn.nJ,t.ULS.sendTraceTag(529388308,
3023,50,"User in new ribbonMode: {0}",this.Cn.nJ);else return 8;appChrome.getHeaderApi().then(B=>{B.hasOwnProperty("refreshThemeOverride")&&B.refreshThemeOverride()});this.kMo()||t.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.MKa&&!this.Cn.lVa&&(this.jng()||t.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");ab.StaticActiveAppFrame.za().lH(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",
!this.Cn.nJ));this.MKa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Cn.nJ));b.stop();t.ULS.sendTraceTag(555885377,3023,50,"{0}",b.pi);ne.b(this.Cn.nJ?"DarkModeOn":"DarkModeOff");return 32}C$c(b,h,r){if(1===r)return 32;b=this.BT.Yf("UserAction","sharedUXDarkModeSwitchBackground");t.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Cn.lVa=!this.Cn.lVa;if(!this.jng())return 8;h={};h.DarkModeSwitchBackground=
this.Ax?"ButtonModel":"ToggleButtonModel";ab.StaticActiveAppFrame.za().lH(h);b.stop();t.ULS.sendTraceTag(555885378,3023,50,"{0}",b.pi);t.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Cn.lVa);ne.b(this.Cn.lVa?"DarkCanvasOff":"DarkCanvasOn");return 32}lce(b,h,r,B,P){if(1===r)return 32;if(!P)return 2;rh.a("isSharedUXDarkModeOn")&&(this.Cn.nJ=appChrome.api.isSharedUXDarkModeOn());P&&(P[Df.a.On]=this.Cn.nJ);return 32}L5c(b,h,r,B,P){if(1===r)return 32;if(!P)return 2;!this.Ax&&P&&
(P[Df.a.On]=this.Cn.lVa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Cn.nJ));this.MKa&&this.Wxj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.yii(!1)));appChrome.api.dispatch(b);return 32}yii(b){const h={};this.Cn.lVa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");
return h}uMb(){this.s0b&&this.YNf(!1);this.MKa&&this.qNf(!1)}YNf(b){var h;t.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.Cn.nJ?"dark":"light",this.Cn.DEa);b&&this.Cn.nJ!=(null===(h=this.nMg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&t.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Cn.nJ?"dark":"light",this.Cn.DEa)}qNf(b){t.ULS.sendTraceTag(561088150,3023,
50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Cn.j8?"dark":"light",this.Cn.pil)}}Object(n.a)(kK,"DarkModeActor",null,[]);var lK=c(1621),YM=c(532);class PG{constructor(){this.Height=this.Width=0}static construct(b,h){const r=new PG;r.Width=b;r.Height=h;return r}}Object(n.a)(PG,"ViewportInfo",null,[]);class DH extends Wm.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=
this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}ml(){return YM.a.swayPreview}static construct(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){const fc=new DH;fc.ContractVersion=b;fc.DocumentContent=h;fc.EnhancementId=r;fc.World=B;fc.ScalingFactor=P;fc.DesktopViewportInfo=PG.construct(ca,ra);fc.MobileViewportInfo=PG.construct(Qa,mb);fc.MinParagraphCount=Jb;fc.ContentCulture=Yb;return fc}}Object(n.a)(DH,"SwayPreviewRequest",Wm.a,[]);var ZM=c(602);class yD{static get Vg(){return Pf.a.Nx(qe.App.instance&&
qe.App.instance.$1d?yD.fol:yD.Wm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,yD.Dao,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}yD.Dao=Ad.a.xg("progress.gif");yD.Wm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
yD.fol="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(n.a)(yD,"DigitalPrintDialogHtml",null,[]);class Fx{constructor(b,h,r,B){this.fontFamily=b;this.n8n=h;this.fontWeight=r;this.fontStyle=B}}Object(n.a)(Fx,"FontInfo",null,[]);class Rs{constructor(b,h,r,B){this.styleName=b;this.title=h;this.CLo=r;this.yum=B}}Object(n.a)(Rs,"StyleVisualInfo",null,[]);class fE extends Pf.a{constructor(b,h,r,B,P=!0){super();this.g7=this.gu=this.Wla=this.p3=this.Bnd=this.Mih=this.Lyd=this.bVe=this.cVe=this.uUe=this.P0b=this.DNa=this.E3=this.g0b=null;this.SXe=this.uQe=
!1;this.pmd=null;this.xsl=()=>{this.Phj(0)};this.wsl=(ca,ra)=>{this.Phj(ra)};this.wZi=ca=>{this.Gbi(ca)===Sys.UI.Key.enter&&(this.aZf(ca),ca.preventDefault(),ca.stopPropagation())};this.NVi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===Ai.a.Fgd)||ba.a.ht)&&this.DNa&&this.sQb(this.DNa)};this.OVi=ca=>{const ra=this.Gbi(ca);ra!==Sys.UI.Key.tab&&ra!==Sys.UI.Key.left&&ra!==Sys.UI.Key.right&&ra!==Sys.UI.Key.up&&ra!==Sys.UI.Key.down||this.mrm(ra)||(ca.preventDefault(),
ca.stopPropagation(),this.vpn(ra))};this.aXf=()=>{this.SXe||(this.SXe=!0,t.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),De.a.removeHandler(this.E3,Xc.a.scroll,this.aXf))};this.KXf=()=>{t.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.aZf=ca=>{ca.preventDefault();ca.stopPropagation();v.AFrameworkApplication.va.processAction(Mb.a.kTh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.g0b&&(t.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.g0b,ca.id),this.nDh(ca),this.PNh()):t.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.Nol=ca=>{const ra=(new Date).getTime()-this.OSg;ki.a.instance.pf(Cg.a.Pol,ra);ca?this.pfo():(t.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),v.AFrameworkApplication.va.processAction(Mb.a.jTh,2))};
this.nfo=()=>{this.Xyo();try{const ca=fE.MUh.bBl(),ra=DH.construct(2,ca,this.g0b,"VerticalWorld",.3,1366,600,330,280,20,fE.MUh.yab.name);v.AFrameworkApplication.He.nj(String.format("{0}/we/GetSwayPreview.ashx?{1}",qe.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,ZM.b(ra),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.kIn,this.q4i,ra)}catch(ca){t.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.kIn=ca=>{var ra=null;({group:ra}=de.a.d2(ca.data.te)).returnValue?(ra=ra.Responses[0],ra.Succeeded?(this.P3d(ca.data,Cg.a.ZGo),this.jgb(),this.ynj(this.bVe,ra.PreviewHtml),this.ynj(this.Lyd,ra.PreviewHtmlMobile)):this.q4i(null)):t.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.q4i=()=>{this.Yyo();this.cVe.style.background="#E6E6E6";this.Mih.style.background="#E6E6E6"};this.Vg=yD.Vg;this.zg="DigitalPrintDialog";t.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.Igk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.tWb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.Tlk=r;this.yvc=B;this.ye(1,this.Igk);this.Uh(this.tWb,this.Nol,null);this.vBm();this.GFo();this.OSg=(new Date).getTime();P&&Wv.a.mR(xD.a.digitalPrint,!1,this.xsl,this.wsl,null);this.GCm();this.Wzm();this.g3m();this.UMf();this.Y2m();this.PNh()}get Awa(){return this.pmd}Phj(b){if(!this.uQe){const h=
(new Date).getTime()-this.OSg;ki.a.instance.pf(Cg.a.Ool,h);b?t.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",di.a[b])):t.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.f0a.disabled=!1}}vBm(){this.P0b=document.getElementById("digitalPrintStatusMessageDiv");this.uUe=document.getElementById("digitalPrintStatusMessageIconDiv");this.cVe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.bVe=document.getElementById("swayDesktopPreviewHtmlHolder");this.Lyd=document.getElementById("swayMobilePreviewHtmlHolder");this.Mih=document.getElementById("swayMobilePreviewWrapperDiv");this.E3=document.getElementById("swayGallery");this.E3.setAttribute("tabindex","0");De.a.addHandler(this.E3,Xc.a.scroll,this.aXf);this.E3.setAttribute(qf.a.uh,qf.a.$vh);this.p3=document.getElementById("digitalPrintLearnMoreLink");this.p3.href="https://go.microsoft.com/fwlink/?linkid=871972";De.a.addHandler(this.p3,
Xc.a.click,this.KXf);this.Wla=new vb.a;this.Bnd=document.getElementById("homeWrapper");this.M5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.yvc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}GCm(){this.gu=new vb.a;this.gu.add(new Rs("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.gu.add(new Rs("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.gu.add(new Rs("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.gu.add(new Rs("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.gu.add(new Rs("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.gu.add(new Rs("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.gu.add(new Rs("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.gu.add(new Rs("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.gu.add(new Rs("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.gu.add(new Rs("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.gu.add(new Rs("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.gu.add(new Rs("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.gu.add(new Rs("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.gu.add(new Rs("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.gu.add(new Rs("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.gu.add(new Rs("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.gu.add(new Rs("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.gu.add(new Rs("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.gu.add(new Rs("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.gu.add(new Rs("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.gu.add(new Rs("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.gu.add(new Rs("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}Wzm(){this.g7=
new vb.a;this.g7.add(new Fx("universc","universc","normal","normal"));this.g7.add(new Fx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.g7.add(new Fx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.g7.add(new Fx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.g7.add(new Fx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.g7.add(new Fx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.g7.add(new Fx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.g7.add(new Fx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.g7.add(new Fx("ArialNova","ArialNova","normal","normal"));this.g7.add(new Fx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.g7.add(new Fx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.g7.add(new Fx("RockwellNova","RockwellNova","normal","normal"));
this.g7.add(new Fx("SabonNRegLT","SabonNRegLT","normal","normal"));this.g7.add(new Fx("DaytonaThin","DaytonaThin","100","normal"))}g3m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.g7)h+=String.format(this.Tlk,r.fontFamily,r.n8n,r.fontWeight,r.fontStyle);b.innerText=h;this.Bnd.appendChild(b)}Y2m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Ad.a.xg("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Ad.a.xg("SwayPreviewFrameHC.svg"));b.innerText=h+r;ba.a.Er&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Bnd.appendChild(b)}Gbi(b){return b?b.keyCode:window.event.keyCode}hide(){this.R7f();super.hide()}R7f(){if(this.E3&&!this.uQe){for(let b=0;b<this.Wla.count;b++)De.a.removeHandler(this.Wla.J(b),
Xc.a.click,this.aZf),De.a.removeHandler(this.Wla.J(b),Xc.a.gi,this.wZi);De.a.removeHandler(this.E3,Xc.a.gi,this.OVi);De.a.removeHandler(this.E3,Xc.a.focus,this.NVi);De.a.removeHandler(this.p3,Xc.a.click,this.KXf);this.SXe||De.a.removeHandler(this.E3,Xc.a.scroll,this.aXf);this.uQe=!0}}UMf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Ad.a.JMk());this.Bnd.appendChild(b);for(const h of this.gu)this.HJd(this.E3,h);this.G1(this.E3);
this.nDh(this.E3.firstChild);this.E3.firstChild.focus();De.a.addHandler(this.E3,Xc.a.gi,this.OVi);De.a.addHandler(this.E3,Xc.a.focus,this.NVi)}HJd(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(qf.a.sfb,qf.a.yM);r.setAttribute("title",h.title);r.setAttribute(qf.a.uh,qf.a.cwh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Ad.a.xg("swayPublish.png");b.setAttribute(qf.a.uh,qf.a.xz);b.setAttribute("unselectable","on");b.setAttribute(qf.a.uA,qf.a.xp);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.CLo;b.setAttribute(qf.a.uA,qf.a.xp);b.setAttribute("unselectable","on");b.setAttribute(qf.a.uh,qf.a.xz);r.appendChild(b);const B=document.createElement("label");B.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;B.className=h.yum;B.setAttribute(qf.a.uA,
qf.a.xp);b.setAttribute("unselectable","on");B.setAttribute(qf.a.uh,qf.a.xz);r.appendChild(B);De.a.addHandler(r,Xc.a.click,this.aZf);De.a.addHandler(r,Xc.a.gi,this.wZi);this.Wla.add(r)}vpn(b){const h=this.Awa;this.$Hl(b,h,!v.AFrameworkApplication.isRtl)||this.bIl(b,h,!v.AFrameworkApplication.isRtl)||this.XHl(b,h)||this.YHl(b,h)}mrm(b){return b===Sys.UI.Key.tab?(this.Awa&&this.Awa!==this.DNa&&(this.Awa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.pmd=this.DNa),!0):!1}$Hl(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.E3.firstChild,this.sQb(b),!0):!1}bIl(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.E3.lastChild,this.sQb(b),!0):!1}XHl(b,h){return b===Sys.UI.Key.down?(b=this.Wla.indexOf(h),h=b+2,h<this.Wla.count?(b=this.Wla.J(h))&&this.sQb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Wla.J(h))&&this.sQb(b)),!0):!1}YHl(b,h){b===Sys.UI.Key.up&&(b=this.Wla.indexOf(h),h=b-2,0<=h?(b=this.Wla.J(h))&&
this.sQb(b):(h=b?20+b-1:this.Wla.count-1,(b=this.Wla.J(h))&&this.sQb(b)))}sQb(b){this.Awa&&this.Awa.id!==this.DNa.id&&(this.Awa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.pmd=b;this.Awa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.Awa.focus()}GFo(){this.f0a.className="WACDialogButtonNormal swayPrintToWebButton";this.f0a.setAttribute("tabindex","0");this.aA.className="WACDialogButtonNormal swayCancelButton";
this.aA.setAttribute("tabindex","0");this.f0a.disabled=!0}nDh(b){this.Awa&&(this.Awa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.DNa&&(this.DNa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.DNa.setAttribute(qf.a.sfb,qf.a.yM));this.g0b=b.id;this.DNa=b;this.DNa.setAttribute(qf.a.sfb,qf.a.xp);this.pmd=b;this.Awa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}PNh(){Rg.a.instance.Wb(new Oe.a(2,
1,50,this.nfo))}ynj(b,h){b.innerHTML=h}pfo(){t.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.g0b));v.AFrameworkApplication.va.processAction(Mb.a.lTh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",qe.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature,v.AFrameworkApplication.userSessionId,this.g0b);Qd.a.openWindow(4,b)}P3d(b,h){ki.a.instance.pf(h,+b.cU-+b.bI)}Yyo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.jgb();this.P0b.innerText=b;this.P0b.style.display="block"}Xyo(){this.jgb();this.uUe.style.display="block";this.P0b.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.P0b.style.display="block"}jgb(){this.cVe.style.background="";this.Lyd.style.background="";Kb.a.RQ(this.bVe);Kb.a.RQ(this.Lyd);this.P0b.style.display="none";this.uUe.style.display="none"}static get MUh(){return null!=fE.Gyg?fE.Gyg:fE.Gyg=
Ya.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(n.a)(fE,"DigitalPrintDialog",Pf.a,[]);class EH{constructor(b,h){this._context=this.Gk=null;this.cwe=0;this.iid=!1;this.Fhh=null;this.digitalPrint=(r,B,P,ca,ra)=>{if(1===P)return v.AFrameworkApplication.DF?8:32;this.Fhh=ra.SourceControlId;if(v.AFrameworkApplication.K.$("IsAnonymousUser"))return t.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=B;if(EH.cRm())return t.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.rbf(),32;switch(this.cwe){case 1:t.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.rbf();break;case 2:t.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.iid=!1,this.Gk=(new lk.a).create(),this.Gk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Gk.KL(CommonUIStrings.l_DefaultDialogTitle,this.uXk,null),v.AFrameworkApplication.He.nj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",qe.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.wXk,this.vXk,null)}return 32};this.uXk=()=>{this.iid=!0;t.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.wXk=r=>{if(!this.iid){this.Gk.close();var B=null;this.P3d(r.data,Cg.a.YGo);({group:B}=de.a.d2(r.data.te)).returnValue?(r=B.Responses[0],t.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.cwe=r.HasLicense?1:2,2===this.cwe?this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.rbf()):this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(t.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.vXk=r=>{this.iid||(this.Gk.close(),t.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.P3d(r.data,Cg.a.XGo),this.Hqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.U6=h}Ub(){v.AFrameworkApplication.eZ?t.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?t.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Mb.a.digitalPrintToSway,zc.a.view,this.digitalPrint,4),this.ga.fb(Mb.a.kTh,zc.a.view,nd.ActionManager.gR,4),this.ga.fb(Mb.a.lTh,zc.a.view,
nd.ActionManager.gR,4),this.ga.fb(Mb.a.jTh,zc.a.view,nd.ActionManager.gR,4),this.ga.fb(eb.a.CLd,zc.a.view,nd.ActionManager.gR,4))}rbf(){t.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.Fhh);new fE(this._context,this.ga,v.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),v.AFrameworkApplication.K.kb("FileSource"))}Hqb(b){const h=new Wh.StandardDialog;h.Cd=0;h.lka(CommonUIStrings.l_DefaultDialogTitle,b,
null)}P3d(b,h){ki.a.instance.pf(h,+b.cU-+b.bI)}static cRm(){return"OneDriveWOPI"===v.AFrameworkApplication.K.kb("FileSource")}}Object(n.a)(EH,"DigitalPrintActor",null,[]);class mK{constructor(){this.Dkh=null}LLi(){t.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}FDj(b){if(!b)return t.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.TEi(b.errorDetails))return!1;this.Dkh=Object(Na.a)(Hn.a,b.errorDetails).typeId;return!0}N$c(b){return this.TEi(b)?
Object(Na.a)(Hn.a,b).typeId===this.Dkh:!1}TEi(b){if(!b)return t.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Na.a)(Hn.a,b);return b?b.token&&b.typeId?!0:(t.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(t.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(n.a)(mK,"DoNotCheckThisCritiqueTypeStrategy",null,[605]);class nK extends Pf.a{constructor(b,h,r){super(!1,!1,!0);this.oc=b;this.roa=r;this.K1j="DocumentChoiceGroup";this.nUg="EmbededContent";
this.NZg="HyperLink";this.$Ie=r.lab;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.PFb()};this.kYj=this.GAl.bind(this);this.ye(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Uh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.kYj,b)}PFb(){const b=Array(2);b[0]={["key"]:this.nUg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.NZg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.K1j,["defaultSelectedKey"]:this.$Ie?this.nUg:this.NZg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}GAl(b,h){1===b?(this.$Ie!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?V.a.JPa:V.a.gib,this.oc.processAction(b,2),this.$Ie=h.isExternalContentSelected,oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ma.a,{name:"ActionId",int64:b})]}))),this.roa.bbo(h.isExternalContentSelected)):0===b&&t.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(n.a)(nK,"ExternalContentDefaultSettingsDialog",Pf.a,[]);class Ss{constructor(b,h,r,B,P){this.aM=Ya.a.instance.resolve("Common.IReactContextualUILauncher");this.ttb=Df.a.On;this.gmc=()=>{const ca=Array(1);ca.push("ExternalContent");var ra=Ya.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").qQa();ra=Object.assign(new sD.a,{x:ra.x,y:ra.y});this.aM.showFloatie(ra,ca,1);return 32};this.cIb=()=>{this.aM.M0&&this.aM.dismissFloatie();return 32};this.e6i=(ca,ra,Qa,mb,Jb)=>
{if(ra="object"===typeof Jb?Jb:null)ca===V.a.I4f?(ca=Ss.kYa!==V.a.JPa&&Ss.kYa!==V.a.gib,ra[this.ttb]=Ss.kYa===V.a.JPa||ca):ca===V.a.J4f&&(ra[this.ttb]=Ss.kYa===V.a.gib);return 32};this.EZh=(ca,ra,Qa)=>{1!==Qa&&(ca===V.a.gib&&Ss.kYa!==V.a.gib?(t.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Pm.undo()&&(ra=new vw.a(1,v.AFrameworkApplication.isRtl),ra.Z3c="ExternalContent",Ss.fib.e6c(ra))):ca===V.a.JPa&&Ss.kYa!==V.a.JPa&&(t.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.fVg.M7i()),Ss.kYa=ca);oa.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ma.a,{name:"behavior",string:Qa.toString()}),Object.assign(new ma.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Pm=h;this.fVg=B;this.g8j=P;this.jYj=this.HAl.bind(this);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.fVg.H9i(()=>{this.reset()})}Ub(){this.ga.fb(V.a.I4f,zc.a.view,this.e6i,97);this.ga.fb(V.a.J4f,zc.a.view,this.e6i,97);this.ga.fb(V.a.DZh,zc.a.view,this.jYj,1028);this.ga.fb(V.a.JPa,zc.a.view,this.EZh,1028);this.ga.fb(V.a.gib,zc.a.view,this.EZh,1028);this.g8j||(this.ga.fb(V.a.gmc,zc.a.view,this.gmc,96),this.ga.fb(V.a.cIb,zc.a.view,this.cIb,96))}oxo(b){new nK(this.ga,b,Ss.roa)}HAl(b,h,r){1!==r&&this.oxo(Ss.kYa);return 32}static get fib(){return null!=Ss.$yg?Ss.$yg:Ss.$yg=Ya.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get roa(){Ss.zBa||
(Ss.zBa=Ya.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ss.zBa}reset(){Ss.kYa=null!=Ss.roa?Ss.roa.lab?V.a.JPa:V.a.gib:V.a.JPa}}Ss.kYa=V.a.JPa;Ss.zBa=null;Object(n.a)(Ss,"ExternalContentActor",null,[]);class gE extends Pg{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){super(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc);this.XVc=Mc;this.PNd=!1;this.j0g=null}A6c(){this.PNd||(super.A6c(),this.PNd=!0)}eoe(){this.PNd&&(super.eoe(),gE.XVh&&this.j0g&&gE.XVh.removeHandler(gb.a.Mua,
this.j0g),this.PNd=!1)}TSb(){if(this.XVc){this.yva.M0&&this.yva.dismissFloatie();const b=new vw.a(0,v.AFrameworkApplication.isRtl);b.location=this.H6a.qQa();this.showFloatie(null,b)}else this.yva.M0&&v.AFrameworkApplication.va.processAction(V.a.cIb,2),v.AFrameworkApplication.va.processAction(V.a.gmc,2);this.pec=!1}dismissFloatie(b){!this.MGe&&(b&&(this.H6a.hDf(),this.GEj()),this.yva.M0||this.pMa)&&(this.pMa=!b,this.eoe(),this.XVc?this.yva.dismissFloatie():v.AFrameworkApplication.va.processAction(V.a.cIb,
2))}showFloatie(b,h){h||(h=new vw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.H6a.qQa());if(!h.location)return!1;this.pMa&&(this.pMa=!1,this.A6c());this.XVc?(b=Array(1),b.push("ExternalContent"),this.yva.showFloatie(this.H6a.qQa(),b,1)):v.AFrameworkApplication.va.processAction(V.a.gmc,2);return!0}ALc(){if(!this.pec){const b=new Oe.a(3,1,this.cQh,()=>{this.TSb()},196);Rg.a.instance.Wb(b);this.pec=!0}}Pja(){this.XVc?this.yva.M0&&this.yva.dismissFloatie():v.AFrameworkApplication.va.processAction(V.a.cIb,
2);this.ALc()}VPb(){this.XVc?this.yva.M0&&this.yva.dismissFloatie():v.AFrameworkApplication.va.processAction(V.a.cIb,2);this.ALc()}static get XVh(){return null!=gE.Lyg?gE.Lyg:gE.Lyg=Ya.a.instance.resolve("Box4.IEditStateEventManager")}}Object(n.a)(gE,"ExternalContentFloatieEventManager",Pg,[]);class hE extends ww{constructor(b,h,r,B,P){super(b,h,r,B,P)}iBh(){if(!this.hb||!this.hb.ib||!this.hb.ib.lb)return t.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),
null;var b=this.hb.ib.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.KJ){do r=this.xfi(r);while(r&&!r.KJ&&Object(uc.a)(ni.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const P=Object(Na.a)(ni.AParagraphNode,r);P&&(B=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());h=P?B.length:b.cpBegin;b=Object.assign(new Nz,{Rya:Object(Na.a)(112,(P?Object(Na.a)(112,P):Object(Na.a)(112,r))||b.node),jic:h});return this.lrf(b)}Cai(b,
h){let r=null;const B=Object(Na.a)(209,b.Rya.Aj(h.$b));if(!B)return null;if(Object(uc.a)(ni.AParagraphNode,b.Rya)){const P=Object(Na.a)(ni.AParagraphNode,b.Rya);if(P.YQ){if(b=Object(Na.a)(dt.a,Td.ParagraphReader.sQa(P)))(b=Object(Na.a)(209,b.Aj(h.$b)))&&(r=b.getBounds()),r&&(r.height+=hE.M1h,r.width-=hE.rHl);return r}h=Object(Na.a)(94,B);if(!h)return null;try{if(r=this.nua.Q_(b.jic,h,0<b.jic,!1,!1,!1))r.height+=hE.M1h}catch(ca){t.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
ca),r=null}}r||(r=B.getBounds());return r}}hE.M1h=65;hE.rHl=100;Object(n.a)(hE,"ExternalContentFloatiePositionProvider",ww,[]);class oK{constructor(b,h,r,B,P,ca){this.j$f=(ra,Qa,mb)=>{if(1===mb)return v.AFrameworkApplication.eZ||v.AFrameworkApplication.DF||v.AFrameworkApplication.Fpa||gc.SessionStatusManager.instance.Yj?8:32;if(ra===Mb.a.print)ra=1;else if(ra===V.a.MMc)ra=0;else if(ra===V.a.oMd)ra=2;else return 8;return this.Mao(ra)};this.ga=b;this.U6=h;this.jXb=r;this.s1j=B;this.bTg=P;this.zYj=ca;
this.YI=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback")}Ub(){v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.s1j||v.AFrameworkApplication.DF?(document.body.classList.add("WACStopPrinting"),""!==this.bTg&&this.zYj.Pxo(this.bTg)):(this.ga.qa(Mb.a.print,zc.a.application,this.j$f),this.ga.qa(V.a.MMc,zc.a.application,this.j$f),this.ga.qa(V.a.oMd,zc.a.application,this.j$f))}Mao(b){const h=v.AFrameworkApplication.rootQuerySignature;if(!h||""===h||qe.App.zd&&qe.App.zd.nC.Io)return 8;this.jXb.yZd=
!1;this.jXb.cLj.start();Wv.a.mR(xD.a.conversion,!0,Object(z.a)(this.jXb,this.jXb.$5n,"requestFileDownload"),Object(z.a)(this.jXb,this.jXb.IMb,"onForceSaveFailed"),b);this.nre();return 32}nre(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145741,306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(n.a)(oK,"FileDownloadActor",
null,[]);class pK extends cf{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get HAf(){return null}get W5a(){return this.YZd?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:v.AFrameworkApplication.t1a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get lfc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get PCd(){return null}get YZd(){return"VersionHistory"===this.M6e?
!1:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}A3d(){t.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");v.AFrameworkApplication.Ria("tcopypdf;ccopypdf")}}Object(n.a)(pK,"DownloadAsPdfDialog",cf,[]);class jw{constructor(){this._url=this.xv=null;this.AZa=this.zZa=0;this.Feb=!1;this.makeRequest=()=>{v.AFrameworkApplication.He.nj(this._url,1,null,null,!0,2,this.TMb,this.Bqa,null)};this.TMb=b=>{jw.P7c();const h=b.data.Qja;
let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(B){}r&&("InProgress"===r.text&&22>this.zZa++||"ServiceBusy"===r.text&&3>this.AZa++)?this.FIa(1E3*(this.zZa+this.AZa)):this.xv(!0,r?r.text:null,b.data)};this.Bqa=b=>{this.Feb?(jw.yCa||(jw.rcb=new Date,jw.yCa=!0,jw.wT=1),18E4>(new Date).getTime()-jw.rcb.getTime()?this.retryOnFailure(4<=jw.wT?2E4:1E3):this.t3a(b.data)):4>jw.wT?this.retryOnFailure(2E3):this.t3a(b.data)}}send(b,h,r){this._url=b;this.xv=h;this.Feb=r;this.makeRequest(null)}FIa(b){b=
new Oe.a(2,1,b,this.makeRequest);v.AFrameworkApplication.lc.Wb(b)}retryOnFailure(b){this.FIa(b);jw.wT++}t3a(b){this.xv(!1,null,b)}static I8(b,h){(new jw).send(b,h,!1)}static P7c(){jw.yCa=!1;jw.wT=0}}jw.rcb=null;jw.yCa=!1;jw.wT=0;Object(n.a)(jw,"ClientRequestWithRetry",null,[]);class qK extends Le{constructor(b){super(b,void 0,v.AFrameworkApplication.t1a)}get W5a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get lfc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get m_c(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get iLc(){return v.AFrameworkApplication.t1a?
"UIFontDialogTextLarge":null}A3d(){t.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}uNf(){t.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}K_c(){t.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get UZc(){return rB.jTi}get xmb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get qPi(){return!v.AFrameworkApplication.t1a}}Object(n.a)(qK,"DownloadAsOdtDialog",Le,[]);class rK{constructor(b,h){this.mbb=this.s_a=
null;this.x8a=r=>{1===ab.StaticActiveAppFrame.za().state||this.s_a||(this.s_a=(new lk.a).create(),r=r.customData,this.K4m(r),1===r?this.s_a.message=this.yub.fR.isEnabled?v.AFrameworkApplication.t1a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:r?2===r&&(this.s_a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.s_a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.s_a.KL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.yZd=!0};this.W9=(r,B,P)=>{this.Rjg("Success. Save and Conversion Complete.");P=new xb.QueryStringBuilder(P.request.get_url());v.AFrameworkApplication.qga(P);P=P.toString();const ca=this.o6n(P);this.aoa(ca);2!==ca&&this.yub.UIn();if(!r||B)this.U5(ca);else if(this.yZd)this.yZd=!1,this.mbb=null;else{this.mbb&&v.AFrameworkApplication.lc.ff(this.mbb);this.mbb=null;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePdfProtectionUsageTelemetry",
!1)&&0===ca){B=new ma.a;B.name="IsPdfProtectionEnabled";B.bool=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeepPDFProtection",!1);const ra=new ma.a;ra.name="IsLabeled";const Qa=v.AFrameworkApplication.K.kb("AppliedPolicyId");ra.bool=!!(Qa&&0<Qa.length);ne.a("PdfProtectionUsage",r,void 0,[B,ra])}this.uql(P,ca)}};this.yZd=!1;this.yub=b;this.cLj=h.DSa("UserAction","WordEditorForceSaveAndPrint")}aoa(b){this.s_a&&(this.U4m(b),this.s_a.close(),this.s_a=null)}U5(b){if(1!==
ab.StaticActiveAppFrame.za().state){this.N5m(b);const h=new Wh.StandardDialog;h.Cd=0;h.ye(1,CommonUIStrings.l_DialogClose);h.wx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}wuf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return t.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}$5n(b){var h=v.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+
this.rkf(b)+"?"+h+"&type="+this.wuf(b)+"&rndm="+Lb.a.create(),1===b&&this.yub.gwo()&&(h+="&useNamedAction=1"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&bp.FontUtils.tie()&&(1===b||!b)&&(0<bp.FontUtils.NPh&&(h+="&cfcVer="+bp.FontUtils.NPh),bp.FontUtils.MPh&&(h+="&cfcUrl="+bp.FontUtils.MPh),bp.FontUtils.OPh&&(h+="&cfcEncData="+bp.FontUtils.OPh)),jw.I8(h,this.W9),this.mbb||(this.mbb=new Oe.a(2,1,500,this.x8a),this.mbb.customData=b,v.AFrameworkApplication.lc.Wb(this.mbb))):
(this.Rjg("failed. QuerySignature is empty."),this.U5(b))}rkf(b){return 2===b?"odt":"pdf"}IMb(){this.Rjg("Failed. force save failed.")}o6n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;t.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}Rjg(b){t.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.cLj.stop()}uql(b,h){const r=
new vb.a;r.add("access_token");r.add("access_token_ttl");1!==ab.StaticActiveAppFrame.za().state&&(1===h?this.yub.zyo(b,r):h?2===h&&new qK(b):new pK(b))}dispose(){}K4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:t.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:t.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:t.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}U4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:t.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:t.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:t.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}N5m(b){switch(b){case 0:t.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:t.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:t.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:t.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(n.a)(rK,"FileDownloadManager",null,[]);class iE{get key(){return"LIST"}get Ku(){return Box4Intl.Box4Strings.l_ListContentTitle}ESb(b){let h=null;const r=iE.Jd.ww(b);if(!r)return{returnValue:!1,Xba:h};b=this.E3l(b,r);h=Object.assign(new Vx.a,{nE:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Xba:h}}ejb(b,h){b=b.contentObject;const r=this.m2l(b.Wx),B=new Hh.a;h?(h=h.contentObject,h.level!==b.level?(B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),B.add(r)):h.id.equals(b.id)&&h.Wx.listType===b.Wx.listType||B.add(r)):(B.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),B.add(r));return B.toArray().join(" ")}m2l(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Tu);else if(1===b.listType)switch(r){case 1:h=this.Uzh;break;case 2:h=this.aQk;break;case 3:h=this.bQk;break;default:h=
this.Uzh}return h}static get Jd(){return null!=iE.DEg?iE.DEg:iE.DEg=Ya.a.instance.resolve("Box4.List.IListReader")}}Object(n.a)(iE,"ListDetailsProvider",null,[549,346]);class sK{constructor(){this.Wx=this.listId=this.id=null;this.level=0}}Object(n.a)(sK,"ListItemInfo",null,[]);class tK extends iE{constructor(b){super();this.d7=b}get Uzh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get aQk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get bQk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}E3l(b,
h){const r=this.d7.GB(b);return Object.assign(new sK,{id:b.currentNode.id,listId:new U.a(Lb.a.nil,r.listID),Wx:h,level:r.level+1})}}Object(n.a)(tK,"FlatListDetailsProvider",iE,[]);class uK{constructor(b,h){this.ga=b;this.Hf=h}get qc(){return null!=this.lKg?this.lKg:this.lKg=Ya.a.instance.Oa("Box4.Styles.IWACStyleReader")}Ub(){}}Object(n.a)(uK,"FormattingActor",null,[]);var $M=c(1182),YE=c(1345),aN=c(1732);class vK{constructor(b,h,r,B,P,ca,ra,Qa){this.Gb=b;this.rjk=h;this.Lc=r;this.Kvb=B;this.ap=P;
this.Ca=ca;this.rd=ra;this.f9j=Qa}phc(b,h,r,B,P,ca,ra){t.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.pi});this.Kvb.then(()=>{this.rjk(b.data.te);t.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.pi});ra.stop()})}Bqa(b,h,r,B,P,ca,ra){ca.stop();P();ra?(this.tDn(h,r),t.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:ye.ImageReader.vQa(h.Gb)})):t.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:ye.ImageReader.vQa(h.Gb)})}Vth(b,h){b.Ae(HG.a.taf,RF.documentXmlToJson.toString());if(this.rd&&this.rd.isFeatureEnabled(51)){var r=this.ap.sn(h.ik);r=this.ap.ui(r);b.Ae(Sg.a.Ns,YE.a[r]);5===r&&this.vEk(b,h)}this.f9j&&b.Ae(Sg.a.EXd,"true")}Gnh(){return new aN.a(this.Gb.id,this.Gb)}tUd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}tDn(b,h){const r=
this.Lc.Pc(7,Mb.a.unm);r.Db(h);b.Gb.setValue(Oc.a.fJh,!0);r.dispose()}vEk(b,h){var r=h.ik;h=this.ap.sn(r);var B=r.node;const P=(r=this.ap.JFa(h,B.Mc,!1))?this.ap.CFa(r):"";if(""===P)throw t.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");B=(B=this.ap.JFa(h,B.Mc,!0))?this.ap.CFa(B):"";b.Ae(Sg.a.Ghc,P);b.Ae(Sg.a.gLj,B);r=r.ja(xe.a.I_h,"");""!==r&&b.Ae(Sg.a.extension,r);b.Ae(Sg.a.width,this.ap.oF(h).toString());
b.Ae(Sg.a.height,this.ap.KG(h).toString());b.Ae(Sg.a.g4c,this.ap.Fjb(h).toString());r=this.Ca.$("WordEditorImageCropIsEnabled");b.Ae(Sg.a.ZOh,r.toString());r&&(r=this.ap.yca(h),b.Ae(Sg.a.top,r.top.toString()),b.Ae(Sg.a.bottom,r.bottom.toString()),b.Ae(Sg.a.left,r.left.toString()),b.Ae(Sg.a.right,r.right.toString()));r=this.Ca.$("WordEditorImageRotateIsEnabled");b.Ae(Sg.a.Dgj,r.toString());r&&(b.Ae(Sg.a.angle,this.ap.p0(h).toString()),h=this.ap.Loa(h),b.Ae(Sg.a.flipH,h.xib?"true":"false"),b.Ae(Sg.a.flipV,
h.hFa?"true":"false"));b.Ae(Sg.a.BWh,"true")}}Object(n.a)(vK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[612]);class wK{constructor(){this.SLa=null}YKk(b){this.SLa=b}teardown(){null!=this.SLa&&(this.SLa.teardown(),this.SLa=null);this.tPe=null}getGraphicData(){return this.SLa?this.SLa.getGraphicData():null}MZn(){null!=this.tPe&&this.setGraphicData(this.tPe)}setGraphicData(b){this.tPe=b;if(this.SLa)try{this.SLa.setGraphicData(b)}catch(h){t.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else t.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.SLa?this.SLa.hasEdits():!1}}Object(n.a)(wK,"GraphicsEditorGC2HostUser",null,[614]);var bN=c(1733),cN=c(1102),dN=c(1394),eN=c(802),fN=c(1491),gN=c(1101);class xK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(n.a)(xK,"GC2ScriptLoader",null,[]);class FH{constructor(b,
h,r){this.Dwe=b;this._context=h;this.qNa=r}closeEditor(){this.Dwe&&(this.Dwe(),this.Dwe=null)}logActivity(b,h,r,B){ne.a(b,h,r,B)}logTrace(b,h,r,B){t.ULS.sendTraceTag(575522531,3001,FH.q9m(h),B)}isEnabled(b){const h=v.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ya.a.instance.resolve("Box4.IFontServiceParser").h2a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=bp.FontUtils.Mnf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==
r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return xa.Health.instance}getFonts(b){const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",B=`${Ya.a.instance.resolve("Box4.IFontServiceParser").h2a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,B);bp.FontUtils.ooh();bp.FontUtils.Qoh({});b=bp.FontUtils.Lnf(()=>!1,(P,ca)=>ca).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.f5k()));return b}f5k(){const b=bp.FontUtils.Mnf(()=>!1,()=>"").fonts.map((h,r)=>{const B=h.name;h=h.displayName;const P=bp.FontUtils.Spa(B);return Object.assign(new FE.a,{MenuItemId:bp.FontUtils.Eij+r,CommandValueId:B,LabelText:h||B,Styles:{["optionText"]:{["fontFamily"]:h&&!P?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:B})});return Object.assign(new Nf.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.ik;var r=ye.ImageReader.sn(h);if(this.ZOm(r,h,b)&&(r=ye.ImageReader.n6(r,Zc.a.Eqa,""),r.length))return Promise.resolve(r);r=new xb.QueryStringBuilder("/we/GetImage.ashx?");r.x2b(h.node.Zi().yr);r.Ae(Sg.a.DKd,b);v.AFrameworkApplication.qga(r);r.Ae(li.a.rsb,"1");ke.a.instance.bBb(r);r.Ae(Sg.a.aQh,"true");const B=r.toString();return new Promise((P,ca)=>{this.qNa.nj(B,1,null,null,!1,2,ra=>{P(ra.data.te)},ra=>{ca(ra.data.Ne.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=
Ad.a.xg("progress.gif");b.PictureInvalid=Ad.a.xg("CancelRequest.32x32x32.png");return b}getTheme(){const b=ro.PageNavigator.instance.uu(this._context.view.ed).properties.ja(Oc.a.nme,"");return 0===b.length?[]:b.split(" ").map(h=>qe.App.FCb[h])}static q9m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}ZOm(b,h,r){const B=h.node.Mc;h=ye.ImageReader.xTd(b,B,!1);b=ye.ImageReader.xTd(b,B,!0);return r===h||r===b}}Object(n.a)(FH,"GraphicsEditorApp",
null,[625]);class yK extends Pf.a{constructor(b,h,r,B,P){super(!1,!1,!0);this.closeEditor=()=>{this.IJh();this.dispose()};this.eca=ca=>{this.IJh(2===ca)};this.Dbb=b;this.N5j=h;this.f_g=r;this._context=B;this.qNa=P}Fxo(b){return new Promise((h,r)=>{this.Uh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.eca,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(B,P)=>this.eMk(P,b),["onload"]:B=>{this.onLoad(B,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.Dbb.MZn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.Dbb.YKk(b),h(b)):(t.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}eMk(b,h){const r=v.AFrameworkApplication.K,B=gN.a();B.loadScriptWithRetryHandler=b;const P=new FH(this.closeEditor,this._context,this.qNa),ca={["bootConfig"]:Object.assign(new dN.a,
{scriptBaseUrl:RE.AppChromeOverrideUtilities.isEnabled?RE.AppChromeOverrideUtilities.hTd(v.AFrameworkApplication.lcid):v.AFrameworkApplication.b6+v.AFrameworkApplication.lcid+"/",isMLRRibbonMode:v.AFrameworkApplication.ta.Kb.Vlc,isCombinedBundleEnabled:v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new xK(new cN.DynamicScriptLoader(B)),["publicPath"]:v.AFrameworkApplication.b6,["appSettings"]:r.appSettings,["logger"]:new Tm.a,["featureGateManager"]:Object.assign(new eN.a,
{getBooleanFeatureGate:Object(z.a)(r,r.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(r,r.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(r,r.getStringFeatureGate,"getStringFeatureGate")}),["app"]:P,["resolveScript"]:(ra,Qa)=>fN.a.resolveScript(ra,Qa),["initialTabId"]:h};r.$("DynamicBundlesIsEnabled")&&(h=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=
RE.AppChromeOverrideUtilities.isEnabled?RE.AppChromeOverrideUtilities.Dkc+h:r.kb("StaticContentUrl")+h);return new Promise((ra,Qa)=>{b("gc2",v.AFrameworkApplication.Sz("gc2.js",5),"anonymous",5,!1).then(()=>{ra(ca)}).catch(()=>{t.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Qa(null)})})}IJh(b){b=this.Dbb.hasEdits()&&!b;this.N5j(b?this.Dbb.getGraphicData():null,!!this.f_g,this.f_g,b)}}Object(n.a)(yK,"ReactGraphicsEditorDialog",Pf.a,[]);class zK{constructor(b,
h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc,id=!1){this.Y3h=id;this.Kvb=this._context=null;this.Gxo=(Id,ve,$d,be,he)=>{var re,Xf,Mg;const $l=!!he&&Object(uc.a)(U.a,he);try{if(1===$d){const zp=ve.view;return this.Vj.Kga(ve)&&zp.features.ele?32:8}this.B9j=4===(null===he||void 0===he?void 0:he.InputMethod)?!0:!1;qe.App.instance&&qe.App.instance.yJb&&(this.Y3h||$M.a.bib(()=>{this.Y3h=!0}));t.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${$l}`);performance.mark("LaunchStart");this._context=
ve;const Nm=new yK(this.Dbb,this.lWf,$l?he:null,ve,this.Zf);Id=null;if($l&&(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const zp=null===(Mg=null===(Xf=ve.view.mb)||void 0===Xf?void 0:Xf.ib)||void 0===Mg?void 0:Mg.lb;if(null===zp||void 0===zp?0:zp.dI)Id="Draw"}this.Kvb=Nm.Fxo(Id).then(()=>{t.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${$l}`)}).catch(()=>
{this.TTh()});if(!$l){const zp=sB=>{this.Kvb.then(()=>{this.JYi(sB,!1)})};if(v.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return zp(JSON.stringify({elements:[]})),32;let vv=null;vv=ro.PageNavigator.instance.uu(ve.view.ed);const cD=vv.properties.ja(Oc.a.Z3h,"");if(0<cD.length)return zp(cD),32;this.gDe.Meo(ve,U.a.create(),Lb.a.create()).then(sB=>{const ZD=this.Lc.Pc(0,Mb.a.QSc);ZD.Db(vv);vv.setValue(Oc.a.Z3h,sB);ZD.dispose();
zp(sB);return null}).catch(sB=>{t.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",sB.toString(),$l);this.TTh()})}return 32}catch(Nm){return t.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Nm.toString(),$l),8}};this.dpm=(Id,ve,$d,be,he)=>{if(!ve.view.features.ele)return 32;t.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.TVh(he,ve);return 32};
this.cpm=(Id,ve,$d,be,he)=>{var re,Xf,Mg;const $l=ve.view;if(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(re=null===(Mg=null===(Xf=null===$l||void 0===$l?void 0:$l.mb)||void 0===Xf?void 0:Xf.ib)||void 0===Mg?void 0:Mg.lb,null===re||void 0===re||!re.t4a)return 8;return this.vmi(Id,ve,$d,be,he)};this.vmi=(Id,ve,$d)=>{if(1===$d)return ve.view.features.ele?32:8;if(2===$d){Id=ye.ImageReader.sn(ve.ik);if(!Id)return 2;
t.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.TVh(Id,ve);return 32}return 2};this.JYi=(Id,ve=!0)=>{this.Dbb.setGraphicData(Id);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Id=performance.getEntriesByName("EditorLaunch");t.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${ve} Duration: ${Id[Id.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.lWf=(Id,ve,$d,be)=>{var he;this.Dbb.teardown();if(ve&&this._context){var re=this._context.view.mb.qg,Xf=re.node;re.al&&Td.ParagraphReader.Xb(Xf)&&(re=null===(he=this.H7)||void 0===he?void 0:he.GA(Xf),27==(null===re||void 0===re?void 0:re.role)&&t.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",be,be?" Everything deleted: "+(0==(null===Id||void 0===Id?void 0:Id.json.length)):""))}if(be)if(t.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Id)if(be=Id.json,he=Id.width,Xf=Id.height,be.length||ve)if(!be.length&&ve)if(ve=this._context.ik){ve=ve.node;if(ye.ImageReader.r9(ve)){if(!this.Vj.e_n(ve,new xd.GraphIterator,xj.a.instance,lK.DeleteActor.i2b)){t.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Vj.Ajc(ve,$d,this.gb,this.dW)){t.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}t.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else t.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else re=new bN.a(this._context,v.AFrameworkApplication.ta.TQa,!0,this.Vj,this.Ca,ro.PageNavigator.instance),Id=Lb.a.create(),$d=new KJ.a(re,be,this.qK,this.Pm,Id,kl.a.instance,ve,$d,this.Vj,this.ap,he,Xf,this.Ca,this.dW,this.rd,qe.App.instance.yJb,qe.App.instance.hBf),this.gDe.xcg($d,this._context,ve,Id),this.Tra(),this.B9j&&this.TOo();else t.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else t.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else t.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ca=h;this.gDe=r;this.Vj=B;this.qK=P;this.Pm=ca;this.Dbb=new wK;this.Lc=Qa;this.gb=mb;this.dW=Jb;this.ap=Yb;this.rd=Mc;this.Zf=fc;this.H7=Wc}Ub(){var b;let h=!0;this.Ca.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.rd&&this.rd.isFeatureEnabled(51));
h&&!ba.a.ht&&(this.ga.fb(V.a.rxf,zc.a.view,this.Gxo,4),this.ga.fb(Mb.a.Hhf,zc.a.view,this.dpm,4),this.ga.fb(V.a.VVh,zc.a.view,this.cpm,4),(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(V.a.v7b,zc.a.view,this.vmi,4))}TTh(){const b=new Wh.StandardDialog;b.Cd=0;b.wx(vg.a.whf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);ab.StaticActiveAppFrame.za().updateCommandUI()}TVh(b,
h){var r=b.ja(Ng.a.H5,1);const B=b.ja(xe.a.B0,pg.a.finished);r&&B!==pg.a.uploading?b.ja(Oc.a.fJh,!1)?(h=new Wh.StandardDialog,h.Cd=0,h.wx(vg.a.whf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),ab.StaticActiveAppFrame.za().updateCommandUI(),t.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:ye.ImageReader.vQa(b)})):(this.ga.Qb(V.a.rxf,2,b.id),this.Kvb||
(t.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Kvb=new Promise(P=>{P(null)})),r=Lb.a.create(),b=new vK(b,this.JYi,kl.a.instance,this.Kvb,this.ap,this.Ca,this.rd,qe.App.instance.IR(this.ap.ui(b))),this.gDe.xcg(b,h,!0,r)):t.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Tra(){const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
t.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}TOo(){const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):t.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(n.a)(zK,"GraphicsEditorActor",null,[]);var hN=c(522);class AK{constructor(b,h,r){this.EXa="wwaengidc";this.yjd="CreateLinkForHeading";this.f0j="CreateLinkForHeadingAction";this.n2j="\ufffc";this.qXa=
b;this.ga=h;this.gb=r}Ub(){this.ga.qa(V.a.MKc,zc.a.paragraph,this.vcf.bind(this));this.ga.qa(V.a.MKc,zc.a.Fd,this.vcf.bind(this));this.ga.qa(V.a.MKc,zc.a.Tc,this.vcf.bind(this));this.ga.Xc(V.a.MKc,1028)}vcf(b,h,r){b=h.node;if(1===r)return this.$zi(b)?32:8;this.YSn(this.yjd,this.f0j);if(!this.$zi(b))return t.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Oc.a.Wc);if(!r)return t.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
r=new Map,r.set("Source",this.yjd),r=Object.assign(new sb.a,{additionalValues:r}),xa.Health.instance.recordKpiFailure(this.yjd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.IMh(r);return 32}IMh(b){b=String.format('{{"{0}":"{1}"}}',hN.a.heading,b);this.ga.Qb(eb.a.U8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}$zi(b){return!this.gb.Xb(b)||this.gb.Ycc(b)||this.gb.vJb(b)||b.Fr||""===b.characterData||b.characterData===this.n2j||!this.qXa.uSd(b)?
!1:!0}YSn(b,h){const r=new Map;r.set("Source",this.yjd);r.set("Action",h);xa.Health.instance.recordKpiUsage(b,0,this.EXa,r)}}Object(n.a)(AK,"HeadingsActor",null,[]);class BK{Juo(b){return Td.ParagraphReader.wva(this.bai(b))}J9c(b,h,r){if(b=Td.ParagraphReader.sQa(this.bai(b)))h=b.qe(h),Object(uc.a)(606,h)&&(gn.m(b)?h.Xoo(r):h.J9c())}bai(b){return b&&b.al&&b?b.node:null}}Object(n.a)(BK,"IFrameFocusStrategy",null,[607]);class CK{constructor(b){this.RCa=null;this.Xnd=b}LLi(){t.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}FDj(b){if(!b)return t.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return t.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return t.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.RCa=E.a.Fme(b.errorDetails.token,b.errorDetails.lcid);this.Xnd.add(this.RCa,b.errorDetails.lcid);return!0}N$c(b){return b?
b.token?E.a.Fme(b.token,b.lcid)===this.RCa:(t.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(t.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(n.a)(CK,"IgnoreAllProofingErrorStrategy",null,[605]);var iN=c(1403),jN=c(581),DK=c(539);class EK{constructor(b,h){this.filename=b;this.blob=h}}Object(n.a)(EK,"UploadBlobParameters",null,[]);class FK extends km{constructor(b,h,r,B,P,ca,ra,Qa=null){super(b,h,r,null,P,ca,!1);this.K$j="DragAndDrop";
this.HVg="FileName";this.KVg=0;this.klh=null;this.ned=this.v1a=!1;this.RTg=B;this.Qbh=Qa}get $Ij(){return"DragDropInsertImage"}get wP(){return this.K$j}get fileExtension(){return this.HVg}get fileSize(){return this.KVg}get aJj(){return this.klh}rbd(b){const h=new EK(this.RTg.name,this.RTg);b.pxj(h);this.klh=b.Ceb}wwa(b,h){this.Qbh&&this.Qbh();super.wwa(b,h)}Grg(b){const h=!!b&&this.Nka(b.name,null)&&this.Hrg(b,null);b&&(this.HVg=b.name,this.KVg=b.size);h||this.B3d();return h}}Object(n.a)(FK,"DragDropInsertImageUploader",
km,[]);class Ts{constructor(b,h,r,B,P,ca,ra){this.BUc=ca;this.nS=ra;this.J4d=this.K4d=this.h5d=this.i5d=0;this.ga=null;this.nhf=(Qa,mb,Jb)=>{if(qe.App.GLd)return 8;Qa=mb.node;return 1===Jb?Qa?32:2:2===Jb?(Jb=ye.ImageReader.sn(mb),mb=ye.ImageReader.FRc(Jb,mb.node.Zi().xd,v.AFrameworkApplication.K,v.AFrameworkApplication.ta.TQa),Wt(mb),32):2};this.dFm=(Qa,mb,Jb)=>{var Yb;const fc=this.Vj.Kga(mb);if(2===Jb&&fc){if(Mb.a.CR===Qa||Mb.a.$Fd===Qa)v.AFrameworkApplication.dqa?v.AFrameworkApplication.cig():
((null===(Yb=v.AFrameworkApplication.K)||void 0===Yb?0:Yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&gv.a.instance.p7a("PictureLocal"),this.ael(mb));return 32}return 1!==Jb||Mb.a.CR!==Qa&&Mb.a.$Fd!==Qa?2:fc?32:2};this.MIb=(Qa,mb,Jb,Yb,fc)=>this.Vj.Kga(mb)?1===Jb?32:this.Vj.PCf(mb,fc)?32:2:2;this.ooo=()=>{if(this.hb&&this.hb.ib&&this.hb.ib.lb){const Qa=this.hb.ib.lb.Pa;Qa&&this.hb.Ac(Fe.SelectionFactory.ne(Qa.node,Qa.cpBegin))}};this.Jtl=(Qa,mb,Jb,Yb,fc)=>{t.ULS.sendTraceTag(42530333,
307,50,"Drag and drop local content");if((Qa=fc.DataTransfer)&&Qa.files&&0<Qa.files.length){t.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Qa.files.length));for(Jb=0;Jb<Qa.files.length;Jb++)Yb=Qa.files[Jb],0<=E.a.eh(Yb.type).indexOf("image")&&this.qEm(Yb,mb)&&(Yb=this.hb.ib.lb.Pa,this.hb.Ac(Fe.SelectionFactory.ne(Yb.node,Yb.cpBegin+1)));this.tKa();return 32}t.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.YDn=(Qa,mb,Jb,Yb,fc)=>{if(2===
Jb)return v.AFrameworkApplication.va.Mf(mb.ik,Qa,Jb,!0,Yb,fc);if(!mb.view.ue)return 8;Qa=mb.view;if(!Qa.mb)return 8;Qa=Ts.ah.uO(Qa.mb.qg);return 1===Qa.length&&this.tO(Qa[0])?(this.G7m(),this.$Yc||Ts.k1f(!0),32):8};this.Snm=(Qa,mb,Jb)=>{if(!this.tO(mb))return 8;const Yb=ye.ImageReader.sn(mb),fc=ye.ImageReader.oF(Yb),Mc=ye.ImageReader.KG(Yb);Qa=Qa===Mb.a.WVd;t.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Qa});if(1===Jb)return this.Hi.P4||ye.ImageReader.J4a(Yb)?2:Qa&&fc<this.K4d&&
Mc<this.J4d||!Qa&&fc>this.i5d&&Mc>this.h5d?32:2;Jb=Qa?1.1:.9;this.setSize(Yb,mb,fc*Jb,Mc*Jb,!0);return 32};this.Uic=(Qa,mb,Jb,Yb,fc)=>{if(!this.fna(mb))return 8;Qa=ye.ImageReader.sn(mb);mb=ye.ImageReader.IFa(Qa);Jb=ye.ImageReader.HFa(Qa);if(0>=mb||0>=Jb)return 2;Qa=ye.ImageReader.oF(Qa)/mb*100;fc.setValue(Zc.a.IUc,Qa);return 32};this.ubc=(Qa,mb,Jb,Yb,fc)=>{if(!this.fna(mb))return 8;Qa=ye.ImageReader.sn(mb);if(1===Jb)return this.Hi.P4||ye.ImageReader.J4a(Qa)?2:32;t.ULS.sendTraceTag(20459937,322,50,
"Change image scale.");Jb=fc.ja(Zc.a.IUc,-1)/100;Yb=fc.ja(Zc.a.Oqi,!1);const Mc=fc.ja(Zc.a.bBf,!0);fc=fc.ja(Zc.a.cBf,!0);if(0>=Jb)return Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.XIb}),2;const Wc=ye.ImageReader.IFa(Qa),id=ye.ImageReader.HFa(Qa),Id=ye.ImageReader.oF(Qa),ve=ye.ImageReader.KG(Qa);if(0>=Wc||0>=id)return Ts.Ic.Yb(te.a.f2,{["Reason"]:fe.a.XIb}),2;Yb?(Yb=Mc?Jb*Id:Id,Jb=fc?Jb*ve:ve):(Yb=Mc?Jb*Wc:Id,Jb=fc?Jb*id:ve);this.setSize(Qa,mb,Yb,Jb);qe.App.zd.Uo&&qe.App.zd.fq.iG(mb.node);this.tKa();return 32};
this.sOb=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);Qa=ye.ImageReader.KG(Qa);if(0>=Qa)return 2;fc.setValue(Zc.a.dGa,Qa);return 32};this.dGa=(Qa,mb,Jb,Yb,fc)=>{if(!this.fna(mb))return 8;Qa=ye.ImageReader.sn(mb);if(1===Jb)return this.Hi.P4||ye.ImageReader.J4a(Qa)?2:32;t.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Jb=fc.ja(Zc.a.dGa,0);fc=ye.ImageReader.I4a(Qa);if(0>=Jb)return Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.XIb}),2;Yb=ye.ImageReader.IFa(Qa);const Mc=
ye.ImageReader.HFa(Qa),Wc=ye.ImageReader.oF(Qa);var id=ye.ImageReader.KG(Qa);id=Wc/id;if(0>=Yb||0>=Mc)if(Ts.Ic.Yb(te.a.f2,{["Reason"]:fe.a.XIb}),this.orj(Qa))return 2;this.setSize(Qa,mb,fc?Jb*id:Wc,Jb);qe.App.zd.Uo&&qe.App.zd.fq.iG(mb.node);ab.StaticActiveAppFrame.za().updateCommandUI();return 32};this.tOb=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);Qa=ye.ImageReader.oF(Qa);if(0>=Qa)return 2;fc.setValue(Zc.a.eGa,Qa);return 32};this.eGa=(Qa,mb,Jb,Yb,fc)=>{if(!this.fna(mb))return 8;
Qa=ye.ImageReader.sn(mb);if(1===Jb)return this.Hi.P4||ye.ImageReader.J4a(Qa)?2:32;t.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Jb=fc.ja(Zc.a.eGa,0);fc=ye.ImageReader.I4a(Qa);if(0>=Jb)return Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.XIb}),2;Yb=ye.ImageReader.IFa(Qa);const Mc=ye.ImageReader.HFa(Qa);var Wc=ye.ImageReader.oF(Qa);const id=ye.ImageReader.KG(Qa);Wc=id/Wc;if(0>=Yb||0>=Mc)if(Ts.Ic.Yb(te.a.f2,{["Reason"]:fe.a.XIb}),this.orj(Qa))return 2;this.setSize(Qa,mb,Jb,fc?Jb*Wc:id);qe.App.zd.Uo&&
qe.App.zd.fq.iG(mb.node);ab.StaticActiveAppFrame.za().updateCommandUI();return 32};this.vOb=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);Qa=ye.ImageReader.I4a(Qa);fc.setValue(Zc.a.wY,Qa);return 32};this.wY=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);if(1===Jb&&this.Hi.P4)return 2;qe.App.zd.Uo&&qe.App.zd.fq.iG(mb.node);fc&&(mb=fc.ja(Zc.a.wY,!0),t.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Vj.vmj(Qa,mb),ab.StaticActiveAppFrame.za().updateCommandUI());
return 32};this.a7a=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);Qa=ye.ImageReader.eY(Qa);fc.setValue(Zc.a.wkb,Qa);return 32};this.wkb=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;if(1===Jb)return this.Hi.P4?2:32;if(qe.App.zd.Uo&&(Qa=mb.node.ja(Ng.a.RJ,Ti.a.Qt),Qa!==Ti.a.Qt&&(Qa=qe.App.zd.fq.ujb(Qa),DK.CoauthLockEditor.getInstance().p8a(Qa))))return Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),2;Qa=ye.ImageReader.sn(mb);fc=fc.ja(Zc.a.wkb,null);this.Vj.vko(Qa,mb,fc);t.ULS.sendTraceTag(21297027,
322,50,"Change image alt text.");this.Qd.Zs(13);return 32};this.$6a=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;Qa=ye.ImageReader.sn(mb);Qa=ye.ImageReader.uQa(Qa);fc.setValue(Zc.a.vY,Qa);return 32};this.vY=(Qa,mb,Jb,Yb,fc)=>{if(!this.tO(mb))return 8;if(1===Jb)return this.Hi.P4?2:32;if(qe.App.zd.Uo&&(Qa=mb.node.ja(Ng.a.RJ,Ti.a.Qt),Qa!==Ti.a.Qt&&(Qa=qe.App.zd.fq.ujb(Qa),DK.CoauthLockEditor.getInstance().p8a(Qa))))return Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),2;Qa=ye.ImageReader.sn(mb);fc=fc.ja(Zc.a.vY,
null);this.Vj.uko(Qa,mb,fc);t.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Qd.Zs(13);return 32};this.P7a=(Qa,mb,Jb)=>{var Yb,fc;if(1===Jb)return 32;if(!mb.view.ue)return t.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Qa),8;mb=mb.view;Jb=null===(fc=null===(Yb=mb.mb)||void 0===Yb?void 0:Yb.ib)||void 0===fc?void 0:fc.J(0);if(!Jb)return t.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Qa),8;fc=Jb.Pa;Yb=this.nS.Yf("UserAction",
Qa.toString());let Mc;Qa==Mb.a.Xbg?Mc=this.BUc.P7a(fc,2):Qa==Mb.a.$bg?(Mc=this.BUc.P7a(fc,0),5==Mc&&(Mc=this.BUc.P7a(fc,2))):Qa==Mb.a.acg&&(Mc=this.BUc.P7a(fc,1),5==Mc&&(Mc=this.BUc.P7a(fc,3)));switch(Mc){case 4:fc=32;mb.D1();break;case 5:fc=2;break;default:fc=8}Yb.stop();t.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",Mc,Yb.pi,Qa);return fc};this.Vj=b;this.en=h;this.Qd=r;this.vg=B;this.hb=P;this.rg=ci.a.getInstance(Rm.a)}get Hi(){return Qh.PageReader.instance}get lca(){return this.en.instance}get oc(){return this.ga}FCm(){this.i5d=
Xg.a.Ql(1,0);this.h5d=Xg.a.Ql(1,1);this.K4d=Xg.a.Ql(1920,0);this.J4d=Xg.a.Ql(1280,1)}Ub(b){this.ga=b;const h=this.YDn,r=this.dFm,B=this.MIb,P=this.Snm;b.fb(Mb.a.CR,zc.a.view,r,1284);b.qa(Mb.a.MIb,zc.a.Tc,B);b.qa(Mb.a.Xbg,zc.a.view,this.P7a);b.qa(Mb.a.$bg,zc.a.view,this.P7a);b.qa(Mb.a.acg,zc.a.view,this.P7a);b.qa(Mb.a.MIb,zc.a.image,B);b.Xc(Mb.a.MIb,1284);b.fb(Mb.a.$Fd,zc.a.view,r,1284);b.fb(Mb.a.F7e,zc.a.view,h,1028);this.ur(b,Mb.a.WVd,P);this.ur(b,Mb.a.pig,P);this.ur(b,Mb.a.Uic,this.Uic);this.ur(b,
Mb.a.sOb,this.sOb);this.ur(b,Mb.a.tOb,this.tOb);this.ur(b,Mb.a.a7a,this.a7a);this.ur(b,Mb.a.$6a,this.$6a);this.ur(b,Mb.a.ubc,this.ubc);this.ur(b,Mb.a.khe,this.dGa);this.ur(b,Mb.a.lhe,this.eGa);this.ur(b,Mb.a.N9c,this.wkb);this.ur(b,Mb.a.qQb,this.vY);this.ur(b,Mb.a.vOb,this.vOb);this.ur(b,Mb.a.wY,this.wY);this.ur(b,Mb.a.nhf,this.nhf);b.fb(Mb.a.DVh,zc.a.view,this.Jtl,4);b.Xc(Mb.a.WVd,4);b.Xc(Mb.a.pig,4);b.Xc(Mb.a.Uic,69);b.Xc(Mb.a.sOb,69);b.Xc(Mb.a.tOb,69);b.Xc(Mb.a.vOb,69);b.Xc(Mb.a.a7a,69);b.Xc(Mb.a.$6a,
69);b.Xc(Mb.a.wY,4);b.Xc(Mb.a.ubc,4);b.Xc(Mb.a.khe,4);b.Xc(Mb.a.lhe,4);b.Xc(Mb.a.N9c,4);b.Xc(Mb.a.qQb,4);this.FCm();this.$Yc&&lh.a.instance.Xw(this.LSk)}ur(b,h,r){b.qa(h,zc.a.image,r);b.qa(h,zc.a.pFb,r);b.qa(h,zc.a.Fd,r);b.qa(h,zc.a.W7,r)}ael(b){new km(b,Rg.a.instance,v.AFrameworkApplication.K,null,this.vg,this.ga)}i3o(b){return this.Hi.P4?(Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.JBl}),!1):Ts.Xf.a0(b)?(Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.cF}),
!1):this.lca&&this.lca.TU(b)?(Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.Y1a}),!1):!0}bPm(b){const h=ye.ImageReader.sn(b);return h&&5===ye.ImageReader.ui(h)&&this.Txi(b,h)}Txi(b,h){(h=!ye.ImageReader.h$b(h)&&!ye.ImageReader.W_d(h))||Ts.Ic.Yb(te.a.wn,{["Reason"]:fe.a.mJh});return h&&this.i3o(b)}qEm(b,h){var r,B;h=new FK(h,Rg.a.instance,v.AFrameworkApplication.K,b,this.vg,this.ga,this.hb,this.ooo);if(h.Grg(b))(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiUsage({kpiName:Rm.c.fGa,
kpiType:0});else return(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new sb.a,{extendedProperties:b}),this.rg.logKpiFailure({kpiName:Rm.c.fGa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Rm.c.sbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):xa.Health.instance.recordQosError("PictureDragDropInvalid",
["ImageInsertFailed"],!0,!0,!1,!1,null),t.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new sn.a(document.body,Object(z.a)(h,h.t6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Nea,"uploadResponseReceived"),v.AFrameworkApplication.K,!1,void 0,Nl.a(v.AFrameworkApplication.K));return!0}tO(b){return this.bPm(b)}fna(b){const h=ye.ImageReader.sn(b);if(!h)return!1;const r=Ya.a.instance.Oa("Box4.IFeatureHelper"),B=ye.ImageReader.ui(h);return 5===B||10===B||48===B||11===B||r&&r.isFeatureEnabled(51)&&
4===B?this.Txi(b,h):!1}get $Yc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}LSk(){Ts.k1f(!0)}setSize(b,h,r,B,P=!1){qe.App.zd.Uo&&qe.App.zd.fq.iG(h.node);const ca=ye.ImageReader.I4a(b);let ra=1;r>this.K4d?ra=this.K4d/r:r<this.i5d&&(ra=this.i5d/r);let Qa=1;B>this.J4d?Qa=this.J4d/B:B<this.h5d&&(Qa=this.h5d/B);if(ca||P)ra=Math.min(ra,Qa),Qa=Math.min(ra,Qa);1!==ra&&(r*=ra);1!==Qa&&(B*=Qa);this.Pgf(b,
h,r,B)}Pgf(b,h,r,B){this.Vj.Aoo(b,h,r,B)}G7m(){t.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}tKa(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}orj(b){const h=ye.ImageReader.IFa(b);b=ye.ImageReader.HFa(b);return 0>=h||0>=b}static get ah(){return Im.ContextSetEditor.instance}static get Xf(){return xj.a.instance}static get Ic(){return Ih.a.instance}}
Ts.k1f=null;Object(n.a)(Ts,"ImageActor",null,[]);var GK=c(1115),wv=c(398),Gx=c(737);class VF{constructor(b,h,r,B,P){this.imagePropertySet=b;this.graphNode=h;this.WMc=r;this.ynm=B;this.XPa=P;if(this.qRa=qe.App.instance&&qe.App.instance.qRa())this.CCe=new GK.a(this.zr(),VF.$pc);this.rg=ci.a.getInstance(wv.a)}dha(b){this.NY("crop");if(null===this.imagePropertySet||void 0===this.WMc||void 0===this.XPa)return this.yF("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;
const r=this.XPa.Mlm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.RDd(r,h))return this.M_c("crop","Failed to apply and update"),this.yF("crop","Failed to apply and update"),!1}catch(B){return this.M_c("crop",B),this.yF("crop",B.stack?B.stack:B.message?B.message:B.toString()),!1}this.G3d("crop");return!0}rotate(b){this.NY("rotate");if(null===this.imagePropertySet||void 0===this.WMc||void 0===this.XPa)return this.yF("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");
if(void 0===h)return!1;b-=this.imagePropertySet.W6a.Mgi();if(0!==b){const r=this.XPa.Qlm();r.rotation=b;try{if(!this.RDd(r,h))return this.yF("rotate","Failed to apply and update"),!1}catch(B){return this.M_c("rotate",B),this.yF("rotate",B.stack?B.stack:B.message?B.message:B.toString()),!1}}this.G3d("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.NY(r);if(null===this.imagePropertySet||void 0===this.WMc||void 0===this.XPa)return this.yF(r,"Argument(s) invalid"),!1;const B=this.getGraphicData(r);
if(void 0===B)return!1;const P=this.XPa.Nlm();P.flip=this.XPa.nZl();P.flip.x=b;P.flip.y=h;try{if(!this.RDd(P,B))return this.yF(r,"Failed to apply and update"),!1}catch(ca){return this.M_c(r,ca),this.yF(r,ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.G3d(r);return!0}resize(b,h){this.NY("resize");if(null===this.imagePropertySet||void 0===this.WMc||void 0===this.XPa)return this.yF("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let B=0;
var P=0;({width:B,height:P}=ye.ImageReader.qjb(this.imagePropertySet));b/=B;h/=P;P=this.XPa.Rlm();P.scale=this.XPa.dfm();P.scale.width=b;P.scale.height=h;try{if(!this.RDd(P,r))return this.yF("resize","Failed to apply and update"),!1}catch(ca){return this.M_c("resize",ca),this.yF("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.G3d("resize");return!0}G3d(b){Gx.a.bJa&&(b=new Map([["Renderer",wv.b.lQd],["Operation",b],["Type",ye.ImageReader.ui(this.imagePropertySet).toString()]]),
this.rg.logKpiSuccess({kpiName:wv.d.vMd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b},hasImpliedUsage:void 0},blockFutureEmissionDurationInMs:3E5}))}M_c(b,h){Gx.a.bJa&&(b=Object.assign(new sb.a,{extendedProperties:new Map([["Renderer",wv.b.lQd],["Exception",h.message],["Operation",b]])}),h={name:wv.d.KVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.rg.logKpiFailure({kpiName:wv.d.vMd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h}))}static get $pc(){return Ya.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.qRa){const h=this.CCe.cwf();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.yF(b,h.stack?h.stack:h.message?h.message:h.toString())}}RDd(b,h){this.WMc.apply(b,h);b=this.imagePropertySet.SFb(h);
if(void 0===b)return!1;this.ZUo(b);return!0}ZUo(b){const h=new sg.GraphTransaction(15);h.Db(this.graphNode);this.imagePropertySet.setValue(Nd.a.lP,b.lP);this.ynm.hbo(b.IZh,b.$xa,this.imagePropertySet);h.dispose()}zr(){return ro.PageNavigator.instance.uu(this.graphNode)}NY(b){const h=this.yug;h.edit=b;t.ULS.sendTraceTag(509657553,322,50,"{0}",h)}yF(b,h){const r=this.yug;r.message=h;r.edit=b;t.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get yug(){return{["id"]:ye.ImageReader.vQa(this.imagePropertySet),
["type"]:ye.ImageReader.ui(this.imagePropertySet)}}}Object(n.a)(VF,"EditWithGC2Command",null,[]);class QG{hbo(b,h,r){this.i3m(b,h);this.kbo(r)}i3m(b,h){this.UH=Array(4);this.UH[Ff.a.left]=b.Whf;this.UH[Ff.a.top]=b.Yhf;this.UH[Ff.a.right]=b.Xhf;this.UH[Ff.a.bottom]=b.Vhf;this.HPa=b.HPa;this.IPa=b.IPa;(this.$xa=h)&&this.F7k()}kbo(b){b.setValue(Nd.a.bxa,Math.round(this.HPa).toString());b.setValue(Nd.a.cxa,Math.round(this.IPa).toString());const h=Array(4);this.UH.forEach((r,B)=>{h[B]=Math.round(r).toString()});
b.setValue(Nd.a.JQa,h);b.setValue(Nd.a.s4a,this.$xa)}F7k(){this.WGo();const b=this.HPa/2,h=this.IPa/2;this.HPa%2&&0===this.IPa%2?(--this.UH[Ff.a.left],++this.UH[Ff.a.top]):this.IPa%2&&0===this.HPa%2&&(++this.UH[Ff.a.left],--this.UH[Ff.a.top]);this.UH[Ff.a.left]+=b-h;this.UH[Ff.a.right]-=b-h;this.UH[Ff.a.top]+=h-b;this.UH[Ff.a.bottom]-=h-b}WGo(){const b=this.HPa;this.HPa=this.IPa;this.IPa=b}}Object(n.a)(QG,"GraphicsExtents",null,[]);var GH=c(1180),HH=c(1181),RG=c(699);class SG{constructor(){this.g5o=
{["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.uil={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8}}eMo(b,h){if(b){var r=this.UTd(b);h=h.W6a.bfi();b.On=void 0===r?!1:r===h}}dMo(b,h){if(b){var r=
this.E$l(b);h=h.W6a.D$l();b.On=void 0===r||void 0===h?!1:r===h}}static aHb(b,h){return b.W6a.aHb(h)}UTd(b){b=this.g5o[b.SourceControlId];if(void 0!==b)return b=Xg.a.cZ(b,0,!1),Xg.a.q1f(b)}E$l(b){return this.uil[b.SourceControlId]}}Object(n.a)(SG,"Gc2PictureBorderHelper",null,[]);var HK=c(524),kN=c(523),lN=c(1493);class ar extends Ts{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){super(b,h,B,ca,ra,Qa,mb);this.C6g=!1;this.TBa=this.BCe=this.aba=null;this.Hw=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;if(1===
Mc)return this.Hi.P4?2:32;Yb=parseInt(id);t.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Yb);this.Ewd.dOn(fc,ye.ImageReader.sn(fc),Yb);this.H_c(fc);this.tKa();return 32};this.Nee=(Yb,fc,Mc)=>{if(!this.tO(fc))return 8;t.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Yb=ye.ImageReader.sn(fc);if(1===Mc)return this.Hi.P4?2:32;Mc=ye.ImageReader.Q2a(Yb);Mc===po.a.rendered?(Mc=new sg.GraphTransaction(15),Mc.Db(fc.node),ye.ImageReader.tcc()?Yb.setValue(Oc.a.BNb,""):this.CK.S_n(Yb),Mc.dispose(),
this.mCc.create(Yb,fc).Hw(Ce.a.Nej),this.H_c(fc)):Mc===po.a.alwaysRendered&&this.mCc.create(Yb,fc).Hw(Ce.a.Nej);return 32};this.Dpm=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;Yb=ye.ImageReader.sn(fc);if(1===Mc)return this.Hi.P4||ye.ImageReader.edc(Yb)?2:32;id&&(this.CK.rcd(Yb,fc),t.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),ab.StaticActiveAppFrame.za().updateCommandUI());this.tKa();return 32};this.Epm=(Yb,fc,Mc,Wc,id)=>{var Id;if(!this.tO(fc))return 8;if(1===Mc)return this.Hi.P4?
2:32;Yb=ye.ImageReader.sn(fc);if(id){Mc=ye.ImageReader.AZd(ye.ImageReader.sn(fc));t.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Mc);Wc=id.ja(Zc.a.Bkb,0);const $d=id.ja(Zc.a.ykb,0),be=id.ja(Zc.a.zkb,0);id=id.ja(Zc.a.Akb,0);var ve=ye.ImageReader.yca(Yb);const he=ve.bottom,re=ve.left,Xf=ve.right;if(Wc===ve.top&&$d===he&&be===re&&id===Xf)return t.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(this.NFf(Yb)&&(ve=null===
(Id=x())||void 0===Id?void 0:Id.oDb(),(new VF(Yb,fc.node,ve,new QG,y())).dha({top:.001*Wc,bottom:.001*$d,left:.001*be,right:.001*id})))return 32;Mc?(new GH.a(Yb,new HH.a)).mio(Wc,$d,be,id,this.Wnn,fc):this.Ewd.TNn(fc,ye.ImageReader.sn(fc),Wc,$d,be,id);this.H_c(fc);ab.StaticActiveAppFrame.za().updateCommandUI()}return 32};this.eWd=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;Wc=ye.ImageReader.sn(fc);if(1===Mc)return this.Hi.P4||ye.ImageReader.edc(Wc)?2:32;if(id){t.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");
this.CK.Ixa()||this.CK.rcd(Wc,fc);switch(Yb){case V.a.yUc:Yb=id.ja(Zc.a.Bkb,-1);Mc=0;break;case V.a.rUc:Yb=id.ja(Zc.a.ykb,-1);Mc=1;break;case V.a.sUc:Yb=id.ja(Zc.a.zkb,-1);Mc=2;break;case V.a.tUc:Yb=id.ja(Zc.a.Akb,-1);Mc=3;break;default:return 8}this.CK.LXo(Yb,Mc);this.H_c(fc);ab.StaticActiveAppFrame.za().updateCommandUI()}return 32};this.Zob=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;ye.ImageReader.sn(fc);id&&(Yb=this.CK.Ixa(),id.setValue(Zc.a.Ixa,Yb));return 32};this.Tic=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;
Yb=ye.ImageReader.sn(fc);if(id){if(this.CK.Ixa())({top:Id,bottom:Mc,left:Yb,right:fc}=this.CK.UUl());else{Wc=Xg.a.nf(ye.ImageReader.oF(Yb),0);var Id=Xg.a.nf(ye.ImageReader.KG(Yb),1);fc=ye.ImageReader.yca(Yb);const ve=Math.max(fc.top,0);Mc=Math.max(fc.bottom,0);Yb=Math.max(fc.left,0);fc=Math.max(fc.right,0);Wc=1E5*Wc/(1E5-(Yb+fc));const $d=1E5*Id/(1E5-(ve+Mc));Id=Math.floor(ve*$d/1E5);Mc=Math.floor(Mc*$d/1E5);Yb=Math.floor(Yb*Wc/1E5);fc=Math.floor(fc*Wc/1E5)}id.setValue(Zc.a.Bkb,Id);id.setValue(Zc.a.ykb,
Mc);id.setValue(Zc.a.zkb,Yb);id.setValue(Zc.a.Akb,fc)}return 32};this.Bac=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;if(1===Mc){if(this.Hi.P4)return 2;this.l9m();return 32}Yb=ye.ImageReader.sn(fc);this.CK.Ixa()&&this.CK.rcd(Yb,fc);Yb=id.ja(Zc.a.lJa,"");id=id.ja(Zc.a.X9a,0);t.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:id,["SourceControlId"]:Yb});switch(id){case 1:this.CK.tpo(fc);break;case 8:this.CK.fie(fc,tC.a.square,1);break;case 9:this.CK.fie(fc,tC.a.square,3);break;case 3:this.CK.fie(fc,
tC.a.none,void 0,!0);break;case 4:this.CK.fie(fc,tC.a.none,void 0,!1)}this.tKa();ab.StaticActiveAppFrame.za().updateCommandUI();return 32};this.gjc=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;Yb=ye.ImageReader.sn(fc);fc=ye.ImageReader.S4(fc);Mc=ye.ImageReader.t9(Yb);Wc=ye.ImageReader.kac(Yb);Yb=ye.ImageReader.Ox(Yb);return this.RNn(fc,Mc,Wc,Yb,id)?32:8};this.Gpm=(Yb,fc,Mc,Wc,id)=>{var Id;if(!this.fna(fc))return 8;Wc=ye.ImageReader.sn(fc);if(1===Mc)return gc.SessionStatusManager.instance.Yj?8:this.Hi.P4||
ye.ImageReader.fdc(Wc)?2:32;this.CK.Ixa()&&this.CK.rcd(Wc,fc);if(id){const $d=id.ja(Zc.a.FUc,0),be=ye.ImageReader.AZd(Wc);t.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",$d,be);Mc=ye.ImageReader.p0(Wc);var ve=ye.ImageReader.Loa(Wc);let he=ve.xib;ve=ve.hFa;switch($d){case 0:Mc=id.ja(Zc.a.KU,0);break;case 2:Mc-=90;Mc=df.c(Mc);break;case 1:Mc+=90;Mc=df.c(Mc);break;case 4:he=!he;break;case 3:ve=!ve;break;case 5:Mc+=id.ja(Zc.a.KU,0),Mc=df.c(Mc)}if(this.NFf(Wc))if(id=null===
(Id=x())||void 0===Id?void 0:Id.oDb(),Id=new VF(Wc,fc.node,id,new QG,y()),4===$d){if(Id.flip(!0,!1))return 32}else if(3===$d){if(Id.flip(!1,!0))return 32}else if(Id.rotate(Mc))return 32;be?(new GH.a(Wc,new HH.a)).Ono(Mc,he,ve,this.mun,fc):$d?this.mCc.create(Wc,fc).Vmo(Mc,he,ve):(Id=Lb.a.create(),id=new sg.GraphTransaction(15,Mb.a.m9),id.Db(fc.node),this.CK.Eko(Wc,Mc),this.Ewd.$Nn(fc,ye.ImageReader.sn(fc),Mc,Id),id.mHa(Id,1),id.Uj=Yb,id.dispose());this.tKa();this.H_c(fc);ab.StaticActiveAppFrame.za().updateCommandUI()}return 32};
this.uOb=(Yb,fc,Mc,Wc,id)=>{if(!this.tO(fc))return 8;Yb=ye.ImageReader.sn(fc);Yb=ye.ImageReader.p0(Yb);if(0>Yb)return 2;id.setValue(Zc.a.KU,Yb);return 32};this.mun=(Yb,fc,Mc,Wc)=>{if(Yb){const id=new sg.GraphTransaction(15,Mb.a.m9);id.Db(Wc.node);fc.setValue(Zc.a.nCb,JSON.stringify(Mc));fc.setValue(Zc.a.ft,Yb);this.CK.ohe(fc,Mc.rotationAngle,Mc.cbc,Mc.zpc);this.HFb(fc);id.dispose()}};this.Wtn=(Yb,fc,Mc,Wc)=>{if(Yb){const id=new sg.GraphTransaction(15);id.Db(Wc.node);fc.setValue(Zc.a.nCb,JSON.stringify(Mc));
fc.setValue(Zc.a.ft,Yb);this.CK.Vge(fc,Mc.Tne,Mc.xdd);this.HFb(fc);id.dispose()}};this.Wnn=(Yb,fc,Mc,Wc)=>{if(Yb){const id=new sg.GraphTransaction(15);id.Db(Wc.node);fc.setValue(Zc.a.nCb,JSON.stringify(Mc));fc.setValue(Zc.a.ft,Yb);this.CK.yko(fc,Math.round(Mc.Mva*RG.a.Wgb),Math.round(Mc.Jva*RG.a.Wgb),Math.round(Mc.Kva*RG.a.Wgb),Math.round(Mc.Lva*RG.a.Wgb));this.HFb(fc);id.dispose()}};this.s4c=(Yb,fc,Mc,Wc,id)=>{var Id,ve;if(!this.fna(fc))return 8;if(1===Mc)return 32;Yb=fc.contextId===zc.a.view?Qh.PageReader.instance.ETd(fc):
ro.PageNavigator.instance.uu(fc.node);if(!Yb)return 8;Mc=ye.ImageReader.sn(fc);(null===(Id=qe.App.instance)||void 0===Id?0:Id.IR(ye.ImageReader.ui(Mc)))?(null===(ve=qe.App.instance)||void 0===ve?0:ve.qRa())?(fc=new GK.a(Yb,this.l1k),fc=SG.aHb(Mc,fc.cwf())):fc=SG.aHb(Mc):fc=this.Po.aHb(Ul.a.xU(fc),Mc);ar.H2i.$Pb=fc;this.hYc&&this.u1.Roe(fc);fc=ar.H2i.pPc(Yb,qe.App.FCb);if(!fc)return 8;id.MenuItems=fc;return 32};this.L$=(Yb,fc,Mc,Wc,id)=>{if(!this.fna(fc))return 8;if((Wc=ye.ImageReader.sn(fc))&&ye.ImageReader.Qy(Wc))return 2;
if(1===Mc)return 32;if(2!==Mc)return 2;if(!id)return t.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Mc=new sg.GraphTransaction(15);Mc.Db(fc.node);const Id=ar.W8a.pva(fc.node,id);this.Po.L$(Wc,id,fc,Id);this.HFb(Wc);Mc.dispose();Yb==Mb.a.W9c&&this.u1.F_a(id);this.mgd();this.tKa();return 32};this.jja=(Yb,fc,Mc)=>{if(!this.fna(fc))return 8;if(1===Mc)return 32;ab.StaticActiveAppFrame.za().dismissFloatie();ar.aab=new Vt.a("PictureBorder",Mb.a.W9c);ar.aab.bmc(0);return 32};
this.dka=(Yb,fc,Mc,Wc,id)=>{if(!this.fna(fc))return 8;if(1===Mc)return 32;if((Yb=ye.ImageReader.sn(fc))&&ye.ImageReader.Qy(Yb))return 2;if(!id)return t.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Mc=new sg.GraphTransaction(15);Mc.Db(fc.node);this.Po.dka(Yb,id,fc);this.HFb(Yb);Mc.dispose();this.mgd();this.tKa();return 32};this.i8a=(Yb,fc,Mc,Wc,id)=>{if(!this.fna(fc))return 8;if(1===Mc)return 32;if((Yb=ye.ImageReader.sn(fc))&&ye.ImageReader.Qy(Yb))return 2;if(!id)return t.ULS.sendTraceTag(571287760,
322,10,"SetPictureBorderStyle: actionData null"),8;Mc=new sg.GraphTransaction(15);Mc.Db(fc.node);this.Po.i8a(Yb,id,fc);this.HFb(Yb);Mc.dispose();this.mgd();this.tKa();return 32};this.Ude=(Yb,fc,Mc)=>{if(!this.fna(fc))return 8;if(1===Mc)return 32;Yb=ye.ImageReader.sn(fc);Mc=new sg.GraphTransaction(15);Mc.Db(fc.node);ye.ImageReader.Nac(Yb)&&(this.Po.Ude(Yb),this.HFb(Yb));Mc.dispose();this.mgd();this.tKa();return 32};this.CK=b;this.mCc=r;this.Ewd=P;ar.Mh=Jb;Ts.k1f=ar.ZDn}get u1(){return null!=this.FGg?
this.FGg:this.FGg=Ya.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get Po(){this.aba||(this.aba=new HK.a);return this.aba}get X3h(){this.BCe||(this.BCe=new SG);return this.BCe}Ub(b){super.Ub(b);this.ur(b,Mb.a.Hw,this.Hw);b.Xc(Mb.a.Hw,4);this.ur(b,Mb.a.Nee,this.Nee);this.ur(b,V.a.tqe,this.Bac);b.Xc(V.a.tqe,4);this.ur(b,V.a.uqe,this.Bac);this.ur(b,V.a.vqe,this.Bac);this.ur(b,V.a.wqe,this.Bac);this.ur(b,V.a.xqe,this.Bac);this.ur(b,V.a.yqe,this.Bac);this.ur(b,V.a.gjc,this.gjc);b.Xc(V.a.gjc,101);
this.ur(b,V.a.imageCrop,this.Dpm);b.Xc(V.a.imageCrop,4);this.ur(b,V.a.Zob,this.Zob);b.Xc(V.a.Zob,101);this.ur(b,V.a.Aqi,this.Epm);this.ur(b,V.a.yUc,this.eWd);this.ur(b,V.a.rUc,this.eWd);this.ur(b,V.a.sUc,this.eWd);this.ur(b,V.a.tUc,this.eWd);this.ur(b,V.a.s5c,this.Tic);b.Xc(V.a.s5c,101);this.ur(b,V.a.Gbe,this.Tic);b.Xc(V.a.Gbe,101);this.ur(b,V.a.Hbe,this.Tic);b.Xc(V.a.Hbe,101);this.ur(b,V.a.Ibe,this.Tic);b.Xc(V.a.Ibe,101);this.ur(b,Mb.a.m9,this.Gpm);b.Xc(Mb.a.m9,4);this.ur(b,Mb.a.uOb,this.uOb);b.Xc(Mb.a.uOb,
101);this.ur(b,Mb.a.s4c,this.s4c);b.Xc(Mb.a.s4c,4);this.ur(b,Mb.a.L$,this.L$);b.Xc(Mb.a.L$,4);this.ur(b,Mb.a.W9c,this.L$);b.Xc(Mb.a.W9c,4);this.ur(b,Mb.a.VZf,this.jja);b.Xc(Mb.a.VZf,4);this.ur(b,Mb.a.aza,this.aza.bind(this));b.Xc(Mb.a.aza,4);this.ur(b,Mb.a.dka,this.dka);b.Xc(Mb.a.dka,4);this.ur(b,Mb.a.wOb,this.wOb.bind(this));b.Xc(Mb.a.wOb,4);this.ur(b,Mb.a.i8a,this.i8a);b.Xc(Mb.a.i8a,4);this.ur(b,Mb.a.dUf,this.Ude);b.Xc(Mb.a.dUf,4)}Pgf(b,h,r,B){var P;t.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+
ye.ImageReader.AZd(b));this.CK.Ixa()&&this.CK.rcd(b,h);if(this.NFf(b)){const ca=null===(P=x())||void 0===P?void 0:P.oDb();if((new VF(b,h.node,ca,new QG,y())).resize(r,B))return}ye.ImageReader.Qy(b)?(b=Lb.a.create(),P=new sg.GraphTransaction(15),P.Db(h.node),this.Ewd.ZNn(h,ye.ImageReader.sn(h),r,B,b),P.mHa(b,1),P.dispose()):ye.ImageReader.Zlc(b)?(new GH.a(b,new HH.a)).yno(r,B,this.Wtn,h):(super.Pgf(b,h,r,B),this.Qd.Zs(13))}tO(b){if(!b.al)return!1;var h=b.node;return(h=qe.App.instance&&qe.App.instance.yJb?
h instanceof Qt.a||h instanceof lN.a?h:null:Object(Na.a)(Qt.a,h))&&gn.n(h)?(Ts.Ic.Yb(iN.a.wn,{["Reason"]:jN.a.zO}),!1):super.tO(b)}static ZDn(b){b&&!ar.Oxb&&(ar.Mh.I_a(ar.Jnb),ar.Oxb=!0)}RNn(b,h,r,B,P){return P?(P.pzi=b,P.t9=h,P.iSb=r,P.zw=B,P.X9a=ar.Ylm(P),!0):!1}NFf(b){b=ye.ImageReader.ui(b);const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return qe.App.instance&&qe.App.instance.IR(b)?(v.AFrameworkApplication.se("editswithgc2;editswithgc2cf"),
h):!1}H_c(b){qe.App.zd.Uo&&qe.App.zd.fq.iG(b.node)}l9m(){this.C6g||(t.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.C6g=!0)}HFb(b){const h=kN.a.instance.Jjf(b);this.CK.mhe(b,h[Ff.a.left],h[Ff.a.right],h[Ff.a.top],h[Ff.a.bottom])}get l1k(){return null!=this.Dxg?this.Dxg:this.Dxg=Ya.a.instance.Oa("Box4.ICssColorProvider")}aza(b,h,r,B,P){var ca;if(!this.fna(h))return 8;2===r&&(b=ye.ImageReader.sn(h),(null===(ca=qe.App.instance)||void 0===ca?0:ca.IR(ye.ImageReader.ui(b)))?this.X3h.eMo(P,
b):this.Po.ZSj(P,b));return 32}wOb(b,h,r,B,P){var ca;if(!this.fna(h))return 8;2===r&&(b=ye.ImageReader.sn(h),(null===(ca=qe.App.instance)||void 0===ca?0:ca.IR(ye.ImageReader.ui(b)))?this.X3h.dMo(P,b):this.Po.YSj(P,b));return 32}mgd(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ya.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},
5E3)}static get W8a(){return null!=ar.BIg?ar.BIg:ar.BIg=Il.a.instance}static get H2i(){ar.gW||(ar.gW=new hv.a("PictureBorder"),ar.kGa(ar.gW));return ar.gW}static Ylm(b){if(b.pzi)b=1;else switch(b.iSb){case tC.a.none:b=b.t9?3:4;break;case tC.a.square:b=1===b.zw?8:3===b.zw?9:2;break;case tC.a.topAndBottom:b=5;break;case tC.a.tight:b=6;break;case tC.a.through:b=7;break;default:b=0}return b}static kGa(b){b.pX(3,Mb.a.L$);b.pX(4,Mb.a.L$);b.pX(5,Mb.a.W9c);b.pX(6,Mb.a.L$);b.aBb(Fs.a.instance,1)}get hYc(){null==
this.TBa&&(v.AFrameworkApplication.se("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.TBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.TBa}}ar.Oxb=!1;ar.gW=null;ar.aab=null;ar.Jnb=()=>{ar.Mh.Gjc(ar.Jnb);ar.Oxb=!1;if(rh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else t.ULS.sendTraceTag(509445760,
322,50,"appChrome is undefined")};Object(n.a)(ar,"ImageActor",Ts,[]);class pn{static get Sk(){return null!=pn.ZFg?pn.ZFg:pn.ZFg=Ya.a.instance.resolve("Box4.IParagraphEditor")}static get SA(){return null!=pn.jGg?pn.jGg:pn.jGg=Ya.a.instance.resolve("Box4.IParagraphIndentationReader")}static get p1(){return pn.Sk.qq}static get vg(){return null!=pn.AJg?pn.AJg:pn.AJg=Ya.a.instance.resolve("Box4.IUndoManager")}static Ub(){const b=v.AFrameworkApplication.va;b.qa(Mb.a.gOb,zc.a.view,Lm.a.lw);b.qa(Mb.a.gOb,
zc.a.paragraph,pn.$ma);b.Xc(Mb.a.gOb,1036);b.qa(Mb.a.bEb,zc.a.view,Lm.a.lw);b.qa(Mb.a.bEb,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.bEb,1036);b.qa(Mb.a.khb,zc.a.view,Lm.a.lw);b.qa(Mb.a.khb,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.khb,1036);b.qa(Mb.a.zjc,zc.a.view,Lm.a.lw);b.qa(Mb.a.zjc,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.zjc,1036);b.qa(Mb.a.X6c,zc.a.view,Lm.a.lw);b.qa(Mb.a.X6c,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.X6c,1036);b.qa(Mb.a.S3a,zc.a.view,Lm.a.lw);b.qa(Mb.a.S3a,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.S3a,1036);b.qa(Mb.a.Gkb,
zc.a.view,Lm.a.lw);b.qa(Mb.a.Gkb,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.Gkb,1036);b.qa(Mb.a.R3a,zc.a.view,Lm.a.lw);b.qa(Mb.a.R3a,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.R3a,1036);b.qa(Mb.a.qhe,zc.a.view,pn.mke);b.qa(Mb.a.qhe,zc.a.paragraph,pn.mke);b.Xc(Mb.a.qhe,1028);b.qa(Mb.a.eeg,zc.a.view,pn.mke);b.qa(Mb.a.eeg,zc.a.paragraph,pn.mke);b.Xc(Mb.a.eeg,1028);b.qa(Mb.a.EQb,zc.a.view,Lm.a.lw);b.qa(Mb.a.EQb,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.EQb,1036);b.qa(Mb.a.mqb,zc.a.view,Lm.a.lw);b.qa(Mb.a.mqb,zc.a.paragraph,pn.$ma);
b.Xc(Mb.a.mqb,1036);b.qa(Mb.a.FQb,zc.a.view,Lm.a.lw);b.qa(Mb.a.FQb,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.FQb,1036);b.qa(Mb.a.Yig,zc.a.view,Lm.a.lw);b.Xc(Mb.a.Yig,1028);b.qa(Mb.a.e$c,zc.a.view,Lm.a.lw);b.qa(Mb.a.e$c,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.e$c,1036);b.qa(Mb.a.f$c,zc.a.view,Lm.a.lw);b.qa(Mb.a.f$c,zc.a.paragraph,pn.$ma);b.Xc(Mb.a.f$c,1036)}static mke(b,h,r,B,P){2===r&&""===P[Gg.a.Text]&&(b=b===Mb.a.qhe?Mb.a.S3a:Mb.a.R3a,h=new GD.a,h.value=0,h.unit=qe.App.LGa?2:1,v.AFrameworkApplication.va.Qb(b,2,
h),ab.StaticActiveAppFrame.za().updateCommandUI());return 32}static $ma(b,h,r,B,P){if(!({Dy:r}=Lm.a.sgg(r,h)).returnValue)return r;h=h.node;switch(b){case Mb.a.gOb:pn.p1.c4f(h,!0);break;case Mb.a.bEb:pn.p1.c4f(h,!1);break;case Mb.a.khb:pn.p1.khb(h);break;case Mb.a.zjc:pn.p1.mea(h,0);break;case Mb.a.X6c:pn.p1.bqb(h,0);break;case Mb.a.Gkb:case Mb.a.S3a:r=new xd.GraphIterator;r.set(h);r.zb(11);let ca=P.value;P=P.unit;b===Mb.a.Gkb&&(ca=(new js.a(P,ca)).Xt+pn.SA.JG(h).Xt,P=1);pn.p1.Kza(r,P,ca);break;case Mb.a.R3a:pn.p1.rQb(h,
P.unit,P.value);break;case Mb.a.EQb:P?(b=(new js.a(P.unit,P.value)).Xt,pn.p1.mea(h,b)):pn.SA.iSd(h).Xt||pn.p1.mea(h,Dg.OutlineReader.aY(h));break;case Mb.a.mqb:P?(b=(new js.a(P.unit,P.value)).Xt,pn.p1.bqb(h,b)):pn.SA.JG(h).Xt||pn.p1.bqb(h,Dg.OutlineReader.aY(h));break;case Mb.a.FQb:pn.p1.mea(h,0);break;case Mb.a.e$c:b=P;b=(new js.a(b.unit,b.value)).Xt;pn.p1.Yeg(h,1,b);break;case Mb.a.f$c:b=P,b=(new js.a(b.unit,b.value)).Xt,pn.p1.Yeg(h,2,b)}pn.vg.sF();B&&Ur.a.trb&&(B.Hs|=Ur.a.cjb(h));return 32}}Object(n.a)(pn,
"IndentationActor",null,[]);class IH extends Pf.a{constructor(){super(!1,!1,!0);this.Jih="08448f1f-f728-4e12-95f8-f6333cdb269f";this.Uub="Envelopes"}dNb(b=!1){!0===b&&(this.Uub="Labels",this.Jih="43f54585-fdbb-4c80-88eb-3251ae40b275");b={["description"]:`Thank you for showing interest! While we are building this feature, we'd love your feedback.\nHow often do you create ${this.Uub.toLowerCase()}?`,["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]=
{["key"]:"4",["text"]:"Daily"};h[1]={["key"]:"3",["text"]:"Weekly"};h[2]={["key"]:"2",["text"]:"Monthly"};h[3]={["key"]:"1",["text"]:"Rarely"};h[4]={["key"]:"0",["text"]:"Never"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b.textAreaDescription=`Please tell us more about why you create ${this.Uub.toLowerCase()} and the top 3 capabilities you would like to see in ${this.Uub.toLowerCase()} feature?`;b={["id"]:"MailingsDialog",["bodyControls"]:b};this.Uh(`Interested in the ${this.Uub} Feature?`,
this.Llo.bind(this),b);return new Promise(r=>{this.HMe=r})}Llo(b,h){1===b&&this.fK(h.selectedReason,h.reasonDescription)}dispose(){super.dispose();this.HMe()}fK(b,h){const r={},B={},P={},ca={},ra={};r.appId=2155;r.manifestType="Fps";r.submitTime=(new Date).toISOString();r.source="Client";r.type="Survey";r.clientFeedbackId=Lb.a.create().toString();ra.reason=b;const Qa={},mb={numberOfOptions:5};mb.selectedRating=b;Qa.rating=[mb];Qa.comment=[h];ca.surveySpecificData=JSON.stringify(Qa);P.extendedManifestData=
JSON.stringify(ca);r.application=P;ra.surveyId=this.Jih;r.survey=ra;r.telemetry=this.g0a();r.web=this.UBb();B["Content-Type"]="application/json";this.Eja(JSON.stringify(r),B)}vM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}g0a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Envelopes and Labels";this.vM(h,b,"audienceGroup","AudienceGroup");this.vM(h,b,"osBuild","OsVersion");this.vM(h,b,"platform","Platform");this.vM(h,b,
"processSessionId","WACSessionID");return h}UBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.vM(h,b,"browser","Browser");this.vM(h,b,"browserVersion","BrowserVersion");this.vM(h,b,"dataCenter","WACDatacenter");return h}Eja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Oe.a(2,1,B,()=>{v.AFrameworkApplication.He.nj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{t.ULS.sendTraceTag(508904273,211,50,"Success sending OCV feedback for {0}",
this.Uub)},()=>{this.Eja(b,h,r+1);t.ULS.sendTraceTag(508904272,211,50,"Failure sending OCV feedback for {0}, attempt {1}",this.Uub,r)},null)})))}}Object(n.a)(IH,"MailingsDialog",Pf.a,[]);class IK{constructor(b){this.ga=b}Ub(){this.ga.qa(V.a.zjf,zc.a.view,this.SVc.bind(this))}SVc(b,h,r){2===r&&(Object(ne.c)(V.a.zjf),(new IH).dNb());return 32}}Object(n.a)(IK,"EnvelopesActor",null,[]);class JK{constructor(b){this.ga=b}Ub(){this.ga.qa(V.a.labels,zc.a.view,this.SVc.bind(this))}SVc(b,h,r){2===r&&(Object(ne.c)(V.a.labels),
(new IH).dNb(!0));return 32}}Object(n.a)(JK,"LabelsActor",null,[]);var KK=c(384),mN=c(66),TG=c(421),nN=c(1223);class zr{constructor(b){this.SYa=this.bDa=this.pAc=null;this.zmh=!1;this.Tae=h=>{if(this.bDa)if(h===eb.a.Sae)kb.FocusManager.instance().getRegion(Zd.AFrame.Q6a).pgc();else if(h===eb.a.Rae)kb.FocusManager.instance().getRegion(Zd.AFrame.Q6a).ngc();else return 2;else return 2;return 32};this._frame=b}NDo(){if(this.zmh)this.SGi();else{const b=Nb.a.create(v.AFrameworkApplication.K.kb("WopiBootstrapUrl"));
b.F_((h,r)=>{r.succeeded?(this.zmh=!0,this.SGi()):t.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Ta.a.UX(b)}}SGi(){if(this.pAc)t.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.fsa;this.bDa=document.createElement("div");b.parentNode.insertBefore(this.bDa,b);this.SYa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:v.AFrameworkApplication.K.kb("FileName"),reactRoot:this.bDa});this.SYa.setWebpackPublicPath(v.AFrameworkApplication.b6);
this.SYa.renderDocumentPanel()}}q2l(b){const h={};h.Container=b;h.BootstrapperUrl=v.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.osb;b={};b.HostName=v.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=v.AFrameworkApplication.K.kb("HostSessionId");b.UserId=v.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.bnb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=v.AFrameworkApplication.K.kb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.bnb;h.Diagnostics=b;b={};b.WopiSrc=v.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=v.AFrameworkApplication.K.kb("AccessToken");b.AccessTokenTtl=v.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
r=>{zr.lX=r;this.SYa.setMaxPage(zr.lX.GetPageCount());this.SYa.setCurrentPage(zr.lX.GetCurrentPage());this.SYa.setPageControlVisible(!0);zr.lX.RegisterEventHandler("PageChanged",B=>{this.SYa.setCurrentPage(B.newPage)});zr.lX.RegisterEventHandler("BrowserEvent",B=>{27===B.keyCode?this.closeViewer():B.button&&1!==B.button||this.bDa.click()});r=this._frame.bnb-(new Date).getTime();t.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Ub();kb.FocusManager.instance().FL(Zd.AFrame.Q6a,
!0);this.buildFocusRegion();this.tIa(kb.FocusManager.instance().fe(Zd.AFrame.Q6a));this.bDa.click()};h.FnOnInitializeFailure=(r,B)=>{t.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),B.toString());this.closeViewer()};return h}buildFocusRegion(){const b=kb.FocusManager.instance();var h=b.getRegion(Zd.AFrame.Q6a);h=[2,3];const r=b.fe(Zd.AFrame.Q6a),B=new le.DOMFocusListing(()=>this.bDa);B.Lja=!0;for(const P of h)B.Qm(P);h=b.nna(()=>this.bDa,r,B);h.TTa();h.yP=!0;h.J0a=!0;B.iz(B.zha)}Ub(){v.AFrameworkApplication.va.qa(eb.a.Sae,
Gd.a.frame,this.Tae);v.AFrameworkApplication.va.qa(eb.a.Rae,Gd.a.frame,this.Tae)}tIa(b){b.mr(kb.FocusManager.instance().YW);b.mr(kb.FocusManager.instance().ZW);b.bindAction(kb.FocusManager.instance().YW,eb.a.Sae);b.bindAction(kb.FocusManager.instance().ZW,eb.a.Rae)}loadViewer(b){b=this.q2l(b);this.pAc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.pAc.Complete(b.WopiInfo)}closeViewer(){kb.FocusManager.instance().hS(Zd.AFrame.Q6a);zr.lX&&(zr.lX.Dispose(),zr.lX=null,v.AFrameworkApplication.va.Vv(eb.a.Sae,
Gd.a.frame,this.Tae),v.AFrameworkApplication.va.Vv(eb.a.Rae,Gd.a.frame,this.Tae));this.pAc&&(this.bDa.parentNode.removeChild(this.bDa),this.bDa=this.pAc=null)}printAction(){t.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");v.AFrameworkApplication.va.processAction(Mb.a.print,2)}downloadPdfAction(){t.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");v.AFrameworkApplication.va.processAction(V.a.MMc,2)}downloadCopyAction(){t.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
v.AFrameworkApplication.va.processAction(eb.a.downloadACopy,2)}zoomInAction(){if(zr.lX){let b=zr.lX.GetZoomLevel();b+=.2;zr.lX.SetZoomLevel(b)}}zoomOutAction(){if(zr.lX){let b=zr.lX.GetZoomLevel();b-=.2;zr.lX.SetZoomLevel(b)}}setPage(b){if(zr.lX){const h=zr.lX.GetPageCount();1>b?(zr.lX.SetCurrentPage(1),this.SYa.setCurrentPage(1)):1<=b&&b<=h?zr.lX.SetCurrentPage(b):(zr.lX.SetCurrentPage(h),this.SYa.setCurrentPage(h))}}static getInstance(b){zr.rPe||(zr.rPe=new zr(b));return zr.rPe}}zr.lX=null;zr.rPe=
null;Object(n.a)(zr,"PreviewPanelActor",null,[]);class cq{static get FKj(){return null!=cq.UJg?cq.UJg:cq.UJg=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static Ub(b,h){b.fb(Mb.a.readingMode,Gd.a.frame,cq.bMj,128);b.qa(Mb.a.ole,Gd.a.frame,cq.bMj);cq.WI=h;b.qa(V.a.NZc,Gd.a.frame,cq.NZc);b.qa(V.a.PZc,Gd.a.frame,cq.PZc);b.qa(V.a.vge,Gd.a.frame,cq.vge);b.fb(V.a.G5c,Gd.a.frame,cq.G5c,96);b.fb(V.a.V5c,Gd.a.frame,cq.V5c,96);b.fb(V.a.jce,Gd.a.frame,cq.jce,96)}static bMj(b,h,r){if(h.contextId!==
Gd.a.frame)return 2;h=Jk.App.pn;switch(b){case Mb.a.readingMode:if(!h.osb)return 8;if(1===r)return gc.SessionStatusManager.instance.Yj?8:32;b=(new Date).getTime();Rh.a.instance.pUn(b);h.bnb=b;v.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Wv.a.mR(xD.a.modeSwitch,!0,cq.LHn,null,h):Wv.a.mR(xD.a.modeSwitch,!0,cq.iRi,null,h);return 32;case Mb.a.ole:return 32;default:return 2}}static iRi(b){TG.a()?cq.Ckm(b):cq.Yxj(b)}static Ckm(b){const h={};h[H.a.qAf]=cq.FKj;v.AFrameworkApplication.kP().execute(r=>
{r.Gv(M.a.rAf);r.eTo(M.a.rAf);r.eC(M.a.rAf,B=>{cq.TVk(B,b)});r.sendMessage(M.a.w0l,h)})}static TVk(b,h){b.Values[H.a.qAf]===cq.FKj&&("true"===b.Values[H.a.Jpi]?cq.Yxj(h):(cq.vWo(),cq.hHo()))}static vWo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};v.AFrameworkApplication.se("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static hHo(){v.AFrameworkApplication.qv=!0;ab.StaticActiveAppFrame.za().W$(1);ab.StaticActiveAppFrame.za().jb.ju&&ab.StaticActiveAppFrame.za().jb.ju.$i&&ab.StaticActiveAppFrame.za().jb.ju.dCf();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&ab.StaticActiveAppFrame.za().updateCommandUI();nN.MainView.PBj(v.AFrameworkApplication.K)}static Yxj(b){try{const h=new Rb.a;let r,B;v.AFrameworkApplication.ZKj?
(r=qe.App.hostUrl,B=3):(r=b.osb,B=1);b.bnb&&h.add(v.AFrameworkApplication.xQf,b.bnb.toString());v.AFrameworkApplication.wEf&&h.add(v.AFrameworkApplication.saf,"1");v.AFrameworkApplication.c7e&&h.add(v.AFrameworkApplication.w5k,"1");h.add(KK.a.urg,KK.a.userSessionData);h.add(v.AFrameworkApplication.Vae,v.AFrameworkApplication.userSessionId);const P=v.AFrameworkApplication.K.kb(v.AFrameworkApplication.Fka);P&&h.add(v.AFrameworkApplication.eEj,P);t.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");
TG.b(v.AFrameworkApplication.K)?TG.d("view",h,TG.c):(r=ka.a.Gph(r,h),v.AFrameworkApplication.ZKj?Qd.a.vm(r,Qd.a.gsa(B),void 0,"AuthenticationLostDuringSession"):Qd.a.openWindow(B,r,!1,void 0,mN.a.Dcj))}catch(h){}}static LHn(b){t.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ya.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("previewPanel")).catch(()=>{t.ULS.sendTraceTag(38130907,
323,10,"previewPanel: Failed to download script");cq.iRi(b)}).then(()=>{zr.getInstance(b).NDo()})}static NZc(b,h,r){if(1===r)return 32;cq.WI.Ddg(1);ab.StaticActiveAppFrame.za().updateCommandUI();return 32}static PZc(b,h,r){if(1===r)return 32;cq.WI.Ddg(0);ab.StaticActiveAppFrame.za().updateCommandUI();return 32}static vge(b,h,r){if(1===r)return 32;cq.WI.Ddg(1===cq.WI.ou?0:1);ab.StaticActiveAppFrame.za().updateCommandUI();return 32}static jce(b,h,r,B,P){if(1===r)return 32;P[Df.a.On]=1===cq.WI.ou;return 32}static G5c(b,
h,r,B,P){if(1===r)return 32;P[Df.a.On]=1===cq.WI.ou;return 32}static V5c(b,h,r,B,P){if(1===r)return 32;P[Df.a.On]=!cq.WI.ou;return 32}}cq.WI=null;Object(n.a)(cq,"MainViewModeActor",null,[]);class LK{constructor(b,h,r){this.qan=(B,P,ca,ra,Qa)=>1===ca?32:(B=this.Yk.g9(P.ik))?(Qa=3===Qa.Ux,this.U6.value.cNh(this.Yam(B),this.vHb(B),Qa),32):2;this.ga=b;this.U6=h;this.Yk=r}Ub(){this.ga.qa(V.a.NKf,zc.a.view,this.qan);this.ga.fb(V.a.Mbe,zc.a.view,Bm.d,96);this.ga.fb(V.a.Jbe,zc.a.view,Bm.d,96);this.ga.fb(V.a.Kbe,
zc.a.view,Bm.d,96);this.ga.fb(V.a.Lbe,zc.a.view,Bm.d,96);this.ga.qa(V.a.a3c,zc.a.view,Bm.c);this.ga.qa(V.a.$2c,zc.a.view,Bm.c);this.ga.qa(V.a.C9d,zc.a.view,Bm.c);this.ga.qa(V.a.D9d,zc.a.view,Bm.c)}Yam(b){const h=new wc.DictionaryPropertySet;h.setValue(Oc.a.marginTop,this.Yk.Noa(b));h.setValue(Oc.a.marginBottom,this.Yk.Owa(b));h.setValue(Oc.a.marginLeft,this.Yk.CJ(b));h.setValue(Oc.a.marginRight,this.Yk.oL(b));return h}vHb(b){const h=new wc.DictionaryPropertySet;h.setValue(Oc.a.Ko,this.Yk.ru(b));h.setValue(Oc.a.uv,
this.Yk.IB(b));return h}}Object(n.a)(LK,"MarginsDialogActor",null,[]);class MK{constructor(b,h,r,B){this.ga=b;this.hd=h;this.$Ma=r;this.v0j=B;this.izd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],cRj:["Summary","Updates","Challenges","Opportunities","What's Next"],cTj:["Highlights","Itinerary","Food","Activities"],IPj:["Introduction","Step 1","Step 2","Step 3"]}}Ub(){this.ga.fb(V.a.NPi,zc.a.Tc,this.SFk.bind(this),1028);this.ga.fb(V.a.uQf,zc.a.Tc,this.VGc.bind(this),
1028);this.ga.fb(V.a.sQf,zc.a.Tc,this.VGc.bind(this),1028);this.ga.fb(V.a.rQf,zc.a.Tc,this.VGc.bind(this),1028);this.ga.fb(V.a.vQf,zc.a.Tc,this.VGc.bind(this),1028);this.ga.fb(V.a.tQf,zc.a.Tc,this.VGc.bind(this),1028)}SFk(){return null===this.hd.instance?2:32}VGc(b,h,r){var B;if(1===r){if(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===r){switch(b){case V.a.uQf:this.nYd(this.izd.Resume);
break;case V.a.sQf:this.nYd(this.izd.cRj);break;case V.a.vQf:this.nYd(this.izd.cTj);break;case V.a.rQf:this.nYd(this.izd.IPj);break;case V.a.tQf:this.v0j.m8b(P=>{P.iJa("WordMiniTemplateSurvey",null)})}return 32}return 2}nYd(b){const h=new sg.GraphTransaction(15);try{const r=ab.StaticActiveAppFrame.za().jb.rc.ed;let B=r,P;for(P=qc.a.gp(r);P.moveNext();){const ra=P.currentNode;if(Td.ParagraphReader.VWc(ra)&&Td.ParagraphReader.Xb(ra)){B=ra;break}}h.Db(B);const ca=this.hd.instance.jCd(b,B,!0).toArray();
this.CJl(ca)}finally{h.dispose()}}CJl(b){for(const h of b)this.$Ma.instance.Bba(h.node,4)}}Object(n.a)(MK,"MiniTemplateActor",null,[]);class JH{constructor(b){this.scd=(h,r,B)=>{if(1===B)return 32;h=v.AFrameworkApplication.ta;if(!h)return 32;h.uEd();JH.cbo(h);return 32};this.ga=b}Ub(){this.ga.qa(V.a.scd,zc.a.view,this.scd)}static cbo(b){const h=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var r=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");r=Gc.a.tca(h,
!r);Gc.a.ZIa(h,(!r).toString(),Gc.a.pHa);r?t.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):t.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");ne.d(V.a.scd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ma.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.refreshDocument(null)}}Object(n.a)(JH,"ModernUxActor",null,[]);var oN=c(1089),Us=c(1729);class NK{constructor(b,h,r,B){this.ake=af.a.Nv(1)/6;this.bno=(P,
ca,ra,Qa,mb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){if(0<=mb&&mb<Us.a.t1.length){ca=new sg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=Us.a.t1[mb].jxb;Qa=Us.a.t1[mb].hxb;const Jb=Us.a.t1[mb]._marginLeft;mb=Us.a.t1[mb].ixb;this.g$d(P,Qa,this.Uf.IB(ra))&&this.g$d(Jb,mb,this.Uf.ru(ra))?(this.QE.f8a(ra,P),this.QE.d8a(ra,Qa),this.QE.cka(ra,Jb),this.QE.e8a(ra,mb),this.Vd.Zs(11)):this.TIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ca.dispose()}else return 2;return 32}t.ULS.sendTraceTag(520618525,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.cno=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){if(0<=mb&&mb<Us.a.Sqa.length)ca=new sg.GraphTransaction(15),ca.Db(ra),ca.Uj=P,P=(Qa=this.Uf.lXc(ra))?Us.a.Sqa[mb].Kta:Us.a.Sqa[mb].ZMa,mb=Qa?Us.a.Sqa[mb].ZMa:Us.a.Sqa[mb].Kta,this.g$d(this.Uf.Owa(ra),this.Uf.Noa(ra),mb)&&this.g$d(this.Uf.CJ(ra),this.Uf.oL(ra),P)?(this.QE.Beg(ra,P),this.QE.Aeg(ra,mb),this.Vd.Zs(11)):this.TIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),
ca.dispose();else return 2;return 32}t.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.xmo=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=this.Uf.lXc(ra);Qa=new sg.GraphTransaction(15);Qa.Db(ra);Qa.Uj=P;this.QE.Jmj(ra,mb);if(mb&&!ca||!mb&&ca){P=this.Uf.ru(ra);mb=this.Uf.IB(ra);this.QE.Beg(ra,mb);this.QE.Aeg(ra,P);P=this.Uf.Noa(ra);mb=this.Uf.Owa(ra);const Jb=this.Uf.CJ(ra),Yb=this.Uf.oL(ra);ca?(this.QE.f8a(ra,v.AFrameworkApplication.isRtl?
Jb:Yb),this.QE.d8a(ra,v.AFrameworkApplication.isRtl?Yb:Jb),this.QE.cka(ra,v.AFrameworkApplication.isRtl?mb:P),this.QE.e8a(ra,v.AFrameworkApplication.isRtl?P:mb)):(this.QE.f8a(ra,v.AFrameworkApplication.isRtl?Yb:Jb),this.QE.d8a(ra,v.AFrameworkApplication.isRtl?Jb:Yb),this.QE.cka(ra,v.AFrameworkApplication.isRtl?Math.abs(P):mb),this.QE.e8a(ra,v.AFrameworkApplication.isRtl?mb:P));this.Vd.Zs(11)}Qa.dispose();return 32}t.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik);return 2};this.GZd=(P,ca,ra)=>{if(1===ra)return 1===this.qT.ou?32:8};this.Ypb=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new sg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=Math.floor(this.Uf.ru(ra)/720);if(0>mb||mb>P)return 2;this.QE.kQb(ra,mb);this.Imd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Pge=(P,ca,ra,Qa,mb)=>
{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new sg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=mb[0];Qa=this.Uf.ru(ra);if(720>P||P>Qa)return 2;this.QE.jlc(ra,mb);this.Imd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Oge=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik),2;ca=new sg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=this.Uf.ru(ra);Qa=this.Uf.hh(ra);if(0>mb||mb>(P-720*Qa)/(Qa-1))return 2;this.QE.Uho(ra,mb);this.Imd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Nge=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new sg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;if(null==mb)return 2;this.QE.too(ra,
mb);this.Imd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.mIa=(P,ca,ra,Qa,mb)=>{if(P=this.Uf.g9(ca.ik))return mb.marginTop=this.Uf.Noa(P),mb.marginBottom=this.Uf.Owa(P),mb.marginLeft=this.Uf.CJ(P),mb.marginRight=this.Uf.oL(P),mb.Ko=this.Uf.ru(P),mb.uv=this.Uf.IB(P),mb.Mxa=this.Uf.lXc(P),mb.aF=this.Uf.hh(P),mb.zna=this.Uf.bjb(P),mb.u1k=this.Uf.FUd(P),mb.BLb=this.N4l(mb),mb.jNb=this.Y8l(mb),mb.tJc=this.ySl(mb),32;t.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik);return 2};this.Bhe=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=new sg.GraphTransaction(15);ca.Db(ra);switch(P){case Mb.a.f8a:this.QE.f8a(ra,mb);break;case Mb.a.d8a:this.QE.d8a(ra,mb);break;case Mb.a.cka:this.QE.cka(ra,mb);break;case Mb.a.e8a:this.QE.e8a(ra,mb)}this.Vd.Zs(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.qnj=(P,ca,ra,Qa,mb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=
new sg.GraphTransaction(15);ca.Db(ra);let Jb=Qa=0;switch(P){case Mb.a.Deg:Jb=mb;this.QE.Beg(ra,Jb);Qa=this.Uf.IB(ra);break;case Mb.a.Ceg:Qa=mb,this.QE.Aeg(ra,Qa),Jb=this.Uf.ru(ra)}this.QE.Jmj(ra,Qa<Jb);this.Vd.Zs(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.QE=b;this.Vd=h;this.qT=r;this.Imd=B}get Uf(){return Kn.a.instance}O4l(b){var h=qe.App.LGf,r=h?1:3,B=v.AFrameworkApplication.numberFormat;let P=Us.a.t1[b].jxb;
var ca=Us.a.t1[b].hxb;var ra=Us.a.t1[b]._marginLeft;b=Us.a.t1[b].ixb;P=h?af.a.IVa(P):af.a.Yz(P);ca=h?af.a.IVa(ca):af.a.Yz(ca);ra=h?af.a.IVa(ra):af.a.Yz(ra);b=h?af.a.IVa(b):af.a.Yz(b);h=E.a.mFa(P,r,B);ca=E.a.mFa(ca,r,B);ra=E.a.mFa(ra,r,B);r=E.a.mFa(b,r,B);B={};B.top=h;B.bottom=ca;B.left=ra;B.right=r;return B}nan(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,B=WordRibbonStrings.PageMarginsLeft,P=WordRibbonStrings.PageMarginsRight;b=this.O4l(b);return[[h,b.top,r,b.bottom],
[B,b.left,P,b.right]]}x3c(b){var h=qe.App.LGf,r=h?1:3;const B=v.AFrameworkApplication.numberFormat;let P=Us.a.Sqa[b].Kta;b=Us.a.Sqa[b].ZMa;P=h?af.a.IVa(P):af.a.Yz(P);b=h?af.a.IVa(b):af.a.Yz(b);h=E.a.mFa(b,r,B);r=E.a.mFa(P,r,B);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Ub(){const b=v.AFrameworkApplication.va;b.fb(Mb.a.g8a,zc.a.view,this.bno,4);b.fb(Mb.a.GUa,zc.a.view,this.cno,4);b.fb(Mb.a.setOrientation,zc.a.view,this.xmo,4);b.fb(Mb.a.mIa,zc.a.view,this.mIa,96);b.qa(Mb.a.f8a,
zc.a.view,this.Bhe);b.qa(Mb.a.d8a,zc.a.view,this.Bhe);b.qa(Mb.a.cka,zc.a.view,this.Bhe);b.qa(Mb.a.e8a,zc.a.view,this.Bhe);b.qa(Mb.a.Deg,zc.a.view,this.qnj);b.qa(Mb.a.Ceg,zc.a.view,this.qnj);b.fb(Mb.a.GZd,zc.a.view,this.GZd,4);b.qa(Mb.a.Ypb,zc.a.view,this.Ypb);b.qa(Mb.a.Pge,zc.a.view,this.Pge);b.qa(Mb.a.Oge,zc.a.view,this.Oge);b.qa(Mb.a.Nge,zc.a.view,this.Nge)}g$d(b,h,r){return r>=b+h+qe.App.GAa}N4l(b){let h=5;for(let r=0;r<Us.a.t1.length;r++)if(Us.a.t1[r].jxb===b.marginTop&&Us.a.t1[r].hxb===b.marginBottom&&
Us.a.t1[r]._marginLeft===b.marginLeft&&Us.a.t1[r].ixb===b.marginRight){h=r;break}return h}Y8l(b){let h=5;b=new oN.a(Math.min(b.Ko,b.uv),Math.max(b.Ko,b.uv));for(let r=0;r<Us.a.Sqa.length;r++)if(this.aAn(b,Us.a.Sqa[r])){h=r;break}return h}ySl(b){let h=0;switch(b.aF){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}aAn(b,h){return Kd.a.Wvi(b.ZMa,Math.max(h.ZMa-this.ake,0),h.ZMa+this.ake)&&Kd.a.Wvi(b.Kta,Math.max(h.Kta-this.ake,0),h.Kta+this.ake)}TIa(b){if(!Ai.a.EM){const h=new Wh.StandardDialog;
h.Cd=0;h.IV(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(n.a)(NK,"PageActor",null,[604]);class OK{constructor(b){this.ga=b}get oc(){return this.ga}Ahe(b,h){let r=0;b?1===b?r=Mb.a.cka:2===b?r=Mb.a.e8a:3===b&&(r=Mb.a.d8a):r=Mb.a.f8a;this.oc.Qb(r,2,h)}GUa(b,h){let r=0;1===b?r=Mb.a.Ceg:b||(r=Mb.a.Deg);this.oc.Qb(r,2,h)}Mge(b,h){let r=0;switch(b){case 0:r=Mb.a.Ypb;break;case 1:r=Mb.a.Pge;break;case 2:r=Mb.a.Oge;break;case 3:r=Mb.a.Nge}this.oc.Qb(r,2,h)}}Object(n.a)(OK,"PageCommands",null,[603]);
class PK{constructor(b,h,r){this.$zn=(B,P,ca,ra,Qa)=>1===ca?32:(B=this.Yk.g9(P.ik))?(Qa=3===Qa.Ux,this.U6.value.HNh(this.Zam(B),this.vHb(B),Qa),32):2;this.ga=b;this.U6=h;this.Yk=r}Ub(){this.ga.qa(V.a.PKf,zc.a.view,this.$zn);this.ga.fb(V.a.ace,zc.a.view,Bm.d,96);this.ga.fb(V.a.$be,zc.a.view,Bm.d,96);this.ga.qa(V.a.G9d,zc.a.view,Bm.c);this.ga.qa(V.a.F9d,zc.a.view,Bm.c)}Zam(b){const h=new wc.DictionaryPropertySet;h.setValue(Oc.a.Ko,this.Yk.ru(b));h.setValue(Oc.a.uv,this.Yk.IB(b));return h}vHb(b){const h=
new wc.DictionaryPropertySet;h.setValue(Oc.a.marginTop,Math.abs(this.Yk.Noa(b)));h.setValue(Oc.a.marginBottom,Math.abs(this.Yk.Owa(b)));h.setValue(Oc.a.marginLeft,this.Yk.CJ(b));h.setValue(Oc.a.marginRight,this.Yk.oL(b));return h}}Object(n.a)(PK,"PaperSizeDialogActor",null,[]);class ZE{constructor(b,h,r){this.ga=b;this.U6=h;this.BW=r}Ub(){this.ga.fb(Mb.a.afc,zc.a.view,this.NAn.bind(this),1028);this.ga.qa(Mb.a.afc,zc.a.paragraph,this.LAn.bind(this));this.ga.fb(Mb.a.xNn,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.yNn,
zc.a.view,Bm.d,96);this.ga.fb(Mb.a.FMn,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.GMn,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.aCo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.$Bo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.eyn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.fyn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.Rxn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.ZBo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.Sxn,zc.a.view,Bm.c,96)}LAn(b,h,r,B,P){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.aDj(h);P=3===P.Ux;this.U6.value.PJd(this.VRc(b),
this.vHb(h),P);return 32}NAn(b,h,r,B,P){b=h.view.mb;if(!b||ZE.Xf.Dcc(b.qg))return 8;if(ZE.ah.CAa(Td.ParagraphReader.PU,b.qg))return ZE.Ic.Yb(te.a.ef,{["Reason"]:fe.a.zO}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.ib.lb;h=this.aDj(h);P=3===P.Ux;if(1===r.length&&Pd.SelectionEditor.Ze(r.J(0)))return r=r.J(0).node,this.U6.value.PJd(this.VRc(r),this.vHb(h),P),32;b=[];for(B=0;B<r.length;B++){const ca=r.J(B);(!B&&Pd.SelectionEditor.Kk(ca)||Td.ParagraphReader.um(ca)||Pd.SelectionEditor.vl(ca))&&
b.push(ca.node)}if(!b.length)return 8;r=Array(b.length);for(B=0;B<b.length;B++)r[B]=this.VRc(b[B]);r=rw.APropertySet.ubi(r);this.U6.value.PJd(r,this.vHb(h),P);return 32}VRc(b){const h=new wc.DictionaryPropertySet;h.setValue(Zc.a.zw,Td.ParagraphReader.Ox(b));const r=this.BW.zQa(b);var B=r.lineSpacing;h.setValue(Zc.a.w5a,B.unit);h.setValue(Zc.a.xa,B.value);B=r.beforeSpacing;h.setValue(Zc.a.Vhc,B.unit);h.setValue(Zc.a.Whc,B.value);B=r.afterSpacing;h.setValue(Zc.a.Thc,B.unit);h.setValue(Zc.a.Uhc,B.value);
h.setValue(Zc.a.E3c,r.sw);h.setValue(Nd.a.keepWithNext,Td.ParagraphReader.keepWithNext(b));h.setValue(Nd.a.widowControl,Td.ParagraphReader.Ipc(b));h.setValue(Nd.a.keepTogether,Td.ParagraphReader.keepTogether(b));return h}static get Xf(){return xj.a.instance}static get ah(){return Im.ContextSetEditor.instance}static get Ic(){return Ih.a.instance}}Object(n.a)(ZE,"AParagraphDialogActor",null,[]);class QK extends ZE{constructor(b,h,r,B,P){super(b,h,r);this.Yk=B;this.ep=P}Ub(){super.Ub();this.ga.fb(Mb.a.m6i,
zc.a.view,Bm.d,96);this.ga.fb(Mb.a.n6i,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.LMn,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.czm,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.ezm,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.XBo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.YBo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.Zxn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.hyn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.gyn,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.bCo,zc.a.view,Bm.c,96);this.ga.fb(Mb.a.zNn,zc.a.view,Bm.d,96);this.ga.fb(Mb.a.ANn,zc.a.view,Bm.d,96)}aDj(b){return this.Yk.g9(b.ik)}VRc(b){const h=
super.VRc(b);var r=this.ep.yU(b);const B=this.ep.JG(b);h.setValue(Zc.a.$Ha,1);h.setValue(Zc.a.aIa,r.Xt-B.Xt);r=this.ep.i3a(b);h.setValue(Zc.a.xob,r.unit);h.setValue(Zc.a.yob,r.value);b=this.ep.aac(b);b.specialIndentType&&(h.setValue(Zc.a.Y5,b.specialIndentType),h.setValue(Zc.a.WUa,b.unit),h.setValue(Zc.a.XUa,b.value));return h}vHb(b){const h=new wc.DictionaryPropertySet;h.setValue(Oc.a.Ko,this.Yk.ru(b));h.setValue(Oc.a.uv,this.Yk.IB(b));h.setValue(Oc.a.marginTop,Math.abs(this.Yk.Noa(b)));h.setValue(Oc.a.marginBottom,
Math.abs(this.Yk.Owa(b)));h.setValue(Oc.a.marginLeft,this.Yk.CJ(b));h.setValue(Oc.a.marginRight,this.Yk.oL(b));return h}}Object(n.a)(QK,"ParagraphDialogActor",ZE,[]);class RK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.Uzi=h}}Object(n.a)(RK,"AfterPasteEventArgs",Sys.EventArgs,[]);class SK{constructor(b){this.UFe=null;this.Dld=b}get rPd(){return null!=this.oAg?this.oAg:this.oAg=Ya.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get UZd(){this.UFe||(this.UFe=
!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(Ro.a.lSh));return this.UFe}aKn(b){if(b&&Zf.OutlineElementReader.yh(b.ywa)&&Zf.OutlineElementReader.yh(b.pmb)){this.vKn(b);var h=new al.a;for(h.kd(b.ywa);h&&h.currentNode;){const r=this.STd(h),B=Td.ParagraphReader.Xb(r);B&&Td.ParagraphReader.Bgb(r)&&this.ZJn(r);const P=h.currentNode.id===b.pmb.currentNode.id;B&&this.UZd&&r.yj.Nha(r.type).Hce(new RK(r,P));if(P)break;hg.OutlineElementNavigator.ns(h,!1,!1)}}}ZJn(b){t.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.kic;b=Se.a.Uc(b,0);aq.OWc(h)?this.rPd.P$d(b,h):this.Dld.P$d(b,h)}vKn(b){if(b.ywa.currentNode&&b.pmb.currentNode&&b.ywa.currentNode.id===b.pmb.currentNode.id){const h=this.STd(b.ywa);Td.ParagraphReader.Xb(h)?this.cKn(h,b.ECn,b.DCn):t.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}cKn(b,h,r){t.ULS.shipAssertTag(590956771,
307,0<=h);t.ULS.shipAssertTag(590958592,307,0<=r);var B=Td.ParagraphReader.text(b);if(""!==B){var P=Se.a.createTextRange(b,h,r);P=ch.a.Fz(P,!1);if(1===P.length){const ca=P[0];P=B.substring(h,r).trim();B=B.substring(ca.cpBegin,ca.cpEnd).trim();h=P===B;P=Se.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&h&&!ch.a.cSa(B))b=ca.hyperlink.url;else if(h)b=B;else{t.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}aq.OWc(b)?this.rPd.gRa(P,b,!1):this.Dld.gRa(P,b,!1)}else t.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",P.length)}}STd(b){const h=hg.OutlineElementNavigator.Ee(b);hg.OutlineElementNavigator.Yd(b);return h}}Object(n.a)(SK,"PastedContentsProcessorPostMergeAfterPaste",null,[602]);class KH extends hi{constructor(b,h,r,B,P,ca,ra,Qa){super(B);this.ZRe=7;this.iw=
this.evc=null;this.BEe=0;this.yEe=b;this.Nk=h;this.Dn=r;this.je=P;this.mVj=ra;this.iZa=Qa;this.D3=this.je.DSa("UserAction","WordIgnoreAll")}Lfg(b){this.yEe.LLi();this.evc=this.Dn.Hoa(b);this.iZa.sqi(this.evc,null,!1);return this.yEe.FDj(this.evc)?(this.D3.start(),this.iw=new sg.GraphTransaction(15),this.iw.Db(b.node),!0):!1}Zae(b){this.cOb(b.node);return!0}Q4c(b){this.cOb(b);return!0}$ae(b){this.cOb(b.node)}Slg(b){this.iw.dispose();this.evc.errorDetails.Jrb(b.actionId);this.D3.stop();t.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.BEe,this.D3.pi,this.evc.errorDetails.proofingType));return!0}Bmc(b,h){if(super.Bmc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}Nfi(b){if(b&&b.type!==this.ZRe){const h=xd.GraphIterator.eb(b);return h.zb(this.ZRe)?h.jd(this.ZRe):b}return b}$Om(b,h){return this.yEe.N$c(h.errorDetails)&&!this.Nk.x9(Se.a.createTextRange(b,h.Bc,h.end))}cOb(b){if(b){var h=this.Dn.G4(b,
r=>this.$Om(b,r));this.mVj?this.Dn.ppb(b,h,!0):0<h.length&&(b.nl(4,!0),this.Dn.iMb(b));this.BEe+=h.length}}}Object(n.a)(KH,"IgnoreAllCallbackSteps",hi,[]);class TK{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){this.C5c=(Wc,id,Id,ve,$d)=>{if(1===Id)return 32;Wc=this.OI.FFa(id.view.mb.qg);if(Wc=Hi.a.ug(Wc))$d[mm.a.LabelText]=Wc.displayName;return 32};this.epa=(Wc,id,Id,ve,$d,be)=>{const he=new KH(this.S6j,this.Nk,this.Dn,this.Fe,this.je,this.QW,0,this.iZa);return new Qy(Wc,id,Id,ve,$d,be,he,this.ga,
this.hb,this.Fe,"IgnoreAllOperation")};this.jEb=(Wc,id,Id,ve,$d,be)=>{const he=new KH(this.G1j,this.Nk,this.Dn,this.Fe,this.je,this.QW,1,this.iZa);return new Qy(Wc,id,Id,ve,$d,be,he,this.ga,this.hb,this.Fe,"DoNotCheckThisCritiqueType")};this.ga=b;this.Nk=h;this.hb=r;this.Fe=B;this.Dn=P;this.OI=ca;this.je=ra;this.S6j=Qa;this.G1j=mb;this.wYb=Jb.aYc;this.QW=Jb;this.iZa=Yb;this.BGe=fc;this.G$a=Mc}Ub(){this.BGe&&(qs.QB()?this.ga.fb(Mb.a.epa,zc.a.Tc,this.pxm.bind(this),1028):this.ga.KT(Mb.a.epa,zc.a.view,
this.epa,1028));this.wYb&&this.ga.KT(Mb.a.jEb,zc.a.view,this.jEb,1028);this.ga.fb(V.a.C5c,zc.a.view,this.C5c,96)}pxm(b,h,r,B,P){if(1===r)return 32;t.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.G$a.zyf(P?P:h,null,Eo.b.IgnoreAll);return 32}}Object(n.a)(TK,"ProofingActor",null,[]);var pN=c(1731);class gD{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.Lp=this.yNa=this.myd=this.nyd=null;this.uE=this.Pr=this.Op=0;this.ubb=this.tbb=!1;this.oba=this.wab=this.vab=this.sab=this.xab=
0;this.nxd=null;this.afa=this.RW=this.Uq=this.wQ=0;this.Zl=null;this.Yvb=0;this.KYf=Jb=>{var Yb;if(5===this.Yvb){const fc=Object.assign(new sb.a,{extendedProperties:new Map});fc.extendedProperties.set("status",Jb.data.status.toString());fc.extendedProperties.set("httpStatus",Jb.data.Ne.toString());(null===(Yb=v.AFrameworkApplication.K)||void 0===Yb?0:Yb.$("ShouldLogPicturesExtendedHealthKpis"))?(Yb={name:Rm.c.wXd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:fc},fc.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:Rm.c.qbc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:fc},optionalVeto:Yb})):xa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,fc)}t.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Jb.data.status,["HttpStatus"]:Jb.data.Ne,["Id"]:Jb.data.id,["ResponseData"]:Jb.data.te},
YE.a[this.Yvb]);this.dfe()};this.Vj=r;this._image=b;this._context=h;this.fqd=!1;(b=gD.hi.uu(h.node))&&b.tf(Oc.a.AIf)&&(this.fqd=!0);this.Ywc=B.$("ImageDataURLPresentationIsEnabled");this.Wfk=B.$("WordOartPostRequestIsEnabled");this.Ca=B;this.qr=P;this.je=ca;this.Vd=ra;this.Pm=Qa;this.qK=mb;this.rg=ci.a.getInstance(Rm.a);this.SBm();this.G8d=this.phc.bind(this)}SBm(){this.Lp="";this.Op=ye.ImageReader.oF(this._image);this.Pr=ye.ImageReader.KG(this._image);this.oba=ye.ImageReader.Fjb(this._image);this.uE=
ye.ImageReader.p0(this._image);var b=ye.ImageReader.Loa(this._image);this.tbb=b.xib;this.ubb=b.hFa;b=ye.ImageReader.yca(this._image);this.xab=Math.max(b.top,0);this.sab=Math.max(b.bottom,0);this.vab=Math.max(b.left,0);this.wab=Math.max(b.right,0);this.Zl=Lb.a.nil;this.yNa=null;this.Yvb=ye.ImageReader.ui(this._image)}XEd(b,h){return(new pN.a(this.qr,this.Yvb,this.Ca,this.Op,this.Pr,this.uE,this.oba,this.xab,this.sab,this.vab,this.wab,this.tbb,this.ubb,this.fqd)).build(this._context.node,this._image,
b,h)}resize(b,h){this.Lp="Resize";this.zke();Me.a.mark(this.J$b());this.Op=b;this.Pr=h;this.sendMessage(!1,this.G8d)}Hw(b){this.Lp="Styles";this.zke();Me.a.mark(this.J$b());this.oba=b;this.sendMessage(!1,this.G8d)}Vmo(b,h,r){this.Lp="Rotation";this.zke();this.uE=b;this.tbb=h;this.ubb=r;this.sendMessage(!1,this.G8d)}Umo(b,h){this.Lp="SwordRequestManager";this.zke();this.yNa=b;this.uE=h.angle;this.Op=h.width;this.Pr=h.height;this.oba=h.styleId;this.xab=h.top;this.sab=h.bottom;this.vab=h.left;this.wab=
h.right;this.Zl=h.MX;this.sendMessage(!1,this.G8d)}sendMessage(b,h){if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Qgb(r);const B=ye.ImageReader.Roa(this._image,this.Ca,this.qr);B?Gx.a.kqb(this._image,B,4):this._image.setValue(Ng.a.TPa,!0);r.dispose()}this.fwj(b);Me.a.mark(this.J$b());b=new xb.QueryStringBuilder(this.XEd(b,!0));this.Ywc&&b.Ae(Sg.a.aQh,"true");this.Wfk?(r=new xb.QueryStringBuilder("WordOart.ashx"),v.AFrameworkApplication.He.nj(r.toString(),2,b.toString(),
{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.KYf,null)):v.AFrameworkApplication.He.nj(b.toString(),1,"",null,!0,0,h,this.KYf,null)}Qgb(b){b=this.Zl&&this.Zl!==Lb.a.nil?new sg.GraphTransaction(7,Mb.a.m9):new sg.GraphTransaction(15);b.Db(this._context.node);return b}get DPj(){const b=new sg.GraphTransaction(3);b.Db(this._context.node);return b}dfe(){this.uNc();this.ZMd();const b=this.DPj;var h=ye.ImageReader.qFa(this._image,this._context.node.Mc,this.Ca,this.qr);this._image.setValue(Ng.a.TPa,
!1);this._image.setValue(Zc.a.zUc,h);this._image.setValue(Zc.a.KU,-1);this._image.setValue(Ng.a.H5,1);h=ye.ImageReader.Roa(this._image,this.Ca,this.qr);this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Zc.a.iae),this._image.removeProperty(Zc.a.gae),h&&Gx.a.kqb(this._image,h,3));b.dispose();gD.Ep();this.yNa&&this.yNa()}fwj(b){this.je&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.nyd=this.je.Yf("WebServiceCall",b))}uNc(){this.nyd&&(this.nyd.stop(),
this.nyd=null)}zke(){if(this.je){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Lp,YE.a[this.Yvb]);this.myd=this.je.Yf("WebServiceCall",b)}}ZMd(){this.myd&&(this.myd.stop(),this.myd=null)}static get hi(){return ro.PageNavigator.instance}static Ep(){const b=new Wh.StandardDialog;b.Cd=0;b.wx(vg.a.WDn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);ab.StaticActiveAppFrame.za()&&ab.StaticActiveAppFrame.za().updateCommandUI()}}Object(n.a)(gD,
"RenderedImageEditOperation",null,[624]);var LH=c(303),WF=c(512);class UK extends gD{constructor(b,h,r,B,P,ca,ra,Qa,mb){super(b,h,r,B,P,ca,ra,Qa,mb);this.rg=ci.a.getInstance(wv.a)}sendMessage(b,h){Object(LH.a)(()=>{let r;r=this.Qgb(r);this._image.setValue(Ng.a.H5,0);r.dispose()});this.fwj(b);Me.a.mark(this.J$b());b=new xb.QueryStringBuilder("WordOart.ashx");this.g_g=this.Njb(!0,!1);b=new WF.a(b.toString(),2,this.Njb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,
null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");v.AFrameworkApplication.He.send(b).hza(h,r=>{this.KYf(r)})}phc(b){try{var h=JSON.parse(b.data.jUa);this.M5j=h[Sg.a.PSc];this.xpk=h[Sg.a.width];this.f6j=h[Sg.a.height];this.SLg=h[Sg.a.DGc];this.Quc=Array(4);this.Quc[Ff.a.left]=h[Sg.a.Fhb];this.Quc[Ff.a.right]=h[Sg.a.Ghb];this.Quc[Ff.a.top]=h[Sg.a.Hhb];this.Quc[Ff.a.bottom]=h[Sg.a.Ehb];this.H3g=void 0!==h[Sg.a.$xa]?"true"===h[Sg.a.$xa].toLowerCase():null;Object(LH.a)(()=>
{this.Udd();this._context.node.Zi().contentReplicator.forceOutbound(()=>{this.SFl()},null,null)})}catch(r){Gx.a.bJa&&(b=Object.assign(new sb.a,{extendedProperties:new Map([["Renderer",wv.b.bFa],["Exception",r.message],["Operation",this.Lp]])}),h={name:wv.d.KVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:wv.d.vMd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:b},optionalVeto:h})),t.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Lp,ye.ImageReader.ui(this._image)),this.dfe()}}U7d(){t.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Udd(){let b;b=this.Qgb(b);this._image.setValue(Nd.a.lP,this.M5j);this.SLg&&this._image.setValue(Nd.a.hDd,this.SLg);this._image.setValue(Nd.a.bxa,this.xpk);this._image.setValue(Nd.a.cxa,
this.f6j);this._image.setValue(Nd.a.JQa,this.Quc);this.Z6j&&this._image.setValue(Zc.a.sIb,this.Z6j);Gx.a.kqb(this._image,this.g_g,3);this._image.setValue(Oc.a.Chb,this.g_g);this.H3g?this._image.setValue(Nd.a.s4a,this.H3g):this._image.removeProperty(Nd.a.s4a);this.rYk();b.dispose()}rYk(){this._image.removeProperty(Zc.a.ft);this._image.removeProperty(Zc.a.KU);this._image.removeProperty(Zc.a.iae);this._image.removeProperty(Zc.a.gae)}SFl(){this.qK.SIa(this._context);if(this.Zl&&this.Zl!==Lb.a.nil){var b=
this._context.node.Zi();const h=new U.a(this.Zl,1);this.Pm.m5b(b,h)}this.Vd.Zs(13);Gx.a.bJa&&(b=new Map([["Renderer",wv.b.bFa],["Type",ye.ImageReader.ui(this._image).toString()]]),this.rg.logKpiSuccess({kpiName:wv.d.vMd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b}},blockFutureEmissionDurationInMs:3E5}));this.uNc();this.ZMd();Me.a.mark(this.I$b());Object(LH.a)(()=>{let h;h=this.Qgb(h);this._image.setValue(Ng.a.H5,1);h.dispose()});this.yNa&&this.yNa()}Njb(b,
h){b=new xb.QueryStringBuilder(this.XEd(b,h));b.Ae(Sg.a.EXd,"true");return b.toString()}J$b(){return 51511}I$b(){return 51512}}Object(n.a)(UK,"RenderedGraphicEditOperation",gD,[]);class VK extends gD{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){super(b,h,r,B,P,ca,ra,Qa,mb);this.dVg=null;this.U7d=Yb=>{const fc=this.XEd(!0,!1);let Mc;Mc=this.Qgb(Mc);this._image.setValue(Oc.a.EGc,this.nxd);var Wc=Ya.a.instance.Oa("Box4.IFeatureHelper");if(Gx.a.bJa){const ve=new Map([["Renderer",wv.b.legacy],["Type",ye.ImageReader.ui(this._image).toString()]]);
this.rg.logKpiSuccess({kpiName:wv.d.JVh,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:ve}},blockFutureEmissionDurationInMs:3E5})}Wc&&Wc.isFeatureEnabled(51)&&this._image.setValue(Oc.a.dOd,this.dVg);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Vj.ohe(this._image,this.uE,this.tbb,this.ubb);const id=ye.ImageReader.Roa(this._image,this.Ca,this.qr),Id=()=>{id&&Gx.a.kqb(this._image,id,3);Gx.a.kqb(this._image,
fc,3);this.Vj.mhe(this._image,af.a.EG(this.wQ),af.a.EG(this.RW),af.a.EG(this.Uq),af.a.EG(this.afa));this._image.setValue(Oc.a.Chb,fc);ye.ImageReader.Qy(this._image)||this._image.setValue(Oc.a.gGa,po.a.rendered);this.Vj.Vge(this._image,this.Op,this.Pr);this.Ca.$("WordEditorImageRotateIsEnabled")&&!this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Vj.ohe(this._image,this.uE,this.tbb,this.ubb);2===Yb.data.status&&ye.ImageReader.O0(Yb.data.te)&&(this._image.setValue(Zc.a.ft,Yb.data.te),
Yb.data.request&&this._image.setValue(Zc.a.sIb,Gx.a.eOc("POST"===Yb.data.request.get_httpVerb()?Yb.data.request.get_body():Yb.data.request.get_url())));this.yNa&&this.yNa();this.qK.SIa(this._context);if(this.Zl&&this.Zl!==Lb.a.nil){const ve=this._context.node.Zi(),$d=new U.a(this.Zl,1);this.Pm.m5b(ve,$d)}this.Vd.Zs(13);this.uNc();this.ZMd();Me.a.mark(this.I$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Zl&&this.Zl!==Lb.a.nil&&(Wc=this._context.node.Zi())&&Wc.contentReplicator){Mc.dispose();
Wc.contentReplicator.forceOutbound(()=>{let ve;ve=this.Qgb(ve);Id();ve.dispose()},null,null);return}Id();Mc.dispose()};this.rg=ci.a.getInstance(wv.a);this.AQe=Jb}J$b(){return 51511}I$b(){return 51512}phc(b){try{var h=JSON.parse(b.data.te);const P=Sys.Net.XMLDOM("string"===typeof h[Sg.a.ath]?h[Sg.a.ath]:null);this.nxd="string"===typeof h[Sg.a.iDd]?h[Sg.a.iDd]:null;const ca=Ya.a.instance.Oa("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(51)&&(this.dVg="string"===typeof h[Sg.a.s8b]?h[Sg.a.s8b]:null);
ba.a.ht&&P.setProperty("SelectionNamespaces","xmlns:mc='"+Ce.a.HCk+"'");const ra=P.selectSingleNode("/mc:AlternateContent");if(!ra)throw Dr.a.argument("Alternate content element could not be retrieved!");const Qa=ra.firstChild;if(!Qa)throw Dr.a.argument("Alternate content choice element could not be retrieved!");const mb=Qa.firstChild;if(!mb)throw Dr.a.argument("Drawing element could not be retrieved!");var r=mb.firstChild;if(!r)throw Dr.a.argument("Inline element could not be retrieved!");h=b=null;
const Jb=RegExp("effectExtent"),Yb=RegExp("extent");for(const Mc of r.childNodes)-1!==Mc.nodeName.search(Jb)&&(b=Mc),-1!==Mc.nodeName.search(Yb)&&(h=Mc);if(!b||!h)throw Dr.a.argument("Effect extent or extent could not be retrieved!");this.wQ=parseInt(b.selectSingleNode("@l").text);this.RW=parseInt(b.selectSingleNode("@r").text);this.Uq=parseInt(b.selectSingleNode("@t").text);this.afa=parseInt(b.selectSingleNode("@b").text);const fc=df.c(this.uE);if(45<=fc&&135>=fc||225<=fc&&315>=fc){const Mc=parseInt(h.selectSingleNode("@cx").text);
var B=parseInt(h.selectSingleNode("@cy").text);r=Mc/2;B/=2;this.wQ-=r-B;this.RW+=r-B;this.Uq-=B-r;this.afa+=B-r}}catch(P){Gx.a.bJa&&(B=Object.assign(new sb.a,{extendedProperties:new Map([["Renderer",wv.b.legacy],["Exception",P.message],["Operation",this.Lp]])}),r={name:wv.d.Ctl,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:B},B.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:wv.d.JVh,errorName:"DrawingResponseInvalid",
optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:B},optionalVeto:r}));t.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",P.message,this.Lp,YE.a[this.AQe]);this.dfe();return}this.sendMessage(!0,this.U7d)}}Object(n.a)(VK,"RenderedDrawingEditOperation",gD,[]);class WK extends gD{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){super(b,h,r,B,P,ca,ra,Qa,mb);this.aba=null;this.U7d=fc=>{var Mc;const Wc=this.XEd(!0,!1);let id;
id=this.Qgb(id);this._image.setValue(Oc.a.BNb,this.nxd);const Id=ye.ImageReader.Roa(this._image,this.Ca,this.qr);(null===(Mc=v.AFrameworkApplication.K)||void 0===Mc?0:Mc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiSuccess({kpiName:Rm.c.qbc});const ve=()=>{Id&&Gx.a.kqb(this._image,Id,3);Gx.a.kqb(this._image,Wc,3);this.Vj.mhe(this._image,af.a.EG(this.wQ),af.a.EG(this.RW),af.a.EG(this.Uq),af.a.EG(this.afa));this._image.setValue(Oc.a.Chb,Wc);ye.ImageReader.Qy(this._image)||this._image.setValue(Oc.a.gGa,
po.a.rendered);this._image.setValue(Oc.a.g4c,this.oba);this._image.setValue(Zc.a.hym,-1);this.rd.isFeatureEnabled(91)&&ye.ImageReader.Nac(this._image)&&this.Po.Ude(this._image);this._image.setValue(Ng.a.TPa,!1);this.Vj.Vge(this._image,this.Op,this.Pr);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Vj.ohe(this._image,this.uE,this.tbb,this.ubb);this.Ca.$("WordEditorImageCropIsEnabled")&&this.Vj.aeg(this._image,this.xab,this.sab,this.vab,this.wab);2===fc.data.status&&ye.ImageReader.O0(fc.data.te)&&
(this._image.setValue(Zc.a.ft,fc.data.te),fc.data.request&&this._image.setValue(Zc.a.sIb,Gx.a.eOc("POST"===fc.data.request.get_httpVerb()?fc.data.request.get_body():fc.data.request.get_url())));this.yNa&&this.yNa();this.qK.SIa(this._context);if(this.Zl&&this.Zl!==Lb.a.nil){const $d=this._context.node.Zi(),be=new U.a(this.Zl,1);this.Pm.m5b($d,be)}this.Vd.Zs(13);this.uNc();this.ZMd();Me.a.mark(this.I$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Zl&&this.Zl!==Lb.a.nil&&
(Mc=this._context.node.Zi())&&Mc.contentReplicator){id.dispose();Mc.contentReplicator.forceOutbound(()=>{let $d;$d=this.Qgb($d);ve();$d.dispose()},null,null);return}ve();id.dispose()};this.AQe=Jb;this.rd=Yb}J$b(){return 7988}I$b(){return 7989}get Po(){this.aba||(this.aba=new HK.a);return this.aba}phc(b){var h;try{const r=b.data.Qja;this.nxd=b.data.te;ba.a.ht&&r.setProperty("SelectionNamespaces","xmlns:pic='"+Ce.a.UDn+"'");const B=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.wQ=parseInt(B.selectSingleNode("@l").text);
this.RW=parseInt(B.selectSingleNode("@r").text);this.Uq=parseInt(B.selectSingleNode("@t").text);this.afa=parseInt(B.selectSingleNode("@b").text)}catch(r){b=Object.assign(new sb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.Lp);(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Rm.c.wXd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:Rm.c.qbc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):xa.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);t.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Lp,YE.a[this.AQe]);this.dfe();
return}this.uNc();Me.a.mark(this.I$b());this.sendMessage(!0,this.U7d)}}Object(n.a)(WK,"RenderedPictureEditOperation",gD,[]);class XK{constructor(b,h,r,B,P,ca,ra,Qa){this.Vj=b;this.Ca=h;this.qr=r;this.je=B;this.Vd=P;this.Pm=ca;this.qK=ra;this.rd=Qa}create(b,h){const r=ye.ImageReader.ui(b);return Jk.App.instance.IR(r)?new UK(b,h,this.Vj,this.Ca,this.qr,this.je,this.Vd,this.Pm,this.qK):10===r||11===r||48===r||4===r?new VK(b,h,this.Vj,this.Ca,this.qr,this.je,this.Vd,this.Pm,this.qK,r):5===r?new WK(b,
h,this.Vj,this.Ca,this.qr,this.je,this.Vd,this.Pm,this.qK,r,this.rd):null}}Object(n.a)(XK,"Factory",null,[601]);class YK{constructor(){this.CMc=b=>{const h=window.performance.now(),r=um.a.zr();if(r){b=BH.a(b.customData,r);b=qc.a.Gs(b,r);var B=0,P=new sg.GraphTransaction(3);try{for(P.Db(r);b.moveNext();){if(!Td.ParagraphReader.oh(b.iterator))continue;const ca=b.currentNode;this.cVh(ca)&&(B++,ca.nl(4,!0));const ra=window.performance.now()-h;if(2500<B||100<ra){this.Xyb=null;this.X5c(ca);break}}}finally{P&&
P.dispose()}}else Rc.b(570450380,3018,10,"PageContentNode not found")};this.Xyb=null}Wui(){const b=um.a.zr();this.i6c(b);this.X5c(null)}X5c(b){this.Xyb&&(v.AFrameworkApplication.lc.ff(this.Xyb),this.Xyb=null);this.Xyb=new Oe.a(1,1,1,this.CMc,198);this.Xyb.customData=b;v.AFrameworkApplication.lc.Wb(this.Xyb)}i6c(b){const h=BH.b(b);if(h){var r=new sg.GraphTransaction(3);try{for(r.Db(b);h.moveNext();){if(!Td.ParagraphReader.oh(h.iterator))continue;const B=h.currentNode;this.cVh(B)&&B.nl(4,!0)}}finally{r&&
r.dispose()}}}cVh(b){b=b.mH;for(const h of b)if(h.slb)return 0<h.KRb;return!1}}Object(n.a)(YK,"RenderParagraphsContainingTabs",null,[]);class ZK{constructor(b,h){this.qze=!0;this.Dtc=null;this.Yrl=()=>{this.Dtc=null;this.qze=!0;this.zNa&&this.zNa.RVa(!qe.App.nP())};this.D9a=(r,B,P)=>{if(1===P)return 32;2===P&&(r=!1,qe.App.nP()?this.qze=!1:this.qze?r=!0:this.n0o(),this.zNa&&this.zNa.RVa(r));return 32};this.ga=b;this.zNa=h}Ub(){this.ga.fb(eb.a.D9a,zc.a.application,this.D9a,1124)}n0o(){this.Dtc?v.AFrameworkApplication.lc.ff(this.Dtc):
this.Dtc=new Oe.a(4,1,5E3,this.Yrl);v.AFrameworkApplication.lc.Wb(this.Dtc)}}Object(n.a)(ZK,"SaveStatusActor",null,[]);class $K{get tbg(){return null!=this.TGg?this.TGg:this.TGg=Ya.a.instance.Oa("Box4.ISaveStyleManager")}get F6n(){return this.E6n||(this.E6n=Ya.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get io(){return null!=this.OHg?this.OHg:this.OHg=Ya.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(r,B,P)=>{r=um.a.eKb(B);if(1===P||r)return r?8:32;this.U6.value.$9k(B);
return 32};this.vDb=(r,B,P)=>{r=um.a.eKb(B);if(1===P||r)return r?8:32;this.U6.value.edl(B,this.ga);return 32};this.Wef=(r,B,P)=>{r=um.a.eKb(B)||this.Fso();if(1===P||r)return r?8:32;this.U6.value.Wef(B);return 32};this.ga=b;this.U6=h}get qc(){return null!=this.zKg?this.zKg:this.zKg=Ya.a.instance.resolve("Box4.Styles.IWACStyleReader")}Ub(){this.ga.fb(Mb.a.applyStyles,zc.a.view,this.applyStyles,1028);this.ga.fb(Mb.a.vDb,zc.a.view,this.vDb,4);this.ga.fb(Mb.a.aEb,zc.a.view,this.Wef,4);this.ga.fb(Mb.a.sbg,
zc.a.view,this.ybo.bind(this),4);this.ga.fb(Mb.a.I$f,zc.a.view,this.J$f.bind(this),4);this.ga.fb(Mb.a.Ref,zc.a.view,this.Kll.bind(this),4)}ybo(b,h,r){b=um.a.eKb(h)||this.Kso();if(1===r||b)return b?8:32;this.tbg.xbo();return 32}J$f(b,h,r){b=um.a.eKb(h)||this.Iso();if(1===r||b)return b?8:32;this.F6n.J$f();return 32}Kll(b,h,r){b=um.a.eKb(h)||this.Eso();if(1===r||b)return b?8:32;this.U6.value.Jll();return 32}Eso(){return"{}"===OE.a.isb?!0:!1}Iso(){if(0==OE.a.j5.size)return!0;var b=OE.a.j5;const h=this.qc.Ar();
let r=0;for(const B of b.values())b=h.pj(B),this.qc.le(b,h)||r++;return 0==r?!0:!1}Kso(){var b=OE.a.isb,h=OE.a.j5;const r=this.qc.Ar();if(0==h.size)return!0;if(!({Gt:b}=I.d(b)).returnValue)return t.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const P of h.values()){h=r.pj(P);var B=b[P];if(null==B)return!1;if(B=um.a.QUd(B)){if(h=um.a.wQc(h,r),um.a.zXc(h,B))return!1}else t.ULS.sendTraceTag(526979993,
3017,15,"Received null style during de serialization: StylesActor.")}return!0}Fso(){var b=um.a.zr();if(!b)return Rc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new au.WACStyleSet).iY(b);const h=b.DO;for(let B=0;B<h;B++){var r=b.PFa(B);if(this.qc.isHidden(r)||!this.qc.le(r,b))continue;const P=this.qc.NG(r);if(2===P||1===P)if(!r.hasProperty(Oc.a.linkedStyle)||2===P)if(r=r.ja(Oc.a.XK,null),!(r&&0<r.length))return!1}return!0}}Object(n.a)($K,"StylesActor",null,[]);class UG{constructor(b){this.nle=
(h,r,B)=>{h=v.AFrameworkApplication.ta;if(1===B)return 1!==h.mode||gc.SessionStatusManager.instance.Yj?2:32;xa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,UG.zB,null);const P={};P[H.a.qAf]=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");P[H.a.Jpi]="true";v.AFrameworkApplication.kP().execute(ca=>{ca.sendMessage(M.a.aFo,P)});return v.AFrameworkApplication.va.processAction(Mb.a.readingMode,2)};this.ga=b}Ub(){this.ga.qa(V.a.nle,zc.a.view,this.nle)}}UG.zB="wwaengidc";
Object(n.a)(UG,"SwitchToClassicViewModeActor",null,[]);class aL{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.angle=r;this.styleId=B;this.width=b;this.height=h;this.top=P;this.bottom=ca;this.left=ra;this.right=Qa;this.MX=mb}}Object(n.a)(aL,"SWordData",null,[]);class bL{constructor(b,h){this.Fk=this.k3=this.xq=null;this.PQe=this.DZb=!1;this.wQ=this.RW=this.afa=this.Uq=this.oba=this.Pr=this.Op=this.uE=0;this.Zl=null;this.W9=()=>{this.PQe=!1;this.DZb&&this.yNc()};this.ap=b;this.mCc=h;this.lsi()}lsi(){this.RW=
this.wQ=this.afa=this.Uq=this.oba=this.Pr=this.Op=this.uE=-1;this.Zl=Lb.a.nil}yNc(){this.PQe||(this.s3o(),this.xel(),this.DZb=!1)}xel(){this.Fk=new aL(this.Op,this.Pr,this.uE,this.oba,this.Uq,this.afa,this.wQ,this.RW,this.Zl);this.mCc.create(this.k3,this.xq).Umo(this.W9,this.Fk);this.PQe=!0;let b;Object(uc.a)(3,this.k3)?b=YE.a[ye.ImageReader.ui(this.k3)]:(t.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");t.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.Op,this.Pr,this.uE,this.oba,this.Uq,this.afa,this.wQ,this.RW,b);this.lsi()}s3o(){this.Op=-1!==this.Op?this.Op:this.k3.ja(Zc.a.eGa,-1);this.Pr=-1!==this.Pr?this.Pr:this.k3.ja(Zc.a.dGa,-1);this.Op=-1!==this.Op?this.Op:this.ap.oF(this.k3);this.Pr=-1!==this.Pr?this.Pr:this.ap.KG(this.k3);this.uE=-1!==this.uE?
this.uE:this.ap.p0(this.k3);this.oba=-1!==this.oba?this.oba:this.ap.Fjb(this.k3);const b=this.ap.yca(this.k3);this.Uq=-1!==this.Uq?this.Uq:b.top;this.afa=-1!==this.afa?this.afa:b.bottom;this.wQ=-1!==this.wQ?this.wQ:b.left;this.RW=-1!==this.RW?this.RW:b.right}$Nn(b,h,r,B){this.xq=b;this.uE=r;this.DZb=!0;this.k3=h;this.Zl=B;this.yNc()}ZNn(b,h,r,B,P){this.xq=b;this.DZb=!0;this.k3=h;this.Zl=P;this.k3.setValue(Zc.a.eGa,r);this.k3.setValue(Zc.a.dGa,B);this.yNc()}dOn(b,h,r){this.xq=b;this.DZb=!0;this.k3=
h;this.oba=r;this.yNc()}TNn(b,h,r,B,P,ca){this.xq=b;this.Uq=r;this.afa=B;this.wQ=P;this.RW=ca;this.DZb=!0;this.k3=h;h=b=0;({width:b,height:h}=this.ap.qjb(this.k3));this.Op=b-(P+ca)/1E5*b;this.Pr=h-(r+B)/1E5*h;this.yNc()}}Object(n.a)(bL,"SWordRequestManager",null,[600]);class XF{constructor(b,h,r,B=null,P=null,ca=null,ra=null,Qa=null,mb=null,Jb=null){this.Pm=null;this.Klh=!1;this.GHo=(Yb,fc,Mc,Wc,id)=>{if(1===Mc)return 32;const Id=Yb===Mb.a.Zfg;if(!fc.view.ue)return 2;const ve=fc.view,$d=ve.mb,be=
$d.qg;if(!be||XF.Xf.a0(be))return 2;if(this.en&&this.en.instance&&this.en.instance.TU(be))return 4;Yb=null;var he=nd.ActionManager.sya;let re=!1;var Xf=Pd.SelectionEditor.Ze(be);if(be.lx){if($d.ib.MJ&&(he=be.getContext(0),Yb=new xd.GraphIterator,Yb.set(he.node),Yb.Ip(),he=Id?Mb.a.bcg:Mb.a.bge),he=this.gVe.BIn(he),he===nd.ActionManager.sya){var Mg=XF.ah.YT(be,16);Mg?(Id&&(he=Mb.a.X5d),Yb=new xd.GraphIterator,Yb.set(Mg.node),Yb.od()):he=Id?Mb.a.bH:Mb.a.JO}}else if(be.al)if(Yb=new xd.GraphIterator,Yb.set(be.node),
Pd.SelectionEditor.Bu(Yb),Dg.OutlineReader.ORa(be))he=Id?Mb.a.bcg:Mb.a.bge;else{if(this.wEe&&this.wEe.Juo(be))return this.wEe.J9c(be,ve.$b,Id),32;ye.ImageReader.j4a(be)?he=Id?Mb.a.acg:Mb.a.$bg:(he=Id?this.gVe.lnm(Yb,be,he,fc):this.gVe.knm(Yb,be,he,fc),Zf.OutlineElementReader.yh(Yb)&&be.contextId===zc.a.Tc&&(re=Zf.OutlineElementReader.KA(Yb,be,!1)),Mg=rg.ListItemReader.lg(Yb)&&re,he!==nd.ActionManager.sya||qh.TableCellReader.Tpa(Yb)||Mg||(this.Klh||(t.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),
this.Klh=!0),v.AFrameworkApplication.va.processAction(Mb.a.Gsi,2),this.dti(fc)))}else return 2;if(!Id&&he===nd.ActionManager.sya&&qh.TableCellReader.Tpa(Yb))if(Qg.returnToCell(Yb),qh.TableCellReader.HRa(Yb)||mi.TableReader.nzi(Yb)&&qh.TableCellReader.sGf(Yb)){if(he=this.Mqk(),!he)return 2}else he=Mb.a.cRi;if(he===nd.ActionManager.sya)return 2;switch(he){case Mb.a.cRi:case Mb.a.X5d:Wc=he===Mb.a.X5d;Xf&&this.A2&&this.FZ&&(Xf=this.A2.mlf(be,-1,!0,kc.a.Kw))&&this.FZ.bij(Xf);Mc=32;Qg.returnToCell(Yb);
Qg.moveToNextOrPreviousCell(Yb,Wc)&&(Xf=!0,Wc=!1,Dg.OutlineReader.vzf(Yb)||(Xj.OutlineNavigator.TQf(Yb,!1),hg.OutlineElementNavigator.Ee(Yb),Td.ParagraphReader.Bt(Yb.currentNode)&&(Xf=!1,Td.ParagraphReader.textLength(Yb.currentNode)||(Wc=!0)),Wc||Qg.returnToCell(Yb)),Wc?Yb=Fe.SelectionFactory.ne(Yb.currentNode,0):(Yb=Fe.SelectionFactory.Dq(Yb.currentNode),!Xf&&Pd.SelectionEditor.Kk(Yb.Rc)&&(Xf=Yb.toArray(),Array.removeAt(Xf,Xf.length-1),Yb=new ri.Selection(Xf,Yb.isForward))),$d.Ac(Yb));break;case Mb.a.bcg:case Mb.a.bge:he===
Mb.a.bge?Xj.OutlineNavigator.EQi(Yb,!1):Xj.OutlineNavigator.EQi(Yb,!0);$d.Ac(Fe.SelectionFactory.Dq(Yb.currentNode));Mc=32;break;case Mb.a.Tad:Mc=v.AFrameworkApplication.va.Mf(fc,he,Mc,!0,Wc,id);break;default:if(Mc=v.AFrameworkApplication.va.Mf(fc,he,Mc,!0,Wc,id),!re&&Xf&&(he===Mb.a.bH||he===Mb.a.JO)){const $l=Pd.SelectionEditor.NQ($d.ib.lb).y;qe.App.tjc(()=>{this.Vfn($d,ve,$l)})}}32===Mc&&fc.view.ue&&this.vg.sF();return Mc};this.Nma=b;this.gVe=h;this.en=r;this.A2=B;this.FZ=P;this.jVe=ca;this.EKa=
ra;this.rd=Qa;this.Lc=mb;this.wEe=Jb}get vg(){return this.Pm||(this.Pm=this.Nma())}Ub(){const b=v.AFrameworkApplication.va,h=this.GHo;b.fb(Mb.a.tab,zc.a.view,h,1124);b.fb(Mb.a.Zfg,zc.a.view,h,1124);b.qa(Mb.a.Gsi,zc.a.view,nd.ActionManager.Nf)}Vfn(b,h,r){if(b&&h){var B=b.ib.lb;Pd.SelectionEditor.NQ(B).y<r?(h=Pd.SelectionEditor.xOc(h,B,!1),h=Pd.SelectionEditor.xwa(h,{gC:!1,gt:!1,ZD:!1,QF:!0})):h=Pd.SelectionEditor.yOc(h,B,!1);b.Ac(h)}}Mqk(){return Mb.a.d4a}dti(){}c1c(b,h,r){if(b&&h){var B=b.ib.lb;Pd.SelectionEditor.NQ(B).y<
r?(h=Pd.SelectionEditor.xOc(h,B,!1),h=Pd.SelectionEditor.xwa(h,{gC:!1,gt:!1,ZD:!1,QF:!0})):h=Pd.SelectionEditor.xwa(B,{gC:!1,gt:!1,ZD:!1,QF:!0});b.Ac(h)}}static get Xf(){return xj.a.instance}static get ah(){return Im.ContextSetEditor.instance}}Object(n.a)(XF,"TabActor",null,[]);class MH{constructor(b){this.dxc=b}get qq(){return this.dxc}BIn(b){return b}lnm(b,h,r,B){const P=B.view,ca=P.mb.ib.lb;if(qh.TableCellReader.Tpa(b))return this.hzi(b,B)?Mb.a.bH:Mb.a.X5d;hg.OutlineElementNavigator.Yd(b);if(Pd.SelectionEditor.Ze(h))Zf.OutlineElementReader.KA(b,
h,!1)&&this.rrj(b)?r=Mb.a.gOb:Pd.SelectionEditor.sYc(P,ca)&&this.qq.jCb(b)?r=Mb.a.bH:Pd.SelectionEditor.sYc(P,ca)&&(r=Mb.a.bH);else if(Pd.SelectionEditor.vl(h)){if(!this.qq.jCb(b))return r;Pd.SelectionEditor.olb(h)?r=Mb.a.bH:Pd.SelectionEditor.hEi(h)&&(r=this.rrj(b)?Mb.a.gOb:Mb.a.bH)}else this.qq.jCb(b)&&(r=Mb.a.bH);return r}knm(b,h,r,B){if(qh.TableCellReader.P0(b))return this.hzi(b,B)?Mb.a.JO:r;hg.OutlineElementNavigator.Yd(b);if(Pd.SelectionEditor.Ze(h))Zf.OutlineElementReader.KA(b,h,!1)&&(!rg.ListItemReader.lg(b)&&
Zf.OutlineElementReader.isEmpty(b,!1)?r=nd.ActionManager.sya:this.Dso(b)?r=Mb.a.khb:this.Dqj(b)?r=Mb.a.bEb:this.qq.s4b(b)&&(r=Mb.a.JO));else if(Pd.SelectionEditor.vl(h)){if(!this.qq.s4b(b))return r;Pd.SelectionEditor.olb(h)?r=Mb.a.JO:Pd.SelectionEditor.hEi(h)&&(r=this.Dqj(b)?Mb.a.bEb:Mb.a.JO)}else this.qq.s4b(b)&&(r=Mb.a.JO);return r}rrj(b){return rg.ListItemReader.lg(b)?!1:0<Zf.OutlineElementReader.o0(b)?!0:!1}Dqj(b){if(rg.ListItemReader.lg(b))return!1;const h=Zf.OutlineElementReader.o0(b);b=Dg.OutlineReader.aY(b.currentNode);
return h<b?!0:!1}Dso(b){return rg.ListItemReader.lg(b)?!1:0<Zf.OutlineElementReader.JG(b)?!0:!1}static Wr(){return new MH(uu.a.TGb)}hzi(b,h){if(this.ATm){h=h.view;const r=h.mb.ib.lb,B=new xd.GraphIterator;B.kd(b);hg.OutlineElementNavigator.Yd(B);if(rg.ListItemReader.lg(B)&&Pd.SelectionEditor.sYc(h,r))return!0}return!1}get ATm(){var b;v.AFrameworkApplication.se("egdi3422;7g6fa693");return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",
!1)}}Object(n.a)(MH,"TabActorPromoteDemoteStrategy",null,[610]);class jE extends XF{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc){super(b,h,r,B,P,ca,ra,Qa,mb,Jb);this.t8d=(Wc,id)=>{Wc=id.property;!this.q7c||Wc!==Oc.a.Ko&&Wc!==Oc.a.marginLeft&&Wc!==Oc.a.marginRight||this.q7c.Wui()};this.aY=(Wc,id,Id,ve,$d)=>{Wc=Dg.OutlineReader.aY(this.C9l(id));$d.defaultTabStop=Wc;return 32};this.FZb=Yb;this.ga=Mc;this.fC();this.ga.qa(V.a.aY,zc.a.view,this.aY)}get q7c(){return null!=this.IGg?this.IGg:this.IGg=Ya.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}fC(){this.FZb.Al.Te(10).qo(this.t8d)}dti(b){const h=
b.view,r=h.mb;b=r.qg;if(this.EKa&&this.Lc){var B=this.Lc.Pc(15);B.Db(b.node);b.contextId===zc.a.Fd&&v.AFrameworkApplication.va.processAction(Mb.a.QH,2);this.EKa.xYd(r.qg);B.dispose();var P=Pd.SelectionEditor.NQ(r.ib.lb).y;qe.App.tjc(()=>{this.c1c(r,h,P)})}}C9l(b){return b.view.mb.ib.lb.Pa.node}static get instance(){return null!=jE.qDg?jE.qDg:jE.qDg=jE.fm()}static fm(){return new jE(()=>Ya.a.instance.resolve("Box4.IUndoManager"),MH.Wr(),Ya.a.instance.Sa("Box4.IExternalSelectionManager"),Ya.a.instance.resolve("Box4.IAutoCorrectRules"),
Ya.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ya.a.instance.Oa("Box4.ITabPresenterFactory"),Ya.a.instance.Oa("Box4.IBlobEditor"),Ya.a.instance.Oa("Box4.IFeatureHelper"),Ya.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Ya.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),qe.App.li,Ya.a.instance.Oa("Box4.ITabRenderer"),v.AFrameworkApplication.va)}}Object(n.a)(jE,"TabActor",XF,[]);class Hx{static get zt(){return null!=Hx.Ewg?Hx.Ewg:Hx.Ewg=Ya.a.instance.resolve("Box4.IAppFrame")}static initialize(){ih.a.Sdc=
Hx.yUm;ih.a.Ile=Hx.n6o}static yUm(b){return!mi.TableReader.pPm(b)}static Jnb(){Hx.zt.Gjc(Hx.Jnb);Hx.Oxb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static n6o(b){var h,r,B;b&&((null===(h=vq.a.instance.lb)||void 0===h?0:h.ZGa)||(null===(r=vq.a.instance.lb)||void 0===r?0:r.Ov)||(null===(B=vq.a.instance.lb)||void 0===B?0:B.$lb))&&!Hx.Oxb&&(Hx.zt.I_a(Hx.Jnb),
Hx.Oxb=!0)}}Hx.Oxb=!1;Object(n.a)(Hx,"TableActor",null,[]);var qN=c(925);class NH{LFl(b,h,r,B){return b?this.lEl(h,r,B):this.MFl(h,r,B)}I0h(b,h,r,B,P){return b?this.nFl(h,r,B,P):this.aFl(h,r,B,P)}YEl(b){let h=!1;var r=b.isForward?b.Oe.Rc:b.Oe.Pa;b=new xd.GraphIterator;b.set(r.node);b.zb(14);r=null;qh.TableCellReader.gda(b)?qh.TableCellReader.CJb(b)||(h=!0,r=Qg.moveToNextRow(b)):r=Qg.moveToNextColumn(b);return{returnValue:r,ngn:h}}iFl(b){var h=b.isForward?b.Oe.Rc:b.Oe.Pa;const r=new xd.GraphIterator;
r.set(h.node);r.zb(14);h=null;qh.TableCellReader.uia(r)?qh.TableCellReader.tia(r)||(h=new xd.GraphIterator,h.set(b.GDa.node),h.zb(14),b=Al.a.Ls(h),Al.a.Ls(r)>b?(Qg.moveToPreviousRow(r),Qg.moveToLastColumn(r),h=r.currentNode):h=Qg.moveToPreviousRow(r)):h=Qg.moveToPreviousColumn(r);return h}W0h(b,h){var r=b.isForward?b.Oe.Rc:b.Oe.Pa;b=new xd.GraphIterator;b.set(r.node);b.zb(14);r=null;h?qh.TableCellReader.tia(b)||(r=Qg.moveToPreviousRow(b)):qh.TableCellReader.CJb(b)||(r=Qg.moveToNextRow(b));return r}vKb(b,
h,r){for(;qh.TableCellReader.hg(b);)if(h){if(r&&b.Gxa(1)||!r&&b.Nxa(1))return null;r?Qg.moveToPreviousColumn(b):Qg.moveToNextColumn(b)}else{if(qh.TableCellReader.b5(b.currentNode)){const B=new xd.GraphIterator;B.kd(b);if(this.vKb(B,!0,!0)||this.vKb(B,!0,!1)){b.kd(B);break}}else{if(!r&&Qg.moveToControllingCell(b,2))break;if(r&&Qg.moveToControllingCell(b))break}if(r&&qh.TableCellReader.tia(b)||!r&&qh.TableCellReader.CJb(b))return null;r?Qg.moveToPreviousRow(b):Qg.moveToNextRow(b)}return b.currentNode}J8b(b,
h){if(!Al.a.isTableRow(b))return null;b=xd.GraphIterator.eb(b.currentNode);b.zb(14);let r;const B=mi.TableReader.RB(b.origin);do r=h?Qg.moveToPreviousRow(b):Qg.moveToNextRow(b);while(B&&r&&Al.a.zRa(b));return r}hnb(b,h,r,B,P){let ca=null;hg.OutlineElementNavigator.Yd(b);const ra=Zf.OutlineElementReader.isRtl(b.currentNode);if(r)if(Qg.returnToCell(b),h=qh.TableCellReader.gda(b),r=qh.TableCellReader.uia(b),P||!ra&&r||ra&&B&&h)Qg.returnToContainingRow(b),(B=this.J8b(b,!0))?ca=Fe.SelectionFactory.Eo(B,
!h):P&&(hg.OutlineElementNavigator.Yd(b),P=new al.a,P.kd(b),(b=hg.OutlineElementNavigator.g1(P,!1,!1))&&(ca=Fe.SelectionFactory.Eo(b,!1)));else{do ra?Qg.moveToNextColumn(b):Qg.moveToPreviousColumn(b);while(qh.TableCellReader.hg(b)&&!qh.TableCellReader.tia(b));qh.TableCellReader.hg(b)||(ca=Fe.SelectionFactory.Eo(b.currentNode,!ra))}else Zf.OutlineElementReader.KA(b,h,ra)||Pd.SelectionEditor.Ze(h)||Qg.returnToCell(b),ca=Fe.SelectionFactory.Eo(b.currentNode,!ra);return ca}gnb(b,h,r,B,P){let ca=null;
hg.OutlineElementNavigator.Yd(b);const ra=Zf.OutlineElementReader.isRtl(b.currentNode);if(r)if(Qg.returnToCell(b),r=qh.TableCellReader.gda(b),h=qh.TableCellReader.uia(b),P||!ra&&B&&r||ra&&!B&&h)Qg.returnToContainingRow(b),(B=this.J8b(b,!1))?ca=Fe.SelectionFactory.Eo(B,h):(hg.OutlineElementNavigator.Yd(b),B=new al.a,B.kd(b),(b=hg.OutlineElementNavigator.ns(B,!1,!1))&&(ca=Fe.SelectionFactory.Eo(b,!0)));else{do ra?Qg.moveToPreviousColumn(b):Qg.moveToNextColumn(b);while(qh.TableCellReader.hg(b)&&!qh.TableCellReader.gda(b));
qh.TableCellReader.hg(b)||(ca=Fe.SelectionFactory.Eo(b.currentNode,ra))}else Zf.OutlineElementReader.KA(b,h,!ra)||Pd.SelectionEditor.Ze(h)||Qg.returnToCell(b),ca=Fe.SelectionFactory.Eo(b.currentNode,ra);return ca}}Object(n.a)(NH,"ATableCellSelectionStrategy",null,[1572]);class cL extends NH{constructor(){super()}aFl(b,h,r,B){let P=b.lb,ca=null;if(b.Ov)if(h)if(2===P.Oe.Zia&&!P.isForward&&P.Oe.Rc.equals(P.GDa))P=Fe.SelectionFactory.dOh(P.GDa.node,!1);else{var ra=({ngn:b}=this.YEl(P)).returnValue;ra&&
(qh.TableCellReader.$r(ra)&&(ra=xd.GraphIterator.eb(ra),ra.zb(14),ra=!b&&this.vKb(ra,!0,!1)?ra.currentNode:b||Qg.moveToNextRow(ra)?this.vKb(ra,!1,!1):null),ra&&(ca=Fe.SelectionFactory.Xn(xr.TableNodeContext.create(ra),P.isForward)))}else P=b.Cea,b=xd.GraphIterator.eb(P.Oe.Rc.node),b.zb(14),qh.TableCellReader.IGa(b.currentNode)&&Qg.moveToLastGhostCell(b,2),(ra=Qg.moveToNextColumn(b))?(b=qh.TableCellReader.b5(ra),qh.TableCellReader.$r(ra)&&!b&&(ra=xd.GraphIterator.eb(ra),ra.zb(14),ra=Qg.moveToControllingCell(ra)),
b?P=Fe.SelectionFactory.Eo(P.Oe.Rc.node,!1):ca=Fe.SelectionFactory.Eo(ra,!0)):(ra=P.Oe.Rc.node,ca=Fe.SelectionFactory.Eo(ra,!1));else b=h&&P.isForward||!h&&!P.Vpa?P.Oe.Rc:P.Oe.Pa,Al.a.Upa(b.node)&&(b=xd.GraphIterator.eb(b.node),(ra=this.J8b(b,!1))?ca=h?Fe.SelectionFactory.Xn(xr.TableNodeContext.create(ra),P.isForward):Fe.SelectionFactory.Eo(ra,!0):P=Pd.SelectionEditor.Jj(Fe.SelectionFactory.Dq(b.currentNode),!1,!0));return ca?ca:B?Pd.SelectionEditor.I8b(P,!1,h,!0):Pd.SelectionEditor.xwa(P,{gC:!h,
gt:h,ZD:r,QF:!0})}nFl(b,h,r,B){let P=b.lb;var ca=null;if(b.Ov)h?1===P.Oe.Zia&&P.isForward&&P.Oe.Pa.equals(P.GDa)||(ca=this.iFl(P),(ca=this.G0h(P,ca))||P.isForward&&(P=P.SOc())):(P=b.Cea,ca=Fe.SelectionFactory.Eo(P.Oe.Pa.node,!0));else if(h){var ra=(P.isForward?P.Oe.Rc:P.Oe.Pa).node;b=xd.GraphIterator.eb(ra);Pd.SelectionEditor.Bu(b);Al.a.Upa(ra)&&(P.isForward&&1===P.Oe.Zia&&P.Vpa?(ca=Al.a.AB(ra).toArray(),(ca=this.G0h(P,0<=ca.length-2?ca[ca.length-2]:null))||P.isForward&&(P=P.SOc())):(ra=this.J8b(b,
!0))?ca=Fe.SelectionFactory.Xn(xr.TableNodeContext.create(ra),P.isForward):P=Fe.SelectionFactory.Eo(b.currentNode,!0))}else ca=Pd.SelectionEditor.Jj(P,!0,!1);return ca?ca:B?Pd.SelectionEditor.I8b(P,!0,h,!0):Pd.SelectionEditor.fFa(P,{gC:!h,gt:h,ZD:r,QF:!0})}G0h(b,h){if(!h)return null;var r=h;qh.TableCellReader.$r(h)&&(r=xd.GraphIterator.eb(h),r.zb(14),r=this.vKb(r,!0,!0)?r.currentNode:qh.TableCellReader.xha(h));return r?Fe.SelectionFactory.Xn(xr.TableNodeContext.create(r),b.isForward):null}MFl(b,h,
r){let B=h.lb,P=null;if(h.Ov){var ca=h.JX>h.vJa;if(r)if(2===h.length&&1===h.Cea.Oe.Zia&&ca)B=Pd.SelectionEditor.Jj(B,!0,!1);else{if(h=this.W0h(B,!0))qh.TableCellReader.$r(h)&&(h=xd.GraphIterator.eb(h),h.zb(14),h=this.vKb(h,!1,!0)),h&&(P=Fe.SelectionFactory.Xn(xr.TableNodeContext.create(h),B.isForward));P||B.isForward&&(B=B.SOc())}else ca&&(B=h.Cea)}else h=r&&B.isForward?B.Oe.Rc:B.Oe.Pa,Al.a.Upa(h.node)&&(h=xd.GraphIterator.eb(h.node),(ca=this.J8b(h,!0))?P=r?Fe.SelectionFactory.Xn(xr.TableNodeContext.create(ca),
B.isForward):Fe.SelectionFactory.Eo(ca,!0):r&&(B=Fe.SelectionFactory.Eo(h.currentNode,!0)));return P?P:Pd.SelectionEditor.Rgb(b,B,!1,r,r)}lEl(b,h,r){let B=h.lb,P=null;if(h.Ov){const ca=h.JX<h.vJa;if(r)if(2===h.length&&1===h.Cea.Oe.Zia&&ca)B=Pd.SelectionEditor.Jj(B,!1,!1);else{if(h=this.W0h(B,!1))qh.TableCellReader.$r(h)&&(h=xd.GraphIterator.eb(h),h.zb(14),h=this.vKb(h,!1,!1)),h&&(P=Fe.SelectionFactory.Xn(xr.TableNodeContext.create(h),B.isForward))}else ca&&(B=h.Cea)}else h=!r||B.isForward?B.Oe.Rc:
B.Oe.Pa,Al.a.Upa(h.node)&&(h=xd.GraphIterator.eb(h.node),(h=this.J8b(h,!1))&&(P=r?Fe.SelectionFactory.Xn(xr.TableNodeContext.create(h),B.isForward):Fe.SelectionFactory.Eo(h,B.Vpa)));return P?P:Pd.SelectionEditor.Rgb(b,B,!0,r,r)}}Object(n.a)(cL,"TableCellSelectionStrategy",NH,[]);class dL{constructor(b){this.KL=(h,r,B,P,ca)=>{if(1===B)return 32;h=(new lk.a).create();r="";switch(ca.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;
break;default:ca=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.KL(ca,null,null);return 32};this.ga=b}Ub(){this.ga.fb(Mb.a.KL,zc.a.view,this.KL,1028)}}Object(n.a)(dL,"UIAutomationActor",null,[]);class eL{constructor(b,h,r,B){this.gb=b;this.EKa=h;this.Lrc=r;this.h7=B}rog(b,h,r){return this.Lrc.qSm(h)?r?!0:b&&this.gb.oh(b)?(b=this.tw(b.currentNode),this.EKa.qti(b),!0):!1:!1}Nyf(b,h){return this.Lrc.Tyl(b,h)}Tyf(b){b&&this.gb.oh(b)&&(b=this.tw(b.currentNode),this.EKa.xYd(b))}tw(b){return Se.a.tw(b)}K$(b,
h,r){this.h7.E1i&&this.Lrc.Nxi(r)&&(this.h7.K$(b,h),b.setValue(Zc.a.gyi,!0))}tQb(){}w_d(b){return this.Lrc.w_d(b)}get E0d(){return this.Lrc.E0d}lD(){}pea(){}Uhe(){}get Orj(){return!1}}Object(n.a)(eL,"WordEditorPasteStewardBridge",null,[590]);class fL{constructor(b){this.sa=new wd.a;this.rhj="WordFileSaveAsButtonClicked";this.p6o=()=>{this.sa.raiseEvent(this.rhj,null);return 32};this.ga=b}Ub(){v.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(V.a.$Lj,Gd.a.frame,this.p6o)}qzk(b){this.sa.addHandler(this.rhj,
b)}}Object(n.a)(fL,"WordFileSaveAsActor",null,[]);class gL extends up{constructor(){super()}WGc(b,h,r,B,P,ca,ra){return Tr.a.mic(h,r,B,P,ca,ra)}}Object(n.a)(gL,"WordIndentationActorExtension",up,[]);class OH{constructor(){this.Opd=null}get name(){return"WordEditor.Actors"}init(){var b;Hb.InteractiveViewManager.instance.we.Q6b=!0;v.AFrameworkApplication.va.qa(V.a.k5o,Gd.a.frame,WM);this.W.resolve("WordEditor.Actors.DeleteActor").Ub(v.AFrameworkApplication.va);cE.instance.Ub();pn.Ub();cq.Ub(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.IMainViewModeManager"));Bk.Ub();jE.instance.Ub();qN.a.Ub();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Ub(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Ub();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Ub();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Ub();v.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Ub();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.QW.N0d=!0);v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Ub();v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Ub();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Ub();
this.W.resolve("Common.IOfficeTrialExperience").Ub();this.W.resolve("Common.IMacOfficeOffer").Ub();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Ub();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Ub();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Ub();this.W.resolve("WordEditor.Actors.FileDownloadActor").Ub();this.W.resolve("WordEditor.Actors.StylesActor").Ub();(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",
!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Ub();this.W.resolve("WordEditor.Actors.LabelsActor").Ub();this.W.resolve("WordEditor.Actors.EnvelopesActor").Ub();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Ub();this.W.resolve("WordEditor.Actors.ProofingActor").Ub();this.W.resolve("WordEditor.Actors.PageActor").Ub();this.W.resolve("WordEditor.Actors.DarkModeActor").Ub();this.W.resolve("WordEditor.Actors.ImageActor").Ub(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Ub();
this.W.resolve("WordEditor.Actors.UIAutomationActor").Ub();this.W.resolve("WordEditor.Actors.ContentControlActor").Ub();this.W.resolve("WordEditor.Actors.CustomTabActor").Ub();this.W.resolve("WordEditor.Actors.BookmarkActor").Ub();this.W.resolve("WordEditor.Actors.HeadingsActor").Ub();this.W.resolve("Box4.Indicator.IIndicatorManager").RTa(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Ub();this.W.resolve("WordEditor.Actors.AccessibilityActor").l7f();
this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Ub();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Ub();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Ub();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").gZ();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Ub();v.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.jVn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub();this.yW.j7a(this.WXj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");v.AFrameworkApplication.se("bookmarks-core-ex;bookmarks-core-ex-cf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.ksm()&&ab.StaticActiveAppFrame.za().jb.wXh();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Ub();
ab.StaticActiveAppFrame.za().updateCommandUI();Hx.initialize()}dispose(){}jVn(){this.rd.pq.isCompleted?this.rd&&this.rd.isFeatureEnabled(51)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub():this.rd.pq.continueWith(()=>{this.rd&&this.rd.isFeatureEnabled(51)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub(),ab.StaticActiveAppFrame.za().updateCommandUI())})}get MSm(){if(null==this.Opd)if(this.rd)if(this.rd.pq.isCompleted)this.Opd=this.rd.isFeatureEnabled(3);else return!1;else this.Opd=
!1;return this.Opd}wc(b){var h,r;this.W=b;this.rd=b.Oa("Box4.IFeatureHelper");this.QW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.QW.aYc=v.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new xJ).wc(b);b.ia("Box4.IClipboardCommands",()=>new yJ(v.AFrameworkApplication.va,Mb.a.J5e,Mb.a.NHc,Mb.a.R_,Mb.a.z0f,Mb.a.paste,Mb.a.j$,Mb.a.Gob)).ha();
b.ia("HtmlImport.IHtmlNormalizerSettings",()=>{const B=b.resolve("Common.IAppSettingsManager");return new Xx(!0,B.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const B=b.resolve("Common.IAppSettingsManager"),P=ca=>!ca.Ecc;return new uJ(B.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,B.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ca=>ca.Ecc,()=>!1,P,P,P,P,void 0,()=>this.MSm,ca=>!ca.Ecc)}).ha();
b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new eL(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new SK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();
b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new zJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",()=>new AJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",()=>new BJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new CJ(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new OK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>
new $K(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"))).ha();(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ia("WordEditor.Actors.CustomizeRibbonActor",()=>new UF(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.EnvelopesActor",()=>new IK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.LabelsActor",()=>new JK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.DigitalPrintActor",
()=>new EH(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"))).ha();b.ia("WordEditor.Actors.FileDownloadManager",()=>new rK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new MM.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new oK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),v.AFrameworkApplication.K.$("DisablePrint"),v.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();
b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new QK(v.AFrameworkApplication.va,b.Ve("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Kn.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new LK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Kn.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new gK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Kn.a.instance)).ha();
b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new mB.a(b.Sa("Common.ISystemInitiatedFeedback"),IJ.a.N9b())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",()=>new PK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Kn.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new CK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(mK,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",
()=>new TK(v.AFrameworkApplication.va,xj.a.instance,Ya.a.instance.resolve("Box4.ISelectionManager"),Fr.a.instance,Ya.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ya.a.instance.resolve("Box4.ILanguageReader"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ya.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ya.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.QW,Ya.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ya.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("EditorSettingsManager")).then(()=>{const B=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");B.Qzm();B.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new DJ(v.AFrameworkApplication.va,
b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new EJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Ub()});b.ia("WordEditor.Actors.PageActor",()=>new NK(Ya.a.instance.resolve("Box4.IWordSectionEditor"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Ya.a.instance.resolve("WordEditor.IMainViewModeManager"),Ya.a.instance.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();b.ia("WordEditor.Actors.DarkModeActor",()=>new kK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,NM.a.aia(),!!qe.App.instance&&qe.App.instance.HGa,!!qe.App.instance&&qe.App.instance.vYc,Ya.a.instance.resolve("Box4.IDarkModeState"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ya.a.instance.resolve("Box4.DarkModeEventsManager"),
!!qe.App.instance&&qe.App.instance.Jpa)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new tK(b.resolve("WordEditor.IFlatListEditor")));b.ia("WordEditor.Actors.AccessibilityActor",()=>new PJ(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.Ve("WordEditor.FlatListDetailsProvider"),b.Ve("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ve("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new cK(v.AFrameworkApplication.va,
b.Sa("Postmessage.IHostPostmessenger"))).ha();b.ia("WordEditor.Actors.ImageActor",()=>new ar(b.resolve("WordEditor.IImageEditor"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
b.resolve("Box4.IAppFrame"),v.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",()=>new fL(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new XK(b.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.K,v.AFrameworkApplication.ta.TQa,Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),
b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",()=>new lK.DeleteActor(Ya.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ya.a.instance.Sa("Box4.ContentControlConfigSettings"),Ya.a.instance.Sa("Box4.IContentControlEditor"),Ya.a.instance.resolve("Box4.IDynamicRangeEditor"),Ya.a.instance.Sa("WordEditor.Bookmark.IBookmarkManager"),Ya.a.instance.resolve("Box4.IHyperlinkEditor"),Ya.a.instance.resolve("Box4.IHyperlinkStrategy"),
Ya.a.instance.resolve("Box4.IParagraphReader"),Ya.a.instance.resolve("Box4.IParagraphIndentationReader"),Ya.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ya.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ya.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",()=>new bL(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),v.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").ha();
b.ia("WordEditor.Actors.TableCellSelectionStrategy",()=>new cL).as("Box4.ITableCellSelectionStrategy").ha();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new FJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),
xj.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new dE(ab.StaticActiveAppFrame.za(),kb.FocusManager.instance(),v.AFrameworkApplication.va,Ih.a.instance,vq.a.instance,b.resolve("Box4.IFormatPainter"),
b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!qe.App.instance&&qe.App.instance.Jpa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new uK(v.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new dL(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new ZK(v.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();
b.ia("Box4.Actors.IEnterViewStrategy",()=>new GJ(b.Oa("Box4.IAutoCorrectScheduler"),b.Ve("Box4.IUndoManager"),b.Sa("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new eD(Qh.PageReader.instance,b.Ve("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new iK(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),
b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va,v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",
()=>new QJ(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),kb.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",()=>new HJ).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new IG(v.AFrameworkApplication.He,ro.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),
b.resolve("WordEditor.IImageEditor"),Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new zK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),v.AFrameworkApplication.He,this.rd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new YK).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new jK(v.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),
b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new AK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),v.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();b.ia("WordEditor.Actors.BookmarkActor",()=>new fK(ab.StaticActiveAppFrame.za(),v.AFrameworkApplication.va,lh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new zf.a(()=>ab.StaticActiveAppFrame.za().jb.Zc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),
this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Fr.a.instance,this.W.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),Hb.InteractiveViewManager.instance,this.W.Ve("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),xj.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>{var B,P;return new Qs(b.resolve("Box4.IParagraphReader"),Ye.a.instance,ji.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),
b.resolve("Box4.IInteractiveEventHandler"),null!==(P=null===(B=qe.App.instance)||void 0===B?void 0:B.cD)&&void 0!==P?P:!1,new zf.a(()=>ab.StaticActiveAppFrame.za().jb.rc))}).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",()=>new BK).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new hE(lh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Hb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",
()=>new Ss(v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").ha();b.ia("Box4.UI.ExternalContentFloatieManager",()=>new OJ).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new RJ(v.AFrameworkApplication.K,
v.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new gE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Hb.InteractiveViewManager.instance,Ez.a.instance(),v.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),qe.App.li.Al.Te(12),
b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",()=>new gL).as("Box4.Actors.IIndentationActorExtension").ha();v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new JH(v.AFrameworkApplication.va)).ha());v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new UG(v.AFrameworkApplication.va)).ha();(new tJ).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new NJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new LJ(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),!!qe.App.instance&&qe.App.instance.$1d)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",()=>new MJ(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),
b.resolve("Wonca.ExternalContent.IExternalContentEditor"),xj.a.instance,v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Ya.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).ha();(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))&&b.ia("WordEditor.Actors.MiniTemplateActor",()=>new MK(v.AFrameworkApplication.va,b.Sa("WordEditor.Extension.IInsertApiOperations"),b.Sa("WordEditor.Designer.Style.IParagraphDesigner"),
IJ.a.N9b())).ha();this.WXj=new JJ;this.yW=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){L.a.instance.Gc(new OH)}}Object(n.a)(OH,"WordEditorActorsPackage",null,[1,2]);class hL{constructor(b){this.xpd=!1;this.VVi=()=>{this.xpd=!0;this.Ds.fee(this.VVi)};this.Ds=b;this.Ds.dfb(this.VVi)}}Object(n.a)(hL,"GraphFullyConnectedGetter",null,[620]);class dg{constructor(){this.C5g=Object.assign(new Tp.a,{})}ysk(b,h){let r;const B=b&1023;({value:r}=this.C5g.Fc(B,0)).returnValue||dg.Bmm().contains(B)||
t.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,B);r+=h;this.C5g.Z(B,r);return r}static Bmm(){dg.Byd||(dg.Byd=new fa.a,dg.pc(0),dg.pc(1),dg.pc(2),dg.pc(3),dg.pc(4),dg.pc(5),dg.pc(6),dg.pc(7),dg.pc(8),dg.pc(9),dg.pc(10),dg.pc(11),dg.pc(12),dg.pc(13),dg.pc(14),dg.pc(15),dg.pc(16),dg.pc(17),dg.pc(18),dg.pc(19),dg.pc(20),dg.pc(21),dg.pc(22),dg.pc(23),dg.pc(24),dg.pc(25),dg.pc(26),dg.pc(27),dg.pc(28),dg.pc(29),dg.pc(30),dg.pc(31),dg.pc(32),dg.pc(33),dg.pc(34),dg.pc(35),
dg.pc(36),dg.pc(37),dg.pc(38),dg.pc(39),dg.pc(40),dg.pc(41),dg.pc(42),dg.pc(43),dg.pc(44),dg.pc(45),dg.pc(46),dg.pc(47),dg.pc(48),dg.pc(49),dg.pc(50),dg.pc(51),dg.pc(52),dg.pc(53),dg.pc(54),dg.pc(55),dg.pc(56),dg.pc(57),dg.pc(58),dg.pc(59),dg.pc(60),dg.pc(61),dg.pc(62),dg.pc(63),dg.pc(64),dg.pc(65),dg.pc(66),dg.pc(67),dg.pc(68),dg.pc(69),dg.pc(70),dg.pc(71),dg.pc(72),dg.pc(73),dg.pc(74),dg.pc(75),dg.pc(76),dg.pc(77),dg.pc(78),dg.pc(79),dg.pc(80),dg.pc(81),dg.pc(82),dg.pc(83),dg.pc(84),dg.pc(85),dg.pc(86),
dg.pc(87),dg.pc(88),dg.pc(89),dg.pc(90),dg.pc(91),dg.pc(92),dg.pc(93),dg.pc(94),dg.pc(95),dg.pc(96),dg.pc(97),dg.pc(98),dg.pc(99),dg.pc(100),dg.pc(101),dg.pc(102),dg.pc(103),dg.pc(104),dg.pc(105),dg.pc(106),dg.pc(107),dg.pc(108),dg.pc(109),dg.pc(110),dg.pc(111),dg.pc(112),dg.pc(113),dg.pc(114),dg.pc(115),dg.pc(116),dg.pc(117),dg.pc(118),dg.pc(119),dg.pc(120),dg.pc(121),dg.pc(122),dg.pc(124),dg.pc(126),dg.pc(127),dg.pc(128),dg.pc(129),dg.pc(130),dg.pc(131),dg.pc(132),dg.pc(133),dg.pc(134),dg.pc(135),
dg.pc(136),dg.pc(140),dg.pc(145),dg.pc(146),dg.pc(147));return dg.Byd}static pc(b){dg.Byd.add(b&1023)}}dg.Byd=null;Object(n.a)(dg,"LanguagePerParagraphModel",null,[]);class iL{constructor(){this.lhg=!1;this.fGd=this.eGd=this.RTb=0;this.JEi=!0;this.W8o=0}}Object(n.a)(iL,"UpdateWordCountStateResult",null,[]);class jL extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(n.a)(jL,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class kL{constructor(){this.qDh=this.pDh=this.wordCount=
-1;this.vEb=this.Tyh=0;this.uEb=1;this.X0i=1033}}Object(n.a)(kL,"WordCountCache",null,[]);class lL extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(n.a)(lL,"WordCountChangedEventArg",Sys.EventArgs,[]);class mL{constructor(){this.Hpc=this.ODa=0}}Object(n.a)(mL,"CharsCountResult",null,[]);class nL{constructor(){this.cp=0;this.Jpc=null;this.m8=this.n8=0}}Object(n.a)(nL,"TextChunkResult",null,[]);class oL{constructor(){this.OLj=this.n8=this.m8=this.wordCount=0}}Object(n.a)(oL,"WordCountStateForParagraph",
null,[]);class PH{constructor(){this.X$=this.HJ=this.n8=this.m8=this.fS=this.wordCount=0;this.currentNode=null;this.JX=-1;this.cp=0;this.P0f=[];this.uEb=this.vEb=this.e0a=this.K0f=this.L0f=0;this.wI=this.Oyi=!1;this.zsb=new vb.a;this.p5a=new vb.a}}Object(n.a)(PH,"WordCountState",null,[]);class br{constructor(b,h,r,B,P,ca){this.mDo=1E3;this.sa=new wd.a;this.HAb=null;this.Use=0;this.$3j="\ue000";this.Cuc=!1;this.mye=this.bye=this.Wjd=0;this.zRg=this.HRg=null;this.Yxe=this.Xxe=this.gye=0;this.$rl=ra=>
{this.HAb=null;this.Rgf(ra.customData)};this.cG=h;this.k2j=new RegExp(ni.AParagraphNode.QC,"g");this.Jd=b;this.taskManager=B;this.sm=r;this.u_a=ca;this.RXa=P.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Yik=P.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.Eej()}get LYm(){return!!this.HAb}get qPa(){return this.Cuc}set qPa(b){this.Cuc=b}get DBd(){return this.Use}set DBd(b){this.Use=b}get fSa(){return!this.Use}get Lx(){return this.Wjd}get HDb(){return this.bye}get LDb(){return this.mye}get Thl(){return this.HRg}get odf(){return this.zRg}get pLc(){return this.gye}get mLc(){return this.Xxe}get s6b(){return this.Yxe}dfb(b){this.sa.addHandler(br.aqe,
b)}fee(b){this.sa.removeHandler(br.aqe,b)}S0e(b){this.sa.addHandler(br.Hsg,b)}$2n(b){this.sa.removeHandler(br.Hsg,b)}hLd(){this.gLd();this.Eej()}Eej(){this.gye=this.Yxe=this.Xxe=this.mye=this.bye=this.Wjd=-1}Bef(){this.Dke(this.mDo)}gbd(){const b=new PH;b.Oyi=!0;this.gLd();this.Rgf(b)}Dke(b,h=null){this.fSa&&(this.LYm&&(h=null,this.gLd()),h||(h=new PH),b=new Oe.a(3,1,b,this.$rl,this.Qyj),b.customData=h,this.Uwk(b))}gLd(){this.HAb&&(this.taskManager.ff(this.HAb),this.HAb=null)}RIj(b,h,r,B,P,ca=!0,
ra=-1,Qa=-1,mb=-1,Jb=1033){const Yb=new iL;Yb.RTb=r;Yb.eGd=P;Yb.fGd=B;if(!b.cp&&h.$ed&&ca&&!this.lgi(h))return br.H0o(b,h.$ed),Yb.JEi=!0,Yb;B=0<=Qa&&0<=mb?{Bd:Qa,endCp:mb}:void 0;r=this.oNl(h,B);B&&(Qa=B.Bd,mb=B.endCp);r=0<=mb?r.substring(0,mb):r;mb=0<=Qa&&0<=mb?r.substring(Qa,mb):r;B=b.cp>=Qa?b.cp:Qa;P=b.P0f||[];ca=0<b.L0f?b.L0f:0;let fc=0<b.K0f?b.K0f:0,Mc=[];b.wI=!1;do{this.u_a.update();if(!b.Oyi&&(Yb.RTb+Mc.length/2>br.U5o||this.u_a.nnb())){let Id;P=(Id=P).concat.apply(Id,Mc);b.cp=B;b.P0f=P;b.K0f=
fc;b.L0f=ca;b.JX=ra;b.currentNode=h;this.Dke(br.x9o,b);Yb.lhg=!0;b.wI=!0;return Yb}if((!B||B===Qa)&&0<r.length&&B<r.length){P.push(Oz.a.instance.awf(r,B));var Wc=this.lgi(h);if(0<=ra&&!B&&Wc){b.wordCount+=1;Yb.RTb+=1;const Id=this.Jd.gY(Wc);Wc=this.cG.O1c(Id,Wc);Wc=br.jJd(Wc);b.n8+=Wc.ODa+1;b.m8+=Wc.ODa-Wc.Hpc}}Wc=this.Mki(r,B,br.ZXk);B=Wc.cp;let id;Mc=(id=Mc).concat.apply(id,Wc.Jpc);ca+=Wc.n8;fc+=Wc.m8}while(-1!==B);b=this.yqk(b,P,Mc,r,mb,Yb.RTb,Yb.eGd,Yb.fGd,h,-1===ra,Jb);Yb.RTb=b.wordCount;Yb.eGd=
b.m8;Yb.fGd=b.n8;Yb.W8o=b.OLj;return Yb}vUh(b,h){const r=Td.ParagraphReader.textLength(h,9);if(r){h=xo.e(h);var B=0;for(let P=0;P<h.length;P++)if(this.xkb&&5===h[P].vh&&b.HJ++,br.gso(h[P])){B++;break}h.length!==r?b.fS++:b.fS+=B}}Cqj(b){this.DBd=this.Hso(b.e0a,b.wordCount)?1:0;return!!this.DBd}PZi(b){this.Wjd=b.wordCount;this.bye=b.HJ;this.mye=b.X$;this.Yxe=b.n8;this.Xxe=b.m8;this.gye=b.fS;this.HRg=b.zsb;this.zRg=b.p5a;this.D7i(b)}D7i(b){this.sa.raiseEvent(br.aqe,new lL(b))}C7i(){this.sa.raiseEvent(br.Hsg,
new jL(!1))}Hso(b,h){if(ba.a.ht||ba.a.Nt||ba.a.WG)return!1;(h/=2)||(h=1);return(h?b/h:0)>br.Bbn?!0:!1}get xkb(){const b=!this.gPf||1===this.gPf&&this.Yik;return this.RXa&&b}Xci(b,h){let r=1033,B=0;b=h.msf(b);h=new dg;for(let P=0;P<b.length;P++){const ca=h.ysk(b[P].lcid,b[P].end-b[P].Bc);B<ca&&(B=ca,r=b[P].lcid)}return r}yqk(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){var fc;h=(fc=h).concat.apply(fc,r);r=Oz.a.instance.Oki(h,B);b.wordCount+=r.wordCount;P=br.jJd(P);fc=P.ODa-P.Hpc;const Mc=P.ODa;b.m8+=fc;b.n8+=Mc;ca+=
r.wordCount;ra+=P.ODa-P.Hpc;Qa+=P.ODa;b.e0a+=r.e0a;const {cul:Wc,TMo:id}=br.xqk(h,B);b.vEb+=Wc;b.uEb+=id;b.p5a.add(Yb);b.zsb.add(r.wordCount);Jb&&br.RQk(Mc,fc,mb,r,Wc,id,Yb);b.cp=0;b.P0f=[];b=new oL;b.m8=ra;b.n8=Qa;b.wordCount=ca;b.OLj=r.wordCount;return b}oNl(b,h){let r=this.F4n(b);r=Td.ParagraphReader.pib(b,9,r,h);return this.U_n(r)}F4n(b){var h=Td.ParagraphReader.text(b);b=xo.e(b);if(0<b.length){h=h.split("");for(let B=0;B<b.length;++B){let P=!0;var r=!0;const ca=b[B];if(1===ca.vh)r=ca,r=22!==
r.kind&&2!==r.kind;else if(5===ca.vh)P=!1;else if(7===ca.vh||10===ca.vh)h[ca.Lb.cp]=this.$3j,P=!1;if(P){if(ca.Lb.cp>=h.length)return"";h[ca.Lb.cp]=r?" ":"C"}}h=h.join("")}return h}U_n(b){return b.replace(this.k2j,"")}Mki(b,h,r){const B=b.length-h<=r;var P=B?b.length:h+r;const ca=new nL;if(P<h)return ca.cp=-1,ca;ca.Jpc=Oz.a.instance.Yof(b,h,P);P=br.jJd(b.substr(h,P));ca.n8=P.ODa;ca.m8=P.ODa-P.Hpc;if(!ca.Jpc.length&&!B)return r===b.length-h?ca:this.Mki(b,h,b.length-h);ca.cp=B||!ca.Jpc.length?-1:ca.Jpc[ca.Jpc.length-
1].cp;return ca}Uwk(b){this.HAb=b;this.taskManager.Wb(this.HAb)}lgi(b){if(b=b.ND){const h=this.Jd.gY(b);if(h&&h.Mz)return b}return null}static gso(b){return 11===b.vh}static H0o(b,h){b.wordCount+=h.wordCount;b.m8+=h.pDh;b.n8+=h.qDh;b.e0a+=h.Tyh;b.vEb+=h.vEb;b.uEb+=h.uEb;b.p5a.add(h.X0i);b.zsb.add(h.wordCount)}static RQk(b,h,r,B,P,ca,ra){const Qa=new kL;Qa.wordCount=B.wordCount;Qa.qDh=b;Qa.pDh=h;Qa.Tyh=B.e0a;Qa.vEb=P;Qa.uEb=ca;Qa.X0i=ra;r.$ed=Qa}static jJd(b){const h=b.length,r=new mL;for(let P=0;P<
h;P++){var B=b.charCodeAt(P);r.ODa++;if(55296<=B&&56319>=B&&(B=P+1<h?b.charCodeAt(P+1):0,56320<=B&&57343>=B)){P++;continue}E.a.qda(b.charAt(P))&&r.Hpc++}return r}static xqk(b,h){let r=0,B=0;for(let P=0;P<b.length;++P){const ca=b[P],ra=ca.VL;(3===ra||2===ra)&&ca.cp<h.length&&(++r,E.a.Mcc(h.charCodeAt(ca.cp))&&++B)}return{cul:B,TMo:r}}}br.aqe="wctek";br.Hsg="wcac";br.x9o=1;br.ZXk=400;br.U5o=90;br.Bbn=.1;Object(n.a)(br,"WordCountManagerBase",null,[628]);class pL extends br{constructor(b,h,r,B,P,ca,ra,
Qa,mb,Jb,Yb){super(b,h,r,P,mb,Jb);this.K2h=this.Ryd=this.vma=null;this.Aqa=()=>{this.Bef()};this.hb=B;this.Ad=ra;this.ajh=Qa;this.OI=Yb;this.hb.Xw(this.Aqa);this.qHe=mb.$("ReadingTimeIsEnabled")}get Qyj(){return 66}ACm(){if(this.vma)return!0;if(!this.hb||!this.hb.ib)return this.Ad&&(qe.App.EZd||v.AFrameworkApplication.Qk?this.Ad.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.Ad.Yb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.hb.ib.clone();this.vma=b.GO(!0);if(!this.vma||!this.vma.bZ())return this.gLd(),!1;this.ajh&&(this.Ryd=this.ajh.create(h=>b.GO(h),this.sm));this.vma.moveNext();return!0}get gPf(){return 1}M6k(b){return b===zc.a.Fd||b===zc.a.paragraph?!0:this.xkb&&(b===zc.a.pFb||b===zc.a.image||b===zc.a.W7)}Rgf(b){this.u_a.reset();if(this.ACm()){for(this.xkb&&this.Ryd&&(this.Ryd.Vrl(b,this.u_a)||this.Dke(1,b));this.vma.current;){const B=-1===b.JX?0:b.JX;let P=0;var h=this.vma.current;if(!this.M6k(h.contextId)){this.vma.moveNext();
continue}if(this.xkb&&ye.ImageReader.j4a(h)){b.HJ++;this.vma.moveNext();continue}if(!Td.ParagraphReader.Xb(h.node)){this.vma.moveNext();continue}const ca=h.node;if(this.qPa&&this.K2h&&this.K2h.K2a(ca))this.vma.moveNext();else{if(this.xkb&&h.isValid){var r=xd.GraphIterator.eb(ca);for(r.Tb(6);!r.Zr;)ye.ImageReader.Mt(r.currentNode)&&b.HJ++,r.Ri(6)}r=this.qHe?this.Xci(ca,this.OI):1033;h=this.RIj(b,ca,0,0,0,this.B_d(h),B,h.cpBegin,h.cpEnd,r);if(h.JEi&&(P+=1,100<P)){b.JX=B+1;this.Dke(1,b);return}if(h.lhg)return;
this.vUh(b,ca);this.vma.moveNext()}}this.Ryd=this.vma=null;this.Cqj(b)?(this.Wjd=-1,this.C7i()):this.PZi(b)}}B_d(b){let h=!1;b.contextId===zc.a.paragraph?h=!0:b.contextId===zc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(n.a)(pL,"SelectionWordCountManager",br,[]);class VG{constructor(b,h){this.oYb=!1;this.Rzb=null;b&&h&&(this.a1b=b(!1),this.Yc=h,this.a1b.moveNext())}Vrl(b,h){if(!b||!this.a1b||!this.a1b.current)return!0;do{const r=this.a1b.current;if(r.contextId===zc.a.gy||
r.contextId===zc.a.Jw){for(this.Rzb||this.JCm(r.node);this.Rzb.moveNext();)if(14===this.Rzb.currentNode.type&&b.X$++,h.update(),h.nnb())return!1;this.l9k(r,b);this.Rzb=null}this.a1b.moveNext()}while(this.a1b.current);return!0}l9k(b,h){const r=this.Yc.Rf(b.node);r.zb(14);b.contextId===zc.a.gy&&(Al.a.Byi(r)&&(this.oYb=!0),Al.a.b0d(r)&&this.oYb&&(this.oYb=!1,h.X$++));b.contextId===zc.a.Jw&&(qh.TableCellReader.JWc(r)&&(this.oYb=!0),qh.TableCellReader.HRa(r)&&this.oYb&&(this.oYb=!1,h.X$++))}JCm(b){this.Rzb=
qc.a.gp(b);14===b.type?this.Rzb.xo(VG.rOc,b):this.Rzb.xo(VG.rOc,null)}static rOc(b){return b.parentNode?!0:!1}}Object(n.a)(VG,"TableCountSelectionTraverser",null,[629]);class qL{constructor(b){this.RXa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.RXa?new VG(b,h):null}}Object(n.a)(qL,"TableCountSelectionTraverserFactory",null,[618]);class rL extends br{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb){super(b,h,r,P,mb,Jb);this.W5o=fc=>{if(fc.Zr)return!0;fc=fc.role;return 1===
fc||2===fc||this.xkb&&6===fc||3===fc||4===fc||5===fc||!this.qPa&&(7===fc||8===fc)};this.ga=B;this.Sek=ca;this.Knk=ra;this.gRg=Qa;this.OI=Yb;this.ga.fb(V.a.MLj,zc.a.application,nd.ActionManager.Nf,64);this.ga.fb(V.a.NLj,zc.a.application,nd.ActionManager.Nf,64);this.qHe=mb.$("ReadingTimeIsEnabled")}get Qyj(){return 63}get gPf(){return 0}Rgf(b){this.u_a.reset();b.wI=!1;var h=this.Sek();Qh.PageReader.instance.KJb(h)||(this.hLd(),this.C7i());h=this.sm.Joa(h,7,7).currentNode;var r=this.dcl(b.currentNode,
h);h=this.Knk(r,h);h.xo(this.W5o,null);let B=r=0;for(var P=0;h.moveNext();)if(h.currentNode&&this.Jd.hda(h.currentNode)){var ca=this.Jd.gY(h.currentNode);if(ca.Mz){var ra=this.Jd.JGb(h.currentNode);if(ra&&(ra=ra.ra.last,(null===ra||void 0===ra?0:ra.Ph)&&(Jk.App.M1&&ra.Lh||ra.NR)))continue;b.wordCount+=1;if(ca=this.cG.O1c(ca,h.currentNode))ca=br.jJd(ca),b.n8+=ca.ODa+1,b.m8+=ca.ODa-ca.Hpc;r+=1;B+=b.n8;P+=b.m8}}else if(this.xkb&&h.currentNode&&ye.ImageReader.Mt(h.currentNode))b.HJ++;else if(this.xkb&&
h.currentNode&&mi.TableReader.LR(h.currentNode))b.X$++;else if(h.currentNode&&Td.ParagraphReader.Xb(h.currentNode)){ca=h.currentNode;ra=this.qHe?this.Xci(ca,this.OI):1033;P=this.RIj(b,ca,r,B,P,!0,-1,-1,-1,ra);if(P.lhg){b.wI=!0;v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.vUh(b,ca);r=P.RTb;B=P.fGd;P=P.eGd}this.Cqj(b)?(this.hLd(),this.x5n(),this.D7i(b)):this.PZi(b)}dcl(b,h){b?(b=this.gRg(b),b.zb(7)):b=this.gRg(h);
return b}x5n(){switch(this.DBd){case 1:this.ga.processAction(V.a.MLj,2);break;case 2:this.ga.processAction(V.a.NLj,2)}}}Object(n.a)(rL,"TotalWordCountManager",br,[]);class sL{constructor(){this.vjj=this.ujj=this.ocg=this.wjj=this.VAj=this.WAj=this.TAj=this.UAj=0}get bTi(){return this.n$b(this.wjj,this.WAj,"WC")}get Mjn(){return this.n$b(this.ujj,this.TAj,"NumCharsNoSp")}get Njn(){return this.n$b(this.ocg,this.UAj,"NumCharsWithSp")}get Sjn(){return this.n$b(this.vjj,this.VAj,"NumParagraphs")}n$b(b,
h,r){const B=this.Ged(h,r).toLocaleString();return 0<this.ocg?(b=this.Krg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),B)):B}Krg(b,h,r){b=this.Ged(b,r);return b>h?(t.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}Ged(b,h){0>b&&t.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(n.a)(sL,"DocumentStats",null,[]);class WG{static pbf(b){return Pf.a.Nx(WG.Wm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.bTi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.Mjn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.Njn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.Sjn)}}WG.Wm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(n.a)(WG,"DocumentStatsDialogHtml",null,[]);class tL extends Pf.a{constructor(b){super();this.ZS=!1;this.Esl=()=>{};this.gG=b}cxo(){this.zg="DocumentStatsDialog";this.Vg=WG.pbf(this.gG);this.Cd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.Esl);this.M5("DocumentStatsTable")}V9(){}dispose(){this.ZS||(super.dispose(),this.ZS=!0)}}Object(n.a)(tL,"DocumentStatsDialog",Pf.a,[]);class uL{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.bih=this.nwc=this.Cuc=this.nYb=this.pIe=
!1;this.Ahc=()=>{this.Zoe()};this.Mda=()=>{this.Zoe()};this.Noo=()=>{this.bih=!0;return 32};this.z5f=()=>this.Ds.fSa?32:8;this.W5c=(Jb,Yb,fc,Mc,Wc)=>{if(1===fc)return this.Ds.fSa?32:8;Wc[Df.a.On]=this.xJf;return 32};this.Gme=(Jb,Yb,fc)=>{if(1===fc)return this.Ds.fSa?32:8;this.xJf?this.tpl():this.$vl();ab.StaticActiveAppFrame.za().lH({ShowWordCount:"CheckboxModel"});return 32};this.rmc=(Jb,Yb,fc)=>{if(1===fc)return $i.a.via(Yb)?8:this.Ds.fSa?32:8;if(this.bih)return v.AFrameworkApplication.va.processAction(V.a.z9d,
2),32;Jb=this.je.Yf("UserAction","Show Word Count Dialog");Jb.start();this.Ds.gbd();this.GQ.gbd();this.Ds.Lx!==this.GQ.Lx?t.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):t.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Yb=this.xal();(new tL(Yb)).cxo();Jb.stop();return 32};this.i5c=(Jb,Yb,fc,Mc,Wc)=>{Wc||t.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===fc)return 32;if(!this.Ds.fSa)return Wc[mm.a.Visible]=
!1,32;Wc[mm.a.Visible]=!0;this.xJf?(Jb=this.Ds.Lx,0>Jb?Jb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Jb?(Yb=this.GQ?this.GQ.Lx:-1,Jb=0<Yb?this.rem(Jb,Yb):String.format(1===Jb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.Ife(Jb))):Jb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.Ife(Jb))):Jb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Wc[mm.a.LabelText]=Jb;return 32};
this.Fxe=ra;this.Gxe=ca;this.Ds=b;this.GQ=h;this.WDc=r;this.xlk=P;this.GQ.S0e(this.Ahc);this.Ds.S0e(this.Ahc);this.GQ.dfb(this.Mda);this.Ds.dfb(this.Mda);this.je=Qa;this.qPa=B;this.RXa=mb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get oef(){return!ba.a.W4}Ub(){const b=v.AFrameworkApplication.va;b.qa(V.a.Gme,zc.a.application,this.Gme);b.qa(V.a.rmc,zc.a.view,this.rmc);b.fb(V.a.W5c,zc.a.application,this.W5c,96);b.fb(V.a.i5c,zc.a.application,this.i5c,96);b.fb(V.a.z5f,zc.a.application,
this.z5f,96);b.qa(V.a.SWh,zc.a.application,this.Noo)}get qPa(){return this.Cuc}set qPa(b){this.Cuc=b;this.Ds.qPa=b;this.GQ.qPa=b}$vl(){this.Ds.fSa&&(this.npj(!0),this.Zoe(),this.Ds.gbd())}xal(){const b=new sL;b.WAj=this.Ds.Lx;b.UAj=this.Ds.s6b;b.TAj=this.Ds.mLc;b.VAj=this.Ds.pLc;b.wjj=this.GQ.Lx;b.ujj=this.GQ.mLc;b.ocg=this.GQ.s6b;b.vjj=this.GQ.pLc;return b}vXl(){return this.Fxe("WACWordCountEnabled",this.oef)}ahe(b){this.Gxe("WACWordCountEnabled",b?"true":"false",Gc.a.pHa)}get xJf(){this.nYb||(this.pIe=
this.vXl(),this.nYb=!0);return this.pIe}npj(b){this.ahe(b);this.pIe=b;this.nYb=!0}tpl(){this.Ds.hLd();this.GQ.hLd();this.npj(!1);this.Zoe()}get eK(){return null!=this.xHg?this.xHg:this.xHg=(()=>this.WDc())()}Zoe(){this.nwc||(t.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.Ggl()),this.nwc=!0);this.eK&&this.eK.pV(this.xlk)}Ggl(){const b={["words"]:this.Ds.Lx,["charsWithSpaces"]:this.Ds.s6b,["charsWithNoSpaces"]:this.Ds.mLc,["paragraphs"]:this.Ds.pLc};this.RXa&&(b.images=this.Ds.HDb,
b.tables=this.Ds.LDb);return b}Ife(b){try{return b.toLocaleString()}catch(h){t.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}rem(b,h){h>b&&(t.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.Ife(h),this.Ife(b))}}Object(n.a)(uL,"WordCountActor",
null,[]);class vL extends Gs.a{constructor(b,h,r,B){super();this.IP=(P,ca)=>{if(ca.property===Pe.a.ho||ca.property===Pe.a.Rn)P=ca.node,ca=Jk.App.pn.jb.rc,ca.ov&&ca.ed&&ca.ed.Mc&&P.Mc&&P.Mc.id===ca.ed.Mc.id&&this.bYh(P)};this.pXi=(P,ca)=>{this.bYh(ca.node)};this.Xrn=(P,ca)=>{ca.property!==Zc.a.MA&&ca.property!==Oc.a.Ot||this.TY()};this.A7d=()=>{this.TY()};this.d3=b;this.Ds=h;this.wq=r;this.RXa=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Qz(){var b=this.wq.Te(12);b.qo(this.IP);b.ku(this.pXi);
b.kw(this.pXi);b=this.wq.Te(22);b.qo(this.Xrn);b.ku(this.A7d);b.kw(this.A7d);this.RXa&&this.DXn();this.d3.pra(this,7)}DXn(){var b=[19,14];for(const h of b)b=this.wq.Te(h),b.ku(this.A7d),b.kw(this.A7d)}get index(){return 1}run(){this.Ds.Bef()}bYh(b){b.$ed=null;this.TY()}}Object(n.a)(vL,"WordCountAppEventCoordinator",Gs.a,[]);class QH{}QH.zqk="AccurateWordCountButton";Object(n.a)(QH,"WordCountConstants",null,[]);class wL{constructor(b,h){this.Ds=b;this.GQ=h}getInstance(b){switch(b){case 1:return this.GQ;
case 0:return this.Ds;default:return this.Ds}}}Object(n.a)(wL,"WordCountManagerFactory",null,[320]);class RH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}wc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new qL(h)).ha();this.W.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new Eq.a(10,Qd.a.$e);const B=new rL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Tl.a,v.AFrameworkApplication.va,v.AFrameworkApplication.lc,()=>Jk.App.pn.jb.rc.ed,qc.a.Gs,xd.GraphIterator.eb,h,r,Ya.a.instance.resolve("Box4.ILanguageReader"));r=new pL(Ya.a.instance.resolve("Box4.List.IListReader"),Ya.a.instance.resolve("Box4.IListMarkerUtility"),new Tl.a,lh.a.instance,v.AFrameworkApplication.lc,Zy.a.instance,Ih.a.instance,Ya.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Ya.a.instance.resolve("Box4.ILanguageReader"));return new wL(B,r)}).ha();
this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new hL(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=ab.StaticActiveAppFrame.za().jb;b.Cxa?this.oka():b.vga(()=>{this.oka()})}oka(){if(qe.App.li){var b=qe.App.li.Al;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
B=Ya.a.instance.resolve("Common.IAppSettingsManager");(new uL(h,r,()=>Ya.a.instance.Oa("WordEditor.IStatusBarUser"),this.xWl(),QH.zqk,Gc.a.ZIa,Gc.a.tca,Ya.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),B)).Ub();(new vL(Lk.GraphTransactionManager.instance,h,b,B)).Qz();h.Bef()}else t.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else t.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}xWl(){var b=
Jk.App.pn.jb;if(!b)return t.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.rc;if(!b)return t.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ed;return b?b.ja(Oc.a.qPa,!1):(t.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){L.a.instance.Gc(new RH)}}Object(n.a)(RH,"PackageManager",null,[1,2]);var rN=c(2072);class xL{constructor(b){this.fSe=null;b.Sa("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.fSe=h})}Klj(b){this.fSe&&this.fSe.Nrf().handleDocumentContentAugloopAnnotation(b)}}
Object(n.a)(xL,"DocumentContentExtractionManager",null,[480]);class Mh{}Mh.WAo="mso_smartLookup";Mh.channelId="SmartLookup";Mh.VAo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Mh.Juj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Mh.Kuj="https://uci.cdn.office.net/mirrored/smartlookup/";Mh.UAo="https://hedwigtestserver.blob.core.windows.net/builds/";Mh.TAo="http://localhost:8080/";Mh.Iad="current";Mh.Iuj="next";Mh.uAn=2;Mh.Rhc=1;Mh.Shc=CommonUIStrings.L_SmartLookupPaneTitle;
Mh.lC="InsightsTaskPane";Mh.Mlg="InsightsTaskPaneData";Mh.GAf="InsightsContentFrame";Mh.width=400;Mh.aen="ApplicationPropertiesRequest";Mh.men="SelectionRequest";Mh.gen="PageRendered";Mh.$dn="ApplicationProperties";Mh.ken="Selection";Mh.oen="Telemetry";Mh.nen="TakeFocus";Mh.fen="LostFocus";Mh.cen="Keyboard";Mh.den="LegalAgreed";Mh.S8o="WordWac";Mh.hxn="OneNoteWAC";Mh.q0f="yes";Mh.bzj="appCorrelationId";Mh.AJo="clientCorrelationId";Mh.czj="message";Mh.pHi="Microsoft::Office::Insights::LegalAgreed";
Object(n.a)(Mh,"InsightsConstants",null,[]);var YF=c(1642);class $E{}Object(n.a)($E,"ActivityContractInfo",null,[]);class Kt{}Object(n.a)(Kt,"BrowserPaneDataField",null,[]);class aF{}Object(n.a)(aF,"BrowserPaneTelemetryEvent",null,[]);class im{static Uz(b,h){const r=new aF;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new $E,{success:!0});const B=[],P=new Kt;P.name="Message";P.dataType=0;P.value=b;b=new Kt;b.name="Level";b.dataType=0;b.value=im.getLevelString(h);Array.add(B,
P);Array.add(B,b);r.dataFields=B;im.sendTelemetryEvent(r)}static Ojj(b,h){const r=new aF;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new $E,{success:!0});b=[];const B=new Kt;B.name="AppCorrelationId";B.dataType=0;B.value=h;Array.add(b,B);r.dataFields=b;im.sendTelemetryEvent(r)}static Seo(b,h,r,B,P,ca){const ra=new aF;ra.eventName="LaunchPaneWithError";ra.isActivity=!1;ra.activityContract=Object.assign(new $E,{success:!0});const Qa=[],mb=new Kt;mb.name="IsNetworkConnected";mb.dataType=
0;mb.value=b?"true":"false";b=new Kt;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Kt;h.name="EntryPoint";h.dataType=0;h.value=r;r=new Kt;r.name="RuntimeVersion";r.dataType=0;r.value=B;B=new Kt;B.name="IsFirstRelease";B.dataType=1;B.value=P?"true":"false";P=new Kt;P.name="IsZeroTerm";P.dataType=1;P.value=ca?"true":"false";ca=new Kt;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Qa,mb);Array.add(Qa,h);Array.add(Qa,b);Array.add(Qa,r);Array.add(Qa,
B);Array.add(Qa,P);Array.add(Qa,ca);ra.dataFields=Qa;im.sendTelemetryEvent(ra)}static rcg(b,h,r){const B=new aF;B.eventName="CDNDownloadLatency";B.isActivity=!0;B.activityContract=Object.assign(new $E,{duration:r,success:!0});r=[];const P=new Kt;P.name="CDNHostname";P.dataType=0;P.value=b;b=new Kt;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,P);Array.add(r,b);B.dataFields=r;im.sendTelemetryEvent(B,1)}static Qkc(b,h,r,B,P,ca,ra,Qa){const mb=new aF;mb.eventName="LaunchPane";mb.isActivity=!0;
mb.activityContract=Object.assign(new $E,{duration:h,success:!0});h=[];const Jb=new Kt;Jb.name="AppCorrelationId";Jb.dataType=0;Jb.value=b;b=new Kt;b.name="EntryPoint";b.dataType=0;b.value=r;r=new Kt;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const Yb=new Kt;Yb.name="UxVersion";Yb.dataType=0;Yb.value=B;B=new Kt;B.name="FeatureGates";B.dataType=0;B.value=P;P=new Kt;P.name="IsFirstRelease";P.dataType=1;P.value=ca?"true":"false";ca=new Kt;ca.name="IsZeroTerm";ca.dataType=1;ca.value=ra?
"true":"false";ra=new Kt;ra.name="IsClientSideRendering";ra.dataType=1;ra.value=Qa?"true":"false";Array.add(h,Jb);Array.add(h,b);Array.add(h,r);Array.add(h,Yb);Array.add(h,B);Array.add(h,P);Array.add(h,ca);Array.add(h,ra);mb.dataFields=h;im.sendTelemetryEvent(mb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)im.P5m(b.eventName);else{var r=-1<b.eventName.indexOf(im.azj)?b.eventName:im.azj+b.eventName,B=im.xVl(b.dataFields);b.isActivity?(b=Object.assign(new Rj.a,{name:r,samplingPolicy:h,
dataFields:B,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),oa.a.sendActivityEvent(b)):(b=Object.assign(new ea.a,{name:r,samplingPolicy:h,dataFields:B}),oa.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static xVl(b){const h=[];if(b&&0<b.length)for(const r of b)(b=sh.a.b9(r.name,r.value,im.h8k(r.dataType)))&&Array.add(h,b);return h}static h8k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static P5m(b){const h=Ya.a.instance.Oa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):t.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}im.azj="Office.Insights.SmartLookup.";Object(n.a)(im,"TelemetryUtils",null,[]);var bF;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(bF||(bF={}));Object(n.b)("EntryPoint",bF);var Lt=c(1569),Ix=c(1583);class xv{static zY(b,h,r,B,P,ca){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;if(P.value.Dvo())return im.Uz("Skipping Serplet launch",10),32;h=ca;if(!h)return 8;b=xv.NFb();if(r=h.CommandValueId)try{h=I.a(r)}catch(ra){return t.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Lt.a,{selection:h}):
(h=P.value.uGb(),r.selection=Object.assign(new Ix.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=P.value.kbi();return xv.o8b(ca,null,r,b,0,P)}static o8b(b,h,r,B,P,ca){const ra={};ra.controlId=b?b.SourceControlId:"shortcut";r&&(ra.entryPoint=bF[r.entryPoint]);t.ULS.sendTraceTag(594044172,1303,50,xv.tU("Show insights",B,ra));h?ca.value.Xxo(h,B,P):r&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.qwo(r,B):ca.value.Yxo(r,B,P));return 32}static tU(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(let B in r)b[B]=r[B];return I.c(b)}static NFb(){return Lb.a.create().toString()}}Object(n.a)(xv,"InvokingPaneUtils",null,[]);class yL{}Object(n.a)(yL,"LaunchDataInDoc",null,[]);class zL{}Object(n.a)(zL,"LaunchDataPasteAsSlide",null,[]);class AL{}Object(n.a)(AL,"LaunchDataSlidesCompression",null,[]);var ou=c(1559);class SH{constructor(b,h,r,B,P,ca,ra,Qa,mb){this.Euc=this.Ind=
this.$v=null;this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.np=r;this.Vb=B;this.c3g=Qa;this.kAc=P;this.Ca=ca;this.Ib=ra;this.FBm();this.LXa=new zf.a(()=>new jk.a(mb.value,Object(z.a)(this,this.LGb,"getMoreInfoEventReceived")))}Ub(){this.ga.qa(eb.a.OFm,Gd.a.frame,Object(z.a)(this,this.Vxo,"showInsights"));this.ga.qa(eb.a.PFm,Gd.a.frame,Object(z.a)(this,this.Wxo,"showInsightsForTellMe"));this.ga.qa(eb.a.definitions,Gd.a.frame,Object(z.a)(this,this.Two,"showDefinitions"));this.ga.qa(eb.a.yef,Gd.a.frame,
Object(z.a)(this,this.Uwo,"showDefinitionsForTellMe"));this.ga.qa(eb.a.Jhg,Gd.a.frame,Object(z.a)(this,this.Jhg,"showInsightsForSuggestion"));this.c3g&&(this.ga.qa(eb.a.q9,Gd.a.frame,Object(z.a)(this,this.zY,"invokeSmartLookupPane")),this.ga.qa(eb.a.UVc,Gd.a.frame,Object(z.a)(this,this.UVc,"invokeInDocSerplet")),this.ga.qa(eb.a.WVc,Gd.a.frame,Object(z.a)(this,this.WVc,"invokeSerpletRibbon")),this.ga.qa(eb.a.VVc,Gd.a.frame,Object(z.a)(this,this.VVc,"invokeSerpletContextMenu")),this.ga.qa(eb.a.GDf,
Gd.a.frame,Object(z.a)(this,this.GDf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(eb.a.FDf,Gd.a.frame,Object(z.a)(this,this.FDf,"invokeSerpletTellMeNotes")),this.ga.qa(eb.a.YYd,Gd.a.frame,Object(z.a)(this,this.YYd,"invokeImageSerpletContextMenu")),this.ga.qa(eb.a.bZd,Gd.a.frame,Object(z.a)(this,this.bZd,"invokeSynonymsSerpletContextMenu")),this.ga.qa(eb.a.XYd,Gd.a.frame,Object(z.a)(this,this.XYd,"invokeDictionarySerpletContextMenu")),this.ga.qa(eb.a.dZd,Gd.a.frame,Object(z.a)(this,this.dZd,"invokeZeroTermSerpletContextMenu")),
this.ga.qa(eb.a.WYd,Gd.a.frame,Object(z.a)(this,this.WYd,"invokeDefinitionSearchFromFloatie")),this.ga.qa(eb.a.aZd,Gd.a.frame,Object(z.a)(this,this.aZd,"invokeSerpletBrowseFiles")),this.ga.qa(eb.a.ZYd,Gd.a.frame,Object(z.a)(this,this.ZYd,"invokeInDocSerpletWithLaunchData")),this.ga.qa(eb.a.vce,Gd.a.frame,Object(z.a)(this,this.vce,"queryToggleSerplet")),this.ga.qa(eb.a.phe,Gd.a.frame,Object(z.a)(this,this.phe,"setInDocSearchParameter")),this.ga.qa(eb.a.EDf,Gd.a.frame,Object(z.a)(this,this.EDf,"invokeSerpletSlidesCompression")),
this.ga.qa(eb.a.DDf,Gd.a.frame,Object(z.a)(this,this.DDf,"invokeSerpletPasteAsNewSlide")),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.qa(eb.a.ivi,Gd.a.frame,Object(z.a)(this,this.JHm,"invokeSmartLookupPaneConversations")),this.ga.qa(eb.a.UYd,Gd.a.frame,Object(z.a)(this,this.UYd,"invokeAutoLaunchSearchRequest"))),this.lWn().continueWith(()=>{v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.updateCommandUI(!0)}))}Zoh(){this.ga.fb(eb.a.BGa,
Gd.a.frame,Object(z.a)(this,this.BGa,"invokeFilesSerplet"),4);this.ga.fb(eb.a.xDf,Gd.a.frame,Object(z.a)(this,this.BGa,"invokeFilesSerplet"),4);this.ga.fb(eb.a.cvi,Gd.a.frame,Object(z.a)(this,this.yHm,"invokeLinkFilesSerplet"),4);if(this.Ca.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ca.$("SmartLookupTokenPrefetchIsEnabled")){const b=Oe.a.A8(0,Object(z.a)(this,this.O3i,"prefetchToken"),0,177);this.Ib.Wb(b)}}a0e(){rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.qa(eb.a.BGa,Gd.a.frame,Object(z.a)(this,this.yDf,"invokeFilesSerpletUnavailable")),this.ga.qa(eb.a.xDf,Gd.a.frame,Object(z.a)(this,this.yDf,"invokeFilesSerpletUnavailable")),this.ga.qa(eb.a.cvi,Gd.a.frame,Object(z.a)(this,this.yDf,"invokeFilesSerpletUnavailable")))}O3i(b){t.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Coc().then(h=>{let r=1;if(h)t.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.Kcg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ca.nc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{t.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.Kcg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Ca.nc("SmartLookupTokenRenewalRetryThreshold",5)){t.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.Kcg("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Ca.nc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new Oe.a(3,1,h,Object(z.a)(this,this.O3i,"prefetchToken"),177);h.data=r.toString();this.Ib.Wb(h)})}Kcg(b="",h=!1){this.kAc.execute(r=>{r&&r.Okc("PrefetchToken",h,0,"SmartLookup",b)})}Coc(){return this.kAc?new Promise(b=>{this.kAc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(B=>{b(!!B&&0<B.length);h.Okc("TryGetTokenInternal",!!B&&0<B.length,Date.now()-
r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}lWn(){const b=new jg.a;if(this.Ca.$("BrowserSupportsInsightsPaneSSO"))this.Zoh(),b.Dg(!0);else{if(!this.kAc)return t.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Dg(!1),this.a0e(),b.task;this.kAc.execute(h=>{h?h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(r=>{t.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.Zoh(),b.Dg(!0)):this.a0e()}):(t.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Dg(!1),this.a0e())})}return b.task}Vxo(b,h,r,B,P){if(1===r)return v.AFrameworkApplication.ta&&v.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.gKc?8:this.vC.value.Bzi()?32:8;b=xv.NFb();h=this.vC.value.uGb();return this.c3g?(h=Object.assign(new Ix.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Lt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new ou.a,
{landingTab:"All"})}),xv.o8b(P,null,h,b,0,this.vC)):xv.o8b(P,h,null,b,0,this.vC)}Two(b,h,r,B,P){if(1===r)return this.vC.value.Bzi()?32:8;b=xv.NFb();h=this.vC.value.uGb();return xv.o8b(P,h,null,b,1,this.vC)}Wxo(b,h,r,B,P){return 1===r?32:this.nZh(P,0)}Uwo(b,h,r,B,P){return 1===r?32:this.nZh(P,1)}nZh(b,h){const r=xv.NFb(),B=b.CommandValueId;let P;try{P=I.a(B)}catch(ca){return t.ULS.sendTraceTag(6295941,1303,15,xv.tU(String.format("Insights parameters [{0}] is not in proper format.",B),r)),8}return xv.o8b(b,
P,null,r,h,this.vC)}Jhg(b,h,r,B,P){if(1===r)return 32;if(!P)return 8;b=P.query?P.query:"";h=xv.NFb();r=new YF.a;r.neighborhood=b;r.mentionStart=0;r.mentionLength=b.length;return xv.o8b(P,r,null,h,0,this.vC)}yHm(b,h,r,B){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;const P=v.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.vC.value.R2a();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new ou.a,{landingTab:"File"}),entryPoint:P?32:10}))}BGa(b,h,r,B){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;const P=v.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.vC.value.R2a();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ou.a,{landingTab:P?"Slide":"File"}),entryPoint:P?20:10}))}yDf(){return 2}UVc(b,h,r,B,P){if(1===
r)return gc.SessionStatusManager.instance.Yj?8:32;const ca=this.vC.value.R2a();P=void 0===P||null===P?18:19;return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new ou.a,{landingTab:"Indoc"}),entryPoint:P}))}ZYd(b,h,r,B,P){P=P.CommandValueId;if(!P||P&&this.Euc&&P.query===this.Euc.query&&P.matchCase===this.Euc.matchCase&&P.matchWholeWordOnly===this.Euc.matchWholeWordOnly)return 32;
const ca=this.vC.value.R2a();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new ou.a,{landingTab:"Indoc",data:Object.assign(new yL,{type:4,query:P.query,matchCase:P.matchCase,matchWholeWord:P.matchWholeWordOnly})}),entryPoint:18}))}vce(b,h,r,B,P){P&&(P[Df.a.On]=this.vC.value.LJb);return 32}phe(b,h,r,B,P){if(b=P.CommandValueId)this.Euc=b;return 32}JHm(b,
h,r){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;b=this.vC.value.R2a();b=Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ou.a,{landingTab:"All"})});this.vC.value.D2d(b);return 32}UYd(b,h,r){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;b=this.vC.value.R2a();b=Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new ou.a,{landingTab:"All",data:v.AFrameworkApplication.rEb})});h=xv.NFb();this.vC.value.dQb(b,h);return 32}WVc(b,h,r,B){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;const P=this.vC.value.mbi();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:P.mentionLength}),entryPoint:4,launchData:Object.assign(new ou.a,{landingTab:"All"})}))}VVc(b,
h,r,B){return this.zY(b,h,r,B,Object.assign(new Lt.a,{entryPoint:5,launchData:Object.assign(new ou.a,{landingTab:"All"})}))}GDf(b,h,r,B){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;const P=this.vC.value.R2a();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new ou.a,{landingTab:"All"}),entryPoint:26}))}XYd(b,h,r,B){return 1===r?(b=this.vC.value.uGb())&&0<
b.mentionLength?32:8:this.zY(b,h,r,B,Object.assign(new Lt.a,{entryPoint:22,launchData:Object.assign(new ou.a,{landingTab:"All"})}))}WYd(b,h,r,B){return 1===r?(b=this.vC.value.uGb())&&0<b.mentionLength?32:8:this.zY(b,h,r,B,Object.assign(new Lt.a,{entryPoint:7,launchData:Object.assign(new ou.a,{landingTab:"All"})}))}YYd(b,h,r,B){return this.zY(b,h,r,B,Object.assign(new Lt.a,{launchData:Object.assign(new ou.a,{landingTab:"Image"}),entryPoint:9}))}bZd(b,h,r,B){return this.zY(b,h,r,B,Object.assign(new Lt.a,
{launchData:Object.assign(new ou.a,{landingTab:"All"}),entryPoint:24}))}FDf(b,h,r,B){return this.zY(b,h,r,B,Object.assign(new Lt.a,{launchData:Object.assign(new ou.a,{landingTab:"Notes"}),entryPoint:33}))}dZd(b,h,r,B){if(1===r)return gc.SessionStatusManager.instance.bD?32:8;const P=this.vC.value.R2a();return this.zY(b,h,r,B,Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new ou.a,{landingTab:"All"}),
entryPoint:27}))}EDf(b,h,r,B,P){if(!P)return 8;const ca=P.url;P=P.selectedSlideIDs;return this.zY(b,h,r,B,Object.assign(new Lt.a,{launchData:Object.assign(new ou.a,{landingTab:"All",data:Object.assign(new AL,{type:6,url:ca,selectedSlideIDs:P})}),entryPoint:37}))}DDf(b,h,r,B,P){if(!P)return 8;const ca=P.Selection;P=P.CurrentDocTitle;return this.zY(b,h,r,B,Object.assign(new Lt.a,{launchData:Object.assign(new ou.a,{landingTab:"All",data:Object.assign(new zL,{type:5,selection:ca,currentDocTitle:P})}),
entryPoint:36}))}zY(b,h,r,B,P){return xv.zY(b,h,r,B,this.vC,P)}aZd(b,h,r){if(1===r)return 32;this.$v||this.LXa.value.jP("Browse File from Search pane",!0);if(!this.Ind||""===this.Ind)return t.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Qd.a.vm(this.Ind,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}LGb(b){this.$v||3!==b.state||(this.$v=b,this.Ind=this.$v.Tda)}FBm(){const b=this.Vb.fe(Mh.lC);b.parent=Zd.AFrame.Ap;b.sga(Object(z.a)(this,this.Pkc,
"sendIFrameTakeFocusMessage"));this.np.MT(Mh.lC)}Pkc(){document.activeElement.blur();v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Nlb||(this.vC.value.zjo(),this.vC.value.Qeo())}dispose(){this.vC.value&&this.vC.value.dispose()}}Object(n.a)(SH,"InsightsActor",null,[10]);const TH=b=>{b=b.split("-");return b[b.length-1]},tN=()=>{var b=XG();if(b)return Promise.resolve(b);b=ZF().replace("SearchWeb","searchweb");b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Mh.Iuj+"/":b+Mh.Iad+"/";b+="version.json";if(ba.a.Cpa)return sN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(im.Uz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{im.Uz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=I.b(JSON.stringify(r));
return r.version?r.version:""},r=>{im.Uz("InsightsUtils - Failed to deserialize version: "+r.toString(),10);t.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return im.Uz("InsightsUtils - Failed to download version.json: "+h.toString(),10),t.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},sN=b=>{const h=v.AFrameworkApplication.He;return new Promise(r=>{const B=
new WF.a(b,1,null,null,!0,2,null);h.send(B).hza(P=>{P&&P.data?P.data.te||(im.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+P.data.Ne,10),r("")):(im.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const ca=I.b(P.data.te);ca.version&&r(ca.version)}catch(ca){im.Uz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),r("")}},P=>{P&&P.data?im.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
P.data.Ne,10):im.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},YG=()=>v.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),ZG=()=>{const b=ZF();return YG()||v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+XG()+"/":v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Mh.Iuj:b+Mh.Iad},XG=()=>YG()?"dev":v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.K.kb("SmartLookupClientVersion"),UH=b=>{var h=3===v.AFrameworkApplication.ta.Kb.xk?"wordwac":2===v.AFrameworkApplication.ta.Kb.xk?"pptwac":"excelwac";var r=Hi.a.ug(v.AFrameworkApplication.lcid);const B=r?r.name:"en-us";r=ZF();const P=hD();h="main_ssr_wac.html?appName="+h+"&culture="+B;return"LOCAL"===P?
r+h:r+((""!==b?b:Mh.Iad)+"/")+h},uN=b=>ZF()+(""!==b?b:Mh.Iad)+"/scripts/microsoft.office.smartlookup.host.runtime.js",ZF=()=>{switch(hD()){case "LOCAL":return Mh.TAo;case "PR":const b=v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return Mh.UAo+b[0]+"/";case "INT":return Mh.VAo;case "EDOG":return Mh.Juj;default:return Mh.Kuj}},vN=()=>{if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(hD()){case "EDOG":return Mh.Juj;
case "PROD":return Mh.Kuj;default:return""}},hD=()=>{if(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(YG())return"LOCAL";switch(Object(Na.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=v.AFrameworkApplication.K.kb("UserPrincipalName");b=E.a.eh(b);const h=v.AFrameworkApplication.K.rw("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.EB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},BL=()=>{let b;b=v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":hD();const h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint"),r=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},wN=()=>{const b=hD(),h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class CL{sendTelemetryEvent(b){im.sendTelemetryEvent(b)}}
Object(n.a)(CL,"OtelTelemetrySink",null,[497]);class DL{}Object(n.a)(DL,"ApplicationProperties",null,[]);class EL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(n.a)(EL,"CurrentDocumentProperties",null,[]);class FL{}Object(n.a)(FL,"EnterpriseUserInfo",null,[]);class GL{}Object(n.a)(GL,"FeatureGates",null,[]);class VH{constructor(b,h){this.rv=this.Ki=null;this.Yea="Search";this.bNi=!0;this.wAb=h;this.dv=b;this.dv.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(B=>
{this.bNi=B}).catch(B=>{im.Uz("SearchHelper - Failed to check if Feedback feature is enabled: "+B.toString(),15)})});b=BL();h=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.rv={};const r=this.Bem();if(r&&0<r.length)for(let B=0;B<r.length;B++){const P=r[B],ca=this.Pem(P);switch(ca.toLowerCase()){case "true":this.rv[P]=
!0;break;case "false":this.rv[P]=!1;break;default:this.rv[P]=ca}}this.rv.EnableInDocumentSearch=h;this.rv.EnableInDocumentSearchReplace=!0;this.rv.EnableInDocumentParamLocalSearch=!0;this.rv.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.rv.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.rv.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.rv.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.rv.EnableInDocumentExperiment3=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.rv.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.rv.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.rv.EnableLocalSearch=!0;this.rv.EnableInDocumentStickyFilters=!0;this.rv.IntentServiceEndpoint=b;this.rv.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.rv.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.rv.UXBundleVersion=XG();this.rv.SmartLookupServicePath=ZG();this.rv.EnableAcronymSearch=
!0;this.rv.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.rv.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.rv.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.rv.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.rv.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.rv.ShowDebugInfo="INT"===hD();this.rv.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.rv.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.rv.QnaInMixSection=!0;this.rv.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.rv.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.rv.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.rv.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.rv.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.rv.EnableClientSideRendering=!0}else this.Ki=new GL,this.Ki.EnableInDocumentSearch=h,this.Ki.EnableInDocumentSearchReplace=
!0,this.Ki.EnableInDocumentParamLocalSearch=!0,this.Ki.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ki.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Ki.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ki.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Ki.EnableInDocumentExperiment3=
h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ki.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ki.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ki.EnableLocalSearch=!0,this.Ki.EnableInDocumentStickyFilters=!0,this.Ki.IntentServiceEndpoint=b,this.Ki.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ki.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ki.UXBundleVersion=XG(),this.Ki.SmartLookupServicePath=ZG(),this.Ki.EnableAcronymSearch=
!0,this.Ki.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ki.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ki.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ki.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ki.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ki.ShowDebugInfo="INT"===hD(),this.Ki.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ki.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ki.QnaInMixSection=!0,this.Ki.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ki.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ki.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ki.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ki.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ki.EnableClientSideRendering=!0,this.Ki.SharedSerpletFeatureGate1=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ki.SharedSerpletFeatureGate2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ki.SharedSerpletFeatureGate3=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ki.SharedSerpletFeatureGate4=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ki.SharedSerpletFeatureGate5=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ki.SharedSerpletFeatureGate6=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ki.SharedSerpletFeatureGate7=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ki.SharedSerpletFeatureGate8=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ki.SharedSerpletFeatureGate9=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ki.SharedSerpletFeatureGate10=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ki.SharedSerpletFeatureGate11=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ki.SharedSerpletFeatureGate12=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ki.SharedSerpletFeatureGate13=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ki.SharedSerpletFeatureGate14=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ki.SharedSerpletFeatureGate15=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ki.SharedSerpletFeatureGate16=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ki.SharedSerpletFeatureGate17=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ki.SharedSerpletFeatureGate18=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ki.SharedSerpletFeatureGate19=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ki.SharedSerpletFeatureGate20=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ki.SharedSerpletFeatureGate21=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ki.SharedSerpletFeatureGate22=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ki.SharedSerpletFeatureGate23=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ki.SharedSerpletFeatureGate24=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ki.SharedSerpletFeatureGate25=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ki.SharedSerpletFeatureGate26=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ki.SharedSerpletFeatureGate27=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ki.SharedSerpletFeatureGate28=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ki.SharedSerpletFeatureGate29=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ki.SharedSerpletFeatureGate30=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ki.SharedSerpletFeatureGate31=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ki.SharedSerpletFeatureGate32=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ki.SharedSerpletFeatureGate33=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ki.SharedSerpletFeatureGate34=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ki.SharedSerpletFeatureGate35=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ki.SharedSerpletFeatureGate36=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ki.SharedSerpletFeatureGate37=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ki.SharedSerpletFeatureGate38=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ki.SharedSerpletFeatureGate39=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ki.SharedSerpletFeatureGate40=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.mzc=Ya.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.Smb=VH.isEnterpriseUser();this.ySa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.WOf=ka.a.dY(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.l$m=v.AFrameworkApplication.K.kb("UserPrincipalName");this.Smb&&this.Hhi()}Pem(b){return v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}Bem(){const b=v.AFrameworkApplication.K.f2a,h=v.AFrameworkApplication.K.EB("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(let P in b){var B=
{key:P,value:b[P]};B=B&&B.key?B.key:"";for(let ca=0;ca<h.length;ca++)if(-1<B.toLowerCase().indexOf(h[ca].toLowerCase())){const ra=B.split(".");ra&&4===ra.length&&Array.add(r,ra[ra.length-1])}}return r}cvf(b,h,r,B){return new Promise(P=>{this.HVm().then(ca=>{const ra=new DL;ra.anid="";ra.applicationName=3===v.AFrameworkApplication.ta.Kb.xk?"WORD":"POWERPNT";ra.applicationVersion=v.AFrameworkApplication.buildVersion;ra.appCorrelationId=b?b:xv.NFb();ra.themePlatform="web";ra.lcid=v.AFrameworkApplication.lcid;
ra.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ra.featureGates=I.c(this.rv):ra.featureGates=I.c(this.Ki);var Qa=Hi.a.ug(v.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;ra.market=TH(Qa);ra.uiLanguage=Qa;ra.sessionId=v.AFrameworkApplication.userSessionId;ra.themeId=r;ra.parentalControl="yes";ra.processorOnlyMode=ca;ra.isEditingAllowed=h.isEditingAllowed();ra.isFeedbackEnabled=this.bNi;ra.isClientSideRendering=18===B||19===B||15===B;ra.disableClipboard=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.DF&&!v.AFrameworkApplication.CEb;ra.accessToken=this.Smb?this.Hhi():"";ca=new FL;ca.CountryCode=TH(Qa);ca.ServiceEndpoint=this.ySa;ca.IsGoLocal=v.AFrameworkApplication.K.$("IsGoLocalEnvironment");ca.IsEnabled=this.Smb;ca.IsEnterpriseEnabled=this.Smb;ca.TenantRoot=this.WOf;ca.Upn=this.l$m;Qa=hD();ca.IsEUDB="PROD"===Qa&&""!==v.AFrameworkApplication.K.kb("IntentServiceEndpoint");
ra.enterpriseUserInfo=ca;ca=new EL;ca.filePath=v.AFrameworkApplication.K.kb("EditDocInClientUrl");ca.docName=v.AFrameworkApplication.K.kb("FileName");ca.author=99!==B?h.author():null;ca.createdDate=99!==B?h.createdDate():null;ra.currentDocument=ca;P(ra)})})}HVm(){return new Promise(b=>{this.dv?this.dv.execute(h=>{h.isFeatureEnabled(Mh.WAo,!0).then(r=>{b(!r)}).catch(r=>{im.Uz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}dDn(b){this.mzc&&
this.Smb&&this.nVd(this.ySa).then(h=>{b(h)})}Hhi(){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.mzc?this.mzc.Iim(this.Yea,this.ySa):""}nVd(b){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.mzc?this.mzc.getToken(this.Yea,b):Promise.resolve("")}eSc(){return this.wAb?this.wAb.getVersion():""}iYl(){return v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?I.c(this.rv):I.c(this.Ki)}static isEnterpriseUser(){const b=v.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(n.a)(VH,"SearchHelper",null,[481]);class kE{constructor(){kE._instance=
""}getVersion(){return kE._instance}Xpo(b){kE._instance=b}}kE._instance=null;Object(n.a)(kE,"SmartLookupVersion",null,[]);class HL{}Object(n.a)(HL,"ConfigurationProvider",null,[]);class cF{constructor(b){cF._instance=b}Nrf(){return cF._instance}}cF._instance=null;Object(n.a)(cF,"SearchHostRuntime",null,[]);class WH{constructor(){this.Afa=this.AUb=this.W=null}get name(){return"Common.App.Insights"}wc(b){this.W=b;const h=Db.a.Gp(Ya.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||v.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(SH,"Common.App.Insights.InsightsActor").ha().Ud(()=>new SH(b.Ve("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,Xl.a.instance,kb.FocusManager.instance(),b.Sa("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.K,Rg.a.instance,r,new zf.a(()=>h.result)));b.register(480,"Common.App.Insights.IDocumentContentExtractionManager").ha().Ud(()=>new xL(b));
r&&(b.register(kE,"Common.App.Insights.SmartLookupVersion").ha().Ud(()=>new kE),b.register(481,"Common.App.SearchCommon.ISearchHelper").ha().Ud(()=>new VH(Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.E0&&(this.AUb=this.W.Oa("Common.App.Insights.InsightsActor"),this.AUb.Ub())}XUn(){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").nVd(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=wN();const B=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new WF.a(h+("?isTelemetryOnly="+B),1,null,r,!0,2,null);v.AFrameworkApplication.He.send(r).hza(()=>{im.Uz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
B,50)},P=>{im.Uz("InsightsPackage - Failed to send refreshmemory API request. Error: "+P.toString(),10)})})}}qtl(){this.vGm();this.XUn()}vGm(){tN().then(b=>{if(""!==b){const h=this.W.Oa("Common.App.Insights.SmartLookupVersion");h&&h.Xpo(b)}this.pMd();this.AUb=this.W.resolve("Common.App.Insights.InsightsActor");b=uN(b);b=Nb.a.create(b);b.F_((h,r)=>{r.succeeded?this.Vqo()&&this.prefetchZeroTerm():im.Uz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.HF,10);this.AUb.Ub()});
Ta.a.UX(b)})}Vqo(){const b=Object.assign(new HL,{channelId:Mh.channelId,approvedOriginPattern:YG()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),B=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),P=new vb.a;h&&P.add(h);r&&P.add(r);B&&P.add(B);h=BL();try{const ca=new CL,ra=SmartLookupHostRuntime.setup(b,
P.toArray(),!0,h,ca);this.W.register(cF,"Common.App.SearchCommon.SearchHostRuntime").ha().Ud(()=>new cF(ra));return!0}catch(ca){return im.Uz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ya.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.cvf(null,r,0,99).then(B=>{b.Nrf().prefetchZeroTerm(B,v.AFrameworkApplication.userSessionId,ZG(),!0,"Indoc",null)})}else im.Uz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}pMd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=UH(b.eSc());b=b.eSc();b=ZF()+(""!==b?b:Mh.Iad)+"/scripts/microsoft.office.smartlookup.ssr.js";
const r=vN();ba.a.Cpa?this.ptl(h,b):(this.ntl(h,r),this.otl(b,r))}ntl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);const P=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&im.rcg(h,b,(new Date).getTime()-P);this.W.Oa("Common.App.Insights.SmartLookupVersion")})}catch(ca){im.Uz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ca.toString(),10)}}otl(b,h){var r=new Sys.Net.WebRequest;
r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);let P=-1;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Rg.a.instance.Wb(new Oe.a(5,1,r,()=>{const ca=Nb.a.create(b);ca.q0e(()=>{P=Date.now()});ca.F_((ra,Qa)=>{Qa.succeeded?""!==h&&im.rcg(h,b,Date.now()-P):im.Uz("InsightsPackage - Failed to prefetch JS file.",
10)});Ta.a.UX(ca)}));else{P=Date.now();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&im.rcg(h,b,Date.now()-P)})}catch(ca){im.Uz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}ptl(b,h){if(ba.a.Cpa){var r=v.AFrameworkApplication.He;b=new WF.a(b,1,null,null,!0,2,null);r.send(b).hza(B=>{B&&B.data?B.data.te?this.W.Oa("Common.App.Insights.SmartLookupVersion"):im.Uz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Ne,10):im.Uz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?im.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+B.data.Ne,10):im.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new WF.a(h,1,null,null,!0,2,null),r.send(h).hza(B=>{B&&B.data?B.data.te||im.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Ne,10):im.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?im.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+B.data.Ne,10):im.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.AUb&&this.AUb.dispose()}}Object(n.a)(WH,"InsightsPackage",null,[1,2]);var IL=c(1626);class JL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(n.a)(JL,"DocumentContentParams",null,[]);var $G=c(1893),KL=c(406),dF=c(736),pu;(function(b){b.qWa="SearchProvider";b.i$a="TextSummarization"})(pu||(pu={}));Object(n.b)("WorkflowType",pu);var $w;(function(b){b.Success="Success";b.Cug="Invoked";b.Error="Error"})($w||($w={}));Object(n.b)("LogType",$w);var Cy;(function(b){b.pNj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.Bug="InvalidAnnotation";b.uSj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Cy||(Cy={}));Object(n.b)("ErrorReason",Cy);class $F{constructor(b){this.LUh=b;this.KWf=this.KWf.bind(this);this.fob=this.fob.bind(this);this.pKo=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.Mco=Date.now();this.Lpb=Lb.a.create().toString();this.log({oK:pu.qWa,logType:$w.Cug,success:!0,correlationId:this.Lpb});
var b=hD().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new Qr.l({parentPath:["Signal",$G.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new $G.SearchProviderSignal({correlationId:this.Lpb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.Aij=window.setTimeout(()=>{this.onError(pu.qWa,$w.Error,Cy.Timeout)},1500)}catch(h){window.clearTimeout(this.Aij),this.onError(pu.qWa,$w.Error,
Cy.Other,this.N9h(h))}}async generateDocumentSummaryDetails(){try{if(!$F.HYc)return null;this.oKo=Date.now();this.log({oK:pu.i$a,logType:$w.Cug,success:!0});await this.activateAnnotation();const b=new Qr.l({parentPath:["Signal",dF.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new dF.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.yzj=window.setTimeout(()=>{this.onError(pu.i$a,$w.Error,Cy.Timeout)},
this.pKo);return new Promise(h=>{this.Xmc=h})}catch(b){window.clearTimeout(this.yzj),this.onError(pu.i$a,$w.Error,Cy.Other,this.N9h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get HYc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get LVm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.icc){await Wq.a.ll();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new KL.a,{annotationType:$G.SearchProviderAnnotation.getTypeName(),handler:this.KWf}))];$F.HYc&&h.push(b(Object.assign(new KL.a,{annotationType:dF.TextSummaryAnnotation.getTypeName(),handler:this.fob})));await Promise.all(h);this.icc=!0}}fob(b){var h,r,B;if(this.Xmc)if(this.dBi(b)){if(b=b.items[0],dF.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.yzj),
b=b.body,b.status!==dF.Result.Success)this.onError(pu.i$a,$w.Error,this.NXl(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({oK:pu.i$a,logType:$w.Success,success:!0});var P=null!==b.summary&&""!==b.summary,ca=$F.LVm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===dF.TTSStatus.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(B=b.tts)||void 0===B?void 0:B.base64Audio);this.Xmc({succeeded:P,summary:P?b.summary:null,audioSucceeded:ca,
audioBase64:ca?b.tts.base64Audio:null});this.Xmc=null}}else this.log({oK:pu.i$a,logType:$w.Error,success:!1,DNd:Cy.Bug})}KWf(b){if(this.dBi(b)&&(b=b.items[0],$G.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.Aij),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Lpb)this.log({oK:pu.qWa,logType:$w.Error,DNd:Cy.pNj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Lpb!==b.correlationId)this.log({oK:pu.qWa,logType:$w.Error,DNd:Cy.uSj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.jMh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({oK:pu.qWa,logType:$w.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Lpb=void 0;this.LUh.Klj(h)}else this.onError(pu.qWa,
$w.Error,Cy.Bug)}NXl(b){switch(b.status){case "BlockedByPrefilter":return Cy.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Cy.BlockedByQualityCheck;default:return Cy.Other}}dBi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.oK){case pu.qWa:var h=this.Mco;break;case pu.i$a:h=this.oKo;break;default:h=-1}const r=Date.now(),B=h?r-h:-1;h=[Object.assign(new ma.a,{name:"WorkflowType",string:b.oK}),Object.assign(new ma.a,{name:"LogType",string:b.logType}),
Object.assign(new ma.a,{name:"ErrorReason",string:b.DNd}),Object.assign(new ma.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ma.a,{name:"Message",string:b.message}),Object.assign(new ma.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ma.a,{name:"StartTime",int64:h}),Object.assign(new ma.a,{name:"EndTime",int64:r}),Object.assign(new ma.a,{name:"Duration",int64:B})];Object(ne.a)("AugloopSearchProviderData",b.success,B,h)}N9h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}jMh(b=
"",h="",r=""){return Object.assign(new JL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,B){h={oK:b,logType:h,success:!1,message:B,DNd:r};switch(b){case pu.qWa:if(!this.Lpb)break;h.correlationId=this.Lpb;this.log(h);this.Lpb=void 0;this.KBl();break;case pu.i$a:if(!this.Xmc)break;this.log(h);this.Xmc(null);this.Xmc=null;break;default:return null}}KBl(){this.LUh.Klj(this.jMh())}}Object(n.a)($F,"AugloopSearchProviderManager",null,[]);class aH{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(n.a)(aH,"DocumentContentSearchResults",null,[]);class XH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,B,P){this.selectRange(h,r,B,P)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new aH,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new aH,{results:r,
totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(n.a)(XH,"BaseDocumentContentExecutor",null,[1143,354]);var YH=c(2112),LL=c(1487);class bH{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(n.a)(bH,"DocumentContentSearchParams",null,[]);class ZH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(n.a)(ZH,"DocumentSelection",null,[]);class ML{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(n.a)(ML,"IAuthorProperties",null,[]);var lE=c(690);class $H{constructor(){this.FOc=this.J9e=0}}Object(n.a)($H,"CommentFindResultIndexInfo",null,[]);const aI=b=>{b.Ac(Pd.SelectionEditor.Jj(b.ib.lb,!0,!1))},NL=b=>{b=YH.a.ZTd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class OL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(n.a)(OL,"DocumentContentSearchResult",null,[]);var xN=c(1851);class PL{constructor(){this.authorEmail=this.authorName=this.gFb=this.O9e=null}}Object(n.a)(PL,"CommentFindResults",null,[]);class QL{constructor(){this.end=this.Bc=0}}Object(n.a)(QL,"FindResultOffset",null,[]);class kw{constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb){this.Dve=this.xv=this.HBe=this.fB=null;this.ekh=0;this.mM=null;this.Osc=new vb.a;this.ZPg=null;this.Eu=b;this.gb=h;this.Rdb=r;this.Xfa=
P;this.nXb=ca;this.gvb=ra;this.Yh=Qa;this.ga=mb;this.hb=Jb}r0l(b,h){var r;const B=[];if(12!=b.type)return B;const P=Bn.FormattingReader.f5h(b);let ca=null,ra=-1;var Qa=$f.a.auto;for(let Jb=0;Jb<=P.length;Jb++){let Yb=-1;var mb=$f.a.auto;Jb<P.length&&(mb=P[Jb],Yb=mb.cp,mb=null===(r=mb.formatting)||void 0===r?void 0:r.cache,mb=(null===mb||void 0===mb?0:mb.QHb)?mb.highlight:(null===mb||void 0===mb?0:mb.PQa)?mb.vx:$f.a.auto);if(Qa!=mb){if(Qa!=$f.a.auto){ca||(ca=this.gvb.zFa(b.id));-1==Yb&&(Yb=ca.length);
Qa=this.Rdb.VJd(ca,ra,Yb,"");const fc={};fc.context=Qa.EId;fc.startOffsetInContext=Qa.Xee;fc.endOffsetInContext=Qa.Vee-1;B.push({data:fc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ra,endOffsetInParagraph:Yb-1})}ra=Yb;Qa=mb}}return B}get Rba(){return this.ZPg}initialize(){this.fB=qi.FindManager.createInstance(this,this.Xfa,R.a.instance,!1,!0)}search(b,h){this.fB.p0a();this.GHf(b)?(this.xv=h,this.mM=new vb.a,b=this.lcf(b),this.fB.find(b)):h(null)}searchV2(b,h){v.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.fB.p0a();if(this.GHf(b)){this.ozi()&&this.ga.Qb(eb.a.phe,2,{CommandValueId:b});this.Dve=h;this.ekh=b.totalResultLimit;this.mM=new vb.a;b=this.lcf(b);this.ZPg=new Tp.a;this.fB.find(b);h=this.Xfa.C4c(b.text);h=this.Xfa.vNb(h);b=this.nXb.P$b(h.join("|"),b);h=this.Yh.$O();for(let B=0;B<h.length;B++){const P=h[B],ca=NL(P);var r=this.gvb.Xjb(ca,b);const ra=this.gvb.Xjb(P.author,b);if(!r&&!ra){t.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}r=ra&&
(!this.Bwi||0<ra.length)?ra:r;let Qa="",mb="";ra&&(!this.Bwi||0<ra.length)&&(Qa=P.author,mb=P.authorId);for(const Jb of r)r=xN.a.createInstance(Jb.Bc,Jb.end,U.a.If(P.objectId),B,32,!1),this.Osc.add(r),this.Rba.nb(B)||this.Rba.add(B,Object.assign(new PL,{O9e:ca,gFb:[],authorName:Qa,authorEmail:mb}))}}else h(null)}get B0h(){null==this.HBe&&(this.HBe=qi.FindManager.createInstance(this,this.Xfa,R.a.instance));return this.HBe}ozi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}gdc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}get Bwi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentsInFindPaneFix",!1)}highlight(b){var h=this.GHf(b);b=h?this.lcf(b):null;var r={};this.ozi()&&this.ga.Qb(V.a.y5f,2,r);if(r[Df.a.On]){if(h){h={};r={};var B={};this.ga.Qb(V.a.Dbe,2,h);this.ga.Qb(eb.a.Cbe,
2,r);this.ga.Qb(eb.a.Ebe,2,B);if(b.text!=h.CommandValueId||b.matchCase!=r[Df.a.On]||b.matchWholeWord!=B[Df.a.On])aI(this.hb),this.ga.Qb(eb.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.B0h,r.p0a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.B0h;return 0<h.Sj.Aka?(b?h.Dli():h.Ili(),h.Sj.yZe-1):-1}lcf(b){let h=zj.a.none;b.matchCase&&(h|=zj.a.matchCase);b.matchWholeWordOnly&&(h|=zj.a.wholeWordOnly);return vh.a.createQuery(b.query,
h)}GHf(b){return b&&!!b.query&&0<b.query.length}hie(){}Dge(){}reset(){}Glf(){}F8b(){if(this.xv){var b=this.kMh(this.mM);this.xv(b)}if(this.Dve){b=new aH;const h=this.mM.count+this.Osc.count>this.ekh;b.totalResultCount=this.mM.count+this.Osc.count;b.hasTooManyResults=h;h||(this.mM.$C(this.mM.count,this.Osc),b.results=this.kMh(this.mM));this.Dve(b);this.Osc.clear()}}kMh(b){var h;const r=[];var B=Object.assign(new lE.a,{pP:!1,Vca:!0,jpa:this.gdc(),qP:!0});B=this.gb.yFa(this.Eu.value,B);for(const ra of b){var P=
ra.Bc;let Qa=ra.end;var ca=void 0;b=-1;let mb=null,Jb=0;if(32===ra.type){mb=kw.N9e;Jb=3;b=B.count+ra.UQa;const Yb=({Bc:P,end:Qa}=IL.a.taj(this.Rba.J(ra.UQa).O9e,P,Qa)).returnValue;ca=this.Rdb.VJd(Yb,P,Qa,nh.a(ra.type));this.Rba.J(ra.UQa).O9e=Yb;this.Rba.J(ra.UQa).gFb.push(Object.assign(new QL,{Bc:P,end:Qa}))}else{if(2===ra.type||4===ra.type)Jb=2===ra.type?1:2,mb=kw.Mzf;if(8===ra.type||16===ra.type)Jb=8===ra.type?6:5,mb=kw.sUf;for(ca=0;ca<B.count;ca++)if(B.J(ca).id===ra.nodeId){b=ca;break}ca=this.Rdb.WJd(ra)}P=
(null===(h=this.Rba)||void 0===h?0:h.nb(ra.UQa))?this.Rba.J(ra.UQa):null;if(0<=b||(null===P||void 0===P?0:P.authorName))b=Object.assign(new OL,{snippet:ca.EId,subdocumentId:mb,subdocumentType:Jb,startOffsetInSnippet:ca.Xee,endOffsetInSnippet:ca.Vee-1,paragraphIndex:b,startOffsetInParagraph:ra.Bc-ca.Xee,endOffsetInParagraph:ra.end-ca.Vee-1,authorName:P?P.authorName:"",authorEmail:P?P.authorEmail:""}),r.push(b)}r.sort((ra,Qa)=>ra.paragraphIndex===Qa.paragraphIndex?ra.startOffsetInParagraph-Qa.startOffsetInParagraph:
ra.paragraphIndex-Qa.paragraphIndex);return r}update(){}OPa(b,h){switch(b){case 0:h&&0<h.length&&!this.mM&&(t.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.mM=new vb.a);for(const r of h)this.mM.add(r)}}lqb(){}dispose(){}}kw.N9e="Comment";kw.Mzf="HeaderFooter";kw.sUf="Note";kw.Pqi="Image";Object(n.a)(kw,"WordDocumentSearchProcessor",null,[468,10,479]);class RL extends XH{get mS(){return!this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",
!1)}gdc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,B,P,ca,ra,Qa,mb,Jb,Yb,fc,Mc,Wc){super();this.Ca=Jb;this.CNa=null;this.IP=(id,Id)=>{id=Id.node;Id=Id.property;this.wgg(id)&&Id===Pe.a.ho&&this.JHb(id,3)};this.gja=(id,Id)=>{id=Id.node;!Id.MEf&&this.wgg(id)&&this.JHb(id,1)};this.Ynb=(id,Id)=>{id=Id.node;this.wgg(id)&&this.JHb(id,2)};this.Eu=b;this.gb=h;this.ld=
r;this.hb=B;this.ME=P;this.Cl=Qa;this.Vb=mb;this.Q7=ca;this.yC=ra;this.Yh=Yb;this.J7j=fc;this.ueh=U.a.create();this.zde(this.IP,this.gja,this.Ynb);Wc&&Wc.execute(id=>this.ima=id);Mc.execute(id=>{this.JZa=id})}submitDocumentContentExtractionSignal(){this.JZa&&this.JZa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.JZa?this.JZa.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.JZa?this.JZa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=
this.tR(this.D9l());for(const r of this.Yh.$O()){var h=YH.a.ZTd(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new lE.a,{pP:!1,Vca:!1,qP:!0}),r=this.gb.yFa(this.Eu.value,h);h=[];const B=[];for(var P=0;P<r.count;++P){var ca=r.J(P);h.push(...this.o1l(ca,P));B.push(...this.Q7.r0l(ca,P))}r=[];P=this.Yh.$O();for(ca=0;ca<P.length;ca++)r.push(this.LSl(P[ca]));P={};P.images=h;P.comments=r;P.highlights=B;b(P)}selectRange(b,h,
r,B,P){const ca=Date.now(),ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.HUa();if(0>b||0>h||0>r||0>B||b>r||b===r&&h>B)throw Error("Provided select range offsets incorrect");const Wc=Object.assign(new lE.a,{pP:!1,Vca:!0,jpa:this.gdc(),qP:!0}),id=this.gb.yFa(this.Eu.value,Wc);if(r>=id.count){const Id=Ya.a.instance.resolve("Common.Comments.ICommentModel").$O(),ve=r-id.count;if(ve<Id.length){P=-1;if(this.Q7.Rba.nb(ve)){const be=this.Q7.Rba.J(ve).gFb;
for(var Qa=0;Qa<be.length;Qa++)if(be[Qa].Bc===h){P=Qa;break}}this.CNa=-1!==P?Object.assign(new $H,{J9e:ve,FOc:P}):null;const $d=Id[ve];v.AFrameworkApplication.va.processAction(V.a.kU,2);v.AFrameworkApplication.va.Qb(V.a.r4,2,null);v.AFrameworkApplication.va.Qb(V.a.selectComment,2,Object.assign(new LL.a,{commentId:$d.id,E$:2,mS:this.mS}))}}else{this.CNa=null;var mb=id.J(b),Jb=id.J(r);if(!this.Q1d(mb,h)||!this.Q1d(Jb,B))throw Error("Provided select range offsets incorrect");v.AFrameworkApplication.va.processAction(V.a.kU,
2);this.oMo(mb);var Yb=this.ME.ne(mb,h);Qa=this.ME.Iy(Yb,Se.a.Uc(Jb,B+1));if(P){const Id=Qa.toArray();h=[];for(const ve of Id)h.push(this.NTd(ve.node));h.join(" ").includes(P)||(ra.success=!1,ra.message="The text in clicked passage does not match the selected hit")}var fc=this.Cl.value.ju,Mc=this.hb.ib.lb;Mc&&Mc.equals(Qa)&&this.ld.rea(fc,null);this.ld.rea(fc,Qa);ra.duration=Date.now()-ca;this.logMessage(ra)}}catch(Wc){ra.success=!1,ra.message=Wc.stack,ra.duration=Date.now()-ca,this.logMessage(ra)}}search(b,
h){this.HUa();this.Q7.search(Object.assign(new bH,{query:b}),h)}searchV2(b,h){this.HUa();this.Q7.searchV2(Object.assign(new bH,{query:b}),h)}selectNextPrevHighlight(b){this.HUa();return this.Q7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.HUa();this.Q7.search(b,h)}searchWithParamV2(b,h){this.HUa();this.Q7.searchV2(b,h)}highlight(b){this.HUa();this.Q7.highlight(Object.assign(new bH,{query:b}))}highlightWithParam(b){this.HUa();this.Q7.highlight(b)}getRevision(){return this.ueh.toString()}getSelectedText(){const b=
this.J7j.getSelectedText();return Object.assign(new Ix.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new lE.a,{pP:!1,Vca:!0,jpa:this.gdc(),qP:!0}),h=({ps:ca}=this.mem(b)).returnValue;if(h)return h;var r=this.hb.ib.lb;if(!r||!r.length)return null;h=r.Pa;r=r.Rc;let B=-1,P=-1;var ca=ca||this.gb.yFa(this.Eu.value,b);b=null;for(let ra=0;ra<ca.count;ra++){const Qa=ca.J(ra);-1===B&&h.node.id===Qa.id&&(B=ra,b=Qa);-1===
P&&r.node.id===Qa.id&&(P=ra)}ca=null;5===(null===b||void 0===b?void 0:b.foa)&&(ca=kw.Mzf);if(1===(null===b||void 0===b?void 0:b.foa)||2===(null===b||void 0===b?void 0:b.foa))ca=kw.sUf;return Object.assign(new ZH,{subdocumentId:ca,startParagraphIndex:B,startParagraphOffset:h.Wj,endParagraphIndex:P,endParagraphOffset:r.vp})}clearDocumentSelection(){aI(this.hb)}selectRangeV2(b,h,r,B,P,ca){const ra=Date.now(),Qa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};
try{this.HUa();if(0>h||0>r||0>B||0>P||h>B||h===B&&r>P)throw Error("Provided select range offsets incorrect");var mb=Object.assign(new lE.a,{pP:!1,Vca:!0,jpa:this.gdc(),qP:!0});const Mc=this.gb.yFa(this.Eu.value,mb);if(b==kw.N9e)this.Nij(r,B,Mc.count);else{mb=this.CNa=null;var Jb={};Jb.subdocumentId=b;Jb.startParagraphIndex=h;Jb.startParagraphOffset=r;Jb.endParagraphIndex=B;Jb.endParagraphOffset=P;mb=b==kw.Pqi?this.Qai(Mc.J(h),{isFloatingImage:!1,imageId:"",...Jb}):this.rji(Mc.J(h),Mc.J(B),{clickedPassage:ca,
...Jb},Qa);var Yb=this.Cl.value.ju,fc=this.hb.ib.lb;(null===fc||void 0===fc?0:fc.equals(mb))&&this.ld.rea(Yb,null);this.ld.rea(Yb,mb)}Qa.duration=Date.now()-ra;this.logMessage(Qa)}catch(Mc){Qa.success=!1,Qa.message=Mc.stack,Qa.duration=Date.now()-ra,this.logMessage(Qa)}}selectRangeV3(b){const h=Date.now(),r={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.HUa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||
b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var B=Object.assign(new lE.a,{pP:!1,Vca:!0,jpa:this.gdc(),qP:!0});const ra=this.gb.yFa(this.Eu.value,B);if(b.subdocumentId==kw.N9e)this.Nij(b.startParagraphOffset,b.endParagraphIndex,ra.count);else{B=this.CNa=null;B=b.subdocumentId==kw.Pqi?this.Qai(ra.J(b.startParagraphIndex),b):this.rji(ra.J(b.startParagraphIndex),
ra.J(b.endParagraphIndex),b,r);var P=this.Cl.value.ju,ca=this.hb.ib.lb;(null===ca||void 0===ca?0:ca.equals(B))&&this.ld.rea(P,null);this.ld.rea(P,B)}r.duration=Date.now()-h;this.logMessage(r)}catch(ra){r.success=!1,r.message=ra.stack,r.duration=Date.now()-h,this.logMessage(r)}}D9l(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},r=Object.assign(new lE.a,{pP:!1,Vca:!1,qP:!0});h.duration=Date.now()-b;this.logMessage(h);return this.gb.yFa(this.Eu.value,r)}tR(b){const h=
Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},B=new vb.a;for(const P of b)B.add(this.NTd(P));r.duration=Date.now()-h;this.logMessage(r);return B}Qai(b,h){if(h.isFloatingImage)return h=U.a.If(h.imageId),b=b.Mc.Eb(h),b=Fe.SelectionFactory.Dq(b);const r=this.ME.ne(b,h.startParagraphOffset);return b=this.ME.Iy(r,Se.a.Uc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Ve.a(b,"O365",h,b);if(!this.ima||!this.ima.getPersonaIconPropertiesArray)return null;
b=await this.ima.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new ML,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}rji(b,h,r,B){if(!this.Q1d(b,r.startParagraphOffset)||!this.Q1d(h,r.endParagraphOffset))throw Error("Provided select range offsets incorrect");r.subdocumentId==kw.Mzf?v.AFrameworkApplication.va.Qb(V.a.umb,2,new vp.a(b)):v.AFrameworkApplication.va.processAction(V.a.kU,2);r.subdocumentId==kw.sUf?
32===v.AFrameworkApplication.va.Qb(V.a.u6a,2,new vp.a(b))&&v.AFrameworkApplication.va.processAction(V.a.JPd,2):v.AFrameworkApplication.va.Qb(V.a.r4,2,null);b=this.ME.ne(b,r.startParagraphOffset);h=this.ME.Iy(b,Se.a.Uc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const P=[];for(const ca of b)P.push(this.NTd(ca.node));P.join(" ").includes(r.clickedPassage)||(B.success=!1,B.message="The text in clicked passage does not match the selected hit")}return h}Nij(b,h,r){const B=Ya.a.instance.resolve("Common.Comments.ICommentModel").$O();
h-=r;if(h<B.length){r=-1;if(this.Q7.Rba.nb(h)){const P=this.Q7.Rba.J(h).gFb;for(let ca=0;ca<P.length;ca++)if(P[ca].Bc===b){r=ca;break}}this.CNa=-1!==r?Object.assign(new $H,{J9e:h,FOc:r}):null;b=B[h];v.AFrameworkApplication.va.processAction(V.a.kU,2);v.AFrameworkApplication.va.Qb(V.a.r4,2,null);v.AFrameworkApplication.va.Qb(V.a.selectComment,2,Object.assign(new LL.a,{commentId:b.id,E$:2,mS:this.mS}))}}HUa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===Mh.lC||this.Vb.mg(Mh.lC))}b_o(){this.ueh=
U.a.create()}NTd(b){if(b.iJb)return"";b=this.gb.text(b);return ni.AParagraphNode.QP(b," ")}Q1d(b,h){b=this.NTd(b);return h<b.length}JHb(b,h){switch(h){case 1:case 2:case 3:this.b_o()}}logMessage(b){const h=[Object.assign(new ma.a,{name:"Message",string:b.message})];Object(ne.a)(b.activityName,b.success,b.duration,h)}wgg(b){return!b.iJb&&this.DXc(b)}DXc(b){const h=this.Eu.value;return!!h&&!!h.xd&&!!b.Mc&&b.Mc.id.equals(h.xd.id)}oMo(b){this.gb.Ycc(b)?32===v.AFrameworkApplication.va.Qb(V.a.u6a,2,new vp.a(b))&&
v.AFrameworkApplication.va.processAction(V.a.JPd,2):v.AFrameworkApplication.va.Qb(V.a.r4,2,null)}zde(b,h,r){this.yC&&(this.yC.qo(b),this.yC.ku(h),this.yC.kw(r))}mem(b){let h=null;var r=this.Vb?this.Vb.currentScope.name:"";if(!this.Yh.tt||r!==Zd.AFrame.Sr&&r!==Zd.AFrame.KM)return{returnValue:null,ps:h};r=Array.indexOf(this.Yh.$O(),this.Yh.tt);if(0>r)return{returnValue:null,ps:h};h=this.gb.yFa(this.Eu.value,b);var B=YH.a.ZTd(this.Yh.tt.text[0]).split("\n");b=0;B=(1===B.length?B[0]:B.join(" ")).length-
1;this.CNa&&r===this.CNa.J9e&&this.Q7.Rba.nb(r)&&this.Q7.Rba.J(r).gFb.length>this.CNa.FOc&&(b=this.Q7.Rba.J(r).gFb[this.CNa.FOc].Bc,B=this.Q7.Rba.J(r).gFb[this.CNa.FOc].end);return{returnValue:Object.assign(new ZH,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:B,subdocumentId:"Comment"}),ps:h}}o1l(b,h){const r=[];if(12!=b.type)return r;r.push(...this.O1l(b,h));r.push(...this.sZl(b,h));return r}sZl(b,h){const r=[],B=xd.GraphIterator.eb(b);if(!B.Jz())return r;
let P=B.Rd();for(;P;){if(!this.yRa(P)){P=B.It();continue}const ca=P.properties;ca&&ye.ImageReader.bXc(ca)&&r.push(this.CBj(ca,h,0,b.Mc,!0,P.id.toString()));P=B.It()}return r}yRa(b){if(19!==b.type||5!==ye.ImageReader.ui(b))return!1;b=xd.GraphIterator.eb(b);if(!b.Jz())return!0;let h=b.Rd();for(;h;){if(59===h.type)return!1;h=b.It()}return!0}O1l(b,h){const r=[],B=b.Mc;if(B){if(!b.hasProperty(Pe.a.Rn))return r;var P=b.ja(Pe.a.Rn,null);if(!P)return r;b=b.ja(Pe.a.Im,null);for(let ra=0;ra<P.length;++ra){var ca=
P[ra];if(!ca)continue;ca=B.Eb(ca);if(!ca||!ye.ImageReader.bXc(ca)||5!==ye.ImageReader.ui(ca))continue;let Qa=0;0!=ra&&b&&ra-1<b.length&&(Qa=b[ra-1]);r.push(this.CBj(ca,h,Qa,B,!1,""))}return r}}CBj(b,h,r,B,P,ca){B=(new Sys.Net.WebRequest).getResolvedUrl()+ye.ImageReader.e8l(b,B);const ra=b.ja(Zc.a.ft,""),Qa={};Qa.base64Encoding=ra;Qa.url=B;Qa.width=ye.ImageReader.WC(b);Qa.height=ye.ImageReader.YH(b);Qa.altText=ye.ImageReader.eY(b);Qa.description=ye.ImageReader.uQa(b);Qa.imageId=ca;Qa.isFloatingImage=
P;return{data:Qa,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}LSl(b){return{data:{comment:NL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(n.a)(RL,"WordDocumentContentExecutor",XH,[]);class cH{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(n.a)(cH,"BaseDocumentHelper",null,[412]);
class SL extends cH{constructor(b){super();this.OKl=b}get p7b(){const b=this.OKl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return ab.StaticActiveAppFrame.za().jb.isEditingAllowed}author(){var b;return null===(b=this.p7b)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.p7b)||void 0===b?void 0:b.creationDate}}Object(n.a)(SL,"WordDocumentHelper",cH,[]);class TL{constructor(b){this.yMi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.ACf(b.htmlText)}getId(){return"InsertContentExecutor"}ACf(b){return this.executeCommand(Mb.a.dna,
b)}executeCommand(b,h){const r=new wc.DictionaryPropertySet;r.setValue(Zc.a.LP,h);r.setValue(Zc.a.Yja,!1);h=this.yMi.processAction(b,1);32===h&&(h=this.yMi.Qb(b,2,r));return h}}Object(n.a)(TL,"WordInsertContentExecutor",null,[353,354]);var yN=c(1734),zN=c(1735);class UL{constructor(b,h,r,B,P){this.Etc="undefined";this.Qfg="Something went wrong with retrieving a summary. Please try again.";this.KHm=(ca,ra,Qa,mb,Jb)=>xv.zY(ca,ra,Qa,mb,this.vC,Jb);this.eje=(ca,ra,Qa,mb,Jb)=>{if(1===Qa)return this.L8j?
32:8;ca=zG.getSelectedText();ca=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,zG.oUd(ca));Jb[mm.a.LabelText]=ca;return 32};this.Vnf=(ca,ra,Qa)=>{if(1===Qa)return 32;const mb={};this.JZa?this.JZa.generateDocumentSummary().then(Jb=>{Jb||(Jb=this.Qfg,t.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));mb.additionalData=this.Vaf(Jb);this.ga.Qb(eb.a.U8,2,mb)}).catch(()=>{t.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
mb.additionalData=this.Vaf(this.Qfg);this.ga.Qb(eb.a.U8,2,mb)}):(t.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),mb.additionalData=this.Vaf(this.Qfg),this.ga.Qb(eb.a.U8,2,mb));return 32};this.fOo=(ca,ra,Qa)=>{if(!this.mNi)return t.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Qa)return this.nXm()?32:2;if(2===Qa)this.mNi.nVd(this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(mb=>{mb={token:mb,
files:I.c(this.tYl()),type:"MultiFilesDeckGeneration"};mb=Object.assign(new yN.a,{selection:Object.assign(new Ix.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new ou.a,{landingTab:"All",data:mb}),entryPoint:38});this.ga.Qb(eb.a.q9,2,mb);return 32}).catch(()=>{t.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.Ca=r;this.u8j=(this.Rw=!!v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Kb.uL)&&!!this.Ca&&this.Ca.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.L8j=!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);B&&B.execute(ca=>{this.JZa=ca});this.mNi=P}Ub(){this.ga.fb(V.a.exh,Gd.a.frame,this.KHm,1028);this.ga.fb(V.a.eje,Gd.a.frame,this.eje,1028);this.ga.fb(V.a.k4h,Gd.a.frame,this.Vnf,1028);this.ga.fb(V.a.DBj,Gd.a.frame,this.fOo,1028);this.u8j&&(this.Etc=ab.StaticActiveAppFrame.za().bJ.getWindowMode(),
this.BXh(this.Etc),ab.StaticActiveAppFrame.za().bJ.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.Etc&&(this.Etc=h,this.BXh(this.Etc))}))}nXm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}BXh(b){"DP"===b&&Ik.UISurfaces.Pu().then(h=>{h.selectors.getTabbedTaskPaneCount()||
this.ga.Qb(V.a.exh,2,{SourceControlId:"smartlookupAuto"});return null})}Vaf(b){return{["documentSummary"]:b}}tYl(){const b=new zN.a("docx",v.AFrameworkApplication.K.kb("EditDocInClientUrl"),v.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",v.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(n.a)(UL,"WordInsightsActor",null,[]);class eF{constructor(){this.ujd=this.vQ=null}R2a(){return this.uGb()}mbi(){return this.uGb()}kbi(){return null}Xxo(b,
h,r){this.vQ||(this.vQ=this.EJd());this.vQ.WP(b,h,r)}Yxo(b,h,r){this.vQ||(this.vQ=this.EJd());this.vQ.Uhg(b,h,r)}qwo(b,h){this.ujd||(this.ujd=null);this.ujd&&this.ujd.Uhg(b,h)}dQb(b,h){this.vQ||(this.vQ=this.EJd());this.vQ.dQb(b,h)}D2d(b){this.vQ||(this.vQ=this.EJd());this.vQ.D2d(b)}Qeo(){this.vQ&&this.vQ.Pkc()}zjo(){this.vQ&&this.vQ.che()}Dvo(){var b=v.AFrameworkApplication.K.nc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-eF.wGi<=b;b||(eF.wGi=window.performance.now());
return b}dispose(){this.vQ&&(this.vQ.dispose(),this.vQ=null)}get LJb(){return this.vQ?this.vQ.isVisible:!1}}eF.wGi=0;Object(n.a)(eF,"InsightsManager",null,[1167,10]);class aG{constructor(b,h,r,B,P,ca=!0,ra=null,Qa=null){this.C6=this.LE=this.mMa=null;this.dyc=!1;this.Afa=null;this.Vb=h;this.DYb=ca;this.qTg=Qa?Qa:new cH;this.dv=ra;this.np=b;this.DYb&&(Ya.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.Afa=Ya.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Nrf()),this.Sdb=
Ya.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.wAb=this.Sdb.eSc())}Tnb(b){if(this.DYb){b=b.rawEvent;try{var h=I.a(b.data)}catch(r){t.ULS.sendTraceTag(595161728,1303,15,this.tU("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.LE&&(b=this.LE.entryPoint);this.Sdb.cvf(this.C6,this.qTg,this.lac(),b).then(r=>{h.data=r;this.Nob(h)});break;case 118:h.data=this.LE?this.LE:Object.assign(new Lt.a,{selection:Object.assign(new Ix.a,
{neighborhood:this.mMa.neighborhood,mentionStart:this.mMa.mentionStart,mentionLength:this.mMa.mentionLength})});this.Nob(h);break;case 103:b=I.a(Object(Na.a)(String,h.data));im.sendTelemetryEvent(b);break;case 206:this.Sdb.nVd(h.data).then(r=>{h.data=r;this.Nob(h)});break;case 112:h.data.shiftPressed?(ba.a.Dj&&document.activeElement.blur(),this.np.cWd(0,null,2,null,null),t.ULS.sendTraceTag(592545156,1303,50,this.tU("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.np.YSc(0,null,2,null,null),
t.ULS.sendTraceTag(592545155,1303,50,this.tU("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.cpa()}}}R8c(b){if(this.Afa){var h=0;this.LE&&(h=this.LE.entryPoint);this.Sdb.cvf(this.C6,this.qTg,this.lac(),h).then(r=>{im.Ojj("SearchFromHost",this.C6);this.LE.launchData||(this.LE.launchData=new ou.a);const B=ZG();try{this.Afa.search(this.LE,r,v.AFrameworkApplication.userSessionId,B,b),this.Sdb.dDn(P=>{im.Ojj("SearchFromHostWithToken",this.C6);this.Afa.searchAuthenticatedProviders(this.LE,
r,v.AFrameworkApplication.userSessionId,B,null,P)})}catch(P){im.Uz("BaseSmartLookupPane - Fail to search from host. Error: "+P,10)}}).catch(r=>{im.Uz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Qkc(b){if(this.DYb){var h=im,r=h.Qkc,B=this.C6;b=Math.round(window.performance.now()-b);var P=this.LE?bF[this.LE.entryPoint]:"",ca=this.Sdb.eSc(),ra=this.Sdb.iYl(),Qa=this.LE?this.LE.entryPoint:0;r.call(h,B,b,P,ca,ra,v.AFrameworkApplication.M1e,this.dyc,
18===Qa||19===Qa||15===Qa)}}}Object(n.a)(aG,"BaseSmartLookupPane",null,[408,10]);class bG{constructor(b){this.messageType=null;this.messageType=b}}Object(n.a)(bG,"InsightsMessage",null,[]);class cG extends bG{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(n.a)(cG,"InsightsMessageWithContent",bG,[]);class VL extends cG{constructor(b){super(Mh.$dn,b)}}Object(n.a)(VL,"InsightsMessageAppProperties",cG,[]);class XL extends cG{constructor(b){super(Mh.ken,b)}}Object(n.a)(XL,
"InsightsMessageSelection",cG,[]);class YL extends bG{constructor(){super(Mh.nen)}}Object(n.a)(YL,"InsightsMessageTakeFocus",bG,[]);class dG extends aG{constructor(b,h,r,B,P=null,ca=null,ra=null,Qa=!0,mb=null,Jb=null){super(h,r,P,ca,ra,Qa,mb,Jb);this.pid=this.hB=this.mj=null;this.Jtd=!1;this.Cod=b;this.Mwc=this.DYb?UH(this.wAb):v.AFrameworkApplication.QFm;this.S_();this.v7f();this.Xo=B;this.eSg=0}get isVisible(){return!1}S_(){this.mj=this.Cod.eLc();v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb.Nlb&&
this.mj.PXn(b=>{b===this.mj&&(this.che(),this.Pkc())});this.bCf(this.mj.bVa.Mxh);this.mj.Gm()}bCf(b){b.style.overflow="hidden";const h=Af.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.hB=h;b.appendChild(this.hB);this.hB.id=Mh.GAf}v7f(){De.a.addHandler(this.hB,"load",Object(z.a)(this,this.Snb,"onIFrameLoad"));De.a.addHandler(this.hB,"error",Object(z.a)(this,this.Rnb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,
this.Tnb,"onIFrameMessage"))}epg(){De.a.removeHandler(this.hB,"load",Object(z.a)(this,this.Snb,"onIFrameLoad"));De.a.removeHandler(this.hB,"error",Object(z.a)(this,this.Rnb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.Tnb,"onIFrameMessage"))}dispose(){this.hB&&(this.epg(),this.hB.parentNode.removeChild(this.hB),this.hB=null);this.mj&&(this.Cod.j7b(this.mj),this.mj=null)}WP(b,h,r){this.C6=h;this.pid=null;this.eSg=r;this.dyc=!b.mentionLength;this.Jtd=!1;t.ULS.sendTraceTag(6295947,
1303,50,this.tU("Start to show Insights"));this.mMa=b;this.Mwc&&this.Mwc.length?this.hB.src=this.Mwc:(this.hB.src=dG.WSi,t.ULS.sendTraceTag(6295948,1303,15,this.tU("The Insights URL config setting is null or empty")));this.Xo.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.mj.JY||this.mj.D7f(Object(z.a)(this,this.Cqn,"onInsightsTaskPaneHidden"));this.DYb&&this.R8c(!1);b=window.performance.now();this.Cod.showTaskPane(this.mj);this.mj.Gm();this.Qkc(b)}Uhg(b,h,r){this.LE=b;this.WP(Object.assign(new YF.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}dQb(){}D2d(){}Pkc(){this.hB.src===this.Mwc&&this.Jtd&&(this.Vb.mg(Mh.lC),this.Nob(new YL))}che(){this.hB&&kb.FocusManager.kK(this.hB.contentWindow)}fef(){this.hB.src=dG.WSi;this.mj.Hm()}cpa(){this.Cod.hideTaskPane(this.mj);this.fef()}Cqn(b){b===this.mj&&this.cpa()}Snb(){t.ULS.sendTraceTag(6295951,1303,50,this.tU("The iframe is successfully loaded in Insights task pane"))}Rnb(){t.ULS.sendTraceTag(6295952,
1303,15,this.tU("The iframe failed to load in Insights task pane"))}Tnb(b){const h=b.rawEvent;if(h.source===this.hB.contentWindow)if(this.DYb)super.Tnb(b);else{let r;try{r=I.a(h.data)}catch(B){t.ULS.sendTraceTag(6295953,1303,15,this.tU("Message data [{0}] failed to deserialize.",h.data));return}if(lf.c(r.messageType))t.ULS.sendTraceTag(6295954,1303,15,this.tU("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Mh.aen:this.Nob(new VL(this.X1l()));break;case Mh.men:this.Nob(new XL(this.mMa));
break;case Mh.gen:this.Jtd=!0;this.che();this.Pkc();t.ULS.sendTraceTag(6295955,1303,50,this.tU("Insights pane rendering is completed"));break;case Mh.oen:b=r.messageContent;this.pid=b.clientCorrelationId;this.C6!==b.appCorrelationId&&t.ULS.sendTraceTag(6403778,1303,15,this.tU("App correlation ID on client {0} does not match one on server {1}",this.C6,b.appCorrelationId));break;case Mh.fen:r.messageContent?(ba.a.Dj&&document.activeElement.blur(),this.np.cWd(0,null,2,null,null),t.ULS.sendTraceTag(6604741,
1303,50,this.tU("Insights UX lost focus through Ctrl + Shift + F6"))):(this.np.YSc(0,null,2,null,null),t.ULS.sendTraceTag(6604742,1303,50,this.tU("Insights UX lost focus through Ctrl + F6")));break;case Mh.cen:r.messageContent.keyCode===kc.a.fKa&&this.cpa();break;case Mh.den:try{this.Jtd=!1,localStorage.setItem(Mh.pHi,"true")}catch(B){t.ULS.sendTraceTag(17961859,1303,10,this.tU("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}X1l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.C6;3===v.AFrameworkApplication.ta.Kb.xk?b.applicationName=Mh.S8o:4===v.AFrameworkApplication.ta.Kb.xk&&(b.applicationName=Mh.hxn);b.applicationVersion=v.AFrameworkApplication.buildVersion;var h=Hi.a.ug(v.AFrameworkApplication.lcid);h=h?h.name:null;b.market=TH(h);b.uiLanguage=h;b.sessionId=v.AFrameworkApplication.userSessionId;b.parentalControl=Mh.q0f;b.clientType="user";b.legalAgreed=this.g3l();b.defaultDefineTab=1===this.eSg?"true":null;return b}tU(b,...h){const r={};this.C6&&(r[Mh.bzj]=this.C6);
this.pid&&(r[Mh.AJo]=this.pid);r[Mh.czj]=String.format.apply(null,[b].concat(h));return I.c(r)}lac(){return 5}g3l(){try{const b=localStorage.getItem(Mh.pHi);return!!b&&"true"===b}catch(b){return t.ULS.sendTraceTag(17961860,1303,10,this.tU("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Nob(b){b=I.c(b);this.hB.contentWindow.postMessage(b,ka.a.getOrigin(this.Mwc))}}dG.WSi="about:blank";Object(n.a)(dG,"InsightsPane",aG,[]);class ZL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(n.a)(ZL,
"SmartLookupTaskPaneProps",null,[]);class $L{}Object(n.a)($L,"ActionDescriptor",null,[]);class aM extends aG{constructor(b,h,r,B=null,P=null,ca=null,ra=!0,Qa=null,mb=null){super(h,r,B,P,ca,ra,Qa,mb);this.zVe=!!v.AFrameworkApplication.ta&&!!v.AFrameworkApplication.ta.Kb&&v.AFrameworkApplication.ta.Kb.TIf;this.Vs=this.pQe=!1;this.ybk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.wbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.Bbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.Abk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ra||im.Uz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.nCa=b;this.SZg=UH(this.wAb)}get isVisible(){return this.Vs}dQb(b,h){this.LE=b;this.mMa=b=Object.assign(new YF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.dyc=!b.mentionLength;this.C6=h;this.R8c(!1)}D2d(b){this.LE=b;this.mmc(Object.assign(new YF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}WP(b,h){this.C6=h;this.mmc(b,!0)}Uhg(b,h,r){this.LE=b;this.WP(Object.assign(new YF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}cpa(){this.nea();this.nCa.hideTaskPane()}mmc(b,
h){gc.SessionStatusManager.instance.bD&&this.Afa?(this.mMa=b,this.dyc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.nCa.updateTaskPane(null),h&&this.yfo()):(h&&this.R8c(!1),this.pQe=!this.pQe,this.nCa.updateTaskPane(this.xA())):(h&&this.R8c(this.isVisible),this.nCa.showTaskPane(this.xA())),this.Qkc(b)):(this.nCa.showTaskPane(this.xA()),im.Seo(gc.SessionStatusManager.instance.bD,!!this.Afa,this.LE?
bF[this.LE.entryPoint]:"",this.Sdb.eSc(),v.AFrameworkApplication.M1e,this.dyc))}yfo(){if(!this.LE){const b=Object.assign(new Ix.a,{neighborhood:this.mMa.neighborhood,mentionStart:this.mMa.mentionStart,mentionLength:this.mMa.mentionLength});this.LE=Object.assign(new Lt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.R8c(this.isVisible)}bfo(){const b=new $L;b.transactionId=this.C6;b.actionType=15;b.channelId=Mh.channelId;this.Nob(b)}Tnb(b){const h=b.rawEvent;document.getElementById(Mh.lC)&&
h.source!==document.getElementById(Mh.lC).contentWindow||this.zQn(b)}zQn(b){const h=b.rawEvent;let r;try{r=I.b(h.data)}catch(B){t.ULS.sendTraceTag(545604257,1303,15,this.tU("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Kb.a.yHb()>=this.ybk?this.nCa.updateTaskPane(this.Ecf(this.wbk)):Kb.a.yHb()>=this.Bbk&&this.nCa.updateTaskPane(this.Ecf(this.Abk)));
break;case 33:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.nCa.updateTaskPane(this.Ecf(r.data));break;case 42:this.nCa.updateTaskPane(this.Sfl(r.data));break;case 43:this.nCa.updateTaskPane(this.xA());break;default:super.Tnb(b)}}dispose(){}initialize(){this.S_();this.jka()}S_(){this.nCa.eLc()}jka(){const b=this.Vb.fe(Mh.lC);b.parent=Zd.AFrame.Ap;b.fI=!0}Gjo(){this.Vb.mg(Mh.lC)}nea(){this.e5a()&&this.Vb.mg(this.Vb.iU)}v7f(){$addHandler(window,
"message",Object(z.a)(this,this.Tnb,"onIFrameMessage"))}epg(){$removeHandler(window,"message",Object(z.a)(this,this.Tnb,"onIFrameMessage"))}e5a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Mh.lC}Nob(b){b=I.c(b);document.getElementById(Mh.lC)&&document.getElementById(Mh.lC).contentWindow.postMessage(b,ka.a.getOrigin(this.SZg))}tU(b,...h){const r={};this.C6&&(r[Mh.bzj]=this.C6);r[Mh.czj]=String.format.apply(null,[b].concat(h));return I.c(r)}lac(){return rh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}vZi(){if(this.Afa)this.Afa.onPaneThemeChanged(this.lac());return rh.a("getTheme")?appChrome.api.getTheme():null}Pkc(){}che(){document.getElementById(Mh.lC)&&kb.FocusManager.kK(document.getElementById(Mh.lC).contentWindow)}Rnb(){im.Uz("ReactSmartLookupPane - Iframe component failed to load.",10)}Snb(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||im.Uz("ReactSmartLookupPane - Onload detected no network.",
50)}ZWl(){return this.LE?10===this.LE.entryPoint?2===v.AFrameworkApplication.ta.Kb.xk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.LE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.LE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.LE.entryPoint||38===this.LE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}xA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",
!1)&&(b=this.ZWl());const h=new ZL;h.src=this.SZg;h.id=Mh.lC;h.refreshPane=this.pQe;h.onError=Object(z.a)(this,this.Rnb,"onIFrameError");h.onLoad=Object(z.a)(this,this.Snb,"onIFrameLoad");h.title=b;gc.SessionStatusManager.instance.bD?this.Afa||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new Sl.a,{title:b,hideHeader:!1,width:Mh.width,location:Mh.uAn,contentProps:h,
isModernPane:!0,onOpen:()=>{this.Gjo();this.Vs=!0;this.v7f();rh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.vZi,"onThemeIdChanged"));v.AFrameworkApplication.ta.updateCommandUI();if(this.Afa)this.Afa.onPaneStateChanged(!0)},onClose:()=>{this.bfo();this.nea();this.Vs=!1;this.epg();rh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.vZi,"onThemeIdChanged"));v.AFrameworkApplication.ta.updateCommandUI();
if(this.Afa)this.Afa.onPaneStateChanged(!1)}});this.zVe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}Sfl(b){const h=this.xA();h.title=b;h.contentProps.title=b;return h}Ecf(b){const h=this.xA();h.resizeWidth=b;return h}}Object(n.a)(aM,"ReactSmartLookupPane",aG,[]);class bM{eLc(){const b=new Sp.CuiHelper(Ad.a.d0a,WordEditorIntl.WordEditorStrings);return Sq.a.instance.wOh(Mh.lC,Mh.Rhc,Mh.width,Mh.Mlg,b)}showTaskPane(b){Sq.a.instance.showTaskPane(b)}hideTaskPane(b){Sq.a.instance.hideTaskPane(b)}j7b(b){Sq.a.instance.j7b(Mh.lC,
b)}}Object(n.a)(bM,"WordInsightsPaneHandler",null,[385]);class cM{eLc(){Sq.a.instance.dPa()}showTaskPane(b){Ik.UISurfaces.Pu().then(h=>{h.showTaskPane(Mh.lC,b);return null})}updateTaskPane(b=null){Ik.UISurfaces.Pu().then(h=>{h.setSelectedTaskPane(Mh.lC);b&&h.updateTaskPane(Mh.lC,b);return null})}hideTaskPane(){Ik.UISurfaces.Pu().then(b=>{b.hideTaskPane(Mh.lC,2);return null})}}Object(n.a)(cM,"WordReactSmartLookupPaneHandler",null,[384]);class dM extends eF{constructor(b,h){super();this.Fx=b;this.hb=
h}EJd(){const b=!!v.AFrameworkApplication.ta&&!!v.AFrameworkApplication.ta.Kb&&v.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Kb&&v.AFrameworkApplication.ta.Kb.MHf?new aM(new cM,Xl.a.instance,kb.FocusManager.instance(),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new dG(new bM,Xl.a.instance,kb.FocusManager.instance(),Ya.a.instance.resolve("Common.Utils.IAriaNotifier"),Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ya.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ya.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Ya.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}uGb(){return this.Fx.getSelectedText()}kbi(){if(!this.hb||!this.hb.ib||1>this.hb.ib.length)return null;var b=this.hb.ib.lb.Pa;b=null==b?null:Bn.FormattingReader.Xr(b);return(b=null==b?null:Hi.a.ug(Bn.FormattingReader.language(b)))?b.name:""}R2a(){return this.Fx.Quf()}mbi(){return this.Fx.Quf()}Bzi(){return this.Fx.jLm()}}Object(n.a)(dM,"WordInsightsManager",eF,[]);var AN=c(215);class eM{}Object(n.a)(eM,"CommandMetadataResponse",null,
[]);class mE{constructor(){this.IAf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){AN.PrivacyDialogManager.bje()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new eM;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),B=Array(2);B[0]=r["default"];B[1]=r.icon32;h.svgData=this.getCommandIconSvg(B)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.IAf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.IAf)return this.IAf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=mE.dCl;h.telemetryGroup=r;h.appData=b;return h}}mE.Poi="FA000000012";mE.queryPrefix="AssetID=";mE.dCl="SearchPane";Object(n.a)(mE,"BaseSerpletExecutor",null,[388,354]);
class fM extends mE{constructor(b,h){super();this.ga=b;this.hb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Mb.a.MKb,2,null);break;case 1:this.ga.Qb(V.a.oRb,2,null);break;case 2:this.ga.Qb(Mb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(eb.a.aZd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(eb.a.WPb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(eb.a.Clf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};aI(this.hb);this.ga.Qb(eb.a.Clf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(eb.a.findInDocument,2,h)}openNavigationPane(){this.ga.Qb(V.a.imc,2,null)}openSerpletTaskPane(){this.ga.Qb(eb.a.ivi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(eb.a.UYd,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(B=>b[B.id]=JSON.stringify(B)))}return b}}Object(n.a)(fM,"WordSerpletExecutor",mE,[]);class gM extends WH{constructor(){super();this.JNe=null;this.$x=()=>{v.AFrameworkApplication.E0&&(this.qtl(),Wq.a.ll().then(()=>this.JNe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){v.AFrameworkApplication.E0&&(this.JNe.Oa("WordEditor.Insights.WordInsightsActor").Ub(),
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?v.AFrameworkApplication.K.Nn(this.$x):super.init())}wc(b){super.wc(b);this.JNe=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new rr.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new TL(v.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new fM(v.AFrameworkApplication.va,lh.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new $F(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new kw(new zf.a(()=>ab.StaticActiveAppFrame.za()?ab.StaticActiveAppFrame.za().jb.Zc:
null),b.resolve("Box4.IParagraphReader"),IL.a.instance,v.AFrameworkApplication.K,Ge.a.instance,rN.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),v.AFrameworkApplication.va,lh.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new RL(new zf.a(()=>ab.StaticActiveAppFrame.za()?ab.StaticActiveAppFrame.za().jb.Zc:null),b.resolve("Box4.IParagraphReader"),Hb.InteractiveViewManager.instance,lh.a.instance,b.resolve("Box4.ISelectionFactory"),
h,qe.App.li.Al.Te(12),new zf.a(()=>ab.StaticActiveAppFrame.za().jb),kb.FocusManager.instance(),v.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Sa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new dM(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();
b.ia("WordEditor.Insights.WordInsightsActor",()=>new UL(b.Ve("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new SL(b.Sa("WordEditor.Extension.DocumentProperties"))).ha()}}Object(n.a)(gM,"WordInsightsPackage",WH,[]);class BN{}Object(n.a)(BN,"ScalingStep",null,[]);class hM{constructor(b,h,
r){this.pxc=!1;this.kQ=null;this.jEc=this.pYb=!1;this.SZa=[];this.Kee=B=>{this.waa&&this.waa!==B&&appChrome.api.dispatch(this.Ygi(!1))};h.execute(B=>{this.kQ=B});b.Xw(Object(z.a)(this,this.Pun,"onProcessSetSelectionFinished"));this.Mo=r}U$b(b,h,r){const B=[];for(const P of b)B.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:P},r));return B}tfi(b){const h=[];for(let r=0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>
r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}Ygi(b){const h=[];if(b)switch(this.waa){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.tfi("PictureStyles"));h.push(...this.U$b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.SZa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.U$b(b,
"MoveToOverflow"));break;case "Table":this.jEc||h.push(...this.tfi("TableStyles"));h.push(...this.U$b(this.SZa,"DropLabel",this.jEc?0:void 0));b=this.SZa.slice().reverse();h.push(...this.U$b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.U$b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.SZa.slice().reverse(),h.push(...this.U$b(b,"MoveToOverflow"))}else for(const r of this.SZa)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return h}Gdd(b){const h={};for(const r of b)try{h[r]=
appChrome.selectors.getModelType(r)}catch(B){this.XG("Error","GetModelType failed for "+r)}ab.StaticActiveAppFrame.za().WPd(h)}yUo(b){if(0!==b.length){var h=[],r={},B=!1;for(const P of b)try{if(appChrome.selectors.isControlDefined(P))r[P]=appChrome.selectors.getModelType(P);else{B=!0;break}}catch(ca){this.XG("Error","GetModelType failed for "+P);B=!0;break}if(B)this.waa=void 0,this.loe(!1);else{if("Image"===this.waa&&!this.pYb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.pYb=!0;
else if(this.pYb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));B=appChrome.selectors.getVisibleControlsInGroup("Font");for(const P of B)r[P]=appChrome.selectors.getModelType(P);this.pYb=!1}ab.StaticActiveAppFrame.za().WPd(r);this.SZa=b;r=[];for(const P of b)appChrome.selectors.isControlDisabled(P)&&r.push(P);0<r.length&&this.XG("Disabled",r.join(","));0<this.SZa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.SZa)),h.push(...this.Ygi(!0)),this.pxc=!0);appChrome.api.dispatch(h)}}}loe(b){if(b||this.pxc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.pxc=b;if("Image"===this.waa||this.pYb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.Gdd(r)}this.pYb=!b}appChrome.api.dispatch(h)}}HVa(){this.pxc&&this.Mo&&this.Mo.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Pun(b,
h){!v.AFrameworkApplication.ta.Kb.Vlc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.kQ&&h.yl&&h.yl.lb&&0!==h.yl.length?(b=()=>{let r=[],B=!1;var P=this.kQ.contentType,ca=appChrome.selectors.getActiveContextualTabIds();P.includes("Image")?(this.Kee("Image"),this.waa&&"Image"===this.waa?B=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.waa="Image")):
P.includes("Table")&&0<=ca.indexOf("Table")?(P=!(vq.a.instance.lb.ZGa||vq.a.instance.lb.Ov||vq.a.instance.lb.$lb),(ca="Table"===this.waa&&P!==this.jEc)?this.Kee("TableCellEdit"):this.Kee("Table"),!this.waa||"Table"!==this.waa||ca?(P?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.jEc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.jEc=!1),this.waa="Table"):B=!0):P.includes("Hyperlink")&&(this.Kee("Hyperlink"),this.waa&&"Hyperlink"===this.waa?B=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.waa="Hyperlink"));B?this.pxc||(this.Gdd(this.SZa),this.loe(!0),this.HVa()):0<r.length?(this.yUo(r),this.HVa()):this.loe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.loe(!1)}XG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new Rj.a;h.name="Events";h.dataFields=sh.a.RH(b);h.durationMs=window.performance.now();oa.a.PIa(h,"TellMeWAC.")}}Object(n.a)(hM,"AdaptiveTabGroupUpdater",null,[]);class iM{constructor(){this.W=null;this.Oln=()=>{v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new hM(this.W.resolve("Box4.ISelectionManager"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"))).ha(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.W=b}init(){jD.a(1,this.Oln)}dispose(){}}Object(n.a)(iM,"PackageManager",null,[1,2]);const CN=(b,h,r)=>1===r?32:2===r?(c.e(4).then(c.bind(null,2093)).then(B=>{B.createAndShowDevToolsMenu()}),32):2;class bI{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))v.AFrameworkApplication.va.qa(V.a.uhg,Gd.a.frame,CN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2093))}dispose(){}wc(){}static main(){L.a.instance.Gc(new bI)}}Object(n.a)(bI,"WordDevToolsPackage",null,[1,2]);c(587);class cI{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(n.a)(cI,"FormattingData",null,[]);class jM extends cI{constructor(){super();this.hyperlinkData=null}}Object(n.a)(jM,"RichContentCommandData",
cI,[]);class Ki{constructor(){Ki.ej.add(V.a.N8a);Ki.ej.add(V.a.JRb);Ki.ej.add(V.a.cnc);Ki.ej.add(V.a.OV);Ki.ej.add(V.a.VTf);Ki.ej.add(V.a.R2f);Ki.ej.add(V.a.deleteComment);Ki.ej.add(V.a.LLc);Ki.ej.add(V.a.Jef);Ki.ej.add(V.a.vje);Ki.ej.add(V.a.$8a);Ki.ej.add(V.a.uhg);Ki.ej.add(V.a.oRb);Ki.ej.add(V.a.Bhg);Ki.ej.add(V.a.MMc);Ki.ej.add(V.a.oMd);Ki.ej.add(Mb.a.digitalPrintToSway);Ki.ej.add(Mb.a.openInClient);Ki.ej.add(Mb.a.print);Ki.ej.add(Mb.a.rbe);Ki.ej.add(Mb.a.k5f);Ki.ej.add(Mb.a.readingMode);Ki.ej.add(Mb.a.MKb);
Ki.ej.add(eb.a.tAj);Ki.ej.add(eb.a.tellMe);Ki.ej.add(eb.a.Ubd);Ki.ej.add(eb.a.WPb);Ki.ej.add(eb.a.giveFeedback);Ki.ej.add(eb.a.dad);Ki.ej.add(eb.a.nhg);Ki.ej.add(eb.a.zsg);Ki.ej.add(eb.a.U8);Ki.ej.add(eb.a.yHa);Ki.ej.add(eb.a.m9e);Ki.ej.add(eb.a.nSa);Ki.ej.add(eb.a.b$f);Ki.ej.add(eb.a.a$f);Ki.ej.add(eb.a.c$f);Ki.ej.add(eb.a.CLd);Ki.ej.add(eb.a.Wma);Ki.ej.add(eb.a.Jje);Ki.ej.add(eb.a.Bsj);Ki.ej.add(eb.a.close);Ki.ej.add(eb.a.kce);Ki.ej.add(eb.a.zbe);Ki.ej.add(eb.a.H9d);Ki.ej.add(eb.a.Eje);Ki.ej.add(eb.a.Ije);
Ki.ej.add(eb.a.ZNb);Ki.ej.add(eb.a.renameFile);Ki.ej.add(eb.a.Lbc);Ki.ej.add(eb.a.aig);Ki.ej.add(eb.a.pmc);Ki.ej.add(eb.a.downloadACopy);Ki.ej.add(eb.a.zkc);Ki.ej.add(eb.a.wae);Ki.ej.add(eb.a.DOb);Ki.ej.add(eb.a.A6i);Ki.ej.add(eb.a.wGh);Ki.ej.add(eb.a.dHd);Ki.ej.add(eb.a.l9e);Ki.ej.add(eb.a.yGh);Ki.ej.add(eb.a.xGh);Ki.ej.add(eb.a.m9e);Ki.ej.add(eb.a.eHd);Ki.ej.add(V.a.Cqe);Ki.ej.add(V.a.qtg);Ki.ej.add(V.a.zoomToPageWidth);Ki.ej.add(V.a.dcg);Ki.ej.add(V.a.Xob);Ki.ej.add(V.a.Dce);Ki.ej.add(V.a.Lka);
Ki.ej.add(eb.a.Fkb);Ki.ej.add(eb.a.fhb);Ki.ej.add(eb.a.smc);Ki.ej.add(eb.a.LMj);Ki.ej.add(eb.a.H6i);Ki.ej.add(V.a.R5c);Ki.ej.add(Mb.a.KNb);Ki.ej.add(Mb.a.jja)}}Ki.ej=new Set;Object(n.a)(Ki,"CommentRibbonCommands",null,[]);class kM{constructor(b,h,r,B,P){this.mSi=b;this.Ch=h;this.Fo=r;this.ol=B;this.QKo=P;this.N_b=null;this.VAa=new Dh.a(0);this.ptb=new Dh.a(0);this.ave=new Dh.a(0);this.yXe=!1;this.UAm();this.BYn()}jKm(b){return this.N_b&&this.Fo.Tx?!Ki.ej.has(b):!1}zac(b,h,r){if(b===eb.a.Jg)return 32;
if(!this.VAa.nb(b)&&!this.ptb.nb(b)||!this.N_b)return 2;const B=this.ptb.nb(b);var P=B?this.ptb.J(b):this.VAa.J(b);const ca=B?2:this.ave.J(r);B||1!==ca||(this.RNm(ab.StaticActiveAppFrame.za().Hp.currentScope.name)||ab.StaticActiveAppFrame.za().Hp.mg(this.Ch.Am?Zd.AFrame.Sr:Zd.AFrame.KM),ab.StaticActiveAppFrame.za().updateCommandUI(!0));r=new jM;switch(P){case 1:r.highlight={color:this.Wfi(h.Color)};break;case 6:r.fontColor={color:this.Wfi(h.Color)}}P=this.N_b.executeCommand(P,ca,r);2===P&&B&&(b===
Mb.a.Ric?h[Df.a.On]=!!r.bold:b===Mb.a.Xic?h[Df.a.On]=!!r.italic:b===Mb.a.fjc?h[Df.a.On]=!!r.underline:b===Mb.a.$ic?h[Df.a.On]=!!r.strikethrough:b===Mb.a.nZ?h[Df.a.On]=!!r.highlight:b===Mb.a.Xv&&(h[Df.a.On]=!!r.fontColor));return 2===P?32:1===P?2:8}FVn(b){this.N_b=b;this.N_b.registerSelectionChangeHandler(()=>{this.yXe||(this.yXe=!0,ab.StaticActiveAppFrame.za().updateCommandUI(!0),this.yXe=!1)});this.N_b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case kc.a.iUb:case kc.a.Msb:case kc.a.jse:case kc.a.tWa:ab.StaticActiveAppFrame.za().updateCommandUI(!0)}h.key!==
kc.a.qC&&h.key!==kc.a.k2||ab.StaticActiveAppFrame.za().updateCommandUI(!0)})}BYn(){this.mSi.s$i(Zd.AFrame.Sr,this);this.mSi.s$i(Zd.AFrame.KM,this)}UAm(){this.VAa.Z(Mb.a.bold,0);this.VAa.Z(Mb.a.fz,3);this.VAa.Z(Mb.a.strikethrough,4);this.VAa.Z(Mb.a.underline,5);this.VAa.Z(Mb.a.nZ,1);this.VAa.Z(Mb.a.hva,1);this.VAa.Z(Mb.a.Xv,6);this.VAa.Z(Mb.a.Mga,6);this.VAa.Z(Mb.a.ura,6);this.ptb.Z(Mb.a.Ric,0);this.ptb.Z(Mb.a.Xic,3);this.ptb.Z(Mb.a.$ic,4);this.ptb.Z(Mb.a.fjc,5);this.ave.Z(1,0);this.ave.Z(2,1)}RNm(b){return b===
Zd.AFrame.Sr||b===Zd.AFrame.KM}Wfi(b){return b?$f.a.eF(this.QKo.pva(this.ol.ed,b)):""}}Object(n.a)(kM,"CommentRibbonCommandHandler",null,[621,622]);class dI{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").T5f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").u$("OnCommentRenderedOnce",
()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new kM(this.W.Oa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),Jk.App.pn.jb.rc,Il.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.W.ia("WordEditor.Comments.CommentRibbonCommands",()=>new Ki).ha()}static main(){L.a.instance.Gc(new dI)}}
Object(n.a)(dI,"PackageManager",null,[1,2]);var DN=c(1984);class eG{constructor(b,h){this.xjl=2E3;this.Jnh=null;this.d0f=b.Y0i;this.maxLength=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.xjl);h&&h.execute(r=>{this.Jnh=r})}ipf(b){b=this.VQl(b,this.maxLength);return{semantic:Pc.ObjectSemantic.CanvasContext,type:Pc.ObjectSchemaType.WordCanvasContext,value:b}}VQl(b,h){try{return this.UQl(b,h)}catch(r){return t.ULS.sendTraceTag(522725067,1303,15,
"Error processing selection for Canvas Context: {0}",r),null}}sem(b,h){const r={O1a:[],tya:0,selection:{start:null,end:null},cursor:null,tiles:[]},B=b.length;for(let ca=0;ca<B;ca++){const ra=b.J(ca);var P=ra.node;if(!Td.ParagraphReader.Xb(P)||Array.contains(r.O1a,P.Uk))continue;r.O1a.push(P.Uk);const Qa=Td.ParagraphReader.textLength(P);if(r.tya+Qa>h)break;P=this.d0f.aDb(P);r.tiles.push(P);r.tya+=Qa;1!==B||r.cursor||(r.cursor=eG.iVl(ra,r.tiles.length-1));null===r.selection.start&&0===ca&&(r.selection.start=
this.vji(ra,!0,r.tiles.length-1));null===r.selection.end&&ca===B-1&&(r.selection.end=this.vji(ra,!1,r.tiles.length-1))}return r}j6l(b,h,r){const B={hcd:[],Xzj:[],tya:0};var P=b.J(0).node;let ca=b.J(b.length-1).node;for(b=h;0<b&&(P||ca);){var ra=eG.l5i(P,!0,b,r);if(P=ra.node)P=this.d0f.aDb(P),B.hcd.push(P),b-=ra.tya,P=ra.node,r=ra.O1a;ra=eG.l5i(ca,!1,b,r);if(ca=ra.node)r=this.d0f.aDb(ca),B.Xzj.push(r),b-=ra.tya,ca=ra.node,r=ra.O1a}B.tya=h-b;return B}WQl(b,h){let r=0;var B=this.sem(b,h);const P={tiles:B.tiles,
selection:B.selection,cursor:B.cursor};r+=B.tya;B=B.O1a;r<h&&(b=this.j6l(b,h-r,B),P.tiles.unshift.apply(P.tiles,b.hcd),P.tiles.push.apply(P.tiles,b.Xzj),P.selection.start&&(P.selection.start.index+=b.hcd.length),P.selection.end&&(P.selection.end.index+=b.hcd.length),P.cursor&&(P.cursor.index+=b.hcd.length));return P}UQl(b,h){var r;if(!b)return null;b=this.WQl(b,h);return{contentType:null===(r=this.Jnh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}vji(b,
h,r){if(b.contextId===zc.a.Fd||b.contextId===zc.a.paragraph||b.contextId===zc.a.Tc){if(h&&-1!==b.Wj)return{index:r,offset:b.Wj};if(!h&&-1!==b.vp)return{index:r,offset:b.vp}}return null}static iVl(b,h){return b.contextId===zc.a.Tc?{index:h,offset:b.Wj}:null}static l5i(b,h,r,B){B={node:null,tya:0,O1a:B};if(!b||0>=r||!B.O1a)return B;do B.node=Td.ParagraphReader.Wf(b,h,!1,!1),B.tya=B.node?Td.ParagraphReader.textLength(B.node):0,b=B.node;while(B.node&&(Array.contains(B.O1a,B.node.Uk)||!Td.ParagraphReader.Xb(B.node)||
!B.tya));B.node&&(B.tya>r?B.node=null:B.O1a.push(B.node.Uk));return B}}Object(n.a)(eG,"Box4CanvasContextProvider",null,[319]);class eI{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new eG(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Sa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){L.a.instance.Gc(new eI)}}Object(n.a)(eI,"Box4CanvasContextPackage",null,
[1,2]);class lM{constructor(b,h,r,B){this.GI={};this.Z1b=this.Fwd=0;this.NKd=3E4;this.start=()=>{0!=this.EAb.size&&0===this.Z1b&&(this.Z1b=window.setInterval(this.uao,this.NKd),t.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.uao=()=>{if(0!=this.EAb.size)if(this.rf.Io)t.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var P=50;this.GI.ScanTime=Date.now();this.GI.NumWatchDogs=this.EAb.size;this.GI.WatchDogManagerScanNumber=++this.Fwd;this.EAb.forEach(async(ca,
ra)=>{this.GI[ra]=await ca.ofn();this.hQm&&"KickoutComponent"==this.GI[ra].ComponentStatus&&this.eKf(this.IXl(ra));ca.xYm()||(P=15)});t.ULS.sendTraceTag(520974674,306,P,JSON.stringify(this.GI))}};this.rf=b;this.S_b=r;this.g_=B;this.zYe=new Map;this.EAb=new Map;h.execute(P=>{this.am=P;this.am.K_a((ca,ra)=>{this.mY(ra)})})}mY(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.Z1b||(t.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",
b.newState),this.stop()):(this.stop(),this.start(),this.I7n(),t.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.Z1b&&(window.clearInterval(this.Z1b),this.Z1b=0);t.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}Rvk(b,h){this.zYe.set(b,h)}k8n(){this.SGn(this.zYe)}get jCk(){return this.zYe.size===this.EAb.size}SGn(b){b.forEach((h,r)=>{h.execute(B=>{B?(this.EAb.set(r,B),this.start()):t.ULS.sendTraceTag(512550848,306,10,
"WatchDog {0} resolved to null",r)})})}I7n(){this.EAb.forEach(b=>{b&&b.rza()});t.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}eKf(b){0<this.S_b.KVa&&this.g_.Pec(b)}IXl(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?vg.a.U8o:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?vg.a.T8o:null}get hQm(){return null!=this.RDg?this.RDg:this.RDg=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KickoutEnabledFromWatchDogs",!1)}}Object(n.a)(lM,
"WatchDogManager",null,[318]);class fI{constructor(){this.W=this.DAb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.DAb=this.W.resolve(this.name);this.UCm()}dispose(){this.DAb&&this.DAb.stop()}wc(b){this.W=b;b.ia(this.name,this.Dgl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){L.a.instance.Gc(new fI)}G3o(){if(!this.DAb.jCk){const b=[];let h=0;this.Awd.forEach((r,B)=>{r&&(this.W.Oa(B)||(b[h++]=B))});if(0<b.length){const r=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").YU;
t.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}Dgl(){return new lM(this.W.resolve("Common.ISessionStatus")||gc.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),this.W.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.W.resolve("Wonca.KickoutExecutor"))}Kwk(){window.setTimeout(this.G3o.bind(this),this.$4o)}Rwk(){this.Awd=new Map;this.Awd.set("WordEditor.RunawayDataLossMonitorWatchDog",qe.App.Cm||qe.App.Fs);this.Awd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",
!0)}UCm(){this.Rwk();this.Qwk(this.Awd,this.DAb.Rvk.bind(this.DAb));this.DAb.k8n();this.Kwk()}Qwk(b,h){b.forEach((r,B)=>{r&&h(B,this.W.Sa(B))})}get $4o(){return null!=this.UKg?this.UKg:this.UKg=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(n.a)(fI,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");
Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");
Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");
Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");
Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");
Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");S.main();Type.registerNamespace("Common.App.WopiIdentity");sa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Dc.main();Object(DN.a)(!1);AE.main();wb.main();
rb.main();cb.main();bI.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");oc.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Tf.main();Type.registerNamespace("Common.App.WildFire");eg.main();Type.registerNamespace("Common.App.BrowserInfoLogger");ad.main();Type.registerNamespace("Common.App.HostNotification");
Zb.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Bh.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Sf.main();Type.registerNamespace("CNT");fh.main();Type.registerNamespace("Common.App.NewAndOpen.Core");L.a.instance.Gc(new Xn);Type.registerNamespace("Common.App.NewAndOpen.UX");L.a.instance.Gc(new am);Type.registerNamespace("Common.App.OneDriveFilePickerApi");
Qe.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");ge.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");rk.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");gl.main();Type.registerNamespace("CADWLTR");Ga.main();Type.registerNamespace("Common.App.DirectPrint");
L.a.instance.Gc(new wi);Type.registerNamespace("Common.App.SearchOAuthManager");xi.main();Xk.main();jo.main();To.main();ep.main();Zh.main();L.a.instance.Gc(new Xi);Oi.main();nb.main();ph.main();L.a.instance.Gc(new jd);Type.registerNamespace("Common.App.SaveStatus");L.a.instance.Gc(new cn);Type.registerNamespace("Common.App.EventsCacheManager");zq.main();Type.registerNamespace("CUIB");Ql.main();Type.registerNamespace("CommandUI.TaskPane");try{L.a.instance.Gc(new Dv(ab.StaticActiveAppFrame.za().jb))}catch(b){t.ULS.shipAssertTag(575930383,
3016,!1,b.message)}Vo.main();Type.registerNamespace("Common.App.Insights");Hp;L.a.instance.Gc(new Sm);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Hl("Begin");L.a.instance.Gc(new dx);try{L.a.instance.Gc(new tp(Qk.a.get_instance(),ab.StaticActiveAppFrame.za().jb,ab.StaticActiveAppFrame.za().Kb))}catch(b){t.ULS.shipAssertTag(575930384,
3016,!1,b.message)}Ra.main();L.a.instance.Gc(new Nc);Yq.main();zs.main();Rr.main();Yu.main();ct.main();Gy.main();tq.main();MB.main();L.a.instance.Gc(new dy);ey.main();Vl.main();px.main();Sv.main();eI.main();dI.main();L.a.instance.Gc(new Od);L.a.instance.Gc(new HC);Wr.main();Hw.main();Et.main();L.a.instance.Gc(new vx);L.a.instance.Gc(new Mw);KC;aw.main();wy.main();NC.main();kg.main();ud;L.a.instance.Gc(new da);L.a.instance.Gc(new pc);ae.main();nE.main();kB.main();L.a.instance.Gc(new Hj);L.a.instance.Gc(new tF);
Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=yz;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Ps.main();nD.main();CE.main();mG;sH.main();KM;window.MSOJS=vD;OH.main();RH.main();L.a.instance.Gc(new gM);L.a.instance.Gc(new iM);(async()=>{v.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(28).then(c.bind(null,2104)).then(b=>{b.initializeOnDemandPackage()})})();
fI.main();ek.main()},2112:function(D,J,c){D=c(0);var l=c(7),e=c(1638);class a{static get bcn(){return 50}static ZTd(x){if(""===x)return"";let y=0,n="";try{const t=e.a.hGb(x);for(const z of t.ops)if(a.SG(z))y||(n+=a.VYl(z.attributes.atmention.fullName)),y+=1;else{const v=z.insert?z.insert:"";" "!==v&&0<v.length&&(y=0,n+=v)}}catch(t){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static USl(x){x=a.ZTd(x);return 0<
x.length&&x.split(" ").length<=a.bcn?x:null}static VYl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static SG(x){return!!x.attributes&&!!x.attributes.atmention}}Object(D.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(J,"a",function(){return k});class k extends a{constructor(){super()}static ZFb(x,y,n=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Df||""===y.Df;return 0<x.length&&y&&!n?a.USl(x):null}}Object(D.a)(k,"CommentSmartReplyHelpers",a,[])},960:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.method=this.api=0}}Object(D.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20380705/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll1.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1533:function(D,J,c){c.r(J);c.d(J,"RtcUtils",function(){return k});D=c(0);var l=c(7),e=c(1565),a=c(35);class k{static T7e(x,y=e.RealtimeChannel.APf){let n;try{n=a.c(x)}catch(t){throw x=String.format("Failed to JSON-serialize payload : {0}",t),l.ULS.sendTraceTag(18637072,500,10,x),Error.argument("payload",x);}if(n.length>y)throw x=String.format("Payload exceeds maximum length: {0} > {1}.",n.length,y),l.ULS.sendTraceTag(18637074,
500,10,x),Error.argument("payload",x);return n}static deserialize(x,y,n){if(!x)return null;if(Object.getType(x)!==String){var t=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",y,Object.getType(x).getName(),n);l.ULS.sendTraceTag(18637075,500,10,t);return null}t=null;try{t=a.a(x)}catch(z){x=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",y,z,n),l.ULS.sendTraceTag(18637077,
500,10,x)}return t}static Mgc(x){if(!x)return"";if("string"===typeof x)return x.toString();try{return a.c(x)}catch(y){return x.toString()}}static aBl(x){let y,n,t;y=0;t=n=null;if(!x)return{Wpi:y,Ypi:n,exception:t};try{const z=x.source;z&&Object.getType(z)===String&&(t=z);const v=x.context;v&&(x=v,y=x.status?x.status:0,n=x.statusText?x.statusText:null)}catch(z){}return{Wpi:y,Ypi:n,exception:t}}}Object(D.a)(k,"RtcUtils",null,[])},1554:function(D,J,c){c.r(J);D=c(0);var l=c(7),e=c(55),a=c(85),k;(function(t){t[t.SendNotification=
0]="SendNotification";t[t.SendPersistentState=1]="SendPersistentState";t[t.FindSession=2]="FindSession";t[t.Last=3]="Last"})(k||(k={}));Object(D.b)("ApiType",k);var x;(function(t){t[t.AttemptCount=0]="AttemptCount";t[t.SuccessCount=1]="SuccessCount";t[t.DropCount=2]="DropCount";t[t.FailedCount=3]="FailedCount";t[t.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";t[t.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";t[t.ThrottledCount=6]="ThrottledCount";t[t.Last=7]="Last"})(x||(x=
{}));Object(D.b)("EventCountType",x);var y=c(1654);c.d(J,"FrequentLoggingMetrics",function(){return n});class n{constructor(t){this.DIh=this.M0h=null;this.rOi=this.I3h=0;this.fu=null;this.E6g=this.uKe=0;this.Zf=t;this.bCm();this.iBe=this.gWg=this.dLe=!1;this.czc=0}get tAl(){return this.iBe}ADo(t){this.E6g=t;window.setInterval(Object(e.a)(this,this.NNf,"logMetricsBatchAndReset"),t);this.uKe=(new Date).getTime()}rP(t,z){this.fso(t)&&!this.gWg||this.tAl||!window.navigator.onLine||this.Zf.KRa||(this.fu[t][z]++,
this.dLe=!0)}bCm(){this.fu=Array(3);for(let t=0;3>t;t++){this.fu[t]=Array(7);for(let z=0;7>z;z++)this.fu[t][z]=0}}HOk(){const t={};for(let z=0;3>z;z++)for(let v=0;7>v;v++)this.$Xm(z,v)&&(t[k[z]+x[v]]=this.fu[z][v]);t.FSDomain=this.M0h;t.ConnectionDomain=this.DIh;t.FSRetryInterval=this.I3h;t.MaxPayloadSize=this.rOi;t.LogNumber=this.czc;1===this.czc&&(t.FSLatencies=y.a.instance.IYl(),t.ConLatencies=y.a.instance.jTl());return t}$Xm(t,z){return 2===t&&3!==z&&0!==z?!1:!0}fso(t){return 2===t?!1:!0}NNf(){if(this.dLe){this.czc++;
if((new Date).getTime()-this.uKe<5E3+this.E6g){var t=a.a.toJSON(this.HOk());l.ULS.sendTraceTag(50644352,500,15,t)}this.uKe=(new Date).getTime();for(t=0;3>t;t++)for(let z=0;7>z;z++)this.fu[t][z]=0;this.dLe=!1}}Can(){this.gWg=!0}static get instance(){return n._instance}static create(t){n.instance||(n._instance=new n(t));return n.instance}}n._instance=null;Object(D.a)(n,"FrequentLoggingMetrics",null,[1095])},1565:function(D,J,c){c.r(J);D=c(0);var l=c(7),e=c(55),a=c(464),k=c(889),x=c(83),y=c(2);class n{constructor(ta,
fa){this.status=ta;this.$ec=fa}}Object(D.a)(n,"UserStatusInfo",null,[]);var t=c(46),z=c(1654);class v{constructor(ta,fa){this.data=ta;this.timeStamp=fa}}Object(D.a)(v,"PresenceData",null,[]);class I{constructor(ta){this.PCa=!1;this.$zb=0;this.hxe=!1;this.setTimeout=I.vef;this.clearTimeout=I.mef;this.Y8m=Object(e.a)(this,this.b8m,"logRtcConnectingUsageStatement");this.aw=ta}ynn(){this.PCa||(this.$zb=this.setTimeout(()=>{this.PCa=!1;this.ILi()},8E3),this.PCa=!0,this.hxe=!1)}ton(){this.W_()}Avn(){this.ILi()}ILi(){this.W_();
this.hxe||(this.hxe=!0,this.Y8m())}b8m(){l.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.aw)}W_(){this.PCa&&this.clearTimeout(this.$zb);this.$zb=0;this.PCa=!1}static vef(ta,fa){return window.setTimeout(ta,fa)}static mef(ta){window.clearTimeout(ta)}}Object(D.a)(I,"ConnectedUsageKpiLogger",null,[1120]);class E{constructor(){this.w8i=this.u6f;this.z8i=this.x6f;this.y8i=this.w6f;this.D8i=this.z6f;this.C8i=this.y6f;this.K6f=this.L6f;this.r6c=this.I6f;this.LOb=
this.G6f;this.MOb=this.H6f;this.x8i=this.v6f;this.b6a=this.zTf;this.ZLb=this.ATf}u6f(){}x6f(){}w6f(){}z6f(){}y6f(){}I6f(){}H6f(){}G6f(){}L6f(){}v6f(){}zTf(){}ATf(){}}Object(D.a)(E,"NoopRealtimeChannelMetrics",null,[1107,158]);class H{}H.Tdd="presenceUpdated";H.updateNotification="updateNotification";H.z2i="persistentStateCleared";H.updatePersistentState="persistentStateUpdated";Object(D.a)(H,"RtcClientMethodNames",null,[]);class M{}M.Lwm="realtimeChannelHub";M.Tdd="UpdatePresence";M.qN="SendUpdateNotification";
M.Cpf="GetCompletePersistentStateWithMetadata";M.updatePersistentState="UpdatePersistentState";M.Yrb="UpdateClientInfo";Object(D.a)(M,"RtcHubMethodNames",null,[]);class K{constructor(ta){this.gw=ta}lYn(ta){this.gw.on(H.Tdd,ta)}gZn(ta){this.gw.on(H.updateNotification,ta)}jYn(ta){this.gw.on(H.updatePersistentState,ta)}iYn(ta){this.gw.on(H.z2i,ta)}GTo(ta){this.gw.off(H.Tdd,ta)}QTo(ta){this.gw.off(H.updateNotification,ta)}FTo(ta){this.gw.off(H.updatePersistentState,ta)}ETo(ta){this.gw.off(H.z2i,ta)}Tdd(ta){return this.gw.invoke(M.Tdd,
ta)}Yrb(ta){return this.gw.invoke(M.Yrb,ta)}qN(ta,fa){return this.gw.invoke(M.qN,ta,fa)}Cpf(ta){return this.gw.invoke(M.Cpf,ta)}updatePersistentState(ta,fa){return this.gw.invoke(M.updatePersistentState,ta,fa)}}Object(D.a)(K,"RealtimeChannelProxy",null,[1117,1118,1119]);class L{constructor(){this.Eue=this.WMg=!1;this.Cue=0;this.vwe=this.eTe=this.dTe=this.Dte=!1;this.KBe=0;this.Peh=!1;this.Oeh=this.Neh=0;this.yRe=!1;this.FRe=this.DRe=this.HRe=this.zRe=0;this.ERe=!1}get PJk(){return this.Eue}get OJk(){return this.Cue}get mCk(){return this.Dte}get Mto(){return this.dTe}get Nto(){return this.eTe}get k_k(){return this.vwe}get $Od(){return this.KBe}get P$n(){return this.Peh}get Lgj(){return this.Neh}get O$n(){return this.Oeh}get K$n(){return this.yRe}get L$n(){return this.zRe}get Rgj(){return this.HRe}get Mgj(){return this.DRe}get Ogj(){return this.FRe}get Ngj(){return this.ERe}static createInstance(ta){const {RealtimeChannel:fa}=
c(1565);return ta?Object.assign(new L,{WMg:ta.$("AwayStatusManagerIsEnabled"),Eue:ta.$("AwayStatusOneMinuteTimeoutIsEnabled"),Cue:ta.nc("AwayCoauthorThresholdMs",9E5),Dte:ta.$("RtcAllowCrossDomainAccessEnabled"),dTe:ta.$("ShouldLogOnContentNotification"),eTe:ta.$("ShouldLogOnHostSubscriptionNotification"),vwe:ta.$("RtcClientMetricsEnabled"),KBe:ta.nc("RtcFindSessionRequestTimeoutInMS",6E4),Peh:ta.$("RtcJsClientFrequentlyLogsMetrics"),Neh:ta.nc("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),
Oeh:ta.nc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),yRe:ta.$("RtcClientMessageTelemetryEnabled"),zRe:ta.nc("RtcClientMessageTelemetrySampleSize",5),HRe:ta.nc("RtcSendTelemetryMessageIntervalInMS",3E5),DRe:ta.nc("RtcLogClientMessageMetricsTimeOutInMs",2E4),FRe:ta.nc("RtcMaxPayloadSizeInCharactersOverride",fa.APf),ERe:ta.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new L,{WMg:!1,Eue:!1,Cue:9E5,Dte:!1,dTe:!1,eTe:!0,vwe:!1,KBe:9E4,yRe:!1,
zRe:5,HRe:3E5,DRe:2E4,FRe:fa.APf,ERe:!1})}}Object(D.a)(L,"RealtimeChannelSettings",null,[1111]);var S=c(1788),Q=c(69),N=c(153);class O{constructor(ta){this.BEc=null;this.oUa=0;this.SEb=!1;this.ym=ta;this.ym.Kua(Object(e.a)(this,this.dja,"onConnectionStateChanged"))}dja(ta,fa){this.oUa=fa.newState}gwn(){l.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.ym.Xce()}xAm(ta){this.BEc.init(ta)}}Object(D.a)(O,"ARtcMessageHandler",null,[]);var X=c(358);class U{constructor(){this.Presence=
null;this.TimeStamp=0}}Object(D.a)(U,"PresenceDataEntryForClients",null,[]);var T=c(85);class Y{constructor(ta,fa=""){this.djk=ta;this.zta=fa}send(){return this.djk()}get messageId(){return this.zta}}Object(D.a)(Y,"MessageHandler",null,[1126]);var aa=c(1681);class ba extends Sys.EventArgs{constructor(ta,fa,Xa,ob){super();this.W9f=ta;this.reconnectDelay=fa;this.reason=Xa;this.pcg=ob}}Object(D.a)(ba,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var oa=c(1739);class ma{constructor(){this.xUe=this.ki=
null}get pi(){return this.ki?this.xUe?this.xUe.getTime()-this.ki.getTime():(new Date).getTime()-this.ki.getTime():0}start(){this.ki=new Date}stop(){this.xUe=new Date}}Object(D.a)(ma,"SimpleStopwatch",null,[]);var ea=c(1740),ua;(function(ta){ta[ta.contentUpdate=0]="contentUpdate";ta[ta.editorsTableUpdate=1]="editorsTableUpdate";ta[ta.fileNameUpdate=2]="fileNameUpdate";ta[ta.wetContentUpdate=3]="wetContentUpdate";ta[ta.persistedContentUpdate=4]="persistedContentUpdate";ta[ta.clientRtcReconnectRequest=
5]="clientRtcReconnectRequest";ta[ta.replicationTelemetry=6]="replicationTelemetry";ta[ta.lockUpdate=7]="lockUpdate";ta[ta.collabServiceContentUpdate=8]="collabServiceContentUpdate";ta[ta.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";ta[ta.saveTargetUpdate=10]="saveTargetUpdate";ta[ta.uploadToOcsUpdate=11]="uploadToOcsUpdate";ta[ta.labelUpdate=12]="labelUpdate";ta[ta.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";ta[ta.subscribeOrExtend=14]="subscribeOrExtend";
ta[ta.elapsedBootTelemetry=15]="elapsedBootTelemetry";ta[ta.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";ta[ta.clientToClientResponseMessage=17]="clientToClientResponseMessage";ta[ta.verifyNotificationPipeline=18]="verifyNotificationPipeline";ta[ta.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";ta[ta.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";ta[ta.last=21]="last"})(ua||(ua={}));Object(D.b)("UpdateNotificationType",ua);var sa=c(769),Fa=c(606),Pa=c(607);
class Na extends O{constructor(ta,fa,Xa,ob,xb,zb,Lb,Ia,Ya,eb){super(Lb);this.gw=null;this.s6g=this.u6g=!1;this.zta=0;this.AOe=new N.a;this.L$j=Na.LTl();this.INe=y.AFrameworkApplication.K.kb("OwningFeatureCrewForRtcNotificationKpis");this.Vf=ta;this.c9g=this.b9g=0;this.BEc=fa;this.BEc.HCd(Object(e.a)(this,this.gwn,"onTooManyUndeliveredMessages"));this._clientId=Xa;this.Ggk=xb;this.ym.Fzk(Object(e.a)(this,this.Atn,"onRefreshProxyRequired"));this.ym.Dzk(Object(e.a)(this,this.ytn,"onRefreshAllPersistentStateRequest"));
this.ym.Nzk(Object(e.a)(this,this.qN,"sendUpdateNotification"));this.ym.Cxk(Object(e.a)(this,this.Iqn,"onInternalPresenceUpdated"));this.ym.Dxk(Object(e.a)(this,this.Jqn,"onInternalUpdateNotificationReceived"));this.ym.Bxk(Object(e.a)(this,this.Hqn,"onInternalPersistentStateUpdated"));this.ym.Axk(Object(e.a)(this,this.Gqn,"onInternalPersistentStateCleared"));this.ym.Lzk(Object(e.a)(this,this.Rkc,"sendPersistentState"));this.ym.$zk(Object(e.a)(this,this.Yrb,"updateClientInfo"));this.je=zb;this.aw=
ob;this.fu=Ia;this.wW=Ya;this.Azc=eb;this.Xea=Object(Q.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.Application)||""}Atn(ta,fa){this.gw=this.Ggk(fa.hubConnection);this.BEc.reset();this.gw.lYn(Object(e.a)(this,this.t5,"onPresenceUpdated"));this.gw.jYn(Object(e.a)(this,this.eTa,"onPersistentStateUpdated"));this.gw.iYn(Object(e.a)(this,this.ihc,"onPersistentStateCleared"));this.gw.gZn(Object(e.a)(this,this.l1,"onUpdateNotificationReceived"))}dja(ta,fa){this.oUa=fa.newState;2===fa.newState&&
this.ffo()}ffo(){for(let ta of this.AOe)this.qN(null,new oa.a(ta.key,ta.value,!1,new a.a));this.AOe=new N.a}ytn(ta,fa){fa.x8e();for(ta=0;3>ta;++ta)this.Heo(ta,fa)}Heo(ta,fa){try{this.gw.Cpf(ta).done(Xa=>{fa.ypc(fa.s$e,"GetCompletePresenceSuccess")&&(fa.U4k.Avn(),l.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.aw,ta),this.ym.APn(),this.Hsn(ta,Xa),this.ym.QOn(Xa),fa.rZh.nb(ta)&&this.ym.t7i(ta,fa.rZh.J(ta),new a.a))}).fail(Xa=>{const {RtcUtils:ob}=
c(1533);fa.ypc(fa.s$e,"GetCompletePresenceFail")&&(l.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",ob.Mgc(Xa),this.aw,ta),this.ym.Xce())}).always(()=>{fa.YA&&fa.YA.stop()})}catch(Xa){l.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",fa.s$e,Xa.message)}}Rkc(ta,fa){var {RtcUtils:Xa}=c(1533);ta=fa.presence;
let ob;const xb=fa.U8a;this.wW.rP(1,0);try{ob=Xa.T7e(ta,this.Azc)}catch(Lb){this.wW.rP(1,3);l.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Lb.message);xb.setException(Lb);return}Xa=new x.a;Xa.Z(this._clientId,Object.assign(new U,{Presence:ta,TimeStamp:(new Date).getTime()}));this.ym.A7i(fa.type,Xa);if(2!==this.oUa)this.fu.LOb(),this.wW.rP(1,2),xb.Dg(null);else{var zb=this.zta.toString();++this.zta;ta=new Y(()=>this.hfo(fa.type,ob,
zb),zb);ta=this.Pzj(0,fa.type).add(ta);ta.i8d(Lb=>{2===Lb&&this.wW.rP(1,6);xb.Dg(null)});ta.h8d(()=>{})}}hfo(ta,fa,Xa){let ob=null;const xb=new ma,zb=new aa.a;l.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.aw,ta);if(2!==this.oUa)return this.fu.LOb(),this.wW.rP(1,2),l.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.aw,ta),zb.lPf(),zb;this.je&&20>this.b9g&&(ob=this.je.Yf("WebServiceCall","Send Presence Message"),
this.b9g++);xb.start();zb.m0c(1);try{this.gw.updatePersistentState(ta,fa).done(()=>{this.fu.r6c();this.wW.rP(1,1);l.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",Xa,this.aw,ta);zb.Vmb(1);xb&&(xb.stop(),xb.pi>this.Vf.Lgj?this.wW.rP(1,4):this.wW.rP(1,5))}).fail(Lb=>{const {RtcUtils:Ia}=c(1533);this.SEb||(this.fu.LOb(),this.wW.rP(1,3),l.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",
Xa,Ia.Mgc(Lb),this.aw));zb.Vmb(2)}).always(()=>{ob&&ob.stop()})}catch(Lb){l.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",Lb.message),this.wW.rP(1,3),zb.Vmb(2)}return zb}Yrb(ta,fa){({RtcUtils:ta}=c(1533));const Xa=fa.j_k,ob=fa.U8a;let xb;try{xb=ta.T7e(Xa,this.Azc)}catch(zb){l.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",zb.message);ob.setException(zb);return}try{this.gw.Yrb(xb).done(()=>
{l.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(zb=>{const {RtcUtils:Lb}=c(1533);this.SEb||l.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Lb.Mgc(zb));ob.Dg(null)})}catch(zb){l.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",zb.message),ob.Dg(null)}}qN(ta,fa){({RtcUtils:ta}=c(1533));const Xa=fa.type,ob=fa.OL,xb=fa.cml,zb=fa.U8a;let Lb;this.wW.rP(0,0);try{Lb=ta.T7e(ob,this.Azc)}catch(Ya){this.wW.rP(0,
3);l.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Ya.message);zb.setException(Ya);return}if(2!==this.oUa)xb?this.AOe.Z(Xa,ob):(this.fu.LOb(),this.wW.rP(0,2)),zb.Dg(null);else{var Ia=this.zta.toString();++this.zta;fa=new Y(()=>this.Yfo(Xa,Lb,Ia),Ia);fa=this.Pzj(1,Xa).add(fa);fa.i8d(Ya=>{2===Ya&&this.wW.rP(0,6);zb.Dg(null)});fa.h8d(()=>{})}}Yfo(ta,fa,Xa){let ob=null;const xb=new ma,zb=new aa.a;l.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",
this.aw,ta);if(2!==this.oUa)return this.fu.LOb(),this.wW.rP(0,2),l.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.aw),zb.lPf(),zb;this.je&&3===ta&&20>this.c9g&&(ob=this.je.Yf("WebServiceCall","Send WetContent Update"),this.c9g++);xb.start();zb.m0c(1);this.gw.qN(ta,fa).done(()=>{this.fu.r6c();this.wW.rP(0,1);l.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",Xa,this.aw,ta);zb.Vmb(1);
xb&&(xb.stop(),xb.pi>this.Vf.Lgj?this.wW.rP(0,4):this.wW.rP(0,5))}).fail(Lb=>{const {RtcUtils:Ia}=c(1533);this.SEb||(this.fu.LOb(),this.wW.rP(0,3),l.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Xa,Ia.Mgc(Lb),this.aw));zb.Vmb(2)}).always(()=>{ob&&ob.stop()});return zb}p6(){this.gw.GTo(Object(e.a)(this,this.t5,"onPresenceUpdated"));this.gw.FTo(Object(e.a)(this,this.eTa,"onPersistentStateUpdated"));this.gw.ETo(Object(e.a)(this,this.ihc,
"onPersistentStateCleared"));this.gw.QTo(Object(e.a)(this,this.l1,"onUpdateNotificationReceived"))}Iqn(ta,fa){this.t5(fa.asa,fa.ILd)}t5(ta){this.fu.MOb();this.eTa(0,ta)}Hqn(ta,fa){this.eTa(fa.type,fa.asa)}Hsn(ta,fa){const Xa={};for(let ob in fa)Xa[ob]=fa[ob].Presence;this.zXi(ta,Xa,fa)}eTa(ta,fa){this.fu.MOb();this.zXi(ta,fa)}zXi(ta,fa,Xa=null){var {RtcUtils:ob}=c(1533);if(l.ULS.R$(500,100))for(var xb in fa);delete fa[this._clientId];if(!T.a.isEmpty(fa)){for(var zb in fa)xb=zb,fa[xb]=ob.deserialize(fa[zb],
"Presence",xb,!1,this.Azc);ob=new x.a;zb=(new Date).getTime();for(let Lb in fa){xb=fa[Lb];let Ia=Lb,Ya;Xa?(Ya=Xa[Ia],Ya.Presence=xb):Ya=Object.assign(new U,{Presence:xb,TimeStamp:zb});ob.Z(Ia,Ya)}this.ym.A7i(ta,ob);switch(ta){case 0:this.u6g||(l.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.aw),this.u6g=!0,y.AFrameworkApplication.Og&&y.AFrameworkApplication.Og.van());this.ym.m7i(fa,[]);break;case 2:this.s6g||(l.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",
this.aw),this.s6g=!0);this.ym.k7i(ta,fa);break;default:this.ym.k7i(ta,fa)}}}Gqn(ta,fa){this.ihc(fa.SGd)}ihc(ta){this.fu.MOb();if(l.ULS.R$(500,100))for(let fa=0;fa<ta.length;++fa);ta.length&&(this.ym.QPn(ta),this.ym.qPn(ta),this.ym.m7i({},ta))}Jqn(ta,fa){this.l1(fa.type,fa.OL)}l1(ta,fa=null){this.Vf.Mto&&0===ta&&l.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===ta&&this.INe&&0<this.INe.length){var Xa=Object.assign(new sa.a,{topLevelKpiName:"ContentUpdateNotificationReceived",
featureName:"RtcNotification",crewAlias:this.INe,vetoPillar:"RealTimeCoauth"});(Xa=X.a.getInstance(Xa))&&Xa.logKpiUsage(this.L$j)}this.Vf.Nto&&13===ta&&l.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",fa||"<none>"));this.fu.MOb();5===ta?(fa=(ta=this.TBn(fa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",ta.reason,ta.reconnectDelay):"Received client reconnection request from the server without params.",
l.ULS.sendTraceTag(18637071,500,50,fa),this.ym.Xce(ta)):(fa=c(1533).RtcUtils.deserialize(fa,String.format("UpdateNotification-{0}",ua[ta]),null,!1,this.Azc),this.ym.PPn(ta,fa))}TBn(ta){try{if(!ta||""===ta)return null;const fa=JSON.parse(ta);return new ba(fa[ea.a.$ag],fa[ea.a.J$n],fa[ea.a.N$n],fa[ea.a.pcg])}catch(fa){return l.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",fa.message),null}}Pzj(ta,fa){return this.BEc.xim(this.yim(ta,fa))}yim(ta,fa){return ta+","+fa}static LTl(){var ta=
new Map;ta.set("SkipAria","True");ta=Object.assign(new Fa.a,{extendedProperties:ta});return Object.assign(new Pa.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:ta,blockFutureEmissionDurationInMs:3E5})}}Object(D.a)(Na,"RtcMessageHandler",O,[]);class Aa{dNh(ta,fa=""){const {MaxOutstandingThrottler:Xa}=c(1736);return Xa.createInstance(ta,fa)}Kcl(ta,fa=""){const {MaxRateThrottler:Xa}=c(1738);return Xa.createInstance(ta,fa)}}Object(D.a)(Aa,"ThrottlerFactory",null,[1109]);var za=
c(81),xa=c(1741);class ka{constructor(ta){this.Vf=null;this.Zh=!1;this.sa=new za.a;this.PKe=new x.a;this.NKe=new x.a;this.$Ve=ta;this.HXb=this.$Ve.dNh(fa=>fa.send(),"GlobalMaxOustandingThrottler");this.HXb.HCd(()=>{this.sa.raiseEvent("TMUDM")})}init(ta){this.Zh||(this.Vf=ta,this.HXb.init(this.Vf.Arb,this.Vf.Nmm),this.Zh=!0)}xim(ta){var {MaxRateThrottler:fa}=c(1738),{MaxOutstandingThrottler:Xa}=c(1736);this.Zh||this.init(new xa.a(fa.zQh,Xa.cRh,Xa.KQh,ka.ecn));({value:fa}=this.PKe.Fc(ta)).returnValue||
(({value:fa}=this.NKe.Fc(ta)).returnValue||(fa="MaxOutstandingThrottler-"+ta,fa=this.$Ve.dNh(Object(e.a)(this.HXb,this.HXb.add,"add"),fa),fa.init(this.Vf.Arb,this.Vf.dcn),fa.HCd(()=>{this.sa.raiseEvent("TMUDM")}),this.NKe.add(ta,fa)),Xa="MaxRateThrottler-"+ta,fa=this.$Ve.Kcl(Object(e.a)(fa,fa.add,"add"),Xa),fa.init(this.Vf.ben),this.PKe.add(ta,fa));return fa}reset(){for(let ta of this.PKe)ta.value.J6f();for(let ta of this.NKe)ta.value.J6f(),ta.value.reset();this.HXb.J6f();this.HXb.reset()}HCd(ta){this.sa.addHandler("TMUDM",
ta)}}ka.ecn=1E3;Object(D.a)(ka,"ThrottlerManager",null,[1108]);var wa;(function(ta){ta[ta.unspecified=0]="unspecified";ta[ta.word=1]="word";ta[ta.excel=2]="excel";ta[ta.powerPoint=3]="powerPoint";ta[ta.test=4]="test";ta[ta.wacFrontEnd=5]="wacFrontEnd";ta[ta.oneNote=6]="oneNote";ta[ta.visio=7]="visio";ta[ta.officeMobile=8]="officeMobile";ta[ta.cosmosDBChangefeed=9]="cosmosDBChangefeed";ta[ta.last=10]="last"})(wa||(wa={}));Object(D.b)("RtcClientAppName",wa);const ia=(ta,fa,Xa,ob,xb,zb,Lb,Ia,Ya=null,
eb=null,sb=null,lc=null)=>{const vb=L.createInstance(y.AFrameworkApplication.K),Eb=y.AFrameworkApplication.buildVersion?y.AFrameworkApplication.buildVersion:"1.0",Ua=va(ta,fa,Lb,Eb),Ta=vb.k_k?c(1897).RealtimeChannelMetrics.createInstance(Ua):new E;var Nb=c(1554).FrequentLoggingMetrics.create(xb);vb.P$n&&Nb.ADo(vb.O$n);var Wa="";Wa=Ya&&""!==Ya?Ya:"/rtc2/";Nb.M0h=t.a.dY(Wa);const Bb=Wa+"signalr";Ya=Wa+"findsession";const Ob=M.Lwm;Wa=new Aa;sb=sb||S.a.getInstance();l.ULS.shipAssertTag(556867617,500,
vb.Ogj<=c(1565).RealtimeChannel.sOi,"Client attempting to override max payload size beyond absolute limit");const hc=Math.min(vb.Ogj,c(1565).RealtimeChannel.sOi);Nb.rOi=hc;Nb=new Na(vb,new ka(Wa),ta,Ua,Gc=>new K(Gc.createHubProxy(Ob)),Ia,sb,Ta,Nb,hc);eb||(eb=c(1792).FindSessionStrategy.createInstance(fa,xb,Ya,Ia,Eb,Lb,ta,Ua,sb,zb,ob,lc));eb.$Od=vb.$Od;fa=new I(Ua);Xa=Xa?Xa.split(","):null;ta=new (c(1565).RealtimeChannel)(ta,Xa,Ua,Ia,()=>$.hubConnection(Bb),eb,Nb,fa,sb,Ta,vb,xb);ta.init();return ta},
va=(ta,fa,Xa)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",ta,na(wa[Xa]),na("browser"),fa),na=ta=>ta?ta.charAt(0).toLocaleUpperCase()+ta.substring(1,ta.length):ta;c.d(J,"RealtimeChannel",function(){return Ca});class Ca{constructor(ta,fa,Xa,ob,xb,zb,Lb,Ia,Ya,eb,sb,lc){this.vUe=!1;this.N6=null;this.u3=new x.a;this.Xsc=1;this.ffa=null;this.km=!1;this.SIe=(new Date(0)).getTime();this.rhh=0;this._clientId=ta;this.Vzd=fa;this.taa=0;this.je=ob;this.gxe=Ia;this.Eik=Lb;this.YUj=Ya;
this.n_j=xb;this.F$a=zb;this.aw=Xa;this.fu=eb;this.Vf=sb;this.Zf=lc;this.Gkk=1>100*Math.random()}get ASa(){return this.F$a.ASa}set ASa(ta){this.F$a.ASa=ta}get Bpb(){return this.Eik}get ym(){return this.YUj}init(){this.ym.Ezk(Object(e.a)(this,this.HLd,"disconnectAndCreateNewConnection"));this.ym.cAk(Object(e.a)(this,this.Bwn,"onUpdatePersistentStateRequestReceivedInternal"));this.ym.bAk(Object(e.a)(this,this.Awn,"onUpdatePersistentStateClearedRequestReceived"));this.Zf.D2b(this.fu);y.AFrameworkApplication.rI(()=>
{const {FrequentLoggingMetrics:ta}=c(1554);this.fu.K6f();ta.instance&&ta.instance.NNf()});this.wNh();this.opl();this.ym.Pzk(Object(e.a)(this,this.RVo,"updateConnectionQueryString"))}opl(){try{const Xa=$.signalR;if(!Xa)throw Error.invalidOperation("Failed to retrieve Signalr object");const ob=Xa.version;if(!ob)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===ob){var ta=Xa.transports;if(!ta)throw Error.invalidOperation("Failed to retrieve transports object");
var fa=ta.longPolling;if(!fa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!fa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");fa.supportsKeepAlive=this.jfl()}}catch(Xa){l.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",Xa.message)}}jfl(){return()=>!1}wNh(){const ta=++this.Xsc;this.SIe=(new Date(0)).getTime();this.ffa=this.n_j();this.ym.xPn(this.ffa);this.ffa.stateChanged(fa=>
{this.Cnn(fa,ta)});this.ffa.connectionSlow(Object(e.a)(this,this.rvn,"onSlowConnection"));this.ffa.error(Object(e.a)(this,this.ivn,"onSignalRError"));this.ffa.log=Object(e.a)(this,this.jvn,"onSignalRLog")}ypc(ta,fa){return ta!==this.Xsc?(l.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",fa),!1):!0}connect(){2!==this.taa&&1!==this.taa&&(l.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.aw),this.gxe.ynn(),z.a.instance.BDo(),this.dja(1,
this.taa),this.Kvj())}Kvj(){const ta=this.Xsc;this.vUe=!1;this.fu.w8i();this.F$a.bdm(Object(e.a)(this,this.S4k,"connectSignalrConnection"),Object(e.a)(this,this.DVi,"onFailureToConnect"),Object(e.a)(this.Bpb,this.Bpb.xAm,"initThrottlerManager"),Object(e.a)(this,this.ypc,"verifyConnectionToken"),ta)}DVi(ta=null){this.fu.y8i();let fa=null;!ta||"documentsessiondeleted"!==(fa=ta.toLowerCase())&&"documentsessionexpired"!==fa?this.HLd():(l.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",
this.aw,ta),this.disconnect())}HLd(ta,fa=null){l.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.N6);ta=(ta=2===this.taa||1===this.taa)&&!this.Bpb.SEb;let Xa=!0,ob=0;fa&&Object.getType(fa)!==Object.getType(Sys.EventArgs.Empty)&&fa.W9f&&""!==fa.W9f&&(ta=!0,this.F$a.Sno(fa.W9f),Xa=fa.pcg,ob=fa.reconnectDelay);ta&&this.dja(1,this.taa);++this.Xsc;this.Bpb.p6();this.QEo(Xa);this.F$a.Pql();this.wNh();ta&&window.setTimeout(Object(e.a)(this,this.Kvj,"startConnecting"),Math.min(ob,
3E4))}RVo(){let ta=null;const fa=({correlationId:ta}=this.F$a.h$h()).returnValue;this.ffa.qs=fa;l.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.aw,ta)}S4k(ta){const {FrequentLoggingMetrics:fa}=c(1554);this.SIe=(new Date).getTime();let Xa=null;this.ffa.qs=({correlationId:Xa}=this.F$a.h$h()).returnValue;this.Vf.mCk&&(this.ffa.url=ta,fa.instance&&(fa.instance.DIh=t.a.dY(ta)));let ob=null;this.je&&(ob=this.je.Yf("WebServiceCall","ConnectToServer"));
l.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.aw);ta={};this.Vzd&&(ta.transport=1===this.Vzd.length?this.Vzd[0]:this.Vzd);ta.pingInterval=null;z.a.instance.q6c(1,0);ta.waitForPageLoad=!1;this.ffa.start(ta,null).done(xb=>{this.fu.z8i();z.a.instance.q6c(1,1,!0);l.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",xb.id,Xa)}).fail(xb=>{l.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",
this.F$a.EX,Xa,this.aw);this.DVi();this.fu.x8i(xb);z.a.instance.q6c(1,1,!1);this.ym.q7i(0,{["CorrelationId"]:Xa,["ErrorDetails"]:xb,["ConnectionState"]:k.a[this.taa]})}).always(()=>{const {FrequentLoggingMetrics:xb}=c(1554);ob&&ob.stop();xb.instance&&(xb.instance.iBe=!1)})}disconnect(){const {FrequentLoggingMetrics:ta}=c(1554);0===this.taa?l.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.aw):(this.fu.C8i(),ta.instance&&(ta.instance.iBe=
!0),l.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.aw),this.Bpb.SEb=!0,this.gxe.ton(),this.dja(0,this.taa),this.HLd(),this.Bpb.SEb=!1)}QEo(ta){const fa=this.uSk(),Xa=this.ffa,ob=this.N6,xb=()=>{if(this.vUe)l.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.vUe=!0,Xa.stop(!0,ta)}catch(zb){l.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",zb.message)}};0<fa?(l.ULS.sendTraceTag(4309020,
500,50,"Waiting to stop connection [{0}]: [{1}] ms.",ob,fa),window.setTimeout(xb,fa)):(l.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",ob),xb())}uSk(){let ta=0;0===this.ffa.state&&(ta=this.SIe+Ca.K4o-(new Date).getTime(),0>ta&&(ta=0));return ta}get connectionState(){return this.taa}Kua(ta){this.ym.Kua(ta)}Ejc(ta){this.ym.Ejc(ta)}Yjj(ta){this.Rkc(0,ta)}Rkc(ta,fa){const Xa=new a.a;this.ym.t7i(ta,fa,Xa);return Xa.task}M_a(ta){this.ym.M_a(ta)}hPb(ta){this.ym.hPb(ta)}rGc(ta){this.ym.rGc(ta)}m7c(ta){this.ym.m7c(ta)}ECd(ta){this.ym.ECd(ta)}dee(ta){this.ym.dee(ta)}vSc(ta){return this.skm(ta)}KFb(){return this.o9b(0)}o9b(ta){const fa=
{};for(let Xa of this.u3)Xa.value.nb(ta)&&(fa[Xa.key]=Xa.value.J(ta).data);return fa}skm(ta){return this.u3.nb(ta)&&this.u3.J(ta).nb(0)?this.u3.J(ta).J(0).data:null}Bwn(ta,fa){for(let Xa of fa.L0o)this.u3.nb(Xa.key)||this.u3.Z(Xa.key,new N.a),ta=Xa.value,this.u3.J(Xa.key).Z(fa.type,new v(ta.Presence,new Date(ta.TimeStamp))),Xa.key===this._clientId&&0===fa.type&&this.ym.cPn(ta.Presence)}Awn(ta,fa){for(const Xa of fa.SGd)this.u3.remove(Xa)}LNl(){const ta=new N.a;if(!this.u3.nb(this._clientId))return ta;
for(let fa of this.u3.J(this._clientId))ta.Z(fa.key,fa.value.data);return ta}qN(ta,fa=null,Xa=!1){const ob=new a.a;this.ym.S5f(ta,fa,Xa,ob);return ob.task}V3(ta){this.ym.V3(ta)}iPb(ta){this.ym.iPb(ta)}Ojb(ta){let fa,Xa;return({value:fa}=this.u3.Fc(ta)).returnValue&&({value:Xa}=fa.Fc(0)).returnValue?new n(this.xkm(Xa),Xa.timeStamp):null}IPc(){const ta={};for(let fa of this.u3)fa.value.Fc(0).returnValue&&(ta[fa.key]=this.Ojb(fa.key));return ta}Yrb(ta){const fa=new a.a;this.ym.z7i(ta,fa);return fa.task}get clientId(){return this._clientId}get Nzo(){return this.Gkk}dispose(){const {FrequentLoggingMetrics:ta}=
c(1554);this.km||(this.Bpb.p6(),this.Zf.x8f(this.fu),this.fu.K6f(),ta.instance&&ta.instance.NNf(),this.km=!0)}Cnn(ta,fa){this.ypc(fa,"StateChangedSignalR")&&this.dja(this.oKh(ta.newState),this.oKh(ta.oldState))}dja(ta,fa){var {FrequentLoggingMetrics:Xa}=c(1554),{ClientToClientMessageTelemetry:ob}=c(1802);if((1!==this.taa||0!==fa||1!==ta)&&this.taa!==fa){const xb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.taa,
fa,ta]));l.ULS.sendTraceTag(3290053,500,10,xb)}if(this.taa!==ta){switch(ta){case 2:Xa.instance&&Xa.instance.Can();this.N6=this.ffa.id;l.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.N6,this.aw);this.J8m(this.ffa);l.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Xa=null;this.je&&(Xa=this.je.Yf("WebServiceCall","Receive First Presence"));ob=this.Xsc;this.ym.wPn(Object(e.a)(this,this.ypc,"verifyConnectionToken"),ob,this.gxe,Object(e.a)(this,
this.x8e,"clearExistingPersistentState"),this.LNl(),Xa);this.Vf.K$n&&(Xa=100*Math.random()<=this.Vf.L$n,c(1802).ClientToClientMessageTelemetry.z$b(this.ym,this.Vf,Xa).start());break;case 1:2===fa&&l.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.N6);break;case 0:if(ob.instance&&ob.instance.stop(),this.Bpb.SEb)l.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.N6);else{1===fa&&(l.ULS.sendTraceTag(7672737,500,
50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.N6),this.fu.D8i());2===fa&&l.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.N6);this.HLd();return}}this.taa=ta;this.ym.BOn(ta,fa)}}J8m(ta){if(ta&&ta.transport&&ta.transport.name){ta=ta.transport.name;var fa=ta.toLowerCase();
"websockets"===fa?l.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",ta,this.aw):"serversentevents"===fa?l.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",ta,this.aw):"foreverframe"===fa?l.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",ta,this.aw):"longpolling"===fa?l.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",ta,this.aw):"mocktransport"!==fa&&l.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",
ta)}else l.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}rvn(){if(this.Vf.Ngj){const ta=t.a.iP(this.ASa,"mid");l.ULS.sendTraceTag(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.N6,ta)}else l.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.N6)}ivn(){l.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.N6)}jvn(ta){ta=c(1533).RtcUtils.Mgc(ta);if(this.Vf.Ngj&&ta.startsWith("Keep alive timed out.")){const fa=
t.a.iP(this.ASa,"mid");l.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",ta,fa)}else this.Nzo&&2E3>this.rhh&&!ta.startsWith("Invok")&&!ta.startsWith("Trigger")&&(l.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",ta),this.rhh++)}x8e(){let ta;const fa=[];({value:ta}=this.u3.Fc(this._clientId)).returnValue&&this.u3.remove(this._clientId);for(let Xa of this.u3.keys)Array.add(fa,Xa);for(const Xa of fa)this.u3.remove(Xa);ta&&this.u3.Z(this._clientId,ta);this.ym.XOn(fa)}oKh(ta){switch(ta){case 0:return 1;
case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",ta,"Unknown SignalR state");}}xkm(ta){return ta&&ta.timeStamp?(new Date).getTime()-ta.timeStamp.getTime()>(this.Vf.PJk?6E4:this.Vf.OJk)?2:1:1}static createInstance(ta,fa,Xa,ob,xb,zb,Lb,Ia=null,Ya=null,eb=null,sb=null,lc=null,vb=null){return ia(ta,fa,Xa,vb,ob,xb,zb,Lb,Ia,Ya,eb,lc,sb)}}Ca.sOi=31E3;Ca.APf=8E3;Ca.K4o=15E3;Object(D.a)(Ca,"RealtimeChannel",null,[1082,1083])},1654:function(D,J,c){c.d(J,"a",function(){return l});
D=c(0);class l{constructor(){this.tih=!1;this.Ayb=null;this.sRg=0;this.IBe=this.QOh();this.Vid=this.QOh();this.Ltb=this.BXb=0;this.nq=()=>new Date}get eGo(){return this.tih}QOh(){const e=Array(6);for(let a=0;a<e.length;a++)e[a]=0;return e}IYl(){return this.IBe.toString()}jTl(){return this.Vid.toString()}BDo(){this.Ayb=this.nq()}q6c(e,a,k=!1){this.eGo||(k&&(this.tih=!0),k=this.nq(),0===e&&5<this.BXb||1===e&&5<this.Ltb||(this.sRg<e?(1===this.BXb%2&&(this.IBe[this.BXb]=-1,this.BXb++),this.sRg=e,1===
a&&(this.Vid[this.Ltb]=-1,this.Ltb++),this.Vid[this.Ltb]=this.Vjg(k),this.Ltb++):0===e?(this.IBe[this.BXb]=this.Vjg(k),this.BXb++):(this.Vid[this.Ltb]=this.Vjg(k),this.Ltb++)))}Vjg(e){const a=e.getTime()-this.Ayb.getTime();this.Ayb=e;return a}static get instance(){l._instance||(l._instance=new l);return l._instance}static set instance(e){l._instance=e}}l._instance=null;Object(D.a)(l,"LatencyMetrics",null,[])},1681:function(D,J,c){D=c(0);class l{constructor(){this.gOg=this.axe=!1;this.callback=null}l2c(a){this.callback=
a;this.OBj()}KNi(a){this.axe||(this.axe=!0,this.f_j=a,this.OBj())}OBj(){this.axe&&this.callback&&!this.gOg&&(this.gOg=!0,this.callback(this.f_j))}}Object(D.a)(l,"CompletionTask",null,[]);c.d(J,"a",function(){return e});class e{constructor(){this.F7g=new l;this.D7g=new l}i8d(a){this.F7g.l2c(a)}h8d(a){this.D7g.l2c(a)}m0c(a){this.F7g.KNi(a)}Vmb(a){this.D7g.KNi(a)}lPf(){this.m0c(2);this.Vmb(2)}}Object(D.a)(e,"MessageStatus",null,[1125])},1736:function(D,J,c){c.r(J);c.d(J,"MaxOutstandingThrottler",function(){return k});
D=c(0);var l=c(55),e=c(81);J=c(1737);var a=c(1681);class k extends J.a{constructor(x,y=""){super(x,y);this.Xfc=this.Arb=0;this.sa=new e.a;this.IYb=!1;this.Gsd=this.wjd=this.Wid=this.ZVe=0;this.L3=[];this.clearTimeout=k.mef}add(x){this.JYb||this.init(k.cRh,k.KQh);this.dAb++;const y=new a.a;this.vdc?this.die(x,y):this.Gsd<this.Xfc?this.m9c(x,y):(this.die(x,y),this.IYb=!1);return y}m9c(x,y){x=this.Nfh(x);const n=this.setTimeout(Object(l.a)(this,this.Crn,"onMessageWaitTimeExpired"),this.Arb);++this.Gsd;
Array.add(this.L3,n);const t=this.Wid;x.i8d(z=>{y.m0c(z)});x.h8d(z=>{this.Wid===t&&(this.Brn(t,n),y.Vmb(z))})}Brn(x,y){this.Wid===x&&(--this.Gsd,this.clearTimeout(y),Array.remove(this.L3,y),this.vdc&&this.Kfo())}Kfo(){this.vdc&&!this.IYb&&(this.ZVe=this.setTimeout(Object(l.a)(this,this.Lfo,"sendThrottledMessageFromTimer"),0),this.IYb=!0)}Lfo(){this.IYb=!1;if(this.vdc){const x=this.tzd,y=this.i1b;this.YIc(!1);this.m9c(x,y)}}Crn(){++this.wjd;this.wjd>Math.floor(this.Xfc/2)&&(this.wjd=-1E9,this.sa.raiseEvent("TMUDM"))}HCd(x){this.sa.addHandler("TMUDM",
x)}reset(){this.dAb=this.AEc=this.Kuc=this.wjd=0;++this.Wid;for(const x of this.L3)this.clearTimeout(x);this.Gsd=0;this.L3=[];this.YIc(!0);this.IYb&&(this.clearTimeout(this.ZVe),this.ZVe=0,this.IYb=!1)}init(x,y){this.JYb||(this.Arb=x,this.Xfc=y,this.JYb=!0)}static createInstance(x,y=""){return new k(x,y)}static mef(x){window.clearTimeout(x)}}k.cRh=15E3;k.KQh=5;Object(D.a)(k,"MaxOutstandingThrottler",J.a,[1122,1123])},1737:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(7);class e{constructor(a,
k=""){this.Kuc=this.AEc=0;this.SGe=!1;this.i1b=this.tzd=null;this.JYb=!1;this.Nfh=a;this.Qzj=k;this.setTimeout=e.vef;this.dAb=this.AEc=this.Kuc=0}J6f(){0<this.dAb&&0<this.Kuc&&l.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.Qzj,this.Kuc,this.dAb);0<this.dAb&&0<this.AEc&&l.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Qzj,this.AEc,this.dAb)}get vdc(){return this.SGe}die(a,k){this.AEc++;this.YIc(!0);this.SGe=
!0;this.tzd=a;this.i1b=k}YIc(a){this.SGe=!1;this.i1b&&a&&(this.Kuc++,this.i1b.lPf());this.i1b=this.tzd=null}static vef(a,k){return window.setTimeout(a,k)}}Object(D.a)(e,"ThrottlerBase",null,[])},1738:function(D,J,c){c.r(J);c.d(J,"MaxRateThrottler",function(){return a});D=c(0);var l=c(55);J=c(1737);var e=c(1681);class a extends J.a{constructor(k,x=""){super(k,x);this.fgc=0;this.Fyc=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(k){this.JYb||(this.fgc=k,this.JYb=!0)}add(k){this.JYb||
this.init(a.zQh);this.dAb++;const x=this.currentTime(),y=new e.a;this.Fyc>x&&(this.Fyc=x);this.vdc?(this.YIc(!0),this.die(k,y)):this.Fyc+this.fgc<=x?this.m9c(k,y):(this.die(k,y),this.setTimeout(Object(l.a)(this,this.Jfo,"sendThrottledMessage"),this.Fyc+this.fgc-x));return y}Jfo(){if(this.vdc){const k=this.tzd,x=this.i1b;this.YIc(!1);this.m9c(k,x)}}m9c(k,x){this.Fyc=this.currentTime();k=this.Nfh(k);k.i8d(y=>{x.m0c(y)});k.h8d(y=>{x.Vmb(y)})}static createInstance(k,x=""){return new a(k,x)}}a.zQh=200;
Object(D.a)(a,"MaxRateThrottler",J.a,[1124,1123])},1739:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e,a,k,x){super();this.type=e;this.OL=a;this.cml=k;this.U8a=x}}Object(D.a)(l,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1740:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.$ag="rr";l.N$n="rd";l.J$n="rbp";l.pcg="sa";Object(D.a)(l,"RtcReconnectParams",null,[])},1741:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);
class l{constructor(e,a,k,x){this.ben=e;this.Arb=a;this.dcn=k;this.Nmm=x}}Object(D.a)(l,"ThrottlerManagerSettings",null,[])},1788:function(D,J,c){D=c(0);class l extends Sys.EventArgs{constructor(N,O){super();this.newState=N;this.oldState=O}}Object(D.a)(l,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(N,O){super();this.j_k=N;this.U8a=O}}Object(D.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class a extends Sys.EventArgs{constructor(N){super();this.presence=
N}}Object(D.a)(a,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var k=c(1899),x=c(1898),y=c(1896);class n extends Sys.EventArgs{constructor(N,O=null){super();this.ek=N;this.ook=O}get type(){return this.ek}get OL(){return this.ook}}Object(D.a)(n,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class t extends Sys.EventArgs{constructor(){super()}}Object(D.a)(t,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);class z extends Sys.EventArgs{constructor(N,O,X,U,T,Y){super();this.ypc=N;
this.s$e=O;this.U4k=X;this.rZh=T;this.x8e=U;this.YA=Y}}Object(D.a)(z,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(N){super();this.hubConnection=N}}Object(D.a)(v,"RefreshProxyEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(N,O){super();this.vha=N;this.errorMessage=O}}Object(D.a)(I,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(N,O,X){super();this.type=N;this.presence=O;this.U8a=X}}Object(D.a)(E,
"SendPersistentStateEventArgs",Sys.EventArgs,[]);var H=c(1739);class M extends Sys.EventArgs{constructor(){super()}}Object(D.a)(M,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(N){super();this.SGd=N}}Object(D.a)(K,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class L extends Sys.EventArgs{constructor(N,O){super();this.type=N;this.L0o=O}}Object(D.a)(L,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var S=c(81);c.d(J,"a",
function(){return Q});class Q{constructor(){this.sa=new S.a}BOn(N,O){this.sa.raiseEvent("CSC",new l(N,O))}xPn(N){this.sa.raiseEvent("RP",new v(N))}Xce(N){this.sa.raiseEvent("RC",N)}APn(){this.sa.raiseEvent("RMID")}wPn(N,O,X,U,T,Y){this.sa.raiseEvent("RPS",new z(N,O,X,U,T,Y))}A7i(N,O){this.sa.raiseEvent("UPSR",new L(N,O))}m7i(N,O){this.sa.raiseEvent("PU",new y.a(N,O))}cPn(N){this.sa.raiseEvent("MPU",new a(N))}S5f(N,O,X,U){this.sa.raiseEvent("SUN",new H.a(N,O,X,U))}PPn(N,O){this.sa.raiseEvent("UNR",
new n(N,O))}t7i(N,O,X){this.sa.raiseEvent("SP",new E(N,O,X))}k7i(N,O){this.sa.raiseEvent("PSU",new x.a(N,O))}qPn(N){this.sa.raiseEvent("PSC",new k.a(N))}XOn(N){this.sa.raiseEvent("IPSC",new k.a(N))}QPn(N){this.sa.raiseEvent("UPSC",new K(N))}CPn(N,O){this.sa.raiseEvent("SPC",new M(N,O))}q7i(N,O){this.sa.raiseEvent("RCF",new I(N,O))}QOn(N){this.sa.raiseEvent("CPSWM",new t(N))}z7i(N,O){this.sa.raiseEvent("UCI",new e(N,O))}Kua(N){this.sa.addHandler("CSC",N)}Ejc(N){this.sa.removeHandler("CSC",N)}Fzk(N){this.sa.addHandler("RP",
N)}Ezk(N){this.sa.addHandler("RC",N)}Izk(N){this.sa.addHandler("RMID",N)}Dzk(N){this.sa.addHandler("RPS",N)}cAk(N){this.sa.addHandler("UPSR",N)}M_a(N){this.sa.addHandler("PU",N)}hPb(N){this.sa.removeHandler("PU",N)}Cxk(N){this.sa.addHandler("IPU",N)}$zk(N){this.sa.addHandler("UCI",N)}Nzk(N){this.sa.addHandler("SUN",N)}Dxk(N){this.sa.addHandler("IUNR",N)}V3(N){this.sa.addHandler("UNR",N)}iPb(N){this.sa.removeHandler("UNR",N)}rGc(N){this.sa.addHandler("PSU",N)}m7c(N){this.sa.removeHandler("PSU",N)}Bxk(N){this.sa.addHandler("IPSU",
N)}ECd(N){this.sa.addHandler("PSC",N)}dee(N){this.sa.removeHandler("PSC",N)}Axk(N){this.sa.addHandler("IPSC",N)}bAk(N){this.sa.addHandler("UPSC",N)}Lzk(N){this.sa.addHandler("SP",N)}Pzk(N){this.sa.addHandler("SPC",N)}static getInstance(){return Q._instance||(Q._instance=new Q)}}Q._instance=null;Object(D.a)(Q,"RtcEventHub",null,[1110])},1792:function(D,J,c){c.r(J);D=c(0);var l=c(7),e=c(55),a=c(75),k=c(889);class x{}x.fgc="throttling_messageDelay";x.ZXc="enabled";x.Arb="throttling_timeToWaitForResponse";
x.Xfc="throttling_maxNumberOfOutstandingMessages";x.sli="throttling_globalMaxNumberOfOutstandingMessages";x.errorMessage="errorMessage";x.Ytj="url";x.oIa="queryString";x.EX="connectionString";Object(D.a)(x,"RtcFindSessionOutputFieldNameConstants",null,[]);var y=c(2),n=c(46),t=c(40),z=c(316),v=c(1399),I=c(85),E=c(19),H=c(139);class M{constructor(){this.tli=this.pOi=this.qOi=this.vOi=0;this.U0d=!1;this.correlationId=this.EX=this.oIa=this.t$e=this.errorMessage=null}get P3k(){return this.t$e+"?"+this.oIa}}
Object(D.a)(M,"FindSessionResponse",null,[]);var K=c(597);class L{constructor(ba,oa,ma,ea,ua,sa){this.kZa=null;const {FindSessionStrategy:Fa}=c(1792);this.Pgk=ba;ba=String.format("{0}={1}",K.a.clientId,E.a.Gj(ea));ba=String.format("{0}&{1}={2}",ba,K.a.userSessionId,E.a.Gj(ua));ba=String.format("{0}&{1}={2}",ba,K.a.uJj,E.a.Gj(ma.toString()));ba=String.format("{0}&{1}={2}",ba,K.a.userType,E.a.Gj("1"));ba=String.format("{0}&{1}={2}",ba,K.a.EJj,E.a.Gj(oa));ba=String.format("{0}&{1}={2}",ba,K.a.KFh,E.a.Gj(Fa.l_k));
(oa=L.Gof(ma,sa))&&(ba=String.format("{0}&{1}",ba,oa));this.p_j=ba}B9i(){this.kZa=this.Pgk()}generate(){this.kZa&&""!==this.kZa||(this.B9i(),l.ULS.sendTraceTag(575784194,500,this.kZa&&""!==this.kZa?50:15,"Query signature delegate called for refresh returned: {0} ",this.kZa));const ba=String.format("{0}={1}",K.a.zOb,E.a.Gj(this.kZa));return String.format("{0}&{1}",ba,this.p_j)}static Gof(ba,oa){return 4===ba?String.format("{0}={1}",K.a.SRi,"1"):oa?oa.qki():null}}Object(D.a)(L,"FindSessionQueryStringGenerator",
null,[]);var S=c(1554),Q=c(1654),N=c(1533),O=c(1741);class X{}X.xFl="FSType";Object(D.a)(X,"RtcFindSessionRequestHeaders",null,[]);class U{}U.NQn="polling";Object(D.a)(U,"RtcFindSessionTypes",null,[]);var T=c(1740);class Y{}Y.x3o="RTC-TokenProofkey";Y.uYm="RTC-IsWacJsBootFsRequest";Object(D.a)(Y,"RtcRequestHeaders",null,[]);c.d(J,"FindSessionStrategy",function(){return aa});class aa{constructor(ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa,ka=null){this.z4g=(new Date(0)).getTime();this.L6g=0;this.wrd=!1;this.$fh=
null;this.$6f=36E5;this.VVb=aa.Zri;this.lvc=0;this.wPb=null;this.oUa=0;this.skc=this.FIh=null;this.Thk=[x.ZXc,x.errorMessage,x.Ytj,x.EX,x.oIa,x.sli,x.Xfc,x.Arb,x.fgc];this.Shk=[x.ZXc,x.errorMessage];this.EX=this.ASa=null;this.ZVg=new L(za?za:()=>y.AFrameworkApplication.em,ua,sa,Fa,ba,oa);this.nsc=xa;this.je=ea;this.Zf=oa;this.MBe=ma;this.aw=Pa;this.ym=Na;this.Evc=ka;this.$Vg=!1;this.$Od=9E4;Aa&&Aa.execute(wa=>{wa.J_a(()=>{l.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.aw);this.ZVg.B9i()})});2>=100*Math.random()&&(this.$6f=3E5);S.FrequentLoggingMetrics.instance&&(S.FrequentLoggingMetrics.instance.I3h=this.$6f)}Sno(ba){this.skc=ba}init(){this.ym.Izk(Object(e.a)(this,this.U6n,"resetGetMachineIdDelay"));this.ym.Kua(Object(e.a)(this,this.dja,"onConnectionStateChanged"))}dja(ba,oa){this.oUa=oa.newState;2===oa.newState&&(this.lvc=0)}h$h(){let ba;ba=this.wPb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.wPb.oIa,aa.bLh,E.a.Gj(ba)),correlationId:ba}}bdm(ba,
oa,ma,ea,ua){this.Eeo(()=>{ea(ua,"GetMachineIdSuccess")&&(l.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.EX,this.aw),ba(this.$fh),ma(this.zim()))},sa=>{ea(ua,"GetMachineIdFailure")&&(l.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.aw),oa(sa))},ea,ua)}Pql(){this.qFh();this.Rym()}Eeo(ba,oa,ma,ea){l.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.EX);if(this.EX)ba();else{var ua=this.ARk();window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(ba,oa,ma,ea)},ua)}}sendFindSessionRequestToServerInternal(ba,oa,ma,ea){ma(ea,"RequestMachineId")&&(this.z4g=(new Date).getTime(),ma=t.a.$e(),this.dSd(ua=>{const sa=t.a.$e();this.j1i(ua);this.qeg();ba();ua=t.a.$e()-sa;l.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ua)},ua=>{const sa=t.a.$e();this.qFh();S.FrequentLoggingMetrics.instance&&S.FrequentLoggingMetrics.instance.rP(2,
3);oa(ua);ua=t.a.$e()-sa;l.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ua)},!1),ma=t.a.$e()-ma,l.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",ma))}Rym(){this.VVb+=aa.I4l;this.VVb=Math.min(this.VVb,aa.Nbn)}ARk(){var ba=(new Date).getTime();ba=this.z4g+this.VVb-ba;0>ba&&(ba=0);return ba}j1i(ba){try{this.wPb=ba,this.ASa=ba.P3k,this.EX=ba.EX,this.FIh=ba.oIa,this.$fh=ba.t$e}catch(oa){l.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",
oa.toString())}}qFh(){this.EX=null;this.rFh()}qeg(){this.rFh();this.wrd=!0;this.L6g=window.setTimeout(Object(e.a)(this,this.WUn,"refreshMachineId"),this.$6f)}rFh(){this.wrd&&(window.clearTimeout(this.L6g),this.wrd=!1)}WUn(){this.wrd=!1;this.dSd(ba=>{const oa=this.FIh!==ba.oIa,ma=this.EX!==ba.EX,ea=this.EX;this.j1i(ba);0!==this.oUa&&(ma?(l.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",ea||"null",ba.EX),this.ym.Xce()):(this.ym.CPn(oa,ma),
this.qeg()))},()=>{S.FrequentLoggingMetrics.instance&&S.FrequentLoggingMetrics.instance.rP(2,3);this.qeg()},!0)}U6n(){this.VVb=aa.Zri}zim(){return new O.a(this.wPb.vOi,this.wPb.qOi,this.wPb.pOi,this.wPb.tli)}xOo(ba){if(Object.getType(ba)!==Object)return null;for(let oa in ba);return this.Val(ba)}Val(ba){if(!(x.ZXc in ba))return null;const oa=ba[x.ZXc];var ma=oa?this.Thk:this.Shk;for(const ea of ma)if(!(ea in ba))return null;ma=Object.assign(new M,{U0d:ba[x.ZXc],errorMessage:ba[x.errorMessage],correlationId:H.a.create().toString()});
oa&&(ma.t$e=ba[x.Ytj],ma.oIa=ba[x.oIa],ma.EX=ba[x.EX],ma.tli=ba[x.sli],ma.pOi=ba[x.Xfc],ma.qOi=ba[x.Arb],ma.vOi=ba[x.fgc]);return ma}JYl(ba,oa){l.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.Evc.N0h.continueWith(()=>{this.Evc.N0h.result?(l.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),ba(this.Evc.O0h)):(l.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),oa(this.Evc.O0h))})}sej(ba,oa,
ma,ea,ua=!1){return sa=>{Q.a.instance.q6c(0,1);ba&&ba.stop();this.nsc=this.skc=null;this.FLi(sa.data,!0,oa);var Fa=N.RtcUtils.deserialize(sa.data.te,"FindSession",null);if(Fa)if(Fa=this.xOo(Fa)){if(Fa.U0d&&Fa.oIa&&Fa.EX){l.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.aw);this.v5m(sa.data);ma(Fa);return}oa.FindSessionFailureReason="FindSessionInvalidResponse";oa.IsRtcEnabled=Fa.U0d;oa.IsQueryStringEmpty=!Fa.oIa;oa.IsConnectionStringEmpty=!Fa.EX;l.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.aw,Fa.U0d,!Fa.oIa,!Fa.EX)}else oa.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",l.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.aw);else oa.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",l.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.aw);this.r7i(oa,ua);ea(null)}}mej(ba,oa,ma,ea=!1){return ua=>{Q.a.instance.q6c(0,1);ba&&ba.stop();this.nsc=this.skc=null;this.FLi(ua.data,!1,oa);let sa=null;var Fa="unknown";let Pa="unknown";ua.data&&((Fa=ua.data.jj)&&aa.D8c in Fa&&(sa=Fa[aa.D8c].toString()),Fa=v.a[ua.data.status],Pa=ua.data.Ne.toString());oa.FindSessionFailureReason="FindSessionRequestFailed";oa.HttpErrorCode=Pa;oa.HttpErrorStatus=Fa;oa[aa.D8c]=sa;l.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
Fa,Pa,this.aw,sa,ea);this.r7i(oa,ea);ma(Pa)}}dSd(ba,oa,ma=!1){let ea=null;l.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.aw);const ua={};var sa=this.ZVg.generate();ua[z.a.ZQ]=H.a.create().toString();this.skc&&""!==this.skc?sa=String.format("{0}&{1}={2}",sa,T.a.$ag,this.skc):this.nsc&&""!==this.nsc&&(sa=String.format("{0}&{1}={2}",sa,T.a.$ag,this.nsc),ua[Y.x3o]="True",ua[Y.uYm]="True");sa=this.MBe+"?"+sa;ma&&(ua[X.xFl]=U.NQn);const Fa={};Fa.IsNetworkOfflineBeforeSendRequest=
this.Zf.KRa;Fa.HasAvailableConnectionsBeforeSendRequest=this.Zf.rWd;Fa.MaxConnectionsAllowed=this.Zf.Ufc;Fa.IsRefreshMachineId=ma;this.Evc&&!this.$Vg?(this.JYl(this.sej(null,Fa,ba,oa,ma),this.mej(null,Fa,oa,ma)),this.$Vg=!0):(this.je&&(ea=this.je.Yf("WebServiceCall","GetMachineIdFromTheServer")),S.FrequentLoggingMetrics.instance&&S.FrequentLoggingMetrics.instance.rP(2,0),0>this.Zf.ZAb(sa,1,null,ua,[aa.eJd,aa.D8c,aa.S1c,aa.Zag,aa.PQi,aa.uTi,aa.tTi],1,this.sej(ea,Fa,ba,oa,ma),this.mej(ea,Fa,oa,ma),
null,!1,null,this.$Od,"3",null,!0)&&(5<this.lvc&&200>this.lvc&&l.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.lvc),window.setTimeout(()=>{this.lvc++;oa("-1")},1E3)))}FLi(ba,oa,ma){ma||(ma={});ma.IsNetworkOfflineAfterRequestComplete=this.Zf.KRa;ma.IsRequestSucceeded=oa;ba&&(ma.EnqueueTime=ba.yPa,ma.InvokedTime=ba.bI,ma.CompletedTime=ba.cU,ba.jj&&(aa.eJd in ba.jj&&(ma.CorrelationId=ba.jj[aa.eJd]),aa.S1c in
ba.jj&&(ma[aa.S1c]=ba.jj[aa.S1c])));l.ULS.sendTraceTag(38633565,500,oa?50:15,N.RtcUtils.Mgc(ma))}r7i(ba,oa){ba||(ba={});ba.ConnectionState=k.a[this.oUa];oa||this.ym.q7i(1,ba)}v5m(ba){try{var oa=!1,ma=!1,ea=ba.jj,ua=n.a.dY(ba.request.get_url());if(ea&&aa.Zag in ea){const Aa=ea[aa.Zag].toString().toLocaleLowerCase();ma="true"===Aa;oa="false"===Aa}ea=!1;const Na=0<=ua.toLocaleLowerCase().indexOf("collab");ma&&!Na?ea=!0:oa&&Na&&(ea=!0);if(ea){oa={};oa.HostName=ua;oa.Status=v.a[ba.status];oa.HttpStatus=
ba.Ne.toString();var sa=ba.request.get_headers();for(let Aa in sa){var Fa=sa[Aa];(ua=Aa)&&0<ua.length&&(ma=0,Fa&&(ma=Fa.toString().length),oa["r_"+ua]=ma)}if(ba.jj){const Aa=new a.a;Aa.add(aa.eJd);Aa.add(aa.S1c);Aa.add(aa.D8c);Aa.add(aa.uTi);Aa.add(aa.tTi);Aa.add(aa.PQi);aa.kvk(oa,ba.jj,Aa)}aa.Wuk(ba.request.get_url(),oa);var Pa=I.a.toJSON(oa);l.ULS.sendTraceTag(559437006,500,15,Pa)}}catch(Na){l.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Na.toString())}}static createInstance(ba,
oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa=null){return aa.Ybl(ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa)}static Ybl(ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa=null){ba=ba||H.a.create().toString();ba=new aa(ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,null,za,xa);ba.init();return ba}static kvk(ba,oa,ma){for(let ea of ma)ea in oa&&(ba[ea]=oa[ea])}static Wuk(ba,oa){if(ba){var ma=ba.indexOf("?");if(-1!==ma)for(ba=ba.substr(ma+1).split("&"),ma=0;ma<ba.length;++ma){var ea=ba[ma].split("=");if(2===ea.length){const ua=ea[0];if(ua&&0<ua.length){let sa=
0;if(ea=ea[1])sa=ea.length;oa["q_"+ua]=sa}}}}}}aa.I4l=3E3;aa.Nbn=3E5;aa.l_k="1.0";aa.Zri=1E3;aa.eJd="X-CorrelationId";aa.bLh="corrid";aa.D8c="RtcErrorCode";aa.S1c="X-OfficeCluster";aa.Zag="X-NewEnv";aa.PQi="X-MSEdge-Ref";aa.tTi="X-OFFICEFD";aa.uTi="X-OfficeFE";Object(D.a)(aa,"FindSessionStrategy",null,[1106])},1802:function(D,J,c){c.r(J);D=c(0);var l=c(7),e=c(55),a=c(464),k=c(61),x=c(75);class y{constructor(t){this.messageId=t;this.Nfo=(new Date).getTime();this.EKf=new x.a}}Object(D.a)(y,"MessageLatencyDetails",
null,[]);c.d(J,"ClientToClientMessageTelemetry",function(){return n});class n{constructor(t,z,v){this.CMa=null;this.vKe=this.ASe=0;this.Vf=z;this.G7g=v;this.nDc=!1;this.ym=t;this.ym.V3(Object(e.a)(this,this.lRn,"receiveMessage"))}start(){if(this.G7g&&!this.nDc){const t=this.Vf.Rgj;this.vKe=this.Vf.Mgj;t<=this.vKe?(l.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.Vf.Rgj,this.Vf.Mgj),this.G7g=!1):(this.nDc=!0,this.ASe=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),t))}}sendMessage(){if(this.nDc){const t=k.a.create().toString();this.CMa=new y(t);this.ym.S5f(16,t,!1,new a.a);window.setTimeout(()=>{this.h7m(t)},this.vKe)}}h7m(t){this.CMa&&this.CMa.messageId===t&&(0<this.CMa.EKf.count?(t=this.CMa.EKf.toArray().join(","),l.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",t)):l.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),
this.CMa=null)}stop(){this.ASe&&(window.clearInterval(this.ASe),this.nDc=!1)}lRn(t,z){16===z.type?this.ym.S5f(17,z.OL,!1,new a.a):17===z.type&&this.nDc&&z.OL&&this.processMessage(z.OL)}processMessage(t){t&&this.CMa&&t.toString()===this.CMa.messageId&&(t=(new Date).getTime()-this.CMa.Nfo,this.CMa.EKf.add(t))}static get instance(){return n._instance}static z$b(t,z,v){return n.instance||(n._instance=new n(t,z,v))}}n._instance=null;Object(D.a)(n,"ClientToClientMessageTelemetry",null,[])},1896:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e,a){super();this.asa=e;this.ILd=a}}Object(D.a)(l,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1897:function(D,J,c){c.r(J);c.d(J,"RealtimeChannelMetrics",function(){return x});D=c(0);var l=c(7),e=c(202),a=c(85),k=c(1533);class x{constructor(){this.m9g=this.n9g=this.o9g=this.i9g=this.h9g=this.j9g=this.jAc=this.iMe=0;this.ILa=this.rJe=this.Hyc=this.dJe=this.mYa=this.RIe=this.pcb=this.syc=this.SYb=this.QIe=this.amd=
this.oXb=null;this.HKe=this.zzc=this.Yfh=this.nPg=0;this.H7g=!1;this.w8i=this.u6f;this.z8i=this.x6f;this.y8i=this.w6f;this.D8i=this.z6f;this.C8i=this.y6f;this.K6f=this.L6f;this.r6c=this.I6f;this.LOb=this.G6f;this.MOb=this.H6f;this.x8i=this.v6f;this.b6a=this.zTf;this.ZLb=this.ATf}u6f(){this.iMe++;this.QIe=new Date;this.oXb||(this.oXb=new Date)}x6f(){this.jAc++;this.pcb=new Date;this.amd||(this.amd=this.pcb);this.Hyc=this.pcb;this.i4k()}w6f(){this.j9g++;this.RIe=new Date}z6f(){this.h9g++;this.SYb=new Date}y6f(){this.i9g++;
this.syc=new Date}I6f(){this.mYa=new Date;this.o9g++}H6f(){this.ILa||(this.ILa=new Date);this.n9g++}G6f(){this.dJe=new Date;this.m9g++}L6f(){!this.H7g&&this.iMe&&(l.ULS.sendTraceTag(39321871,500,15,a.a.toJSON(this.Z0k())),this.H7g=!0)}v6f(y){let n,t;({Wpi:y,Ypi:n,exception:t}=k.RtcUtils.aBl(y));y&&y!==e.a.Zz&&(l.ULS.sendTraceTag(40157596,500,15,a.a.toJSON({["HttpErrorCode"]:y,["HttpErrorStatus"]:n,["Exception"]:t})),e.a.hEf(y)&&this.nPg++,e.a.lIf(y)&&this.Yfh++)}zTf(){this.rJe=new Date}ATf(){this.SYb=
this.Hyc=new Date}Z0k(){return{["numberOfConnectionAttempts"]:this.iMe,["numberOfSuccessfulConnections"]:this.jAc,["numberOfFailedConnections"]:this.j9g,["numberOfDisconnectedConnections"]:this.h9g,["numberOfExplicitDisconnectedConnections"]:this.i9g,["numberOfSentMessages"]:this.o9g,["numberOfReceivedMessages"]:this.n9g,["numberOfLostMessages"]:this.m9g,["firstConnectionAttempt"]:this.oXb?this.oXb:null,["firstMessageReceived"]:this.ILa?this.ILa:null,["firstConnectionSuccess"]:this.amd?this.amd:null,
["lastConnectionAttempt"]:this.QIe?this.QIe:null,["lastConnectionSuccess"]:this.pcb?this.pcb:null,["lastConnectionFailure"]:this.RIe?this.RIe:null,["lastMessageSent"]:this.mYa?this.mYa:null,["lastMessageLost"]:this.dJe?this.dJe:null,["lastDisconnect"]:this.SYb?this.SYb:null,["lastExplicitDisconnect"]:this.syc?this.syc:null,["lastTimeOnline"]:this.Hyc?this.Hyc:null,["lastTimeOffline"]:this.rJe?this.rJe:null,["maxDisconnectedTimeMs"]:this.zzc,["maxExplicitDisconnectedTimeMs"]:this.HKe,["clientConnectionErrors"]:this.nPg,
["serverConnectionErrors"]:this.Yfh}}i4k(){this.oXb&&1===this.jAc&&(this.zzc=Math.max(this.zzc,this.pcb.getTime()-this.oXb.getTime()));this.SYb&&1<this.jAc&&(this.zzc=Math.max(this.zzc,this.pcb.getTime()-this.SYb.getTime()));this.syc&&1<this.jAc&&(this.HKe=Math.max(this.HKe,this.pcb.getTime()-this.syc.getTime()))}static createInstance(y){x._instance||(x._instance=new x,l.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",y));return x._instance}}x._instance=null;Object(D.a)(x,
"RealtimeChannelMetrics",null,[1107,158])},1898:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e,a){super();this.type=e;this.asa=a}}Object(D.a)(l,"PersistentStateUpdateEventArgs",Sys.EventArgs,[])},1899:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e){super();this.SGd=e}}Object(D.a)(l,"PersistentStateClearedEventArgs",Sys.EventArgs,[])},2096:function(D,J,c){c.r(J);var l=c(0),e=c(55);class a{constructor(Ga,
kb){this.Wfa=null;this.sBc=Ga;this.Nfk=kb}init(){this.sBc.continueWith(()=>{this.Wfa=this.sBc.result;this.Wfa.T2b(Object(e.a)(this,this.Lda,"onUsersUpdated"))})}Lda(){a.l3e(this.Wfa.q2a())&&(this.Wfa.k9f(Object(e.a)(this,this.Lda,"onUsersUpdated")),this.Nfk.IsRealCoauthSession=!0)}get NTm(){return this.Wfa?a.l3e(this.Wfa.q2a()):!1}static l3e(Ga){let kb=null;for(const nc of Ga)if(nc)if(Ga=nc.isAnonymous||!nc.email?nc.clientId:nc.email.toUpperCase(),!kb)kb=Ga;else if(kb!==Ga)return!0;return!1}}Object(l.a)(a,
"CoauthTelemetry",null,[295]);var k=c(7),x=c(464),y=c(69),n=c(2),t;(function(Ga){Ga[Ga.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Ga[Ga.notImplemented=1]="notImplemented";Ga[Ga.renderHandled=2]="renderHandled";Ga[Ga.renderHandledWithVeto=3]="renderHandledWithVeto"})(t||(t={}));Object(l.b)("CoauthorGalleryTelemetryEndResult",t);var z=c(86),v=c(85),I=c(132);class E{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf){this.mbh=this.JPg=this.BD=null;this.y6=Ga;this.gyd=new x.a;this.Ca=nc;this.Jwe=
kb;this.DZ=Kb;this.ag=ld;this.EOe=Kc;this.hdb=ue;this.LWj=Le;this.OYg=this.HYg=!1;this.zzd=0;this.HPg=1;this.rtb=cf;this.lFc=this.Ca.$("PeoplesWellExtraButtonInfoIsEnabled");this.Xea=Object(y.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.Application)||""}get owj(){return this.gyd.task}init(){I.Task.WAA.call(null,this.hdb,this.Jwe,this.EOe).continueWith(()=>{this.BD=this.hdb.result;this.JPg=this.Jwe.result;this.mbh=this.EOe.result;I.Task.WAA.call(null,this.Jwe.result.a5b,this.EOe.result.Zzj).continueWith(()=>
{this.HPg=this.JPg.a5b.result;this.zzd=this.mbh.Zzj.result;this.BD.T2b(Object(e.a)(this,this.q9d,"onUsersUpdatedEventListener"));this.BD.q2a().length&&this.Lda()})})}q9d(){this.Lda()}Lda(){this.LWj(this.BD.q2a())?(this.BD.k9f(Object(e.a)(this,this.q9d,"onUsersUpdatedEventListener")),this.epn(this.HYg)):this.gyd.vS(1);this.HYg=!0}epn(Ga){this.OYg?this.owj.continueWith(()=>{k.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",t[this.owj.result])}):(this.OYg=
!0,this.DKn(0===this.HPg&&!Ga))}DKn(Ga){Ga?this.DZ.pk(4,Object(e.a)(this,this.zXf,"onInteractiveReady")):this.gyd.vS(1)}zXf(){const Ga=this.ag.LG("AppInitStatus_interactivityReady");k.ULS.shipAssertTag(42259235,325,!!this.zzd);const kb=this.zzd-Ga,nc={};nc.InteractiveTime=Ga;nc.ReactRenderComplete=this.zzd;nc.HadTabSwitch=this.rtb();nc.IsModernGallery=this.lFc;k.ULS.sendTraceTag(594883104,325,50,v.a.toJSON(nc));this.lFc?(k.ULS.sendTraceTag(42062997,325,15,kb.toString()),this.gyd.vS(this.V3o(kb)?3:
2)):k.ULS.sendTraceTag(594883103,325,15,kb.toString())}V3o(Ga){const kb=Ga>this.Ca.nc("CoauthorGalleryTimeToRenderDurationMs",1E4),nc="Word"===this.Xea;if(this.rtb())return k.ULS.sendTraceTag(50455714,325,50,kb.toString()),!1;nc&&z.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);kb&&(nc&&z.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),k.ULS.sendTraceTag(42062998,325,15,Ga.toString()));
return kb}}Object(l.a)(E,"CoauthorGalleryTelemetry",null,[294]);class H{constructor(Ga){this.BD=null;this.Did={};this.kud={};this.exc=null;this.hdb=Ga}fUd(Ga){const kb=new x.a;this.init().continueWith(()=>{Ga in this.Did?kb.vS(this.Did[Ga]):this.kud[Ga]=kb});return kb.task}init(){if(this.exc)return this.exc.task;this.exc=new x.a;this.hdb.continueWith(()=>{this.BD=this.hdb.result;this.BD.T2b(Object(e.a)(this,this.Lda,"onUsersUpdated"));this.PHj();this.exc.Dg(null)});return this.exc.task}PHj(){const Ga=
this.BD.q2a();Ga.sort(Object(e.a)(this,this.H3k,"comparePresenceUsers"));this.Did={};for(let kb=0;kb<Ga.length&&Ga[kb]&&Ga[kb].gSa;kb++)this.Ouk(this.Did,Ga[kb].clientId,kb)}Ouk(Ga,kb,nc){Ga[kb]=nc;kb in this.kud&&(this.kud[kb].vS(nc),delete this.kud[kb])}Lda(){this.PHj()}H3k(Ga,kb){return Ga.gSa>kb.gSa?1:Ga.gSa<kb.gSa?-1:0}}Object(l.a)(H,"CoauthorPositionFinder",null,[293]);var M=c(598),K=c(360),L=c(505),S=c(75),Q=c(139);class N{constructor(){this.WCa=null;this.Wrc=Array(32)}xor(Ga){if(!Ga)throw Error.argumentNull("Guid argument cannot be null");
const kb=new N,nc=new Sys.StringBuilder;for(let Kb=0;Kb<Ga.Wrc.length;Kb++){const ld=this.Wrc[Kb]^Ga.Wrc[Kb];kb.Wrc[Kb]=ld;nc.append(ld.toString(16));7!==Kb&&11!==Kb&&15!==Kb&&19!==Kb||nc.append("-")}kb.WCa=Q.a.If(nc.toString());return kb}toString(){return this.WCa.toString()}equals(Ga){if(!Ga)throw Error.argumentNull("Guid argument cannot be null");return this.WCa.equals(Ga.WCa)}static f9b(Ga){if(!Ga)throw Error.argumentNull("String input cannot be null");const kb=new N;kb.WCa=Q.a.If(Ga);const nc=
kb.WCa.toString();let Kb=0;for(let Kc=0;Kc<nc.length;Kc++){var ld=Ga.charAt(Kc);if(N.JOm(ld))ld=N.Lum(ld,Ga.charCodeAt(Kc)),kb.Wrc[Kb++]=ld;else if(!N.eOm(ld))throw Error.argument("String contains characters not valid in Guids");}return kb}static JOm(Ga){return"0"<=Ga&&"9">=Ga||"A"<=Ga&&"F">=Ga||"a"<=Ga&&"f">=Ga}static eOm(Ga){return"{"===Ga||"}"===Ga||"-"===Ga}static Lum(Ga,kb){if("0"<=Ga&&"9">=Ga)return kb-48;if("A"<=Ga&&"F">=Ga)return kb-65+10;if("a"<=Ga&&"f">=Ga)return kb-97+10;throw Error.argument("Char is not valid hex digit");
}}Object(l.a)(N,"Guid",null,[]);class O{constructor(Ga,kb,nc,Kb){this.Wfa=null;this.cSg=this.n8g=!1;this.n5g=0;this.sBc=Ga;this.fVe=kb;this.Ca=nc;this.AZb=Kb;this.fWj=n.AFrameworkApplication.vTb||n.AFrameworkApplication.dqa;this.w6g=new M.a(K.a.ih())}get Cdf(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.sBc.continueWith(()=>{this.Wfa=this.sBc.result;this.Wfa.T2b(Object(e.a)(this,this.Lda,"onUsersUpdated"))})}Lda(){this.W0k(this.Wfa.q2a())}W0k(Ga){var kb=
0;const nc=new L.a(K.a.ih());for(const Kb of Ga)if(Kb&&Kb.isAnonymous){n.AFrameworkApplication.se("70eb6120;2gfeb930");if(nc.nb(Kb.userName))nc.J(Kb.userName).add(Kb.clientId);else{let ld;nc.add(Kb.userName,(ld=new S.a,ld.add(Kb.clientId),ld))}Kb.clientId!==this.AZb?(kb++,2<=kb&&!this.n8g&&this.m7m()):!this.cSg&&this.Cdf&&"Guest"===Kb.userName&&(k.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),this.cSg=!0)}if(this.Cdf&&this.n5g!==kb){k.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",
kb+(this.fWj?1:0));this.n5g=kb;for(let Kb of nc.keys)2<=nc.J(Kb).count&&(Ga=this.WWl(nc.J(Kb)),this.w6g.contains(Ga)||(kb={},kb.guestsWithSameName=nc.J(Kb).count,kb.identifier=Ga,k.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",kb),this.w6g.add(Ga)))}}m7m(){k.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.n8g=!0;this.Cdf&&this.fVe&&this.fVe.continueWith(()=>{window.setTimeout(()=>{this.fVe.result.logActivity("MultipleGuestsCoauthoring",
null)},15E3)})}WWl(Ga){if(!Ga||1>=Ga.count)return"";let kb=N.f9b(Ga.J(0));for(let nc=1;nc<Ga.count;nc++)kb=kb.xor(N.f9b(Ga.J(nc)));return kb.toString()}}Object(l.a)(O,"GuestCoauthTelemetry",null,[]);var X=c(250);class U{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(l.a)(U,"PL",null,[]);var T=c(35);class Y{constructor(){this.ct=this.vt=this.d=0}static nkj(Ga,kb,nc){const Kb=new Y;Kb.d=Ga;Kb.vt=kb;Kb.ct=nc;return T.c(Kb)}}Object(l.a)(Y,"VD",null,
[]);var aa=c(123);class ba{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg){this.ggh=!1;this._id=Ga;this.ki=kb;this.Thh=nc;this.ys=Kb;this.BLe=ld;this.WVe=Kc;this.xAb=ue;this.jub=Le;this.sZj=cf;this.rtb=Mf;this.tlh=Vg;this.Xea=Object(y.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.Application)||""}Cpe(Ga){const kb=[this.BLe,this.WVe];this.tlh&&kb.push(this.Thh);I.Task.WAA.apply(null,kb).continueWith(()=>{if(this.BLe.result<=this.WVe.result)Ga.vS(!1);else{this.tlh&&(this.ki=this.Thh.result);
var nc=this.ys-this.ki,Kb=new U;Kb.id=this._id;Kb.et=this.ys;Kb.st=this.ki;Kb.d=this.ys-this.ki;Kb.mp=this.BLe.result;Kb.tp=this.WVe.result;Kb.ct=this.bSl(this.sZj);Kb.vc=this.rtb();var ld=T.c(Kb),Kc="Word"===this.Xea,ue="PowerPoint"===this.Xea;k.ULS.sendTraceTag(42078597,302,15,ld);if(Kc){const Le=new Map;Le.set("data",ld);z.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Le)}nc>this.xAb.value&&!this.ggh&&!Kb.vc&&(this.ggh=!0,Ga.vS(!0),Kb=Object.assign(new aa.a,{inStaging:!0,
extendedProperties:new Map}),Kb.extendedProperties.set("data",ld),Kc&&z.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Kb),nc<this.jub.value&&(k.ULS.sendTraceTag(42078598,302,15,Y.nkj(nc,this.xAb.value,this.jub.value)),nc=n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),ue&&nc&&z.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],
!1,!0,!0,!1,Kb)));Ga.task.isCompleted||Ga.vS(!1)}})}bSl(Ga){switch(Ga){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(l.a)(ba,"PresenceLatencyActivityLogger",null,[]);class oa{constructor(Ga,kb,nc){this.xOg=this.FPg=this.bid=this.Cid=this.EUb=0;this._id=Ga;this.xAb=kb;this.jub=nc;this.Xea=Object(y.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.Application)||""}get Csh(){return this.EUb}set Csh(Ga){this.EUb=Ga;this.S7e()}get nGh(){return this.Cid}set nGh(Ga){this.Cid=
Ga;this.S7e()}get qCh(){return this.bid}set qCh(Ga){this.bid=Ga;this.S7e()}get oGh(){return 0!==this.FPg}get rCh(){return 0!==this.xOg}S7e(){!this.oGh&&this.EUb&&this.Cid&&(this.FPg=this.Cpe(this.Cid,"CoauthGalleryLightupDurationTooLong"));!this.rCh&&this.EUb&&this.bid&&(this.xOg=this.Cpe(this.bid,"CanvasPresenceLightupDurationTooLong"))}Cpe(Ga,kb){const nc=Ga-this.EUb;var Kb=new U;Kb.id=this._id;Kb.et=Ga;Kb.st=this.EUb;Kb.d=nc;var ld=T.c(Kb),Kc="Word"===this.Xea;Ga="PowerPoint"===this.Xea;Kb="CanvasPresenceLightupDurationTooLong"===
kb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===kb?k.ULS.sendTraceTag(572289499,302,15,ld):k.ULS.sendTraceTag(571524118,302,15,ld);if(Kc){var ue=new Map;ue.set("data",ld);z.Health.instance.recordKpiUsage(Kb,0,"wordcollabrel",ue)}return nc>this.xAb.value?(ue=Object.assign(new aa.a,{inStaging:!0,extendedProperties:new Map}),ue.extendedProperties.set("data",ld),ld=nc<this.jub.value,ue.extendedProperties.set("cash",ld?"true":"false"),Kc&&z.Health.instance.recordKpiFailure(Kb,
kb,!1,!0,ue),Kc=n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientRenderLatencyQoSError"),Ga&&Kc&&z.Health.instance.recordQosError(kb,[Kb],!1,!0,!0,!1,ue),k.ULS.sendTraceTag(572289500,302,15,Y.nkj(nc,this.xAb.value,this.jub.value)),ld?2:1):3}}Object(l.a)(oa,"PresenceLightupLatencyLogger",null,[]);var ma=c(50),ea=c(171);class ua{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le=null,cf=null,Mf=null){this.sch={};this.Iwe={};this.S3g=new S.a;this.Khd=this.fxc=this.BD=
this.lj=null;this.lUe=this.iUe=0;this.xAb=new X.a(()=>Le.zU("PresenceBootLatencyThreshold",1E4));this.jub=new X.a(()=>Le.zU("PresenceBootLatencyCutoffThreshold",6E4));this.fpk=new X.a(()=>Le.zU("PresenceLightupLatencyThreshold",2E3));this.x0j=new X.a(()=>Le.zU("PresenceLightupLatencyCutoffThreshold",1E4));this.DZ=Kb;this.Ca=Le;this.Ufk=ld;this.IPg=Ga;this.Seh=kb;this.hdb=nc;this.ag=Kc;this.AZb=cf;this.rtb=ue;this.WYg=Mf;this.Xue=!1;this.init()}vNc(Ga,kb,nc=null,Kb=0){nc&&(k.ULS.shipAssertTag(42274970,
302,!this.AZb||this.AZb===nc,"_myClientId is already set and you are trying to update it to something different"),this.AZb=nc);const ld=new x.a;this.init().continueWith(()=>{this.Ysn(Ga);this.vwl(ld,Ga,kb,Kb)})}get jTf(){return this.AZb||"{"+n.AFrameworkApplication.userSessionId+"}"}init(){if(this.fxc)return this.fxc.task;this.fxc=new x.a;this.rtb()&&k.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.IPg.continueWith(()=>{const Ga=this.IPg.result,kb=Ga.a5b,nc=Ga.ufn;nc.continueWith(()=>
{kb.continueWith(()=>{this.WYg&&this.WYg.addQosPillar("RealTimeCoauth");this.Hjg(kb.result,nc.result);this.fxc.Dg(null)})})});this.Seh.continueWith(()=>{this.lj=this.Seh.result;this.lj.Kua(Object(e.a)(this,this.nun,"onRtcConnection"));this.lj.V3(Object(e.a)(this,this.bnn,"onCoauthorBootReceived"))});this.hdb.continueWith(()=>{this.BD=this.hdb.result;this.BD.T2b(Object(e.a)(this,this.q9d,"onUsersUpdatedEventListener"));0<this.BD.q2a().length&&this.Lda()});return this.fxc.task}j7h(){return this.ag.Gna(ma.a.K9a)?
this.ag.LG(ma.a.K9a):ea.a.Mfb?window.performance.timing.fetchStart:-1}qbi(){this.Khd||(this.Khd=new x.a,this.DZ.pk(4,()=>{this.Khd.vS(this.ag.LG("AppInitStatus_interactivityReady"))}));return this.Khd.task}nun(Ga,kb){if(!this.Xue&&2===kb.newState)if(this.bpe){const nc=this.qbi();nc.continueWith(()=>{var Kb=nc.result;Kb=Date.now()-Kb;const ld={};ld.clientId=this.jTf;ld.bootTime=Kb;this.Xue=!0;this.lj.qN(15,ld)})}else Ga=this.j7h(),Ga=Date.now()-Ga,kb={},kb.clientId=this.jTf,kb.bootTime=Ga,this.Xue=
!0,this.lj.qN(15,kb)}bnn(Ga,kb){if(15===kb.type){Ga=Date.now();kb=kb.OL;var nc=kb.bootTime;this.tsf(kb.clientId).Csh=Ga-nc}}q9d(){this.Lda()}Lda(){const Ga=Date.now();var kb=this.BD.q2a();const nc=new S.a;for(const Kb of kb)this.S3g.contains(Kb.clientId)||(this.S3g.add(Kb.clientId),nc.add(Kb.clientId));if(0<nc.count)for(let Kb of nc)kb=this.tsf(Kb),kb.oGh||(kb.nGh=Ga)}Ysn(Ga){Ga=this.tsf(Ga);Ga.rCh||(Ga.qCh=Date.now())}tsf(Ga){return Ga in this.Iwe?this.Iwe[Ga]:this.Iwe[Ga]=new oa(Ga,this.fpk,this.x0j)}Hjg(Ga,
kb=0){this.iUe=Ga;this.lUe=kb?kb:(new Date).getTime()}vwl(Ga,kb,nc,Kb){nc=nc?nc.getTime():(new Date).getTime();if(kb in this.sch)Ga.Eka();else{const ld=this.bpe?0:this.Hfm(),Kc=this.bpe?this.Ifm():null;Kb=new ba(kb,ld,Kc,nc,this.fUd(this.jTf),this.fUd(kb),this.xAb,this.jub,Kb,this.rtb,this.bpe);this.sch[kb]=Kb;Kb.Cpe(Ga)}}Hfm(){return 1===this.iUe?this.lUe:this.j7h()}Ifm(){return 1===this.iUe?I.Task.C4(this.lUe):this.qbi()}fUd(Ga){return this.Ufk.fUd(Ga)}get bpe(){return this.Ca.$("UseAppInteractiveBootTimeForPresenceTelemetry")}}
Object(l.a)(ua,"PresenceBootTelemetry",null,[292]);var sa=c(134),Fa=c(186),Pa=c(236),Na=c(22),Aa=c(636);class za{get name(){return"Common.App.CoauthTelemetry"}wc(Ga){Ga.register(a,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ha().Ud(()=>new a(Aa.a.Gp(Ga.Sa("Common.IPeopleInfoProvider")),n.AFrameworkApplication.Og));Ga.register(E,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ha().Ud(()=>new E(n.AFrameworkApplication.va,
Aa.a.Gp(Ga.Sa("Common.ICoauthoringTelemeryInfoProvider")),n.AFrameworkApplication.K,sa.a.get_instance(),Pa.a.instance,Aa.a.Gp(Ga.Sa("Common.IPeoplesWell")),Aa.a.Gp(Ga.Sa("Common.IPeopleInfoProvider")),a.l3e,()=>this.fzh()));Ga.register(ua,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ha().Ud(()=>new ua(Aa.a.Gp(Ga.Sa("Common.ICoauthoringTelemeryInfoProvider")),Aa.a.Gp(Ga.Sa("Common.IRealtimeChannelBasic")),Aa.a.Gp(Ga.Sa("Common.IPeopleInfoProvider")),
sa.a.get_instance(),Ga.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Pa.a.instance,()=>this.fzh(),n.AFrameworkApplication.K,null,z.Health.instance));Ga.register(H,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ha().Ud(()=>new H(Aa.a.Gp(Ga.Sa("Common.IPeopleInfoProvider"))));Ga.register(O,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ha().Ud(()=>new O(Aa.a.Gp(Ga.Sa("Common.IPeopleInfoProvider")),Aa.a.Gp(Ga.Sa("Common.ISystemInitiatedFeedback")),
n.AFrameworkApplication.K,"{"+n.AFrameworkApplication.userSessionId+"}"))}init(){n.AFrameworkApplication.K.Nn(()=>{Na.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();Na.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();n.AFrameworkApplication.K.$("CoauthorGalleryTelemetryIsEnabled")&&Na.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();n.AFrameworkApplication.K.$("CashTelemetryIsEnabled")&&(Na.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),
Na.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}fzh(){return ea.a.Mfb&&Pa.a.instance.Gna(ma.a.xed)?0<Pa.a.instance.LG(ma.a.xed)[ma.a.LKj]:!1}static main(){Fa.a.instance.Gc(new za)}}Object(l.a)(za,"CoauthTelemetryPackage",null,[1,2]);class xa extends Sys.EventArgs{constructor(){super()}}Object(l.a)(xa,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var ka;(function(Ga){Ga[Ga.notYetStarted=0]="notYetStarted";Ga[Ga.polling=1]="polling";Ga[Ga.subscribed=2]="subscribed";
Ga[Ga.blocked=3]="blocked";Ga[Ga.permanentlyStopped=4]="permanentlyStopped"})(ka||(ka={}));Object(l.b)("RtcHostNotificationSubscriptionState",ka);var wa=c(93),ia=c(1434),va=c(81);class na{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf){this.Oh=!1;this.lba=this.z_b=this.jga=this.wZa=null;this.cEc=na.Cse;this.sa=new va.a;this.heb=new ia.a(0);this.heb.Q0e(Object(e.a)(this,this.wvn,"onStateMachineChanged"));this.Dik=Ga;this.xwd=kb;this.Cik=nc;this.BRe=Kb;this.Ib=ld;this.rf=Kc;ue.execute(Mf=>{this.Oh||(this.z_b=
Mf,this.z_b.V3(Object(e.a)(this,this.l1,"onUpdateNotificationReceived")),this.start())});Le.execute(Mf=>{this.Oh||(this.lba=Mf,Mf.J_a(Object(e.a)(this,this.ija,"onTokenRefreshed")))});this.wzd=cf}get Umc(){return this.heb.currentState}get ZCi(){return!this.rf||this.rf.aya}get uDi(){return 2===this.Umc&&this.wzd()<this.cEc}start(){0!==this.Umc?k.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",ka[this.Umc]):(this.heb.event(1),this.Gcg(null))}Gcg(){this.wZa=
null;if(this.ZCi){k.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",ka[this.Umc]);let Ga=null;this.BRe&&this.BRe.length&&(Ga={},Ga.etts=this.BRe);this.z_b.qN(14,Ga,!0);this.fij(this.Dik)}else this.heb.event(3)}fij(Ga){this.wZa=wa.a.A8(1E3*Ga,Object(e.a)(this,this.Gcg,"sendSubscribeEvent"),this.xwd,192,"RtcHostNotificationSubscribe");this.Ib.Wb(this.wZa)}eco(Ga){Ga=1E3*(Ga+this.Cik);const kb=this.wzd().getTime()+Ga;this.cEc=new Date(kb);Ga-=this.xwd;
this.jga?this.Ib.z1(this.jga,Ga):(this.jga=wa.a.A8(Ga,Object(e.a)(this,this.qOo,"transitionToPollingEvent"),this.xwd/2,194,"RtcHostNotificationTransitionToPolling"),this.Ib.Wb(this.jga))}qOo(){this.jga=null;2===this.Umc&&(this.heb.event(1),k.ULS.shipAssertTag(573100185,502,!!this.wZa,"Missing task to ensure that we re-subscribe."))}ija(){this.qom()}qom(){3===this.Umc&&this.ZCi&&(this.heb.event(this.uDi?2:1),this.Gcg(null))}l1(Ga,kb){if(13===kb.type&&(Ga=kb.OL,k.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",
{["SerializableHostNotificationSubscription"]:Ga,["DurationBeforeExpirationToResubscribeInSec"]:this.xwd}),kb=Ga.cts,!this.$Qo(kb))){if(Ga.sb){var nc=2;this.eco(Ga.cts)}else nc=1,this.cEc=na.Cse,this.jga&&(this.Ib.ff(this.jga),this.jga=null);this.heb.event(nc);this.wZa?this.Ib.z1(this.wZa,1E3*kb):this.fij(kb)}}$Qo(Ga){if(!isNaN(Ga)&&isFinite(Ga)&&0<Ga)return!1;this.Dwj(!1);return!0}Dwj(Ga){this.wZa&&(this.Ib.ff(this.wZa),this.wZa=null);this.jga&&(this.Ib.ff(this.jga),this.jga=null);this.z_b&&(this.z_b.iPb(Object(e.a)(this,
this.l1,"onUpdateNotificationReceived")),this.z_b=null);this.lba&&(this.lba.gPb(Object(e.a)(this,this.ija,"onTokenRefreshed")),this.lba=null);Ga||this.heb.event(4)}wvn(Ga,kb){Ga=kb.newState;const nc=kb.V2f,Kb={};Kb.NewState=ka[Ga];Kb.PreviousState=ka[nc];Kb.PreviousStateHits=kb.W2f;Kb.PreviousStateTransitionTime=kb.X2f.toISOString();Kb.IsSubscribed=this.uDi;this.cEc!==na.Cse&&(Kb.SubscriptionExpiringTime=this.cEc.toISOString());k.ULS.sendTraceTag(572346515,502,4===Ga?15:50,"HostNotificationChanged: {0}",
Kb);this.sa.raiseEvent("HN",new xa(nc,Ga))}dispose(){this.Oh||(this.Oh=!0,this.Dwj(!0),this.jga&&(this.Ib.ff(this.jga),this.jga=null))}}na.Cse=new Date(0);Object(l.a)(na,"RtcHostNotificationSubscriptionManager",null,[291,10]);var Ca=c(400);class ta{constructor(){this.Zh=this.Oh=!1}get name(){return"RtcHostNotificationSubscription"}wc(Ga){Ga.register(na,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").ha().Ud(()=>
{const kb=n.AFrameworkApplication.K;return new na(kb.nc("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),kb.nc("RtcHostNotificationRetryIntervalBufferInSeconds",120),kb.nc("RtcHostNotificationSubscriptionLostBufferInSeconds",60),this.sdm(kb),n.AFrameworkApplication.lc,Ca.SessionStatusManager.instance,Ga.Sa("Common.IRealtimeChannelBasic"),Ga.Sa("Common.ISessionExpirationManager"),()=>new Date)})}init(){n.AFrameworkApplication.K.Nn(()=>{!this.Oh&&n.AFrameworkApplication.K.$("RtcHostNotificationEnabled")&&
(this.Zh=!0,Na.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})}dispose(){this.Oh||(this.Oh=!0,this.Zh&&Na.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())}sdm(Ga){return Ga.rw("RtcEventTypesToSubscribe")?Ga.EB("RtcEventTypesToSubscribe"):null}static main(){Fa.a.instance.Gc(new ta)}}Object(l.a)(ta,"RtcHostNotificationSubscriptionPackage",null,[1,2]);var fa=c(472),Xa=c(649);
class ob{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg){this.clientId=Ga;this.SkypeChatThreadId=nc;this.chatThreadDiscoveryUri=Kb;this.inChat=ld;this.localColbaltSessionId=kb;this.capabilities=Kc;this.email=ue;this.isReadOnly=Le;this.userName=cf;this.isAnonymous=Mf;this.presenceStatus=Vg}}Object(l.a)(ob,"SerializablePresenceUserData",null,[]);class xb extends fa.a{constructor(Ga,kb,nc,Kb,ld=null,Kc=null,ue=null,Le=null,cf=null,Mf=!1,Vg=!1,Eg=!1,wi=null){super(Ga,kb,nc,Kb,Kc,ue,Le,cf,Mf,Vg,Eg);this.xP=
ld;this.presenceStatus=wi}getData(){return new ob(this.clientId,this.xP,this.AIc,this.chatThreadDiscoveryUri,this.inChat,this.capabilities.capabilities,this.email,this.isReadOnly,this.userName,this.isAnonymous,this.presenceStatus)}gUd(Ga){return(Ga=Ga.value)?Ga.user:null}clone(){return new xb(this.clientId,this.userName,this.color,this.capabilities.clone(),this.xP,this.AIc,this.email,this.client,this.chatThreadDiscoveryUri,this.isAnonymous,this.inChat,this.isReadOnly,this.presenceStatus)}static lDb(Ga){return Ga.clientId?
new xb(Ga.clientId,Ga.userName,null,new Xa.a(void 0===Ga.capabilities?0:Ga.capabilities),Ga.localColbaltSessionId,Ga.SkypeChatThreadId,Ga.email,null,Ga.chatThreadDiscoveryUri,Ga.isAnonymous,Ga.inChat,Ga.isReadOnly,Ga.presenceStatus):null}static zMh(Ga,kb,nc,Kb=null,ld=null,Kc=null,ue=null,Le=null,cf=!1,Mf=!1,Vg=!1,Eg=null){return Ga?new xb(Ga,kb,null,new Xa.a(void 0===nc?0:nc),Kb,ld,Kc,ue,Le,Vg,cf,Mf,Eg):null}}Object(l.a)(xb,"PresenceUser",fa.a,[1395,1396,25]);class zb extends xb{constructor(){super();
this.Hic=this.$Mf=null}a6l(){const Ga=n.AFrameworkApplication.userName,kb=n.AFrameworkApplication.K.kb("UserPrincipalName"),nc=this.$Mf?this.$Mf.xP:null,Kb=n.AFrameworkApplication.vTb||n.AFrameworkApplication.dqa,ld=this.Hic?this.Hic.getStatus():null;return new xb(this.clientId,Ga,this.color,this.capabilities,nc,this.AIc,kb,this.client,this.chatThreadDiscoveryUri,Kb,this.inChat,this.isReadOnly,ld)}}Object(l.a)(zb,"MyPresenceUser",xb,[1461,25]);var Lb=c(25),Ia=c(219);class Ya{constructor(Ga,kb,nc,
Kb,ld){this.Vf=Ga;this._clientId=kb;this.z1j=ld;this.v5j=nc||(()=>null);this.w5j=Kb||(()=>null)}get id(){return this.Vf.id}get rBd(){return this.Vf.rBd}get vBd(){return this.Vf.vBd}get uBd(){return this.Vf.uBd}get tBd(){return this.Vf.tBd}get sBd(){return this.Vf.sBd}get xBd(){return this.Vf.xBd}get lZe(){return this.Vf.lZe}get vmc(){return this.Vf.vmc}get Yje(){return this.Vf.Yje}get Q5d(){return this.Vf.Q5d}get clientId(){return this._clientId}get vSc(){return this.v5j}get Ojb(){return this.w5j}get yql(){return this.z1j}static createInstance(Ga,
kb,nc,Kb,ld=!1){return new Ya(Ga,kb,nc,Kb,ld)}}Object(l.a)(Ya,"PeoplesWellSettings",null,[]);var eb=c(15),sb=c(67),lc=c(177),vb=c(109),Eb=c(208),Ua=c(163),Ta=c(403),Nb=c(341);class Wa extends Eb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(l.a)(Wa,"PeopleButtonProps",Eb.a,[]);var Bb=c(414),Ob=c(19),hc=c(83);class Gc{constructor(Ga){this.yed=new hc.a;this.Bdf=null;this.clientId=
Ga}Upo(Ga){this.d_n();this.oio(Ga);for(const kb of Ga)kb.clientId!==this.clientId&&this.Gqh(kb)}get rrg(){const Ga=[];for(let kb of this.yed.values){const nc=this.Yij(kb);Array.add(Ga,nc)}return Ga}get Cnb(){return this.yed.count}d0e(Ga,kb){Ga=Ga.toUpperCase();let nc;({value:nc}=this.yed.Fc(Ga)).returnValue||(nc=[],this.yed.Z(Ga,nc));Array.add(nc,kb)}d_n(){this.yed=new hc.a}oio(Ga){for(const kb of Ga)if(kb.clientId===this.clientId){this.Bdf=kb;break}}}Object(l.a)(Gc,"UserTracker",null,[1206]);class bc extends Gc{constructor(Ga,
kb){super(Ga);this.x5j=kb}Gqh(Ga){Ga.isAnonymous||!Ga.email?this.d0e(Ga.clientId,Ga):this.Bdf&&K.a.ih().equals(this.Bdf.email,Ga.email)||this.d0e(Ga.email,Ga)}Yij(Ga){let kb=new Date(0),nc=0<Ga.length?Ga[0]:null;for(const Kb of Ga)(Ga=this.x5j(Kb.clientId))&&kb.getTime()<Ga.$ec.getTime()&&(kb=Ga.$ec,nc=Kb);return nc}}Object(l.a)(bc,"UniqueUserTracker",Gc,[]);class Dc extends Gc{constructor(Ga){super(Ga)}Gqh(Ga){this.d0e(Ga.clientId,Ga)}Yij(Ga){return Ga[0]}}Object(l.a)(Dc,"UserInstanceTracker",Gc,
[]);const Ub=(Ga,kb,nc)=>nc?new bc(Ga,kb):new Dc(Ga);var Fc=c(70),Sa=c(611),wb=c(12);class Tb{constructor(Ga,kb=null,nc=null){this.BD=null;this.eWe=new x.a;this.Vf=Ga;this.V$d=kb;nc&&nc.continueWith(()=>{this.BD=nc.result;this.BD.T2b(Object(e.a)(this,this.Lda,"onUsersUpdated"));this.rde()});new fa.a(this.settings.clientId,"Anonymous user","#cccccc",new Xa.a(7));this.HFf=this.THe=!0;this.GDe=this.DOe=!1;this.yAa=Ub(this.settings.clientId,this.settings.Ojb,Ga.yql)}get settings(){return this.Vf}get gKm(){return n.AFrameworkApplication.K?
n.AFrameworkApplication.K.$("ColorPresenceHashIsEnabled"):!1}get cKm(){return n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"):!1}$Tl(){let Ga;let kb,nc,Kb,ld;var Kc=this.aUl();this.yAa.Cnb?1===this.yAa.Cnb?(kb=!0,nc=this.settings.vmc.cluster,Kb=this.settings.vmc.eKd,ld=this.yAa.rrg[0].color):(kb=!0,nc=this.settings.Q5d.cluster,Kb=this.settings.Q5d.eKd,ld=""):(kb=!1,ld=Kb=nc="");Ga=Kc[0];Kc=Kc.slice(1);return{Gyn:Ga,Hyn:Kc,Cyn:kb,Kpp:nc,Eyn:Kb,Dyn:ld}}aUl(){if(2<=
this.yAa.Cnb)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.yAa.Cnb)];if(1===this.yAa.Cnb){const Ga=this.yAa.rrg[0],kb=this.settings.Ojb(Ga.clientId);return kb&&2===kb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,Ga.userName]:[Ga.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,Ga.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}ykm(Ga){return this.zkm(Ga)}TBh(Ga,
kb,nc){return kb?this.sTk(kb)?(Ga=this.settings.Ojb(Ga))&&2===Ga.status?!1:!0:(nc&&k.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(nc&&k.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),!1)}Ofm(Ga){return Ga.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}zkm(Ga){if(!Ga.capabilities.TFa(1))return this.Ofm(Ga);const kb=Ga.isReadOnly,nc=this.settings.Ojb(Ga.clientId);
Ga=this.settings.vSc(Ga.clientId);if(!nc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(nc.status){case 1:return Ga?kb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.i8k(Ga)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}m1l(Ga){if(this.V$d.dZc)return this.V$d.BDb(Ga.email,
"O365",n.AFrameworkApplication.em,0)}jkm(Ga){Ga=this.settings.Ojb(Ga.clientId);return!Ga||Ga&&1===Ga.status?!0:!1}mkm(Ga){var kb=String.format("buttonPeoplesWellUser-{0}",Ga.clientId),nc=Ga.clientId,Kb=this.ykm(Ga);const ld=Ga.userName,Kc=Ga.color;var ue=Object,Le=ue.assign,cf=new Wa,Mf=this.settings.xBd.toString(),Vg=this.settings.Yje.cluster,Eg=this.settings.Yje.eKd,wi=this.l9h(),sm=Ga.isAnonymous,sh;if(sh=[ld],sh.length){var Rj=new Sys.StringBuilder("STRARRY@");for(const Ni of sh)Rj.append(Ni?
Ni.length:0),Rj.append(","),Rj.append(Ni),Rj.append(",");sh=Rj.toString().slice(0,-1)}else sh=null;kb=Le.call(ue,cf,{Id:kb,Command:Mf,LabelText:"{0}",Image32by32:Vg,Image32by32Class:Eg,MenuItemId:nc,CommandValueId:nc,Alt:ld,DisplayMode:wi,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:Kb,ImageBackColor:Kc,IsAnonymous:sm,LabelTextUserGeneratedPlaceholderReplacements:sh,Upn:Ga.email});n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")&&
this.V$d&&(nc=this.m1l(Ga),Kb=this.jkm(Ga),kb.ImageUrl=nc,kb.ActiveStatus=Kb,kb.JoinTimeInMS=Ga.gSa,Ga=this.TBh(Ga.clientId,this.settings.vSc(Ga.clientId),!1),kb.CanJump=Ga,""===nc&&k.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));return kb}z_l(){return Object.assign(new Eb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}l9h(){return this.gKm?"Initials":
"Menu32"}nkm(Ga){const kb=[];for(const nc of Ga)Ga=this.mkm(nc),Array.add(kb,Ga);return kb}VZd(){return 0<this.yAa.Cnb}PNn(Ga){if(!this.THe)return!0;this.HFf||(Ga[Sa.a.Visible]=!0);let kb,nc,Kb,ld,Kc;({Gyn:kb,Hyn:nc,Cyn:Kb,Eyn:ld,Dyn:Kc}=this.$Tl());Ga[Sa.a.LabelText]=kb;nc&&nc.length&&(Ga[Sa.a.LabelTextUserGeneratedPlaceholderReplacements]=nc);Ga[Sa.a.ImageIsVisible]=Kb;Ga[Sa.a.Image16by16Class]=ld;Ga[Sa.a.ImageBackColor]=Kc;this.THe=!1;return!0}hFn(Ga){if(0>=this.yAa.Cnb)return!1;var kb=this.kBo(this.yAa.rrg),
nc=this.nkm(kb);kb=Object.assign(new Ta.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});nc=Object.assign(new Nb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.l9h(),ControlList:nc});n.AFrameworkApplication.K.$("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.V$d&&(nc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,nc.TitleId="menuCoauthorsTitle",nc.Theme="Light");Array.add(kb.MenuSectionList,nc);n.AFrameworkApplication.K.$("DocChatIsEnabled")&&n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")&&
n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.Gr&&(nc=[],Array.add(nc,this.z_l()),nc=Object.assign(new Nb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:nc}),Array.add(kb.MenuSectionList,nc));n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.Gr?Ga.MenuItems=kb:Ga.PopulationXML=Ua.o(kb);return!0}org(Ga){k.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");Ga=Ga.MenuItemId;if(!Ga)return!1;const kb=this.settings.vSc(Ga);if(!this.TBh(Ga,kb,
!0))return!1;this.AZm(kb);return!0}NUn(){const Ga=this.eOl();this.yAa.Upo(Ga);this.HFf&&1<=this.yAa.Cnb&&(k.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.HFf=!1);this.THe=!0}Lda(){this.GDe||(window.setTimeout(()=>{this.rde();this.GDe=!1},3E3),this.GDe=!0)}eOl(){let Ga;Ga=this.dOl()||[];for(const kb of Ga)this.Kao(kb);return Ga}Kao(Ga){Ga.clientId||(Ga.clientId=Q.a.create().toString());Ga.userName||(Ga.userName="Anonymous user");Ga.capabilities||(Ga.capabilities=
new Xa.a);Ga.color||(Ga.color="#cccccc");Ga.gSa||(Ga.gSa=0)}kBo(Ga){const kb=[];Array.addRange(kb,Ga);kb.sort(Tb.qyn);return kb}fYn(){n.AFrameworkApplication.K.$("CoauthorGalleryTelemetryIsEnabled")&&!this.DOe&&(n.AFrameworkApplication.va.l0(wb.a.zGh)&&Bb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||n.AFrameworkApplication.va.fb(wb.a.zGh,Fc.a.frame,Object(e.a)(this,this.cnn,"onCoauthorGalleryFirstRender"),96));this.gYn();this.DOe=
!0;this.rde()}cnn(Ga,kb,nc,Kb,ld){this.eWe.vS(ld.RenderTime);return 32}get Zzj(){return this.eWe.task}rde(){if(!this.DOe&&(this.eWe.vS((new Date).getTime()),k.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.cKm))return;this.NUn();this.OUn()}dispose(){this.BD&&(this.BD.k9f(Object(e.a)(this,this.Lda,"onUsersUpdated")),this.BD=null)}static qyn(Ga,kb){return Ga.capabilities.TFa(1)&&kb.capabilities.TFa(1)||!Ga.capabilities.TFa(1)&&
!kb.capabilities.TFa(1)?Ob.a.localeCompare(Ga.userName,kb.userName):Ga.capabilities.TFa(1)?-1:1}}Object(l.a)(Tb,"APeoplesWell",null,[1148,10]);var Hb=c(11);const $a=()=>!0;class ab extends Tb{constructor(Ga,kb,nc=null,Kb=null){super(Ga,nc,Kb);this.UKm=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,()=>this.VZd(),$a);this.QNn=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,Mf=>this.PNn(Mf),$a);this.iFn=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,$a,Mf=>this.hFn(Mf));this.O1k=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,$a,$a);this.N1k=(ld,Kc,ue,Le,
cf)=>this.w3a(ue,cf,$a,$a);this.V1o=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,$a,Mf=>this.org(Mf));this.XCn=(ld,Kc,ue,Le,cf)=>this.w3a(ue,cf,$a,()=>{this.rde();return!0});this.ga=kb}w3a(Ga,kb,nc,Kb){let ld=!1;switch(Ga){case 1:ld=nc(kb);break;case 2:ld=Kb(kb)}return ld?32:8}gYn(){this.ga.qa(this.settings.rBd,Hb.a.application,this.UKm);this.ga.fb(this.settings.vBd,Hb.a.application,this.QNn,96);this.ga.fb(this.settings.tBd,Hb.a.application,this.O1k,96);this.ga.fb(this.settings.sBd,Hb.a.application,this.N1k,
96);this.ga.fb(this.settings.uBd,Hb.a.application,this.iFn,96);this.ga.qa(this.settings.xBd,Hb.a.application,this.V1o);this.ga.fb(this.settings.lZe,Hb.a.application,this.XCn,96)}}Object(l.a)(ab,"ABox4PeoplesWell",Tb,[]);var rb=c(3),cb=c(49),rc=c(8),Rb=c(28),fb=c(169);class Pb{static isSupported(Ga){for(let kb=0;kb<Pb.Hxj.length;kb++)if(Ga===Pb.Hxj[kb])return!0;return!1}}Pb.Hxj=[1];Object(l.a)(Pb,"RTTDataVersion",null,[]);var Ec=c(1655);const uc=Ga=>{if("number"!==typeof Ga.RK||"number"!==typeof Ga.DK)return!1;
let kb,nc=!1,Kb=!1,ld=!1;switch(Ga.RK){case 0:Kb=kb=!0;break;case 1:ld=nc=Kb=kb=!0;break;case 2:if(null!=Ga.PE&&"number"!==typeof Ga.PE)return!1;kb=!0;break;case 4:kb=!0;break;case 3:Kb=kb=!0;break;case 5:nc=kb=!0;break;default:return!1}return kb&&("number"!==typeof Ga.PS||"number"!==typeof Ga.TS)||Kb&&("object"!==typeof Ga.OS||!Ga.OS||!Ec.validateVersionedCpData(Ga.OS))||nc&&("number"!==typeof Ga.PE||"number"!==typeof Ga.TE)||ld&&("object"!==typeof Ga.OE||!Ga.OE||!Ec.validateVersionedCpData(Ga.OE))?
!1:!0},ya=Ga=>{let kb="";if("number"!==typeof Ga.I)return{returnValue:!1,mia:"Invalid PacketId Type"};if("number"!==typeof Ga.O)return{returnValue:!1,mia:"Invalid Operation Type"};if("string"!==typeof Ga.A)return{returnValue:!1,mia:"Invalid ClientId Type"};if("object"!==typeof Ga.AN)return{returnValue:!1,mia:"Invalid Anchor Object Type"};if(!Ga.AN)return{returnValue:!1,mia:"Null AnchorObject"};if(!uc(Ga.AN)){let nc;try{nc=T.c(Ga.AN)}catch(Kb){nc=String.format("Failed to JSON-serialize payload : {0}",
Kb)}8E3<nc.length&&(nc=String.format("Payload exceeds maximum length: {0} > {1}, not logging",nc.length,8E3));kb="Invalid AnchorObject: "+nc+", Client: "+Ga.C;return{returnValue:!1,mia:kb}}return!Ga.O&&Ga.AN.RK?(kb="Invalid RangeKind:"+Ga.AN.RK+" for Caret",{returnValue:!1,mia:kb}):2===Ga.O&&("number"!==typeof Ga.TF||"undefined"!==typeof Ga.TX&&"string"!==typeof Ga.TX||1!==Ga.AN.RK&&Ga.AN.RK)?{returnValue:!1,mia:"Invalid TypingData"}:3!==Ga.O||"object"===typeof Ga.AP&&Ga.AP&&"number"===typeof Ga.AP.TFA&&
"number"===typeof Ga.AP.PN&&"number"===typeof Ga.AP.TN&&2===Ga.AN.RK?6!==Ga.O||"object"===typeof Ga.MP&&Ga.MP&&"number"===typeof Ga.MP.PM&&"number"===typeof Ga.MP.TM&&5===Ga.AN.RK?4!==Ga.O||"object"===typeof Ga.SP&&Ga.SP&&"number"===typeof Ga.SP.PA&&"number"===typeof Ga.SP.TA&&"number"===typeof Ga.SP.PB&&"number"===typeof Ga.SP.TBS&&3===Ga.AN.RK&&(Ga.AN.PS===Ga.SP.PA||Ga.AN.PS===Ga.SP.PB)?7!==Ga.O||"object"===typeof Ga.SPS&&Ga.SPS&&"string"===typeof Ga.SPS.SF&&"boolean"===typeof Ga.SPS.SL?null!=Ga.ISS&&
"number"!==typeof Ga.ISS?{returnValue:!1,mia:"invalid StrictlySequentialId"}:{returnValue:!0,mia:kb}:{returnValue:!1,mia:"Invalid SymbolData"}:{returnValue:!1,mia:"Invalid SplitParaData"}:{returnValue:!1,mia:"Invalid RemoveParaData"}:{returnValue:!1,mia:"Invalid AddParaData"}};var db=c(1627);class tb{constructor(Ga,kb=null,nc=null){this.V1=this.S_f=this.wmg=null;null!=Ga&&(this.wmg=Ga);null!=kb&&(this.S_f=kb);null!=nc&&(this.V1=nc)}}Object(l.a)(tb,"AddParaData",null,[]);class Xb{constructor(Ga=null,
kb=null){this.Fnc=this.R_f=null;null!=Ga&&(this.R_f=Ga);null!=kb&&(this.Fnc=kb)}}Object(l.a)(Xb,"MergeRemoveParaData",null,[]);class $b{constructor(Ga,kb,nc,Kb,ld,Kc,ue=null,Le=null,cf=null,Mf=null,Vg=null,Eg=null,wi=0,sm=null){this.Dbd=this.text=this.fSb=this.yRb=this.Q0c=this.E2b=this.Qka=null;this.packetId=Ga;this.client=nc;this.nt=Kb;this.clientId=kb.toLowerCase();this.RT=ld;this.version=wi;Kc&&(this.Qka=Kc);null!=ue&&(this.fSb=ue);void 0!==Le&&null!==Le&&(this.text=Le);cf&&(this.E2b=cf);Mf&&
(this.Q0c=Mf);Vg&&(this.yRb=Vg);Eg&&(this.Dbd=Eg);this.strictlySequentialId=sm}}Object(l.a)($b,"RTTData",null,[]);class Ab{constructor(Ga=null,kb=null,nc=null,Kb=null){this.vmg=this.Q_f=this.smg=this.P_f=null;null!=Ga&&(this.P_f=Ga);null!=kb&&(this.smg=kb);null!=nc&&(this.Q_f=nc);null!=Kb&&(this.vmg=Kb)}}Object(l.a)(Ab,"SplitParaData",null,[]);class vc{constructor(Ga=null,kb=null){this.Wkg=this.Vkg=null;Ga&&(this.Vkg=Ga);null!=kb&&(this.Wkg=kb)}}Object(l.a)(vc,"SymbolData",null,[]);class Sc{constructor(Ga,
kb=null,nc=null){null!=Ga&&(this.TFA=Ga);null!=kb&&(this.PN=kb);null!=nc&&(this.TN=nc)}}Object(l.a)(Sc,"SerializableAddParaDataV1",null,[]);class ed{constructor(Ga=null,kb=null){null!=Ga&&(this.PM=Ga);null!=kb&&(this.TM=kb)}}Object(l.a)(ed,"SerializableMergeRemoveParaDataV1",null,[]);class pd{}Object(l.a)(pd,"SerializableRTTDataV1",null,[]);class oc{constructor(Ga=null,kb=null,nc=null,Kb=null){null!=Ga&&(this.PA=Ga);null!=kb&&(this.TA=kb);null!=nc&&(this.PB=nc);null!=Kb&&(this.TBS=Kb)}}Object(l.a)(oc,
"SerializableSplitParaDataV1",null,[]);class cd{constructor(Ga=null,kb=null){Ga&&(this.SF=Ga);null!=kb&&(this.SL=kb)}}Object(l.a)(cd,"SerializableSymbolDataV1",null,[]);const Xc=Ga=>{var kb;if(!({mia:kb}=ya(Ga)).returnValue)return k.ULS.sendTraceTag(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",kb),null;let nc=kb=null,Kb=null,ld=null,Kc=null,ue=null,Le=null,cf=null;Ga.WD&&(kb=Ga.WD);null!=Ga.TF&&(nc=Ga.TF);void 0!==Ga.TX&&null!==Ga.TX&&(Kb=Ga.TX);Ga.AP&&(ld=new tb(Ga.AP.TFA,Ga.AP.PN,
Ga.AP.TN));Ga.MP&&(Kc=new Xb(Ga.MP.PM,Ga.MP.TM));Ga.SP&&(ue=new Ab(Ga.SP.PA,Ga.SP.TA,Ga.SP.PB,Ga.SP.TBS));Ga.SPS&&(Le=new vc(Ga.SPS.SF,Ga.SPS.SL));null!=Ga.ISS&&(cf=Ga.ISS);return new $b(Ga.I,Ga.A,Ga.C,Ga.O,db.a(Ga.AN),kb,nc,Kb,ld,Kc,ue,Le,1,cf)},ic=Ga=>{let kb=Ga;if("number"===typeof kb.V){if(1===kb.V)return Xc(Ga);k.ULS.sendTraceTag(9188758,302,15,"Unsupported Version");return null}let nc=0,Kb=null;for(let ld=0;ld<Ga.length;ld++)kb=Ga[ld],Pb.isSupported(kb.V)&&kb.V>nc&&(nc=kb.V,Kb=Ga[ld]);return 1===
nc?Xc(Kb):null},Ac=Ga=>{if(Ga){const kb=new pd;kb.I=Ga.packetId;kb.V=1;kb.A=Ga.clientId;kb.C=Ga.client;kb.O=Ga.nt;kb.AN=db.c(Ga.RT);Ga.Qka&&(kb.WD=Ga.Qka);null!=Ga.fSb&&(kb.TF=Ga.fSb);void 0!==Ga.text&&null!==Ga.text&&0<Ga.text.length&&(kb.TX=Ga.text);Ga.E2b&&(kb.AP=new Sc(Ga.E2b.wmg,Ga.E2b.S_f,Ga.E2b.V1));Ga.Q0c&&(kb.MP=new ed(Ga.Q0c.R_f,Ga.Q0c.Fnc));Ga.yRb&&(kb.SP=new oc(Ga.yRb.P_f,Ga.yRb.smg,Ga.yRb.Q_f,Ga.yRb.vmg));Ga.Dbd&&(kb.SPS=new cd(Ga.Dbd.Vkg,Ga.Dbd.Wkg));kb.ISS=Ga.strictlySequentialId;Ga=
kb}else Ga=null;return Ga};var wd=c(61);class Je{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf){this.LocalCobaltSessionId=Ga;this.SkypeChatThreadId=kb;this.ChatThreadDiscoveryUri=nc;this.InChat=Kb;this.Capabilities=ld;this.Email=Kc;this.UserName=ue;this.IsAnonymous=Le;this.PresenceStatus=cf}}Object(l.a)(Je,"SerializableWacData",null,[]);class Zd{constructor(){this.Zxd=this.Yxd=0}R6l(){this.Zxd===Number.MAX_VALUE&&(this.Zxd=0);this.Zxd++;return this.Zxd}Q6l(){this.Yxd===Number.MAX_VALUE&&(this.Yxd=0);this.Yxd++;
return this.Yxd}static get instance(){return Zd.klk}}Zd.klk=new Zd;Object(l.a)(Zd,"StrictlySequentialIdGenerator",null,[300]);var le=c(1552);class kc{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le=0){this.Lta=null;this.dryDeletion=0;this.XI=Ga;this.SMa=Kc;this.ud=ld;this.LAb=ue;this.Wc=kb;this.shapeId=Le;this.bIa=nc;this.o$=ue.create(this,Kb,ld,Kc)}clone(){return new kc(this.XI,this.Wc,this.bIa,this.o$.QTb,this.ud,this.SMa,this.LAb,this.shapeId)}get paragraphId(){return this.Lta?this.Lta:this.XI.Ajb(this.Wc)}xYf(){this.Lta||
(this.Lta=this.paragraphId,this.o$.xYf())}isValid(){return 0<=this.o$.cp}getData(){const Ga=this.o$.QTb;return Ga?new le.a(0,this.Wc,this.bIa,Ga,null,null,null,0,this.shapeId):null}static lDb(Ga,kb,nc,Kb,ld){return kb?new kc(kb,parseInt(Ga.nTa),Ga.V8a,Ga.cS,nc,Kb,ld,Ga.shapeId):null}}Object(l.a)(kc,"WordPresenceIp",null,[289,69,290]);class kd{constructor(Ga,kb,nc){this.TUa=this.kda=this.uzc=!1;this.$cb=Ga;this.WXa=nc;this.user=kb}get ip(){return this.WXa}get Tfc(){return this.uzc}set Tfc(Ga){(this.uzc=
Ga)&&this.ip.xYf()}Vuf(){const Ga=Zd.instance.Q6l();return new $b(this.$cb,this.user.clientId,1,0,this.ip?this.ip.getData():null,new Je(this.user.xP,this.user.AIc,this.user.chatThreadDiscoveryUri,this.user.inChat,this.user.capabilities.capabilities,this.user.email,this.user.userName,this.user.isAnonymous,this.user.presenceStatus),void 0,void 0,void 0,void 0,void 0,void 0,void 0,Ga)}jai(){return this.user.clientId+(this.ip?this.ip.paragraphId.toString():wd.a.nil.toString())}isValid(){const Ga=!!this.user&&
this.user.isValid(),kb=!this.ip||this.ip.isValid();return Ga&&kb}clone(){const Ga=new kd;Ga.$cb=this.$cb;Ga.uzc=this.uzc;Ga.user=this.user?this.user.clone():null;Ga.WXa=this.ip?this.ip.clone():null;Ga.kda=this.kda;Ga.TUa=this.TUa;return Ga}static zbf(Ga,kb,nc,Kb,ld){if(!Ga||!kb)return null;if(Ga.nt)return k.ULS.sendTraceTag(7685324,302,15,"Presence packet is of unexpected operationType {0}",Ga.nt),null;let Kc;Kc=void 0!==Ga.Qka&&null!==Ga.Qka?xb.zMh(Ga.clientId,Ga.Qka.UserName,Ga.Qka.Capabilities,
Ga.Qka.LocalCobaltSessionId,Ga.Qka.SkypeChatThreadId,Ga.Qka.Email,Ga.client,Ga.Qka.ChatThreadDiscoveryUri,Ga.Qka.InChat,!1,Ga.Qka.IsAnonymous,Ga.Qka.PresenceStatus):xb.zMh(Ga.clientId,null,0,void 0,void 0,void 0,Ga.client);return new kd(Ga.packetId,Kc,kc.lDb(Ga.RT,kb,nc,Kb,ld))}}Object(l.a)(kd,"WordPresenceInfo",null,[299,69]);class nd extends ab{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,Eg,wi,sm){super(Ga,Kc,sm,kb);this.UYj=nc;this.Oik=Kb;this.ihk=ld;this.hb=ue;nd.hu=Le;this.XI=cf;this.ud=Mf;
this.SMa=Vg;this.OYe=Eg;this.VKa=wi}org(Ga){this.VKa.EFi(Ga.CommandValueId);return super.org(Ga)}AZm(Ga){let kb;({I2f:kb}=this.BHf(Ga)).returnValue&&(this.Oik(kb.ip.paragraphId,kb.ip.o$.cp),n.AFrameworkApplication.K.$("WordEditorMoveIpToUserLocationIsEnabled")&&(Ga=nd.uem(kb),void 0!==Ga&&null!==Ga?(k.ULS.sendTraceTag(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),this.hb.Ac(Ga),sb.FocusManager.nK()&&sb.FocusManager.instance().mg(lc.AFrame.In)):k.ULS.sendTraceTag(20764575,
325,50,"IP will not be moved since the selection is either null or undefined")),Ga=new wa.a(2,1,0,()=>{this.ga.Qb(rb.a.yje,2,kb)}),vb.a.instance.Wb(Ga))}sfi(Ga){return Ga?(Ga=kd.zbf(ic(Ga),this.XI,this.ud,this.SMa,this.OYe.instance))&&Ga.isValid()&&Ga.ip?Ga:null:null}sTk(Ga){return this.pTm(Ga)?this.MTk(Ga)?!0:(k.ULS.sendTraceTag(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),!1):(k.ULS.sendTraceTag(41236612,325,50,"Cannot jump to user location because presence is not valid"),
!1)}pTm(Ga){return!!this.sfi(Ga)}BHf(Ga){Ga=this.sfi(Ga);return{returnValue:!!Ga,I2f:Ga}}MTk(Ga){let kb;return({I2f:kb}=this.BHf(Ga)).returnValue?this.UYj(kb.ip.paragraphId,kb.ip.o$.cp):!1}dOl(){if(!this.BD)return[];const Ga=[];for(const kb of this.BD.q2a())kb.userName?Ga.push(kb):k.ULS.sendTraceTag(592229832,304,15,"The looked up RTC User has no name");return Ga}i8k(Ga){let kb;return({I2f:kb}=this.BHf(Ga)).returnValue&&kb.user&&kb.user.presenceStatus&&"0"!==kb.user.presenceStatus?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,
kb.user.presenceStatus):CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}OUn(){this.ihk(this.settings.id)}static createInstance(Ga,kb,nc,Kb,ld,Kc,ue){const Le=Lb.StaticActiveAppFrame.za().jb,cf=n.AFrameworkApplication.va,Mf=cb.a.instance,Vg=Na.a.instance.resolve("Box4.ICoauthCashTelemetry");return new nd(Ga,kb,Eg=>Le.rc.$i?Le.rc.Z6e(Eg,!0):!1,(Eg,wi)=>{Le.rc.$i&&Le.rc.rUa(Eg,wi,!0,!0,!1)},()=>{eb.App.Iv.gJ.Sdd()},cf,Mf,Le,nc,Kb,ld,Kc,Vg,ue)}static uem(Ga){const kb=nd.hu.Zc.xd.Eb(Ga.ip.paragraphId);
if(void 0===kb||null===kb)return k.ULS.sendTraceTag(20764576,325,15,"The node could not be obtained"),null;if(!rc.ParagraphReader.Xb(kb))return k.ULS.sendTraceTag(20764577,325,15,"The obtained node is not a paragraph node"),null;Ga=Rb.a.Uc(kb,Ga.ip.o$.cp);return new fb.Selection([Ga],!0)}}nd.hu=null;Object(l.a)(nd,"WordEditorPeoplesWell",ab,[]);class Ud{constructor(){this.$x=()=>{n.AFrameworkApplication.Y1i?Ud.lra.bE().continueWith(this.R2c):k.ULS.sendTraceTag(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")};
this.R2c=()=>{Ud.lj=Ud.lra.bE().result;if(Ud.lj){var Ga=()=>{const kb=Lb.StaticActiveAppFrame.za().jb;return kb?kb.Zc?kb.Zc.xd:(k.ULS.sendTraceTag(23196876,325,15,"ActivePage is null"),null):(k.ULS.sendTraceTag(23196875,325,15,"Workspace is null"),null)};eb.App.Xoa().continueWith(()=>{const kb=eb.App.Xoa().result.rj,nc=Ia.CuiHelper.u$l(n.AFrameworkApplication.Ms,n.AFrameworkApplication.Ms,n.AFrameworkApplication.Ms,n.AFrameworkApplication.Ms),Kb=Ya.createInstance(nc,kb,Object(e.a)(Ud.lj.sfe,Ud.lj.sfe.vSc,
"getUserPresence"),Object(e.a)(Ud.lj.sfe,Ud.lj.sfe.Ojb,"getUserStatusInfo"),n.AFrameworkApplication.K.$("WordEditorPresenceDedupeMultipleCoauthorInstances"));Na.a.instance.ia("RealtimePresenceUI.WordEditorPeoplesWell",()=>nd.createInstance(Kb,Aa.a.Gp(Ud.W.Sa("Common.IPeopleInfoProvider")),Ud.W.Oa("WordEditor.ParagraphWordIdMapping"),Ud.W.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Ga,Ud.W.Sa("WordEditor.Presence.IWordPresenceCpFactory"),Ud.W.resolve("Common.App.People.IPeopleManager"))).as("Common.IPeoplesWell").ha();
Ud._instance=Na.a.instance.resolve("Common.IPeoplesWell");Ud._instance.fYn();k.ULS.sendTraceTag(23196877,325,50,"PeoplesWellControl is fully initialized")})}else k.ULS.sendTraceTag(23196873,325,15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")}}get name(){return"WordEditor.PeoplesWellControl"}wc(Ga){Ud.W=Ga}init(){n.AFrameworkApplication.K.Nn(this.$x)}dispose(){Ud._instance&&(Ud._instance.dispose(),Ud._instance=null)}static get lra(){return null!=Ud.OGg?Ud.OGg:
Ud.OGg=Na.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}}Ud._instance=null;Ud.W=null;Ud.lj=null;Object(l.a)(Ud,"WordEditorPeoplesWellControlPackage",null,[1,2]);var Qd=c(100),Gd=c(164);class of{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf=!1){this.r$a=null;this.QBe=!0;this.hPe=this.Kl=this.Due=null;this.sa=new va.a;this.MMa=Ga;this.o_=kb;this.Vbh=nc;this.EBc=Kb;this.XMg=Kc;of.Ib=ld;this.kgk=ue;this.z7=Le;this.rhk=cf;I.Task.WAA(kb,nc).continueWith(Object(e.a)(this,this.gAm,"initOnTaskReady"))}fAk(Ga){this.sa.addHandler("u",
Ga)}B7i(){this.sa.raiseEvent("u",null,this)}gAm(){this.o_.result&&this.Vbh.result&&(this.Kl=this.o_.result,this.hPe=this.Vbh.result,this.Kl.M_a(Object(e.a)(this,this.t5,"onPresenceUpdated")),this.Due=new wa.a(2,2,this.XMg,Object(e.a)(this,this.TUo,"updateAwayClientsTask"),88),of.Ib.Wb(this.Due))}t5(Ga,kb){(this.QBe||this.pRn(kb.asa))&&of.Ib.z1(this.Due,0)}pRn(Ga){for(let nc in Ga){var kb=this.EBc.gUd({key:nc,value:Ga[nc]});if(kb&&kb.clientId&&(kb=kb.clientId.toLowerCase(),(kb=this.r$a[kb]||this.r$a[kb.toUpperCase()])&&
2===kb.status))return!0}return!1}TUo(Ga){var kb=this.Kl.IPc();if(kb){var nc=new Date,Kb=!1;if(this.QBe){this.r$a=kb;this.QBe=!1;var ld=this.r$a;for(var Kc in ld){kb=Kc;var ue=ld[Kc];ue.$ec<nc&&(nc=ue.$ec);2===ue.status&&(Kb=!0,this.hPe.f7c(kb))}Kb&&this.B7i();of.Ib.z1(Ga,this.idi(nc))}else{ue=new S.a;Kc=!1;var Le=this.r$a;for(ld in Le){Le=ld;if(!(Le in this.r$a)||this.MMa.clientId===Le)continue;var cf=this.r$a[Le];const Mf=kb[Le];if(cf&&Mf){cf=cf.status;const Vg=Mf.status;2===cf&&1===Vg?(ue.add(Le),
k.ULS.sendTraceTag(38052609,392,50,Le+" returned from away")):1===cf&&2===Vg&&(Kc=Kb=!0,this.hPe.f7c(Le),k.ULS.sendTraceTag(38052610,392,50,Le+" went away"));1===Vg&&Mf.$ec<nc&&(nc=Mf.$ec)}}this.r$a=kb;of.Ib.z1(Ga,this.idi(nc));(0<ue.count||Kb)&&this.B7i();0<ue.count&&!this.rhk?(Ga=this.kSl(ue),this.WLo(Ga)):Ga=new S.a;(Kc||0<Ga.count)&&this.kgk(wb.a.eHd,2)}}}WLo(Ga){if(Ga.count)for(let kb of Ga)Ga=this.z7.Eva(String.format(CommonUIStrings.l_EditorsToastArriving,kb),!1),Ga.image=5,Ga.hpa="CoAuth_AuthorStatus_16x16x32",
this.z7.sA(Ga)}kSl(Ga){const kb=this.Kl.KFb(),nc=new S.a;for(let Kb in kb){const ld={key:Kb,value:kb[Kb]};if(Ga.contains(ld.key)){const Kc=this.EBc.gUd(ld);Kc&&(nc.add(Kc.userName),Ga.remove(ld.key))}}nc.count||k.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return nc}idi(Ga){const kb=new Date;return Math.max(Ga.getTime()+this.XMg-kb.getTime(),0)}}of.Ib=null;Object(l.a)(of,"AwayManager",null,[]);var Tf=c(782);class uh{constructor(Ga=0){this.updates=Ga}get Hzf(){return 0!==
this.updates}TFa(Ga){return!!(this.updates&Ga)}Y7a(Ga){this.updates|=Ga}toString(){if(this.TFa(0))return"none";const Ga=new S.a;this.TFa(1)&&Ga.add("user(s) joined");this.TFa(2)&&Ga.add("user(s) disconnected");this.TFa(4)&&Ga.add("user(s) updated");return Ga.toArray().join(", ")}}Object(l.a)(uh,"UserUpdateEvent",null,[]);var Gh=c(36);class Dh{constructor(Ga,kb,nc,Kb,ld=null){this.sa=new va.a;this.xK=this.lj=null;this.r8g=this.O8g=this.km=!1;this.Aq=new hc.a;Ga.continueWith(()=>{this.lj=Ga.result;
this.lj.M_a(Object(e.a)(this,this.zYi,"onRtcPresenceUpdate"));this.lj.Kua(Object(e.a)(this,this.yYi,"onRtcConnectionChange"));this.Nqg(null,null)});kb.continueWith(()=>{this.xK=kb.result;this.xK.afb(Object(e.a)(this,this.s2c,"onEditorsTableUpdated"))});ld&&ld.continueWith(()=>{ld.result.fAk(Object(e.a)(this,this.Nqg,"updateUserStatus"));this.Nqg(null,null)});this.dNa=nc;this.EBc=Kb}get users(){return this.Aq}T2b(Ga){this.sa.addHandler("UU",Ga)}k9f(Ga){this.sa.removeHandler("UU",Ga)}Nqg(){if(this.lj){var Ga=
!1,kb=this.lj.IPc();for(let Kb in kb){var nc=kb[Kb];const ld=Kb;this.users.nb(ld)&&(nc=this.HBj(nc),Ga=this.users.J(ld).ECb!==nc||Ga,this.users.J(ld).ECb=nc)}Ga&&(Ga=new uh(4),this.tge(Ga))}}HBj(Ga){return 1===Ga.status?0:1}q2a(){this.users.count||(this.O8g||(Gh.b(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),this.O8g=!0),this.GFn());const Ga=[];for(let kb of this.users)Array.add(Ga,kb.value);return Ga}GFn(){if(this.lj){var Ga=this.lj.KFb();this.$Pf(Ga)}if(this.xK){Ga=
this.xK.CPc();for(const kb of Ga)kb.Id&&(Ga=this.LOh(kb.Id),this.Mqg(new uh,Ga))}}pOf(Ga){({value:Ga}=this.users.Fc(Ga));return Ga}dispose(){this.km||(this.lj&&(this.lj.hPb(Object(e.a)(this,this.zYi,"onRtcPresenceUpdate")),this.lj.Ejc(Object(e.a)(this,this.yYi,"onRtcConnectionChange"))),this.xK&&this.xK.Pbj(Object(e.a)(this,this.s2c,"onEditorsTableUpdated")),this.km=!0)}yYi(Ga,kb){2===kb.newState&&(Ga=this.$Pf(this.lj.KFb()),Ga.Hzf&&this.tge(Ga))}s2c(Ga,kb){Ga=new uh;var nc=this.xK.CPc();k.ULS.sendTraceTag(561894485,
302,50,"editorstablemanager coauthors count is {0}, editorstableupdate old count of coauthors is {1}, editorstableupdate new count of coauthors is {2}",nc.length,kb.Nkn,kb.yRi);const Kb=new hc.a;for(var ld of nc){nc=ld.Id;const Kc=this.LOh(nc);this.Mqg(Ga,Kc);Kb.Z(nc,Kc)}if((kb=kb.oLf)&&0<kb.length)for(ld=0;ld<kb.length;ld++)k.ULS.sendTraceTag(562415168,302,50,"{0} users in coauth gallery. User leaving the editor table: {1}",this.users.count,kb.J(ld).Id),({value:nc}=this.users.Fc(kb.J(ld).Id)).returnValue?
nc?(this.users.remove(kb.J(ld).Id),Ga.Y7a(2),Kb.Z(kb.J(ld).Id,nc)):k.ULS.sendTraceTag(561287839,302,50,"Empty entry in PIP users: {0}",kb.J(ld).Id):k.ULS.sendTraceTag(570426140,302,15,"Disconnected user not found: {0}",kb.J(ld).Id);kb=this.lj.KFb();for(let Kc in kb)ld=this.EBc.gUd({key:Kc,value:kb[Kc]}),Kb.Z(ld.clientId,ld);for(let Kc of this.users)Kb.nb(Kc.value.clientId)||(k.ULS.sendTraceTag(561287840,302,15,"Coauth Gallery contains user not in Editors Table or RTC presence: {0}",Kc.key),this.users.remove(Kc.key),
Ga.Y7a(2));Ga.Hzf&&this.tge(Ga)}zYi(Ga,kb){Ga=this.$Pf(kb.asa);for(const nc of kb.ILd)this.users.nb(nc)&&(Ga.Y7a(2),this.users.J(nc).ECb=2);Ga.Hzf&&this.tge(Ga)}$Pf(Ga){const kb=new uh;if(!Ga)return kb;for(let Kb in Ga){var nc=this.EBc.gUd({key:Kb,value:Ga[Kb]});nc&&(nc=nc.clone(),this.Mqg(kb,nc))}return kb}Mqg(Ga,kb){if(kb){var nc=kb.clientId;var Kb=this.j8n(kb);({value:kb}=this.users.Fc(nc)).returnValue?kb.equals(Kb)||(Ga.Y7a(4),this.users.Z(nc,Kb)):(k.ULS.sendTraceTag(562415169,302,50,"{0} users in coauth gallery. User joining: {1}",
this.users.count,nc),Ga.Y7a(1),this.users.Z(nc,Kb))}}LOh(Ga){return this.users.nb(Ga)?this.users.J(Ga):fa.a.ibl(Ga)}j8n(Ga){if(!Ga||!Ga.clientId||!this.xK)return Ga;const kb=Ga.clone();kb.ECb=this.jSl(Ga);if(Ga=this.xK.F9b(kb.clientId))kb.isReadOnly=kb.isReadOnly||Ga.IsReadOnly?!0:!1,kb.userName=this.i8n(kb,Ga),kb.capabilities=this.Pdn(kb.capabilities,Ga.Capabilities),kb.email=kb.email||Ga.SIPAddress||Ga.EmailAddress,Ga.JoinCoauthTime&&(kb.gSa=Ga.JoinCoauthTime);kb.color=this.dNa.qac(new Tf.a(kb.email,
void 0,kb.userName,void 0,kb.isAnonymous,kb.clientId),3);return kb}jSl(Ga){if(!this.lj)return 2;if(Ga&&Ga.clientId){const kb=this.lj.IPc();if(Ga.clientId in kb)return this.HBj(kb[Ga.clientId])}return 2}z3k(Ga,kb){kb.Name&&Ga.userName&&kb.Name!==Ga.userName&&!this.r8g&&(this.r8g=!0,Gh.b(42316243,302,15,"User names in EditorsTable and RTC don't match"))}Pdn(Ga,kb){Ga=Ga||new Xa.a;kb&&(kb.SupportsRealtimeChannel&&Ga.Y7a(1),kb.SupportsRename&&Ga.Y7a(2),kb.SupportsChat&&Ga.Y7a(4));return Ga}i8n(Ga,kb){this.z3k(Ga,
kb);return kb.Name||Ga.userName||(Ga.isAnonymous||kb.IsAnonymous?CommonUIStrings.l_GuestUserName:null)}tge(Ga){k.ULS.sendTraceTag(42316245,302,100,"PeopleInfoProvider update detected: {0}",Ga.toString());this.sa.raiseEvent("UU")}}Object(l.a)(Dh,"PeopleInfoProvider",null,[1164,10]);var lg;(function(Ga){Ga[Ga.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Ga[Ga.peopleImageClassName=1]="peopleImageClassName";Ga[Ga.peopleImageClusterPath=4]="peopleImageClusterPath";Ga[Ga.multipleBrowserImageClusterPath=
5]="multipleBrowserImageClusterPath";Ga[Ga.imageDimension=6]="imageDimension";Ga[Ga.rtl=8]="rtl";Ga[Ga.pointerInputManager=9]="pointerInputManager";Ga[Ga.clickInputManager=10]="clickInputManager";Ga[Ga.vertical=11]="vertical";Ga[Ga.zIndex=12]="zIndex";Ga[Ga.contextMenuInputManager=13]="contextMenuInputManager";Ga[Ga.imageDomElement=14]="imageDomElement";Ga[Ga.useIdleTooltip=15]="useIdleTooltip";Ga[Ga.viewportBoundsCallback=16]="viewportBoundsCallback";Ga[Ga.flipHorizontalDirection=17]="flipHorizontalDirection";
Ga[Ga.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";Ga[Ga.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Ga[Ga.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(lg||(lg={}));Object(l.b)("PresenceTooltipSettingKeys",lg);class xh{constructor(){this.Du={}}get(Ga,kb=null){Ga=lg[Ga];return"number"===typeof kb?(kb=this.Du[Ga])?Number.parseInvariant(kb.toString()):0:this.Du[Ga]}add(Ga,kb){this.Du[lg[Ga]]=kb}eOa(Ga,kb){lg[Ga]in this.Du||(this.Du[lg[Ga]]=kb)}remove(Ga){delete this.Du[lg[Ga]]}}
Object(l.a)(xh,"PresenceTooltipSettings",null,[]);class eg extends va.a{constructor(Ga){super();this._element=null;this.element=Ga}get element(){return this._element}set element(Ga){this._element=Ga}get visible(){return"visible"===this.element.style.visibility}set visible(Ga){this.element.style.visibility=Ga?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(Ga){this.element.dir=Ga?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(Ga){this.element.style.zIndex=
String(Ga)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(Ga){return this.element.ownerDocument.createElement(Ga)}rka(){return!0}static ZNh(Ga){return"prControl"+(Ga?"Rtl":"")}}Object(l.a)(eg,"BasePresenceControl",va.a,[10,1173]);class cc extends Sys.EventArgs{constructor(Ga,kb){super();this.type=Ga;this.Ro=kb}}cc.OU="InteractivityChanged";Object(l.a)(cc,"InteractivityChangedEventArgs",Sys.EventArgs,
[]);class Ic{static tVl(Ga){return Ic.uVl(Ga)}static uVl(Ga){const kb=document.createElementNS(Ic.ntg,"svg");kb.setAttribute("viewBox",String.format(Ic.mil,Ic.BKj,Ic.AKj));kb.appendChild(Ic.Fgm(Ga));return kb}static Fgm(Ga){const kb=Ic.BKj/Ga,nc=2*kb,Kb=Ic.AKj/2;Ga=(Ga-12-8)*kb/2;const ld=document.createElementNS(Ic.ntg,"g");Sys.UI.DomElement.addCssClass(ld,Ic.lil);for(let Kc=1;3>=Kc;Kc++)ld.appendChild(Ic.WRl(Kc,nc,Ga+(6*Kc-2)*kb,Kb));return ld}static WRl(Ga,kb,nc,Kb){const ld=document.createElementNS(Ic.ntg,
"circle");Sys.UI.DomElement.addCssClass(ld,String.format("{0}-{1}",Ic.$Xk,Ga));ld.setAttribute("cx",String.format("{0}",nc));ld.setAttribute("cy",String.format("{0}",Kb));ld.setAttribute("r",String.format("{0}",kb));return ld}}Ic.ntg="http://www.w3.org/2000/svg";Ic.lil="prDancingDots";Ic.$Xk="prAnimateCircle";Ic.mil="0 0 {0} {1}";Ic.AKj=40;Ic.BKj=120;Object(l.a)(Ic,"ModernPresenceTooltipDancingDots",null,[]);var Yc=c(96),ad=c(90),yd=c(10),ne=c(30),Oe=c(144),nf=c(57);class wf extends eg{constructor(Ga,
kb){super(Ga);this.Elh=this.jbb=this.pwe=this._img=this.xE=this.Bs=this.ig=null;this.wNa=kb.get(8,!1);this.Pab=kb.get(6,0);this.Eok=kb.get(15,!1);this.Vf=kb;this.mVg=0;this.element=Ga;this.element.className=wf.jmf;this._span=document.createElement("span");this.element.appendChild(this._span);this.$1j=Ic.tVl(kb.get(6,0));this.fC(kb);this._state=5}eBb(Ga){this.addHandler(cc.OU,Ga)}dPb(Ga){this.removeHandler(cc.OU,Ga)}get user(){return this.Elh}get state(){return this._state}dispose(){this.element&&
(this.ig.uc(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.ig.uc(yd.a.wB,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),this.Bs.uc(yd.a.pointerDown,this.element,Object(e.a)(this,this.fD,"onPointerDown")),this.Bs.uc(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut")),this.Bs.uc(yd.a.pointerOver,this.element,Object(e.a)(this,this.JP,"onPointerOver")),this.xE.uc(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")));
super.dispose()}fC(Ga){this.ig=Ga.get(10);this.ig.ob(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.ig.ob(yd.a.wB,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior"));this.Bs=Ga.get(9);this.Bs.ob(yd.a.pointerOver,this.element,Object(e.a)(this,this.JP,"onPointerOver"));this.Bs.ob(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut"));this.Bs.ob(yd.a.pointerDown,this.element,Object(e.a)(this,this.fD,"onPointerDown"));this.xE=Ga.get(13);
this.xE.ob(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior"))}hide(Ga=null,kb=0,nc=0){this.Eok&&Ga?this.Qxo(Ga,kb,nc):(3===this.state&&this.xaj(),this.visible=!1,this._state=5)}Qxo(Ga,kb,nc=0){this.show(Ga,kb,15,4,void 0,nc)}msj(Ga,kb,nc=!1,Kb=!1,ld=!1,Kc=0){this.show(Ga,kb,20,nc?2:Kb?1:0,ld,Kc)}nxo(Ga,kb,nc,Kb=!1,ld=0){this.show(Ga,kb,nc+20,3,Kb,ld)}show(Ga,kb,nc,Kb=3,ld=!1,Kc=0){!Ga||Kb===this.state&&this.Ctm(kb,nc)||(this.Vrk(Kb,ld,Kc),this.uga(Ga,Kb,Kc),this._state=
Kb,4===Kc||0===Kc&&!this.wNa?this.element.style.left=kb+"px":this.element.style.right=kb+"px",this.element.style.top=nc+"px",this.visible=!0)}uga(Ga,kb,nc){this.Elh=Ga;nf.a.MD(this._span);Oe.a.KZk(this._span);this._span.id="fly_"+Ga.clientId;this._span.style.backgroundColor=Ga.color;4!==kb?(this._span.style.height=this.Pab+"px",this._span.style.lineHeight=this.Pab+"px",Oe.a.GQb(this._span,"border-radius",this.Pab+"px")):4===nc||0===nc&&!this.wNa?this._span.style.left="0px":this._span.style.right=
"0px";2!==kb&&(4===kb?nf.a.wv(this._span,""):1===kb?this._span.appendChild(this.$1j):(this._span.setAttribute("dir","auto"),nc=Ob.a.L1l(Ga.userName),(!Ga.isAnonymous||n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&nc||0!==kb?(Ga=Ga.userName,0===kb&&(Ga=nc,Oe.a.GQb(this._span,"text-align","center")),nf.a.wv(this._span,Ga)):(this._img||(this._img=this.U9k()),this._span.appendChild(this._img),Oe.a.GQb(this._span,"text-align","start"))))}onClick(Ga){if(0===
this.state)return this.raiseEvent(cc.OU,new cc(1,Ga)),!0;3===this.state&&k.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}TJ(Ga){3===this.state&&this.raiseEvent(cc.OU,new cc(3,Ga));return!1}JP(Ga){3!==Ga.kg&&this.raiseEvent(cc.OU,new cc(2,Ga));return!1}fD(Ga){if(3!==Ga.kg)return!0;this.raiseEvent(cc.OU,new cc(4,Ga));return!1}U9k(){const Ga=document.createElement("img");Ga.src=Yc.a.Sba("doughperson_white_glyph.svg");Ga.setAttribute("Unselectable","on");ne.a.kr(Ga,ne.a.uh,
ne.a.xz);return ad.createClusteredImageFromClusterWithImageClass(this.Pab,this.Pab,null,null,wf.NHl,"",!1,"",this.element.ownerDocument,Ga)}Vrk(Ga,kb=!1,nc=0){if(!this.nWc(this.state)||!this.nWc(Ga))switch(Sys.UI.DomElement.removeCssClass(this.element,this.pwe),this.state){case 4:3===Ga?this.B_a(wf.kmf,wf.Y1h):this.nWc(Ga)&&this.B_a(wf.imf,wf.Y1h);break;case 3:4===Ga?this.B_a(wf.nmf,wf.X1h):this.nWc(Ga)&&(kb&&this.xaj(),this.B_a(wf.imf,wf.X1h,kb?wf.MHl:""));break;case 0:case 1:case 2:4===Ga?this.B_a(wf.nmf,
wf.lmf):3===Ga&&(kb&&this.ctk(),this.B_a(wf.kmf,wf.lmf,kb?wf.Z1h:"",3===nc?wf.QHl:wf.OHl));break;default:4===Ga?this.B_a(wf.nmf):3===Ga?this.B_a(wf.kmf):this.nWc(Ga)&&this.B_a(wf.imf)}}B_a(...Ga){this.pwe=Ga.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.pwe)}ctk(){this.mVg=window.setTimeout(()=>{this.element&&(this.jbb=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.jbb),this.element.style.zIndex="2",this.jbb.style.zIndex="1")},300)}xaj(){window.clearTimeout(this.mVg);
this.jbb&&(Sys.UI.DomElement.removeCssClass(this.jbb,wf.lmf+" "+wf.Z1h),Sys.UI.DomElement.addCssClass(this.jbb,wf.LHl),I.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.jbb.parentNode&&this.element.parentNode.removeChild(this.jbb)}),Oe.a.Cjc(this.element,"z-index"))}nWc(Ga){return 0===Ga||1===Ga||2===Ga}Ctm(Ga,kb){const nc=Oe.a.$Y(this.element.style.top);return Oe.a.$Y(this.element.style.left)===Ga&&nc===kb}u$f(Ga){3===Ga&&Oe.a.Lba(this.element,"left")?(Ga=Oe.a.$Y(this.element.style.left),
Oe.a.Cjc(this.element,"left"),this.element.style.right=-1*Ga+"px"):4===Ga&&Oe.a.Lba(this.element,"right")&&(Ga=Oe.a.$Y(this.element.style.right),Oe.a.Cjc(this.element,"right"),this.element.style.left=-1*Ga+"px")}}wf.jmf="prModernFlyout UIFont";wf.nmf="flyoutIdle";wf.kmf="flyoutExpanded";wf.imf="flyoutCollapsed";wf.Y1h="flyoutFromIdle";wf.X1h="flyoutFromExpanded";wf.lmf="flyoutFromCollapsed";wf.Z1h="flyoutStacked";wf.MHl="flyoutFromStacked";wf.LHl="flyoutFadeOut";wf.NHl="cui-img-cont-float cui-img-20by20";
wf.OHl="flyoutLtrDir";wf.QHl="flyoutRtlDir";Object(l.a)(wf,"ModernPresenceTooltipFlyoutControl",eg,[]);class Ye{constructor(Ga,kb,nc=2,Kb=4){this.offsetTop=Ga;this.offsetLeft=kb;this.yKj=nc;this.vpi=Kb}}Object(l.a)(Ye,"FlyoutsPositioningInfo",null,[]);var Rg=c(40);class Db{constructor(Ga=!1,kb=!1){this.nm=Ga;this.VBe=kb}Z2l(Ga,kb,nc,Kb,ld){const Kc=ld.y,ue=ld.height;var Le=this.pQl(Kb);const cf=Le+kb,Mf=Ga*nc+2*(Ga-1);nc=null;1===Ga||this.iTk(Le,Mf,Kc,ue)?Ga=new Ye(0,0,2):(Ga=this.Ulf(cf,Mf,Kc,ue),
Ga.offsetTop-=Le);this.VBe?nc=new Ye(0,0,void 0,this.nm?4:3):(Kb=this.oQl(Kb,ld),Le=Math.max(0,ld.x),ld=ld.width,kb=Kb+kb,this.jTk(Kb,Le,ld)?nc=new Ye(0,0,void 0,this.nm?3:4):this.kTk(kb,Le)&&(nc=new Ye(0,0,void 0,this.nm?4:3)),nc||(nc=this.wGl(Kb,kb,Le,ld)));return new Ye(Ga.offsetTop,nc.offsetLeft,Ga.yKj,nc.vpi)}pQl(Ga){return Rg.a.rFa(Ga)}oQl(Ga,kb){return this.nm?kb.width-Rg.a.n6h(Ga):Rg.a.Xof(Ga)}iTk(Ga,kb,nc,Kb){return Ga+kb<=nc+Kb}Ulf(Ga,kb,nc,Kb){let ld=1,Kc=Math.max(nc,Ga-kb);kb>Ga-nc&&(ld=
2,Kc=kb<Kb?Kb-kb:nc);return new Ye(Kc,0,ld)}jTk(Ga,kb,nc){return Ga+150<=kb+nc}kTk(Ga,kb){return 150<=Ga-kb}wGl(Ga,kb,nc,Kb){Kb-kb>=Ga-nc?Ga=4:(kb=Ga,Ga=3);return new Ye(0,kb,void 0,Ga)}}Object(l.a)(Db,"ModernPresenceTooltipPositioner",null,[]);class Zb{constructor(Ga,kb,nc,Kb,ld,Kc,ue){this.Aaa=Ga;this._parent=kb;this.KPg=nc;this.MZj=Kb;this.P6j=ld;this.b1b=Kc;this.wNa=ue;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Ga,
kb){if(3!==Ga)if(5!==Ga&&this.Aaa&&this.Aaa.length){if(4===Ga){var nc=this.P6j;var Kb=(this.b1b-nc)/2;this.element.style.height=this.b1b+"px";this.element.style.width=this.b1b+"px";Ga=Oe.a.$Y(this.Aaa[0].element.style.top);kb=Oe.a.$Y(this.wNa?this.Aaa[0].element.style.right:this.Aaa[0].element.style.left)}else nc=this.KPg,Kb=(this.b1b-nc)/2,this.element.style.height=this.b1b+"px",this.element.style.width=this.nSl()+2*Kb+"px",Ga=Oe.a.$Y(this.Aaa[this.Aaa.length-1].element.style.top),kb=this.nSk(this.Aaa[this.Aaa.length-
1].element,nc,kb);Oe.a.GQb(this.element,"border-radius",this.b1b+"px");this.element.style.top=Ga-Kb-nc+"px";this.wNa?this.element.style.right=kb-Kb+"px":this.element.style.left=kb-Kb+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}nSk(Ga,kb,nc){return this.wNa&&!nc?Oe.a.$Y(Ga.style.right):this.wNa||nc?this.wNa&&nc?-Oe.a.$Y(Ga.style.left)-kb:-Oe.a.$Y(Ga.style.right)-kb:Oe.a.$Y(Ga.style.left)}nSl(){return this.Aaa&&
this.Aaa.length?this.KPg+Math.min(this.Aaa.length-1,2)*this.MZj:0}}Object(l.a)(Zb,"ModernPresenceTooltipTarget",null,[]);var xc=c(128),Jd=c(194);class ie extends eg{constructor(Ga,kb,nc){super(Ga);this.C_b=this.hMa=this.o_g=this.pvb=!1;this.Aq=[];this.Snd={};this.Vf=nc;this.nm=nc.get(8,!1);this.dZg=nc.get(15,!1);this.S0j=nc.get(12,0);this.Nfb=nc.get(6,0);this.xma=kb;this.amh=nc.get(16);this.VBe=nc.get(17,!1);this.T6j=nc.get(19,!1);this.agk=nc.get(20,!1);this.Lqd=0;this.Vfk=new Db(this.nm,this.VBe);
this.Rqc=this.T8h();this.myb=!1;this.vUb=[];this.Swc=[];this.element.id=ie.Kib();this.element.className=eg.ZNh(this.nm);this.n1a&&(this.zIndex=this.n1a);this.rtl=this.nm;this.ydg(kb);this.e7=this.createElement("div");this.e7.className="prFlyoutContainer";this.element.appendChild(this.e7);this.Aaa=[];this.Jbb=new Zb(this.z4,this.element,this.Nfb,4,6,32,this.nm);this.Bs=nc.get(9);this.Bs.ob(yd.a.pointerDown,this.Jbb.element,Object(e.a)(this,this.$gc,"onHitTarget"));this.Bs.ob(yd.a.pointerOver,this.Jbb.element,
Object(e.a)(this,this.$gc,"onHitTarget"));this.Bs.ob(yd.a.pointerOut,this.Jbb.element,Object(e.a)(this,this.$gc,"onHitTarget"))}get Mae(){return Jd.a.clone(this.Aq)}get z4(){return this.Aaa}get n1a(){return this.S0j}get g2a(){return this.z4?this.z4.length:0}get qSb(){return 0<this.g2a?this.z4[0].state:5}get pFf(){return 3===this.qSb&&!this.pvb}eBb(Ga){this.addHandler(cc.OU,Ga)}dPb(Ga){this.removeHandler(cc.OU,Ga)}dispose(){if(this.pFf)this.myb=!0;else{if(this.z4)for(const Ga of this.z4)Ga.dPb(Object(e.a)(this,
this.aTa,"onInteractivityChanged")),Qd.a.jC(Ga);this.Aaa=null;this.Bs.uc(yd.a.pointerDown,this.Jbb.element,Object(e.a)(this,this.$gc,"onHitTarget"));this.Bs.uc(yd.a.pointerOver,this.Jbb.element,Object(e.a)(this,this.$gc,"onHitTarget"));this.Bs.uc(yd.a.pointerOut,this.Jbb.element,Object(e.a)(this,this.$gc,"onHitTarget"));super.dispose()}}kmc(){this.c5b();this.visible=!0}jad(){this.visible=!0;this.vZh();this.pvb=!0}qhg(){this.jad()}hide(){this.dbj();this.F3a();this.Jbb.update(this.qSb,this.C_b)}uga(Ga){const kb=
this.qSb,nc=this.pvb;Ga.clientId||(Ga.clientId=(ie.lxc++).toString());if(Ga.clientId in this.Snd){var Kb=this.hFb(Ga.clientId);if(0<=Kb){Kb=this.Aq[Kb];if(Kb.color===Ga.color&&Kb.userName===Ga.userName)return;this.r7a(Ga.clientId)}}this.hide();Kb=new wf(this.createElement("div"),this.Vf);Kb.eBb(Object(e.a)(this,this.aTa,"onInteractivityChanged"));this.e7.insertBefore(Kb.element,this.e7.firstChild);this.Snd[Ga.clientId]=Kb;Array.add(this.Aq,Ga);Array.add(this.z4,Kb);this.JIj(kb,nc);this.visible=!0}r7a(Ga){if(this.pFf)Array.add(this.Swc,
Ga);else{var kb=this.qSb,nc=this.pvb;this.hide();this.e7c(Ga);this.JIj(kb,nc)}}JQi(Ga){const kb=this.hFb(Ga);if(!(0>=kb)){var nc=this.Aq[kb];Ga=this.Snd[Ga];Array.removeAt(this.Aq,kb);Array.insert(this.Aq,0,nc);Array.removeAt(this.z4,kb);Array.insert(this.z4,0,Ga);this.e7.removeChild(Ga.element);this.e7.appendChild(Ga.element);this.c5b()}}JIj(Ga,kb){0>=this.Aq.length?this.hide():3===Ga&&kb?this.jad():this.kmc()}Ljf(Ga){if(this.pFf&&this.T6j)return!1;Ga=ie.tuf(Ga);if(this.e7!==Ga&&nf.a.wRa(this.e7,
Ga))return!0;for(const kb of this.z4)if(nf.a.wRa(kb.element,Ga))return!0;return!1}position(Ga,kb){this.element.style.top=kb+"px";this.element.style.left=Ga+"px"}c5b(Ga=!1){if(!Ga||this.hMa){this.o_g&&this.Xnj(!0);var kb=Math.min(3,this.g2a)-1;Ga=0;var nc=1,Kb=0;this.C_b&&(Ga=this.Rqc,nc=-1,Kb=-this.Nfb);for(let ld=this.g2a-1;ld>kb;ld--)this.z4[ld].msj(this.Aq[ld],-4*kb*nc+Kb,!0,!1,!0,Ga);for(;0<=kb;kb--)this.z4[kb].msj(this.Aq[kb],-4*kb*nc+Kb,0<kb,Array.contains(this.vUb,this.Aq[kb].clientId),kb!==
this.Lqd,Ga);this.Lqd=0;this.Jbb.update(0,this.C_b);this.zIndex=this.n1a;this.pvb=!1;this.dbj(0);this.myb&&this.dispose()}}vZh(){this.o_g&&this.Xnj(!1);this.zIndex=this.n1a+1;let Ga,kb,nc;({offsetX:kb,offsetY:Ga,upi:nc}=this.blo());for(let Kb=0;Kb<this.g2a;Kb++)this.z4[Kb].nxo(this.Aq[Kb],kb,Ga+(this.Nfb+2)*Kb,Kb!==this.Lqd,nc)}F3a(){let Ga=0,kb=0;this.C_b&&(Ga=this.Rqc,kb=-6);for(let nc=0;nc<this.g2a;nc++)this.z4[nc].hide(this.Aq[nc],kb,Ga);this.zIndex=this.n1a;this.visible=this.pvb=!1;this.myb&&
this.dispose()}o9e(Ga=0){Ga?(this.hMa=!0,I.Task.delay(Ga).continueWith(()=>{this.dZg?this.qvm():this.c5b(!0);this.hMa=!1})):this.dZg?this.hide():this.c5b()}qvm(){this.hMa&&this.hide()}qLk(){if(n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.Ppa&&xc.c()){const Ga=appChrome.selectors.getShyState();return Ga.isActive&&0!==Ga.state}return!1}aTa(Ga,kb){Ga=this.qSb;this.qLk()||2!==kb.type&&(4!==kb.type||3===Ga)?4===kb.type&&3===Ga?(this.hMa&&(this.hMa=!1),this.o9e()):3!==kb.type||3!==Ga||this.pvb||
(1<this.g2a?(this.hMa=!0,I.Task.delay(250).continueWith(()=>{this.c5b(!0);this.hMa=!1})):this.o9e()):(this.hMa&&(this.hMa=!1),3!==Ga&&(this.vZh(),3===kb.Ro.kg&&this.o9e(2E3)));this.raiseEvent(cc.OU,kb)}$gc(Ga){3===Ga.kg?this.aTa(this,new cc(4,Ga)):Ga.eventName===yd.a.pointerOver?this.aTa(this,new cc(2,Ga)):Ga.eventName===yd.a.pointerOut&&this.aTa(this,new cc(3,Ga));return!1}ydg(Ga){this.element.style.width=Ga+"px";this.element.style.height=this.Nfb+"px"}e7c(Ga){this.VZn(Ga);Ga=this.hFb(Ga);if(!(0>
Ga)){var kb=this.Aq[Ga];Array.removeAt(this.Aq,Ga);delete this.Snd[kb.clientId];kb=this.z4[Ga];this.e7.removeChild(kb.element);this.Vf.get(18,!1)&&kb.dPb(Object(e.a)(this,this.aTa,"onInteractivityChanged"));Array.removeAt(this.z4,Ga);kb.dispose()}}dbj(Ga=5){if(this.Swc.length){this.visible&&this.F3a();for(let kb=0;kb<this.Swc.length;kb++)this.e7c(this.Swc[kb]);Array.clear(this.Swc);0>=this.Aq.length||5===Ga?this.hide():0===Ga&&this.kmc()}}hFb(Ga){for(let kb=0;kb<this.Aq.length;kb++)if(this.Aq[kb].clientId===
Ga)return kb;return-1}VZn(Ga){-1===this.hFb(Ga)?k.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.vUb,Ga)&&(Array.remove(this.vUb,Ga),this.Aq[0].clientId===Ga&&0<this.vUb.length&&this.JQi(this.vUb[this.vUb.length-1]),this.Aq[0].clientId===Ga&&1===this.qSb&&this.c5b())}Xnj(Ga){Ga?Sys.UI.DomElement.addCssClass(this.e7,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.e7,"prBackgroundSelection")}blo(){let Ga,kb;kb=Ga=0;var nc=
this.Rqc;if(this.amh){const Kb=this.amh(this);if(!Kb)return{offsetX:Ga,offsetY:kb,upi:nc};const ld=4===this.qSb;nc=this.Vfk.Z2l(this.g2a,ld?6:this.Nfb,this.Nfb,this.element,Kb);kb=nc.offsetTop;this.Lqd=this.A1l(nc.yKj,nc.offsetTop);nc=nc.vpi;nc!==this.Rqc&&(this.u$f(nc),this.element.dir=3===nc?"rtl":"ltr",this.Rqc=nc);nc!==this.T8h()?(Ga=this.agk?-2:ld?-6:-this.Nfb,this.C_b=!0):this.C_b=!1}return{offsetX:Ga,offsetY:kb,upi:nc}}A1l(Ga,kb){if(1===Ga)return this.g2a-1;Ga=Math.abs(kb);return 0<Ga?Ga/(this.Nfb+
2):0}u$f(Ga){for(let kb=0;kb<this.g2a;kb++)this.z4[kb].u$f(Ga)}T8h(){return this.nm?3:4}static Kib(){return String.format("{0}-{1}","presencetooltip",ie.lxc++)}static tuf(Ga){return Ga.Hb.rawEvent.relatedTarget}}ie.lxc=0;Object(l.a)(ie,"ModernPresenceTooltipControl",eg,[1192,10]);var De=c(232),qf=c(276);class tg{constructor(Ga){this.Vf=Ga;this.Vf.eOa(10,De.a.instance);this.Vf.eOa(9,Gd.a.instance);this.Vf.eOa(6,20);this.Vf.eOa(13,qf.a.instance);this.Vf.eOa(17,!1)}gbf(Ga,kb=!1){this.Vf.eOa(15,kb);return new ie(Ga,
20,this.Vf)}}Object(l.a)(tg,"ModernPresenceTooltipFactory",null,[1174]);class Ah extends eg{constructor(Ga,kb){super(Ga);this.Aq=null;this.wNa=kb.get(8,!1);this.Pab=kb.get(6,0);this.element=Ga;this.element.className=Ah.jmf;this._ul=this.createElement("ul");this.element.appendChild(this._ul);this.ig=kb.get(10);this.ig.ob(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Bs=kb.get(9);this.Bs.ob(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut"));this.Bs.ob(yd.a.pointerDown,
this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior"));this.xE=kb.get(13);this.xE.ob(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior"))}eBb(Ga){this.addHandler(cc.OU,Ga)}dPb(Ga){this.removeHandler(cc.OU,Ga)}get users(){return this.Aq}dispose(){this.element&&(this.ig.uc(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.Bs.uc(yd.a.pointerDown,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),
this.Bs.uc(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut")),this.xE.uc(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(Ga,kb,nc){this.hide();!Ga||0>=Ga.length||(this.wNa?this.element.style.right=kb+"px":this.element.style.left=kb+"px",this.element.style.top=nc+"px",this.Hwk(Ga),this.visible=!0)}Hwk(Ga){this.Aq=Ga;nf.a.MD(this._ul);for(let kb=Ga.length-1;0<=kb;kb--)this.uga(Ga[kb])}uga(Ga){const kb=
document.createElement("li");kb.style.backgroundColor=Ga.color;kb.style.height=this.Pab+"px";kb.id="fly_"+Ga.clientId;kb.style.lineHeight=this.Pab+"px";nf.a.wv(kb,Ga.userName);kb.setAttribute("dir","auto");this._ul.appendChild(kb)}onClick(){this.hide();return!1}TJ(Ga){this.raiseEvent(cc.OU,new cc(3,Ga));return!1}}Ah.jmf="prFlyout UIFont";Object(l.a)(Ah,"PresenceTooltipFlyoutControl",eg,[]);class ji extends eg{constructor(Ga,kb,nc){super(Ga);this._img=null;this.Aq=[];this.element.className="prGlyph";
this.Vf=kb;this.j_b=this.Vf.get(9);this.Pq=this.Vf.get(10);this.xE=this.Vf.get(13);this.Nvm();this.uga(nc);this.sGe=!1}get h6a(){return this.Aq.length}get users(){return this.Aq}eBb(Ga){this.addHandler(cc.OU,Ga)}dPb(Ga){this.removeHandler(cc.OU,Ga)}dispose(){this.HSo();super.dispose()}uga(Ga){Array.add(this.Aq,Ga);2===this.h6a?this.Kka(!0):1===this.h6a?this.Kka(!1):this.Kka(this.sGe)}r7a(Ga){this.SDl(Ga)&&(1<this.h6a&&this.Kka(!0),1===this.h6a?this.Kka(!1):1>this.h6a&&this.hide())}show(){this.Kka(2<=
this.h6a);this.visible=!0}hide(){this.visible=!1}k1l(Ga){return Ga?this.r7h(0,5):this.r7h(1,4)}SDl(Ga){for(let kb=0;kb<this.h6a;kb++)if(this.Aq[kb].clientId===Ga)return Ga=this.Aq[kb],Array.removeAt(this.Aq,kb),Ga;return null}Kka(Ga){this.sGe!==Ga&&(this._img&&this.element.removeChild(this._img),this._img=this.k1l(Ga),this.element.appendChild(this._img),this.sGe=Ga);this._img.childNodes[0].style.backgroundColor=this.Aq[this.Aq.length-1].color}r7h(Ga,kb){const nc=this.Vf.get(6,0),Kb=this.Vf.get(14);
return ad.createClusteredImageFromClusterWithImageClass(nc,nc,this.Vf.get(Ga),this.Vf.get(kb),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,Kb?Kb.cloneNode(!0):null)}JP(Ga){3!==Ga.kg&&this.raiseEvent(cc.OU,new cc(2,Ga));return!1}onClick(Ga){this.raiseEvent(cc.OU,new cc(1,Ga));return!0}TJ(Ga){3!==Ga.kg&&this.raiseEvent(cc.OU,new cc(3,Ga));return!1}HSo(){this.element&&(this.j_b.uc(yd.a.pointerDown,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),
this.j_b.uc(yd.a.pointerOver,this.element,Object(e.a)(this,this.JP,"onPointerOver")),this.j_b.uc(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut")),this.Pq.uc(yd.a.wB,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),this.Pq.uc(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.xE.uc(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")))}Nvm(){this.element&&(this.j_b.ob(yd.a.pointerDown,this.element,
Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),this.j_b.ob(yd.a.pointerOver,this.element,Object(e.a)(this,this.JP,"onPointerOver")),this.j_b.ob(yd.a.pointerOut,this.element,Object(e.a)(this,this.TJ,"onPointerOut")),this.Pq.ob(yd.a.wB,this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")),this.Pq.ob(yd.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.xE.ob(this.element,Object(e.a)(this,this.rka,"stopPropagationAndPreventDefaultBehavior")))}}
Object(l.a)(ji,"PresenceTooltipGlyph",eg,[]);class Bh extends eg{constructor(Ga,kb,nc){super(Ga);this.Aq=[];this.QK=[];this.OMa=0;this.FDc=this.xXb=!1;this.pLg=null;this.Tnd={};this.Vf=nc;this.nm=nc.get(8,!1);this.Vla=nc.get(11,!1);Ga=nc.get(12,0);this.imageDimension=nc.get(6,0);this.xma=kb;this.element.id=Bh.Kib();this.element.className=eg.ZNh(this.nm);Ga&&(this.zIndex=Ga);this.rtl=this.nm;this.ydg(kb);this.FBa=this.createElement("div");this.FBa.className=this.Vla?"prContainerV":"prContainerHr";
this.element.appendChild(this.FBa);this.wWg=Array(this.OMa);for(kb=0;kb<this.OMa;kb++)this.pca[kb]=new Ah(this.createElement("div"),this.Vf),this.pca[kb].eBb(Object(e.a)(this,this.aTa,"onInteractivityChanged")),this.element.appendChild(this.pca[kb].element)}get Mae(){return Jd.a.clone(this.Aq)}get pca(){return this.wWg}get Xnh(){return this.pLg}get dke(){return this.imageDimension+2}get width(){return this.Vla?this.dke:this.xma}get height(){return this.Vla?this.xma:this.dke}eBb(Ga){this.addHandler(cc.OU,
Ga)}dPb(Ga){this.removeHandler(cc.OU,Ga)}dispose(){if(this.pca)for(const Ga of this.pca)Ga.dPb(Object(e.a)(this,this.aTa,"onInteractivityChanged")),Qd.a.jC(Ga);Qd.a.gbg(this.QK);this.QK=this.wWg=null;super.dispose()}kmc(){this.F3a();this.Dhg();this.visible=!0;this.xXb=!1}jad(){!this.QK||1>this.QK.length||(this.F3a(),this.visible=!0,this.Dhg(),this.Dae(this.QK[this.QK.length-1]),this.xXb=!0)}qhg(){if(this.QK&&!(1>this.QK.length)){this.visible=!0;this.Dhg();var Ga=0;for(const kb of this.QK)this.Dae(kb,
Ga++);this.xXb=!1;this.FDc=!0}}hide(){this.visible=!1;this.F3a();for(let Ga=0;Ga<this.QK.length;Ga++)this.QK[Ga].hide();this.xXb=!1}UDh(){if(!this.FDc)return!1;let Ga=0;for(const kb of this.pca)kb.visible&&Ga++;return this.FDc=0<Ga&&(this.Aq.length<=this.OMa?Ga===this.Aq.length:Ga===this.OMa)}uga(Ga){if(!(0>=this.OMa)){Ga.clientId||(Ga.clientId=(Bh.lxc++).toString());if(Ga.clientId in this.Tnd){var kb=this.hFb(Ga.clientId);if(0<=kb){kb=this.Aq[kb];if(kb.color===Ga.color&&kb.userName===Ga.userName)return;
this.r7a(Ga.clientId)}}kb=this.UDh();var nc=0;if(this.Aq.length<this.OMa){var Kb=new ji(this.createElement("div"),this.Vf,Ga);Kb.eBb(Object(e.a)(this,this.aTa,"onInteractivityChanged"));this.nm&&!this.Vla&&0<this.Aq.length?this.FBa.insertBefore(Kb.element,this.FBa.firstChild):(this.FBa.appendChild(Kb.element),nc=this.QK.length);Array.add(this.QK,Kb)}else this.nm&&!this.Vla?Kb=this.QK[0]:(nc=this.QK.length-1,Kb=this.QK[nc]),Kb.uga(Ga);Kb.show();this.Tnd[Ga.clientId]=Kb;Array.add(this.Aq,Ga);this.tGj(Kb,
nc);kb&&this.qhg()}}r7a(Ga){const kb=this.UDh();kb&&this.F3a();this.e7c(Ga);this.Aq.length>=this.OMa&&this.QK.length<this.OMa&&this.tRn();0>=this.Aq.length?this.hide():kb&&this.qhg()}JQi(){}e7c(Ga){var kb=this.hFb(Ga);0>kb||(Ga=this.Aq[kb],Array.removeAt(this.Aq,kb),kb=this.Tnd[Ga.clientId],delete this.Tnd[Ga.clientId],kb.r7a(Ga.clientId),this.tGj(kb),0>=kb.h6a&&(this.FBa.removeChild(kb.element),Array.remove(this.QK,kb),kb.dispose()))}tRn(){var Ga=this.A8l();!Ga||1>=Ga.users.length||(Ga=Array.clone(this.Aq),
Ga.forEach(kb=>{this.e7c(kb.clientId)}),Ga.forEach(kb=>{this.uga(kb)}))}hFb(Ga){for(let kb=0;kb<this.Aq.length;kb++)if(this.Aq[kb].clientId===Ga)return kb;return-1}A8l(){return this.nm&&!this.Vla?this.QK[0]:this.QK[this.QK.length-1]}position(Ga,kb){this.element.style.top=kb+"px";this.element.style.left=Ga+"px"}Dhg(){for(let Ga=0;Ga<this.QK.length;Ga++)this.QK[Ga].show()}F3a(){for(let Ga=0;Ga<this.OMa;Ga++)this.pca[Ga].hide();this.FDc=!1}Dae(Ga,kb=0){if(Ga)if(this.pLg=Ga,this.Vla){const nc=this.imageDimension;
if(1<Ga.users.length)this.pca[kb].show(Ga.users,nc,this.height-this.imageDimension);else{const Kb=this.FBa.children.length;for(let ld=0;ld<this.FBa.children.length;ld++)Ga.element===this.FBa.children[ld]&&this.pca[kb].show(Ga.users,nc,this.height-(Kb-ld)*this.dke+2)}}else this.pca[kb].show(Ga.users,this.width,0)}aTa(Ga,kb){var nc=Object(y.a)(ji,Ga);nc=nc?this.q0h(nc):-1;if(2===kb.type||1===kb.type&&-1!==nc&&!this.pca[nc].visible)this.Dae(Ga);else if(1===kb.type)this.F3a(),this.xXb=!1;else if(3===
kb.type){if(this.Ljf(kb.Ro))return;this.xXb||this.F3a()}this.raiseEvent(cc.OU,kb)}Ljf(Ga){Ga=Bh.tuf(Ga);let kb=!1;for(const nc of this.pca)if(nf.a.wRa(nc.element,Ga)){kb=!0;break}return this.FBa!==Ga&&nf.a.wRa(this.FBa,Ga)||kb}tGj(Ga,kb=0){const nc=this.ZHm(Ga);nc&&0>=Ga.h6a?this.pca[kb].hide():nc?this.Dae(Ga):this.pca[kb].hide()}q0h(Ga){let kb=0;for(const nc of this.QK){if(Ga===nc)return kb;kb++}return-1}ZHm(Ga){const kb=this.q0h(Ga);return!!this.Xnh&&Ga===this.Xnh&&-1!==kb&&this.pca[kb].visible}ydg(Ga){this.OMa=
Ga===this.imageDimension?1:Math.floor(Ga/this.dke);this.Vla?(this.element.style.height=Ga+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=Ga+"px",this.element.style.height=this.imageDimension+"px")}static Kib(){return String.format("{0}-{1}","presencetooltip",Bh.lxc++)}static tuf(Ga){Ga=Ga.Hb.rawEvent;return Ga.relatedTarget||Ga.toElement}}Bh.lxc=0;Object(l.a)(Bh,"PresenceTooltipControl",eg,[1192,10]);class Tj{constructor(Ga){this.Vf=Ga;this.Vf.eOa(10,De.a.instance);
this.Vf.eOa(9,Gd.a.instance);this.Vf.eOa(6,16);this.Vf.eOa(13,qf.a.instance)}gbf(Ga){return new Bh(Ga,16,this.Vf)}}Object(l.a)(Tj,"PresenceTooltipFactory",null,[1174]);var sf=c(258),vf=c(115),Sf=c(56),ah=c(6),mg=c(106),Bg=c(5),Cg=c(18),ki=c(78),Rh=c(519),ml=c(310),el=c(111);class Kl extends Sys.EventArgs{constructor(Ga,kb){super();this.paragraphId=Ga;this.l1m=kb}}Object(l.a)(Kl,"PresenceControlRenderedEventArgs",Sys.EventArgs,[]);class ig extends eg{constructor(Ga,kb,nc,Kb,ld,Kc=null,ue=null){super(null);
this.Mnd=this.jn=null;this.ZZc=!1;this.Sra=0;this.Dp=Ga;this.IEc=kb;this.Bs=nc;this.wj=Kb;this.VKa=ld;ig.Lvb=0;this.nth=new hc.a;this.efj=new hc.a;this.VW=Kc;this.Ca=ue;this.O3j=this.Ca.nc("PresenceIpRenderedFloodgateTimeLapseSec",30);this.Onk=this.Ca.nc("PresenceIpRenderedFloodgateTriggerThreshold",3);this.Hsa=0}get Y5a(){return n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")}sxk(Ga){this.addHandler("CR",Ga)}Nbj(Ga){this.removeHandler("CR",Ga)}Wce(){this.raiseEvent("CR",new Kl(this.Dp.ip.paragraphId,
this.ZZc))}UQf(){if(Object(el.a)(ie,this.jn)){const Ga=Object(y.a)(ie,this.jn);ig.Lvb=0<ig.Lvb?ig.Lvb+1:Ga.n1a+1;Ga.zIndex=ig.Lvb;this.element.style.zIndex=String(ig.Lvb)}}n7n(){if(Object(el.a)(ie,this.jn)){const Ga=Object(y.a)(ie,this.jn);ig.Lvb=Ga.n1a;Ga.zIndex=Ga.n1a;this.element.style.zIndex=String(Ga.n1a)}}BLi(){this.VW&&!this.ZOo()&&this.VW.continueWith(()=>{this.VW.result.logActivity("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",this.O3j)&&this.Hsa++})}ZOo(){return this.Hsa>=this.Onk}static VKi(){ig.iWg||
(ig.iWg=!0,k.ULS.sendTraceTag(4006594,302,50,"First presence ip rendered on the page"))}static Kib(Ga){return ig.cxm+Ga.jai()}}ig.d4i="data-presence-control";ig.U_i="OverlayControlElementOwner";ig.cxm="ipId_";ig.e4i="WacPresence";ig.vzn="PresenceIpPaddingDiv";ig.iWg=!1;ig.Lvb=0;Object(l.a)(ig,"APresenceControl",eg,[1453,10]);class Mi{constructor(){this.rotation=this.height=this.width=this.top=this.left=0;this.m8a=!1}}Object(l.a)(Mi,"PresenceImageControlStyle",null,[1452]);class fh extends ig{constructor(Ga,
kb,nc,Kb,ld,Kc=null,ue=null){super(Ga,kb,nc,Kb,ld,Kc,ue);this.TJ=()=>{this.PPi();return!1};this.i9d=Le=>{this.jn&&3===Le.kg&&(2!==this.Sra?(this.UQf(),this.rRb()):this.PPi());return!1}}r7a(Ga){this.jn&&this.jn.r7a(Ga)}mpe(){return this.jn?this.jn.Mae.length:0}updatePosition(Ga){if(this.element&&this.element.parentNode){var kb=this.Hai(Ga);if(kb){var nc=Sys.UI.DomElement.getBounds(this.element.parentNode),Kb,ld;({left:nc,top:Kb,height:ld,width:kb}=this.gam(kb,nc,this.element.parentNode,this.wj.instance));
this.element.style.top=Kb+"px";this.element.style.left=nc+"px";this.element.style.height=ld+"px";this.element.style.width=kb+"px";nc=this.Pai(Ga);Oe.a.Q5(this.element,nc);Ga=this.Urf(Ga,this.Dp.ip.shapeId);this.Boj(nc,kb,this.isSelected(Ga),n.AFrameworkApplication.isRtl);this.rRb()}}}iZ(){this.element&&(nf.a.rx(this.element),this.jn.r7a(this.Dp.user.clientId),this.Wce())}oIh(Ga,kb,nc,Kb){kb=new Mi;if(!Kb||!nc)return kb;nc=this.Hai(Ga);if(!nc)return kb;kb.top=nc.y;kb.left=nc.x;kb.height=nc.height;
kb.width=nc.width;kb.rotation=this.Rcm(Ga);kb.m8a=!0;return kb}Ocj(Ga,kb,nc,Kb){ig.VKi();this.Mnd=Ga;if(Kb){const ld=this.Urf(Ga,this.Dp.ip.shapeId);if(!ld)return;const Kc=!this.element;Kc&&this.kbf(kb.ownerDocument,Ga);Kc||!this.element.parentNode?ld.appendChild(this.element):this.element.parentNode!==ld&&(this.element.parentNode.removeChild(this.element),ld.appendChild(this.element));this.jn.uga(this.Dp.user);this.element.style.borderColor=this.Dp.user.color;this.element.id=ig.Kib(this.Dp);nc.m8a&&
(this.element.style.height=nc.height+"px",this.element.style.top=nc.top+"px",this.element.style.left=nc.left+"px",this.element.style.width=nc.width+"px",Oe.a.Q5(this.element,nc.rotation),Oe.a.Q5(this.jn.element,-1*nc.rotation),this.Boj(nc.rotation,nc.width,this.isSelected(ld),n.AFrameworkApplication.isRtl),this.rRb())}this.ZZc=!Kb;this.Wce()}Rcm(Ga){return this.element&&this.element.parentNode&&this.Ngi(Oe.a.getTransform(this.element.parentNode))?this.Ngi(Oe.a.getTransform(this.element)):this.Pai(Ga)}Ngi(Ga){return Ga&&
-1<Ga.indexOf("deg")&&(Ga=parseInt(Ga.substring(Ga.indexOf("(")+1,Ga.indexOf("deg"))),!isNaN(Ga))?Ga:0}SFj(Ga){this.element.style.borderColor=this.Dp.user.color;this.element.id=ig.Kib(this.Dp);this.updatePosition(Ga)}kbf(Ga,kb){this.element=Ga.createElement("div");this.element.setAttribute(ig.d4i,!0);vf.a.Sl(this.element,ig.U_i,this);this.element.className=fh.GHn;(Ga=kb.Cb)&&Ga.YQ&&(this.element.style.pointerEvents="none");this.element.dir=n.AFrameworkApplication.isRtl?"rtl":"ltr";this.jn=this.IEc.gbf(this.createElement("div"),
!0);this.jn.uga(this.Dp.user);this.jn.hide();this.Bs.ob(yd.a.pointerOut,this.jn.element,this.TJ);this.Bs.ob(yd.a.pointerDown,this.jn.element,this.i9d);this.jn.element.classList.add(ig.e4i);this.element.appendChild(this.jn.element)}gam(Ga,kb,nc,Kb){let ld=Ga.y,Kc=Ga.x,ue=Ga.height;Ga=Ga.width;(1<Math.abs(kb.width-nc.offsetWidth)||1<Math.abs(kb.height-nc.offsetHeight))&&Kb&&(ld=Math.round(ld/Kb.oj),Kc=Math.round(Kc/Kb.oj),ue=Math.round(ue/Kb.oj),Ga=Math.round(Ga/Kb.oj));return{left:Kc,top:ld,height:ue,
width:Ga}}isSelected(Ga){return Ga.classList.contains(ml.a.N6b)}Boj(Ga,kb,nc,Kb){this.jn.element.style.left="auto";this.jn.element.style.top="auto";this.jn.element.style.right="auto";this.jn.element.style.bottom="auto";nc=nc?Math.round(.5*fh.Rra)+fh.JMo:0;0<=Ga&&90>Ga||360===Ga?(this.jn.element.style.top=-.5*fh.Rra-nc+"px",Kb?this.jn.element.style.right=kb-.5*fh.Rra+"px":this.jn.element.style.left=kb-.5*fh.Rra+"px"):90<=Ga&&180>Ga?(this.jn.element.style.left=-.5*fh.Rra-nc+"px",Kb?this.jn.element.style.bottom=
-.5*fh.Rra+"px":this.jn.element.style.top=-.5*fh.Rra+"px"):180<=Ga&&270>Ga?(this.jn.element.style.bottom=-.5*fh.Rra-nc+"px",Kb?this.jn.element.style.left=kb-.5*fh.Rra+"px":this.jn.element.style.right=kb-.5*fh.Rra+"px"):(this.jn.element.style.right=-.5*fh.Rra-nc+"px",Kb?this.jn.element.style.top=-.5*fh.Rra+"px":this.jn.element.style.bottom=-.5*fh.Rra+"px")}Gl(Ga,kb){const nc=this.wSd(Ga,kb);return nc?nc.properties:(Ga=this.Nai(Ga,kb))?Ga.properties:null}Urf(Ga,kb){var nc=this.wSd(Ga,kb);return nc&&
(nc=nc.Uwa(Ga.Ag,Ga))?nc.element:(kb=this.Nai(Ga,kb))?Object(y.a)(Rh.a,kb).qe(Ga.$b).htmlElement:null}wSd(Ga,kb){Ga=ki.i(Ga.Cb,5);for(const nc of Ga)if(nc.properties.getValue(ah.a.Ahb)===kb)return nc;return null}Nai(Ga,kb){Ga=Bg.GraphIterator.eb(Ga.Cb);let nc=Ga.Tb(6);for(;nc;){const Kb=nc.properties.getValue(ah.a.Ahb);if(Cg.ImageReader.Mt(nc)&&Kb===kb)return nc;nc=Ga.Lf(6)}return null}Z0l(Ga){const kb=Sf.a.nf(Cg.ImageReader.oF(Ga),0);Ga=Sf.a.nf(Cg.ImageReader.KG(Ga),1);return{Tka:kb,Gum:Ga}}Pai(Ga){Ga=
this.Gl(Ga,this.Dp.ip.shapeId);return Cg.ImageReader.p0(Ga)}Hai(Ga){var kb=this.Dp.ip;if(!kb||!kb.shapeId)return null;var nc=this.Gl(Ga,kb.shapeId);const Kb=this.Urf(Ga,kb.shapeId);if(!nc||!Kb)return null;const ld=Cg.ImageReader.ui(nc);let Kc=Ga=1,ue;({Tka:kb,Gum:ue}=this.Z0l(nc));eb.App.instance&&eb.App.instance.IR(ld)?(nc=Cg.ImageReader.Foa(nc),Ga=Sf.a.nf(nc[mg.a.left],0),Kc=Sf.a.nf(nc[mg.a.top],1)):nc.hasProperty(ah.a.Vda)?(nc=nc.getValue(ah.a.Vda),Ga+=Sf.a.nf(nc[mg.a.left],0),Kc+=Sf.a.nf(nc[mg.a.top],
1)):(Ga+=0<Kb.offsetWidth?(Kb.offsetWidth-kb)/2:2,Kc+=0<Kb.offsetHeight?(Kb.offsetHeight-ue)/2:2);return new Sys.UI.Bounds(Math.round(Ga),Math.round(Kc),Math.round(kb),Math.round(ue))}PPi(){this.jn&&(this.jn.kmc(),this.Sra=1)}rRb(){for(const Ga of this.jn.Mae)if(Ga.clientId===this.Dp.user.clientId&&!Ga.equals(this.Dp.user)){this.jn.uga(this.Dp.user);break}if(this.Dp.TUa||2===this.Sra)this.jn.jad(),this.Dp.TUa=!1,this.Dp.kda=!0,this.Sra=2;this.Dp.kda&&1!==this.Sra||(this.jn.kmc(),this.Dp.kda=!0,this.Sra=
1)}}fh.GHn="WACImgPresenceHighlight";fh.Rra=20;fh.JMo=6;Object(l.a)(fh,"PresenceImageControl",ig,[]);var zf=c(280);class Eh{constructor(){this.height=this.top=this.left=this.kvi=0;this.m8a=!1;this.bC=this.Kh=null}}Object(l.a)(Eh,"PresenceIpControlStyle",null,[1452]);var tl=c(65);class Nh extends ig{constructor(Ga,kb,nc,Kb,ld,Kc=null,ue=null,Le=null){super(Ga,kb,nc,Kb,ld,Kc,ue);this.NDc=this.XXa=this.C0b=null;this.JP=cf=>{!this.jn||this.Y5a&&!this.jn.Ljf(cf)||(this.UQf(),this.Qfe(cf));this.SFj(this.Mnd);
return!1};this.TJ=()=>{this.jn&&this.AR();return!1};this.i9d=cf=>{this.jn&&3===cf.kg&&(2!==this.Sra?(this.UQf(),this.Qfe(cf)):this.AR());return!1};this.BD=Le}kbf(Ga){this.element=Ga.createElement("div");this.element.setAttribute(ig.d4i,!0);vf.a.Sl(this.element,ig.U_i,this);this.element.className=ig.vzn;this.element.dir=n.AFrameworkApplication.isRtl?"rtl":"ltr";this.Bs.ob(yd.a.pointerOver,this.element,this.JP);this.Y5a&&(this.Bs.ob(yd.a.pointerOut,this.element,this.TJ),this.Bs.ob(yd.a.pointerDown,
this.element,this.i9d));this.XXa=this.createElement("div");this.XXa.className=Nh.HHn;this.Y5a||(this.NDc=this.createElement("div"),this.NDc.className=Nh.KHn,this.XXa.appendChild(this.NDc));this.jn=this.IEc.gbf(this.createElement("div"),this.Y5a);Ga=this.Ca.$("NoPresenceUserLookUpBeforeRender");this.BD&&!Ga&&(this.Dp.user=this.BD.pOf(this.Dp.user.clientId)||this.Dp.user);this.jn.uga(this.Dp.user);this.jn.hide();this.jn.element.classList.add(this.Y5a?ig.e4i:Nh.PCn);this.XXa.appendChild(this.jn.element);
this.element.appendChild(this.XXa)}kll(){this.C0b&&(vb.a.instance.ff(this.C0b),this.C0b=null)}rRb(Ga){for(var kb of this.jn.Mae)if(kb.clientId===this.Dp.user.clientId&&!kb.equals(this.Dp.user)){this.jn.uga(this.Dp.user);break}kb=!1;Nh.Zil===this.Dp.user.color?({value:kb}=this.nth.Fc(this.Dp.user.clientId,!1),kb||(this.nth.Z(this.Dp.user.clientId,!0),k.ULS.sendTraceTag(17954772,302,50,'{ "ClientID" : "'+this.Dp.user.clientId+'" , "Event" : "RenderGrayPawn"}'))):({value:kb}=this.efj.Fc(this.Dp.user.clientId,
!1),kb||(this.efj.Z(this.Dp.user.clientId,!0),k.ULS.sendTraceTag(17954773,302,50,'{ "ClientID" : "'+this.Dp.user.clientId+'" , "Event" : "RenderColoredPawn"}')));return Ga||this.Dp.TUa||2===this.Sra?(this.BLi(),this.jn.jad(),this.Dp.TUa=!1,this.Dp.kda=!0,this.Sra=2,Nh.qLo):this.Dp.kda&&1!==this.Sra?0:(this.BLi(),this.jn.kmc(),this.Dp.kda=!0,this.Sra=1,Nh.pLo)}Qfe(Ga=null){this.kll();const kb=this.rRb(!!Ga);this.Y5a&&Ga&&Ga.eventName===yd.a.pointerOver||this.Wbo(kb)}AR(){this.jn&&this.Sra&&(this.n7n(),
this.jn.hide(),this.Sra=0)}Wbo(Ga){this.C0b=new wa.a(2,1,Ga,()=>{this.C0b=null;this.AR()},56);vb.a.instance.Wb(this.C0b)}updatePosition(Ga){if(this.element&&this.element.parentNode){var kb=this.wbi(Ga);if(kb){Ga=Sys.UI.DomElement.getBounds(this.element.parentNode);kb=new Sys.UI.Bounds(kb.x-Ga.x,kb.y-Ga.y,Nh.ovi,kb.height);var nc;({left:Ga,top:kb,height:nc}=this.jam(kb,Ga,this.element.parentNode,this.wj.instance));this.element.style.height=2*Nh.Lhc+nc+"px";this.element.style.top=kb-Nh.Lhc+"px";this.element.style.left=
Ga-Nh.Lhc+"px";this.XXa.style.height=Math.max(Nh.EPi,nc)+"px";this.Qfe()}}}iZ(){this.element&&(nf.a.rx(this.element),this.Wce())}oIh(Ga,kb,nc,Kb,ld){const Kc=new Eh;if(!Kb||!nc)return Kc;Kb=this.wbi(Ga);if(!Kb)return Kc;var ue=nc;nc=Ga;if(Ga.gk){var Le=Ga.mc;ue=Ga.Xg.Z$b(this.Dp.ip.o$.cp);0>ue&&0==ue;Ga.mc.Exa?nf.a.wRa(Le.editingElement,Ga.Xg.ij.J(ue))||(nc=tl.InteractiveViewManager.instance.yd.Aj(Ga.source),kb=nc.Xg.ij.J(ue)):kb=nc.Xg.ij.J(ue);ue=kb.getBoundingClientRect()}ue=new Sys.UI.Bounds(Kb.x-
ue.x,Kb.y-ue.y,Nh.ovi,Kb.height);Ga=ue.y;Kb=ue.x;ue=ue.height;Le=this.wj.instance;ld&&Le&&(ld=Le.oj,Ga=Math.round(Ga/ld),Kb=Math.round(Kb/ld),ue=Math.round(ue/ld));Kc.top=Ga-Nh.Lhc;Kc.left=Kb-Nh.Lhc;Kc.height=2*Nh.Lhc+ue;Kc.kvi=Math.max(Nh.EPi,ue);Kc.m8a=!0;Kc.Kh=kb;Kc.bC=nc;return Kc}Ocj(Ga,kb,nc,Kb){ig.VKi();this.Mnd=Ga;Ga=nc.Kh;kb=nc.bC;if(Ga&&kb){if(Kb){const ld=!this.element;ld&&this.kbf(Ga.ownerDocument);ld||!this.element.parentNode?Ga.appendChild(this.element):this.element.parentNode!==Ga&&
(this.element.parentNode.removeChild(this.element),Ga.appendChild(this.element));this.Mnd=kb;Ga=this.Dp.user.color;this.XXa.style.borderColor=Ga;this.Y5a||(this.NDc.style.borderColor=Ga);this.element.id=ig.Kib(this.Dp);nc.m8a&&(this.element.style.height=nc.height+"px",this.element.style.top=nc.top+"px",this.element.style.left=nc.left+"px",this.XXa.style.height=nc.kvi+"px",this.Qfe())}this.ZZc=!Kb;this.Wce()}else k.ULS.sendTraceTag(520950942,302,50,`Skip IpControl rendering due to paragraphElement is null:${!Ga} or paragraphViewElement is null:${!kb}`)}dispose(){this.element&&
(this.iZ(),this.Bs.uc(yd.a.pointerOver,this.element,this.JP),this.Y5a&&(this.Bs.uc(yd.a.pointerOut,this.element,this.TJ),this.Bs.uc(yd.a.pointerDown,this.element,this.i9d)),Qd.a.jC(this.jn),this.element=this.jn=null);super.dispose()}SFj(Ga){const kb=this.Dp.user.color;this.XXa.style.borderColor=kb;this.Y5a||(this.NDc.style.borderColor=kb);this.element.id=ig.Kib(this.Dp);this.updatePosition(Ga)}jam(Ga,kb,nc,Kb){let ld=Ga.y,Kc=Ga.x;Ga=Ga.height;(1<Math.abs(kb.width-nc.offsetWidth)||1<Math.abs(kb.height-
nc.offsetHeight))&&Kb&&(ld=Math.round(ld/Kb.oj),Kc=Math.round(Kc/Kb.oj),Ga=Math.round(Ga/Kb.oj));return{left:Kc,top:ld,height:Ga}}wbi(Ga){const kb=this.Dp.ip;if(!kb)return null;let nc;try{const Kb=kb.o$.cp;nc=zf.a.Q_(Kb,Ga,0<Kb,!1,!1,!1)}catch(Kb){k.ULS.sendTraceTag(4301318,302,15,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",vb.a.instance.Qv,Kb.message,Kb.stack),nc=null}return nc}}Nh.PCn="WacPawn";Nh.ovi=2;Nh.pLo=7E3;Nh.qLo=2E3;Nh.Lhc=5;Nh.HHn="presenceIp";Nh.KHn="PresenceSmallBox";
Nh.EPi=10;Nh.Zil="0xcccccc";Object(l.a)(Nh,"PresenceIpControl",ig,[]);class Uh{constructor(Ga,kb,nc,Kb,ld=null,Kc=null,ue=null){this.vtc={};this.ttc={};this.qPg={};this.IEc=Ga;this.Bs=kb;this.nn=nc;this.VKa=Kb;this.VW=ld;this.Ca=Kc;this.BD=ue}get Chl(){return this.vtc}get uPh(){return this.ttc}eam(Ga){const kb=!!this.Ca&&this.Ca.$("PeoplesWellExtraButtonInfoIsEnabled");return Ga.ip.shapeId&&kb?this.kam(Ga):this.lam(Ga)}kam(Ga){const kb=Ga.ip.shapeId.toString();this.qPg[Ga.user.clientId]=kb;const nc=
this.ttc[kb];return nc?(nc.Dp=Ga,{returnValue:nc,kpe:!0}):{returnValue:this.ttc[kb]=new fh(Ga,this.IEc,this.Bs,this.nn,this.VKa,this.VW,this.Ca),kpe:!1}}lam(Ga){const kb=Ga.user.clientId,nc=this.vtc[kb];return nc&&nc.Dp.user.equals(Ga.user)?(nc.Dp=Ga,{returnValue:nc,kpe:!0}):{returnValue:this.vtc[kb]=new Nh(Ga,this.IEc,this.Bs,this.nn,this.VKa,this.VW,this.Ca,this.BD),kpe:!1}}xbi(Ga){return this.vtc[Ga]}V0l(Ga){return(Ga=this.ttc[this.qPg[Ga]])&&!Ga.mpe()?Ga:null}Hql(){var Ga=this.vtc;for(const kb in Ga)Ga[kb].dispose();
Ga=this.ttc;for(const kb in Ga)Ga[kb].dispose()}}Object(l.a)(Uh,"PresenceControlProvider",null,[]);var ok=c(172);class pj{constructor(){this.$cb=0}ndi(){this.$cb++;this.$cb===Number.MAX_VALUE&&(this.$cb=1);return this.$cb}static get instance(){return pj.SAc}}pj.SAc=new pj;Object(l.a)(pj,"PacketIdGenerator",null,[298]);class Ek{constructor(Ga,kb,nc){this.ico=Ga;this.Gym=kb;this.nGi=nc}}Object(l.a)(Ek,"SuccessfulInboundReplicationCallbackData",null,[]);class cj{constructor(Ga,kb,nc,Kb,ld,Kc,ue){this.Q$n=
(Le,cf)=>{cf.type||(Le=this.Vk.fWh>=this.d2j,this.bnk&&Le?(Le=this.VCe())?Le.XXh():k.ULS.sendTraceTag(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.kF())};this.Bvn=Le=>{if(Le=Object(y.a)(Ek,Le)){var cf=Le.Gym.pi.toString(),Mf=this.VCe(),Vg=Mf.Su,Eg="";Vg!==Le.nGi&&(k.ULS.sendTraceTag(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",Le.ico.toString()),Eg=this.w6l(Mf,Vg,Le.nGi));k.ULS.sendTraceTag(19964237,
500,50,"Revisions: {0}, InboundDuration: {1}",Eg,cf)}else k.ULS.sendTraceTag(19964235,500,10,"The callback data was null")};this.I$n=Ga;this.VCe=kb;this.Vk=nc;this.bnk=ld;this.d2j=Kc;this.GYb=Kb;this.eq=ue;this.I$n.V3(this.Q$n)}kF(){const Ga=this.VCe();if(!Ga)k.ULS.sendTraceTag(19682514,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");else if(!this.GYb()&&Ga.mSa){let kb=-1;null!=Ga&&(kb=Ga.pza());const nc=this.eq.Yf("Task","ShoulderTapInboundReplicationTimer");
Ga.kF(this.Bvn,null,new Ek(kb,nc,Ga.Su))}}w6l(Ga,kb,nc){const Kb=new Sys.StringBuilder;Ga=Ga.node.xd.store.getRevision(kb);if(!Ga)return k.ULS.sendTraceTag(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{["lastRevisionId"]:kb}),"";for(Kb.append(Ga.id.guid);kb!==nc;){Kb.append(", ");Kb.append(kb.guid);Ga=Ga.Fn;if(!Ga)break;kb=Ga.id}return Kb.toString()}}Object(l.a)(cj,"ContentNotificationManager",null,[]);class Fi extends cj{constructor(Ga,kb,nc,Kb,ld,Kc,ue){super(Ga,
kb,nc,Kb,ld,Kc,ue)}static get lra(){return null!=Fi.QGg?Fi.QGg:Fi.QGg=Na.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}static init(){if(Lb.StaticActiveAppFrame.za()){var Ga=Lb.StaticActiveAppFrame.za().jb;Ga&&(Ga.vga(Fi.e2c),Ga=Ga.Zc)&&(Fi.zH=Ga.contentReplicator,Fi.zH&&eb.App.Xoa().continueWith(Fi.nWf))}}static nWf(){Fi.Eid=eb.App.Xoa().result;Fi.Eid&&Fi.Eid.Uo&&Fi.lra.bE().continueWith(Fi.R2c)}static R2c(){Fi.lj=Fi.lra.bE().result;if(Fi.lj){var Ga=n.AFrameworkApplication.K,kb=Ga.$("Box4ThrottleInboundRequests");
Ga=Ga.nc("Box4ThrottleInboundsAtUserCount",20);Fi.zH.yUd=()=>Fi.lj.ASa;Fi.Bid=Fi.Bid||new Fi(Fi.lj,()=>Fi.zH,Fi.Eid,()=>n.AFrameworkApplication.Qk,kb,Ga,Lb.StaticActiveAppFrame.za().Kq);Fi.Bid.kF()}}static e2c(Ga){Fi.Bid||(Ga.qpb(Fi.e2c),Fi.init())}}Fi.Bid=null;Fi.lj=null;Fi.zH=null;Fi.Eid=null;Object(l.a)(Fi,"WordContentNotificationManager",cj,[]);class Yh{constructor(Ga,kb,nc,Kb,ld,Kc){this.xjd=null;this.Tbh=Ga;this.ud=nc;this.SMa=Kb;this.dB=ld;this.Nh=Kc;this.QTb=kb}clone(){return new Yh(this.Tbh,
this.QTb.clone(),this.ud,this.SMa,this.dB,this.Nh)}get cp(){if(null!=this.xjd)return this.xjd;var Ga=this.Tbh.paragraphId;if(Ga.equals(wd.a.nil))return 0;var kb=this.SMa();if(!kb)return 0;Ga=kb.Eb(Ga);if(!Ga)return k.ULS.sendTraceTag(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;kb=this.ud.gDb(this.ud.pTa(Ga.characterData,Ga.ra),this.QTb);if(this.dB){const nc=Rb.a.Uc(Ga,kb);this.Nh&&Ga.su&&(nc.Fb=this.Nh.atf(Ga,kb,this.QTb.cEa));kb=this.dB.Ava(nc,!0)}return kb}xYf(){null==
this.xjd&&(this.xjd=this.cp)}equals(Ga){return Ga?this.QTb.isEqual(Ga.QTb,!1):!1}}Object(l.a)(Yh,"WordPresenceCp",null,[307,69,308]);class rj{constructor(Ga,kb){this.dB=Ga;this.Nh=kb}create(Ga,kb,nc,Kb){return new Yh(Ga,kb,nc,Kb,this.dB,this.Nh)}}Object(l.a)(rj,"Factory",null,[297]);class Pm extends Sys.EventArgs{constructor(Ga,kb,nc){super();this.paragraphId=Ga;this.presence=kb;this.JDf=nc}}Object(l.a)(Pm,"ParagraphChangedEventArg",Sys.EventArgs,[]);class Fk{constructor(Ga){this.cp=Ga}equals(Ga){return Ga?
this.cp===Ga.cp:!1}clone(){return new Fk(this.cp)}}Object(l.a)(Fk,"PresenceCp",null,[307,69]);class Ll{constructor(Ga,kb,nc,Kb,ld){this.paragraphId=Ga;this.cp=kb;this.length=nc;this.shapeId=Kb;this.dryDeletion=ld}}Object(l.a)(Ll,"SerializablePresenceIpData",null,[]);class rh{constructor(Ga,kb,nc,Kb=0,ld=0){this.Lta=null;Ga&&(this.Lta=wd.a.If(Ga));this.Sbh=new Fk(kb);this.bIa=nc;this.wgh=Kb;this.UTg=ld}get paragraphId(){return this.Lta}get o$(){return this.Sbh}get shapeId(){return this.wgh}get dryDeletion(){return this.UTg}isValid(){return 0<=
this.o$.cp&&!!this.paragraphId&&!this.paragraphId.equals(wd.a.nil)}getData(){return new Ll(this.paragraphId.toString(),this.o$.cp,this.bIa,this.shapeId,this.dryDeletion)}clone(){const Ga=new rh;Ga.Lta=this.paragraphId;Ga.Sbh=this.o$?this.o$.clone():null;Ga.bIa=this.bIa;Ga.wgh=this.shapeId;Ga.UTg=this.dryDeletion;return Ga}static lDb(Ga){return Ga.paragraphId&&void 0!==Ga.cp&&null!==Ga.cp&&void 0!==Ga.length&&null!==Ga.length?new rh(Ga.paragraphId,Ga.cp,Ga.length,void 0,Ga.dryDeletion):null}}Object(l.a)(rh,
"PresenceIp",null,[289,69]);class qp{constructor(Ga,kb){this.ip=Ga;this.user=kb}}Object(l.a)(qp,"SerializablePresenceData",null,[]);class Hi{constructor(Ga,kb){this.TUa=this.kda=this.Tfc=!1;this.WXa=kb;this.user=Ga}get ip(){return this.WXa}Vuf(){return new qp(this.ip?this.ip.getData():null,this.user.getData())}jai(){return this.user.clientId+(this.WXa?this.WXa.paragraphId.toString():wd.a.nil.toString())}isValid(){const Ga=!!this.user&&this.user.isValid(),kb=!this.ip||this.ip.isValid();return Ga&&
kb}clone(){const Ga=new Hi;Ga.user=this.user?this.user.clone():null;Ga.WXa=this.WXa?this.WXa.clone():null;Ga.kda=this.kda;Ga.Tfc=this.Tfc;Ga.TUa=this.TUa;return Ga}static lDb(Ga){return Ga?new Hi(xb.lDb(Ga.user),Ga.ip?rh.lDb(Ga.ip):null):null}}Object(l.a)(Hi,"PresenceInfo",null,[299,69]);class Gk extends va.a{constructor(){super();this.dBc={};this.IWa={};this.cWg=!1}get AAn(){return this.dBc}get $Ai(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled")}Qrh(Ga){this.addHandler("PPC",
Ga)}ucj(Ga){this.removeHandler("PPC",Ga)}IRc(Ga){return Ga.ip.paragraphId.toString()}D_e(Ga,kb=!1){this.cWg||(this.cWg=!0,k.ULS.sendTraceTag(4289312,302,50,"First presence added to data manager"));var nc=({IHn:Kb}=this.EXm(Ga)).returnValue;if(Kb&&!kb)(nc=this.IWa[Ga.user.clientId])&&0<=nc.length&&(nc[nc.length-1].ip.bIa=Ga.ip.bIa);else{nc||this.hbj(Ga.user.clientId);this.$Ai&&nc&&this.OXo(Ga);kb=this.IRc(Ga);var Kb=Ga.user.clientId;var ld=this.dBc[kb]||[],Kc=this.IWa[Kb]||[];Kc.length>=Gk.oOi&&(Kc=
Kc.splice(-Gk.Zjn,Gk.oOi));nc||ld.push(Kb);Kc.push(Ga);this.dBc[kb]=ld;this.IWa[Kb]=Kc;Ga.ip.paragraphId.equals(wd.a.nil)||this.O5f(Ga.ip.paragraphId,Ga,!0)}}EXm(Ga){var kb=this.IWa[Ga.user.clientId];const nc=!kb||0>=kb.length?null:kb[kb.length-1],Kb=!!nc&&this.IRc(nc)===this.IRc(Ga);kb=Kb&&nc.ip.o$.equals(Ga.ip.o$)&&nc.user.equals(Ga.user);this.$Ai&&kb&&nc.ip.shapeId&&Ga.ip.shapeId&&nc.ip.shapeId!==Ga.ip.shapeId&&(kb=!1);return{returnValue:Kb,IHn:kb}}OXo(Ga){const kb=this.Phl(Ga);kb&&kb.ip.shapeId&&
(Ga.ip.shapeId&&Ga.ip.shapeId===kb.ip.shapeId||this.O5f(kb.ip.paragraphId,kb,!1))}Phl(Ga){Ga=this.IWa[Ga.user.clientId];return!Ga||0>=Ga.length?null:Ga[Ga.length-1]}hbj(Ga){const kb=this.IWa[Ga];if(kb&&0<kb.length){const nc=kb[0].ip.paragraphId,Kb=this.IRc(kb[0]);delete this.IWa[Ga];this.H0n(Kb,Ga);nc.equals(wd.a.nil)||this.O5f(nc,kb[0],!1)}}k7h(Ga){return this.dBc[Ga]}GPc(Ga,kb,nc,Kb=!1){const ld=[],Kc=this.k7h(Ga);if(!Kc)return ld;for(let ue=0;ue<Kc.length;ue++){const Le=Kc[ue],cf=this.IWa[Le];
let Mf=!1;for(let Vg=cf.length-1;0<=Vg;Vg--){const Eg=cf[Vg];if(Kb){if(Eg.kda&&Eg.ip.paragraphId.equals(wd.a.If(Ga))){Mf=!0;ld.push(Eg);break}}else if(Object(el.a)(Hi,Eg)?Eg.ip.bIa===kb:Eg.ip.bIa===nc){Mf=!0;Eg.Tfc=!0;ld.push(Eg);this.IWa[Le]=cf.splice(Vg,cf.length);break}}!Mf&&0<cf.length&&cf[0].Tfc&&cf[0].ip.paragraphId.equals(wd.a.If(Ga))&&ld.push(cf[0])}return ld}VNl(Ga){if(!Ga||!Ga.Pa||!Ga.Pa.node)return null;Ga=this.GPc(Ga.Pa.node.id.toString(),0,0,!0);Ga=this.Dkm(Ga);Ga.sort((kb,nc)=>{if(!(kb&&
kb.userName&&nc&&nc.userName))return k.ULS.sendTraceTag(542165082,302,15,"Missing presence user info for user in PresenceInfos"),0});return Ga}Dkm(Ga){if(!Ga||!Ga.length)return[];const kb=[],nc=new M.a(K.a.ih());for(let Kb=0;Kb<Ga.length;Kb++){const ld=Ga[Kb].user;ld.isAnonymous&&nc.contains(ld.clientId)||!ld.isAnonymous&&ld.email&&nc.contains(ld.email)||(kb.push(ld),nc.add(ld.isAnonymous?ld.clientId:ld.email))}return kb}O5f(Ga,kb,nc){this.raiseEvent("PPC",new Pm(Ga,kb,nc))}H0n(Ga,kb){Array.remove(this.dBc[Ga],
kb)}}Gk.oOi=10;Gk.Zjn=2;Object(l.a)(Gk,"PresenceDataManager",va.a,[1402]);class Xn extends Gk{constructor(Ga){super();this.yH=Ga}D_e(Ga,kb=!1){super.D_e(Ga,kb)}IRc(Ga){return Ga.ip.Wc.toString()}k7h(Ga){Ga=this.yH.Eb(wd.a.If(Ga));if(!Ga)return null;Ga=Ga.ja(ah.a.Wc,0);return this.AAn[Ga.toString()]}}Object(l.a)(Xn,"WordPresenceDataManager",Gk,[]);var jk=c(1506),Hd=c(1086),Ie=c(1896),Ok=c(17),Jj=c(1414);class ee{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,Eg,wi,sm,sh,Rj,Ni,xi,qe,Hh,xd,ye,Pd,Td){this.RNa=
Array(5);this.CXe=this._started=this.CSe=!1;this.ePe=null;this.tch=new M.a(K.a.ih());this.Wtd={};this.xHe=!1;this.gAn=()=>{if(!this.CXe&&!this.sl.Py){var ul=new wa.a(0,1,20,()=>{const oi=new S.a;var lh=this.jdb.Chl;for(var Xk in lh){const Ih=lh[Xk];Ih.ZZc&&oi.add(Ih.Dp.ip.paragraphId)}if(this.M6d){lh=this.jdb.uPh;for(const Ih in lh)Xk=lh[Ih],Xk.ZZc&&!oi.contains(Xk.Dp.ip.paragraphId)&&oi.add(Xk.Dp.ip.paragraphId)}this.v5h(oi);this.CXe=!1},72);this.Ib.Wb(ul);this.CXe=!0}};this.WVi=()=>{this.CSe&&(this.tcg(),
this.CSe=!1)};this.v5=(ul,oi)=>{this.ckj(oi.yl.lb)};this.t5=(ul,oi)=>{ul=oi.asa;for(var lh in ul){const Xk=ul[lh];this.Ca.$("CashTelemetryIsEnabled")&&this.vNc(Xk,new Date,null);Xk.ip?this.w_e(Xk):this.f7c(Xk.user.clientId)}oi=oi.ILd;for(lh=0;lh<oi.length;++lh)this.Zll(oi[lh]);this.hee()};this.yYf=(ul,oi)=>{oi.paragraphId?this.SZo(oi.paragraphId.toString(),oi.l1m,this.Wtd):k.ULS.shipAssertTag(8758481,302,!1,"null paraid")};this.f4i=(ul,oi)=>{oi.paragraphId&&(ul=this.YF.Eb(oi.paragraphId))&&((Object(el.a)(Hi,
oi.presence)?this.LCe(ul):this.MCe(ul))===oi.presence.ip.bIa&&this.bco(oi.paragraphId),this.M6d&&this.JHn(oi))};this.gw=Ga;this.hb=Kb;this.BD=ld;this.uyb=Kc;this.sl=cf;this.b2j=Mf;this.jdb=Vg;this.YF=nc;this.LCe=wi;this.MCe=sm;this.cVj=ue;this.e2j=Le;this.MMa=sh;this.Rq=Rj;this.Lc=Ni;this.Ib=xi;this.Fjh=ye;this.dhk=Td;this.fPe=Hh;this.Ca=xd;this.ztd=kb;ee.Cud=new hc.a;for(Ga=0;Ga<this.ztd.length;Ga++)this.ztd[Ga].WXn(this);this.uyb.Qrh(this.f4i);this.gw.M_a(this.t5);Pd&&this.sl.wga(this.gAn);this.gw.Bde(this)}get M6d(){return!!this.Ca&&
this.Ca.$("PeoplesWellExtraButtonInfoIsEnabled")}hee(Ga=!1){this.Fjh&&!Ga||this.Kcj()}Kcj(){const Ga=new S.a,kb=this.Wtd;for(const nc in kb)Ga.add(wd.a.If(nc));this.v5h(Ga);this.Wtd={}}tcg(){this.hb.ib&&this.ckj(this.hb.ib.lb,!0)}ckj(Ga,kb=!1){this.dhk||(this.YF.zm.Fia||kb?Ga?(kb=this.hel(Ga))?this.gw.Bcg(kb):(this.gw.Bcg(null),k.ULS.sendTraceTag(4281418,302,50,"Not supported selection context {0}",Ga.Pa.contextId)):this.gw.Bcg(null):this.CSe=!0)}hel(Ga){if(!this.M6d||!Ga.emb)if(Ga=Ok.SelectionEditor.Jj(Ga,
!0,!1),!Ok.SelectionEditor.Pl(Ga))return null;return this.Dzh(Ga)}Dzh(Ga){const kb=Ga.Pa.cpBegin,nc=Ga.Pa.node.id;Ga=this.LCe(Ga.Pa.node);return new rh(nc.toString(),kb,Ga)}vNc(Ga,kb,nc){if(this.fPe)if(Ga&&Ga.user&&Ga.user.clientId){var Kb=Ga.user.clientId;this.tch.contains(Kb)||(this.ePe?(this.ePe.vNc(Kb,kb,null,ee.adm(nc||Ga.user.client)),this.tch.add(Kb)):this.fPe.continueWith(()=>{this.ePe=this.fPe.result;this.vNc(Ga,kb,nc)}))}else k.ULS.sendTraceTag(42262876,302,15,"invalid presence")}ham(Ga){const kb=
new S.a;for(let nc=0;nc<Ga.length;nc++)kb.add(this.tkm(Ga[nc]));return kb}w_e(Ga){var kb=null;Ga&&Ga.user&&(kb=Ga.user.client);Ga=Ga.clone();Ga.user=this.BD.pOf(Ga.user.clientId)||Ga.user;this.Ca.$("CashTelemetryIsEnabled")&&this.vNc(Ga,new Date,kb);Ga.isValid()&&!Ga.user.rL()&&(kb=Ga.user.clientId,ee.Cud.nb(kb)||this.mmi(kb),this.GZo(kb),Ga.user.userName=CommonUIStrings.l_AnonymousUserName);this.uyb.D_e(Ga,!1)}GZo(Ga){const {value:kb}=ee.Cud.Fc(Ga,!1);kb||(ee.Cud.Z(Ga,!0),k.ULS.sendTraceTag(17954774,
302,50,'{ "ClientID" : "'+Ga+'" , "Event" : "CreateAnonymousGrayPawn"}'))}mmi(){}f7c(Ga){this.uyb.hbj(Ga)}Zll(Ga){this.f7c(Ga);const kb=this.jdb.xbi(Ga);kb&&(kb.Nbj(this.yYf),kb.dispose());this.M6d&&(Ga=this.jdb.V0l(Ga))&&(Ga.Nbj(this.yYf),Ga.dispose())}A$b(Ga){if(12!==Ga.type)return new S.a;Ga=this.uyb.GPc(Ga.id.toString(),this.LCe(Ga),this.MCe(Ga));return 0>=Ga.length?new S.a:this.ham(Ga)}SZo(Ga,kb,nc){!kb&&Ga in nc&&delete nc[Ga]}dispose(){this.stop();this.uyb.ucj(this.f4i);this.gw.hPb(this.t5);
this.gw.fpg(this);for(let Ga=0;Ga<this.ztd.length;Ga++)this.ztd[Ga].BTo(this);Qd.a.gbg([this.cVj,this.e2j,this.gw]);this.jdb.Hql()}tkm(Ga){let kb=!1;Ga=({kpe:kb}=this.jdb.eam(Ga)).returnValue;kb||Ga.sxk(this.yYf);return Ga}tki(Ga){Ga=this.YF.Eb(Ga);if(!Ga)return this.RNa[0]||(k.ULS.sendTraceTag(4281420,302,50,"Could not find the node in object space"),this.RNa[0]=!0),null;if(!rc.ParagraphReader.Xb(Ga))return this.RNa[1]||(k.ULS.sendTraceTag(4281421,302,50,"Not a paragraph node"),this.RNa[1]=!0),null;
if(!Ga.qe(this.sl.$b))return this.RNa[2]||(k.ULS.sendTraceTag(4281422,302,50,"No ViewElement found for this node"),this.RNa[2]=!0),null;if(!Ga.anchor)return this.RNa[3]||(k.ULS.sendTraceTag(4281423,302,50,"node is not anchored"),this.RNa[3]=!0),null;this.RNa[4]||(k.ULS.sendTraceTag(4564931,302,50,"Valid paragraph node found for rendering ip"),this.RNa[4]=!0);return Ga}Naj(Ga){Ga=this.uyb.GPc(Ga.toString(),-1,-1,!0);if(!Jd.a.af(Ga))for(const kb of Ga)(Ga=this.jdb.xbi(kb.user.clientId))&&Ga.element&&
Ga.iZ()}v5h(Ga){if(Ga.count){var kb=new S.a;for(var nc of Ga)(Ga=this.tki(nc))?kb.add(Ga):this.Naj(nc);if(kb.count){nc=this.Lc.Pc(2);try{nc.set(this.Rq);for(const Kb of kb)this.qUh(Kb)}finally{nc&&nc.dispose()}}}}qUh(Ga){Ga.IJ(this.sl.$b,32,!0);Ga.IJ(this.b2j,32,!0)}bco(Ga){this.Wtd[Ga.toString()]=null;this.Fjh&&!this.xHe&&(Ga=new wa.a(0,1,200,()=>{this.xHe=!1;this.Kcj()},70),this.Ib.Wb(Ga),this.xHe=!0)}JHn(Ga){if(Ga.presence.ip.shapeId&&!Ga.JDf){var kb=this.jdb.uPh[Ga.presence.ip.shapeId.toString()];
kb&&kb.r7a(Ga.presence.user.clientId)}}stop(){this._started&&(this._started=!1,this.hb.jZ(this.v5),Jj.a.instance.ocj(this.WVi))}start(){if(!this._started){this._started=!0;this.hb.Xw(this.v5);Jj.a.instance.ACd(this.WVi);var Ga=this.gw.KFb();delete Ga[this.MMa.clientId];this.t5(null,new Ie.a(Ga,[]));this.tcg()}}yje(Ga){if(Ga&&Ga.isValid()&&Ga.ip){var kb=this.uyb.GPc(Ga.ip.paragraphId.toString(),-1,-1),nc=!1,Kb=null;for(let ld=0;ld<kb.length;ld++)if(Kb=kb[ld],Kb.user.clientId===Ga.user.clientId){nc=
Kb.TUa=!0;break}if(nc)if(kb=Kb.ip.paragraphId,Ga=this.tki(kb)){kb=this.Lc.Pc(2);try{kb.Db(Ga),this.qUh(Ga)}finally{kb&&kb.dispose()}}else this.Naj(kb)}}static adm(Ga){return Ga?Ga?1===Ga?1:2===Ga?2:0:2:0}}ee.Cud=null;Object(l.a)(ee,"PresenceManager",null,[1398,10,263,1399,1400,1401]);class md{constructor(Ga,kb,nc,Kb){this.aWb=null;this._started=this.XFe=!1;this.uAb=null;this.Aqa=(ld,Kc)=>{if(!n.AFrameworkApplication.Qk&&(ld=this.UGj(Kc.yl),this.aWb&&ld)){ld=this.Aye.GPc(this.aWb.toString(),-1,-1,
!0);for(Kc=0;Kc<ld.length;Kc++)this.uAb[ld[Kc].user.clientId]=ld[Kc];0>=ld.length||(ld=this.Hal(ld),this.Xo.sendNotification(ld,!0))}};this.LXi=(ld,Kc)=>{this.hb.ib&&!n.AFrameworkApplication.Qk&&this.XFe&&this.aWb&&this.aWb.equals(Kc.paragraphId)&&(ld=null,!Kc.JDf||Kc.presence.user.clientId in this.uAb?Kc.JDf||(ld=this.INh(Kc.presence.user.userName,!1),delete this.uAb[Kc.presence.user.clientId]):(ld=this.INh(Kc.presence.user.userName,!0),this.uAb[Kc.presence.user.clientId]=Kc.presence),ld&&this.Xo.sendNotification(ld,
!0))};this.lj=Kb;this.hb=kb;this.Aye=Ga;this.Xo=nc;this.lj.Bde(this)}start(){this._started||(this._started=!0,this.uAb={},this.Aye.Qrh(this.LXi),this.hb.Xw(this.Aqa),this.UGj(this.hb.ib))}stop(){this._started&&(this._started=!1,this.uAb=null,this.Aye.ucj(this.LXi),this.hb.jZ(this.Aqa))}Hal(Ga){if(1===Ga.length)return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,Ga[0].user.userName);const kb=[],nc=Ga.length;for(let Kb=0;Kb<nc;Kb++)kb.push(Ga[Kb].user.userName);return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,
kb.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}INh(Ga,kb){return String.format(kb?Box4Intl.Box4Strings.l_UserJoiningParagraph:Box4Intl.Box4Strings.l_UserLeavingParagraph,Ga)}dispose(){this.lj.fpg(this);this.stop()}UGj(Ga){if(!Ga)return!1;Ga=Ga.lb;if(!Ga)return!1;Ga=Ga.Pa;if(!Ga)return!1;this.XFe=Ok.SelectionEditor.Ze(Ga);Ga=Ga.node.id;if(Ga.equals(this.aWb)||!this.XFe)return!1;this.aWb=Ga;this.uAb={};return!0}}Object(l.a)(md,"PresenceAccessibilityManager",null,[10,263]);class nl{constructor(Ga,
kb){this._started=!1;this.xK=null;this.Tod=!1;this.s2c=()=>{this._started&&this.Njj()};this.lj=Ga;kb&&(this.xK=kb,this.xK.afb(this.s2c));this.lj.Bde(this)}start(){this._started||(this._started=!0,this.xK?this.Njj():this.lj.qN(1,this.oMh()))}Njj(){const Ga=this.Tod;(this.Tod=!!this.xK.Yx)&&!Ga&&this.lj.qN(1,this.oMh())}oMh(){const Ga={};Ga.Id="{"+n.AFrameworkApplication.userSessionId.toUpperCase()+"}";Ga.HQ=!1;Ga.NT=1;Ga.WEB=!0;return Ga}stop(){this._started&&(this._started=this.Tod=!1)}dispose(){this.lj.fpg(this);
this.xK&&this.xK.Pbj(this.s2c)}}Object(l.a)(nl,"EditorsTableNotifier",null,[10,263]);var gf=c(373),yh=c(14);class Ef extends ee{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,Eg,wi,sm,sh,Rj,Ni,xi,qe,Hh,xd,ye,Pd,Td,ul,oi,lh,Xk,Ih,Ze,If){super(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,wi,sm,sh,Rj,qe,Hh,xd,ye,Pd,Td,ul,oi,Ih);this.Vk=null;this.Oul=Ho=>{const Me=!!this.Vk.mC.F9b(Ho);k.ULS.sendTraceTag(579179741,302,50,"ClientId:{0} isPresentAfterPoll:{1}",Ho,Me)};this.Nul=(Ho,Me)=>{k.ULS.sendTraceTag(579179742,302,
15,"EditorsReplicator failed with {0} when looking for ClientId {1}",Me,Ho)};this.ija=()=>{if(2===Ef.lj.connectionState&&!Ca.SessionStatusManager.instance.fda){const Ho={};Ho.qs=n.AFrameworkApplication.rootQuerySignature;Ef.lj.Yrb(Ho)}};Eg.fb(yh.a.yyo,Hb.a.application,Ef.Quk,64);Eg.fb(yh.a.D8f,Hb.a.application,Ef.D8f,64);Eg.fb(yh.a.m5f,Hb.a.application,Ef.m5f,96);Eg.fb(rb.a.yje,Hb.a.application,Ef.xyo,64);this.XI=Ni;this.ud=xi;this.LAb=lh;this.MMa.Hic=Xk;this.MMa.Hic.Azk(Ef.MXi);Ze.continueWith(()=>
{this.Vk=Ze.result});k.ULS.sendTraceTag(4006600,302,50,"WordPresenceManager Initialized");(this.y3=If)&&this.y3.execute(Ho=>{Ho.J_a(this.ija)})}F$b(Ga){if(!Ga||!Ga.anchor)return null;for(Ga=Ga.anchor.Vp;Ga;Ga=Ga.NA)if(Ga.JGa)return Ga.us.node;return null}Dzh(Ga){var kb=null;kb=n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled");var nc=Ga.Pa.cpBegin,Kb=Ga.Pa.node;kb&&Cg.ImageReader.Mt(Kb)&&(Kb=this.F$b(Kb));if(!Kb)return k.ULS.sendTraceTag(51242309,302,15,"selectedNode is null"),null;
Kb=this.MCe(Kb);const ld=Ga.Pa.node.ja(ah.a.Wc,0);if(!this.XI)return k.ULS.sendTraceTag(35997152,302,15,"paragraphWordIdMapping is null"),null;var Kc=this.XI.value.Ajb(ld);const ue=Ef.yH.Eb(Kc);if(!ue)return k.ULS.sendTraceTag(16791249,302,15,"Can't find pid "+Kc),null;nc=this.ud.Qpc(this.ud.pTa(ue.characterData,ue.ra),nc);nc.cEa=-1===Ga.Pa.Fb?0:Ga.Pa.Fb;Kc=0;kb&&Ga.emb&&(Kc=this.Kem(Ga));return kb=new kc(this.XI.value,ld,Kb,nc,this.ud,()=>Ef.yH,this.LAb,Kc)}Kem(Ga){const kb=Cg.ImageReader.BFa(Ga.Pa);
return kb?kb.properties.ja(ah.a.Ahb,0):Ga.Pa.node.properties.ja(ah.a.Ahb,0)}mmi(Ga){this.Vk&&this.Vk.goa&&this.Vk.goa.kF(this.Oul,this.Nul,Ga)}dispose(){this.y3&&this.y3.execute(Ga=>{Ga.gPb(this.ija)});super.dispose()}static get Hv(){return Na.a.instance.resolve("Common.Utils.IAriaNotifier")}static bE(){return Ef.mxc.task}static get_instance(){return Ef.Bud.task}static mam(){return Ef.Ubh.task}static get lra(){return null!=Ef.PGg?Ef.PGg:Ef.PGg=Na.a.instance.resolve("Box4.Presence.IRtcProxyProvider")}static init(){Ef.Bud||
(Ef.Bud=new x.a);Ef.pWg&&(k.ULS.sendTraceTag(4256585,302,50,"WordPresenceManager Init"),Ef.pWg=!1);if(Lb.StaticActiveAppFrame.za()){var Ga=Lb.StaticActiveAppFrame.za().jb;Ga?(Ga.vga(Ef.e2c),Ef.ZAc=Ga.rc,Ga.Hpa()?(Ef.$N=Ga.Zc.contentReplicator,Ef.$N?(Ef.yH=Ga.Zc.xd,Ef.yH?Ef.lra.bE().continueWith(Ef.oun):k.ULS.sendTraceTag(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app")):k.ULS.sendTraceTag(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object")):
k.ULS.sendTraceTag(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):k.ULS.sendTraceTag(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else k.ULS.sendTraceTag(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}static oun(){Ef.lj=Ef.lra.bE().result;if(Ef.lj){var Ga=[Ef.ZAc.o3c,Ef.ZAc.we.o3c],kb=cb.a.instance,nc=Na.a.instance.resolve("Box4.Presence.WordPresenceDataManager"),
Kb=new md(nc,kb,Ef.Hv,Ef.lj),ld=n.AFrameworkApplication.K.$("DoNotAddToEditorsTableOnFrameIsEnabled")?eb.App.zd.mC:null;ld=new nl(Ef.lj,ld);var Kc=Na.a.instance.Ve("WordEditor.IParagraphWordIdMapping"),ue=Na.a.instance.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Le=Na.a.instance.resolve("Common.IPeopleInfoProvider");Ef._instance=new Ef(Ef.lj,Ga,Ef.yH,kb,Le,nc,Kb,ld,Ef.ZAc,Ef.ZAc.we.$b,Na.a.instance.resolve("Box4.Presence.PresenceControlProvider"),n.AFrameworkApplication.va,
Ef.$N,rc.ParagraphReader.textLength,rc.ParagraphReader.hoa,Na.a.instance.resolve("Box4.Presence.MyPresenceUser"),Kc,ue,eb.App.li.Al,new gf.a,vb.a.instance,jk.a.get_instance(),Aa.a.Gp(Na.a.instance.Sa("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),n.AFrameworkApplication.K,n.AFrameworkApplication.K.$("Box4ThrottleAndBatchPresenceRendering"),n.AFrameworkApplication.K.$("Box4DoNotRenderPresenceOutOfView"),Na.a.instance.resolve("WordEditor.Presence.IWordPresenceCpFactory"),Na.a.instance.resolve("Common.IPresenceStatusProvider"),
!eb.App.Fs&&!eb.App.Cm,eb.App.Xoa(),Na.a.instance.Sa("Common.ISessionExpirationManager"));k.ULS.sendTraceTag(23196878,302,50,"WordPresenceManager instance created");Ef.Bud.Dg(Ef._instance);Ef.mxc.Dg(Ef._instance);Ef.Ubh.Dg(Ef._instance);Ga=Na.a.instance;Ga.ia("WordEditor.Presence.WordPresenceManager",()=>Ef._instance).as("Common.IPresenceRemover").as("Common.IPresenceSender").ha();Ga.resolve("WordEditor.Presence.WordPresenceManager")}else k.ULS.sendTraceTag(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}static e2c(Ga){Ef._instance||
(k.ULS.sendTraceTag(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(Ga=Object(y.a)(13,Ga))&&Ga.qpb(Ef.e2c),Ef.init())}static MXi(){Ef._instance.tcg()}static Quk(Ga,kb,nc,Kb,ld){nc=ld.split(",");if(!nc||3!==nc.length)return 8;Ga=nc[0].trim();kb=nc[1].trim();nc=Number.parseInvariant(nc[2].trim());Ga=new Hi(new xb(Ga),new rh(kb,nc,-1));if(!Ef.mxc.task.isCompleted)return 8;kb=Ef.bE().result;kb.w_e(Ga);kb.hee();return 32}static D8f(Ga,kb,nc,Kb,ld){if(!Ef.mxc.task.isCompleted)return 8;
Ga=Ef.bE().result;Ga.f7c(ld);Ga.hee();return 32}static xyo(Ga,kb,nc,Kb,ld){if(!Ef.mxc.task.isCompleted)return 8;Ga=Ef.bE().result;if(!Ga)return 8;Ga.yje(ld);return 32}static m5f(Ga,kb,nc,Kb,ld){if(1===nc)return 32;if(!Ef.lra.bE().isCompleted)return 8;Ga=Ef.lra.bE().result;if(!Ga)return k.ULS.sendTraceTag(4301136,302,10,"rtcProxy is null when trying to display RTC connection status"),8;ld[Hd.a.Value]=2===Ga.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===Ga.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnecting:
"";return 32}}Ef._instance=null;Ef.pWg=!0;Ef.Bud=new x.a;Ef.mxc=new x.a;Ef.Ubh=new x.a;Ef.yH=null;Ef.ZAc=null;Ef.$N=null;Ef.lj=null;Object(l.a)(Ef,"WordPresenceManager",ee,[]);class vi{constructor(Ga){this.sa=new va.a;this.RZ=Ga;this.RZ.CWR(()=>this.RZ.result.uxk(()=>{this.sa.raiseEvent("X")}))}Azk(Ga){this.sa.addHandler("X",Ga)}T2n(Ga){this.sa.removeHandler("X",Ga)}getStatus(){return this.RZ.isCompleted&&this.RZ.result?this.RZ.result.pKd.toString():"0"}}Object(l.a)(vi,"WordPresenceStatusProvider",
null,[296]);class Ml{constructor(Ga,kb,nc,Kb){this.lj=null;this.hWg=this.pKe=!1;this.pun=()=>{this.o_.isCompleted&&this.o_.result?(this.lj=this.o_.result,this.lj.M_a(this.t5),k.ULS.sendTraceTag(5604372,302,50,"Presence Update Monitor is ready.")):k.ULS.sendTraceTag(5604373,302,15,"RtcTask did not complete successfully. No monitoring")};this.t5=(ld,Kc)=>{ld=Kc.asa;for(const ue in ld)if(Kc=ld[ue],!this.pKe&&Kc.user.xP&&Kc.user.xP!==this.q3.xP){k.ULS.sendTraceTag(5604375,302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",
this.q3.xP,Kc.user.xP);this.pKe=!0;break}this.pKe&&this.lj.hPb(this.t5);this.hWg||(k.ULS.sendTraceTag(5604374,302,50,"First presence received"),this.hWg=!0)};this.Vk=Ga;this.q3=kb;this.o_=nc;nc.continueWith(this.pun);this.Ybk=Kb;this.Ybk.$Mf=this.q3}}Object(l.a)(Ml,"WordPresenceUpdateMonitor",null,[]);var kk=c(416),am=c(1565),Wh=c(225),Wg=c(1898),jg=c(1899),Lh=c(1788);class je{constructor(Ga,kb,nc,Kb,ld,Kc,ue){this.sa=new va.a;this.P1g=this.I3g=this.uIe=this.r6g=!1;this.HXe=this.oAd=0;this.J1b=null;
this.MMa=Kc;this.MMa.clientId=Ga.clientId;this.Kl=Ga;this.oaa=kb;this.Maa=Kb;this.a4j=ld;this.Ib=nc;this.Kab=new Wh.a;this.Jp=ue;this.oaa&&this.oaa.continueWith(()=>{this.oaa.Ho||this.oaa.Gi||this.oaa.result.Lqh(Object(e.a)(this,this.ZTi,"onAmIAloneChanged"))})}get connectionState(){return this.Kl.connectionState}M_a(Ga){this.sa.addHandler("PU",Ga)}hPb(Ga){this.sa.removeHandler("PU",Ga)}Kua(Ga){this.sa.addHandler("CSC",Ga)}Ejc(Ga){this.sa.removeHandler("CSC",Ga)}rGc(Ga){this.sa.addHandler("PSU",Ga)}m7c(Ga){this.sa.removeHandler("PSU",
Ga)}ECd(Ga){this.sa.addHandler("PSC",Ga)}dee(Ga){this.sa.removeHandler("PSC",Ga)}Yjj(){}get clientId(){return this.Kl.clientId}V3(Ga){this.sa.addHandler("UN",Ga)}iPb(Ga){this.sa.removeHandler("UN",Ga)}zAm(){this.J1b=Array(12);for(let Ga=0;12>Ga;Ga++)this.J1b[Ga]=0;this.I3g=this.Jp?this.Jp.$("UpdateNotificationTaskExperimentIsEnabled"):!0;n.AFrameworkApplication.rI(()=>{this.W8m()})}init(){this.Kl.Kua(Object(e.a)(this,this.dja,"onConnectionStateChanged"));this.Kl.M_a(Object(e.a)(this,this.t5,"onPresenceUpdated"));
this.Kl.rGc(Object(e.a)(this,this.eTa,"onPersistentStateUpdated"));this.Kl.ECd(Object(e.a)(this,this.ihc,"onPersistentStateCleared"));this.Kl.V3(Object(e.a)(this,this.l1,"onUpdateNotificationReceived"));this.CIh();this.zAm()}Bde(Ga){this.Kab.contains(Ga,(kb,nc)=>kb===nc)||(this.Kab.add(Ga),2===this.connectionState&&Ga.start())}fpg(Ga){for(let kb=0;kb<this.Kab.length;kb++)if(this.Kab.J(kb)===Ga){this.Kab.AG(kb);break}}connect(){this.uIe||this.Kl.connect()}disconnect(){this.Kl.disconnect()}get sfe(){return this.Kl}fSh(Ga){return Hi.lDb(Ga)}Rcg(Ga,
kb){return(new Hi(Ga,kb)).Vuf()}Bcg(Ga){Ga&&Ga.isValid()&&!this.Maa()?this.Kl.Yjj(this.Rcg(this.MMa.a6l(),Ga)):I.Task.C4(null)}Rkc(Ga,kb){return this.Kl.Rkc(Ga,kb)}o9b(Ga){return this.Kl.o9b(Ga)}IPc(){return this.Kl.IPc()}qN(Ga,kb,nc=!1){return this.Kl.qN(Ga,kb,nc)}KFb(){return this.fMh(this.Kl.KFb())}Yrb(Ga){const kb=new x.a;Lh.a.getInstance().z7i(Ga,kb);return kb.task}get ASa(){return this.Kl.ASa}dja(Ga,kb){2===kb.newState&&this.Kab.forEach(nc=>{nc.start();return!0});kb.newState||this.Jp.$("SendRTCMessagesWhileDisconnectedIsEnabled")&&
!this.uIe||this.Kab.forEach(nc=>{nc.stop();return!0});this.sa.raiseEvent("CSC",kb)}Wlf(Ga){return Ga.toLowerCase()}t5(Ga,kb){if(!this.Maa()){Ga=this.fMh(kb.asa);kb=this.hMh(kb.ILd);var nc=new Ie.a(Ga,kb);kb=new wa.a(0,1,0,()=>{this.sa.raiseEvent("PU",nc)},57);this.Ib.Wb(kb)}}fMh(Ga){const kb={};for(const Kb in Ga){var nc=Kb;const ld=this.fSh(Ga[Kb]);ld&&ld.isValid()?kb[this.Wlf(nc)]=ld:k.ULS.sendTraceTag(562661590,302,50,"No Valid User {0}",nc)}return kb}hMh(Ga){const kb=Array(Ga.length);for(let nc=
0;nc<Ga.length;nc++)kb[nc]=this.Wlf(Ga[nc]);return kb}eTa(Ga,kb){if(!this.Maa()){var nc={};Ga=kb.asa;for(var Kb in Ga)nc[this.Wlf(Kb)]=Ga[Kb];Kb=new wa.a(0,1,0,()=>{this.sa.raiseEvent("PSU",new Wg.a(kb.type,nc))},80);this.Ib.Wb(Kb)}}ihc(Ga,kb){if(!this.Maa()){Ga=this.hMh(kb.SGd);var nc=new jg.a(Ga);Ga=new wa.a(0,1,0,()=>{this.sa.raiseEvent("PSC",nc)},81);this.Ib.Wb(Ga)}}l1(Ga,kb){this.I3g?this.KZi(kb):(Ga=new wa.a(0,1,0,()=>{this.KZi(kb)},58),this.Ib.Wb(Ga))}KZi(Ga){var kb=Date.now();this.sa.raiseEvent("UN",
Ga);kb=Date.now()-kb;500<=kb&&(this.oAd++,k.ULS.sendTraceTag(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",Ga.type,kb),this.NFl(Ga));this.HXe++}NFl(Ga){0>Ga.type||21<=Ga.type?k.ULS.sendTraceTag(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",Ga.type):this.J1b[Ga.type]++}W8m(){if(!this.P1g){var Ga={};Ga.TC=this.HXe;Ga.HRC=this.oAd;this.J1b&&0<this.oAd&&(Ga.TBC=this.J1b);this.oAd=this.HXe=0;this.J1b=null;k.ULS.sendTraceTag(42541603,
302,50,"UpdateNotificationHeuristics: {0}",Ga);this.P1g=!0}}dispose(){this.Kab=new Wh.a;this.Kl.Ejc(Object(e.a)(this,this.dja,"onConnectionStateChanged"));this.Kl.hPb(Object(e.a)(this,this.t5,"onPresenceUpdated"));this.Kl.m7c(Object(e.a)(this,this.eTa,"onPersistentStateUpdated"));this.Kl.dee(Object(e.a)(this,this.ihc,"onPersistentStateCleared"));this.Kl.iPb(Object(e.a)(this,this.l1,"onUpdateNotificationReceived"));this.oaa&&this.oaa.continueWith(()=>{this.oaa.Ho||this.oaa.Gi||this.oaa.result.S1n(Object(e.a)(this,
this.ZTi,"onAmIAloneChanged"))});this.Kl.disconnect();k.ULS.sendTraceTag(4564935,302,50,"Disposing of rtcProxyCompleted")}ZTi(){this.CIh()}CIh(){let Ga=!1;this.oaa?this.oaa.continueWith(()=>{this.oaa.Ho||this.oaa.Gi||(Ga=!this.oaa.result.amIAlone);this.Kl.connectionState||!Ga&&!this.a4j()?2!==this.Kl.connectionState||Ga||(this.disconnect(),k.ULS.sendTraceTag(4564937,302,50,"Disconnecting because there are no other users in the doc")):(this.connect(),k.ULS.sendTraceTag(4564936,302,15,"Connecting because there are other authors in the doc"));
!this.r6g&&Ga&&(k.ULS.sendTraceTag(4203466,302,50,"There are other real-time authors in this session"),this.r6g=!0)}):(this.connect(),k.ULS.sendTraceTag(589321547,302,50,"Connecting to rtc because Rtc Always On is enabled"))}mMc(){this.uIe=!0;this.disconnect();k.ULS.sendTraceTag(4564938,302,50,"DisconnectForever")}}Object(l.a)(je,"RtcProxy",null,[1381,10,1083,1382]);class oh extends je{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,Eg,wi){super(Ga,kb,nc,Kb,ld,Kc,wi);this.ega=null;this.XI=ue;this.ud=
Le;this.SMa=cf;this.SAc=Mf;this.tUe=Vg;this.LAb=Eg}get eK(){return this.ega||(this.ega=this.tUe())}dja(Ga,kb){2===kb.newState&&k.ULS.sendTraceTag(4315102,302,50,"RTC Connected");this.h_o();super.dja(Ga,kb)}h_o(){this.eK&&this.eK.pV("RtcConnectionStatusLabel")}fSh(Ga){return kd.zbf(ic(Ga),this.XI,this.ud,this.SMa,this.LAb)}Rcg(Ga,kb){return Object(el.a)(kc,kb)?(Ga=new kd(this.SAc.ndi(),Ga,kb),Ac(Ga.Vuf())):super.Rcg(Ga,kb)}}Object(l.a)(oh,"WordRtcProxy",je,[]);class Rd{constructor(Ga,kb,nc,Kb,ld,Kc,
ue,Le,cf,Mf,Vg,Eg,wi){this.jq=new x.a;this.dhh=!0;this.je=kb;this.Ib=nc;this.Maa=Kb;this.MMa=ld;this.XI=Kc;this.yua=ue;this.SMa=Le;this.SAc=cf;this.tUe=Mf;this.y3=Vg;this.LAb=Eg;this.Ca=wi}bE(){this.FPo();return this.jq.task}hRc(){return kk.a.then(this.bE(),Ga=>Ga)}FPo(){if(this.dhh)if(this.dhh=!1,eb.App.qIf()&&eb.App.pGf()){var Ga=n.AFrameworkApplication.He;if(Ga){Ga=am.RealtimeChannel.createInstance("{"+n.AFrameworkApplication.userSessionId+"}",n.AFrameworkApplication.userSessionId,n.AFrameworkApplication.Sgj,
Ga,this.y3,1,this.je,this.Ca.kb("RtcEndpointUrl"),void 0,void 0,null,this.Ca.$("FindSessionOnBootIsEnabled")?Na.a.instance.resolve("Common.IFindSessionUtils"):null,this.Ca.kb("RtcBootToken"));var kb=this.Ca.$("RtcAlwaysOnEnabled"),nc=new oh(Ga,kb?null:eb.App.Xoa(),this.Ib,this.Maa,Rd.eJl,this.MMa,this.XI,this.yua,this.SMa,this.SAc,this.tUe,this.LAb,n.AFrameworkApplication.K);eb.App.qno(nc);this.NXn(nc);nc.init();ok.App.L7a=nc;this.y3.execute(Kb=>{Kb.cfb(()=>{nc.mMc()})});this.jq.Dg(nc)}else k.ULS.sendTraceTag(8206365,
302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else k.ULS.sendTraceTag(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}NXn(Ga){const kb=Na.a.instance;kb.ia("WordEditor.Presence.WordRtcProxy",()=>Ga).as("Box4.Presence.IRtcProxy").as("Common.IRealtimeChannelBasic").ha();kb.resolve("Common.IRealtimeChannelBasic")}static eJl(){return!1}}Object(l.a)(Rd,"WordRtcProxyProvider",null,[286,287]);class Ii{constructor(){this.W=null;this.km=
!1}get name(){return"WordEditor.Presence"}init(){k.ULS.sendTraceTag(50995799,302,50,"PresencePackage Init");eb.App.YLj&&(this.W.resolve("WordEditor.Presence.WordRtcProxyProvider").bE(),Ef.init(),this.W.resolve("WordEditor.Presence.WordPresenceUpdateMonitor"));eb.App.aKc&&Fi.init();this.W.resolve("Common.App.Presence.AwayManager");this.W.resolve("Common.IPeopleInfoProvider");if(Ii.C1g){const Ga=this.W.resolve("WordEditor.IMainViewModeManager");Ga.fBb(this.DZf);Ii.bHe=1===Ga.ou}}dispose(){if(!this.km){this.km=
!0;Ef.bE().continueWith(()=>{Qd.a.jC(Ef.bE().result)});var Ga=this.W.resolve("Box4.Presence.MyPresenceUser");Ga&&Ga.Hic&&Ga.Hic.T2n(Ef.MXi)}}wc(Ga){this.W=Ga;this.W.ia("Box4.Presence.MyPresenceUser",()=>new zb).as("Box4.Presence.IMyPresenceUser").as("Common.IPresenceUser").as("Common.IPresenceConverter").ha();Ga.ia("WordEditor.Presence.IWordPresenceCpFactory",()=>new rj(Ga.resolve("Box4.CpConversionManagerImpl"),Ga.resolve("Box4.IContentControlReader"))).ha();Ga.ia("WordEditor.Presence.WordPresenceUpdateMonitor",
()=>new Ml(new X.a(()=>eb.App.zd),sf.a.instance,Ga.resolve("WordEditor.Presence.WordRtcProxyProvider").hRc(),Ga.resolve("Box4.Presence.IMyPresenceUser"))).ha();Ga.ia("WordEditor.Presence.WordRtcProxyProvider",()=>new Rd(n.AFrameworkApplication.buildVersion,Lb.StaticActiveAppFrame.za().Kq,vb.a.instance,()=>n.AFrameworkApplication.Qk,Na.a.instance.resolve("Box4.Presence.IMyPresenceUser"),Na.a.instance.Oa("WordEditor.ParagraphWordIdMapping"),Na.a.instance.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),
()=>n.AFrameworkApplication.ta&&Lb.StaticActiveAppFrame.za().jb&&Lb.StaticActiveAppFrame.za().jb.Zc?Lb.StaticActiveAppFrame.za().jb.Zc.xd:null,pj.instance,()=>Na.a.instance.Oa("WordEditor.IStatusBarUser"),Na.a.instance.Sa("Common.ISessionExpirationManager"),Na.a.instance.resolve("WordEditor.Presence.IWordPresenceCpFactory"),n.AFrameworkApplication.K)).ha().as("Box4.Presence.IRtcProxyProvider").as("Common.Interface.IRtcBasicProvider");Ga.ia("Box4.Presence.PresenceControlProvider",()=>new Uh(Ii.ggl(),
Gd.a.instance,Na.a.instance.Sa("Common.IZoomManager"),Na.a.instance.resolve("Box4.ICoauthCashTelemetry"),Aa.a.Gp(Na.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),n.AFrameworkApplication.K,Ga.resolve("Common.IPeopleInfoProvider"))).ha();Ga.ia("Common.App.Presence.AwayManager",()=>new of(Na.a.instance.resolve("Common.IPresenceUser"),Na.a.instance.resolve("WordEditor.Presence.WordRtcProxyProvider").hRc(),Ef.mam(),Na.a.instance.resolve("Common.IPresenceConverter"),vb.a.instance,n.AFrameworkApplication.K.$("AwayStatusOneMinuteTimeoutIsEnabled")?
6E4:n.AFrameworkApplication.K.nc("AwayCoauthorThresholdMs",9E5),Object(e.a)(n.AFrameworkApplication.va,n.AFrameworkApplication.va.processAction,"processAction"),Lb.StaticActiveAppFrame.za().notificationBar,n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"))).ha();Ga.ia("WordEditor.Presence.WordPresenceStatusProvider",()=>new vi(Aa.a.Gp(Na.a.instance.Sa("Common.ICurrentPageCalculator")))).as("Common.IPresenceStatusProvider").ha();Ga.ia("Common.App.Presence.PeopleInfoProvider",()=>new Dh(Ga.resolve("WordEditor.Presence.WordRtcProxyProvider").hRc(),
eb.App.Xoa().CWR(()=>eb.App.Xoa().result.mC),Ga.resolve("Common.App.People.IPeopleColorUtils"),Ga.resolve("Common.IPresenceConverter"),Aa.a.Gp(Ga.Sa("Common.App.Presence.AwayManager")))).as("Common.IPeopleInfoProvider").ha();Ga.ia("Box4.Presence.WordPresenceDataManager",()=>new Xn(Lb.StaticActiveAppFrame.za().jb.Zc.xd)).as("Box4.IPresenceDataManager").ha()}DZf(Ga,kb){Lb.StaticActiveAppFrame.za()&&Lb.StaticActiveAppFrame.za().RF&&(Ii.wtd=null,Ii.bHe=1===kb.rnb)}static get K_i(){if(!Ii.wtd&&Lb.StaticActiveAppFrame.za()&&
Lb.StaticActiveAppFrame.za().RF){const Ga=ok.App.pn.RF;Ii.wtd=Ii.bHe&&Ii.C1g?Ga.getElementsByClassName("PaginatedContentContainerDisplayWrapper")[0]:Ga.getElementsByClassName("OutlineContainerDisplayWrapper")[0]}return Ii.wtd}static ggl(){const Ga=n.AFrameworkApplication.K.$("PeoplesWellExtraButtonInfoIsEnabled"),kb=n.AFrameworkApplication.K.$("PresenceIgnoreEventOnExpandedTooltip"),nc=n.AFrameworkApplication.K.$("PresenceIpWidthAdjustForFlyout"),Kb=new xh;Kb.add(lg.multipleBrowsersImageClassName,
ad.getImageClassWithCluster(n.AFrameworkApplication.Pca,"MoreUsersGlyph16"));Kb.add(lg.multipleBrowserImageClusterPath,n.AFrameworkApplication.Ms);Kb.add(lg.peopleImageClassName,ad.getImageClassWithCluster(n.AFrameworkApplication.Pca,Ga?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));Kb.add(lg.peopleImageClusterPath,n.AFrameworkApplication.Ms);Kb.add(lg.zIndex,1);Kb.add(lg.rtl,n.AFrameworkApplication.isRtl);Kb.add(lg.viewportBoundsCallback,Ii.flm);Kb.add(lg.ignoreEventOnExpandedTooltip,
kb);Kb.add(lg.ipWidthAdjustForFlyout,nc);return Ga?new tg(Kb):new Tj(Kb)}static flm(){return Ii.K_i?Rg.a.getElementBounds(Ii.K_i):null}}Ii.bHe=!0;Ii.C1g=n.AFrameworkApplication.K.$("FlippedFlyoutForPaginationViewIsEnabled");Ii.wtd=null;Object(l.a)(Ii,"WordPresencePackage",null,[1,2]);var Lf=c(1064),ag=c(1425),xn=c(1070),Zj=c(192);class dk{constructor(Ga,kb){this.x_e=Ga;this.paragraphId=kb}get opType(){return 2}get operation(){return this.x_e}}Object(l.a)(dk,"RttAppliedAddParagraphOp",null,[288]);
class Qe{constructor(Ga,kb){this.Y4n=Ga;this.paragraphId=kb}get opType(){return 6}get operation(){return this.Y4n}}Object(l.a)(Qe,"RttAppliedReplaceSymbolRangeOp",null,[288]);class pk{constructor(Ga,kb){this.b5n=Ga;this.paragraphId=kb}get opType(){return 1}get operation(){return this.b5n}}Object(l.a)(pk,"RttAppliedReplaceTextRangeOp",null,[288]);class io{constructor(Ga,kb,nc){this.yvj=Ga;this.cke=kb;this.hLc=nc}get opType(){return 4}get operation(){return this.yvj}get aqk(){return this.yvj.a6b()?
this.hLc:this.cke}}Object(l.a)(io,"RttAppliedSplitParagraphOp",null,[288]);class Oh{constructor(){this.E$a=new hc.a}YJf(Ga){return Ga.toString()}VFc(Ga,kb){Ga=this.YJf(Ga);this.E$a.nb(Ga)||this.E$a.Z(Ga,new S.a);this.E$a.J(Ga).add(kb)}gYf(Ga){switch(Ga.opType){case 1:var kb=Object(y.a)(pk,Ga);this.VFc(kb.paragraphId,Ga);break;case 6:kb=Object(y.a)(Qe,Ga);this.VFc(kb.paragraphId,Ga);break;case 4:kb=Object(y.a)(io,Ga);this.VFc(kb.cke,Ga);this.VFc(kb.hLc,Ga);break;case 2:kb=Object(y.a)(dk,Ga),this.VFc(kb.paragraphId,
Ga)}}Lpn(Ga){return this.Onb(Ga)}Onb(Ga){Ga=this.YJf(Ga);if(!this.E$a.nb(Ga))return new S.a;const kb=this.E$a.J(Ga);this.E$a.remove(Ga);for(const nc of kb)nc.operation&&(nc.operation.a8=null);return kb}X7l(Ga){let kb;return({value:kb}=this.E$a.Fc(this.YJf(Ga),kb)).returnValue?kb:new S.a}eNl(Ga){for(const kb of this.E$a.values){if(!kb.count)continue;if(2!==kb.J(0).opType)continue;const nc=kb.J(0);if(nc.x_e.OTf===Ga)return nc}return null}}Object(l.a)(Oh,"RttAppliedOpTracker",null,[271]);var Zg=c(251),
yg;(function(Ga){Ga[Ga.sAl=0]="expired";Ga[Ga.Aip=1]="dried"})(yg||(yg={}));Object(l.b)("RemoveChangeReason",yg);class Nn{constructor(){this.EAa=new Zg.a}Qrk(Ga){if(!Ga)return k.ULS.sendTraceTag(7685333,355,15,"Cannot add a null change to RTTStore"),!1;const kb=Ga.Wc,nc=Ga.uj;this.EAa.nb(kb)||this.EAa.add(kb,new Zg.a);this.EAa.J(kb).Z(nc,Ga);return this.kil(kb,nc)?(k.ULS.sendTraceTag(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",kb),this.EAa.J(kb).remove(nc),
!1):!0}etf(Ga,kb){if(!this.EAa.nb(Ga))return null;Ga=this.EAa.J(Ga);return Ga.nb(kb)?Ga.J(kb):null}zTd(Ga){const kb=new S.a;for(const nc of this.EAa.keys){const Kb=this.EAa.J(nc);for(const ld of Kb.keys){const Kc=Kb.J(ld);Ga(Kc)&&kb.add(Kc)}}return kb}$aj(Ga,kb){let nc=null;({value:nc}=this.EAa.Fc(Ga.Wc,nc)).returnValue?(Ga.activity.gWf(yg[kb]),nc.remove(Ga.uj),nc.count||this.EAa.remove(Ga.Wc)):k.ULS.sendTraceTag(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",
Ga.Wc,kb)}j8f(Ga){this.$aj(Ga,1)}m8f(Ga){this.$aj(Ga,0)}kil(Ga,kb){if(!this.EAa.nb(Ga))return!1;Ga=this.EAa.J(Ga);if(!Ga.nb(kb))return!1;for(var nc=Ga.J(kb);nc;){nc=nc.V1;if(nc===kb)return!0;if(!Ga.nb(nc))break;nc=Ga.J(nc)}return!1}}Object(l.a)(Nn,"RttDataStore",null,[269,270]);var rf=c(291),ge=c(91),bh=c(277),lj=c(312),ol=c(16);class Pf{constructor(Ga,kb){this.K7d=(nc,Kb)=>{4===this.Lp.opType?k.ULS.shipAssertTag(9204866,355,12===Kb.node.type||11===Kb.node.type,"Unexpected graph modification detected during RTT edit"):
k.ULS.shipAssertTag(9204867,355,!1,"Unexpected graph modification detected during RTT edit")};this.Onb=()=>{k.ULS.shipAssertTag(9204868,355,!1,"Unexpected graph modification detected during RTT edit")};this.XVi=()=>{k.ULS.shipAssertTag(9204869,355,!1,"Unexpected graph modification detected during RTT edit")};this.Lp=Ga;if(this.wq=kb)Ga=this.wq.Te(12),Ga.ku(this.K7d),Ga.kw(this.Onb),Ga.qo(this.XVi)}dispose(){if(this.wq){const Ga=this.wq.Te(12);Ga.xV(this.K7d);Ga.bea(this.Onb);Ga.UP(this.XVi)}}}Object(l.a)(Pf,
"GraphChangeValidator",null,[10]);class zi{constructor(Ga,kb,nc,Kb){this.id=Ga;this.cpBegin=kb;this.cpEnd=nc;this.zVk=Kb}R2o(Ga){var kb=this.id===Ga.id;kb&&(kb=this.zVk.replace("\u00a0"," "),Ga=Ga.characterData.substr(this.cpBegin,this.cpEnd-this.cpBegin).replace("\u00a0"," "),kb=kb===Ga);return kb}}Object(l.a)(zi,"RttOpValidator",null,[306]);class $e{constructor(Ga,kb){this.a8=this.xpc=this.activity=null;this.opType=Ga;this.metadata=kb}Vvf(){return""}serialize(){return null}}Object(l.a)($e,"RttOp",
null,[285]);class qn extends $e{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf){super(cf,Le);this.Wc=Ga;this.uj=kb;this.cS=nc;this.n5=Kb;this.V1=ld;this.urb=Kc;this.TH=ue}fOh(){return this.cS.isEqual(this.n5,!0)?new le.a(0,this.Wc,this.uj,this.cS,void 0,void 0,void 0,this.TH):new le.a(1,this.Wc,this.uj,this.cS,this.Wc,this.uj,this.n5,this.TH)}static ECj(Ga){let kb,nc;var Kb=Ga.RT;if(1===Kb.bde&&(Kb.nTa!==Kb.ZHa||Kb.V8a!==Kb.Enc))return k.ULS.sendTraceTag(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),
nc=kb=null,Ga=Kb=-1,{returnValue:!1,cS:nc,n5:kb,Wc:Ga,uj:Kb};if(Kb.TH)return nc=kb=null,Ga=Kb=-1,{returnValue:!1,cS:nc,n5:kb,Wc:Ga,uj:Kb};kb=nc=Kb.cS;1===Kb.bde&&(kb=Kb.n5);Ga=Kb.nTa;Kb=Kb.V8a;return{returnValue:!0,cS:nc,n5:kb,Wc:Ga,uj:Kb}}}Object(l.a)(qn,"RttReplaceRangeOp",$e,[]);var fl=c(1423),Qj=c(463),rm=c(1038),Ai=c(594),qk=c(532);class pe extends Ai.a{constructor(){super();this.RttStatusRecords=this.FileId=null}ml(){return qk.a.rttStatusReplicator}static Uba(Ga,kb){const nc=new pe;nc.FileId=
Ga;nc.RttStatusRecords=kb;return nc}}Object(l.a)(pe,"RttStatusRequest",Ai.a,[]);class hb{}Object(l.a)(hb,"RttStatusOp",null,[]);class Ib{constructor(){this.contentState=this.contentType=this.timeToRender=this.strictlySequentialId=this.packetVersion=this.clientType=this.clientId=this.packetId=null}}Object(l.a)(Ib,"WireRttStatusOpRecord",null,[]);class gc extends Qj.a{constructor(){super();const {App:Ga}=c(172);this.U_b=new S.a;this.IRe=new S.a;this.yk=new fl.a(n.AFrameworkApplication.K.nc("WordEditorRttStatusReplicatorIntervalMs",
6E4));this.enabled=1;Ga.W1.register(this)}jSj(){const Ga=Date.now();for(const kb of this.U_b)kb.aNb&&1===kb.aNb&&(kb.aNb=2,kb.timeToRender=Ga-kb.metadata.Omg)}Kqe(Ga){const kb=new hb;kb.metadata=Ga.operation.metadata;kb.opType=Ga.opType;kb.aNb=1;this.U_b.add(kb)}get Yia(){return"RttStatusReplicator"}Jca(){return this.he&&this.he.status===rm.a.responseReady?!0:1===this.enabled&&this.yk.w0()?this.dE():!1}dE(){for(const Ga of this.U_b)if(Ga.aNb&&2===Ga.aNb)return!0;return!1}bUa(){if(1===this._state){this._state=
3;const kb=this.U_b.toArray().filter(nc=>2===nc.aNb);var Ga=this.cal(kb);Ga=pe.Uba(n.AFrameworkApplication.rootQuerySignature,Ga);kb.forEach(nc=>this.U_b.remove(nc));kb.forEach(nc=>this.IRe.add(nc));this.he.Iq=Ga;this.he.aH="RttStatusRequest";this.he.status=rm.a.requestReady}else 3===this._state&&this.he&&this.he.status===rm.a.responseReady&&(this.yk.i2(),2!==this.he.statusCode&&this.U_b.$C(0,this.IRe),this.IRe.clear(),this._state=1)}cal(Ga){const kb=[];Ga.forEach(nc=>{const Kb=new Ib;Kb.clientId=
nc.metadata.clientId;Kb.clientType=nc.metadata.clientType;Kb.packetId=nc.metadata.packetId;Kb.packetVersion=nc.metadata.packetVersion;Kb.strictlySequentialId=nc.metadata.strictlySequentialId;Kb.contentType=nc.opType;Kb.contentState=nc.aNb;Kb.timeToRender=nc.timeToRender;kb.push(Kb)});return kb}Ulc(){return!0}kF(){}forceOutbound(){}}Object(l.a)(gc,"RttStatusReplicator",Qj.a,[]);class Lc{constructor(Ga,kb,nc,Kb,ld,Kc){this.packetId=Ga;this.clientId=kb;this.clientType=nc;this.Omg=Kb;this.packetVersion=
ld;this.strictlySequentialId=Kc}static create(Ga){let kb=null;null!=Ga.strictlySequentialId&&(kb=Ga.strictlySequentialId);return new Lc(Ga.packetId,Ga.clientId,Ga.client,Date.now(),Ga.version,kb)}}Object(l.a)(Lc,"RttOpMetadata",null,[]);class Rc extends $e{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf){super(4,cf);this.V1=0;this.Wc=Ga;this.uj=kb;this.offset=nc;this.TH=Kb;this.Rsg=ld;this.tmg=Kc;this.kqe=ue;this.umg=Le;this.Rsg===this.Wc?this.V1=this.tmg:this.kqe===this.Wc?this.V1=this.umg:(k.ULS.sendTraceTag(8397766,
355,10,"Bad data passed to RttSplitParagraphOp"),this.V1=0)}a6b(){return this.Wc===this.kqe}get dKo(){return this.V1}get r6o(){return this.a6b()?this.Rsg:this.kqe}get szj(){return this.a6b()?this.tmg:this.umg}serialize(){const Ga=new le.a(3,this.Wc,this.uj,this.offset,null,null,null,this.TH),kb=new Ab(this.Rsg,this.tmg,this.kqe,this.umg);return new $b(this.metadata.packetId,this.metadata.clientId,1,4,Ga,null,void 0,void 0,void 0,void 0,kb,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){const kb=
Ga.RT,nc=Ga.yRb;return new Rc(kb.nTa,kb.V8a,kb.cS,kb.TH,nc.P_f,nc.smg,nc.Q_f,nc.vmg,Lc.create(Ga))}static jdm(Ga,kb,nc){if(1!==Ga.type)return null;const Kb=nc.pTa(Ga.o5.characterData,Ga.o5.ra);return new Rc(Ga.o5.Wc,Ga.o5.uj,nc.Qpc(Kb,Ga.kvj),Ga.TH,Ga.OAb.Wc,Ga.OAb.uj,Ga.wHc.Wc,Ga.wHc.uj,kb)}}Object(l.a)(Rc,"RttSplitParagraphOp",$e,[266,285]);class qd{constructor(Ga,kb,nc,Kb){this.Iln=()=>{this.ezb.jSj()};this.jla=Ga;this.nAc=kb;this.Pla=nc;this.Wzb=Kb;null!=n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRttStatusReplicatorIsEnabled",
!1)&&(this.ezb=new gc,rf.GraphTransactionManager.instance.Kqh(this.Iln))}ZFk(Ga,kb,nc,Kb=null){if(kb.isDirty)return Kb&&Kb.properties.Z(qd.S0i,"1"),!1;const ld=new Pf(Ga,kb.yj);try{if(1===Ga.opType||6===Ga.opType){const Le=Object(y.a)(qn,Ga),cf=this.I6k(Le,kb);var Kc=cf.node.characterData;const Mf=10<=cf.cpBegin?cf.cpBegin-10:0;let Vg=cf.cpEnd+10<=Kc.length?cf.cpEnd+10:Kc.length;const Eg=Kc.substr(Mf,cf.cpBegin-Mf),wi=Kc.substr(cf.cpEnd,Vg-cf.cpEnd);Vg=Vg+Le.urb.length-(cf.cpEnd-cf.cpBegin);var ue=
new zi(cf.node.id,Mf,Vg,Eg+Le.urb+wi);const sm=6===Le.opType;Kc="";sm&&(Kc=Le.font);if(!this.J4n(cf,Le.urb,sm,Kc,Kb))return!1;let sh;sh=1===Ga.opType?new pk(Le,kb.id):new Qe(Le,kb.id);kb.hoa=Ga.V1;Le.xpc=ue;Ga.a8=sh;nc.gYf(sh);null!=this.ezb&&this.ezb.Kqe(sh)}else return 4===Ga.opType?this.YFk(Ga,kb,nc):!1}finally{ld&&ld.dispose()}return!0}YFk(Ga,kb,nc){const Kb=Object(y.a)(Rc,Ga);var ld=this.Wzb.pTa(kb.characterData,kb.ra);ld=this.Wzb.gDb(ld,Kb.offset);if(!this.KCi(Rb.a.createTextRange(kb,0,rc.ParagraphReader.textLength(kb))))return!1;
var Kc=Bg.GraphIterator.eb(kb);Kc.zb(10);if(this.D0d(Kc))return!1;let ue;Kc=this.Pla.Pc(3);try{Kc.Db(kb);const Le=kb.uZ();try{const cf=Bg.GraphIterator.eb(kb);cf.zb(10);cf.jd(11);let Mf=cf.currentNode;Kb.a6b()&&(cf.uFf?Mf=null:(cf.FJ(),Mf=cf.currentNode));cf.sc();const Vg=this.nAc.Tgb();cf.aI(Vg,Mf,89);cf.Bj(Vg);ue=kb.clone();const Eg=ue.uZ();try{ue.setValue(ah.a.Wc,Kb.r6o);ue.setValue(ah.a.uj,Kb.szj);ue.isDirty=!1;cf.Bf(ue,2);cf.Bj(ue);this.E8k(kb,ue);const wi=Kb.a6b()?ue:kb,sm=Kb.a6b()?kb:ue;wi.AO=
!0;sm.AO=!0;this.jla.U9f(this.pEa(wi,ld,rc.ParagraphReader.textLength(wi)),"",!1,"");this.jla.U9f(this.pEa(sm,0,ld),"",!1,"");kb.hoa=Kb.dKo;ue.hoa=Kb.szj}finally{Eg&&Eg.dispose()}}finally{Le&&Le.dispose()}Kc.wUa()}finally{Kc&&Kc.dispose()}kb=new io(Kb,kb.id,ue.id);Ga.a8=kb;nc.gYf(kb);null!=this.ezb&&this.ezb.Kqe(kb);return!0}D0d(Ga){const kb=new Bg.GraphIterator;kb.kd(Ga);kb.jd(11);return ge.ListItemReader.lg(kb)?(k.ULS.sendTraceTag(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}SEl(Ga,
kb,nc){var Kb=kb.Ajb(Ga.Wc);if(Kb.equals(wd.a.nil))return null;Kb=nc.Eb(Kb);if(!Kb||!rc.ParagraphReader.Xb(Kb)||!Kb.isConnected)return null;const ld=Bg.GraphIterator.eb(Kb);if(!ld.zb(23))return null;if(Ga.Qsg){Ga=kb.Ajb(Ga.Qsg);if(Ga.equals(wd.a.nil))return null;nc=nc.Eb(Ga);if(!nc||!rc.ParagraphReader.Xb(nc)||!nc.isConnected)return null;nc=Bg.GraphIterator.eb(nc);if(!nc.zb(23))return null;nc.jd(11);nc.FJ();nc.Rd();if(nc.currentNode!==Kb)return null}return this.D0d(ld)?null:ld}yPo(Ga,kb,nc,Kb){const ld=
kb.currentNode,Kc=this.Pla.Pc(3);try{Kc.Db(ld);kb.jd(11);const ue=kb.currentNode;kb.sc();const Le=this.nAc.Tgb();kb.aI(Le,ue,89);kb.Bj(Le);const cf=bh.a.instance.createInstance(393230),Mf=cf.uZ();try{cf.setValue(ol.a.ho,""),cf.KGa=!0,Kb.cPb(cf),Kb=[0],cf.setValue(ah.a.uq,Kb),cf.setValue(ah.a.ot,Kb),cf.KGa=!1,cf.setValue(ah.a.Wc,Ga.OTf),cf.setValue(ah.a.uj,Ga.NTf),cf.isDirty=!1,kb.Bf(cf,2),cf.AO=!0,cf.hoa=Ga.NTf}finally{Mf&&Mf.dispose()}Kc.wUa();Ga.a8=new dk(Ga,cf.id);nc.gYf(Ga.a8);null!=this.ezb&&
this.ezb.Kqe(Ga.a8)}finally{Kc&&Kc.dispose()}return!0}pEa(Ga,kb,nc){return kb===nc?Rb.a.Uc(Ga,kb):Rb.a.createTextRange(Ga,kb,nc)}J4n(Ga,kb,nc,Kb,ld=null){const Kc=Ga.node;if(Ga.cpBegin!==Ga.cpEnd&&!this.KCi(Ga))return ld&&ld.properties.Z(qd.HEj,"1"),!1;ld=this.Pla.Pc(3);try{ld.Db(Kc);const ue=Kc.uZ();try{Kc.AO=!0,this.jla.U9f(Ga,kb,nc,Kb)}finally{ue&&ue.dispose()}ld.wUa()}finally{ld&&ld.dispose()}return!0}E8k(Ga,kb){kb.KGa=!0;kb.sra(Ga.characterData);kb.hoa=Ga.hoa;kb.ra.clear();for(var nc=0;nc<Ga.ra.length;nc++){const Kb=
Ga.ra.J(nc).wna(kb);kb.ra.add(Kb)}kb.Xl();if(kb.xe.length)for(Ga=0;Ga<kb.ra.length;Ga++){if((nc=kb.ra.J(Ga).formatting)&&-1!==nc.pe)for(;kb.xe.length<=nc.pe;)kb.xe.xY(kb.xe.length-1,256)}else k.ULS.sendTraceTag(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");kb.KGa=!1}wJf(Ga){Ga=Bg.GraphIterator.eb(Ga);Ga.zb(23);Ga.sc();return{returnValue:89===Ga.role,iterator:Ga}}V8f(Ga){const kb=new Bg.GraphIterator;kb.kd(Ga);kb.sc();const nc=this.Pla.Pc(3);try{nc.Db(kb.currentNode),
Ga.tg()}finally{nc&&nc.dispose()}}f_n(Ga){if(Ga.anchor)if(({iterator:kb}=this.wJf(Ga)).returnValue)this.V8f(kb);else{var kb=Ga.Mc.zm;var nc=this.Pla.Pc(3);try{nc.Db(Ga),Ga.load(Object(lj.a)(kb).Eb(Ga.id)),Ga.anchor.yY(4)}finally{nc&&nc.dispose()}}}sag(Ga,kb,nc){for(let Kc=kb.count-1;0<=Kc;Kc--){var Kb=kb.J(Kc);switch(Kb.opType){case 4:Kb=Object(y.a)(io,Kb);if(!Ga.id.equals(Kb.cke)){k.ULS.shipAssertTag(9204885,355,Ga.id.equals(Kb.hLc));continue}Kb=nc.Eb(Kb.hLc);if(!Kb)break;if(!Kb||!rc.ParagraphReader.Xb(Kb)){k.ULS.shipAssertTag(9204886,
355,!1);break}if(!Kb.isConnected)continue;var ld=({iterator:Kb}=this.wJf(Kb)).returnValue;k.ULS.shipAssertTag(9204887,355,ld);ld&&this.V8f(Kb);break;case 2:(Kb=Object(y.a)(dk,Kb),Ga.id.equals(Kb.paragraphId))?Ga.isConnected&&(ld=({iterator:Kb}=this.wJf(Ga)).returnValue,k.ULS.shipAssertTag(16820002,355,ld),ld&&this.V8f(Kb)):k.ULS.shipAssertTag(16820001,355,!1)}}}I6k(Ga,kb){const nc=this.Wzb.pTa(kb.characterData,kb.ra),Kb=this.Wzb.gDb(nc,Ga.cS);Ga=this.Wzb.gDb(nc,Ga.n5);return Kb===Ga?Rb.a.Uc(kb,Kb):
Rb.a.createTextRange(kb,Kb,Ga)}KCi(Ga){const kb=Ga.node.ra,nc=Ga.cpBegin;Ga=Ga.cpEnd;for(let Kb=0;Kb<kb.length;Kb++){const ld=kb.J(Kb);if(ld.cp>=Ga)break;if(ld.cp>=nc){if(ld.Ue)return k.ULS.sendTraceTag(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(ld.blob)return k.ULS.sendTraceTag(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(ld.Hc||ld.XRa||ld.Pcc)return k.ULS.sendTraceTag(8242649,355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}}
qd.S0i="ParagraphAlreadyDirty";qd.HEj="UnsafeWetChange";Object(l.a)(qd,"RttEditor",null,[268]);var Ld=c(20),zd=c(1470),pf=c(256);class Jc{constructor(){this.Ogd=new S.a}add(Ga){this.Ogd.add(Ga);return!0}zTd(Ga){const kb=new S.a;for(const nc of this.Ogd)Ga(nc)&&kb.add(nc);return kb}j8f(Ga){Ga.activity.gWf("dried");this.Ogd.remove(Ga)}m8f(Ga){Ga.activity.gWf("expired");this.Ogd.remove(Ga)}}Object(l.a)(Jc,"RttAddParagraphDataStore",null,[]);class gg extends $e{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le){super(2,
Le);this.Wc=Ga;this.uj=kb;this.V1=nc;this.Qsg=Kb;this.OTf=ld;this.NTf=Kc;this.TH=ue}serialize(){const Ga=new le.a(2,this.Wc,this.uj,null,this.Qsg,null,null,this.TH),kb=new tb(this.V1,this.OTf,this.NTf);return new $b(this.metadata.packetId,this.metadata.clientId,1,3,Ga,null,void 0,void 0,kb,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){const kb=Ga.RT,nc=Ga.E2b;let Kb=null;null!=Ga.RT.ZHa&&(Kb=Ga.RT.ZHa);return new gg(kb.nTa,kb.V8a,nc.wmg,Kb,nc.S_f,nc.V1,kb.TH,Lc.create(Ga))}static fdm(Ga,
kb){return 3!==Ga.type?null:new gg(Ga.vqa.Wc,Ga.vqa.uj,Ga.mhn.uj,Ga.USa?Ga.USa.Wc:null,Ga.pya.Wc,Ga.pya.uj,Ga.TH,kb)}}Object(l.a)(gg,"RttAddParagraphOp",$e,[]);class dc{constructor(Ga){this.YV=Ga}O8i(){this.YV&&this.YV.properties.Z(dc.YZh,"1")}LRn(Ga){this.YV&&(this.YV.properties.nb(dc.fRf)||this.YV.properties.Z(dc.fRf,(Ga-this.YV.startTime).toString()))}gWf(Ga){this.YV&&(this.YV.properties.Z(dc.ycj,Ga),this.YV.end())}lTn(Ga){this.YV&&this.YV.properties.Z(dc.$_i,Ga.toString())}kTn(Ga){this.YV&&this.YV.properties.Z(dc.x_i,
Ga)}static FBf(Ga){Ga.L5(yh.a.MPb,dc.YZh,zd.a.Bxj);Ga.L5(yh.a.MPb,dc.IBl,zd.a.Bxj);Ga.L5(yh.a.MPb,dc.fRf,zd.a.LJk);Ga.L5(yh.a.MPb,dc.ycj,zd.a.Bva);Ga.L5(yh.a.MPb,dc.$_i,zd.a.Bva);Ga.L5(yh.a.MPb,dc.x_i,zd.a.Bva)}static create(Ga){if(!Ga)return null;Ga=Ga.Fp(yh.a.MPb,dc.h5o);return new dc(Ga)}}dc.YZh="FailedToFindInitialParaID";dc.IBl="FailedToFindInitialTextID";dc.fRf="MsecUntilApplied";dc.ycj="RemovedBecause";dc.$_i="PacketVersions";dc.x_i="OperationType";dc.h5o=48E4;Object(l.a)(dc,"RttOpActivity",
null,[]);var ng;(function(Ga){Ga[Ga.unknown=0]="unknown";Ga[Ga.brp=1]="replaceTextRangeOp";Ga[Ga.kfp=2]="addParagraphOp";Ga[Ga.Vhp=3]="deleteParagraphOp";Ga[Ga.Otp=4]="splitParagraphOp";Ga[Ga.Nnp=5]="mergeParagraphOp";Ga[Ga.arp=6]="replaceSymbolRangeOp"})(ng||(ng={}));Object(l.b)("RttOpType",ng);var Sd=c(124);class rk extends qn{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg){super(Kb,ld,Kc,ue,Le,cf,Mf,Vg,6);this.font=Ga;this.legacy=kb}Vvf(){return"OffsetStart: "+this.cS+"OffsetEnd: "+this.n5}serialize(){const Ga=
this.fOh();return new $b(this.metadata.packetId,this.metadata.clientId,1,7,Ga,null,this.V1,this.urb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){let kb,nc,Kb,ld;if(!({cS:kb,n5:nc,Wc:Kb,uj:ld}=qn.ECj(Ga)).returnValue)return null;let Kc,ue;if(1===Ga.text.length)Kc=!1,ue=Sd.AParagraphNode.QC;else if(2===Ga.text.length)if(Ob.a.dzi(Ga.text,0)&&Ob.a.Lz(Ga.text,1))Kc=!0,ue=Ga.text;else return k.ULS.sendTraceTag(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",
Ga.nt),null;else return k.ULS.sendTraceTag(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",Ga.nt),null;const Le=Ga.Dbd,cf=Lc.create(Ga);return new rk(Le.Vkg,Le.Wkg,Kc,Kb,ld,kb,nc,Ga.fSb,ue,Ga.RT.TH,cf)}}Object(l.a)(rk,"RttReplaceSymbolRangeOp",qn,[266,285]);class Yi extends qn{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le){super(Ga,kb,nc,Kb,ld,Kc,ue,Le,1)}Vvf(){return"OffsetStart: "+this.cS+"OffsetEnd: "+this.n5+"TextAddedLength: "+this.urb.length}serialize(){const Ga=
this.fOh();return new $b(this.metadata.packetId,this.metadata.clientId,1,2,Ga,null,this.V1,this.urb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){let kb,nc,Kb,ld;if(!({cS:kb,n5:nc,Wc:Kb,uj:ld}=qn.ECj(Ga)).returnValue)return null;let Kc="";Ga.text&&(Kc=Ga.text);const ue=Lc.create(Ga);return new Yi(Kb,ld,kb,nc,Ga.fSb,Kc,Ga.RT.TH,ue)}static fcm(Ga,kb,nc){if(Ga.type)return null;const Kb=nc.pTa(Ga.o5.characterData,Ga.o5.ra);return new Yi(Ga.o5.Wc,Ga.o5.uj,nc.Qpc(Kb,
Ga.cpBegin),nc.Qpc(Kb,Ga.cpEnd),Ga.pya.uj,Ga.T9,Ga.TH,kb)}}Object(l.a)(Yi,"RttReplaceTextRangeOp",qn,[266,285]);class dh{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le,cf,Mf,Vg,Eg,wi,sm,sh,Rj,Ni,xi,qe){this.Kl=null;this.yHe=this.wmh=!1;this.Rkd=!0;this.t9g=0;this.Tfh=this.DSe=this.Vfh=this.Sfh=this.Ufh=!1;this.OYf=()=>{k.ULS.sendTraceTag(7685328,355,50,"All prerequisite ready for RttManager");this.Kl=this.o_.result;k.ULS.sendTraceTag(7685330,355,50,"Subscribing to presence updates");this.Kl.V3(this.l1)};this.l1=
(Hh,xd)=>{if(3===xd.type||10===xd.type)if(10===xd.type)this.t9g="boolean"===typeof xd.OL?xd.OL?1:0:xd.OL;else if(this.oZb.value&&!this.oZb.value.AWd)k.ULS.sendTraceTag(8454939,355,15,"RTT channel did not get disconnected on lock release");else if(xd.OL){if(this.yTn(),(Hh=this.rml(xd.OL))&&1!==Hh.metadata.clientType){this.xTn();if(!(!this.Zo||this.Zo.mda||Ld.a.uRa||Ld.a.lda||(n.AFrameworkApplication.se("1i00j689;ba0dg262"),Ld.a.uRa||Ld.a.lda)))return;if(2!==this.t9g)switch(this.Rkd&&(this.T_b.X8i(),
this.Rkd=!1),this.wmh||this.BAm(),Hh.opType){case 1:case 6:case 4:if(!({Bg:Hh}=this.Rrk(Hh)).returnValue)break;this.Gjh?this.hij(Hh):this.LDj(Hh);break;case 2:this.Yqc.add(Hh),this.Sri(Hh),this.Gjh?this.hij(wd.a.nil):this.KDj(Hh)}}}else k.ULS.sendTraceTag(7685331,355,15,"RTT packet was empty")};this.rAl=()=>{const Hh=this.ji.value;if(Hh){var xd=this.xD()-dh.r_n,ye=this.lub.zTd(Td=>Td.metadata.Omg<xd);0<ye.count&&this.MRn();var Pd=new pf.a;for(const Td of ye)if(this.lub.m8f(Td),Td.a8)switch(Td.a8.opType){case 1:Pd.add(Td.a8.paragraphId.toString());
break;case 6:Pd.add(Td.a8.paragraphId.toString());break;case 4:Pd.add(Td.a8.cke.toString()),Pd.add(Td.a8.hLc.toString())}ye=this.Yqc.zTd(Td=>Td.metadata.Omg<xd);for(const Td of ye)this.Yqc.m8f(Td),Td.a8&&Pd.add(Td.a8.paragraphId.toString());for(const Td of Pd)(Pd=Hh.Eb(wd.a.If(Td)))?Pd.AO?(this.dzb.f_n(Pd),Pd.AO||this.azc.value.Lbj(Pd)):k.ULS.sendTraceTag(8765829,355,15,"Expiring wet change from paragraph with no applied changes"):k.ULS.sendTraceTag(8765828,355,15,"Expiring wet change with invalid object ID")}else this.ji.Izf&&
k.ULS.sendTraceTag(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")};this.dzb=Ga;this.lub=kb;this.azc=nc;this.oZb=Kb;this.XI=ld;this.o_=Kc;this.ji=ue;this.Ib=Le;this.xD=cf;this.Wzb=Mf;this.Ad=Vg;this.iPe=wi;this.Lc=sm;this.Gjh=sh;this.T_b=Rj;this.jtb=Ni;this.OYe=xi;this.eBc=new M.a(K.a.ih());this.Yqc=new Jc;Eg.execute(dh.FBf);this.Zo=qe}BAm(){const Ga=new wa.a(3,2,dh.x1n,this.rAl);this.Ib.Wb(Ga);this.wmh=!0}init(){return this.o_?this.o_.continueWith(this.OYf):I.Task.C4(!1)}rml(Ga){Ga=
ic(Ga);if(!Ga)return null;switch(Ga.nt){case 2:return Yi.create(Ga);case 7:return rk.create(Ga);case 4:return Rc.create(Ga);case 3:return gg.create(Ga);default:return k.ULS.sendTraceTag(8459668,355,50,"RTT packet is of unexpected operationType {0}",Ga.nt),null}}Rrk(Ga){let kb=wd.a.nil;if(!this.lub.Qrk(Ga))return{returnValue:!1,Bg:kb};this.Sri(Ga);if(!this.XI)return{returnValue:!1,Bg:kb};const nc=this.XI.Ajb(Ga.Wc);if(nc.equals(wd.a.nil)||!this.ji.value.Eb(nc))return Ga.activity.O8i(),{returnValue:!1,
Bg:kb};this.Z8i();return{returnValue:!0,Bg:nc}}hij(Ga){Ga.equals(wd.a.nil)||this.eBc.add(Ga.toString());this.yHe||(Ga=new wa.a(0,1,200,()=>{this.pRo();this.yHe=!1},71),this.Ib.Wb(Ga),this.yHe=!0)}Sbo(Ga){Ga=new wa.a(0,1,0,Ga,71);this.Ib.Wb(Ga)}Sri(Ga){Ga.activity=dc.create(this.Ad);Ga.activity.lTn(Ga.metadata.packetVersion);Ga.activity.kTn(ng[Ga.opType])}pRo(){var Ga=this.Yqc.zTd(nc=>!nc.a8);for(const nc of Ga)this.KDj(nc);if(this.eBc.count){Ga=null;for(var kb of this.eBc){kb=wd.a.If(kb);Ga=this.ji.value.Eb(kb);
break}kb=this.Lc.Pc(3);try{kb.Db(Ga);for(const nc of this.eBc)this.LDj(wd.a.If(nc))}finally{kb&&kb.dispose()}this.eBc.clear()}}LDj(Ga){Ga=this.ji.value.Eb(Ga);let kb;const nc=this.Lc.Pc(3);try{nc.Db(Ga);kb=this.Ad.Fp(yh.a.dvh);const Kb=this.ivh(Ga,kb);kb.end();Kb&&this.Puk(Kb)}finally{nc&&nc.dispose(),this.T_b.B6f(1),this.Rkd=!0}}KDj(Ga){var kb=this.dzb.SEl(Ga,this.XI,this.ji.value);kb&&(this.Z8i(),this.dzb.yPo(Ga,kb,this.jtb,Na.a.instance.resolve("Box4.IParagraphEditor"))&&(kb=this.ji.value.Eb(Ga.a8.paragraphId),
this.Avh(kb,Ga),this.T_b.B6f(1),this.Rkd=!0))}Puk(Ga){this.iPe.continueWith(()=>{if(1===Ga.opType){var kb=this.iam(Ga);kb&&(this.iPe.result.w_e(kb),this.iPe.result.hee(!0))}})}iam(Ga){const kb=Ga.serialize();if(2!==kb.nt||kb.RT.ZHa&&kb.RT.nTa!==kb.RT.ZHa)return null;const nc=Ga.cS.clone();0<Ga.urb.length&&(nc.BFh(),nc.cp+=Ga.urb.length);kb.nt=0;kb.text=null;kb.RT.bde=0;kb.RT.cS=nc;kb.RT.V8a=kb.fSb;kb.RT.ZHa=null;kb.RT.Enc=null;kb.RT.n5=null;kb.fSb=null;return kd.zbf(kb,this.XI,this.Wzb,()=>this.ji.value,
this.OYe.instance)}Avh(Ga,kb){return this.azc.value?this.azc.value.Cqk(Ga,kb.metadata.clientId).returnValue?!0:(k.ULS.sendTraceTag(7866379,355,15,"Unable to apply a wet change lock"),!1):(k.ULS.shipAssertTag(7866378,355,!!this.azc.value,"Unable to apply wet changes as LockManager unavailable"),!1)}hvh(Ga,kb){this.ivh(Ga,kb)}ivh(Ga,kb){if(!Ga)return null;if(!Ga.anchor)return kb&&kb.properties.Z(dh.iSi,"1"),null;if(!Ga.hasProperty(ah.a.Wc))return k.ULS.sendTraceTag(7619922,355,15,"Paragraph is missing the WordId property"),
null;if(!Ga.hasProperty(ah.a.uj))return k.ULS.sendTraceTag(8197722,355,15,"Paragraph is missing the TextId property"),null;if(Ga.hasProperty(ah.a.vTh)&&Ga.getValue(ah.a.vTh))return k.ULS.sendTraceTag(16815506,355,50,"RTT edit disabled in paragraph"),null;const nc=Ga.getValue(ah.a.Wc);var Kb=Ga.hoa;kb&&(kb.properties.Z(dh.jin,Kb.toString()),kb.properties.Z(dh.nin,nc.toString()));Kb=this.lub.etf(nc,Kb);if(!Kb)return kb&&kb.properties.Z(dh.VRi,"1"),null;if(!this.Avh(Ga,Kb))return kb&&kb.properties.Z(dh.dLh,
"1"),null;let ld=0,Kc=null;for(;Kb;){if(!this.dzb.ZFk(Kb,Ga,this.jtb,kb)){kb&&kb.properties.Z(dh.kLj,"1");break}ld++;Kb.activity.LRn(this.xD());Kc=Kb;Kb=Ga.hoa;Kb=this.lub.etf(nc,Kb)}0<ld&&this.u8i();kb&&kb.properties.add(dh.lLj,ld.toString());return Kc}Pde(Ga){if(Ga.hasProperty(ah.a.Wc)&&Ga.hasProperty(ah.a.uj)){var kb=Ga.getValue(ah.a.Wc),nc=Ga.ja(ah.a.uj,0),Kb=this.Ad.Fp(yh.a.O$i),ld=this.jtb.Lpn(Ga.id);0<ld.count&&(this.dzb.sag(Ga,ld,this.ji.value),this.P_n(Ga,ld,nc));var Kc=this.jtb.eNl(kb);
if(Kc&&!Ga.id.equals(Kc.paragraphId)){const ue=this.ji.value;this.Sbo(()=>{const Le=this.jtb.Onb(Kc.paragraphId),cf=ue.Eb(Kc.paragraphId);k.ULS.shipAssertTag(16820032,355,!!cf,"Could not find added graph node");cf&&(this.dzb.sag(cf,Le,ue),this.Yqc.j8f(Kc.x_e))})}this.lub.etf(kb,nc)||this.azc.value.Lbj(Ga);this.hvh(Ga,Kb);Kb.end()}}P_n(Ga,kb,nc){let Kb=!1;for(let Kc=kb.count-1;0<=Kc;Kc--){var ld=kb.J(Kc);switch(ld.opType){case 1:case 6:case 4:ld=Object(y.a)(266,ld.operation);break;default:continue}ld.V1===
nc&&(Kb=!0,ld.xpc&&!ld.xpc.R2o(Ga)&&k.ULS.sendTraceTag(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",ld.opType,ld.Vvf(),Ga.id,ld.xpc.id,ld.xpc.cpBegin,ld.xpc.cpEnd));Kb&&this.lub.j8f(ld)}Kb&&this.u8i()}F2c(Ga){const kb=this.jtb.Onb(Ga.id);0<kb.count&&(2===kb.J(0).opType&&kb.removeAt(0),this.dzb.sag(Ga,kb,this.ji.value))}vie(Ga){var kb=this.jtb.X7l(Ga.id);for(const nc of kb)if(4===nc.opType&&
(kb=Object(y.a)(io,nc),Ga.id.equals(kb.aqk)))return!0;return!1}yTn(){this.Ufh||(k.ULS.sendTraceTag(8704354,355,50,"Received a wet change"),this.Ufh=!0)}xTn(){this.Sfh||(k.ULS.sendTraceTag(8185606,355,50,"Received a wet change that we could deserialize"),this.Sfh=!0)}Z8i(){this.Vfh||(k.ULS.sendTraceTag(17147533,355,50,"Received a usable wet change"),this.Vfh=!0)}u8i(){this.DSe||(k.ULS.sendTraceTag(8185607,355,50,"Successfully applied a wet change"),this.DSe=!0)}MRn(){this.DSe||this.Tfh||(k.ULS.sendTraceTag(8185608,
355,15,"Failed to apply any wet changes so far"),this.Tfh=!0)}static FBf(Ga){const kb=[yh.a.dvh,yh.a.O$i];for(const nc of kb)Ga.L5(nc,dh.lLj,zd.a.Bva),Ga.L5(nc,dh.VRi,zd.a.Bva),Ga.L5(nc,dh.iSi,zd.a.Bva),Ga.L5(nc,dh.dLh,zd.a.Bva),Ga.L5(nc,dh.kLj,zd.a.Bva),Ga.L5(nc,qd.S0i,zd.a.Bva),Ga.L5(nc,qd.HEj,zd.a.Bva);dc.FBf(Ga)}}dh.x1n=6E4;dh.r_n=18E4;dh.lLj="WetChangeCount";dh.VRi="NoChangesToApply";dh.iSi="NodeNotConnected";dh.dLh="CouldNotGetLock";dh.kLj="WetChangeBlocked";dh.nin="NodeWordId";dh.jin="NodeTextId";
Object(l.a)(dh,"RttManager",null,[267]);class Nf{constructor(Ga,kb){this.Ugj=0;this.qj=Ga;this.S$n=kb}X8i(){this.Ugj=this.qj()}B6f(Ga){const kb=this.qj()-this.Ugj;0<=kb&&this.S$n.track(Math.round(kb),0===Ga?"CTB":"RTP")}}Object(l.a)(Nf,"RttPerfCounter",null,[265]);var ei=c(2002);class kf{constructor(){this.JCc=new ei.a}tvk(Ga,kb){this.JCc.back()&&kb&&this.JCc.back().ogb(Ga)||this.JCc.enqueue(Ga)}A6l(){return this.JCc.isEmpty?null:this.JCc.dequeue()}}Object(l.a)(kf,"RttSendDataStore",null,[264]);class rn extends $e{constructor(Ga,
kb,nc,Kb){super(3,Kb);this.Wc=Ga;this.uj=kb;this.TH=nc}get V1(){return 0}serialize(){const Ga=new le.a(4,this.Wc,this.uj,null,null,null,null,this.TH);return new $b(this.metadata.packetId,this.metadata.clientId,1,5,Ga,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){const kb=Ga.RT;return new rn(kb.nTa,kb.V8a,kb.TH,Lc.create(Ga))}static gdm(Ga,kb){return 4!==Ga.type?null:new rn(Ga.S6b.Wc,Ga.S6b.uj,Ga.TH,kb)}}Object(l.a)(rn,"RttDeleteParagraphOp",
$e,[266,285]);class Zi extends $e{constructor(Ga,kb,nc,Kb,ld,Kc,ue,Le){super(5,Le);this.Psg=Ga;this.rzj=kb;this.q6o=nc;this.eKo=Kb;this.TH=ld;this.aMj=Kc;this.Fnc=ue}get Wc(){return this.Psg}get uj(){return this.rzj}get V1(){return this.Psg===this.aMj?this.Fnc:0}serialize(){const Ga=new le.a(5,this.Psg,this.rzj,null,this.q6o,this.eKo,null,this.TH),kb=new Xb(this.aMj,this.Fnc);return new $b(this.metadata.packetId,this.metadata.clientId,1,6,Ga,null,void 0,void 0,void 0,kb,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(Ga){const kb=
Ga.RT,nc=Ga.Q0c;return new Zi(kb.nTa,kb.V8a,kb.ZHa,kb.Enc,kb.TH,nc.R_f,nc.Fnc,Lc.create(Ga))}static hdm(Ga,kb){return 2!==Ga.type?null:new Zi(Ga.vqa.Wc,Ga.vqa.uj,Ga.USa.Wc,Ga.USa.uj,Ga.TH,Ga.$4d.Wc,Ga.$4d.uj,kb)}}Object(l.a)(Zi,"RttMergeParagraphOp",$e,[266,285]);class Ao{constructor(Ga,kb,nc,Kb,ld,Kc){this.mDc=this.lj=null;this.Efa=!1;this.FWe=this.dkh=0;this.vyd=this.slh=!1;this.GRe=0;this.OYf=()=>{k.ULS.sendTraceTag(8245954,355,50,"All prerequisites ready for RttSendManager");this.lj=this.o_.result;
this.lj.Bde(this)};this.yXi=(ue,Le)=>{if(this.lj&&2===this.lj.connectionState&&(ue=Le.rF,ue.length))if(Le.f8)100>this.FWe&&(this.FWe++,k.ULS.sendTraceTag(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",Le.tLk,this.dkh,this.FWe));else{for(Le=0;Le<ue.length;Le++)if(!this.WXm(ue[Le]))return;for(Le=0;Le<ue.length;Le++){const cf=ue[Le];this.Ueh.tvk(cf,!cf.type&&!Le)}this.mDc||this.aXi(this.mDc,this.lj)}};this.o_=Ga;this.Ueh=kb;this.ucb=nc;this.hu=Kb;this.yua=ld;this.T_b=
Kc}get Sm(){return this.ucb.value}init(){return this.o_?this.o_.continueWith(this.OYf):I.Task.C4(!1)}start(){this.Efa||(this.hu.Zc?(this.hu.Zc.rF.uzk(this.yXi),this.Efa=!0):k.ULS.sendTraceTag(522740420,355,10,"No activePage, RttSendManager not started"))}stop(){this.Efa&&(this.Efa=!1,this.hu.Zc.rF.P2n(this.yXi))}WXm(Ga){return Ga&&-1!==Ga.TH?Ga.type&&3!==Ga.type&&1!==Ga.type?!1:!0:!1}g8m(){this.vyd||(this.slh||(k.ULS.sendTraceTag(8270468,355,50,"Preparing to send RTT change"),this.slh=!0),!this.vyd&&
5>=this.GRe&&this.GRe++)}v8m(){!this.vyd&&5>=this.GRe&&(k.ULS.sendTraceTag(8270469,355,50,"Sent Rtt Message"),this.vyd=!0)}aXi(Ga,kb){this.g8m();Ga&&(Ga.Gi||Ga.Ho)&&k.ULS.sendTraceTag(8245956,355,15,"Task is faulted or cancelled with exception {0}",Ga.exception);this.T_b.X8i();(Ga=this.idm(this.Ueh.A6l()))?(this.dkh++,this.mDc=kb.qN(3,Ac(Ga.serialize())),this.v8m(),this.T_b.B6f(0),this.mDc.continueWith(nc=>{this.aXi(nc,kb)})):this.mDc=null}idm(Ga){if(!Ga)return null;if(!this.Sm)return k.ULS.sendTraceTag(8245957,
355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;const kb=new Lc(pj.instance.ndi(),this.Sm.rj,1,0,0,Zd.instance.R6l());let nc=null;switch(Ga.type){case 0:nc=Yi.fcm(Ga,kb,this.yua);break;case 4:nc=rn.gdm(Ga,kb);break;case 3:nc=gg.fdm(Ga,kb);break;case 2:nc=Zi.hdm(Ga,kb);break;case 1:nc=Rc.jdm(Ga,kb,this.yua)}return nc}}Object(l.a)(Ao,"RttSendManager",null,[263]);class gl{constructor(){this.W=null;this.v4l=()=>eb.App.zd&&eb.App.zd.fq?eb.App.zd.fq:(k.ULS.sendTraceTag(7866377,
304,15,"Unable to get the lock manager"),null)}get name(){return"WordEditor.RealTimeTyping"}wc(Ga){const kb=Aa.a.Gp(Ga.Sa("Box4.IOutlineElementEditor")),nc=Aa.a.Gp(Ga.Sa("Box4.IFeatureHelper")),Kb=Aa.a.Gp(Ga.Sa("Common.IActivityAggregationInfo")),ld=Aa.a.Gp(Ga.Sa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator")),Kc=Aa.a.Gp(Ga.Sa("Box4.CompositionStateManager"));this.W=Ga;const ue=new gf.a;I.Task.WAA.call(null,kb,nc,Kb,ld,Kc).continueWith(()=>{Ga.ia("WordEditor.RealTimeTyping.IRttEditor",
()=>new qd(Ga.resolve("Box4.ICharacterPropertiesEditor"),Ga.resolve("Box4.IOutlineElementEditor"),ue,Ga.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();Ga.register(Nf,"WordEditor.RttPerfCounter").as("WordEditor.IRttPerfCounter").ha().Ud(()=>new Nf(Rg.a.$e,Lf.a.mF(17,1,new ag.a(new xn.a(.25)))));Ga.ia("WordEditor.RealTimeTyping.RttManager",()=>new dh(Ga.resolve("WordEditor.RealTimeTyping.IRttEditor"),new Nn(Zj.a.instance),new X.a(this.v4l),new X.a(()=>eb.App.sS),Ga.resolve("WordEditor.ParagraphWordIdMapping"),
Ga.resolve("Box4.Presence.IRtcProxyProvider").bE(),new X.a(()=>Lb.StaticActiveAppFrame.za().jb&&Lb.StaticActiveAppFrame.za().jb.Zc?Lb.StaticActiveAppFrame.za().jb.Zc.xd:(k.ULS.sendTraceTag(522740419,304,10,"No activePage or workspace."),null)),vb.a.instance,()=>Date.now(),Ga.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Zj.a.instance,Ga.Sa("Common.IActivityAggregationInfo"),Ef.bE(),ue,n.AFrameworkApplication.K.$("WordEditorThrottleAndBatchRTTRendering"),Ga.resolve("WordEditor.IRttPerfCounter"),
new Oh,Ga.Sa("WordEditor.Presence.IWordPresenceCpFactory"),Ga.resolve("Box4.CompositionStateManager"))).as("WordEditor.RealTimeTyping.IRttManager").ha();Ga.ia("WordEditor.RealTimeTyping.RttSendManager",()=>new Ao(Ga.resolve("Box4.Presence.IRtcProxyProvider").bE(),new kf,new X.a(()=>eb.App.zd),Lb.StaticActiveAppFrame.za().jb,Ga.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Ga.resolve("WordEditor.IRttPerfCounter"))).ha();this.GBf()})}GBf(){this.W.resolve("WordEditor.RealTimeTyping.RttManager").init();
this.W.resolve("WordEditor.RealTimeTyping.RttSendManager").init()}init(){}dispose(){}static main(){Fa.a.instance.Gc(new gl)}}Object(l.a)(gl,"WordEditorRealTimeTypingPackage",null,[1,2]);Type.registerNamespace("BPr");Type.registerNamespace("Box4.Presence");Type.registerNamespace("RealtimePresenceUI");Type.registerNamespace("WERTT");Type.registerNamespace("WordEditor.PeoplesWellControl");Type.registerNamespace("WordEditor.Presence");Type.registerNamespace("AppRealtimeChannel");Type.registerNamespace("Common.App.CoauthTelemetry");
za.main();Type.registerNamespace("Common.App.CollabControls");xb.prototype.toString=fa.a.prototype.toString;zb.prototype.toString=fa.a.prototype.toString;Fa.a.instance.Gc(new Ii);gl.main();Type.registerNamespace("RealtimePresenceUI");Fa.a.instance.Gc(new Ud);Type.registerNamespace("Common.App.RtcHostNotificationSubscription");ta.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20380705/wdjs/WordEditorDSVersionHistoryRemoved.collab.js.map
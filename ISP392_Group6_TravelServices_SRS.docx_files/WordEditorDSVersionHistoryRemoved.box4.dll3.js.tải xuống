/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1519:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(1616);class e{constructor(){this.Tq=null;this.yq=!1}rq(){this.yq||(this.yq=!0,this.Tq=l.a.instance.Rbm(),l.a.instance.rq(this.Tq,this))}aVi(){this.M6c();this.yq=!1}M6c(){}}Object(D.a)(e,"Base",null,[])},1539:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.Vwc=this.Uwc=this.szc=this.rzc=this.tzc=this.u7=this.v7=
!1}get ignorePunct(){return this.Uwc}set ignorePunct(e){this.Uwc=e}get ignoreSpace(){return this.Vwc}set ignoreSpace(e){this.Vwc=e}get matchCase(){return this.u7}set matchCase(e){this.u7=e}get matchPrefix(){return this.rzc}set matchPrefix(e){this.rzc=e}get matchSuffix(){return this.szc}set matchSuffix(e){this.szc=e}get matchWholeWord(){return this.v7}set matchWholeWord(e){this.v7=e}get matchWildcards(){return this.tzc}set matchWildcards(e){this.tzc=e}getTypeName(){return"Microsoft.WordServices.SearchOptions"}invokePropertyGet(e){switch(e){case 1:return this.ignorePunct;
case 2:return this.ignoreSpace;case 3:return this.matchCase;case 4:return this.matchPrefix;case 6:return this.matchSuffix;case 8:return this.matchWholeWord;case 7:return this.matchWildcards}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertyGetAsync(e){e=this.invokePropertyGet(e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}invokePropertySet(e,a){switch(e){case 1:this.ignorePunct=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 2:this.ignoreSpace=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 3:this.matchCase=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 4:this.matchPrefix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 6:this.matchSuffix=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return;case 8:this.matchWholeWord=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,
0,"boolean");return;case 7:this.matchWildcards=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(a,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokePropertySetAsync(e,a){this.invokePropertySet(e,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(e){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(e);}invokeMethodAsync(e,a){e=this.invokeMethod(e,a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}}
Object(D.a)(l,"SearchOptions",null,[])},1616:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);var l=c(61),e=c(7),a=c(505),k=c(360),x=c(1515);class y{constructor(){this.Scb=new a.a(k.a.ih())}Rbm(){return l.a.create().toString()}rq(n,t){n&&t||(e.ULS.sendTraceTag(17168157,369,10,"Cannot keep reference for null object."),x.a.Tf());this.swk(n,t)}swk(n,t){try{this.Scb.add(n,t)}catch(z){e.ULS.sendTraceTag(17168158,369,10,"Failed to add object into the cache with exception message {0}.",z.message)}}OOd(n){let t=
null;({value:t}=this.Scb.Fc(n,t));t||e.ULS.sendTraceTag(17168159,369,15,"This object with reference Id {0} hasn't been added to the cache yet.",n);return t}d0n(n){try{let t=null;({value:t}=this.Scb.Fc(n,t));t&&(t.aVi(),this.Scb.remove(n))}catch(t){e.ULS.sendTraceTag(17168160,369,10,"Failed to remove the object from the cache with exception message {0}.",t.message)}}pZk(){if(this.Scb&&this.Scb.values){for(const n of this.Scb.values)n.aVi();this.Scb=new a.a(k.a.ih())}}static get instance(){return y._instance||
(y._instance=new y)}}y._instance=null;Object(D.a)(y,"ObjectCache",null,[])},1624:function(D,J,c){c.r(J);D=c(0);var l=c(75),e=c(7),a=c(83);class k{constructor(){this.startTime=0;this.callback=null}}Object(D.a)(k,"SSOCallbackInfo",null,[]);class x{constructor(){this.accessToken=null}}Object(D.a)(x,"AccessTokenInformation",null,[1033]);var y=c(1764);class n{constructor(){this.token=null;this.expiresOn=0;this.Y_a=this.authChallenge=null}}Object(D.a)(n,"CachedTokenInfo",null,[]);class t{constructor(){this.Yhd=
new l.a;this.lOa=this.kOa=!1;this.a9a=this.authChallenge=null;this.startTime=this.retryCount=0;this.ish=null}get callbacks(){return this.Yhd}}Object(D.a)(t,"SSORequestInfo",null,[]);class z extends t{constructor(){super();this.errorCode=0}}Object(D.a)(z,"SSOFailedRequestInfo",t,[]);var v=c(2);class I{constructor(X,U,T,Y){this.rma=new l.a;this.a3=new l.a;this.T$a=null;this.ZBc=new l.a;this.W4g=Promise.resolve(null);this.nhh=!1;this.Wvd=U;this.Utb=X;this.oyd=T;this.GVj=Y}uuo(X){if(this.T$a&&this.T$a.authChallenge===
X.authChallenge){if(Date.now()/1E3+I.Kbn>this.T$a.expiresOn)return this.T$a=null,!1;X=new y.a;X.token=this.T$a.token;X.expiresOn=this.T$a.expiresOn;X.Y_a=this.T$a.Y_a;X.pSb=!0;X.rSc=0;this.hTc(X);return!0}return!1}yso(X){for(let U=0;U<this.a3.count;U++)if(this.a3.J(U).authChallenge===X.authChallenge&&this.a3.J(U).a9a===X.a9a){let T;(T=this.a3.J(U)).retryCount=T.retryCount+1;X.retryCount=this.a3.J(U).retryCount;if(this.a3.J(U).retryCount<I.ncn||!this.a3.J(U).kOa&&X.kOa||!this.a3.J(U).lOa&&X.lOa){if(!this.a3.J(U).kOa&&
X.kOa||!this.a3.J(U).lOa&&X.lOa)X.retryCount=0;this.a3.removeAt(U);break}X=new y.a;X.errorCode=this.a3.J(U).errorCode;this.hTc(X);return!0}return!1}mwk(X,U){for(let T=0;T<this.a3.count;T++)if(this.a3.J(T).a9a===X.a9a&&this.a3.J(T).authChallenge===X.authChallenge)return;this.a3.add(Object.assign(new z,{kOa:X.kOa,lOa:X.lOa,authChallenge:X.authChallenge,a9a:X.a9a,errorCode:U,retryCount:X.retryCount}))}get resource(){return this.Wvd}dof(X,U,T,Y,aa,ba){const {AppsForOfficeSingleSignOnManager:oa}=c(1624);
""===T&&(T=null);if(this.nhh)oa.gHa(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var ma=null;for(let ea of this.rma)if(ea.kOa===X&&ea.lOa===U&&ea.authChallenge===T&&ea.a9a===aa){ma=ea;break}ma||(ma=Object.assign(new t,{kOa:X,lOa:U,authChallenge:T,ish:Y,a9a:aa,retryCount:0,startTime:oa.nq()}),this.rma.add(ma));ma.retryCount=0;ma.callbacks.add(ba);this.W4g=this.W4g.then(()=>{var {AppsForOfficeSingleSignOnManager:ea}=c(1624);if(0<this.rma.count){var ua=this.rma.J(0);if(this.uuo(ua)||
this.yso(ua))return null;for(let Fa=0;Fa<this.ZBc.count;)this.ZBc.J(Fa)+I.UKo<ea.nq()?this.ZBc.removeAt(Fa):Fa++;if(this.ZBc.count>=I.kcn||this.rma.count>=I.Ebn)return ua=new y.a,ua.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.hTc(ua),null;let sa=null;v.AFrameworkApplication.ta&&(ea=v.AFrameworkApplication.ta.Kq)&&(sa=ea.Yf("ComponentAttach",this.Utb+I.Blk));return ua.a9a.Gqk(this.resource,ua.kOa,ua.lOa,ua.authChallenge,this.GVj,ua.ish).then(Fa=>{sa&&sa.stop();this.hTc(Fa)},
()=>{sa&&sa.stop();const Fa=new y.a;Fa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.hTc(Fa)})}return null})}}hTc(X){const {AppsForOfficeSingleSignOnManager:U}=c(1624);try{if(this.rma.count){var T=this.rma.J(0);this.rma.removeAt(0);var Y=null;X.errorCode||(Y=new x,Y.accessToken=X.token);X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&
X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.mwk(T,X.errorCode);var aa={};null!=X.rSc&&(aa.getTokenSilentTime=X.rSc.toString());null!=X.iwf&&(aa.getTokenPopupTime=X.iwf.toString());null!=X.Prf&&(aa.getIDTokenTime=X.Prf.toString());null!=X.pSb&&(aa.tokenCached=X.pSb.toString());X.Ulg&&(aa.detailedError=X.Ulg);X.Y_a&&(aa.authLibrary=X.Y_a);T.retryCount&&(aa.retryCount=T.retryCount);for(var ba of T.callbacks)U.gHa(ba,X.errorCode,Y,aa);null!=X.pSb&&X.pSb||this.ZBc.add(T.startTime);
if(!X.errorCode)for(null!=X.expiresOn&&(this.T$a=Object.assign(new n,{token:X.token,expiresOn:X.expiresOn,authChallenge:T.authChallenge,Y_a:X.Y_a})),this.a3.clear(),ba=0;ba<this.rma.count;)if(this.rma.J(ba).authChallenge===T.authChallenge){for(let oa of this.rma.J(ba).callbacks)U.gHa(oa,X.errorCode,Y,aa);this.rma.removeAt(ba)}else ba++}}catch(oa){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",oa.message)}}shutdown(){this.nhh=!0;this.rma.clear()}}I.UKo=6E4;
I.kcn=6;I.Ebn=6;I.ncn=3;I.Kbn=300;I.Blk="GetAccessToken";Object(D.a)(I,"SSOCallbackManager",null,[]);var E=c(1530),H=c(468),M=c(114),K=c(46),L=c(20),S=c(19),Q=c(190),N=c(176);c.d(J,"AppsForOfficeSingleSignOnManager",function(){return O});class O{constructor(X,U,T=null){this.CUb=new a.a;const Y=new l.a;U&&Y.add(U.j$m);T&&Y.addRange(T);this.Hj=X;this.rnk=Y}n_n(X){this.CUb.nb(X)&&(this.CUb.J(X).shutdown(),this.CUb.remove(X))}eof(X,U,T,Y,aa,ba,oa,ma,ea,ua){ua=Object.assign(new k,{startTime:O.nq(),callback:ua});
try{const Pa=!!T&&""!==T;var sa=ua.startTime;const Na=this.getOsfControl(X);let Aa=Na.getStoreType()||"",za=Na.getOwnerAddinStoreType()||"",xa=Na.getSolutionId()||"";const ka=Na.getVersion()||"";Aa=Aa.toLowerCase();za=za.toLowerCase();xa=xa.toLowerCase();var Fa=K.a.Mrf(U)||"";const wa=K.a.Mrf(Na.getIframeUrl())||"",ia=Fa.toLowerCase()===wa.toLowerCase();Fa=Aa;"inmemory"===Aa&&(Fa=za);const va=Telemetry.PrivacyRules.GetPrivacyCompliantId(xa,Fa,Na.getAssetId(),null,null,Na.getStoreId()),na={["callInstanceId"]:sa.toString(),
["controlSolutionId"]:va,["controlVersion"]:ka,["storeType"]:Aa,["ownerStoreType"]:za,["allowConsentPrompt"]:Y.toString(),["forMSGraphAccess"]:aa.toString(),["allowSignInPrompt"]:ba.toString(),["hasAddinAuthChallenge"]:Pa.toString(),["securityOriginEqualsSourceLocation"]:ia.toString(),["singleSignOnEnabled"]:oa.toString(),["accountTypeFilter"]:ma||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",na);Q.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",
dataFields:M.a.RH(na)}));sa=!0;const Ca=v.AFrameworkApplication.K.kb("HostAuthType");switch(ma){case "aad":sa="aad"===Ca;break;case "msa":sa="msa"===Ca;break;default:sa=!ma||"noFilter"===ma}if(sa){ma=null;if(oa)for(let ta of this.rnk)if(ta.MMm(xa)){ma=ta;break}ma?this.isSSOAddin(X)?(oa=!0,"omex"===Fa&&(oa=!1),"spapp"===Fa||"spcatalog"===Fa?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):aa&&!oa?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(aa&&"exchange"===Fa&&(Y=!1),this.dof(X,U,T,Fa,Y,ba,ea,ma,ua))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Pa){this.q3d(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Pa.message),O.gHa(ua,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(X,U,T,Y){this.eof(X,T[E.a.$0e]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||
!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,U,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Y)}dof(X,U,T,Y,aa,ba,oa,ma,ea){this.CUb.nb(X)?Y=this.CUb.J(X):(Y=new I(X,this.getWebApplicationResource(X).split(",")[0],Y,this.getDefaultDisplayName(X)),this.CUb.add(X,Y));const ua=Y.resource;X=
O.ocm(ua,this.getWebApplicationId(X));const sa=OfficeExt.WACUtils.getHostSecure(U);X&&sa?X.toLowerCase()===sa.toLowerCase()?Y.dof(aa,ba,T,oa,ma,ea):(O.pLb('SSO Resource "'+ua+'" cannot be used from "'+U+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),O.gHa(ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(X||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),
sa||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),O.gHa(ea,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}q3d(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(X){return this.Hj.getOsfControl(X)}isSSOAddin(X){return this.getOsfControl(X).getManifest().isSSOAddin()}getWebApplicationId(X){return this.getOsfControl(X).getManifest().getWebApplicationId()}getWebApplicationResource(X){return this.getOsfControl(X).getManifest().getWebApplicationResource()}getDefaultDisplayName(X){return this.getOsfControl(X).getManifest().getDefaultDisplayName()}static afm(){try{const X=
{};L.a.ZRa&&H.OAuthManagerSettings.XTc&&(X.UiHostSupportsAuthTokenAddinList=O.n1h);X.UiHostSupportsAuthToken=H.OAuthManagerSettings.XTc;return X}catch(X){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",X.message)}return null}static getInstance(X,U,T=null){O._instance||(O._instance=new O(X,T));return O._instance}static KVk(X){O._instance&&O._instance.n_n(X)}static pLb(X){window.console.warn&&window.console.warn(X)}static ocm(X,U){if(!X)return"";U||(U="");
let T=X.toLowerCase();var Y=U.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Y)||(O.pLb('SSO App Id "'+U+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));T.endsWith(Y)||(O.pLb('SSO Resource "'+X+'" does not end with App Id "'+U+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!T.startsWith("https://")&&
!T.startsWith("api://"))return O.pLb('SSO Resource "'+X+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(U=0;U<X.length;U++){Y=X.charAt(U);const aa=S.a.charCodeAt(X,U);if(33>aa||126<aa||"&"===Y||"?"===Y||"#"===Y||"%"===Y||"\\"===Y)return O.pLb('SSO Resource "'+X+'" contains an invalid character "'+Y+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Y+"' in resource URI."),""}if(0<=X.indexOf("::"))return O.pLb('SSO Resource "'+
X+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<X.length)return O.pLb('SSO Resource "'+X+'" is '+X.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+X.length+"."),"";T.startsWith("api://")&&(T="https://"+T.substring(6,T.length));return 8===T.length?"":OfficeExt.WACUtils.getHostSecure(T)||""}static gHa(X,U,T,Y){var aa=X.startTime;let ba=0;0<aa&&(ba=O.nq()-aa);aa=
{["callInstanceId"]:aa.toString(),["callDuration"]:ba.toString(),["errorCode"]:U.toString()};if(Y)for(let oa in Y)aa[oa]=Y[oa];e.ULS.sendTraceTag(51401116,344,50,"{0}",aa);Q.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:M.a.RH(aa)}));X.callback(U,T)}static nq(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(X){}return Date.now()}}O.n1h="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
O._instance=null;Object(D.a)(O,"AppsForOfficeSingleSignOnManager",null,[984])},1665:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.cOc="extId";l.cIh="ComponentType";l.o5b="ComponentId";l.kwm="HostProps";l.e3c="OptionalProps";Object(D.a)(l,"ActionPropertyNames",null,[])},1764:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Y_a=this.pSb=this.Prf=this.iwf=this.rSc=this.Ulg=null}}Object(D.a)(l,"AppsForOfficeOauthResult",
null,[])},1765:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.taskPaneWidth="TaskPaneWidth";l.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";l.pS="TaskPaneTitle";l.bS="NonPersistedSettings";l.onTaskPaneClose="OnTaskPaneClose";l.onExtensionLaunchCallback="OnExtensionLaunchCallback";l.Inh="ActionArgs";l.dialogWidth="DialogWidth";l.dialogHeight="DialogHeight";l.dialogLeft="DialogLeft";l.dialogTop="DialogTop";l.dialogTitle="DialogTitle";Object(D.a)(l,"PropertyNames",
null,[])},1767:function(D,J,c){c.d(J,"a",function(){return z});D=c(0);var l=c(1912),e=c(1914),a=c(1665),k=c(1911),x=c(1913),y=c(2),n=c(61),t=c(12);class z{constructor(){this.ga=y.AFrameworkApplication.va}KKf(v,I,E,H,M){this.p0m(v,I,E,H,M)}p0m(v,I,E,H,M){const {ExtensionComponentInstance:K}=c(1910),L={};L[a.a.cOc]=v;L[a.a.cIh]=I;L[a.a.o5b]=E;L[a.a.kwm]=H;L[a.a.e3c]=M;H=8;if(y.AFrameworkApplication.QCi(v.getId()))switch(I){case k.a.action:H=this.ga.Qb(t.a.RNd,2,L);break;case k.a.Tyj:H=this.ga.Qb(t.a.ysj,
2,L);break;case k.a.zco:H=this.ga.Qb(t.a.E2d,2,L);break;default:H=16}32===H?(H=n.a.create().toString(),M.optionalProperties.InstanceToken&&(H=M.optionalProperties.InstanceToken),v=new K(v,I,E,H),z.wH[H]=v):v=new K(v,I,E,null);v.Jgo(L)}o0m(v){var I=v.ExtId;const E=v.ComponentType,H=v.ComponentId;var M=v.HostProps;v=v.OptionalProps;I=new l.a(I.Id,I.StoreId,I.StoreType,I.AppVersion);M=new x.a(M.HostType,M.FormFactor,M.Locale);const K=new e.a;K.optionalProperties=v.OptionalProperties;K.$Lc=v.DevProperties;
z.instance.KKf(I,E,H,M,K)}getInstance(v){return z.wH[v]}t0n(v){delete z.wH[v]}static get instance(){z.jBe||(z.jBe=new z);return z.jBe}}z.jBe=null;z.wH={};Object(D.a)(z,"ExtensionLifeCycleManager",null,[1259])},1769:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.vNi=e;this.text=a}}Object(D.a)(l,"ListTransformationContent",null,[])},1771:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,
x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1918),J);e(c(1919),J);e(c(1920),J);e(c(1921),J)},1906:function(D,J,c){(function(l){c.d(J,"a",function(){return n});var e=c(0),a=c(137),k=c(1216),
x=c(1519),y=c(1515);class n extends x.a{constructor(t,z,v,I,E,H,M,K,L,S){super();this.Ed=t;this._context=z;this._id=v;this.PZg=I;this.tk=E;this.Ow=H;this.$c=M;this.Ig=K;this.hd=L;this.iq=S}get EAf(){return this.PZg}set EAf(t){this.PZg=t}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}get code(){return this.Ow.mYl(this)}set code(t){81===this.type&&(null===t||void 0===t?0:t.toLowerCase().startsWith("addin"))?this.Ow.ljo(this,t):y.a.Lmg()}get result(){return this.Ed?this.tk.create(this.Ed,
this._context):null}get parentBody(){return this.$c.Rtf(this.Ed.J(0).node,this.Ed.J(this.Ed.count-1).node,this._context)}get parentContentControl(){const t=this.parentContentControlOrNullObject;t||y.a.Tk();return t}get parentContentControlOrNullObject(){const t=this.Ed.J(0),z=this.Ed.J(this.Ed.count-1);return this.Ig.eac(t,z,this._context)}get parentTable(){const t=this.parentTableOrNullObject;t||y.a.Tk();return t}get parentTableCell(){const t=this.parentTableCellOrNullObject;t||y.a.Tk();return t}get parentTableCellOrNullObject(){const t=
this.Ed.J(0),z=this.Ed.J(this.Ed.count-1);return this.$c.H$b(t.node,this._context,z.node)}get parentTableOrNullObject(){const t=this.Ed.J(0),z=this.Ed.J(this.Ed.count-1);return this.$c.Ejb(t.node,this._context,z.node)}get data(){a.a.T8||y.a.zk();if(81!==this.type)return null;const t=this.Ow.ZRd(this);return t.data?l.from(t.data,"base64").toString("utf8"):null}set data(t){a.a.T8||y.a.zk();81!==this.type&&y.a.Tf();65280<(null===t||void 0===t?void 0:t.length)&&y.a.qd();t=l.from(t,"utf8").toString("base64");
this.Ow.ZRd(this).data=t}get kind(){a.a.T8||y.a.zk();switch(this.type){case 81:case 88:case 13:case 31:return 2;default:return 0}}get locked(){a.a.T8||y.a.zk();return 88===this.type?!0:this.Ow.ZRd(this).IRa}set locked(t){a.a.T8||y.a.zk();88!==this.type&&(this.Ow.ZRd(this).IRa=t)}get showCodes(){return null}set showCodes(t){}get type(){a.a.T8||y.a.zk();const t=k.a.t8b(this.code);return"addin"===t?81:"toc"===t?13:"hyperlink"===t?88:"date"===t?31:100}_KeepReference(){this.rq()}_OnAccess(){}delete(){a.a.T8||
y.a.zk();this.hd.R6b(this.Ed)}getNext(){const t=this.getNextOrNullObject();t||y.a.Tk();return t}getNextOrNullObject(){return this.Ow.getNextOrNullObject(this,this._context)}getRange(){return this.Ed?this.tk.create(this.Ed,this._context):null}select(t){a.a.T8||y.a.zk();this.iq.select(this.Ed,t)}updateResult(){a.a.T8||y.a.zk();this.Ow.updateResult(this)}getTypeName(){return"Microsoft.WordServices.Field"}invokePropertyGet(t){switch(t){case 1:return this._Id;case 2:return this._ReferenceId;case 3:return this.code;
case 16:return this.data;case 13:return this.kind;case 15:return this.locked;case 5:return this.parentBody;case 6:return this.parentContentControl;case 7:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 10:return this.parentTableCell;case 11:return this.parentTableCellOrNullObject;case 9:return this.parentTableOrNullObject;case 4:return this.result;case 14:return this.showCodes;case 12:return this.type}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
}invokePropertyGetAsync(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}invokePropertySet(t,z){switch(t){case 3:this.code=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 16:this.data=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 15:this.locked=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 14:this.showCodes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertySetAsync(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(t,z){switch(t){case 1002:return this.Vh();case 1001:return this.Wh();case 1003:return this.UD(z);case 1004:return this.Cca();case 1005:return this.Dca();case 1007:return this.iea(z);case 1006:return this.$Zo()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
}invokeMethodAsync(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}UD(){return this.delete()}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}iea(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");this.select(t);return null}$Zo(){this.updateResult();return null}}Object(e.a)(n,"Field",x.a,[841])}).call(this,c(1907).xNj)},1907:function(D,
J,c){(function(l){function e(){try{var aa=new Uint8Array(1);aa.__proto__={__proto__:Uint8Array.prototype,okp:function(){return 42}};return"function"===typeof aa.subarray&&0===aa.subarray(1,1).byteLength}catch(ba){return!1}}function a(aa,ba){if((k.Vea?2147483647:1073741823)<ba)throw new RangeError("Invalid typed array length");k.Vea?(aa=new Uint8Array(ba),aa.__proto__=k.prototype):(null===aa&&(aa=new k(ba)),aa.length=ba);return aa}function k(aa,ba,oa){if(!(k.Vea||this instanceof k))return new k(aa,
ba,oa);if("number"===typeof aa){if("string"===typeof ba)throw Error("If encoding is specified then the first argument must be a string");return n(this,aa)}return x(this,aa,ba,oa)}function x(aa,ba,oa,ma){if("number"===typeof ba)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&ba instanceof ArrayBuffer){ba.byteLength;if(0>oa||ba.byteLength<oa)throw new RangeError("'offset' is out of bounds");if(ba.byteLength<oa+(ma||0))throw new RangeError("'length' is out of bounds");
ba=void 0===oa&&void 0===ma?new Uint8Array(ba):void 0===ma?new Uint8Array(ba,oa):new Uint8Array(ba,oa,ma);k.Vea?(aa=ba,aa.__proto__=k.prototype):aa=t(aa,ba);ba=aa}else if("string"===typeof ba){ma=aa;aa=oa;if("string"!==typeof aa||""===aa)aa="utf8";if(!k.cyi(aa))throw new TypeError('"encoding" must be a valid string encoding');oa=I(ba,aa)|0;ma=a(ma,oa);ba=ma.write(ba,aa);ba!==oa&&(ma=ma.slice(0,ba));ba=ma}else ba=z(aa,ba);return ba}function y(aa){if("number"!==typeof aa)throw new TypeError('"size" argument must be a number');
if(0>aa)throw new RangeError('"size" argument must not be negative');}function n(aa,ba){y(ba);aa=a(aa,0>ba?0:v(ba)|0);if(!k.Vea)for(var oa=0;oa<ba;++oa)aa[oa]=0;return aa}function t(aa,ba){var oa=0>ba.length?0:v(ba.length)|0;aa=a(aa,oa);for(var ma=0;ma<oa;ma+=1)aa[ma]=ba[ma]&255;return aa}function z(aa,ba){if(k.isBuffer(ba)){var oa=v(ba.length)|0;aa=a(aa,oa);if(0===aa.length)return aa;ba.copy(aa,0,0,oa);return aa}if(ba){if("undefined"!==typeof ArrayBuffer&&ba.buffer instanceof ArrayBuffer||"length"in
ba)return(oa="number"!==typeof ba.length)||(oa=ba.length,oa=oa!==oa),oa?a(aa,0):t(aa,ba);if("Buffer"===ba.type&&U(ba.data))return t(aa,ba.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function v(aa){if(aa>=(k.Vea?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(k.Vea?2147483647:1073741823).toString(16)+" bytes");return aa|0}function I(aa,ba){if(k.isBuffer(aa))return aa.length;if("undefined"!==
typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(aa)||aa instanceof ArrayBuffer))return aa.byteLength;"string"!==typeof aa&&(aa=""+aa);var oa=aa.length;if(0===oa)return 0;for(var ma=!1;;)switch(ba){case "ascii":case "latin1":case "binary":return oa;case "utf8":case "utf-8":case void 0:return S(aa).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*oa;case "hex":return oa>>>1;case "base64":return N(aa).length;default:if(ma)return S(aa).length;ba=
(""+ba).toLowerCase();ma=!0}}function E(aa,ba,oa){var ma=!1;if(void 0===ba||0>ba)ba=0;if(ba>this.length)return"";if(void 0===oa||oa>this.length)oa=this.length;if(0>=oa)return"";oa>>>=0;ba>>>=0;if(oa<=ba)return"";for(aa||(aa="utf8");;)switch(aa){case "hex":aa=ba;ba=oa;oa=this.length;if(!aa||0>aa)aa=0;if(!ba||0>ba||ba>oa)ba=oa;ma="";for(oa=aa;oa<ba;++oa)aa=ma,ma=this[oa],ma=16>ma?"0"+ma.toString(16):ma.toString(16),ma=aa+ma;return ma;case "utf8":case "utf-8":return K(this,ba,oa);case "ascii":aa="";
for(oa=Math.min(this.length,oa);ba<oa;++ba)aa+=String.fromCharCode(this[ba]&127);return aa;case "latin1":case "binary":aa="";for(oa=Math.min(this.length,oa);ba<oa;++ba)aa+=String.fromCharCode(this[ba]);return aa;case "base64":return 0===ba&&oa===this.length?X.fromByteArray(this):X.fromByteArray(this.slice(ba,oa));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ba=this.slice(ba,oa);oa="";for(aa=0;aa<ba.length;aa+=2)oa+=String.fromCharCode(ba[aa]+256*ba[aa+1]);return oa;default:if(ma)throw new TypeError("Unknown encoding: "+
aa);aa=(aa+"").toLowerCase();ma=!0}}function H(aa,ba,oa,ma,ea){if(0===aa.length)return-1;"string"===typeof oa?(ma=oa,oa=0):2147483647<oa?oa=2147483647:-2147483648>oa&&(oa=-2147483648);oa=+oa;isNaN(oa)&&(oa=ea?0:aa.length-1);0>oa&&(oa=aa.length+oa);if(oa>=aa.length){if(ea)return-1;oa=aa.length-1}else if(0>oa)if(ea)oa=0;else return-1;"string"===typeof ba&&(ba=k.from(ba,ma));if(k.isBuffer(ba))return 0===ba.length?-1:M(aa,ba,oa,ma,ea);if("number"===typeof ba)return ba&=255,k.Vea&&"function"===typeof Uint8Array.prototype.indexOf?
ea?Uint8Array.prototype.indexOf.call(aa,ba,oa):Uint8Array.prototype.lastIndexOf.call(aa,ba,oa):M(aa,[ba],oa,ma,ea);throw new TypeError("val must be string, number or Buffer");}function M(aa,ba,oa,ma,ea){function ua(Na,Aa){return 1===sa?Na[Aa]:Na.WQn(Aa*sa)}var sa=1,Fa=aa.length,Pa=ba.length;if(void 0!==ma&&(ma=String(ma).toLowerCase(),"ucs2"===ma||"ucs-2"===ma||"utf16le"===ma||"utf-16le"===ma)){if(2>aa.length||2>ba.length)return-1;sa=2;Fa/=2;Pa/=2;oa/=2}if(ea)for(ma=-1;oa<Fa;oa++)if(ua(aa,oa)===ua(ba,
-1===ma?0:oa-ma)){if(-1===ma&&(ma=oa),oa-ma+1===Pa)return ma*sa}else-1!==ma&&(oa-=oa-ma),ma=-1;else for(oa+Pa>Fa&&(oa=Fa-Pa);0<=oa;oa--){Fa=!0;for(ma=0;ma<Pa;ma++)if(ua(aa,oa+ma)!==ua(ba,ma)){Fa=!1;break}if(Fa)return oa}return-1}function K(aa,ba,oa){oa=Math.min(aa.length,oa);for(var ma=[];ba<oa;){var ea=aa[ba],ua=null,sa=239<ea?4:223<ea?3:191<ea?2:1;if(ba+sa<=oa)switch(sa){case 1:128>ea&&(ua=ea);break;case 2:var Fa=aa[ba+1];128===(Fa&192)&&(ea=(ea&31)<<6|Fa&63,127<ea&&(ua=ea));break;case 3:Fa=aa[ba+
1];var Pa=aa[ba+2];128===(Fa&192)&&128===(Pa&192)&&(ea=(ea&15)<<12|(Fa&63)<<6|Pa&63,2047<ea&&(55296>ea||57343<ea)&&(ua=ea));break;case 4:Fa=aa[ba+1];Pa=aa[ba+2];var Na=aa[ba+3];128===(Fa&192)&&128===(Pa&192)&&128===(Na&192)&&(ea=(ea&15)<<18|(Fa&63)<<12|(Pa&63)<<6|Na&63,65535<ea&&1114112>ea&&(ua=ea))}null===ua?(ua=65533,sa=1):65535<ua&&(ua-=65536,ma.push(ua>>>10&1023|55296),ua=56320|ua&1023);ma.push(ua);ba+=sa}aa=ma.length;if(aa<=T)ma=String.fromCharCode.apply(String,ma);else{oa="";for(ba=0;ba<aa;)oa+=
String.fromCharCode.apply(String,ma.slice(ba,ba+=T));ma=oa}return ma}function L(aa,ba,oa){if(0!==aa%1||0>aa)throw new RangeError("offset is not uint");if(aa+ba>oa)throw new RangeError("Trying to access beyond buffer length");}function S(aa,ba){ba=ba||Infinity;for(var oa,ma=aa.length,ea=null,ua=[],sa=0;sa<ma;++sa){oa=aa.charCodeAt(sa);if(55295<oa&&57344>oa){if(!ea){if(56319<oa){-1<(ba-=3)&&ua.push(239,191,189);continue}else if(sa+1===ma){-1<(ba-=3)&&ua.push(239,191,189);continue}ea=oa;continue}if(56320>
oa){-1<(ba-=3)&&ua.push(239,191,189);ea=oa;continue}oa=(ea-55296<<10|oa-56320)+65536}else ea&&-1<(ba-=3)&&ua.push(239,191,189);ea=null;if(128>oa){if(0>--ba)break;ua.push(oa)}else if(2048>oa){if(0>(ba-=2))break;ua.push(oa>>6|192,oa&63|128)}else if(65536>oa){if(0>(ba-=3))break;ua.push(oa>>12|224,oa>>6&63|128,oa&63|128)}else if(1114112>oa){if(0>(ba-=4))break;ua.push(oa>>18|240,oa>>12&63|128,oa>>6&63|128,oa&63|128)}else throw Error("Invalid code point");}return ua}function Q(aa){for(var ba=[],oa=0;oa<
aa.length;++oa)ba.push(aa.charCodeAt(oa)&255);return ba}function N(aa){var ba=X,oa=ba.toByteArray;aa=(aa.trim?aa.trim():aa.replace(/^\s+|\s+$/g,"")).replace(Y,"");if(2>aa.length)aa="";else for(;0!==aa.length%4;)aa+="=";return oa.call(ba,aa)}function O(aa,ba,oa,ma){for(var ea=0;ea<ma&&!(ea+oa>=ba.length||ea>=aa.length);++ea)ba[ea+oa]=aa[ea];return ea}var X=c(1014);c(1908);var U=c(1909);J.xNj=k;J.qdp=function(aa){+aa!=aa&&(aa=0);return k.Ush(+aa)};J.mbp=50;k.Vea=void 0!==l.Vea?l.Vea:e();J.Hmp=k.Vea?
2147483647:1073741823;k.from=function(aa,ba,oa){return x(null,aa,ba,oa)};k.Vea&&(k.prototype.__proto__=Uint8Array.prototype,k.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&k[Symbol.species]===k&&Object.defineProperty(k,Symbol.species,{value:null,configurable:!0}));k.Ush=function(aa){y(aa);return a(null,aa)};k.kCk=function(aa){return n(null,aa)};k.isBuffer=function(aa){return!(null==aa||!aa.y8j)};k.compare=function(aa,ba){if(!k.isBuffer(aa)||!k.isBuffer(ba))throw new TypeError("Arguments must be Buffers");
if(aa===ba)return 0;for(var oa=aa.length,ma=ba.length,ea=0,ua=Math.min(oa,ma);ea<ua;++ea)if(aa[ea]!==ba[ea]){oa=aa[ea];ma=ba[ea];break}return oa<ma?-1:ma<oa?1:0};k.cyi=function(aa){switch(String(aa).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};k.concat=function(aa,ba){if(!U(aa))throw new TypeError('"list" argument must be an Array of Buffers');if(0===aa.length)return k.Ush(0);
var oa;if(void 0===ba)for(oa=ba=0;oa<aa.length;++oa)ba+=aa[oa].length;ba=k.kCk(ba);var ma=0;for(oa=0;oa<aa.length;++oa){var ea=aa[oa];if(!k.isBuffer(ea))throw new TypeError('"list" argument must be an Array of Buffers');ea.copy(ba,ma);ma+=ea.length}return ba};k.byteLength=I;k.prototype.y8j=!0;k.prototype.toString=function(){var aa=this.length|0;return 0===aa?"":0===arguments.length?K(this,0,aa):E.apply(this,arguments)};k.prototype.equals=function(aa){if(!k.isBuffer(aa))throw new TypeError("Argument must be a Buffer");
return this===aa?!0:0===k.compare(this,aa)};k.prototype.compare=function(aa,ba,oa,ma,ea){if(!k.isBuffer(aa))throw new TypeError("Argument must be a Buffer");void 0===ba&&(ba=0);void 0===oa&&(oa=aa?aa.length:0);void 0===ma&&(ma=0);void 0===ea&&(ea=this.length);if(0>ba||oa>aa.length||0>ma||ea>this.length)throw new RangeError("out of range index");if(ma>=ea&&ba>=oa)return 0;if(ma>=ea)return-1;if(ba>=oa)return 1;ba>>>=0;oa>>>=0;ma>>>=0;ea>>>=0;if(this===aa)return 0;var ua=ea-ma,sa=oa-ba,Fa=Math.min(ua,
sa);ma=this.slice(ma,ea);aa=aa.slice(ba,oa);for(ba=0;ba<Fa;++ba)if(ma[ba]!==aa[ba]){ua=ma[ba];sa=aa[ba];break}return ua<sa?-1:sa<ua?1:0};k.prototype.includes=function(aa,ba,oa){return-1!==this.indexOf(aa,ba,oa)};k.prototype.indexOf=function(aa,ba,oa){return H(this,aa,ba,oa,!0)};k.prototype.lastIndexOf=function(aa,ba,oa){return H(this,aa,ba,oa,!1)};k.prototype.write=function(aa,ba,oa,ma){if(void 0===ba)ma="utf8",oa=this.length,ba=0;else if(void 0===oa&&"string"===typeof ba)ma=ba,oa=this.length,ba=
0;else if(isFinite(ba))ba|=0,isFinite(oa)?(oa|=0,void 0===ma&&(ma="utf8")):(ma=oa,oa=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ea=this.length-ba;if(void 0===oa||oa>ea)oa=ea;if(0<aa.length&&(0>oa||0>ba)||ba>this.length)throw new RangeError("Attempt to write outside buffer bounds");ma||(ma="utf8");for(ea=!1;;)switch(ma){case "hex":ba=Number(ba)||0;ma=this.length-ba;oa?(oa=Number(oa),oa>ma&&(oa=ma)):oa=ma;ma=aa.length;if(0!==ma%2)throw new TypeError("Invalid hex string");
oa>ma/2&&(oa=ma/2);for(ma=0;ma<oa;++ma){ea=parseInt(aa.substr(2*ma,2),16);if(isNaN(ea))break;this[ba+ma]=ea}return ma;case "utf8":case "utf-8":return O(S(aa,this.length-ba),this,ba,oa);case "ascii":return O(Q(aa),this,ba,oa);case "latin1":case "binary":return O(Q(aa),this,ba,oa);case "base64":return O(N(aa),this,ba,oa);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ma=aa;ea=this.length-ba;for(var ua=[],sa=0;sa<ma.length&&!(0>(ea-=2));++sa){var Fa=ma.charCodeAt(sa);aa=Fa>>8;Fa%=256;ua.push(Fa);
ua.push(aa)}return O(ua,this,ba,oa);default:if(ea)throw new TypeError("Unknown encoding: "+ma);ma=(""+ma).toLowerCase();ea=!0}};k.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.Sep||this,0)}};var T=4096;k.prototype.slice=function(aa,ba){var oa=this.length;aa=~~aa;ba=void 0===ba?oa:~~ba;0>aa?(aa+=oa,0>aa&&(aa=0)):aa>oa&&(aa=oa);0>ba?(ba+=oa,0>ba&&(ba=0)):ba>oa&&(ba=oa);ba<aa&&(ba=aa);if(k.Vea)ba=this.subarray(aa,ba),ba.__proto__=k.prototype;else{oa=ba-aa;ba=new k(oa,
void 0);for(var ma=0;ma<oa;++ma)ba[ma]=this[ma+aa]}return ba};k.prototype.WQn=function(aa){L(aa,2,this.length);return this[aa]<<8|this[aa+1]};k.prototype.KQn=function(){L(void 0,4,this.length);return this[void 0]|this[NaN]<<8|this[NaN]<<16|this[NaN]<<24};k.prototype.copy=function(aa,ba,oa,ma){oa||(oa=0);ma||0===ma||(ma=this.length);ba>=aa.length&&(ba=aa.length);ba||(ba=0);0<ma&&ma<oa&&(ma=oa);if(ma===oa||0===aa.length||0===this.length)return 0;if(0>ba)throw new RangeError("targetStart out of bounds");
if(0>oa||oa>=this.length)throw new RangeError("sourceStart out of bounds");if(0>ma)throw new RangeError("sourceEnd out of bounds");ma>this.length&&(ma=this.length);aa.length-ba<ma-oa&&(ma=aa.length-ba+oa);var ea=ma-oa;if(this===aa&&oa<ba&&ba<ma)for(ma=ea-1;0<=ma;--ma)aa[ma+ba]=this[ma+oa];else if(1E3>ea||!k.Vea)for(ma=0;ma<ea;++ma)aa[ma+ba]=this[ma+oa];else Uint8Array.prototype.set.call(aa,this.subarray(oa,oa+ea),ba);return ea};k.prototype.fill=function(aa,ba,oa,ma){if("string"===typeof aa){"string"===
typeof ba?(ma=ba,ba=0,oa=this.length):"string"===typeof oa&&(ma=oa,oa=this.length);if(1===aa.length){var ea=aa.charCodeAt(0);256>ea&&(aa=ea)}if(void 0!==ma&&"string"!==typeof ma)throw new TypeError("encoding must be a string");if("string"===typeof ma&&!k.cyi(ma))throw new TypeError("Unknown encoding: "+ma);}else"number"===typeof aa&&(aa&=255);if(0>ba||this.length<ba||this.length<oa)throw new RangeError("Out of range index");if(oa<=ba)return this;ba>>>=0;oa=void 0===oa?this.length:oa>>>0;aa||(aa=0);
if("number"===typeof aa)for(ma=ba;ma<oa;++ma)this[ma]=aa;else for(aa=k.isBuffer(aa)?aa:S((new k(aa,ma)).toString()),ea=aa.length,ma=0;ma<oa-ba;++ma)this[ma+ba]=aa[ma%ea];return this};var Y=/[^+\/0-9A-Za-z-_]/g}).call(this,c(1225))},1908:function(D,J){J.read=function(c,l,e,a,k){var x=8*k-a-1;var y=(1<<x)-1,n=y>>1,t=-7;k=e?k-1:0;var z=e?-1:1,v=c[l+k];k+=z;e=v&(1<<-t)-1;v>>=-t;for(t+=x;0<t;e=256*e+c[l+k],k+=z,t-=8);x=e&(1<<-t)-1;e>>=-t;for(t+=a;0<t;x=256*x+c[l+k],k+=z,t-=8);if(0===e)e=1-n;else{if(e===
y)return x?NaN:Infinity*(v?-1:1);x+=Math.pow(2,a);e-=n}return(v?-1:1)*x*Math.pow(2,e-a)};J.write=function(c,l,e,a,k,x){var y,n=8*x-k-1,t=(1<<n)-1,z=t>>1,v=23===k?Math.pow(2,-24)-Math.pow(2,-77):0;x=a?0:x-1;var I=a?1:-1,E=0>l||0===l&&0>1/l?1:0;l=Math.abs(l);isNaN(l)||Infinity===l?(l=isNaN(l)?1:0,a=t):(a=Math.floor(Math.log(l)/Math.LN2),1>l*(y=Math.pow(2,-a))&&(a--,y*=2),l=1<=a+z?l+v/y:l+v*Math.pow(2,1-z),2<=l*y&&(a++,y/=2),a+z>=t?(l=0,a=t):1<=a+z?(l=(l*y-1)*Math.pow(2,k),a+=z):(l=l*Math.pow(2,z-1)*
Math.pow(2,k),a=0));for(;8<=k;c[e+x]=l&255,x+=I,l/=256,k-=8);a=a<<k|l;for(n+=k;0<n;c[e+x]=a&255,x+=I,a/=256,n-=8);c[e+x-I]|=128*E}},1909:function(D){var J={}.toString;D.exports=Array.isArray||function(c){return"[object Array]"==J.call(c)}},1910:function(D,J,c){c.r(J);c.d(J,"ExtensionComponentInstance",function(){return k});D=c(0);c(1765);var l=c(1767);c(1665);var e=c(2),a=c(12);class k{constructor(x,y,n,t){this.OUb=this.YL=null;this._id=x;this.h_j=n;this.M7j=t;this.ga=e.AFrameworkApplication.va?e.AFrameworkApplication.va:
null}Dpf(){return this.h_j}get appVersion(){return this.OUb}Jgo(x){this.YL=x}stop(){const x=this.ga.Qb(a.a.cGh,2,this.YL);l.a.instance.t0n(this.M7j);return 32===x}restart(){return 32===this.ga.Qb(a.a.jfj,2,this.YL)}}Object(D.a)(k,"ExtensionComponentInstance",null,[1281])},1911:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.Tyj="Taskpane";l.action="Action";l.zco="SDXDialog";Object(D.a)(l,"ComponentTypeNames",null,[])},1912:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,
a,k,x){this._id=e;this.Clk=a;this.oyd=k;this.OUb=x}getId(){return this._id}getStoreId(){return this.Clk}getStoreType(){return this.oyd}}Object(D.a)(l,"ExtensionIdentity",null,[1272])},1913:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k){this.Z5g=k}}Object(D.a)(l,"HostProperties",null,[])},1914:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.optionalProperties={};this.$Lc={}}}Object(D.a)(l,"ExtensionLaunchProperties",null,[])},1915:function(D,
J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1916),J);e(c(1917),J)},1916:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1917:function(D,J,c){Object.defineProperty(J,
"__esModule",{value:!0});J.Security=J.DLP=J.CLP=J.SecurityShared=J.SeedAnnotation=J.EditAnnotation=J.SensitiveItemFullDocumentAnnotation=J.SensitiveItemRangeAnnotation=void 0;const l=c(196);class e{constructor(v){l.SchemaObject.assign(e,this,v)}get metadata(){return this.M_}set metadata(v){this.M_=v}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemRangeAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}}J.SensitiveItemRangeAnnotation=
e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(v){l.SchemaObject.assign(a,this,v)}get metadata(){return this.M_}set metadata(v){this.M_=v}static getTypeName(){return"AugLoop_SecurityShared_SensitiveItemFullDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}J.SensitiveItemFullDocumentAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(v){l.SchemaObject.assign(k,this,v)}get metadata(){return this.M_}set metadata(v){this.M_=v}static getTypeName(){return"AugLoop_SecurityShared_EditAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
J.EditAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(v){l.SchemaObject.assign(x,this,v)}get metadata(){return this.M_}set metadata(v){this.M_=v}static getTypeName(){return"AugLoop_SecurityShared_SeedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}J.SeedAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(v){l.SchemaObject.assign(y,this,v)}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}
J.SecurityShared=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class n{constructor(v){l.SchemaObject.assign(n,this,v)}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}J.CLP=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class t{constructor(v){l.SchemaObject.assign(t,this,v)}static getTypeName(){return"AugLoop_SecurityShared_DLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}J.DLP=t;t.H_={T_:t.getTypeName(),
B_:t.getBaseTypes()};class z{constructor(v){l.SchemaObject.assign(z,this,v)}static getTypeName(){return"AugLoop_SecurityShared_Security"}static getBaseTypes(){return[]}}J.Security=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()}},1918:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1919:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsExampleAnotherCustomAnnotation=J.RoamingSettingsExampleCustomAnnotation=J.RoamingSettingAnnotation=void 0;const l=c(196);
class e{constructor(x){l.SchemaObject.assign(e,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[e.getTypeName()])}}J.RoamingSettingAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=
x}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}J.RoamingSettingsExampleCustomAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsExampleAnotherCustomAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[k.getTypeName()])}}J.RoamingSettingsExampleAnotherCustomAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1920:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingType=void 0;D=J.RoamingSettingType||(J.RoamingSettingType={});D.SingleValue="SingleValue";D.Dictionary="Dictionary"},1921:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.RoamingSettingsWriteSignal=J.RoamingSettingsReadSignal=J.RoamingSettingsSignal=void 0;const l=c(196);class e{constructor(x){l.SchemaObject.assign(e,
this,x)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[e.getTypeName()])}}J.RoamingSettingsSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsReadSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal",
"AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}J.RoamingSettingsReadSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}static getTypeName(){return"AugLoop_RoamingSettings_RoamingSettingsWriteSignal"}static getBaseTypes(){return["AugLoop_RoamingSettings_RoamingSettingsSignal","AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}J.RoamingSettingsWriteSignal=
k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1922:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,
"__esModule",{value:!0});e(c(1923),J);e(c(1924),J);e(c(1925),J);e(c(1926),J);e(c(1927),J);e(c(1928),J);e(c(1929),J);e(c(1930),J)},1923:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1924:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1925:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1926:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1927:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChatResponse=void 0;
const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_BasicChatResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextChatResponse","AugLoop_Chat_ChatResponse","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.BasicChatResponse=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1928:function(D,J,c){Object.defineProperty(J,
"__esModule",{value:!0});J.DslResponse=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_BasicChat_DslResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.DslResponse=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1929:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.BasicChat=
void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_BasicChat_BasicChat"}static getBaseTypes(){return["AugLoop_Chat_Chat"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.BasicChat=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1930:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.DslInput=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_BasicChat_DslInput"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}J.DslInput=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1931:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1932),J);e(c(1933),J);e(c(1934),J);e(c(1935),J);e(c(1936),J);e(c(1937),J);e(c(1938),J);e(c(1939),J);e(c(1940),J);e(c(1941),J);e(c(1942),J)},1932:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1933:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.OpenAiImageStatus=J.ChatRole=J.CompletionStatus=void 0;(function(c){c[c.Success=0]="Success";c[c.OffensiveContentInput=1]="OffensiveContentInput";c[c.OffensiveContentOutput=
2]="OffensiveContentOutput";c[c.EmptyResponse=3]="EmptyResponse";c[c.ErrorInExecution=4]="ErrorInExecution";c[c.ResourcesNotAvailable=5]="ResourcesNotAvailable";c[c.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput";c[c.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput";c[c.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList";c[c.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList";c[c.InputAttackDetected=10]=
"InputAttackDetected";c[c.OutputAttackDetected=11]="OutputAttackDetected";c[c.PartialResult=13]="PartialResult";c[c.ModelContentFilter=14]="ModelContentFilter";c[c.Unknown=15]="Unknown";c[c.Overloaded=16]="Overloaded";c[c.Timeout=17]="Timeout";c[c.TooLargeRequest=18]="TooLargeRequest";c[c.BadRequest=19]="BadRequest";c[c.InternalServerError=20]="InternalServerError";c[c.UserNotAuthenticated=21]="UserNotAuthenticated";c[c.UserNotAuthorized=22]="UserNotAuthorized"})(J.CompletionStatus||(J.CompletionStatus=
{}));(function(c){c.System="system";c.User="user";c.Assistant="assistant"})(J.ChatRole||(J.ChatRole={}));(function(c){c.NotStarted="NotStarted";c.Running="Running";c.Succeeded="Succeeded"})(J.OpenAiImageStatus||(J.OpenAiImageStatus={}))},1934:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1935:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1936:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.OpenAiModel=void 0;D=J.OpenAiModel||(J.OpenAiModel={});
D[D.TextChatDavinci002=0]="TextChatDavinci002";D[D.TextDavinci001=1]="TextDavinci001";D[D.TextDavinci002=2]="TextDavinci002";D[D.TextDavinci003=3]="TextDavinci003";D[D.TextCurie001=4]="TextCurie001";D[D.TextBabbage001=5]="TextBabbage001";D[D.TextAda001=6]="TextAda001";D[D.CodeDavinci002=7]="CodeDavinci002";D[D.CodeCushman001=8]="CodeCushman001";D[D.Custom=9]="Custom";D[D.TextSimilarityAda001=10]="TextSimilarityAda001";D[D.TextSimilarityBabbage001=11]="TextSimilarityBabbage001";D[D.TextSimilarityCurie001=
12]="TextSimilarityCurie001";D[D.TextSimilarityDavinci001=13]="TextSimilarityDavinci001";D[D.TextSearchAdaDoc001=14]="TextSearchAdaDoc001";D[D.TextSearchAdaQuery001=15]="TextSearchAdaQuery001";D[D.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001";D[D.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001";D[D.TextSearchCurieDoc001=18]="TextSearchCurieDoc001";D[D.TextSearchCurieQuery001=19]="TextSearchCurieQuery001";D[D.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001";D[D.TextSearchDavinciQuery001=
21]="TextSearchDavinciQuery001";D[D.CodeSearchAdaCode001=22]="CodeSearchAdaCode001";D[D.CodeSearchAdaText001=23]="CodeSearchAdaText001";D[D.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001";D[D.CodeSearchBabbageText001=25]="CodeSearchBabbageText001";D[D.TextEmbeddingAda002=26]="TextEmbeddingAda002";D[D.Gpt35Turbo=27]="Gpt35Turbo";D[D.Gpt4_32k=28]="Gpt4_32k"},1937:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1938:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},
1939:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.TextChatResponse=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_GenerativeAi_TextChatResponse"}static getBaseTypes(){return["AugLoop_Chat_ChatResponse","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.TextChatResponse=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},
1940:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.ImageCompletion=J.ImagePrompt=J.ChatCompletion=J.TextCompletion=J.OpenAiEmbedding=J.Completion=J.TemplatedTextPrompt=J.ChatPrompt=J.TextPrompt=J.Prompt=void 0;const l=c(196);class e{constructor(E){l.SchemaObject.assign(e,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_Prompt"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[e.getTypeName()])}}J.Prompt=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(E){l.SchemaObject.assign(a,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_TextPrompt"}static getBaseTypes(){return["AugLoop_GenerativeAi_Prompt","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[a.getTypeName()])}}J.TextPrompt=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(E){l.SchemaObject.assign(k,
this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_ChatPrompt"}static getBaseTypes(){return["AugLoop_GenerativeAi_Prompt","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[k.getTypeName()])}}J.ChatPrompt=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(E){l.SchemaObject.assign(x,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_TemplatedTextPrompt"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextPrompt",
"AugLoop_GenerativeAi_Prompt","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[x.getTypeName()])}}J.TemplatedTextPrompt=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(E){l.SchemaObject.assign(y,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_Completion"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[y.getTypeName()])}}
J.Completion=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class n{constructor(E){l.SchemaObject.assign(n,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiEmbedding"}static getBaseTypes(){return["AugLoop_GenerativeAi_Completion","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[n.getTypeName()])}}J.OpenAiEmbedding=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class t{constructor(E){l.SchemaObject.assign(t,
this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_TextCompletion"}static getBaseTypes(){return["AugLoop_GenerativeAi_Completion","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[t.getTypeName()])}}J.TextCompletion=t;t.H_={T_:t.getTypeName(),B_:t.getBaseTypes()};class z{constructor(E){l.SchemaObject.assign(z,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_ChatCompletion"}static getBaseTypes(){return["AugLoop_GenerativeAi_TextCompletion",
"AugLoop_GenerativeAi_Completion","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[z.getTypeName()])}}J.ChatCompletion=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class v{constructor(E){l.SchemaObject.assign(v,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_ImagePrompt"}static getBaseTypes(){return["AugLoop_GenerativeAi_Prompt","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[v.getTypeName()])}}J.ImagePrompt=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class I{constructor(E){l.SchemaObject.assign(I,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_GenerativeAi_ImageCompletion"}static getBaseTypes(){return["AugLoop_GenerativeAi_Completion","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[I.getTypeName()])}}J.ImageCompletion=I;I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()}},1941:function(D,
J,c){Object.defineProperty(J,"__esModule",{value:!0});J.ModelConfig=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_GenerativeAi_ModelConfig"}static getBaseTypes(){return[]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}J.ModelConfig=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1942:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.OpenAiChatModelConfig=J.OpenAiEmbeddingsModelConfig=
J.OpenAiTextModelConfig=J.OpenAiModelConfig=void 0;const l=c(196);class e{constructor(y){l.SchemaObject.assign(e,this,y)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[e.getTypeName()])}}J.OpenAiModelConfig=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(y){l.SchemaObject.assign(a,this,y)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiTextModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,
[a.getTypeName()])}}J.OpenAiTextModelConfig=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(y){l.SchemaObject.assign(k,this,y)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiEmbeddingsModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_OpenAiModelConfig","AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[k.getTypeName()])}}J.OpenAiEmbeddingsModelConfig=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(y){l.SchemaObject.assign(x,
this,y)}static getTypeName(){return"AugLoop_GenerativeAi_OpenAiChatModelConfig"}static getBaseTypes(){return["AugLoop_GenerativeAi_ModelConfig"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[x.getTypeName()])}}J.OpenAiChatModelConfig=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},1987:function(D,J,c){c.r(J);D=c(0);var l=c(2),e=c(93),a=c(22),k=c(17),x=c(8),y=c(5),n=c(91),t=c(33),z=c(75);class v{constructor(ba){this.Q5g=null;this.listId=ba}get X0(){return this.Q5g}zlo(ba){this.Q5g=
ba}}Object(D.a)(v,"List",null,[]);class I{constructor(ba,oa,ma,ea,ua=0){this.listId=ba;this.data=oa;this.RXd=ma;this.outlineElementNode=ea;this.cQk=ua}}Object(D.a)(I,"ListNode",null,[]);class E{constructor(ba,oa,ma,ea,ua,sa){this.xcb=null;this.iga=0;this.seb=this.dye=this.T6=this.wtc=null;this.Szd=this.VWe=0;this.frn=(Fa,Pa)=>{2===this.iga&&E.fO===Pa.requestId&&(Fa=this.Gak.wLl(Pa),this.zkg(Fa)?(this.jZb.$On(Fa),this.iga=3):(this.Rjc(),this.Sjc()))};this.C2c=(Fa,Pa)=>{this.dye=Pa.B2m};this.Dnn=(Fa,
Pa)=>{3===this.iga?Pa.sourceId!==this.T6.listId?this.Uac():this.bKe.iId(Pa,this.T6,this.dye):4===this.iga?2===this.VWe?this.bKe.p6f(Pa,this.seb,this.Szd):this.Uac():(this.Rjc(),this.Sjc())};this.wnn=(Fa,Pa)=>{this.iga=4;this.seb=Pa.node;this.VWe=Pa.bne;this.Szd=Pa.ane};this.yDo=Fa=>{Fa!==this.xcb||1!==this.iga?(this.xcb=null,this.Rjc(),this.Sjc()):(this.xcb=null,this.QPo()?(this.bKe.d6n(this.T6,++E.fO),this.iga=2):(this.Rjc(),this.iga=0))};this.jZb=ba;this.bKe=oa;this.Gak=ma;this.Ib=ua;this.b2m=sa.nc("WordListExtractionTaskDelayTime",
2500)}Ub(){this.jZb.Ixk(this.frn);this.jZb.Wqh(this.C2c);this.jZb.rxk(this.Dnn);this.jZb.pxk(this.wnn)}C6n(){this.Sjc();this.Rjc();this.Vej()}Rjc(){this.dye=this.T6=this.wtc=null}Vej(){this.seb=null;this.Szd=this.VWe=0}WY(ba,oa){oa.yl&&oa.yl.lb&&(ba=oa.yl.lb,k.SelectionEditor.Pl(ba)?(ba=ba.Pa.node,x.ParagraphReader.Xb(ba)&&x.ParagraphReader.HR(ba)?this.dqm(ba):4===this.iga&&this.oXm()&&this.NPm(ba)||this.Uac()):this.Uac())}dqm(ba){switch(this.iga){case 1:this.Sjc();break;case 3:if(!this.juo(ba))return;
this.Uac();break;case 4:this.Uac()}this.wtc=ba;this.tAm()}juo(ba){if(!this.wtc||!this.T6||0>=this.T6.X0.length)return!0;const oa=y.GraphIterator.eb(ba);oa.od();oa.jd(11);var ma=n.ListItemReader.e9(oa);ma=n.ListItemReader.Nj?n.ListItemReader.cE(ma):x.ParagraphReader.Jd.fP(ma,!1,!1);if(ma.listId!==this.T6.listId||ma.listLevel!==this.T6.X0[0].RXd)return!0;for(ma=0;ma<this.T6.X0.length;++ma){const ea=this.T6.X0[ma];if(ea.outlineElementNode.id.equals(oa.currentNode.id)&&ea.data===ba.characterData)return!1}return!0}NPm(ba){ba=
ba.bF;return!!ba&&ba===this.seb}oXm(){if(!this.seb||!t.TableReader.LR(this.seb))return!1;const ba=t.TableReader.gg(this.seb),oa=t.TableReader.hh(this.seb);let ma=0,ea=0;switch(this.Szd){case 1:ma=this.T6.X0.length;ea=2;break;case 2:ma=2,ea=this.T6.X0.length}return ba===ma&&oa===ea}QPo(){const ba=[];var oa=y.GraphIterator.eb(this.wtc);oa.od();oa.jd(11);var ma=!1;let ea=!1;const ua=({rpg:ma}=this.lci(oa,ma)).returnValue;if(!ua||ma)return!1;this.T6=new v(ua.listId);ba.push(ua);ma=y.GraphIterator.eb(oa.currentNode);
oa=y.GraphIterator.eb(oa.currentNode);ma.od();for(oa.od();ma.MVd();)if(!({U7b:ea}=this.zCj(ma,ba,ea)).returnValue)return!1;ba.reverse();for(ea=!1;oa.HSc();)if(!({U7b:ea}=this.zCj(oa,ba,ea)).returnValue)return!1;if(2>ba.length)return!1;this.T6.zlo(ba);return!0}zCj(ba,oa,ma){let ea=!1;const ua=({rpg:ea}=this.lci(ba,ea)).returnValue;if(!ua)return this.v2m(ba)?{returnValue:!1,U7b:ma}:{returnValue:!0,U7b:!0};if(ua.listId!==this.T6.listId)return{returnValue:!0,U7b:!0};if(ma||ea||oa[0].RXd!==ua.RXd)return{returnValue:!1,
U7b:ma};oa.push(ua);return{returnValue:!0,U7b:ma}}lci(ba,oa){if(!n.ListItemReader.lg(ba))return{returnValue:null,rpg:oa};const ma=x.ParagraphReader.$k(ba.currentNode);oa=!this.IQm(ma);var ea=n.ListItemReader.e9(ba);ea=n.ListItemReader.Nj?n.ListItemReader.cE(ea):x.ParagraphReader.Jd.fP(ea,!1,!1);return{returnValue:new I(ea.listId,ma.characterData,ea.listLevel,ba.currentNode),rpg:oa}}IQm(ba){if(""===ba.characterData.trim()||x.ParagraphReader.N0(ba)||y.GraphIterator.eb(ba).Tb(6))return!1;for(let oa=
0;oa<ba.ra.length;++oa)if(ba.ra.J(oa).blob)return!1;return!0}v2m(ba){const oa=new z.a;x.ParagraphReader.Bjb(ba,!0,!0,oa);for(const ma of oa)if(ba=y.GraphIterator.eb(ma),ba.od(),ba.jd(11),n.ListItemReader.lg(ba)&&(ba=n.ListItemReader.e9(ba),(n.ListItemReader.Nj?n.ListItemReader.cE(ba):x.ParagraphReader.Jd.fP(ba,!1,!1)).listId===this.T6.listId))return!0;return!1}tAm(){this.wtc&&(this.xcb=new e.a(4,1,this.b2m,this.yDo,144),this.Ib.Wb(this.xcb),this.iga=1)}Sjc(){this.xcb&&(this.Ib.ff(this.xcb),this.xcb=
null);this.iga=0}Uac(){3!==this.iga&&4!==this.iga||this.jZb.SOn();this.Sjc();this.Rjc();this.Vej()}zkg(ba){return!!ba&&!!ba.x_c&&0<ba.x_c.length}static j4l(){return new E(a.a.instance.resolve("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionEventManager"),a.a.instance.resolve("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionRequestManager"),a.a.instance.resolve("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionGenerator"),a.a.instance.resolve("Box4.ISelectionManager"),
l.AFrameworkApplication.lc,l.AFrameworkApplication.K)}}E.fO=0;Object(D.a)(E,"ListTransformationSuggestionActor",null,[]);var H=c(81);class M{constructor(){this.WHi="ListTransformationInsightsAvailableEventKey";this.YHi="ListTransformationSuggestionsAvailableEventKey";this.OIh="ConstructTableFromListEventKey";this.YHh="CompletingTransformationEventKey";this.cpi="HideListTransformationCardEventKey";this.sa=new H.a}a7i(ba){this.sa.raiseEvent(this.WHi,ba)}Ixk(ba){this.sa.addHandler(this.WHi,ba)}$On(ba){this.sa.raiseEvent(this.YHi,
ba)}Wqh(ba){this.sa.addHandler(this.YHi,ba)}COn(ba){this.sa.raiseEvent(this.OIh,ba)}rxk(ba){this.sa.addHandler(this.OIh,ba)}AOn(ba){this.sa.raiseEvent(this.YHh,ba)}pxk(ba){this.sa.addHandler(this.YHh,ba)}SOn(){this.sa.raiseEvent(this.cpi)}zxk(ba){this.sa.addHandler(this.cpi,ba)}}Object(D.a)(M,"ListTransformationSuggestionEventManager",null,[986]);var K=c(903);class L{constructor(ba,oa,ma,ea){this.bne=ba;this.ane=oa;this.thumbnail=ma;this.styleId=ea}}Object(D.a)(L,"ListTransformationSuggestion",null,
[]);class S extends Sys.EventArgs{constructor(ba,oa,ma){super();this.listId=ba;this.B2m=oa;this.x_c=ma}}Object(D.a)(S,"ListTransformationSuggestionsAvailableArgs",Sys.EventArgs,[]);var Q=c(1769);class N{constructor(ba,oa){this.tEc=ba;this.KGe=oa.$("WordListToTableTransformationIsEnabled")}wLl(ba){try{const oa=this.tEc.hfm(ba.C2m);if(!oa||1!==oa.response)return null;const ma=this.XAl(oa);if(!ma||0>=ma.length)return null;const ea=this.RLl();return!ea||0>=ea.length?null:new S(ba.listId,ma,ea)}catch(oa){return null}}RLl(){const ba=
[];this.KGe&&this.WLl(ba);return ba}WLl(ba){ba.push(new L(2,2,"iVBORw0KGgoAAAANSUhEUgAAApQAAAEJCAYAAAAq37c8AAAgAElEQVR4Ae29DbCdRZmo29xCCdHEILnyE0FSCqhBA1aYIpArKhBkPDpwD6EGi1KwMlx/uIDMhFGxoKQGqTElcLiIDJMSrqNwijgDeuA4BJHBAsIZKAMMiBE9QTQQPOESE4mRsWrfejq8a3p/fOtvr7Wz19rr6aq9v7/ut7uffr/u93u7v/XtNjY2NpYMEpCABCQgAQlIQAISmCCB/22C6UwmAQlIQAISkIAEJCCBTECDUkWQgAQkIAEJSEACEuiJgAZlT/hMLAEJSEACEpCABCSgQakOSEACEpCABCQgAQn0RECDsid8JpaABCQgAQlIQAIS0KBUByQgAQlIQAISkIAEeiKgQdkTPhNLQAISkIAEJCABCWhQqgMSkIAEJCABCUhAAj0R0KDsCZ+JJSABCUhAAhKQgAQ0KNUBCUhAAhKQgAQkIIGeCGhQ9oTPxBKQgAQkIAEJSEACGpTqgAQkIAEJSEACEpBATwQ0KHvCZ2IJSEACEpCABCQgAQ1KdUACEpCABCQgAQlIoCcCGpQ94TOxBCQgAQlIQAISkIAGpTogAQlIQAISkIAEJNATAQ3KnvCZWAISkIAEJCABCUhAg1IdkIAEJCABCUhAAhLoiYAGZU/4TCwBCUhAAhKQgAQkoEGpDkhAAhKQgAQkIAEJ9ERAg7InfCaWgAQkIAEJSEACEtCgVAckIAEJSEACEpCABHoioEHZEz4TS0ACEpCABCQgAQloUKoDEpCABCQgAQlIQAI9EdCg7AmfiSUgAQlIQAISkIAENCjVAQlIQAISkIAEJCCBngjs3lPqlNIJf3l/ryJMLwEJSEACEpCABCSwCwnc9dVj+prbbmNjY2N9lagwCUhAAhKQgAQkIIGRIuCU90g1t5WVgAQkIAEJSEAC/SegQdl/pkqUgAQkIAEJSEACI0VAg3KkmtvKSkACEpCABCQggf4T0KDsP1MlSkACEpCABCQggZEioEE5Us1tZSUgAQlIQAISkED/CWhQ9p+pEiUgAQlIQAISkMBIEdCgHKnmtrISkIAEJCABCUig/wQ0KPvPVIkSkIAEJCABCUhgpAhoUI5Uc1tZCUhAAhKQgAQk0H8CGpT9Z6pECUhAAhKQgAQkMFIENChHqrmtrAQkIAEJSEACEug/AQ3K/jNVogQkIAEJSEACEhgpAhqUI9XcVlYCEpCABCQgAQn0n4AGZf+ZKlECEpCABCQgAQmMFAENypFqbisrAQlIQAISkIAE+k9Ag7L/TJUoAQlIQAISkIAERoqABuVINbeVlYAEJCABCUhAAv0noEHZf6ZKlIAEJCABCUhAAiNFQINypJrbykpAAhKQgAQkIIH+E9Cg7D9TJUpAAhKQgAQkIIGRIqBBOVLNbWUlIAEJSEACEpBA/wloUPafqRIlIAEJSEACEpDASBHQoJxgc//+D/+ezrn8jvS+T9yQfvb0CxOUMjXJHnjkV+nwZV9Pl/39j6amAOY6aQRu+u//ltuWNjZIQAISmK4E2vV15XXGaMZqxmzG7mahTNMsjuebE9i9+aXpcwUl+coN96ULz1qSPvqn72pUDINq9Zon0rUX/ad09OEHNM5P9U6z8k51ucy/fwRe+O3v0/JLbksbNm4ZJ3TZ0gXpor9477hzU3FAp7viijXp8ad+k66/+CPpkIP2nopimOcuIlDVxzmzZkxKu6tXu6hBpzibGFvLYsyfNyet+tLJae837Fmebuw77jVQDO3OSBiUQ9s6FnzaE2jXyU57AFZwygngvTn70u+lvWbPSHevOjMP+Jy74bvr0sWfPDbtucdrpryMFmA4CQyKs4YH4n/5xlnDCXGISq1B+UpjxRP6h957SHpk/aZ034+fyVfKGyI63i3bdqSFh+77qmYur3Ox9DbxxPbc5m1p1sw90vfveyp7Sw/af0769GW3ZzlhWNx5/8+zN5WTeFWv/87D2VNwwH6zs8coyhXxedrjyW71msfTWScfkS7+2j1Z3pL3HJhWXrC0MRiUT4yUyzC4BOqe1Gm/u9b+oq0ulLUKfTzs4DdlXeBa1esYcdBpArpxwccWj9O101bckkp9KnVpsjxZZT3cn1wCq+96ItH+Xz73+Ib3iAH48vOOT/SLH/3r76RjF81P9z68Ib24dUfDc9lKD1hyEX0bpWd26JTj3t5Ur7bv+OM4j32pb5Nbe6XvagJlnxP9x8M/ebZ23EMPW+kZZf/J//xN+sLVP8g6XI6LZb1ifJ+3z+xxfWGMp9XZy1KmuliSbL3vGsoKn2tu/tf00ZPendZ+a/nOQfTG+3KnikL+9VVrEoMz1/6vUxelR9dvaqSOm+SExW9Nj6z+VJ5GZzod4yACyrtt+x9y+hOPeVtaeeN9OQ/k/e35S9P9636Zp+RRbgJbnqrCmKRcyL5l5Wm5Y7/ulodCdJ46XbP2F1k2RjB53Xr3T/P1nQbnzql98sKwNQwugUXv3D/R0T7w6DN5vQ+69/ATG7PuzX3jzDwot9KFTmuGzl626kfpH6/886xX6Bs6u+7JTbnTpSOlHOjbNZ//UH44CcOWc+gS9wP3BWU0DB+B0C0G4kPnz21agRu/uy4tW3pY7o9ikOcBp04PMCZv+v5jWT/or3hI4cH4V89trdWrMCYZ7NEpZLLU4opvrm1aHi8MJwGWPFx984MNbzh9z49+XD/uhZ7Nn7dX7p/wnuNFJ325DvKOH/0s92GMeywhKsfFZpQYGxkjSYOObt/x7+P6MJxK3//6Gfl6OZY2k+f5nQQ0KCuawCB6xDv2zYPnfnNnZcPthRe3p/UbNmdlPXrhgfkacYgbgScsnvLff+T8fIrOmU46jAJOMjife/pRDa8h5+g46Wi5eT7yvreHuHFbppwY0GOd5957zcw3FoZheWNhZBB37pyZOa8NG1/M1ylDDBhcJ55hMAjQAR63/Mb8Ik284MUDBIZa6Eape2+cvWdHutBJ7dC5//dvTml4pfCYE55+dvy6zpAVxgdlo4zoEvcDdaCMhuEjQN+G17FdoK/Dw0hopwf0U/EAQnwMAvrGzVu212ZT6jc6FfrPQ5QPKrXIhuYkXmpeAOWvdK5En8EM2/L/8z1N68N68njvYeaM3RMPHRuf35p4CImw4swluQ+LMbcbvbnnoQ1ZDGUo13bWjaWRn9vmBJzybs5m3JVmg2xEwngjlNM8HHMD1AWUlxuB+EwpEnhaCqOxmqY6hcT1ZrLLtNx43ICGwSTQbIoGQ40nYwZhdI+HETyXhInqQh2Bcjqp7np5LowPBoPFZ6wqL7k/pATi4bSb4rfTAx5yWVqB/nYSom9liQ9/Ebg3DMNNoG5Mw6nCw3KMldXp5rLGMfMXS3K41g+94OEIRwszMvzxwMQSMUNvBEbCoAzPSx0qBmo8eu1CKxmk5SmcUHcDNZON8Yi7PW4aponwfFYD11kjEmsyeWrnDeFOQvlU10l84wwGgZj2/m/3rs/LJMIr2IsuVGtWLoVAF+sM1TJNGB+UpVyfW8Zxf7gIRP+A8YensNkDbVmrdnrAQwoGA1PXeMHRs9JQLGWxH31rK8Oimsbj4SWATrCUK8Yx1v+zBKwauB7LzMLY40GlnYMERwt63SrgCceLToiHapb6GHojMBJT3uEKR3FjCoWBmTVAMVC3wxjTyDGFjfKVT+BhAIQLvZ088v/8f/lBnpKODjrSRAcbx9VtTBFVz9cdc+MwdR9TDHgPMFwNg00gpv14gQs9i6UW1VK30oXQq5giqupsVVapu6E3ZRy86osWzGtMxZfX3B9OArRzLIFhTXf0j2wZaHfU/GZfN3pAf0OfGaFOr6J/jr414rqdfgTQK34Lkm08zEQt2417LA3jQaUaQm+jL2S8Q89aBXSbB2hCOINaxfdaZwRam/GdyRj4WHSA/P4VXj3Wq0UIjx/H5ZqMuF5ueariLUjc9Ez34SI/5/Q/Sd+6fadxVl7HhR6h2VM38d918D6NqUPc+F/69AfyjRDrM8u3vM8+dVF+ykc2ccv1m5FXsy1v7bLeMqYYLv3M+9s+5TWT5fn+EsDQr9NJOsSY9i6nu9GbTnWhXFZBHlWdjWmf0Auul9NJy05YkB+6yre8Q5dimQY0SNPq9+X6S0xp/SaAVxJvIj8dFLqIzvH7ozOaDMyt9OCTpx2ZXyILHTlpycF5yUaUu06veCmR/MulFGX/HGndDheB6FsodfQTPMBU9Yy+qm7ci2Vh6AU6uXjhAemnG/5XAwIy+XWTkEcfhm62C+ho+TvAjNPcB7H8ol16r9cT2G1sbGys/pJnJSABCUhAAhKQgAQk0J7ASEx5t8dgDAlIQAISkIAEJCCBiRLQoJwoOdNJQAISkIAEJCABCWQCGpQqggQkIAEJSEACEpBATwQ0KHvCZ2IJSEACEpCABCQgAQ1KdUACEpCABCQgAQlIoCcCGpQ94TOxBCQgAQlIQAISkIAGpTogAQlIQAISkIAEJNATAQ3KnvCZWAISkIAEJCABCUhAg1IdkIAEJCABCUhAAhLoiYAGZU/4TCwBCUhAAhKQgAQkoEGpDkhAAhKQgAQkIAEJ9ERAg7InfCaWgAQkIAEJSEACEtCgVAckIAEJSEACEpCABHoioEHZEz4TS0ACEpCABCQgAQloUKoDEpCABCQgAQlIQAI9EdCg7AmfiSUgAQlIQAISkIAENCjVAQlIQAISkIAEJCCBnghoUPaEz8QSkIAEJCABCUhAAhqU6oAEJCABCUhAAhKQQE8ENCh7wmdiCUhAAhKQgAQkIAENSnVAAhKQgAQkIAEJSKAnAhqUPeEzsQQkIAEJSEACEpCABqU6IAEJSEACEpCABCTQE4Hde0qdUjrhL+/vVYTpJSABCUhAAhKQgAR2IYG7vnpMX3PbbWxsbKyvEhUmAQlIQAISkIAEJDBSBJzyHqnmtrISkIAEJCABCUig/wQ0KPvPVIkSkIAEJCABCUhgpAhoUI5Uc1tZCUhAAhKQgAQk0H8CGpT9Z6pECUhAAhKQgAQkMFIENChHqrmtrAQkIAEJSEACEug/AQ3K/jNVogQkIAEJSEACEhgpAhqUI9XcVlYCEpCABCQgAQn0n4AGZf+ZKlECEpCABCQgAQmMFAENypFqbisrAQlIQAISkIAE+k9Ag7L/TJUoAQlIQAISkIAERoqABuVINbeVlYAEJCABCUhAAv0noEHZf6ZKlIAEJCABCUhAAiNFQINypJrbykpAAhKQgAQkIIH+E9Cg7D9TJUpAAhKQgAQkIIGRIqBBOVLNbWUlIAEJSEACEpBA/wloUPafqRIlIAEJSEACEpDASBHQoByp5rayEpCABCQgAQlIoP8ENCj7z1SJEpCABCQgAQlIYKQIaFCOVHNbWQlIQAISkIAEJNB/AhqU/WeqRAlIQAISkIAEJDBSBDQoR6q5rawEJCABCUhAAhLoPwENyv4zVaIEJCABCUhAAhIYKQIalDXN/bOnX0gnn3dzYjtM4bK//1Hir5Pwwm9/nz7+xVuHro6d1G3Q48h+0FvI8klAAhBo11c98Miv0jmX35F+/4d/7wgY8YhPOsP0IzD0BuVN//3fahWa850aV7uqWTFQMeK4SXd1gAVMDN0RiA7w8GVfT+XfoLDc1e2K7p5y/s1tdamq652m6651hjs2jN73iRsaetXNwNxNzatt0U3aqY6LfgeXdsbNZJd10DhOtG+arD4j9LmfxuIgjuOTrWfDLH/3YS68ZZfAriJw4VlL0kf/9F27KruBzWfvN+yZbr3q9K7LN9F0XWc0JAkYdL9w9Q/S9Rd/JB1y0N651Ayet979U/WsaMOL/uK9jaPtO/7Y2HfnPwgMSt+EHv/LN876j4K5N3IERsKg5Mn2kmt/mD560rtzJ75l24605D0HppUXLE177vGa7K5fccWadN+Pn8kKcM7pfzJOEUi//JLb0oaNW/L5ZUsXpOjoGAS273g5PbJ+U05/7UX/KR06f+64+NzwhK/ccF/eHrf8xkb+v3puazr70u8lykQg/dGHH5D3wwu2YeOLafWaJ151nUHp05fdns9Tn1kz90ivn/nafBz/qmWnDFFG4vz06f/VyL9kwjXyjzLPmTVj3OAX8kd5C/+VN96XVn3p5ITBFMweePSZrFvrntzUaJ9W/PAYEEKneNK/8Mo16SufXZqNjbKdQ87ee80cp2PRrugO6UudajXgNGtjyvTc5m2Ne4R46OEFH1ucuFe4l8irql/NdP3Sz3wgXfy1nfcg6ajTPQ9tSPPn7dXQsbKcZZ0znJRSed/FuWHcwgy9+fK5xzeMSeoRDyxcp79auvit6eKv3dPoKzComvVDeKvKPixYle1b9jutZJVMm5Wl2m+VbUd69Cf6rLIs1b7y6We3pLhf6ItDn1acuSTrV+jd+4+c37iXTltxS5o/b06+79Zv2FyrRwftP6cRP/KPepVlCzncv610shlHyjyooSwz9Vz5lyemFV+9szGOlX1Geb9FHxMPOtSvHCdKZmXdabsLVv5zumj5e7NeV/shxp0j3rFvTrJ5y0t5poMxtU5eVZ/RJXTsxGPeVntvVPUxxlHkXHrdvenDxx6a77m6/Ep9iDGQvrvaP5V6VFe3ctyu6jnXynzKOrfSu+BbpqUcy05YMG6MIB5yquNRpN9l27EhD9++47Gxz3z59rHtO14eVxPO/8319+Zzm7dsHzv5vJsa8eKYOIRSBnKQd+xZ3xhbv2FzlstxxI209697ppF24anXjsUxJ8k34udIr/xD3scu+qcxZBDYIjuOkUE54xgZpWyO4zpx2I982RI36lzmy361TJE+2MVxlLuuLBG3Kns6H4c+BJeyrsEs2qCMS1t/7qq7GnpJ+uBHOvSAOATapmw3zv/ZuTfl663kRNqybNUylbLKsrPfqo1DDrJLGVHHqHNVryIP0pS6Xk1HevQ1ys5x3HNVPsQp+UQew7qtsqnWI9iHvnA9+AWviFO2Q+xXr1XzayerLE/IKssS5yK/Uj9ISxnL+Ff+w9qsQ5wv+7O6uFXZZdtzrbxvSE8ZqnrEceRP2dCrKGu1bOW9VycrdJK8qhw5N5Wh2o5lWVqVtXrPErdVX1WOnZFn3I8wC9Zl+0S84B5li/MxjsVxyIt4sS3bn3OhH5FnnOOYawTyrMqvHkd+Zflz4lf+cb7Uq8iX8+w3y4/kneg5+ZdlKPMij1LvqjrL/fTY+k25DFyLUMqMc7t6O/RrKDu1vGe/fkY69/SjskeSp9FFC+ZljwtPMDwh43HhaZM/4vGURuDJZ9tLL+cnI45Ju2zpYfnpJfLmiSGeTuIcMpHdKiDrms9/qOHdmjtnZhobS+mFF7c3kpWyF71z/8Z1nszn7TO78cRH/sTtJjRjggyezqgnZSTwZAgHeIxi4Gk+1lCyhpCn8dAjWBFg8+tNWxPtxNP95ecdn/WJa3hMNj6/NXU7bdetnKpekP7Iw+alh3/y7KuarVUbUze8RNd/5+H8JHzaiYeN86aVwjrR9TJ+7OMNOOW4t+dDvPp7zZ6RNm/Z3tB/vLAE2OEtbXc/hdxB31LHrb/bOSPRrKzlvUmcdv0Q3u3og2bO2D33DXj/6kI7WdU01bK00rFqf4qs8884qqE7ZX9WzWeix1U9Wnjovo2+/oD9ZqfDDn5TgkVd2fD0/OyXLzTWtVdlhU5OtGy7Il1d30S+v3x2S6Kt2oV2fUzZ/oyPjJUPP7GxwayV/Ogbq3HoW+hjkHf0wgO7ur/L8iAXOe3G0Vb5Pf7Ub2rHtVIXyr6+k/xKPe9F7+rScj+965B9MrfoexmP0GP0eSrDSEx51wFmqo0pPAZ4Bvpmgc7/0fWbEtNFZWhlvNG546JefMaqWnd+KaecauB8GLJlnNhngH3DK4Zus8Ei4k5kG0xQYgZwphnorCK0KlvEma7b6pRe1JOpOKYZuKEx2jDe6KAJ5ZQTx0xzTCR0Iwe9YOkGulcGyl+GTtqY6SkGY+4PHijqQje6Xpc+zoURxHEYkjxY0XkzKO03d1bDOI80o7Rt1w+hf+V0OGwYqOtCO1l1acpzrXSsXX9aytnV+1G2WCYU+Te7L0udjLiDuK3rm7hvWJ8bS1/q4pR16aaPwfGBUdcqYCiypIxlGDyIY5xxXBd4YMQw6iV0M46W+fEQxtITllEQYqq8riwxPnKtm/x60btIW1ce+uQ7H/h5Noa5p2e97rWJB6ipDENvUKIcq9c8ng1DlDgCxmInoV2nwc3DE+8VKz6YB7dOZBKHgTYGW9ZD1d1MrMPAYLtl5WnZCOGYtXOdhPKm6CR+N3HgyADerhPqRuZ0jYvRhad43ZPPNTzd1JUOB728e9WZWW84xvDsNnQrB72Izru8H6r5dtLGvCCCV5rB4877f95Y41eV1YmuV9O0OsaQxLsSnXysN2qVZpiu4Y0l4D0Kr2K78rfqh3g4oI9hRoF1mBwzkDcLrWQ1S1Oeb6Vj5M39MIgh+nq8VZ1yH8R6dFomHmx5SSbW+9FudfXuto/BeGnnYaeM9DF4DkMfr/jm2rwGu9Pydxqvl3GUPGDyyOpP5T47XpSryztsim7z60XvIm1deXhoOOQte2dHBmXjAbJVn18no9/nhn7KOzrn6255qMGGBn/o8Y0duX9jYL3p+49lxUf5r775wcZLMnhLuHkYUCcSeKopvSu/3bajMaXHjbnbbv/hkcHDFS/ntMuLQQFXPYuHCTs7hZ0v7jRLGzdEs+vlecqNQYTnw9CcAPrDjXzNzf8jG1+hj3hxGFjpEAjNpn64BuuYQqrqXydyynat6kXzku/Mt1kb0+48/bLAnr9b7ny87W+WttL1VuWoXuO+OGHxW3MnT0fPW+V0ntMlUBeMPwYv+qoIeIn4qwut+qHwYmAwEJjSpm8oQ9nvtJJVpmm230rHqv0pMq761oPj6lnKpczllCP9eLz8WMaLffpi9GMioa5s3copOXabdqri095v2X9Oot0ilH1Guz4G5oyJ9E38MVayZKzTezK40z9MJLRb7tLLOFqWBz5wgheBmR4eqgncp3et/UViRqrb/KL+YWNkgR3+q0tb3k+UB6cUZWOp1VSHofdQotS8Zct0D651Qt1baq1Ax5urTBOSFhf43730cE5Syi+nf5t577jhyrctS+9KrGfD8xJeJG7MmE7nHArdSUAW5YzpG6bgKVPZUZRyWFvB9AfT2Lj1w/Ap45T78cZplI1rUZdOO5JS3rDv0/bN2p8bmbWGTHcHG9YGMo0TU88nLTm46TRRxA3Wl37m/dk4hVlcayan2q48bZdTXcG9biqnVRszsPP0G9P3rKFkUOFt7Qjd6HqZLtI321IHDPC4n4kX9wsd7HQIwT68sGUdMRCroV0/hNct+gLuU5YqRKjrd6LPbKbTkbZui7xWOlb2p6SnbyJN3Tpe2pqHh+DAL2zQ1nUBBhji1DP6orp4rc7FrFHcT8QN3WqVjmt1HAdBH+v6Jgz10AfKzthA+QnVPqNdH8ODMb84EMzgRRu3CtUlGJ2kqZPHtC4PveRNHeqW3qBDEx1Hq1P99JPRh1Pmf3vq+XT4sp0zS+RPXoRu8+tF75rdT5SDcZx7gTaa6uluyrMbbwFlQv6TgAQkMAAE6OQxxuNnvSgSa5LxcIQhNgDFtAgSkMA0JcCMHx7Fsg8axKrGQz2zZIPQNw79lPcgNrJlkoAEJk4AL3u5TIROk2kvgwQkIAEJ/AeB8pdF/uPs1O0N/ZT31KEzZwlIYDIIxBRPOeXNdNMgPIFPRn2VKQEJSGAiBFhG8uZ9B2O6m/I75T2RVjSNBCQgAQlIQAISkECDgFPeDRTuSEACEpCABCQgAQlMhIAG5USomUYCEpCABCQgAQlIoEFAg7KBwh0JSEACEpCABCQggYkQ0KCcCDXTSEACEpCABCQgAQk0CGhQNlC4IwEJSEACEpCABCQwEQIDa1Dy23PnXH5H/qTgRCpmmu4I8GPS/EzL+z5xQ9PPpJUSic+PTRskIAEJNCMwSv3EsI1Z9N/d9uHDVsdmetnq/CjpbCsOE7k2sAblRCozGWn6oVzctBjH3IzNAt8K/fgXbx337exO0jWT1815PpPF56347NS/fOOsxie6QgbXKVv53eG45nbiBNCtU86/udHmVV2DNwY+X20YxlCtD3pEfTlvmH4E+t1PVPVn+hEb/hrtqjGqn6QmU6/qxvF+ln3QZfnD5rughfiO50TCRNNNJK/Zr5+R5s6ZOZGkppkgAX6ou9WPdfPtXQz86RL4Ru6tV50+XapjPSQw8gR25Rg18rCHAMBA/LA5Vv3Zl34vbdm2I82ZNSNdf/FH8ofOV1yxJn+U/obb1qUNG7fkj6Cv+tLJjY+383S0es0TGTMfco/vbuLRueehDfk81+MrG5z/9GW35/ORD4M2oVqG/+dzf5r+7h8fTvf9+Jl8nX8hp4xbnmefp5/tO15Oj6zflNPi9Xv62S2Jz8lx8/EUv/yS23J9Ii3br9yw8wP07Eddbr37p410nC/zLcvfjANpIuAdhWfUhw/Kw3L9hs0NJsSNvPfc4zU5acmME5Huzvt/nsvGuWgD6nr04QfkdNV6Llu6INc/XxyQfzC59Lp70+KFb05XfHNt2mv2jMwEw6dkGnXmPIE2jvYKXtt3/DFdcu0Ps75e/LV7MsezT12ULr7mh+krn13a8Poil4AuwJbvxV76mQ+ki7/2w0bbcB1dO/GYt6ULVv5zumj5e3N68iWgS3XMy3LliIXOxnHU+cPHHppW3nhf1sNSl2i3aj24r/jEV9yjyGrV1lddeFL6zg+eeFV9Tjnu7VkHP3rSuxt6UpY5WKJ75fmyfORdtk2ZJuo4CNvgSF2/cPUPct9GWT/3if8j/d+X39G2P6vqXF2d0blqX8IDStlPtGsrrkde7Jfyynu2lUzSTbSfqJN7xDv2HddXIT/6XvYjVPu0srx190rIaHcPIL9arkhbdy3uhShPqd9R1n5tI4/ox9vVOcpG/mUboYuzZu6RXo5zNmYAACAASURBVD/ztbX9crX+ISfyjzrCOcY28ijv26gz7A7af04ek+fP26vRd5ZM69qLPBk7o68t47caX5rJ6lSvok6UP/rZMu8qm7hWrTuMj1wwL/36+a0NxrQB/W7YMVGPFWcuyX1iKaPa7zXLN7izbTY2RFtM+nZsisPmLdvHTj7vprH71z2TS7J+w+axK/9h7dj2HS+PfebLt+drxInjv7n+3hzv23c8NsYfIa7FMbIWnnpt4zpxkPu5q+7KcTkmLvJJ26wMES/y5Lgu7p+de1OWH/HJO+oT50IG2ygn1yJQvo9d9E9ZfpwjXqSryxdO5BP1iHTVbfAJWVxnP9Ihm7wpQ12ou07ZynpyTDsSN/KLelbLXpfHVJyLcka5owyUO9hwDlbBDt5lfOJyLupYpoNnqRt1ssr4yIp8iFvlzvVmzKv6gxziV0NdnYkX5airB+e4zpZQMgh5kRdxyJvznCvrE3FJX5XDMfG5VsqP81E+rsV+FjKg/6oc4/jYs76R77NgEXzKNqBKnI9rzerM9eAeGMinWVuF3EhT6kyUJ65Feck7rrHfKpCm2o8gr5nOtisraYNBXb5cizKV5SVuNd/yXoz6VO/j0KuqrDJtqzKH3ChTXZl7PddNnWEQdazWiTLSLnV8u6lj2UalPlFPZHOdEPmVx3EvcJ3zVT0py0f6iB+cQ1a1bnWygkPkVVfvXNCaspR5V/MqdYP0VQbV4+/e82QeE5BZjc+5ajk70UnktKtzzmwX/JvyNZR4yObtMzvx9EDAY3j+GUc1DGksdzxDeC2OXnhgem7ztrwWsZwu5Np+c2c1PGYk5ukAj0gE5F5+3vFZDud4Ytr4/NbEU367MoQMtnVxjzxsXuKbmhF4agxPXZwrtw88+kzL9ZRl3Nivyzc4Pf7Ub7IHKeJWt3iXtr30cvrkaUc2Li07YUH69aatLdM1IjfZKeu56J37p7GxlF54cXuWSX542Ai037KlhzW8xk3ETdnp0DEKwBM47cMTeHhpYfWzX76Qvct4vqlLeCvRw2hrlg2ce/pRjXSTUaFmzDdv2Z5mve61aeaMnatY8ATwtNoslHWm7UpdqNaDul7z+Q816szSiFZtjfc12DXLn/PNWFbPo0foE3pMaKfvrfLclddKjjBctGBewmtNX1T2Z//f1t+31LlWda72Ja3aCt2m/6TvI+y9184lLp3eszHr0y3DZjrbqqyd5IGexb2H3jOO4NGKUOZ7wH6z8zePy3662T1Q19dGH99rmaNsE912U+eyT67WCW7wqQsTrWO7Pqgckw+dPzfPCJEmQtlelH3hofs2xqwyfoxnrcaXqqzoryKvdtsyPbbJYQe/KY/xVY7cy6EbdTK5x7b+bke2G7j//u2p36RPnHJEQ0/Rx0PesnfuW1v1e53kW5a5bPu6ck3WuSlfQ1l2AO0qSUdIB0oI13u4/jkH0FahdCcTj6keQjdlIC55Lj5j1biscHt3EugQmL4ifUw1cQO3C83KSMfw5XOPT6etuCWLiKmJUh43LUpdBhT9DbNmlKd62i/lkd+j6zel45bfOE5mu/YZF3mKDnjA4EEjlkZEMWirHX/4Yx6QMdYGIZTMMfIwuig/gfuEB7BOQimnWfxyuow4TMcQ6nSrmYzyfBg3VZZxnqmmmOoiXeTXib6X+QzD/u93/HtTnaP8zercrC9p1lbx4E1fgkwGKfoF2p/9Zvcs6Vj2wJIZfgkCwyCWF3XLt6przcraidyYLmQ5VIRmOh91j3jVbVmudn18L2Wu5tvtcTd1rtapm7wmUsdu+qB4AOimTBG32/Gl5BAyutmWutNON6pyGdt5kCQdRvE+e78+vf2g/z3d8N116YXfvq3xINmu3+s63z6P79V6NTuecoOyNBKbFbLuPGve8Eo+svpT+XKsTauLyzluEN5kvnvVmflpgGPWMhC6KQNxe+lQyY+BIAYD1qvRObcLrcrI4AAH6sR6Ldag8uQUgRsdb0kZ8Er8dtt4I7O83ss++fF0ecWKDza8Wr3I25Vpo6PDewHXakDnBjFUO9nSG9CuvO10gbU7GHe3rDwt6xXHF165Jout0612+XG97KTL+HE+1iWV12K/nb5HvGHZ7jnjNdm71kznqEezOlf7EjygzdqqbtDiAZRBr909S7vgpUYGhiX9L3n3ElrpVTu5lIO+k9kCZgmiXM3SRd2rDzARv7wHWvXxvZQ58protts6l/m0Gj/KeOxPtI699EHVMrQ6bqerrdJO5FqpO610o5ns9x85P6+Vf9MbX5dmznhNfj+EuDzEETA02/V7sO3V7mhWvn6en/Ipb5SDKax1T27K9UKZr/rWgy3r+PuKp4intoef2NgyDRY+UyIxJVhO37QrQ0yzk0E1bstM21ykc8NAQZkIGHh0bHWhmm8dJ+K8Zf85jamskMMTGp4IXqSJsPquJ/IUEFNBnQTSo9SdhLr8Okk3CHHixuZlGTqSaqDNeDBB5wh4vTHk6wIcdtstNZZD7Hyo2fkSWV18zpW61ixO3Xn0GyOMBwv+GPxDr+ri8zAVdWinC7Q79aA+BKZpeIGOUG1rZPJwF+xa1acZy+r5nFHNv2b6XhN1oE/tucfuuR9opnNl4ZvVOfqS3730ctO2Cu81D9WhJ/HQVG3HMs9yP+4P8qsL3fQTrfQqZDfTn5hJYIAnMA3KOFIGvNxxbzK+cJ2pwAjN7oFqXxvx2XZS5jJ+P/c7qXOz/Kp1atUXTbSO3fZBzcra7nynutpKTjO9ijTNdKfKMeKX2+o4jsHI7NHd/+N/ZucV9xAvQ2GDMP7HDGWrfq+TfMsyTNX+lHso8aQxZRtTjPFmUysgdMCsVeOtU57GSbN44au9SaUM1lMyDRhT1SctObjhtWtVBtZpYECQLrwmeADLN17Jp26qucyffQbZujetuRZrMZi6jieRMn2zMlan8cPjUKZFYXmrjDc4Yxox8kC5Y6Ap05T7pMcTQBvFNH15vbpflx9xgl81/qAdh/c4dIXyBS+8IaxNjOl8zqNbdQzhgNcJbnAn7jmn/0l6/oWXaqtc1bVYI1QbuXIy3qCO9uUySwyaeZE+9N5D0n/+7H/NhmG0aTNdwOhg2qasMw8uBOr4t+cvbdyLnEMHkVWtT7mmmXjNWIaRE/kRN8rIQ1FZxzp9J/6whVY6x689VOvMgzG/bRtLfoIP7dGqrVgbXHKN/pb+pdpHwJB7lnYs3/5Gjy/42OJXISbvbvqJVnqF8Kr+oC8RynuLc9SfdW5loI/HSI+xBV2hnvGw0+weIE6rPr4Z3zLvydjvpM7N8q2OH/QNtG3dOut27dIsj277oGZy2p2HQzNdLXWkmZxWehVp6KfrdIfrrXQDzqypLMdxyss6SZxef3XmMTkLvJboJToZIcpe3p9xX7fTyZAx1duB+NmgqYZg/hIYdgKx5CMMyHh4iZ/3iPo1Ox/X3U5fAsxqsFSh/BkrPFUMnBNdEzmotHjQxliK+6Esp/dASaN/+532Qf3LUUmDRmDKp7wHDYjlkcCwEWCAZAqnnIaM6bFhq4vlnTwC1alMcmKa0iCBXgnYB/VKcHqkn/Ip7+mB0VpIYOoIML38pU9/YNySBkrDdEpMH09d6cx5UAigC0xJl1NqsZQDHTJIYKIE7IMmSm56pXPKe3q1p7WRgAQkIAEJSEACu5yAU967HLkZSkACEpCABCQggelFQINyerWntZGABCQgAQlIQAK7nIAG5S5HboYSkIAEJCABCUhgehHQoJxe7WltJCABCUhAAhKQwC4noEG5y5GboQQkIAEJSEACEpheBIbOoOQHaw9f9vX0vk/ckL85Or2aw9pIQAIS2LUE+HFzvrrDbwkaJDBqBPjB/5PPu3nS7Qk+S/vxL9466flMZfsNlUFJg/AZRH5f71++cVb+jNZUwhuUvLkhUNT4NjPbU86/OX9nelDKaDkkIIGdBHgojq+KyGRyCFQZ00fihIhve09Orkp17OlMB6qcqmN4Z1IGL9bQ/bD57NfPSHwo3dCcAN8OvfWq05tH8IoEJCCBESLAt5BxQhgml4BjT2d8pyunoTEoebLkY+qE8sPrHK+4Yk2678fP5GvxMXUaDKu/+u3a8AzwjVdk3vPQhpxu9Zon0oVnLUnxgfZ8MqXs5fvKDffFYd5GPOSffen30pZtO8adZ+ro0uvuTR8+9tC08sb70oaNW1JZLiK3S7t44ZvTFd9cm/aaPSOt+tLJ6YUXt4/LK76CwpN4lI8vYPDli0s/84F08dd+mMrvOJf8yD/qwD4yCHz7Fg6EkM8+zOJ8fFnjV89tzeU5+9RFr2KWBfhPAhIYR4B+oeyryj6neq3aX5SC8G4sv+S23K9wftnSBY1vVlfllNeIW97L1WvfvuOxdM3N/5qzKvuHMu+qfK7NmTUjXX/xR/KMUdkflecp8yXX7uyTvnD1D3KfGX1JfKWnXdqli9+aLv7aPbmP49vj657c1BgTIq8D9ptdy/jEY96WLlj5z+mi5e9tzGyV+VGP6POoY7v+u2QySPt1nEtdajbmTWR84LOdMfaEvoR+xNhT1dWIB7NSF8sytkpTsi7Tl7oUdeRTtNXykT7KGDbDOaf/SSl23D46sn3Hy+mR9ZuyjRE6UuZdlp3E5bWyXKXgKAOcSo4xhp96/DvTf/n2g3nsx5YhUJYHHn0moftxz5QyB2J/bIjC5i3bxz520T+Nrd+wOZd6+46Xxz7z5dvH/ub6exu1YJ9zXCPen517UyM+kbge8e9f98zYwlOvHfv2HY810pc7pCc/8o20EZdzJ5930xgyCGVeUS6uEy+OI99u0iKb+NSJLYE8Q3bkXZYz8ouysT32rG80OFBWjuM6dYJDeRzyORc8c+av/AsZwaO85r4EJNCcAPdM9AXEivu1PMd+3X0XceO+q/YlpIv7uHqNNKXMK/9hbe4TiF/2gxyX/UVZk7LsyC/7Y9JFv0GaMr8oS+Qfx1GPbtIim/7nc1fdldlV84rjkme1rORblrWsczCO63FcyiOPQQzBNThTRsodZaeeZVtzvaw7x9G3c54Aq+r4wHEpM/QlWEVa4kQbZ2Gv/ONcszI2S1NNH3Ijzziu1rFavzLvSBvlL/Ngn7hl3eNcs7ITP8oRsuO41MG4FpxgXo7h0Y5xPeKHrGo5B+V4qNZQVi1wvGTbXno5ffK0IxuXlp2wIP1609bEtU4CTxCnHPf22qibt2xPs1732jRzxk5HLk88ePEI6zdsTvP2mZ2OeMe++ZgplSMPm5ce/smzDVkrzlySeLrgaeLohQem5zZvy09H3aRFGDKu+fyH8pZjpvzHxlL2WjYya7GDFxZPImUksD1h8Vsb3lnO4a2I7z4veuf+4+Q//tRvXsUzppCqHt0WxfCSBCRQQ6Cbfizi4nEj0Dfwfe6YaWHmJe5j+i36KDwgeETwbuARCe/G+Wcc1egTyn7w0Plz88wI/V810P/RDxKQT/8Y8SgDZQmPCmWkf46+mOVK555+VM6fOIsWzGv0p92kJW/6n8vPO75Rl4P2n5M2Pr81bd/xx2qRX3UcLKJ/JgL9+GEHv6mj/vtVAgfsRMmZor3/yPnp4Sc2NtbYl23N9YmMDwsP3bcx7rbSF+SjdzCPEPxLXWTc/tkvX2iUsZom0saWcSfGHvR5v7mzGrpEnLKOZfmqeZMWncTD3SyUY2M1PWnKsrcrV7M8qufj/oj7unrfV+MPyvHQTHnXAaMj2/q7ndPNcX3vvWamN7RQjojXyRbDjQ4xOimUHMOQQCeNy3zxGavGicKlXxfo8EhP6DYtaapTEq1ugDJ/bgAM2RgE4lppHMe52JYMGZy+fO7xeZkB18PlH3HdSkACvRHoph8j7qPrNyWmxsrAoEeoThdyjj6LPgyDq5MQhmhd3LLfYJDj4Z1+MvoZpvFjmpH0rfqpkDWRtMiuTlkz9dhJqGMRRkmz9GX/3SzOoJ6nfTAy60Kw72Z8qJPT7BwPOEwBM07G1DBx0cVYwhZpo/3q0sRDSsSl3OXyEc7HPRBxYlvqc13bR7xOtpG+Wdm7KVe7/DBUL1v1o3xP46g65C17Nx7W2qWdqutDbVDW3SisNfztK2sae4Va7bzLpx46GI7r1jOgVK1Ct2lZb0knfcvK0/KTeawNbZVHXGvWUYanNeK12mJUPrL6U9moZf1TrJdqlcZrEpBAZwS66ceIi3foihUffNXgQr/DOkW8hHhKYnCjFOWg2lmp6mPFOutYU80DdMx84CUq18iVEjB0m4Xoo7pJywM2v/hx96ozMweOWa/eSahjAau6B+9O5A16nLoHlihzsI/j2HYzPkSaZlsMxDAS0U/W+OM5x0Mc3vRq2mqa6jjL+wXoG+MSAaO1k1DX9p2kiziRvlnZKcdEyhXyyy3rgZkBWPfkc43ZhfL6IO4P9ZQ3njQ8lHfe//MG29V3PZHevO/sRGNwfbfdUmMaY2cntPOlk0aCFjt4EunkUFr+mHbmBiTQsTMVzMLwbkO3aekQqAf1IfC0Ei8CRd4Y0RjTdYGnTzrf6NQxSO9a+4s8FVIXv9k5yv2W/efkciCDn+HAS2CQgAS6IxDLX0jVrh8rJdfFjevhPeGBlYAHkT6KEIbDTd9/rDH9eNW3HuzqN/Ewun63/eX8YBt9Ykw7kke1n8kZd/iv27T0zRglDPCEmBossysZl+frWNCPw4rlPsMeGBOvvvnB3M60GW3O8oKqly/qWWU/0fEh5DXbkg/G1htn75m3pS62SxPjLvGqxj/jGlP6nYRq2yMLVtXxtJmsavoyXi/lQk51DCcvZhf+6qt3Zo8uU/eDHobaQ8kNwhvQvPEY0yyl15AG4UkC9zTXucYbXc+/8FJH7cLaStzqIZtEuNV5euKpHE9d+ZY315kSjnWVzTLpNi1PcXQIMc1FPTDsIiCP9Zvx9jtPgGWITj/Sc63TqevqtBLp4N7MeC3zdV8CEng1AdYW8oDHNGB45Vr1Y6WEuj6P6yEn+jvOMYXIusAIF3xsce7PYpkOfRl9x+ZH6h9EI11s6U/P+rMjavs8+qi6fqac5gw5ddtu09I3s4Qo6nLSkoPHTetWGcea08g7PGaRPt4ShweGwTAHprcPP3TfBhvGC9q+Wahj3+n40Ewm5+FYTkuXulDlT3zKGb9QEm9gl2kiL/SQdY+MvYzNtN3ihQfE5bbb8j4gLUu6/u6lh9umiwjNyo4XdaLlqo7h4ZHlAYcytnogiHINwnY33g4ahIIMYhnCjY4CEeIGiZ9EGMQyWyYJSEACk0Eg1meW0314s1jnVTcFPxllUGZrArRR9eeRWqfw6iATqLvnBrm8Qz3lPZlgMR6ra2piSmky81W2BCQggUEkwKwE7geWvkRotT4v4riVgAQmRoBfhCEMw3Q35RzqKe+JNVFnqXCrf+nTHxg3nU7KfkwFdFYCY0lAAhIYHAJMyzG1ztKaCDEl2Wx9XsRzKwEJdE+AtcHDMt1N7Zzy7r6NTSEBCUhAAhKQgAQkUBBwyruA4a4EJCABCUhAAhKQQPcENCi7Z2YKCUhAAhKQgAQkIIGCgAZlAcNdCUhAAhKQgAQkIIHuCWhQds/MFBKQgAQkIAEJSEACBQENygKGuxKQgAQkIAEJSEAC3RMYSYOSr7+cc/kdA/VFBH7A9ONfvLWrT6F139wTS8FvcsKLT1caJCABCUhAAhKQQJXAwP0OZfwy/IaNW6plzZ8S4xNl/fzNM4xLPoMWcjnesPHF/HlFChDlWbb0sManxV5VsD6f6DTPbr5SEV/5iU9aUWR/Q67PDac4CUhAAhKQwIgSGDiDEmPx1qtOz82BwXThlWvSVz67NH9zdjLaiO+YxrdM6+SX5am7PhnnJjPP+OYv5ebTkpdc+8MU3w2djLooUwISkIAEJCCB6U9g4AzKdsjx3mEELV381nTx1+7JH5THIPrVc1vzx+K3bNuRRZRftMEw5UPyXMMrd+yi+Y1smMa96fuPveqj9KvXPJG/CnHKcW/PH7gvv9+NF5OP0keIvPACXnrdvenDxx6aVt54X8LLWvUCkt+nL7s9J+Wj79df/JFXGcvhTYw8w2MZXluMQkKU4bjlNzY48IWfTsP7j5yfy8knJUlXckJG1Cvkbd7yUjrl/JtzvaLsB+w3O/M5euGBDcM8ylt+8zdkuJWABCQgAQlIYPoRGDqDkibY+PzWtGbtL9Laby3PhhAGzNU3P5j+8co/z9PhGG0YdExjz5yxe7529qmLssETRtNhB79pXGvuucfu6ZrPfyhVp7wx7soQU+R3rzqzkdcXrv5BNgwxrrZt/8O4vFdcsSZdd8tDeQqdvP/bvesb5UYW5cYgbhVIXzflvuid+6fLVv0oXbHigxNaBlB+1qkdQ8p3w23rGksD8G5G2TEmH3j0mYTxjWE6bN8fbcXeaxKQgAQkIAEJtCcwlC/lzH79jHTu6Udl44UqMkWMMciWMHfOzDQ2ltILL27PnsttL72cTjzmbfka36PFuJxIwLjEcMLzFnkd8Y59E8bpwz95tiEyrmNcYWw9t3lbfgGIvC8/7/hGuQ/af042jvEQtgvkWzVu26Wpu45X8/BlX89/eGHxUhJaMQw5US+Ol52wIP1609bMF8M29rmGoYoBHIwivVsJSEACEpCABKYngaH0UNY1RTmVzHWmZAmbt2xPW3+3cxq8Ll035zD88I6WAaNxv7mzylPj9jEaMQYjVKfLmRJvFy76i/fm9Y6Lz1j1qin0dmmr18s1lOGt/fK5x6ejDz8gv8Ud0/GkC4ZVGRzvvdfM9IZXGGMoH3nYvGxUc/5nv3whG5x16TwnAQlIQAISkMD0IzCUHspqM2AY4Xm7ZeVp6ZHVn8rbMIbwVuLR7Edg+nzePrPHicJriAeyk4DRyxvlTJdTTtYodhowKkmzaMG8vIa0H95Kpujxrj797Ja8frIZw7oy4v397SvrVbmOpxPDed2Tz6VZr3ttQrZBAhKQgAQkIIHRIDAtDEq8kLvtttNrRrMx/Rwv5+Axw0N55/0/zy2K8Xn9dx5u2boxRV2NFN5IXuIJg27dk5vS40/9JjHt2y5guGGQYpgSmBruNsyft1f2iFIWAkYdxl0E1jby10ngRSbKjhe1FcOQxbpU1loSVt/1RHrzvrMbhuOh8+dm7+1fffXOPM0f5Yu0biUgAQlIQAISmL4EpsWUN9O1eO5425mw5D0Hprfsv3MqmXV8f3v+0vyWNx44rn3x7GPTbfc8WduqrLXEi8j0MtPDvGhShnL6mfPxtjPTvmFklvHLfWThxUM24aQlB7f1niKTF3vi9yPjrXHSx1TzaStuabzlXeZXtw8D/iKUb3I3Y0jcWTP3SGedfET6z5/9r4235XnpKQxHOJP+xa07OjKuI3+3EpCABCQgAQkMP4HdxsZ4fcUwHQjgfe3lre9eGbA+FIPZ37XslaTpJSABCUhAAsNFYFpMeQ8X8skrLVP9Jx79til5uxpPKsYkb7WH13LyaqpkCUhAAhKQgAQGicC0mPIeJKBTWZZWX/yZ7HKxHpOfDlp0evu1pJNdFuVLQAISkIAEJLBrCTjlvWt5m5sEJCABCUhAAhKYdgSc8p52TWqFJCABCUhAAhKQwK4loEG5a3mbmwQkIAEJSEACEph2BDQop12TWiEJSEACEpCABCSwawloUO5a3uYmAQlIQAISkIAEph0BDcpp16RWSAISkIAEJCABCexaAhqUu5a3uUlAAhKQgAQkIIFpR2BKf4eSL6uUnwGEbvkpwGlH+5UKVetdfr5xkOpMOTdsfDHxuUkC3/FefsltadnSw9JU/ublIDGyLBKQgAQkIAEJpDSlBiUNwLe141N9Dzzyq/SFq3+Qrr/4I/k71dOtgeK73Buf35ruXnVm44s2fDLxhu+uSxd/8tiB/soM3+u+9arTp1uzWB8JSEACEpCABHokMOUGZVn+Q+fPTXvNnpE2b9meDkl750tVb17pwQwD7b4fP5Pjzp83J6360snZUMM4veehDWn+vL0aXtALz1qSDtp/Tvr0Zbfn+MuWLmh43zhx2d//KK1e88SrZOGZu+TaH6ali9+aLv7aPQ0j+Ipvrm3ELw3jLKDm37onNyWMyShjRDnkoL3T5ecdH4cJA/PsS7+Xtmzbkc9RbjyC1PfS6+5NHz720LTyxvvSho1bUllnIrdLu3jhmxPlhjPleOHF7ePygu8R79g3rbhiTQquMKEMpxz39nz+oye9Ox19+AG5bHAOnpzopqxZgP8kIAEJSEACEhh6AgNlUK7fsDkDxbAkYEyuXvN4w5tXejAP2G92Nm72mzsrPbL6Uzk+BiGGHx5PQhhCXA/DB8Nv7beWJz4ViNH2/iPnZ+OIvJ7bvC1f41vUyLrulocaBieG4Jq1v2hcR14ZP2fY5h8G7qIF8xqeybroGK9/fdWa9OVzj8/lwkC88Mo1adE790/Uedv2P2RjEmNw5ozdM4MoZydpb7htXfrHK/88l4H4V9/8YOOYOmGoIvuaz38o8y+nvDFoyxDtccvK07JHOYxZjHaM0lZlLeW4LwEJSEACEpDAcBOY8pdy8IItPmNVOnzZ17OnKwwujJcHHn0mrThzScMAw0g57OA3pYd/8mw2CLe99HL65GlHNlpg2QkL8vekMRYJGI941QgYqQsP3Tede/pReVoZ4wxZTz+7JXv+yAvPG8YkAVk/++ULed0gx7NfP6ORNkdIKT3+1G9yOeK41Zb6YIDiMSVwfM7ld+R6U3f2OYdRPW+f2dkgIx7eyyMPm5frHPKDCWU9euGBWW63aZHFFDaGI1vC3Dkz09hYyl7LyKvVFgP57FMXNZYnUNYTFr81e4YjXbOyxnW3EpCABCQgAQkMP4Ep91CWU8UYRUy14h3EUMQrWAYMKDySBKbFt/5u55RwxNl7r5npDbNmxGHH2+07/pjzKqduScx0crPAlC9exNNW3JKjlFPxdWmi7Hj8CBxjzBHw9N30QZ/dqQAACsNJREFU/cfyPgZuGNn5xCv/mEquC3gDMYYJ3aYlDXmX9eYFoU4CbVUayJEGgznqGOdiW5Y1zrmVgAQkIAEJSGD4CUy5QVkiDI8bBtJuu6XsqSuvl0YM3jS8hmVgPeBvX1l3WJ5vt8/UMV5BvGmxNrBMw9RwXSBuTKd38jIRxhZT+MgLr2BVLkZXaWSX16l/q9BtWqaoecu+nLJmer2TEAZyNW4zY7Iaz2MJSEACEpCABKYPgSmf8i5RYjBhTOKFfOPsPfMWz10YUrzUwjQz6wnxRuKhvPP+nzdErL7rifTmfWfntYaNkx3shHFU5tVBskYUjNu37D8nlwkj7eTzbs4vxzQivLLD9DuGKz+908xIRRZ1pK7dhm7T4uXFcIclgaUE8SJQ5I0XMvjHudiWBjLnqPtda3+R16VGHLcSkIAEJCABCUx/AlPuoaxO75ZvXvP7h0x/s8aSUP29Rl4ewTiL37Js5tnrpBmreZEm5NWlr3v7HK8jXtJmIaa5SXvc8hvHRWPKnOusQ+Rnk8q3vIkYb1+PS1Q56DYtHlbWrEZZqC+GcYQTj3lb9qjCP97yjmts47coIz3nYuq/mRFapndfAhKQgAQkIIHpQWC3sTFewzD0iwAGMJ67MLb6JVc5EpCABCQgAQlIYFAJDNSU96BC6rRcTGMzRYxnzyABCUhAAhKQgARGhYAeylFpaespAQlIQAISkIAEJomAHspJAqtYCUhAAhKQgAQkMCoENChHpaWtpwQkIAEJSEACEpgkAhqUkwRWsRKQgAQkIAEJSGBUCGhQjkpLW08JSEACEpCABCQwSQQ0KCcJrGIlIAEJSEACEpDAqBDQoByVlraeEpCABCQgAQlIYJIIaFBOEljFSkACEpCABCQggVEhMLQGJT8ifsr5N6cHHvlVo6343N85l9+R+LRhJ4FvT7/vEzekw5d9vfHXadpO5PcrDnX9+BdvHfd9cL7IQ137+YnDuu+Q13HuV72UIwEJSEACEpDA9CAw5d/ynihGvpu9bOlhaeWN9yW+6c3xrXf/NIs75bi3txUb3+KOb0+TAOPs0uvuTT97ev/8Te22QqYwAt8e73fgW+BHHjYvXX3zg2nlBUvzt8XvvP/nad4+s9MR79i339kpTwISkIAEJCCBaUJgqL+UgwG44oo1ab+5s9KyExaksy/9Xvryucenow8/oGXz4HVbfsltacWZS1rGjXgbNm7J8pYtXZDCkAtP5oaNL6bVa57I10vjtF3a7TteTo+s35Tu+/EziXQYbNSFY0LkhQf205fdns/xb/68OdmAxtAj7yhPNb8l7zmwYRQi456HNuRvjH/lhvuyrAvPWlL7vXG8lMHx0PlzO+LUKJw7EpCABCQgAQmMJIGhnfKmtfbc4zXp3NOPSg89vjFdeOWadMLit7Y0EKOF12/YnHcxmJoFjNVLrv1h9oI+svpT6e5VZ6aHn9g4bood4+z9R85PXMdAw1uKYddJ2mtu/tf00ZPendNiAF/xzbWN4zIvrnG88NB90y0rT0u3XnV69saW5Q5jEo8tZVn7reX5MjIjhNHLdQzY67/z8Lgp9IiHl/LsUxdlA1TvZFBxKwEJSEACEpBAKwJDbVBSsZim3bJtR/ZStqpsXHv62S15GnfmjJ0z/ngbYx0layrx0v3qua1p20svpxOPeVtOFlPsePoi4EUMb+iid+6fxsZSeuHF7V2nRR6expBFuZhmppydBAxk4sdUP4Y2xioGMMYmAY9lXMeQ3mv2jLR5y/Za8dSZtBjMyEGeQQISkIAEJCABCTQjMLRrKKNCTOdi/Bx28JvS6rueaEwBx/W67UH7z0mr1zyetu/4YzaWPvqn78rTvxhfF6z855wEY+vR9ZvScctvHCcCI7Iu7L3XzPSGWTMmlJZE4WWM6XXOHb3wwLqsXnWuzvCcO2dmmv36neWpJgiDtXo+jsN4Zko9jNy45lYCEpCABCQgAQlUCQy1QcnU8k3ffyxPS+NVY10kBmY7Iwhj68WtOxKevWZxicM08xUrPviqKeYqxOpxt2nLKXKMW45ZT9lpwEB+4NGday8jDQbx1t/tiEO3EpCABCQgAQlIYNIIDPWUd/lWd3jVynWMzX5CKNYJ8rILBmhdwOOIQcY6wm5Dt2nxlG58fmvCMCQw3f74U78Zly1laTZFjQFL/HVPbsppwtBetGBe18bwuEw9kIAEJCABCUhAAh0QGFoPJescebGEt7pjjR9rBPHUXXfLQ+mCjy1uWX08gax75I1m1l9GYEobg5PAzxHh9Yw3oznX7O3oSM8W47abtMTnjfN4m5s3uZnCjxDGMtfjLe+4xpbyXn/xR8bVJd4SL+O5LwEJSEACEpCABCaDwFD/bFArIHgemQ6P31NsFddrEpCABCQgAQlIQAITJzDUU96tqs3b2L6h3IqQ1yQgAQlIQAISkEB/CExbD2V/8ChFAhKQgAQkIAEJSKAdgWnroWxXca9LQAISkIAEJCABCfSHgAZlfzgqRQISkIAEJCABCYwsAQ3KkW16Ky4BCUhAAhKQgAT6Q0CDsj8clSIBCUhAAhKQgARGloAG5cg2vRWXgAQkIAEJSEAC/SGgQdkfjkqRgAQkIAEJSEACI0tAg3Jkm96KS0ACEpCABCQggf4Q0KDsD0elSEACEpCABCQggZEloEE5sk1vxSUgAQlIQAISkEB/CGhQ9oejUiQgAQlIQAISkMDIEtCgHNmmt+ISkIAEJCABCUigPwQ0KPvDUSkSkIAEJCABCUhgZAloUI5s01txCUhAAhKQgAQk0B8CGpT94agUCUhAAhKQgAQkMLIENChHtumtuAQkIAEJSEACEugPAQ3K/nBUigQkIAEJSEACEhhZAhqUI9v0VlwCEpCABCQgAQn0h4AGZX84KkUCEpCABCQgAQmMLAENypFteisuAQlIQAISkIAE+kNAg7I/HJUiAQlIQAISkIAERpaABuXINr0Vl4AEJCABCUhAAv0hsHuvYk74y/t7FWF6CUhAAhKQgAQkIIFdSOCurx7T19x2GxsbG+urRIVJQAISkIAEJCABCYwUAae8R6q5rawEJCABCUhAAhLoPwENyv4zVaIEJCABCUhAAhIYKQIalCPV3FZWAhKQgAQkIAEJ9J+ABmX/mSpRAhKQgAQkIAEJjBQBDcqRam4rKwEJSEACEpCABPpPQIOy/0yVKAEJSEACEpCABEaKgAblSDW3lZWABCQgAQlIQAL9J6BB2X+mSpSABCQgAQlIQAIjRUCDcqSa28pKQAISkIAEJCCB/hPQoOw/UyVKQAISkIAEJCCBkSKgQTlSzW1lJSABCUhAAhKQQP8JaFD2n6kSJSABCUhAAhKQwEgR0KAcqea2shKQgAQkIAEJSKD/BDQo+89UiRKQgAQkIAEJSGCkCGhQjlRzW1kJSEACEpCABCTQfwIalP1nqkQJSEACEpCABCQwUgQ0KEequa2sBCQgAQlIQAIS6D8BDcr+M1WiBCQgAQlIQAISGCkCGpQj1dxWVgISkIAEJCABCfSfgAZl/5kqUQISkIAEJCABCYwUAQ3KkWpuKysBCUhAAhKQgAT6T0CDsv9MlSgBCUhAAhKQgARGioAG5Ug1t5WVgAQkIAEJSEAC/SegQdl/pkqUgAQkIAEJSEACI0VAg3KkmtvKSkACEpCABCQggf4T+P8BrTsqGaV9qqcAAAAASUVORK5CYII=",
K.a.w_c));ba.push(new L(2,1,"iVBORw0KGgoAAAANSUhEUgAAAp4AAAFVCAYAAABGse95AAAgAElEQVR4Ae2dD5BVxb3nm10SgQjCg1Jk/ANllERIUBdSopTGp2KM+YO7Qj0s12iKuIlaaMzD9wwpLd2o+2SDrGuIMZS4eQpbkARfVmPEfzGL4kY2IIEY/LMoBkTfUI4Qx5FYdbe+jb9jT885995z5869c+d8umrm3NOn+9e//vSv+/xOd597B5VKpZIjQAACEIAABCAAAQhAoI8J/Js+lo94CEAAAhCAAAQgAAEIeAI4nhgCBCAAAQhAAAIQgEBDCOB4NgQzhUAAAhCAAAQgAAEI4HhiAxCAAAQgAAEIQAACDSGA49kQzBQCAQhAAAIQgAAEIIDjiQ1AAAIQgAAEIAABCDSEAI5nQzBTCAQgAAEIQAACEIAAjic2AAEIQAACEIAABCDQEAI4ng3BTCEQgAAEIAABCEAAAjie2AAEIAABCEAAAhCAQEMI4Hg2BDOFQAACEIAABCAAAQjgeGIDEIAABCAAAQhAAAINIYDj2RDMFAIBCEAAAhCAAAQggOOJDUAAAhCAAAQgAAEINIQAjmdDMFMIBCAAAQhAAAIQgACOJzYAAQhAAAIQgAAEINAQAjieDcFMIRCAAAQgAAEIQAACOJ7YAAQgAAEIQAACEIBAQwjgeDYEM4VAAAIQgAAEIAABCOB4YgMQgAAEIAABCEAAAg0hgOPZEMwUAgEIQAACEIAABCCA44kNQAACEIAABCAAAQg0hACOZ0MwUwgEIAABCEAAAhCAAI4nNgABCEAAAhCAAAQg0BACOJ4NwUwhEIAABCAAAQhAAAI4ntgABCAAAQhAAAIQgEBDCOB4NgQzhUAAAhCAAAQgAAEIDK4ngrO/83Q9xSELAhCAAAQgAAEIQKAPCTz6g1P7UHpP0YNKpVKpZzQxEIAABCAAAQhAAAIQqC8BltrryxNpEIAABCAAAQhAAAIZBHA8M8AQDQEIQAACEIAABCBQXwI4nvXliTQIQAACEIAABCAAgQwCOJ4ZYIiGAAQgAAEIQAACEKgvARzP+vJEGgQgAAEIQAACEIBABgEczwwwREMAAhCAAAQgAAEI1JcAjmd9eSINAhCAAAQgAAEIQCCDAI5nBhiiIQABCEAAAhCAAATqSwDHs748kQYBCEAAAhCAAAQgkEEAxzMDDNEQgAAEIAABCEAAAvUlgONZX55IgwAEIAABCEAAAhDIIIDjmQGGaAhAAAIQgAAEIACB+hLA8awvT6RBAAIQgAAEIAABCGQQwPHMAEM0BCAAAQhAAAIQgEB9CeB41pcn0iAAAQhAAAIQgAAEMgjgeGaAIRoCEIAABCAAAQhAoL4EcDzryxNpEIAABCAAAQhAAAIZBHA8M8AQDQEIQAACEIAABCBQXwI4nvXliTQIQAACEIAABCAAgQwCOJ4ZYIiGAAQgAAEIQAACEKgvARzP+vJEGgQgAAEIQAACEIBABgEczwwwREMAAhCAAAQgAAEI1JcAjmd9efYbae+9/1d35a0Puc9/fbl78dU9/UavahR5ZtPr7oTZP3I3/+S31SQnzQAnsOJXf/C2LJtulbDnnffc+VevdLLlaoLSqb/2VR1tPKhWn2p0Jk02AY25Gns1jsl+K4V6tn/esivpxnUI1JsAjme9idYgTwNT2gAlx0vx/e1mkaVvDVUnywAiYM5NfKO1+P5ox814uJFT+rXvrWm5B8J6mKpso7fMJUNOvThmhTTG1eTLkpc3fvWjW93Z049xm1Z/y134xc90y56mW7cEvTwpV3YvRbds9jTmssO+fNhrWVgNUHxwA8qgCAhAAAIQgEBdCMiRi525agTXmq8a2WlpJrSNSotuSFwzy25IBetQyMJvnFYHKYiohQCOZy3UmpBHT2zzbnjAnXfacW7Ttt1u3e93eC2WLvySO+WEI/1nLbFcdtMvXce+Ljdl4tgeWobXdXH2zEnOOp+e/t5o3+eGDzvIPbzuJXftpTPc+HEj3eU3P+jlTGgb6ZbdOMs98vTL7rbl63ycjnf/bIO7+/qvuCMPH+EWLF6b6GXpRx8y1C81rV67xV0660R3/Q+f9HlnnHSUW3TNTDf0oI/5c5W/eu1W/1l6EQYuAc18Pvncdqebo9mS7M2cidBOZUenT53QDUZ4XRcsr2ZWb7rrKTd9yhFu8U/Xu1Ejhnib3fN2Z9IvlH7Jtee6nz22NbFV2Z3JkG5m8yOHD/G2fdz40X4JXLK/fPpEt+jedW77zg4X2rjkhjZ8yVdP7KaznYTy5yxYlciw6/c/tNndufJ3/tR0smuh/LhsS6NjyMfqoP6p0N7xrp8tTNM/1M3yqe4ae25Y+oSbOf0Y33+t7258YXcqK5Vj45XKUSjHPE4bjkuapezs2p+MeRrvFFY8vDkZP0Iu0u2Cs453V9/2a58uZLxte3u3fGmcVF+VaXaZxVm2ljbeqVCN01ZvGx8lVyFkHOrmLzrnetP+Mcew7LBOKsvuG5ZnwSUzkvuI0j7z/A7Pt7Prg9S2t3E7rpPVw9rQ5BsPi1c6laOwfefbydhveim+Ut7YLnQfjG1B95jQTkPmupepbLsHxuWZnauuardyY1bI12xm2JDB3kZUl/Be5ytd9H8lQtMJ3P/Q5tKUC5aWdAzD9+9+ysc/vXFHqb2jszTrqhXJeWfX/tIVtzzo43TNritO15RHMk+/9J7Stu3t/k+fJVPBrluZVpblj+VJxr88+YLPG+trukimgtKGZVl6kx2XbdcVb7Kku+nqhfKv3xOwtjObMoUt3uwjbn+dm51aWpNhtmS2Y3ZpsnT9q/NXeJuzvOonSqdgcZbedNJRZYQ2Jln/uORRn8euW7kmx2TbueWXfLumvNaf0sqVbhcv/IXX2fRRunAM0LkxiXUx+Va2ydAxjc/t/7w+4WA6xvqXq7vJNBYqp1x6k21tqPzSVfEx87S00tG4Kb242LnK1mfTJfwcc0hjbPmsTiZX9REnHZVP17OC6Rzy12eTrXw6t/rHciQ7Tbd6tH9a2dLD2l3XVWezrZiDriu91cWu23mluiivcTFOxsFkGXPFh22rc9Mzb17T28pKyx8zV1rT1XSL89t16ZzVPlk2YzpksYtZFumcPZ4t9uShp7ATPz3WzxQePma4e3tvl9OMjp7m9VR5ypSj/DWlUVoLG/64y8+EnjHtwOzRxAlj/GyLnmz19K6gWY75c09OZiEVt+Wlt9zrb+x1emL/yuc/ZeK6HfVEeOd15yVPzKNHDfOzTZpBNdnKcOG5n/Wyx4wc5svS06auSwc9JUonyVI6wsAmINs8/8wD9qR21+xke0ent7V97+5355z6SQ9AdnfZBVMTGLLztsNG+D6gSF2fNrnNyb4taPZGM+1h0GxFpSBZt151VmL/mvHf+eZep1kfCyZbdqq+ZjYu+bNnTk7K/eacad6mLV81xywm1kes/0jW7LMnuRdf29Njn2Man6svOjkpPkv/SnUfcXD3saFceo0XYRuqLTSrJGZxSEsrjmF7aZbMVnXi/Dq3MSrtWlZcOU6v7erw42lWXtNZbWxB7fHn3Xu9/Vpc3mM92j8u02zH2l3XdW+YfOyh3fpMnC88j9s+vKZ7j4LGfAX1GesTxsn6suygXNtOPX6cK5Wcv5/lzauyw60UsjXdH3WPqSaYPdiYZPehDVt3Jn0sq30kP81mJEP3Rf2l2X41eg3UNCy1D5CWfXXXgSWtrOpYB7RlREunm3ha0CChwUrptTyhEC6DxHnCJSS7liXbruuom7pu7oTiEtCSlNmKnM+9f+nKhCE71zaT6Rct65ZGy9JpQQO+lrm0LKoX9XTzKLfsFS6ZSZ4eiLKCbrIHHtw+8Dfbeu6rC5lYH4n7bppulcaBsC6mv8XlqbvyZKWv1IZWno5K+/y23e7MefeG0X4bULeIjBM5pLfMP6uqMSoUkcVJDrW2DtmWpXi7g2Sk1U+O1yHDh4RF9Opzre0fF2q2E8arT8gpq0cwh1MOqO4ZemCQbJWRt21Dhnnzqi5yssPtD4rTQ0s1Ic0eNEEipzsthO1Tjc2kyShyHI5nP2h93QCygmYh1QEqhXIylNduiuWcx7gMDep6K9P2QmlflZ6W46Dr373jsWTPqO2VidOlnVsHxvlMo9NacXZDs4cc0z7t5mfX4mO5wV5pZedZzqNuPGlBemnWwW5M2v9p+7rC9Hp40l7kx5dd4m+iOtd+zkph6EGD63YjTyvL+ogeBMvN/Clv7EymyUuLy1v3cukrtWFYvtJqP/riBV9IZovD69V8tnFKOmkckuNoDlFW/nKc5Ej85p5Lk3FPaUPuafWT4/XOvuwHpiw9qonP0/6xPMsbxqsfaFbS7gnhtbyfVW/N9tnkhO1vlJzetG0tedWv5fTqnqWg/Z7VhjR7SHvAyJJXyWay8hU1nqX2ftDytuytm56cNgU5c4+uf8UvidiLAeVUVUeVk2pL59pQbS8gKZ+WMXQ9XMIqJ0/lX/ffHvM3aw3iWgq1oE5aLmjZwjaTl0unax85KweWtzQoysEltCYBbeXQyzpyAixoE3+4PG7xaUfZmmY8lUdBdqiXJCzIzrW0KvvOG8zWwhuuLQtKlmY9pKdu1grV9hWllcyw/9616rmyfUB11I2tmmB6q19kOdcmJ+Yjfkvue9YuZx7z1r1c+rgNNabJCTDdQ+Zx2kwFq7iguh89bmTidJZjXA0n6SZ5ShuGNJ31FUZHjB3hX7IM02Z9LqdbnCdP+1eTV31HfUj3BHNMzdbj/hbLi89lw/a1UXL41iyZmzxApHGK82ed580bO9OyOS2Th6Ec89ge7D40dVJbUp9QVtbn0GYkQ1/XxFc29aTFjGdPJg2P0RKF3hjX25DhklP4BqBmjcoFPXFpyUnLcVqG1KzQlXM/5+578IATF163t8clL20pSfFK/5ljD0uWNPUke+Plf+sdRds/Gr7Vrn14OpdspVX51YZrLp7un8BtKfGmK85g+b1aeP0snWaGNKtubSn1smYo01RXX/inq2f6pU7Zk/J+77LT3QNPvuCTyy7DpVCToTLTZuNt9t0ehCRP9qagvWdyFtVf1A+0v0sPbraMf+6MYzOX2qxcO2p/mWZ6rf/+1++c423arodH1VF73cQonCEK08SfNUMr58100/U0rmE/Vxo9bIpXpZC37uXSx22ostU+cqBi5uJmY5+9Sa70WeNSXI94uV/lqHyFcoyzOOmBKbRd6aG0YZD8WOe0tgjzhJ/7sv3DcuxzbDtmE1Yv7evX1gIbu9U/1q5/xbKXPaq/y2nVNhYLxiKNk9JU07Z588q2rB6yI9Vx+pQD3/aiMisxF4t4XAnvv1a3tGOWzdiDVlqeoscN0ptURYdA/SEAAQhAAAIQyEdAjr8e1sJ903pA0gqAfT1aPomkLgIBltqL0MrUEQIQgAAEIFBnAprlt5eJJNqWvOtcDOIGGAFmPAdYg1IdCEAAAhCAQCMIyNGM3ySvZim9EbpRRv8lgOPZf9sGzSAAAQhAAAIQgMCAIsBS+4BqTioDAQhAAAIQgAAE+i8BHM/+2zZoBgEIQAACEIAABAYUARzPAdWcVAYCEIAABCAAAQj0XwI4nv23bdAMAhCAAAQgAAEIDCgCOJ4DqjmpDAQgAAEIQAACEOi/BHA8+2/boBkEIBAQ0M/5zbpqpf8ZzSC6qR/tZ/HCnwhtqkJR4dKLn+yLoHAKAQg0lQCOZ1PxUzgEBgYBc8D003nx3+e/vrzuzqJ+CvP8q1c6/XKKgpzSr31vjVO8Bf2CSqOdLukjvUI9TB876pp0lc7VBDmPMVOrdzX5e5smrW0r1bG3ZfaX/LKhkH1/rbfsQbpaiPuHxff2KFuMGeR9IJSuIdO+GB96W0/lb9SYUg+m9ahvI2XwW+2NpE1ZEBigBPRbyXded56vnW568254wC24ZIbTbzn3RdBvL69ZMresaP1GdaODfiawL34q0H7TXfXWDVG/rT1+3Mg+45vGLfxicDk5Nyx9ottPJabladU4s+G2w0a49ffN878zr7rISbhr1XOuGbaVh2U1/SOPPEt74qfHOjExBnoouWPls27OOZN7/Ka95bGj0urL5ne+udc9vuwS//vpuiZ7Xv4vG9313zw94Wx5+tuxL9o9Zqo6r350q5s2ua0i0/7Gp1p9cDyrJUU6CECgVwQ009HZtd9t2rbbrfv9Drd04ZecBt3wl09mz5yU3NTtRqW0ClfO/VxSvl278NzPuld3dbjblq/z186cd6+bcdJR3iFa8/ifnH7Sz24Wchouv/nBREboSNkMotKvXrvVp5F+5jibs9exr6vHtUTgh47Jioc3Jw6ZHDSTJ70uOOt4d/Vtv/ZZ5ixY5UKHMpRT7vORh49wk4891Nfb9IvLCX87W7Luf2izu3Pl77xYY2wzZMbHmJ4y5aiKzvMZ0ya4Rfeuc51dH3hnwfJaW8X1Mkdu+84Or4O1kR5Y1C5PPrfd/763taPaRo61tZfpbFzC+oZlmSylE3fJOefUT/oHISs7bHeTFx8fefpl72DFHMXbmCuP7MZ0Hjl8iLv7+q94Z0H1lWMu+/zuHY852U1Y52ryzpx+jLv+h08m+V5/Y69/4AhtMO4/Vufzz/yU71cq3/QNdVX5Zt9qu5vuesp9+fSJvk3FKWQaslF7zZ97stdDNqC+J0dSjCuFjS/s9mmX3TgrcTqV57jxo92tV52VZI/7WtheeftpnLfa8Sdk1VdjilVYTM1OZp89yUc/t2Wnu+3bMy3JwDuWCBCAAATqSKC9o7M066oVpac37ugm9f6HNpemXLC0W/z3734qOY/zKf0VtzxY6uza7//0+fRL7ylt296enFsZirt44S9KkmFB+SVfQeksr86VXueWP9ZN56qD5OlPZZts5bFr0k3XTI6OpnP42XTSUXKkq3SoJoTlKb3yfXX+iiS/dNWfgulj58or5nYe1ruSXNMtlql4cTW2dt3O7bpxUH3Fy3SI08c62rnlD3WWbMmxa1aWlW15rSy7Hp4rrlww/SrlifmFelmdTU87N5l58kpX5ZcsHRXS8hsDXbc6KJ2CyjWbtfzWHyytXbfzUJ4XEvyTPNlg2IeCy6kfJa+cTGUyTqZ3mq2HY0hYr7x5VZ70sbLS8vfVmJIGSLqoPtVwSsvfSnHs8Rx4zxLUCAL9loBmrmwGRkpqts3Ohw0Z7GeZNIuiWZhnnt/hZwI0I2AzLZpVqiVoRu2yC6YmS1eaZTl7+jF+ps3khbpNPX6cK5Wc2/N2p5+d0TYCLV8qjBk5LLlmebOOW156y2mmqrdBs1CaedHeOM2UHjF2hNPMp0K4vC9Oh48Z7md6rUzNtGkGTCGs98QJY3zctu3t/rjhj7vKLu9pZs/25mlmTTNeCqrfvnf3u2/OmebP9U8zN3/evddfk3wtz5oONsOzYevOZC9sqKP0mjJxrJ9ZU9pwhje2Cyvrxdf2pMoyhWRLyltN0CyuZvE046qg2Uvta7S620yxbGr2zMmJXWjWTxysvUccPCSpg2xn6qS2pF3y5JUOyl+rDRozbX0xG9ZMqWbN1eYW7LqYa9b7jfZ9mcxU10GDnJchWZWCdJC8CW2jfFKda/+1MbW92GYrJlP2qiXnUM+sfpo3rxTJGn8q1UfXezOmpMlXn7n7Zxvco+tf8f0nLc1AiWOpfaC0JPWAQAsSiJdgVQXd9OzmX48qxTc9k6mboJbW08LoUcPcIYGTGy/TV+MAy6G+Zf5Z3lFUGba0mVZepbh46VPOj7YoaClYIdyuoHPdnLOC1VtOiBwn3UB1ozdHPytfuGxpy6Gqn8LevxzYgmB5Q356kIiDnHc5ZnmD2YUtwVt+8ckKci7Ea/pFyzKXkMO84QOQ2lCcbD+xlmBlM2ZTcsBtqV0yytmFca8lr2TXYoPKZ8zCOtoDShgXfpbTLXvICtrjqYcJOehaQreHx6z0Vp71N53bnnDVS9tTFGQr2q6htgqDbC8txHaWJ6/kZY0/aWWFcdaG5kjbNWtjOw+Poa5hvH22h0LJ0OeBHHA8B3LrUjcI9GMCGry1D07Oj2btdC4HSsFu/vVQ3256sSy7Ccbx8bmcLDkXqxbN8TcEnV97+wE947TxuW7Im1Z/yzsN2uunPYC6AfU2hHss5QRollPlKNiMXFYZYb01s/vIMy9750GzdTYLmpXX4sNZSMmInUjNFL/z4X7YNCemvaOzh7NqsssdzS7yvrgm59Mc0EovRZm9yPHSLK3O42BpQmc8TCOHJivUkrc3NmjMQn2yHKcwTdZn6WJ7ENWO2usb79tMyyuHavXaLd7Zs5nXOJ1sJd4LG6fJOs+bt9z4k1WGxVsb2rkdw75lcRx7EmCpvScTYiAAgQYQsJkY3TAUtESppWkFG9g1E6IbhP709qy9WOETRf/k6MjhSQvhTU/XdfPUkpYtF6flsTjdXLWsaA6jlv3K6WH5wqNm+I4eNzKRoRlCybUgffJ8R6lmKTXjJL3CJUw5PFrCDoNmgfSilUJcbzmQwz/xcf8Sz3FHj06WYsP8aZ+trdR24qL66IUcC3or17YDqO5qV82MKagt1a5aes5yQExOfIztIr5e6Vx2ICddcjTTFn81kOXXtgHN5ulBSPqmhdim0tJkxeXNW40NZi2NpzFTW6hN9NCQJ1g/tLfYNVNub7lLjq5r2dxeAgply4lXWn3jRZZjHttKmL/S57x5y40/VlZfjSkmv6hHZjyL2vLUGwJNJiCnQzNXtmyq5VLtO7NwzcXT/Y1fy25awtSy7o/f3WCXux1tL5j2P9qMSZjAvuJI+yQtVLv0rVlLOUmWV/LlRFYK4ZuxSqvyzNHSLK/qbUvolWTZHk9LZ3WUU2FvGWtWVpymT+n+FVZadtdMjPbTKWiWzpZGlV9bG+ScVnLCJT9cVg75acZLDoVdD/VT22imV18BZQ67dNIMZC3BZi7D5VgrL5YnRyjchlAtb7WTltdtid7kiq/qopBmU9XKz5u3kg1qz6VmE8VE7Wv7aU3vmJnVQ20jRtUGPcCEb7GH9if7sb2ZafKUVsvr6hfWlyydbEnX02xFaUJbszzxMW/eSuOP5Gl/aV+MKbHuRTsfpDehilZp6gsBCECgPxGQg6NZMHNIGqmbZv6qXS5tpF59WZY5pOHXDfVleUWRbfs146+hKkr9qWd1BFhqr44TqSAAAQj0CQEtO2qZtJrvQuwLBbRsX8uyd1/o0iiZ2iowfNhBZWfoGqXLQCpHtiRnXrOXBAhkEWDGM4sM8RCAAAQGOAE5vX39K1MDHCHVgwAEchLA8cwJjOQQgAAEIAABCEAAArURYKm9Nm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMycwkkMAAhCAAAQgAAEI1EYAx7M2buSCAAQgAAEIQAACEMhJAMczJzCSQwACEIAABCAAAQjURgDHszZu5IIABCAAAQhAAAIQyEkAxzMnMJJDAAIQgAAEIAABCNRGAMezNm7kggAEIAABCEAAAhDISQDHMyewgZZ8xa/+4E6Y/SP3zKbXB1rVqM8AILDnnffc1763xr346p4BUBuqAAEIQAACOJ4tYgO6AZ9/9UrvJMpRtL+bf/LbflGD997/q7vy1ofc57++HCehX7RI45UwGzDbtKMebvpDkB6N7C/WZyvVX061nGulV6g2X39gWq0OqqPGBnvAjdui1esct6G4yNY0JqpfECAAgY8IDP7oI59agcCEtpFu2Y2z3OhDhraCuuhYQALXXjrDXfjFzxSw5t2rrD66Zsnc7pFVnNWarwrRTUty3PjR7jf3XJpZ/kCs88JvnJZZXy5AoMgEcDwHQOtr9uC25etceMPX0/aj619xd1//FXfk4SPcgsVr3brf7/C1zXJe9dR+2U2/dJOPPdQtumamT6t8W156y8vRzcPSdOzr8tdnz5zkrrl4ejf5cxascjNOOsrLGHrQx/yT/+q1W336kcOHJLJ8BP8KQUAzXYvuXdftoUl2+8zzO7ydbHxht7v85gcr2ojNWNpNXfZ47e1r3W3fnulknyonlhPbv2zR+kpszxaf1ijWz3QttGPp9Eb7vsTelW77zreTfnHhuZ91p5xwpJ/JnHfDA277zgrefuMAACAASURBVA4vXmUpqO8qnDnvXt9vbrrib931P3zCWT7V6cnntrsJbaOStKGemi0M5UpWWh+XXp1d+92mbbv9WLB04Ze8Xln1kpyQj9VZPG+66yk3fcoRbvFP17tRI4a4Rd85xy34wSNuwSUzvEzllVxr386uD9w1i37t/v7iU9yPf74hGYusLc4/81N+DKm2zmE7qywFjUVmFx9GeR30We1hY5Cx00xkXA891A8bMrjbeBbLVXubLF0L28XaUOPnmsf/5Ms1ndJYpo2ppp/0DtsmrU2tnhwh0EoEcDxbqbUydJ16/Dh/I9QgrwFcg/yGrTu9Aznmb4YlA/qd152X3EjuWvVcj0E6Q3wSrYHz5mW/dT+//e/8jKsNimdMm+BvurGTqozmAK9aNCdxgP9hydpuDkhSAB8GLIGJE8b4um3b3u4dE930Za+nTDnKvf7GXve/ntrm1t83z+lBRXZ1x8pnvU3lASL7zJIj25dcOSDmCMhhky3eMv8sr5Pyy4lVf5JDEAY5OqvXbnGPL7sksX3T8ZtzpnnHT46G8q56ZIt3hMP8+qw+N3vm5B6zwcqjfrV4wRe87LSlWXPQNq3+lneuv3vHY4meoVzroyYr1uHOlb9zcjjFQ6FcvTSOxHx+te4l959m/zu3r/N9t/yBjclYIJbVhIM+PtiXHbdFnjqPHjXM/fhnG5zGFLVTLCvWQ4696qx2D9tYDnRcD+XVmCUHWIzMqRcnPTyoLD1kmK0uue/ZA22+aE63Nox1SLM1sVRdYsZmg5LxyDMvJzYXy+QcAq1KgD2eLdZymi3RU7X2z9l+Sg2gmqXUzKRu4rq5K51u6n8zYqgfQDVoKmig0wyFBs+0wb4cDg3y/+P75yfL/OPHjfTJX911YAYnzqvB1hxg6SinQjpJN+lIGJgEdKO3/Z3alyw70FLq1EltfuZOtZad/nn33sR5uvWqs7x96Jrsauebe/0DVB5Css88cmSDbYeNcCd+eqwvRvmnTW5zG/64q0exmnGU06h6KJxz6ifdvnf3+3ooTjN9d/9sg3dc55wzuYfjagLlbOftd8qrFQQ9VCrIiVcfbu/o9LLUl60vqn8r7Hm70x/jf5qhs7FA18rVK43P1RednIhUnY1HElnHD1l1trpZXVX3cuNZWGeNQ0eMHdGtjeN6yEE1Rpr9lI1ojFO7qf3klGosUxAP2U2lkMUyLT60wdd2MVZWYsv11iPAjGeLtVnWcoscOi2l62akQVLLYppJUUhbltJgWksIl5kq5dcN4u29Xd7RnH7RskrJuT5ACIRLhWGV/Mz4veu8IyrnTjdYu2lrJsmWnJVHdl5LyCNH/UR9JrZN6R8GORxybDTrGOqoPmZBzqse/uQwyylNC3Jo1H9UXlY/TssXx5kzpHg5QIePGe77vJwlOTJ7/9LlHzDjfPF5pXplPVDGchpxHtbZHE6NL3J85TyLgTmD5fQxXuXS2CynbYlQWo2vmgFW+9YSsliWs0H1DW2V0vYnbW3K6le16EMeCDSTAI5nM+nXsWw5mboRaqlRy0e6CerpXktLWpazfUo2qNZStG7quvna3rA0hzaUa7Ortme0mhtDmJ/PA4uAnDM98Gx84Y1k5kg1jJd7da79oHlDXjmaKQv3ImeVZ85KuRu/ltk1Azri4CHukadf7rGcbrLlfJoDesPSJ3JvJzA5dkxzHtU/q5mJrFQvPcRqhq+/BTmcmgnUXnIFc+Kr0dN4aV9mWtB1tYttidC5thAphM5vWt5ycbK1NJaVbFDOp17K0jguB1TpbTa2XHlcg0B/JsBSe39unRy62XL7w+te8rM4ekJPc/Q0IxI+yYdFmKNoy5x64cNeSArT2WfNNFiwm5id66ibn5ZXbQtAeI3PxSMgG5Fd3rny/3gnzfZ9atZHDqlu7AqhXcWU5DBo+4YeoOQUaJ+lvehWjZxwSXbMyGHeNmXnlYLK1R5PlRsHxWkv3sJ5p/k/7fGUo1AuSF44S/fOvq7M5fFycjQLp6C9p9r/qb88jkm5esV8VCftaUwL5pRZ2ymtth6UC2FblEsXX5NDfPb0Y5L66psDyjnaeljWQ4mC2lrjka0GxbJtVlMOnoK2hCi9go1xKx7enGyXEA9r63JtmMUyjvcFpfzT2Hz0uJFO6QkQaHUCzHi2WAvKadQeTws2k2k3dTmK4TK7npgvu2CqXyLUAKzZAc3ypAUN3trvpLeC7e3MK+d+zt334GafXHvM9NRubw1LTrgkOvvsSf5N+vCtdr3xrhuMzU5IkM1QlLtZpOlHXGsQ0HJ0uCQdzhTqhi+HRMvs1v5mV7bkfe6MY/3MYVptLa31gZuuOMM7sUpr17LkaAlczqOum07hUqaVZzP6dq6jfT2Ulas4s2O93HPc0aOTbQPa4ymHWG+nW7CZM3uQs7y6rj4qHtZvwnyWP+sohtpzGOql/q96SW6lUK5eyq8Xr6y/m9w0mRp/5s892c/K2Tijvr92/Stpyf12hLAt1HbVBjnWcnC1j9hCuZlr2ZOcRauH2ld1U5vEIRwDdU3tpBUbC/YNHmZjGn+Nc9iG9q0gli+LpeKzbFB5TWd9ls1aWSaXIwRakcCgUqlUakXF0RkCEIBA0Qloti38Oinx0OyeHC05P3IIB1rQlh89AIf1095Zzd6aI211VtrwmwwsniMEINA8Aiy1N489JUMAAhDoFQEtOw8adODbKkxQ1ossdr3Vj3Ikw20KmrnUqgoBAhBoDQIstbdGO6ElBCAAgR4EtOysF2HCpfZyy849BLRghC13h0vttnWiBauDyhAoHAGW2gvX5FQYAhCAAAQgAAEINIcAS+3N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAAQhAAALNIYDj2RzulAoBCEAAAhCAAAQKRwDHs3BNToUhAAEIQAACEIBAcwjgeDaHO6VCAAIQgAAEIACBwhHA8Sxck1NhCEAAAhCAAAQg0BwCOJ7N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAAQhAAALNIYDj2RzulAoBCEAAAhCAAAQKRwDHs3BNToUhAAEIQAACEIBAcwjgeDaHO6VCAAIQgAAEIACBwhHA8Sxck1NhCEAAAhCAAAQg0BwCOJ7N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAAQhAAALNIYDj2RzulAoBCEAAAhCAAAQKRwDHs3BNToUhAAEIQAACEIBAcwjgeDaHO6VCAAIQgAAEIACBwhHA8Sxck1NhCEAAAhCAAAQg0BwCOJ7N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAAQhAAALNIYDj2RzulAoBCEAAAhCAAAQKRwDHs3BNToUhAAEIQAACEIBAcwjgeDaHO6VCAAIQgAAEIACBwhHA8Sxck1NhCEAAAhCAAAQg0BwCOJ7N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAAQhAAALNIYDj2RzulAoBCEAAAhCAAAQKRwDHs3BNToUhAAEIQAACEIBAcwjgeDaHO6VCAAIQgAAEIACBwhHA8Sxck1NhCEAAAhCAAAQg0BwCOJ7N4U6pEIAABCAAAQhAoHAEcDwL1+RUGAIQgAAEIAABCDSHAI5nc7hTKgQgAAEIQAACECgcARzPwjU5FYYABCAAgTwE3nv/r+7KWx9yz2x6PU+2lk2755333Ne+t8a9+Oqefl+HorVNv2+QKhTE8awCUisk0UBx/tUr3Qmzf+T/Pv/15X0yaFgn7yv5rcAaHcsT0M1K9mG2qBu27KbeQeXo5ijbb7Vw809+6x0ZcWn2Tb6VOfZVu6/41R+c2qheQbIkcyCEZtvrQGBY9DoMLjqAgVB/3Tguu+mXbtSIIe7xZZe40YcM9U7n8n/Z6K7/5ulu6EEfGwjVpA4tQEAzQt+94zF39/VfcceNH+011g13zeN/chd+8TMtUIPGqLjwG6clBXV2fZB85gMEIACBgU5gUKlUKg30Sg70+ulpevXarW7pwi+5U044slt19XQ674YH3OlTJ7inNmx3b+/tSpwCy6cMI4cPSeJ1Lgfi8psfTGRde+kMd/6Zn3ILFq91636/I4mfcdJRbtE1M51unipn+84Of83icXoTVAP+g9nagktm9LBDVV7Xb1j6hJs5/Rh3/Q+fdGYjse3MnjnJmWOmGcHQ5uyanNnblq9LmJos2Vto1xPaRrplN87yD2NJ4jK6vP7GXv8Q17GvyyeX3YcOcyg71KWza7/btG237xvqh6/u6nDPPL/D9w3pFLOR/tt3vu3OmDahWz8zfbdtb3dPPrfdTWgbldRTuowfNzJJb+VbvULdTI4eQtWX02SpXuU4mtys/Fm6WF1tLAj1jK8ZX3t4Nu42loXjUKUxSvpaWbE8K0dpwjqHnHQttjfFKa+NfbLd5Q9s9ONcnDdN19GjhnUbFyXP6qbPFmJ9LY30uemup9yXT5/oFt27zpcbcrA+deG5n/UPfOIX6xXWN8yrstN01gOj5F6z6Ndu4bzTkgfIOL3Ow7LCcnTN6qDPcciyVaXL0knXQk5WlyMPH+HHiHJtE5fPeZMJyPEktC6B9o7O0qyrVvg/fY6DXZ9ywdLS/Q9tTi5//+6nSqdfek9p2/b2UmfX/tIVtzyYyHh64w5/rniFtLSWV9etDMlQHsnUdeUjFIeA2v3ihb/w9pBW69hOlMZsz2zT0sgGFWRD9jm+llae5JgdWv40OzRZYVqLs/Ik/6vzV3h7lqxY9u3/vN5fU7z6l+VLSxvLVh7TS9fETeVZkKywz9q56au06mNWZqybZJt8y6s0CjoP+28aR9PD0lerSzXtaXpYGZbH6mLx0usflzzqbURxYR1jZrpm9Y1ZS461Y6W6WtmhPMWZjhprJd/Orcxyuiq/0sX1trIkT+2qo4I4xOXYua7HHHTN7ELXVZbpFcqK85bTWbrENqn8CmnXpFOoY2xjH2b1h1B/RYT6VtJJZZidKK36oLWFlW/nxiAsm8/9gwB7PJvs+Pe2+D1vd/pZzEpyNCOkp3YFPc1u2LrTTT72UKenRc3InDLlKP80rZkWzZreed15yRK9Zl30JN3e0ZlajPJodkMyJEsyJVtlqCxCMQjIPvb+5cBMYVaNRxw8xM2fe3JiW5ph3PfufnfOqZ/0WTRDN3vmZD9DpwjNfNos/rAhg13bYSP8bGKafM0OaZZRsz+yQ4XZZ09yL762J9UOY11kx5J/4qfH+rya+Zk2uc1t+OMuPxMWy776opOT2SDNtJmeabrVEhf22YkTxrgpE8cm7KyPaWa1mnrHsrQtJ6s/p+ka58/SpVJ7SrY4Suc4aFY2DOJ/61VnJW2pGdadb+71qysa9xQ0o6iga2+07/Nyy7Wj0r62q8MpTS1Bs/myURszrcxyulYqR/I03uqoMGbkMKd1SKuj4qxcfZ56/Dj35917nVgrxHasWXQbe8VU/clkq5+pvylvb3T2BX/4z+wv1FF9yN8D/rgrTFrRVsvplNau6oMWrPy4bew6x/5DgD2e/actatJEA69uInmCOatyFqdftKxHVg0k4fJmjwRRhG5+Clr6DJc/tQxDgEA5AnJ+nt+22505795uyeTIKejBJdzCoTg94KQFLdnLMQm3iChdtXYoO9Y2krhPaKnVZKeV2+w4063aepsD3xd6V2pPPUhomVWMw2VabdfRmKMX0uTk6lwORLx8a21pDqfGMjlVcrAOHzPc5ynXjnJstP9Ye+L1MB0uweflIWdXTrSFLF3terljuLysdFpGzgqq+yFlrstxlTPa9f4H3hnXNqxwXA5l90Zn08/sz851VNupPeJgacvZapZOdp+JZaadx22Tloa45hHA8Wwe+7qUbDcR3TD1RFjNrIs5q3oitQE+VEY3hi0vveVWLZrjn4rjgSBMq8/q5Aq9GcRjmZy3HgHNyilUa4dKq5ukZs8WL/hCMitjNdcDkPaEasZG+xHtgciux0frC5r5qKYfxPllx6HTE15X2ZoN7Y+ht/WuZ53KtaeVI+fTHFC1r41BmvWzNl780/V+/+vqtVuSFyblnGmfo4IcTs1czlmwyp+bE6uTcu2o63I+f3PPpcl+QaWvxV58wR/+k25Zuobp0j5r36IcQxtvdX7t7WvTkvo41f2dD/cgpyWylYchBw32zl/WuNwbncNyzf7COLWjZoO1WhYGS5vVR8vppHYKHf1QLp9biwBL7a3VXj201ZOllhYVNCjb0raOciC7Upa0NEMwdVKbdy5tuaaH4A8jNICEnT3tSVYOhwb+rCW0LNnEDywCsis5iXqrXTdPC3pw0V9a0EOQlucfefrlHpdtdkQ3HAXZqh6IwqAbsG7ECmabKx7e7B2YMF01n+U0Sf7GF3b3SJ4me8l9z3arZ5hJOkuW9a+7Vj3nt6OEacLPYpBn6TvMm6ZbeL2azyHHatJnpSnXnnEeOSU2S2nXrC66phkuOftyVhTCpXixOnv6MW7T6m/5vzVL5iYPLuXa0crRUboePW6kf/gJ4+2zLaPbebljOV0tn14mSwuqy6BBH20b0NYOe8nK0odj++pHt7ojxo7wW5p0XbZzx8pnvc1rvJb9a3xXfxRHOcR2XzB5Olajc5g+/Bzaq7VZ2O/Uh2T/2hYQhrS04fVyOsXtqjFGfZDQegSY8Wy9NuuhsZ7W9bSs5SNbsrQ3/oZkfJXSNRdP90+kNmMgoTZr8M050/weIbt27oxjuy39aN/co+tf8bMNNkP0T1fP9OWHy5T2hmkPhYkYsATsDXCzHVXUbESOZBx0c9Rb51pOD5cDbZZGMyO2LCf71Cy9Bc1caQ+myrIybCYttEO7ppteuRAvw1paeztXfUbLwSZb9q08chTioD4px8g4XDn3c17HOJ3OzWFXPa0PpqUrF1eu3uXy6Voax0qssmSWa097M9y+FcPqGm+nUHuJtYIeZo23xiEtISuIrxxRLc1bsHYu145Ka/akz7IzpY+D9kLKYVPZSmP74+N0dq7rWboqjcZMjc9p3z6iushRtLFb9ZBDHIbzTjvO/Ydv/0/vkBo3tZH6lJicMHFswinkZ/3RZEum5a+kc1h++DnNXmP7s/tPGts4rWRb25XTSbJumX9W0n5WRqgbn1uDAF+n1BrthJYQgAAEIPAhAc2gy9GzZXpFa4VHM3zmbA0EWLb1QKtaclDjIKc97WuP4nScQ6A/EWCpvT+1BrpAAAIQgEBFAlq2DpfpbU9hxYwkgAAEmk6ApfamNwEKQAACEIBAHgK27SFcarftGXnkkBYCEGg8AZbaG8+cEiEAAQhAAAIQgEAhCbDUXshmp9IQgAAEIAABCECg8QRwPBvPnBIhAAEIQAACEIBAIQngeBay2ak0BCAAAQhAAAIQaDwBHM/GM6dECEAAAhCAAAQgUEgCOJ6FbHYqDQEIQAACEIAABBpPAMez8cwpEQIQgAAEIAABCBSSAI5nIZudSkOguAT0G89f+96abr9frV+9ufLWh2r6jffikqTmEIAABPIT4Avk8zMjBwQgMMAI6PejCRCAAAQg0PcE+AL5vmdMCRAoDIFnNr3uLr/5wW71nT1zkpNjp9+VnnfDA277zg5/3eJ1ot/eVtBPIa5eu9V/XrrwS8nvU1fK29m1323attut+/0Op3wnfnqsW7B4rT+XMCtL5dy2fJ2Xr38zTjrK/973msf/5Ms2BzSuR/irOJV0TYTzAQIQgAAEehIoESAAAQjUgUB7R2fp4oW/KG3b3u6l3f/Q5tL3737Kf+7s2l+64pYHS4pTUNpZV60oPb1xR5J2ygVLu53rutLlzSuBKtdkx2VJP+mpeAuhrsp3+qX3JPVQep2bPKXN0tXkcYQABCAAgXQC7PHs6YsTAwEI1EBgz9udPtfoUcP8cfy4ke6N9n1+3+Trb+x1+97d78459ZMH0hwy1M2eOdk9+dz2pCTNSp5ywpH+fOrx41yp5Jxk5s0rAZq5NFnDhgx2bYeNcK/uOjDTmhSY8UE6XXbBVHfc+NE+hY5nTz+mKl0zRBINAQhAAAIfEmCPJ6YAAQjUhYA5nHIWRx8y1Dtqh48Z7oYe9DHX3tHpnt+22505795uZcnZTAuSdcjwIf5S3rzKFC/NK+6UKUelFdUt7r33/+qd5Qlto7rF61zbANJCqGvadeIgAAEIQOAjAjieH7HgEwQg0AsCcjhf29Xh5ixY5aVMaBvplt04y38eM3KYmzJxrFu84AveKc1TTN68ch5vWPqEn1G98Iuf8TOu2u9ZTZCTLGc5DllOZ5yOcwhAAAIQKE+ApfbyfLgKAQhUSUAzk1qS3rT6W/5vzZK5iZOpWcG9f+lyjzz9cpXSPkqWN29n1wdu55t7nZb6FbRUv+Wltz4S6Jx7Z1+XX8bvFvnhiWY3V6/dknzdkr5+6dH1r7gzpk1IS04cBCAAAQjkIMCMZw5YJIUABLIJaE+l9keeMPtHSSJ7a1xL75r91Fvt4Vvl4dviSaboQ968Sr/gkhnJ2/WaeZ187KGJVO3ZnDa5zc/Mmn7JReecZkkVwm0B4Rv2YVo+QwACEIBAPgJ8nVI+XqSGAAQyCOhrhp55fof/eiItWSvoi9k1g2jOXEZWoiEAAQhAoCAEWGovSENTTQj0NQHtg7SXiVSWvajT1+UiHwIQgAAEWocAM56t01ZoCoF+TUCOZvil7VK2mqX0fl0plIMABCAAgboSwPGsK06EQQACEIAABCAAAQhkEWCpPYsM8RCAAAQgAAEIQAACdSWA41lXnAiDAAQgAAEIQAACEMgigOOZRYZ4CEAAAhCAAAQgAIG6EsDxrCtOhEEAAhCAAAQgAAEIZBHA8cwiQzwEIAABCEAAAhCAQF0J4HjWFSfCIAABCEAAAhCAAASyCOB4ZpEhHgIQgAAEIAABCECgrgRwPOuKE2EQgAAEIAABCEAAAlkEcDyzyBAPAQhAAAIQgAAEIFBXAjiedcWJMAhAAAIQgAAEIACBLAI4nllkiIcABCAAAQhAAAIQqCsBHM+64kQYBCAAAQhAAAIQgEAWARzPLDLEQwACEIAABCAAAQjUlQCOZ11xIgwCEIAABCAAAQhAIIsAjmcWGeIhAAEIQAACEIAABOpKAMezrjgRBgEIQAACEIAABCCQRQDHM4sM8RCAAAQgAAEIQAACdSWA41lXnAiDAAQgAAEIQAACEMgigOOZRYZ4CEAAAhCAAAQgAIG6EsDxrCtOhEEAAhCAAAQgAAEIZBHA8cwiQzwEIAABCEAAAhCAQF0J4HjWFSfCIAABCEAAAhCAAASyCOB4ZpEhHgIQgAAEIAABCECgrgRwPOuKE2EQgAAEIAABCEAAAlkEcDyzyBAPAQhAAAIQgAAEIFBXAjiedcWJMAhAAAIQgAAEIACBLAI4nllkiIcABCAAAQhAAAIQqCsBHM+64kQYBCAAAQhAAAIQgEAWARzPLDLEQwACEIAABCAAAQjUlQCOZ11xIgwCEIAABCAAAQhAIIsAjmcWGeIhAAEIQAACEIAABOpKAMezrjgRBgEIQAACEIAABCCQRQDHM4sM8RCAAAQgAAEIQAACdSWA41lXnAiDAAQgAAEIQAACEMgigOOZRYZ4CEAAAhCAAAQgAIG6EsDxrCtOhEEAAhCAAAQgAAEIZBHA8cwiQzwEIAABCEAAAhCAQF0J4HjWFSfCIAABCEAAAhCAAASyCOB4ZpEhHgIQgAAEIAABCECgrgRwPOuKE2EQgAAEIAABCEAAAlkEcDyzyBAPAQhAAAIQgAAEIFBXAjiedcWJMAhAAAIQgAAEIACBLAI4nllkiIcABCAAAQhAAAIQqCsBHM+64mxtYSt+9Qd3wuwfuWc2vZ5akfD6i6/ucZ//+nJ35a0Puffe/2tqekWGeTITcQECVRLY88577mvfW+Nkf2lBtlvJJsN8sl2lz7L5MC2f+x8B2cGsq1Zm2kOWxhqXbv7Jb7Mut3x83n7Q8hWmAi1FAMezRZpLg6ScwvDv/KtXOt2Is4I5fToSINDXBMyJC21UnyvZX185Aeob6iOVys/Dpa90zaMDaetLQG1aaSytb4m9lyaHWw9g5cb/Wkup9HBXq9yBlM8mXnhgra1VB9eWjVzNIrB04ZfcKScc2azik3KPGz/a/eaeS5NzPkDACFx76Qx34Rc/Y6dNO44+ZKhbs2Ru08qn4NYgIFvtD/baGrTQUgS4//XODnA8e8evX+TW09dlN/3SdezrciOHD3F3X/8Vt+GPu9xty9d5/XS8+2cbfLw6jGZPV6/d6q9ZesVb+OP/e8t9947HvLwJbSPdshtnOd3Ew6Cn4nk3PODaDhvhFl0z019asHitW/f7Hf5z7HyEMmecdJTPM/Sgj4Ui+TzACYR2qqouufZc97PHtiY2I5s0u9FMwuU3P+iJpNnon17918Tms2xUM7CyyQvP/ax/WIvL10PciZ8e68to73jXz3pt39nh0uSZLLNv0/X8Mz/lbrrrKTd9yhFu8U/Xu1Ejhvj+suftzkQ/FWAPjJKj9F8+faJbdO86l1Ze2D+tr2x8Ybd78rntbkLbqKRfz545yS38xmle/1i/8Jpm9Dq79rtN23Z71qZLWE5YZ7GPy7J28YU5120MUVmzz57krr19rbvt2zP9TVnpJEd1TBs/wrKtjhoPKpUd1/PKuZ8zlXoc47QhkzCxylzx8OZkTNK52Z6lU95vzpnmblj6hLcnGx+r0X38uJGJvFiHkEO1baD2tLH9zHn3ulAHDJ7l+gAAEZNJREFU09eO9z+02d258nf+tJqyt21vT3Sds2CV7wuLvnOO+88/fsotnHeab1vjesqUoxKHXTo98/wOz7Cz6wN/b5BtK1RTru4vldre6qRjWtqwnCybD9lJjvUF1SmtX/73685z/+We/+37TTgO6f53zaJfJ0xCuWE7xmNO2I/ia6ZLWM8B+7lEaAkC37/7qdKUC5aWnt64o5u+nV37S1fc8mBp1lUrSu0dnf7vJz//vz7N/Q9t9nl0tCA5dq70yqf8kmPpTZbKUpnKo2DXFZ+V1/STDkpjeawMk2k6mF4cW5+A2WJa29o1s4+wtkpvNqb4bdvbS/+45FFvkzrXdbOf2O5MruWXfEtr1xQXfg7LtnizeTs3eWFa0yW8Zuktv9JIR+mgo4LKt+txejs3maH+PvOH/xSvvmhsjYPiFZTfPsfXlCceO0Kmlj/UISxLck+/9B7fLkob5739n9eXNm/b7ets+sUydW5BaSyd1d/O43qWK9vyhrpZGTpWYhLW12xG7C5e+ItudbV0xjVMq3Ytp7s4WnrZtXS1dlI+u2b6WlmVOEiW9JROaSHOn6fsmIHpZvXUdekd9lHprevWJmFaMapHncN6xvWztgnLSbN564eSpbRmO6a3XbfzUIbqaO0VMspqi1gnpfvq/BXetky+6RvWrQif2ePZYo8UehK3PXR6yrKgp0s9rerJcd6/P8miexw1Q2LLSsOGDPYzljvf3Ov0lGphwSUzvJyJE8b4J94NW3dWvZdIMyUK0iGcJdWsk2Y0xowc5mdlt+9824rjOMAIaDbGbDTeO2f2Ua7Kmn2/9aqzvL0onWaMQhsdcfAQN3/uyf66bEq2Va2NZpVvNi95msl5o31f2ZfmYv0tv+Jl93ded15i/7L5Usk5zYJasPRp5W156S33+ht7LWly1MyWZlgVVMbUSW1+ZlLn6te2Bcf69au7Dsw46bpmg+y6Znc0O2V90l8/e5J78bU9ST8Py9I4oJnc9o5OzyTOe/VFJ7vPHHeY56Zrkq8ZIcnTTGgcwqVt1f/wMcNdOB5UW7byyg40E5UWKjFJy2NtNHrUMH9ZthfaQmh71gbldJ8ycWxiq0cePsJNPvZQp3bpTRuk6Z0WF3JUnzp7+jHeXqopO5anmXZrW91nTpg41h087OP+vmFtPfX4cd5u9727351z6ie9CDGaPXNy1eWGOod2F+uj8zCttUXYv9Ns3vqd8mu1Q+2h1UELdt36ZSjjjGkTuo1DlkfH13YduP+GceKkFUFbVVEbTJvc1q28UN8w70D/zFJ7i7Vw2nS8Bl/drGx5KJzOj6sXT+/rupYGeht0Q9TApCVI/WlQsCX43somf2sRyLI/2YOWvuWUmn1ogE8L4dKVrpezUTl2cgjKBZWTVn5aHjkbsuXehHi5Nss5UhlheXIOb5l/ltMyp0Jafze95AyY02NbX2x5U2nkQKcFPWTKkbfxwtJkMTZHVuksr+UJj3I2HnnmZe98yEkd/omPOzlbcZDjE27L0XXd4NNCtWWn5c3DxPKbwykHVM6MHAM5xrKf8OHc0odtYHHVHI1jLW1Qjfy0NKZr3rIlS06l2lZ5tS3ltJPGu9WPbvWTHbpuba0tIc9v2+20BSAMat+85YZtH8rK+mz1S7tuZYfX1KZq294GOZTa3mbb3Wz80wOGtuZMv2hZtyJ0PWs8UnwRAo7nAGhlGb5e9LGBdvXaLckTZ1g9Xf+HJWv9U545hboB6CZULuipTYNAuaAOo1keBdu3pEGIAAEjYDZijof2RNoeRUujo5w22fDjyy7xN3+da69gVpCTs/cvXVmXk/i08q+5eHpyvV4f9HCnWd9Vi+b4PXE61/7HaoOcz02rv+U5aC+hbmppwZxO8dTeQ80saTbR+KblUZzd0DW7Y7OgWWnjeMsbx+tcjtpxR4/2MzrSTY5v2o1U7a4bvuqooPGimlCu7Dh/XiaWXw6nZq/M8bf9ena9XkerSy1tUKsOZi+VytZ9Ig56gJBzufGFN9wfXnrLnXri0U4zgHLM5fBZW+shULO8ixd8wdtDKEdtontJX9XZ6heWaZ+tznauo/TRbLb0722we7BN7OhhUn/lHrDTxqO08bC3uvXH/Cy198dWyaGTBgl9D6GOceeS4ZcLWs7TTGkcdJOXPC0VaAbFnvjjdOG5bh5yEBTq0ZFD2XweWAQ04MqmQjsJlzM1UxA+7MTLUXIy71j5rL9x6OahF0O07CzHp5qQVn41+SxNqKvFhUc5woMGOWezZ1rK04t/eYNu4kePG5nI0ezJmsf/5MXoBvfo+lf8zd9mc6y/Z/VrK9/qL27ilyek5V1y37PJ92jKGZHTLd00SxaH+GavcUbbJKoJcdmSJTtIY5uXiZWvttOStJxi/elbEaq1K5NRzTGuSzV54jTv7Ovqtn0jvp5lL9WUrT4mFhaUR87lA0++4KN0r5F9qi9odcDaWjavvI88/bJlTY7VlJskruJDVv3SsqaVrYkR3f9M97R8eeNUf/VZsdGf5FeagDHdwvEwb7mtlr78NFar1aYA+oZLM/Y0rr1atrRhb95psNTeEj1x6UZgb7XraVMyNP2vtNOnHOn+tP1fE3KSeemsExN5yl/NrJDe+NRb7rbUp+UEzaaE+8ySQvgwoAnI3vRnQbagZdjQPkK70jXNcMomlda2bdgS1bkzju22lC6ndOb0Y5IlrFCWlRkf5eBklR+nLXeepmucXnYvR9j6pPTTzaiaEG8x0FK7OT6S84eX3nQnzD7A1vqY5Fq/1mf1Ye1dKxc0s6KHRWOstJJvKyHl8mo80EqJ5dUyqmZ8FGxfuNoobZldN1ltDdKypGzExqBy5YXXwrKVV9sSfvzuhjCJ/yxmeZkoo9pODzraDmKhWi6Wvtpjb9pAvLVfUDOzpp/YhkHtollAq0toL+XKFjvNnus+YfcYxclB033EZjfD9rXPSqdvMVBfi8cAzcaXKzfUvZrP5fpDWv64bLtXiqUeYmoN8bYacbb+EC7Bm3z1afWTeoxHJrPVjoP0BlWrKY2+EIAABIpEQDe38Ct/+mvddQOXUyrnxF5i7K+6puklx18zeHLAzZGTg67ZqFasT1odB0Jcq/SHgcC6L+rAUntfUEUmBCAAgQIS0DL/n3fvrevyZSMxaoYw3FokR1rLyQQIQKB+BFhqrx9LJEEAAhAoNAHtZz1ibPoyeyuAsaV8W56Wzlo6ZbazFVoPHVuFAEvtrdJS6AkBCEAAAhCAAARanABL7S3egKgPAQhAAAIQgAAEWoUAjmertBR6QgACEIAABCAAgRYngOPZ4g2I+hCAAAQgAAEIQKBVCOB4tkpLoScEIAABCEAAAhBocQI4ni3egKgPAQhAAAIQgAAEWoUAjmertBR6QqBgBPTF3frr66AvDW9EOX1dD+RDAAIQaAUCOJ6t0EroCAEINISAnNDzr17p9BObCjilDcFOIRCAQIEI8AXyBWpsqgoBCJQnoC8K58vCyzPiKgQgAIHeEMDx7A098kIAAt0IvPjqHnfZTb90Hfu6fPzShV9yp5xwpNNPD95011Puy6dPdIvuXee27+xwE9pGumU3znKjDxnq0+r3ly+/+UH/ecZJR7nhww5yBw/7eDf5OtFs5A1Ln3Azpx/jrv/hk05p9dva+rnGsOzwF2fsN8TX/X6Hlzd75iS38Bun9ZBtvwF90xV/667/4RPO0q9eu9V9+z9Od89t3dntd8ily7wbHnALLpnh69lDIBEQgAAEINCNAI5nNxycQAACtRKQE3bHymfdz2//O+9MyomTkynnctiQwW5f5/vdzhcsXuvuWvWcdwCVV2nNUTUnVA5iWtj55l63dv0rbv1989zQgz7mndF/WLLW3TL/LO8AygG+9va1/jfDjxs/2i3+6Xp34bmfdXded55PK2dRZcgpTgtDDxrs02qpXb/fbU7qxwb/W/fM8zvc+Wd+ype7bXu7zz5xwpg0McRBAAIQgEBEgD2eERBOIQCB2gho5lKOnc1gjhk5zJVKzu15uzMRqJlBXZezeMqUo9wb7fv8bKgcuLbDRrgTPz3Wp5VDmOV0KsGIg4e4+XNP9nJ0HueXszltcpvTb4cryHE0J1NOsMp6dVeHv5bn39Tjx7k/797rZ1eV78nntrvZMycndc4ji7QQgAAEikiAGc8itjp1hkAfEbCZShM/cvgQ+9jjOH7cSD97qAu1OIGhQOXXsvj0i5aF0U7L7Qq2JK4lfgtyfPOG0KEdPWqYe/G1PW722emzsnllkx4CEIBAEQjgeBahlakjBBpAQMvbty1f51YtmuPkoNlydzVFh05oNenjNMpvez01mxoG7e/UnlDNTOrFIdvvGabJ8/mMaRPcioc3u0P/5hNu+Cc+7o48fESe7KSFAAQgUGgCLLUXuvmpPATqR6C9o9MNGuScZgIVtMxtLxlVKkXL8lteesttfGG3T6qZU73QU22I84f5Ors+cNoTKudUQS8hqaxqg20HsPTazyl5f/+DR/x2gdjRtXQcIQABCECgJwFmPHsyIQYCEKiBgPZQTp3U5s6cd6/PrRnIoz909iqJ0wypXgyyt9q1v1PL5Hqxp5qg/Hdf/5Vub7Urn72spL2lJltv008+9tBqxLpzTv2kW712i1/Ct7fktUdV9Xx7b5d/eakqQSSCAAQgAAFPYFCppO3/BAhAAAIQqJaA3nbX2+36GidmPKulRjoIQAACzrHUjhVAAAIQyEFAe0TldOrlJJzOHOBICgEIQMDheGIEEIAABHIR0B5RfaWSvlqJAAEIQAAC+Qiw1J6PF6khAAEIQAACEIAABGokwFJ7jeDIBgEIQAACEIAABCCQjwCOZz5epIYABCAAAQhAAAIQqJEAjmeN4MgGAQhAAAIQgAAEIJCPAI5nPl6khgAEIAABCEAAAhCokQCOZ43gyAYBCEAAAhCAAAQgkI8Ajmc+XqSGAAQgAAEIQAACEKiRAI5njeDIBgEIQAACEIAABCCQjwCOZz5epIYABCAAAQhAAAIQqJEAjmeN4MgGAQhAAAIQgAAEIJCPAI5nPl6khgAEIAABCEAAAhCokQCOZ43gyAYBCEAAAhCAAAQgkI8Ajmc+XqSGAAQgAAEIQAACEKiRAI5njeDIBgEIQAACEIAABCCQjwCOZz5epIYABCAAAQhAAAIQqJEAjmeN4MgGAQhAAAIQgAAEIJCPAI5nPl6khgAEIAABCEAAAhCokQCOZ43gyAYBCEAAAhCAAAQgkI8Ajmc+XqSGAAQgAAEIQAACEKiRAI5njeDIBgEIQAACEIAABCCQjwCOZz5epIYABCAAAQhAAAIQqJHA4BrzpWY7+ztPp8YTCQEIQAACEIAABCDQ/wg8+oNTG6rUoFKpVGpoiRQGAQhAAAIQgAAEIFBIAiy1F7LZqTQEIAABCEAAAhBoPAEcz8Yzp0QIQAACEIAABCBQSAI4noVsdioNAQhAAAIQgAAEGk8Ax7PxzCkRAhCAAAQgAAEIFJIAjmchm51KQwACEIAABCAAgcYTwPFsPHNKhAAEIAABCEAAAoUkgONZyGan0hCAAAQgAAEIQKDxBHA8G8+cEiEAAQhAAAIQgEAhCeB4FrLZqTQEIAABCEAAAhBoPAEcz8Yzp0QIQAACEIAABCBQSAI4noVsdioNAQhAAAIQgAAEGk8Ax7PxzCkRAhCAAAQgAAEIFJIAjmchm51KQwACEIAABCAAgcYTwPFsPHNKhAAEIAABCEAAAoUkgONZyGan0hCAAAQgAAEIQKDxBHA8G8+cEiEAAQhAAAIQgEAhCeB4FrLZqTQEIAABCEAAAhBoPAEcz8Yzp0QIQAACEIAABCBQSAI4noVsdioNAQhAAAIQgAAEGk8Ax7PxzCkRAhCAAAQgAAEIFJIAjmchm51KQwACEIAABCAAgcYTwPFsPHNKhAAEIAABCEAAAoUkgONZyGan0hCAAAQgAAEIQKDxBHA8G8+cEiEAAQhAAAIQgEAhCeB4FrLZqTQEIAABCEAAAhBoPIH/Dxrdye/Owtt6AAAAAElFTkSuQmCC",
K.a.w_c))}XAl(ba){const oa=[];for(const ma of ba.interpretedTextBody){ba=ma.text;const ea=this.Q$h(ma.subTextItems);if(this.af(ba)||this.af(ea))return null;oa.push(new Q.a(ba,ea))}return oa}Q$h(ba){const oa=new Sys.StringBuilder;for(const ma of ba)this.af(ma.text)||(oa.appendLine(ma.text),ba=this.Q$h(ma.subTextItems),this.af(ba)||oa.append(ba));return oa.toString()}af(ba){return!ba||""===ba.trim()}}Object(D.a)(N,"ListTransformationSuggestionGenerator",null,[985]);var O=c(23),X=c(55);class U extends Sys.EventArgs{constructor(ba,
oa,ma){super();this.node=ba;this.bne=oa;this.ane=ma}}Object(D.a)(U,"CompletingTransformationArgs",Sys.EventArgs,[]);class T extends Sys.EventArgs{constructor(ba,oa,ma){super();this.listId=ba;this.requestId=oa;this.C2m=ma}}Object(D.a)(T,"ListTransformationInsightsAvailableArgs",Sys.EventArgs,[]);class Y{constructor(ba,oa,ma,ea,ua,sa){this.tEc=ba;this.$Je=oa;this.Zih=ma;this.Lc=ea;this.hb=ua;this.KGe=sa.$("WordListToTableTransformationIsEnabled")}d6n(ba,oa){let ma;this.tEc.PSk(ba,(ma=new z.a,ma.add(Object(X.a)(this.tEc,
this.tEc.iao,"runSmartArtAnalysis")),ma),ea=>{this.YMb(ba.listId,oa,ea)},()=>{this.HMb(ba.listId,oa)})}YMb(ba,oa,ma){this.$Je.a7i(new T(ba,oa,ma.data.te))}HMb(ba,oa){this.$Je.a7i(new T(ba,oa,null))}iId(ba,oa,ma){if(this.KGe&&ba.tableSubtype){var ea=this.Lc.Pc(15);try{ea.set(oa.X0[0].outlineElementNode.yj);const ua=this.Zih.r5k(oa,ma,ba.tableSubtype,ba.styleId);this.d1h(ua,ba.tableSubtype)}finally{ea&&ea.dispose()}}}p6f(ba,oa,ma){if(ba.tableSubtype!==ma){var ea=this.Lc.Pc(15);try{ea.set(oa.yj);const ua=
this.Zih.p6f(oa,ma,ba.tableSubtype,ba.styleId);this.d1h(ua,ba.tableSubtype)}finally{ea&&ea.dispose()}}}d1h(ba,oa){this.$Je.AOn(new U(ba,2,oa));ba=x.ParagraphReader.$k(ba);this.hb.Ac(O.SelectionFactory.ne(ba,0))}}Object(D.a)(Y,"ListTransformationSuggestionRequestManager",null,[884]);c.d(J,"ListTransformationSuggestionPackageManager",function(){return aa});class aa{get name(){return"WordEditor.ListTransformationSuggestion"}constructor(ba){this.hrd=this.W=null;this.qwb=ba}wc(ba){this.W=ba;this.qwb&&
(this.W.ia("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionEventManager",()=>new M).ha(),this.W.ia("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionRequestManager",()=>new Y(this.W.resolve("WordEditor.TextAnalysisServiceHelper.ITextAnalysisServiceHelper"),this.W.resolve("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionEventManager"),this.W.resolve("WordEditor.Transformation.ITableConstructor"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),
this.W.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.K)).ha(),this.W.ia("WordEditor.ListTransformationSuggestion.IListTransformationSuggestionGenerator",()=>new N(this.W.resolve("WordEditor.TextAnalysisServiceHelper.ITextAnalysisServiceHelper"),l.AFrameworkApplication.K)).ha(),this.hrd=E.j4l())}init(){this.qwb&&this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){this.hrd.Ub()}dispose(){this.hrd&&this.hrd.C6n();this.W=null}}Object(D.a)(aa,"ListTransformationSuggestionPackageManager",
null,[1,2])},2091:function(D,J,c){function l(d,m,A,R,da,Ea,ib,Qb){let pc=!1;(d.dI||1===m.Xp.count&&1===m.text.length)&&0===A&&1===m.Wtf(m.Xp.J(0)).count&&(pc=!0,!ib&&da&&Ea&&(da.Values.type="ImageSelection",da.Values.payload="ImageSelection",da.Values.Action="SuccessfulSelectionV2",Qb&&(da.Values.payload=JSON.stringify({text:"ImageSelection",typeOfField:{regular:!0,conditional:!1}})),R.flag=!0,window.parent.postMessage(JSON.stringify(da),Ea)));return pc}async function e(d,m){var A=d.dGb();A=d.getRange(0).Wtf(A.J(0));
1===A.count&&pk.ImageReader.KBi(A.J(0))&&(A=pk.ImageReader.sn(A.J(0)),A=pk.ImageReader.Iai(A),A={height:A.height,width:A.width,imageSelection:!0,useSourceImageProps:!1,altText:m.altText},m.useSourceImageProps||(A.useSourceImageProps=!0),Object(hi.w)(d,"Filled"),d.pVc(m.imageUrl,4,A))}function a(d,m,A,R){var da,Ea;if(R&&m.tag.startsWith("mscacr"))if(R=m.dGb(),m.Of)for(Ea=0;Ea<R.count;Ea++){var ib=null===(da=R.J(Ea))||void 0===da?void 0:da.node;m=d;var Qb=A;for(let pc=0;pc<ib.ra.length;pc++){const Pc=
ib.ra.J(pc).formatting;m.Roj(Pc,Qb)}}else{da=null===(Ea=m.dGb().J(0))||void 0===Ea?void 0:Ea.node;R=m.dGb().J(0).cpBegin;Ea=m=m.dGb().J(0).cpEnd;m=[];for(ib=0;ib<da.ra.length;ib++)Qb=da.ra.J(ib).cp,Qb>=R&&Qb<Ea&&m.push(da.ra.J(ib));for(da=0;da<m.length;da++)m[da].blob||d.Roj(m[da].formatting,A)}}c.r(J);var k={};c.r(k);c.d(k,"getDocument",function(){return JB});var x=c(1087),y=c(0),n=c(2);class t{get name(){return"AppLoadStateTracker"}wc(){}init(){n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MarkAppFullyLoadedExplicitly",
!1)||x.a.get_instance().JNi()}dispose(){}}Object(y.a)(t,"AppLoadStateTrackerPackage",null,[1,2]);var z=c(186),v=c(7),I=c(55),E=c(46);class H{constructor(){$addHandler(document,"securitypolicyviolation",Object(I.a)(this,this.FYi,"onSecurityPolicyViolationEventHandler"))}FYi(d){d=d.rawEvent;let m=d.blockedURI;m=E.a.Nja(m);const A={};A.effectiveDirective=d.effectiveDirective;A.violatedDirective=d.violatedDirective;A.originalPolicy=d.originalPolicy;A.blockedURI=m;A.disposition=d.disposition;v.ULS.sendTraceTag(588084128,
306,15,"{0}",A)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(I.a)(this,this.FYi,"onSecurityPolicyViolationEventHandler"))}}Object(y.a)(H,"ContentSecurityPolicyListener",null,[10]);class M{constructor(){this.W=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.W.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const d=this.W.Oa("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");d&&d.dispose()}wc(d){this.W=d;this.W.register(H,
"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").ha().Ud(()=>new H)}static main(){z.a.instance.Gc(new M)}}Object(y.a)(M,"ContentSecurityPolicyPackage",null,[1,2]);var K=c(70),L=c(1086),S=c(246),Q=c(12);class N{constructor(d,m){this.avc=null;this.ga=d;this.Ca=m}Ub(){(this.avc=this.Ca.kb("StatusBarEnvironmentNameToUse"))&&""!==this.avc&&this.ga.fb(Q.a.d6i,K.a.frame,Object(I.a)(this,this.KWo,"updateEnvironmentName"),96)}KWo(d,m,A,R,da){if(1===A)return 32;da[L.a.Value]=this.avc;da[S.a.labelText]=
this.avc;da[L.a.Visible]=!0;return 32}}Object(y.a)(N,"DisplayEnvironmentName",null,[]);class O{constructor(){this.W=null}get name(){return"Common.App.DisplayEnvironmentName"}wc(d){this.W=d;this.W.register(N,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ha().Ud(()=>new N(n.AFrameworkApplication.va,n.AFrameworkApplication.K))}init(){this.W.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Ub()}dispose(){}static main(){z.a.instance.Gc(new O)}}Object(y.a)(O,"DisplayEnvironmentNamePackage",
null,[1,2]);var X=c(763),U=c(75),T=c(360);class Y{constructor(d,m,A=null){this.id=d.Id;A||(A="");this.sRn=A;this.sensitivityLabel=d}}Object(y.a)(Y,"AutoPolicyLabelData",null,[]);class aa{constructor(d,m){this.tDa=d;this.displayName=m}}Object(y.a)(aa,"PolicyLabelRequestState",null,[]);class ba{constructor(){this.Wbg=this.gUf=""}}Object(y.a)(ba,"PolicyStrings",null,[]);var oa=c(156),ma=c(90),ea=c(10),ua=c(39),sa=c(19);class Fa{static get KJf(){return Fa.DZm}}Fa.DZm="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(y.a)(Fa,"JustificationDialogHtml",null,[]);class Pa extends oa.a{constructor(d,m){super(!1,!1,Pa.QL);this.mcb=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.ivd=null;this.hvd=!1;this.Twd=d;this.xv=m;this.Vg=this.UNk();this.Cd=1;this.zg=Pa.id;this.ye(1,CommonUIStrings.l_DialogChange);this.qra(1,!1);this.FV(0)}Lhg(){if(Pa.QL)this.Uh(CommonUIStrings.l_SensitivityJustificationTitle,
Object(I.a)(this,this.V7i,"reactJustificationDialogHandler"),this.Zfi(this.hvd));else{const d={};for(let m=0;m<this.mcb.length;m++)d[Pa.E5f+m]=!1;d[Pa.Zbd]="";this.Uh(CommonUIStrings.l_SensitivityJustificationTitle,Object(I.a)(this,this.CZm,"justificationDialogHandler"),d);this.q7f();ua.a.addHandler($get(Pa.Zbd),ea.a.input,Object(I.a)(this,this.XJo,"textAreaHandler"))}}validate(){if(Pa.QL)return this.iKj(this.ivd);const d=$get(Pa.Zbd);return d.disabled?!0:this.iKj(d.value)}iKj(d){const m=2>d.length,
A=500<d.length,R=RegExp("[{|}|;|\\\\]").test(d);d=""===sa.a.lza(d);return!m&&!A&&!R&&!d}CZm(d,m){let A="";if(1===d)for(let R=0;R<this.mcb.length;R++)if(m[Pa.E5f+R]){A=R===this.mcb.length-1?m[Pa.Zbd]:this.mcb[R];break}this.xv(d,this.Twd,A)}V7i(d){let m="";1===d&&this.ivd&&(m=this.ivd);this.xv(d,this.Twd,m)}Nqn(d){this.ivd=d;d=this.validate();this.hvd!==d&&(this.hvd=d,this.q6(CommonUIStrings.l_SensitivityJustificationTitle,Object(I.a)(this,this.V7i,"reactJustificationDialogHandler"),this.Zfi(this.hvd)))}Zfi(d){return{["id"]:this.zg,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!d},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(I.a)(this,this.Nqn,"onJustificationUpdated")}}XJo(d){d.target&&this.qra(1,this.validate())}UNk(){return oa.a.Nx(Pa.KJf,n.AFrameworkApplication.Ms,ma.getImageClass(Pa.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.mcb[0],this.mcb[1],this.mcb[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}q7f(){const d=document.getElementsByName(Pa.x2m);for(let m=0;m<d.length;m++)ua.a.addHandler(d[m],ea.a.focus,Object(I.a)(this,this.Gce,"radioButtonFocusHandler")),
ua.a.addHandler(d[m],ea.a.click,Object(I.a)(this,this.Gce,"radioButtonFocusHandler"))}Gce(d){if(d=d.target){d.checked=!0;var m=$get(Pa.Zbd);d.id===Pa.E5f+(this.mcb.length-1)?(m.disabled=!1,Sys.UI.DomElement.setVisible(m,!0),m.focus()):(m.disabled=!0,d.focus());this.qra(1,this.validate())}}static get QL(){return n.AFrameworkApplication.ta.Kb.uF&&n.AFrameworkApplication.ta.Kb.LHf}}Pa.KJf=Fa.KJf;Pa.x2m="ListRadioBox";Pa.E5f="radiobox";Pa.Zbd="txtJustification";Pa.iconName="Info_32x32x32";Pa.id="JustificationDialog";
Object(y.a)(Pa,"JustificationDialog",oa.a,[]);class Na extends oa.a{constructor(d,m,A){super(!1,!1,!0);if(d&&A){var R={["id"]:"MandatoryLabellingDialog"};this.i1j=A;this.NJe=m;if(!n.AFrameworkApplication.K.$("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.NJe&&""!==this.NJe)R.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.NJe,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
m={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(m.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:d});R.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:m};d={["id"]:"MandatoryLabellingDialog",["bodyControls"]:R};R.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;R.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.Uh(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(I.a)(this,this.Z$m,"mandatoryLabellingDialogHandler"),d)}else v.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}Z$m(d,m){1===d&&m.selectedLabel&&(d=m.selectedLabel,""!==d&&this.i1j(d))}}Object(y.a)(Na,"MandatoryLabellingDialog",oa.a,[]);class Aa{constructor(){this.rMa=!!n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.uF}Hcl(d,m,A){this.rMa&&new Na(d,m,A)}static get instance(){return Aa._instance||
(Aa._instance=new Aa)}}Aa._instance=null;Object(y.a)(Aa,"MandatoryLabellingDialogFactory",null,[931]);class za{}za.wEo="sbProtectForm14";za.zEo="SBStatusBarMarkAsReadOnly14";za.h1m="Info_16x16x32";za.IIc="QuickSearchCompletedToday_16x16x32";za.X5f="CommonControlCheckboxCheck_16";za.sAj="On";za.visible="Visible";za.KHl="ImageIsVisible";za.lJa="SourceControlId";za.menuItemId="MenuItemId";za.menu="Menu";za.Bth="AppLockId";za.value="Value";za.labelText="LabelText";za.alt="Alt";za.yqi="Image16by16";za.obc=
"Image16by16Class";za.vEo="SBProtectForm_16";za.yEo="SBStatusBarMarkAsReadOnly_16";za.icon="Icon";za.iconColor="IconColor";za.customTooltip="CustomTooltip";za.CQn="MipTagDynamicFillWithOutline_20";za.DQn="MipTagLockDynamicFillWithOutline_20";za.BQn="MipTagErrorOutline_20";za.EQn="MipTagQuestionOutline_20";za.dne="transparent";za.VRo="UILocation";Object(y.a)(za,"PolicyConstants",null,[]);class xa extends oa.a{constructor(d,m,A){super(!1,!1,xa.QL);this.Twd=d;this.Paa=m;this.xv=A;this.Cd=1;this.zg=xa.id;
this.FV(1);this.FV(0)}lig(){const d={["id"]:"UserDefinedPermissionsDialog"};xa.QL&&this.Uh("Defined Permissions",Object(I.a)(this,this.Z1o,"userDefinedPermissionsDialogHandler"),d)}Z1o(d){1!==d&&this.xv(d,this.Twd,"",this.Paa)}static get QL(){return n.AFrameworkApplication.ta.Kb.uF&&n.AFrameworkApplication.ta.Kb.LHf}}xa.id="UserDefinedPermissionsDialog";Object(y.a)(xa,"UserDefinedPermissionsDialog",oa.a,[]);var ka=c(771),wa=c(208),ia=c(163),va=c(765),na=c(86),Ca=c(43),ta=c(403),fa=c(341),Xa=c(128),
ob=c(478),xb=c(182),zb=c(30),Lb=c(170),Ia=c(22),Ya=c(32),eb=c(132);class sb{constructor(d,m,A,R){this.myc=this.Gwb=null;this.e2g=this.tHe=this.jIe=this.Qxc=this.d4g=this.R6g=this.Iye=!1;this.QVb=this.aXa=this.oZa=this.I$a=this.Paa=this.eA=this.rCa=this.ak=null;this.$_j=this.Bue=0;this.GVg=this.x3g=this.kNg=this.ROe=null;this.ga=d;this.Yi=m;this.Ca=A;this.Hh=R;this.Bzc={};this.Ebh={};this.T6g={};this.clb=A.$("WacApplyManualPolicyLabelIsEnabled");this.Hh.value.GCd(Object(I.a)(this,this.r3f,"processAutoSensitivityLabel"));
this.Hh.value.P0e(Object(I.a)(this,this.r3f,"processAutoSensitivityLabel"));this.Hh.value.o0e(Object(I.a)(this,this.zwn,"onUpdateLabelInfo"));n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.H_a(Object(I.a)(this,this.SUn,"refreshDocumentPolicyLabelsOnModeChange"));A.$("SupportsPolicies")&&A.kb("AppliedPolicyId")&&(this.Gwb=A.kb("IrmPolicyTitle"),this.myc=A.kb("IrmPolicyDescription"));this.AXj=this.Ca.nc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.BXj=this.Ca.nc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",
5E3)}get VG(){return n.AFrameworkApplication.VG||!!this.x3g&&this.x3g()}Ub(){this.ga.qa(Q.a.QZf,K.a.frame,Object(I.a)(this,this.bMd,"documentLabelPaneHandler"));this.ga.fb(Q.a.Zic,K.a.frame,Object(I.a)(this,this.Zic,"queryPolicyLabel"),96);this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.qa(Q.a.b_i,K.a.frame,Object(I.a)(this,this.bMd,"documentLabelPaneHandler")),this.ga.fb(Q.a.H5c,K.a.frame,Object(I.a)(this,this.H5c,"queryPolicyShortLabel"),96));
this.ga.qa(Q.a.oSb,K.a.frame,Object(I.a)(this,this.oSb,"toggleSensitivity"));this.ga.qa(Q.a.NNb,K.a.frame,Object(I.a)(this,this.NNb,"populateSensitivityFlyout"));this.ga.qa(Q.a.DQb,K.a.frame,Object(I.a)(this,this.DQb,"setSensitivity"));this.ga.fb(Q.a.K5c,K.a.frame,Object(I.a)(this,this.K5c,"querySensitivity"),96);this.ga.qa(Q.a.yOb,K.a.frame,Object(I.a)(this,this.yOb,"querySensitivityToggleButton"));this.ga.qa(Q.a.xOb,K.a.frame,Object(I.a)(this,this.xOb,"querySensitivitySubFlyout"));this.KFc(Q.a.oSb)||
this.ga.Xc(Q.a.oSb,4);this.KFc(Q.a.NNb)||this.ga.Xc(Q.a.NNb,4);this.KFc(Q.a.DQb)||this.ga.Xc(Q.a.DQb,4);this.KFc(Q.a.yOb)||this.ga.Xc(Q.a.yOb,4);this.KFc(Q.a.xOb)||this.ga.Xc(Q.a.xOb,4);this.Yi.updateCommandUI();n.AFrameworkApplication.K&&Xa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Hh.value.b2n(Object(I.a)(this,this.G9i,"registerActionsHandler"))}G9i(){this.Ub()}s9a(){this.ga.Vv(Q.a.QZf,K.a.frame,Object(I.a)(this,
this.bMd,"documentLabelPaneHandler"));this.ga.Vv(Q.a.Zic,K.a.frame,Object(I.a)(this,this.Zic,"queryPolicyLabel"));this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ga.Vv(Q.a.b_i,K.a.frame,Object(I.a)(this,this.bMd,"documentLabelPaneHandler")),this.ga.Vv(Q.a.H5c,K.a.frame,Object(I.a)(this,this.H5c,"queryPolicyShortLabel")));this.ga.Vv(Q.a.oSb,K.a.frame,Object(I.a)(this,this.oSb,"toggleSensitivity"));this.ga.Vv(Q.a.NNb,K.a.frame,Object(I.a)(this,this.NNb,
"populateSensitivityFlyout"));this.ga.Vv(Q.a.DQb,K.a.frame,Object(I.a)(this,this.DQb,"setSensitivity"));this.ga.Vv(Q.a.K5c,K.a.frame,Object(I.a)(this,this.K5c,"querySensitivity"));this.ga.Vv(Q.a.yOb,K.a.frame,Object(I.a)(this,this.yOb,"querySensitivityToggleButton"));this.ga.Vv(Q.a.xOb,K.a.frame,Object(I.a)(this,this.xOb,"querySensitivitySubFlyout"))}oSb(){return 32}J5h(d){const m="mandatoryLabelling_"+d.Id;this.T6g[m]=d.Id;return{["type"]:"AppToggleButtonProps",["id"]:m,["label"]:d.DisplayName,["hideLabel"]:!1,
["customTooltip"]:d.Tooltip}}lKb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}HGf(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)}K4l(){const d=[],m=this.rCa;for(let R in m){var A=m[R];const da=this.eA[R];if(da&&da.Enabled&&!da.HasUserDefinedPermissions)if(A.count){const Ea={["sections"]:[],["shouldAutoOpen"]:!1},ib={["id"]:"mandatoryLabelling_flyoutMenuSection_"+da.Id,["controls"]:[]};for(let Qb of A)(A=this.eA[Qb])&&
A.Enabled&&!A.HasUserDefinedPermissions&&Array.add(ib.controls,this.J5h(A));Array.add(Ea.sections,ib);Array.add(d,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+da.Id,["label"]:da.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Ea})}else Array.add(d,this.J5h(da))}return d}NNb(d,m,A,R,da){if(1===A||!this.Hh.value.y3b(!0))return 32;da.MenuItems=Object.assign(new ta.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(da.MenuItems.MenuSectionList,
this.Fva(!this.isReactRibbonEnabled()));this.ak.CustomUrl&&Array.add(da.MenuItems.MenuSectionList,this.lcl(this.isReactRibbonEnabled()?this.ak.CustomUrl:sa.a.zf(this.ak.CustomUrl)));this.isReactRibbonEnabled()||(da.PopulationXML=ia.o(da.MenuItems));return 32}K5c(d,m,A,R,da){if(1===A||!da||!this.clb)return 32;this.ak=this.Hh.value.wy;if(this.Hh.value.y3b(!0)&&(da[za.visible]=!0,this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.d4g||(Ca.a("MipLabelsAvailable"),
this.d4g=!0):Ca.a("MipLabelsAvailable"),this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.ak&&this.ak.AreLabelsAvailable&&(d=Ia.a.instance.Sa("Common.ISystemInitiatedFeedback")))){const Ea=sb.af(this.ak.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";d.execute(ib=>{ib.logActivity(Ea,null)})}return 32}yOb(d,m,A,R,da){if(1===A||!da)return 32;let Ea,ib;da[za.sAj]=!!(Ea=da[za.menuItemId])&&!!(ib=this.Bzc[Ea])&&
ib===this.ak.AppliedPolicyId;return 32}xOb(d,m,A,R,da){if(1===A||!da)return 32;let Ea,ib,Qb;d=!!(Ea=da[za.lJa])&&!!(ib=this.Bzc[Ea])&&!!(Qb=this.rCa[ib])&&Qb.contains(this.ak.AppliedPolicyId);da[za.KHl]=d;da[za.sAj]=d;return 32}DQb(d,m,A,R,da){if(1===A||!da)return 32;d=this.Bzc[da[za.lJa]];m=this.WRo(da[za.VRo]);A=new Ya.a;A.name="SensitivityPickerLocation";A.int64=m;Ca.a("SensitivityPickerUsage",void 0,void 0,[A]);return this.k8a(d,da,2)}f_d(){return!!n.AFrameworkApplication.ta&&1===n.AFrameworkApplication.ta.mode}SUn(){this.tHe&&
!this.f_d()&&(this.tHe=!1,this.Hh.value.RUn())}JOo(){this.ak.DefaultLabelId&&this.ak.MandatoryLabelingEnforced?this.Iye||this.f_d()?this.ak.AppliedPolicyId?this.Hjf(""):(this.Hh.value.mUm(this.Hh.value.KZc)||this.f_d())&&this.tXh():this.Flj():this.ak.DefaultLabelId?this.Flj():this.ak.MandatoryLabelingEnforced&&(this.ak.AppliedPolicyId?this.Hjf(""):this.tXh())}sAi(){return this.ak.MandatoryLabelingEnforced?this.ak&&this.ak.AreLabelsAvailable?this.Ca.$("TestOverrideIsReactDialogEnabled")||this.Yi&&
this.Yi.Kb&&this.Yi.Kb.uF?!0:(v.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(v.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(v.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}tXh(){!this.sAi()||n.AFrameworkApplication.Fpa||this.R6g||(this.R6g=n.AFrameworkApplication.Fpa=!0,v.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),
this.Hh.value.b7i("",1),this.Hh.value.o_e(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.X$m()}))}Hjf(d){this.sAi()&&n.AFrameworkApplication.Fpa&&(n.AFrameworkApplication.Fpa=!1,v.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Hh.value.v8f(),this.Hh.value.b7i(d,2))}X$m(){Aa.instance.Hcl(this.K4l(),this.ak.CustomUrl,Object(I.a)(this,
this.Y$m,"mandatoryLabellingDialogCallback"))}Y$m(d){this.Hjf(this.T6g[d])}hxh(){return this.Ca.$("CoAuthForProtectedFilesEnabled")&&this.Ca.$("SupportsOfficeClientCoauthoring")&&this.Ca.$("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.GVg&&this.VG}k8a(d,m,A,R=null){this.Hh.value.FPn(A);let da=32,Ea=!1,ib=!0;const Qb=2===A||8===A||16===A,pc=d===this.ak.AppliedPolicyId;if(this.kNg&&this.kNg(d,Qb))v.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",
A),this.Yi.updateCommandUI();else if(m&&za.Bth in m&&this.Hh.value.Ilo(m[za.Bth]),d)if(this.Hh.value.bDi()||this.hxh()&&this.jIe)v.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",A),this.Yi.updateCommandUI(),Qb&&this.aDd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.Ca.$("HasDocumentEditRights"))if(this.Hh.value.NTk(d))if(!this.lKb()&&
this.eA[d]&&this.eA[d].HasUserDefinedPermissions&&!pc)v.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",A),1!==A&&4!==A&&this.SBk();else if(Qb&&this.ak.MandatoryLabelingEnforced&&pc)v.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",A),this.aDd(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);
else{if(Qb&&this.Ca.$("WacLabelingJustificationDialogIsEnabled")&&this.ak.RequiredDowngradeJustification&&(pc||this.eA[d].RequiredDowngradeJustification)&&(this.lKb()?!this.e2g&&!R:!this.Paa))return v.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",A),this.Lhg(d),da;if(this.lKb()&&this.eA[d].HasUserDefinedPermissions&&!pc)return v.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",A),this.lig(d,R),da;if(this.hxh()&&!this.GVg())this.Bue<
this.AXj?(v.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.Bue,A),this.jIe=!0,this.Bue++,eb.Task.delay(this.BXj).continueWith(()=>{this.jIe=!1;this.k8a(d,m,A)})):(v.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",A),Ea=1!==A,ib=!1,da=8);else{if(this.JSm(d)&&(v.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",
A),1===A||8===A||4===A))return da;v.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",A);this.setPolicyLabel(pc?"":d,this.lKb()?R:this.Paa,"",A);return da}}else v.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",A),this.Yi.updateCommandUI(),Qb&&this.aDd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else v.ULS.sendTraceTag(558892739,
306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",A),this.Yi.updateCommandUI(),Qb&&this.aDd(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else v.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",A),this.Yi.updateCommandUI(),Ea=Qb,ib=!1,da=8;this.Hh.value.u7i(0,A,Ea,ib);return da}REk(d,m,A=null,R=!1){na.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.Ca.$("SupportsOfficeClientCoauthoring")&&this.Ca.$("CoAuthForProtectedFilesIsEnabled")?(this.Qxc=!1,(this.ak=this.Hh.value.wy)&&!this.ak.AppliedPolicyId?this.Qxc=!0:this.ak&&this.ak.PolicyLabelAssignmentMethod&&(this.Qxc=Lb.e(this.ak.PolicyLabelAssignmentMethod)===Lb.e("standard"))):this.Qxc=R;d=sb.af(d)?null:this.eA[d];(m=sb.af(m)?null:this.eA[m])?this.oZa=new Y(m,!0,A):(this.Hh.value.WTa(29),this.aXa=null);d?this.I$a=new Y(d,!1):this.QVb=null;this.r3f(null,null)}OFk(d){this.k8a(d,
null,16)}qko(){this.eA={};if(this.ak=this.Hh.value.wy)for(const d of this.ak.SensitivityLabels)this.eA[d.Id]=d}JSm(d){if(this.rCa&&d in this.rCa){d=this.rCa[d];for(let m of d)if((d=this.eA[m])&&d.Enabled)return!0}return!1}Omo(){this.rCa={};if(this.ak=this.Hh.value.wy){for(const d of this.ak.SensitivityLabels)d.ParentId||(this.rCa[d.Id]=new U.a);for(const d of this.ak.SensitivityLabels){if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(d.ParentId&&
d.ParentId in this.rCa&&d.Enabled))continue}else if(!(d.ParentId&&d.ParentId in this.rCa))continue;this.rCa[d.ParentId].add(d.Id)}}}TMn(){this.ak=this.Hh.value.wy;const d=this.clb&&this.isReactRibbonEnabled()&&this.Hh.value.y3b();sb.Aee(d)}Flj(){if(this.Ca.$("WacApplyDefaultPolicyLabelIsEnabled"))if(this.f_d())this.tHe=!0;else if(!this.Iye)if(this.Iye=!0,this.ak=this.Hh.value.wy,this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.ak&&this.ak.DefaultLabelId)if(!this.ak.AppliedPolicyId)v.ULS.sendTraceTag(509732190,
306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ak.DefaultLabelType),this.k8a(this.ak.DefaultLabelId,null,1);else if(T.a.ih().equals(this.ak.DefaultLabelType,"documentLibraryDefault")){const d=this.eA[this.ak.AppliedPolicyId],m=this.eA[this.ak.DefaultLabelId];this.ak.AppliedPolicyId!==this.ak.DefaultLabelId&&T.a.ih().equals(this.ak.PolicyLabelAssignmentMethod,"standard")&&d.Order<m.Order&&(v.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ak.DefaultLabelType),
this.k8a(this.ak.DefaultLabelId,null,1))}}else this.ak&&this.ak.DefaultLabelId&&!this.ak.AppliedPolicyId&&(v.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.ak.DefaultLabelId),this.k8a(this.ak.DefaultLabelId,null,1))}r3f(){if(!this.Hh.value.bDi()){var d=this.eA[this.ak.AppliedPolicyId];this.Qxc&&this.I$a&&this.QVb!==this.I$a.id&&(!d||d.Order<this.I$a.sensitivityLabel.Order)&&(d=this.k8a(this.I$a.id,{},4),32!==d?v.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
d):(this.QVb=this.I$a.id,this.aXa&&(d=this.eA[this.aXa])&&d.Order<=this.I$a.sensitivityLabel.Order&&(this.Hh.value.WTa(29),this.aXa=null)));d=this.eA[this.Hh.value.wy.AppliedPolicyId];if(this.oZa&&this.aXa!==this.oZa.id&&(!d||d.Order<this.oZa.sensitivityLabel.Order)){const m=this.oZa.id;this.Hh.value.WTa(29);this.Hh.value.LBd(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.QTd(this.oZa.sensitivityLabel))+" "+this.oZa.sRn,CommonUIStrings.l_PolicyLabelRecommendationButton,
()=>{this.k8a(m,{},8)});this.aXa=this.oZa.id}this.oZa=this.I$a=null}}setPolicyLabel(d,m,A,R=2){this.lKb()?m&&(this.e2g=!0):this.Paa=m;this.Hh.value.setPolicyLabel(d);this.Yi.updateCommandUI();A=new aa(R,this.QTd(this.eA[d]));this.Hh.value.Keg(d,this.lKb()?m:this.Paa,A)}$6k(d,m,A,R){1===d&&this.setPolicyLabel(m,R,A)}Z6k(d,m,A){1===d?this.lKb()?this.k8a(m,null,2,A):this.setPolicyLabel(m===this.ak.AppliedPolicyId?"":m,A,""):this.Yi.updateCommandUI()}Lhg(d){(new Pa(d,Object(I.a)(this,this.Z6k,"continueToSetPolicyLabelFromJustificationDialog"))).Lhg()}lig(d,
m){(new xa(d,m,Object(I.a)(this,this.$6k,"continueToSetPolicyLabelFromUDPDialog"))).lig()}aDd(d="",m=""){const A=new xb.StandardDialog;A.Kt=n.AFrameworkApplication.cda;A.Cd=0;A.ye(1,CommonUIStrings.l_DialogClose);A.IV(d,m,null)}vLk(d){1===d&&this.Hh.value.MPn()}SBk(){const d=new xb.StandardDialog;d.Kt=n.AFrameworkApplication.cda;d.Cd=1;d.ye(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);d.ye(0,CommonUIStrings.l_DialogClose);d.IV(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,
Object(I.a)(this,this.vLk,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Yi&&!!this.Yi.Kb&&this.Yi.Kb.Gr}Mdc(){return this.Yi&&this.Yi.Kb?this.Yi.Kb.Mdc:!1}bMd(){return 32}nno(d,m,A,R){d?(R[za.value]=d,R[za.labelText]=d,R[za.customTooltip]=m,this.Hmj(A,n.AFrameworkApplication.DF,R)):(R[za.iconColor]=za.dne,this.ak.MandatoryLabelingEnforced?(R[za.value]=R[za.labelText]=this.dUd().Wbg,R[za.icon]=za.BQn):(R[za.value]=R[za.labelText]=this.dUd().gUf,R[za.icon]=za.EQn));R[za.visible]=!0}Uko(d){let m=
"",A="",R="";if(this.ak.AreLabelsAvailable){let da=null;this.eA&&(da=this.eA[this.ak.AppliedPolicyId]);da&&(m=this.QTd(da),A=da.Tooltip,n.AFrameworkApplication.DF=this.Hh.value.Jdc(da),R=this.tpf(da));if(!this.Hh.value.y3b()&&!da)return}else{if(!this.Gwb)return;m=this.Gwb;R=za.dne;A=this.myc?this.myc:""}this.nno(m,A,R,d)}Zic(d,m,A,R,da){if(1===A)return 32;this.ak=this.Hh.value.wy;if(!this.ak||!da)return 32;da[za.value]="";da[za.labelText]="";da[za.alt]=null;da[za.yqi]=null;da[za.obc]=null;da[za.customTooltip]=
"";da[za.visible]=!1;da[za.iconColor]="";da[za.icon]="";if(this.HGf())this.Uko(da);else{A=m=d="";if(!this.ak.AreLabelsAvailable){if(!this.Gwb)return 32;d=this.Gwb;A=za.dne;this.myc&&(m=this.myc)}else if(this.ak.AppliedPolicyId){R=null;for(const Ea of this.ak.SensitivityLabels)if(Ea.Id.toLowerCase()===this.ak.AppliedPolicyId.toLowerCase()){R=Ea;break}R&&(d=this.QTd(R),m=R.Tooltip,n.AFrameworkApplication.DF=this.Hh.value.Jdc(R),A=this.tpf(R))}d&&(da[za.value]=d,da[za.labelText]=d,this.Mdc()?da[za.customTooltip]=
m:da[za.alt]=m,this.Hmj(A,n.AFrameworkApplication.DF,da),da[za.visible]=!0)}return 32}H5c(d,m,A,R,da){if(1===A)return 32;this.ak=this.Hh.value.wy;if(!this.ak||!da)return 32;da[za.labelText]="";if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.ak.HideBarByDefault)return 32;d="";if(this.ak.AreLabelsAvailable)if(this.ak.AppliedPolicyId){if(!this.eA)return 32;(m=this.eA[this.Hh.value.wy.AppliedPolicyId])&&(d=m.ParentId&&this.eA[m.ParentId]?this.eA[m.ParentId].DisplayName:
m.DisplayName)}else d=this.ak.MandatoryLabelingEnforced?this.dUd().Wbg:this.dUd().gUf;else{if(!this.Gwb)return 32;d=this.Gwb}da[za.labelText]=d;return 32}QTd(d){return d?this.eA?d.ParentId&&this.eA[d.ParentId]?this.eA[d.ParentId].DisplayName+"\\"+d.DisplayName:d.DisplayName:(v.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),d.DisplayName):""}Hmj(d,m,A){this.HGf()?(A[za.icon]=this.Wii(m),A[za.iconColor]=this.Xii(d)):this.Mdc()?A[za.icon]=m?za.vEo:
za.yEo:(A[za.yqi]=n.AFrameworkApplication.Ms,A[za.obc]=m?ma.getImageClass(za.wEo):ma.getImageClass(za.zEo))}lcl(d){const m=this.rDb("LearnMoreSection",!0);d=Object.assign(new wa.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:d,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:n.AFrameworkApplication.Ms,Image16by16Class:ma.getImageClass(za.h1m),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(m.ControlList,d);return m}FOh(d,m,
A=!1){let R;R="Toggle_"+d.Id;R="Sensitivity_"+R;const da=d.DisplayName,Ea=d.Tooltip;var ib=d.Id===this.ak.AppliedPolicyId,Qb=A?sa.a.zf(R):R;this.HGf()?(ib=this.tpf(d),m=Object.assign(new ob.a,{Id:Qb,ExternalId:Qb,LabelText:A?sa.a.zf(da):da,Command:"2935633379",MenuItemId:Qb,QueryCommand:"991261903",Visible:!0,Alt:A?sa.a.zf(Ea):Ea,AriaLabel:zb.a.gHc,IconColor:this.Xii(ib),KeyTip:m}),m.ExternalImageId=this.Wii(this.Hh.value.Jdc(d))):(Qb=Object.assign(new ka.a,{Id:Qb,ExternalId:Qb,LabelText:A?sa.a.zf(da):
da,Command:"2935633379",MenuItemId:Qb,QueryCommand:"991261903",CheckedImage:n.AFrameworkApplication.Ms,Visible:!0,Alt:A?sa.a.zf(Ea):Ea,IsChecked:ib,AriaLabel:zb.a.gHc,KeyTip:m}),this.isReactRibbonEnabled()?(Qb.CheckedImageClass=ma.getImageClass(za.X5f),Qb.ExternalImageId=za.X5f):Qb.CheckedImageClass=ma.getImageClass(za.IIc),m=Qb);Qb=R;this.Bzc[Qb]=d.Id;this.Ebh[d.Id]=Qb;return m}rDb(d,m=!1){return Object.assign(new fa.a,{Title:"",Id:d,DisplayMode:za.menu,ShowMenuSectionSeparator:m,ControlsId:"Ctrl_"+
d,ControlList:[]})}Dfl(d,m,A){d=this.rDb(d+"Sub");let R=1;for(let da of m)(m=this.eA[da])&&m.Enabled&&(Array.add(d.ControlList,this.FOh(m,R.toString(),A)),R++);return d}Fva(d=!1){const m=this.rDb("SensitivitySection");let A=1;const R=this.rCa;for(let Ea in R){const ib=R[Ea],Qb=this.eA[Ea];if(Qb&&Qb.Enabled){if(ib.count){var da="Sensitivity_"+Qb.Name;d&&sa.a.zf(da);da="Label"+this.$_j++;const pc=Object.assign(new va.a,{Id:da,ExternalId:da,LabelText:d?sa.a.zf(Qb.DisplayName):Qb.DisplayName,Command:"798637440",
QueryCommand:"2875864574",Menu:Object.assign(new ta.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:zb.a.gHc,KeyTip:A.toString(),Alt:d?sa.a.zf(Qb.Tooltip):Qb.Tooltip});this.isReactRibbonEnabled()?pc.ExternalImageId=za.X5f:(pc.Image16by16=n.AFrameworkApplication.Ms,pc.Image16by16Class=ma.getImageClass(za.IIc));Array.add(pc.Menu.MenuSectionList,this.Dfl(da,ib,d));Array.add(m.ControlList,pc);this.Bzc[pc.Id]=Qb.Id;this.Ebh[Qb.Id]=
pc.Id}else Array.add(m.ControlList,this.FOh(Qb,A.toString(),d));A++}}return m}KFc(d){return!!this.ga.l0(d)&&!!this.ga.l0(d).flags&&!!this.ga.l0(d).flags.length}zwn(d,m){m.onSuccess&&this.eA&&(d=this.eA[this.Hh.value.wy.AppliedPolicyId])&&(this.aXa&&(m=this.eA[this.aXa])&&m.Order<=d.Order&&(this.Hh.value.WTa(29),this.aXa=null),this.QVb&&this.QVb!==d.Id&&(this.Hh.value.WTa(28),this.QVb=null))}Wii(d){return d?za.DQn:za.CQn}Xii(d){return d?d:za.dne}tpf(d){if(d.Color||!d.ParentId)return d.Color;const m=
this.eA[d.ParentId];return m?m.Color:d.Color}WRo(d){switch(d){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}dUd(){this.ROe||(this.ROe=Object.assign(new ba,{gUf:HeaderStrings.NoSensitivityLabel,Wbg:HeaderStrings.SelectASensitivityLabel}));return this.ROe}static t_o(){n.AFrameworkApplication.K&&!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)||!Xa.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",
!0))}static Aee(d){Xa.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!d))}static af(d){return d&&d.length?!1:!0}}Object(y.a)(sb,"PolicyActor",null,[890]);var lc=c(598),vb=c(81),Eb;(function(d){d[d.unknown=0]="unknown";d[d.boot=1]="boot";d[d.refresh=2]="refresh";d[d.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(Eb||(Eb={}));Object(y.b)("GetPolicyLabelsReason",Eb);class Ua extends Sys.EventArgs{constructor(d,m,A,R,da,Ea){super();this.k4b=d;this.title=m;this.message=
A;this.buttonText=R;this.WHc=da;this.Q0d=Ea}}Object(y.a)(Ua,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Ta extends Sys.EventArgs{constructor(d,m,A,R,da){super();this.k4b=d;this.title=m;this.message=A;this.buttonText=R;this.WHc=da}}Object(y.a)(Ta,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Nb;(function(d){d[d.none=0]="none";d[d.reasonDefaultLabel=1]="reasonDefaultLabel";d[d.reasonManual=2]="reasonManual";d[d.reasonAutomatic=4]="reasonAutomatic";d[d.reasonRecommended=
8]="reasonRecommended";d[d.reasonMandatory=16]="reasonMandatory"})(Nb||(Nb={}));Object(y.b)("ApplyLabelFlags",Nb);class Wa extends Sys.EventArgs{constructor(d,m,A){super();this.lGh=d;this.kGh=m;this.existingLabelPriority=A}}Object(y.a)(Wa,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Bb extends Sys.EventArgs{constructor(d){super();this.T$l=d}}Object(y.a)(Bb,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Ob extends Sys.EventArgs{constructor(){super()}}Object(y.a)(Ob,"GetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);class hc{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=
this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(y.a)(hc,"GetPolicyLabelsData",null,[]);class Gc extends Sys.EventArgs{constructor(d=!1){super();this.onSuccess=d}}Object(y.a)(Gc,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class bc extends Sys.EventArgs{constructor(d,m){super();this.FNi=d;this.appMode=m}}Object(y.a)(bc,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Dc extends Sys.EventArgs{constructor(d,
m,A,R){super();this.title=d;this.zEn=m;this.buttonText=A;this.umn=R}}Object(y.a)(Dc,"PolicyTipEventArgs",Sys.EventArgs,[]);class Ub extends Sys.EventArgs{constructor(d,m){super();this.k4b=d;this.Q0d=m}}Object(y.a)(Ub,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Fc extends Sys.EventArgs{constructor(){super()}}Object(y.a)(Fc,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Sa extends Sys.EventArgs{constructor(d,m){super();this.E1f=d;this.tDa=m}}Object(y.a)(Sa,
"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class wb extends Sys.EventArgs{constructor(d,m,A,R=null,da=null,Ea=null,ib=null){super();this.errorType=d;this.H2e=m;this.byo=A;this.title=R;this.message=da;this.buttonText=Ea;this.WHc=ib}}Object(y.a)(wb,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Tb extends Sys.EventArgs{constructor(d){super();this.H2e=d}}Object(y.a)(Tb,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Hb extends Sys.EventArgs{constructor(d){super();this.Xto=d}}Object(y.a)(Hb,
"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var $a=c(93),ab=c(109),rb=c(35),cb=c(40),rc=c(512),Rb=c(316),fb=c(194);class Pb{static cjo(d,m){if(!d||!m||d.count!==m.count)return!1;for(let A of d)if(!m.contains(A))return!1;return!0}static toArray(d){if(!d)return null;const m=Array(d.count);let A=0;for(let R of d)m[A]=R,A++;return m}}Object(y.a)(Pb,"HashSetUtils",null,[]);var Ec=c(230),uc=c(123);class ya{constructor(d,m,A,R=0,da=null,Ea=0){this.zye=this.xK=null;this.Wdb=this.bwc=this.ewc=0;this.vsa=
"";this.nzb=this.c4g=this.oMg=this.H0g=this.yWa=this.iKe=null;this.h2g=!1;this.itb=null;this.aEe=0;this.xud=this.rzb=this.zvb=this.wud=null;this.sa=new vb.a;this.X9c=this.QRc=this.Kl=null;this.KFe=!1;this.KZc=null;this.Ca=d;this.Zf=m;this.je=A;this.Frd=R;this.wy=new hc;this.Dbh=this.Ca.kb("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.dv=da;this.oAc=0===Ea?this.qTi(n.AFrameworkApplication.ta.Kb.xk):this.qTi(Ea);this.clb=d.$("WacApplyManualPolicyLabelIsEnabled");this.xcc=d.$("CoAuthForProtectedFilesIsEnabled");
this.crb=d.$("SupportsOfficeClientCoauthoring");this.cDi=!1;this.xnj=3E4;this.Ib=ab.a.instance;d.$("SupportsPolicies")&&Ca.a("MipSupportsPolicies");this.xcc&&this.crb&&Ca.a("MipSupportsOfficeClientCoauthoring")}get SDf(){return this.KFe}xzk(d){this.sa.addHandler("PolicyTipEvent",d)}o0e(d){this.sa.addHandler("LabelInfoUpdateEvent",d)}b2n(d){this.sa.removeHandler("LabelInfoUpdateEvent",d)}Qzk(d){this.sa.addHandler("SetPolicyLabelTriggeredEventKey",d)}GCd(d){this.sa.addHandler("SetPolicyLabelEventKey",
d)}P0e(d){this.sa.addHandler("SetPolicyLabelFailureEventKey",d)}yxk(d){this.sa.addHandler("GetPolicyLabelEventKey",d)}xxk(d){this.sa.addHandler("GetAutoPolicyLabelEventKey",d);this.SDf&&(v.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.K5f(new Bb(0)))}txk(d){this.sa.addHandler("CreateAutoCLPSecurityNodesEventKey",d)}Yzk(d){this.sa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",d)}Zzk(d){this.sa.addHandler("UpdateAutoCLPSITNodesEventKey",
d)}Zwk(d){this.sa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",d)}Gzk(d){this.sa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",d)}$wk(d){this.sa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",d)}Hzk(d){this.sa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",d)}Xqh(d){this.sa.addHandler("MandatoryLabellingAppHandlerEventKey",d)}Wzk(d){this.sa.addHandler("UDPLabelingAppHandlerEventKey",d)}get aNm(){if(!this.xK)return!1;for(const d of this.xK.CPc())if(!d.Capabilities||
!d.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get ICi(){return!!this.Kl}kAm(d){d&&this.xcc&&this.crb&&d.execute(Object(I.a)(this,this.c4e,"awaitRtc"))}Rzm(d){d&&this.xcc&&this.crb&&d.continueWith(()=>{this.xK=d.result})}WWk(){return this.H0g?this.H0g():!1}nq(){return(new Date).getTime()}c4e(d){if(!this.ICi){var m=d.hRc();m.continueWith(()=>{this.Kl=m.result;this.Kl.V3(Object(I.a)(this,this.Uqn,"onLabelChangeUpdateOverRtc"))})}}Uqn(d,m){12===m.type&&(this.c4g?this.c4g():this.iGb(this.vsa,
2,this.yWa,!0))}Dqf(){this.je&&(this.wud=this.je.Yf("WebServiceCall","Call Get Policy Endpoint On Server"));var d=Ec.a.Z0a(1,1);this.Ca.$("SendHostAttributionInfoForPolicyLabelEnabled")?(d=new rc.a(this.L$b("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,d),this.Zf.send(d).hza(Object(I.a)(this,this.$Ui,"onDataLossPolicySuccessCallback"),Object(I.a)(this,this.ZUi,"onDataLossPolicyFailureCallback"))):this.Zf.nj(this.L$b("datalosspolicy"),
1,null,null,!0,2,Object(I.a)(this,this.$Ui,"onDataLossPolicySuccessCallback"),Object(I.a)(this,this.ZUi,"onDataLossPolicyFailureCallback"),null);this.ewc++;v.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.Dbh,this.ewc)}RUn(){this.iGb(this.vsa,2,this.yWa)}iGb(d,m=0,A=null,R=!1){na.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.H2a(void 0,m));this.QRc=this.nq();const da=this.Kbf(m);this.HRd(d,da,A,
R,m);this.nPb(!0)}$Ui(d){this.T2i();let m="";({data:m}=this.pog(d)).returnValue&&(v.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.ewc=0,this.je&&(this.xud=this.je.Yf("Task","Parse and Handle Get Policy Response")),this.pBn(m),this.xud&&(this.xud.stop(),this.xud=null))}ZUi(d){this.T2i();this.ewc<=this.Frd?this.Dqf():(v.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",d?d.data?d.data.Qja:null:
null),this.ewc=0)}bDi(){return 0<this.Wdb}setPolicyLabel(d){this.wy.AppliedPolicyId=d}Keg(d,m,A=null){const R=this.Dbl(A);this.$mo(d,m,R,A)}MYi(d){this.rzb&&(this.rzb.stop(),this.rzb=null);let m,A;({jjj:m,wnj:A}=this.yhi(d));const R=d.data.state,da=R?R.tDa:2;let Ea="";({data:Ea}=this.pog(d)).returnValue?(v.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",da),this.Wdb=0,this.XBn(Ea,m,A,R)):this.rag(da)}FPn(d){na.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.H2a(d));this.X9c=this.nq();v.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.sa.raiseEvent("SetPolicyLabelTriggeredEventKey",new Tb(d))}kjn(){this.xcc&&this.crb&&this.ICi&&this.Kl.qN(12,null,!0)}LYi(d){this.rzb&&(this.rzb.stop(),this.rzb=null);let m;({jjj:A,wnj:m}=this.yhi(d));if(this.Wdb<=this.Frd)this.Keg(A,m);else{var A=(A=d.data.state)?A.tDa:2;v.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
d?d.data?d.data.Qja:null:null,A);this.KZc="WACServerConnectionFailed";this.Wdb=0;this.rag(A)}}mUm(d){if(d&&("LabelNotSupported"===d||"LabelErrorRetryLater"===d||"CoherencyFailure"===d||"LabelIdNotFound"===d||"LabelDisabled"===d))return v.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",d),!0;v.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",d);return!1}Jdc(d){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?d.IsEndpointProtectionEnabled||
d.HasUserDefinedPermissions:d.IsEndpointProtectionEnabled}NTk(d){if(!d)return!1;let m=null,A=null;for(const R of this.wy.SensitivityLabels)R.Id===d&&(m=R),R.Id===this.vsa&&(A=R);if(!m)return!1;if(this.xcc&&this.crb){if(this.oMg&&this.oMg()||this.aNm)return!0}else if(n.AFrameworkApplication.Sm&&n.AFrameworkApplication.Sm.r2a||this.yWa&&this.yWa())return!0;return this.Jdc(m)===(!!A&&this.Jdc(A))}LBd(d,m,A,R,da){28===d?this.R6i(new Ua(d,m,A,R,da,!1)):this.R6i(new Ua(d,m,A,R,da,!0))}WTa(d){28===d?this.n7i(new Ub(d,
!1)):this.n7i(new Ub(d,!0))}FOn(d,m,A){v.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.sa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Wa(d,m,A))}NPn(d){v.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.sa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Wa(null,null,d))}OPn(d,m){v.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.sa.raiseEvent("UpdateAutoCLPSITNodesEventKey",
new Wa(d,m,null))}b7i(d,m){v.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===m?"Reading":"Edit")+" switch event.");this.sa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new bc(d,m))}o_e(d,m,A,R,da){37===d&&this.qOn(new Ta(37,m,A,R,da))}v8f(){this.yPn(new Fc)}MPn(){v.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.sa.raiseEvent("UDPLabelingAppHandlerEventKey",new Hb(!0))}y3b(d=!1){const m=!!this.wy&&this.wy.AreLabelsAvailable&&!!this.wy.SensitivityLabels&&
0<this.wy.SensitivityLabels.length&&fb.a.any(this.wy.SensitivityLabels,A=>!!A&&A.Enabled);m||d||sb.Aee(!1);return m}RVi(d){this.zvb&&(this.zvb.stop(),this.zvb=null);var m="";this.nPb(!1);({data:m}=this.pog(d)).returnValue?(v.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.bwc=0,m=this.IBn(m),d=this.kfi(d.data),na.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.Qib(void 0,d,this.QRc)),this.QRc=null,d=new Bb(d),this.POn(d),this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)?m&&this.eso()?this.SDf?this.SUo():(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.rJd(),this.K5f(d),this.KFe=!0):m||this.Tce():!this.SDf&&m&&this.Ca.$("WacApplyManualPolicyLabelIsEnabled")&&this.Fvh()?(this.K5f(d),this.KFe=!0):m||this.Tce()):this.Tce()}eso(){if(!this.Ca.$("WacApplyManualPolicyLabelIsEnabled"))return v.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;
if(!this.Fvh())return!1;if(""===this.vsa)return v.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.itb===this.aEe)return v.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;v.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}rJd(){this.lFj();v.ULS.sendTraceTag(545104324,
306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.nzb.count,this.itb);const d=Pb.toArray(this.nzb);this.FOn(d,d,this.itb)}SUo(){var d=this.nzb;this.lFj();Pb.cjo(d,this.nzb)||(v.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.nzb.count),d=Pb.toArray(this.nzb),this.OPn(d,d));this.h2g&&(v.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.itb),this.NPn(this.itb))}lFj(){const d=new lc.a(T.a.ih());
for(const m of this.wy.SensitivityLabels)if(m&&m.AutoLabelingSensitiveTypeIds&&0<m.AutoLabelingSensitiveTypeIds.length)for(const A of m.AutoLabelingSensitiveTypeIds)A&&d.add(A);this.nzb=d}QVi(d){const m=this.kfi(d.data);na.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.Qib(void 0,m,this.QRc));this.QRc=null;this.zvb&&(this.zvb.stop(),this.zvb=null);if(this.bwc<=this.Frd){if(this.Ca.$("SendHostAttributionInfoForPolicyLabelEnabled")){const A=d.data.request.get_headers();
if("HostAttributionInfo.ScenarioParamName"in A&&A[Ec.a.Nfe]&&"HostAttributionInfo.ScenarioTypeParamName"in A&&A[Ec.a.Ofe]){d.data.request.get_headers();d.data.request.get_headers();d=this.Kbf(m);this.HRd(this.vsa,d,this.yWa,void 0,m);return}}this.iGb(this.vsa,m,this.yWa)}else v.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",d?d.data?d.data.Qja:null:null),this.Tce(),this.bwc=0,this.nPb(!1)}kfi(d){return d.state?d.state:0}L$b(d,m=!1){let A=String.format("{0}{1}?action={2}&{3}",
this.Ca.kb("PolicyHandlerWebServiceBase")||n.AFrameworkApplication.ta.Kb.NSa,this.Dbh,d,n.AFrameworkApplication.em);"setpolicylabel"===d&&n.AFrameworkApplication.Sm&&n.AFrameworkApplication.Sm.tFf&&(A=E.a.fp(A,"sl","1"));m&&(A=E.a.fp(A,"cbd","1"));return A}yhi(d){let m,A;m=A=null;d&&d.data&&d.data.request&&d.data.request.get_headers()&&(m=d.data.request.get_headers()[Rb.a.ecg],A=d.data.request.get_headers()[Rb.a.Jeg]);return{jjj:m,wnj:A}}pog(d){d=d?d.data?d.data.te:null:null;return d&&d.length&&!this.nVm(d)?
{returnValue:!0,data:d}:(v.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:d})}pBn(d){let m;try{m=rb.b(d)}catch(A){v.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(m)if(m.IsPolicyTipAvailable)switch(m.IsPolicyTipAvailable.toLowerCase()){case "false":v.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":v.ULS.sendTraceTag(25565186,
306,50,"DLP Policy is enabled on this document.");this.zye=m.NavigateUrl;this.wyo(m.GeneralText,Object(I.a)(this,this.Ynn,"onDataLossPolicyOverrideButtonClick"));break;default:v.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",m.IsPolicyTipAvailable)}else v.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else v.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}g8k(d){switch(d){case "CoherencyFailure":return 1;
case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}XBn(d,m,A,R){var da=R?R.tDa:2;let Ea=
0,ib="",Qb;if(({Gt:Qb}=rb.d(d)).returnValue)if(Qb){ib="Success";d=this.Kbf(3);if(Qb.IsSuccessful){na.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.Qib(da,void 0,this.X9c));this.KZc=this.X9c=null;v.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",da);2===da&&this.WTa(29);this.ioo(m,da);this.kjn();this.WTa(28);R&&4===da&&this.LBd(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,
R.displayName),CommonUIStrings.l_DialogOk,()=>{});Ca.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Ya.a,{name:"SetPolicyLabelApplyFlag",string:Nb[da]})]);this.HRd(m,d,this.yWa,void 0,3);return}v.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",da,Qb.FailureReason);this.KZc=Qb.FailureReason;this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",
!1)?Ea=this.g8k(Qb.FailureReason):"FileTooLarge"===Qb.FailureReason?Ea=7:"LabelNotSupported"===Qb.FailureReason?Ea=13:"LabelDisabled"===Qb.FailureReason?Ea=9:"MinorVersionLimitExceeded"===Qb.FailureReason&&(Ea=15);this.cDi&&0<=Qb.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(R=new $a.a(2,1,this.xnj,()=>{v.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.Wdb);this.Wdb<=this.Frd&&this.Keg(m,A)}),
this.Ib.Wb(R));this.xcc&&this.crb&&this.HRd(this.wy.AppliedPolicyId,d,this.yWa,!0,3)}else ib="setPolicyLabelData null.",v.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",da);else ib="TryDeserialize failed.",v.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",da);this.rag(da,Ea);da=this.Qib(da,void 0,this.X9c);this.X9c=null;da.extendedProperties.set("SetPolicyLabelDataFailureReason",
this.KZc);da.extendedProperties.set("SetPolicyLabelDataParseStatus",ib.toString());na.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,da)}rag(d,m=0){const A=2===d||8===d||16===d;this.setPolicyLabel(this.vsa);this.$6i(new Gc);this.u7i(m,d,A,!1)}ioo(d,m){this.setPolicyLabel(this.vsa=d);if(""===d)n.AFrameworkApplication.DF=!1,n.AFrameworkApplication.UMd=!1;else for(const A of this.wy.SensitivityLabels)if(A.Id===d){n.AFrameworkApplication.DF=this.Jdc(A);break}this.EPn(new Sa(d,
m))}dYo(){for(const d of this.wy.SensitivityLabels)d&&d.Enabled&&(d.Id===this.vsa&&(this.h2g=this.itb!==d.Order,this.itb=d.Order),d.Order>this.aEe&&(this.aEe=d.Order))}IBn(d){if(!({Gt:d}=rb.d(d)).returnValue)return v.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!d)return v.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!d.AreLabelsAvailable)return!1;this.wy=d;this.vsa=d.AppliedPolicyId;
this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePdfProtectionUsageTelemetry",!1)&&this.Ca.appSettings&&(this.Ca.appSettings.AppliedPolicyId=this.vsa);this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.dYo();this.y3b()&&v.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.$6i(new Gc(!0));return!0}Fvh(){if(!this.y3b())return v.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),
!1;for(const d of this.wy.SensitivityLabels)if(d&&d.AutoLabelingSensitiveTypeIds&&0<d.AutoLabelingSensitiveTypeIds.length)return!0;v.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}$6i(d){v.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.sa.raiseEvent("LabelInfoUpdateEvent",d)}POn(d){v.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.sa.raiseEvent("GetPolicyLabelEventKey",
d)}Tce(){sb.Aee(!1);this.sa.raiseEvent("GetPolicyLabelFailureEventKey",new Ob)}K5f(d){this.dv&&this.dv.execute(m=>{m=[m.isFeatureEnabled("MsoClpSpTwo",!0),m.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(m).then(A=>{fb.a.any(A,R=>R)&&(v.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.sa.raiseEvent("GetAutoPolicyLabelEventKey",d),this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.rJd(),Ca.a("MipAutoClassificationEnabled"));
return null})})}H2a(d=null,m=null){const A=new Map;A.set("ClpCoauth",this.crb.toString());null!=d&&A.set("ApplyLabelFlags",Nb[d]);null!=m&&A.set("GetPolicyLabelsReason",Eb[m]);return A}Qib(d=null,m=null,A=null){const R=new uc.a;R.extendedProperties=this.H2a(d,m);null!=A&&(R.durationMs=this.nq()-A);return R}EPn(d){v.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.sa.raiseEvent("SetPolicyLabelEventKey",d)}R6i(d){v.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");
d&&d.Q0d&&Ca.a("MipRecommendations");this.sa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",d)}n7i(d){v.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.sa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",d)}qOn(d){v.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.sa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",d)}yPn(d){v.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.sa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",d)}wyo(d,m=null){v.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.sa.raiseEvent("PolicyTipEvent",new Dc(CommonUIStrings.l_PolicyBusinessBarTitle,d,CommonUIStrings.l_PolicyOverrideButton,m))}u7i(d,m,A,R=!0){v.ULS.sendTraceTag(42074656,306,R?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",m);R=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let da=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
Ea=null,ib=null;switch(d){case 2:R=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;da=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:da=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:R=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;da=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:R=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
da=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:R=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;da=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:da=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:R=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;da=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:R=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,da=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Ea=CommonUIStrings.l_LearnMore,ib=()=>{this.ano()}}d=new wb(d,m,A,R,da,Ea,ib);this.sa.raiseEvent("SetPolicyLabelFailureEventKey",d)}Ilo(d){this.iKe=d}Ynn(){this.zye?(v.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),cb.a.Bib(this.zye)):v.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}nVm(d){if(!d.startsWith("<")||
-1===d.indexOf("Error")&&-1===d.indexOf("Unavailable"))return!1;v.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}T2i(){this.wud&&(this.wud.stop(),this.wud=null)}LMl(d){if(!d)return"manual";switch(d.tDa){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}YOl(d){if(!d)return"privileged";
d=d.tDa;let m="privileged";if(4===d||1===d)m="standard";return m}qTi(d){switch(d){case 1:return"Excel";case 4:return"OneNote";case 2:return"PowerPoint";case 5:return"Visio";case 3:return"Word";default:return"Unknown"}}HRd(d,m,A=null,R=!1,da=0){this.Ca.$("WacLabelingGetPolicyLabelsIsEnabled")&&(this.vsa=d,this.yWa=A,this.je&&(this.zvb=this.je.Yf("WebServiceCall","Call Get Policy Endpoint On Server")),A={},A[Rb.a.Auh]=d,this.Ca.$("SendHostAttributionInfoForPolicyLabelEnabled")?(d=new rc.a(this.L$b("getpolicylabels",
R),1,null,A,!0,2,da,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m),this.Zf.send(d).hza(Object(I.a)(this,this.RVi,"onGetPolicyLabelsSuccessCallback"),Object(I.a)(this,this.QVi,"onGetPolicyLabelsFailureCallback"))):this.Zf.nj(this.L$b("getpolicylabels",R),1,null,A,!0,2,Object(I.a)(this,this.RVi,"onGetPolicyLabelsSuccessCallback"),Object(I.a)(this,this.QVi,"onGetPolicyLabelsFailureCallback"),da,void 0,void 0,void 0,void 0,"22"),this.bwc++,v.ULS.sendTraceTag(34996492,
306,50,"Policy label request sent to server. Policy call times: {0}",this.bwc))}$mo(d,m,A,R=null){if(this.clb){this.je&&(this.rzb=this.je.Yf("WebServiceCall","Call Set Policy Endpoint On Server"));var da={};da[Rb.a.ecg]=d;m&&(da[Rb.a.Jeg]=encodeURIComponent(m));this.iKe&&(da[Rb.a.Cth]=this.iKe);R?(da[Rb.a.Geg]=this.LMl(R),da[Rb.a.Heg]=this.YOl(R),this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===R.tDa&&this.wy.DefaultLabelType&&(da[Rb.a.vnj]=this.wy.DefaultLabelType)):
(da[Rb.a.Geg]="manual",da[Rb.a.Heg]="privileged");this.crb&&this.wy&&(da[Rb.a.U2i]=this.wy.PolicyLabelVersionToken);this.Ca.$("SendHostAttributionInfoForPolicyLabelEnabled")?(d=new rc.a(this.L$b("setpolicylabel",!0),1,null,da,!0,2,R,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,A),this.Zf.send(d).hza(Object(I.a)(this,this.MYi,"onSetPolicyLabelSuccessCallback"),Object(I.a)(this,this.LYi,"onSetPolicyLabelFailureCallback"))):this.Zf.nj(this.L$b("setpolicylabel",
!0),1,null,da,!0,2,Object(I.a)(this,this.MYi,"onSetPolicyLabelSuccessCallback"),Object(I.a)(this,this.LYi,"onSetPolicyLabelFailureCallback"),R,void 0,void 0,void 0,void 0,"32");this.Wdb++;v.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.Wdb)}else v.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}ano(){const d=new xb.StandardDialog,m=this.Ca.kb("BreadcrumbFolderUrl");
m?(d.Cd=11,d.ye(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),d.ye(2,CommonUIStrings.l_DialogOk)):(d.Cd=0,d.ye(1,CommonUIStrings.l_DialogOk));d.g_e(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");d.Z_n();d.IV(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,A=>{1===
A&&m&&cb.a.vm(m,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}Kbf(d){switch(d){case 1:return Ec.a.Z0a(1,1);case 2:return Ec.a.Z0a(7,1);case 3:return Ec.a.Z0a(8,1);default:return Ec.a.Z0a(7,0)}}Dbl(d=null){if(!d)return Ec.a.Z0a(8,0);switch(d.tDa){case 1:case 16:return Ec.a.Z0a(1,1);case 4:case 2:case 8:return Ec.a.Z0a(8,1);default:return Ec.a.Z0a(8,0)}}nPb(d){Xa.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",d)}}Object(y.a)(ya,"PolicyManager",null,
[862]);var db=c(134);class tb{constructor(){this.MSe=this.SOe=this.S6g=this.adh=this.QMg=this.wt=this.bba=this.W=this.Hh=null}get name(){return"Common.App.Policy"}init(){n.AFrameworkApplication.K.$("ShouldInitCommonPolicyPackage")&&(n.AFrameworkApplication.K.$("IsDataLossPreventionEnabledForUser")&&n.AFrameworkApplication.ta&&(this.Hh=this.W.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Hh.xzk(Object(I.a)(this,this.vyo,"showPolicyBusinessBar")),v.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?db.a.get_instance().pk(5,()=>{this.Hh.Dqf()}):db.a.get_instance().pk(6,()=>{this.Hh.Dqf()})),n.AFrameworkApplication.K.$("WacLabelingPoliciesIsEnabled")&&n.AFrameworkApplication.K.$("SupportsPolicies")?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?db.a.get_instance().pk(5,Object(I.a)(this,this.VTi,"onAfterRibbonBehaviorAttached")):
db.a.get_instance().pk(6,Object(I.a)(this,this.VTi,"onAfterRibbonBehaviorAttached")):(sb.t_o(),sb.Aee(!1)))}dispose(){}wc(d){d.register(862,"Common.App.Policy.Contracts.IPolicyManager").ha().Ud(()=>new ya(n.AFrameworkApplication.K,n.AFrameworkApplication.He,n.AFrameworkApplication.ta.Kq,n.AFrameworkApplication.K.nc("MaxGetPolicyRetries",1),d.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),n.AFrameworkApplication.ta.Kb.xk));d.register(sb,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ha().Ud(()=>
new sb(n.AFrameworkApplication.va,n.AFrameworkApplication.ta,n.AFrameworkApplication.K,d.Ve("Common.App.Policy.Contracts.IPolicyManager")));this.W=d}VTi(){this.wt=this.W.Oa("CommonUI.BusinessBar");this.Hh||(this.Hh=this.W.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.bba=this.W.resolve("Common.App.Policy.PolicyActor");Xa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Hh.o0e(Object(I.a)(this.bba,this.bba.G9i,
"registerActionsHandler")):this.bba.Ub();this.Hh.o0e(Object(I.a)(this,this.cYo,"updateLabelInfo"));n.AFrameworkApplication.K.$("WacApplyManualPolicyLabelIsEnabled")&&(this.Hh.P0e(Object(I.a)(this,this.brm,"handleSetPolicyLabelFailure")),this.Hh.Zwk(Object(I.a)(this,this.LBd,"addAutoPolicyBusinessBarEntry")),this.Hh.Gzk(Object(I.a)(this,this.WTa,"removeAutoPolicyBusinessBarEntry")),this.Hh.$wk(Object(I.a)(this,this.o_e,"addMandatoryLabellingBusinessBarEntry")),this.Hh.Hzk(Object(I.a)(this,this.v8f,
"removeMandatoryLabellingBusinessBarEntry")))}cYo(){this.bba.Omo();this.bba.qko();this.bba.TMn();const d=this.Hh.WWk();n.AFrameworkApplication.K.$("HasDocumentEditRights")&&!d?this.bba.JOo():v.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",n.AFrameworkApplication.K.$("HasDocumentEditRights"),d);n.AFrameworkApplication.ta.updateCommandUI()}vyo(d,m){this.SOe&&this.wt.EY(38)&&this.wt.removeEntry(this.SOe);
d=this.ifi(m.title,m.zEn,38,m.umn,m.buttonText);n.AFrameworkApplication.ta.Kb.Vma(d,!0)?(this.SOe=d,v.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):v.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}brm(d,m){m.byo&&(this.MSe&&this.wt.EY(21)&&this.wt.removeEntry(this.MSe),d=this.ifi(m.title,m.message,21,null,null,m.WHc,m.buttonText),n.AFrameworkApplication.ta.Kb.Vma(d,!0)?
(this.MSe=d,v.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):v.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}WTa(d,m){(d=m.Q0d?this.adh:this.QMg)&&this.wt&&this.wt.EY(m.k4b)&&this.wt.removeEntry(d)}LBd(d,m){this.wt&&(this.Hh.WTa(m.k4b),d=new X.a(m.title,m.message,null),d.id=m.k4b,d.closeable=!0,d.image=3,d.addButton(m.buttonText,m.WHc,m.buttonText,!0),this.wt.sA(d,
!1),m.Q0d?this.adh=d:this.QMg=d)}o_e(d,m){this.wt&&(d=new X.a(m.title,m.message,null),d.id=m.k4b,d.closeable=!1,d.image=3,d.addButton(m.buttonText,m.WHc,m.buttonText,!1),this.wt.sA(d,!1),this.S6g=d)}v8f(){const d=this.S6g;d&&this.wt&&this.wt.EY(d.id)&&this.wt.removeEntry(d)}ifi(d,m,A,R=null,da=null,Ea=null,ib=null){d=new X.a(d,m,null);d.id=A;d.closeable=!0;R&&d.dCd(da,R);Ea&&d.addButton(ib,Ea,ib);return d}static main(){z.a.instance.Gc(new tb)}}Object(y.a)(tb,"PackageManager",null,[1,2]);var Xb=c(202),
$b=c(578),Ab=c(15),vc=c(602),Sc=c(532),ed=c(233);class pd extends ed.a{constructor(){super();this.Offset=this.Top=this.CollectionId=this.Authorization=this.FileId=this.Language=null}ml(){return Sc.a.templates}static construct(d,m,A,R,da,Ea){const ib=new pd;ib.Language=A;ib.FileId=m;ib.Authorization=d;ib.CollectionId=R;ib.Top=da;ib.Offset=Ea;return ib}}Object(y.a)(pd,"TemplatesRequest",ed.a,[]);class oc{constructor(d,m,A){this.SQ=d;this.K=m;this.qkn=A;this.QHi=async(R,da,Ea,ib)=>{var Qb;let pc=pd.construct(null,
n.AFrameworkApplication.rootQuerySignature,R,da,Ea,ib);this.qkn.RV("ContentPlatform",null!==(Qb=this.K.kb("ContentPlatformUrl"))&&void 0!==Qb?Qb:"https://contentplatform.office.net").then(Pc=>{Pc.IsSuccess?pc=pd.construct(Pc.Token,R,n.AFrameworkApplication.rootQuerySignature):v.ULS.sendTraceTag(509693953,3042,15,"Failed to acquire access token for Content Platform [OAuthResult Error: {0}]",Pc.ErrorMessage)}).catch(()=>{v.ULS.sendTraceTag(509693952,3042,15,"Failed to acquire access token for Content Platform")});
return this.ewk(pc)}}ewk(d){return new Promise((m,A)=>{this.SQ.nj(`${Ab.App.webServiceBase}OfficeTemplatesMetadata.ashx?perfTag=Templates`,2,vc.b(d),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,R=>{var da,Ea;if(null===(da=null===R||void 0===R?void 0:R.data)||void 0===da||!da.te)return A("No response data!");if(R.data.Ne!==Xb.a.Zz)return A(`Bad Http Status ${R.data.Ne}`);if(!({group:R}=$b.a.d2(R.data.te)).returnValue)return A("Empty Server response!");da=null;if(null===(Ea=null===R||void 0===
R?void 0:R.Responses)||void 0===Ea||!Ea.length||!(da=R.Responses[0]))return A("No valid response!");m(da.Templates)},R=>{var da,Ea;v.ULS.sendTraceTag(509692131,3042,10,"Templates request failed [Status: {0}]",null===(da=null===R||void 0===R?void 0:R.data)||void 0===da?void 0:da.status);A(null===(Ea=null===R||void 0===R?void 0:R.data)||void 0===Ea?void 0:Ea.status)},d)})}}Object(y.a)(oc,"OfficeTemplatesDiscoveryService",null,[]);class cd{get name(){return"Box4.OfficeTemplates"}init(){}dispose(){}wc(d){this.container=
d;this.container.register(oc,"Box4.OfficeTemplates.OfficeTemplatesDiscoveryService").ha().Ud(()=>new oc(n.AFrameworkApplication.He,this.container.resolve("Common.IAppSettingsManager"),this.container.resolve("Common.App.OAuth.IOAuthManager")))}static main(){z.a.instance.Gc(new cd);v.ULS.sendTraceTag(509692130,3042,50,"Box4 Office Templates package registered.")}}Object(y.a)(cd,"OfficeTemplatesPackage",null,[1,2]);var Xc=c(1395),ic=c(11),Ac=c(14);class wd{constructor(d,m){this.ga=d;this.Iqc=m}Ub(){v.ULS.sendTraceTag(558965411,
390,50,"Registering AcronymsWeb actions");try{this.ga.fb(Ac.a.iRb,K.a.frame,this.Iqc.$mi,1028),this.ga.fb(Ac.a.x5f,ic.a.view,this.Iqc.lni,1124)}catch(d){v.ULS.sendTraceTag(558965440,390,10,"Registering actions failed",d.message)}}s9a(){v.ULS.sendTraceTag(558965441,390,50,"Unregistering AcronymsWeb actions");this.ga.Vv(Ac.a.iRb,K.a.frame,this.Iqc.$mi);this.ga.Vv(Ac.a.x5f,ic.a.view,this.Iqc.lni)}dispose(){this.Iqc=this.ga=null}}Object(y.a)(wd,"AcronymsWebActionDelegator",null,[10]);var Je=c(311);class Zd{constructor(d){this.Jqc=
d;this.$mi=(m,A,R)=>{if(1===R)return 32;try{this.Jqc.isVisible()?this.Jqc.hide():this.Jqc.show()}catch(da){return v.ULS.sendTraceTag(558965410,390,10,"Show/hide pane failed",da.message),8}return 32};this.lni=(m,A,R,da,Ea)=>{if(1===R)return 32;Ea&&(Ea[Je.a.On]=this.Jqc.isVisible(),Ea[Je.a.Visible]=!0);return 32}}dispose(){this.Jqc=null}}Object(y.a)(Zd,"AcronymsWebActionHandler",null,[10]);var le=c(1413);class kc{constructor(d,m,A,R){this.ii=d;this.Txd=m;this.uCe=A;this.qtd=Object.assign(new le.a,{isModernPane:!0,
sourceLocationOverrideResourceId:this.Txd,pS:WordEditorIntl.WordEditorStrings.L_AcronymsPaneTitle});R(this)}static dWk(){return d=>{d.uCe.execute(async m=>{m=await m.isFeatureEnabled("mso_sendASmile",!0)&&n.AFrameworkApplication.LF;const A={};A.EnableFeedback=m;d.qtd.bS=A})}}isVisible(){return this.ii.J0(`${"FA000000085"}.${this.Txd}`)}show(){if(this.isVisible())return v.ULS.sendTraceTag(558965405,390,10,"Show pane called when already shown"),!0;Ca.c(Ac.a.iRb,void 0,void 0,void 0,2);let d=!1;try{d=
this.ii.V5("FA000000085",this.qtd,!0)}catch(m){v.ULS.sendTraceTag(558965406,390,10,"Show pane failed due to exception",m.message)}d||v.ULS.sendTraceTag(558965407,390,10,"Show pane failed");return d}hide(){if(this.isVisible()){Ca.c(Ac.a.iRb,void 0,void 0,void 0,2);try{this.ii.DCb("FA000000085",this.qtd)}catch(d){v.ULS.sendTraceTag(558965409,390,10,"Hide pane failed",d.message)}}else v.ULS.sendTraceTag(558965408,390,10,"Hide pane called when already hidden")}dispose(){this.qtd=this.ii=null}}Object(y.a)(kc,
"AcronymsWebPane",null,[10]);var kd=c(948);class nd extends kd.a{constructor(){super(...arguments);this.W=null}get name(){return"WordEditor.AcronymsWeb"}F8(d){this.W=d;this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebPane",()=>new kc(this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),n.AFrameworkApplication.K.kb("WordEditorAcronymsWebSourceLocationOverrideResourceId"),this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),kc.dWk())).ha();this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebActionHandler",
()=>new Zd(this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane"))).ha();this.W.ia("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator",()=>new wd(n.AFrameworkApplication.va,this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler"))).ha()}H8(){let d=!1;try{this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").Ub(),d=!0}catch(m){v.ULS.sendTraceTag(558965404,390,10,"Initializing package failed",m.message)}Ca.a("InitializeAcronymsWebPackage",d)}G8(){this.W&&(this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").s9a(),
this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebPane").dispose(),this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionHandler").dispose(),this.W.resolve("WordEditor.AcronymsWeb.IAcronymsWebActionDelegator").dispose(),this.W=null)}static get WHm(){return Object(Xc.a)(n.AFrameworkApplication.K,n.AFrameworkApplication.uiCulture)}static main(){n.AFrameworkApplication.eL||nd.WHm&&z.a.instance.Gc(new nd)}}Object(y.a)(nd,"WordEditorAcronymsWebPackage",kd.a,[]);class Ud{constructor(){this.MYj=new U.a}get fFd(){return this.MYj}F7l(d){v.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",d);const m=new U.a;for(let A of this.fFd)for(let R of A.T1c)R.id===d&&m.add(R);return m}ONk(d){var m=this.F7l(d);if(m&&0<m.count){d=Object.assign(new fa.a,{ControlList:[]});for(let A of m)m=A.ncd(),0<m.length&&Array.addRange(d.ControlList,m);return d}return null}Moh(d){this.fFd.add(d)}B_n(d){for(let m of this.fFd)if(m.Esh===d.Esh){this.fFd.remove(m);break}}static apl(d,m,A=null){d=Ud.QTl(d);0<d.length&&(Ud.$ge(d,!1),A&&A(m,d))}static QTl(d){const m=[];if(d&&d.T1c&&0<
d.T1c.count)for(let A of d.T1c)if(A.controls&&0<A.controls.count)for(let R of A.controls)if(R.menuItems&&0<R.menuItems.count)for(let da of R.menuItems)Array.add(m,da.id);return m}static $ge(d,m){if(d.length){var A=[];for(const R of d)A.push(appChrome.actions.updateControlEnabledDisabledState(R,m));appChrome.api.dispatch(A)}}}Object(y.a)(Ud,"ContextMenuExtensibilityCache",null,[1291,1292]);class Qd{constructor(){this.$tl=this.displayName=this.eKc=this.VA=this.jV=null;this.isUpgraded=!1}NCi(d,m){return this.jV.getStoreType().toLowerCase()===
d.toLowerCase()&&this.jV.getSolutionId().toLowerCase()===m.toLowerCase()}}Object(y.a)(Qd,"AddinCommandsResourceItem",null,[]);class Gd{constructor(){this.jte=null;this.sDe=0;this.hGe=!1;this.sa=new vb.a;this.K7j=new U.a}cxk(d){this.sa.addHandler("AddinCommandsLoadingMessageChanged",d)}get tGc(){return this.jte}Glc(d){d!==this.jte&&(this.jte=d,this.sa.raiseEvent("AddinCommandsLoadingMessageChanged"))}mho(){this.sDe++;this.tGc||this.Glc(CommonUIStrings.l_LoadingAddInsTitle)}Idg(){this.sDe--;this.k3d()&&
(this.hGe?this.tGc!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Glc(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Glc(null))}kjo(){this.hGe=!0;this.Glc(CommonUIStrings.l_ErrorLoadingAddInsTitle)}JEh(){this.hGe=!1;this.k3d()?this.Glc(null):this.Glc(CommonUIStrings.l_LoadingAddInsTitle)}k3d(){return 0>=this.sDe}get Tbc(){return this.K7j}H8b(d,m,A=0){for(let R of this.Tbc)if(R.NCi(d,m)&&(!R.VA||R.VA.gMl===A))return R;return null}xph(d,m,A,R){const da=new Qd;da.jV=d;da.VA=m;da.eKc=A;da.displayName=
R;this.Tbc.add(da)}huk(d,m,A,R){const da=new Qd;da.jV=d;da.VA=m;da.eKc=null;da.$tl=A;da.displayName=R;this.Tbc.add(da)}XZn(d,m){let A=0;for(let R of this.Tbc)R.jV.getStoreType()===d&&R.jV.getSolutionId()===m?this.Tbc.removeAt(A):A++}static getInstance(){Gd._instance||(Gd._instance=new Gd);return Gd._instance}}Gd._instance=null;Object(y.a)(Gd,"AddinCommandsResourceManager",null,[]);var of=c(1993),Tf=c(51),uh=c(1400),Gh=c(777),Dh=c(541),lg=c(1401),xh=c(183),eg=c(57);class cc{constructor(){this.title=
this.id=this.tabs=null}}Object(y.a)(cc,"AddInDataTransferObject",null,[]);class Ic{constructor(d,m,A){this.Ngd=d;this.xVj=m;this.zVj=A}get IH(){return this.Ngd}get Gtk(){return this.xVj}get Itk(){return this.zVj}static nPc(d){return(d=d.Jya)?Object.assign(new cc,{tabs:d.IH.toArray(),id:d.Gtk,title:d.Itk}):null}}Object(y.a)(Ic,"OneLineRibbonExtensibility",null,[]);var Yc=c(26);class ad{static get Hv(){return ad.Xo||(ad.Xo=Ia.a.instance.Oa("Common.Utils.IAriaNotifier"))}static ELh(d,m,A,R){ad.HW&&ad.HW.cI&&
ad.HW.dismiss();ad.HW=of.a.fNh(m,d,d,3);ad.HW.content=A;Yc.b(R)||(ad.HW.title=R,ad.HW.JWd=!0);d=new Sys.UI.Bounds(0,0,eg.a.yHb(),eg.a.kY());ad.HW.Ega=ad.gpf(d,m,ad.HW.Tka,1);ad.HW.show();ad.Hv&&ad.Hv.sendNotification(A.innerText,!0)}static DKc(d,m,A,R=null){xh.UISurfaces.MM().then(da=>{let Ea=null;ad.Sta&&(da.removeNotification(ad.Sta),ad.Sta=null);const ib=da.callout(Object.assign(new uh.a,{target:d,title:m,content:A,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new lg.a,
{onDismiss:()=>{da.removeNotification(Ea)},directionalHint:null!=R?R:null})})),Qb=Object.assign(new Dh.a,{expirationOptions:Object.assign(new Gh.a,{displayTimeoutSeconds:7,onExpire:()=>{da.removeNotification(ad.Sta)}})});Ea=ad.Sta=da.addNotification(ib,Qb);return null},da=>{v.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",da);return null})}static ohg(d){ad.HW&&ad.HW.cI&&ad.HW.dismiss();const m=new xb.StandardDialog;m.fJa=!1;m.Cd=0;m.wx(Tf.a.$_m,CommonUIStrings.l_DialogError,
Yc.b(d)?ad.i9h():d,null)}static pwo(d){ad.HW&&ad.HW.cI&&ad.HW.dismiss();v.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",d.errorCode));const m=Yc.b(d.description)?ad.i9h():d.description,A=new xb.StandardDialog;let R=null;d.YHc?(A.Cd=1,A.ye(1,d.buttonText),A.FV(1)):A.Cd=0;R=da=>{1===da?d.YHc():d.$na&&d.$na()};A.fJa=!1;0===d.Xca?A.wx(d.errorCode,d.title?d.title:CommonUIStrings.l_DialogError,m,R):1===d.Xca?A.IV(d.title?d.title:CommonUIStrings.l_DialogWarning,
m,R):A.lka(d.title?d.title:CommonUIStrings.l_DialogInfo,m,R)}static gpf(d,m,A,R){let da=0===R?0:4;const Ea=d.x+d.width-m.x-m.width;m.x-d.x+m.width/2<=A/2?da=0===R?2:5:Ea+m.width/2<=A/2&&(da=0===R?3:6);return da}static Cwo(d,m,A,R=!1){(m=Ic.nPc(m))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(m,da=>{da&&(R||ad.DKc(da,A,d,5))})}static Dwo(d,m,A=!1){ad.Cwo(m.startedNode?m.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,
d),m,m.startedNode?m.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,d),A)}static Bwo(d,m,A,R){if(ad.kJj)d=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,A,R,CommonUIStrings.l_InsertionDialogRefresh)),ad.DKc(m,d,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{m=cb.a.getElementBounds(m);var da=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Ea=document.createElement("span");
Ea.innerText=da[0];var ib=document.createElement("span");ib.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,A,R,CommonUIStrings.l_InsertionDialogRefresh);ib.className="UIFontBold";A=document.createElement("span");A.innerText=da[1];R=document.createElement("div");Sys.UI.DomElement.addCssClass(R,"ModalCalloutControl");R.appendChild(Ea);R.appendChild(ib);R.appendChild(A);ad.ELh(d,m,R,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static cyo(d,m){var A=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,
R=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;ad.kJj?ad.DKc(m,A,R):(m=cb.a.getElementBounds(m),ad.ELh(d,m,ad.JPk(R),A))}static Opl(){ad.HW&&ad.HW.cI&&ad.HW.dismiss()}static JPk(d){const m=document.createElement("div");Sys.UI.DomElement.addCssClass(m,"ModalCalloutControl");m.innerText=d;return m}static i9h(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get kJj(){return n.AFrameworkApplication.ta.Kb.Gr&&n.AFrameworkApplication.ta.Kb.TRa}}
ad.HW=null;ad.Sta=null;ad.Xo=null;Object(y.a)(ad,"AddInCommandsNotificationFactory",null,[]);class yd{constructor(d,m){this.OJa=(A,R,da,Ea,ib)=>{if(R.contextId!==ic.a.application)return 2;if(1===da)return A!==Q.a.B2b||this.Yka&&this.Yka.Xnm(ib)?32:8;if(!ib)return 8;switch(A){case Q.a.LKb:this.Yka.LKb(ib);break;case Q.a.B2b:this.Yka.XVd(ib);break;case Q.a.j5c:this.Yka.j5c(ib);break;case Q.a.$lc:this.Yka.$lc(ib);break;case Q.a.fZ:this.Yka.dMn(ib);break;case Q.a.Xjc:this.Yka.Xjc(ib);break;case Q.a.Z6f:this.Yka.HUn();
break;case Q.a.jRb:this.Yka.jRb(ib);break;case Q.a.hJa:this.Yka.hJa(ib);break;case Q.a.YFa:this.Yka.YFa(ib);break;case Q.a.Xcd:this.Yka.Xcd()}return 32};this.ga=d;this.Yka=m}Ub(){this.ga.qa(Q.a.LKb,ic.a.application,this.OJa);this.ga.fb(Q.a.B2b,ic.a.application,this.OJa,64);this.ga.fb(Q.a.j5c,ic.a.application,this.OJa,96);this.ga.qa(Q.a.$lc,ic.a.application,this.OJa);this.ga.fb(Q.a.Xjc,ic.a.application,this.OJa,64);this.ga.fb(Q.a.fZ,ic.a.application,this.OJa,64);this.ga.qa(Q.a.Z6f,ic.a.application,
this.OJa);this.ga.qa(Q.a.jRb,ic.a.application,this.OJa);this.ga.qa(Q.a.hJa,ic.a.application,this.OJa);this.ga.qa(Q.a.YFa,ic.a.application,this.OJa);this.ga.qa(Q.a.Xcd,ic.a.application,this.OJa)}}Object(y.a)(yd,"AddInCommandsActor",null,[]);class ne{constructor(){this.Pmh={["tabhome"]:"tabHome",["tabinsert"]:"tabInsert",["tabpagelayoutword"]:"tabPageLayout",["tabreviewword"]:"tabReview",["tabview"]:"tabView",["tabhelp"]:"tabHelp"};this.Kmh={["tabworddesign"]:["tabWordDesign",WoncaIntl.WoncaStrings.L_TabWordDesign,
CommonUIStrings.l_TabWordDesignKeytip],["tabreferences"]:["tabReferences",WoncaIntl.WoncaStrings.L_TabReferences,CommonUIStrings.l_TabReferencesKeytip],["tabmailings"]:["tabMailings",WoncaIntl.WoncaStrings.L_TabMailings,CommonUIStrings.l_TabMailingsKeytip],["tabdeveloper"]:["tabDeveloper",WoncaIntl.WoncaStrings.L_TabDeveloper,CommonUIStrings.l_TabDeveloperKeytip],["tabaddins"]:["tabAddIns",WoncaIntl.WoncaStrings.L_TabAddIns,CommonUIStrings.l_TabAddInsKeytip]};this.dBd=null}get VJh(){return"SourceControlId"}get tY(){return"Document"}get formFactor(){return"DesktopFormFactor"}j5l(){if(!this.dBd){this.dBd=
{};for(const d of Object.keys(this.Pmh))this.dBd[d]=this.Pmh[d];for(const d of Object.keys(this.Kmh))this.dBd[d]=this.Kmh[d][0]}}}Object(y.a)(ne,"AddInCommandsStringProvider",null,[868]);var Oe=c(1836),nf;(function(d){d[d.notSupported=0]="notSupported";d[d.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";d[d.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";d[d.launchByInsertion=3]="launchByInsertion";d[d.launchByRefresh=4]="launchByRefresh";d[d.launchByLastUpdateInitializer=
5]="launchByLastUpdateInitializer";d[d.launchByDynamicCall=6]="launchByDynamicCall"})(nf||(nf={}));Object(y.b)("AddinCommandsLaunchOperationType",nf);class wf{}wf.hLo=864E5;wf.mAk=3;wf.Rkn=144E5;Object(y.a)(wf,"AddinConstantsNum",null,[]);var Ye=c(1530),Rg;(function(d){d[d.notSupported=-1]="notSupported";d[d.OMEX=0]="OMEX";d[d.spCatalog=1]="spCatalog";d[d.spApp=2]="spApp";d[d.fileSystem=3]="fileSystem";d[d.exchange=4]="exchange";d[d.oneDrive=5]="oneDrive";d[d.registry=6]="registry";d[d.inMemory=7]=
"inMemory";d[d.uploadFileDevCatalog=8]="uploadFileDevCatalog";d[d.hardCodedPreinstall=9]="hardCodedPreinstall";d[d.privateCatalog=10]="privateCatalog";d[d.wopiCatalog=16]="wopiCatalog"})(Rg||(Rg={}));Object(y.b)("AddinProviderType",Rg);class Db{static vuo(d){return parseInt(Db.mog(Ye.a.bsh,d)||"-1")<=(new Date).getTime()}static Y4h(d){return parseInt(Db.mog(Ye.a.Y2b,d)||"-1")}static oni(d){return Boolean.parse(Db.mog(Ye.a.U0e,d)||"false")}static mog(d,m){let A=null;try{const R=Db.fTd();if(void 0!==
R&&R){const da=Ye.a.X4h(d)+m;A=R.getItem(da)}else v.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(R){v.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",d,m)}return A}static Fne(d,m,A){try{const R=Db.fTd();if(void 0!==R&&R){const da=Ye.a.X4h(d)+A;R.setItem(da,m)}else v.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(R){v.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",d,A)}}static fTd(){if(!Db.CTc)return null;let d=null;try{d=localStorage}catch(m){Db.CTc=!1,d=null}return d}}Db.CTc=!0;Object(y.a)(Db,"AddinUtil",null,[]);class Zb{constructor(d,m,A,R=null){this.K=R?R:n.AFrameworkApplication.K;this.fFe=2;this.Ibc=d;this.Mok=m;this.eq=A}get Kkb(){return this.fFe}get X1o(){return this.Mok}dag(d){if(this.K.$("AgaveSupportsLiveIdSpoofing")){var m=(new Date).getTime();this.Ibc(d,this.Kkb,{["ak0"]:m})}else if(Db.vuo(d)){m=
String.format(n.AFrameworkApplication.ta.Kb.NSa+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",n.AFrameworkApplication.ta.Kb.xk,this.X1o,n.AFrameworkApplication.em);const A=n.AFrameworkApplication.He;let R=null;this.eq&&(R=this.eq.Yf("ComponentAttach",Rg[d]+nf[this.Kkb]));A.nj(m,1,null,null,!0,4,da=>{this.Rwn(d,da.data.te);R&&R.stop()},da=>{v.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",da.data.Ne);R&&R.stop()},null)}else Db.oni(d)?(m=Db.Y4h(d),
this.Ibc(d,this.Kkb,{["ak0"]:m})):this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.Ibc(d,this.Kkb,null)}Rwn(d,m){if(m&&""!==m&&(m=Sys.Net.XMLDOM(m))){Db.Fne(Ye.a.bsh,((new Date).getTime()+wf.Rkn).toString(),d);let A=m.getElementsByTagName("update");A&&A.length||(A=m.getElementsByTagName("o:update"));A&&0<A.length&&(m=Date.parse(A[0].firstChild.nodeValue),(Db.Y4h(d)<m||Db.oni(d))&&this.Ibc(d,this.Kkb,{["ak0"]:m}))}}}Object(y.a)(Zb,"AddinCommandsAnonymousAPIInitializer",
null,[1194]);class xc{constructor(d,m,A){this.fFe=A;this.Ibc=d;this.je=m}get Kkb(){return this.fFe}dag(d){let m=null;this.je&&(m=this.je.Yf("ComponentAttach",Rg[d]+nf[this.Kkb]));if(null==this.Pgg(d)?0:this.Pgg(d)){const A=(new Date).getTime()-wf.mAk*wf.hLo;this.Ibc(d,this.Kkb,{["ak0"]:A})}m&&m.stop()}}Object(y.a)(xc,"AddinCommandsInitializerBase",null,[1194]);class Jd extends xc{constructor(d,m){super(d,m,5)}Pgg(){return!0}}Object(y.a)(Jd,"AddinCommandsInitializer",xc,[]);class ie extends xc{constructor(d,
m){super(d,m,1)}Pgg(d){try{const m=Ye.a.y$h()+d;return Boolean.parse(this.NQl(m)||"false")}catch(m){v.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",m.toString())}return null}NQl(d){const m=localStorage;return void 0!==m&&null!==m?m.getItem(d):null}}Object(y.a)(ie,"AddinCommandsLocalCacheInitializer",xc,[]);var De=c(760);class qf{constructor(d,m=null){this.eq=d;this.K=m?m:n.AFrameworkApplication.K}get appUILocale(){return De.a.ug(n.AFrameworkApplication.lcid).name}SAm(){if(this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var d={};d[Ye.a.Xtl]="TeachingCallout";this.s3f(Q.a.Xcd,d)}const m=this.Q5h();if(m)if(this.K.$("OcpsIsEnabled"))Ia.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(A=>{A.isFeatureEnabled("ConnectedServices",
!0).then(R=>{for(let da of m){if(!R&&0===da.key)continue;const Ea=this.r4h(da.value);Ea&&Ea.dag(da.key)}return null})});else for(let A of m)(d=this.r4h(A.value))&&d.dag(A.key)}eag(d,m,A){A&&A[Ye.a.Y2b]?(A[Ye.a.iOa]=d,A[Ye.a.hOa]=m,this.s3f(Q.a.Xjc,A),Db.Fne(Ye.a.Y2b,A[Ye.a.Y2b].toString(),d)):this.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===d&&(A={},A[Ye.a.iOa]=d,A[Ye.a.hOa]=m,this.s3f(Q.a.fZ,A))}r4h(d){let m=null;switch(d){case 1:m=new ie(Object(I.a)(this,
this.eag,"retrieveAddinFlagCompleted"),this.eq);break;case 2:m=new Zb(Object(I.a)(this,this.eag,"retrieveAddinFlagCompleted"),this.appUILocale,this.eq,this.K);break;case 5:m=new Jd(Object(I.a)(this,this.eag,"retrieveAddinFlagCompleted"),this.eq)}return m}}Object(y.a)(qf,"AddinCommandsInitializerHost",null,[]);var tg=c(153);class Ah extends qf{constructor(d,m){super(m);this.ga=d}zQo(){this.SAm()}XNl(){return this.Q5h()}Q5h(){const d=new tg.a;n.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&
(n.AFrameworkApplication.K.$("AddInCommandsRoamingStoreIsEnabled")?d.Z(0,2):d.Z(0,1),d.Z(16,5));n.AFrameworkApplication.K.$("InsertAgaveMyOrgEnabledForHost")&&d.Z(1,1);n.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled")&&d.Z(10,5);n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&d.Z(8,1);return d}s3f(d,m){this.ga.Qb(d,2,m)}}Object(y.a)(Ah,"AddInCommandsInitService",qf,[245]);class ji extends Ah{constructor(d,m){super(d,m);Oe.a.TTc=Oe.a.wMj}}Object(y.a)(ji,"WordEditorAddInCommandsInitService",
Ah,[]);class Bh{constructor(){this.labelText=null;this.visible=!1}}Object(y.a)(Bh,"AddinStatusCommandValues",null,[]);class Tj{static HMn(d){const m=new Bh;m.labelText=d.tGc;m.visible=m.labelText?!0:!1;return m}static uje(d,m,A,R,da){const Ea=document.getElementById(A);Ea?Tj.$xo(d,m,Ea,R,da):v.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",A))}static $xo(d,m,A,R,da){A?d.tGc===CommonUIStrings.l_ErrorLoadingAddInsTitle?ad.Bwo(m,A,R,da):d.tGc===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
ad.cyo(m,A):v.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(y.a)(Tj,"AddinCommandsStatusHandler",null,[]);var sf=c(25),vf=c(69),Sf=c(114),ah=c(190);class mg{constructor(d,m,A,R=null){this.u8c=n.AFrameworkApplication.K.kb("RoamingServiceHandlerWebServiceBase");this.appName=d;this.Cvb=m;this.$vc=A;this.CBc=R}$jf(d){this.cZh(d,"getAddinTeachingCalloutSettings",Object(I.a)(this,this.h3a,"getRequestSuccessCallback"),Object(I.a)(this,this.Soa,"getRequestFailureCallback"))}Fzl(){const d=
new U.a;d.add(this.appName);this.cZh(d,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(I.a)(this,this.jcm,"getRequestSuccessCallbackForBEP"),Object(I.a)(this,this.Soa,"getRequestFailureCallback"))}cZh(d,m,A,R){const da=new Sys.StringBuilder(this.u8c);da.append("RoamingServiceHandler.ashx?action=");da.append(m);da.append("&");da.append(this.iuf(d));da.append("&");da.append(n.AFrameworkApplication.em);n.AFrameworkApplication.He.nj(da.toString(),1,null,null,!0,2,A,R,null)}VNd(d){this.jZh(d,
"saveAddinTeachingCalloutSettings")}Jzl(d){this.jZh(d,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}jZh(d,m){const A=new Sys.StringBuilder(this.u8c);A.append("RoamingServiceHandler.ashx?action=");A.append(m);A.append("&");A.append(n.AFrameworkApplication.em);m=A.toString();d=rb.c(d);n.AFrameworkApplication.He.nj(m,2,d,null,!0,4,null,Object(I.a)(this,this.gIa,"postRequestFailureCallback"),null)}h3a(d){let m=!1,A=null;try{if(0<d.data.te.length){const R=Object(vf.a)(Object,rb.a(d.data.te)),
da=R?R[this.appName]:null;da&&(A=Object(vf.a)(Object,rb.a(da.toString())))}m=!0}catch(R){this.Soa(null)}m&&this.Cvb&&this.Cvb(A)}jcm(d){let m=!1,A=null;try{if(0<d.data.te.length){const R=Object(vf.a)(Object,rb.a(d.data.te));A=Object(vf.a)(String,R[this.appName])||null}m=!0}catch(R){this.Soa(null)}m&&this.Cvb&&(d={},d.Platforms=A,this.Cvb(d))}Soa(d){this.$vc&&this.$vc(d?d.data:null)}gIa(d){this.CBc&&this.CBc(d?d.data:null)}iuf(d){const m=new Sys.StringBuilder("requestedsettings=");for(let A=0;A<d.count;A++)m.append(d.J(A)),
A<d.count-1&&m.append(";");return m.toString()}}Object(y.a)(mg,"AddinTeachingUIRoamingRequestHandler",null,[]);var Bg=c(176);class Cg{constructor(d){this.Sle=null;this.t8c=!1;this.fd=new vb.a;this.w8c=this.Yea=null;this.contextActivationMgr=d;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(I.a)(this,this.dtn,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(I.a)(this,this.JWf,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",
Object(I.a)(this,this.kWf,"onCloseButtonClickedEventHandler"),!0))}get appName(){Yc.b(this.Yea)&&(this.Yea=n.AFrameworkApplication.K.kb("WebAppShortName"));return this.Yea}Gxk(d){this.fd.addHandler(Ye.a.OGi,d)}HVa(){this.contextActivationMgr.queryStoreDisabled("omex",d=>{d?v.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.YOo()})}YOo(){this.Sle=new mg(this.appName,Object(I.a)(this,this.h3a,"getRequestSuccessCallback"),Object(I.a)(this,this.Soa,"getRequestFailureCallback"),
Object(I.a)(this,this.gIa,"postRequestFailureCallback"));this.Sle.Fzl()}h3a(d){this.Ugg(d)&&(v.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.fzo())}Soa(d){v.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",d?d.Ne:-1)}gIa(d){v.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",d?d.Ne:-1)}Ugg(d){if(!d)v.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in d&&(this.w8c=
Object(vf.a)(String,d.Platforms),!Yc.b(this.w8c)&&(d=this.w8c.split(","),0<d.length&&Array.contains(d,"Web"))))return v.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}fzo(){const d=Ia.a.instance.Sa("Common.ISystemInitiatedFeedback");if(d){var m=this.XMl();Yc.b(m)?v.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):d.execute(A=>{A.logActivity(m,null)})}else v.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}dtn(){this.WB("ClickOnLaunch");
this.rbg();this.fd.raiseEvent(Ye.a.OGi)}kWf(){this.WB("ClickOnClose");this.rbg()}JWf(){this.WB("ClickOnDismiss");this.rbg()}XMl(){let d;switch(this.appName){case "Word":d="WordShowCalloutForBEPHomeTab";break;case "Excel":d="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":d="PPTShowCalloutForBEPHomeTab";break;default:d=""}return d}WB(d){d={["AppTeachingUICalloutAction"]:d,["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Sf.a.RH(d)}))}rbg(){if(!this.t8c)if(Yc.b(this.appName))v.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const d={};d[this.appName]=this.w8c?this.w8c+",Web":"Web";this.Sle&&(this.Sle.Jzl(d),v.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.t8c=!0}}}Object(y.a)(Cg,"BetterEntryTeachingCalloutLauncher",null,[]);var ki=c(1407),Rh=c(61);class ml extends Sys.EventArgs{constructor(){super();this.VA=
this.Yp=null}}Object(y.a)(ml,"InsertionParamEventArgs",Sys.EventArgs,[]);class el{constructor(d,m,A,R,da,Ea){this.vF=d;this.Yp=m;this.tza=A;this.displayName=da;this.$Fi=Ea}}Object(y.a)(el,"PostLaunchAddinCommandsParameters",null,[]);var Kl=c(197),ig=c(349);class Mi{}Object(y.a)(Mi,"AppsForOfficeEntitlementQueryInfo",null,[]);class fh{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(y.a)(fh,"AddinAbstract",null,[]);class zf extends Sys.EventArgs{constructor(d){super();
this.solutionId=d.solutionId;this.assetId=d.assetId;this.storeType=d.storeType;this.storeId=d.storeId;this.assetStoreId=d.assetStoreId;this.targetType=d.targetType;this.width=d.width;this.height=d.height;this.displayName=d.displayName;this.version=d.version}}Object(y.a)(zf,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class Eh{constructor(d){this.Z2b=this.Yp=null;this.t8c=!1;this.hab=this.Rgd=this.GTa=this.Et=this.Ysb=this.kkc=null;this.fd=d}get appName(){return n.AFrameworkApplication.K.kb("WebAppShortName")}get hsh(){this.Ysb||
(this.Ysb=new mg(this.appName,Object(I.a)(this,this.h3a,"getRequestSuccessCallback"),Object(I.a)(this,this.Soa,"getRequestFailureCallback"),Object(I.a)(this,this.gIa,"postRequestFailureCallback")));return this.Ysb}get efb(){this.Rgd||(this.Rgd=new U.a);return this.Rgd}set efb(d){this.Rgd=d}get SCb(){this.hab||(this.hab=new U.a);return this.hab}set SCb(d){this.hab=d}YBd(d,m){window.addEventListener?(this.Yp=d,this.Z2b=m,window.addEventListener("LaunchAddinTaskpane",Object(I.a)(this,this.Yqn,"onLaunchButtonClickedEventHandler"),
!0),window.addEventListener("DismissCallout",Object(I.a)(this,this.JWf,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(I.a)(this,this.kWf,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(I.a)(this,this.zUi,"onCampaignLaunchedHandler"),!0)):v.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}HVa(d,m,A,R){this.Et=d;this.efb=m;this.SCb=A;this.GTa=R;v.ULS.sendTraceTag(0,220,50,
"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",m?m.count.toString():"null",A?A.count.toString():"null");0<this.efb.count||0<this.SCb.count?(d=new U.a,d.add(this.appName),this.hsh.$jf(d)):this.GTa(new U.a,null)}Yqn(){const d=new Kl.ScriptSharpLegacyMap;this.Z2b&&this.Z2b.tabs&&!this.Z2b.tabs[0].isOfficeTab&&d.Z("SDX.FeatureFlags","NonOfficeTab");this.xfc(Eh.J4(this.Yp),"ClickOnLaunch",d);this.C4d();this.Z2b?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Z2b,
()=>{const m=new ml;m.Yp=this.Yp;this.fd.raiseEvent(Ye.a.EGi,m)}):v.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}kWf(){this.xfc(Eh.J4(this.Yp),"ClickOnClose");this.C4d()}JWf(){this.xfc(Eh.J4(this.Yp),"ClickOnDismiss");this.C4d()}zUi(d){if(d&&(d=d.detail)&&d.id&&this.DJm(d.id)){const m=(d.action||"").toLowerCase();if(d.success&&"opened"===m)this.xfc(Eh.J4(this.Yp),"CampaignLaunched"),v.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),
this.C4d(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(I.a)(this,this.zUi,"onCampaignLaunchedHandler"),!0);else{let A;try{A=JSON.stringify(d),v.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+A)}catch(R){A="id : "+d.id+" telemetryEventName: "+d.telemetryEventName,v.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+A+" Error: "+(R?R.toString():""))}}}}DJm(d){d=sa.a.eh(d);return-1!==d.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==d.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==d.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==d.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==d.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==d.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}Kfe(d){if(this.appName){const m={},A={};A.LastTeachingUIShowTime=(new Date).toUTCString();A.AddinHasShown=d;m[this.appName]=rb.c(A);this.hsh.VNd(m);v.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else v.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}C4d(){if(!this.t8c){const d=window.g_roamingAddinList;d&&(this.Kfe(d),this.t8c=!0)}}h3a(d){d?this.Ugg(d)?(v.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.kkc="AddinHasShown"in d&&d.AddinHasShown?d.AddinHasShown.toString():null,this.hIh()):(v.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.GTa(this.efb,null)):(v.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.kkc=null,this.hIh())}Soa(d){v.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",d?d.Ne:-1);this.GTa(this.efb,null)}gIa(d){v.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",d?d.Ne:-1)}hIh(){const d=this.mnl();0===d.targetType?(d.solutionId?this.lMn(d):this.xfc(null,"NoSolutionId"),this.ZHj(d),this.GTa(this.efb,null)):this.GTa(this.efb,d);v.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",d.addinId)}lMn(d){const m=new Mi;m.callbackFunc=
A=>{if(A.errorCode){this.xfc(d.solutionId,"FailToGetAppDetails");var R=window.g_roamingAddinList;R&&this.Kfe(R)}else if(A.value)for(R of A.value)if(A=R[1],A===d.solutionId){const da={};da.solutionId=A;da.assetId=R[5];da.storeType=R[12];da.storeId=R[11];da.assetStoreId=R[6];da.targetType=R[3];da.width=R[7];da.height=R[8];da.displayName=R[0];da.version=R[4];v.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",d.solutionId);R=new zf(da);this.fd.raiseEvent(Ye.a.Awo,R);
break}};m.storeType=OSF.StoreTypeEnum.PrivateCatalog;m.fromInsertDialog=!1;m.refresh=!1;this.Et.queryEntitlementDetails(m)}Ugg(d){if("LastTeachingUIShowTime"in d){if(d=+new Date-+new Date(d.LastTeachingUIShowTime.toString()),d<n.AFrameworkApplication.K.zU("AddinShowTeachingUIIntervalInMS",864E5))return v.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",d),!1}else v.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}mnl(){let d=
new ig.a(new fh,0),m=new ig.a(new fh,0),A=0,R=0,da=0;var Ea=new U.a;for(var ib of this.efb)Ea.add(ib);for(let Qb of this.SCb)Ea.add(Qb);for(let Qb of Ea)if(!("excatalog"!==Qb.storeType||Yc.c(Qb.installTimeInMS)||!Qb.installTimeInMS||Qb.installTimeInMS<=n.AFrameworkApplication.K.zU("DateTimeInMSForNewAddin",16409952E5))){Ea=Eh.Z4h(Qb);if(this.kkc&&(ib=this.kkc.split(","),0<ib.length&&Array.contains(ib,Ea))){da++;v.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Ea.startsWith("private_")?
(d=Eh.Vbi(Qb,d),R++):(m=Eh.Vbi(Qb,m),A++)}v.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",R,A,da);return 0<m.value?m.key:0<d.value?d.key:Object.assign(new fh,{addinId:null,targetType:-1,solutionId:null})}xfc(d,m,A=null){d={["AppTeachingUICalloutAction"]:m,["SDX.Id"]:d,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(A)for(let R of A.keys)d[R]=A.J(R);ah.a.sendTelemetryEvent(Object.assign(new Bg.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sf.a.RH(d)}))}ZHj(d){d&&(window.g_roamingAddinList=this.kkc?this.kkc+","+d.addinId:d.addinId)}static J4(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static Vbi(d,m){return m.value<d.installTimeInMS?new ig.a(Object.assign(new fh,{addinId:Eh.Z4h(d),targetType:d.targetType,solutionId:d.solutionId}),d.installTimeInMS):m}static Z4h(d){return Telemetry.PrivacyRules.IsPrivateAddin(d.storeType,
d.assetId,null,null,d.storeId)?"private_"+d.installTimeInMS:d.solutionId}}Object(y.a)(Eh,"PrivateCatalogTeachingCalloutHandler",null,[]);class tl{constructor(d){this.MIe=null;this.N_g=d}get zKb(){return this.MIe}I2b(d,m=null){this.N_g.I2b(d,m);this.MIe=d}I8f(d){this.N_g.I8f(d)}Mmj(d){this.MIe=d}}Object(y.a)(tl,"RibbonExtensibilityManagerWithChangeDetection",null,[1185]);const Nh=()=>{const d=E.a.Cjb(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"4"===d},Uh=()=>E.a.Cjb(window.location.href.toLowerCase(),
"wdtpl"),ok=()=>{const d=E.a.Cjb(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"1"===d},pj=d=>{let m=null;switch(d){case 0:m="omex";break;case 1:m="spcatalog";break;case 2:m="spapp";break;case 3:m="filesystem";break;case 4:m="exchange";break;case 6:m="registry";break;case 7:m="inmemory";break;case 8:m="uploadfiledevcatalog";break;case 9:m="hardcodedpreinstall";break;case 10:m="excatalog";break;case 16:m="wopicatalog"}return m},Ek=d=>{let m=-1;switch(d.toLowerCase()){case "omex":m=
0;break;case "spcatalog":m=1;break;case "spapp":m=2;break;case "filesystem":m=3;break;case "exchange":m=4;break;case "registry":m=6;break;case "inmemory":m=7;break;case "uploadfiledevcatalog":m=8;break;case "hardcodedpreinstall":m=9;break;case "excatalog":m=10;break;case "wopicatalog":m=16}return m};class cj{I2b(d,m=null){if(d=Ic.nPc(d)){appChrome.addInApi.dispatchActionsToInstallAddIn(d,m);for(const A of d.tabs)if(A.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(d,()=>{});break}}}I8f(d){(d=
Ic.nPc(d))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(d)}Mmj(){}static npl(d,m,A=null){d=cj.Ecm(d);0<d.length&&(cj.$ge(d,!1),A&&A(m,d))}static Ecm(d){const m=[];if(d&&(d=d.Jya,d.IH&&0<d.IH.count))for(let A of d.IH)if(A.groups&&0<A.groups.length)for(const R of A.groups)if(R.controls&&0<R.controls.length)for(const da of R.controls)Array.add(m,da.id);return m}static $ge(d){if(d.length){var m=[];for(const A of d)m.push(appChrome.actions.updateControlEnabledDisabledState(A,!0));appChrome.api.dispatch(m)}}}
Object(y.a)(cj,"OneLineRibbonExtensibilityManager",null,[1185]);class Fi{constructor(){this.Ver=1}}Object(y.a)(Fi,"CacheItem",null,[]);class Yh{constructor(d){this.pT=d}}Object(y.a)(Yh,"AppsDataCacheManager",null,[1182]);var rj=c(1397);class Pm{constructor(){new Yh(rj.a.instance)}Gkj(d,m){d=Ye.a.y$h()+d;rj.a.instance.setItem(d,m.toString())}sam(){var d=Ye.a.Ifi();v.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",d);d=rj.a.instance.getItem(d);return rb.a(d)}dno(d){const m=Ye.a.Ifi();v.ULS.sendTraceTag(527523851,
306,50,"get cache key:{0}",m);rj.a.instance.setItem(m,rb.c(d))}LQm(){return!!rj.a.instance.localStorage}static get instance(){Pm._instance||(Pm._instance=new Pm);return Pm._instance}}Pm._instance=null;Object(y.a)(Pm,"AddInCommandsCacheManager",null,[1160]);var Fk=c(83);class Ll{static yai(d){const m=new U.a;if(Ll.NHh)for(var A of Ll.NHh)m.add(A);A=null;switch(d){case "Workbook":A=Ll.Z8o;break;case "Document":A=Ll.isl;break;case "Presentation":A=Ll.OHn}if(A)for(const R of A)m.add(R);return m}}Ll.NHh=
["PrimaryCommandSurface","ContextMenu"];Ll.Z8o=null;Ll.isl=null;Ll.OHn=null;Object(y.a)(Ll,"ExtensionPointType",null,[]);class rh{constructor(d){this.x9g=null;if(Yc.c(d))throw v.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.OVj=d}get T1c(){return this.x9g||(this.x9g=new U.a)}get Esh(){return this.OVj}}Object(y.a)(rh,"ContextMenuExtensibility",null,[1220]);class qp{constructor(d,m=null,A=0){if(Yc.c(d))throw v.ULS.sendTraceTag(9041814,
220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.jek=d;this.qlk=m;this.p4j=A}get Jya(){return this.jek}get startedNode(){return this.qlk}get gMl(){return this.p4j}}Object(y.a)(qp,"RibbonExtensibility",null,[1219]);class Hi{constructor(d){this.A2j=d.entitlement}get entitlement(){return this.A2j}createActionContext(d,m){d={};d.ownerAddinInfo=this.entitlement;d.action=m;return d}}Object(y.a)(Hi,
"AddInCommandsContextProvider",null,[]);class Gk{constructor(d,m,A){this.ALg=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=d;this.eventBuilder=m;this.contextMenuBuilder=A}get addinInfo(){return this.ALg}P$k(d){return new Hi(d)}createActionBuilder(d,m){return OfficeExt.DefaultControlActionBinder.createActionBuilder(d,m.entitlement,m.manifest)}startApplyAddin(d){this.ALg=d;const m=this.P$k(d);this.actionBuilder=this.createActionBuilder(m,
d)}endApplyAddin(){}Rnf(d,m,A=0){return this.ribbonBuilder.IH&&0<this.ribbonBuilder.IH.count?new qp(this.DLl(d,m),this.addinInfo.startedNode,A):null}g4h(){var d=null;if(this.contextMenuBuilder.X4d&&0<this.contextMenuBuilder.X4d.count){d||(d=this.addinInfo.entitlement.solutionId);d=new rh(d);for(let m of this.contextMenuBuilder.X4d)d.T1c.add(m);return d}return null}DLl(d,m){return this.ribbonBuilder.IH&&0<this.ribbonBuilder.IH.count?new Ic(this.ribbonBuilder.IH,d,m):null}}Object(y.a)(Gk,"AddinCommandsBuilder",
null,[]);class Xn{constructor(d,m,A,R,da,Ea,ib){this.ARb=new Fk.a;this.vF=d;this.Et=m;this.W3=A;this.ikc=R;this.maf=da;this.A7a=Ea;this.U2b=ib;this.nS=n.AFrameworkApplication.ta.Kq}a0m(d,m,A,R,da,Ea,ib){const Qb=(pc,Pc,gd,Cd)=>{da(pc,Pc,gd,Cd);pc=nf[this.vF]+Pc.assetId;({value:Pc}=this.ARb.Fc(pc)).returnValue&&(Pc.stop(),this.ARb.remove(pc))};if(0!==this.vF&&d){v.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",d.count);4===this.vF&&(v.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
R)),this.BYk(d,R),Ea());for(let pc of d)if(d=pc,v.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.vKj(d))if(ib&&d.requireConsent)ib(d,Pc=>{try{if(this.nS){const Cd=nf[this.vF]+Pc.solutionId,ae=this.nS.Yf("ComponentAttach",Cd);this.ARb.Z(Cd,ae)}const gd=this.A7a.H8b(Pc.storeType,Pc.solutionId);6!==this.vF&&(gd&&(this.DGd(gd),gd.jV.purge(!1)),
this.Et.insertOsfControl(this.B4c(Pc,m,A,Qb)),gd&&this.Et.ownerAddinControlRecreated(Pc.solutionId,Pc.storeType))}catch(gd){v.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(Pc.solutionId,Pc.ownerAddinStoreType||Pc.storeType,Pc.assetId,null,null,Pc.storeId),Pc.version,Pc.storeType,Pc.storeId,gd.message)),Qb(!1,Pc,null,null)}});else try{if(this.nS){const gd=
nf[this.vF]+d.solutionId,Cd=this.nS.Yf("ComponentAttach",gd);this.ARb.Z(gd,Cd)}const Pc=this.A7a.H8b(d.storeType,d.solutionId);!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==n.AFrameworkApplication.ta.Kb.xk&&1!==n.AFrameworkApplication.ta.Kb.xk&&2!==n.AFrameworkApplication.ta.Kb.xk||3!==this.vF||"excatalog"===d.storeType||!Pc||Pc.isUpgraded?6!==this.vF&&(Pc&&(this.DGd(Pc),Pc.jV.purge(!1)),this.Et.insertOsfControl(this.B4c(d,m,A,Qb)),
Pc&&this.Et.ownerAddinControlRecreated(d.solutionId,d.storeType)):(this.ikc.Mmj(Pc.VA),Qb(!0,d,null,Pc.displayName))}catch(Pc){v.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Pc.message)),Qb(!1,d,null,null)}else Qb(!1,
d,null,null)}}l0m(d,m,A,R,da,Ea){const ib=(Qb,pc,Pc,gd)=>{Ea(Qb,pc,Pc,gd);Qb=nf[this.vF]+pc.solutionId;({value:pc}=this.ARb.Fc(Qb)).returnValue&&(pc.stop(),this.ARb.remove(Qb))};if(6===this.vF&&d)if(v.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.vKj(d))try{if(this.nS){const pc=nf[this.vF]+d.solutionId,Pc=this.nS.Yf("ComponentAttach",
pc);this.ARb.Z(pc,Pc)}const Qb=this.A7a.H8b(d.storeType,d.solutionId);Qb||ib(!1,d,null,null);n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.jRh?this.K4h(d,m,R,da,A,pc=>{ib(pc,d,A,Qb.displayName)}):(this.K4h(d,m,R,da,A),ib(!0,d,A,Qb.displayName))}catch(Qb){v.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Qb.message)),ib(!1,d,null,null)}else ib(!1,d,null,null)}cln(d,m,A,R,da,Ea){if(Ea)if(Ea._isAddinCommandsManifest(this.W3.tY))try{n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.jRh?this.J4h(d,m,A,da,Ea,ib=>{R(ib,d,Ea,Ea.getDefaultDisplayName())}):(this.J4h(d,m,A,da,Ea),R(!0,d,Ea,Ea.getDefaultDisplayName()))}catch(ib){v.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,ib.message)),R(!1,d,Ea,Ea.getDefaultDisplayName())}else v.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,
d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),R(!1,d,null,null);else v.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.W3.tY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),R(!1,d,null,null)}B4c(d,m,A,R){const da={},Ea=document.createElement("div");Ea.setAttribute("visible",
"false");da.div=Ea;da.id=d.solutionId;da.solutionId=d.solutionId;da.version=d.version;da.storeType=d.storeType;da.storeId=d.storeId;da.assetId=d.assetId;da.assetStoreId=d.assetStoreId;da.isvirtualOsfControl=!0;da.virtualOsfControlActivationCallback=(ib,Qb)=>{const pc=this.A7a.H8b(d.storeType,d.solutionId);pc&&(pc.isUpgraded&&(d.isUpgraded=!0),this.DGd(pc));this.cln(d,m,A,R,ib,Qb)};da.reason=3===this.vF?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return da}J4h(d,m,A,R,da,Ea=null){const ib={};ib.solutionId=R.getSolutionId();ib.version=R.getVersion();ib.storeType=R.getStoreType();ib.storeId=R.getStoreId();ib.assetId=R.getAssetId();ib.assetStoreId=R.getAssetStoreId();ib.targetType=R.getOsfControlType();let Qb=null,pc=null;if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Qb=(new OfficeExt.Parser.AddinCommandsManifestParser(this.W3.tY,this.W3.formFactor)).parseExtensions(ib,
da,this.U2b),pc=Ll.yai(this.W3.tY);else try{Qb=(new OfficeExt.Parser.AddinCommandsManifestParser(this.W3.tY,this.W3.formFactor)).parseExtensions(ib,da,this.U2b),pc=Ll.yai(this.W3.tY)}catch(gd){throw v.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+gd.message),gd;}if(pc&&0<pc.count){if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Pc=m(d);m=A(d);A=!!n.AFrameworkApplication.K&&
n.AFrameworkApplication.K.$("AddinCommandsMultipleCustomTabsEnabled");Pc=new Gk(Pc,null,m);for(let gd of pc)Pc.commandSurface=gd,Qb.apply(Pc,this.U2b,A)}else try{let gd=m(d),Cd=A(d),ae=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("AddinCommandsMultipleCustomTabsEnabled");Pc=new Gk(gd,null,Cd);for(let Xd of pc)Pc.commandSurface=Xd,Qb.apply(Pc,this.U2b,ae)}catch(gd){throw v.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+gd.message),gd;}if(OSF.OUtil.checkFlight(14))try{let gd=
Pc.Rnf(d.solutionId,da.getDefaultDisplayName()),Cd=Pc.g4h();gd&&this.ikc.I2b(gd,Ea);Cd&&this.maf.Moh(Cd);this.A7a.xph(R,gd,Cd,da.getDefaultDisplayName());v.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",da.getDefaultDisplayName())}catch(gd){throw OfficeExt.DevConsole.log(gd),v.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+gd.message),gd;}else try{let gd=Pc.Rnf(d.solutionId,da.getDefaultDisplayName()),Cd=Pc.g4h();gd&&this.ikc.I2b(gd);Cd&&this.maf.Moh(Cd);
this.A7a.xph(R,gd,Cd,da.getDefaultDisplayName());v.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",da.getDefaultDisplayName())}catch(gd){throw v.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+gd.message),gd;}}}K4h(d,m,A,R,da,Ea=null){const ib={};ib.solutionId=d.solutionId;ib.version=d.version;ib.storeType=d.storeType;ib.storeId=d.storeId;ib.assetId=d.assetId;ib.assetStoreId=d.assetStoreId;ib.targetType=d.targetType;const Qb=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.W3.tY,
this.W3.formFactor);try{const pc=m.getManifest(),Pc=Qb.parse(ib,pc,da,this.U2b,m.getSharedRuntimeId(),m),gd=A(d),Cd=R(d),ae=new Gk(gd,null,Cd);ae.commandSurface="PrimaryCommandSurface";Pc.apply(ae,this.U2b,!0);if(ae.ribbonBuilder.IH&&0<ae.ribbonBuilder.IH.count){const Xd=ae.Rnf(d.solutionId,m.getManifest().getDefaultDisplayName(),1);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ikc.I2b(Xd,Ea):Xd&&this.ikc.I2b(Xd,Ea);
this.A7a.huk(m,Xd,da,m.getManifest().getDefaultDisplayName());v.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",m.getManifest().getDefaultDisplayName())}}catch(pc){v.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",m.getManifest().getDefaultDisplayName(),pc.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(pc)}}DGd(d){d.VA&&this.ikc.I8f(d.VA);d.eKc&&this.maf.B_n(d.eKc);this.A7a.XZn(d.jV.getStoreType(),d.jV.getSolutionId())}BYk(d,
m){m=pj(m);for(let A of this.A7a.Tbc){if(A.jV.getStoreType()!==m)continue;let R=!0;for(let da of d){const Ea=da;if(Ea&&A.NCi(Ea.storeType,Ea.solutionId)){R=!1;break}}R&&(this.DGd(A),A.jV.purge(!1))}}vKj(d){return!!d&&!!d.solutionId&&!!d.version&&!!d.storeType&&!!d.storeId}}Object(y.a)(Xn,"AddInCommandsIntegration",null,[]);class jk{constructor(d,m,A,R,da,Ea,ib,Qb=null){this.sa=new vb.a;this.yKa=d;this.S_j=m;this.Hj=A;this.Gkh=R;this.F_b=da;this.BVj=Ea;this.Sgd=ib;this.Xck=Qb}bxk(d){this.sa.addHandler(Ye.a.Zrh,
d)}Fxk(d){this.sa.addHandler(Ye.a.EGi,d)}Szk(d){this.sa.addHandler(Ye.a.isj,d)}ixk(d){this.sa.addHandler(Ye.a.Z3e,d)}D0m(d,m,A){const R=A[Ye.a.JCd],da=void 0===A[Ye.a.hOa]?0:A[Ye.a.hOa];if(R&&0!==da)if(0>=R.count&&4!==da)this.w3i(new el(da,null,null,m,null,!0));else{var Ea=R.count,ib=new tl(new cj),Qb=void 0===A[Ye.a.iOa]?-1:A[Ye.a.iOa],pc=new Xn(da,this.Hj,this.yKa,ib,this.S_j,this.F_b,this.Sgd),Pc=se=>this.Gkh.SOk(se.solutionId,this.Sgd,this.yKa,d),gd=se=>this.Gkh.NNk(se.solutionId),Cd=(se,Xe,Be)=>
{Ea--;Be=new el(da,Xe,ib,m,Be,0>=Ea);if(se&&Xe)this.w3i(Be);else{if(3===da||Xe&&Xe.isUpgraded)se="",Xe&&(se=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xe.solutionId,Xe.ownerAddinStoreType||Xe.storeType,Xe.assetId,null,null,Xe.storeId)),Xe={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:se},ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sf.a.RH(Xe)}));this.v3i(Be)}Ea||n.AFrameworkApplication.ta.updateCommandUI()},
ae=(se,Xe,Be,Hg)=>{Cd(se,Xe,Hg)},Xd=()=>{this.EUf();0>=R.count&&4===da&&this.F_b.Idg()};6===da?(Qb=A[Ye.a.Vtl],A=A[Ye.a.Wtl],pc.l0m(R.J(0),Qb,A,Pc,gd,(se,Xe,Be,Hg)=>{Cd(se,Xe,Hg)})):pc.a0m(R,Pc,gd,Qb,ae,Xd,this.Xck)}else ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sf.a.RH({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),v.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.yKa.tY)),this.v3i(new el(da,null,null,m,null,!0))}v3i(d){this.EUf(d);this.jtj(!1,d)}w3i(d){const m=d.Yp;let A=null;null!==m&&(A=m.storeType,A=A.toLowerCase());if(d&&"omex"===A&&(3===d.vF||m.isUpgraded)){var R={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(m.solutionId,m.ownerAddinStoreType||m.storeType,m.assetId,null,null,m.storeId)};ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Sf.a.RH(R)}))}this.EUf(d);R=ok()&&"omex"===A&&!!d.tza&&!!m.solutionId&&2===d.vF&&m.solutionId.toLowerCase()===Uh().toLowerCase();var da="excatalog"===A&&3===d.vF;if("omex"===A&&d.tza&&(3===d.vF&&"hardcodedpreinstall"!==A||m.isUpgraded)||R||da)R=new ml,R.Yp=m,R.VA=d.tza.zKb,this.sa.raiseEvent(Ye.a.Z3e,R);R=Nh();da=Uh();R&&m&&"excatalog"===m.storeType&&d.tza&&5===d.vF&&da&&(m.storeId&&m.storeId.toLowerCase()===da.toLowerCase()||m.assetId&&m.assetId.toLowerCase()===da.toLowerCase())&&(R=new ml,
R.Yp=m,R.VA=d.tza.zKb,this.sa.raiseEvent(Ye.a.Z3e,R),v.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));m&&(Pm.instance.Gkj(Ek(A),!0),"uploadfiledevcatalog"===A&&(R=this.BVj.createAddinDataProvider(A,this.Hj))&&R.localCacheAddinCommands(this.Hj.jTa,m.solutionId,m.version,m.storeId),Db.Fne(Ye.a.U0e,"true",Ek(A)));this.jtj(!0,d)}jtj(d,m){d?n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&m.tza&&5===
m.vF&&m.tza.zKb&&void 0!==m.Yp.showCallout&&null!==m.Yp.showCallout&&m.Yp.showCallout?((new Eh(this.sa)).YBd(m.Yp,Ic.nPc(m.tza.zKb)),d=new ml,d.VA=m.tza.zKb,d.Yp=m.Yp,this.sa.raiseEvent(Ye.a.isj,d)):3!==m.vF?m.$Fi&&this.F_b.Idg():m.tza&&m.tza.zKb&&"hardcodedpreinstall"!==m.Yp.storeType&&ad.Dwo(m.displayName,m.tza.zKb,m.Yp.isAutoLaunched):3===m.vF?m.Yp&&"uploadfiledevcatalog"===m.Yp.storeType.toLowerCase()?(m=this.Sgd.MXl(m.Yp.solutionId),ad.ohg(m?m:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.F_b.kjo():m.$Fi&&this.F_b.Idg()}EUf(d=null){var m=d?d.Yp:null;const A=new ml;if(A.Yp=m){var R=this.F_b.H8b(m.storeType,m.solutionId,6===d.vF?1:0);if(R&&R.VA){A.VA=R.VA;var da=Uh();da=ok()&&!!m.solutionId&&!!da&&m.solutionId.toLowerCase()===da.toLowerCase()&&2===d.vF;if(3===d.vF&&"hardcodedpreinstall"!==m.storeType||da)d="",R.VA.Jya&&R.VA.Jya.IH&&(R=R.VA.Jya.IH.J(0))&&(d=R.id),m={["SDX_CommandPlacement"]:d,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(m.solutionId,
m.ownerAddinStoreType||m.storeType,m.assetId,null,null,m.storeId)},ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sf.a.RH(m)}))}}this.sa.raiseEvent(Ye.a.Zrh,A)}}Object(y.a)(jk,"LaunchAddinCommandsHandler",null,[1287]);class Hd{constructor(d){this.wek=d}get jTa(){return this.wek}insertOsfControl(d){return this.jTa.insertOsfControl(d)}getManifestInvaildErrorString(){return this.jTa.getManifestInvaildErrorString()}isAddinCommandsAsync(d,m){this.jTa.isAddinCommandsAsync(d,
m)}isAddinCommandsExAsync(d,m){this.jTa.isAddinCommandsExAsync(d,m)}ownerAddinControlRecreated(d,m){this.jTa.ownerAddinControlRecreated(d,m)}queryEntitlementDetails(d){this.jTa.queryEntitlementDetails(d)}}Object(y.a)(Hd,"ContextActivationMgrWrapper",null,[1293]);class Ie{}Ie.$9a="Alt";Ie.mWa="Command";Ie.id="Id";Ie.e$a="Image16by16";Ie.f$a="LabelText";Ie.rWa="Title";Ie.bre="Groups";Ie.Dsb="Controls";Ie.button="Button";Ie.iFa="FlyoutAnchor";Object(y.a)(Ie,"AddinDataNodeConstants",null,[]);class Ok{constructor(d,
m){this.zYa=this.GQg=null;if(Yc.c(d)||Yc.c(m))throw v.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Axe=m;this._id=d;this.HX[Ie.id]=this._id}get id(){return this._id||""}get HX(){return this.GQg||(this.GQg={})}get controlType(){return this.Axe||""}get menuItems(){return this.zYa||(this.zYa=new U.a)}ncd(){let d=null;this.Axe===Ie.iFa?d=Object.assign(new va.a,{Menu:this.Rcn()}):
this.Axe===Ie.button&&(d=Object.assign(new wa.a,{}));d&&(this.HX[Ie.id]&&(d.ExternalId=this.HX[Ie.id]),this.HX[Ie.mWa]&&(d.Command=this.HX[Ie.mWa].toString()),this.HX[Ie.f$a]&&(d.LabelText=this.HX[Ie.f$a]),this.HX[Ie.$9a]&&(d.Alt=this.HX[Ie.$9a]),this.HX[Ie.e$a]&&(Xa.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.HX[Ie.e$a]),d.ExternalImageId=this._id));return d}Rcn(){const d=Object.assign(new ta.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.zYa){const m=
Object.assign(new fa.a,{ControlList:[]});for(let A of this.zYa)Array.add(m.ControlList,A.ncd());Array.add(d.MenuSectionList,m)}return d}}Object(y.a)(Ok,"ControlDefinition",null,[1290]);class Jj{constructor(d){this.yta=null;if(Yc.c(d))throw v.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=d;this.M0c[Ie.id]=this._id}get M0c(){return this.yta||(this.yta={})}get id(){return this._id||
""}ncd(){const d=Object.assign(new wa.a,{});this.yta[Ie.id]&&(d.ExternalId=this.yta[Ie.id]);this.yta[Ie.mWa]&&(d.Command=this.yta[Ie.mWa].toString());this.yta[Ie.f$a]&&(d.LabelText=this.yta[Ie.f$a]);this.yta[Ie.$9a]&&(d.Alt=this.yta[Ie.$9a]);this.yta[Ie.e$a]&&(Xa.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.yta[Ie.e$a]),d.ExternalImageId=this._id);return d}}Object(y.a)(Jj,"MenuItemDefinition",null,[1333]);class ee{constructor(d){this.fLa=null;if(Yc.c(d))throw v.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=d}get id(){return this._id}get controls(){return this.fLa||(this.fLa=new U.a)}ncd(){const d=[];if(this.fLa)for(let m of this.fLa){const A=m.ncd();A&&d.push(A)}return d}}Object(y.a)(ee,"OfficeMenuDefinition",null,[1288]);class md{constructor(d,m,A){this.R6=this.ZVb=null;this.DLe=d;this.EVb=m;this.qUb=A;this.Dbk=new U.a}get S5d(){return this.DLe}get uJc(){return this.EVb}get jZe(){return this.qUb}addButton(d){v.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",d.actionType);this.R6=new Ok(this.Ofb(d.id),Ie.button);this.R6.HX[Ie.f$a]=d.label;this.R6.HX[Ie.$9a]=d.label;this.R6.HX[Ie.e$a]=d.icon["16"];this.yHc(this.R6.HX[Ie.id],d.action);this.SAb(this.R6.HX);this.ZVb.controls.add(this.R6);this.R6=null}startBuildMenu(d){if(Yc.c(this.ZVb))this.ZVb=new ee(d.id);else{const m=this.Ofb(d.id);this.R6=new Ok(m,Ie.iFa);this.f4b(this.R6.HX,d);this.R6.HX[Ie.e$a]=d.icon["16"];this.R6.HX[Ie.mWa]=Q.a.Wma}}addMenuItem(d){v.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",d.actionType);const m=new Jj(this.Ofb(d.id));this.f4b(m.M0c,d);d.icon&&(m.M0c[Ie.e$a]=d.icon["16"]);this.yHc(m.M0c[Ie.id],d.action);this.SAb(m.M0c);this.R6.menuItems.add(m)}endBuildMenu(){Yc.c(this.R6)?(this.X4d.add(this.ZVb),this.ZVb=null):(this.ZVb.controls.add(this.R6),this.R6=null)}get X4d(){return this.Dbk}yHc(d,m){this.jZe.bindAction(d,m)}SAb(d){this.uJc.SAb(d)}Ofb(d){return this.S5d.I9b(d)}f4b(d,m){d[Ie.f$a]=m.label;d[Ie.$9a]=m.label}}Object(y.a)(md,
"ContextMenuExtensibilityCreator",null,[1318,1314]);class nl{constructor(d){this.Tzc=d}get k1c(){return this.Tzc}I9b(d){return this.k1c+d}}Object(y.a)(nl,"DefaultContextMenuNamingProvider",null,[1317]);class gf{constructor(d,m,A,R){this.Tzc=d;n.AFrameworkApplication.K.$("AddInCommandsMissingTabIsEnabled")&&A.j5l();this.Ehh=m;this.ckk=R}get k1c(){return this.Tzc}get solutionId(){return this.Ehh}get Egg(){return this.ckk}I9b(d){d=this.k1c+this.solutionId+d;return this.Egg?(d in gf.MCd||(gf.MCd[d]="AddinControl"+
gf.oAk++),gf.MCd[d]):d}UPh(d){if(this.Egg){const A=gf.MCd;for(let R in A){var m=R;if(d===A[R])return m.substr(this.k1c.length+this.solutionId.length)}}return d}Sgm(d){d=this.k1c+this.solutionId+d;return this.Egg?(d in gf.e1e||(gf.e1e[d]="AddinTab"+gf.xAk++),gf.e1e[d]):d}}gf.MCd={};gf.e1e={};gf.xAk=0;gf.oAk=0;Object(y.a)(gf,"DefaultRibbonNamingProvider",null,[1289]);class yh{bindAction(d,m){OfficeExt.DefaultControlActionBinder.bindAction(d,m)}}Object(y.a)(yh,"DefaultUIControlActionBinder",null,[1316]);
class Ef{constructor(d){this.Etb=d}get command(){return this.Etb}SAb(d){d[Ie.mWa]=this.command}}Object(y.a)(Ef,"DefaultUIControlCommandBinder",null,[1315]);var vi=c(48);class Ml{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(y.a)(Ml,"AddInControl",null,[]);class kk{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(y.a)(kk,"AddInGroup",null,[]);class am{constructor(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(y.a)(am,"AddInMenuItem",null,[]);class Wh{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(y.a)(Wh,"AddInTab",null,[]);class Wg{constructor(d,m,A,R,da,Ea){this.Ngd=new U.a;this.xtc=this.YWa=this.cWb=null;this.DLe=d;this.qUb=m;this.EVb=A;this.Ehh=R;this.Sgd=da;this.eVg=Ea}get S5d(){return this.DLe}get IH(){return this.Ngd}get jZe(){return this.qUb}get uJc(){return this.EVb}startBuildTab(d){const m=
d.isOfficeTab?d.id:this.S5d.Sgm(d.id),A=d.isOfficeTab?null:d.label;this.cWb=Object.assign(new Wh,{id:m,title:A,isOfficeTab:d.isOfficeTab,visible:d.visible,groups:[],tabType:d.tabType,insertBefore:d.insertBefore,insertAfter:d.insertAfter,autoFocus:d.autoFocus})}startBuildGroup(d){const m=this.Ofb(d.id);this.YWa=Object.assign(new kk,{id:m,mlrId:d.mlrId,title:d.label,controls:[],groupType:0})}addNativeGroup(d){this.YWa=Object.assign(new kk,{id:d.id,mlrId:d.mlrId,title:d.label,controls:[],groupType:1});
this.cWb.groups.push(this.YWa)}addButton(d){const m=this.Ofb(d.id);m&&(this.yHc(m,d.action),v.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",d.actionType),d=Object.assign(new Ml,{id:m,title:d.label,iconLocation:this.Srf(d),enabled:d.enabled,controlType:0,attributes:this.f4b()}),this.eVg.koh(new vi.a(m,this.uJc.command.toString())),this.YWa.controls.push(d))}addNativeControl(d){d.id&&(v.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
d.actionType),d=Object.assign(new Ml,{id:d.id,title:"",iconLocation:"",enabled:d.enabled,controlType:2,attributes:this.f4b()}),this.YWa.controls.push(d))}startBuildMenu(d){const m=this.Ofb(d.id);m&&(this.xtc=Object.assign(new Ml,{id:m,title:d.label,iconLocation:this.Srf(d),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(d){const m=this.Ofb(d.id);m&&(this.yHc(m,d.action),v.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",d.actionType),d=Object.assign(new am,
{id:m,title:d.label,iconLocation:this.Srf(d),enabled:d.enabled,attributes:this.f4b()}),this.eVg.koh(new vi.a(m,this.uJc.command.toString())),this.xtc.menuItems.push(d))}endBuildMenu(){Yc.c(this.xtc.id)||this.YWa.controls.push(this.xtc);this.xtc=null}endBuildGroup(){Yc.c(this.YWa.id)||this.cWb.groups.push(this.YWa);this.YWa=null}endBuildTab(){Yc.c(this.cWb.id)||this.Ngd.add(this.cWb);this.cWb=null}f4b(){const d={};this.SAb(d);return d}Srf(d){return d.icon["80"]?d.icon["80"]:d.icon["32"]}SAb(d){this.uJc.SAb(d)}Ofb(d){return this.S5d.I9b(d)}yHc(d,
m){this.jZe.bindAction(d,m)}}Object(y.a)(Wg,"OneLineRibbonExtensibilityCreator",null,[1313,1314]);class jg{constructor(d,m){this.Tzc=d;this.qUb=new yh;this.EVb=new Ef(m)}NNk(d){d=new nl(d);return new md(d,this.EVb,this.qUb)}SOk(d,m,A,R){A=new gf(this.Tzc,d,A,!0);return new Wg(A,this.qUb,this.EVb,d,m,R)}}Object(y.a)(jg,"UIExtensibilityFactory",null,[1285]);class Lh{createAddinDataProvider(d,m){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(d,m.jTa)}static get instance(){Lh._instance||
(Lh._instance=new Lh);return Lh._instance}}Lh._instance=null;Object(y.a)(Lh,"OSFAddinDataProviderFactory",null,[1286]);class je{constructor(){this.V2b=null}setErrorMessageForAddin(d,m){this.V2b||(this.V2b={});this.V2b[d]=m}MXl(d){return this.V2b&&d in this.V2b?this.V2b[d]:null}}Object(y.a)(je,"AddinCommandsErrorManager",null,[]);class oh{constructor(){this.Xca=0;this.YHc=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.kpi=!1;this.gxm=this.$na=null}}Object(y.a)(oh,"AddInCommandsNotificationParameters",
null,[]);class Rd{constructor(){this.UMg=this.Mse=null}get kZe(){return this.Mse||(this.Mse=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set kZe(d){this.Mse=d}get HJk(){return this.UMg||(this.UMg=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(d,m){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(d,m)}aom(d,m,A,R,da){v.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",d);
if((d=m.H8b(da.ownerAddinInfo.storeType,da.ownerAddinInfo.solutionId))&&d.jV&&!d.jV.getIsUpgrading())if(m=null,0<d.jV.getNotificationParams().length&&(m=this.Azh(d.jV.getNotificationParams()[0]))&&2147758681===m.errorCode&&(d.isUpgraded=!0),2!==d.jV.getStatus()&&(1!==d.jV.getStatus()||m&&2147758681===m.errorCode))m&&this.esj(d,m,null);else try{A.setOwnerAddinEToken(d.jV.getEToken()),da.action(A,R.jTa)}catch(Ea){v.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",
n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ea.stack:Ea.message)),ad.ohg(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}esj(d,m,A=null){const R=d.jV;if(1===R.getNotificationParams().length||m.kpi){const da=m.YHc,Ea=m.$na;m.YHc=()=>{R.removeFirstNotification();if(0<R.getNotificationParams().length){const ib=this.Azh(R.getNotificationParams()[0]);this.esj(d,ib)}2147758681===m.errorCode&&(cj.npl(d.VA,R,Object(I.a)(this,
this.Vri,"initUpgradeStateDetectTask")),Ud.apl(d.eKc,R,Object(I.a)(this,this.Vri,"initUpgradeStateDetectTask")));da&&da()};m.$na=()=>{Ea&&Ea();A&&A()};ad.pwo(m)}}Vri(d,m){let A=null;A=()=>{d.getIsUpgrading()?window.setTimeout(A,1E3):d.getUpgradingFailed()?cj.$ge(m,!0):n.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(A,1E3)}Azh(d){const m=new oh;m.Xca=d.infoType;m.id=d.id;m.title=d.title;m.description=d.description;m.buttonText=d.buttonTxt;m.YHc=d.buttonCallback;m.kpi=d.highPriority;
m.$na=d.dismissCallback;m.errorCode=d.errorCode;m.gxm=d.iframeNotificationUrl;return m}}Object(y.a)(Rd,"AddinCommandsActionHandler",null,[1284]);var Ii=c(629);class Lf{constructor(){this.vF=this.X6a=0;this.V0e=null;this.cbe=this.Tme=0;this.hab=this.oCe=this.ite=null}get LCd(){this.ite||(this.ite=new U.a);return this.ite}get wnf(){this.oCe||(this.oCe=new U.a);return this.oCe}get SCb(){this.hab||(this.hab=new U.a);return this.hab}}Object(y.a)(Lf,"AddinCommandsListLoaderContext",null,[]);class ag{constructor(d,
m){this.entitlement=d;this.metadata=m}Xnc(){var d=this.entitlement;const m={};m.solutionId=d.solutionId;m.version=d.version;m.storeType=d.storeType;m.storeId=d.storeId;m.assetId=d.assetId;m.assetStoreId=d.assetStoreId;m.targetType=d.targetType;m.requireConsent=d.requireConsent||!1;m.isAddinCommands=!0;m.addinCommandsActionType=0;m.targetType=this.targetType;return m}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(y.a)(ag,"AddinEntitlementEx",null,[]);class xn extends Sys.EventArgs{constructor(d){super();this.properties=d}}Object(y.a)(xn,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Zj{constructor(d,m,A){this.fd=new vb.a;this.context=
new Lf;this.BVe=null;this.contextActivationMgr=d;this.pAk=m;this.KCd=A;this.appName=n.AFrameworkApplication.K.kb("WebAppShortName")}get Uyj(){this.BVe||(this.BVe=new Eh(this.fd));return this.BVe}axk(d){this.fd.addHandler(Ye.a.Yrh,d)}iRo(d){null!==d&&(this.context.X6a=d[Ye.a.iOa],this.context.vF=d[Ye.a.hOa],this.context.Tme=this.context.cbe=0,d=Ye.a.Y2b in d?d[Ye.a.Y2b]:0,-1!==this.context.X6a&&0!==this.context.vF&&(this.context.V0e=this.pAk.createAddinDataProvider(pj(this.context.X6a),this.contextActivationMgr),
this.context.V0e?this.context.V0e.getEntitlementsAsync(this.contextActivationMgr.jTa,!0,d,m=>{this.grn(m)}):v.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.X6a)))}grn(d){if(d&&0<d.length){this.context.Tme=d.length;const A=n.AFrameworkApplication.K.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Uh():null;for(let R=0;R<d.length;R++){const da=d[R];if(n.AFrameworkApplication.K.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&
ok()&&da&&da.storeType&&"omex"===da.storeType.toLowerCase()&&da.assetId&&A&&da.assetId.toLowerCase()===A.toLowerCase()){var m={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Zj.J4(da)};ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Sf.a.RH(m)}))}!da||1!==da.targetType&&-1!==da.targetType?this.rVf():(m={},n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?
(m.solutionId=da.solutionId,m.version=da.version):(m.marketplaceId=da.solutionId,m.marketplaceVersion=da.version),m.storeType=da.storeType,m.storeId=da.storeId,m.targetData=da,this.contextActivationMgr.isAddinCommandsExAsync(m,Object(I.a)(this,this.Lqn,"onIsAddinCommandsExCompleted")))}}else this.rVf()}rVf(){var d;(d=this.context).cbe=d.cbe+1;this.context.cbe>=this.context.Tme&&(this.KCd.Gkj(this.context.X6a,!1),0<this.context.Tme&&10===this.context.X6a&&("Excel"===this.appName||"PowerPoint"===this.appName||
"Word"===this.appName)?(d=!1,Nh()&&(d=this.y5m(this.context.wnf)),this.G4m(this.context.wnf),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!d?this.Uyj.HVa(this.contextActivationMgr,this.context.LCd,this.context.SCb,(m,A)=>{const R=new U.a;for(let da of m)m=da.Xnc(),A&&A.solutionId===da.solutionId&&(m.showCallout=!0,this.Uyj.ZHj(A)),R.add(m);this.GTa(R)}):this.GTa(this.gIh(this.context.LCd))):this.GTa(this.gIh(this.context.LCd)))}gIh(d){const m=
new U.a;if(d)for(let A of d)m.add(A.Xnc());return m}GTa(d){d&&d.count||Db.Fne(Ye.a.U0e,"false",this.context.X6a);d={["ack2"]:d};d[Ye.a.iOa]=this.context.X6a;d[Ye.a.hOa]=this.context.vF;this.fd.raiseEvent(Ye.a.Yrh,new xn(d),this)}y5m(d){let m=!1;if(d&&1>d.count)return m;const A=Uh();if(!A)return m;for(let R of d)if(R.storeId&&R.storeId.toLowerCase()===A.toLowerCase()||R.assetId&&R.assetId.toLowerCase()===A.toLowerCase())d={["SDX_Id"]:Zj.Hfi(R),["SDX_TargetType"]:Yc.c(R.targetType)?"":R.targetType.toString()},
ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Sf.a.RH(d)})),m=!0;return m}G4m(d){if(!(d&&1>d.count))if(this.KCd.LQm()){var m=this.KCd.sam();m?(d=this.G8h(d,m),v.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(d=this.G8h(d,null),v.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.KCd.dno(d)}else v.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}G8h(d,m){const A={};let R=!1;for(let da of d)if(d=
Zj.Hfi(da))!m||d in m||(this.WB(da,d),v.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===d.toLowerCase()?R||(R=!0,A[d]=null):A[d]=null;return A}WB(d,m){var A=d.installTimeInMS?(new Date(d.installTimeInMS)).toISOString():"";A={["SDX.Id"]:m,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Yc.c(d.targetType)?"":d.targetType.toString(),["SDX.AdminDeploymentTime"]:A};ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Sf.a.RH(A)}));1===d.targetType&&(d={["SDX.Id"]:m,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Sf.a.RH(d)})))}Lqn(d,m,A,R){d?(d=new ag(A.targetData,R),m&&this.context.LCd.add(d),10===this.context.X6a&&(this.context.wnf.add(d),0===d.targetType&&this.context.SCb.add(d))):(m=A.targetData,v.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(m.solutionId,m.storeType,m.assetId,null,null,m.storeId),m.storeType));this.rVf()}static J4(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static Hfi(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}}Object(y.a)(Zj,"AddInCommandsListLoader",null,[]);var dk;(function(d){d[d.inactive=0]="inactive";d[d.background=1]="background"})(dk||
(dk={}));Object(y.b)("AppBackgroundState",dk);var Qe=c(8),pk=c(18),io=c(78),Oh=c(111);class Zg{}Zg.text=1;Zg.image=2;Zg.table=4;Object(y.a)(Zg,"ContentCatagory",null,[]);class yg{}Object(y.a)(yg,"AddinCommandsHost",null,[]);class Nn extends oa.a{constructor(){super(void 0,void 0,void 0,!0);this.luc="AddinCommandsUILessDialog";this.pWe="WACDialogTitleText";this.Dsa="0";this.UZ=380;this.qW=190;this.zg=this.luc;this.Cd=5;this.v_j=String.format("{0}px",this.UZ);this.Csa=String.format("{0}px",this.qW);
this.tni=this.Kt=!1;this.iS()}iS(){super.iS();this.hq.style.width=this.v_j;this.hq.style.height=this.Csa;this.hq.style.padding=this.Dsa}yUa(d){this.LL();document.getElementById(this.rj(this.pWe)).innerText=d}LL(){super.LL();this.Kc.style.width=String.format("{0}px",this.UZ);this.Kc.style.height=String.format("{0}px",this.qW);this.Kc.removeAttribute(zb.a.uh);this.Kc.removeAttribute(zb.a.Bga)}hide(){this.UWd()}get qhb(){return this.hq}initializeAndShowWithTitle(){this.Uh(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(y.a)(Nn,"AddinCommandsUILessDialog",oa.a,[1294]);class rf extends yg{constructor(d,m){super();this.ii=d;this.Ctd=m}setOwnerAddinEToken(d){this.Ctd.eToken=d}showTaskpane(d,m,A){v.ULS.sendTraceTag(19507426,220,50,"ShowTaskpane action called.");m=this.uOk(d,this.Ctd,m);m.addinCommandsActionType=2;this.ii.GIb(m);(d=this.ii.PPa(d.solutionId))?(A(d,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess),n.AFrameworkApplication.K.isChangeGateEnabled("TelemetryForActiveAddinSuccessOnWordWacEnabled")&&
v.ULS.sendTraceTag(526410901,220,50,"ShowTaskpane: succeed to call.")):(v.ULS.sendTraceTag(19507427,220,10,"ShowTaskpane: instance id is null."),A(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}showDialog(){}createUILessSandbox(d,m,A){v.ULS.sendTraceTag(19509248,220,50,"UILess action called.");var R=d.solutionId,da=this.Ctd.solutionId;const Ea=this.getSharedRuntimeId(m,!0,R,da);R=Ea?da:R;da=this.ii.PPa(R);da||(d=this.xNk(d,this.Ctd),d.addinCommandsActionType=3,d.isForUILessAction=!0,
d.sharedRuntimeId=Ea,d.solutionId=R,m=m.getDefaultDisplayName(),rf.C1b.Z(d.id,new Nn),d.div=rf.C1b.J(d.id).qhb,this.ii.createUILessSandbox(R,m,d),da=this.ii.PPa(R));da?A(da,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(v.ULS.sendTraceTag(19509249,220,10,"UILess: instance id is null."),A(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}disposeHost(){}uOk(d,m,A){const R={};R.solutionId=d.solutionId;R.version=d.version;R.storeType=d.storeType;R.storeId=d.storeId;R.assetId=d.assetId;R.assetStoreId=
d.assetStoreId;R.targetType=OSF.OsfControlTarget.TaskPane;R.displayName=A.getDefaultDisplayName();R.ownerAddinSolutionId=m.solutionId;R.ownerAddinStoreType=m.storeType;R.isAddinCommands=!0;R.sharedRuntimeId=this.getSharedRuntimeId(A,!1,d.solutionId,m.solutionId);n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring")&&R.sharedRuntimeId&&(R.solutionId=R.ownerAddinSolutionId,R.storeType=R.ownerAddinStoreType);return R}getSharedRuntimeId(d,m,A,
R){if(!d)return null;const da=Ia.a.instance.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider");if(!da)return null;if(m)return d.getSharedRuntimeId(da.tY,m,null);A=(new gf("",R,da,!0)).UPh(A.substr(R.length));return d.getSharedRuntimeId(da.tY,m,A)}xNk(d,m){var A=Rh.a.create().toString();A=new ki.a(A,d.solutionId,d.version,d.storeId,d.storeType,{});A.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;A.osfControlType=OSF.OsfControlTarget.TaskPane;A.assetId=d.assetId;A.assetStoreId=
d.assetStoreId;A.ownerAddinSolutionId=m.solutionId;A.ownerAddinStoreType=m.storeType;A.isAddinCommands=!0;return A}static hJa(d){rf.C1b.nb(d)&&rf.C1b.J(d).initializeAndShowWithTitle()}static YFa(d){rf.C1b.nb(d)&&rf.C1b.J(d).hide()}}rf.C1b=new Fk.a;Object(y.a)(rf,"Box4AddInCommandsHost",yg,[]);class ge{constructor(d){this.hBb=this.zba=this.Yp=this.VA=null;this.wbj=this.l8f=0;this.Ysb=this.appName=null;this.gIa=m=>{v.ULS.sendTraceTag(523319329,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
m?m.Ne:-1)};this.k_e=d;this.appName=n.AFrameworkApplication.K.kb("WebAppShortName")||"Word"}static GetPrivacyCompliantId(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}Wqn(){this.Yp&&this.hBb&&(this.k_e.XVd({["SourceControlId"]:this.hBb}),v.ULS.sendTraceTag(529110620,220,50,"Launch addin command has been triggered"))}rhg(d,m){d=null;m?(d=m,this.Yp=d.Yp,(this.VA=d.VA)&&this.VA.Jya&&this.VA.Jya.IH&&(this.zba=this.VA.Jya.IH.J(0)),this.zba&&
this.zba.id?this.zba.isOfficeTab?(m=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),d=this.Yp.solutionId,d in m?this.hBb=m[d]:(v.ULS.sendTraceTag(529110622,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",ge.GetPrivacyCompliantId(this.Yp)),this.hBb=this.iof(this.VA)),this.hBb?"TabHome"===this.zba.id?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ic.nPc(this.VA),()=>{this.Dje(this.e3a(this.hBb))}):n.AFrameworkApplication.va.qa(Q.a.nVa,
ic.a.application,Object(I.a)(this,this.nVa,"tabSwitch2")):(this.WB("NoEnabledButtonFound"),v.ULS.sendTraceTag(529110623,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.Ofc())):this.Htj(this.e3a(this.zba.id),0):(this.WB("NoTabFound"),v.ULS.sendTraceTag(529110621,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.Ofc())):this.Ofc()}nVa(d,m,A,R,da){this.zba.id.includes(da.NewContextId)&&(n.AFrameworkApplication.va.Vv(Q.a.nVa,ic.a.application,
Object(I.a)(this,this.nVa,"tabSwitch2")),this.pEh(da.NewContextId,n.AFrameworkApplication.K.nc("AddinMaxTabSwitchDetectionTimesForTeachingUI",10)));return 32}pEh(d,m){if(0>=m)this.WB("TabSwitchTimeOut");else{var A=document.querySelector("button"+this.e3a(d));A.hasAttribute("aria-selected")&&"false"!==A.getAttribute("aria-selected")?(window.clearTimeout(this.wbj),this.Dje(this.e3a(this.hBb))):this.wbj=window.setTimeout(()=>{this.pEh(d,m-1)},1E3)}}e3a(d){return"[id="+d+"]"}Htj(d,m){m>n.AFrameworkApplication.K.nc("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.l8f),this.wad("[data-unique-id='pivotOverflowButton']"),v.ULS.sendTraceTag(529110624,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time")):document.querySelector("button"+d)?(window.clearTimeout(this.l8f),this.wad(d)):this.l8f=window.setTimeout(()=>{this.Htj(d,m+1)},1E3)}Dje(d){let m=document.querySelector("button[data-unique-id='RightPaddle']");if(m)this.WB("RightPaddlePresent");else if(m=document.querySelector("button"+d),!m||"none"===window.getComputedStyle(m).display)if(m=
document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!m){this.WB("NoAnchor");v.ULS.sendTraceTag(529110625,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.Ofc();return}this.Orb(m,"ShowTeachingUIForAddinButton")}wad(d){let m=document.querySelector("button"+d);if(!m&&("[data-unique-id='pivotOverflowButton']"!==d&&(m=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!m)){this.WB("NoAnchor");v.ULS.sendTraceTag(529110626,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");
this.Ofc();return}this.Orb(m,"ShowTeachingUIForAddinTab")}Orb(d,m){d.setAttribute("lpp-id","latestAddin");const A=Ia.a.instance.Sa("Common.ISystemInitiatedFeedback");A&&d?(A.execute(R=>{R.logActivity(m,null)}),this.WB("Show"),v.ULS.sendTraceTag(529110656,220,50,"triggerLPPActivity triggered an LPP activity")):(this.WB("NoSifFutureObject"),v.ULS.sendTraceTag(529110627,220,15,"triggerLPPActivity failed to get a sifFuture"),this.Ofc())}iof(d){if(!d)return null;if((d=d.Jya)&&d.IH&&0<d.IH.count)for(const m of d.IH)if(m.groups&&
0<m.groups.length)for(const A of m.groups)if(A.controls&&0<A.controls.length)for(const R of A.controls){if(R.attributes&&!R.controlType&&R.enabled)return R.id;if(R.menuItems)for(const da of R.menuItems)if(da.attributes&&da.enabled)return R.id}return null}WB(d){ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:[{name:"AppTeachingUICalloutAction",string:d},{name:"SDX.Id",string:ge.GetPrivacyCompliantId(this.Yp)},{name:"AppTeachingUICalloutGoal",
string:"NewAdminDeployment"},{name:"SDX.AppInstallOrigin",string:"Organization"}]}))}Kfe(d){const m={},A={};A.LastTeachingUIShowTime=(new Date).toUTCString();A.AddinHasShown=d;m[this.appName]=rb.c(A);this.Ysb=new mg(this.appName,null,null,this.gIa),this.Ysb.VNd(m),v.ULS.sendTraceTag(523319328,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Ofc(){this.Kfe(window.g_roamingAddinList)}}Object(y.a)(ge,"AddinTeachingCalloutHandler",null,[]);
var bh=c(1433),lj;(function(d){d[d.realtime=0]="realtime";d[d.aboveNormal=1]="aboveNormal";d[d.normal=2]="normal";d[d.background=3]="background";d[d.low=4]="low";d[d.onIdle=5]="onIdle";d[d.lastPriority=6]="lastPriority";d[d.customized=7]="customized"})(lj||(lj={}));Object(y.b)("TaskItemPriority",lj);var ol;(function(d){d[d.oneShot=1]="oneShot";d[d.continuous=2]="continuous"})(ol||(ol={}));Object(y.b)("TaskItemType",ol);class Pf{constructor(d,m,A,R,da,Ea,ib,Qb=null){this.vxe=d;this.Hj=m;this.wWa=A;
this.yKa=R;this.rik=da;this.ii=Ea;this.rl=Qb;this.ii&&this.ii.vyk(this.iZk.bind(this))}sNk(d,m,A){if(d){switch(this.pem(m,A)){case Zg.text:m="ContextMenuText";break;case Zg.image:m="ContextMenuImage";break;default:return}(m=this.vxe.ONk(m))&&d.push(m)}}QTh(d){let m;switch(d){case 22:var A=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;m=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:A=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;m=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;
break;default:return}A=new X.a(A,m,null);A.id=d;A.image=1;A.closeable=!0;n.AFrameworkApplication.ta.Kb.Vma(A,!0)||v.ULS.sendTraceTag(36790731,306,10,"Failed to add entry to business bar. Addin disabled message could not be shown to user.")}Xcd(){this.XIm()?Ia.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(d=>{d.isFeatureEnabled("ConnectedServices",!0).then(()=>{this.HVa()})}):v.ULS.sendTraceTag(509678945,341,50,"Callout is not allowed to show for current user and document.")}HVa(){const d=
new Cg(this.Hj.value);d.Gxk(()=>{this.MKf()});d.HVa()}XIm(){return!n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&n.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&n.AFrameworkApplication.oOa}MKf(){const d=document.getElementById("InsertAddInFlyout");if(null==d||void 0===d||"none"===window.getComputedStyle(d).display){const m=document.getElementById("RibbonOverflowMenu-overflow");null!=m&&(m.onclick=function(){const A=new $a.a(lj.realtime,ol.oneShot,500,()=>
{const R=document.getElementsByName("Add-ins")[0];null!=R&&(R.click(),v.ULS.sendTraceTag(509678944,341,50,"Launch flyout in overflow"))});n.AFrameworkApplication.lc.Wb(A);m.onclick=function(){}},m.click())}else d.click(),v.ULS.sendTraceTag(509678943,341,50,"Launch flyout in ribbon button")}LKb(d){v.ULS.sendTraceTag(19507423,220,50,"LaunchAddInCommands log: {0}",{["HostType"]:this.yKa.tY,["LaunchOperationType"]:d[Ye.a.hOa]});if(n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")||!n.AFrameworkApplication.oOa){var m=
d[Ye.a.JCd];if(m&&0<m.count){const da=m.count;for(let Ea=da-1;0<=Ea;Ea--){const ib=m.J(Ea);OSF.OsfControl.isFirstPartyStoreString(ib.storeType)||m.remove(m.J(Ea))}m.count<da&&n.AFrameworkApplication.ta&&(n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&!n.AFrameworkApplication.ta.Kb.EY(22)&&this.QTh(22),n.AFrameworkApplication.oOa||n.AFrameworkApplication.ta.Kb.EY(36)||this.QTh(36));if(!m.count)return}}let A=null;if(n.AFrameworkApplication.K.$("HostInstallAddInsIsEnabled")){const da=
this;A=new jk(this.yKa,this.vxe,new Hd(this.Hj.value),new jg("",Q.a.B2b),this.wWa,Lh.instance,new je,(Ea,ib)=>{const Qb=new ki.a(Rh.a.create().toString(),Ea.solutionId,Ea.version,Ea.storeId,Ea.storeType,null);Qb.assetId=Ea.assetId;Qb.assetStoreId=Ea.assetStoreId;Qb.osfControlType=1;da.ii.Jtj(Qb,()=>{ib(Ea)})})}else A=new jk(this.yKa,this.vxe,new Hd(this.Hj.value),new jg("",Q.a.B2b),this.wWa,Lh.instance,new je);A.ixk(this.Xln.bind(this));A.bxk(this.Xqn.bind(this));n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&(m=new ge(this),A.Fxk(m.Wqn.bind(m)),A.Szk(m.rhg.bind(m)));const R=this;this.rik.continueWith(()=>{try{db.a.get_instance().pk(10,null).continueWith(()=>{A.D0m(R.rl,sf.StaticActiveAppFrame.za().Eoa(),d)},3)}catch(da){v.ULS.sendTraceTag(19507424,220,10,"LaunchAddInCommands failure log: {0}",{["HostType"]:R.yKa.tY,["ExceptionMessage"]:da.message})}},11)}Xln(d,m){m?m?ok()||Nh()?(d=Ia.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper"))?d.zDf(()=>{Ia.a.instance.Sa("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(A=>
{A.HQd(m.Yp.solutionId)?this.Gtg(m):v.ULS.sendTraceTag(512274763,220,15,"No ref for current add-in.")})}):v.ULS.sendTraceTag(512274764,220,15,"initializeHelper isn't ready."):this.Gtg(m):v.ULS.sendTraceTag(528544852,220,15,"agaveParams is null"):v.ULS.sendTraceTag(529110619,220,15,"No args for OnAutoLaunchAddin event")}Xnm(d){var m=null;d&&(m=d[this.yKa.VJh]);if(m){if(d=(new Rd).kZe(m))return n.AFrameworkApplication.oOa||OSF.OsfControl.isFirstPartyStoreString(d.ownerAddinInfo.storeType);m='Failed to look up ActionContext for buttonId "'+
m+'" in HandleAddInCommandsActionEnabled.'}else m="Failed to retrieve required buttonId property in HandleAddInCommandsActionEnabled.";v.ULS.sendTraceTag(561816859,306,10,m);return n.AFrameworkApplication.oOa}XVd(d){let m=null;d&&(m=d[this.yKa.VJh]);m?(d=new Rd,this.vyf(d,m)):v.ULS.sendTraceTag(561816861,306,10,"Failed to retrieve required buttonId property in HandleAddInCommandsAction.")}vyf(d,m){const A=d.kZe(m);if(A){const R=new rf(this.ii,A.ownerAddinInfo);d.aom(m,this.wWa,R,new Hd(this.Hj.value),
A);bh.b.hqc()&&A.ownerAddinInfo&&bh.b.djn(A.ownerAddinInfo)}else v.ULS.sendTraceTag(561816863,306,10,'Failed to look up ActionContext for buttonId "'+m+'" in HandleAddInCommandsActionInternal.')}j5c(d){const m=Tj.HMn(this.wWa);d[Ii.a.Visible]=m.visible;d[Ii.a.LabelText]=m.visible?m.labelText:""}$lc(){}dMn(d){d&&Ye.a.iOa in d?this.fZ(d[Ye.a.iOa],!0):v.ULS.sendTraceTag(509695234,220,10,"QueryAddinDetails: invalid actionData.")}fZ(d,m=!1){this.ii?(v.ULS.sendTraceTag(509695232,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",
d,m),this.ii.fZ(d,m)):v.ULS.sendTraceTag(509695233,220,10,"QueryAddinDetails: abort because _appsForOfficeUiActor is null..")}Xjc(d){v.ULS.sendTraceTag(19507425,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",d[Ye.a.hOa],d[Ye.a.iOa]);this.wWa.mho();window.setTimeout(()=>{const m=new Zj(new Hd(this.Hj.value),Lh.instance,Pm.instance);m.axk((A,R)=>{this.LKb(R.properties);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fZ(d[Ye.a.iOa])});m.iRo(d)},0)}HUn(){if(this.wWa.k3d()){this.wWa.JEh();var d=Ia.a.instance.resolve("Wonca.AddInCommands.IAddInCommandsInitService").XNl();if(d)for(const m of d)d={["ack1"]:m.key,["ack0"]:4,["ak0"]:(new Date).getTime()},this.Xjc(d)}else n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(v.ULS.sendTraceTag(509695235,220,50,"RefreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.wWa.k3d()),
this.fZ(10,!0),this.fZ(0,!0))}jRb(d){ad.ohg(d[Ye.a.sAk].toString())}hJa(d){rf.hJa(d[Ye.a.NCd].toString())}YFa(d){rf.YFa(d[Ye.a.NCd].toString())}Gtg(d){var m=d.Yp;const A=d.VA,R=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&m.solutionId in R)m=R[m.solutionId];else if(m.assetId in R)m=R[m.assetId];else if(m=this.ZTl(A),void 0===m||null===m){v.ULS.sendTraceTag(528544853,
220,15,"addinCommandControlId is NullOrUndefined");return}this.XVd({["SourceControlId"]:m});d.Yp.isAutoLaunched=!0}ZTl(d){if(!d)return v.ULS.sendTraceTag(528561871,220,10,"Failed to get button id for addin"),null;if((d=d.Jya)&&d.IH&&0<d.IH.count)for(const m of d.IH){if(m.groups&&1===m.groups.length){d=m.groups[0];if(d.controls&&1===d.controls.length){const A=d.controls[0];if(A.attributes&&!A.controlType&&A.enabled)return A.id}d.controls&&v.ULS.sendTraceTag(528261908,220,15,"It has multiple buttons")}m.groups&&
v.ULS.sendTraceTag(528261909,220,15,"It has multiple groups")}return null}pem(d,m){let A=0;if(!d||!m)return A;for(var R=0;R<m.Wp();R++){if(m.qF(R)){if(m.Rd()&&14===m.Xe){A|=Zg.table;break}m.sc()}m.sc()}for(m=0;m<d.length;++m)if(R=d.J(m),R.contextId===ic.a.Fd||R.contextId===ic.a.paragraph||R.contextId===ic.a.image)Qe.ParagraphReader.Xb(R.node)?A=io.a(R.node,5)?A|Zg.image:A|Zg.text:pk.ImageReader.Mt(R.node)&&(A|=Zg.image);return A}iZk(){this.wWa.JEh()}GJk(d){if(d&&d.solutionId){var m=Ia.a.instance.resolve("Box4.AppsForOffice.IInitializeHelper");
m?m.zDf(()=>{Ia.a.instance.Sa("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").execute(A=>{var R=d.solutionId,da=A.HQd(R);da?da.sharedRuntimeId&&da.backgroundState===dk.background?this.wJk(da.sharedRuntimeId,R):(A=A.e6f(da),(A=Ye.a.Xrh in A?A[Ye.a.Xrh]:null)&&"true"===A.toLowerCase()?(A=new Rd,da=A.HJk,da=R in da?da[R]:null,R=Telemetry.PrivacyRules.GetPrivacyCompliantId(R,d.storeType,d.assetId,null,null,d.storeId),da?(this.vyf(A,da),v.ULS.sendTraceTag(22360455,220,100,"LaunchAddInCommands AutoShowTaskPane Success for app "+
R)):v.ULS.sendTraceTag(22360454,220,15,"LaunchAddInCommands AutoShowTaskPane: No TaskPane set to autoshow for app "+R)):v.ULS.sendTraceTag(22360453,220,50,"LaunchAddInCommands AutoShowTaskPane: Document settings don't set AddinCommandsAutoShowTaskPaneWithDocument = true.")):v.ULS.sendTraceTag(22360452,220,50,"LaunchAddInCommands AutoShowTaskPane failed for afoRefData is null.")})}):v.ULS.sendTraceTag(22360451,220,10,"LaunchAddInCommands AutoShowTaskPane failed for initializeHelper is null.")}else v.ULS.sendTraceTag(571248988,
220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid asset id.")}wJk(d,m){const A=new Rd;(d=A.getTaskPaneControlIdFromSolutionIdRuntimeId(m,d))&&this.vyf(A,d)}Xqn(d,m){Object(Oh.a)(ml,m);n.AFrameworkApplication.K.$("AddInCommandsAutoShowTaskPaneIsEnabled")&&(m?window.setTimeout(()=>{m.Yp&&this.GJk(m.Yp)},0):v.ULS.sendTraceTag(21546839,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null.")));bh.b.hqc()&&m&&bh.b.ejn(this,m)}}Object(y.a)(Pf,"AddInCommandsManager",null,[244]);
class zi extends Pf{constructor(d,m,A,R,da,Ea,ib,Qb,pc){super(d,m,A,R,da,Ea,ib,Qb);this.bom=()=>{Ia.a.instance.Oa("WordEditor.IStatusBarUser").HNb();this.uje()};(this.kte=A)&&this.kte.cxk(this.bom);Oe.a.TTc=Oe.a.wMj;this.Ca=pc}$lc(){this.uje()}uje(){const d=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1);Tj.uje(this.kte,sf.StaticActiveAppFrame.za().Eoa(),"AddInCommandsLoadStatus-Medium14",
d?WoncaIntl.WoncaStrings.L_TabHome:WoncaIntl.WoncaStrings.L_TabInsert,CommonUIStrings.L_ButtonOfficeAddins)}}Object(y.a)(zi,"WordEditorAddInCommandsManager",Pf,[]);class $e{get name(){return"WordEditor.AddInCommands"}wc(d){this.W=d;this.W.ia("CommandUI.AddInCommands.ContextMenuExtensibilityCache",()=>new Ud).ha();this.W.ia("CommandUI.AddInCommands.AddinCommandsResourceManager",()=>n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddinResourceManagerGetInstance",!0)?Gd.getInstance():
new Gd).ha();this.W.ia("CommandUI.AddInCommands.IAddinCommandsStringProvider",()=>new ne).ha();this.W.ia("Wonca.AddInCommands.IAddInCommandsManager",()=>new zi(d.resolve("CommandUI.AddInCommands.ContextMenuExtensibilityCache"),d.Ve("Common.App.AppsForOfficeCommon.IContextActivationManager"),d.resolve("CommandUI.AddInCommands.AddinCommandsResourceManager"),d.resolve("CommandUI.AddInCommands.IAddinCommandsStringProvider"),d.resolve("Wonca.ICommandUiManager").pN,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
d.resolve("Common.ISharedDependencyLoader"),d.resolve("Common.IExternalUICommandDefinitionMapping"),d.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("Wonca.AddInCommands.AddInCommandsActor",()=>new yd(n.AFrameworkApplication.va,d.resolve("Wonca.AddInCommands.IAddInCommandsManager"))).ha();this.W.ia("Wonca.AddInCommands.IAddInCommandsInitService",()=>new ji(n.AFrameworkApplication.va,n.AFrameworkApplication.ta.Kq)).ha()}init(){n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&(this.W.resolve("Wonca.AddInCommands.AddInCommandsActor").Ub(),
this.W.resolve("WordEditor.UI.EditSurfaceContextMenu"),Object(I.a)(this.W.resolve("Wonca.AddInCommands.IAddInCommandsManager"),this.W.resolve("Wonca.AddInCommands.IAddInCommandsManager").sNk,"buildAddInCommandsContextMenuProps"),n.AFrameworkApplication.K.$("AddInCommandsLoadedInBootingIsEnabled")&&this.W.resolve("Wonca.AddInCommands.IAddInCommandsInitService").zQo())}dispose(){ad.Opl()}static main(){n.AFrameworkApplication.eL||z.a.instance.Gc(new $e)}}Object(y.a)($e,"PackageManager",null,[1,2]);class qn{constructor(d,
m){this.pB=d;this.appId=m}}Object(y.a)(qn,"ActivatedAfoData",null,[]);class fl{constructor(d,m,A,R,da,Ea,ib,Qb=!0,pc=null,Pc=0){this.settings=null;this.DWj=d;this.L7j=m;this.ghk=A;this.wAb=R;this.K7=da;this.oyd=Ea;this.PGc=ib;this.fN=null;this.isToBePersisted=Qb;this.sharedRuntimeId=pc;this.backgroundState=Pc}get Dth(){return this.DWj}get instanceId(){return this.L7j}get Qn(){return this.ghk}get version(){return this.wAb}get store(){return this.K7}get storeType(){return this.oyd}get Bia(){return"inmemory"===
this.storeType||this.fN&&!this.fN.Bia||!this.isToBePersisted?!1:!0}Ovh(d){return d.Qn.toLowerCase()===this.Qn.toLowerCase()&&d.store.toLowerCase()===this.store.toLowerCase()&&d.storeType.toLowerCase()===this.storeType.toLowerCase()}}Object(y.a)(fl,"AppsForOfficeReferenceData",null,[]);class Qj{constructor(){this.qsa=new Fk.a}add(d,m){this.qsa.nb(d.id)&&v.ULS.sendTraceTag(7143680,344,15,"instance Id {0} already exists when adding new activated apps for office info",d.id);m=new qn(d,m);this.qsa.Z(d.id,
m)}aQa(d){return this.qsa.nb(d)?this.qsa.J(d).appId:(v.ULS.sendTraceTag(7143681,344,15,"instance Id {0} not exists when trying to get App Id",d),null)}vGb(d){for(let m of this.qsa)if(d===m.value.appId)return m.key;return null}yPc(d){return this.qsa.J(d).pB.addinCommandsActionType}qqf(d){d=this.qsa.J(d).pB;const m=new fl(null,d.id,d.solutionId,d.version,d.storeId,d.storeType,!0,d.isToBePersisted);d.ownerAddinSolutionId&&(m.fN=new fl(d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.ownerAddinSolutionId,
d.version,d.storeId,d.ownerAddinStoreType,!1,d.isToBePersisted));return m}Qhm(d){return this.qsa.J(d).pB.onTaskPaneClose}bGb(d){return this.qsa.J(d).pB.div}qVl(d){return this.qsa.J(d).pB.customizedActionDic}nbi(d){const m=new U.a;for(let A of this.qsa){const R=A.value.pB;R.ownerAddinSolutionId&&d.toLowerCase()===R.ownerAddinSolutionId.toLowerCase()&&m.add(R.id)}return m}MOl(d){const m=new U.a;for(let A of this.qsa){const R=A.value.pB;R.ownerAddinSolutionId&&d.toLowerCase()===R.ownerAddinSolutionId.toLowerCase()&&
m.add(A.value.appId)}return m}}Object(y.a)(Qj,"ActivatedAfoDataManager",null,[1177]);class rm{constructor(d,m,A,R,da){this.IYh=d;this.controlId=m;this.vnc=A;this.handler=R;this.callback=da}}Object(y.a)(rm,"EventRegistrationParams",null,[]);class Ai{constructor(d,m,A){this.Ib=d;this.jhd=m;this.ELg=A}invokeDdaMethod(d,m,A){const R=d.DdaMethod.DispatchId,da=this.jhd.uDk.Aof(R);da?(da.parameters=d,da.callback=m,da.EAk=A,da.controlId=d.DdaMethod.ControlId,da.nk=this.ELg.qqf(da.controlId),da.customizedActionDic=
this.ELg.qVl(da.controlId),this.S_e(Object(I.a)(da,da.go,"go"),null)):(v.ULS.sendTraceTag(5902750,341,10,"API Call for method ID {0} does not exist.",R),this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}registerDdaEventAsync(d,m,A,R,da){this.S_e(Object(I.a)(this,this.gWn,"registerEventTaskProcess"),new rm(d,m,A,R,da))}unregisterDdaEventAsync(d,m,A,R,da){this.S_e(Object(I.a)(this,this.lTo,"unregisterEventTaskProcess"),new rm(d,m,A,R,da))}getThrottleForCall(d){return this.jhd.vDk.wim(d)}S_e(d,
m){d=new $a.a(2,1,0,d,116);d.customData=m;this.Ib.Wb(d)}gWn(d){this.a5i(d.customData,(m,A)=>{m.addHandler(A.controlId,A.handler,A.callback,A.vnc)})}lTo(d){this.a5i(d.customData,(m,A)=>{m.removeHandler(A.controlId,A.callback,A.vnc)})}a5i(d,m){const A=this.jhd.tDk.r9b(d.IYh);A?m(A,d):(v.ULS.sendTraceTag(5902751,341,10,"Event for dispatch ID {0} does not exist.",d.IYh),this.Wq(d.callback,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}sG(d){this.Wq(d,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Wq(d,
m){if(d){var A={};A.Error=m;d(A)}}}Object(y.a)(Ai,"AppsForOfficeApiAdapter",null,[1249]);class qk{constructor(){this.QUb=this.W=null}wc(d){this.W=d;d.register(Qj,"Common.App.AppsForOfficeCommon.ActivatedAfoDataManager").as("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager").ha().Ud(()=>new Qj);d.register(Ai,"Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter").as("Common.App.AppsForOfficeCommon.IHostApi").ha().Ud(()=>new Ai(n.AFrameworkApplication.lc,d.resolve("Common.App.AppsForOfficeCommon.ApiManager"),
d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager")))}init(){}dispose(){this.QUb&&(this.QUb.dispose(),this.QUb=null)}}Object(y.a)(qk,"AppsForOfficeCommonPackage",null,[1,2]);var pe=c(1507);class hb{constructor(d,m,A){this.uWj=d;this.tWj=m;this.vWj=A}get uDk(){return this.uWj}get tDk(){return this.tWj}get vDk(){return this.vWj}}Object(y.a)(hb,"ApiManager",null,[1255]);var Ib=c(67),gc=c(402),Lc=c(192),Rc=c(244);class qd extends xb.StandardDialog{constructor(d,m){super();this.YOg=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;
this.hVg=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.iVg=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.oNe=!1;this.lXa=d;this.kuc=m}showDialog(d,m){this.zg=void 0===this.zg||null===this.zg?Rc.a.kjc(0,Number.MAX_VALUE).toString():this.zg;n.AFrameworkApplication.ta.Kb.uF?this.wQn(d,m):this.t1m(d,m)}t1m(d,m){const A=new oa.a(void 0,void 0,!1);A.Cd=0;A.zg=Rc.a.kjc(0,Number.MAX_VALUE).toString();A.Vg=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
m,this.iVg,this.hVg,this.YOg);A.Uh(d,Object(I.a)(this,this.Wmn,"onCheckboxExecuteLegacy"),{optInCheckbox:!1})}wQn(d,m){this.AYa=Object(I.a)(this,this.L3b,"baseDialogHandler$4");d={["type"]:"StandardDialogProps",["id"]:this.zg,["dialogIcon"]:3,["headerText"]:d,["titleText"]:m,["resultHandler"]:this.AYa,["messageAreaLink"]:this.uel(),["permanentDismissCheckbox"]:this.pel(),["renderMicrosoftLogoInHeader"]:!1};this.show(d)}L3b(){this.hide();this.oNe&&this.Ntj()}Vmn(){rj.a.instance.getItem("optedIntoAddinDeveloperMode")?
(rj.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.oNe=!1):(rj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.oNe=!0)}Wmn(d,m){1===d&&m.optInCheckbox&&(rj.a.instance.getItem("optedIntoAddinDeveloperMode")?rj.a.instance.removeItem("optedIntoAddinDeveloperMode"):(rj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Ntj()))}uel(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.hVg,["handler"]:{["href"]:this.iVg,["target"]:"_blank"},["onExecute"]:null}}pel(){const d=
Object(I.a)(this,this.Vmn,"onCheckboxExecute$4");return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.YOg,["onExecute"]:d}}Ntj(){const d=new xb.StandardDialog;d.Cd=4;const m=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.lXa)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;d.IV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,m,this.kuc)}}Object(y.a)(qd,
"AppsForOfficeDeveloperModeOptInDialog",xb.StandardDialog,[]);class Ld{constructor(d,m){this.lXa=this.rkd=null;this.dX=d;this.$ea=m}initialize(){this.$ea&&(this.$ea.initialize(),this.rwo())}rwo(){if(this.$ea){var d=this.$ea.c5h();if(d){for(let A=0;A<d.count;A++){var m=!OSF.OsfControl.isFirstPartyStoreString(d.J(A).storeType);if(n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&m)n.AFrameworkApplication.ta&&!n.AFrameworkApplication.ta.Kb.EY(22)&&(m=new X.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,
CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),m.id=22,m.image=1,m.closeable=!0,n.AFrameworkApplication.ta.Kb.Vma(m,!0)||v.ULS.sendTraceTag(36790730,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user."));else if(d.J(A).PGc||"registry"===d.J(A).storeType)if(m=new ki.a(d.J(A).instanceId,d.J(A).Qn,d.J(A).version,d.J(A).store,d.J(A).storeType,d.J(A).settings),m.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,m.osfControlType=
1,n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")){const R={};n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(R.solutionId=m.solutionId,R.version=m.version):(R.marketplaceId=m.solutionId,R.marketplaceVersion=m.version);R.storeType=m.storeType;R.storeId=m.storeId;R.targetData=m;this.dX.YDi(R,(da,Ea,ib)=>{const Qb=ib.targetData;if(!Ea)this.dX.showTaskPane(Qb.solutionId,null,Qb);else if(n.AFrameworkApplication.K.$("InstallVisibleAddinCommandsEnabled")){if("omex"!==
R.storeType.toLowerCase())return;let pc=!1;this.H4f(Pc=>{if(!Pc[Ye.a.rAk]){if(Pc[Ye.a.$rh])for(const gd of Pc[Ye.a.$rh])if(pc=Lb.e(gd[1])===Lb.e(Qb.solutionId))break;pc||this.dX.Nnh(Qb)}})}da||v.ULS.sendTraceTag(542978530,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Qb.solutionId,Qb.storeType,Qb.assetId,null,null,Qb.storeId),Qb.storeType)})}else this.dX.showTaskPane(d.J(A).Qn,null,m)}this.fRo()}}}H4f(d){const m={};m.callback=d;n.AFrameworkApplication.va.Qb(Q.a.pOb,
2,m)}Nkb(d){if(this.$ea){var m=new fl(d.id,d.id,d.solutionId,d.version,d.storeId,d.storeType,!0,d.isToBePersisted);d.ownerAddinSolutionId&&(m.fN=new fl(d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.ownerAddinSolutionId,d.version,d.storeId,d.ownerAddinStoreType,!1,d.isToBePersisted));this.$ea.Nkb(m)}}vCf(d,m,A,R){this.$ea&&(R=new fl(R.id,R.id,R.solutionId,R.version,R.storeId,R.storeType,!0),this.$ea.vCf(d,m,A,R))}Kpl(d){this.$ea&&(d=this.$ea.GQd(d))&&(d.PGc=!1,this.$ea.dho(d))}dispose(){this.dX&&
(this.dX.dispose(),this.dX=null);this.$ea&&(this.$ea.dispose(),this.$ea=null)}fRo(){this.lXa=n.AFrameworkApplication.K.kb("DevAddinManifestFileUrl");this.rkd=n.AFrameworkApplication.K.kb("DevAddinManifestGuid");var d=n.AFrameworkApplication.K.kb("IsDevAddinTest");if(this.lXa&&this.rkd&&d){d="true"===d;var m=rj.a.instance.getItem("optedIntoAddinDeveloperMode");const A=rj.a.instance.getItem(this.rkd);m||d&&n.AFrameworkApplication.K.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?A||
d&&n.AFrameworkApplication.K.$("RegisterAddinManifestFromQueryParamSuppressDialogsIsEnabled")?this.dX.Et.validateAndCacheNewDevAddinManifest(this.lXa):(d=new xb.StandardDialog,d.Cd=4,m=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.lXa)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,d.IV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,m,Object(I.a)(this,this.R9i,"registerDevAddinManifestHandler"))):
(d=Object(I.a)(this,this.R9i,"registerDevAddinManifestHandler"),d=new qd(this.lXa,d),d.Cd=0,d.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}R9i(d){1===d&&this.lXa&&this.TVn()}TVn(){this.dX.Et.validateAndCacheNewDevAddinManifest(this.lXa);rj.a.instance.setItem(this.rkd,"true")}}Object(y.a)(Ld,"AppsForOfficeManager",null,[1247,10]);class zd{constructor(d,m){this.hostControl=d;this.controlStatusChanged=
m.LOl();this.notifyHost=m.BWj}}Object(y.a)(zd,"HostControlInfo",null,[]);class pf{constructor(d){this.Xdb=d}create(){return new OSF.ContextActivationManagerBuilder(this.Xdb.zai(),this.Xdb.tci())}}Object(y.a)(pf,"ContextActivationManagerBuilderFactory",null,[1244]);class Jc{constructor(d,m,A){this.qIb=d;this.onSuccess=m;this.onError=A;$addHandler(window,"message",Object(I.a)(this,this.$jb,"handleResponse"))}$jb(d){try{if(d&&d.rawEvent&&d.rawEvent.origin&&this.qIb&&this.qIb.id){var m=this.k1i(d.rawEvent.origin);
const A=this.k1i(document.domain);if(T.a.ih().equals(A,m))if(d.rawEvent.source&&d.rawEvent.source.frameElement&&d.rawEvent.source.frameElement.id&&T.a.ih().equals(d.rawEvent.source.frameElement.id,this.qIb.id)){m=null;try{m=JSON.parse(d.rawEvent.data)}catch(R){v.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",R.message)}m?(m.statusCode!==Xb.a.Zz||void 0!==m.error&&m.error?(v.ULS.sendTraceTag(23707648,
344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",m.statusCode,m.error),this.onError()):(v.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(m.authorizationCode?m.authorizationCode:m.signInUrl)),$removeHandler(window,"message",Object(I.a)(this,this.$jb,"handleResponse")),this.qIb?document.body.contains(this.qIb)?document.body.removeChild(this.qIb):v.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
v.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):v.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else v.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else v.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else v.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(A){v.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",A.message)}}k1i(d){let m="";try{d&&(m=-1<d.indexOf("//")?d.split("/")[2]:d.split("/")[0])&&(m=m.split(":")[0],m=m.split("?")[0])}catch(A){v.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",A.message)}return m}static YE(d,m,A){new Jc(d,m,A)}}Object(y.a)(Jc,"ResponseHandler",null,[]);var gg=c(205);
class dc{constructor(d){this.FAb=d}tryAuthenticate(d,m){this.Z$d(dc.O6j,()=>{d()},m)}tryAuthorize(d,m){this.Z$d(dc.pXj,d,m)}getSignInUrl(d,m){this.Z$d(dc.qhh,d,m)}signOut(d,m){this.Z$d(dc.Ekk,d,m)}Z$d(d,m,A){var R=new gg.QueryStringBuilder("AuthenticationProxyHandler.aspx");R.Ae("responseType",d);n.AFrameworkApplication.qga(R);R=String.format("{0}{1}&{2}",this.FAb,R.toString(),n.AFrameworkApplication.em);const da=document.createElement("iframe");da.setAttribute("id","privateCatalogIframe");da.setAttribute("name",
"privateCatalogIframe");da.setAttribute("style","display: none");T.a.ih().equals(d,dc.qhh)||da.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Jc.YE(da,m,A);da.setAttribute("src",R);document.body.appendChild(da)}}dc.pXj="authcode";dc.O6j="identitytoken";dc.qhh="signinurl";dc.Ekk="signout";Object(y.a)(dc,"AuthenticationProxy",null,[]);class ng{}ng.getUserId="getUserId";ng.getLastStoreUpdate="laststoreupdate";ng.getEntitlement="getEntitlements";
ng.getEToken="getEToken";ng.getManifest="getManifest";ng.getAppState="getAppState";ng.getKilledApps="getRemovedAddins";ng.getAppDetails="getAppDetails";ng.removeApps="removeAddin";ng.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";ng.getPrivateCatalogAddIns="getAddIns";ng.getPrivateCatalogManifests="getAppManifests";ng.isStoreDisabled="isStoreDisabled";Object(y.a)(ng,"S2SWebRequestActions",null,[]);var Sd=c(1072);class rk{getUserId(d,m){const A=new U.a;A.add(new ig.a("corr",d));this.Wv(ng.getUserId,
A,1,m)}getLastStoreUpdate(d,m,A){const R=new U.a;R.add(new ig.a("lc",d));R.add(new ig.a("corr",m));this.Wv(ng.getLastStoreUpdate,R,1,A)}getEntitlement(d,m,A,R){d=new U.a;d.add(new ig.a("av",m));d.add(new ig.a("corr",A));this.Wv(ng.getEntitlement,d,1,R)}getEToken(d,m,A,R,da,Ea){const ib=new U.a;ib.add(new ig.a("cmu",d));ib.add(new ig.a("cmf",m));ib.add(new ig.a("assetid",A));ib.add(new ig.a("expver",R));ib.add(new ig.a("corr",da));this.Wv(ng.getEToken,ib,1,Ea)}getManifest(d,m,A,R){const da=new U.a;
da.add(new ig.a("cmu",d));da.add(new ig.a("assetid",m));da.add(new ig.a("corr",A));this.Wv(ng.getManifest,da,1,R)}getAppState(d,m,A){const R=new U.a;R.add(new ig.a("ma",d));R.add(new ig.a("corr",m));this.Wv(ng.getAppState,R,1,A)}getKilledApps(d,m){const A=new U.a;A.add(new ig.a("corr",d));this.Wv(ng.getKilledApps,A,1,m)}getAppDetails(d,m,A,R){const da=new U.a;da.add(new ig.a("cmo",d));da.add(new ig.a("corr",A));this.sendWithBody(ng.getAppDetails,da,m,2,R,!1)}removeApps(d,m,A){const R=new U.a;R.add(new ig.a("corr",
m));this.sendWithBody(ng.removeApps,R,d,2,A,!1)}getLastPrivateCatalogUpdate(d,m,A,R,da,Ea){const ib=new U.a;ib.add(new ig.a("catalog","privatecatalog"));ib.add(new ig.a("clientCode",d));ib.add(new ig.a("clientVersion",m));ib.add(new ig.a("corr",da));d=String.format("authorizationCode={0}&refreshToken={1}",A?sa.a.Gj(A):"",R?sa.a.Gj(R):"");this.sendWithBody(ng.getLastPrivateCatalogUpdate,ib,d,2,Ea,!0)}getPrivateCatalogAddIns(d,m,A,R,da,Ea){const ib=new U.a;ib.add(new ig.a("catalog","privatecatalog"));
ib.add(new ig.a("clientCode",d));ib.add(new ig.a("clientVersion",m));ib.add(new ig.a("corr",da));d=String.format("authorizationCode={0}&refreshToken={1}",A?sa.a.Gj(A):"",R?sa.a.Gj(R):"");this.sendWithBody(ng.getPrivateCatalogAddIns,ib,d,2,Ea,!0)}getPrivateCatalogManifests(d,m,A,R,da){const Ea=new U.a;Ea.add(new ig.a("catalog","privatecatalog"));Ea.add(new ig.a("corr",R));d=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",sa.a.Gj(d),m?sa.a.Gj(m):"",A?sa.a.Gj(A):"");this.sendWithBody(ng.getPrivateCatalogManifests,
Ea,d,2,da,!0)}isStoreDisabled(d,m){const A=new U.a;A.add(new ig.a("corr",d));this.Wv(ng.isStoreDisabled,A,2,m)}Wv(d,m,A,R){this.sendWithBody(d,m,null,A,R,!1)}sendWithBody(d,m,A,R,da,Ea){const ib=new gg.QueryStringBuilder("AddinServiceHandler.ashx");ib.Ae("action",d);ib.Ae("app",Sd.a[n.AFrameworkApplication.ta.Kb.xk]);for(let Qb of m)ib.Ae(Qb.key,Qb.value);m=String.format("{0}{1}&{2}",n.AFrameworkApplication.ta.Kb.NSa,ib.toString(),n.AFrameworkApplication.em);n.AFrameworkApplication.He.nj(m,R,A,null,
!1,2,Qb=>{let pc=null,Pc=null;Qb&&Qb.data&&(Qb.data.jj["X-BlockedForMinor"]&&"1"===Qb.data.jj["X-BlockedForMinor"].toString()&&(Qb.data.Ne=451),pc=Qb.data.te,Pc=Qb.data.jj);da(Qb.data.Ne,pc,Pc)},Qb=>{var pc=null;let Pc=null;Ea&&Qb&&Qb.data&&Qb.data.te&&(pc=Qb.data.te,Pc=Qb.data.jj);da(Qb.data.Ne,pc,Pc);if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){pc={message:"AddinServiceHandler request failed"};pc.code=Qb.data.Ne;pc.action=
d;if(Qb.data.request||Qb.data.request.get_headers())pc["X-UserSessionId"]=Qb.data.request.get_headers()["X-UserSessionId"];408===Qb.data.Ne||503===Qb.data.Ne?v.ULS.sendTraceTag(538784582,220,10,JSON.stringify(pc)):v.ULS.sendTraceTag(18392345,220,50,JSON.stringify(pc))}else v.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Qb.data.Ne)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+d,void 0,void 0,void 0,["X-UserKey"])}}Object(y.a)(rk,"S2SWebRequestManager",null,[]);class Yi{constructor(d,
m,A){this.hjd=null;this.Prc=d;this.Xdb=m;this.t6j=A}create(){if(!this.hjd){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("AppsForOfficeServerToServerIsEnabled")&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new rk);n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled")&&OfficeExt.PrivateCatalogService.initRequestHandler(new rk,new dc(n.AFrameworkApplication.K.appSettings.WebServiceBase),n.AFrameworkApplication.K.$("PrivateCatalogThirdPartyHostsEnabled"),
n.AFrameworkApplication.K.$("PrivateCatalogIsResultCodesEnabled"));"undefined"!==typeof OfficeExt.MosRequestHandler&&"undefined"!==typeof OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new rk);"undefined"!==typeof OfficeExt.ProxyBasedCatalogService&&"undefined"!==typeof OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new rk);const d=this.hjd=this.Prc.setHostInfo(this.Xdb.zai()).setLocaleInfo(this.Xdb.tci()).setUrlInfo(this.Xdb.fkm()).setMiscellaneousActivationParameters(this.Xdb.t5l()).setHostControlInfo(this.t6j).setUserInfo(this.Xdb.rkm()).construct();
void 0!==d&&null!==d&&"undefined"!==typeof d.hostCheckReadyHandler?n.AFrameworkApplication.Exk(Object(I.a)(d,d.hostCheckReadyHandler,"hostCheckReadyHandler")):v.ULS.sendTraceTag(594613527,1403,15,"ContextActivationManager or its hostCheckReadyHandler is null")}return this.hjd}}Object(y.a)(Yi,"ContextActivationManagerFactory",null,[1243]);var dh=c(1912),Nf=c(1913),ei=c(1914),kf=c(1765),rn=c(1767),Zi=c(1911),Ao=c(141);class gl{constructor(d,m,A){this._id=d;this.FVj=m;this.NZj=A;this.fvi=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get iBb(){return this.FVj}get M1k(){return this.NZj}execute(d,
m,A){A=A||{};A.commandMode=this.fvi;m.invokeAppCommand(this.iBb,this.M1k,A,()=>{d.Mrn(this.id)})}}Object(y.a)(gl,"AddinNativeActionBase",null,[1046]);class Ga extends gl{constructor(d,m){super(1,d,m);this.fvi=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(y.a)(Ga,"AddinTakeSnapshotAction",gl,[]);class kb{A9k(d){return new gl(3,d,this.hNl().getNativeActionName(3))}hNl(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(y.a)(kb,"AddinNativeActionManager",null,[1031]);class nc{invokeAppCommand(d,
m,A,R){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(d,m,A,R)}static getInstance(){nc._instance||(nc._instance=new nc);return nc._instance}}nc._instance=null;Object(y.a)(nc,"OSFAddinCommandsRuntimeManager",null,[1030]);var Kb=c(203),ld=c(20);class Kc extends oa.a{constructor(d,m,A){super();this.ONa=null;this.pWe="WACDialogTitleText";this.Dsa="0";this.ZKa="15px";this.u_j="0px";this.Csa="calc(100% - 30px)";this.t_j="100%";this.pdh=0;this.sa=new vb.a;this.HVj=new kb;this.Cd=5;this.zg=this.luc=
A;this.gze=d;this.JSg=m;this.BAe=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix")}y0e(d){this.sa.addHandler("OnDialogClosedEventKey",d)}ecj(d){this.sa.removeHandler("OnDialogClosedEventKey",d)}Slo(){this.AYa=null}iS(){super.iS();this.hq.style.width="100%";this.hq.style.height=this.BTc?this.Csa:this.t_j;this.hq.style.marginTop=this.BTc?this.ZKa:this.u_j;this.hq.style.padding=this.Dsa}LL(){super.LL();this.Kc.style.width=String.format("{0}px",
this.gze*window.innerWidth/100);this.Kc.style.height=String.format("{0}px",this.JSg*window.innerHeight/100);this.Kc.style.minWidth="0px";this.BAe&&n.AFrameworkApplication.isRtl&&100===this.gze&&(this.Kc.style.right="0px",this.Kc.style.marginRight="0px");this.ONa=document.getElementById(this.rj(this.pWe));this.ONa.style.position="absolute";this.ONa.style.whiteSpace="nowrap";this.ONa.style.textOverflow="ellipsis";n.AFrameworkApplication.isRtl?(this.ONa.style.right="14px",this.ONa.style.left="44px"):
(this.ONa.style.right="44px",this.ONa.style.left="14px")}yUa(d){super.yUa(d);this.ONa&&this.ONa.setAttribute("title",d)}get qhb(){return this.hq}y$f(){this.Kc.style.width=String.format("{0}px",this.gze*window.innerWidth/100);this.Kc.style.height=String.format("{0}px",this.JSg*window.innerHeight/100);this.Kc.style.overflowY="hidden";this.Kc.style.overflowX="hidden";this.Kc.style.marginTop="";this.Kc.style.top="";ld.a.Jxa&&n.AFrameworkApplication.isRtl?(this.Kc.style.right="",this.Kc.style.marginRight=
""):(this.Kc.style.left="",this.Kc.style.marginLeft="")}hide(){this.HVj.A9k(this.luc).execute(this,nc.getInstance(),{});this.pdh=window.setTimeout(()=>{this.sa.raiseEvent("OnDialogClosedEventKey",this.luc);Kb.a.prototype.hide.call(this)},500)}Mrn(d){3===d&&(window.clearTimeout(this.pdh),this.sa.raiseEvent("OnDialogClosedEventKey",this.luc),super.hide())}}Object(y.a)(Kc,"AppsForOfficeDialog",oa.a,[1015,1016]);class ue{constructor(){this.dialog=this.zg=null}}Object(y.a)(ue,"DialogInfo",null,[]);class Le{}
Le.url="url";Le.height="height";Le.width="width";Le.wgf="displayInIframe";Le.XWd="hideTitle";Object(y.a)(Le,"DialogSettings",null,[]);class cf{constructor(){this.height=this.width=0;this.zg=this.controlId=this.pageUrl=null;this.XWd=this.wgf=!1}}Object(y.a)(cf,"DisplayDialogParams",null,[]);class Mf extends Sys.EventArgs{constructor(d,m,A=null,R="",da=""){super();this.controlId=d;this.messageType=m;this.messageContent=A;this.dQf=R;this.S8a=da}}Object(y.a)(Mf,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);class Vg extends Sys.EventArgs{constructor(d,m,A=null,R="",da=""){super();this.controlId=d;this.messageType=m;this.messageContent=A;this.dQf=R;this.S8a=da}}Object(y.a)(Vg,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Eg=c(139);class wi{constructor(d){this.sa=new vb.a;this.Hj=d}Fyk(d){this.sa.addHandler("OnMessageParentEventKey",d)}ncj(d){this.sa.removeHandler("OnMessageParentEventKey",d)}Eyk(d){this.sa.addHandler("OnMessageDialogEventKey",d)}x2n(d){this.sa.removeHandler("OnMessageDialogEventKey",
d)}showDialog(d,m,A,R){if(wi.zKa.nb(m))v.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),A(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const gd=rb.b(d),Cd=gd[Le.url];if(this.Hj.getOsfControl(m).checkAppDomains(Cd)){var da=new cf;da.width=gd[Le.width];da.height=gd[Le.height];da.pageUrl=Cd;da.wgf=gd[Le.wgf];da.XWd=gd[Le.XWd];da.controlId=m;da.zg=Eg.a.create().toString();var Ea=new ue;Ea.zg=da.zg;var ib=this.Hj.getOsfControl(da.controlId).getManifest().getDefaultDisplayName(),
Qb=this.Hj.getOsfControl(da.controlId).getStoreType().toLowerCase();d=null;d=(4===n.AFrameworkApplication.ta.Kb.xk&&"hardcodedpreinstall"===Qb||"sdxcatalog"===Qb)&&da.XWd?this.createAndShowAppsForOfficeDialog(da.width,da.height,da.zg,!0,ib):this.createAndShowAppsForOfficeDialog(da.width,da.height,da.zg,!1,ib);var pc=this.Hj.getOsfControl(da.controlId),Pc=pc.getManifest();m={};m.id=da.zg;m.solutionId=pc.getSolutionId();m.version=pc.getVersion();m.storeType=Qb;m.storeId=pc.getStoreId();m.assetId=pc.getAssetId();
m.assetStoreId=pc.getAssetStoreId();m.ownerAddinSolutionId=pc.getOwnerAddinSolutionId();m.ownerAddinStoreType=pc.getOwnerAddinStoreType();m.appDomains=Pc.getAppDomains();m.dialogUrl=Cd;m.osfControlType=1;m.agaveName=ib;m.div=d.qhb;v.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(m.solutionId,m.ownerAddinStoreType||m.storeType,m.assetId,null,null,m.storeId),sa.a.PQ(da.pageUrl));this.Hj.insertDialogControl(m);d.y0e(Object(I.a)(this,
this.con,"onDialogClosed"));Ea.dialog=d;wi.zKa.Z(da.controlId,Ea);R&&R(m);A(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else v.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),A(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(gd){v.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",gd.message),A(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}ien(d,m,A,R){n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===R&&(R=A);try{const da=this.I9b(d);da&&this.sa.raiseEvent("OnMessageParentEventKey",new Vg(da,OSF.DialogMessageType.DialogMessageReceived,m,A,R))}catch(da){return v.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",da.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}mva(d,m){if(wi.zKa.nb(d))try{const A=wi.zKa.J(d);A.dialog&&A.dialog.hide();this.Hj.purgeDialogControl(A.zg);wi.zKa.remove(d);
m(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(A){v.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",A.message),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else v.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Weo(d,m,A,R){n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===R&&(R=A);if(wi.zKa.nb(d)&&(d=wi.zKa.J(d),d.dialog))try{this.sa.raiseEvent("OnMessageDialogEventKey",new Mf(d.zg,OSF.DialogMessageType.DialogParentMessageReceived,m,A,R))}catch(da){v.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",da.message)}}I9b(d){let m=null;for(let A of wi.zKa)if(A.value.zg===d){m=A.key;break}return m}con(d,m){if(d=this.I9b(m))this.Hj.purgeDialogControl(m),wi.zKa.remove(d),this.sa.raiseEvent("OnMessageParentEventKey",new Vg(d,
OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(d,m,A,R,da){d=new Kc(d,m,A);da=R?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,da);R&&(d.BTc=!1,d.Kt=!1);d.Uh(da,null,null);d.Slo();return d}static gmm(){return wi.zKa}static getInstance(d){wi._instance||(wi._instance=new wi(d));return wi._instance}}wi._instance=null;wi.zKa=new Fk.a;Object(y.a)(wi,"AppsForOfficeDialogManager",null,[982]);class sm{constructor(d,m,A){this.Hj=this.due=null;this.ii=
m;this.z6=A}get contextActivationMgr(){!this.Hj&&this.ii&&(this.Hj=this.ii.Et);return this.Hj}get u1a(){this.due||(this.due=wi.getInstance(this.contextActivationMgr));return this.due}showDialog(d,m,A){try{this.u1a.showDialog(m,d,A,R=>{this.z6.add(this.rNk(R),R.id)})}catch(R){v.ULS.sendTraceTag(19670552,344,10,"ShowDialogApiHelper: show dialog failed. Exception message: {0}",R.message),A(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}sPi(d,m,A,R){return this.u1a.ien(d,m,A,R)}mva(d,m){this.u1a.mva(d,
m)}hJa(d){return this.ii.hJa(d)}YFa(d){return this.ii.YFa(d)}sendMessage(d,m,A,R){this.u1a.Weo(d,m,A,R)}rNk(d){return d?new ki.a(d.id,d.solutionId,d.version,d.storeId,d.storeType,null):null}}Object(y.a)(sm,"ShowDialogApiHelper",null,[1374]);var sh=c(49),Rj=c(373),Ni=c(234),xi=c(551),qe=c(206),Hh=c(1165),xd=c(238),ye=c(178),Pd=c(250),Td=c(47),ul=c(445),oi=c(359),lh=c(56),Xk=c(608),Ih=c(971),Ze=c(44),If=c(5),Ho=c(110),Me=c(16),Si=c(1035),sg=c(724);class Fe{constructor(d,m){this.Vj=d;Fe.Deb=m}wDm(d,
m,A,R){const da=Eg.a.create(),Ea=new oi.DictionaryPropertySet;Ea.setValue(Me.a.Kia,lh.a.Ql(m,0));Ea.setValue(Me.a.Jia,lh.a.Ql(A,1));Ea.setValue(Td.a.B0,Si.a.uploading);A=d.view;m=new Ze.GraphTransaction(15);m.Db(A.ed);A=null;const ib=({cMb:A}=this.Vj.pUh(d,Ea,da)).returnValue;if(!ib)return null;var Qb=new If.GraphIterator;Qb.set(ib.node);Qb=this.xDm(Qb,R);m.dispose();A&&d.view.mb.Ac(A);Fe.Deb&&Fe.Deb.d6b(d,Ea,R,ib.node,Qb.id.toString(),ib.blob,da);return Qb}xDm(d,m){if(!d||!d.currentNode||19!==d.Xe)return null;
const A=new sg.a,R=new oi.DictionaryPropertySet;R.setValue(Td.a.dsh,m.id);R.setValue(Td.a.gsh,m.version);R.setValue(Td.a.esh,m.store);R.setValue(Td.a.fsh,m.storeType);A.setValue(Td.a.lbc,20);A.setValue(Td.a.iBb,m.instanceId);A.setValue(Td.a.csh,R);A.setValue(Td.a.ash,m.isContent);d.Bf(A,2);d.Bj(A);return A}saveSettings(d,m,A){var R=d.ja(Td.a.Z0e,null);let da=0;var Ea=R?R.length:0;const ib=[];for(var Qb=0;Qb<Ea;Qb++){var pc=R.J(Qb),Pc=pc.tf(Td.a.W0e);if(Pc in m){const gd=d.Mc,Cd=new Ho.a;Cd.setValue(Td.a.X0e,
m[Pc]);Pc=gd.Xu(Cd,null);pc.setValue(Td.a.Y0e,Pc);da+=1}ib.push(pc)}if(A&&da!==A.length)for(R=0;R<A.length-da;R++)Ea=new oi.DictionaryPropertySet,Qb=A[da+R],pc=d.Mc,Pc=new Ho.a,Pc.setValue(Td.a.X0e,m[Qb]),pc=pc.Xu(Pc,null),Ea.setValue(Td.a.W0e,Qb),Ea.setValue(Td.a.Y0e,pc),ib.push(Ea);return new Xk.a(Ih.CommonProperties.propertySet.id,ib)}}Fe.Deb=null;Object(y.a)(Fe,"AddinEditor",null,[243]);var ch=c(882);class Se{constructor(d){this.lXd={};this.Lc=d}ztk(d){if(d){var m=d.properties.ja(Td.a.iBb,"");
this.lXd[m]=d}}saveSettings(d,m){if(!m||!ul.a(m))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(!(d.instanceId in this.lXd))return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.vbo(this.lXd[d.instanceId],m);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}vbo(d,m){const A=this.Lc.Pc(15);A.Db(d);m=(new Fe(null,null)).saveSettings(d,m,ul.a(m));d.setValue(Td.a.Z0e,m);A.dispose()}Dof(d){if(!d)return null;d=this.lXd[d.instanceId];let m={};d&&(m=(new ch.a(d)).getSettings());
return m}}Object(y.a)(Se,"SaveSettingsHelper",null,[]);class Mb{constructor(d,m,A){this.Hj=d;this.ZV=m;this.Kik=A}activate(d,m){var A=m.ja(Td.a.iBb,null);A||(A=String.format("{{{0}}}",Eg.a.create()),m.setValue(Td.a.iBb,A));var R=new ch.a(m);A=R.getSettings();R=R.DSd();A=new ki.a(R.instanceId,R.id,R.version,R.store,R.storeType,A);A.div=d;A.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;A.osfControlType=R.isContent?OSF.OsfControlType.DocumentLevel:OSF.OsfControlType.ContainerLevel;
this.ZV.add(A,R.id);this.Kik.ztk(m);this.Hj.value.insertOsfControl(A)}}Object(y.a)(Mb,"AddinActivator",null,[103]);var hj=c(1701),ak=c(1676),xj=c(1801),jo=c(1640),To=c(113),ep=c(459),yn=c(691);const ko=()=>{};class fq extends hj.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc){super(d,m,A);this.vYf=Pc=>{if(jo.c(this.Ef)){var gd={},Cd=this.nH?this.nH.properties.Oc.toString():this.Ef.Oc.toString();gd[ep.a.nodeId]=this.nH?this.nH.id.toString():this.Ef.id.toString();gd[ep.a.classId]=Cd;gd[yn.a.iFrameNode]=this.R6j;
Cd=lh.a.nf(pk.ImageReader.WC(this.Ef),0);var ae=lh.a.nf(pk.ImageReader.YH(this.Ef),1);gd[yn.a.width]=Cd;gd[yn.a.height]=ae;jo.d(Pc,this.Ef,this.Zl,gd)&&Pc.rbd()}};this.ned=!1;this.Ef=Ea;this.R6j=ib;this.nH=Qb;this.Zl=pc;this.Gwn=this.t6a.bind(this);this.U0o=this.Nea.bind(this)}d6b(){new ak.a(document.body,this.Gwn,this.U0o,this.K,!1,null)}wwa(d){this.y7c(d)}y7c(d){xj.a.instance.Vqg(this.Ef.Zi());this.Ef.Zi().contentReplicator.forceOutbound(this.vYf,ko,d)}Nea(d){d&&!d.StatusCode&&this.Ef.zJ().contentReplicator.inbound(d,
To.b(d.RevisionList[0].BaseId),!1,new Date,"");this.Ef&&d?xj.a.instance.epc(this.Ef.Zi(),d.StatusCode):v.ULS.sendTraceTag(594929294,339,50,"Not able to notify upload notifier for completion")}Nka(){return!0}}Object(y.a)(fq,"BackCompatImageUploader",hj.a,[]);class Rp{d6b(d,m,A,R,da,Ea,ib){(new fq(d,ab.a.instance,n.AFrameworkApplication.K,m,A,R,da,Ea,ib)).d6b()}}Object(y.a)(Rp,"BackCompatImageUploaderWrapper",null,[242]);var yj=c(172),Io=c(1132);class Qm{create(){return new Io.a}}Object(y.a)(Qm,"AppNodeFactory",
null,[380]);var Dl=c(1133);class ek{create(){return new Dl.a}}Object(y.a)(ek,"AppPropNodeFactory",null,[380]);class Zh{constructor(){this.lNe=[]}RXn(d){this.lNe.push(d)}JIc(d,m){if(!d||!d.count)return v.ULS.sendTraceTag(17356047,341,15,"The GNC list passed into CheckOperation() should not be null or empty"),!1;for(let A=0;A<this.lNe.length;++A)if(!(0,this.lNe[A])(d,m))return!1;return!0}}Object(y.a)(Zh,"ApiOperationChecker",null,[911]);var Fh=c(926);class Xi{constructor(){this.sa=new vb.a;this.S6i=
()=>{var d=(new Date).getTime();this.yvi()&&this.sa&&(this.sa.raiseEvent("GraphSpaceLoadContentReadyEventKey"),this.sa.dispose(),this.sa=null,Fh.a.S$i("GraphSpaceLoadContentReadyEventKey"));d=(new Date).getTime()-d;v.ULS.sendTraceTag(17585671,341,50,"{0}",d)}}zDf(d){this.yvi()?(Fh.a.S$i(),d()):this.sa&&(this.sa.addHandler("GraphSpaceLoadContentReadyEventKey",d),Fh.a.krk(this.S6i))}yvi(){let d=null;const m=yj.App.pn.jb.Zc;m&&(d=new If.GraphIterator,d.set(m),this.RQf(d)||(d=null));return d&&d.Tb(19)?
!0:!1}RQf(d){ye.PageNavigator.instance.GP(d);return d.Tb(18)}}Object(y.a)(Xi,"InitializeHelper",null,[909]);var Oi=c(508);class nb{setTimeout(d,m=0){return window.setTimeout(d,m)}clearTimeout(d){window.clearTimeout(d)}setInterval(d,m=0){return window.setInterval(d,m)}clearInterval(d){window.clearInterval(d)}}Object(y.a)(nb,"WindowTimer",null,[910]);var Bc=c(33),wc=c(6);class Zc{}Zc.text="text";Zc.table="table";Zc.GLb="matrix";Object(y.a)(Zc,"AppBindingType",null,[]);class Ne{}Ne.rth="appBindingData";
Ne.j3b="appInstanceId";Ne.rDd="appReferenceId";Object(y.a)(Ne,"AppConstants",null,[]);class df{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc=null){this.my=this.yld=null;this.AWf=(gd,Cd)=>{if(this.rEf){gd=this.LN.c5h();var ae=new U.a;for(var Xd=0;Xd<gd.count;++Xd){var se=gd.J(Xd);se=this.LN.s9b(se);ae.add(se)}Xd=new U.a;se=new U.a;for(var Xe of Cd.YPh){Cd=this.Mof(Xe.id);for(let Hg=0;Hg<ae.count;++Hg){const Xh=new U.a;for(var Be of ae.J(Hg))Cd===Be.sO&&Xh.add(Be);0<Xh.count&&(Xd.add(gd.J(Hg)),se.add(Xh))}}if(0<
se.count){Xe=this.Lc.Pc(15);Xe.Db(this.LN.Uha());for(Be=0;Be<se.count;++Be)for(const Hg of se.J(Be))(gd=this.INd.r9b(OSF.DDA.EventDispId.dispidBindingDataChangedEvent))&&Xd.J(Be)&&gd.X6i(Xd.J(Be).instanceId,Hg.UT),this.LN.b8f(Xd.J(Be),Hg.UT);Xe.dispose()}}};this.LN=d;this.$o=m;this.hb=A;this.Lc=R;this.ji=da;this.G3=Ea;this.cMa=Qb;this.qA=ib;this.z6=Pc;this.rEf=!0;this.Mg=pc}get KDi(){return n.AFrameworkApplication.K.$("TableCellRowSelectionIsEnabled")}get sj(){return this.ji.value}get INd(){this.yld||
(this.yld=Ia.a.instance.resolve("WordEditor.AppsForOffice.WordEditorEventStore"));return this.yld}set INd(d){this.yld=d}get RZd(){this.my||(this.my=Ia.a.instance.Oa("Box4.ContentControlConfigSettings"));return this.my?this.my.jh:!1}get Xvi(){return n.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingDataChangedEventIsEnabled")}Bwa(d,m){const A={};m=this.LN.s9b(m);for(var R of m)if(R.UT===d){d={};R=({Bxh:d}=this.$5h(R)).returnValue;if(R!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:R,
fJ:A};A[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties]=d;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,fJ:A}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,fJ:A}}A5h(d,m){m=this.LN.s9b(m);for(const A of m)if(A.UT===d)return d=A,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,D4e:d};return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,D4e:null}}$5h(d){const m={};let A=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;
m[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=d.UT;m[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=d.wM;if(d.wM===Zc.table||d.wM===Zc.GLb){let R=null;({root:R,returnValue:A}=this.Kii(d));A===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(m[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount]=Bc.TableReader.hh(R),m[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=Bc.TableReader.gg(R),d.wM===Zc.table&&(d=this.qA.O2a(R),m[OSF.DDA.Marshaling.AppBindingKeys.HasHeaders]=0<d,m[OSF.DDA.Marshaling.AppBindingKeys.RowCount]=
Bc.TableReader.gg(R)-d))}return{returnValue:A,Bxh:m}}$Jk(d){let m=null;const A=({Hna:d}=this.Jpf(d)).returnValue;if(A!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:A,graphNode:m};m=d.contentControlNode.ZK();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,graphNode:m}}ohm(d,m){let A=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,R=null;(d=this.LN.Bwa(d,m))?{root:R,returnValue:A}=this.Kii(d):A=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:A,
root:R}}Kii(d){let m=null,A=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;d?d.wM!==Zc.table&&d.wM!==Zc.GLb?A=OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType:(d=this.$o.getById(this.dQa(d.sO)))?{tableNode:m,returnValue:A}=this.YUd(d):A=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:A=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:A,root:m}}YUd(d){let m=null;var A=d.Au;d=d.Ez;A=A&&d&&A.equals(d)?(m=this.sj.Eb(A))&&14===m.type?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;return{returnValue:A,tableNode:m}}iQc(d,m,A){var R=null;d=({Hna:R}=this.hQc(m,d)).returnValue;return d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?d:(R=R.lF(!0))?(A.push(...R.toArray()),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}mof(d){const m=[];if(d=this.LN.s9b(d))for(const A of d){let R;({Bxh:R}=this.$5h(A)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
m.push(R)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Axh:m}}F$i(d,m,A=null){var R=this.LN.Bwa(m,d);if(!R)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;var da=R.sO;R=this.dQa(da);const Ea=this.$o.getById(R);if(!Ea)return v.ULS.sendTraceTag(17581638,341,10,"The content control bound id : {0} did not exist.",R),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;da=this.LN.KOl(da);d=this.LN.b8f(m,d);d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(A&&A(),Ea.u0d&&
1===da.count?this.$o.ZOb(R):Ea.Bdc&&1===da.count&&(Ea.Bdc=!1));return d}jza(d){let m=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;d=this.dQa(d.sO);this.$o.getById(d)?this.$o.ZOb(d)&&(m=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):m=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return m}ydl(){let d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType;var m=2;let A=0;const R=[];for(var da of this.hb.ib)R.push(...da.toArray());const Ea=R[0];da=R[R.length-1];2===R.length&&
Ea.contextId===ic.a.Fd&&da.contextId===ic.a.Vc&&(da=Ea);const ib=this.$o.lL(Ea,da,0);if(ib&&0<ib.count)return A=ib.J(0).id,ib.J(0).Bdc=!0,{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,$w:A};if(Ea.contextId===ic.a.Fd&&(1===R.length||2===R.length))d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{id:A,returnValue:m}=this.$o.E_a(Ea);else if((this.KDi||1===this.hb.ib.length)&&Ea.contextId===ic.a.paragraph&&da.contextId===ic.a.paragraph){let Qb;if(!({Dle:m}=this.SDj(Ea.node)).returnValue||
!({Dle:Qb}=this.SDj(da.node)).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,$w:A};d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;({id:A,returnValue:m}=this.$o.Uma(m.id,Qb.id))}if(d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:d,$w:A};if(m)return v.ULS.sendTraceTag(17585562,341,15,"{0}",{["ccError"]:m,["errMsg"]:"Unable to create content control for selection"}),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,
$w:A};this.$o.getById(A).u0d=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,$w:A}}uUn(d,m){this.Mg.sE(m.id,d.Pa.node.id,!0);this.Mg.sE(m.id,d.Rc.node.id,!1);({returnValue:d}=this.$o.Uma(d.Pa.node.id,d.Rc.node.id));return d?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}SDj(d){let m=d;if(!d||12!==d.type)return{returnValue:!1,Dle:m};d=If.GraphIterator.eb(d);if(d.zb(14))if(this.G3.v1d(d.jd(14)))m=d.currentNode;else return{returnValue:!1,
Dle:m};return{returnValue:!0,Dle:m}}CTl(d){var m;return(m=this.$o.getById(d))?(d=this.sj.Eb(m.Au),m=this.sj.Eb(m.Ez),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Svj:d,kXh:m}):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Svj:null,kXh:null}}vTl(d){const m=this.$o.getByTitle(d);if(!m.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound,$w:0};if(1<m.count)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound,
$w:0};d=m.J(0).id;m.J(0).Bdc=!0;return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,$w:d}}hQc(d,m){d=this.LN.Bwa(d,m);return this.Jpf(d)}voh(d,m){const A=this.LN.Bwa(d,m.UT);let R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(A){if(!this.$o.getById(this.dQa(m.sO)))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(A.sO===m.sO){if(m.wM===A.wM)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else R=this.F$i(m.UT,d);if(R!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return R}return this.LN.nti(d,
m)}Nof(d,m){if(d=this.LN.Bwa(d,m)){if(d=this.$o.getById(this.dQa(d.sO)))return d=d.getText(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,text:d};d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return{returnValue:d,text:null}}ldg(d,m,A){(d=this.LN.Bwa(d,m))?d.wM!==Zc.text?A=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType:(d=this.dQa(d.sO),A=(d=this.$o.getById(d))?d.bie(A)?OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):A=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;return A}Z5h(d,m,A,R){let da=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Ea,ib={};({root:Ea}=this.ohm(d,m)).returnValue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(R.isPartialTable&&this.G3.QDi(Ea)?da=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported:{zil:ib,returnValue:da}=this.G3.phm(Ea,A,R));return{returnValue:da,
zyj:ib}}APl(d,m){let A="";const R=[];(d=this.iQc(m,d,R))===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&({WQa:A,returnValue:d}=this.cMa.Bqf(R,!0));return{returnValue:d,WQa:A}}Rkj(d,m,A,R,da,Ea,ib){let Qb=null,pc=null;if((d=({Hna:Qb}=this.hQc(d,m)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=({tableNode:pc}=this.YUd(Qb)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(Ea.isPartialTable&&this.G3.QDi(pc))d=OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported;
else if({vIo:Ea,returnValue:d}=this.G3.oQo(pc,A,Ea),d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.G3.GWm(A,pc,Ea,da,R)){if({KIo:R,returnValue:d}=this.G3.UGn(Ea,da,R),d===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){ib(this.qA.wio(Qb,R[0],R[1])?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,A?"table":"matrix");return}}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize;ib(d,A?"table":"matrix")}Jdm(){const d=new U.a;
var m=new U.a;for(var A of this.hb.ib)m.addRange(this.$o.lL(A.Pa,A.Rc,1));if(0<m.count){A=this.LN.B5h();If.GraphIterator.eb(this.hb.Z1);const Ea=this.eVm(),ib={};for(var R of m)ib[R.id.toString()]=R;for(const Qb of Object.keys(ib)){m=ib[Qb];for(const pc of A){var da=pc[Ne.rth];if(this.dQa(da.sO)===m.id){R={["appInstanceId"]:pc[Ne.j3b]};const Pc=this.LN.GQd(pc[Ne.j3b]);Pc&&(R[Ne.rDd]=Pc.Qn);R[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=da.UT;R[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=da.wM;
da.wM===Zc.table&&m.Au&&this.KDi&&Ea&&(da=null,{txj:da}=this.G3.Zdm(this.sj.Eb(m.Au)),R[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=da);d.add(R)}}}}return d}JOl(d){const m=new U.a;var A=this.LN.B5h();for(const R of A)if(A=R[Ne.rth],this.dQa(A.sO)===d){const da={["appInstanceId"]:R[Ne.j3b]},Ea=this.LN.GQd(R[Ne.j3b]);da[Ne.rDd]=Ea.Qn;da[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=A.UT;da[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=A.wM;m.add(da)}return m}k_n(d,m){d&&(d=d.instanceId,this.INd.r9b(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent).removeHandler(d,
null,m))}j_n(d,m){d&&(d=d.instanceId,this.INd.r9b(OSF.DDA.EventDispId.dispidBindingDataChangedEvent).removeHandler(d,null,m))}s3d(d,m,A){d=this.LN.GQd(d);m=this.LN.Bwa(d,m);v.ULS.sendTraceTag(16798856,341,50,"{0}",{["method"]:A,["appId"]:d?d.Qn:null,["bindingType"]:m?m.wM:null})}dQa(d){d=Number.parseInvariant(d);return 2147483648>d?d:d+-4294967296}Mof(d){return-1<d?d.toString():(d- -4294967296).toString()}KQl(d){let m=0;(d=this.sj.Eb(d))&&(m=d.ja(wc.a.$w,0));return m}GVn(){this.$o.Ksk(this.AWf)}qVm(d){let m=
null;return({Hna:m}=this.Jpf(d)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess||!m.Of&&!this.RZd?!1:m.isEditable&&m.isSupported}eVm(){const d=If.GraphIterator.eb(this.hb.Z1);if(1>=d.Wp())return!0;var m=d.Rd();let A=null;for(;m;){m=If.GraphIterator.eb(m);if(!m.zb(16))return!1;if(!A)A=m.jd(16);else if(A!==m.jd(16))return!1;m=d.It()}return!0}Jpf(d){let m=null;if(!d)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Hna:m};d=this.dQa(d.sO);return(m=this.$o.getById(d))?
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Hna:m}:{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist,Hna:m}}Gef(d,m,A){let R=null;(d=({Hna:R}=this.hQc(m,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=this.qA.Dkl(R)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);A(d)}K_e(d,m,A,R){let da=null;var Ea=null;(d=({Hna:da}=this.hQc(m,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
(d=({tableNode:Ea}=this.YUd(da)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Ea=Bc.TableReader.hh(Ea),d=this.G3.jIm(Ea,A)?this.qA.yEk(da,A)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);R(d)}QZe(d,m,A,R,da,Ea){let ib=null;var Qb=null;(d=({Hna:ib}=this.hQc(m,d)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=({tableNode:Qb}=this.YUd(ib)).returnValue)===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=Bc.TableReader.gg(Qb),m=this.qA.O2a(Qb),Qb=null,d=({uyj:Qb}=this.G3.iIm(m,d-m,A,R,da)).returnValue?this.qA.gEk(ib,Qb)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize);Ea(d)}W6h(d){return d?this.z6.nbi(d):new U.a}VQc(d,m){if(d.nb(m))return d.J(m);const A=RegExp("\t","g");for(const R of d)if(R.key.replace(A," ")===m)return R.value;return null}}
Object(y.a)(df,"AppBindingHelper",null,[904]);class Kf extends Sys.EventArgs{constructor(d,m,A){super();this.E6b=d;this.JXd=m;this.LTf=A}}Object(y.a)(Kf,"OnDataNodeInsertedEventArgs",Sys.EventArgs,[]);class af extends Sys.EventArgs{constructor(d,m,A,R){super();this.E6b=d;this.JXd=m;this.ITi=A;this.LTf=R}}Object(y.a)(af,"OnDataNodeReplacedEventArgs",Sys.EventArgs,[]);var Ji=c(368);class aj{constructor(d,m,A){this.CEa=A.lQa(d);this.mfd=m}get E6b(){return this.CEa.id}}Object(y.a)(aj,"CustomXmlNodeList",
null,[]);class ph{constructor(d,m){this.Oq=new Ji.a;this.Rnd=new U.a;this.iah=new U.a;this.VUg=new U.a;this.JYj=d;this.Mk=m}add(d,m){if(!m)return null;if(this.Rnd.count>=this.JYj.value){var A=this.Rnd.J(0);this.uRh(A);this.VUg.add(A);v.ULS.sendTraceTag(9187593,341,50,"Put the first custom xml node list id: {0} in exceeded quota array as the added custom xml touches the quota which is 1024",A)}A=Eg.a.create().toString();this.Oq.add(A,new aj(d,m,this.Mk));this.Rnd.add(A);return A}get(d){const m=this.Oq.J(d);
if(void 0===m||null===m){if(-1<this.iah.indexOf(d))throw v.ULS.sendTraceTag(9187594,341,50,"Custom xml node list id: {0} is in out of date array",d),Error.invalidOperation(ph.c_f);if(-1<this.VUg.indexOf(d))throw v.ULS.sendTraceTag(9187595,341,50,"Custom xml node list id: {0} is in exceeded quota array where the quota is 1024",d),Error.invalidOperation(ph.SYh);return null}if(this.Mk.lQa(m.E6b)!==m.CEa)throw this.zNi(d),v.ULS.sendTraceTag(9187596,341,50,"Put custom xml node list id: {0} in out of date array as the custom xml document has been changed",
d),Error.invalidOperation(ph.c_f);return m.mfd}zNi(d){this.uRh(d);this.iah.add(d)}uRh(d){this.Oq.remove(d);this.Rnd.remove(d)}}ph.SYh="exceedQuota";ph.c_f="outOfDate";Object(y.a)(ph,"CustomXmlNodeListCache",null,[902]);class ij{constructor(){this.NodeListCacheId=this.CustomXmlId=null;this.NodeIndex=0}}Object(y.a)(ij,"CustomXmlNodePointer",null,[]);class Ng{constructor(d,m){this.sa=new vb.a;this.Mk=d;this.lWb=m}zHb(d){let m,A=null,R=null;const da=({mfd:m}=this.Vki(d)).returnValue;if(void 0===m||null===
m)return{returnValue:da,CEa:R,Bsb:A};A=m[d.NodeIndex];R=this.Mk.lQa(d.CustomXmlId);return{returnValue:void 0!==R&&null!==R&&void 0!==A&&null!==A?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,CEa:R,Bsb:A}}Vki(d){let m=null;try{m=this.lWb.get(d.NodeListCacheId)}catch(A){return{returnValue:this.JXl(A),mfd:m}}return{returnValue:m?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,mfd:m}}yBj(d,m){const A=
[],R=this.lWb.add(d,m);let da;for(let Ea=0;Ea<m.length;Ea++){da=m[Ea];const ib=new ij;ib.CustomXmlId=d;ib.NodeListCacheId=R;ib.NodeIndex=Ea;A.push(this.DRd(ib,da))}return A}DRd(d,m){const A=this.Mk.lQa(d.CustomXmlId),R={};R[OSF.DDA.Marshaling.DataNodeProperties.Handle]=d;R[OSF.DDA.Marshaling.DataNodeProperties.BaseName]=A.getNodeBaseName(m);R[OSF.DDA.Marshaling.DataNodeProperties.NamespaceUri]=A.getNodeNamespaceURI(m);R[OSF.DDA.Marshaling.DataNodeProperties.NodeType]=A.getNodeType(m);return R}s_e(d,
m){this.sa.addHandler(d,m)}y8f(d,m){this.sa.removeHandler(d,m)}dPn(d,m){d=this.DRd(m,d);m=new Kf(m.CustomXmlId,!1,d);return this.c7i(Ng.ZXf,m)}b6c(d,m,A){m=this.DRd(A,m);m[OSF.DDA.Marshaling.DataNodeProperties.Handle]=null;d=this.DRd(A,d);A=new af(A.CustomXmlId,!1,m,d);return this.c7i(Ng.bYf,A)}c7i(d,m){try{this.sa.raiseEvent(d,m)}catch(A){return v.ULS.sendTraceTag(19489935,344,10,"RaiseNodeEvent({0}): action failed. Exception message: {1}",d,A.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}JXl(d){return 0>
d.message.indexOf(":")?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:d.message.split(":")[1].trim()===ph.c_f?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate:d.message.split(":")[1].trim()===ph.SYh?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}Ng.ZXf="OnNodeInsertedInfoReceivedHandlerKey";Ng.bYf="OnNodeReplacedInfoReceivedHandlerKey";Ng.YWi="OnNodeDeletedInfoReceivedHandlerKey";Object(y.a)(Ng,"CustomXmlHelper",null,
[903]);var Oc=c(517),Sg=c(1009),li=c(1038),de=c(1483),ke=c(251);class Ti extends ed.a{constructor(){super();this.FileId=null;this.IsSecondaryRevision=!1}ml(){return Sc.a.closeFileAgave}static construct(d,m){const A=new Ti;A.FileId=d;A.IsSecondaryRevision=m;return A}}Object(y.a)(Ti,"CloseFileAgaveAsyncRequest",ed.a,[]);class Uf extends ed.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.SliceSize=this.FileType=0}ml(){return Sc.a.getFileAgaveApi}static construct(d,m,A,R){const da=
new Uf;da.FileId=d;da.IsCoauthorable=m;da.FileType=A;da.SliceSize=R;return da}}Object(y.a)(Uf,"GetFileAgaveApiRequest",ed.a,[]);class fk extends ed.a{constructor(){super();this.FileId=null;this.SliceIndex=0;this.IsSecondaryRevision=!1}ml(){return Sc.a.getFileSlice}static construct(d,m,A){const R=new fk;R.FileId=d;R.SliceIndex=m;R.IsSecondaryRevision=A;return R}}Object(y.a)(fk,"GetFileSliceRequest",ed.a,[]);class lk{constructor(d,m){this.Xdc=d;this.handler=m}}Object(y.a)(lk,"CloseAsyncRequestData",
null,[]);class dj{constructor(d,m,A,R,da=!1){this.XIf=!1;this.J_h=d;this.fileSize=m;this.Cig=A;this.fileData=R;this.Xdc=da}}Object(y.a)(dj,"DocumentFile",null,[]);class ci{constructor(d,m,A,R){this.a2e=d;this.fileType=m;this.Cig=A;this.handler=R}}Object(y.a)(ci,"GetFileRequestData",null,[]);class Sh{constructor(d,m,A,R){this.controlId=d;this.CAo=m;this.Xdc=A;this.handler=R}}Object(y.a)(Sh,"GetFileSliceRequestData",null,[]);class Xg{constructor(d,m,A,R,da,Ea,ib){this.qm=this.$$a=this.KXa=this.TLa=
null;this.Keo=Qb=>{if(this.uQ&&this.mCa){var pc=Uf.construct(this.uQ(),this.mCa.KSd(this.qVj),Qb.fileType,Qb.Cig);this.TLa=new Sg.a;this.TLa.Iq=pc;this.TLa.status=li.a.requestReady;this.TLa.aH="GetFileAgave";pc=this.E6(()=>{this.tNc();if(2===this.TLa.statusCode&&this.TLa.Mj&&this.TLa.Mj.length&&this.TLa.Mj[0]){var Pc=this.TLa.Mj[0];this.Fxi(Qb.a2e)?(v.ULS.sendTraceTag(7123615,344,15,"App {0} has reach the limit of number of cached files.",Qb.a2e),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit,
null)):(Pc=this.lMh(Qb.a2e,Pc.FileSize,Qb.Cig,null,Pc.IsSecondaryRevision),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Pc))}else v.ULS.sendTraceTag(7123614,344,15,"Fail to obtain the file."),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)});pc.JH(this.TLa);pc.lU()}else this.tNc(),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.Leo=Qb=>{if(this.uQ&&this.mCa){var pc=fk.construct(this.uQ(),Qb.CAo,Qb.Xdc);this.KXa=new Sg.a;this.KXa.Iq=
pc;this.KXa.status=li.a.requestReady;pc=this.E6(()=>{this.tNc();if(2===this.KXa.statusCode&&this.KXa.Mj&&this.KXa.Mj.length&&this.KXa.Mj[0]){var Pc=this.KXa.Mj[0];"undefined"===typeof Pc.SliceData?(v.ULS.sendTraceTag(20711200,344,15,"Undefined error possibly because we failed to get the file slice data"),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)):Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Pc.SliceData)}else v.ULS.sendTraceTag(20711199,344,15,
"Fail to obtain the file."),Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile,null)});pc.JH(this.KXa);pc.lU()}};this.peo=Qb=>{var pc=Qb.Xdc;this.uQ&&this.mCa&&(pc=Ti.construct(this.uQ(),pc),this.$$a=new Sg.a,this.$$a.Iq=pc,this.$$a.status=li.a.requestReady,pc=this.E6(()=>{this.tNc();2===this.$$a.statusCode&&this.$$a.Mj&&this.$$a.Mj.length&&this.$$a.Mj[0]?Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):v.ULS.sendTraceTag(20854626,344,15,"Fail to obtain the file.")}),
pc.JH(this.$$a),pc.lU())};this.IMb=Qb=>{this.tNc();v.ULS.sendTraceTag(7123616,344,15,"Fail to force save the file.");Qb.handler(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null)};this.CZn=(Qb,pc)=>{this.sBa.nb(pc)&&this.sBa.remove(pc)};this.E6=d;this.uQ=m;this.mCa=A;this.qVj=R;this.sBa=new Fk.a;this.je=da;this.Ca=Ea;this.ii=ib;this.ii.v0e(this.CZn)}GWl(d,m,A,R){this.je&&(this.qm=this.je.Yf("UserAction","GetFileAgaveApi"));d=new ci(d,m,A,R);this.Tmf(d)}KWl(d,m,A,R){this.je&&(this.qm=this.je.Yf("UserAction",
"GetFileSliceAgaveApi"));d=new Sh(d,m,A,R);this.pJl(d)}oeo(d,m,A,R){this.je&&(this.qm=this.je.Yf("UserAction","CloseFileAsyncApi"));m=new lk(m,R);this.nJl(m);this.H$i(d,A)}Tmf(d){Oi.a.mR(de.a.getFileAgaveApi,!1,this.Keo,this.IMb,d)}pJl(d){Oi.a.mR(de.a.getFileAgaveApi,!1,this.Leo,this.IMb,d)}nJl(d){Oi.a.mR(de.a.getFileAgaveApi,!1,this.peo,this.IMb,d)}lMh(d,m,A,R,da=!1){const Ea=Xg.LYj++;m=new dj(Ea,m,A,R,da);this.Rsk(d,m);return m}tNc(){this.qm&&(this.qm.stop(),this.qm=null)}Rsk(d,m){this.sBa.nb(d)||
this.sBa.Z(d,new ke.a);this.sBa.J(d).Z(m.J_h,m)}n9h(d,m){let A=null;this.sBa.nb(d)&&({value:A}=this.sBa.J(d).Fc(m,A));A||v.ULS.sendTraceTag(7123617,344,15,"File {0}:{1} doesn't exist",d,m);return A}Fxi(d){return this.sBa.nb(d)?2<=this.sBa.J(d).count:!1}H$i(d,m){return this.sBa.nb(d)?this.sBa.J(d).remove(m)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}static o4e(d){return(new Oc.a).Hha(0,d)}}
Xg.LYj=0;Object(y.a)(Xg,"GetFileApiHelper",null,[900]);var Pe=c(169),xe=c(3),pg=c(65),jm=c(642),vg=c(98),mh=c(1213),Nl=c(392),sn=c(95),bn=c(1116),Ol=c(312),Dm=c(175),sc=c(1515),Hm=c(506),Rm=c(465),hn=c(198),km=c(658);class On extends hn.a{constructor(d,m){super(new km.a,d,m);this.c2b=null}get p9(){return 192}createElement(d){d=super.createElement(d);this.c2b.appendChild(d);return d}Pk(d){d=super.Pk(d);this.c2b.appendChild(d);return d}get xKo(){return this.c2b.cloneNode(!0)}yMb(){super.yMb();this.c2b=
Hm.a.createElement(this.container.ownerDocument,Rm.a.div)}Ugc(){super.Ugc();this.c2b=null}dispose(){super.dispose();this.c2b=null}}Object(y.a)(On,"HtmlDataRenderingView",hn.a,[]);class Ad{constructor(d,m,A,R,da){this.hb=d;this.Z$a=m;this.ga=A;this.F6j=R;this.xEc=da}Xge(d,m,A,R){if(!d.length||!A)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;const da=new Pe.Selection(d,m);try{this.hb.NPb(()=>{this.hb.Ac(da)})}catch(ib){return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}const Ea=
new oi.DictionaryPropertySet;Ea.setValue(Dm.a.LP,A);Ea.setValue(Dm.a.WVa,!0);return 32===this.ga.Qb(xe.a.dna,1,Ea)?(this.ga.Tqa(null,xe.a.dna,Ea,ib=>{const Qb=Ea.ja(Dm.a.H1i,null);R(32===ib.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Qb)}),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Bqf(d,m){let A="";if(!d.length)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,
WQa:A};if(!this.Z$a.CXm)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,WQa:A};let R=new Ze.GraphTransaction(7);const da=new Pe.Selection(d,m);let Ea=null,ib=null;try{this.hb.NPb(()=>{this.hb.Ac(da,void 0,!0);this.Z$a.rJj();R.Db(this.Z$a.zka);Ea=d[0].node.Mc;ib=this.Z$a.zka.Mc;this.Z$a.cJd(pg.InteractiveViewManager.instance.we.ke);this.Z$a.qJj()})}catch(gd){return R.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,WQa:A}}R.dispose();var Qb=[];m=new If.GraphIterator;
m.set(this.Z$a.Dzj);for(var pc=m.Rd();pc;)Qb.push(pc),pc=m.ggf();if(0<Qb.length){this.J8k(Ea,ib);var Pc=new If.GraphIterator;Pc.set(d[0].node);if(!Pc.zb(7))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,WQa:A};pc=Pc.Ps(8);m=this.Nnm(this.Z$a.Dzj,Qb);R=new Ze.GraphTransaction(7);R.Db(m);Pc=new If.GraphIterator;Pc.set(Qb[0]);if(!Pc.zb(8))return R.dispose(),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,WQa:A};Qb=Pc.Ps(8);pc=(new jm.WACStyleSet).iY(pc);if(sc.a.EGl()){Pc=
(new jm.WACStyleSet).iY(Qb);for(let gd=0;gd<pc.DO;gd++){const Cd=pc.PFa(gd);Pc.mqh(vg.a.Yfm(Cd))}Pc.Xhe(Qb)}else pc.Xhe(Qb);Qb=new On(this.F6j,this.xEc);pc=document.createElement("div");Qb.GBb(pc);Qb.YE(m);R.r$c(Qb.$b);R.dispose();A+=Qb.xKo.innerHTML.replace('\\"','"');Qb.dispose();Qb=null}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,WQa:"<HTML>\r\n<HEAD></HEAD>\r\n<BODY>\r\n"+A+"\r\n</BODY>\r\n</HTML>"}}Nnm(d,m){const A=new mh.a;If.GraphIterator.eb(d).Bf(A,1);return this.Mnm(A,
m)}Mnm(d,m){var A=!1;let R,da=null;1===m.length&&10===m[0].type?(A=!0,da=R=m[0]):R=new Nl.a(new sn.a(10,1073872968));d=If.GraphIterator.eb(d);d.Bf(R,1);d.Bj(R);if(A)return R;A=[];for(d=0;d<m.length;d++){const Ea=m[d];23===Ea.type?0<A.length&&(da=this.fmi(R,A),A=[]):A.push(Ea)}0<A.length&&(m=this.fmi(R,A),da=da?R:m);return da}fmi(d,m){var A=!1;let R;1===m.length&&23===m[0].type?(A=!0,R=m[0]):R=new bn.a;d=If.GraphIterator.eb(d);d.Bf(R,1);d.Bj(R);if(A)return R;for(A=0;A<m.length;A++){const da=m[A];da.id=
Rh.a.nil;d.Bf(da,1)}return R}J8k(d,m){d=d.zm;d=Object(Ol.a)(d).DLf();var A=m.Gvj();for(var R=0;R<d.length;R++){var da=d[R];if(131073===da.Oc){if(!m.jxa(da.id)){var Ea=da.clone();m.Xu(Ea,da.id)}}else 1179649===da.Oc?(Ea=da.clone(),Ea.id=da.id,A.fOa(Ea)):1073872969===da.Oc&&(Ea=da.clone(),Ea.id=da.id,A.fOa(Ea))}d=m.$0h();d=Object(Ol.a)(d).DLf();for(A=0;A<d.length;A++)R=d[A],1179649===R.Oc?m.jxa(R.id)||(da=R.clone(),da.id=R.id,m.uV(da)):1073872969!==R.Oc||m.jxa(R.id)||(da=R.clone(),da.id=R.id,m.J7f(da))}}
Object(y.a)(Ad,"HtmlDataGetSetProvider",null,[899]);var Jo=c(147);class oq{constructor(d){this.LYa=d}getOoxml(d,m,A){d=this.Gzh(d);this.LYa.Vdi(d,m,A)}gag(d,m,A,R){this.LYa.gag(d,m,A,R)}Ghe(d,m,A,R,da,Ea,ib,Qb){d=this.Gzh(d);this.LYa.jnj(d,m,A,R,da,Ea,ib,Qb)}i$b(d,m){return this.LYa.i$b(d,m)}Gzh(d){if(fb.a.af(d))return null;d=[new Pe.Selection(d,!0)];return new Jo.SelectionCollection(d,0)}}Object(y.a)(oq,"OoxmlRangeManager",null,[901]);var lm=c(594);class Ko extends lm.a{constructor(){super();this.FileId=
null;this.IsCoauthorable=!1;this.AnchorData=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0}ml(){return Sc.a.ooXmlGet}static construct(d,m,A,R,da,Ea){const ib=new Ko;ib.FileId=d;ib.IsCoauthorable=m;ib.AnchorData=A;ib.ContentControlId=R;ib.InsertLocationWithContentControl=da;ib.WordOperationId=Ea;return ib}}Object(y.a)(Ko,"OoXmlGetRequest",lm.a,[]);class zc extends lm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=
null;this.WordOperationId=0}ml(){return Sc.a.ooXmlRetrieveStyles}static construct(d,m,A,R,da){const Ea=new zc;Ea.FileId=d;Ea.IsCoauthorable=m;Ea.Ooxml=R;Ea.AnchorData=A;Ea.WordOperationId=da;return Ea}}Object(y.a)(zc,"OoXmlRetrieveStylesRequest",lm.a,[]);class Fn extends lm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1;this.AnchorData=this.Ooxml=null;this.WordOperationId=this.InsertLocationWithContentControl=this.ContentControlId=0;this.InsertFileOptions=null}ml(){return Sc.a.ooXmlSet}static construct(d,
m,A,R,da,Ea,ib,Qb){const pc=new Fn;pc.FileId=d;pc.IsCoauthorable=m;pc.Ooxml=R;pc.AnchorData=A;pc.ContentControlId=da;pc.InsertLocationWithContentControl=Ea;pc.WordOperationId=ib;pc.InsertFileOptions=Qb;return pc}}Object(y.a)(Fn,"OoXmlSetRequest",lm.a,[]);var jd=c(28),Em=c(17),Pl;(function(d){d[d.unknown=-1]="unknown";d[d.main=0]="main";d[d.footnote=1]="footnote";d[d.endnote=2]="endnote";d[d.textbox=3]="textbox";d[d.comment=4]="comment";d[d.Lzf=5]="headerFooter"})(Pl||(Pl={}));Object(y.b)("DocumentKindType",
Pl);var Sp=c(1552),vl=c(1627);class fp{constructor(d,m,A,R,da,Ea){this.sI=d;this.x4=m;this.t9c=A;this.aVa=R;this.ooxml=da;this.kGn=Ea}}Object(y.a)(fp,"OoxmlSelectionManagerCallBackData",null,[]);class to{constructor(d){this.AN=null;this.AN=d}}Object(y.a)(to,"SerializableOoxmlData",null,[]);class cn{constructor(d,m,A,R,da,Ea){this.pgh=WordEditorIntl.WordEditorStrings.L_Inserting;this.onFailure=ib=>{this.BX(ib.aVa);ib.x4&&ib.x4(3)};this.onSuccess=ib=>{var Qb=ib.t9c.Mj;Qb?Qb.length?(Qb=ib.t9c.Mj[0])?
Qb.StatusCode?this.QYm(ib.ooxml)?this.QMb("ooxml failed for an unknown reason",ib,0):this.QMb("Agave sent malformated OOXML",ib,7):ib.kGn(ib):this.QMb("ooxml response is null",ib,0):this.QMb("response list is empty",ib,0):this.QMb("response list is null",ib,0)};this.iGn=ib=>{const Qb=ib.t9c.Mj[0];Qb.RetrievedStyles?(ib.sI&&ib.sI(Qb.RetrievedStyles),this.BX(ib.aVa)):this.QMb("retrieved styles is null",ib,0)};this.VFn=ib=>{const Qb=ib.t9c.Mj[0];Qb.OoXml?(ib.sI&&ib.sI(Qb.OoXml),this.BX(ib.aVa)):this.QMb("ooxml is null",
ib,0)};this.jGn=ib=>{const Qb=ib.t9c.Mj[0];ab.a.instance.Wb(new $a.a(0,1,0,()=>{this.ovb(de.a.ooXml,!0,()=>{Ab.App.li.sle(()=>{var pc=Qb.InsertedContentInfo;if(""!==pc){pc=rb.b(pc);var Pc=vl.a(pc.AN);pc=Pc.nTa;const gd=vl.d(Pc.cS),Cd=Pc.ZHa;Pc=vl.d(Pc.n5);pc=pc.toString()+"|"+rb.c(gd)+"|"+Cd.toString()+"|"+rb.c(Pc);ib.sI(pc)}else ib.sI(pc)});this.BX(ib.aVa)},(pc,Pc)=>{this.BX(ib.aVa);this.hHa("we succeeded to set ooxml but failed in the second save, most likely, the user can't see the change yet. [errorCode: {0}]",
Pc);ib.sI(null)},null,this.pgh,null)}))};this.BT=d;this.$bb=m;this.uQ=A;this.yua=R;this.ovb=da;this.B1g=Ea}Vdi(d,m,A){this.gZh(d,m,A,"ForceSaveAndGetOoXmlForSelection",!1,this.VFn,null,null,0,0,0,null,(R,da,Ea)=>Ko.construct(R,da,Ea,0,0,0))}gag(d,m,A,R){const da=this.BT.Yf("Task","ForceSaveAndRetrieveStyles");try{const Ea=zc.construct(this.uQ(),this.$bb(),"{}",d,m),ib=Object.assign(new Sg.a,{Iq:Ea,status:li.a.requestReady,aH:"OoxmlRetrieveStyles"}),Qb=new fp(A,R,ib,da,d,this.iGn);this.ovb(de.a.ooXml,
!1,this.onSuccess,this.onFailure,Qb,null,ib)}catch(Ea){this.hHa("failed in the call to retrieveStyles. most likely during ForceSave. [e:{0}] [callstack: {1}]",Ea.message,Ea.stack),this.BX(da),R(0)}}jnj(d,m,A,R,da,Ea,ib,Qb){void 0===m||null===m?(this.hHa("Agave sent NULL OOXML"),Qb(4)):this.$bb()?this.gZh(d,ib,Qb,"ForceSaveAndSetOoXmlForSelection",!0,this.jGn,m,this.pgh,A,R,da,Ea,Fn.construct):(this.hHa("Document is non-coauthorable. Disabled for SET OOXML"),Qb(6))}i$b(d,m){if(!d)return new U.a;var A=
d.split("|");if(4!==A.length)return new U.a;d=Number.parseLocale(A[0]);var R=rb.b(A[1]);R=vl.b(R);const da=Number.parseLocale(A[2]);A=rb.b(A[3]);const Ea=vl.b(A);A=new U.a;let ib=!1,Qb=!1,pc=!1,Pc=null,gd,Cd=-1;for(let ae=0;ae<m.count;ae++)if(gd=m.J(ae).ja(wc.a.Wc,0),ib)if(pc||(Cd?(Cd!==Pc.characterData.length&&A.add(jd.a.createTextRange(Pc,Cd,Pc.characterData.length)),A.add(jd.a.tl(Pc))):A.add(jd.a.create(Pc)),pc=!0),da===gd){Qb=!0;(d=this.aqf(m.J(ae),Ea))&&A.add(jd.a.createTextRange(m.J(ae),0,d));
break}else A.add(jd.a.create(m.J(ae)));else if(d===gd&&(ib=!0,Pc=m.J(ae),Cd=this.aqf(Pc,R),da===gd)){Qb=!0;d=this.aqf(Pc,Ea);d===Cd?A.add(jd.a.Uc(m.J(ae),Cd)):A.add(jd.a.createTextRange(m.J(ae),Cd,d));break}return ib&&Qb?A:new U.a}aqf(d,m){d=this.yua.pTa(d.characterData,d.ra);return this.yua.gDb(d,m)}gZh(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae){R=this.BT.Yf("Task",R);const Xd={};try{let xp=0,vj=0,Jr=0,PC=0;if(d){var se=d.lb;if(se)if(Em.SelectionEditor.GGa(se))this.hHa("User has selected an anchored object and it's not yet supported."),
this.BX(R),A(8);else{var Xe=se.Pa.node,Be=se.Rc.node;xp=Xe.ja(wc.a.Wc,0);Jr=Be.ja(wc.a.Wc,0);vj=qe.a.fjb(se,!0);PC=qe.a.fjb(se,!1);Xd.startParaId=xp;Xd.endParaId=Jr;Xd.cpBegin=vj;Xd.cpEnd=PC;if(this.yua){var Hg=this.yua.pTa(Xe.characterData,Xe.ra),Xh=this.yua.Qpc(Hg,vj,this.B1g);d=Xh;Hg=this.yua.pTa(Be.characterData,Be.ra);Hg=Xh=this.yua.Qpc(Hg,PC,this.B1g);var Fl=Xe.ja(wc.a.uj,2147483646),Gm=Be.ja(wc.a.uj,2147483646);Xd.textIdStart=Fl;Xd.textIdEnd=Gm;var em=Xe.foa;Xd.documentKind=Pl[em];if(-1===
em||1===em||2===em)this.hHa("Unsupported DocumentKind is "+em),this.BX(R),A(2);else{var $n=new Sp.a(1,xp,Fl,d,Jr,Gm,Hg,em),Ep=new to(vl.c($n)),Mm=rb.c(Ep),Mk=Cd?JSON.stringify({["_importChangeTrackingMode"]:Cd.importChangeTrackingMode,["_importPageColor"]:Cd.importPageColor,["_importParagraphSpacing"]:Cd.importParagraphSpacing,["_importStyles"]:Cd.importStyles,["_importTheme"]:Cd.importTheme}):"",gm=ae(this.uQ(),this.$bb(),Mm,ib,pc,Pc,gd,Mk),cl=Object.assign(new Sg.a,{Iq:gm,status:li.a.requestReady,
aH:"OoxmlSelection"}),Sj=new fp(m,A,cl,R,ib,Ea);this.ovb(de.a.ooXml,da,this.onSuccess,this.onFailure,Sj,Qb,cl)}}else this.hHa("IWordTextOffsetTranslator is null as it did not resolve"),this.BX(R),A(5)}else this.BX(R),A(2)}else this.hHa("SelectionCollection is null"),this.BX(R),A(9)}catch(xp){this.hHa("failed in the call to GetOoxmlForSelection. most likely during ForceSave. [e:{0}] [logData: {1}] [callstack: {2}]",xp.message,Xd,xp.stack),this.BX(R),A(0)}}QMb(d,m,A){this.hHa("[reason:{0}].",d);m.x4&&
m.x4(A)}QYm(d){let m=!0;const A=this.BT.Yf("Task","SetOoxmlIsValidXML");try{const R=Sys.Net.XMLDOM(d);if(0<R.getElementsByTagName("parsererror").length)m=!1;else{const da=R.parseError;void 0!==da&&null!==da&&da.errorCode&&(m=!1)}}catch(R){m=!0,this.hHa("Failed in parsing the xml string: [message: {0}] [callstack: {1}]",R.message,R.stack)}finally{A.stop()}return m}BX(d){d&&d.stop()}hHa(d,...m){v.ULS.sendTraceTag.apply(null,[7902996,341,15,"OoXml Operation Failed. "+d].concat(m))}}Object(y.a)(cn,"OoxmlSelectionManager",
null,[898]);var Pk=c(23),zq=c(84),Qk=c(117),kh=c(37);class bm{Sci(d,m,A){({Sdo:d,cpBegin:R,Ydo:m,cpEnd:A}=this.aRk(d,m,A));if(d===m)d=Pk.SelectionFactory.mJ(d,R,A);else{var R=Pk.SelectionFactory.ne(d,R);m=Pk.SelectionFactory.ne(m,A);d=zq.OutlineReader.jHf(d)?R:Pk.SelectionFactory.Iy(R,m.Oe?m.Oe.Pa:m.Pa)}return d}aRk(d,m,A){let R;d=bm.cnf(d);m=bm.cnf(m);A=bm.cnf(A);if(d.contains(m)){var da=bm.Xcc(d.Pa)?d.Pa.node:A.Pa.node;R=d.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(da):d.Pa.contextId===
ic.a.paragraph?0:d.Pa.cpBegin;if(bm.Xcc(d.Rc))if(1===d.length||2===d.length&&d.Pa.node.id===d.Rc.node.id&&d.Pa.contextId===ic.a.Fd&&d.Rc.contextId===ic.a.Vc)if(A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc){var Ea=Qk.a.eb(A.Rc.node);Ea.Ip();Ea.Ps(11);kh.OutlineElementNavigator.ns(Ea,!0,!1)?(kh.OutlineElementNavigator.Ee(Ea),Ea=Ea.currentNode):Ea=A.Rc.node}else Ea=A.Rc.node;else Ea=d.Rc.node;else A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc?(Ea=Qk.a.eb(A.Rc.node),Ea.Ip(),Ea.Ps(11),
kh.OutlineElementNavigator.ns(Ea,!0,!1)?(kh.OutlineElementNavigator.Ee(Ea),Ea=Ea.currentNode):Ea=A.Rc.node):Ea=A.Rc.node;d=d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?A.Rc.contextId!==ic.a.paragraph&&A.Rc.contextId!==ic.a.Vc||A.Rc.node.id===Ea.id?Qe.ParagraphReader.textLength(Ea):0:d.Rc.node.id===m.Rc.node.id?A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc?Ea===A.Rc.node?Qe.ParagraphReader.textLength(A.Rc.node):d.Rc.cpEnd-m.Rc.cpEnd:A.Rc.cpEnd+d.Rc.cpEnd-m.Rc.cpEnd:d.Rc.cpEnd}else m.contains(d)?
(d=Em.SelectionEditor.Pl(A)?A:Em.SelectionEditor.xwa(A,{gC:!0,gt:!1,ZD:!1,QF:!0}),da=Ea=d.Pa.node,R=d=d.Pa.cpBegin):bm.NWk(d,m)?d.Pa.node.id===d.Rc.node.id?m.Pa.node.id===d.Pa.node.id&&d.Pa.cpBegin<m.Pa.cpBegin?(da=Ea=d.Pa.node,R=d.Pa.contextId===ic.a.paragraph?0:d.Pa.cpBegin,d=m.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(Ea):m.Pa.cpBegin):(A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc?(da=Qk.a.eb(A.Rc.node),da.Ip(),da.Ps(11),kh.OutlineElementNavigator.ns(da,!0,!1),kh.OutlineElementNavigator.Ee(da),
da=da.currentNode,R=0):(da=A.Rc.node,R=A.Rc.cpEnd),Ea=da,d=d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(Ea):R+d.Rc.cpEnd-m.Rc.cpEnd):bm.Xcc(d.Pa)&&(d.Pa.node.id!==m.Pa.node.id||d.Pa.contextId===ic.a.paragraph||m.Pa.contextId===ic.a.Vc||d.Pa.contextId!==ic.a.Vc&&d.Pa.cpBegin<=m.Pa.cpBegin)?(da=d.Pa.node,R=d.Pa.contextId===ic.a.paragraph?0:d.Pa.contextId===ic.a.Vc?m.Pa.node.id===d.Pa.node.id?A.Pa.contextId===ic.a.paragraph||A.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(da):
A.Pa.cpBegin:Qe.ParagraphReader.textLength(da):d.Pa.cpBegin,d=bm.GFl(d),Ea=d.node,d=m.Pa.contextId===ic.a.paragraph||m.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(d.node):m.Pa.cpBegin):bm.Xcc(d.Rc)?(A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc?(m=Qk.a.eb(A.Rc.node),m.Ip(),m.Ps(11),kh.OutlineElementNavigator.ns(m,!0,!1),kh.OutlineElementNavigator.Ee(m),da=m.currentNode,R=0):(da=A.Rc.node,R=A.Rc.cpEnd),Ea=d.Rc.node,d=d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(Ea):
d.Rc.cpEnd):(A.Rc.contextId===ic.a.paragraph||A.Rc.contextId===ic.a.Vc?(da=Qk.a.eb(A.Rc.node),da.Ip(),da.Ps(11),kh.OutlineElementNavigator.ns(da,!0,!1),kh.OutlineElementNavigator.Ee(da),da=da.currentNode,R=0):(da=A.Rc.node,R=A.Rc.cpEnd),Ea=da,d=d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(da):R+d.Rc.cpEnd-m.Rc.cpEnd):d.Pa.node.id===m.Rc.node.id&&(d.Pa.cpBegin>=m.Rc.cpEnd||d.Pa.contextId===ic.a.Vc)?(A.Rc.contextId===ic.a.Vc||A.Rc.contextId===ic.a.paragraph?
(da=Qk.a.eb(A.Rc.node),da.Ip(),da.Ps(11),kh.OutlineElementNavigator.ns(da,!0,!1),kh.OutlineElementNavigator.Ee(da),da=da.currentNode,R=d.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(d.Pa.node)-m.Rc.cpEnd:d.Pa.cpBegin-m.Rc.cpEnd):(da=A.Rc.node,R=d.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(da):d.Pa.cpBegin-m.Rc.cpEnd+A.Rc.cpEnd),Ea=d.Pa.node.id===d.Rc.node.id?da:d.Rc.node,d=da===Ea?R+d.Rc.cpEnd-d.Rc.cpBegin:d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(Ea):
d.Rc.cpEnd):(da=d.Pa.node,R=d.Pa.contextId===ic.a.paragraph?0:d.Pa.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(d.Pa.node):d.Pa.cpBegin,Ea=d.Rc.node,d=d.Rc.contextId===ic.a.paragraph||d.Rc.contextId===ic.a.Vc?Qe.ParagraphReader.textLength(d.Rc.node):d.Rc.cpEnd);return{Sdo:da,cpBegin:R,Ydo:Ea,cpEnd:d}}static cnf(d){d.isForward||(d=d.toArray(),d.reverse(),d=new Pe.Selection(d,!0));return d}static NWk(d,m){const A=d.toArray(),R=m.toArray();let da,Ea;if(d.contains(m)||m.contains(d))return!1;for(let ib=
0;ib<d.length;ib++){da=A[ib];for(let Qb=0;Qb<m.length;Qb++)if(Ea=R[Qb],da.node.id===Ea.node.id&&(da.contextId===ic.a.paragraph||Ea.contextId===ic.a.paragraph||da.contextId===ic.a.Vc&&Ea.contextId===ic.a.Vc||da.contextId===ic.a.Fd&&Ea.contextId===ic.a.Fd&&(da.cpBegin>=Ea.cpBegin&&da.cpBegin<Ea.cpEnd||Ea.cpBegin>=da.cpBegin&&Ea.cpBegin<da.cpEnd)))return!0}return!1}static Xcc(d){return!!d.node.anchor&&!d.node.anchor.JR&&d.node.Sy}static GFl(d){if(!bm.Xcc(d.Pa))return null;let m=d.Pa;d=d.GO();for(d.moveNext();d.moveNext();)if(bm.Xcc(d.current))m=
d.current;else break;return m}}Object(y.a)(bm,"SetDataVirtualSelectionMerger",null,[897]);var mm=c(29),Df=c(21);class Ym{constructor(d,m,A){this.ga=d;this.hb=m;this.qA=A}iRm(){this.hb.Z1||v.ULS.sendTraceTag(8452246,341,15,"Unexpected error to selectionManager and the selectionRoot cannot return");return 1<If.GraphIterator.eb(this.hb.Z1).Wp()}qog(){let d=null;const m=If.GraphIterator.eb(this.hb.Z1);if(m.Rd()){const A=If.GraphIterator.eb(m.currentNode);m.SGa&&m.Rd()&&Bc.TableReader.isTable(m)?d=m.currentNode:
A.zb(14)&&(d=A.jd(14))}return d?{returnValue:!0,Ele:d}:{returnValue:!1,Ele:d}}qQo(d,m){let A="";var R=null;for(let da=0;da<m.length;da++)if(d.equals(m[da].node)){R=m[da];break}if(R){d=Qe.ParagraphReader.text(R.node);switch(R.contextId){case ic.a.paragraph:A+=d;break;case ic.a.Fd:m=R.cpBegin;R=R.cpEnd-m;0<R&&(A+=d.substr(m,R));break;case ic.a.Vc:break;default:return v.ULS.sendTraceTag(8452249,341,15,"Unexpected context type when trying get selected text of paragraph node, context type is:"+R.contextId),
{returnValue:!1,Mkc:A}}return{returnValue:!0,Mkc:A}}return{returnValue:!1,Mkc:A}}bDj(d,m,A){let R="",da=!1;d=If.GraphIterator.eb(d);const Ea=d.Wp();for(let Qb=0;Qb<Ea;Qb++){if(d.qF(Qb)){d.Rd();if(12===d.Xe){if(A)R+=Qe.ParagraphReader.text(d.currentNode);else{var ib=void 0;({Mkc:ib}=this.qQo(d.currentNode,m)).returnValue&&(R+=ib,da=!0)}Qb!==Ea-1&&(R+="\r")}else if(14===d.Xe)for(ib=d.Tb(1);ib;){for(ib=d.Tb(1);ib;)da=({wIc:ib}=this.bDj(ib,m,A)).returnValue||da,R+=ib,d.SGa||(R+="\t"),ib=d.It();R+="\r\n";
ib=d.It()}d.sc()}d.sc()}return{returnValue:da,wIc:R}}jhi(d){const m={rows:[],headers:[]};if(!({Ele:Qb}=this.qog()).returnValue)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType,gge:m};const A=If.GraphIterator.eb(Qb),R=[];var da={};if((da.isSelectionManagerNull=!this.hb)||(da.isSelectionCollectionNull=!this.hb.ib))return v.ULS.sendTraceTag(8452252,341,10,"Unexpected error to selectionManager and contigousSelection data cannot return.{0}",da),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
gge:m};for(var Ea of this.hb.ib)R.push(...Ea.toArray());da=[];var ib;var Qb=this.qA.O2a(Qb);Ea=0;for(ib=A.Tb(1);ib;){ib=!1;d===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&Ea<Qb&&(ib=!0);for(var pc=A.Tb(1);pc;){if(!mm.TableCellReader.$r(pc)){let Pc="";(({wIc:Pc}=this.bDj(pc,R,ib)).returnValue||ib)&&da.push(Pc)}pc=A.It()}0<da.length&&(pc=Array.clone(da),ib?Array.add(m.headers,pc):Array.add(m.rows,pc),Array.clear(da));ib=A.It();Ea++}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,gge:m}}Unj(d,
m,A){if(this.iRm())this.yNm()?this.Ccf(d,m,A,!1):A(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection);else{let R;if(({Ele:R}=this.qog()).returnValue){let da,Ea;({KSm:da,Ldo:Ea}=this.Ydm(R));da?(v.ULS.sendTraceTag(8458370,344,15,"SetSelectedTable failed due to the attempt to set data in a partially selected table"),A(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)):this.UUm(Ea,m,d)?this.lDl(R,Ea,d,m,A):this.Ccf(d,m,A,!0)}else this.Ccf(d,m,A,!1)}}gim(d){let m="";if(mm.TableCellReader.$r(d))return{returnValue:!1,
wIc:m};d=If.GraphIterator.eb(d);const A=d.Wp();for(let R=0;R<A;R++)d.qF(R)&&(d.Rd(),12===d.Xe&&(m+=Qe.ParagraphReader.text(d.currentNode),R!==A-1&&(m+="\r")),d.sc()),d.sc();return{returnValue:!0,wIc:m}}QDi(d){let m=!1;Bc.TableReader.b3h(d,A=>{mm.TableCellReader.$r(A)&&(m=!0)});return m}phm(d,m,A){let R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const da={},Ea=this.qA.O2a(d),ib=Bc.TableReader.gg(d)-(m?Ea:0),Qb=Bc.TableReader.hh(d);let pc,Pc,gd,Cd,ae;pc=A[OSF.DDA.Marshaling.BindingParameterKeys.StartRow];
Pc=A[OSF.DDA.Marshaling.BindingParameterKeys.RowCount];gd=A[OSF.DDA.Marshaling.BindingParameterKeys.StartCol];A=A[OSF.DDA.Marshaling.BindingParameterKeys.ColCount];if(0>pc||pc>=ib||pc+Pc>ib||0>gd||gd>=Qb||gd+A>Qb)R=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn;else{Cd=Pc?pc+Pc-1:ib;ae=A?gd+A-1:Qb;d=If.GraphIterator.eb(d);const Xd=[];let se;da.rows=[];da.headers=[];Df.forEachCellInTable(d,(Xe,Be,Hg)=>{const Xh=m&&Be<Ea,Fl=m?Ea:0;Be=Be>=pc+Fl&&Be<=Cd+Fl;Hg=Hg>=gd&&Hg<=ae;(Xh||Be)&&
Hg&&({wIc:se}=this.gim(Xe.currentNode)).returnValue&&Xd.push(se);Xe.SGa&&0<Xd.length&&(Xe=Array.clone(Xd),Array.add(Xh?da.headers:da.rows,Xe),Array.clear(Xd));return!0})}return{returnValue:R,zil:da}}isTable(d,m){return d.id===m.id&&14===d.type?!0:!1}v1d(d){if(!d||14!==d.type)return!1;let m=!0;const A=this.rof(),R=new If.GraphIterator;R.set(d);Df.forEachCellInTable(R,da=>mm.TableCellReader.$r(da.currentNode)||this.B_d(da.currentNode,A)?!0:m=!1);return m}VUm(){let d;return({Ele:d}=this.qog()).returnValue?
this.v1d(d):!1}lDl(d,m,A,R,da){const Ea=Ac.a.Cvh,ib=[];ib.push(m);ib.push(A);ib.push(R);ib.push(d);32===this.ga.processAction(Ea,1)?this.ga.Tqa(null,Ea,ib,Qb=>{32!==Qb.response&&v.ULS.sendTraceTag(8458371,344,10,"SetSelectedTable failed with error {0}",Qb.response);da(32===Qb.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):(v.ULS.sendTraceTag(8458372,344,10,"SetSelectedTable failed due to the action is not enabled"),da(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection))}Ccf(d,
m,A,R){R?this.ga.processAction(xe.a.jU,2):this.ga.processAction(xe.a.QH,2);m=this.$7k(d,m);d=new oi.DictionaryPropertySet;d.setValue(Dm.a.LP,m);d.setValue(Dm.a.Yja,!0);m=xe.a.dna;32===this.ga.processAction(m,1)?this.ga.Tqa(null,m,d,da=>{A(32===da.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):A(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}$7k(d,m){const A=document.createElement("div"),R=document.createElement("table");
var da=document.createAttribute("border");da.value="1";R.attributes.setNamedItem(da);A.appendChild(R);if(d&&d.length){da=document.createElement("tr");R.appendChild(da);for(var Ea=0;Ea<d.length;++Ea){var ib=document.createElement("th");ib.innerText=d[Ea]?d[Ea].toString():"";da.appendChild(ib)}}for(d=0;d<m.length;++d)for(da=m[d],Ea=document.createElement("tr"),R.appendChild(Ea),ib=0;ib<da.length;++ib){const Qb=document.createElement("td");Qb.innerText=da[ib]?da[ib].toString():"";Ea.appendChild(Qb)}return A.innerHTML}UUm(d,
m,A){if(d.length!==m.length+(A?1:0))return!1;if(A){if(d[0].length<A.length)return!1;for(A=1;A<d.length;++A)if(d[A].length<m[A-1].length)return!1}else for(A=0;A<d.length;++A)if(d[A].length<m[A].length)return!1;return!0}rof(){const d=[];for(const m of this.hb.ib)d.push(...m.toArray());return d}Ydm(d){let m=!1,A=!1,R=!1;const da=[],Ea=this.rof();d=If.GraphIterator.eb(d);var ib=d.Tb(1);let Qb=!0;for(;ib;){ib=[];let pc=d.Tb(1);for(;pc;)mm.TableCellReader.$r(pc)?A=!0:this.B_d(pc,Ea)?(Qb&&(R=!0),ib.push(pc)):
m=!0,pc=d.Oj();Qb=!1;da.push(ib);d.sc();ib=d.Oj()}return{KSm:m,Cmp:A,zmp:R,Ldo:da}}B_d(d,m){var A=this.s$h(d);d=this.Obi(d);let R=0,da=!1;for(;R<m.length;++R){const Ea=m[R];if(Ea.node===A)if(Ea.contextId===ic.a.paragraph||Ea.contextId===ic.a.Vc){da=!0;++R;break}else return!1}if(!da||A===d)return da;for(;R<m.length;++R)if(A=m[R],A.node===d)if(A.contextId===ic.a.paragraph||A.contextId===ic.a.Vc){da=!0;break}else return!1;return da}isSelected(d,m){let A;for(let R=0;R<m.length;++R)if(A=If.GraphIterator.eb(m[R].node),
A.zb(16)&&A.jd(16)===d)return!0;return!1}Obi(d){d=If.GraphIterator.eb(d);var m=d.Wp();for(--m;-1<m;--m){if(d.qF(m)){d.Rd();if(12===d.Xe)return d.currentNode;if(14===d.Xe){const A=this.Obi(d.currentNode);if(A)return A}d.sc()}d.sc()}return null}s$h(d){d=If.GraphIterator.eb(d);const m=d.Wp();for(let A=0;A<m;++A){if(d.qF(A)){d.Rd();if(12===d.Xe)return d.currentNode;if(14===d.Xe){const R=this.s$h(d.currentNode);if(R)return R}d.sc()}d.sc()}return null}yNm(){let d=null,m=null,A=If.GraphIterator.eb(this.hb.Z1);
0<A.Wp()&&A.Rd()&&A.Rd()&&14===A.Xe&&(d=A.currentNode);A=If.GraphIterator.eb(this.hb.Z1);1<A.Wp()&&A.lY()&&A.Rd()&&14===A.Xe&&(m=A.currentNode);return d&&!this.v1d(d)||m&&!this.v1d(m)?!1:!0}Zdm(d){const m={},A=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;if(d.KZd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported,txj:m};const R=this.rof(),da=If.GraphIterator.eb(d);let Ea=-1,ib=-1,Qb=-1,pc=-1;Df.forEachCellInTable(da,(Pc,gd,Cd)=>{if(this.isSelected(Pc.currentNode,
R)){if(-1===Ea||-1===ib)Ea=gd,ib=Cd;Qb=Qb<gd?gd:Qb;pc=pc<Cd?Cd:pc}else if(-1<ib&&Cd>=ib&&Cd<=pc)return!1;return!0});A===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(d=this.qA.O2a(d),Qb>=d&&(Ea=Ea>=d?Ea-d:0,m[OSF.DDA.Marshaling.TableSubsetKeys.StartRow]=Ea,m[OSF.DDA.Marshaling.TableSubsetKeys.RowCount]=Qb-d-Ea+1),m[OSF.DDA.Marshaling.TableSubsetKeys.StartColumn]=ib,m[OSF.DDA.Marshaling.TableSubsetKeys.ColumnCount]=pc-ib+1);return{returnValue:A,txj:m}}jIm(d,m){let A=0;for(let R=0;R<m.length;R++)m[R].length>
A&&(A=m[R].length);return A===d}iIm(d,m,A,R,da){let Ea=[];da||(A=Array(d));return(!A&&!d||A&&A.length===d)&&m===R.length?(Ea=A.concat(R),{returnValue:!0,uyj:Ea}):{returnValue:!1,uyj:Ea}}GWm(d,m,A,R,da){d=d?this.qA.O2a(m):0;if(!A||!R||A.length<R.length+d)return!1;if(da){if(da.length!==d)return!1;for(m=0;m<R.length+d;m++)if(A[m].length<(m<d?da[m]:R[m-d]).length)return!1}else for(da=0;da<R.length;da++)if(A[da].length<R[da].length)return!1;return!0}oQo(d,m,A){const R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;
let da=0,Ea=0;da=A.startRow;Ea=A.startCol;const ib=this.qA.O2a(d),Qb=m?ib:0,pc=[],Pc=[],gd=If.GraphIterator.eb(d);Df.forEachCellInTable(gd,(Cd,ae,Xd)=>{if(!mm.TableCellReader.hg(gd)){const se=ae>=da+Qb;Xd=Xd>=Ea;(m&&ae<ib||se)&&Xd&&pc.push(Cd.currentNode);Cd.SGa&&0<pc.length&&(Cd=Array.clone(pc),Pc.push(Cd),Array.clear(pc))}return!0});return{returnValue:R,vIo:Pc}}UGn(d,m,A){const R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,da=[],Ea=[],ib=[],Qb=A?A.length:0;for(let pc=0;pc<m.length+Qb;pc++){const Pc=
pc<Qb?A[pc]:m[pc-Qb],gd=d[pc];for(let Cd=0;Cd<Pc.length;Cd++)Ea.push(gd[Cd]),ib.push(Pc[Cd])}da.push(Ea);da.push(ib);return{returnValue:R,KIo:da}}}Object(y.a)(Ym,"TableMatrixHelper",null,[]);var jn=c(1870),lf=c(85),mk=c(82),Af=c(62),Tg=c(1603);class hl extends Tg.a{constructor(d,m,A){super(d,m,A)}E3o(){return ld.a.$ke}Foc(d){let m=null;if(this.zT&&!d)return v.ULS.sendTraceTag(594408837,307,10,"No htmlDomContent"),{returnValue:!1,$va:m};if(!this.E3o())return this.Ic.Yb(mk.a.soa,{["Reason"]:Af.a.Zyh}),
{returnValue:!1,$va:m};try{const A=hl.k5k(d);m=jSanity.sanitize(A)}catch(A){return v.ULS.shipAssertTag(6423694,307,!1),this.Ic.Yb(mk.a.soa,{["Reason"]:Af.a.H5e}),{returnValue:!1,$va:m}}return{returnValue:!0,$va:m}}static k5k(d){const m={};m.inputString=d;m.allowLinks=!0;m.customProtocols={};m.customProtocols["data:image/"]=1;m.externalContentCallback=(A,R,da,Ea)=>{let ib=!1;if("attribute"===A&&"src"===R){R=lf.a.eP(Ea);for(const Qb of R)if(da.startsWith(Qb)){ib=!0;break}R=lf.a.eP(m.customProtocols);
for(const Qb of R)if(da.startsWith(Qb)){ib=!0;break}}ib||(da="CSSURL"===A?'url("about:blank")':"about:blank");return da};return m}}Object(y.a)(hl,"ExternalHtmlStringImportStrategy",Tg.a,[]);var Qq=c(224);class la{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc=null){var gd;this.cFc=!1;this.dpo=4;this.cpo=(Cd,ae,Xd,se,Xe)=>{if(1===Xd)return 32;if(!Xe||Xe.length!==this.dpo)return 8;Cd=Xe[0];se=Xe[1];ae=Xe[2];Xd=Xe[3];Xe=this.Lc.Pc(15);Xe.Db(Xd);if(32!==this.ga.processAction(xe.a.Wna,2))return 8;Xd=0;if(se){for(var Be=
0;Be<se.length;++Be){var Hg=Cd[Xd];se[Be]&&this.uoj(Hg[Be],se[Be].toString())}Xd++}for(se=0;se<ae.length;++se){Be=ae[se];Hg=Cd[Xd];for(let Xh=0;Xh<Be.length;++Xh)Be[Xh]&&this.uoj(Hg[Xh],Be[Xh].toString());Xd++}Xe.dispose();return 32};this.Yqi=(Cd,ae,Xd,se,Xe,Be)=>{var Hg,Xh;if(ae===xe.a.dna&&(null===(Hg=Xd.view)||void 0===Hg?0:Hg.ue)&&(Hg=Xd.view,Hg.mb&&(null===(Xh=this.Nk)||void 0===Xh?0:Xh.yia(Hg.mb.qg))))return null;Xh=this.ry.J(ae.toString());this.hga&&Be&&Object(Oh.a)(88,Be)&&(Hg=this.hga.bbd(),
Hg.r3b("ImportDataAction"),Be.setValue(Dm.a.lva,Hg));return this.WGd.create(Cd,ae,Xh,new Pd.a(()=>this.YLc(ae,Be)),Xd,se,Xe,Be)};this.ga=d;this.Ad=m;this.Md=R;this.AZj=Ea;this.Lc=da;this.lk=ib;this.hga=Pc;this.HK=A;this.Nk=pc;Qb&&(this.cFc=Qb.$("UseClipboardDataHelperInMultiLineImportIsEnabled"));this.ry=new Fk.a;this.ry.Z(xe.a.SDd.toString(),262145);this.ry.Z(xe.a.dna.toString(),262145);if(null===(gd=null===n.AFrameworkApplication||void 0===n.AFrameworkApplication?void 0:n.AFrameworkApplication.K)||
void 0===gd?0:gd.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveEmptyParagraphAfterPasteIsEnabled",!1))d=this.ry.J(xe.a.dna.toString()),this.ry.Z(xe.a.dna.toString(),d|524288)}get WGd(){return this.AZj.value}Ub(){this.ga.KT(xe.a.SDd,ic.a.view,this.Yqi,1028);this.ga.KT(xe.a.dna,ic.a.view,this.Yqi,4|(n.AFrameworkApplication.pu&&16384));this.ga.fb(Ac.a.Cvh,ic.a.view,this.cpo,4)}uoj(d,m){d=If.GraphIterator.eb(d);d.Tb(1)||this.HK.Z7(d,!0);d=kh.OutlineElementNavigator.Ee(d);this.Md.Ge(jd.a.Uc(d,
0),m)}YLc(d,m){if(d===xe.a.SDd)return new jn.a(m,this.Ad,this.lk,this.cFc,Qq.WoncaApp.instance.PUa);if(d===xe.a.dna)return new hl(m,this.Ad,Qq.WoncaApp.instance.PUa);v.ULS.shipAssertTag(6348963,341,!1,"Could not find an import strategy for action {0}",d);return null}}Object(y.a)(la,"AppsForOfficeApiActor",null,[]);class bb{constructor(d,m,A,R=null){this.appName=d;this.appVersion=m;this.clientMode=A;this.formFactor=R||"DefaultSettings"}}Object(y.a)(bb,"HostInfo",null,[]);class qb{constructor(d,m,A=
null){this.appUILocale=d;this.dataLocale=m;this.lcid=A}}Object(y.a)(qb,"LocaleInfo",null,[]);var ac=c(1472),yc=c(1624),$c=c(96);class Vd{constructor(d=null,m=null,A,R=null,da=null,Ea=null,ib=null,Qb=null,pc=null,Pc=null,gd=null,Cd=null,ae=null,Xd=null,se=null,Xe=null){this.osfOmexBaseUrl=d;this.devCatalogUrl=m;this.spBaseUrl=R;this.docUrl=da;this.pageBaseUrl=Ea;this.localizedScriptsUrl=ib;this.localizedImagesUrl=Qb;this.localizedStylesUrl=pc;this.localizedResourcesUrl=Pc;this.firstPartyManifestCDNUrl=
gd;this.sdxCdnUrl=Cd;this.sdx1CdnUrl=Xd;this.sdxDmsUrl=ae;this.sovereignFederationDMSToken=se;this.sovereignFederationDMSTokenSuffix=Xe}}Object(y.a)(Vd,"UrlInfo",null,[]);class me{constructor(d,m=null){this.userNameHashCode=d;this.loggableUserId=m}}Object(y.a)(me,"UserInfo",null,[]);class Md{constructor(){this.hostFeatureGateFlag=0;this.gKc=!1}zai(){return new bb(OSF.AppName.WordWebApp,"16",OSF.ClientMode.ReadWrite)}tci(){const d=De.a.ug(n.AFrameworkApplication.lcid);return new qb(d?d.name:null,ac.a.dataCulture.name,
n.AFrameworkApplication.lcid.toString())}t5l(){n.AFrameworkApplication.K.$("SetAppContextInIframeNameIsEnabled")&&(this.hostFeatureGateFlag|=1);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SetAppContextInIframeEnabledFor3rdPartyIsEnabled",!1)&&(this.hostFeatureGateFlag|=2);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitFlightingTreatmentAppSettings",!1)&&(n.AFrameworkApplication.K.appSettings.FlightingTreatmentVariables=n.AFrameworkApplication.K.f2a);
return{["omexForceAnonymous"]:!1,["allowExternalMarketplace"]:n.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&this.gKc,["approvedAddIns"]:n.AFrameworkApplication.K.kb("ApprovedAddIns"),["enableAddinCommands"]:n.AFrameworkApplication.K.$("AddInCommandsIsEnabled"),["enableBlackForestRedirect"]:n.AFrameworkApplication.K.$("BlackForestRedirectIsEnabled"),["enableMyApps"]:n.AFrameworkApplication.K.$("InsertAgaveEnableMyAppsForHost"),["enableMyOrg"]:n.AFrameworkApplication.K.$("InsertAgaveMyOrgEnabledForHost"),
["enableDevCatalog"]:n.AFrameworkApplication.K.$("AppsForOfficeDevCatalogIsEnabled"),["enableTaskpaneUpgradeToAppCommand"]:n.AFrameworkApplication.K.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled"),["enableUploadFileDevCatalog"]:n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&!n.AFrameworkApplication.K.$("UploadFileDevCatalogIsDisabled"),["enablePrivateCatalog"]:n.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled"),["showSignOutFromPrivateCatalogMessage"]:n.AFrameworkApplication.K.$("ShowSignOutFromPrivateCatalogMessage"),
["envCode"]:n.AFrameworkApplication.K.appSettings.OfficeAddinTelemetryDataSourceCode,["enableFirstPartySSO"]:n.AFrameworkApplication.K.$("WordEditorAppsForOfficeFirstPartySSO"),["enableSingleSignOnForAddin"]:n.AFrameworkApplication.K.$("WordEditorAppsForOfficeSingleSignOnIsEnabled")&&n.AFrameworkApplication.LIm,["hideAppsExtensionUrl"]:n.AFrameworkApplication.hideAppsExtensionUrl,["enableAnonymousUseLegacyCatalogService"]:n.AFrameworkApplication.K.$("AnonymousUseLegacyCatalogServiceIsEnabled"),["enableInsertDialogAccessibilityFix"]:n.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix"),
["FollowDestinationFormattingPasteIsEnabled"]:!1,["enableDisplayBlockedMinorError"]:n.AFrameworkApplication.K.$("WordEditorDisplayBlockedMinorErrorIsEnabled"),["disableAppsForOfficeThirdParty"]:n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"),["wacSessionId"]:n.AFrameworkApplication.userSessionId,["disableLogging"]:!n.AFrameworkApplication.K.$("AriaLoggingIsEnabled"),["enableFirstPartySDXErrorMessages"]:n.AFrameworkApplication.K.$("OfficeAddinEnableFirstPartySDXErrorMessages"),["isHostDocumentDomain"]:n.AFrameworkApplication.K.$("AppsForOfficeIsJSHostDocumentDomain"),
["sessionStartInfoJson"]:n.AFrameworkApplication.K.kb("SessionStartInfoJson"),["FollowDestinationThemePasteIsEnabled"]:!1,["sdxAssetsToPrefetchMapping"]:n.AFrameworkApplication.K.kb("SdxAssetsToPrefetchMapping"),["wopiHostOriginFromPostMessage"]:n.AFrameworkApplication.wopiHostOriginFromPostMessage,["wopiHostOriginFromWacPropBag"]:n.AFrameworkApplication.K.kb("PostMessageOrigin"),["wacIsEmbedded"]:n.AFrameworkApplication.K.$("IsEmbedded"),["accessibilityAllowFocusAddinTaskpane"]:n.AFrameworkApplication.K.$("AccessibilityAllowFocusAddinTaskpane"),
["isHostFrameTrustCheckEnabledForAddIns"]:n.AFrameworkApplication.K.$("HostFrameTrustCheckIsEnabledForAddIns"),["isHostFrameTrusted"]:n.AFrameworkApplication.isHostFrameTrusted,["isUpnCheckEnabled"]:n.AFrameworkApplication.K.$("IsUpnCheckEnabled"),["wacUpn"]:n.AFrameworkApplication.K.kb("UserPrincipalName"),["hostInstallAddIns"]:n.AFrameworkApplication.K.kb("HostInstallAddIns"),["hostInstallAddInsIsEnabled"]:n.AFrameworkApplication.K.$("HostInstallAddInsIsEnabled"),["hostAllowedOfficeStore"]:n.AFrameworkApplication.K.$("HostAllowedOfficeStore"),
["hostAllowedSdxEmbedding"]:n.AFrameworkApplication.K.$("HostAllowedSdxEmbedding"),["addinEnforceHttpsIsEnabled"]:n.AFrameworkApplication.K.$("AddinEnforceHttpsIsEnabled"),["hostFeatureGateFlag"]:this.hostFeatureGateFlag,["appSettings"]:n.AFrameworkApplication.K.appSettings,["singleSignOnSettings"]:yc.AppsForOfficeSingleSignOnManager.afm(),["flightingTreatmentVariables"]:n.AFrameworkApplication.K.f2a,["addinActionDefinitionHybridModeIsEnabled"]:n.AFrameworkApplication.K.$("AddinActionDefinitionHybridModeIsEnabled"),
["AllowStorageAccessByUserActivationOnIFrame"]:n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AllowStorageAccessByUserActivationOnIFrame",!1),["enableSetFocusOnTaskpaneOnUserAction"]:!0,["officeJsUrl"]:n.AFrameworkApplication.Sz("OfficeJs/word.js",5),["enableOfficeJsUrlParam"]:n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableOfficeJsUrlParam",!1)}}fkm(){var d=n.AFrameworkApplication.vsg?n.AFrameworkApplication.K.kb("StaticContentHostNonOverriden"):
$c.a.a6;const m=d+$c.a.Y9e,A=d+$c.a.DJc;d+=$c.a.MHh;const R=$c.a.bqk($c.a.DJc);return new Vd(n.AFrameworkApplication.K.appSettings.AppsForOfficeOmexBaseUrl,n.AFrameworkApplication.K.appSettings.AppsForOfficeDevCatalogUrl,null,n.AFrameworkApplication.uth,n.AFrameworkApplication.K.appSettings.EditDocInClientUrl,n.AFrameworkApplication.K.appSettings.StaticContentHost,m,A,d,R,n.AFrameworkApplication.K.appSettings.AppsForOfficeFirstPartyManifestUrl,n.AFrameworkApplication.K.kb("SdxCdnUrl"),n.AFrameworkApplication.K.appSettings.SdxDmsUrl)}rkm(){const d=
n.AFrameworkApplication.K.kb("LoggableUserId");return new me(sa.a.PQ(n.AFrameworkApplication.userName),d)}}Object(y.a)(Md,"WordEditorActivationSettingsProvider",null,[894]);class Re{constructor(d){this.Zte=d}Dof(d){const m={};d=this.Bof(d);if(!d)return v.ULS.sendTraceTag(7143683,344,15,"propertyIterator is null"),m;if(!d.Tb(21))return m;do{var A=d.currentNode;const R=A.getValue(wc.a.OGc);A=A.getValue(wc.a.k3b);m[R]=A}while(d.Lf(21));return m}Nao(d,m){m||(v.ULS.sendTraceTag(7143684,344,15,"property is null, assume it means empty setting"),
m={});let A=this.Bof(d);if(!A)return v.ULS.sendTraceTag(7143685,344,15,"propertyIterator is null"),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const R=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");for(;A.Tb(21);)A.z1a(!R);A=this.Bof(d);for(const da in m){const Ea=this.ucf(da,m[da]),ib=Eg.a.create();A.Q3(Ea,21,new Rh.a(ib,1),!R)}R&&(Object(Oh.a)(79,d)?d.OA(21):v.ULS.sendTraceTag(22024345,344,15,"appObj is not a graph node"));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}dispose(){}ucf(d,
m){const A=this.Zte.create(1074135139);A.setValue(wc.a.OGc,d);A.setValue(wc.a.k3b,m);return A}Bof(d){if(!Object(Oh.a)(79,d))return v.ULS.sendTraceTag(7143686,344,15,"appObj is not a graph node"),null;let m=null;d&&(m=new If.GraphIterator,m.set(d));return m}}Object(y.a)(Re,"WordEditorAfoSettingsModel",null,[893,10]);class We{constructor(d,m,A){this.UT=d;this.wM=m;this.sO=A}}Object(y.a)(We,"AppBindingData",null,[]);var bg=c(124);class yf{constructor(d,m,A,R,da){this.nI=da;this.Cnd=0;this.WY=()=>{this.fd.raiseEvent(yf.kcg)};
this.fd=new vb.a;this.mb=d;this.oc=m;this.wkk=A;this.Cba=R}get cJa(){return this.wkk}Trh(d){this.Cnd||this.mb.Xw(this.WY);this.fd.addHandler(yf.kcg,d);this.Cnd++}j9f(d){this.fd.removeHandler(yf.kcg,d);this.Cnd--;this.Cnd||this.mb.jZ(this.WY)}getSelectedText(){let d="";for(const m of this.mb.ib)d+=this.EUd(m);if(d===bg.AParagraphNode.QC)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Mkc:d};d=bg.AParagraphNode.QP(d);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
Mkc:d}}EUd(d){var m=8|(Ab.App.M1?4:0);if(0!==m)return this.nI.getSelectedText(m,d);m="";if(d)for(const A of d){d=A.cpBegin;const R=A.cpEnd-d;let da="";Qe.ParagraphReader.Xb(A.node)&&(da=A.node.characterData);switch(A.contextId){case ic.a.paragraph:m+=da+"\r";break;case ic.a.Fd:0<R&&(m+=da.substr(d,R));break;case ic.a.Vc:m+="\r"}}return m}koo(d,m){this.L3f(xe.a.SDd,d,m)}eoo(d,m,A,R){const da=document.createElement("img");d=d.trim();var Ea=new km.a;let ib=Ea.Uca(m/72,0),Qb=Ea.Uca(A/72,0),pc="";m=()=>
{var Pc=da.width;const gd=da.height;if(gd&&Pc){if(ib&&!Qb||!ib&&Qb)Pc/=gd,ib?Qb=ib/Pc:ib=Qb*Pc;pc=this.NMh(d,ib,Qb);this.L3f(xe.a.dna,pc,R)}else R(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};A=()=>{R(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)};Ea=!1;(Ea=void 0!==da.onload&&void 0!==da.onerror)?(da.onload=m,da.onerror=A,da.src=String.format("data:image/png;base64,{0}",d)):(pc=this.NMh(d,ib,Qb),this.L3f(xe.a.dna,pc,R))}NMh(d,m,A){return String.format("<img src='data:image/png;base64,{0}'{1}{2} />",
d,m?String.format(" width='{0}px'",m):"",A?String.format(" height='{0}px'",A):"")}L3f(d,m,A){const R=new oi.DictionaryPropertySet;R.setValue(Dm.a.LP,m);R.setValue(Dm.a.Yja,!0);R.setValue(Me.a.Oxa,!0);32===this.oc.processAction(d,1)?this.oc.Tqa(null,d,R,da=>{A(32===da.response?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}):A(OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection)}}yf.kcg="SelectionChangedEventKey";Object(y.a)(yf,"ApiObjectModel",
null,[896]);var Rf=c(41),bf=c(76);const pl=d=>{switch(d){case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:return!0;default:return!1}};class il{constructor(d){this.xC=d}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.xC)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.bjn()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bjn(){this.notifyActionHandlerReady();return null}}Object(y.a)(il,"AddinInternalService",null,[]);class Sk{constructor(d,m,A,R){this.menuItemId=
d;this.lJa=m;this.lFo=A;this.dDl=R}}Object(y.a)(Sk,"NewDocumentParameters",null,[]);class Vj{constructor(d,m,A,R,da){this._context=d;this.L1j=m;this.Ca=A;this.jck=R;this.ew=da}createDocument(d){sc.a.Ai()||sc.a.zk();d&&d.length>this.Ca.nc("WordEditorCreateDocumentApiMaxAllowedBase64",52428800)&&(v.ULS.sendTraceTag(36714716,369,15,"Too large base64 stream size:{0}",d.length),sc.a.qd());this._context.Jm.WH();const m=new Sk("blank","agave",d?"streamBase64":"streamEmpty",d);return OfficeExtension.WacRuntime.Utility.createPromise((A,
R)=>{const da=new xb.StandardDialog;da.Cd=4;da.sv(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Ea=>{2!==Ea&&Ea?this.jck.create(A,R,m).WKc():R("Cancelled")})}).then(A=>{this._context.Jm.Iu();return A?OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.L1j.create(A)):(sc.a.Tf(),null)},A=>{this._context.Jm.Iu();"Cancelled"===A?sc.a.XKo():sc.a.Tf();return null})}getEnterpriseUserInfo(){return null}getMruFriendlyPath(){return null}getSharePointTenantRoot(){return null}isTapEnabled(){sc.a.zk();
return!1}launchFileUrlInOfficeApp(){return!1}getTypeName(){return"Microsoft.WordServices.Application"}retrieveStylesFromBase64(d){sc.a.l6o()||sc.a.zk();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this.ew.c9n(d,m,A)})}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1004:return this.DXl();case 1005:return this.T5l(m);case 1003:return this.Lem();case 1002:return this.KWm();case 1006:return this.t0m(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1001:return this.ual(m);case 1007:return this.d9n(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}ual(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.createDocument(d)}DXl(){return this.getEnterpriseUserInfo()}T5l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMruFriendlyPath(d)}Lem(){return this.getSharePointTenantRoot()}KWm(){return this.isTapEnabled()}t0m(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.launchFileUrlInOfficeApp(m,
d)}d9n(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.retrieveStylesFromBase64(d)}}Object(y.a)(Vj,"Application",null,[]);class Ch{constructor(){this.FH=null}get types(){return this.FH}set types(d){this.FH=d}getTypeName(){return"Microsoft.WordServices.ContentControlOptions"}invokePropertyGet(d){switch(d){case 1:return this.types}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
m){switch(d){case 1:this.types=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"Array<int>");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(y.a)(Ch,"ContentControlOptions",null,[937]);class Qn{constructor(){this.m_g=this.l_g=this.k_g=this.j_g=this.i_g=!1}get importChangeTrackingMode(){return this.i_g}set importChangeTrackingMode(d){this.i_g=d}get importPageColor(){return this.j_g}set importPageColor(d){this.j_g=d}get importParagraphSpacing(){return this.k_g}set importParagraphSpacing(d){this.k_g=d}get importStyles(){return this.l_g}set importStyles(d){this.l_g=d}get importTheme(){return this.m_g}set importTheme(d){this.m_g=d}getTypeName(){return"Microsoft.WordServices.InsertFileOptions"}invokePropertyGet(d){switch(d){case 5:return this.importChangeTrackingMode;
case 4:return this.importPageColor;case 3:return this.importParagraphSpacing;case 2:return this.importStyles;case 1:return this.importTheme}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 5:this.importChangeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 4:this.importPageColor=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 3:this.importParagraphSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 2:this.importStyles=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 1:this.importTheme=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(y.a)(Qn,"InsertFileOptions",null,[]);var zh=c(1539);class gk{constructor(){this.Wvd=this.EMg=null;this.lz=this.IZa="";this.thh=!0;this.options=null}get authChallenge(){return this.EMg}set authChallenge(d){this.EMg=
d}get correlationId(){return this.lz}set correlationId(d){this.lz=d}get policy(){return null}set policy(d){}get resource(){return this.Wvd}set resource(d){this.Wvd=d}get scope(){return this.IZa}set scope(d){this.IZa=d}get silentLogin(){return this.thh}set silentLogin(d){this.thh=d}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(d){switch(d){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(y.a)(gk,"TokenParameters",null,[410]);class sk{constructor(d){if(!d)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.YOf=d}areShortcutsInUse(d){return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this.YOf.checkShortcutsInUse(d).then(R=>{m(R)}).catch(R=>{A(R)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((d,
m)=>{this.YOf.getShortcuts().then(A=>{d(A)}).catch(A=>{m(A)})})}replaceShortcuts(d){return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this.YOf.replaceShortcuts(d).then(()=>{m(null)}).catch(R=>{A(R)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 3:return this.HHk(m);case 1:return this.Sem();case 2:return this.W4n(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HHk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");
return this.areShortcutsInUse(d)}Sem(){return this.getShortcuts()}W4n(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.replaceShortcuts(d)}}Object(y.a)(sk,"ActionService",null,[]);class wl{constructor(){this.data=null}}Object(y.a)(wl,"AugLoopHostMessageReceivedEventArgs",null,[]);var Rn=c(1013);class nk{constructor(d,m=!1,A=null){this.Utb=d;this.iHe=m;this.cXb=A||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(d){this.iHe||Rn.a.xfo(d)}_RegisterHostMessageReceivedEvent(){this.iHe||
(nk.C$i||(Rn.a.$Wn(d=>{this.cXb.fireEvent("",65542,Object.assign(new wl,{data:d}))}),nk.C$i=!0),this.cXb.register(this.Utb,"",65542))}_UnregisterHostMessageReceivedEvent(){this.iHe||this.cXb.unregister(this.Utb,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1:return this.Veo(m);case 2:return this.CUj();case 3:return this.MUj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Veo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
this.sendMessage(d);return null}CUj(){this._RegisterHostMessageReceivedEvent();return null}MUj(){this._UnregisterHostMessageReceivedEvent();return null}}nk.C$i=!1;Object(y.a)(nk,"AugLoopEventService",null,[]);var Zm=c(1567),uo=c(636);class Ui{constructor(d,m,A){this.Rcb=this.tXg=null;this.Utb=d;this.cah=m;if(this.Ca=A)this.tXg=this.Ca.kb("GetAccessTokenOAuthFirstPartyAllowList")}B7l(){this.Rcb||(this.Rcb=uo.a.Gp(Ia.a.instance.Sa("Common.App.OAuth.IOAuthManager")));return this.Rcb}oOm(d,m){if(!this.cah||
""===this.Utb||!this.Ca)return!1;const A=this.cah.getOsfControl(this.Utb);if(!A)return!1;let R=!1;this.tXg.split(";").forEach(da=>{m===da&&(R=!0)});return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===n.AFrameworkApplication.ta.Kb.xk&&A.isFirstParty()&&d===Ui.wCk&&R&&Lb.d(A.getSolutionId())===Ui.CCk}getAccessTokenFirstPartyOAuth(d,m){let A;A=this.oOm(d,m)?R=>{const da=this.B7l();da.continueWith(()=>{da.result.RV(d,m).then(Ea=>{R(Ea);return Ea})})}:R=>{R(Object.assign(new Zm.a,
{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(A)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1:return this.zMl(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}zMl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string");return this.getAccessTokenFirstPartyOAuth(m,d)}}Ui.wCk="Maker";Ui.CCk="fa000000043";Object(y.a)(Ui,"Auth",null,[]);class er{constructor(){this.Ydb=null}Oem(){this.Ydb||(this.Ydb=uo.a.Gp(Ia.a.instance.Sa("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Ydb}getSharedFilePickerResponse(d){return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{try{const R=this.Oem();eb.Task.WAA.call(null,R).continueWith(()=>{const da=R.result;if(da){let Ea={};({Gt:Ea}=rb.d(d)).returnValue?
da.aSd(Ea).then(ib=>{ib&&0<ib.length?m(ib):A(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(ib=>{A(ib)}):A(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else A(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(R){A(R)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1:return this.Nem(m)}d=this.invokeMethod(d,
m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Nem(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getSharedFilePickerResponse(d)}}Object(y.a)(er,"SharedFilePicker",null,[]);class wh{createInstance(d,m,A="",R=null,da=null){switch(d){case "Microsoft.Office.ActionService":return new sk(m);case "Microsoft.Office.SharedFilePicker":return new er;case "Microsoft.Office.Auth":return new Ui(A,R,da);case "Microsoft.Office.AugLoopEventService":return new nk(A)}return null}}
Object(y.a)(wh,"WacApiHost",null,[]);class ql{constructor(d,m,A,R,da,Ea=null){this.xC=d;this.Znk=m;this.ga=A;this.jhk=R;this.hok=da;this.RQg=Ea}endCopilotOperation(d){return this.RQg.endCopilotOperation(d)}startCopilotOperation(d){return this.RQg.startCopilotOperation(d)}undo(){return 32===this.ga.processAction(this.Znk,2)}_RegisterUndoStackChangedEvent(){const d=OfficeExtension.WacRuntime.RichApi.getEventManager();d.$Mm("",65543)||this.jhk(ql.f1h);d.register(this.xC,"",65543)}_UnregisterUndoStackChangedEvent(){const d=
OfficeExtension.WacRuntime.RichApi.getEventManager();d.unregister(this.xC,"",65543);d.$Mm("",65543)||this.hok(ql.f1h)}getTypeName(){return"Microsoft.Office.UndoService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.sSo();case 2:return this.EUj();case 3:return this.OUj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 5:return this.iwl(m);case 4:return this.jDo(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}iwl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.endCopilotOperation(d)}jDo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.startCopilotOperation(d)}sSo(){return this.undo()}EUj(){this._RegisterUndoStackChangedEvent();return null}OUj(){this._UnregisterUndoStackChangedEvent();return null}static f1h(){OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent("",65543,null)}}Object(y.a)(ql,"UndoService",null,[]);class Tk{constructor(d,m,A){this.pYe=null;this.A$a=m;this.xC=A;this._context=
d}hostName(){return"WordOnline"}appId(){return this.A$a}createInstance(d){switch(d){case "Microsoft.WordServices.Application":return new Vj(Ia.a.instance.resolve("WordEditor.Extension.RequestContext"),Ia.a.instance.resolve("WordEditor.Extension.DocumentCreatedFactory"),n.AFrameworkApplication.K,Ia.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory"),Ia.a.instance.resolve("WordEditor.Extension.FileApiOperations"));case "Microsoft.WordServices.SearchOptions":return new zh.a;
case "Microsoft.WordServices.ContentControlOptions":return new Ch;case "Microsoft.WordServices.InsertFileOptions":return new Qn;case "Microsoft.Authentication.AuthenticationService":return Ia.a.instance.resolve("WordEditor.Extension.AuthenticationServiceFactory").create(this._context,this.xC);case "Microsoft.Authentication.TokenParameters":return new gk;case "Microsoft.Office.Licensing.License":return Ia.a.instance.resolve("WordEditor.Extension.LicenseFactory").create(this.xC);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return Ia.a.instance.resolve("WordEditor.Extension.AppRuntimePersistenceServiceFactory").create(this._context,
this.xC);case "Microsoft.AppRuntime.AppRuntimeService":return Ia.a.instance.resolve("WordEditor.Extension.AppRuntimeServiceFactory").create(this._context,this.xC);case "Microsoft.InternalService.AddinInternalService":return new il(this.xC);case "Microsoft.Office.AugLoopEventService":var m=Ia.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").Et.getOsfControl(this.xC);if(null===m||void 0===m?0:m.isFirstParty())return this.pYe||(this.pYe=new wh),this.pYe.createInstance(d,null,
this.xC);break;case "Microsoft.Office.UndoService":if(m=Ia.a.instance.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").Et.getOsfControl(this.xC),null===m||void 0===m?0:m.isFirstParty()){const A=Ia.a.instance.resolve("Box4.IUndoManager");d=Ia.a.instance.resolve("WordEditor.CopilotOperationLifecycleHandler");return new ql(this.xC,xe.a.undo,Ia.a.instance.resolve("Common.IActionManager"),R=>A.Ayk(R),R=>A.w2n(R),d)}}v.ULS.sendTraceTag(17359129,369,10,"Typename: {0} is an invalid parameter. Only instance for Application or SearchOptions can be created through this method.",
d);sc.a.Tf();return null}}Object(y.a)(Tk,"RichApiHost",null,[932]);var Pi;(function(d){d[d.none=0]="none";d[d.primitive=1]="primitive";d[d.valueObject=2]="valueObject";d[d.classObject=3]="classObject"})(Pi||(Pi={}));Object(y.b)("TypeCategory_Deprecated",Pi);const nm=d=>{if(n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.IncludeWacApiHostTypeRegister")){let ts,Ns;ts=d.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);Ns=ts.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ns.addParameter("shortcuts","String[]",1,null,0);Ns=ts.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ns=ts.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ns.addParameter("shortcuts","Object",1,null,0);ts=d.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ns=ts.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);Ns.addParameter("pickerCustomizationJsonString","String",1,null,0);ts=d.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Ns=ts.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Ns.addParameter("appName","String",1,null,0);Ns.addParameter("target","String",1,null,0);ts=d.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}",
"{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);ts.addProperty("Data",4,"String",1,!1,null,0);ts=d.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Ns=ts.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Ns.addParameter("data","String",1,null,0);Ns=ts.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Ns=ts.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,
1,"_UnregisterHostMessageReceivedEvent",4);ts=d.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);ts.addProperty("BatchId",6,"String",1,!1,null,0);ts=d.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Ns=ts.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Ns.addParameter("batchId","String",1,null,0);Ns=ts.addMethod("StartCopilotOperation",
4,"Boolean",1,0,"StartCopilotOperation",4);Ns.addParameter("batchId","String",1,null,0);Ns=ts.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Ns=ts.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);Ns=ts.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4)}const m=d.addType("Microsoft.WordServices.Annotation","{4a0f635f-767e-4a07-b75e-80e8432ca12c}","",3,0);m.addProperty("Content",1,"Object",1,!0,null,0);m.addProperty("Id",
2,"String",1,!0,null,0);m.addProperty("_ReferenceId",3,"String",1,!0,null,0);m.addProperty("_State",4,"Microsoft.WordServices.AnnotationState",1,!1,null,0);m.addMethod("Delete",1006,"Void",0,0,"Delete",0);m.addMethod("GetParentAsAnnotation",1005,"Microsoft.WordServices.Annotation",3,1,"ParentAsAnnotation",0);m.addMethod("GetParentAsParagraph",1004,"Microsoft.WordServices.Paragraph",3,1,"ParentAsParagraph",0);m.addMethod("GetParentType",1003,"Microsoft.WordServices.AnnotationParentType",1,1,"ParentType",
0);m.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);m.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const A=d.addType("Microsoft.WordServices.AnnotationCollection","{0b4dc55f-db0a-4fda-93fe-2a32432b87d3}","",3,0);A.addProperty("_ReferenceId",2,"String",1,!0,null,0);A.addMethod("GetFirst",1003,"Microsoft.WordServices.Annotation",3,1,"First",0);A.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Annotation",3,1,"FirstOrNullObject",0);A.addIndexerMethod(1,"Microsoft.WordServices.Annotation",
3,0).addParameter("index","Object",1,null,0);A.addMethod("Refresh",1005,"Void",0,1,"Refresh",0);A.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);A.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);A.setCollectionInfo("Microsoft.WordServices.Annotation",!0);const R=d.addType("Microsoft.WordServices.Application","{e033f092-ac87-40f7-a865-769c9fdacd72}","{2c000fc1-c973-41fc-b5e3-8f3a0cc65c12}",3,0);R.addMethod("CreateDocument",1001,"Microsoft.WordServices.DocumentCreated",3,1,"CreateDocument",
0).addParameter("base64File","String",1,null,0);R.addMethod("GetEnterpriseUserInfo",1004,"String",1,1,"EnterpriseUserInfo",4);R.addMethod("GetMruFriendlyPath",1005,"String",1,1,"MruFriendlyPath",4).addParameter("documentUrl","String",1,null,0);R.addMethod("GetSharePointTenantRoot",1003,"String",1,1,"SharePointTenantRoot",4);R.addMethod("IsTapEnabled",1002,"Boolean",1,1,"IsTapEnabled",4);const da=R.addMethod("LaunchFileUrlInOfficeApp",1006,"Boolean",1,1,"LaunchFileUrlInOfficeApp",4);da.addParameter("documentUrl",
"String",1,null,0);da.addParameter("useUniversalAsBackUp","Boolean",1,null,0);R.addMethod("RetrieveStylesFromBase64",1007,"String",1,1,"RetrieveStylesFromBase64",0).addParameter("base64File","String",1,null,0);const Ea=d.addType("Microsoft.WordServices.Body","{5516bb1d-cf31-4aa9-97cd-ccebc2ee9e6d}","",3,0);Ea.addProperty("ContentControls",3,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Ea.addProperty("Endnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ea.addProperty("Fields",
20,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ea.addProperty("Font",5,"Microsoft.WordServices.Font",3,!0,null,0);Ea.addProperty("Footnotes",18,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ea.addProperty("InlinePictures",7,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Ea.addProperty("Lists",11,"Microsoft.WordServices.ListCollection",3,!0,null,0);Ea.addProperty("Paragraphs",2,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Ea.addProperty("ParentBody",
10,"Microsoft.WordServices.Body",3,!0,null,0);Ea.addProperty("ParentBodyOrNullObject",16,"Microsoft.WordServices.Body",3,!0,null,0);Ea.addProperty("ParentContentControl",4,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ea.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ea.addProperty("ParentSection",13,"Microsoft.WordServices.Section",3,!0,null,0);Ea.addProperty("ParentSectionOrNullObject",17,"Microsoft.WordServices.Section",3,!0,null,0);
Ea.addProperty("Style",6,"String",1,!1,null,0);Ea.addProperty("StyleBuiltIn",14,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ea.addProperty("Tables",12,"Microsoft.WordServices.TableCollection",3,!0,null,0);Ea.addProperty("Text",8,"String",1,!0,null,0);Ea.addProperty("Type",9,"Microsoft.WordServices.BodyType",1,!0,null,0);Ea.addProperty("_ReferenceId",1,"String",1,!0,null,0);Ea.addMethod("Clear",1011,"Void",0,0,"Clear",0);Ea.addMethod("GetComments",1019,"Microsoft.WordServices.CommentCollection",
3,1,"Comments",0);Ea.addMethod("GetContentControls",1021,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Ea.addMethod("GetHtml",1013,"String",1,1,"Html",0);Ea.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);Ea.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",
1,null,0);const ib=Ea.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);ib.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);ib.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ea.addMethod("InsertContentControl",1007,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const Qb=Ea.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",
3,0,"InsertFileFromBase64",0);Qb.addParameter("base64File","String",1,null,0);Qb.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const pc=Ea.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);pc.addParameter("html","String",1,null,0);pc.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Pc=Ea.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",
0);Pc.addParameter("base64EncodedImage","String",1,null,0);Pc.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const gd=Ea.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);gd.addParameter("ooxml","String",1,null,0);gd.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Cd=Ea.addMethod("InsertParagraph",1006,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Cd.addParameter("paragraphText","String",
1,null,0);Cd.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Ea.addMethod("GetReviewedText",1020,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const ae=Ea.addMethod("InsertTable",1017,"Microsoft.WordServices.Table",3,0,"InsertTable",0);ae.addParameter("rowCount","Int32",1,null,0);ae.addParameter("columnCount","Int32",1,null,0);ae.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);ae.addParameter("values","String[][]",1,null,0);const Xd=Ea.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);Xd.addParameter("text","String",1,null,0);Xd.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const se=Ea.addMethod("Search",1012,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);se.addParameter("searchText","String",1,null,0);se.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Ea.addMethod("Select",
1015,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);Ea.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Ea.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Xe=Ea.addMethod("_Search2",1018,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Xe.addParameter("searchText","String",1,null,0);Xe.addParameter("searchFlags","Int32",1,null,0);const Be=d.addType("Microsoft.WordServices.ContentControl","{b86e5ae1-476e-4e56-825d-885468e549f3}",
"",3,0);Be.addProperty("Appearance",7,"Microsoft.WordServices.ContentControlAppearance",1,!1,null,0);Be.addProperty("CannotDelete",10,"Boolean",1,!1,null,0);Be.addProperty("CannotEdit",11,"Boolean",1,!1,null,0);Be.addProperty("Color",8,"String",1,!1,null,0);Be.addProperty("ContentControls",15,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Be.addProperty("Endnotes",30,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Be.addProperty("Fields",31,"Microsoft.WordServices.FieldCollection",
3,!0,null,0);Be.addProperty("Font",12,"Microsoft.WordServices.Font",3,!0,null,0);Be.addProperty("Footnotes",29,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Be.addProperty("Id",1,"UInt32",1,!0,null,0);Be.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Be.addProperty("Lists",19,"Microsoft.WordServices.ListCollection",3,!0,null,0);Be.addProperty("Paragraphs",14,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Be.addProperty("ParentBody",
25,"Microsoft.WordServices.Body",3,!0,null,0);Be.addProperty("ParentContentControl",16,"Microsoft.WordServices.ContentControl",3,!0,null,0);Be.addProperty("ParentContentControlOrNullObject",26,"Microsoft.WordServices.ContentControl",3,!0,null,0);Be.addProperty("ParentTable",22,"Microsoft.WordServices.Table",3,!0,null,0);Be.addProperty("ParentTableCell",21,"Microsoft.WordServices.TableCell",3,!0,null,0);Be.addProperty("ParentTableCellOrNullObject",27,"Microsoft.WordServices.TableCell",3,!0,null,0);
Be.addProperty("ParentTableOrNullObject",28,"Microsoft.WordServices.Table",3,!0,null,0);Be.addProperty("PlaceholderText",5,"String",1,!1,null,0);Be.addProperty("RemoveWhenEdited",9,"Boolean",1,!1,null,0);Be.addProperty("Style",13,"String",1,!1,null,0);Be.addProperty("StyleBuiltIn",24,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Be.addProperty("Subtype",23,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Be.addProperty("Tables",20,"Microsoft.WordServices.TableCollection",3,!0,null,0);
Be.addProperty("Tag",4,"String",1,!1,null,0);Be.addProperty("Text",18,"String",1,!0,null,0);Be.addProperty("Title",3,"String",1,!1,null,0);Be.addProperty("Type",6,"Microsoft.WordServices.ContentControlType",1,!0,null,0);Be.addProperty("_ReferenceId",2,"String",1,!0,null,0);Be.addMethod("Clear",1010,"Void",0,0,"Clear",0);Be.addMethod("Delete",1011,"Void",0,0,"Delete",0).addParameter("keepContent","Boolean",1,null,0);Be.addMethod("GetComments",1021,"Microsoft.WordServices.CommentCollection",3,1,"Comments",
0);Be.addMethod("GetContentControls",1023,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Be.addMethod("GetHtml",1013,"String",1,1,"Html",0);Be.addMethod("GetOoxml",1014,"String",1,1,"Ooxml",0);Be.addMethod("GetRange",1016,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const Hg=
Be.addMethod("GetTextRanges",1019,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);Hg.addParameter("endingMarks","String[]",1,null,0);Hg.addParameter("trimSpacing","Boolean",1,null,0);const Xh=Be.addMethod("InsertBreak",1008,"Void",0,0,"InsertBreak",0);Xh.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);Xh.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Fl=Be.addMethod("InsertFileFromBase64",1006,"Microsoft.WordServices.Range",
3,0,"InsertFileFromBase64",0);Fl.addParameter("base64File","String",1,null,0);Fl.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Gm=Be.addMethod("InsertHtml",1004,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);Gm.addParameter("html","String",1,null,0);Gm.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const em=Be.addMethod("InsertInlinePictureFromBase64",1009,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",
0);em.addParameter("base64EncodedImage","String",1,null,0);em.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const $n=Be.addMethod("InsertOoxml",1005,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);$n.addParameter("ooxml","String",1,null,0);$n.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Ep=Be.addMethod("InsertParagraph",1007,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Ep.addParameter("paragraphText","String",
1,null,0);Ep.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Mm=Be.addMethod("InsertTable",1018,"Microsoft.WordServices.Table",3,0,"InsertTable",0);Mm.addParameter("rowCount","Int32",1,null,0);Mm.addParameter("columnCount","Int32",1,null,0);Mm.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Mm.addParameter("values","String[][]",1,null,0);const Mk=Be.addMethod("InsertText",1003,"Microsoft.WordServices.Range",3,0,"InsertText",0);
Mk.addParameter("text","String",1,null,0);Mk.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const gm=Be.addMethod("Search",1015,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);gm.addParameter("searchText","String",1,null,0);gm.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Be.addMethod("Select",1012,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const cl=Be.addMethod("Split",
1017,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);cl.addParameter("delimiters","String[]",1,null,0);cl.addParameter("multiParagraphs","Boolean",1,null,0);cl.addParameter("trimDelimiters","Boolean",1,null,0);cl.addParameter("trimSpacing","Boolean",1,null,0);Be.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Be.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Sj=Be.addMethod("_Search2",1020,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);Sj.addParameter("searchText",
"String",1,null,0);Sj.addParameter("searchFlags","Int32",1,null,0);Be.addMethod("GetReviewedText",1022,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const xp=d.addType("Microsoft.WordServices.ContentControlCollection","{a6a87ba8-6037-4625-ba4b-ece14e708219}","",3,0);xp.addProperty("_ReferenceId",2,"String",1,!0,null,0);xp.addMethod("GetByChangeTrackingStates",1010,"Microsoft.WordServices.ContentControlCollection",3,
1,"ByChangeTrackingStates",0).addParameter("types","Microsoft.WordServices.ChangeTrackingState[]",1,null,0);xp.addMethod("GetById",1002,"Microsoft.WordServices.ContentControl",3,1,"ById",0).addParameter("id","Int32",1,null,0);xp.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.ContentControl",3,1,"ByIdOrNullObject",0).addParameter("id","Int32",1,null,0);xp.addMethod("GetByTag",1004,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTag",0).addParameter("tag","String",1,null,0);xp.addMethod("GetByTitle",
1003,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTitle",0).addParameter("title","String",1,null,0);xp.addMethod("GetByTypes",1006,"Microsoft.WordServices.ContentControlCollection",3,1,"ByTypes",0).addParameter("types","Microsoft.WordServices.ContentControlType[]",1,null,0);xp.addMethod("GetFirst",1007,"Microsoft.WordServices.ContentControl",3,1,"First",0);xp.addMethod("GetFirstOrNullObject",1009,"Microsoft.WordServices.ContentControl",3,1,"FirstOrNullObject",0);xp.addIndexerMethod(1,
"Microsoft.WordServices.ContentControl",3,0).addParameter("index","Object",1,null,0);xp.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);xp.addMethod("_OnAccess",1005,"Void",0,1,"_OnAccess",0);xp.setCollectionInfo("Microsoft.WordServices.ContentControl",!0);d.addType("Microsoft.WordServices.ContentControlOptions","{dc3307d1-f680-40be-94b4-c50e53399d0e}","{81d9e31a-cd15-43a2-8ee0-614fb6e37a0a}",2,0).addProperty("types",1,"Microsoft.WordServices.ContentControlType[]",1,!1,null,0);const vj=
d.addType("Microsoft.WordServices.Comment","{9446f5cf-2bce-46d3-ae41-2a70c1398270}","",3,0);vj.addProperty("AuthorEmail",1,"String",1,!0,null,0);vj.addProperty("AuthorName",2,"String",1,!0,null,0);vj.addProperty("Content",3,"String",1,!1,null,0);vj.addProperty("CreationDate",4,"DateTime",1,!1,null,0);vj.addProperty("Id",5,"String",1,!0,null,0);vj.addProperty("_ReferenceId",6,"String",1,!0,null,0);vj.addProperty("Replies",7,"Microsoft.WordServices.CommentReplyCollection",3,!0,null,0);vj.addProperty("Resolved",
8,"Boolean",1,!1,null,0);vj.addProperty("ContentRange",9,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);vj.addMethod("GetRange",1001,"Microsoft.WordServices.Range",3,0,"GetRange",0);vj.addMethod("Reply",1002,"Microsoft.WordServices.CommentReply",3,0,"Reply",0).addParameter("replyText","String",1,null,0);vj.addMethod("Delete",1003,"Void",0,0,"Delete",0);vj.addMethod("_KeepReference",1005,"Void",0,1,"_KeepReference",0);vj.addMethod("_OnAccess",1004,"Void",0,1,"_OnAccess",0);const Jr=d.addType("Microsoft.WordServices.CommentContentRange",
"{fc4ae520-29e9-45ee-82ae-c0b29f2feefc}","",3,0);Jr.addProperty("_ReferenceId",1,"String",1,!0,null,0);Jr.addProperty("Text",2,"String",1,!0,null,0);Jr.addProperty("IsEmpty",3,"Boolean",1,!0,null,0);Jr.addProperty("Hyperlink",4,"String",1,!1,null,0);Jr.addProperty("Bold",5,"Boolean",1,!1,null,0);Jr.addProperty("Italic",6,"Boolean",1,!1,null,0);Jr.addProperty("StrikeThrough",7,"Boolean",1,!1,null,0);Jr.addProperty("Underline",8,"Microsoft.WordServices.UnderlineType",1,!1,null,0);Jr.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);Jr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const PC=Jr.addMethod("InsertText",1003,"Microsoft.WordServices.CommentContentRange",3,0,"InsertText",0);PC.addParameter("text","String",1,null,0);PC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const QC=d.addType("Microsoft.WordServices.CommentCollection","{f1054c20-9d4b-4c62-9c80-e0e57ac4df64}","",3,0);QC.addProperty("_ReferenceId",2,"String",1,!0,null,0);QC.addMethod("GetFirst",
1003,"Microsoft.WordServices.Comment",3,1,"First",0);QC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Comment",3,1,"FirstOrNullObject",0);QC.addIndexerMethod(1,"Microsoft.WordServices.Comment",3,0).addParameter("index","object",1,null,0);QC.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);QC.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);QC.setCollectionInfo("Microsoft.WordServices.Comment",!0);const Ww=d.addType("Microsoft.WordServices.CommentReply","{cd697f4e-f862-b2b3-bfa1-5a5a2231b3d4}",
"",3,0);Ww.addProperty("AuthorEmail",1,"String",1,!0,null,0);Ww.addProperty("AuthorName",2,"String",1,!0,null,0);Ww.addProperty("Content",3,"String",1,!1,null,0);Ww.addProperty("CreationDate",4,"DateTime",1,!1,null,0);Ww.addProperty("ParentComment",7,"Microsoft.WordServices.Comment",3,!0,null,0);Ww.addProperty("Id",5,"String",1,!0,null,0);Ww.addProperty("_ReferenceId",6,"String",1,!0,null,0);Ww.addProperty("ContentRange",8,"Microsoft.WordServices.CommentContentRange",3,!1,null,0);Ww.addMethod("Delete",
1002,"Void",0,0,"Delete",0);Ww.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Ww.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);const fC=d.addType("Microsoft.WordServices.CommentReplyCollection","{bfce5553-cb82-aa57-dec3-0c164055f29e}","",3,0);fC.addProperty("_ReferenceId",2,"String",1,!0,null,0);fC.addMethod("GetFirst",1003,"Microsoft.WordServices.CommentReply",3,1,"First",0);fC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.CommentReply",3,1,"FirstOrNullObject",
0);fC.addIndexerMethod(1,"Microsoft.WordServices.CommentReply",3,0).addParameter("index","object",1,null,0);fC.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);fC.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);fC.setCollectionInfo("Microsoft.WordServices.CommentReply",!0);const gC=d.addType("Microsoft.WordServices.CustomProperty","{5edbd9c9-449f-440c-bfae-d59d2db340bb}","",3,0);gC.addProperty("Key",2,"String",1,!0,null,0);gC.addProperty("Type",4,"Microsoft.WordServices.DocumentPropertyType",
1,!0,null,0);gC.addProperty("Value",3,"Object",1,!1,null,0);gC.addProperty("_Id",5,"String",1,!0,null,0);gC.addProperty("_ReferenceId",1,"String",1,!0,null,0);gC.addMethod("Delete",1003,"Void",0,0,"Delete",0);gC.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);gC.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const qA=d.addType("Microsoft.WordServices.CustomPropertyCollection","{85869847-ef5b-4377-9a0b-0eb6da2059e5}","",3,0);qA.addProperty("_ReferenceId",2,"String",1,!0,null,0);
const nE=qA.addMethod("Add",1003,"Microsoft.WordServices.CustomProperty",3,0,"Add",0);nE.addParameter("key","String",1,null,0);nE.addParameter("value","Object",1,null,0);qA.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);qA.addMethod("GetCount",1004,"Int32",1,1,"Count",0);qA.addIndexerMethod(1,"Microsoft.WordServices.CustomProperty",3,0).addParameter("key","String",1,null,0);qA.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomProperty",3,1,"ItemOrNullObject",0).addParameter("key",
"String",1,null,0);qA.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);qA.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);qA.setCollectionInfo("Microsoft.WordServices.CustomProperty",!0);const cw=d.addType("Microsoft.WordServices.CustomXmlPart","{e0f5b881-5a49-403f-adc1-627b9479ad11}","",3,0);cw.addProperty("Id",2,"String",1,!0,null,0);cw.addProperty("NamespaceUri",3,"String",1,!0,null,0);cw.addProperty("_ReferenceId",1,"String",1,!0,null,0);cw.addMethod("Delete",1003,"Void",0,
0,"Delete",0);const oE=cw.addMethod("DeleteAttribute",1012,"Void",0,0,"DeleteAttribute",0);oE.addParameter("xpath","String",1,null,0);oE.addParameter("namespaceMappings","Object",1,null,0);oE.addParameter("name","String",1,null,0);const fF=cw.addMethod("DeleteElement",1009,"Void",0,0,"DeleteElement",0);fF.addParameter("xpath","String",1,null,0);fF.addParameter("namespaceMappings","Object",1,null,0);cw.addMethod("GetXml",1004,"String",1,1,"Xml",0);const hC=cw.addMethod("InsertAttribute",1010,"Void",
0,0,"InsertAttribute",0);hC.addParameter("xpath","String",1,null,0);hC.addParameter("namespaceMappings","Object",1,null,0);hC.addParameter("name","String",1,null,0);hC.addParameter("value","String",1,null,0);const DD=cw.addMethod("InsertElement",1007,"Void",0,0,"InsertElement",0);DD.addParameter("xpath","String",1,null,0);DD.addParameter("xml","String",1,null,0);DD.addParameter("namespaceMappings","Object",1,null,0);DD.addParameter("index","Int32?",1,null,0);const gF=cw.addMethod("Query",1006,"String[]",
1,0,"Query",0);gF.addParameter("xpath","String",1,null,0);gF.addParameter("namespaceMappings","Object",1,null,0);cw.addMethod("SetXml",1005,"Void",0,0,"SetXml",0).addParameter("xml","String",1,null,0);const ED=cw.addMethod("UpdateAttribute",1011,"Void",0,0,"UpdateAttribute",0);ED.addParameter("xpath","String",1,null,0);ED.addParameter("namespaceMappings","Object",1,null,0);ED.addParameter("name","String",1,null,0);ED.addParameter("value","String",1,null,0);const pE=cw.addMethod("UpdateElement",1008,
"Void",0,0,"UpdateElement",0);pE.addParameter("xpath","String",1,null,0);pE.addParameter("xml","String",1,null,0);pE.addParameter("namespaceMappings","Object",1,null,0);cw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);cw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const rA=d.addType("Microsoft.WordServices.CustomXmlPartCollection","{cf95a7e8-7b45-4a7a-9de5-db47e5f9b66b}","",3,0);rA.addProperty("_ReferenceId",1,"String",1,!0,null,0);rA.addMethod("Add",1004,"Microsoft.WordServices.CustomXmlPart",
3,0,"Add",0).addParameter("xml","String",1,null,0);rA.addMethod("GetByNamespace",1005,"Microsoft.WordServices.CustomXmlPartScopedCollection",3,1,"ByNamespace",0).addParameter("namespaceUri","String",1,null,0);rA.addMethod("GetCount",1003,"Int32",1,1,"Count",0);rA.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);rA.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);rA.addMethod("_KeepReference",
1002,"Void",0,1,"_KeepReference",0);rA.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);rA.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const dw=d.addType("Microsoft.WordServices.CustomXmlPartScopedCollection","{9fc07322-b3a6-407b-827e-c40e6e188f68}","",3,0);dw.addProperty("_ReferenceId",1,"String",1,!0,null,0);dw.addMethod("GetCount",1003,"Int32",1,1,"Count",0);dw.addIndexerMethod(2,"Microsoft.WordServices.CustomXmlPart",3,0).addParameter("id","String",1,null,0);dw.addMethod("GetItemOrNullObject",
1004,"Microsoft.WordServices.CustomXmlPart",3,1,"",0).addParameter("id","String",1,null,0);dw.addMethod("GetOnlyItem",1005,"Microsoft.WordServices.CustomXmlPart",3,1,"OnlyItem",0);dw.addMethod("GetOnlyItemOrNullObject",1006,"Microsoft.WordServices.CustomXmlPart",3,1,"",0);dw.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);dw.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);dw.setCollectionInfo("Microsoft.WordServices.CustomXmlPart",!0);const gn=d.addType("Microsoft.WordServices.Document",
"{1fd33ae5-86f2-4770-95f1-8bba5b1dce15}","",3,0);gn.addProperty("AllowCloseOnUntitled",9,"Boolean",1,!1,null,0);gn.addProperty("ChangeTrackingMode",10,"Microsoft.WordServices.ChangeTrackingMode",1,!1,null,0);gn.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);gn.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);gn.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",3,!0,null,0);gn.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",
3,!0,null,0);gn.addProperty("Saved",1,"Boolean",1,!0,null,0);gn.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);gn.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);gn.addProperty("_ReferenceId",5,"String",1,!0,null,0);const FD=gn.addMethod("AddStyle",1028,"Microsoft.WordServices.Style",Pi.ClassObject,0,"AddStyle",0);FD.addParameter("name","String",1,null,0);FD.addParameter("type","Microsoft.WordServices.StyleType",1,null,0);gn.addMethod("DeleteBookmark",
1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);gn.addMethod("GetAnnotationsByType",1020,"Microsoft.WordServices.AnnotationCollection",3,1,"AnnotationsByType",0).addParameter("annotationType","String",1,null,0);gn.addMethod("GetBookmarkRange",1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);gn.addMethod("GetBookmarkRangeOrNullObject",1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name",
"String",1,null,0);gn.addMethod("GetContentControls",1026,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);gn.addMethod("GetEndnoteBody",1025,"Microsoft.WordServices.Body",3,1,"EndnoteBody",0);gn.addMethod("GetFootnoteBody",1024,"Microsoft.WordServices.Body",3,1,"FootnoteBody",0);gn.addMethod("GetMetadata",1013,"Object",1,1,"Metadata",0).addParameter("propertyGUID",
"String",1,null,0);gn.addMethod("GetNeighborhoodTextAroundSelection",1017,"String",1,1,"NeighborhoodTextAroundSelection",4).addParameter("maxLength","Int32?",1,null,0);gn.addMethod("GetSelection",1006,"Microsoft.WordServices.Range",3,1,"Selection",0);gn.addMethod("GetStyles",1029,"Microsoft.WordServices.StyleCollection",Pi.ClassObject,1,"GetStyles",0);gn.addMethod("LaunchTapPane",1016,"Void",0,1,"LaunchTapPane",4).addParameter("documentUrl","String",1,null,0);const xy=gn.addMethod("Save",1005,"Void",
0,0,"Save",0);xy.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",1,null,0);xy.addParameter("fileName","String",1,null,0);gn.addMethod("Close",1027,"Void",0,0,"Close",0).addParameter("closeBehavior","Microsoft.WordServices.CloseBehavior",1,null,0);const eh=gn.addMethod("Search",1022,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);eh.addParameter("searchText","String",1,null,0);eh.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);const RC=gn.addMethod("SetMetadata",
1014,"Void",0,0,"SetMetadata",0);RC.addParameter("propertyGUID","String",1,null,0);RC.addParameter("propertyValue","Object",1,null,0);const qE=gn.addMethod("SetMetadataOnTile",1015,"Void",0,0,"SetMetadataOnTile",0);qE.addParameter("tileID","String",1,null,0);qE.addParameter("propertyGUID","String",1,null,0);qE.addParameter("propertyValue","Object",1,null,0);gn.addMethod("SetNavigationPaneVisibility",1021,"Void",0,0,"SetNavigationPaneVisibility",4).addParameter("visible","Boolean",1,null,0);gn.addMethod("_GetObjectByReferenceId",
1001,"Object",1,1,"_GetObjectByReferenceId",0).addParameter("referenceId","String",1,null,0);gn.addMethod("_GetObjectTypeNameByReferenceId",1002,"String",1,1,"_GetObjectTypeNameByReferenceId",0).addParameter("referenceId","String",1,null,0);gn.addMethod("_KeepReference",1008,"Void",0,1,"_KeepReference",0);gn.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const hF=gn.addMethod("_RegisterEvent",1018,"Void",0,1,"_RegisterEvent",0);hF.addParameter("referenceId","String",1,null,0);hF.addParameter("eventType",
"Microsoft.WordServices.EventType",1,null,0);gn.addMethod("_RemoveAllReferences",1004,"Void",0,1,"_RemoveAllReferences",0);gn.addMethod("_RemoveReference",1003,"Void",0,1,"_RemoveReference",0).addParameter("referenceId","String",1,null,0);const fG=gn.addMethod("_Search2",1023,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);fG.addParameter("searchText","String",1,null,0);fG.addParameter("searchFlags","Int32",1,null,0);const iF=gn.addMethod("_UnregisterEvent",1019,"Void",0,1,"_UnregisterEvent",
0);iF.addParameter("referenceId","String",1,null,0);iF.addParameter("eventType","Microsoft.WordServices.EventType",1,null,0);const jF=gn.addMethod("InsertFileFromBase64",1030,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);jF.addParameter("base64File","String",1,null,0);jF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);jF.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",
0);const Nj=d.addType("Microsoft.WordServices.DocumentCreated","{1a6e7a8e-fa7a-4f86-b7d0-b50a3c10f515}","",3,0);Nj.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);Nj.addProperty("ContentControls",4,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Nj.addProperty("CustomXmlParts",8,"Microsoft.WordServices.CustomXmlPartCollection",3,!0,null,0);Nj.addProperty("Properties",6,"Microsoft.WordServices.DocumentProperties",3,!0,null,0);Nj.addProperty("Saved",1,"Boolean",1,!0,null,
0);Nj.addProperty("Sections",2,"Microsoft.WordServices.SectionCollection",3,!0,null,0);Nj.addProperty("Settings",7,"Microsoft.WordServices.SettingCollection",3,!0,null,0);Nj.addProperty("_ReferenceId",5,"String",1,!0,null,0);Nj.addMethod("DeleteBookmark",1011,"Void",0,0,"DeleteBookmark",0).addParameter("name","String",1,null,0);Nj.addMethod("GetBookmarkRange",1010,"Microsoft.WordServices.Range",3,1,"BookmarkRange",0).addParameter("name","String",1,null,0);Nj.addMethod("GetBookmarkRangeOrNullObject",
1012,"Microsoft.WordServices.Range",3,1,"BookmarkRangeOrNullObject",0).addParameter("name","String",1,null,0);Nj.addMethod("GetContentControls",1013,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);const iC=Nj.addMethod("InsertFileFromBase64",1014,"Microsoft.WordServices.SectionCollection",3,0,"InsertFileFromBase64",0);iC.addParameter("base64File",
"String",1,null,0);iC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);iC.addParameter("insertFileOptions","Microsoft.WordServices.InsertFileOptions",2,"Microsoft.WordServices.InsertFileOptions",0);Nj.addMethod("Open",1009,"Void",0,1,"Open",0);const rE=Nj.addMethod("Save",1005,"Void",0,0,"Save",0);rE.addParameter("saveBehavior","Microsoft.WordServices.SaveBehavior",1,null,0);rE.addParameter("fileName","String",1,null,0);Nj.addMethod("_KeepReference",1008,"Void",0,1,
"_KeepReference",0);Nj.addMethod("_OnAccess",1007,"Void",0,1,"_OnAccess",0);const Np=d.addType("Microsoft.WordServices.DocumentProperties","{642e1471-0cac-4dd2-bc76-1d1d0a3e130f}","",3,0);Np.addProperty("ApplicationName",11,"String",1,!0,null,0);Np.addProperty("Author",5,"String",1,!1,null,0);Np.addProperty("Category",20,"String",1,!1,null,0);Np.addProperty("Comments",7,"String",1,!1,null,0);Np.addProperty("Company",23,"String",1,!1,null,0);Np.addProperty("CreationDate",13,"DateTime",1,!0,null,0);
Np.addProperty("CustomProperties",2,"Microsoft.WordServices.CustomPropertyCollection",3,!0,null,0);Np.addProperty("Format",21,"String",1,!1,null,0);Np.addProperty("Keywords",6,"String",1,!1,null,0);Np.addProperty("LastAuthor",9,"String",1,!0,null,0);Np.addProperty("LastPrintDate",12,"DateTime?",1,!0,null,0);Np.addProperty("LastSaveTime",14,"DateTime?",1,!0,null,0);Np.addProperty("Manager",22,"String",1,!1,null,0);Np.addProperty("RevisionNumber",10,"String",1,!0,null,0);Np.addProperty("Security",19,
"Int32?",1,!0,null,0);Np.addProperty("Subject",4,"String",1,!1,null,0);Np.addProperty("Template",8,"String",1,!0,null,0);Np.addProperty("Title",3,"String",1,!1,null,0);Np.addProperty("_ReferenceId",1,"String",1,!0,null,0);Np.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Np.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Kr=d.addType("Microsoft.WordServices.Field","{5109ffb2-cad2-4420-8f1d-edf33916127a}","",3,0);Kr.addProperty("_Id",1,"Int32",1,!0,null,0);Kr.addProperty("_ReferenceId",
2,"String",1,!0,null,0);Kr.addProperty("Code",3,"String",1,!0,null,0);Kr.addProperty("Result",4,"Microsoft.WordServices.Range",3,!0,null,0);Kr.addProperty("ParentBody",5,"Microsoft.WordServices.Body",3,!0,null,0);Kr.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Kr.addProperty("ParentContentControlOrNullObject",7,"Microsoft.WordServices.ContentControl",3,!0,null,0);Kr.addProperty("ParentTable",8,"Microsoft.WordServices.Table",3,!0,null,0);Kr.addProperty("ParentTableOrNullObject",
9,"Microsoft.WordServices.Table",3,!0,null,0);Kr.addProperty("ParentTableCell",10,"Microsoft.WordServices.TableCell",3,!0,null,0);Kr.addProperty("ParentTableCellOrNullObject",11,"Microsoft.WordServices.TableCell",3,!0,null,0);Kr.addProperty("Data",16,"String",1,!1,null,0);Kr.addProperty("Kind",13,"Microsoft.WordServices.FieldKind",1,!0,null,0);Kr.addProperty("Locked",15,"Boolean",1,!1,null,0);Kr.addProperty("ShowCodes",14,"Boolean",1,!1,null,0);Kr.addProperty("Type",12,"Microsoft.WordServices.FieldType",
1,!0,null,0);Kr.addMethod("GetNextOrNullObject",1005,"Microsoft.WordServices.Field",3,1,"NextOrNullObject",0);Kr.addMethod("GetNext",1004,"Microsoft.WordServices.Field",3,1,"Next",0);Kr.addMethod("Delete",1003,"Void",0,0,"Delete",0);Kr.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Kr.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);Kr.addMethod("Select",1007,"Void",Pi.None,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);Kr.addMethod("UpdateResult",
1006,"Void",Pi.None,0,"UpdateResult",0);const jC=d.addType("Microsoft.WordServices.FieldCollection","{1eb67e75-ccdb-483a-afb0-03a447729113}","",3,0);jC.addProperty("_ReferenceId",2,"String",1,!0,null,0);jC.addMethod("GetFirst",1003,"Microsoft.WordServices.Field",3,1,"First",0);jC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Field",3,1,"FirstOrNullObject",0);jC.addIndexerMethod(1,"Microsoft.WordServices.Field",3,0).addParameter("index","Object",1,null,0);jC.addMethod("_KeepReference",
1001,"Void",0,1,"_KeepReference",0);jC.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);jC.addMethod("getByTypes",1005,"Microsoft.WordServices.FieldCollection",Pi.ClassObject,1,"getByTypes",0).addParameter("types","Microsoft.WordServices.FieldType[]",1,null,0);jC.setCollectionInfo("Microsoft.WordServices.Field",!0);const aq=d.addType("Microsoft.WordServices.Font","{896a961f-e647-4b59-82da-5f1143b5afc1}","",3,0);aq.addProperty("Bold",4,"Boolean?",1,!1,null,0);aq.addProperty("Color",6,"String",
1,!1,null,0);aq.addProperty("DoubleStrikeThrough",11,"Boolean?",1,!1,null,0);aq.addProperty("HighlightColor",12,"String",1,!1,null,0);aq.addProperty("Italic",5,"Boolean?",1,!1,null,0);aq.addProperty("Name",2,"String",1,!1,null,0);aq.addProperty("Size",3,"Single?",1,!1,null,0);aq.addProperty("StrikeThrough",10,"Boolean?",1,!1,null,0);aq.addProperty("Subscript",8,"Boolean?",1,!1,null,0);aq.addProperty("Superscript",9,"Boolean?",1,!1,null,0);aq.addProperty("Underline",7,"Microsoft.WordServices.UnderlineType",
1,!1,null,0);aq.addProperty("_ReferenceId",1,"String",1,!0,null,0);aq.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);aq.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const yp=d.addType("Microsoft.WordServices.InlinePicture","{ef524552-be9e-413b-8030-e5eb3db24f19}","",3,0);yp.addProperty("AltTextDescription",3,"String",1,!1,null,0);yp.addProperty("AltTextTitle",4,"String",1,!1,null,0);yp.addProperty("Height",5,"Single",1,!1,null,0);yp.addProperty("Hyperlink",6,"String",1,!1,
null,0);yp.addProperty("ImageFormat",11,"Microsoft.WordServices.ImageFormat",1,!0,null,0);yp.addProperty("LockAspectRatio",7,"Boolean",1,!1,null,0);yp.addProperty("Paragraph",10,"Microsoft.WordServices.Paragraph",3,!0,null,0);yp.addProperty("ParentContentControl",9,"Microsoft.WordServices.ContentControl",3,!0,null,0);yp.addProperty("ParentContentControlOrNullObject",15,"Microsoft.WordServices.ContentControl",3,!0,null,0);yp.addProperty("ParentTable",14,"Microsoft.WordServices.Table",3,!0,null,0);
yp.addProperty("ParentTableCell",13,"Microsoft.WordServices.TableCell",3,!0,null,0);yp.addProperty("ParentTableCellOrNullObject",16,"Microsoft.WordServices.TableCell",3,!0,null,0);yp.addProperty("ParentTableOrNullObject",17,"Microsoft.WordServices.Table",3,!0,null,0);yp.addProperty("Width",8,"Single",1,!1,null,0);yp.addProperty("_Id",1,"Int32",1,!0,null,0);yp.addProperty("_ReferenceId",2,"String",1,!0,null,0);yp.addMethod("Delete",1012,"Void",0,0,"Delete",0);yp.addMethod("GetBase64ImageSrc",1003,
"String",1,1,"Base64ImageSrc",0);yp.addMethod("GetNext",1015,"Microsoft.WordServices.InlinePicture",3,1,"Next",0);yp.addMethod("GetNextOrNullObject",1016,"Microsoft.WordServices.InlinePicture",3,1,"NextOrNullObject",0);yp.addMethod("GetRange",1014,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const SC=yp.addMethod("InsertBreak",1006,"Void",0,0,"InsertBreak",0);SC.addParameter("breakType","Microsoft.WordServices.BreakType",
1,null,0);SC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);yp.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const TC=yp.addMethod("InsertFileFromBase64",1011,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);TC.addParameter("base64File","String",1,null,0);TC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const kF=yp.addMethod("InsertHtml",1008,"Microsoft.WordServices.Range",
3,0,"InsertHtml",0);kF.addParameter("html","String",1,null,0);kF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const sE=yp.addMethod("InsertInlinePictureFromBase64",1005,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);sE.addParameter("base64EncodedImage","String",1,null,0);sE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Pu=yp.addMethod("InsertOoxml",1009,"Microsoft.WordServices.Range",3,0,"InsertOoxml",
0);Pu.addParameter("ooxml","String",1,null,0);Pu.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const tE=yp.addMethod("InsertParagraph",1010,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);tE.addParameter("paragraphText","String",1,null,0);tE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const Cj=yp.addMethod("InsertText",1007,"Microsoft.WordServices.Range",3,0,"InsertText",0);Cj.addParameter("text","String",1,null,0);
Cj.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);yp.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);yp.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);yp.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const kB=d.addType("Microsoft.WordServices.InlinePictureCollection","{ea74232b-e74b-4a8b-9d30-04d181c29cfa}","",3,0);kB.addProperty("_ReferenceId",2,"String",1,!0,null,
0);kB.addMethod("GetFirst",1003,"Microsoft.WordServices.InlinePicture",3,1,"First",0);kB.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.InlinePicture",3,1,"FirstOrNullObject",0);kB.addIndexerMethod(1,"Microsoft.WordServices.InlinePicture",3,0).addParameter("index","Object",1,null,0);kB.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);kB.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);kB.setCollectionInfo("Microsoft.WordServices.InlinePicture",!0);const nr=d.addType("Microsoft.WordServices.List",
"{92cb59a8-b889-4985-840c-42b2f740ef33}","",3,0);nr.addProperty("Id",1,"Int32",1,!0,null,0);nr.addProperty("LevelExistences",5,"Boolean[]",1,!0,null,0);nr.addProperty("LevelTypes",4,"Microsoft.WordServices.ListLevelType[]",1,!0,null,0);nr.addProperty("Paragraphs",3,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);nr.addProperty("_ReferenceId",2,"String",1,!0,null,0);nr.addMethod("GetLevelFont",1010,"Microsoft.WordServices.Font",3,1,"LevelFont",0).addParameter("level","Int32",1,null,0);nr.addMethod("GetLevelParagraphs",
1004,"Microsoft.WordServices.ParagraphCollection",3,1,"LevelParagraphs",0).addParameter("level","Int32",1,null,0);nr.addMethod("GetLevelPicture",1009,"String",1,1,"LevelPicture",0).addParameter("level","Int32",1,null,0);nr.addMethod("GetLevelString",1007,"String",1,1,"LevelString",0).addParameter("level","Int32",1,null,0);const Op=nr.addMethod("InsertParagraph",1003,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);Op.addParameter("paragraphText","String",1,null,0);Op.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const GD=nr.addMethod("ResetLevelFont",1011,"Void",0,0,"ResetLevelFont",0);GD.addParameter("level","Int32",1,null,0);GD.addParameter("resetFontName","Boolean",1,null,0);const Os=nr.addMethod("SetLevelAlignment",1012,"Void",0,0,"SetLevelAlignment",0);Os.addParameter("level","Int32",1,null,0);Os.addParameter("alignment","Microsoft.WordServices.Alignment",1,null,0);const uE=nr.addMethod("SetLevelBullet",1005,"Void",0,0,"SetLevelBullet",0);uE.addParameter("level",
"Int32",1,null,0);uE.addParameter("listBullet","Microsoft.WordServices.ListBullet",1,null,0);uE.addParameter("charCode","Int32",1,null,0);uE.addParameter("fontName","String",1,null,0);const lF=nr.addMethod("SetLevelIndents",1013,"Void",0,0,"SetLevelIndents",0);lF.addParameter("level","Int32",1,null,0);lF.addParameter("textIndent","Single",1,null,0);lF.addParameter("bulletNumberPictureIndent","Single",1,null,0);const jD=nr.addMethod("SetLevelNumbering",1006,"Void",0,0,"SetLevelNumbering",0);jD.addParameter("level",
"Int32",1,null,0);jD.addParameter("listNumbering","Microsoft.WordServices.ListNumbering",1,null,0);jD.addParameter("formatString","Object[]",1,null,0);const gG=nr.addMethod("SetLevelPicture",1008,"Void",0,0,"SetLevelPicture",0);gG.addParameter("level","Int32",1,null,0);gG.addParameter("base64EncodedImage","String",1,null,0);const hG=nr.addMethod("SetLevelStartingNumber",1014,"Void",0,0,"SetLevelStartingNumber",0);hG.addParameter("level","Int32",1,null,0);hG.addParameter("startingNumber","Int32",1,
null,0);nr.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);nr.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);const Qu=d.addType("Microsoft.WordServices.ListCollection","{d36f169f-d0b0-44e9-a933-62c4dcb1964f}","",3,0);Qu.addProperty("_ReferenceId",2,"String",1,!0,null,0);Qu.addMethod("GetById",1002,"Microsoft.WordServices.List",3,1,"ById",0).addParameter("id","Int32",1,null,0);Qu.addMethod("GetByIdOrNullObject",1005,"Microsoft.WordServices.List",3,1,"ByIdOrNullObject",0).addParameter("id",
"Int32",1,null,0);Qu.addMethod("GetFirst",1004,"Microsoft.WordServices.List",3,1,"First",0);Qu.addMethod("GetFirstOrNullObject",1006,"Microsoft.WordServices.List",3,1,"FirstOrNullObject",0);Qu.addIndexerMethod(1,"Microsoft.WordServices.List",3,0).addParameter("index","Object",1,null,0);Qu.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Qu.addMethod("_OnAccess",1003,"Void",0,1,"_OnAccess",0);Qu.setCollectionInfo("Microsoft.WordServices.List",!0);const lB=d.addType("Microsoft.WordServices.ListItem",
"{f32748c0-d8dd-44ae-a550-92ed26a085a8}","",3,0);lB.addProperty("Level",4,"Int32",1,!1,null,0);lB.addProperty("ListString",3,"String",1,!0,null,0);lB.addProperty("SiblingIndex",2,"Int32",1,!0,null,0);lB.addProperty("_ReferenceId",1,"String",1,!0,null,0);lB.addMethod("GetAncestor",1003,"Microsoft.WordServices.Paragraph",3,1,"Ancestor",0).addParameter("parentOnly","Boolean",1,null,0);lB.addMethod("GetAncestorOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"AncestorOrNullObject",0).addParameter("parentOnly",
"Boolean",1,null,0);lB.addMethod("GetDescendants",1004,"Microsoft.WordServices.ParagraphCollection",3,1,"Descendants",0).addParameter("directChildrenOnly","Boolean",1,null,0);lB.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);lB.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const Pp=d.addType("Microsoft.WordServices.ListLevel","{533c4bba-63a4-4254-b249-2a6cf843330f}","",3,0);Pp.addProperty("Alignment",3,"Microsoft.WordServices.Alignment",1,!1,null,0);Pp.addProperty("Font",4,
"Microsoft.WordServices.Font",Pi.ClassObject,!0,null,0);Pp.addProperty("LinkedStyle",5,"String",1,!1,null,0);Pp.addProperty("NumberFormat",6,"String",1,!1,null,0);Pp.addProperty("NumberPosition",7,"Single",1,!1,null,0);Pp.addProperty("NumberStyle",8,"Microsoft.WordServices.ListBuiltInNumberStyle",1,!1,null,0);Pp.addProperty("ResetOnHigher",9,"Int32",1,!1,null,0);Pp.addProperty("StartAt",10,"Int32",1,!1,null,0);Pp.addProperty("TabPosition",11,"Single",1,!1,null,0);Pp.addProperty("TextPosition",12,
"Single",1,!1,null,0);Pp.addProperty("TrailingCharacter",13,"Microsoft.WordServices.TrailingCharacter",1,!1,null,0);Pp.addProperty("_Id",1,"Int32",1,!0,null,0);Pp.addProperty("_ReferenceId",2,"String",1,!0,null,0);Pp.addMethod("_KeepReference",1002,"Void",Pi.None,1,"_KeepReference",0);Pp.addMethod("_OnAccess",1001,"Void",Pi.None,1,"_OnAccess",0);const mB=d.addType("Microsoft.WordServices.ListLevelCollection","{0bb00b5d-0a29-41f6-a0d8-f74c3a153600}","",3,0);mB.addProperty("_ReferenceId",2,"String",
1,!0,null,0);mB.addMethod("GetFirst",1003,"Microsoft.WordServices.ListLevel",Pi.ClassObject,1,"First",0);mB.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.ListLevel",Pi.ClassObject,1,"FirstOrNullObject",0);mB.addIndexerMethod(1,"Microsoft.WordServices.ListLevel",Pi.ClassObject,0).addParameter("index","Object",1,null,0);mB.addMethod("_KeepReference",1001,"Void",Pi.None,1,"_KeepReference",0);mB.addMethod("_OnAccess",1002,"Void",Pi.None,1,"_OnAccess",0);mB.setCollectionInfo("Microsoft.WordServices.ListLevel",
!0);const us=d.addType("Microsoft.WordServices.ListTemplate","{6f2e0a54-8e99-420c-9716-81cae154ac0e}","",3,0);us.addProperty("ListLevels",2,"Microsoft.WordServices.ListLevelCollection",Pi.ClassObject,!0,null,0);us.addProperty("OutlineNumbered",3,"Boolean",1,!1,null,0);us.addProperty("_ReferenceId",1,"String",1,!0,null,0);us.addMethod("_KeepReference",1002,"Void",Pi.None,1,"_KeepReference",0);us.addMethod("_OnAccess",1001,"Void",Pi.None,1,"_OnAccess",0);const Cl=d.addType("Microsoft.WordServices.NoteItem",
"{4869fd78-c024-4e18-9405-ffa60e9bfd51}","",3,0);Cl.addProperty("Body",4,"Microsoft.WordServices.Body",3,!0,null,0);Cl.addProperty("Reference",5,"Microsoft.WordServices.Range",3,!0,null,0);Cl.addProperty("Type",3,"Microsoft.WordServices.NoteItemType",1,!0,null,0);Cl.addProperty("_Id",1,"String",1,!0,null,0);Cl.addProperty("_ReferenceId",2,"String",1,!0,null,0);Cl.addMethod("Delete",1003,"Void",0,0,"Delete",0);Cl.addMethod("GetNext",1004,"Microsoft.WordServices.NoteItem",3,1,"Next",0);Cl.addMethod("GetNextOrNullObject",
1005,"Microsoft.WordServices.NoteItem",3,1,"NextOrNullObject",0);Cl.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Cl.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const kC=d.addType("Microsoft.WordServices.NoteItemCollection","{38a0db4c-d855-40aa-879e-2251a0f17b11}","",3,0);kC.addProperty("_ReferenceId",2,"String",1,!0,null,0);kC.addMethod("GetFirst",1003,"Microsoft.WordServices.NoteItem",3,1,"First",0);kC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.NoteItem",
3,1,"FirstOrNullObject",0);kC.addIndexerMethod(1,"Microsoft.WordServices.NoteItem",3,0).addParameter("index","Object",1,null,0);kC.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);kC.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);kC.setCollectionInfo("Microsoft.WordServices.NoteItem",!0);const Hj=d.addType("Microsoft.WordServices.Paragraph","{d0c9772c-becf-4961-a582-8024ebdc614c}","",3,0);Hj.addProperty("Alignment",7,"Microsoft.WordServices.Alignment",1,!1,null,0);Hj.addProperty("ContentControls",
5,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Hj.addProperty("Endnotes",36,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Hj.addProperty("FirstLineIndent",8,"Single",1,!1,null,0);Hj.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Hj.addProperty("Footnotes",35,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Hj.addProperty("Fields",37,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Hj.addProperty("InlinePictures",17,"Microsoft.WordServices.InlinePictureCollection",
3,!0,null,0);Hj.addProperty("IsLastParagraph",28,"Boolean",1,!0,null,0);Hj.addProperty("IsListItem",19,"Boolean",1,!0,null,0);Hj.addProperty("LeftIndent",9,"Single",1,!1,null,0);Hj.addProperty("LineSpacing",11,"Single",1,!1,null,0);Hj.addProperty("LineUnitAfter",16,"Single",1,!1,null,0);Hj.addProperty("LineUnitBefore",15,"Single",1,!1,null,0);Hj.addProperty("List",24,"Microsoft.WordServices.List",3,!0,null,0);Hj.addProperty("ListItem",27,"Microsoft.WordServices.ListItem",3,!0,null,0);Hj.addProperty("ListItemOrNullObject",
34,"Microsoft.WordServices.ListItem",3,!0,null,0);Hj.addProperty("ListOrNullObject",33,"Microsoft.WordServices.List",3,!0,null,0);Hj.addProperty("OutlineLevel",12,"Int32",1,!1,null,0);Hj.addProperty("ParentBody",23,"Microsoft.WordServices.Body",3,!0,null,0);Hj.addProperty("ParentContentControl",6,"Microsoft.WordServices.ContentControl",3,!0,null,0);Hj.addProperty("ParentContentControlOrNullObject",30,"Microsoft.WordServices.ContentControl",3,!0,null,0);Hj.addProperty("ParentTable",26,"Microsoft.WordServices.Table",
3,!0,null,0);Hj.addProperty("ParentTableCell",25,"Microsoft.WordServices.TableCell",3,!0,null,0);Hj.addProperty("ParentTableCellOrNullObject",31,"Microsoft.WordServices.TableCell",3,!0,null,0);Hj.addProperty("ParentTableOrNullObject",32,"Microsoft.WordServices.Table",3,!0,null,0);Hj.addProperty("RightIndent",10,"Single",1,!1,null,0);Hj.addProperty("SpaceAfter",14,"Single",1,!1,null,0);Hj.addProperty("SpaceBefore",13,"Single",1,!1,null,0);Hj.addProperty("Style",4,"String",1,!1,null,0);Hj.addProperty("StyleBuiltIn",
29,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Hj.addProperty("TableNestingLevel",22,"Int32",1,!0,null,0);Hj.addProperty("Text",18,"String",1,!0,null,0);Hj.addProperty("_Id",1,"Int32",1,!0,null,0);Hj.addProperty("_ReferenceId",2,"String",1,!0,null,0);const vE=Hj.addMethod("AttachToList",1022,"Microsoft.WordServices.List",3,0,"AttachToList",0);vE.addParameter("listId","Int32",1,null,0);vE.addParameter("level","Int32",1,null,0);Hj.addMethod("Clear",1011,"Void",0,0,"Clear",0);Hj.addMethod("Delete",
1012,"Void",0,0,"Delete",0);Hj.addMethod("DetachFromList",1023,"Void",0,0,"DetachFromList",0);Hj.addMethod("GetComments",1032,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Hj.addMethod("GetContentControls",1034,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options","Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Hj.addMethod("GetHtml",1014,"String",1,1,"Html",0);Hj.addMethod("GetMetadata",
1028,"Object",1,1,"Metadata",0).addParameter("propertyGUID","String",1,null,0);Hj.addMethod("GetNext",1024,"Microsoft.WordServices.Paragraph",3,1,"Next",0);Hj.addMethod("GetNextOrNullObject",1026,"Microsoft.WordServices.Paragraph",3,1,"NextOrNullObject",0);Hj.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Hj.addMethod("GetPrevious",1025,"Microsoft.WordServices.Paragraph",3,1,"Previous",0);Hj.addMethod("GetPreviousOrNullObject",1027,"Microsoft.WordServices.Paragraph",3,1,"PreviousOrNullObject",
0);Hj.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);Hj.addMethod("GetReviewedText",1033,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);const wE=Hj.addMethod("GetSubrange",1030,"Microsoft.WordServices.Range",3,1,"Subrange",0);wE.addParameter("start","Int32",1,null,0);wE.addParameter("length","Int32",1,null,0);const kD=
Hj.addMethod("GetTextRanges",1020,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);kD.addParameter("endingMarks","String[]",1,null,0);kD.addParameter("trimSpacing","Boolean",1,null,0);const UC=Hj.addMethod("InsertBreak",1010,"Void",0,0,"InsertBreak",0);UC.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);UC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Hj.addMethod("InsertContentControl",1004,"Microsoft.WordServices.ContentControl",
3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);const mF=Hj.addMethod("InsertFileFromBase64",1008,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);mF.addParameter("base64File","String",1,null,0);mF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const nF=Hj.addMethod("InsertHtml",1006,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);nF.addParameter("html","String",1,null,0);nF.addParameter("insertLocation",
"Microsoft.WordServices.InsertLocation",1,null,0);const iG=Hj.addMethod("InsertInlinePictureFromBase64",1003,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);iG.addParameter("base64EncodedImage","String",1,null,0);iG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const HD=Hj.addMethod("InsertOoxml",1007,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);HD.addParameter("ooxml","String",1,null,0);HD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);const lD=Hj.addMethod("InsertParagraph",1009,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);lD.addParameter("paragraphText","String",1,null,0);lD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const sA=Hj.addMethod("InsertTable",1019,"Microsoft.WordServices.Table",3,0,"InsertTable",0);sA.addParameter("rowCount","Int32",1,null,0);sA.addParameter("columnCount","Int32",1,null,0);sA.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);sA.addParameter("values","String[][]",1,null,0);const ID=Hj.addMethod("InsertText",1005,"Microsoft.WordServices.Range",3,0,"InsertText",0);ID.addParameter("text","String",1,null,0);ID.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const oF=Hj.addMethod("Search",1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);oF.addParameter("searchText","String",1,null,0);oF.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Hj.addMethod("Select",
1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const pF=Hj.addMethod("SetMetadata",1029,"Void",0,0,"SetMetadata",0);pF.addParameter("propertyGUID","String",1,null,0);pF.addParameter("propertyValue","Object",1,null,0);const xE=Hj.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);xE.addParameter("delimiters","String[]",1,null,0);xE.addParameter("trimDelimiters","Boolean",1,null,0);xE.addParameter("trimSpacing","Boolean",
1,null,0);Hj.addMethod("StartNewList",1021,"Microsoft.WordServices.List",3,0,"StartNewList",0);Hj.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Hj.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const qF=Hj.addMethod("_Search2",1031,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);qF.addParameter("searchText","String",1,null,0);qF.addParameter("searchFlags","Int32",1,null,0);const yy=d.addType("Microsoft.WordServices.ParagraphCollection","{20a0d5b4-fb08-460c-96aa-6af4afe8f1ba}",
"",3,0);yy.addProperty("_ReferenceId",2,"String",1,!0,null,0);yy.addMethod("GetFirst",1003,"Microsoft.WordServices.Paragraph",3,1,"First",0);yy.addMethod("GetFirstOrNullObject",1005,"Microsoft.WordServices.Paragraph",3,1,"FirstOrNullObject",0);yy.addMethod("GetLast",1004,"Microsoft.WordServices.Paragraph",3,1,"Last",0);yy.addMethod("GetLastOrNullObject",1006,"Microsoft.WordServices.Paragraph",3,1,"LastOrNullObject",0);yy.addMethod("GetById",1007,"Microsoft.WordServices.Paragraph",3,1,"ById",4).addParameter("id",
"String",1,null,0);yy.addMethod("GetByIdOrNullObject",1008,"Microsoft.WordServices.Paragraph",3,1,"ByIdOrNullObject",4).addParameter("id","String",1,null,0);yy.addIndexerMethod(1,"Microsoft.WordServices.Paragraph",3,0).addParameter("index","Object",1,null,0);yy.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);yy.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);yy.setCollectionInfo("Microsoft.WordServices.Paragraph",!0);const pt=d.addType("Microsoft.WordServices.ParagraphFormat",
"{83717b74-133d-406e-b769-670eb67c577c}","",3,0);pt.addProperty("Alignment",2,"Microsoft.WordServices.Alignment",1,!1,null,0);pt.addProperty("FirstLineIndent",3,"Single",1,!1,null,0);pt.addProperty("KeepTogether",4,"Boolean",1,!1,null,0);pt.addProperty("KeepWithNext",5,"Boolean",1,!1,null,0);pt.addProperty("LeftIndent",6,"Single",1,!1,null,0);pt.addProperty("LineSpacing",7,"Single",1,!1,null,0);pt.addProperty("LineUnitAfter",8,"Single",1,!1,null,0);pt.addProperty("LineUnitBefore",9,"Single",1,!1,
null,0);pt.addProperty("MirrorIndents",10,"Boolean",1,!1,null,0);pt.addProperty("OutlineLevel",11,"Microsoft.WordServices.OutlineLevel",1,!1,null,0);pt.addProperty("RightIndent",12,"Single",1,!1,null,0);pt.addProperty("SpaceAfter",13,"Single",1,!1,null,0);pt.addProperty("SpaceBefore",14,"Single",1,!1,null,0);pt.addProperty("WidowControl",15,"Boolean",1,!1,null,0);pt.addProperty("_ReferenceId",1,"String",1,!0,null,0);pt.addMethod("_KeepReference",1002,"Void",Pi.None,1,"_KeepReference",0);pt.addMethod("_OnAccess",
1001,"Void",Pi.None,1,"_OnAccess",0);const Dj=d.addType("Microsoft.WordServices.Range","{4869fd78-c024-4e18-9405-ffa60e9bfd50}","",3,0);Dj.addProperty("ContentControls",6,"Microsoft.WordServices.ContentControlCollection",3,!0,null,0);Dj.addProperty("Endnotes",22,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Dj.addProperty("Fields",23,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Dj.addProperty("Font",3,"Microsoft.WordServices.Font",3,!0,null,0);Dj.addProperty("Footnotes",21,"Microsoft.WordServices.NoteItemCollection",
3,!0,null,0);Dj.addProperty("Hyperlink",11,"String",1,!1,null,0);Dj.addProperty("InlinePictures",8,"Microsoft.WordServices.InlinePictureCollection",3,!0,null,0);Dj.addProperty("IsEmpty",10,"Boolean",1,!0,null,0);Dj.addProperty("Lists",12,"Microsoft.WordServices.ListCollection",3,!0,null,0);Dj.addProperty("Paragraphs",5,"Microsoft.WordServices.ParagraphCollection",3,!0,null,0);Dj.addProperty("ParentBody",16,"Microsoft.WordServices.Body",3,!0,null,0);Dj.addProperty("ParentContentControl",7,"Microsoft.WordServices.ContentControl",
3,!0,null,0);Dj.addProperty("ParentContentControlOrNullObject",18,"Microsoft.WordServices.ContentControl",3,!0,null,0);Dj.addProperty("ParentTable",15,"Microsoft.WordServices.Table",3,!0,null,0);Dj.addProperty("ParentTableCell",14,"Microsoft.WordServices.TableCell",3,!0,null,0);Dj.addProperty("ParentTableCellOrNullObject",19,"Microsoft.WordServices.TableCell",3,!0,null,0);Dj.addProperty("ParentTableOrNullObject",20,"Microsoft.WordServices.Table",3,!0,null,0);Dj.addProperty("Style",4,"String",1,!1,
null,0);Dj.addProperty("StyleBuiltIn",17,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Dj.addProperty("Tables",13,"Microsoft.WordServices.TableCollection",3,!0,null,0);Dj.addProperty("Text",9,"String",1,!0,null,0);Dj.addProperty("_Id",1,"Int32",1,!0,null,0);Dj.addProperty("_ReferenceId",2,"String",1,!0,null,0);Dj.addMethod("GetReviewedText",1041,"String",1,1,"GetReviewedText",0).addParameter("changeTrackingVersion","Microsoft.WordServices.ChangeTrackingVersion",1,null,0);Dj.addMethod("Clear",
1011,"Void",0,0,"Clear",0);Dj.addMethod("CompareLocationWith",1019,"Microsoft.WordServices.LocationRelation",1,1,"CompareLocationWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("Delete",1012,"Void",0,0,"Delete",0);Dj.addMethod("EndPreview",1035,"Void",0,1,"EndPreview",0);Dj.addMethod("ExpandTo",1020,"Microsoft.WordServices.Range",3,0,"ExpandTo",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("ExpandToOrNullObject",1028,"Microsoft.WordServices.Range",
3,0,"ExpandToOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);const rF=Dj.addMethod("GetBookmarks",1026,"String[]",1,1,"Bookmarks",0);rF.addParameter("includeHidden","Boolean",1,null,0);rF.addParameter("includeAdjacent","Boolean",1,null,0);Dj.addMethod("GetComments",1040,"Microsoft.WordServices.CommentCollection",3,1,"Comments",0);Dj.addMethod("GetContentControls",1042,"Microsoft.WordServices.ContentControlCollection",3,1,"GetContentControls",0).addParameter("options",
"Microsoft.WordServices.ContentControlOptions",2,"Microsoft.WordServices.ContentControlOptions",0);Dj.addMethod("GetHtml",1014,"String",1,1,"Html",0);Dj.addMethod("GetHyperlinkRanges",1023,"Microsoft.WordServices.RangeCollection",3,1,"HyperlinkRanges",0);const yE=Dj.addMethod("GetNextTextRange",1022,"Microsoft.WordServices.Range",3,1,"NextTextRange",0);yE.addParameter("endingMarks","String[]",1,null,0);yE.addParameter("trimSpacing","Boolean",1,null,0);const sF=Dj.addMethod("GetNextTextRangeOrNullObject",
1030,"Microsoft.WordServices.Range",3,1,"NextTextRangeOrNullObject",0);sF.addParameter("endingMarks","String[]",1,null,0);sF.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("GetOoxml",1015,"String",1,1,"Ooxml",0);Dj.addMethod("GetRange",1017,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",1,null,0);const zE=Dj.addMethod("GetTextRanges",1025,"Microsoft.WordServices.RangeCollection",3,1,"TextRanges",0);zE.addParameter("endingMarks",
"String[]",1,null,0);zE.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("Highlight",1032,"Void",0,1,"Highlight",0).addParameter("color","String",1,null,0);Dj.addMethod("InsertBookmark",1027,"Void",0,0,"InsertBookmark",0).addParameter("name","String",1,null,0);const JD=Dj.addMethod("InsertBreak",1009,"Void",0,0,"InsertBreak",0);JD.addParameter("breakType","Microsoft.WordServices.BreakType",1,null,0);JD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Dj.addMethod("InsertComment",
1039,"Microsoft.WordServices.Comment",3,0,"InsertComment",0).addParameter("commentText","String",1,null,0);Dj.addMethod("InsertContentControl",1003,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0).addParameter("type","Microsoft.WordServices.ContentControlType",1,null,0);Dj.addMethod("InsertEndnote",1038,"Microsoft.WordServices.NoteItem",3,0,"InsertEndnote",0).addParameter("insertText","String",1,null,0);const KD=Dj.addMethod("InsertField",1043,"Microsoft.WordServices.Field",Pi.ClassObject,
0,"InsertField",0);KD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);KD.addParameter("fieldType","Microsoft.WordServices.FieldType",1,null,0);KD.addParameter("text","String",1,null,0);KD.addParameter("removeFormatting","Boolean",1,null,0);const tF=Dj.addMethod("InsertFileFromBase64",1007,"Microsoft.WordServices.Range",3,0,"InsertFileFromBase64",0);tF.addParameter("base64File","String",1,null,0);tF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",
1,null,0);Dj.addMethod("InsertFootnote",1037,"Microsoft.WordServices.NoteItem",3,0,"InsertFootnote",0).addParameter("insertText","String",1,null,0);const jG=Dj.addMethod("InsertHtml",1005,"Microsoft.WordServices.Range",3,0,"InsertHtml",0);jG.addParameter("html","String",1,null,0);jG.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const AE=Dj.addMethod("InsertInlinePictureFromBase64",1010,"Microsoft.WordServices.InlinePicture",3,0,"InsertInlinePictureFromBase64",0);
AE.addParameter("base64EncodedImage","String",1,null,0);AE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const uF=Dj.addMethod("InsertOoxml",1006,"Microsoft.WordServices.Range",3,0,"InsertOoxml",0);uF.addParameter("ooxml","String",1,null,0);uF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const yz=Dj.addMethod("InsertParagraph",1008,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);yz.addParameter("paragraphText","String",
1,null,0);yz.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const LD=Dj.addMethod("InsertTable",1024,"Microsoft.WordServices.Table",3,0,"InsertTable",0);LD.addParameter("rowCount","Int32",1,null,0);LD.addParameter("columnCount","Int32",1,null,0);LD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);LD.addParameter("values","String[][]",1,null,0);const mD=Dj.addMethod("InsertTapObjectFromFileContent",1031,"Microsoft.WordServices.Range",
3,0,"InsertTapObjectFromFileContent",4);mD.addParameter("fileContent","String",1,null,0);mD.addParameter("objectType","Microsoft.WordServices.TapObjectType",1,null,0);mD.addParameter("contentFormat","Microsoft.WordServices.FileContentFormat",1,null,0);const BE=Dj.addMethod("InsertText",1004,"Microsoft.WordServices.Range",3,0,"InsertText",0);BE.addParameter("text","String",1,null,0);BE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);Dj.addMethod("IntersectWith",1021,
"Microsoft.WordServices.Range",3,0,"IntersectWith",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("IntersectWithOrNullObject",1029,"Microsoft.WordServices.Range",3,0,"IntersectWithOrNullObject",0).addParameter("range","Microsoft.WordServices.Range",3,null,0);Dj.addMethod("PreviewTextReplacement",1034,"Void",0,1,"PreviewTextReplacement",0).addParameter("replacement","String",1,null,0);Dj.addMethod("RemoveHighlight",1033,"Void",0,1,"RemoveHighlight",0);const kG=Dj.addMethod("Search",
1016,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);kG.addParameter("searchText","String",1,null,0);kG.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Dj.addMethod("Select",1013,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const MD=Dj.addMethod("Split",1018,"Microsoft.WordServices.RangeCollection",3,1,"Split",0);MD.addParameter("delimiters","String[]",1,null,0);MD.addParameter("multiParagraphs","Boolean",
1,null,0);MD.addParameter("trimDelimiters","Boolean",1,null,0);MD.addParameter("trimSpacing","Boolean",1,null,0);Dj.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);Dj.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const vF=Dj.addMethod("_Search2",1036,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);vF.addParameter("searchText","String",1,null,0);vF.addParameter("searchFlags","Int32",1,null,0);const VC=d.addType("Microsoft.WordServices.RangeCollection","{38a0db4c-d855-40aa-879e-2251a0f17b1f}",
"",3,0);VC.addProperty("_ReferenceId",2,"String",1,!0,null,0);VC.addMethod("GetFirst",1003,"Microsoft.WordServices.Range",3,1,"First",0);VC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Range",3,1,"FirstOrNullObject",0);VC.addIndexerMethod(1,"Microsoft.WordServices.Range",3,0).addParameter("index","Object",1,null,0);VC.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);VC.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);VC.setCollectionInfo("Microsoft.WordServices.Range",
!0);const ND=d.addType("Microsoft.WordServices.InsertFileOptions","{d396444d-d57f-45bb-a6b1-656f573b250f}","{0ad8e799-7550-4095-aa56-c0c6171febe8}",2,0);ND.addProperty("importChangeTrackingMode",5,"Boolean",1,!1,null,0);ND.addProperty("importPageColor",4,"Boolean",1,!1,null,0);ND.addProperty("importParagraphSpacing",3,"Boolean",1,!1,null,0);ND.addProperty("importStyles",2,"Boolean",1,!1,null,0);ND.addProperty("importTheme",1,"Boolean",1,!1,null,0);const lC=d.addType("Microsoft.WordServices.SearchOptions",
"{957e194f-14af-462d-bd95-e29a55de3b4a}","{88b0a400-950b-42b1-b183-258f504bf71f}",3,0);lC.addProperty("IgnorePunct",1,"Boolean",1,!1,null,0);lC.addProperty("IgnoreSpace",2,"Boolean",1,!1,null,0);lC.addProperty("MatchCase",3,"Boolean",1,!1,null,0);lC.addProperty("MatchPrefix",4,"Boolean",1,!1,null,0);lC.addProperty("MatchSuffix",6,"Boolean",1,!1,null,0);lC.addProperty("MatchWholeWord",8,"Boolean",1,!1,null,0);lC.addProperty("MatchWildcards",7,"Boolean",1,!1,null,0);const vs=d.addType("Microsoft.WordServices.Section",
"{a9d1403c-908b-4178-aa45-6b406aeb8cbf}","",3,0);vs.addProperty("Body",3,"Microsoft.WordServices.Body",3,!0,null,0);vs.addProperty("_Id",1,"Int32",1,!0,null,0);vs.addProperty("_ReferenceId",2,"String",1,!0,null,0);vs.addMethod("GetFooter",1004,"Microsoft.WordServices.Body",3,1,"Footer",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,null,0);vs.addMethod("GetHeader",1003,"Microsoft.WordServices.Body",3,1,"Header",0).addParameter("type","Microsoft.WordServices.HeaderFooterType",1,
null,0);vs.addMethod("GetNext",1005,"Microsoft.WordServices.Section",3,1,"Next",0);vs.addMethod("GetNextOrNullObject",1006,"Microsoft.WordServices.Section",3,1,"NextOrNullObject",0);vs.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);vs.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const nB=d.addType("Microsoft.WordServices.SectionCollection","{23ef4423-1c46-48ee-951a-cec1d21d3a5b}","",3,0);nB.addProperty("_ReferenceId",2,"String",1,!0,null,0);nB.addMethod("GetFirst",1003,"Microsoft.WordServices.Section",
3,1,"First",0);nB.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Section",3,1,"FirstOrNullObject",0);nB.addIndexerMethod(1,"Microsoft.WordServices.Section",3,0).addParameter("index","Object",1,null,0);nB.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);nB.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);nB.setCollectionInfo("Microsoft.WordServices.Section",!0);const mC=d.addType("Microsoft.WordServices.Setting","{03764d8a-7c3a-4a5f-82ec-029fbc6f57ee}","",3,0);mC.addProperty("Key",
2,"String",1,!0,null,0);mC.addProperty("Value",3,"Object",1,!1,null,0);mC.addProperty("_Id",4,"String",1,!0,null,0);mC.addProperty("_ReferenceId",1,"String",1,!0,null,0);mC.addMethod("Delete",1003,"Void",0,0,"Delete",0);mC.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);mC.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const tA=d.addType("Microsoft.WordServices.SettingCollection","{02c3b0b1-2468-48c1-8c30-c1e38c6734f7}","",3,0);tA.addProperty("_ReferenceId",2,"String",1,!0,null,
0);const OD=tA.addMethod("Add",1003,"Microsoft.WordServices.Setting",3,0,"Add",0);OD.addParameter("key","String",1,null,0);OD.addParameter("value","Object",1,null,0);tA.addMethod("DeleteAll",1005,"Void",0,0,"DeleteAll",0);tA.addMethod("GetCount",1004,"Int32",1,1,"Count",0);tA.addIndexerMethod(1,"Microsoft.WordServices.Setting",3,0).addParameter("key","String",1,null,0);tA.addMethod("GetItemOrNullObject",1006,"Microsoft.WordServices.Setting",3,1,"ItemOrNullObject",0).addParameter("key","String",1,
null,0);tA.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);tA.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);tA.setCollectionInfo("Microsoft.WordServices.Setting",!0);const ew=d.addType("Microsoft.WordServices.StyleCollection","{fee8d15d-a953-4906-aa80-af8d02008719}","",3,0);ew.addProperty("_ReferenceId",2,"String",1,!0,null,0);ew.addMethod("GetByName",1003,"Microsoft.WordServices.Style",Pi.ClassObject,1,"GetByName",0).addParameter("name","String",1,null,0);ew.addMethod("GetByNameOrNullObject",
1004,"Microsoft.WordServices.Style",Pi.ClassObject,1,"GetByNameOrNullObject",0).addParameter("name","String",1,null,0);ew.addMethod("GetCount",1005,"Int32",1,1,"Count",0);ew.addIndexerMethod(1,"Microsoft.WordServices.Style",Pi.ClassObject,0).addParameter("index","Object",1,null,0);ew.addMethod("_KeepReference",1002,"Void",Pi.None,1,"_KeepReference",0);ew.addMethod("_OnAccess",1001,"Void",Pi.None,1,"_OnAccess",0);ew.setCollectionInfo("Microsoft.WordServices.Style",!0);const Ps=d.addType("Microsoft.WordServices.Style",
"{c2b96925-a089-4d9d-b70e-9a842277a864}","",3,0);Ps.addProperty("BaseStyle",2,"String",1,!0,null,0);Ps.addProperty("BuiltIn",3,"Boolean",1,!0,null,0);Ps.addProperty("Description",4,"String",1,!0,null,0);Ps.addProperty("Font",5,"Microsoft.WordServices.Font",Pi.ClassObject,!0,null,0);Ps.addProperty("InUse",6,"Boolean",1,!0,null,0);Ps.addProperty("Linked",7,"Boolean",1,!0,null,0);Ps.addProperty("ListTemplate",16,"Microsoft.WordServices.ListTemplate",Pi.ClassObject,!0,null,0);Ps.addProperty("NameLocal",
8,"String",1,!0,null,0);Ps.addProperty("NextParagraphStyle",9,"String",1,!0,null,0);Ps.addProperty("ParagraphFormat",15,"Microsoft.WordServices.ParagraphFormat",Pi.ClassObject,!0,null,0);Ps.addProperty("Priority",10,"Int32",1,!1,null,0);Ps.addProperty("QuickStyle",11,"Boolean",1,!1,null,0);Ps.addProperty("Type",12,"Microsoft.WordServices.StyleType",1,!0,null,0);Ps.addProperty("UnhideWhenUsed",13,"Boolean",1,!1,null,0);Ps.addProperty("Visibility",14,"Boolean",1,!1,null,0);Ps.addProperty("_ReferenceId",
1,"String",1,!0,null,0);Ps.addMethod("Delete",1003,"Void",Pi.None,0,"Delete",0);Ps.addMethod("_KeepReference",1002,"Void",Pi.None,1,"_KeepReference",0);Ps.addMethod("_OnAccess",1001,"Void",Pi.None,1,"_OnAccess",0);const Ak=d.addType("Microsoft.WordServices.Table","{55eb3bc4-acec-4fed-b8d3-10414e633465}","",3,0);Ak.addProperty("Alignment",33,"Microsoft.WordServices.Alignment",1,!1,null,0);Ak.addProperty("Endnotes",38,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ak.addProperty("Fields",
39,"Microsoft.WordServices.FieldCollection",3,!0,null,0);Ak.addProperty("Font",24,"Microsoft.WordServices.Font",3,!0,null,0);Ak.addProperty("Footnotes",37,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);Ak.addProperty("HeaderRowCount",12,"Int32",1,!1,null,0);Ak.addProperty("HorizontalAlignment",22,"Microsoft.WordServices.Alignment",1,!1,null,0);Ak.addProperty("IsUniform",4,"Boolean",1,!0,null,0);Ak.addProperty("NestingLevel",6,"Int32",1,!0,null,0);Ak.addProperty("ParentBody",32,"Microsoft.WordServices.Body",
3,!0,null,0);Ak.addProperty("ParentContentControl",25,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ak.addProperty("ParentContentControlOrNullObject",36,"Microsoft.WordServices.ContentControl",3,!0,null,0);Ak.addProperty("ParentTable",8,"Microsoft.WordServices.Table",3,!0,null,0);Ak.addProperty("ParentTableCell",7,"Microsoft.WordServices.TableCell",3,!0,null,0);Ak.addProperty("ParentTableCellOrNullObject",34,"Microsoft.WordServices.TableCell",3,!0,null,0);Ak.addProperty("ParentTableOrNullObject",
35,"Microsoft.WordServices.Table",3,!0,null,0);Ak.addProperty("RowCount",11,"Int32",1,!0,null,0);Ak.addProperty("Rows",3,"Microsoft.WordServices.TableRowCollection",3,!0,null,0);Ak.addProperty("ShadingColor",18,"String",1,!1,null,0);Ak.addProperty("Style",10,"String",1,!1,null,0);Ak.addProperty("StyleBandedColumns",17,"Boolean",1,!1,null,0);Ak.addProperty("StyleBandedRows",16,"Boolean",1,!1,null,0);Ak.addProperty("StyleBuiltIn",31,"Microsoft.WordServices.StyleBuiltIn",1,!1,null,0);Ak.addProperty("StyleFirstColumn",
14,"Boolean",1,!1,null,0);Ak.addProperty("StyleLastColumn",15,"Boolean",1,!1,null,0);Ak.addProperty("StyleTotalRow",13,"Boolean",1,!1,null,0);Ak.addProperty("Tables",5,"Microsoft.WordServices.TableCollection",3,!0,null,0);Ak.addProperty("Values",9,"String[][]",1,!1,null,0);Ak.addProperty("VerticalAlignment",23,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);Ak.addProperty("Width",27,"Single",1,!1,null,0);Ak.addProperty("_Id",1,"Int32",1,!0,null,0);Ak.addProperty("_ReferenceId",2,"String",
1,!0,null,0);const PD=Ak.addMethod("AddColumns",1004,"Void",0,0,"AddColumns",0);PD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);PD.addParameter("columnCount","Int32",1,null,0);PD.addParameter("values","String[][]",1,null,0);const QD=Ak.addMethod("AddRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"AddRows",0);QD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);QD.addParameter("rowCount","Int32",1,null,0);QD.addParameter("values",
"String[][]",1,null,0);Ak.addMethod("AutoFitWindow",1012,"Void",0,0,"AutoFitWindow",0);Ak.addMethod("Clear",1008,"Void",0,0,"Clear",0);Ak.addMethod("Delete",1007,"Void",0,0,"Delete",0);const uA=Ak.addMethod("DeleteColumns",1010,"Void",0,0,"DeleteColumns",0);uA.addParameter("columnIndex","Int32",1,null,0);uA.addParameter("columnCount","Int32?",1,null,0);const wF=Ak.addMethod("DeleteRows",1009,"Void",0,0,"DeleteRows",0);wF.addParameter("rowIndex","Int32",1,null,0);wF.addParameter("rowCount","Int32?",
1,null,0);Ak.addMethod("DistributeColumns",1014,"Void",0,0,"DistributeColumns",0);Ak.addMethod("GetBorder",1015,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);const lG=Ak.addMethod("GetCell",1005,"Microsoft.WordServices.TableCell",3,1,"Cell",0);lG.addParameter("rowIndex","Int32",1,null,0);lG.addParameter("cellIndex","Int32",1,null,0);const xF=Ak.addMethod("GetCellOrNullObject",1028,"Microsoft.WordServices.TableCell",
3,1,"CellOrNullObject",0);xF.addParameter("rowIndex","Int32",1,null,0);xF.addParameter("cellIndex","Int32",1,null,0);Ak.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);Ak.addMethod("GetNext",1025,"Microsoft.WordServices.Table",3,1,"Next",0);Ak.addMethod("GetNextOrNullObject",1029,"Microsoft.WordServices.Table",3,1,"NextOrNullObject",0);Ak.addMethod("GetParagraphAfter",1027,"Microsoft.WordServices.Paragraph",
3,1,"ParagraphAfter",0);Ak.addMethod("GetParagraphAfterOrNullObject",1031,"Microsoft.WordServices.Paragraph",3,1,"ParagraphAfterOrNullObject",0);Ak.addMethod("GetParagraphBefore",1026,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBefore",0);Ak.addMethod("GetParagraphBeforeOrNullObject",1030,"Microsoft.WordServices.Paragraph",3,1,"ParagraphBeforeOrNullObject",0);Ak.addMethod("GetRange",1019,"Microsoft.WordServices.Range",3,1,"Range",0).addParameter("rangeLocation","Microsoft.WordServices.RangeLocation",
1,null,0);Ak.addMethod("InsertContentControl",1020,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const yF=Ak.addMethod("InsertParagraph",1022,"Microsoft.WordServices.Paragraph",3,0,"InsertParagraph",0);yF.addParameter("paragraphText","String",1,null,0);yF.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);const RD=Ak.addMethod("InsertTable",1021,"Microsoft.WordServices.Table",3,0,"InsertTable",0);RD.addParameter("rowCount","Int32",1,null,0);RD.addParameter("columnCount",
"Int32",1,null,0);RD.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);RD.addParameter("values","String[][]",1,null,0);const nD=Ak.addMethod("MergeCells",1006,"Microsoft.WordServices.TableCell",3,0,"MergeCells",0);nD.addParameter("topRow","Int32",1,null,0);nD.addParameter("firstCell","Int32",1,null,0);nD.addParameter("bottomRow","Int32",1,null,0);nD.addParameter("lastCell","Int32",1,null,0);const CE=Ak.addMethod("Search",1018,"Microsoft.WordServices.RangeCollection",
3,1,"Search",0);CE.addParameter("searchText","String",1,null,0);CE.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);Ak.addMethod("Select",1017,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const mG=Ak.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);mG.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);mG.addParameter("cellPadding","Single",1,null,0);Ak.addMethod("_KeepReference",
1002,"Void",0,1,"_KeepReference",0);Ak.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const zF=Ak.addMethod("_Search2",1032,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);zF.addParameter("searchText","String",1,null,0);zF.addParameter("searchFlags","Int32",1,null,0);const Ru=d.addType("Microsoft.WordServices.TableCollection","{793ca292-e6dc-48f7-b0e6-16311394a5b2}","",3,0);Ru.addProperty("_ReferenceId",2,"String",1,!0,null,0);Ru.addMethod("GetFirst",1003,"Microsoft.WordServices.Table",
3,1,"First",0);Ru.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.Table",3,1,"FirstOrNullObject",0);Ru.addIndexerMethod(1,"Microsoft.WordServices.Table",3,0).addParameter("index","Object",1,null,0);Ru.addMethod("_KeepReference",1001,"Void",0,1,"_KeepReference",0);Ru.addMethod("_OnAccess",1002,"Void",0,1,"_OnAccess",0);Ru.setCollectionInfo("Microsoft.WordServices.Table",!0);const so=d.addType("Microsoft.WordServices.TableRow","{7a28087b-2d9c-4db1-95af-b1ce69d1d4db}","",3,0);so.addProperty("CellCount",
4,"Int32",1,!0,null,0);so.addProperty("Cells",3,"Microsoft.WordServices.TableCellCollection",3,!0,null,0);so.addProperty("Endnotes",20,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);so.addProperty("Font",14,"Microsoft.WordServices.Font",3,!0,null,0);so.addProperty("Fields",21,"Microsoft.WordServices.FieldCollection",3,!0,null,0);so.addProperty("Footnotes",19,"Microsoft.WordServices.NoteItemCollection",3,!0,null,0);so.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",
1,!1,null,0);so.addProperty("IsHeader",16,"Boolean",1,!0,null,0);so.addProperty("ParentTable",5,"Microsoft.WordServices.Table",3,!0,null,0);so.addProperty("PreferredHeight",17,"Single",1,!1,null,0);so.addProperty("RowIndex",6,"Int32",1,!0,null,0);so.addProperty("ShadingColor",8,"String",1,!1,null,0);so.addProperty("Values",7,"String[][]",1,!1,null,0);so.addProperty("VerticalAlignment",13,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);so.addProperty("_Id",1,"Int32",1,!0,null,0);so.addProperty("_ReferenceId",
2,"String",1,!0,null,0);so.addMethod("Clear",1006,"Void",0,0,"Clear",0);so.addMethod("Delete",1005,"Void",0,0,"Delete",0);so.addMethod("GetBorder",1009,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);so.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);so.addMethod("GetNext",1012,"Microsoft.WordServices.TableRow",
3,1,"Next",0);so.addMethod("GetNextOrNullObject",1013,"Microsoft.WordServices.TableRow",3,1,"NextOrNullObject",0);so.addMethod("InsertContentControl",1025,"Microsoft.WordServices.ContentControl",3,0,"InsertContentControl",0);const WC=so.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,1,"InsertRows",0);WC.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);WC.addParameter("rowCount","Int32",1,null,0);WC.addParameter("values","String[][]",1,null,
0);so.addMethod("Merge",1004,"Microsoft.WordServices.TableCell",3,0,"Merge",0);const uv=so.addMethod("Search",1008,"Microsoft.WordServices.RangeCollection",3,1,"Search",0);uv.addParameter("searchText","String",1,null,0);uv.addParameter("searchOptions","Microsoft.WordServices.SearchOptions",3,null,0);so.addMethod("Select",1007,"Void",0,1,"Select",0).addParameter("selectionMode","Microsoft.WordServices.SelectionMode",1,null,0);const SD=so.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",
0);SD.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);SD.addParameter("cellPadding","Single",1,null,0);so.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);so.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const AF=so.addMethod("_Search2",1026,"Microsoft.WordServices.RangeCollection",3,1,"_Search2",0);AF.addParameter("searchText","String",1,null,0);AF.addParameter("searchFlags","Int32",1,null,0);const nC=d.addType("Microsoft.WordServices.TableRowCollection",
"{f752737f-a469-460b-a2c1-08b958efb48f}","",3,0);nC.addProperty("_ReferenceId",2,"String",1,!0,null,0);nC.addMethod("GetFirst",1003,"Microsoft.WordServices.TableRow",3,1,"First",0);nC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableRow",3,1,"FirstOrNullObject",0);nC.addIndexerMethod(1,"Microsoft.WordServices.TableRow",3,0).addParameter("index","Object",1,null,0);nC.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);nC.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",
0);nC.setCollectionInfo("Microsoft.WordServices.TableRow",!0);const or=d.addType("Microsoft.WordServices.TableCell","{276a08f8-2afc-42fd-a336-8890d712e195}","",3,0);or.addProperty("Body",8,"Microsoft.WordServices.Body",3,!0,null,0);or.addProperty("CellIndex",6,"Int32",1,!0,null,0);or.addProperty("ColumnWidth",15,"Single?",1,!1,null,0);or.addProperty("HorizontalAlignment",12,"Microsoft.WordServices.Alignment",1,!1,null,0);or.addProperty("ParentRow",4,"Microsoft.WordServices.TableRow",3,!0,null,0);
or.addProperty("ParentTable",3,"Microsoft.WordServices.Table",3,!0,null,0);or.addProperty("RowIndex",5,"Int32",1,!0,null,0);or.addProperty("ShadingColor",9,"String",1,!1,null,0);or.addProperty("Value",7,"String",1,!1,null,0);or.addProperty("VerticalAlignment",14,"Microsoft.WordServices.VerticalAlignment",1,!1,null,0);or.addProperty("Width",16,"Single",1,!0,null,0);or.addProperty("_Id",1,"Int32",1,!0,null,0);or.addProperty("_ReferenceId",2,"String",1,!0,null,0);or.addMethod("DeleteColumn",1007,"Void",
0,0,"DeleteColumn",0);or.addMethod("DeleteRow",1006,"Void",0,0,"DeleteRow",0);or.addMethod("GetBorder",1008,"Microsoft.WordServices.TableBorder",3,1,"Border",0).addParameter("borderLocation","Microsoft.WordServices.BorderLocation",1,null,0);or.addMethod("GetCellPadding",1023,"Single?",1,1,"CellPadding",0).addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);or.addMethod("GetNext",1011,"Microsoft.WordServices.TableCell",3,1,"Next",0);or.addMethod("GetNextOrNullObject",
1012,"Microsoft.WordServices.TableCell",3,1,"NextOrNullObject",0);const DE=or.addMethod("InsertColumns",1004,"Void",0,0,"InsertColumns",0);DE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,0);DE.addParameter("columnCount","Int32",1,null,0);DE.addParameter("values","String[][]",1,null,0);const EE=or.addMethod("InsertRows",1003,"Microsoft.WordServices.TableRowCollection",3,0,"InsertRows",0);EE.addParameter("insertLocation","Microsoft.WordServices.InsertLocation",1,null,
0);EE.addParameter("rowCount","Int32",1,null,0);EE.addParameter("values","String[][]",1,null,0);const BF=or.addMethod("SetCellPadding",1024,"Void",0,0,"SetCellPadding",0);BF.addParameter("cellPaddingLocation","Microsoft.WordServices.CellPaddingLocation",1,null,0);BF.addParameter("cellPadding","Single",1,null,0);const CF=or.addMethod("Split",1005,"Void",0,0,"Split",0);CF.addParameter("rowCount","Int32",1,null,0);CF.addParameter("columnCount","Int32",1,null,0);or.addMethod("_KeepReference",1002,"Void",
0,1,"_KeepReference",0);or.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const oC=d.addType("Microsoft.WordServices.TableCellCollection","{67dffdfa-3a5c-431b-8ea7-9600e82453e3}","",3,0);oC.addProperty("_ReferenceId",2,"String",1,!0,null,0);oC.addMethod("GetFirst",1003,"Microsoft.WordServices.TableCell",3,1,"First",0);oC.addMethod("GetFirstOrNullObject",1004,"Microsoft.WordServices.TableCell",3,1,"FirstOrNullObject",0);oC.addIndexerMethod(1,"Microsoft.WordServices.TableCell",3,0).addParameter("index",
"Object",1,null,0);oC.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);oC.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);oC.setCollectionInfo("Microsoft.WordServices.TableCell",!0);const zy=d.addType("Microsoft.WordServices.TableBorder","{3e45a91b-f887-4feb-8fef-21e1e40f6fb6}","",3,0);zy.addProperty("Color",2,"String",1,!1,null,0);zy.addProperty("Type",3,"Microsoft.WordServices.BorderType",1,!1,null,0);zy.addProperty("Width",4,"Single",1,!1,null,0);zy.addProperty("_ReferenceId",
1,"String",1,!0,null,0);zy.addMethod("_KeepReference",1002,"Void",0,1,"_KeepReference",0);zy.addMethod("_OnAccess",1001,"Void",0,1,"_OnAccess",0);const fw=d.addEnumType("Microsoft.WordServices.EventType");fw.addEnumField("ContentControlDeleted",0);fw.addEnumField("ContentControlSelectionChanged",1);fw.addEnumField("ContentControlDataChanged",2);fw.addEnumField("ContentControlAdded",3);fw.addEnumField("AnnotationAdded",4);fw.addEnumField("AnnotationChanged",5);fw.addEnumField("AnnotationDeleted",6);
fw.addEnumField("CommentDeleted",7);fw.addEnumField("CommentSelected",8);fw.addEnumField("CommentDeselected",9);fw.addEnumField("CommentChanged",10);fw.addEnumField("CommentAdded",11);fw.addEnumField("ContentControlEntered",12);fw.addEnumField("ContentControlExited",13);fw.addEnumField("DocumentWordCountChanged",14);const lu=d.addEnumType("Microsoft.WordServices.ContentControlType");lu.addEnumField("Unknown",0);lu.addEnumField("RichTextInline",1);lu.addEnumField("RichTextParagraphs",2);lu.addEnumField("RichTextTableCell",
4);lu.addEnumField("RichTextTableRow",8);lu.addEnumField("RichTextTable",16);lu.addEnumField("PlainTextInline",32);lu.addEnumField("PlainTextParagraph",64);lu.addEnumField("Picture",128);lu.addEnumField("BuildingBlockGallery",256);lu.addEnumField("CheckBox",512);lu.addEnumField("ComboBox",1024);lu.addEnumField("DropDownList",2048);lu.addEnumField("DatePicker",4096);lu.addEnumField("RepeatingSection",8192);lu.addEnumField("RichText",31);lu.addEnumField("PlainText",96);const oB=d.addEnumType("Microsoft.WordServices.ContentControlAppearance");
oB.addEnumField("BoundingBox",0);oB.addEnumField("Tags",1);oB.addEnumField("Hidden",2);const Lr=d.addEnumType("Microsoft.WordServices.UnderlineType");Lr.addEnumField("Mixed",-1);Lr.addEnumField("None",0);Lr.addEnumField("Hidden",5);Lr.addEnumField("DotLine",8);Lr.addEnumField("Single",1);Lr.addEnumField("Word",2);Lr.addEnumField("Double",3);Lr.addEnumField("Thick",6);Lr.addEnumField("Dotted",4);Lr.addEnumField("DottedHeavy",20);Lr.addEnumField("DashLine",7);Lr.addEnumField("DashLineHeavy",23);Lr.addEnumField("DashLineLong",
39);Lr.addEnumField("DashLineLongHeavy",55);Lr.addEnumField("DotDashLine",9);Lr.addEnumField("DotDashLineHeavy",25);Lr.addEnumField("TwoDotDashLine",10);Lr.addEnumField("TwoDotDashLineHeavy",26);Lr.addEnumField("Wave",11);Lr.addEnumField("WaveHeavy",27);Lr.addEnumField("WaveDouble",43);const pC=d.addEnumType("Microsoft.WordServices.BreakType");pC.addEnumField("Page",0);pC.addEnumField("Next",2);pC.addEnumField("SectionNext",1002);pC.addEnumField("SectionContinuous",3);pC.addEnumField("SectionEven",
4);pC.addEnumField("SectionOdd",5);pC.addEnumField("Line",6);const oD=d.addEnumType("Microsoft.WordServices.InsertLocation");oD.addEnumField("Before",0);oD.addEnumField("After",1);oD.addEnumField("Start",2);oD.addEnumField("End",3);oD.addEnumField("Replace",4);const pD=d.addEnumType("Microsoft.WordServices.Alignment");pD.addEnumField("Mixed",-2);pD.addEnumField("Unknown",-1);pD.addEnumField("Left",0);pD.addEnumField("Centered",1);pD.addEnumField("Right",2);pD.addEnumField("Justified",3);const FE=
d.addEnumType("Microsoft.WordServices.HeaderFooterType");FE.addEnumField("Primary",0);FE.addEnumField("FirstPage",1);FE.addEnumField("EvenPages",2);const pB=d.addEnumType("Microsoft.WordServices.BodyType");pB.addEnumField("Unknown",-1);pB.addEnumField("MainDoc",0);pB.addEnumField("Section",1);pB.addEnumField("Header",2);pB.addEnumField("Footer",3);pB.addEnumField("TableCell",4);pB.addEnumField("Footnote",5);pB.addEnumField("Endnote",6);pB.addEnumField("NoteItem",7);const GE=d.addEnumType("Microsoft.WordServices.SelectionMode");
GE.addEnumField("Select",0);GE.addEnumField("Start",1);GE.addEnumField("End",2);const Xw=d.addEnumType("Microsoft.WordServices.ImageFormat");Xw.addEnumField("Unsupported",-2);Xw.addEnumField("Undefined",-1);Xw.addEnumField("Bmp",0);Xw.addEnumField("Jpeg",1);Xw.addEnumField("Gif",2);Xw.addEnumField("Tiff",3);Xw.addEnumField("Png",4);Xw.addEnumField("Icon",5);Xw.addEnumField("Exif",6);Xw.addEnumField("Wmf",7);Xw.addEnumField("Emf",8);Xw.addEnumField("Pict",9);Xw.addEnumField("Pdf",10);Xw.addEnumField("Svg",
11);const XC=d.addEnumType("Microsoft.WordServices.RangeLocation");XC.addEnumField("Whole",0);XC.addEnumField("Start",1);XC.addEnumField("End",2);XC.addEnumField("Before",3);XC.addEnumField("After",4);XC.addEnumField("Content",5);const gw=d.addEnumType("Microsoft.WordServices.LocationRelation");gw.addEnumField("Unrelated",0);gw.addEnumField("Equal",1);gw.addEnumField("ContainsStart",2);gw.addEnumField("ContainsEnd",3);gw.addEnumField("Contains",4);gw.addEnumField("InsideStart",5);gw.addEnumField("InsideEnd",
6);gw.addEnumField("Inside",7);gw.addEnumField("AdjacentBefore",8);gw.addEnumField("OverlapsBefore",9);gw.addEnumField("Before",10);gw.addEnumField("AdjacentAfter",11);gw.addEnumField("OverlapsAfter",12);gw.addEnumField("After",13);const qt=d.addEnumType("Microsoft.WordServices.BorderLocation");qt.addEnumField("Top",0);qt.addEnumField("Left",1);qt.addEnumField("Bottom",2);qt.addEnumField("Right",3);qt.addEnumField("InsideHorizontal",4);qt.addEnumField("InsideVertical",5);qt.addEnumField("Inside",
6);qt.addEnumField("Outside",7);qt.addEnumField("All",8);const mu=d.addEnumType("Microsoft.WordServices.CellPaddingLocation");mu.addEnumField("Top",0);mu.addEnumField("Left",1);mu.addEnumField("Bottom",2);mu.addEnumField("Right",3);const $q=d.addEnumType("Microsoft.WordServices.BorderType");$q.addEnumField("Mixed",-1);$q.addEnumField("None",0);$q.addEnumField("Single",1);$q.addEnumField("Double",3);$q.addEnumField("Dotted",6);$q.addEnumField("Dashed",7);$q.addEnumField("DotDashed",8);$q.addEnumField("Dot2Dashed",
9);$q.addEnumField("Triple",10);$q.addEnumField("ThinThickSmall",11);$q.addEnumField("ThickThinSmall",12);$q.addEnumField("ThinThickThinSmall",13);$q.addEnumField("ThinThickMed",14);$q.addEnumField("ThickThinMed",15);$q.addEnumField("ThinThickThinMed",16);$q.addEnumField("ThinThickLarge",17);$q.addEnumField("ThickThinLarge",18);$q.addEnumField("ThinThickThinLarge",19);$q.addEnumField("Wave",20);$q.addEnumField("DoubleWave",21);$q.addEnumField("DashedSmall",22);$q.addEnumField("DashDotStroked",23);
$q.addEnumField("ThreeDEmboss",24);$q.addEnumField("ThreeDEngrave",25);const TD=d.addEnumType("Microsoft.WordServices.VerticalAlignment");TD.addEnumField("Mixed",-1);TD.addEnumField("Top",0);TD.addEnumField("Center",1);TD.addEnumField("Bottom",2);const HE=d.addEnumType("Microsoft.WordServices.ListLevelType");HE.addEnumField("Bullet",0);HE.addEnumField("Number",1);HE.addEnumField("Picture",2);const qC=d.addEnumType("Microsoft.WordServices.ListBullet");qC.addEnumField("Custom",0);qC.addEnumField("Solid",
258231);qC.addEnumField("Hollow",131183);qC.addEnumField("Square",716967);qC.addEnumField("Diamonds",716918);qC.addEnumField("Arrow",717016);qC.addEnumField("Checkmark",717052);const YC=d.addEnumType("Microsoft.WordServices.ListNumbering");YC.addEnumField("None",-1);YC.addEnumField("Arabic",0);YC.addEnumField("UpperRoman",1);YC.addEnumField("LowerRoman",2);YC.addEnumField("UpperLetter",3);YC.addEnumField("LowerLetter",4);const Wf=d.addEnumType("Microsoft.WordServices.StyleBuiltIn");Wf.addEnumField("Other",
-1);Wf.addEnumField("Normal",0);Wf.addEnumField("Heading1",1);Wf.addEnumField("Heading2",2);Wf.addEnumField("Heading3",3);Wf.addEnumField("Heading4",4);Wf.addEnumField("Heading5",5);Wf.addEnumField("Heading6",6);Wf.addEnumField("Heading7",7);Wf.addEnumField("Heading8",8);Wf.addEnumField("Heading9",9);Wf.addEnumField("Toc1",19);Wf.addEnumField("Toc2",20);Wf.addEnumField("Toc3",21);Wf.addEnumField("Toc4",22);Wf.addEnumField("Toc5",23);Wf.addEnumField("Toc6",24);Wf.addEnumField("Toc7",25);Wf.addEnumField("Toc8",
26);Wf.addEnumField("Toc9",27);Wf.addEnumField("FootnoteText",29);Wf.addEnumField("Header",31);Wf.addEnumField("Footer",32);Wf.addEnumField("Caption",34);Wf.addEnumField("FootnoteReference",38);Wf.addEnumField("EndnoteReference",42);Wf.addEnumField("EndnoteText",43);Wf.addEnumField("Title",62);Wf.addEnumField("Subtitle",74);Wf.addEnumField("Hyperlink",85);Wf.addEnumField("Strong",87);Wf.addEnumField("Emphasis",88);Wf.addEnumField("NoSpacing",157);Wf.addEnumField("ListParagraph",179);Wf.addEnumField("Quote",
180);Wf.addEnumField("IntenseQuote",181);Wf.addEnumField("SubtleEmphasis",260);Wf.addEnumField("IntenseEmphasis",261);Wf.addEnumField("SubtleReference",262);Wf.addEnumField("IntenseReference",263);Wf.addEnumField("BookTitle",264);Wf.addEnumField("Bibliography",265);Wf.addEnumField("TocHeading",266);Wf.addEnumField("TableGrid",154);Wf.addEnumField("PlainTable1",267);Wf.addEnumField("PlainTable2",268);Wf.addEnumField("PlainTable3",269);Wf.addEnumField("PlainTable4",270);Wf.addEnumField("PlainTable5",
271);Wf.addEnumField("TableGridLight",272);Wf.addEnumField("GridTable1Light",111);Wf.addEnumField("GridTable1Light_Accent1",280);Wf.addEnumField("GridTable1Light_Accent2",287);Wf.addEnumField("GridTable1Light_Accent3",294);Wf.addEnumField("GridTable1Light_Accent4",301);Wf.addEnumField("GridTable1Light_Accent5",308);Wf.addEnumField("GridTable1Light_Accent6",315);Wf.addEnumField("GridTable2",274);Wf.addEnumField("GridTable2_Accent1",281);Wf.addEnumField("GridTable2_Accent2",288);Wf.addEnumField("GridTable2_Accent3",
295);Wf.addEnumField("GridTable2_Accent4",302);Wf.addEnumField("GridTable2_Accent5",309);Wf.addEnumField("GridTable2_Accent6",316);Wf.addEnumField("GridTable3",275);Wf.addEnumField("GridTable3_Accent1",282);Wf.addEnumField("GridTable3_Accent2",289);Wf.addEnumField("GridTable3_Accent3",296);Wf.addEnumField("GridTable3_Accent4",303);Wf.addEnumField("GridTable3_Accent5",310);Wf.addEnumField("GridTable3_Accent6",317);Wf.addEnumField("GridTable4",276);Wf.addEnumField("GridTable4_Accent1",283);Wf.addEnumField("GridTable4_Accent2",
290);Wf.addEnumField("GridTable4_Accent3",297);Wf.addEnumField("GridTable4_Accent4",304);Wf.addEnumField("GridTable4_Accent5",311);Wf.addEnumField("GridTable4_Accent6",318);Wf.addEnumField("GridTable5Dark",277);Wf.addEnumField("GridTable5Dark_Accent1",284);Wf.addEnumField("GridTable5Dark_Accent2",291);Wf.addEnumField("GridTable5Dark_Accent3",298);Wf.addEnumField("GridTable5Dark_Accent4",305);Wf.addEnumField("GridTable5Dark_Accent5",312);Wf.addEnumField("GridTable5Dark_Accent6",319);Wf.addEnumField("GridTable6Colorful",
278);Wf.addEnumField("GridTable6Colorful_Accent1",285);Wf.addEnumField("GridTable6Colorful_Accent2",292);Wf.addEnumField("GridTable6Colorful_Accent3",299);Wf.addEnumField("GridTable6Colorful_Accent4",306);Wf.addEnumField("GridTable6Colorful_Accent5",313);Wf.addEnumField("GridTable6Colorful_Accent6",320);Wf.addEnumField("GridTable7Colorful",279);Wf.addEnumField("GridTable7Colorful_Accent1",286);Wf.addEnumField("GridTable7Colorful_Accent2",293);Wf.addEnumField("GridTable7Colorful_Accent3",300);Wf.addEnumField("GridTable7Colorful_Accent4",
307);Wf.addEnumField("GridTable7Colorful_Accent5",314);Wf.addEnumField("GridTable7Colorful_Accent6",321);Wf.addEnumField("ListTable1Light",322);Wf.addEnumField("ListTable1Light_Accent1",329);Wf.addEnumField("ListTable1Light_Accent2",336);Wf.addEnumField("ListTable1Light_Accent3",343);Wf.addEnumField("ListTable1Light_Accent4",350);Wf.addEnumField("ListTable1Light_Accent5",357);Wf.addEnumField("ListTable1Light_Accent6",364);Wf.addEnumField("ListTable2",323);Wf.addEnumField("ListTable2_Accent1",330);
Wf.addEnumField("ListTable2_Accent2",337);Wf.addEnumField("ListTable2_Accent3",344);Wf.addEnumField("ListTable2_Accent4",351);Wf.addEnumField("ListTable2_Accent5",358);Wf.addEnumField("ListTable2_Accent6",365);Wf.addEnumField("ListTable3",324);Wf.addEnumField("ListTable3_Accent1",331);Wf.addEnumField("ListTable3_Accent2",338);Wf.addEnumField("ListTable3_Accent3",345);Wf.addEnumField("ListTable3_Accent4",352);Wf.addEnumField("ListTable3_Accent5",359);Wf.addEnumField("ListTable3_Accent6",366);Wf.addEnumField("ListTable4",
325);Wf.addEnumField("ListTable4_Accent1",332);Wf.addEnumField("ListTable4_Accent2",339);Wf.addEnumField("ListTable4_Accent3",346);Wf.addEnumField("ListTable4_Accent4",353);Wf.addEnumField("ListTable4_Accent5",360);Wf.addEnumField("ListTable4_Accent6",367);Wf.addEnumField("ListTable5Dark",326);Wf.addEnumField("ListTable5Dark_Accent1",333);Wf.addEnumField("ListTable5Dark_Accent2",340);Wf.addEnumField("ListTable5Dark_Accent3",347);Wf.addEnumField("ListTable5Dark_Accent4",354);Wf.addEnumField("ListTable5Dark_Accent5",
361);Wf.addEnumField("ListTable5Dark_Accent6",368);Wf.addEnumField("ListTable6Colorful",327);Wf.addEnumField("ListTable6Colorful_Accent1",334);Wf.addEnumField("ListTable6Colorful_Accent2",341);Wf.addEnumField("ListTable6Colorful_Accent3",348);Wf.addEnumField("ListTable6Colorful_Accent4",355);Wf.addEnumField("ListTable6Colorful_Accent5",362);Wf.addEnumField("ListTable6Colorful_Accent6",369);Wf.addEnumField("ListTable7Colorful",328);Wf.addEnumField("ListTable7Colorful_Accent1",335);Wf.addEnumField("ListTable7Colorful_Accent2",
342);Wf.addEnumField("ListTable7Colorful_Accent3",349);Wf.addEnumField("ListTable7Colorful_Accent4",356);Wf.addEnumField("ListTable7Colorful_Accent5",363);Wf.addEnumField("ListTable7Colorful_Accent6",370);const UD=d.addEnumType("Microsoft.WordServices.DocumentPropertyType");UD.addEnumField("String",0);UD.addEnumField("Number",1);UD.addEnumField("Date",2);UD.addEnumField("Boolean",3);const vA=d.addEnumType("Microsoft.WordServices.TapObjectType");vA.addEnumField("Chart",1);vA.addEnumField("SmartArt",
2);vA.addEnumField("Table",3);vA.addEnumField("Image",4);vA.addEnumField("Slide",5);vA.addEnumField("OLE",6);vA.addEnumField("Text",7);const DF=d.addEnumType("Microsoft.WordServices.FileContentFormat");DF.addEnumField("Base64",0);DF.addEnumField("Html",7);DF.addEnumField("Ooxml",9);const IE=d.addEnumType("Microsoft.WordServices.AnnotationParentType");IE.addEnumField("None",0);IE.addEnumField("Document",1);IE.addEnumField("Paragraph",2);IE.addEnumField("Annotation",3);const rC=d.addEnumType("Microsoft.WordServices.AnnotationState");
rC.addEnumField("Undefined",0);rC.addEnumField("Created",10);rC.addEnumField("Sent",20);rC.addEnumField("Duplicated",30);rC.addEnumField("Seen",40);rC.addEnumField("Tried",50);rC.addEnumField("Kept",60);rC.addEnumField("Rejected",70);const VD=d.addEnumType("Microsoft.WordServices.StyleType");VD.addEnumField("Character",0);VD.addEnumField("List",1);VD.addEnumField("Paragraph",2);VD.addEnumField("Table",3);const qD=d.addEnumType("Microsoft.WordServices.OutlineLevel");qD.addEnumField("OutlineLevel1",
0);qD.addEnumField("OutlineLevel2",1);qD.addEnumField("OutlineLevel3",2);qD.addEnumField("OutlineLevel4",3);const Vh=d.addEnumType("Microsoft.WordServices.FieldType");Vh.addEnumField("Addin",81);Vh.addEnumField("AddressBlock",93);Vh.addEnumField("Advance",84);Vh.addEnumField("Ask",38);Vh.addEnumField("Author",17);Vh.addEnumField("AutoText",79);Vh.addEnumField("AutoTextList",89);Vh.addEnumField("BarCode",63);Vh.addEnumField("Bibliography",97);Vh.addEnumField("BidiOutline",92);Vh.addEnumField("Citation",
96);Vh.addEnumField("Comments",19);Vh.addEnumField("Compare",80);Vh.addEnumField("CreateDate",21);Vh.addEnumField("Data",40);Vh.addEnumField("Database",78);Vh.addEnumField("Date",31);Vh.addEnumField("DisplayBarcode",99);Vh.addEnumField("DocProperty",85);Vh.addEnumField("DocVariable",64);Vh.addEnumField("EditTime",25);Vh.addEnumField("Embedded",58);Vh.addEnumField("EQ",49);Vh.addEnumField("Expression",34);Vh.addEnumField("FileName",29);Vh.addEnumField("FileSize",69);Vh.addEnumField("FillIn",39);Vh.addEnumField("FormCheckbox",
71);Vh.addEnumField("FormDropdown",83);Vh.addEnumField("FormText",70);Vh.addEnumField("GotoButton",50);Vh.addEnumField("GreetingLine",94);Vh.addEnumField("Hyperlink",88);Vh.addEnumField("If",7);Vh.addEnumField("Import",55);Vh.addEnumField("Include",36);Vh.addEnumField("IncludePicture",67);Vh.addEnumField("IncludeText",68);Vh.addEnumField("Index",8);Vh.addEnumField("Info",14);Vh.addEnumField("Keywords",18);Vh.addEnumField("LastSavedBy",20);Vh.addEnumField("Link",56);Vh.addEnumField("ListNum",90);Vh.addEnumField("MacroButton",
51);Vh.addEnumField("MergeBarcode",98);Vh.addEnumField("MergeField",59);Vh.addEnumField("MergeRec",44);Vh.addEnumField("MergeSeq",75);Vh.addEnumField("Next",41);Vh.addEnumField("NextIf",42);Vh.addEnumField("NoteRef",72);Vh.addEnumField("NumChars",28);Vh.addEnumField("NumPages",26);Vh.addEnumField("NumWords",27);Vh.addEnumField("OCX",87);Vh.addEnumField("Page",33);Vh.addEnumField("PageRef",37);Vh.addEnumField("Print",48);Vh.addEnumField("PrintDate",23);Vh.addEnumField("Private",77);Vh.addEnumField("Quote",
35);Vh.addEnumField("RD",11);Vh.addEnumField("Ref",3);Vh.addEnumField("RevNum",24);Vh.addEnumField("SaveDate",22);Vh.addEnumField("Section",65);Vh.addEnumField("SectionPages",66);Vh.addEnumField("Seq",12);Vh.addEnumField("Set",6);Vh.addEnumField("Shape",95);Vh.addEnumField("SkipIf",43);Vh.addEnumField("StyleRef",10);Vh.addEnumField("Subject",16);Vh.addEnumField("Subscriber",82);Vh.addEnumField("Symbol",57);Vh.addEnumField("TA",74);Vh.addEnumField("TC",9);Vh.addEnumField("Template",30);Vh.addEnumField("Time",
32);Vh.addEnumField("Title",15);Vh.addEnumField("TOA",73);Vh.addEnumField("TOC",13);Vh.addEnumField("UserAddress",62);Vh.addEnumField("UserInitials",61);Vh.addEnumField("UserName",60);Vh.addEnumField("XE",4);Vh.addEnumField("Empty",-1);Vh.addEnumField("Others",100);Vh.addEnumField("Undefined",0);const WD=d.addEnumType("Microsoft.WordServices.FieldKind");WD.addEnumField("None",0);WD.addEnumField("Hot",1);WD.addEnumField("Warm",2);WD.addEnumField("Cold",3);const EF=d.addEnumType("Microsoft.WordServices.TrailingCharacter");
EF.addEnumField("TrailingTab",0);EF.addEnumField("TrailingSpace",1);EF.addEnumField("TrailingNone",2);const Oj=d.addEnumType("Microsoft.WordServices.ListBuiltInNumberStyle");Oj.addEnumField("None",-1);Oj.addEnumField("Arabic",0);Oj.addEnumField("UpperRoman",1);Oj.addEnumField("LowerRoman",2);Oj.addEnumField("UpperLetter",3);Oj.addEnumField("LowerLetter",4);Oj.addEnumField("Ordinal",5);Oj.addEnumField("CardinalText",6);Oj.addEnumField("OrdinalText",7);Oj.addEnumField("Kanji",10);Oj.addEnumField("KanjiDigit",
11);Oj.addEnumField("AiueoHalfWidth",12);Oj.addEnumField("IrohaHalfWidth",13);Oj.addEnumField("ArabicFullWidth",14);Oj.addEnumField("KanjiTraditional",16);Oj.addEnumField("KanjiTraditional2",17);Oj.addEnumField("NumberInCircle",18);Oj.addEnumField("Aiueo",20);Oj.addEnumField("Iroha",21);Oj.addEnumField("ArabicLZ",22);Oj.addEnumField("Bullet",23);Oj.addEnumField("Ganada",24);Oj.addEnumField("Chosung",25);Oj.addEnumField("GBNum1",26);Oj.addEnumField("GBNum2",27);Oj.addEnumField("GBNum3",28);Oj.addEnumField("GBNum4",
29);Oj.addEnumField("Zodiac1",30);Oj.addEnumField("Zodiac2",31);Oj.addEnumField("Zodiac3",32);Oj.addEnumField("TradChinNum1",33);Oj.addEnumField("TradChinNum2",34);Oj.addEnumField("TradChinNum3",35);Oj.addEnumField("TradChinNum4",36);Oj.addEnumField("SimpChinNum1",37);Oj.addEnumField("SimpChinNum2",38);Oj.addEnumField("SimpChinNum3",39);Oj.addEnumField("SimpChinNum4",40);Oj.addEnumField("HanjaRead",41);Oj.addEnumField("HanjaReadDigit",42);Oj.addEnumField("Hangul",43);Oj.addEnumField("Hanja",44);Oj.addEnumField("Hebrew1",
45);Oj.addEnumField("Arabic1",46);Oj.addEnumField("Hebrew2",47);Oj.addEnumField("Arabic2",48);Oj.addEnumField("HindiLetter1",49);Oj.addEnumField("HindiLetter2",50);Oj.addEnumField("HindiArabic",51);Oj.addEnumField("HindiCardinalText",52);Oj.addEnumField("ThaiLetter",53);Oj.addEnumField("ThaiArabic",54);Oj.addEnumField("ThaiCardinalText",55);Oj.addEnumField("VietCardinalText",56);Oj.addEnumField("LowercaseRussian",58);Oj.addEnumField("UppercaseRussian",59);Oj.addEnumField("LowercaseGreek",60);Oj.addEnumField("UppercaseGreek",
61);Oj.addEnumField("ArabicLZ2",62);Oj.addEnumField("ArabicLZ3",63);Oj.addEnumField("ArabicLZ4",64);Oj.addEnumField("LowercaseTurkish",65);Oj.addEnumField("UppercaseTurkish",66);Oj.addEnumField("LowercaseBulgarian",67);Oj.addEnumField("UppercaseBulgarian",68);Oj.addEnumField("PictureBullet",249);Oj.addEnumField("Legal",253);Oj.addEnumField("LegalLZ",254);const XD=d.addEnumType("Microsoft.WordServices.NoteItemType");XD.addEnumField("Footnote",0);XD.addEnumField("Endnote",1);const rD=d.addEnumType("Microsoft.WordServices.ChangeTrackingMode");
rD.addEnumField("Off",0);rD.addEnumField("TrackAll",1);rD.addEnumField("TrackMineOnly",2);const YD=d.addEnumType("Microsoft.WordServices.ChangeTrackingState");YD.addEnumField("Unknown",0);YD.addEnumField("Normal",1);YD.addEnumField("Added",2);YD.addEnumField("Deleted",4);const FF=d.addEnumType("Microsoft.WordServices.ChangeTrackingVersion");FF.addEnumField("Original",0);FF.addEnumField("Current",1);const GF=d.addEnumType("Microsoft.WordServices.SaveBehavior");GF.addEnumField("Save",0);GF.addEnumField("Prompt",
1);const nG=d.addEnumType("Microsoft.WordServices.CloseBehavior");nG.addEnumField("Save",0);nG.addEnumField("SkipSave",1);const HF=d.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);HF.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);HF.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",
1,null,0);const ZC=d.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ZC.addEnumField("Inactive",0);ZC.addEnumField("Background",1);ZC.addEnumField("Visible",2);const IF=d.addEnumType("Microsoft.AppRuntime.Visibility");IF.addEnumField("Hidden",1);IF.addEnumField("Visible",2);const JF=d.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);JF.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeStartState",0);JF.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0).addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);d.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0).addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);const Cx=d.addEnumType("Microsoft.Authentication.IdentityType");Cx.addEnumField("OrganizationAccount",
0);Cx.addEnumField("MicrosoftAccount",1);const sD=d.addEnumType("Microsoft.Authentication.AuthorityType");sD.addEnumField("External",0);sD.addEnumField("Msa",1);sD.addEnumField("Aad",2);const $C=d.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);$C.addProperty("DisplayName",4,"String",1,!1,null,0);$C.addProperty("Email",3,"String",1,!1,null,0);$C.addProperty("FederationProvider",2,"String",1,!1,null,0);$C.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);const aD=d.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);aD.addProperty("AppId",4,"String",1,!1,null,0);aD.addProperty("Authority",2,"String",1,!1,null,0);aD.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);aD.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);aD.addProperty("TenantId",6,"String",1,!1,null,0);aD.addProperty("Upn",
1,"String",1,!1,null,0);const JE=d.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);JE.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);JE.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4).addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);JE.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);JE.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);const bD=d.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);bD.addProperty("AuthChallenge",3,"String",1,!1,null,0);bD.addProperty("CorrelationId",7,"String",1,!1,null,0);bD.addProperty("Policy",4,"String",1,!1,null,0);bD.addProperty("Resource",2,"String",1,!1,null,0);bD.addProperty("Scope",
5,"String",1,!1,null,0);bD.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);const KE=d.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);KE.addProperty("AccessToken",2,"String",1,!1,null,0);KE.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);const KF=d.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);KF.addProperty("Id",
1,"String",1,!0,null,0);KF.addProperty("Value",2,"Object",1,!1,null,0);const LE=d.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);LE.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0).addParameter("id","String",1,null,0);LE.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0).addParameter("id","String",1,null,0);const qB=d.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
qB.addEnumField("Unknown",0);qB.addEnumField("Basic",1);qB.addEnumField("Premium",2);const rB=d.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0),LF=rB.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);LF.addParameter("feature","String",1,null,0);LF.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);rB.addMethod("GetLicenseFeature",5,
"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0).addParameter("feature","String",1,null,0);const ME=rB.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);ME.addParameter("resource","String",1,null,0);ME.addParameter("policy","String",1,null,0);ME.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);const Dx=rB.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Dx.addParameter("feature","String",1,null,0);Dx.addParameter("fallbackValue",
"Boolean",1,null,0);rB.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);rB.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0).addParameter("experienceId","String",1,null,0);rB.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4).addParameter("feature","String",1,null,0);const Ej=d.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ej.addProperty("Id",5,"String",
1,!0,null,0);Ej.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ej.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);d.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0).addProperty("Scopes",1,"String",1,!1,null,0)};class Kj extends yf{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe){super(d,m,R,Ea,Xe);this.H4j=A;this.qy=da;this.LYa=ib;this.gCa=
Qb;this.G3=ae;this.Lc=Pc;this.zo=gd;this.VZ=Cd;this.Yc=Xd;this.cMa=pc;this.gb=se}get xFa(){return this.H4j}get D6b(){return this.qy}Xdm(){let d={};return{returnValue:({gge:d}=this.G3.jhi(OSF.DDA.Marshaling.CoercionTypeKeys.Table)).returnValue,Pdo:d}}Tdm(){let d={};return{returnValue:({gge:d}=this.G3.jhi(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)).returnValue,Jdo:d.rows}}Lof(d,m){const A={};return m.Qn?this.zo.Bwa(d,m):{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,fJ:A}}Pmm(d,
m,A,R){const da=[];if(!this.zo)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;d=this.zo.iQc(d,R,da);if(d===OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;if(d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return d;d=da[0];R=d.node;if(!Qe.ParagraphReader.Xb(R))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;const Ea=this.Yc.Rf(R);if(!Ea.zb(23))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(!Rf.OutlineElementReader.wDa(Ea.origin)){const ib=new Ze.GraphTransaction(7);ib.Db(Ea.origin);Rf.OutlineElementReader.jqb(Ea.origin);ib.dispose()}A=R.qe(A.$b).htmlElement;if(!A)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;A.scrollIntoView();m===OSF.DDA.Marshaling.SelectionMode.Selected?(m=new Pe.Selection(da,!0),this.mb.Ac(m)):(m=d.cpBegin,d.contextId===ic.a.paragraph?m=0:d.contextId===ic.a.Vc&&(m=Qe.ParagraphReader.textLength(R)),m=Pk.SelectionFactory.ne(R,m),this.mb.Ac(m));window.focus();
return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}xNl(d){if(d.Qn){var m=If.GraphIterator.eb(this.Cba.Uha());for(m=bf.a.Qp(m);m.moveNext();)Qe.ParagraphReader.Xb(m.currentNode);return this.zo.mof(d)}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Axh:[]}}xrk(d,m,A){const R=this.Lc.Pc(15);R.Db(this.Cba.Uha());A===OSF.DDA.Marshaling.BindingType.Text.toString()?{fJ:d,returnValue:m}=this.n3f(d,m,Zc.text):A===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{fJ:d,returnValue:m}=
this.n3f(d,m,Zc.GLb):A===OSF.DDA.Marshaling.BindingType.Table.toString()?{fJ:d,returnValue:m}=this.n3f(d,m,Zc.table):(d=null,m=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);R.dispose();return{returnValue:m,fJ:d}}wrk(d,m,A,R){const da=this.Lc.Pc(15);da.Db(this.Cba.Uha());R===OSF.DDA.Marshaling.BindingType.Text.toString()?{fJ:d,returnValue:m}=this.m3f(d,m,Zc.text,A):R===OSF.DDA.Marshaling.BindingType.Matrix.toString()?{fJ:d,returnValue:m}=this.m3f(d,m,Zc.GLb,A):R===OSF.DDA.Marshaling.BindingType.Table.toString()?
{fJ:d,returnValue:m}=this.m3f(d,m,Zc.table,A):(d=null,m=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType);da.dispose();return{returnValue:m,fJ:d}}Nof(d,m){return this.zo.Nof(d,m)}FPl(d,m,A){return this.zo.Z5h(d,m,!0,A)}CPl(d,m,A){let R;return{returnValue:({zyj:R}=this.zo.Z5h(d,m,!1,A)).returnValue,ubn:R.rows}}BPl(d,m){return this.zo.APl(d,m)}ldg(d,m,A){const R=this.Lc.Pc(15);R.Db(this.Cba.Uha());d=this.zo.ldg(d,m,A);R.dispose();return d}EPl(d,m,A){const R=[];d=this.zo.iQc(m,d,R);d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
A(d,null):0>=R.length?A(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null):this.gCa.getOoxml(R,da=>{A(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,da)},da=>{const Ea=this.x4d(da);this.M3d(da,3);A(Ea,null)})}sho(d,m,A,R,da){const Ea=A.TableHeaders;A=A.TableRows;if(Ea&&Ea.length||A&&A.length){var ib=this.Lc.Pc(15);ib.Db(this.Cba.Uha());this.zo.Rkj(d,m,!0,Ea,A,R,da);ib.dispose()}else da(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"table")}qho(d,m,A,R,da){if(A&&A.length){var Ea=
this.Lc.Pc(15);Ea.Db(this.Cba.Uha());this.zo.Rkj(d,m,!1,null,A,R,da);Ea.dispose()}else da(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType,"matrix")}AZn(d,m,A){return m.Qn?(A(this.iKn(d,m)),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}Gef(d,m,A){if(m.Qn){const R=this.Lc.Pc(15);R.Db(this.Cba.Uha());this.zo.Gef(d,m,A);R.dispose()}else A(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}K_e(d,m,A,R){if(A&&A.length)if(m.Qn){const da=
this.Lc.Pc(15);da.Db(this.Cba.Uha());this.zo.K_e(d,m,A,R);da.dispose()}else R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}QZe(d,m,A,R,da,Ea){if(A&&A.length||R&&R.length)if(m.Qn){const ib=this.Lc.Pc(15);ib.Db(this.Cba.Uha());this.zo.QZe(d,m,A,R,da,Ea);ib.dispose()}else Ea(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else Ea(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam)}M3d(d,m){switch(m){case 0:pl(d)?v.ULS.sendTraceTag(8159503,
341,50,"SetSelectedOoxml failed with error code: {0}",d):v.ULS.sendTraceTag(7611806,341,10,"SetSelectedOoxml failed with error code: {0}",d);break;case 1:pl(d)?v.ULS.sendTraceTag(8159504,341,50,"GetSelectedOoxml failed with error code: {0}",d):v.ULS.sendTraceTag(7151686,341,10,"GetSelectedOoxml failed with error code: {0}",d);break;case 2:pl(d)?v.ULS.sendTraceTag(17385219,341,50,"SetBindingOoxml failed with error code: {0}",d):v.ULS.sendTraceTag(17385220,341,10,"SetBindingOoxml failed with error code: {0}",
d);break;case 3:pl(d)?v.ULS.sendTraceTag(17331611,341,50,"GetBindingOoxml failed with error code: {0}",d):v.ULS.sendTraceTag(17331612,341,10,"GetBindingOoxml failed with error code: {0}",d)}}Udm(d){this.LYa.Vdi(this.mb.ib,m=>{d(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,m)},m=>{const A=this.x4d(m);this.M3d(m,1);d(A,null)})}Ndm(){let d="";const m=this.mb.ib.lb;return 1<this.mb.ib.length||!m||!m.length?{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,fjj:d}:{returnValue:({WQa:d}=
this.cMa.Bqf(m.toArray(),m.isForward)).returnValue,fjj:d}}doo(d,m){const A=this.mb.ib.lb;!d||1<this.mb.ib.length||!A||!A.length||this.cMa.Xge(A.toArray(),A.isForward,d,R=>{m&&m(R)})}hoo(d,m){const A=this.Atf(this.mb.ib.J(0).Pa.node);this.LYa.jnj(this.mb.ib,d,0,0,0,null,R=>{var da=this.LYa.i$b(R,this.gb.yw(A,!0,!0));da.count||(da=this.LYa.i$b(R,this.G9l()));if(da.count){var Ea=[];for(let ib=0;ib<da.count;ib++)R=new Pe.Selection([da.J(ib)],!0),Ea.push(R);da=new Jo.SelectionCollection(Ea,0);this.mb.oZ(da);
m(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else v.ULS.sendTraceTag(19994848,341,10,"AppId:{0}, Can't find the inserted ooxml when invoking SetSelectedOoxml"),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)},R=>{const da=this.x4d(R);this.M3d(R,0);m(da)})}pho(d,m,A,R){let da=null,Ea=({D4e:da}=this.zo.A5h(m,d)).returnValue;if(Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)R(Ea);else if(da.wM!==Zc.text)R(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else if(this.zo.qVm(da)){var ib=
[];Ea=this.zo.iQc(m,d,ib);if(Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)R(Ea);else if(0>=ib.length)R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else{var Qb=null;if(!this.zo.RZd&&({graphNode:Qb,returnValue:Ea}=this.zo.$Jk(da),Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){R(Ea);return}var pc=this.Lc.Pc(15);pc.Db(this.Cba.Uha());if(!this.zo.RZd&&(this.zo.rEf=!1,Ea=this.zo.jza(da),this.zo.rEf=!0,Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)){R(Ea);return}d=(Pc,gd)=>
{if(!this.zo.RZd){if(Pc!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){let Cd=!0;for(const ae of ib)if(!ae.isValid){Cd=!1;break}Cd&&(gd=new Pe.Selection(ib,!0))}gd&&(gd=this.zo.uUn(gd,Qb),Pc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(Pc=gd))}pc.dispose();R(Pc)};Ea=this.cMa.Xge(ib,!0,A,d);Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&d(Ea,null)}}else R(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType)}joo(d,m){let A=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders];
d=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows];A&&A.length||d&&d.length?A&&1<A.length?(v.ULS.sendTraceTag(8458368,344,15,"SetSelectedTable failed for app want to add multi-row header table"),m(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)):(A=A[0],this.G3.Unj(A,d,m)):m(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}goo(d,m){d&&d.length?this.G3.Unj(null,d,m):m(OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType)}rho(d,m,A,R){let da=null,
Ea=({D4e:da}=this.zo.A5h(m,d)).returnValue;if(Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)R(Ea);else if(da.wM!==Zc.text)R(OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding);else{var ib=[];Ea=this.zo.iQc(m,d,ib);Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?R(Ea):0>=ib.length?R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(d=this.zo.dQa(da.sO),this.gCa.Ghe(ib,A,d,4,0,null,()=>{R(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)},Qb=>{const pc=this.x4d(Qb);this.M3d(Qb,
2);R(pc)}))}}Atf(d){const m=new If.GraphIterator;m.set(d);d=null;m.zb(10)&&(d=m.jo(10));return d}G9l(){const d=this.Cba.M8l();return this.gb.yw(d,!0,!0)}iKn(d,m){let A=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const R=this.Lc.Pc(15);R.Db(this.Cba.Uha());A=this.zo.F$i(d,m,()=>{this.zo.k_n(m,d);this.zo.j_n(m,d)});R.dispose();return A}n3f(d,m,A){if(!m||""===m)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,fJ:null};if((A===Zc.GLb||A===Zc.table)&&!this.G3.VUm())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType,
fJ:null};let R,da=({$w:R}=this.zo.ydl()).returnValue;if(da!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:da,fJ:null};A=new We(m,A,this.zo.Mof(R));da=this.zo.voh(d,A);return da!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:da,fJ:null}:this.zo.Bwa(m,d)}m3f(d,m,A,R){if(!m||""===m)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,fJ:null};let da=({$w:R}=this.zo.vTl(R)).returnValue;if(da!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:da,
fJ:null};if(A!==Zc.text){let Ea,ib;({Svj:Ea,kXh:ib,returnValue:da}=this.zo.CTl(R));if(da!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)return{returnValue:da,fJ:null};if(!this.G3.isTable(Ea,ib))return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType,fJ:null}}A=new We(m,A,this.zo.Mof(R));da=this.zo.voh(d,A);return da!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?{returnValue:da,fJ:null}:this.zo.Bwa(m,d)}x4d(d){switch(d){case 1:return OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;
case 7:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat;default:return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}Nzl(d,m,A,R=null,da=null){v.ULS.sendTraceTag(18354818,369,50,"A Word Rich API batch execution is requested.");const Ea=this.Cba.Uha(),ib=this.VZ.create(),Qb=!!(d[6]&1);ib.context.Jm.Iu(Ea);ib.context.appId=m;ib.context.controlId=R;ib.context.nZc=Qb;ib.context.nk=da;R=new Tk(ib.context,m,R);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(R,nm,ib,d).then(pc=>
{ib.context.Jm.WH();if(!pc)return v.ULS.sendTraceTag(9204820,344,10,"The rich api executor call failed."),A(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;A(pc,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{v.ULS.sendTraceTag(35733829,369,10,"A Word Rich API batch execution was failed, AppId:{0}",m);ib.context.Jm.WH();A(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})}gQo(){let d;return Ab.App.dJc?(d=Ab.App.dJc,{returnValue:!0,url:d}):{returnValue:!1,
url:null}}Ozl(d,m,A,R,da){this.Nzl(d,m,da,A,R)}saveSettings(d,m){return this.Cba.Fhj(d,m)}B5a(d){return this.Cba.e6f(d)}}Object(y.a)(Kj,"WordEditorApiObjectModel",yf,[895,896]);class Ar{static qne(d,...m){for(let A=0;A<m.length;A++){if(!d||!d.hasOwnProperty(m[A]))return d=null,{returnValue:!1,value:d};d=d[m[A]]}return{returnValue:!0,value:d}}}Object(y.a)(Ar,"AppsForOfficeCommonUtils",null,[]);class ys{constructor(d,m){this.hNe=null;this.YVe=d;this.Ca=m}wim(d){return ys.hUm(d)?this.lxn:null}get lxn(){if(!this.hNe){const d=
[];d.push(this.YVe.createIncompleteRequestThrottle(this.Ca.nc("WordEditorAppsForOfficeSelectionOoxmlMaxIncompleteRequests",1),this.Ca.nc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",3E4)));d.push(this.YVe.createTokenBucketThrottle(this.Ca.nc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketCapacity",3),this.Ca.nc("WordEditorAppsForOfficeSelectionOoxmlTokenBucketFillingIntervalMilliSec",2E3)));this.hNe=this.YVe.createChainedThrottle(d)}return this.hNe}static hUm(d){const m=d.DdaMethod.DispatchId;
let A=null,R=m===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod&&({value:A}=Ar.qne(d,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue;return R=(R=(R=(R=R||m===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod&&({value:A}=Ar.qne(d,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)||m===OSF.DDA.MethodDispId.dispidGetBindingDataMethod&&({value:A}=Ar.qne(d,OSF.DDA.Marshaling.UniqueArgumentKeys.GetData,
OSF.DDA.Marshaling.GetDataKeys.CoercionType)).returnValue)||m===OSF.DDA.MethodDispId.dispidSetBindingDataMethod&&({value:A}=Ar.qne(d,OSF.DDA.Marshaling.UniqueArgumentKeys.SetData,OSF.DDA.Marshaling.SetDataKeys.CoercionType)).returnValue)&&!!A&&A===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml}}Object(y.a)(ys,"WordEditorApiThrottleStore",null,[889]);class Hk{constructor(d,m,A,R,da){this.iaa=d;this.jhd=A;this.EZ=da}get x3b(){return this.EZ}initialize(){this.iaa.initialize();this.x3b.Ub()}dispose(){this.iaa&&
(this.iaa.dispose(),this.iaa=null);this.x3b&&(this.x3b.dispose(),this.EZ=null)}}Object(y.a)(Hk,"AppsForOfficeIntegrationManager",null,[10]);class rp extends Hk{constructor(d,m,A,R,da,Ea,ib,Qb){super(d,m,A,R,da);this.Sf=null;this.sWj=Qb;this.zo=Ea}initialize(){super.initialize();this.sWj.Ub();this.zo&&this.zo.GVn()}}Object(y.a)(rp,"WordEditorAppsForOfficeIntegrationManager",Hk,[]);var Rq=c(1403),Fm=c(581),Pr=c(536),Gg=c(42),mj=c(1195),tk=c(1134);class zn{create(){return new tk.a}}Object(y.a)(zn,"AppBindingNodeFactory",
null,[380]);class Yk{constructor(d,m,A,R,da,Ea,ib){this.Lc=m;this.Yte=A;this.NSe=R;this.lA=d;this.DVj=da;this.ga=Ea;Yk.Ad=ib}initialize(){}Uha(){const d=If.GraphIterator.eb(yj.App.pn.jb.Zc);this.lA.GP(d);return d.currentNode}M8l(){const d=this.Uha(),m=new If.GraphIterator;m.set(d);return this.lA.Etf(m.currentNode)}GQd(d){return this.F5h(d,!1)}F5h(d,m){let A=null;const R=this.Sib();if(R&&R.Tb(19)){do{var da=R.currentNode;if(!da.getValue(wc.a.NGc)){const Ea=da.getValue(wc.a.kfb);da=da.id.toString();
if(m&&Ea.toLowerCase()===d.toLowerCase()||da===d){A=this.EKc(R);break}}}while(R.Lf(19))}return A}HQd(d){return this.F5h(d,!0)}s9b(d){if(d&&d.fN)return this.kjf(d),this.s9b(d.fN);const m=new U.a;if(d&&d.Bia)for(d=this.Cwa(d),d=bf.a.gp(d);d.moveNext();){const A=d.currentNode;50===A.type&&m.add(new We(A.getValue(wc.a.UT),A.getValue(wc.a.wM),A.getValue(wc.a.sO)))}return m}mof(){const d=new U.a;var m=this.Sib();for(m=bf.a.gp(m.currentNode);m.moveNext();){const A=m.currentNode;50===A.type&&d.add(new We(A.getValue(wc.a.UT),
A.getValue(wc.a.wM),A.getValue(wc.a.sO)))}return d}B5h(){const d=new U.a,m=this.Sib();this.XIl(m,A=>{const R=A.currentNode.id.toString();this.WIl(A,da=>{d.add({["appInstanceId"]:R,["appBindingData"]:new We(da.getValue(wc.a.UT),da.getValue(wc.a.wM),da.getValue(wc.a.sO))})})});return d}XIl(d,m){if(d&&d.Tb(19)){do m(d);while(d.Ri(19))}}WIl(d,m){if(d&&d.Tb(22)){do m(d.currentNode);while(d.Ri(22))}}b8f(d,m){if(!d||!m)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(d.fN)return this.b8f(d.fN,
m);if(d.Bia&&(d=this.Cwa(d))){const A=If.GraphIterator.eb(d);let R=A.Tb(22);for(;R;){if(R.getValue(wc.a.UT)===m)return A.tg(),d.setValue(Me.a.QR,new Date),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;R=A.Ri(22)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}Bwa(d,m){d=this.s9b(d);for(const A of d)if(A.UT===m)return A;return null}KOl(d){const m=this.mof(),A=new U.a;for(const R of m)R.sO===d&&A.add(R);return A}nti(d,m){if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
if(d.fN)return this.kjf(d),this.nti(d.fN,m);if(d.Bia){const A=this.Cwa(d);if(!A)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Bwa(d,m.UT))return this.NUo(d,m);d=this.W9k(m);this.yrk(A,d)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}c5h(){const d=new U.a,m=this.Sib();if(m&&m.Tb(19)){do{const A=this.EKc(m);A&&d.add(A)}while(m.Lf(19))}return d}Nkb(d){if(d&&d.Bia&&!this.Cwa(d)){const m=this.ecf(d);this.JZe(m,d)}}vCf(d,m,A,R){if(n.AFrameworkApplication.K.$("ContentAppIsEnabled")){for(;d&&
!Object(Oh.a)(Pr.a,d);)d=d.ik;d?this.oTk(d)?(R=Object.assign(new mj.a,{id:R.Qn,version:R.version,store:R.store,storeType:R.storeType,instanceId:String.format("{{{0}}}",Eg.a.create()),isContent:!0}),d=this.DVj.wDm(d,m,A,R),ch.a.KDf(d)&&this.o0c(d)):this.ga.Qb(Q.a.jRb,2,{["ak1"]:WordEditorIntl.WordEditorStrings.L_ContentAppError}):v.ULS.sendTraceTag(593876625,344,15,"Context is null")}}o0c(d){d=If.GraphIterator.eb(d);d.zb(12);d.jd(12);d.Gn.YQ=!0}oTk(d){d.contextId===ic.a.view&&d.view.ue&&d.view.mb&&
(d=d.view.mb.qg);return d?d.al?!0:!1:(Yk.Ad.Yb(Rq.a.ef,{["Reason"]:Fm.a.noSelection}),!1)}dho(d){const m=this.Cwa(d);if(m){const A=this.Lc.Pc(15);A.Db(m);m.setValue(wc.a.lfb,d.PGc);m.setValue(Me.a.QR,new Date);A.dispose()}}Wgo(d){const m=this.Cwa(d);if(m){const A=this.Lc.Pc(4);A.Db(m);m.setValue(Gg.a.e4e,d.sharedRuntimeId);m.setValue(Gg.a.f4e,d.backgroundState);m.setValue(Me.a.QR,new Date);A.dispose()}}e6f(d){return d?d.fN?this.e6f(d.fN):d.Bia&&(d=this.Cwa(d))?this.NSe.Dof(d):null:null}Fhj(d,m){if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
if(d.fN)return this.kjf(d),this.Fhj(d.fN,m);if(d.Bia&&(d=this.Cwa(d))){const A=this.Lc.Pc(15);A.Db(d);m=this.NSe.Nao(d,m);d.setValue(Me.a.QR,new Date);A.dispose();return m}v.ULS.sendTraceTag(7143687,344,15,"App Node not found when trying to save settings");return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}dispose(){}Cwa(d){const m=this.Sib();if(m&&m.Tb(19)){do if(this.EKc(m).Ovh(d))return m.currentNode;while(m.Lf(19))}return null}EKc(d){var m=d.currentNode;d=this.NSe.Dof(m);const A=m.getValue(wc.a.kfb),
R=m.getValue(wc.a.qDd),da=m.getValue(wc.a.l3b),Ea=m.getValue(wc.a.m3b),ib=m.getValue(wc.a.NGc),Qb=m.getValue(wc.a.lfb),pc=m.ja(Gg.a.e4e,null),Pc=m.ja(Gg.a.f4e,0);m=m.id.toString();let gd=null;ib||(gd=new fl(m,m,A,R,da,Ea,Qb,!0,pc,Pc),gd.settings=d);return gd}RQf(d){this.lA.GP(d);return d.Tb(18)}Sib(){let d=null;const m=yj.App.pn.jb.Zc;m&&(d=new If.GraphIterator,d.set(m),this.RQf(d)||(d=null));return d}ecf(d){const m=this.Yte.create(1074135137);m.setValue(wc.a.kfb,d.Qn);m.setValue(wc.a.qDd,d.version);
m.setValue(wc.a.l3b,d.store);m.setValue(wc.a.m3b,d.storeType);m.setValue(wc.a.lfb,d.PGc);m.setValue(wc.a.NGc,!1);m.setValue(wc.a.xth,!1);m.setValue(wc.a.Gth,"");m.setValue(wc.a.Lth,"right");m.setValue(wc.a.Oth,350);m.setValue(wc.a.Nth,1);m.setValue(wc.a.Mth,!1);return m}DPl(d,m){if((d=If.GraphIterator.eb(d))&&d.Tb(22)){do{const A=d.currentNode,R=A.getValue(wc.a.UT);if(m===R)return A}while(d.Lf(22))}return null}W9k(d){const m=(new zn).create(1074135140);m.setValue(wc.a.UT,d.UT);m.setValue(wc.a.wM,
d.wM);m.setValue(wc.a.sO,d.sO);return m}NUo(d,m){d=this.Cwa(d);if(!d)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const A=this.DPl(d,m.UT);if(!A)return OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist;A.setValue(wc.a.wM,m.wM);A.setValue(wc.a.sO,m.sO);d.setValue(Me.a.QR,new Date);return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}yrk(d,m){If.GraphIterator.eb(d).Bf(m,22);d.setValue(Me.a.QR,new Date)}JZe(d,m){const A=this.Sib();A&&!d.anchor&&(m=Rh.a.If(m.Dth),Eg.a.compare(m.guid,
Eg.a.nil)&&(v.ULS.sendTraceTag(20796771,344,15,"Instance id is not a extended guid. Create a new extended guid for app node."),m=new Rh.a(Eg.a.create(),1)),A.Q3(d,19,m))}kjf(d){this.Nkb(d.fN)}}Yk.Ad=null;Object(y.a)(Yk,"WordEditorAppsForOfficeModel",null,[888,10]);var jl;(function(d){d[d.notRegistered=0]="notRegistered";d[d.queryStarted=1]="queryStarted";d[d.registrationFailed=2]="registrationFailed";d[d.registered=3]="registered"})(jl||(jl={}));Object(y.b)("CommandRegistrationStatus",jl);class fr{constructor(){this.addInDetails=
this.title=null}}Object(y.a)(fr,"AddInCategoryData",null,[]);class sp{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(y.a)(sp,"AddInDetailData",null,[]);class ej{constructor(){this.href=this.text=null}}Object(y.a)(ej,"AddInLinkData",null,[]);class Bp{constructor(d,m,A){this.Wea=0;this.Ca=d;this.Xqc=m;this.UOe=A}BHa(d,m){d&&m&&this.cuo(m)&&this.SEn()}cuo(d){0===d.qO&&(this.Wea|=1);1===d.qO&&(this.Wea|=2);2===d.qO&&(this.Wea|=4);return!!this.Wea}SEn(){const d=
this.QEn,m=0<(this.Wea&4)&&!d.length;m&&v.ULS.sendTraceTag(509110467,220,10,"get popular add-ins for backstage error: empty category, JsonString {1}",this.UOe);const A={};A.categories=d;A.mruAddIns=this.pgn;appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(A,!m))}get QEn(){if(Yc.c(this.UOe))return[];var d=JSON.parse(this.UOe);if(this.rfn){var m=Object.assign(new fr,{title:CommonUIStrings.l_BackstageMostPopularCategoryTitle,addInDetails:[]});for(var A of d)this.jzh(m,A.solutionIds);return[m]}A=
[];for(m of d)d=Object.assign(new fr,{title:m.title,addInDetails:[]}),this.jzh(d,m.solutionIds),0<d.addInDetails.length&&Array.add(A,d);return A}get pgn(){var d=[],m=this.Xqc.oFa(0);Array.addRange(d,m.PT);m=this.Xqc.oFa(1);Array.addRange(d,m.PT);d.sort((A,R)=>{A=Lb.d(A.displayName);R=Lb.d(R.displayName);return sa.a.localeCompare(A,R)});m=[];for(const A of d)d=Object.assign(new sp,{description:A.description,displayName:A.displayName,solutionId:A.solutionId,uniqueId:this.oPc(A)}),Array.add(m,d);return m}jzh(d,
m){const A=this.qgn;let R=0;for(const da of m){if(4===R)break;if(A.contains(da))continue;m=this.Xqc.JFb(da);if(!m){v.ULS.sendTraceTag(509110497,220,15,"SolutionId not found in mapping: {0}",da);continue}const Ea=Object.assign(new sp,{description:m.description,displayName:m.displayName,solutionId:m.solutionId,uniqueId:this.oPc(m)});this.dxn&&(Ea.links=[Object.assign(new ej,{text:CommonUIStrings.l_AddinListPrivacy,href:m.privacyUrl}),Object.assign(new ej,{text:CommonUIStrings.l_AddinListLicense,href:m.licenseUrl}),
Object.assign(new ej,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+m.solutionId})]);Array.add(d.addInDetails,Ea);++R}}get qgn(){const d=[];var m=this.Xqc.oFa(0);Array.addRange(d,m.PT);m=this.Xqc.oFa(1);Array.addRange(d,m.PT);m=new lc.a(T.a.ih());for(const A of d)m.add(A.solutionId);return m}oPc(d){return this.EJb?String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}get rfn(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BackstageMostPopularEnabled",
!1)}get dxn(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BackstageOneClickInstallEnabled",!1)}get EJb(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(y.a)(Bp,"AddInCategoryManager",null,[]);var fj;(function(d){d[d.myAddins=0]="myAddins";d[d.adminManaged=1]="adminManaged";d[d.popular=2]=
"popular"})(fj||(fj={}));Object(y.b)("AddinCollectionType",fj);var uk=c(505);class vk{constructor(){this.downloadNumber=this.AUP=this.priority=0}}Object(y.a)(vk,"AddinDetailInfo",null,[]);class Wl{constructor(d){this.solutionIds=null;this.errorCode=0;this.failure=null;this.NOa=d}}Object(y.a)(Wl,"AddinCollection",null,[]);class wk extends Sys.EventArgs{constructor(d,m,A,R=null){super();this.qO=d;this.errorCode=m;this.PT=A;this.failure=R}}Object(y.a)(wk,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,
[]);class kn{constructor(d){this.errorCode=d;this.PT=[];this.failure=null}}Object(y.a)(kn,"GetAddinDetailsResult",null,[]);class Gn{}Object(y.a)(Gn,"GetEntitlementDetailsParameters",null,[]);var tm=c(105);class lo{constructor(d,m,A=null){this.sa=new vb.a;this.bB=new uk.a(T.a.ih());this.nr=new tg.a;this.Tfa=null;this.KCa=new ke.a;this.KCa.add(OSF.StoreTypeEnum.MarketPlace,0);this.KCa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ca=d;this.Hj=m;this.au=A;this.cxc=lo.eRc(d,"https://store-images.s-microsoft.com");
this.$eb(Object(I.a)(this,this.BHa,"onAddinDetailsRefreshed"))}get Aib(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get PWc(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Et(){return this.Hj.value}oFa(d){if(!this.DGa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:fj[d]}),Object.assign(new kn(1),{failure:d});if(this.nr.J(d).failure)return Object.assign(new kn(this.nr.J(d).errorCode),
{failure:this.nr.J(d).failure});v.ULS.shipAssertTag(509870082,220,!!this.nr.J(d).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const m=new kn(0);for(let A of this.nr.J(d).solutionIds)this.bB.nb(A)&&Array.add(m.PT,this.bB.J(A));return m}JFb(d){return this.bB.nb(d)?this.bB.J(d):null}gpb(d){if(d){this.$eb(d);for(let A of this.nr.keys)if(this.DGa(A)&&!this.nr.J(A).failure){v.ULS.shipAssertTag(509870081,220,!!this.nr.J(A).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
A);var m=[];for(let R of this.nr.J(A).solutionIds)Array.add(m,this.bB.J(R));m=new wk(A,this.nr.J(A).errorCode,m);d(null,m)}}}fZ(d,m=!1){0!==d&&10!==d?v.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Rg[d]):this.k5c(d,Object(I.a)(this,this.N2c,"onQueryAddinDetailsCompleted"),m)}$eb(d){this.sa.addHandler(Ye.a.W2b,d)}N2c(d,m,A){if(A)if(lo.P_c(d,A,window.performance.now()-m),0===A.errorCode){let da;if(A.value){let Ea=0;da=Array(A.value.length);A.value.forEach(ib=>{da[Ea++]=
ib})}else da=[];this.fV(d,da)}else if(-1===A.errorCode||10===A.errorCode)this.fV(d,[]);else{var R={};R.collectionType=fj[d];R.invokeResultCode=A.errorCode;R["queryResult.Value"]=A.value?String.format("Length: {0}",A.value.length):"null";R.queryStart=m;R.queryDuration=window.performance.now()-m;this.nr.Z(d,Object.assign(new Wl(d),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",R)}));v.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",
fj[d],this.nr.J(d).failure.toString(),JSON.stringify(this.nr.J(d).failure))}else R={},R.collectionType=fj[d],R.queryResult=A?"not null":"null",R.queryStart=m,R.queryDuration=window.performance.now()-m,this.nr.Z(d,Object.assign(new Wl(d),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",R)})),v.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",fj[d],this.nr.J(d).failure.toString(),
JSON.stringify(this.nr.J(d).failure))}Syf(d){const m={};m.collectionType=fj[d];this.nr.Z(d,Object.assign(new Wl(d),{errorCode:2,failure:Error.create("The store is disabled.",m)}));v.ULS.sendTraceTag(510253056,220,15,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",fj[d],this.nr.J(d).failure.toString(),JSON.stringify(this.nr.J(d).failure))}S$c(){return this.DGa(2)?this.Ca.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.nr.J(2).failure:
!1:!0}k5c(d,m,A=!1){v.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog?v.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d):(this.S$c()&&this.queryStoreDisabled(0,(R,da)=>{da?this.Syf(2):(R=window.performance.now(),m(2,R,this.Ztf()))}),this.queryStoreDisabled(d,(R,da)=>{if(R===OSF.StoreTypeEnum.MarketPlace&&da)this.Syf(0);else if(R===OSF.StoreTypeEnum.PrivateCatalog&&da)this.Syf(1);
else{var Ea=window.performance.now();this.Et.getEntitlementDetails(Object.assign(new Gn,{storeType:R,refresh:A}),ib=>{m(this.KCa.J(R),Ea,ib)})}}))}fV(d,m){d=new wk(d,0,m);this.sa.raiseEvent(Ye.a.W2b,d)}BHa(d,m){d=Object.assign(new Wl(m.qO),{solutionIds:new U.a});var A=m.PT;for(const R of A)A=R.solutionId,this.bB.nb(A)?this.bB.Z(A,this.O0c(this.bB.J(A),m.qO,R)):this.bB.add(A,R),d.solutionIds.add(A);this.nr.Z(m.qO,d)}DGa(d){return this.nr.nb(d)?!!this.bB:!1}get dHc(){return this.au?!this.au.AreThirdPartyAddInsAllowed||
this.au.AppsForOfficeThirdPartyIsDisabled:!this.Ca.$("AreThirdPartyAddInsAllowed")||this.Ca.$("AppsForOfficeThirdPartyIsDisabled")}get tXc(){return this.au?!this.au.AppsForOfficeAllowExternalMarketplace:!this.Ca.$("AppsForOfficeAllowExternalMarketplace")}get Mob(){return this.au?this.au.PopularAddinDetailsJsonString:this.Ca.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,m){if(this.dHc)m(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.tXc)m(d,!0);else{const A=lo.ocd(d);if(A){const R=
window.performance.now();this.Et.queryStoreDisabled(A,da=>{v.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",d,da,R,window.performance.now()-R);m(d,da)})}else m(d,!1)}}O0c(d,m,A){if(!d)return A;if(!A)return d;if(this.Aib)return 2===m?lo.Zmb(A,d):lo.Zmb(d,A);if(2===m)return d.addinInfo=A.addinInfo,d;A.addinInfo=d.addinInfo;return A}Ztf(){if(!this.Tfa){const d=JSON.parse(this.Mob);this.QOc(d);this.Tfa=d}return lo.VBb(0,this.Tfa)}QOc(d){this.Aib&&
lo.TGc(d);this.v3b(d);this.ROc(d)}v3b(d){const m=this.VHc();for(var A=0;A<d.length&&0<m.count;A++){const R=d[A];if(m.nb(R.solutionId)){let da=String.format("Found an override, solutionId: {0}",R.solutionId);const Ea=m.J(R.solutionId);Ea&&(isNaN(Ea.addinInfo.priority)||(da=String.format("{0}; AddinInfo.Priority: update {1} to {2}",da,R.addinInfo.priority,Ea.addinInfo.priority),R.addinInfo.priority=Ea.addinInfo.priority),isNaN(Ea.addinInfo.AUP)||(da=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
da,R.addinInfo.AUP,Ea.addinInfo.AUP),R.addinInfo.AUP=Ea.addinInfo.AUP),isNaN(Ea.addinInfo.downloadNumber)||(da=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",da,R.addinInfo.downloadNumber,Ea.addinInfo.downloadNumber),R.addinInfo.downloadNumber=Ea.addinInfo.downloadNumber),Ea.displayName&&(da=String.format("{0}; DisplayName: update {1} to {2}",da,R.displayName,Ea.displayName),R.displayName=Ea.displayName),Ea.iconUrl&&(da=String.format("{0}; IconUrl: update {1} to {2}",da,R.iconUrl,
Ea.iconUrl),R.iconUrl=Ea.iconUrl),Ea.description&&(da=String.format("{0}; Description: update {1} to {2}",da,R.description,Ea.description),R.description=Ea.description));m.remove(R.solutionId);this.PWc&&v.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",da)}}for(let R of m.keys)A=m.J(R),A.displayName&&A.iconUrl&&A.addinInfo&&(d.push(A),this.PWc&&v.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(A)))}VHc(){const d=
new uk.a(T.a.ih());let m=this.Ca.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!m)return d;m=m.trim();if(12>=m.length)return 0<m.length&&v.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",m),d;this.PWc&&v.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",m);try{const A=[],R=m.split("|");for(let da=R.length-1;0<=da;da--){const Ea=R[da],ib=Ea.split("\\");if(2>ib.length){A.push(Ea);
continue}const Qb=lo.U3c(ib);Qb?d.nb(Qb.solutionId)||d.add(Qb.solutionId,Qb):A.push(Ea)}this.PWc&&0<A.length&&v.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",A.join("|"));this.PWc&&0<d.count&&v.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(tm.toArray(d.values)));return d}catch(A){v.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
m,A.toString())}return d}ROc(d){for(let m=0;m<d.length;m++)Lb.c(d[m].iconUrl.toLowerCase(),"http",0)||(d[m].iconUrl=String.format("{0}/image/apps.{1}",this.cxc,d[m].iconUrl))}static P_c(d,m,A){const R={};R.AddinCollectionType=fj[d];R.ErrorCode=m.errorCode;R.AddinCount=m.value?m.value.length:0;v.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",A,JSON.stringify(R))}static VBb(d,m){const A={};A.errorCode=d;A.value=m;return A}static ocd(d){return d===
OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Zmb(d,m){m.solutionId=m.solutionId||d.solutionId;m.version=m.version||d.version;m.storeType=m.storeType||d.storeType;m.storeId=m.storeId||d.storeId;m.assetId=m.assetId||d.assetId;m.assetStoreId=m.assetStoreId||d.assetStoreId;m.displayName=m.displayName||d.displayName;m.provider=m.provider||d.provider;m.description=m.description||d.description;m.iconUrl=m.iconUrl||d.iconUrl;m.webApplicationId=m.webApplicationId||
d.webApplicationId;m.highResolutionIconUrl=m.highResolutionIconUrl||d.highResolutionIconUrl;m.licenseUrl=m.licenseUrl||d.licenseUrl;m.privacyUrl=m.privacyUrl||d.privacyUrl;m.addinInfo=m.addinInfo||d.addinInfo;isNaN(m.targetType)&&(m.targetType=d.targetType);isNaN(m.height)&&(m.height=d.height);isNaN(m.width)&&(m.width=d.width);return m}static TGc(d){for(const m of d)isNaN(m.targetType)&&(m.targetType=1),m.assetId=m.assetId||m.solutionId,m.storeId=m.storeId||"en-US",m.storeType=m.storeType||"omex",
m.assetStoreId=m.assetStoreId||"omex",isNaN(m.width)&&(m.width=0),isNaN(m.height)&&(m.height=0)}static U3c(d){const m={};let A=0;A<d.length&&0<d[A].trim().length&&d[A].trim().toLowerCase().startsWith("wa")&&(m.solutionId=d[A].trim(),m.addinInfo=Object.assign(new vk,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.priority=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.AUP=parseInt(d[A].trim())),++A<d.length&&
0<d[A].trim().length&&(m.addinInfo.downloadNumber=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.displayName=d[A].trim()),++A<d.length&&0<d[A].trim().length&&(m.iconUrl=d[A].trim()),++A<d.length&&0<d[A].trim().length&&(m.description=d[A].trim()));return m.solutionId?m:null}static eRc(d,m){d=d.kb("AddinImageStoreServiceUrl");if(!d)return m;d=d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:m}}Object(y.a)(lo,"AddinDetailsManager",null,[1257,1258]);class Uo{constructor(d,
m=0){this.failure=null;this.NOa=d;this.errorCode=m}}Object(y.a)(Uo,"AddinQueryResult",null,[]);class $h extends Uo{constructor(d,m=0){super(d,m);this.solutionIds=null}}Object(y.a)($h,"AddinCollection",Uo,[]);var gq;(function(d){d[d.OK=0]="OK";d[d.notReady=1]="notReady";d[d.storeDisabled=2]="storeDisabled";d[d.invokeFailure=3]="invokeFailure"})(gq||(gq={}));Object(y.b)("AddinDetailsQueryError",gq);class Ql{constructor(d,m,A=null){this.sa=new vb.a;this.bB=new uk.a(T.a.ih());this.nr=new tg.a;this.Tfa=
null;this.KCa=new ke.a;this.KCa.add(OSF.StoreTypeEnum.MarketPlace,0);this.KCa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ca=d;this.Hj=m;this.au=A;this.cxc=Ql.eRc(d,"https://store-images.s-microsoft.com");this.$eb(Object(I.a)(this,this.BHa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ca&&this.Ca.$("IsAnonymousUser")}get pmf(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get $Oc(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",
!0)}get Aib(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get jFa(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Et(){return this.Hj.value}oFa(d){if(!this.DGa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:fj[d]}),Object.assign(new kn(1),{failure:d});if(this.nr.J(d).failure)return Object.assign(new kn(this.nr.J(d).errorCode),{failure:this.nr.J(d).failure});
v.ULS.shipAssertTag(509870082,220,!!this.nr.J(d).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const m=new kn(0);for(let A of this.nr.J(d).solutionIds)this.bB.nb(A)&&Array.add(m.PT,this.bB.J(A));return m}JFb(d){return this.bB.nb(d)?this.bB.J(d):null}gpb(d){if(d){this.$eb(d);for(let m of this.nr.keys){if(!this.DGa(m)||this.nr.J(m).failure)continue;v.ULS.shipAssertTag(509870081,220,!!this.nr.J(m).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
m);const A=[],R=this.nr.J(m);for(let da of R.solutionIds)Array.add(A,this.bB.J(da));d(null,new wk(m,R.errorCode,A,R.failure))}}}fZ(d,m=!1){0!==d&&10!==d?v.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Rg[d]):this.k5c(d,Object(I.a)(this,this.N2c,"onQueryAddinDetailsCompleted"),m)}$eb(d){this.sa.addHandler(Ye.a.W2b,d)}N2c(d,m,A){if(A)if(Ql.P_c(d,A,window.performance.now()-m),0===A.errorCode){let R;if(A.value){let da=0;R=Array(A.value.length);A.value.forEach(Ea=>
{R[da++]=Ea})}else R=[];this.fV(new Uo(d),R)}else-1===A.errorCode||10===A.errorCode?this.fV(new Uo(d),[]):(d=this.b6e(d,m,A),this.fV(d));else d=Ql.c6e(d,m),this.fV(d)}b6e(d,m,A){const R={};R.collectionType=fj[d];R.invokeResultCode=A.errorCode;R["queryResult.Value"]=A.value?String.format("Length: {0}",A.value.length):"null";R.queryStart=m;R.queryDuration=window.performance.now()-m;return Object.assign(new Uo(d,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",R)})}S$c(){return this.DGa(2)?
this.Ca.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.nr.J(2).failure:!1:!0}k5c(d,m,A=!1){v.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog?v.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d):(this.S$c()&&this.queryStoreDisabled(0,(R,da)=>{da?(R=Ql.WBb(2),this.fV(R)):(R=window.performance.now(),m(2,R,this.Ztf()))}),this.$Oc&&this.isAnonymousUser?
(d=Ql.T5e(d===OSF.StoreTypeEnum.MarketPlace?0:1),this.fV(d)):this.queryStoreDisabled(d,(R,da)=>{if(R===OSF.StoreTypeEnum.MarketPlace&&da)da=Ql.WBb(0),this.fV(da);else if(R===OSF.StoreTypeEnum.PrivateCatalog&&da)da=Ql.WBb(1),this.fV(da);else{var Ea=window.performance.now();this.Et.getEntitlementDetails(Object.assign(new Gn,{storeType:R,refresh:A}),ib=>{m(this.KCa.J(R),Ea,ib)})}}))}fV(d,m=null){0!==d.errorCode?(v.ULS.shipAssertTag(509116673,220,!m,"The parameter addinDetails must be null for any failed queries"),
v.ULS.shipAssertTag(509116672,220,!!d.failure,"The result.Failure must not be available for any failed queries"),v.ULS.sendTraceTag(510253056,220,this.qwf(d),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",fj[d.NOa],gq[d.errorCode],d.failure?d.failure.toString():"null",JSON.stringify(d.failure))):(v.ULS.shipAssertTag(509116643,220,!!m,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",fj[d.NOa]),
v.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",fj[d.NOa],m?m.length:-1));d=new wk(d.NOa,d.errorCode,m,d.failure);this.sa.raiseEvent(Ye.a.W2b,d)}qwf(d){return 3===d.errorCode&&(this.$Oc&&-2147208619===Ql.kRc(d)||this.pmf&&-2===Ql.kRc(d))?15:2===d.errorCode?15:10}BHa(d,m){if(0!==m.errorCode)this.nr.Z(m.qO,Object.assign(new $h(m.qO,m.errorCode),{failure:m.failure}));else{d=Object.assign(new $h(m.qO),{solutionIds:new U.a});var A=
m.PT;for(const R of A)A=R.solutionId,this.bB.nb(A)?this.bB.Z(A,this.O0c(this.bB.J(A),m.qO,R)):this.bB.add(A,R),d.solutionIds.add(A);this.nr.Z(m.qO,d)}}DGa(d){return this.nr.nb(d)?!!this.bB:!1}get dHc(){return this.au?!this.au.AreThirdPartyAddInsAllowed||this.au.AppsForOfficeThirdPartyIsDisabled:!this.Ca.$("AreThirdPartyAddInsAllowed")||this.Ca.$("AppsForOfficeThirdPartyIsDisabled")}get tXc(){return this.au?!this.au.AppsForOfficeAllowExternalMarketplace:!this.Ca.$("AppsForOfficeAllowExternalMarketplace")}get Mob(){return this.au?
this.au.PopularAddinDetailsJsonString:this.Ca.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,m){if(this.dHc)m(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.tXc)m(d,!0);else{const A=Ql.ocd(d);if(A){const R=window.performance.now();this.Et.queryStoreDisabled(A,da=>{v.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",d,da,R,window.performance.now()-R);m(d,da)})}else m(d,!1)}}O0c(d,m,A){if(!d)return A;if(!A)return d;
if(this.Aib)return 2===m?Ql.Zmb(A,d):Ql.Zmb(d,A);if(2===m)return d.addinInfo=A.addinInfo,d;A.addinInfo=d.addinInfo;return A}Ztf(){if(!this.Tfa){const d=JSON.parse(this.Mob);this.QOc(d);this.Tfa=d}return Ql.VBb(0,this.Tfa)}QOc(d){this.Aib&&Ql.TGc(d);this.v3b(d);this.ROc(d)}v3b(d){const m=this.VHc();for(var A=0;A<d.length&&0<m.count;A++){const R=d[A];if(m.nb(R.solutionId)){let da=String.format("Found an override, solutionId: {0}",R.solutionId);const Ea=m.J(R.solutionId);Ea&&(isNaN(Ea.addinInfo.priority)||
(da=String.format("{0}; AddinInfo.Priority: update {1} to {2}",da,R.addinInfo.priority,Ea.addinInfo.priority),R.addinInfo.priority=Ea.addinInfo.priority),isNaN(Ea.addinInfo.AUP)||(da=String.format("{0}; AddinInfo.AUP: update {1} to {2}",da,R.addinInfo.AUP,Ea.addinInfo.AUP),R.addinInfo.AUP=Ea.addinInfo.AUP),isNaN(Ea.addinInfo.downloadNumber)||(da=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",da,R.addinInfo.downloadNumber,Ea.addinInfo.downloadNumber),R.addinInfo.downloadNumber=Ea.addinInfo.downloadNumber),
Ea.displayName&&(da=String.format("{0}; DisplayName: update {1} to {2}",da,R.displayName,Ea.displayName),R.displayName=Ea.displayName),Ea.iconUrl&&(da=String.format("{0}; IconUrl: update {1} to {2}",da,R.iconUrl,Ea.iconUrl),R.iconUrl=Ea.iconUrl),Ea.description&&(da=String.format("{0}; Description: update {1} to {2}",da,R.description,Ea.description),R.description=Ea.description));m.remove(R.solutionId);this.jFa&&v.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",da)}}for(let R of m.keys)A=
m.J(R),A.displayName&&A.iconUrl&&A.addinInfo&&(d.push(A),this.jFa&&v.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(A)))}VHc(){const d=new uk.a(T.a.ih());let m=this.Ca.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!m)return d;m=m.trim();if(12>=m.length)return 0<m.length&&v.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",m),d;
this.jFa&&v.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",m);try{const A=[],R=m.split("|");for(let da=R.length-1;0<=da;da--){const Ea=R[da],ib=Ea.split("\\");if(2>ib.length){A.push(Ea);continue}const Qb=Ql.U3c(ib);Qb?d.nb(Qb.solutionId)||d.add(Qb.solutionId,Qb):A.push(Ea)}this.jFa&&0<A.length&&v.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",A.join("|"));this.jFa&&0<d.count&&v.ULS.sendTraceTag(509379103,220,
50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(tm.toArray(d.values)));return d}catch(A){v.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",m,A.toString())}return d}ROc(d){for(let m=0;m<d.length;m++)Lb.c(d[m].iconUrl.toLowerCase(),"http",0)||(d[m].iconUrl=String.format("{0}/image/apps.{1}",this.cxc,d[m].iconUrl))}static c6e(d,m){const A={};A.collectionType=fj[d];A.queryResult="null";
A.queryStart=m;A.queryDuration=window.performance.now()-m;return Object.assign(new Uo(d,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",A)})}static WBb(d){const m={};m.collectionType=fj[d];return Object.assign(new Uo(d,2),{failure:Error.create("The store is disabled.",m)})}static T5e(d){const m={};m.collectionType=fj[d];m.invokeResultCode=-2147208619;m.queryDuration=0;return Object.assign(new Uo(d,3),{failure:Error.create("Anonymous users do not have installed add-ins.",m)})}static kRc(d){return d.failure?
d.failure.invokeResultCode:-1E3}static P_c(d,m,A){const R={};R.AddinCollectionType=fj[d];R.ErrorCode=m.errorCode;R.AddinCount=m.value?m.value.length:0;v.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",A,JSON.stringify(R))}static VBb(d,m){const A={};A.errorCode=d;A.value=m;return A}static ocd(d){return d===OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Zmb(d,m){m.solutionId=m.solutionId||
d.solutionId;m.version=m.version||d.version;m.storeType=m.storeType||d.storeType;m.storeId=m.storeId||d.storeId;m.assetId=m.assetId||d.assetId;m.assetStoreId=m.assetStoreId||d.assetStoreId;m.displayName=m.displayName||d.displayName;m.provider=m.provider||d.provider;m.description=m.description||d.description;m.iconUrl=m.iconUrl||d.iconUrl;m.webApplicationId=m.webApplicationId||d.webApplicationId;m.highResolutionIconUrl=m.highResolutionIconUrl||d.highResolutionIconUrl;m.licenseUrl=m.licenseUrl||d.licenseUrl;
m.privacyUrl=m.privacyUrl||d.privacyUrl;m.addinInfo=m.addinInfo||d.addinInfo;isNaN(m.targetType)&&(m.targetType=d.targetType);isNaN(m.height)&&(m.height=d.height);isNaN(m.width)&&(m.width=d.width);return m}static TGc(d){for(const m of d)isNaN(m.targetType)&&(m.targetType=1),m.assetId=m.assetId||m.solutionId,m.storeId=m.storeId||"en-US",m.storeType=m.storeType||"omex",m.assetStoreId=m.assetStoreId||"omex",isNaN(m.width)&&(m.width=0),isNaN(m.height)&&(m.height=0)}static U3c(d){const m={};let A=0;A<
d.length&&0<d[A].trim().length&&d[A].trim().toLowerCase().startsWith("wa")&&(m.solutionId=d[A].trim(),m.addinInfo=Object.assign(new vk,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.priority=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.AUP=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.downloadNumber=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.displayName=d[A].trim()),
++A<d.length&&0<d[A].trim().length&&(m.iconUrl=d[A].trim()),++A<d.length&&0<d[A].trim().length&&(m.description=d[A].trim()));return m.solutionId?m:null}static eRc(d,m){d=d.kb("AddinImageStoreServiceUrl");if(!d)return m;d=d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:m}}Object(y.a)(Ql,"AddinDetailsManager1",null,[1257,1258]);class cm{constructor(d,m=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=
this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=d.solutionId;this.version=d.version;this.storeType=d.storeType;this.storeId=d.storeId;this.assetId=d.assetId;this.assetStoreId=d.assetStoreId;this.displayName=d.displayName;this.provider=d.provider;this.description=d.description;this.targetType=d.targetType;this.height=d.height;this.width=d.width;this.iconUrl=
d.iconUrl;this.webApplicationId=d.webApplicationId;this.highResolutionIconUrl=d.highResolutionIconUrl;this.licenseUrl=d.licenseUrl;this.privacyUrl=d.privacyUrl;this.addinInfo=m}Xnc(){const d={};d.solutionId=this.solutionId;d.version=this.version;d.storeType=this.storeType;d.storeId=this.storeId;d.assetId=this.assetId;d.assetStoreId=this.assetStoreId;d.targetType=this.targetType;d.displayName=this.displayName;d.width=this.width;d.height=this.height;return d}}Object(y.a)(cm,"AddinDetail",null,[]);class Sq{constructor(d,
m,A,R,da){this.Sxd=null;this.Ca=d;this.Hj=m;this.syb=A;this.Fgk=R;this.yab=da}fZ(d,m){this.Et.queryAppDetails(this.Fgk,this.yab,this.solutionIds,d,(A,R)=>{const da=Array(R.length);for(let Ea=0;Ea<R.length;Ea++)da[Ea]=new cm(R[Ea],this.y9m(R[Ea].solutionId));m(A,da)})}get lOm(){return!!this.Et.queryAppDetails}y9m(d){return this.syb.J(d)}get solutionIds(){if(!this.Sxd){this.Sxd=new U.a;for(let d of this.syb.keys)this.Sxd.add(Lb.d(d))}return this.Sxd.toArray()}get Et(){return this.Hj.value}}Object(y.a)(Sq,
"AddinDetailsLoader",null,[]);class Gi{constructor(d,m=0){this.failure=null;this.NOa=d;this.errorCode=m}}Object(y.a)(Gi,"AddinQueryResult",null,[]);class Aq extends Gi{constructor(d,m=0){super(d,m);this.Ujg=this.solutionIds=null}}Object(y.a)(Aq,"AddinCollection",Gi,[]);var Hn=c(1237);class Cp extends Hn.a{constructor(){super(T.a.ih())}}Object(y.a)(Cp,"AddinDetailTable",Hn.a,[]);class Sn{constructor(d,m,A=null){this.sa=new vb.a;this.bB=new uk.a(T.a.ih());this.nr=new tg.a;this.syb=this.Tfa=null;this.KCa=
new ke.a;this.KCa.add(OSF.StoreTypeEnum.MarketPlace,0);this.KCa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ca=d;this.Hj=m;this.au=A;this.cxc=Sn.eRc(d,"https://store-images.s-microsoft.com");this.VOe=null;this.$eb(Object(I.a)(this,this.BHa,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ca&&this.Ca.$("IsAnonymousUser")}get pmf(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get $Oc(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",
!0)}get Aib(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get jFa(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Et(){return this.Hj.value}get N1f(){this.VOe||(this.VOe=new Sq(this.Ca,this.Hj,this.REn,0,this.Et.getAppUILocale()));return this.VOe}oFa(d){if(!this.DGa(d))return d=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:fj[d]}),Object.assign(new kn(1),
{failure:d});const m=this.nr.J(d);if(m.failure)return Object.assign(new kn(m.errorCode),{failure:m.failure});v.ULS.shipAssertTag(509870082,220,!!m.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",d);const A=new kn(0);for(let R=0;R<m.solutionIds.count;R++){const da=m.solutionIds.J(R),Ea=m.Ujg.J(R);if(this.bB.nb(da)){const ib=this.bB.J(da);ib.nb(Ea)?Array.add(A.PT,ib.J(Ea)):v.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",
da,d,Ea)}else v.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",da,d)}return A}JFb(d,m=null){if(d=this.fNl(d))if(m||(m=this.uiCulture),d.nb(m))return d.J(m);return null}fNl(d){return this.bB.nb(d)?this.bB.J(d):null}gpb(d){if(d){this.$eb(d);for(let m of this.nr.keys){if(!this.DGa(m)||this.nr.J(m).failure)continue;v.ULS.shipAssertTag(509870081,220,!!this.nr.J(m).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
m);const A=[],R=this.nr.J(m);for(let da of R.solutionIds)Array.add(A,this.bB.J(da));d(null,new wk(m,R.errorCode,A,R.failure))}}}fZ(d,m=!1){0!==d&&10!==d?v.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Rg[d]):this.k5c(d,Object(I.a)(this,this.N2c,"onQueryAddinDetailsCompleted"),m)}$eb(d){this.sa.addHandler(Ye.a.W2b,d)}N2c(d,m,A){A?(Sn.P_c(d,A,window.performance.now()-m),0===A.errorCode?(m=A.value?Sn.ADk(A.value):[],this.fV(new Gi(d),m)):-1===A.errorCode||10===A.errorCode?
this.fV(new Gi(d),[]):(d=this.b6e(d,m,A),this.fV(d))):(d=Sn.c6e(d,m),this.fV(d))}b6e(d,m,A){const R={};R.collectionType=fj[d];R.invokeResultCode=A.errorCode;R["queryResult.Value"]=A.value?String.format("Length: {0}",A.value.length):"null";R.queryStart=m;R.queryDuration=window.performance.now()-m;return Object.assign(new Gi(d,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",R)})}S$c(){return this.DGa(2)?this.Ca.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?
!!this.nr.J(2).failure:!1:!0}k5c(d,m,A=!1){v.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",d);d!==OSF.StoreTypeEnum.MarketPlace&&d!==OSF.StoreTypeEnum.PrivateCatalog?v.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",d):(this.S$c()&&this.queryStoreDisabled(0,(R,da)=>{da?(R=Sn.WBb(2),this.fV(R)):this.tHn(m)}),this.$Oc&&this.isAnonymousUser?(d=Sn.T5e(d===OSF.StoreTypeEnum.MarketPlace?0:1),this.fV(d)):this.queryStoreDisabled(d,(R,da)=>{if(R===OSF.StoreTypeEnum.MarketPlace&&
da)da=Sn.WBb(0),this.fV(da);else if(R===OSF.StoreTypeEnum.PrivateCatalog&&da)da=Sn.WBb(1),this.fV(da);else{var Ea=window.performance.now();this.Et.getEntitlementDetails(Object.assign(new Gn,{storeType:R,refresh:A}),ib=>{m(this.KCa.J(R),Ea,ib)})}}))}fV(d,m=null){0!==d.errorCode?(v.ULS.shipAssertTag(509116673,220,!m,"The parameter addinDetails must be null for any failed queries"),v.ULS.shipAssertTag(509116672,220,!!d.failure,"The result.Failure must not be available for any failed queries"),v.ULS.sendTraceTag(510253056,
220,this.qwf(d),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",fj[d.NOa],gq[d.errorCode],d.failure?d.failure.toString():"null",JSON.stringify(d.failure))):(v.ULS.shipAssertTag(509116643,220,!!m,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",fj[d.NOa]),v.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",fj[d.NOa],m?m.length:
-1));d=new wk(d.NOa,d.errorCode,m,d.failure);this.sa.raiseEvent(Ye.a.W2b,d)}qwf(d){return 3===d.errorCode&&(this.$Oc&&-2147208619===Sn.kRc(d)||this.pmf&&-2===Sn.kRc(d))?15:2===d.errorCode?15:10}BHa(d,m){if(0!==m.errorCode)this.nr.Z(m.qO,Object.assign(new Aq(m.qO,m.errorCode),{failure:m.failure}));else{d=Object.assign(new Aq(m.qO),{solutionIds:new U.a,Ujg:new U.a});var A=m.PT;for(const da of A){A=da.solutionId;const Ea=da.storeId;if(this.bB.nb(A)){var R=this.bB.J(A);R.nb(Ea)?R.Z(Ea,this.O0c(R.J(Ea),
m.qO,da)):R.add(Ea,da)}else R=new Cp,R.add(Ea,da),this.bB.add(A,R);d.solutionIds.add(A);d.Ujg.add(Ea)}this.nr.Z(m.qO,d)}}DGa(d){return this.nr.nb(d)?!!this.bB:!1}get uiCulture(){return this.au&&this.au.UICulture?this.au.UICulture:n.AFrameworkApplication.uiCulture}get dHc(){return this.au?!this.au.AreThirdPartyAddInsAllowed||this.au.AppsForOfficeThirdPartyIsDisabled:!this.Ca.$("AreThirdPartyAddInsAllowed")||this.Ca.$("AppsForOfficeThirdPartyIsDisabled")}get tXc(){return this.au?!this.au.AppsForOfficeAllowExternalMarketplace:
!this.Ca.$("AppsForOfficeAllowExternalMarketplace")}get REn(){if(!this.syb){this.syb=new uk.a(T.a.ih());const d=JSON.parse(this.Mob);for(const m of d)this.syb.add(m.solutionId,m.addinInfo)}return this.syb}get Mob(){return this.au?this.au.PopularAddinDetailsJsonString:this.Ca.kb("PopularAddinDetailsJsonString")}queryStoreDisabled(d,m){if(this.dHc)m(d,!0);else if(d===OSF.StoreTypeEnum.MarketPlace&&this.tXc)m(d,!0);else{const A=Sn.ocd(d);if(A){const R=window.performance.now();this.Et.queryStoreDisabled(A,
da=>{v.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",d,da,R,window.performance.now()-R);m(d,da)})}else m(d,!1)}}O0c(d,m,A){if(!d)return A;if(!A)return d;if(this.Aib)return 2===m?Sn.Zmb(A,d):Sn.Zmb(d,A);if(2===m)return d.addinInfo=A.addinInfo,d;A.addinInfo=d.addinInfo;return A}tHn(d){const m=window.performance.now();if(this.Tfa)d(2,m,Sn.VBb(0,this.Tfa));else if(this.N1f&&this.N1f.lOm)this.N1f.fZ(!1,(R,da)=>{this.v3b(da);this.Tfa=
da;d(2,m,Sn.VBb(R,this.Tfa))});else{var A=JSON.parse(this.Mob);this.QOc(A);this.Tfa=A;d(2,m,Sn.VBb(0,this.Tfa))}}QOc(d){this.Aib&&Sn.TGc(d);this.v3b(d);this.ROc(d)}v3b(d){const m=this.VHc();for(var A=0;A<d.length&&0<m.count;A++){const R=d[A];if(m.nb(R.solutionId)){let da=String.format("Found an override, solutionId: {0}",R.solutionId);const Ea=m.J(R.solutionId);Ea&&(isNaN(Ea.addinInfo.priority)||(da=String.format("{0}; AddinInfo.Priority: update {1} to {2}",da,R.addinInfo.priority,Ea.addinInfo.priority),
R.addinInfo.priority=Ea.addinInfo.priority),isNaN(Ea.addinInfo.AUP)||(da=String.format("{0}; AddinInfo.AUP: update {1} to {2}",da,R.addinInfo.AUP,Ea.addinInfo.AUP),R.addinInfo.AUP=Ea.addinInfo.AUP),isNaN(Ea.addinInfo.downloadNumber)||(da=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",da,R.addinInfo.downloadNumber,Ea.addinInfo.downloadNumber),R.addinInfo.downloadNumber=Ea.addinInfo.downloadNumber),Ea.displayName&&(da=String.format("{0}; DisplayName: update {1} to {2}",da,R.displayName,
Ea.displayName),R.displayName=Ea.displayName),Ea.iconUrl&&(da=String.format("{0}; IconUrl: update {1} to {2}",da,R.iconUrl,Ea.iconUrl),R.iconUrl=Ea.iconUrl),Ea.description&&(da=String.format("{0}; Description: update {1} to {2}",da,R.description,Ea.description),R.description=Ea.description));m.remove(R.solutionId);this.jFa&&v.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",da)}}for(let R of m.keys)A=m.J(R),A.displayName&&A.iconUrl&&A.addinInfo&&(d.push(A),this.jFa&&v.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(A)))}VHc(){const d=new uk.a(T.a.ih());let m=this.Ca.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!m)return d;m=m.trim();if(12>=m.length)return 0<m.length&&v.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",m),d;this.jFa&&v.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
m);try{const A=[],R=m.split("|");for(let da=R.length-1;0<=da;da--){const Ea=R[da],ib=Ea.split("\\");if(2>ib.length){A.push(Ea);continue}const Qb=Sn.U3c(ib);Qb?d.nb(Qb.solutionId)||d.add(Qb.solutionId,Qb):A.push(Ea)}this.jFa&&0<A.length&&v.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",A.join("|"));this.jFa&&0<d.count&&v.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",d.count,JSON.stringify(tm.toArray(d.values)));
return d}catch(A){v.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",m,A.toString())}return d}ROc(d){for(let m=0;m<d.length;m++)Lb.c(d[m].iconUrl.toLowerCase(),"http",0)||(d[m].iconUrl=String.format("{0}/image/apps.{1}",this.cxc,d[m].iconUrl))}static c6e(d,m){const A={};A.collectionType=fj[d];A.queryResult="null";A.queryStart=m;A.queryDuration=window.performance.now()-m;return Object.assign(new Gi(d,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",
A)})}static WBb(d){const m={};m.collectionType=fj[d];return Object.assign(new Gi(d,2),{failure:Error.create("The store is disabled.",m)})}static T5e(d){const m={};m.collectionType=fj[d];m.invokeResultCode=-2147208619;m.queryDuration=0;return Object.assign(new Gi(d,3),{failure:Error.create("Anonymous users do not have installed add-ins.",m)})}static kRc(d){return d.failure?d.failure.invokeResultCode:-1E3}static P_c(d,m,A){const R={};R.AddinCollectionType=fj[d];R.ErrorCode=m.errorCode;R.AddinCount=
m.value?m.value.length:0;v.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",A,JSON.stringify(R))}static VBb(d,m){const A={};A.errorCode=d;A.value=m;return A}static ocd(d){return d===OSF.StoreTypeEnum.MarketPlace?"omex":d===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static Zmb(d,m){m.solutionId=m.solutionId||d.solutionId;m.version=m.version||d.version;m.storeType=m.storeType||d.storeType;m.storeId=m.storeId||d.storeId;m.assetId=
m.assetId||d.assetId;m.assetStoreId=m.assetStoreId||d.assetStoreId;m.displayName=m.displayName||d.displayName;m.provider=m.provider||d.provider;m.description=m.description||d.description;m.iconUrl=m.iconUrl||d.iconUrl;m.webApplicationId=m.webApplicationId||d.webApplicationId;m.highResolutionIconUrl=m.highResolutionIconUrl||d.highResolutionIconUrl;m.licenseUrl=m.licenseUrl||d.licenseUrl;m.privacyUrl=m.privacyUrl||d.privacyUrl;m.addinInfo=m.addinInfo||d.addinInfo;isNaN(m.targetType)&&(m.targetType=
d.targetType);isNaN(m.height)&&(m.height=d.height);isNaN(m.width)&&(m.width=d.width);return m}static ADk(d){const m=Array(d.length);for(let A=0;A<m.length;A++)m[A]=new cm(d[A],d[A].addinInfo);return m}static TGc(d){for(const m of d)isNaN(m.targetType)&&(m.targetType=1),m.assetId=m.assetId||m.solutionId,m.storeId=m.storeId||"en-US",m.storeType=m.storeType||"omex",m.assetStoreId=m.assetStoreId||"omex",isNaN(m.width)&&(m.width=0),isNaN(m.height)&&(m.height=0)}static U3c(d){const m={};let A=0;A<d.length&&
0<d[A].trim().length&&d[A].trim().toLowerCase().startsWith("wa")&&(m.solutionId=d[A].trim(),m.addinInfo=Object.assign(new vk,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.priority=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.AUP=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.addinInfo.downloadNumber=parseInt(d[A].trim())),++A<d.length&&0<d[A].trim().length&&(m.displayName=d[A].trim()),++A<
d.length&&0<d[A].trim().length&&(m.iconUrl=d[A].trim()),++A<d.length&&0<d[A].trim().length&&(m.description=d[A].trim()));return m.solutionId?m:null}static eRc(d,m){d=d.kb("AddinImageStoreServiceUrl");if(!d)return m;d=d.toLowerCase();return d.startsWith("http://")||d.startsWith("https://")?d:m}}Object(y.a)(Sn,"AddinDetailsManager2",null,[1257,1258]);class hq{static createInstance(d,m,A=null){if(hq.EXc(d)){if(hq.qAk(d))return v.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),
new Sn(d,m,A);v.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");return new Ql(d,m,A)}v.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new lo(d,m,A)}static EXc(d){return(d||n.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static qAk(d){return(d||n.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",
!1)}}Object(y.a)(hq,"AddinDetailsManagerFactory",null,[]);class Yn{constructor(d){this.jSe=d}next(d){this.jSe=(9301*this.jSe+49297)%233280;return Math.floor(this.jSe/233280*d)}}Object(y.a)(Yn,"Random",null,[]);class El extends wa.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(y.a)(El,"CuiButtonPropsExtended",wa.a,[]);var iq=c(1725),jq=c(651);class Zn{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(y.a)(Zn,"GallerySectionProps",null,
[]);var mi=c(1868),gr=c(772);class mo{constructor(){this.text=this.href=null}}Object(y.a)(mo,"LinkProps",null,[]);class dm{constructor(){this.icon=this.text=this.href=null}}Object(y.a)(dm,"LinkWithLabelProps",null,[]);var Dp=c(1726);class cs{constructor(d,m,A,R,da,Ea=null,ib=null){this.yCe={};this.O5g={};this.Kmd={};this.iXg=0;this.Hbh=!1;this.Wea=0;this.wYg=!1;this.Yab=this.yyc=0;this.Xsb=m;this.eO=null;this.P$j=A;this.R$j=R;this.Tik=da;this.BUb=ib;this.Ca=Ea||n.AFrameworkApplication.K;this.Xsb.gpb(Object(I.a)(this,
this.BHa,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get raf(){return this.Kmd}w7f(d){if(d.PT)for(let m=0;m<d.PT.length;m++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+d.PT[m].solutionId,d.PT[m].iconUrl);else 0===d.errorCode&&v.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get rdc(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get zGf(){return!!this.Ca&&
this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadV2Enabled",!1)}get EJb(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}get qYc(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScrollableFlyoutEnable",!1)}get LUm(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScrollableFlyout10ItemsEnable",
!1)}Uso(d){0===d.qO&&(this.Wea|=1);1===d.qO&&(this.Wea|=2);return!!this.Wea}BHa(d,m){this.w7f(m);this.BUb&&this.BUb.BHa(d,m);this.Uso(m)&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",!1)&&this.u7m()}xDh(){let d=this.Xsb.oFa(0);if(1!==d.errorCode)return!0;d=this.Xsb.oFa(1);return 1!==d.errorCode}PDn(d){const m=[];var A=new Yn((new Date).getDate());for(var R=0;8>R;R++)Array.add(m,A.next(d.count));A=0;for(let da of d){R=!1;for(const Ea of m)if(A===Ea){R=
!0;break}A++;if(R){let Ea;(Ea=da.addinInfo).AUP=20*Ea.AUP}else if(1===da.addinInfo.priority){let Ea;(Ea=da.addinInfo).AUP=4*Ea.AUP}else if(2===da.addinInfo.priority){let Ea;(Ea=da.addinInfo).AUP=2*Ea.AUP}}d.Sc((da,Ea)=>da.addinInfo.AUP<Ea.addinInfo.AUP?1:-1);return d}QDn(d){for(let m of d)if(1===m.addinInfo.priority){let A;(A=m.addinInfo).AUP=4*A.AUP}else if(2===m.addinInfo.priority){let A;(A=m.addinInfo).AUP=2*A.AUP}d.Sc((m,A)=>m.addinInfo.AUP<A.addinInfo.AUP?1:-1);return d}m_l(){const d={},m={},
A={};m.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};m.inner={margin:"-4px"};A.root={width:100,height:100,backgroundColor:"transparent"};A.flexContainer={flexDirection:"column"};A.label=this.rdc?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",
"white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"};d.galleryButtonInExpanded=A;d.galleryStack=m;return d}NLl(){return Object.assign(new mi.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.Tik,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},
Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}qLl(d,m,A){const R={},da={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"};n.AFrameworkApplication.isRtl&&(da.direction="ltr");R.root=da;return Object.assign(new mi.a,{Id:A,ExternalId:A,Icon:"AddinFlyoutControl"+m.solutionId,Command:d===CommonUIStrings.l_PopularAddins?this.P$j:this.R$j,LabelText:m.displayName,FullIconStyle:R,Alt:m.description})}lFn(d,m,A){const R=Object.assign(new Zn,
{SectionId:d,Title:d,GalleryButtons:[]});for(let da=0;da<A;da++)Array.add(R.GalleryButtons,this.qLl(d,m[da],this.yCe[m[da].solutionId]));return R}Cbm(){var d=[];const m=this.Xsb.oFa(0);Array.addRange(d,m.PT);const A=this.Xsb.oFa(1);Array.addRange(d,A.PT);let R=d.length;this.Yab=0<R?5:6;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&v.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",
R,gq[m.errorCode],m.PT.length,gq[A.errorCode],A.PT.length);d.sort((gd,Cd)=>{gd=Lb.d(gd.displayName);Cd=Lb.d(Cd.displayName);return sa.a.localeCompare(gd,Cd)});var da=this.qYc?3:6;const Ea=R>da;Ea&&(R=da-1);for(da=0;da<R;da++)this.qzh(d[da]);let ib=[];da=null;this.eO?ib=this.eO:(da=this.Xsb.oFa(2),0===da.errorCode&&da.PT.forEach(gd=>{-1!==gd.addinInfo.priority&&(this.qzh(gd),ib.push(gd))}));da=!0;ib.length||(da=!1);let Qb=0;if(da&&(Qb=d.length?3>=d.length?9:6:12,ib=this.rdc?this.kGk(ib,d):this.jGk(ib,
d),Qb>ib.length&&(Qb=ib.length),this.qYc&&(this.Yab=this.LUm?10:ib.length),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.Hbh&&!this.rdc)){var pc="",Pc="";for(let gd=0;gd<ib.length&&gd<Qb;gd++)pc+=ib[gd].displayName,pc+=",",Pc+=ib[gd].solutionId,Pc+=",";v.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",Qb,pc,Pc);this.Hbh=!0}pc=Object.assign(new fa.a,{Id:"FooterSection",
ControlsId:"FooterSection.Controls",ControlList:[]});Pc=Object.assign(new wa.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(pc.ControlList,Pc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));pc=Object.assign(new ta.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:pc,UpdateDynamically:!0,IsFlexLayout:this.qYc});2!==m.errorCode||
d.length?3===m.errorCode&&3===A.errorCode?(v.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),d=this.l4h("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(pc.MenuSectionList,d)):(0<R?this.vLh(pc,d,R,"MRUAddins",CommonUIStrings.l_MyAddinSection,Ea):this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(d=this.bLl(),Array.add(pc.MenuSectionList,d),v.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),da&&(this.rdc?(Array.add(pc.MenuSectionList,
this.ILl(ib,this.Yab)),d=[],this.$Gj(d),appChrome.api.dispatch(d),this.yyc=this.eO.length<this.Yab?this.eO.length:this.Yab):this.vLh(pc,ib,Qb,"PopularAddins",CommonUIStrings.l_PopularAddins))):(v.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),d=this.l4h("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(pc.MenuSectionList,d));this.qYc&&this.nXk();return pc}nXk(){window.setTimeout(()=>{var d=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");d&&d.firstChild&&d.firstChild.firstChild&&
d.firstChild.firstChild.firstChild&&(d=d.firstChild.firstChild.firstChild.scrollTop,0<d&&(d={["scrollTopValue"]:d.toString()},ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:Sf.a.RH(d)}))))},6E4)}aHo(){if(!(this.Yab>=this.eO.length)){var d=[];for(let m=0;m<this.Yab;m++)this.O5g["PopularAddInsListItem"+m]=this.eO[m].solutionId,this.zUo(d,m.toString(),this.eO[this.yyc]),this.yyc===this.eO.length-1?this.yyc=0:this.yyc++;this.$Gj(d);appChrome.api.dispatch(d)}}$Gj(d){6>
this.Yab?d.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):d.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}ILl(d,m){const A=Object.assign(new fa.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let R=0;R<0+m&&R<d.length;R++)this.O5g.PopularAddInsListItem0=d[R].solutionId,this.ZKl(A.ControlList,R.toString(),d[R]);this.qYc||(d=Object.assign(new El,{Id:"SwitchPopularAddIns",
ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1}),Array.add(A.ControlList,d));return A}ZKl(d,m,A){m=this.HJd("PopularAddInsListItem",m,A);Array.add(d,m)}zUo(d,m,A){A=this.HJd("PopularAddInsListItem",m,A);const R={};R.label=A.Label;R.secondaryLabel=A.SecondaryLabel;R.description=A.Description;R.iconSet=A.iconSet;R.links=A.Links;this.zGf&&(R.details=A.Details);R.commandValueId=
A.CommandValueId;R.actionCommandValueId=A.ActionCommandValueId;d.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+m,R))}HJd(d,m,A){var R="";if(this.zGf){var da=A.addinInfo.downloadNumber;5E6<=da?R=(5E6).toLocaleString()+"+":1E3<=da?(da=1E3*Math.round(da/1E3),R=da.toLocaleString()+"+"):R=500<=da?(500).toLocaleString()+"+":100<=da?(100).toLocaleString()+"+":0<da?da.toLocaleString():CommonUIStrings.l_AddinDownloadNewText}da=[];const Ea=[];this.zGf?(R=Object.assign(new dm,{icon:R===
CommonUIStrings.l_AddinDownloadNewText?null:"download",text:R}),Array.add(Ea,R),R=Object.assign(new dm,{text:this.Ca.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinListStoreLabel",CommonUIStrings.l_AddinListStore2),href:"https://appsource.microsoft.com/en-us/product/office/"+A.solutionId}),Array.add(Ea,R)):(R=Object.assign(new mo,{text:CommonUIStrings.l_AddinListPrivacy,href:A.privacyUrl}),Array.add(da,R),R=Object.assign(new mo,{text:CommonUIStrings.l_AddinListLicense,href:A.licenseUrl}),
Array.add(da,R),R=Object.assign(new mo,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+A.solutionId}),Array.add(da,R));R={};R["default"]="AddinFlyoutControl"+A.solutionId;const ib=this.oPc(A);return Object.assign(new Dp.a,{Id:d+m,ExternalId:d+m,CommandId:d+m,CommandIdMapped:"1497204054",iconSet:R,SecondaryLabel:null,Details:Ea,Label:A.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:A.description,Links:da,ActionId:d+"Add"+m,ActionIdMapped:"2882601901",
ActionCommandValueId:ib,CommandValueId:ib})}oPc(d){return this.EJb?String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}wQd(d){if(!d)return null;var m=d.split("#");if(1!==m.length&&2!==m.length)return v.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;d=m[0].trim();m=2===m.length?m[1].trim():n.AFrameworkApplication.uiCulture;return this.Xsb.JFb(d,m)}qzh(d){if(!(d.solutionId in this.yCe)){const m="AddinGalleryButton"+this.iXg.toString();this.yCe[d.solutionId]=
m;d=this.oPc(d);this.Kmd[m]=d;this.Kmd[m+"Add"]=d;this.iXg++}}jki(d){return d?this.Kmd[d]:null}bLl(){const d=Object.assign(new fa.a,{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),m=Object.assign(new gr.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Ca.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(d.ControlList,m);return d}l4h(d,
m){const A=Object.assign(new fa.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});d=Object.assign(new iq.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:d,Label:m,RetryButtonTitle:CommonUIStrings.l_AddinPickerTryAgain,OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===d?m:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(A.ControlList,d);return A}jGk(d,m){var A=new U.a;for(let R=0;R<d.length;R++)A.add(d[R]);this.eO||(8<A.count&&(A=this.PDn(A)),
this.eO=A.toArray());for(d=0;d<this.eO.length;d++)for(A=0;A<m.length;A++)if(this.eO[d].solutionId.toLowerCase()===m[A].solutionId.toLowerCase()){Array.remove(this.eO,this.eO[d--]);break}return this.eO}kGk(d,m){var A=new U.a;for(let R=0;R<d.length;R++)A.add(d[R]);this.eO||(8<A.count&&(A=this.QDn(A)),this.eO=A.toArray());for(d=0;d<this.eO.length;d++)for(A=0;A<m.length;A++)if(this.eO[d].solutionId.toLowerCase()===m[A].solutionId.toLowerCase()){Array.remove(this.eO,this.eO[d--]);break}return this.eO}vLh(d,
m,A,R,da,Ea=!1){const ib=Object.assign(new fa.a,{Id:R+"Section",ControlsId:R+"Section.Controls",ControlList:[]});R=Object.assign(new jq.a,{Id:R+"GalleryControl",ExternalId:R+"GalleryControl",GalleryStyle:this.m_l(),Width:3,Type:4,GallerySections:[]});Array.add(d.MenuSectionList,ib);Array.add(ib.ControlList,R);d=this.lFn(da,m,A);Ea&&Array.add(d.GalleryButtons,this.NLl());R.GallerySections.push(d)}rFn(d){if(d)try{d.MenuItems=this.Cbm()}catch(m){v.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+
(m?m.toString():""))}else v.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}u7m(){if(!this.wYg&&this.lge){var d=appChrome.selectors.getSelectedTabId();d&&Lb.a(d,"Home")&&((d=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(d,"").display||v.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.wYg=!0)}}get lge(){return!!window.appChrome&&!!appChrome.selectors}}Object(y.a)(cs,"AppsFlyoutGenerator",null,[10]);var no=c(829);
class om{}om.solutionId="solutionId";om.version="version";om.storeType="storeType";om.storeId="storeId";om.assetId="assetId";om.assetStoreId="assetStoreId";om.displayName="displayName";om.targetType="targetType";om.isAddinCommands="isAddinCommands";om.height="height";om.width="width";om.sharedRuntimeId="sharedRuntimeId";om.backgroundState="backgroundState";Object(y.a)(om,"InsertAgaveParametersConstantsString",null,[]);var Bq=c(1707),qr=c(959);class In extends qr.a{constructor(d){super("TextAboveImage");
this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=d.paragraphs;this.image=d.image;this.imageWidth=d.imageWidth;this.imageHeight=d.imageHeight}}Object(y.a)(In,"TextAboveImage",qr.a,[]);class um{constructor(d,m){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=d;this.image=m}}Object(y.a)(um,"TextAboveImageCustomProps",null,[]);var Rl=c(1766);class oo{constructor(){this.n3c=null}DKc(){let d=this;xh.UISurfaces.MM().then(m=>{oo.Sta&&(m.removeNotification(oo.Sta),
oo.Sta=null);var A="[data-unique-id=Ribbon-InsertAddinTransitionEntry]",R=document.getElementById("InsertAddinTransitionEntry");R&&"none"!==window.getComputedStyle(R,"").display||(A=n.AFrameworkApplication.K.isChangeGateEnabled("ChangeAnchorToHomeWhenOverflow")?"[data-unique-id=Home]":"[data-unique-id=Overflow-RibbonOverflowMenu-overflow]");R=CommonUIStrings.l_BetterEntryPointTUI_Title;var da=CommonUIStrings.l_BetterEntryPointTUI_Content,Ea=new Rl.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF0");
da=da.split("\n");Ea=new um(da,Ea);da=new In(Ea);da.imageWidth=280;da.imageHeight=192;const ib=new Bq.a;ib.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ib.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;ib.onExecute=()=>{d.Gqm();d.WB("ClickOnLaunch")};const Qb=new Bq.a;Qb.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;Qb.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;Qb.onExecute=()=>{m.removeNotification(oo.Sta);d.WB("ClickOnDismiss")};let pc;
Ea=m.callout((pc=new uh.a,pc.target=A,pc.title=R,pc.content=da,pc.showCloseIcon=!0,pc.hasDynamicSizing=!1,pc.preventLightDismiss=!1,pc.useTeachingStyles=!0,pc.primaryButtonProps=ib,pc.secondaryButtonProps=Qb,pc.calloutProps=Object.assign(new lg.a,{onDismiss:()=>{m.removeNotification(oo.Sta)},setInitialFocus:!0}),pc));let Pc;A=(Pc=new Dh.a,Pc.onShow=()=>{d.WB("Show")},Pc);oo.Sta=m.addNotification(Ea,A);return null},m=>{v.ULS.sendTraceTag(509645912,341,15,"Failed to GetNotificationsAPIAsync: {0}",m);
return null})}Gqm(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const d=new $a.a(0,1,500,()=>{this.MKf()});ab.a.instance.Wb(d)}MKf(){const d=document.getElementById("InsertAddInFlyout");d&&"none"!==window.getComputedStyle(d,"").display?(d.click(),v.ULS.sendTraceTag(509645901,341,50,"Launch flyout in ribbon button")):(this.n3c=document.getElementById("RibbonOverflowMenu-overflow"))?(this.n3c.addEventListener("click",Object(I.a)(this,this.S_i,"overflowButtonOnClickHandler"),!0),
this.n3c.click()):v.ULS.sendTraceTag(509645902,341,10,"Neither ribbon nor overflow can launch flyout")}S_i(){const d=new $a.a(0,1,500,()=>{const m=document.getElementsByName("Add-ins")[0];m&&(m.click(),v.ULS.sendTraceTag(509645900,341,50,"Launch flyout in overflow"));this.n3c.removeEventListener("click",Object(I.a)(this,this.S_i,"overflowButtonOnClickHandler"),!0)});ab.a.instance.Wb(d)}WB(d){d={["AppTeachingUICalloutAction"]:d,["AppTeachingUICalloutGoal"]:"BetterEntryPoint_InsertTab"};ah.a.sendTelemetryEvent(Object.assign(new Bg.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Sf.a.RH(d)}))}}oo.Sta=null;Object(y.a)(oo,"WordBetterEntryTeachingCallout",null,[]);class Tq extends oa.a{constructor(d,m,A,R){super();this.Csa="calc(100% - 46px)";this.ZKa="15px";this.Dsa="0";this.xuc="WACDialogPanel";this.UZ=695;this.yuc=462;this.qW="80%";this.Grc=350;this.N$a="100%";this._frame=null;this.Cd=5;this.zg="AddinInstallDialog";this.uhd=d;this.ita=m;this.Vnk=A;this.rdk=R}iS(){super.iS();this.hq.style.width=this.N$a;this.hq.style.height=
this.Csa;this.hq.style.marginTop=this.ZKa;this.hq.style.padding=this.Dsa;document.getElementById(this.rj("WACDialogButtonPanel")).style.display="none";this.ngb.setAttribute("tabindex","0");$addHandler(this.ngb,"keyup",Object(I.a)(this,this.Wy,"onKeyUp"));const d=document.createElement("iframe");d.setAttribute("id","InstallAddinDialog");d.setAttribute("src","about:blank");d.setAttribute("width","100%");d.setAttribute("height","100%");d.setAttribute("marginHeight","0");d.setAttribute("marginWidth",
"0");d.setAttribute("frameBorder","0");d.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const m=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.uhd,this.ita,this.Vnk);d.setAttribute("src",m);this._frame=d;$addHandler(d,"load",Object(I.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(I.a)(this,this.onMessage,"onMessage"));this.hq.appendChild(d);this.hq.appendChild(this.bbl())}bbl(){const d=
document.createElement("div");d.setAttribute("tabindex","0");$addHandler(d,"focus",Object(I.a)(this,this.orn,"onLoopPivotFocus"));return d}Wy(d){13!==d.keyCode&&32!==d.keyCode||this.hide()}orn(){this.ngb.focus()}onLoad(){this._frame.focus()}onMessage(d){d=d.rawEvent;if(d.source===this._frame.contentWindow&&(d=(d=d.data)?d.split("|"):null)&&0<d.length&&("REFRESH_REQUIRED"===d[0]||"PRELOAD_MANIFEST"===d[0])){rj.a.instance.setItem("refreshRequired","true");const m={};m.solutionId=d[1];m.version=Tq.yin(d[3]);
m.storeType=d[4];m.storeId=d[5];m.assetId=d[6];m.targetType=Tq.aCn(d[2]);m.assetStoreId=d[7];m.width=parseInt(d[8]);m.height=parseInt(d[9]);this.rdk(m)}}Yda(){this.hq.style.width=this.N$a;this.hq.style.height=this.Csa;this.hq.style.marginTop=this.ZKa;this.hq.style.padding=this.Dsa;this.UZ>Kb.a.Ko?(this.Kc.style.width=String.format("{0}px",Kb.a.Ko),this.Kc.style.overflowX="scroll",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left="0"):(this.Kc.style.width=String.format("{0}px",
this.UZ),this.Kc.style.overflowX="hidden");this.Kc.offsetHeight>Kb.a.uv||this.yuc+50>Kb.a.uv?(this.Kc.style.height=String.format("{0}px",Kb.a.uv),this.Kc.style.overflowY="scroll",this.Kc.style.top="0",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left="0",this.hq.style.minHeight=String.format("{0}px",this.Grc)):(this.Kc.style.overflowY="hidden",this.Kc.style.top="10%",this.Kc.style.height=this.qW);this.LDa()}LDa(){if(this.Kc){var d=this.Kc.style.zIndex;this.Kc.style.zIndex="-9999";
if(this.UZ>Kb.a.Ko)n.AFrameworkApplication.isRtl?this.Kc.style.marginRight="0":this.Kc.style.marginLeft="0";else{const m=String.format("{0}px",Math.floor(-this.Kc.offsetWidth/2));n.AFrameworkApplication.isRtl?this.Kc.style.marginRight=m:this.Kc.style.marginLeft=m;n.AFrameworkApplication.isRtl?this.Kc.style.right="50%":this.Kc.style.left="50%"}this.Kc.style.zIndex=String(d)}else v.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}LL(){super.LL();const d=document.getElementById(this.rj(this.xuc));
d.style.width=String.format("{0}px",this.UZ);d.style.height=this.qW}get qhb(){return this.hq}dispose(){super.dispose();$removeHandler(window,"message",Object(I.a)(this,this.onMessage,"onMessage"))}static aCn(d){switch(d){case "1":return 0;case "2":return 1;default:return 0}}static yin(d){const m=d.split(".");for(let A=0;A<4-m.length;A++)d+=".0";return d}}Object(y.a)(Tq,"AddinInstallDialog",oa.a,[]);class gp extends oa.a{constructor(){super();this.Csa="calc(100% - 46px)";this.ZKa="15px";this.Dsa="0";
this.xuc="WACDialogPanel";this.UZ=695;this.yuc=462;this.qW="80%";this.Grc=350;this.N$a="100%";this.Cd=5;this.zg="AppsForOfficeInsertionDialog";this.BAe=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("OfficeAddinEnableInsertDialogAccessibilityFix")}iS(){super.iS();this.hq.style.width=this.N$a;this.hq.style.height=this.Csa;this.hq.style.marginTop=this.ZKa;this.hq.style.padding=this.Dsa}Yda(){this.hq.style.width=this.N$a;this.hq.style.height=this.Csa;this.hq.style.marginTop=this.ZKa;this.hq.style.padding=
this.Dsa;this.UZ>Kb.a.Ko?(this.Kc.style.width=String.format("{0}px",Kb.a.Ko),this.Kc.style.overflowX="scroll",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left="0"):(this.Kc.style.width=String.format("{0}px",this.UZ),this.Kc.style.overflowX="hidden");this.Kc.offsetHeight>Kb.a.uv||this.yuc+50>Kb.a.uv?(this.Kc.style.height=String.format("{0}px",Kb.a.uv),this.Kc.style.overflowY="scroll",this.Kc.style.top="0",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left=
"0",this.BAe||(this.Kc.style.marginTop="-48px"),this.hq.style.minHeight=String.format("{0}px",this.Grc)):(this.Kc.style.overflowY="hidden",this.Kc.style.top="10%",this.Kc.style.height=this.qW);this.LDa()}LDa(){if(this.Kc){var d=this.Kc.style.zIndex;this.Kc.style.zIndex="-9999";if(this.UZ>Kb.a.Ko)n.AFrameworkApplication.isRtl?this.Kc.style.marginRight="0":this.Kc.style.marginLeft="0";else{const m=String.format("{0}px",Math.floor(-this.Kc.offsetWidth/2));n.AFrameworkApplication.isRtl?this.Kc.style.marginRight=
m:this.Kc.style.marginLeft=m;n.AFrameworkApplication.isRtl?this.Kc.style.right="50%":this.Kc.style.left="50%"}this.Kc.style.zIndex=String(d)}else v.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}LL(){super.LL();const d=document.getElementById(this.rj(this.xuc));d.style.width=String.format("{0}px",this.UZ);d.style.height=this.qW}get qhb(){return this.hq}}Object(y.a)(gp,"AppsForOfficeInsertionDialog",oa.a,[1248]);var Tp=c(778);class vo extends oa.a{constructor(d=!0,m=!0,
A=null){super();this.Csa="calc(100% - 46px)";this.ZKa="15px";this.Dsa="0";this.xuc="WACDialogPanel";this.UZ=695;this.yuc=462;this.qW="80%";this.Grc=350;this.N$a="100%";this.D1j="auto";this.E1j="5px";this.F1j="auto";this.C1j="40px";this.Ckd="100px";this.zuc="200px";this.Cd=5;this.zg="SDXDialog";this.ecb=d;this.BTc=m;this.tkd=A}iS(){super.iS();this.hq.style.width=this.N$a;this.hq.style.height=this.Csa;this.hq.style.marginTop=this.ZKa;this.hq.style.padding=this.Dsa}Yda(){this.hq.style.width=this.N$a;
this.hq.style.height=this.ecb?this.Csa:"100%";this.hq.style.marginTop=this.ecb?this.ZKa:"0px";this.hq.style.padding=this.Dsa;if(this.ecb){this.Ckd&&this.zuc&&(this.UZ=parseInt(this.zuc.substring(0,this.zuc.length-2)),this.qW=this.Ckd);this.UZ>Kb.a.Ko?(this.Kc.style.width=String.format("{0}px",Kb.a.Ko),this.Kc.style.overflowX="scroll",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left="0"):(this.Kc.style.width=String.format("{0}px",this.UZ),this.Kc.style.overflowX="hidden");if(this.Kc.offsetHeight>
Kb.a.uv||this.yuc+50>Kb.a.uv)this.Kc.style.height=String.format("{0}px",Kb.a.uv),this.Kc.style.overflowY="scroll",this.Kc.style.top="0",n.AFrameworkApplication.isRtl?this.Kc.style.right="0":this.Kc.style.left="0",this.hq.style.minHeight=String.format("{0}px",this.Grc);else{this.Kc.style.overflowY="hidden";const d="%"===this.qW.substring(this.qW.length-1,this.qW.length),m=d?parseInt(this.qW.substring(0,this.qW.length-1)):parseInt(this.qW.substring(0,this.qW.length-2));this.Kc.style.top=d?(100-m)/2+
"%":100*(Kb.a.uv-m)/Kb.a.uv/2+"%";this.Kc.style.height=this.qW}this.LDa()}else this.Kc.style.left=this.D1j,this.Kc.style.right=this.E1j,this.Kc.style.top=this.F1j,this.Kc.style.bottom=this.C1j,this.Kc.style.width=this.zuc,this.Kc.style.height=this.Ckd,this.Kc.style.overflowX="hidden",this.Kc.style.overflowY="hidden"}LDa(){if(this.Kc){var d=this.Kc.style.zIndex;this.Kc.style.zIndex="-9999";if(this.UZ>Kb.a.Ko)n.AFrameworkApplication.isRtl?this.Kc.style.marginRight="0":this.Kc.style.marginLeft="0";else{const m=
String.format("{0}px",Math.floor(-this.Kc.offsetWidth/2));n.AFrameworkApplication.isRtl?this.Kc.style.marginRight=m:this.Kc.style.marginLeft=m;n.AFrameworkApplication.isRtl?this.Kc.style.right="50%":this.Kc.style.left="50%"}this.Kc.style.zIndex=String(d)}else v.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}LL(){super.LL();const d=document.getElementById(this.rj(this.xuc));d.style.width=String.format("{0}px",this.UZ);d.style.height=this.qW}get yXc(){return this.ecb}get qhb(){return this.hq}Gio(d,
m){this.Ckd=d;this.zuc=m}}Object(y.a)(vo,"SDXDialog",oa.a,[]);var Lo=c(1665),Fp=c(337),Wj=c(79),Im=c(102),ln=c(951);class Ik{constructor(d,m,A,R,da,Ea,ib,Qb,pc=null){this.CS=this.Lwb=this.nrc=null;this.CVj=6E4;this.Rpd=!1;this.Qwe=3E3;this.kvc=this.Pwe=0;this.BUb=this.lte=this.GCa=this.Gmh=null;this.iaa=d;this.Hj=A;this.Vb=R;this.np=da;this.ga=Ea;this.Ca=ib;this.qhd=Qb;this.$Xb=pc;this.tck=!pc;this.X2b&&(this.oDa?(this.CS=new cs(this.ga,this.oDa,"3935259562","2544406033","1945259303",this.Ca,this.Dtk),
this.EXc()&&(this.oDa.gpb(Object(I.a)(this,this.BHa,"onAddinDetailsRefreshed")),this.E7f?this.ljf(this.Qwe):window.setTimeout(()=>{this.Rpd||(this.Rpd=!0,this.Ade(),v.ULS.sendTraceTag(509088386,220,15,"AddinDetailsManager not triggered"),this.xZh&&(this.kvc=7,this.fZ(0,!0)))},this.CVj))):v.ULS.sendTraceTag(509749262,220,10,"AddinDetailsManger is null"));this.Ksa=null;this.BWj=Object(I.a)(this,this.ipc,"userActionHandler");this.sa=new vb.a;this.DUb=this.c0b=this.F9g=null;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",
!1)&&(this.nrc=Xa.a("getTheme")?appChrome.api.getTheme():null)}ljf(d){window.setTimeout(()=>{this.kYn()},d)}kYn(){0===this.Bna?(v.ULS.sendTraceTag(508830284,220,15,"commandRegistrationState: {0}, the 1st attempt was timeout, explicitly call queryAddinDetails.",jl[this.Bna]),this.kvc=7,this.fZ(0,!0),this.ljf(this.Qwe)):1===this.Bna?(v.ULS.sendTraceTag(508830283,220,50,"commandRegistrationState: {0}, wait for queryAddinDetails for a few more seconds to complete.",jl[this.Bna]),this.Bna=2,this.ljf(3*
this.Qwe)):2===this.Bna?(v.ULS.sendTraceTag(508839687,220,15,"commandRegistrationState: {0}, the 2nd attempt was timeout, register the command anyway and complete.",jl[this.Bna]),this.Ade()):v.ULS.sendTraceTag(508839686,220,50,"commandRegistrationState: {0}, registration completed.",jl[this.Bna])}get oDa(){this.UCd&&!this.lte&&(this.lte=hq.createInstance(this.Ca,this.Hj,{["AppsForOfficeAllowExternalMarketplace"]:this.Ca.$("AppsForOfficeAllowExternalMarketplace"),["AppsForOfficeThirdPartyIsDisabled"]:this.Ca.$("AppsForOfficeThirdPartyIsDisabled"),
["AreThirdPartyAddInsAllowed"]:n.AFrameworkApplication.oOa,["PopularAddinDetailsJsonString"]:this.Mob,["UICulture"]:n.AFrameworkApplication.uiCulture}));return this.lte}get Dtk(){this.d6d&&!this.BUb&&(this.BUb=new Bp(this.Ca,this.oDa,this.PEn));return this.BUb}EXc(){return(this.Ca||n.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}get PEn(){return'[{"title":"Writing fluently","solutionIds":["wa200001011","wa200000368","wa104381714","wa200002281","wa200005107","wa200003478","wa104380050","wa104380449","wa104380140","wa104380519","wa104380278"]},{"title":"Educational purpose","solutionIds":["wa104099688","wa104382081","wa104381909","wa104379370","wa200001482","wa200002534","wa104380848","wa200001486","wa104380917","wa104380429"]},{"title":"Adding pictures, icons and diagrams","solutionIds":["wa104380121","wa104051163","wa200000113","wa104379279","wa104218065","wa104381063","wa104379997","wa200000729","wa200001486","wa104178141","wa104380118"]}]'}get E7f(){return(this.Ca||
n.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!0)}get xZh(){return this.E7f?!0:(this.Ca||n.AFrameworkApplication.K).getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExperimentalQueryAddinDetailsEnabled",!1)}get UCd(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get X2b(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.UCd}get d6d(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}get rdc(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Et(){return this.Hj.value}get pBo(){this.GCa||(this.GCa={},this.GCa.InsertAddInsFromBackstage="Backstage",this.GCa.InsertMoreAddInsFromBackstageFooter="InsertMoreAddInsFromBackstageFooter",this.GCa.LaunchMyAddInsFromBackstage="BackstageSeeAll",this.GCa.InsertAddIns=
"Ribbon",this.GCa.LaunchAddinDialogFromTellMe="TellMe",this.GCa.TeachingCallout="TeachingCallout",this.GCa.AddinFlyoutMoreButton="AddinFlyoutSeeAll",this.GCa.InsertMoreAddInsFromFooter="InsertMoreAddInsFromFooter");return this.GCa}Ub(){this.ga.fb(Q.a.LZc,K.a.frame,Object(I.a)(this,this.LZc,"launchAppForOfficeDialog"),4);this.ga.fb(Q.a.pOb,K.a.frame,Object(I.a)(this,this.pOb,"queryEntitledAppsForOffice"),96);this.ga.fb(Q.a.mVn,K.a.frame,Object(I.a)(this,this.lVn,"registerAddinDetailObserver"),96);
this.ga.qa(Q.a.EJo,K.a.frame,Object(I.a)(this,this.A8m,"logTellMeOfficeAppOfficeAppStatusQuery"));this.ga.qa(Q.a.f7f,K.a.frame,Object(I.a)(this,this.f7f,"registerAppActivatedEvent"));this.ga.qa(Q.a.JCf,K.a.frame,Object(I.a)(this,this.Osi,"insertAgaveAction"));this.ga.qa(Q.a.lti,K.a.frame,Object(I.a)(this,this.Osi,"insertAgaveAction"));this.ga.qa(Q.a.RNd,K.a.frame,Object(I.a)(this,this.opm,"handleExecuteAddinAction"));this.ga.qa(Q.a.ysj,K.a.frame,Object(I.a)(this,this.drm,"handleShowExtensionTaskPane"));
this.ga.qa(Q.a.cGh,K.a.frame,Object(I.a)(this,this.Aom,"handleCloseExtensionTaskPane"));this.ga.qa(Q.a.jfj,K.a.frame,Object(I.a)(this,this.Pqm,"handleRestartExtensionTaskPane"));this.ga.qa(Q.a.E2d,K.a.frame,Object(I.a)(this,this.Tpm,"handleLaunchSDXDialog"));this.X2b&&(this.ga.qa(Q.a.b0m,K.a.frame,Object(I.a)(this,this.Jyf,"handleLaunchAddinInstallDialog")),this.ga.qa(Q.a.RKf,K.a.frame,Object(I.a)(this,this.RKf,"launchUserInstalledAddInFromFlyout")),this.EXc()||this.ga.qa(Q.a.a3i,K.a.frame,Object(I.a)(this,
this.Tmi,"handlePopulateAddInGallery")),this.ga.fb(Q.a.cMn,K.a.frame,Object(I.a)(this,this.Kqm,"handleQueryAddInFlyout"),100),this.ga.qa(Q.a.Htk,K.a.frame,Object(I.a)(this,this.lmi,"handleAddInListLinksClicked")));this.d6d&&(this.jxh?(this.ga.qa(Q.a.FGi,K.a.frame,Object(I.a)(this,this.Jmi,"handleLaunchAddinInstallDialogFromList")),this.ga.qa(Q.a.Oti,K.a.frame,Object(I.a)(this,this.Hmi,"handleInstallPopularAddInAndLaunchIt"))):this.ga.qa(Q.a.c0m,K.a.frame,Object(I.a)(this,this.Jyf,"handleLaunchAddinInstallDialog")));
this.rdc&&(this.ga.qa(Q.a.bHo,K.a.frame,Object(I.a)(this,this.lrm,"handleSwitchPopularAddIns")),this.d6d&&this.jxh||(this.ga.qa(Q.a.FGi,K.a.frame,Object(I.a)(this,this.Jmi,"handleLaunchAddinInstallDialogFromList")),this.ga.qa(Q.a.Oti,K.a.frame,Object(I.a)(this,this.Hmi,"handleInstallPopularAddInAndLaunchIt"))));n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)&&this.ga.qa(Q.a.yDm,K.a.frame,Object(I.a)(this,this.d0m,"launchAddinTransitionTeachingCallout"));
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorAddinThemeSupportEnabled",!1)&&Xa.a("registerOnThemeChangeCallback")&&(this.Hj.value.setAppTheme(this.nrc),appChrome.api.registerOnThemeChangeCallback(Object(I.a)(this,this.Rvn,"onThemeChanged")))}Ade(){this.Bna=3;this.ga.qa(Q.a.a3i,K.a.frame,Object(I.a)(this,this.Tmi,"handlePopulateAddInGallery"))}P3i(){return new U.a}opm(d,m,A,R,da){if(2!==A)return 32;d=da[Lo.a.cOc];if("Action"!==da[Lo.a.cIh])return 8;m=da[Lo.a.o5b];
A=da[Lo.a.e3c];R=A.optionalProperties[kf.a.Inh];var Ea=(da=this.ztf(da))?this.PPa(da):null;Ea||(da=new le.a,Ea=A.optionalProperties[kf.a.taskPaneWidth],0<=Ea&&(da.taskPaneWidth=Ea),da.pS=A.optionalProperties[kf.a.pS],da.sourceLocationOverrideResourceId=A.optionalProperties[kf.a.sourceLocationOverrideResourceId],da.bS=A.$Lc,da.onTaskPaneClose=A.optionalProperties[kf.a.onTaskPaneClose],da.onExtensionLaunchCallback=A.optionalProperties[kf.a.onExtensionLaunchCallback],da.CVc=A.optionalProperties.InstanceToken?
A.optionalProperties.InstanceToken:(new Rh.a(Eg.a.create(),1)).toString(),da.isPreload=!0,Ea=da.CVc,this.V5(d.getId(),da,!0));return this.Tjf(Ea,m,R)?32:8}BHa(d,m){this.xZh&&this.Kto(m.qO)&&(v.ULS.sendTraceTag(508867086,220,15,"OnAddinDetailsRefreshed: collectionType {0}, errorCode: {1}, failure: {2}, errorInfo: {3}",fj[m.qO],gq[m.errorCode],m.failure?m.failure.toString():"n/a",JSON.stringify(m.failure)),this.NEo(m.qO));this.E7f?2!==m.qO&&3!==this.Bna&&this.Ade():this.Rpd||(this.Rpd=!0,this.Ade())}NEo(d){this.kvc&=
~(1<<d)}Kto(d){return!!(this.kvc&1<<d)}Jmi(d,m,A,R,da){return"LinkClickedPayload"===da.Type?this.lmi(d,m,A,R,da):this.Jyf(d,m,A,R,da)}Jyf(d,m,A,R,da){if(2!==A)return 32;d=this.kfm(da);if(!d)return v.ULS.sendTraceTag(509687395,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;m=this.Hj.value?this.Hj.value.getAppUILocale()||"en-US":"en-US";this.DUb=new Tq(d,"wac_word",m,Ea=>{Ea.fromInstallDialog=!0;Ea.UILocation=da.UILocation;this.ipc("0",3,Ea)});this.DUb.Uh("",null,null);
return 32}kfm(d){var m=null;if(!d)return m;if(this.CS.EJb){if(d=this.CS.wQd(this.zwf(d)))m=d.solutionId}else m=d.CommandValueId,m=Yc.c(m)?this.CS.raf[d.SourceControlId]:m;return m}zwf(d){let m;if(!d)return null;(m=d.CommandValueId)||(m=this.CS.jki(d.SourceControlId));return m}Tpm(d,m,A,R,da){return 2!==A?32:this.E2d(da[Lo.a.cOc],da[Lo.a.e3c])?32:8}drm(d,m,A,R,da){if(2!==A)return 32;d=da[Lo.a.cOc];m=da[Lo.a.o5b];da=da[Lo.a.e3c];A=new le.a;R=da.optionalProperties[kf.a.taskPaneWidth];0<=R&&(A.taskPaneWidth=
R);A.pS=da.optionalProperties[kf.a.pS];A.sourceLocationOverrideResourceId=da.optionalProperties[kf.a.sourceLocationOverrideResourceId];A.bS=da.$Lc;A.onTaskPaneClose=da.optionalProperties[kf.a.onTaskPaneClose];A.onExtensionLaunchCallback=da.optionalProperties[kf.a.onExtensionLaunchCallback];A.o5b=m;da.optionalProperties.InstanceToken&&(A.CVc=da.optionalProperties.InstanceToken);return this.V5(d.getId(),A,!0)?32:8}Kqm(){const d=!n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&n.AFrameworkApplication.oOa;
return d&&this.CS&&!this.EXc()&&this.CS.xDh()||d&&this.CS?32:8}d0m(d,m,A){if(2!==A)return 32;this.Gmh=new oo;this.Gmh.DKc();return 32}Tmi(d,m,A,R,da){if(2!==A)return this.CS.xDh()?32:8;ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.HandlePopulateAddInGallery"}));this.CS.rFn(da);return 32}lrm(d,m,A){if(2!==A)return 32;this.CS.aHo();return 32}Ynm(d,m){if(2!==d)return 32;d=m.Href;var A=m.CommandValueId;A=Yc.c(A)?this.CS.raf[m.SourceControlId]:A;if(!A)return v.ULS.sendTraceTag(508887646,
220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;const R=this.oDa.JFb(A);if(R){const da={};da.solutionId=A;da.storeType=R.storeType;da.storeId=R.storeId;da.assetId=R.assetId;da.assetStoreId=R.assetStoreId;A={["solutionId"]:Ik.J4(da)};A.href=d;A.UILocation=m.UILocation;ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Sf.a.RH(A)}))}return 32}Mpm(d,m){if(2!==d)return 32;d=m.CommandValueId;if(!d)return v.ULS.sendTraceTag(509219802,
344,10,"No solutionId."),8;const A=this.oDa.JFb(d),R={};if(A)R.solutionId=d,R.version=A.version,R.storeType=A.storeType,R.storeId=A.storeId,R.assetId=A.assetId,R.assetStoreId=A.assetStoreId,R.targetType=A.targetType,R.displayName=A.displayName,R.width=A.width,R.height=A.height,this.ipc("InstalledByListView",41,R),this.GIb(R),d={["solutionId"]:Ik.J4(R)},d.UILocation=m.UILocation,ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Sf.a.RH(d)}));
else return v.ULS.sendTraceTag(509219801,344,10,"No add-in details."),8;return 32}lmi(d,m,A,R,da){if(!this.CS.EJb)return this.Ynm(A,da);if(2!==A)return 32;d=da.Href;m=this.CS.wQd(this.zwf(da));if(!m)return v.ULS.sendTraceTag(508913680,220,10,"Failed to get a valid AddinDetail object in LaunchAddinInstallDialog"),8;m=m.Xnc();m={["solutionId"]:Ik.J4(m)};m.href=d;m.UILocation=da.UILocation;ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",
dataFields:Sf.a.RH(m)}));return 32}RKf(d,m,A,R,da){if(!this.CS.EJb)return this.H0m(A,da);if(2!==A)return 32;d=da.SourceControlId;d=this.CS.wQd(this.UFm?this.zwf(da):this.CS.jki(d));if(!d)return v.ULS.sendTraceTag(509751330,344,10,"No add-in details."),8;d=d.Xnc();this.GIb(d);n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&(d={["solutionId"]:Ik.J4(d)},d.UILocation=da.UILocation,ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",
dataFields:Sf.a.RH(d)})));return 32}Hmi(d,m,A,R,da){if(!this.CS.EJb)return this.Mpm(A,da);if(2!==A)return 32;d=this.CS.wQd(da.CommandValueId);if(!d)return v.ULS.sendTraceTag(508913679,344,10,"No add-in details."),8;d=d.Xnc();this.ipc("InstalledByListView",41,d);this.GIb(d);d={["solutionId"]:Ik.J4(d)};d.UILocation=da.UILocation;ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Sf.a.RH(d)}));return 32}Aom(d,m,A,R,da){return 2!==
A?32:(d=this.ztf(da))?(this.LOa(d),32):8}Pqm(d,m,A,R,da){if(2!==A)return 32;if(d=this.ztf(da))if(d=this.Hj.value.getOsfControl(d))return d.refresh(),32;return 8}Rvn(){this.nrc=Xa.a("getTheme")?appChrome.api.getTheme():null;this.Hj.value.setAppTheme(this.nrc);return this.nrc}ztf(d){let m=null;const A=d[Lo.a.cOc].getId();d=d[Lo.a.e3c].optionalProperties[kf.a.sourceLocationOverrideResourceId];A&&(m=this.qPc(A,d));return m}CFm(d,m){const A=da=>{var Ea={};Ea.solutionId=da.solutionId;Ea.version=da.version;
Ea.storeType=da.storeType;Ea.storeId=da.storeId;Ea.assetId=da.assetId;Ea.assetStoreId=da.assetStoreId;Ea.targetType=1;da=new U.a;da.add(Ea);Ea={};Ea[Ye.a.JCd]=da;Ea[Ye.a.hOa]=3;this.ga.Qb(Q.a.LKb,2,Ea)},R=(da,Ea)=>{this.showTaskPane(da.solutionId,Ea,da);this.iaa&&this.iaa.value&&this.iaa.value.Nkb(da)};n.AFrameworkApplication.K.$("OfficeJsUseExperimentHostJsIsEnabled")&&(d.hostInfoFlags|=8);if(n.AFrameworkApplication.K.$("AddInCommandsIsEnabled"))if(d.isAddinCommands)0===d.addinCommandsActionType?
A(d):2===d.addinCommandsActionType?R(d,m):3===d.addinCommandsActionType&&(this.createUILessSandbox(d.solutionId,m,d),this.iaa&&this.iaa.value&&this.iaa.value.Nkb(d));else{const da={};n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(da.solutionId=d.solutionId,da.version=d.version):(da.marketplaceId=d.solutionId,da.marketplaceVersion=d.version);da.storeType=d.storeType;da.storeId=d.storeId;da.targetData=d;this.YDi(da,
(Ea,ib,Qb)=>{Qb=Qb.targetData;ib?A(Qb):R(Qb,m);Ea||v.ULS.sendTraceTag(542978529,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Qb.solutionId,Qb.storeType,Qb.assetId,null,null,Qb.storeId),Qb.storeType)})}else R(d,m)}LZc(d,m,A,R,da){if(1===A)return n.AFrameworkApplication.oOa?32:8;2===A&&(this.sa.raiseEvent("OnInsertionDialogOpened"),d=da.SourceControlId,da=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",
!1)?da.Query:da.CommandValueId,window.g_InstallOrigin=this.pBo[d]||"Unknown",m=this.qBn(d),n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.TellMeLaunchAddinDialogSetTabIdEnabled")&&"LaunchAddinDialogFromTellMe"===d&&!Ik.af(da)?(m.navigationMode=0,m.assetId=da,this.lad("{98143890-AC66-440E-A448-ED8771A02D52}",m)):n.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&(this.X2b||this.d6d)?"InsertMoreAddInsFromFooter"===d||"InsertMoreAddInsFromBackstageFooter"===
d?this.lad("{98143890-AC66-440E-A448-ED8771A02D52}",m):"AddinFlyoutMoreButton"===d?this.lad("0",m):this.lad(null,m):this.lad(null,m));return 32}dCi(){return n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.AllowQueryEntitledAppsForSpecificStoreType")}pOb(d,m,A,R,da){if(2===A){d=da.callback;if(!d)return 16;this.dCi()&&da.storeType?this.c6i(d,da.storeType):this.kMn(d)}return 32}lVn(d,m,A,R,da){if(2===A)if(this.oDa)da&&da.Observer?this.oDa.gpb(da.Observer):v.ULS.sendTraceTag(510248469,
220,10,"RegisterAddinDetailObserver: invalid actionData: {0}",JSON.stringify(da));else return v.ULS.sendTraceTag(512231321,220,10,"RegisterAddinDetailObserver: this.AddinDetailsManager is null."),8;return 32}A8m(d,m,A,R,da){2===A&&v.ULS.sendTraceTag(16847762,341,50,String.format("[TellMeForOfficeAddIn-FlyoutRendered]: AppName:{0} | SessionId:{1} | Lcid:{2}",da.LabelText,n.AFrameworkApplication.userSessionId,n.AFrameworkApplication.lcid));return 32}f7f(d,m,A,R,da){2===A&&(d=da.callback)&&this.Pxk(d);
return 32}RNd(){return!1}Tjf(){return!1}V5(d,m=null,A=!1){if(!n.AFrameworkApplication.QCi(d))return v.ULS.sendTraceTag(527720961,1403,15,"First Party Taskpane blocked: Not in allow list: {0}",d),!1;m||(m=new le.a);m.bS||(m.bS={});m.bS.ShowFeedback=n.AFrameworkApplication.LF;const R=m.CVc?m.CVc:(new Rh.a(Eg.a.create(),1)).toString();A=new ki.a(R,d,"","",A?"sdxcatalog":"firstparty",null,!1);A.activationStart=window.performance.now();A.taskPaneWidth=m.taskPaneWidth;A.sourceLocationOverrideResourceId=
m.sourceLocationOverrideResourceId;A.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;A.osfControlType=1;A.onTaskPaneClose=m.onTaskPaneClose;A.onExtensionLaunchCallback=m.onExtensionLaunchCallback;A.isModernPane=m.isModernPane;A.isResizable=m.isResizable;A.resizeMinWidth=m.resizeMinWidth;A.resizeMaxWidth=m.resizeMaxWidth;A.hostSettings=OSF.OUtil.serializeSettings(m.bS);A.settings=OSF.OUtil.serializeSettings(m.bS);A.featureGates=n.AFrameworkApplication.K.krf(d);A.sharedRuntimeId=
m.sharedRuntimeId;A.isPreload=m.isPreload;A.isPaneAutoOpened=m.isPaneAutoOpened;d=this.qPc(A.solutionId,m.sourceLocationOverrideResourceId);return this.showTaskPane(d,m.pS,A)}DCb(d,m=null){d=m?this.qPc(d,m.sourceLocationOverrideResourceId):this.qPc(d,null);this.LOa(d)}LOa(){}J0(){return!1}showTaskPane(){return!0}dVd(){return null}Cof(){return 0}Kkj(){}Nnh(){}Jtj(){}createUILessSandbox(){}PPa(){return null}hJa(d){var m=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const A=this.IFb();A&&(3===
A.yPc(d)?(m={},m[Ye.a.NCd]=d,this.ga.Qb(Q.a.hJa,2,m),m=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):m=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return m}YFa(d){var m=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const A=this.IFb();A&&(3===A.yPc(d)?(m={},m[Ye.a.NCd]=d,this.ga.Qb(Q.a.YFa,2,m),m=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):m=OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog);return m}Num(d){for(let m of wi.gmm())if(m.value.zg===d)return m.value.dialog.hide(),
m.key;return null}dispose(){this.Hj&&this.Hj.value&&"undefined"!==typeof this.Hj.value.hostCheckReadyHandler&&(n.AFrameworkApplication.a2n(Object(I.a)(this.Hj.value,this.Hj.value.hostCheckReadyHandler,"hostCheckReadyHandler")),v.ULS.sendTraceTag(590943260,1403,100,"ContextActivationManager::HostCheckReadyHandler is unregistered"))}YDi(d,m){this.Hj.value.isAddinCommandsAsync(d,m)}LOl(){return Object(I.a)(this,this.wth,"appForOfficeStatusChangedHandler")}Onh(d){this.Hj.value||v.ULS.shipAssertTag(6068437,
341,!1,"ContextActivationManager unavailable while trying to activate app: {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId));this.Hj.value.insertOsfControl(d)}K7i(d){this.Hj.value?this.Hj.value.activateOsfControl(d):v.ULS.shipAssertTag(6431491,341,!1,"ContextActivationManager unavailable while trying to reactivate app: {0}",d)}Dil(d){this.Hj.value?this.Hj.value.deActivateOsfControl(d):v.ULS.shipAssertTag(6431492,341,!1,
"ContextActivationManager unavailable while trying to deactivate app: {0}",d)}GIm(d){return this.Hj.value?2===this.Hj.value.getOsfControlStatus(d):(v.ULS.shipAssertTag(18114241,341,!1,"ContextActivationManager unavailable while trying to firgure out if app is active: {0}",d),!1)}IFb(){return null}ipc(d,m,A=null){if(5===m)this.X$i(!1);else if(6===m)this.X$i(!0);else if(0===m)this.KDh(d,!1),n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb.Ppa&&ln.ShyRibbon.cgb(1,0);else if(7===m)this.KDh(d,
!0);else if(1===m)this.BDk();else if(2===m)this.AFd();else if(3===m)this.$Xb&&this.$Xb.hide(),this.X2b&&this.DUb&&this.DUb.hide(),A?(this.Lwb=d=this.VEd(A),v.ULS.sendTraceTag(509679069,220,50,"UserActionEnum.InsertAgave: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",Ik.J4(this.Lwb)),this.X2b&&"fromInstallDialog"in A&&A.fromInstallDialog?this.ADm(d,A):this.GIb(d)):v.ULS.sendTraceTag(17113349,344,10,"InsertAgave: should have valid insert agave parameters");else if(41===m)this.UCd&&A&&(this.Lwb=
this.VEd(A),v.ULS.sendTraceTag(509674968,220,50,"UserActionEnum.ClickTrust: the _lastInsertedAgaveParams' PrivacyCompliantId: {0}",Ik.J4(this.Lwb)));else if(40===m)this.UCd&&this.Lwb&&A&&(d=this.VEd(A),this.FHk(this.Lwb,d)&&(v.ULS.sendTraceTag(509679068,220,50,"UserActionEnum.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",Ik.J4(d)),this.Lwb=null,this.fZ(0)));else if(36===m)A?this.GIb(this.VEd(A)):v.ULS.sendTraceTag(587579545,344,10,"InsertDevManifest: should have valid insert agave parameters");
else if(37===m)d={["ak1"]:this.Hj.value.getDevManifestInvalidUrlErrorString(A.manifestUrl)},this.ga.Qb(Q.a.jRb,2,d);else if(9===m)n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&n.AFrameworkApplication.K.$("AddInCommandsLoadedInBootingIsEnabled")&&this.ga.Qb(Q.a.Z6f,2,A);else if(8===m)d={["ak1"]:this.Hj.value.getManifestInvaildErrorString()},this.ga.Qb(Q.a.jRb,2,d);else if(13===m||14===m)(A=this.IFb())&&3===A.yPc(d)&&this.Hj.value.notifyAgave(d,11);else if(15===m)(d=this.Num(d))?(A=this.IFb())&&
3!==A.yPc(d)&&this.Et.notifyAgave(d,11):(n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SdxDialogHandleEscKey")&&this.c0b&&this.c0b.hide(),this.X2b&&this.DUb&&this.DUb.hide());else if(23===m)ah.a.sendOtelEvent(Object.assign(new Tp.a,{otelEvent:A}));else if(38===m)ah.a.sendOtelCustomerContent(Object.assign(new Tp.a,{otelEvent:A}));else if(26===m)rn.a.instance.o0m(A);else if(27===m)(d=A.Id.Id)&&this.LOa(d);else if(32===m){d=this.IFb().MOl(A.solutionId);for(let R of d)this.LOa(R)}}FHk(d,
m){return T.a.ih().equals(d.solutionId,m.solutionId)&&T.a.ih().equals(d.storeType,m.storeType)&&T.a.ih().equals(d.storeType,"OMEX")}wth(){}Ygo(d,m){d!==this.Ksa&&(m&&this.blur(),this.Hj.value&&(this.Hj.value.notifyAgave(d,4),this.Ksa=d))}$go(d){this.Hj.value.appHasNotifications(d)&&(this.Ksa=null)}qPc(d,m=null){return d?m?String.format("{0}.{1}",d,m):d:""}X$i(d){d?(document.activeElement.blur(),this.np.cWd(0,null,2,null,null)):(document.activeElement.blur(),this.np.YSc(0,null,2,null,null));this.Ksa=
null}BDk(){this.Ksa=null}KDh(d,m){this.Ksa=d;const A=this.Qvf(d);if(A){var R=this.Vb.fe(A);m&&!this.Vb.getRegion(R.name)&&(m=new Fp.DOMFocusListing(()=>document.getElementById(this.bRc(d))),m.Lja=!0,m.Qm(3),m.Qm(2),m.Qm(1),m=this.Vb.nna(()=>document.getElementById(this.bRc(d)),this.Vb.fe(A),m),m.yP=!0,m.TTa(),R.mr(Im.KeyInputManager.ic(Wj.a.Kw,0)),R.mr(Im.KeyInputManager.ic(Wj.a.Kw,4)));this.Vb.mg(A)}}bRc(d){return d}blur(){document.activeElement.blur()}v0e(d){this.sa.addHandler("OnAppForOfficeClose",
d)}vyk(d){this.sa.addHandler("OnInsertionDialogOpened",d)}o6a(d,m=!1){m||(this.Dil(d),this.sa.raiseEvent("OnAppForOfficeClose",d));this.iaa&&this.iaa.value&&this.iaa.value.Kpl(d);this.Ksa=null}Qvf(){return null}lad(d,m){this.tck&&(this.$Xb=new gp);this.$Xb.Uh("",null,null);this.Hj.value.launchInsertDialog(this.$Xb.qhb,d,m)}AFd(){this.$Xb.hide()}E2d(d,m){var A=m.optionalProperties.InstanceToken?m.optionalProperties.InstanceToken:(new Rh.a(Eg.a.create(),1)).toString();A=new ki.a(A,d.getId(),"","","sdxcatalog",
null,!1);A.sourceLocationOverrideResourceId=m.optionalProperties[kf.a.sourceLocationOverrideResourceId];A.onExtensionLaunchCallback=m.optionalProperties[kf.a.onExtensionLaunchCallback];A.settings=OSF.OUtil.serializeSettings(m.$Lc?m.$Lc:{});A.featureGates=n.AFrameworkApplication.K.krf(d.getId());this.qPc(A.solutionId,A.sourceLocationOverrideResourceId);this.c0b=new vo(!0,!0);d=m.optionalProperties[kf.a.dialogTitle];this.c0b.Gio(m.optionalProperties[kf.a.dialogHeight],m.optionalProperties[kf.a.dialogWidth]);
this.c0b.Uh(d,null,null);A.div=this.c0b.qhb;A.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;A.osfControlType=1;this.Hj.value.insertOsfControl(A);return!0}GIb(d){this.ga.Qb(Q.a.JCf,2,d)}ADm(d,m){this.ga.Qb(Q.a.lti,2,d);n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled")&&(d={["solutionId"]:Ik.J4(d)},d.UILocation=m.UILocation,ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",
dataFields:Sf.a.RH(d)})))}H0m(d,m){if(2!==d)return 32;d=m.CommandValueId;var A=Yc.c(d)?this.CS.raf[m.SourceControlId]:d;if(!A)return v.ULS.sendTraceTag(508913678,344,10,"No solutionId."),8;d={};d.solutionId=A;if(A=this.oDa.JFb(A))d.version=A.version,d.storeType=A.storeType,d.storeId=A.storeId,d.assetId=A.assetId,d.assetStoreId=A.assetStoreId,d.targetType=A.targetType,d.displayName=A.displayName,d.width=A.width,d.height=A.height,this.GIb(d),n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled")&&
(d={["solutionId"]:Ik.J4(d)},d.UILocation=m.UILocation,ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Sf.a.RH(d)})));else return v.ULS.sendTraceTag(509724485,344,10,"No add-in details."),8;return 32}Osi(d,m,A,R,da){R=da.ownerAddinSolutionId||da.solutionId;d=n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.SharedRuntimeParameterRefactoring");A=da.targetType;R=this.qhd.HQd(R);var Ea=1===A&&R&&R.settings?
R.settings:{};d||!R||Ik.af(R.sharedRuntimeId)||(da.sharedRuntimeId=R.sharedRuntimeId,da.backgroundState=R.backgroundState);const ib=!Ik.af(da.sharedRuntimeId);var Qb=da.storeType;const pc=da.ownerAddinStoreType;let Pc;!d&&ib?(Pc=da.ownerAddinSolutionId||da.solutionId,Qb=pc||Qb):Pc=da.solutionId;const gd=(new Rh.a(Eg.a.create(),1)).toString();Ea=new ki.a(gd,Pc,da.version,da.storeId,Qb,Ea);Ea.assetId=da.assetId;Ea.assetStoreId=da.assetStoreId;Ea.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
Ea.osfControlType=A;Ea.sharedRuntimeId=da.sharedRuntimeId;Ea.backgroundState=d?R?R.backgroundState:Ea.backgroundState:da.backgroundState;Ea.isPreload=ib&&1===Ea.backgroundState;void 0!==da.isAddinCommands&&(Ea.isAddinCommands=da.isAddinCommands);void 0!==da.addinCommandsActionType&&(Ea.addinCommandsActionType=da.addinCommandsActionType);Ea.isAddinCommands&&(Ea.ownerAddinSolutionId=da.ownerAddinSolutionId,Ea.ownerAddinStoreType=pc);Ea.isResizable=!0;Ea.resizeMinWidth=no.a.taskPaneWidth;1===A?this.CFm(Ea,
da.displayName):0===A&&this.iaa.value.vCf(m,da.width,da.height,Ea);this.sa.raiseEvent("OnAppForOfficeActivated",this.l7k(Ea));return 32}kMn(d){if(this.dCi())this.c6i(d,OSF.StoreTypeEnum.MarketPlace);else{const m=new Mi;m.callbackFunc=d;m.storeType=OSF.StoreTypeEnum.MarketPlace;m.fromInsertDialog=!1;m.refresh="true"===rj.a.instance.getItem("refreshRequired");this.Hj.value.queryEntitlementDetails(m)}}c6i(d,m){const A=new Mi;A.callbackFunc=d;A.storeType=m;A.fromInsertDialog=!1;A.refresh="true"===rj.a.instance.getItem("refreshRequired");
this.Hj.value.queryEntitlementDetails(A)}qBn(d){const m={navigationMode:0,assetId:null,category:null};if(!d)return m;d=d.split("|");v.ULS.sendTraceTag(16847763,344,50,"LaunchInsertionDialog with parameters: {0}",JSON.stringify(d));if(3>d.length)return m;d[0]&&1===d[0].length&&(m.navigationMode=parseInt(d[0]));d[1]&&0<d[1].length&&(m.assetId=d[1]);d[2]&&0<d[2].length&&(m.category=d[2]);return m}VEd(d){const m={};m.solutionId=d[om.solutionId];m.version=d[om.version];m.storeType=d[om.storeType];m.storeId=
d[om.storeId];m.assetId=d[om.assetId];m.assetStoreId=d[om.assetStoreId];m.targetType=d[om.targetType]?d[om.targetType]:0;m.displayName=d[om.displayName];m.isAddinCommands=d[om.isAddinCommands];m.width=d[om.width]?d[om.width]:0;m.height=d[om.height]?d[om.height]:0;m.sharedRuntimeId=d[om.sharedRuntimeId];m.backgroundState=d[om.backgroundState]?d[om.backgroundState]:0;return m}l7k(d){return[d.solutionId,d.version,d.storeId,d.storeType,d.osfControlType]}Pxk(d){this.sa.addHandler("OnAppForOfficeActivated",
d)}aTb(){}Woe(){}fZ(d,m=!1){this.oDa&&(0===this.Bna&&Ik.kWm(d)&&(this.Bna=1),this.oDa.fZ(d,m))}get Mob(){return'[{"displayName":"Vertex42 Template Gallery","solutionId":"wa103296784","version":"1.1.0.0","description":"Browse over 300 templates created by Vertex42.com for Excel and Word","iconUrl":"18364.a3e7eafc-7761-4c16-8f90-68c3819a47e4.54117612-5f8b-47b0-a844-684631c459ca.131ca4d3-9ef1-4788-93e9-08aef4a16490.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":-1,"AUP":101,"downloadNumber":575602}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com","addinInfo":{"priority":2,"AUP":3726,"downloadNumber":5211012}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.5.0.0","description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1529,"downloadNumber":1946395}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","description":"Unlimited access to licensed photos, clipart and your company\u2019s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":3,"AUP":1187,"downloadNumber":1159314}},{"displayName":"DocuSign for Word","solutionId":"wa104218065","version":"4.2.0.0","description":"Enhance productivity by electronically signing or sending any document from Microsoft Word","iconUrl":"18865.cc9ae10a-ba5e-4ca5-8ece-5bf0bbacdeaf.b1c97a18-3e7f-49b2-8024-46db9b8faebd.b566087e-eda0-4453-880e-f47a7d848eb9.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.docusign.com/company/privacy-policy","addinInfo":{"priority":3,"AUP":1970,"downloadNumber":1485893}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":2,"AUP":893,"downloadNumber":304226}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":534,"downloadNumber":8447}},{"displayName":"JAGGAER Contract Authoring","solutionId":"wa104379585","version":"3.0.0.0","description":"Author and review contracts faster than ever directly in Word with JAGGAER Contract Authoring.","iconUrl":"559.1462f0c6-f61c-42fe-ad1d-dc4d87b45174.2dc5016b-cdbc-41af-abd9-7c915ae43c4e.06280d94-a345-4639-ae39-da11227674ac.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474843308/Product_42949677815/Asset_52e3d4a8-11b7-420e-802b-a0ff29736a82/JAGGAERMasterAgreementTermsand.doc","privacyUrl":"https://www.jaggaer.com/about/privacy-policy","addinInfo":{"priority":-1,"AUP":244,"downloadNumber":219377}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":453,"downloadNumber":601175}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":2,"AUP":2464,"downloadNumber":525805}},{"displayName":"Lucidchart Diagrams for Word","solutionId":"wa104380118","version":"2.0.0.0","description":"The easiest way to create and insert flowcharts, mockups, UML, mind maps and more in Microsoft Word.","iconUrl":"21470.8707174d-9346-4e3b-89fb-42a1eae7a042.2a02cd8e-edc2-44c8-9dca-10b7e851ac5a.eab30db5-84fe-4e19-b983-6d66f961dcff.png","licenseUrl":"https://lucid.co/tos","privacyUrl":"https://lucid.co/privacy","addinInfo":{"priority":3,"AUP":937,"downloadNumber":414112}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":916,"downloadNumber":319195}},{"displayName":"RefWorks Citation Manager","solutionId":"wa104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":-1,"AUP":3304,"downloadNumber":3710751}},{"displayName":"PDFfiller \u2013 edit your PDFs","solutionId":"wa104380140","version":"1.0.0.0","description":"Instantly add a document from Office365 to PDFfiller! Edit, sign, save, and share anytime, anywhere,","iconUrl":"14229.ae6bc553-5473-4b85-b0ea-714f7ce7f7b9.4763b6eb-4228-47cb-a466-650454ba5fe1.50b4e5e1-1ed9-4d90-9151-3b6be2f4bbb4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.pdffiller.com/en/privacy_policy.htm","addinInfo":{"priority":2,"AUP":216,"downloadNumber":15908}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":91,"downloadNumber":25675}},{"displayName":"Fejlretter - Powerful feedback","solutionId":"wa104380429","version":"2.0.0.0","description":"Save time when correcting student assignments with the critically acclaimed feedback tool.","iconUrl":"48038.4a8f5705-cdd6-4d3d-9ea1-eb6001a61fcf.e50840ee-5e4b-445e-8253-d4b06f278dd1.bd226b93-2fc4-4ecd-a04d-950b408fd15d.png","licenseUrl":"https://fejlretter.squarespace.com/betingelser","privacyUrl":"https://fejlretter.squarespace.com/privacy-policy","addinInfo":{"priority":3,"AUP":44,"downloadNumber":6918}},{"displayName":"Decisions Meeting Documents Manager","solutionId":"wa104380449","version":"3.0.0.0","description":"Easily write and distribute meeting minutes","iconUrl":"41051.34739d15-7ea7-42bb-ad1c-91bfb500a818.3cb93cd9-6b65-42b6-8d5b-9b707412ec5b.07832e01-88e9-4ace-96da-826f31323e98.png","licenseUrl":"https://www.meetingdecisions.com/terms-of-service","privacyUrl":"https://www.meetingdecisions.com/privacy","addinInfo":{"priority":2,"AUP":497,"downloadNumber":106275}},{"displayName":"officeatwork | Wizard for Office","solutionId":"wa104380519","version":"3.5.0.0","description":"Create personalized documents and insert personalized content with just a few clicks.","iconUrl":"21517.0e251595-714f-4044-bf20-b68cba626477.4a09e61b-6aa7-4911-b267-164255e59dcf.c0787172-1cc0-41f2-8885-5fd04ccf297d.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":3517,"downloadNumber":102934}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":1926,"downloadNumber":3103601}},{"displayName":"LEAP for Word","solutionId":"wa104380529","version":"3.0.0.0","description":"LEAP for Word helps automate documents and keep them up-to-date.","iconUrl":"11128.dc087b8a-bb43-477e-80a5-4d417ca5c857.dc25a14c-c04d-44cd-ac74-27e3a6537bd0.9630b45c-ae56-4630-8203-50fa08daa9b6.png","licenseUrl":"https://leap.us/terms.html","privacyUrl":"https://www.leap.us/privacy.html","addinInfo":{"priority":-1,"AUP":62,"downloadNumber":24466}},{"displayName":"FMath Editor","solutionId":"wa104380848","version":"2.1.0.1","description":"Allow users to insert equations into documents.","iconUrl":"21513.6a3c2fa6-ade2-4929-a881-1dd4c188f978.63d347ef-61d0-4ddb-a5af-5102243732ae.0ad9963c-9d43-4f1d-b599-319229de2eda.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://math-on-web.com/privacy_policy.html","addinInfo":{"priority":2,"AUP":169,"downloadNumber":29713}},{"displayName":"SmartCite for Papers","solutionId":"wa104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":3,"AUP":1696,"downloadNumber":1783130}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":-1,"AUP":332,"downloadNumber":149144}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":-1,"AUP":273,"downloadNumber":357671}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":2,"AUP":336,"downloadNumber":218656}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":10474,"downloadNumber":5854335}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":144,"downloadNumber":71152}},{"displayName":"SiteMap","solutionId":"wa104381519","version":"1.0.0.0","description":"Create SiteMaps and UI flows for Office document","iconUrl":"53703.e16f30a8-c796-46a0-8144-87f78c1714fc.0179cf34-ff8d-44ab-909e-62d8ca7404b7.16f23b12-05ab-4080-b531-395b75fa6046.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://mockflow.com/privacy_policy","addinInfo":{"priority":-1,"AUP":107,"downloadNumber":15422}},{"displayName":"Stava Rex","solutionId":"wa104381613","version":"3.1.0.0","description":"Stava Rex \u00e4r ett r\u00e4ttstavningsprogram som r\u00e4ttar stavfel och grammatikfel i svensk text.","iconUrl":"6657.d163e868-f594-4452-9c43-a8e27b9d84b7.0033d815-1490-4021-b259-c8d11fa928f7.571b8cbb-7e92-41a2-a8ae-edf3c143c467.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr/tillagg-for-office","addinInfo":{"priority":-1,"AUP":1049,"downloadNumber":98455}},{"displayName":"Visual Paradigm Online for Office","solutionId":"wa104381637","version":"1.0.0.0","description":"Draw and insert flowcharts, UML, mind maps, BPMN, Venn, ERD, ArchiMate and more in Office documents.","iconUrl":"37179.b19e18e4-8129-4f14-9c5f-94ff9f478a8e.7039006e-f2b2-4482-98db-255ae2f58628.bd478170-6d94-42f7-b043-44f31827a0d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://online.visual-paradigm.com/privacy.jsp","addinInfo":{"priority":-1,"AUP":100,"downloadNumber":25984}},{"displayName":"SpellRight","solutionId":"wa104381658","version":"3.2.1.0","description":"Advanced spellchecker, specially designed for people with reading and writing difficulties.","iconUrl":"44740.a94c453b-9a33-4274-bbd3-812c98659aa6.6f414cd6-fdfa-4f0d-981d-e4ab7d165a01.d68a7473-2a11-46c9-8fb4-1532d54df637.png","licenseUrl":"https://oribi.se/tos","privacyUrl":"https://oribi.se/gdpr","addinInfo":{"priority":-1,"AUP":612,"downloadNumber":77583}},{"displayName":"Outwrite - AI Writing Assistant","solutionId":"wa104381714","version":"4.2.0.0","description":"Write better everywhere with Outwrite\'s proofreading and paraphrasing tool","iconUrl":"24265.44fd0c0a-670c-4940-9d4a-ed3b74576b95.005f9722-a130-46d4-8ebf-c65a5bc3ef81.d1dd5745-4742-4a49-86b9-d9cc20daa98e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://outwrite.com/privacy","addinInfo":{"priority":3,"AUP":270,"downloadNumber":30167}},{"displayName":"LanguageTool","solutionId":"wa104381727","version":"1.0.0.9","description":"Advanced spell and grammar checker","iconUrl":"30578.091db8b2-7164-4fa1-ba0e-12b186fa9d3f.69a95916-c102-4f4e-9fe0-d891c84d0925.9dbc2d81-9492-4743-824a-db1a191f4605.png","licenseUrl":"https://languagetool.org/legal/terms","privacyUrl":"https://languagetool.org/legal/privacy","addinInfo":{"priority":-1,"AUP":704,"downloadNumber":515107}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":-1,"AUP":206,"downloadNumber":12047}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":2,"AUP":2855,"downloadNumber":4062279}},{"displayName":"Easy Code Formatter","solutionId":"wa104382008","version":"1.1.0.1","description":"Format your selected text like code. Choose from multiple open sourced code themes.","iconUrl":"22124.1bda0e8d-c98c-4254-86e5-8913af59e22e.0cc167da-7b45-4060-b953-fe20b1f92adb.52e7d2de-47ee-4544-a18e-1e9de92ef377.png","licenseUrl":"https://github.com/armhil/easy-code-formatter-submission/blob/main/docs/terms_of_use.pdf","privacyUrl":"https://github.com/armhil/easy-code-formatter-submission/blob/main/docs/privacy_policy.pdf","addinInfo":{"priority":3,"AUP":1,"downloadNumber":72543}},{"displayName":"PolicyTech\u00ae Tools","solutionId":"wa104382046","version":"1.0.0.5","description":"Insert always up-to-date fields and links into securely stored PolicyTech\u00ae documents","iconUrl":"16192.0cc4c2a8-ba9f-46fd-843f-0da849b0a778.96177cd9-9568-4427-9e9c-3d4f85b12c3a.aafbd44f-5f1b-4745-96cf-86e320c1ab28.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.navexglobal.com/en-us/privacy-statement","addinInfo":{"priority":-1,"AUP":1171,"downloadNumber":174753}},{"displayName":"Mendeley Cite","solutionId":"wa104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":37759,"downloadNumber":3936496873}},{"displayName":"Easy Syntax Highlighter","solutionId":"wa200000011","version":"1.0.1.0","description":"Code Syntax Highlighting for Word","iconUrl":"46879.e5d00319-8175-4ba7-9d6e-fdc1ea53abc5.228f1720-24bd-47ed-bbd3-59c73c454e5d.99fe41bb-6c5b-43f9-bc6d-585e984740bc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://app.pyxll.com/word-syntax-highlighter/privacy.html","addinInfo":{"priority":3,"AUP":411,"downloadNumber":44599}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":1512,"downloadNumber":992110}},{"displayName":"PERRLA","solutionId":"wa200000199","version":"8.1.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":2,"AUP":1663,"downloadNumber":283010}},{"displayName":"QuillBot","solutionId":"wa200000368","version":"1.0.0.0","description":"Save time and immediately improve your writing with QuillBot\u2019s Paraphrasing and Summarizing Tool. ","iconUrl":"5821.0c33b03b-ab2a-4712-ba09-d11a2edcbca7.e48cfd16-849a-473d-bfaa-746249630244.a00131df-ab1c-47cc-bef5-8d22f76e49dc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://word.quillbot.com/privacy.html","addinInfo":{"priority":1,"AUP":2949,"downloadNumber":1117180}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":908,"downloadNumber":1506340}},{"displayName":"Grammarly for Microsoft Word","solutionId":"wa200001011","version":"1.2.0.0","description":"Compose clear, mistake-free writing with Grammarly for Microsoft Word on Mac.","iconUrl":"44160.caa10083-95fd-4aa5-9299-a40c68cdc829.9e6b7934-9a4d-4e0f-948d-4f54dafab3f8.df43bd30-714e-4369-803a-00c9491be63b.png","licenseUrl":"https://www.grammarly.com/terms","privacyUrl":"https://www.grammarly.com/privacy-policy","addinInfo":{"priority":1,"AUP":23962,"downloadNumber":4682132}},{"displayName":"Writefull","solutionId":"wa200001482","version":"1.0.5.0","description":"Writefull is automated proofreading for science.","iconUrl":"15661.6e967273-a217-48f5-afd0-9c2b8e777bb9.c564a228-3fcf-4b0c-a7f3-a972b79c328c.25cff90e-9ce9-4a8f-8745-6e60c4b9b659.png","licenseUrl":"https://www.writefull.com/terms.html","privacyUrl":"https://www.writefull.com/privacy.html","addinInfo":{"priority":2,"AUP":400,"downloadNumber":429323}},{"displayName":"Corinth Screenshots","solutionId":"wa200001486","version":"1.0.0.0","description":"Sync the visual content of the Corinth app with your Office teaching materials","iconUrl":"51869.9a32c413-7910-4eea-8110-596bd8a40a09.a203af63-a892-4e73-b9ad-dcb325ba30f2.16ceca3f-8b79-45b4-8593-4dae5d022848.png","licenseUrl":"https://www.corinth3d.com/EULA","privacyUrl":"https://www.corinth3d.com/corinth-privacy-policy","addinInfo":{"priority":2,"AUP":21,"downloadNumber":12651}},{"displayName":"Spell checker and Grammar checker by Scribens","solutionId":"wa200001841","version":"1.0.0.0","description":"A powerful spelling and grammar checker. Scribens corrects 250 types of grammar mistakes.","iconUrl":"26848.b2f1ecc7-4017-4115-ae79-09c086924cf5.3c1daf8c-bc5d-4ffb-b4eb-160b11006f27.68175203-816b-48fd-ac79-99d7038badec.png","licenseUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","privacyUrl":"https://www.scribens.fr/download/CGV_Scribens_MSOfficeExtension.txt","addinInfo":{"priority":-1,"AUP":255,"downloadNumber":50247}},{"displayName":"ProWritingAid for Microsoft Word","solutionId":"wa200002281","version":"1.0.0.0","description":"The best writing style and grammar checker for everything you write.","iconUrl":"47676.90dd7d5f-0d94-454f-b4f8-247593fefda6.32a96d9b-d1fb-487e-b93a-532357aec0f1.6355c122-c3b0-4f89-8f7a-e3e9a6c0adff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://prowritingaid.com/en/Home/PrivacyWord","addinInfo":{"priority":2,"AUP":226,"downloadNumber":213992}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":-1,"AUP":2517,"downloadNumber":948014}},{"displayName":"Sciwheel","solutionId":"wa200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":381,"downloadNumber":999759}},{"displayName":"Citavi Assistant","solutionId":"wa200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":-1,"AUP":391,"downloadNumber":488543}},{"displayName":"Impression Signatures","solutionId":"wa200003216","version":"1.0.0.0","description":"Securely sign and send documents for signature directly from Word and Excel.","iconUrl":"10171.55569ba6-8707-48a8-b3df-6e6413574914.d131bcfb-dba2-4b50-bccb-a2ad4f770edc.75c9fdcb-00dd-41b7-81f5-2637d24ad344.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.iubenda.com/privacy-policy/8039352/full-legal","addinInfo":{"priority":-1,"AUP":114,"downloadNumber":26676}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":-1,"AUP":101,"downloadNumber":203447}},{"displayName":"Wordtune","solutionId":"wa200003478","version":"1.0.0.0","description":"Wordtune helps you rewrite your text into a concise, engaging and well-written message.","iconUrl":"24151.f6b24171-2782-4f28-8af6-e38438631fbe.91ba765d-d20e-4d2e-9486-a3a498a5b3a1.7e060834-f678-403e-8cc9-4b80c9f87d7f.png","licenseUrl":"https://www.wordtune.com/terms-of-use","privacyUrl":"https://www.wordtune.com/privacy-policy","addinInfo":{"priority":1,"AUP":476,"downloadNumber":84725}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":-1,"AUP":549,"downloadNumber":271987}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":-1,"AUP":10144,"downloadNumber":1223}},{"displayName":"Draft Coach","solutionId":"wa200004257","version":"1.1.121.0","description":"Formative writing feedback for students: available for Turnitin customers","iconUrl":"32351.26374e0d-06e7-47bd-b6cb-0a1e5e54f167.a165e027-3385-42db-bc1e-38bcbb939a51.ffef3075-692f-4d29-a0e2-b1ca1925b0d4.png","licenseUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm#Usage_Policy","privacyUrl":"https://help.turnitin.com/Privacy_and_Security/Privacy_and_Security.htm","addinInfo":{"priority":-1,"AUP":17823,"downloadNumber":13385103}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","description":"Introducing Ghostwriter OpenAI ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":533,"downloadNumber":54328}},{"displayName":"Legal AI Assistant","solutionId":"wa200005260","version":"1.0.0.0","description":"This add-in is designed to assist users in generating contracts and adding missing clauses using AI","iconUrl":"63548.f4c25bf7-14f2-46fe-9e82-501e47cf4e22.89c55224-07c3-47f2-ad1c-74f01a5391f8.c3bdc80b-1ae3-468f-adbe-d1bf1206b422.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://e-arbitrator.com/legal-ai-privacy-policy","addinInfo":{"priority":2,"AUP":111,"downloadNumber":834}},{"displayName":"GenText AI Assistant","solutionId":"wa200005287","version":"1.0.0.2","description":"GenText is an AI Assistant developed to help business professionals write reports","iconUrl":"39094.562d3128-5997-43ce-aded-f5b52b966432.c9dbaa0c-35ee-443a-8942-03744376197e.97368fc6-d794-4d0e-8282-a96670ef2828.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://gentext.ai/privacy","addinInfo":{"priority":2,"AUP":138,"downloadNumber":527}},{"displayName":"TrustSigner","solutionId":"wa200005298","version":"1.0.0.0","description":"Sign documents fast, secure and affordable. Made in EU with legal binding.","iconUrl":"24353.f2399955-265f-4d0e-9e27-45e114545472.ebc76c58-2921-4d53-84bc-fefad793b03d.fc65492d-5b37-41f9-aca4-ca5b72c3a5a9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://trustsigner.eu/privacy","addinInfo":{"priority":2,"AUP":23,"downloadNumber":104}},{"displayName":"Ghostwriter Consultant Edition","solutionId":"wa200005312","version":"1.5.0.0","description":"Ghostwriter Consultant with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"36233.163ead30-016b-4591-a5b9-f2d2930e5403.bdc1efa7-a706-48f0-baf7-d76c2c5222ef.601d7792-1b34-4021-b4e7-15435a733bf1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":355,"downloadNumber":751}},{"displayName":"Dall-e Image Generator","solutionId":"wa200005313","version":"1.0.0.2","description":"Use AI to generate unique and stunning images based on the descriptive text within a document. ","iconUrl":"31431.4f416b91-4c5c-4aa1-b737-8aa50d8c65dc.bde80e16-2c77-4064-9ad7-a99a077ef64a.c508525c-965d-44b5-aec8-deb21c6941df.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.pegamento.nl/en/terms-conditions-text-to-image-extension","addinInfo":{"priority":2,"AUP":56,"downloadNumber":223}},{"displayName":"DrillBit-Plagiarism","solutionId":"wa200005339","version":"1.0.0.4","description":"Plagiarism detection software to detect similar or copied content.","iconUrl":"23545.e4fc7991-8bb7-408e-ad63-b9ab3b164d86.5c4bfb60-fbec-489d-a4dd-d294bfea0c0e.d48a04e3-6609-4d98-bcda-7e70107b93bc.png","licenseUrl":"https://drillbitplagiarism.com/termsCondition","privacyUrl":"https://drillbitplagiarism.com/customerHelp","addinInfo":{"priority":2,"AUP":17,"downloadNumber":0}},{"displayName":"Ghostwriter Legal","solutionId":"wa200005348","version":"1.5.0.0","description":"Ghostwriter Legal with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"19401.a89bf831-da40-48cb-aea0-9fdb99d2dfb6.24bb5297-c19d-4109-9ddc-4233c6565136.3d1468c5-2f55-4362-815a-846fdf9c7167.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":34,"downloadNumber":0}},{"displayName":"Ghostwriter Education","solutionId":"wa200005360","version":"1.5.0.0","description":"Ghostwriter Education with ChatGPT for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"64228.96000578-f337-4e2a-9458-bf4f19bfed19.965f3cd0-f0cb-4f83-b18e-a1bba1290eab.8dd5e85f-59af-439e-9136-92bebf18e1d6.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":2,"AUP":23,"downloadNumber":0}}]'}get jxh(){return!!this.Ca&&
this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.BackstageOneClickInstallEnabled",!1)}get UFm(){return!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserInstalledAddinCommandValueIdEnabled",!0)}get Bna(){return this.Pwe}set Bna(d){v.ULS.sendTraceTag(508830282,220,50,"commandRegistrationState: {0} --\x3e {1}",jl[this.Pwe],jl[d]);this.Pwe=d}static kWm(d){return 0===d||10===d}static J4(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,
d.assetId,null,null,d.storeId)}static af(d){return!d||!d.length}}Object(y.a)(Ik,"AppsForOfficeUIActor",null,[10,1246]);var Cq=c(400),wo=c(130),xk=c(34);class Br{constructor(){this.onTabKeyDown=this.onExecute=this.icon=this.label=null}}Object(y.a)(Br,"TaskPaneHeaderButtonProps",null,[]);var Dq=c(254);class Uq{constructor(d,m,A,R,da){this.j1a=da;this.rlh=this.plh=null;this.Z7n=()=>{this.Z0m();this.mmc(this.rlh,this.plh)};this.cCl=Ea=>{Ea&&(this.hXb.BFi(Ea),this.uCh())};this.D3i=Ea=>{Ea=Ea.toDataURL("image/jpeg");
const ib=this.dX.PPa(String.format("{0}.{1}","FA000000012","Help.GiveFeedback.Url")),Qb={};Qb.screenshot=Ea;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ib,"onScreenshot",Qb,()=>{})};this.Rcc=Ea=>Ea===Q.a.giveFeedback;this.dX=d;this.Ktc=m;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",!1)||(this.SRg=A,this.hXb=R)}WP(d,m){this.rlh=d;this.plh=m;this.j1a.m8b(this.Z7n)}Z0m(){this.Ktc=Ia.a.instance.Oa("Common.App.ICustomerFeedbackUiWrapper");
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",!1)||(this.hXb=Ia.a.instance.Oa("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.SRg=Ia.a.instance.Oa("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"))}mmc(d,m){d={};m&&(d.query=m.Fg);if(this.dX){const A=Object.assign(new le.a,{taskPaneWidth:352});n.AFrameworkApplication.ta&&n.AFrameworkApplication.ta.Kb&&n.AFrameworkApplication.ta.Kb.p_d&&(A.isResizable=!0,
A.resizeMinWidth=352,A.resizeMaxWidth=920);switch(m.actionId){case Q.a.TIh:d.query="contactsupport";A.pS=WoncaIntl.WoncaStrings.L_ContactSupport;A.sourceLocationOverrideResourceId="Help.ContactSupport.Url";break;case Q.a.giveFeedback:n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",!1)||(this.hXb?this.hXb.lcb?this.uCh():this.SRg.NMc(this.cCl):v.ULS.sendTraceTag(40657945,1302,15,"feedbackFormManager is undefined"));A.pS=WoncaIntl.WoncaStrings.L_GiveFeedback;
A.sourceLocationOverrideResourceId="Help.GiveFeedback.Url";d.feedback=this.Z9h(m);break;case Q.a.wBj:d.query="showtraining";A.pS=WoncaIntl.WoncaStrings.L_Training;break;case Q.a.zsg:d.query="whatsnew";A.pS=WoncaIntl.WoncaStrings.L_WhatsNew;break;default:A.pS=WoncaIntl.WoncaStrings.L_Help}A.bS=d;n.AFrameworkApplication.K&&n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackDelayTaskpane")?this.Rcc(m.actionId)?this.Asj("FA000000012",A,m):(A.isModernPane=!0,this.dX.V5("FA000000012",
A)):this.dX.V5("FA000000012",A)}}Z9h(d){d=d.vd;n.AFrameworkApplication.K.jph(d);d=this.Ktc.getContext(d);let m={};"telemetryGroup"in d&&(m=d.telemetryGroup);m.processSessionId=d.sessionId;m.officeBuild=d.build;d.telemetryGroup=m;if(void 0===d.feedbackType||null===d.feedbackType)d.feedbackType=-1;d.disableIncludeScreenshot="disableIncludeScreenshot"in d?d.disableIncludeScreenshot:!1;d.screenshot="screenshot"in d?d.screenshot:!0;d.disableScreenshotPreview=!1;d.includeScreenshotSelectedDefault=!0;return d}Asj(d,
m,A,R=300){this.Ktc.e3e()?(m.bS.feedback=this.Z9h(A),this.dX.V5(d,m)):this.fkl(R).then(()=>{this.Asj(d,m,A,2*R)})}cpa(){this.dX&&this.dX.DCb("FA000000012")}uCh(){if("undefined"==typeof OfficeBrowserFeedback)v.ULS.sendTraceTag(40207955,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.D3i);return}catch(d){v.ULS.sendTraceTag(594023825,1302,15,"Failed to use createScreenshot "+(d?d.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.D3i)}catch(d){v.ULS.sendTraceTag(594023824,1302,15,"Failed to use html2canvas"+(d?d.toString():null))}}}dispose(){}fkl(d){return new Promise(m=>{window.setTimeout(()=>{m(null)},d)})}}Object(y.a)(Uq,"AgaveAssistancePane",null,[905,10]);class hr{constructor(d){this.sik=d}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(d,m){this.sik.bib(d,m)}}Object(y.a)(hr,"RichApiEventManagerHost",null,[936]);class Gp{constructor(){this.wg=new Fk.a}sG(d){this.Wq(d,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Wq(d,m){if(d){var A={};A.Error=m;d(A)}}}Object(y.a)(Gp,"ApiEvent",null,[]);class rl extends Gp{constructor(){super();this.Sf=null}}Object(y.a)(rl,"WordEditorApiEvent",Gp,[]);class mn extends rl{constructor(){super();this.pRe=null}addHandler(d,m,A,R){this.Sf&&Yc.b(R)?(this.pRe||(this.pRe=new hr(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.pRe)),this.wg.Z(d,m),v.ULS.sendTraceTag(41513415,341,50,"Add RichApiMessage event handler for control: {0}.",
d),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,m,A){this.Sf&&Yc.b(A)&&this.wg.nb(d)?(this.wg.remove(d),v.ULS.sendTraceTag(41513416,341,50,"Remove RichApiMessage event for control: {0}.",d),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}QA(){}bib(d,m){const A={};A[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData]=m;this.wg.nb(d)&&this.wg.J(d)(A)}dPd(d,m){this.bib(d,[[65536,65539,"",mn.X9k(m),-1,!1]])}w9k(d,m){return[[2,1E3,
"",JSON.stringify([d,m]),0,!1]]}static X9k(d){const m={};m.visibility=d?"Visible":"Hidden";return JSON.stringify(m)}static get instance(){return null!=mn.sCg?mn.sCg:mn.sCg=new mn}}Object(y.a)(mn,"RichApiMessageEvent",rl,[]);class Jn{constructor(){this.iconUrl=this.title=this.id=null;this.isVisible=!1;this.Hnb=this.cSb=this.hob=this.pB=null;this.yWd=!1}}Object(y.a)(Jn,"ReactAppsForOfficeTaskPaneData",null,[]);var Jm=c(1074),hp=c(252),pq=c(358),Sl=c(158);class Zk{constructor(d,m,A){this.BBc=0;this.Uta=
d;this.ii=m;this.xwg=A}start(){this.BBc||(this.BBc=window.setInterval(()=>{OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.ii.PPa(this.xwg),Zk.t6l,null,(d,m)=>{d?v.ULS.sendTraceTag(591177106,3011,10,"Failed to send message to transcription pane, status: {0}.",d):this.Znm(m)})},Zk.jen))}stop(){this.BBc&&(window.clearInterval(this.BBc),this.BBc=0)}Znm(d){if(d&&d.completedContext){var m;if(({Gt:m}=rb.d(d.completedContext)).returnValue&&m)for(d=0;d<m.length;d++)this.Irm(m[d])}}Irm(d){if(d[Zk.eQf]&&
d[Zk.eQf]===Zk.e6n&&d[Zk.K7c]&&d[Zk.vej])this.Uta.Jrm(d[Zk.vej],d).then(m=>{this.wo(d[Zk.K7c],m)}).catch(m=>{const A={};A[Zk.BYh]=m;this.wo(d[Zk.K7c],A)});else{const m={};m[Zk.BYh]=Zk.GGm;this.wo(d[Zk.K7c],m)}}wo(d,m){m[Zk.XNo]=!0;m[Zk.eQf]=Zk.r8n;m[Zk.K7c]=d;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.ii.PPa(this.xwg),Zk.yDk,m,A=>{A&&v.ULS.sendTraceTag(591152963,3011,10,"Failed to send message to transcription pane, status: {0}.",A)})}}Zk.yDk="onTranscriptionHostMessage";Zk.t6l="getNewTranscriptionMessages";
Zk.XNo="transcription_message";Zk.eQf="messageType";Zk.vej="requestType";Zk.K7c="requestId";Zk.e6n="request";Zk.r8n="response";Zk.jen=3E3;Zk.BYh="error";Zk.GGm="invalidMessage";Object(y.a)(Zk,"TranscriptionAddInMessaging",null,[]);var fm=c(1057);class Gl{constructor(d,m){this.Leb=d;this.Cub=m}DCl(d){let m;m=this.ECl(d);0==m.length&&(m=this.CCl(d));return m}CCl(d){if(!this.Cub||!this.Cub.customProperties)return"";var m=this.Cub.customProperties.getItemOrNullObject("StoredTranscription");m=m?m.value:
"";if(isNullOrUndefined(m)||0==m.length)return"";v.ULS.sendTraceTag(512522206,3011,50,"Fetched Transcription From Custom property storage");d(!0);return m}ECl(d){if(!this.Leb)return v.ULS.sendTraceTag(512522205,3011,10,"CustomXMLManager object is NULL"),"";var m=this.Leb.CRd("http://schemas.microsoft.com/office/transcription/2022");if(isNullOrUndefined(m)||0==m.length)return"";m=m[0].getValue(wc.a.i1a);if(isNullOrUndefined(m)||0==m.length)return v.ULS.sendTraceTag(512522204,3011,10,"Not able to get the transcription data from XML Node"),
"";m=(new DOMParser).parseFromString(m,"text/xml");if(!isNullOrUndefined(m)&&!isNullOrUndefined(m.lastChild)){m=m.lastChild.textContent;if(isNullOrUndefined(m)||0==m.length)return"";v.ULS.sendTraceTag(512522207,3011,50,"Fetched Transcription From XML Storage");d(!1);return m}return""}}Object(y.a)(Gl,"TranscriptionDocumentStorageManager",null,[]);class vm{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc){this.Leb=null;this.wta="TranscriptionPane";this.lqf=()=>{const gd=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse").toLowerCase();
return"string"==typeof gd&&gd.includes("inner ring")?"DOGFOOD":"string"==typeof gd&&gd.includes("outer ring")?"MICROSOFT":"PRODUCTION"};this.kwn=()=>{v.ULS.sendTraceTag(594331858,3011,50,"Transcription pane closed by user.");const gd=this.Wji();gd.PaneOpenDurationInSecs=((performance.now()-this.Ktd)/1E3).toFixed(2);this.c_a.afo(gd);this.Ktd=0;this.qkh.stop()};this.k_a=d;this.ii=m;this.Cub=A;this.c_a=R;this.Ca=da;this.Jyb=Ea;this.Dnk=ib;this.qkh=new Zk(this.Dnk,this.ii,vm.Fkc);this.tua=Qb;this.Leb=
Pc;this.hAb=pc;this.rg=pq.a.getInstance(vm.WNo)}load(){v.ULS.sendTraceTag(51667731,3011,50,"Loading Transcription pane.");this.k_a&&(this.k_a.Fdc=!0)}Wji(){const d={},m=window.navigator;if(m){const A=m.connection||m.mozConnection||m.webkitConnection;A&&(d.DeviceNetDownLink=A.downlink,d.EffectiveNetworkType=A.effectiveType);d.IsOnline=m.onLine}return d}qzo(d){if(1===d)return 32;v.ULS.sendTraceTag(51667732,3011,50,"User intended to show Transcription Pane.");this.rg.logKpiUsage({kpiName:this.wta,kpiType:0});
this.Ktd=performance.now();this.c_a.cfo(this.Wji());this.k_a&&!this.k_a.Fdc&&this.load();if(!this.ii)return v.ULS.sendTraceTag(51667733,3011,10,"Failed to show Transcription pane, null object of AppsForOfficeUiActor"),this.rg.logKpiFailure({kpiName:this.wta,errorName:"FailedToTriggerPaneLaunch"}),16;d=Sl.a.get("TeachingUIShowCount");d=parseInt(d);if(isNaN(d)||!isFinite(d))d=0;const m={};m.IsProductionEnvironment=(2===n.AFrameworkApplication.L8).toString();m.TranscriptionSessionId=this.c_a.UWe;m.AugLoopCloudALServiceUrl=
this.Ca.kb("AugLoopCloudALServiceUrl");m.DocumentStorageType="DocumentXmlStorage";let A=!1;const R=(new Gl(this.Leb,this.Cub)).DCl(Ea=>{A=Ea});m.HasStoredTranscription=(0!=R.length).toString();m.StoredTranscription=R;m.IsTranscriptionFetchedFromCustomProperties=A.toString();Object(fm.b)()?m.MonthlyMinutesUsed=this.hAb.WUc:m.MonthlyMinutesUsed=this.Jyb.WUc;m.TeachingUIShowCount=d;m.FrontDoorBaseUrl=this.Ca.kb("DictationFrontdoorDomain");m.DefaultTranscriptionLocale=this.k_a.locale;m.EnableSetAnnotationsFromALVoiceClient=
(!!n.AFrameworkApplication.K&&(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSetAnnotationsFromALVoiceClient",!0)||n.AFrameworkApplication.K.$("SetAnnotationsFromALVoiceClient"))).toString();m.UnlimitedMins="true";m.ALSessionInitRetryEnabled=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ALSessionInitRetryEnabled",!1)).toString();m.RoamingCallsRetry=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.RoamingCallsRetry",
!1)).toString();m.FileSizeUploadLimit=3E8;m.isSharedUXDarkModeOn=this.esf().toString();m.UserTenantId=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.kb("TenantId").toString()||"";m.IsTranscriptionNewFlowEnabled=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsTranscriptionNewFlowEnabled",!1)).toString();m.ShouldSkipUpnCheck=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.ShouldSkipUpnCheck",
!1)).toString();m.EnableFlightAuthVersion=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.EnableFlightAuthVersion",!1)).toString();m.UseOfficeJsApiForLanguages=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.UseOfficeJsApiForLanguages",!1)).toString();m.IsAddToDocumentCallbackEnabled=(!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.Transcribe.IsAddToDocumentCallbackEnabled",
!1)).toString();m.Audience=this.lqf();const da=Object.assign(new le.a,{taskPaneWidth:330,isResizable:!0,resizeMinWidth:330,resizeMaxWidth:920,isModernPane:!0,pS:WordEditorIntl.WordEditorStrings.L_TranscriptionPaneTitle,onTaskPaneClose:this.kwn,bS:m,sourceLocationOverrideResourceId:this.ljm()});return this.tua?(this.tua.initialized.then(()=>{da.bS.IsFreemiumUpsellEnabled=this.tua.isFreemiumUpsellEnabled.toString();da.bS.IsLicensedUser=this.tua.xGf.toString();this.c1h(da,!this.tua.isFreemiumUpsellEnabled||
this.tua.xGf)}),32):this.c1h(da,!0)}esf(){return Xa.a("isSharedUXDarkModeOn")?appChrome.api.isSharedUXDarkModeOn():!1}ljm(){return"DOGFOOD"==this.lqf()||"MICROSOFT"==this.lqf()?"Taskpane_Dogfood.Url":"Taskpane.Url"}c1h(d,m){this.c_a.Deo(m);if(d=this.ii.V5(vm.Fkc,d,!0))this.k_a.htm=!0;else return this.c_a.dfo(d),v.ULS.sendTraceTag(587309125,3011,10,"Failed to show Transcription pane."),this.rg.logKpiFailure({kpiName:this.wta,errorName:"FailedToShowPane"}),16;this.qkh.start();this.rg.logKpiSuccess({kpiName:this.wta});
return 32}ovm(d){if(1===d)return 32;v.ULS.sendTraceTag(51667735,3011,50,"User intended to close Transcription pane.");if(!this.ii)return v.ULS.sendTraceTag(51667736,3011,10,"Failed to close Transcription pane, null object of AppsForOfficeUiActor"),this.rg.logKpiFailure({kpiName:this.wta,errorName:"FailedToClosePane"}),16;this.ii.DCb(vm.Fkc);return 32}ejc(d,m,A,R,da){if(1===A)return 32;if(!this.ii)return v.ULS.sendTraceTag(51667737,3011,10,"Failed to QueryToggle Transcription pane, null object of AppsForOfficeUiActor"),
16;da&&(da[Je.a.On]=this.ii.J0(vm.Fkc));return 32}y9i(){console.log("refreshMinutes minified");Object(fm.b)()?this.hAb.ZEb():this.Jyb.ZEb()}}vm.Fkc="FA000000051";vm.WNo={topLevelKpiName:"TranscribeFeatureUsage",featureName:"Transcribe",crewAlias:"VoiceTransEngg",areaName:"ContentCreation"};Object(y.a)(vm,"TranscriptionAddIn",null,[850]);class kl{constructor(){this.type="EmbeddedTaskPaneProps";this.uniqueID=this.getContent=null;this.isSharedRuntimePane=!1;this.feedbackTaskPaneProps=this.addinSharingTaskPaneProps=
null}}Object(y.a)(kl,"WordAddInTaskPaneProps",null,[]);class Vo{constructor(){this.rightActionButtonProps=null;this.canBeShared=!0}}Object(y.a)(Vo,"AddinSharingProps",null,[]);class Hp{constructor(){this.type="AddinSharingTaskPaneProps";this.assetId=this.sharingLink=this.iconUrl="";this.copySuccessCallback=null}}Object(y.a)(Hp,"AddinSharingTaskPaneProps",null,[]);class rr{constructor(d){this.jxe="AppsForOfficeReactContainer";this.EZj="TaskPaneCloseBtn";this.xjk="TaskPaneRightActionButton";this.EXj=
"FA000000012";this.J3=d||Hh.a.instance;this.oo=new Fk.a;this.BBa=new Fk.a;this.BBa.add("FA000000012","Help");this.BBa.add("FA000000012.Help.GiveFeedback.Url","Feedback");this.BBa.add("FA000000002","Translator");this.BBa.add("FA000000006","Search");this.BBa.add("FA000000029","Editor");this.BBa.add("FA000000085","AcronymsWeb");this.BBa.add(vm.Fkc,"Transcription")}JY(d){return this.oo.nb(d)?this.oo.J(d).isVisible:!1}LOa(d){const m=this.oo.J(d);m.isVisible&&(m.isVisible=!1,xh.UISurfaces.Pu().then(A=>
{A.hideTaskPane(m.id,2);return null}))}D1n(d){this.oo.remove(d)}hac(d){return this.oo.nb(d)?this.oo.J(d).id:null}showTaskPane(d,m,A,R,da=null,Ea=null){this.J3.dPa();if(this.oo.nb(d))this.oo.J(d).pB.isPaneAutoOpened=A.isPaneAutoOpened,n.AFrameworkApplication.K&&n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.OcvFeedbackRefreshActivationInfo")&&this.Rcc(d)&&(this.oo.J(d).pB.settings.feedback=A.settings.feedback);else{var ib=document.createElement("div");ib.className=this.jxe;
ib.id=this.jxe+A.id;A.div=ib;ib=String.format("AppForOfficePanel{0}",this.oo.count);let Qb;for(const pc of this.oo.keys)if(Qb=this.oo.J(pc),Qb.id==ib){ib=String.format("AppForOfficePanel{0}|{1}",this.oo.count,A.id);break}this.oo.add(d,Object.assign(new Jn,{id:ib,title:m,pB:A,isVisible:!1,hob:Ea,Hnb:da,yWd:!1}))}this.qad(d,R)}Phm(d){return this.oo.nb(d)?this.oo.J(d).pB.backgroundState:dk.inactive}kpo(d,m){this.oo.nb(d)&&(this.oo.J(d).pB.backgroundState=m)}dVd(d){return this.oo.nb(d)?this.oo.J(d).pB:
null}jom(d,m){m===OSF.AgaveHostAction.TabExitShift?this.vPd(d):m===OSF.AgaveHostAction.TabExit&&(d=this.oo.J(d),this.isResizable(d)?xh.UISurfaces.Pu().then(A=>{A.focusResizeHandle();return null}):Ib.FocusManager.instance().a$c(hp.a.enc))}tEl(d){if(this.BBa.nb(d))return this.BBa.J(d);for(const m of this.BBa.keys)if(!d.indexOf(m))return this.BBa.J(m);return null}vPd(d){(d=this.oo.J(d).cSb)&&d.querySelector("[data-unique-id^='"+this.EZj+"']").focus()}getContent(d){return()=>this.oo.J(d).pB.div}NMl(d){return this.oo.J(d).pB}getAssetId(d){const m=
this.oo.J(d).pB,A=/^WA\d{9}/i;let R;A.test(m.ownerAddinSolutionId)?R=A.exec(m.ownerAddinSolutionId)[0]:A.test(m.solutionId)?R=A.exec(m.solutionId)[0]:A.test(m.assetId)?R=A.exec(m.assetId)[0]:A.test(m.storeId)?R=A.exec(m.storeId)[0]:A.test(d)&&(R=A.exec(d)[0]);return R}fji(d,m,A,R){return()=>{ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Extensibility.Host.AddinSharing",dataFields:[{name:"AssetId",string:Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,m,null,null,
d.storeId)},{name:"ActionType",string:A},{name:"CorrelationId",string:R}]}))}}qad(d,m){const A=this.oo.J(d).id,R=da=>{da=this.oo.J(da).cSb.querySelector("[data-unique-id^='"+this.xjk+"']");this.Orb(da)};xh.UISurfaces.Pu().then(da=>{m?da.doNotUse_InitializePersistedTaskPane(A,this.xA(d,m)):(this.oo.J(d).isVisible?da.setSelectedTaskPane(A):da.showTaskPane(A,this.xA(d)),this.oo.J(d).pB.isPaneAutoOpened||(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",
!1)?this.Rcc(d)?(da=document.getElementById(this.oo.J(d).cSb.id),Ib.FocusManager.kK(da)):(da=document.getElementById(this.oo.J(d).pB.id),Ib.FocusManager.kK(da.contentWindow)):(da=document.getElementById(this.oo.J(d).pB.id),Ib.FocusManager.kK(da.contentWindow))),n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowAddInSharingTeachingCalloutIsEnabled",!1)&&R(d));return null})}Orb(d){const m=Ia.a.instance.Sa("Common.ISystemInitiatedFeedback");m&&
d?(d.setAttribute("lpp-id","addInTaskPaneShareButton"),m.execute(A=>{A.logActivity("ShowTeachingCalloutForAddinSharingButton",null);v.ULS.sendTraceTag(526989395,341,50,"triggerLPPActivity triggered an LPP activity")})):v.ULS.sendTraceTag(526989394,341,15,"triggerLPPActivity failed to get a sifFuture")}xA(d,m=!1){var A=new kl;A.getContent=this.getContent(d);A.uniqueID=this.tEl(d);const R=this.oo.J(d);R.pB.sharedRuntimeId&&(A.isSharedRuntimePane=!0);var da=this.getAssetId(d);const Ea=this.NMl(d),ib=
Rh.a.create().guid.toString();da&&(A.addinSharingTaskPaneProps={type:"AddinSharingTaskPaneProps",iconUrl:this.oo.J(d).iconUrl,sharingLink:`https://appsource.microsoft.com/product/office/${da}?ocid=PROD_OfficeApps_CONS_OCMA_ACQ_OfficeOnline_shareViaLinkOnWacWord&correlationId=${ib}`,assetId:da,copySuccessCallback:this.fji(Ea,da,"copy",ib)});const Qb=new Vo;Qb.canBeShared=!!da;Qb.rightActionButtonProps=da?{onExecute:this.fji(Ea,da,"share",ib)}:void 0;A=Object.assign(new Jm.a,Qb,{title:this.oo.J(d).title,
iconUrl:this.oo.J(d).iconUrl,hideHeader:!1,width:this.oo.J(d).pB.taskPaneWidth,location:2,contentProps:A,isModernPane:R.pB.isModernPane,onOpen:pc=>{m||(R.isVisible=!0);this.oo.J(d).cSb=pc;sf.StaticActiveAppFrame.za().updateCommandUI()},onClose:()=>{if(!m){R.yWd=!1;const pc=R.hob;pc&&pc(d);R.isVisible=!1}sf.StaticActiveAppFrame.za().updateCommandUI()},onCloseButtonTabKeyDown:pc=>{if(R.Hnb){const Pc=pc.shiftKey?OSF.AgaveHostAction.TabInShift:OSF.AgaveHostAction.TabIn;Pc===OSF.AgaveHostAction.TabIn?
n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",!1)?this.Rcc(d)?(pc=document.getElementById(this.oo.J(d).cSb.id),Ib.FocusManager.kK(pc)):(pc.preventDefault(),R.Hnb(d,Pc)):(pc.preventDefault(),R.Hnb(d,Pc)):R.yWd||(pc.preventDefault(),xh.UISurfaces.Pu().then(gd=>{this.nQi(gd,R,d,Pc);return null}))}},enableResize:R.pB.isResizable,minResizeWidth:R.pB.resizeMinWidth,maxResizeWidth:R.pB.resizeMaxWidth,isPaneAutoOpened:R.pB.isPaneAutoOpened||m});n.AFrameworkApplication.K&&
!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddingSharingIsEnabled",!1)&&(A.canBeShared=void 0,A.rightActionButtonProps=void 0,A.contentProps.addinSharingTaskPaneProps=void 0);n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OcvFeedbackvNextEnabled",!1)&&this.Rcc(d)&&(da=JSON.parse(R.pB.settings.feedback),da={...A.contentProps,type:"OcvFeedbackTaskPaneProps",hideHeader:!1,feedbackTaskPaneProps:{customerUiWrapperFeedbackData:da,taskPaneLocation:A.location,
taskPaneIdToClose:this.oo.J(d).id}},A.contentProps=da);n.AFrameworkApplication.K&&n.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.WordOnline.HeaderIconURL")&&"fa000000125"==d.toLowerCase()&&(A.iconId="fa000000125",A.headerIconUrl="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Blue.svg");return A}Rcc(d){return this.oo.nb(d)?"Help.GiveFeedback.Url"===this.oo.J(d).pB.sourceLocationOverrideResourceId:!1}aTb(d,m){this.oo.nb(d)&&
(this.oo.J(d).title=m,this.CIj(d))}Woe(d,m){this.oo.nb(d)&&(this.oo.J(d).iconUrl=m,this.CIj(d))}CIj(d){xh.UISurfaces.Pu().then(m=>{m.updateTaskPane(this.oo.J(d).id,this.xA(d));return null})}BIj(d,m){if(this.oo.nb(d)){const A=this.oo.J(d);A.yWd=!0;xh.UISurfaces.Pu().then(R=>{const da=this.xA(d);da.actionButtonProps=m;da.actionButtonProps.onTabKeyDown=Ea=>{Ea.shiftKey&&A.Hnb&&(Ea.preventDefault(),this.nQi(R,A,d,OSF.AgaveHostAction.TabInShift))};R.updateTaskPane(this.oo.J(d).id,da);return null})}}nQi(d,
m,A,R){2<=d.selectors.getTabbedTaskPaneCount()?d.focusTabbedTaskPaneArea():this.isResizable(m)?d.focusResizeHandle():m.Hnb(A,R)}lSc(d){return this.oo.nb(d)?this.oo.J(d).title:null}eji(d){return this.oo.nb(d)?this.oo.J(d).iconUrl:null}dispose(){}une(d){let m=null;d=d.toLowerCase();for(const A of this.oo.keys){let R=d;A.toLowerCase()!==this.EXj.toLowerCase()&&(R=d.substring(0,A.length));if(R===A.toLowerCase())return m=A,{returnValue:!0,qIc:m}}return{returnValue:!1,qIc:m}}bRc(d){return this.jxe+d}isResizable(d){return!!d&&
!!d.pB&&d.pB.isResizable}}Object(y.a)(rr,"ReactWordEditorAppsForOfficeUIManager",null,[930]);class Sm extends Ik{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd=null){super(d,m,A,R,da,Ea,ib,pc,gd);this.aKl={["fa000000059"]:!0,["FA000000002"]:!0};this.zud=new U.a;this.Qrl=()=>{for(const se of this.zud)this.JGn(se)};this.rZe=(se,Xe,Be)=>{if(2!==Be)return se!==Ac.a.wje||this.Hrj()?Cq.SessionStatusManager.instance.Yj||Dq.a.via(Xe.ik)?8:32:16;Xe=this.J0("FA000000002.Ogma.Document.Url")?"FA000000002.Ogma.Document.Url":
this.J0("FA000000002.Ogma.Settings.Url")?"FA000000002.Ogma.Settings.Url":"FA000000002.Ogma.Lookup.Url";se=se===Ac.a.vje?"Ogma.Cdn.Document.Url":se===Ac.a.wje?"Ogma.Cdn.Settings.Url":"Ogma.Cdn.Lookup.Url";Xe!=="FA000000002."+se&&this.J0(Xe)&&(v.ULS.sendTraceTag(39145870,399,50,"Closing Modern Translator task pane with Office CDN is used"),this.DCb(Xe));v.ULS.sendTraceTag(39145871,399,50,"Opening Modern Translator task pane with Office CDN is used");Xe={};Xe.Locale=n.AFrameworkApplication.K.kb("ModernTranslatorLocale");
Xe.SessionId=n.AFrameworkApplication.userSessionId;Xe.UserId=n.AFrameworkApplication.K.kb("ModernTranslatorLoggableUserId");Xe.MachineId=n.AFrameworkApplication.K.kb("ModernTranslatorMachineId");Xe.AugLoopUrl=n.AFrameworkApplication.K.kb("AugLoopCloudALServiceUrl");Xe.ReadingMode=2===Qq.WoncaApp.instance.aja?"true":"false";Xe.DocProtected=n.AFrameworkApplication.eZ?"true":"false";Xe.DisableEdit=!Ab.App.Fs||Ab.App.Cm||Ab.App.S0&&n.AFrameworkApplication.qv?"true":"false";Xe.DisableCopyCut=n.AFrameworkApplication.K.$("DisablePrint")&&
n.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")?"true":"false";Xe.Reason=(0).toString();Xe.UseGoToTranslatedDocument="true";Xe.MicrofeedbackWacEnabled=n.AFrameworkApplication.K.$("MicrofeedbackSurveyIsEnabled");Be=Ia.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");Xe.SettingsEnabled=Be?n.AFrameworkApplication.K.$("LanguageIntelligentSuggestionIsEnabled")&&void 0!==Be.GVa&&null!==Be.GVa&&""!==Be.GVa.trim()?"true":"false":"false";Be=new le.a;Be.bS=Xe;Be.sourceLocationOverrideResourceId=
se;Be.pS=WordEditorIntl.WordEditorStrings.L_ModernTranslatorTaskPaneTitle;Be.isModernPane=!0;se=n.AFrameworkApplication.K.$("LanguageTranslationIsEnabled");(se=this.V5("FA000000002",Be,se))||v.ULS.sendTraceTag(42074889,399,10,"Modern Translator task pane failed to display with Office CDN is used");return se?32:16};this.uce=(se,Xe,Be,Hg,Xh)=>{if(1===Be)return 32;se=this.J0("FA000000002.Ogma.Document.Url")||this.J0("FA000000002.Ogma.Lookup.Url");Xh&&(Xh[Je.a.On]=se);return 32};this.ONn=(se,Xe,Be,Hg,
Xh)=>{if(1===Be)return 32;Xh&&(Xh[Ii.a.Visible]=this.Hrj());return 32};this.azo=(se,Xe,Be)=>{if(2!==Be)return 32;this.ga.processAction(Ac.a.Rdj,2);se=new le.a;se.pS="Suggested Tasks (Preview)";return this.V5("FA000000030",se,!0)?32:16};this.jeo=(se,Xe)=>{mn.instance.bib(se,Xe)};this.hob=se=>{const Xe=this.ZV.vGb(se);yc.AppsForOfficeSingleSignOnManager.KVk(Xe);const Be=this.tUh(Xe)||this.oFf(Xe);Be&&this.xs.JY(se)&&mn.instance.dPd(Xe,!1);if(this.DNm(Xe)){const Hg=this.ZV.Qhm(Xe);Hg&&Hg()}this.o6a(Xe,
Be);this.xs.LOa(se);this.Vb.hS(this.Qvf(Xe))};this.Hnb=(se,Xe)=>{let Be=null;se&&(Be=this.ZV.vGb(se));if(!Be)return v.ULS.sendTraceTag(19138189,344,10,"Add-in instanceId not found when pressing {Tab} on close button."),!1;this.Et.notifyAgave(Be,Xe);this.Ksa=Be;return!0};this.ZV=Qb;this.BT=Pc;this.xs=Xd||new rr(Cd)}Ub(){super.Ub();this.ga.qa(Ac.a.oRb,K.a.frame,this.rZe);this.ga.qa(Ac.a.vje,K.a.frame,this.rZe);this.ga.qa(Ac.a.wje,K.a.frame,this.rZe);this.ga.qa(Ac.a.Dtj,ic.a.view,this.azo);this.ga.fb(Ac.a.uce,
ic.a.view,this.uce,96);this.ga.qa(Ac.a.Rdj,K.a.frame,wo.ActionManager.Nf);this.ga.fb(Ac.a.D6i,K.a.frame,this.ONn,96)}P3i(){const d=this.ndm();this.gfg(()=>{this.requestIdleCallback(this.Qrl,0)},Sm.xij);return d}ndm(){var d=!1;const m={};this.zud.clear();var A=n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.OEP.SdxAssetIdsToPreload","");if(!sa.a.o8(A)){d=!0;for(var R of A.split("_"))m[sa.a.eh(R)]=!0}if(d&&(A=this.rfi(),!lf.a.isEmpty(A))){R=Date.now()-6048E5;for(const da in A)d=da,
A[da]>R&&(m[sa.a.eh(d)]=!0)}if(!lf.a.isEmpty(m))for(const da in m)this.zud.add(da);return this.zud}JGn(d){switch(d){case Sm.p8b:this.IGn();break;case "FA000000002":this.KGn();break;default:this.v2f(d,new le.a)}}IGn(){const d=Object.assign(new le.a,{pS:"Experimentation SDX",taskPaneWidth:0});this.fjo(d);this.v2f(Sm.p8b,d)}KGn(){const d=Object.assign(new le.a,{sourceLocationOverrideResourceId:"Ogma.Cdn.Lookup.Url",sharedRuntimeId:"Ogma.Cdn.Lookup.Url"});this.v2f("FA000000002",d)}v2f(d,m){m.isPreload=
!0;this.gfg(()=>{this.requestIdleCallback(()=>{this.V5(d,m,!0)},0)},200)}fjo(d){d.sourceLocationOverrideResourceId=Sm.lkf;d.sharedRuntimeId=Sm.lkf}requestIdleCallback(d,m){let A=!1;try{window.self.requestIdleCallback(d)}catch(R){A=!0}A&&this.gfg(d,m)}gfg(d,m){m=new $a.a(2,1,m,()=>{d()});n.AFrameworkApplication.lc.Wb(m)}Hrj(){const d=Ia.a.instance.Oa("WordEditor.TranslatorRoamingServiceManager");return!!d&&d.lTm()}J0(d){return this.xs.JY(d)}LOa(d){let m=null;({qIc:m}=this.xs.une(d)).returnValue&&this.hob(m)}oFf(d){if(!d)return!1;
d=this.ytf(d);return!!d&&!!d.getSharedRuntimeId()}Cof(d){return this.xs.Phm(d)}Kkj(d,m){if(this.qhd&&this.Cof(d)!=m){var A=this.ZV.vGb(d);if(A=(A=this.ytf(A))?A.getSharedRuntimeId():null){var R=this.qhd.HQd(d);R?(R.sharedRuntimeId=A,R.backgroundState=m,this.qhd.Wgo(R),this.xs.kpo(d,m)):xk.Debug.oIk("No appRef in setAppTaskPaneBackgroundState.",544318937)}else xk.Debug.oIk("Not shared runtime in setAppTaskPaneBackgroundState.",544318859)}}dVd(d){return this.xs.dVd(d)}RNd(d,m,A){let R=null;return({qIc:R}=
this.xs.une(d)).returnValue?(d=this.ZV.vGb(R))?this.Tjf(d,m,A):!1:!1}Tjf(d,m,A){m=mn.instance.w9k(m,A);OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(d,m,this.jeo);return!0}KSn(d){let m="none";sa.a.o8(d)||(m=sa.a.eh(d.split(".")[0]));if(m in this.aKl){d=this.rfi();d[m]=Date.now();try{localStorage.setItem("_OSF_Word_Preload_FPA_List",JSON.stringify(d))}catch(A){}}}rfi(){let d={},m=null;try{m=localStorage.getItem("_OSF_Word_Preload_FPA_List")}catch(A){}sa.a.o8(m)||(d=JSON.parse(m));
return d}showTaskPane(d,m,A){let R=null;var da=({qIc:R}=this.xs.une(d)).returnValue,Ea=null;Ea=A.isPreload;const ib=A.isForUILessAction||sa.a.eh(d)===Sm.p8b;var Qb=!sa.a.o8(A.sharedRuntimeId);Ea?A.initialDisplayMode=1:(this.KSn(d),Qb&&(A.initialDisplayMode=ib?1:2));Qb&&(A.hostInfoFlags=1,m||(m=this.xs.lSc(d)));if(da){da=this.ZV.vGb(R);if(Qb=this.ytf(da))A.settings&&(Qb.setSettings(A.settings),Qb.setHostSettings(A.hostSettings)),m&&n.AFrameworkApplication.K.$("WordEditorAppsForOFficeRefreshTaskPaneTitleIsEnabled")&&
"Help.GiveFeedback.Url"!==A.sourceLocationOverrideResourceId&&this.xs.aTb(R,m);const pc=this.xs.JY(R),Pc=this.xs.hac(R);this.tUh(da)?(this.Grl(da)&&(v.ULS.sendTraceTag(50685986,344,50,"Reactivating app before showing because it's in an error state."),this.K7i(da)),pc||(this.xs.showTaskPane(R,m,A,Ea,null,this.hob),mn.instance.dPd(da,!0))):(pc||this.oFf(da))&&this.GIm(da)?Qb&&(Qb.isFirstParty()&&!this.oFf(da)&&Qb.refresh(),this.xs.showTaskPane(d,m,A,ib),mn.instance.dPd(da,!0)):(this.K7i(da),this.xs.showTaskPane(R,
m,A,ib,null,this.hob),mn.instance.dPd(da,!0));Ea=this.Vb.fe(Pc)}else n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")&&n.AFrameworkApplication.K.$("WordEditorTaskpaneUpgradeToAppCommandIsEnabled")&&!A.isAddinCommands&&(A.virtualOsfControlActivationCallback=()=>{this.hob(d);this.ZBj(A)}),this.xLh(d,m,A,ib||Ea),m=this.xs.hac(d),Ea=this.Vb.fe(m),this.soh(Ea,A.id);Ea?(Ea.mr(Im.KeyInputManager.ic(Wj.a.Kw,0)),Ea.mr(Im.KeyInputManager.ic(Wj.a.Kw,4))):v.ULS.sendTraceTag(36767389,344,10,"FocusScope should be initialized.");
ib||(this.Vb.mg(this.Vb.iU),this.Ksa=null);return!0}Nnh(d){const m=()=>{this.xs.LOa(d.solutionId);this.Vb.mg(this.Vb.iU);rj.a.instance.setItem("refreshRequired","true");this.ZBj(d);this.xs.D1n(d.solutionId)};let A=null;const R=d.solutionId;({qIc:A}=this.xs.une(R)).returnValue?this.xs.JY(A)||this.xs.showTaskPane(A,"",d,!1):(this.xs.showTaskPane(R,"",d,this.Lgf(R)),this.Hj.value.insertBlankControlWithErrorUX(this.B4c(d),m));this.Vb.mg(this.Vb.iU);this.Ksa=null}Jtj(d,m){const A=d.solutionId;this.xs.showTaskPane(A,
"",d,this.Lgf(A));this.Hj.value.insertBlankControlWithErrorUX(this.B4c(d),()=>{this.xs.LOa(d.solutionId);this.Vb.mg(this.Vb.iU);m()});this.Vb.mg(this.Vb.iU);this.Ksa=null}ZBj(d){var m={};m.solutionId=d.solutionId;m.version=d.version;m.storeType=d.storeType;m.storeId=d.storeId;m.assetId=d.assetId;m.assetStoreId=d.assetStoreId;m.targetType=OSF.OsfControlType.ContainerLevel;n.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")&&(m.sharedRuntimeId=d.sharedRuntimeId);d=new U.a;d.add(m);m=
{};m[Ye.a.JCd]=d;m[Ye.a.hOa]=3;this.ga.Qb(Q.a.LKb,2,m)}B4c(d){const m={};m.div=d.div;m.id=d.id;m.solutionId=d.solutionId;m.version=d.version;m.storeType=d.storeType;m.storeId=d.storeId;m.osfControlType=d.osfControlType;n.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")&&(m.sharedRuntimeId=d.sharedRuntimeId);return m}createUILessSandbox(d,m,A){this.Lgf(d)?(this.xLh(d,m,A,!0),d=this.xs.hac(d),d=this.Vb.fe(d),this.soh(d,A.id)):A.sharedRuntimeId?this.showTaskPane(d,m,A):(this.Onh(A),this.ZV.add(A,
d))}PPa(d){return this.ZV.vGb(d)}dispose(){super.dispose();this.xs.dispose()}ipc(d,m,A=null){if(m===OSF.AgaveHostAction.TabExit||m===OSF.AgaveHostAction.TabExitShift){if(A=this.IFb())3===A.yPc(d)?this.Hj.value.notifyAgave(d,OSF.AgaveHostAction.TabIn):(ld.a.Dj&&this.blur(),this.xs.jom(this.ZV.aQa(d),m))}else if(m===OSF.AgaveHostAction.EnableTaskPaneHeaderButton){const R=this.ZV.aQa(d);A=Object.assign(new Br,{label:A.Label,icon:A.Icon,onExecute:()=>{this.Kvn(R)}});this.xs.BIj(R,A)}else m===OSF.AgaveHostAction.DisableTaskPaneHeaderButton?
(A=this.ZV.aQa(d),this.xs.BIj(A,null)):m===OSF.AgaveHostAction.GetOriginalControlId?(d=A.controlId,m=new gf("",A.ownerAddinSolutionId,new ne,!0),A.originalControlId=null==m?d:m.UPh(d)):m===OSF.AgaveHostAction.PageIsReady?this.F9g&&this.F9g(d):super.ipc(d,m,A)}Qvf(d){d=this.ZV.aQa(d);return this.xs.hac(d)}IFb(){return this.ZV}lSc(d){return this.xs.lSc(d)}wth(d){if(d){var m=d.getSolutionId();d=d.getVersion();var A=this.xs.lSc(m);if(!A||""===A)if(A=OSF.OsfManifestManager.getCachedManifest(m,d)){let R=
null;const da=this.Hj.value.getAppUILocale();da&&""!==da&&(R=A.getDisplayName(da));R&&""!==R||(R=A.getDefaultDisplayName());this.xs.aTb(m,R)}A=this.xs.eji(m);if(!A||""===A)if(d=OSF.OsfManifestManager.getCachedManifest(m,d))d=d.getDefaultIconUrl(),this.xs.Woe(m,d)}}soh(d,m){d.sga(()=>{this.Ygo(m,ld.a.Dj)});d.bOa(()=>{this.$go(m)})}Grl(d){if(!this.Hj.value)return v.ULS.shipAssertTag(50685987,341,!1,"ContextActivationManager unavailable while trying to figure out if app is one of the error states: {0}",
d),!1;d=this.Hj.value.getOsfControlStatus(d);return d!==OSF.OsfControlStatus.Activated&&d!==OSF.OsfControlStatus.NotActivated}tUh(d){return this.JIm(d)}Lgf(d){return"FA000000029"===d}xLh(d,m,A,R){n.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&!OSF.OsfControl.isFirstPartyStoreString(A.storeType)?n.AFrameworkApplication.ta&&!n.AFrameworkApplication.ta.Kb.EY(22)&&(d=new X.a(CommonUIStrings.l_ThirdPartyAddinDisabledTitle,CommonUIStrings.l_ThirdPartyAddinDisabledMessage,null),d.id=22,
d.image=1,d.closeable=!0,n.AFrameworkApplication.ta.Kb.Vma(d,!0)||v.ULS.sendTraceTag(36962447,306,10,"Failed to add entry to business bar. Third party addin disabled message could not be shown to user.")):n.AFrameworkApplication.oOa||OSF.OsfControl.isFirstPartyStoreString(A.storeType)?(this.xs.showTaskPane(d,m,A,R,this.Hnb,this.hob),this.Onh(A),this.ZV.add(A,d)):(v.ULS.sendTraceTag(571860445,344,50,"Taskpane web add-in disabled by doc IRM"),n.AFrameworkApplication.ta&&!n.AFrameworkApplication.ta.Kb.EY(36)&&
(d=new X.a(CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle,CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage,null),d.id=36,d.image=1,d.closeable=!0,n.AFrameworkApplication.ta.Kb.Vma(d,!0)||v.ULS.sendTraceTag(573388438,306,10,"Failed to add entry to business bar. CLP protected doc addins disabled message could not be shown to user.")))}bRc(d){return this.xs.bRc(d)}Kvn(d){let m=null;d&&(m=this.ZV.vGb(d));m?(this.Et.notifyAgave(m,OSF.AgaveHostAction.TaskPaneHeaderButtonClicked),this.Ksa=
m):v.ULS.sendTraceTag(50738267,344,10,"Add-in instanceId not found when clicking on TaskPaneAction button.")}JIm(d){d=this.ZV.qqf(d);return!!d&&"FA000000029"===d.Qn}DNm(d){d=this.ZV.qqf(d).storeType.toLowerCase();return d===OSF.StoreType.FirstParty.toLowerCase()||d===OSF.StoreType.Sdx.toLowerCase()}ytf(d){return this.Hj.value?this.Hj.value.getOsfControl(d):null}aTb(d,m){this.xs.hac(d);this.xs.lSc(d)!==m&&this.xs.aTb(d,m)}Woe(d,m){this.xs.hac(d);this.xs.eji(d)!==m&&this.xs.Woe(d,m)}}Sm.p8b="fa000000059";
Sm.lkf="FA59SharedRuntime.Url";Sm.xij=1E4;Object(y.a)(Sm,"WordEditorAppsForOfficeUIActor",Ik,[]);class Hl{constructor(d,m){this.ii=d;this.ii.v0e(Object(I.a)(this,this.YYk,"clearHandlersForApp"));this.I2j=m}get Mjf(){return this.I2j}r9b(d){v.ULS.shipAssertTag(5902748,341,!!this.Mjf);let m;return({value:m}=this.Mjf.Fc(d)).returnValue?m:null}YYk(d,m){for(let A of this.Mjf)A.value&&A.value.removeHandler(m,null)}}Object(y.a)(Hl,"ApiEventStore",null,[1256]);var Xl=c(634),Tm;(function(d){d[d.Tkp=1]="getSelectedDataAsync";
d[d.vsp=2]="setSelectedDataAsync";d[d.ifp=3]="addAppBindingFromSelectionAsync";d[d.hfp=4]="addAppBindingFromNamedItemAsync";d[d.Ikp=5]="getDataAsync";d[d.ssp=6]="setDataAsync";d[d.Ufp=7]="bindingSelectionChangedEvent";d[d.Jkp=8]="getFileAsync";d[d.nfp=9]="addTableBindingRowsAsync";d[d.mfp=10]="addTableBindingColumnsAsync";d[d.Uhp=11]="deleteAllDataValuesAsync";d[d.Ckp=12]="getAllAsync";d[d.Fkp=13]="getByIdAsync";d[d.Kqp=14]="releaseByIdAsync";d[d.Zkp=15]="goToByIdAsync";d[d.sPi=16]="messageParent";
d[d.ksp=17]="sendMessageToDialog";d[d.getAccessToken=18]="getAccessToken";d[d.Tfp=19]="bindingDataChangedEvent";d[d.mip=20]="displayRibbonCalloutAsync";d[d.xsp=21]="setTextAsync";d[d.jfp=22]="addCustomXmlNodeAsync"})(Tm||(Tm={}));Object(y.b)("ApiName",Tm);const yk=(d,m,A,R=null)=>{R||(R={});R.ApiName=Tm[d];R.ApiCode=d;R.AppId=m;R.Result=A;v.ULS.sendTraceTag(17131735,341,50,"{0}",R)};class Eq extends rl{constructor(){super();this.DI=this.zo=null;this.XVf=(d,m)=>{m.me&&(d=this.rX.KQl(m.me),this.ZPh=
this.rX.JOl(d),this.QA())};this.ZPh=new U.a}get rX(){this.zo||(this.zo=Ia.a.instance.Oa("WordEditor.AppsForOffice.IAppBindingHelper"));return this.zo}set rX(d){this.zo=d}get M0a(){this.DI||(this.DI=Ia.a.instance.Oa("Box4.IContentControlDataChangedManager"));return this.DI}set M0a(d){this.DI=d}addHandler(d,m,A,R=null){this.M0a&&this.rX?this.rX.Xvi?(this.wg.count||this.M0a.addHandler(Xl.a.YOb,this.XVf),this.wg.Z(this.V_a(d,R),m),this.rX.s3d(d,R,"Binidng.AddHandler for BindingDataChangedEvent"),this.sG(A)):
this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,m,A=null){this.M0a&&this.rX?this.rX.Xvi?A?this.rX.VQc(this.wg,this.V_a(d,A))?(this.wg.remove(this.V_a(d,A)),this.wg.count||this.M0a.removeHandler(Xl.a.YOb,this.XVf),this.rX.s3d(d,A,"Binidng.RemoveHandler for BindingDataChangedEvent"),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.c8f(d,m):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}X6i(d,m=null){if(this.rX&&(d=this.rX.VQc(this.wg,this.V_a(d,m)))){const A={};A[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=m;m={};m[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=A;d(m)}}c8f(d,m){if(this.M0a){const A=new U.a;for(const R of this.wg.keys)R.startsWith(d)&&A.add(R);for(const R of A)this.wg.remove(R);this.wg.count||this.M0a.removeHandler(Xl.a.YOb,this.XVf);this.sG(m)}else this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}V_a(d,
m){return d+"-"+m}QA(){for(const d of this.ZPh){const m=d[Ne.j3b],A=d[Ne.rDd],R=d[OSF.DDA.Marshaling.AppBindingKeys.BindingId];let da=this.rX.W6h(A);da=da?da:new U.a;da.add(m);for(const Ea of da)this.X6i(Ea,R),yk(19,A,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}static get instance(){return null!=Eq.ZBg?Eq.ZBg:Eq.ZBg=new Eq}}Object(y.a)(Eq,"BindingDataChangedEvent",rl,[]);class Mo extends rl{constructor(d){super();this.gBa=this.zo=null;this.uhc=()=>{this.ejj=this.rX.Jdm();this.gBa?this.Ib.ff(this.gBa):
this.gBa=new $a.a(4,1,Mo.eLk,()=>{this.gBa=null;this.QA()});this.Ib.Wb(this.gBa)};this.Ib=d;this.ejj=new U.a}get rX(){this.zo||(this.zo=Ia.a.instance.resolve("WordEditor.AppsForOffice.IAppBindingHelper"));return this.zo}set rX(d){this.zo=d}addHandler(d,m,A,R=null){this.Sf?(this.wg.count||this.Sf.Trh(this.uhc),this.wg.Z(this.V_a(d,R),m),this.rX.s3d(d,R,"Binidng.AddHandler for bindingSelectionChangedEvent"),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,
m,A=null){A?this.Sf&&this.VQc(this.wg,this.V_a(d,A))?(this.wg.remove(this.V_a(d,A)),this.wg.count||this.Sf.j9f(this.uhc),this.rX.s3d(d,A,"Binidng.RemoveHandler for bindingSelectionChangedEvent"),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.c8f(d,m)}c8f(d,m){if(this.Sf){const A=new U.a;for(const R of this.wg.keys)R.startsWith(d)&&A.add(R);for(const R of A)this.wg.remove(R);this.wg.count||this.Sf.j9f(this.uhc);this.sG(m)}else this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}V_a(d,
m){return d+"-"+m}QA(){for(const A of this.ejj){var d=A[Ne.j3b];const R=A[Ne.rDd],da=A[OSF.DDA.Marshaling.AppBindingKeys.BindingId]?A[OSF.DDA.Marshaling.AppBindingKeys.BindingId]:null,Ea=A[OSF.DDA.Marshaling.AppBindingKeys.BindingType]?A[OSF.DDA.Marshaling.AppBindingKeys.BindingType]:null;var m=this.rX.W6h(R);m=m?m:new U.a;m.add(d);for(const ib of m)if(d=this.VQc(this.wg,this.V_a(ib,da))){yk(7,R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,{["BindingType"]:Ea});m={};m[OSF.DDA.Marshaling.AppBindingKeys.BindingId]=
da;m[OSF.DDA.Marshaling.AppBindingKeys.BindingType]=Ea;const Qb={};Qb[OSF.DDA.Marshaling.AppBindingKeys.BindingEventSource]=m;Ea===Zc.table&&(Qb[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]=A[OSF.DDA.Marshaling.TableSubsetKeys.TableSubset]);d(Qb)}}}VQc(d,m){if(d.nb(m))return d.J(m);const A=RegExp("\t","g");for(const R of d)if(R.key.replace(A," ")===m)return R.value;return null}static get instance(){return null!=Mo.dCg?Mo.dCg:Mo.dCg=new Mo(n.AFrameworkApplication.lc)}}Mo.eLk=100;Object(y.a)(Mo,
"BindingSelectionChangedEvent",rl,[]);const sr=(d,m,A)=>{for(const R of m.keys)-1<R.indexOf(d)&&m.J(R)(A)};class Vq extends rl{constructor(){super();this.d$g=this.Trn=(d,m)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=m.JXd;d[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=m.ITi;d[OSF.DDA.Marshaling.DataNodeEventProperties.NextSiblingNode]=m.oop;sr(m.E6b,this.wg,d)}}addHandler(d,m,A,R){this.Sf&&R?(this.wg.count||this.Sf.D6b.s_e(Ng.YWi,this.d$g),this.wg.Z(d+"-"+R,m),v.ULS.sendTraceTag(19489929,
341,50,"Add handler for nodeDeleted event on custom xml file whose id is: {0}.",R),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,m,A){d=d+"-"+A;this.Sf&&A&&this.wg.nb(d)?(this.wg.remove(d),this.wg.count||this.Sf.D6b.y8f(Ng.YWi,this.d$g),v.ULS.sendTraceTag(19489930,341,50,"Remove handler for nodeDeleted event on custom xml file whose id is: {0}.",A),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}QA(){}static get instance(){return null!=
Vq.YCg?Vq.YCg:Vq.YCg=new Vq}}Object(y.a)(Vq,"DataNodeDeletedEvent",rl,[]);class No extends rl{constructor(){super();this.e$g=this.Urn=(d,m)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=m.JXd;d[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=m.LTf;sr(m.E6b,this.wg,d)}}addHandler(d,m,A,R){this.Sf&&R?(this.wg.count||this.Sf.D6b.s_e(Ng.ZXf,this.e$g),this.wg.Z(d+"-"+R,m),v.ULS.sendTraceTag(19489931,341,50,"Add handler for nodeInserted event on custom xml file whose id is: {0}.",
R),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,m,A){d=d+"-"+A;this.Sf&&A&&this.wg.nb(d)?(this.wg.remove(d),this.wg.count||this.Sf.D6b.y8f(Ng.ZXf,this.e$g),v.ULS.sendTraceTag(19489932,341,50,"Remove handler for nodeInserted event on custom xml file whose id is: {0}.",A),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}QA(){}static get instance(){return null!=No.UCg?No.UCg:No.UCg=new No}}Object(y.a)(No,"DataNodeInsertedEvent",
rl,[]);class Jk extends rl{constructor(){super();this.f$g=this.Vrn=(d,m)=>{d={};d[OSF.DDA.Marshaling.DataNodeEventProperties.InUndoRedo]=m.JXd;d[OSF.DDA.Marshaling.DataNodeEventProperties.OldNode]=m.ITi;d[OSF.DDA.Marshaling.DataNodeEventProperties.NewNode]=m.LTf;sr(m.E6b,this.wg,d)}}addHandler(d,m,A,R){this.Sf&&R?(this.wg.count||this.Sf.D6b.s_e(Ng.bYf,this.f$g),this.wg.Z(d+"-"+R,m),v.ULS.sendTraceTag(19489933,341,50,"Add handler for nodeReplaced event on custom xml file whose id is: {0}.",R),this.sG(A)):
this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,m,A){d=d+"-"+A;this.Sf&&A&&this.wg.nb(d)?(this.wg.remove(d),this.wg.count||this.Sf.D6b.y8f(Ng.bYf,this.f$g),v.ULS.sendTraceTag(19489934,341,50,"Remove handler for nodeReplaced event on custom xml file whose id is: {0}.",A),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}QA(){}static get instance(){return null!=Jk.bCg?Jk.bCg:Jk.bCg=new Jk}}Object(y.a)(Jk,"DataNodeReplacedEvent",rl,[]);class V extends rl{constructor(d){super();
this.TXf=(m,A)=>{this.wg.nb(A.controlId)&&(m={},m[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=A.messageType,m[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=A.messageContent,m[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=A.dQf,m[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=A.S8a,this.wg.J(A.controlId)(m),A.messageType===OSF.DialogMessageType.DialogClosed&&(this.wg.remove(A.controlId),this.wg.count||
this.Sf.cJa.u1a.ncj(this.TXf)))};this.sta=d}addHandler(d,m,A,R=null){if(this.sta)if(this.Sf){v.ULS.sendTraceTag(19787875,341,50,"DialogMessageReceivedEvent.AddHandler called!");const da=Ea=>{Ea===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.wg.count||this.Sf.cJa.u1a.Fyk(this.TXf),this.wg.Z(d,m),this.sG(A)):(Ea!==OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains&&v.ULS.sendTraceTag(19787904,341,10,"DialogMessageReceivedEvent.AddHandler failed!"),this.Wq(A,Ea))};this.wg.nb(d)?da(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):
this.Sf.cJa.showDialog(d,R,da)}else this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,m){this.sta?this.Sf&&this.wg.nb(d)?(v.ULS.sendTraceTag(19787905,341,50,"DialogMessageReceivedEvent.RemoveHandler called!"),this.Sf.cJa.mva(d,A=>{this.wg.remove(d);this.wg.count||this.Sf.cJa.u1a.ncj(this.TXf);A===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.sG(m):(v.ULS.sendTraceTag(19787906,341,10,"DialogMessageReceivedEvent.RemoveHandler failed!"),
this.Wq(m,A))})):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}QA(){}static get instance(){const d=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return V._instance||(V._instance=new V(d))}}V._instance=null;Object(y.a)(V,"DialogMessageReceivedEvent",rl,[]);class qa extends rl{constructor(d){super();this.sta=d}addHandler(d,m,A){if(this.sta)if(this.Sf){v.ULS.sendTraceTag(19787907,
344,50,"DialogNotificationShownInAddinEvent.AddHandler called!");try{const R=this.Sf.cJa.hJa(d);R===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.sG(A):this.Wq(A,R)}catch(R){v.ULS.sendTraceTag(19787908,344,10,"DialogNotificationShownInAddinEvent.AddHandler failed. Error message: {0}.",R.message),this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,
m){if(this.sta)if(this.Sf){v.ULS.sendTraceTag(19787909,344,50,"DialogNotificationShownInAddinEvent.RemoveHandler called!");try{const A=this.Sf.cJa.YFa(d);A===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.sG(m):this.Wq(m,A)}catch(A){v.ULS.sendTraceTag(19787910,344,10,"DialogNotificationShownInAddinEvent.RemoveHandler failed. Error message: {0}.",A.message),this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}else this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else this.Wq(m,
OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}QA(){}static get instance(){const d=n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return qa._instance||(qa._instance=new qa(d))}}qa._instance=null;Object(y.a)(qa,"DialogNotificationShownInAddinEvent",rl,[]);class pb extends rl{constructor(d){super();this.IWi=(m,A)=>{this.wg.nb(A.controlId)&&(m={},m[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=A.messageType,
m[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=A.messageContent,m[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=A.dQf,m[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=A.S8a,this.wg.J(A.controlId)(m))};this.sta=d}addHandler(d,m,A){this.sta?this.Sf?(v.ULS.sendTraceTag(595130066,341,50,"DialogParentMessageReceivedEvent.AddHandler called!"),this.wg.count||this.Sf.cJa.u1a.Eyk(this.IWi),this.wg.Z(d,m),this.sG(A)):
this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,m){this.sta?this.Sf&&this.wg.nb(d)?(v.ULS.sendTraceTag(595130065,341,50,"DialogParentMessageReceivedEvent.RemoveHandler called!"),this.wg.remove(d),this.wg.count||this.Sf.cJa.u1a.x2n(this.IWi),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}QA(){}static get instance(){const d=
n.AFrameworkApplication.K?n.AFrameworkApplication.K.$("WordEditorAppsForOfficeShowDialogApiIsEnabled"):!1;return pb._instance||(pb._instance=new pb(d))}}pb._instance=null;Object(y.a)(pb,"DialogParentMessageReceivedEventWord",rl,[]);class ec extends rl{constructor(d){super();this.gBa=null;this.uhc=()=>{this.gBa?this.Ib.ff(this.gBa):this.gBa=new $a.a(4,1,ec.Asl,()=>{this.gBa=null;this.QA()});this.Ib.Wb(this.gBa)};this.Ib=d}addHandler(d,m,A){this.Sf?(this.wg.count||this.Sf.Trh(this.uhc),this.wg.Z(d,
m),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(d,m){this.Sf&&this.wg.nb(d)?(this.wg.remove(d),this.wg.count||this.Sf.j9f(this.uhc),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}QA(){for(const d of this.wg.values)d&&d({})}static get instance(){return null!=ec.lCg?ec.lCg:ec.lCg=new ec(n.AFrameworkApplication.lc)}}ec.Asl=100;Object(y.a)(ec,"DocumentSelectionChangedEvent",rl,[]);class Hc extends rl{constructor(d,m,A,R){super();
this.lrc=null;this.OYi=(da,Ea)=>{if(Ea)if(da=Ea.node,!da)v.ULS.sendTraceTag(22024347,341,10,"node is null");else{if(47===da.type&&21===Ea.yEh){if((Ea=this.Yc.Rf(da))&&Ea.Tb(21))for(;Ea.Lf(21););Ea=new U.a;this.z6&&(Ea=da.getValue(wc.a.kfb),Ea=this.z6.nbi(Ea));Ea.add(da.id.toString());for(const ib of Ea)this.wg.nb(ib)&&(da=this.wg.J(ib))&&da({})}}else v.ULS.sendTraceTag(22024346,341,10,"TopologyChangedEventArgs is null")};d&&(this.lrc=d.Te(47));this.Yc=m;this.tgh=R;this.z6=A}addHandler(d,m,A){this.tgh?
this.lrc?(this.wg.count||this.lrc.krh(this.OYi),this.wg.Z(d,m),this.sG(A)):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Wq(A,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}removeHandler(d,m){this.tgh?this.lrc&&this.wg.nb(d)?(this.wg.remove(d),this.wg.count||this.lrc.acj(this.OYi),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)}QA(){}static get instance(){try{const d=
!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");return Hc._instance||(Hc._instance=new Hc(Ab.App.li.Al,new xi.a,Ia.a.instance.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d))}catch(d){return v.ULS.sendTraceTag(22024348,341,10,"Failed to get SettingsChangedEvent Instance: {0}.",d),null}}}Hc._instance=null;Object(y.a)(Hc,"SettingsChangedEvent",rl,[]);class bd extends rl{QA(){throw Error("Method not implemented.");}constructor(d){super();
this.Hj=d}addHandler(d,m,A){this.wg.count||this.Hj.value.setOfficeThemeChangedHandler(this.$rn);this.wg.Z(d,m);this.sG(A)}$rn(d){for(const m of bd._instance.wg.values)m&&m(d)}removeHandler(d,m){this.wg.nb(d)?(this.wg.remove(d),this.sG(m)):this.Wq(m,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){try{return bd._instance||(bd._instance=new bd(Ia.a.instance.Ve("Common.App.AppsForOfficeCommon.IContextActivationManager")))}catch(d){return v.ULS.sendTraceTag(512300628,341,10,
"Failed to get OfficeThemeChangedEvent Instance: {0}.",d),null}}}bd._instance=null;Object(y.a)(bd,"OfficeThemeChangedEvent",rl,[]);class vd extends Hl{constructor(d,m,A){super(d,m);this.eEe=A}r9b(d){if(d=super.r9b(d))d.Sf=this.eEe;return d}static Oal(d,m){const A=new ke.a;A.Z(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,ec.instance);A.Z(OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent,Mo.instance);A.Z(OSF.DDA.EventDispId.dispidBindingDataChangedEvent,Eq.instance);A.Z(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,
V.instance);A.Z(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,pb.instance);A.Z(OSF.DDA.EventDispId.dispidDataNodeAddedEvent,No.instance);A.Z(OSF.DDA.EventDispId.dispidDataNodeReplacedEvent,Jk.instance);A.Z(OSF.DDA.EventDispId.dispidDataNodeDeletedEvent,Vq.instance);A.Z(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,qa.instance);A.Z(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Hc.instance);A.Z(OSF.DDA.EventDispId.dispidRichApiMessageEvent,mn.instance);A.Z(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,
bd.instance);return new vd(d,A,m)}}Object(y.a)(vd,"WordEditorEventStore",Hl,[]);class Fd{constructor(){this.Jbk=new Pd.a(()=>this.tFn())}get xPi(){return this.Jbk.value}Aof(d){v.ULS.shipAssertTag(5902749,341,!!this.xPi);let m;return({value:m}=this.xPi.Fc(d)).returnValue?m():null}}Object(y.a)(Fd,"ApiMethodFactory",null,[1254]);class Ae{constructor(d,m,A){this.customizedActionDic=this.nk=this.controlId=null;this.parameters=d;this.callback=m;this.EAk=A;this.Mp={};this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get errorCode(){return this.ze}get result(){return this.Mp}go(){this.execute();
this.wo()}execute(){}wo(){this.callback&&(this.result.Error=this.errorCode,this.callback(this.result))}}Object(y.a)(Ae,"ApiMethod",null,[]);class Yf extends Ae{constructor(){super();this.Sf=null}static LJd(d){const m=new Yf;m.ze=d;return m}}Object(y.a)(Yf,"LiveBooksApiMethod",Ae,[]);class tf extends Yf{constructor(d){super();this.sta=d}go(){let d;this.sta?this.Sf?(this.Sf.cJa.sendMessage(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[Ye.a.$0e],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),
d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.Ueo(d)}Ueo(d){this.ze=d;this.wo()}}Object(y.a)(tf,"SendMessageMethod",Yf,[]);var gh=c(1834);class Te extends Yf{constructor(d){super();this.ii=d}go(){var d=this.ii.Et.getOsfControl(this.controlId);if(!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||d.isFirstParty()){d=d.getManifest();
var m=d.getMarketplaceID(),A=d.getWebApplicationId(),R=d.getWebApplicationMsaId();Ia.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(m).then(da=>{this.ze=0;const Ea={};Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=da.upn;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=da.userId;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=A;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=R?R:A;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
da.authority;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=gh.a.O5h(da.authorityType);Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=da.isAnonymous;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=da.tenantId;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=da.supportsAuthToken;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ea;this.wo()},da=>{const Ea={},ib=new gh.a;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
ib.upn;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ib.userId;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=A;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=R?R:A;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ib.authority;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=gh.a.O5h(ib.authorityType);Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ib.isAnonymous;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
ib.tenantId;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ib.supportsAuthToken;Ea[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=da;this.ze=1;this.result[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ea;this.wo()})}}}Object(y.a)(Te,"GetAuthContextMethod",Yf,[]);class hf extends Ae{constructor(){super();this.Sf=null}static LJd(d){const m=new hf;m.ze=d;return m}}Object(y.a)(hf,"WordEditorApiMethod",Ae,[]);class Ph extends hf{constructor(d){super();
this.AW=d}go(){let d="";if(this.AW)if(this.Sf){var m=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(m[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]&&m[OSF.DDA.Marshaling.BindingParameterKeys.ItemName]){let A=null;m[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(A=m[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());d=m[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();this.ze=({fJ:m}=this.Sf.wrk(this.nk,A,m[OSF.DDA.Marshaling.BindingParameterKeys.ItemName].toString(),
d)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=m}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;yk(4,this.nk.Qn,this.errorCode,{["BindingType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(16795283,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,
["errMsg"]:"unexpected error to AddAppBindingFromNamedItem api"});this.wo()}}Object(y.a)(Ph,"AddAppBindingFromNamedItemMethod",hf,[]);class Jh extends hf{constructor(d){super();this.AW=d}go(){let d="";if(this.AW)if(this.Sf){var m=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(m[OSF.DDA.Marshaling.BindingParameterKeys.BindingType]){let A=null;m[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&(A=m[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString());d=m[OSF.DDA.Marshaling.BindingParameterKeys.BindingType].toString();
this.ze=({fJ:m}=this.Sf.xrk(this.nk,A,d)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=m}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;yk(3,this.nk.Qn,this.errorCode,{["BindingType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(16795285,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to AddAppBindingFromSelection api"});this.wo()}}Object(y.a)(Jh,"AddAppBindingFromSelectionMethod",hf,[]);class xg extends hf{constructor(d,m){super();this.RBa=d;this.Mk=m}execute(){if(this.RBa){var d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],m=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],A=this.Mk.lQa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.ze=void 0===A||null===A||A.builtIn?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:
A.wph(d,m)?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.wo()}}Object(y.a)(xg,"AddDataNamespaceMethod",hf,[]);const ri=(d,m,A)=>{let R=A.Qn||"00000000-0000-0000-0000-000000000000";A=A.fN?A.fN:A;A.storeType&&A.store&&A.Qn&&(R=Telemetry.PrivacyRules.GetPrivacyCompliantId(A.Qn,A.storeType,null,null,null,null));v.ULS.sendTraceTag(509368257,341,10,"{0}",{["ApiCode"]:d,
["AppId"]:R,["Result"]:m});m!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&v.ULS.sendTraceTag(509368256,341,10,"{0}",{["error"]:m,["apiName"]:d,["appId"]:R})};class Lj extends hf{constructor(d,m,A){super();this.RBa=d;this.Mk=m;this.fpd=A}execute(){if(this.RBa){var d=null;this.ze=({C1c:d}=this.Mk.UZe(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml])).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){const m={};m[OSF.DDA.Marshaling.DataPartProperties.Id]=
"{"+d.id.guid.toString().toUpperCase()+"}";m[OSF.DDA.Marshaling.DataPartProperties.BuiltIn]=!1;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=m}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.fpd&&ri(22,this.errorCode,this.nk);this.wo()}}Object(y.a)(Lj,"AddDataPartMethod",hf,[]);class tn extends hf{constructor(d){super();this.oqh=m=>{this.ze=m;this.NY();this.wo()};this.AW=d}go(){if(this.AW)if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];
if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&d[OSF.DDA.Marshaling.SetDataKeys.Data]){var m=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let A,R;0<d[OSF.DDA.Marshaling.SetDataKeys.Data].length?(A=null,d=d[OSF.DDA.Marshaling.SetDataKeys.Data],R=!1):(d=d[OSF.DDA.Marshaling.SetDataKeys.Data],A=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableHeaders],d=d[OSF.DDA.Marshaling.TableBindingParameterKeys.TableRows],R=!0);this.Sf.QZe(m,this.nk,A,d,R,this.oqh);return}m=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else m=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else m=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.oqh(m)}NY(){yk(10,this.nk.Qn,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(17580612,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to AddTableBindingColumnsAsync API"})}}Object(y.a)(tn,"AddTableBindingColumnsMethod",hf,[]);class xl extends hf{constructor(d){super();this.pqh=
m=>{this.ze=m;this.NY();this.wo()};this.AW=d}go(){if(this.AW)if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.AddRowsColumns];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]&&d[OSF.DDA.Marshaling.SetDataKeys.Data]){this.Sf.K_e(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.nk,d[OSF.DDA.Marshaling.SetDataKeys.Data],this.pqh);return}d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
this.pqh(d)}NY(){yk(9,this.nk.Qn,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(17580613,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to AddTableBindingRowsAsync API"})}}Object(y.a)(xl,"AddTableBindingRowsMethod",hf,[]);class ll extends hf{constructor(){super()}execute(){try{OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[Ye.a.lAk][Ye.a.kAk],this.parameters),this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(d){v.ULS.sendTraceTag(17306273,341,10,"AppCommandInvocationCompletedMethod: unexpected exception {0}",d.message),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}this.wo()}}Object(y.a)(ll,"AppCommandInvocationCompletedMethod",hf,[]);class Um extends hf{constructor(){super()}go(){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;v.ULS.shipAssertTag(20854624,341,!!this.Sf.xFa);if(this.Sf&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&
null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]){const m=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle],A=this.Sf.xFa.n9h(this.controlId,m);if(A){var d=A.Xdc;if(A.XIf)this.ze=this.Sf.xFa.H$i(this.controlId,m),this.wo();else try{this.Sf.xFa.oeo(this.controlId,d,m,R=>{this.ze=R;this.wo()})}catch(R){v.ULS.sendTraceTag(20854625,341,15,"Error happens when send close document request. "+R.message)}}}}}Object(y.a)(Um,"CloseDocumentCopyMethod",hf,[]);class Vm extends hf{constructor(d,
m){super();this.RBa=d;this.Mk=m}execute(){this.ze=this.RBa?this.Mk.FRh(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]):OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.wo()}}Object(y.a)(Vm,"DeleteDataPartMethod",hf,[]);class Up extends hf{constructor(d){super();this.VRh=m=>{this.ze=m;this.NY();this.wo()};this.AW=d}go(){if(this.AW)if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id]){this.Sf.Gef(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),
this.nk,this.VRh);return}d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.VRh(d)}NY(){yk(11,this.nk.Qn,this.errorCode,null);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(17580614,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to deleteAllDataValuesAsync API"})}}Object(y.a)(Up,
"DeleteTableBindingRowsMethod",hf,[]);class ds extends hf{constructor(d,m){super();this.Mzl=(A,R)=>{this.ze=R;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=A);this.wo()};this.J9j=d;this.I9j=m}go(){if(this.J9j)if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.ArrayData];if(d)try{let m=this.nk.Qn||"00000000-0000-0000-0000-000000000000";if(this.I9j){const A=this.nk.fN?this.nk.fN:this.nk;A.storeType&&A.store&&
A.Qn&&(m=Telemetry.PrivacyRules.GetPrivacyCompliantId(A.Qn,A.storeType,null,null,null,null))}this.Sf.Ozl(d,m,this.controlId,this.nk,this.Mzl)}catch(m){v.ULS.sendTraceTag(17126306,344,10,"{0}",m.message),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.wo()}else v.ULS.sendTraceTag(9204821,344,10,"The rich api executor input parameter should not be null."),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.wo()}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
this.wo();else v.ULS.sendTraceTag(9291534,341,15,"The Rich App API feature is not enabled."),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,this.wo()}}Object(y.a)(ds,"ExecuteRichApiRequestMethod",hf,[]);var Wo=c(1764),si=c(1678);class dl{}dl.generalException="generalException";dl.invalidArgument="invalidArgument";dl.notAllowed="notAllowed";dl.apiNotAvailable="apiNotAvailable";dl.unresolvedPendingRequest="unresolvedPendingRequest";dl.timeout="timeout";dl.adalTimeout="adalTimeout";
dl.userNotSignedIn="userNotSignedIn";dl.userAborted="userAborted";dl.silentSignInFailed="silentSignInFailed";dl.invalidResourceUrl="invalidResourceUrl";dl.invalidGrant="invalidGrant";dl.connectionLost="connectionLost";dl.clientError="clientError";dl.serverError="serverError";Object(y.a)(dl,"WopiHostErrorCodes",null,[]);var qq=c(468);class hg{}Object(y.a)(hg,"OAuthCallerMetadata",null,[]);class Oo{constructor(d){this.P9=d;this.r2j=n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",
!1)}Gqk(d,m,A,R,da,Ea){if(!this.P9)return R=new Wo.a,R.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(R);const ib=new hg;ib.AddinName=da;ib.AddinTrustId=Ea;let Qb=-1;Ea=null;if(R&&this.Dzi())Ea=this.P9.dDj(Ye.a.ome,d,R,Oo.Kfi(da),ib);else{const pc=Date.now();Ea=this.P9.RV(Ye.a.ome,d,ib).then(Pc=>{Qb=Date.now()-pc;const gd=(m||A)&&"login_required"===Pc.ErrorCode;return(m&&("interaction_required"===Pc.ErrorCode||"consent_required"===Pc.ErrorCode||"invalid_grant"===Pc.ErrorCode)||
gd)&&this.Dzi()?this.P9.dDj(Ye.a.ome,d,null,Oo.Kfi(da),ib):Promise.resolve(Pc)})}return Ea.then(pc=>{const Pc=new Wo.a;pc.IsSuccess?(Pc.token=pc.Token,pc.Telemetry&&(Pc.pSb=pc.Telemetry.fromCache,Pc.expiresOn=pc.Telemetry.expiresOn)):(Pc.errorCode=this.fan(pc),Pc.Ulg=this.mBn(pc));return Pc}).catch(()=>{const pc=new Wo.a;pc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(pc)}).then(pc=>{pc.Y_a="OauthManager";0<=Qb&&(pc.rSc=Qb);return pc})}MMm(d){const m=(n.AFrameworkApplication.K.kb(n.AFrameworkApplication.Fka)||
"").toLowerCase();return(ld.a.ZRa||"teams"===m&&qq.OAuthManagerSettings.XTc)&&!Oo.lMm(d)||!this.P9||!this.P9.Ovi()?!1:!0}Dzi(){return this.r2j||1!==si.a.KQd()}fan(d){switch(d.ErrorCode){case "UserCancelled":case "interaction_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":d=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:d=d.ErrorCode===dl.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:d.ErrorCode===dl.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:d.ErrorCode===dl.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
d.ErrorCode===dl.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:d.ErrorCode===dl.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return d}mBn(d){let m="";(d=RegExp("AADSTS(\\d+)").exec(d.ErrorMessage))&&1<d.length&&(m=d[1]);return m}static Kfi(d){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,d)}static lMm(d){if(!d)return!1;d=d.toLowerCase();for(const m of yc.AppsForOfficeSingleSignOnManager.n1h)if(m===
d)return!0;return!1}}Object(y.a)(Oo,"AppsforOfficeTokenFromOauthManager",null,[1193]);class An{constructor(d){this.j$m=d}static sog(){if(n.AFrameworkApplication.K.$("AppForOfficeSSOV2IsEnabled")){var d=null;try{d=Ia.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(m){v.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+m)}d=new Oo(d);An._instance=new An(d)}}static getInstance(){An.B_g||(An.sog(),An.B_g=!0);return An._instance}}An._instance=null;An.B_g=!1;Object(y.a)(An,
"AppsForOfficeOauthManagerFactory",null,[1175]);class Po extends hf{constructor(d,m){super();this.r8j=d;this.ii=m}go(){v.ULS.sendTraceTag(22402398,341,50,"GetAccessToken was called!");const d=(m,A)=>{m===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(A=A.accessToken,this.result[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=A):v.ULS.sendTraceTag(22402399,341,10,"{0}",{["errorCode"]:m.toString(),["appId"]:this.nk.Qn,["storeType"]:this.nk.storeType});this.ze=m;this.wo()};Ia.a.instance.Sa("Postmessage.IHostPostmessenger").execute(m=>
{const A=this.ii.Et,R=An.getInstance();yc.AppsForOfficeSingleSignOnManager.getInstance(A,m,R).getAccessToken(this.controlId,this.r8j,this.parameters,d)})}}Object(y.a)(Po,"GetAccessTokenMethod",hf,[]);class Cr extends hf{constructor(d){super();this.AW=d}go(){if(this.AW)if(this.Sf){let d=[];this.ze=({Axh:d}=this.Sf.xNl(this.nk)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=d}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
yk(12,this.nk.Qn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(9049033,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to getAllAsync api"});this.wo()}}Object(y.a)(Cr,"GetAllAppBindingsMethod",hf,[]);const Ka=(d,m,A,R,da)=>{v.ULS.sendTraceTag(7886233,341,50,"{0}",{["type"]:d?"get":"set",["error"]:m,["xmlSize"]:A,["latency"]:Math.max(R,0),["appId"]:da})},Fb=(d,m)=>{v.ULS.sendTraceTag(7886234,341,50,
"{0}",{["type"]:m?"get":"set",["delay"]:Math.max(d,0)})},jc=d=>(new Date).getTime()-d;class Qc{constructor(d,m){this.vba=d;this.nnk=m;this.Xhd=this.D2=this.rua=0}Ake(d){this.D2=(new Date).getTime();this.Xhd=0;this.rua=this.vba.setTimeout(()=>{this.Xhd=(new Date).getTime();d()},this.nnk)}clearTimeout(){this.vba.clearTimeout(this.rua)}get C1d(){return!!this.Xhd}get Tfb(){return this.D2}get nFd(){return this.Xhd}}Object(y.a)(Qc,"TimeoutMethodHelper",null,[]);class rd extends hf{constructor(d,m,A,R){super();
this.LHe=d;this.AW=m;this.Pxb=A;this.vba=R}go(){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let m=null;if(this.AW)if(this.Sf)if(void 0===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===d[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{m=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();const R=
d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let da;({fJ:A}=this.Sf.Lof(R,this.nk));if(A&&(da=A[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var A=da[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.ze=({text:d}=this.Sf.Nof(this.nk,R)).returnValue,this.PHa(d);else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Table)A===OSF.DDA.Marshaling.CoercionTypeKeys.Table?(this.Nii(d),this.ze=({zyj:d}=this.Sf.FPl(this.nk,R,d)).returnValue,
this.PHa(d)):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)A===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix||A===OSF.DDA.Marshaling.CoercionTypeKeys.Table?(this.Nii(d),this.ze=({ubn:d}=this.Sf.CPl(this.nk,R,d)).returnValue,this.PHa(d)):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else{if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.LHe){this.U7l(R);return}m===OSF.DDA.Marshaling.CoercionTypeKeys.Html?
(this.ze=({WQa:d}=this.Sf.BPl(this.nk,R)).returnValue,this.PHa(d)):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.OY(m)}Nii(d){d.isPartialTable=!!d&&(!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]||
!!d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]);d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]=d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]?d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]:0;d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]=d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]?d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]:0;d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]=d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]?d[OSF.DDA.Marshaling.BindingParameterKeys.RowCount]:
0;d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]=d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]?d[OSF.DDA.Marshaling.BindingParameterKeys.ColCount]:0}U7l(d){const m=new Qc(this.vba,this.Pxb);m.Ake(()=>{this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Xnb(null,m.Tfb)});this.Sf.EPl(this.nk,d,(A,R)=>{m.C1d?Fb(jc(m.nFd),!0):(m.clearTimeout(),this.ze=A,this.Xnb(R,m.Tfb))})}OY(d){yk(5,this.nk.Qn,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
v.ULS.sendTraceTag(16795287,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to GetAppBindingData api",["CoercionType"]:d});this.wo()}PHa(d){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d)}Xnb(d,m){Ka(!0,this.errorCode,(d||"").length,jc(m),this.nk.Qn);this.PHa(d);this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(y.a)(rd,"GetAppBindingDataMethod",hf,[]);class Yd extends hf{constructor(d){super();
this.AW=d}go(){if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];if(d[OSF.DDA.Marshaling.BindingParameterKeys.Id])if(d=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.AW){let m={};this.ze=({fJ:m}=this.Sf.Lof(d,this.nk)).returnValue;this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingResponse]=m}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;yk(13,this.nk.Qn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(9000010,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to getAppBindingById api"});this.wo()}}Object(y.a)(Yd,"GetAppBindingMethod",hf,[]);class Ue extends hf{constructor(d){super();this.qy=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],m=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath];
let A,R;this.ze=({CEa:A,Bsb:R}=this.qy.zHb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)try{const da=A.selectNodes(m,R);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.qy.yBj(d.CustomXmlId,da)}catch(da){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}this.wo()}}Object(y.a)(Ue,"GetDataNodesMethod",hf,[]);class ze extends hf{constructor(d){super();this.qy=d}execute(){let d,m;this.ze=({CEa:d,Bsb:m}=this.qy.zHb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;
this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d.getNodeText(m));this.wo()}}Object(y.a)(ze,"GetDataNodeTextMethod",hf,[]);class Bf extends hf{constructor(d){super();this.qy=d}execute(){let d,m;this.ze=({CEa:d,Bsb:m}=this.qy.zHb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
9===m.nodeType||1===m.nodeType?d.getNodeXml(m):d.getNodeText(m));this.wo()}}Object(y.a)(Bf,"GetDataNodeValueMethod",hf,[]);class Fg extends hf{constructor(d){super();this.qy=d}execute(){let d,m;this.ze=({CEa:d,Bsb:m}=this.qy.zHb(this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle])).returnValue;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=d.getNodeXml(m));this.wo()}}Object(y.a)(Fg,"GetDataNodeXmlMethod",hf,[]);class pi extends hf{constructor(d){super();
this.Mk=d}execute(){const d=this.Mk.lQa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);if(void 0===d||null===d||this.Mk.IEf(d))this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound;else{const m={};m.id=d.id;m.DataPartBuiltIn=d.builtIn;this.result[OSF.DDA.Marshaling.PropertyDescriptors.DataPartProperties]=m;this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}this.wo()}}Object(y.a)(pi,"GetDataPartByIdMethod",hf,[]);class Og extends hf{constructor(d,m){super();this.Mk=d;
this.qy=m}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id],m=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.XPath],A=this.Mk.lQa(d);if(void 0!==A&&null!==A)try{const R=A.selectNodes(m,null);this.result[OSF.DDA.Marshaling.ListDescriptors.DataNodeList]=this.qy.yBj(d,R);this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(R){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.wo()}}
Object(y.a)(Og,"GetDataPartNodesMethod",hf,[]);class Mj extends hf{constructor(d){super();this.Mk=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],m=this.Mk.DPc(),A=[];this.result[OSF.DDA.Marshaling.ListDescriptors.DataPartList]=A;this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;for(let R=0;R<m.length;R++){const da=m[R];if(d===da.namespace&&!this.Mk.IEf(da)){const Ea={};Ea.id=da.id;Ea.DataPartBuiltIn=da.builtIn;A.push(Ea)}}this.wo()}}Object(y.a)(Mj,"GetDataPartsByNamespaceMethod",
hf,[]);class ck extends hf{constructor(d){super();this.Mk=d}execute(){const d=this.Mk.lQa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=void 0===d||null===d?null:d.jWa;this.ze=void 0===d||null===d?OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.wo()}}Object(y.a)(ck,"GetDataPartXmlMethod",hf,[]);class $m extends hf{constructor(d){super();this.Mk=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Namespace],
m=this.Mk.lQa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);void 0!==m&&null!==m?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=m.uRc(d),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.wo()}}Object(y.a)($m,"GetDataPrefixByUriMethod",hf,[]);class Aj extends hf{constructor(d){super();this.Mk=d}execute(){const d=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Prefix],m=this.Mk.lQa(this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Id]);
void 0!==m&&null!==m?(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=m.Ysf(d),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.wo()}}Object(y.a)(Aj,"GetDataUriByPrefixMethod",hf,[]);var un=c(738);class Ip{constructor(){this.transaction=this.r9h=this.ahb=this.dQ=null}}Object(y.a)(Ip,"GetDocumentTextOperationContext",null,[]);class Ma extends hf{constructor(){super();this.xgj=null;this.pbk=100;this.NWl=(d,m)=>{for(d=
0;d<this.pbk;d++)if(m.dQ.moveNext()){if(m.dQ.currentNode.Vx){var A=Pk.SelectionFactory.Dq(m.dQ.currentNode);A=this.Sf.EUd(A);A!==bg.AParagraphNode.QC&&(m.ahb+=bg.AParagraphNode.QP(A))}}else return m.transaction&&m.transaction.dispose(),m.r9h(m.ahb),!1;return!0}}go(){let d=!1;this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Sf&&this.Sf.xFa&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType]&&
void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize]){const m=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.FileType],A=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceSize];this.Sf.xFa.Fxi(this.controlId)?this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:0>=A?(v.ULS.sendTraceTag(7123611,341,15,"Invalid slice size. It should be greater than 0."),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize):
this.hWm(m)?d=this.kcm(m,A):(v.ULS.sendTraceTag(7123612,341,15,"Requested file type {0} is not supported.",m),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported)}d||this.wo()}hWm(d){return d===OSF.DDA.Marshaling.File.FileType.Compressed||d===OSF.DDA.Marshaling.File.FileType.Pdf||d===OSF.DDA.Marshaling.File.FileType.Text}kcm(d,m){const A=(R,da)=>{const Ea={};Ea.FileType=d;Ea.SliceSize=m;yk(8,this.nk.Qn,R,Ea);this.uJn(da);this.AWl(R)};if(d===OSF.DDA.Marshaling.File.FileType.Text)return this.MWl(m,
A);this.Sf.xFa.GWl(this.controlId,d,m,A);return!0}MWl(d,m){v.ULS.sendTraceTag(8914013,341,100,"Started to get document content in text format; sliceSize is "+d);const A=this.qjm();if(!A)return!1;this.$em(d,m,A).run();return!0}$em(d,m,A){const R=new Ip;R.dQ=A;R.ahb="";R.transaction=this.u_l(A);R.r9h=da=>{(da=this.DWl(da,d))?(m(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,da),v.ULS.sendTraceTag(8914015,341,100,"Finished getting text content.")):(m(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,
null),v.ULS.sendTraceTag(8914014,341,10,"Cannot get DocumentFile object."))};A=new un.a(null,this.NWl,R);A.Rl("GetDocumentCopyInText");this.aIf()&&(A.Qh=!0);return A}aIf(){return!!this.xgj}u_l(d){if(this.aIf())return null;const m=(new Rj.a).Pc(3);m.Db(d.currentNode);return m}qjm(){if(this.aIf())var d=this.xgj;else{if(!yj.App.pn||!yj.App.pn.jb||!yj.App.pn.jb.rc)return v.ULS.sendTraceTag(8914016,341,10,"Cannot find ContentView in workspace of word frame."),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,
null;d=(new xi.a).Joa(yj.App.pn.jb.rc.ed,7,7).currentNode}const m=new Qk.a;m.set(d);d=bf.a.Qp(m);d.xo(Em.SelectionEditor.vhb,null);return d}DWl(d,m){if(!d&&""!==d)return null;const A=Ma.IQl(d);if(!this.sXk(m,A))return null;d=Ma.gfm(d,m);if(!d)return null;m=this.Sf.xFa.lMh(this.controlId,A,m,d);m.XIf=!0;v.ULS.sendTraceTag(8914017,341,100,"Got DocumentFile; total bytes are "+A);return m}sXk(d,m){return d<m&&d%2?(v.ULS.sendTraceTag(8914018,341,15,"Invalid slice size. It should not be odd number."),this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize,!1):!0}uJn(d){d&&(this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle]=d.J_h,this.result[""+OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize]=d.fileSize)}AWl(d){this.ze=d;this.wo()}static IQl(d){return 2*d.length+2}static gfm(d,m){const A=new U.a;var R=0;m/=2;do{const da=R+(A.count?m:m-1);R=sa.a.substring(d,R,da);A.add(R);R=da}while(R<d.length);return A}}Object(y.a)(Ma,"GetDocumentCopyMethod",hf,[]);class Za extends hf{constructor(){super()}go(){this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;v.ULS.shipAssertTag(20711197,341,!!this.Sf.xFa);if(this.Sf&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]&&void 0!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]&&null!==this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex]){const A=this.Sf.xFa.n9h(this.controlId,this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.Handle]);
if(A){var d=A.Xdc,m=this.parameters[""+OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex];if(A.XIf)this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=A.fileData.J(m),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.wo();else try{this.Sf.xFa.KWl(this.controlId,m,d,(R,da)=>{if(da){da=window.self.atob(da);const Ea=Array(da.length);for(let ib=0;ib<da.length;ib++)Ea[ib]=da.charCodeAt(ib);this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data]=Ea;this.result[""+OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize]=
da.length;this.ze=R;this.wo()}})}catch(R){v.ULS.sendTraceTag(20711198,341,15,"Error happens when converting string data to binary data. "+R.message)}}}}}Object(y.a)(Za,"GetDocumentCopySliceMethod",hf,[]);class yb extends hf{constructor(){super()}execute(){let d=null;if(this.Sf&&({url:d}=this.Sf.gQo()).returnValue){const m={};m[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=d;this.result[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=m;this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}}
Object(y.a)(yb,"GetFilePropertiesMethod",hf,[]);class qc{constructor(){this.context=null;this.errorCode=0}}Object(y.a)(qc,"NestedAppAuthContextResult",null,[]);class Tc{static k6l(d,m){const A=new qc;(d=d.getOsfControl(m))&&d.isFirstParty()?(A.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,d={},m=n.AFrameworkApplication.K.kb("AADUserObjectId"),d.userObjectId=m?m:n.AFrameworkApplication.K.kb("HostUserId"),d.userPrincipalName=n.AFrameworkApplication.K.kb("UserPrincipalName"),d.tenantId=n.AFrameworkApplication.K.kb("TenantId"),
m=(n.AFrameworkApplication.K.kb("HostAuthType")||"").toLowerCase(),d.authorityType="aad"===m?"aad":"msa"===m?"msa":"other",A.context=d):A.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return A}}Object(y.a)(Tc,"NestedAppAuthUtil",null,[]);class dd extends hf{constructor(d){super();this.ii=d}go(){const d=Tc.k6l(this.ii.Et,this.controlId||"");this.ze=d.errorCode;if(d.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)for(const [m,A]of Object.entries(d.context))this.result[m]=A;
this.wo()}}Object(y.a)(dd,"GetNestedAppAuthContextMethod",hf,[]);class Dd extends hf{constructor(d,m,A,R,da,Ea){super();this.c9j=d;this.Z8j=m;this.b$j=A;this.p9j=R;this.Pxb=da;this.vba=Ea}go(){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.GetData];let m=null;if(this.Sf)if(void 0===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.GetDataKeys.CoercionType])this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else if(m=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString(),
m===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.ze=({Mkc:d}=this.Sf.getSelectedText()).returnValue,this.PHa(d);else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.b$j)this.ze=({Pdo:d}=this.Sf.Xdm()).returnValue,this.PHa(d);else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.p9j)this.ze=({Jdo:d}=this.Sf.Tdm()).returnValue,this.PHa(d);else{if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.Z8j){this.Vdm();return}m===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.c9j?(this.ze=
({fjj:d}=this.Sf.Ndm()).returnValue,this.PHa(d)):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.OY(m)}Vdm(){const d=new Qc(this.vba,this.Pxb);d.Ake(()=>{this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Xnb(null,d.Tfb)});this.Sf.Udm((m,A)=>{d.C1d?Fb(jc(d.nFd),!0):(d.clearTimeout(),this.ze=m,this.Xnb(A,d.Tfb))})}PHa(d){this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.result[OSF.DDA.Marshaling.UniqueArgumentKeys.Data]=
d)}Xnb(d,m){Ka(!0,this.errorCode,(d||"").length,jc(m),this.nk.Qn);this.PHa(d);this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}OY(d){yk(1,this.nk.Qn,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(17385222,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to GetSelectedDataAsync api",["CoercionType"]:d});this.wo()}execute(){}}Object(y.a)(Dd,"GetSelectedDataMethod",hf,[]);class ce{constructor(){this.languageId=
0;this.displayName=this.name=null}}Object(y.a)(ce,"TranslationLanguageInfo",null,[]);class He{constructor(d,m){this.rkh=null;this.WWe=!1;this.Qhk=d;this.J0j=m}n6n(){n.AFrameworkApplication.He.nj(this.Qhk(),1,null,null,!1,2,Object(I.a)(this,this.f2c,"onAppSettingsRequestSucceeded"),Object(I.a)(this,this.Pgc,"onAppSettingsRequestFailed"),null)}J2l(){const d=(this.rkh||this.J0j()).split(","),m=this.WWe?d.length/3:d.length/2,A=Array(m);for(let R=0;R<m;R++){A[R]=new ce;A[R].name=d[R];const da=parseInt(d[R+
m]);A[R].languageId=da;A[R].displayName=this.WWe?d[R+2*m]:De.a.fli()[da]}return A}OUo(d){this.rkh=d.TranslationLanguages;this.WWe=Boolean.parse(d.TranslationLanguagesLocalized||"false")}Pgc(d){d={["Status"]:d.data.status,["HttpStatus"]:d.data.Ne,["ResponseData"]:sa.a.oCj(d.data.te)};v.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",d)}f2c(d){v.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");
let m;try{m=rb.b(d.data.te)}catch(A){v.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",A);return}this.OUo(m)}}Object(y.a)(He,"TranslationLanguagesManager",null,[]);var xf=c(1222),ai=c(2E3);class Bi{constructor(){this.gsc=!1}start(d){Bi.x8a(this.O4o,Object(I.a)(this,this.vMb,"onCancel"));ai.a.I8(this.q6n,Object(I.a)(this,this.unn,"onComplete"),d)}vMb(){this.gsc=!0;Bi.aoa()}unn(d,m,
A){this.gsc||(m||(m=d?"Success":"UnknownError"),"Success"===m?(this.KTh&&Bi.aoa(),this.onSuccess(A)):(this.gMm(m)?v.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+m):v.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+m),Bi.aoa(),d=this.xca(m),1!==n.AFrameworkApplication.ta.state&&(n.AFrameworkApplication.K.$("ReportConversionFailedErrorUnderAdditionalVetoes")&&n.AFrameworkApplication.mN(Tf.a.XJh,void 0,["TranslationFailed"]),m=new xb.StandardDialog,
m.Cd=0,m.ye(1,CommonUIStrings.l_DialogClose),m.wx(Tf.a.XJh,CommonUIStrings.l_DefaultDialogTitle,d,null))))}static x8a(d,m){const A=new xf.a;Bi.Gk=A.create();Bi.Gk.message=d;Bi.Gk.KL(CommonUIStrings.l_DefaultDialogTitle,m,null)}static aoa(){Bi.Gk&&(Bi.Gk.close(),Bi.Gk=null)}}Bi.Gk=null;Object(y.a)(Bi,"TranslationRequest",null,[]);class wg extends Bi{constructor(d,m=0){super();this.wqd=d;this.Uek=m;this.ki=(new Date).getTime();n.AFrameworkApplication.Wl.Q3a(9984)}start(d){v.ULS.sendTraceTag(23184016,
301,50,"Translation started");super.start(d)}vMb(d){super.vMb(d);n.AFrameworkApplication.Wl.Q3a(9986);v.ULS.sendTraceTag(40953793,301,50,"Translation canceled")}onSuccess(){const d=(new Date).getTime()-this.ki;n.AFrameworkApplication.Wl.setDw(9985,d);this.redirect();v.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")}get O4o(){return 10<=this.Uek?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation}get KTh(){return!1}xca(d){return"TranslationServiceUnavailable"===
d?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===d?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===d?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===d?CommonUIStrings.l_DocumentCannotBeTranslatedLength:CommonUIStrings.l_GenericTranslationError}gMm(d){return"DocumentCannotBeTranslated"===d||"DocumentHasOCX"===d||"DocumentTooLong"===d}}Object(y.a)(wg,"TranslateDocumentRequest",Bi,[]);var Qi=c(421);class hk extends wg{constructor(d){super(d)}redirect(){v.ULS.sendTraceTag(592255192,
324,100,"Navigate to view mode for translation");if(Qi.b(n.AFrameworkApplication.K)){var d=new Fk.a;d.add("language",this.wqd);d.add("fromeditor","1");Qi.d("view",d,Qi.e)}else d=E.a.fp(yj.App.pn.osb,"language",this.wqd)+"&fromeditor=1",cb.a.openWindow(1,d)}get KTh(){return!0}get q6n(){return Ab.App.webServiceBase+"docdatahandler.ashx?"+n.AFrameworkApplication.em+"&language="+sa.a.Gj(this.wqd)+"&languagename="+sa.a.Gj(this.wqd)+"&type=png&o15=1"}}Object(y.a)(hk,"TranslateDocumentRequestFromEditor",
wg,[]);class sj{static GBj(d){(new hk(d)).start(sf.StaticActiveAppFrame.za().notificationBar)}static K2l(){return Ab.App.webServiceBase+"translation.ashx?"+n.AFrameworkApplication.em+"&uilang="+sa.a.Gj(n.AFrameworkApplication.uiCulture)}static RVl(){return Ab.App.Scd}}sj.Scd=new He(sj.K2l,sj.RVl);Object(y.a)(sj,"TranslationManager",null,[]);class mf extends hf{constructor(d,m,A){super();this.sKo=m;this.enabled=A}go(){if(this.enabled){var d=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],
m=d[OSF.DDA.Marshaling.NavigationKeys.Id].toString(),A=d[OSF.DDA.Marshaling.NavigationKeys.GoToType];d=d[OSF.DDA.Marshaling.NavigationKeys.SelectionMode];var R=null;m&&m.startsWith("TranslatedDocument")&&(R=m.split("|"),R=2===R.length?R[1]:null);R?(sj.GBj(R),this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ze=this.VXm(A)&&this.jYm(d)?this.Sf.Pmm(m,d,this.sKo,this.nk):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;yk(15,this.nk.Qn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&
v.ULS.sendTraceTag(17585945,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to goToByIdAsync api"})}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}VXm(d){return d===OSF.DDA.Marshaling.GoToType.Binding}jYm(d){return d===OSF.DDA.Marshaling.SelectionMode.Default||d===OSF.DDA.Marshaling.SelectionMode.Selected||d===OSF.DDA.Marshaling.SelectionMode.None}}Object(y.a)(mf,"GoToByIdAsyncMethod",hf,[]);class Ve extends hf{constructor(){super()}execute(){this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Sf){const d=this.dnf(this.Sf.B5a(this.nk));if(d){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const m={};m.Settings=d;this.result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=m}}}dnf(d){const m={};let A=0;for(const R in d)m[""+A]=[R,d[R]],A++;return m}}Object(y.a)(Ve,"LoadSettingsMethod",hf,[]);class ef extends hf{constructor(d){super();this.sta=d}go(){let d;d=this.sta?this.Sf?this.Sf.cJa.sPi(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
this.parameters[Ye.a.$0e],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]):OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.hen(d)}NY(){yk(16,this.nk.Qn,this.errorCode,null);this.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&v.ULS.sendTraceTag(18376392,341,10,"{0}",{["error"]:this.errorCode,["appId"]:this.nk.Qn,["errMsg"]:"MessageParent API failed!"})}hen(d){this.ze=d;this.NY();this.wo()}}Object(y.a)(ef,
"MessageParentMethod",hf,[]);class og extends hf{constructor(d){super();this.zZn=m=>{this.ze=m;this.wo()};this.AW=d}go(){if(this.AW)if(this.Sf){var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.BindingRequest];d=d[OSF.DDA.Marshaling.BindingParameterKeys.Id]?this.Sf.AZn(d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString(),this.nk,this.zZn):OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else d=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;
yk(14,this.nk.Qn,this.errorCode);this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(9225408,341,10,"{0}",{["error"]:d,["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to releaseAppBindingById api"});d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.ze=d,this.wo())}}Object(y.a)(og,"ReleaseAppBindingMethod",hf,[]);class Ig extends hf{constructor(){super()}execute(){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SettingsRequest];
d=Array.isArray(d[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?d[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null;this.Sf&&(this.ze=this.Sf.saveSettings(this.nk,this.dnf(d)))}dnf(d){const m={};if(d)for(let A=0;A<d.length;A++){const R=Array.isArray(d[A])?d[A]:null;R&&1<R.length&&(m[R[0]]=R[1])}return m}}Object(y.a)(Ig,"SaveSettingsMethod",hf,[]);class Uk extends hf{constructor(d,m,A,R,da){super();this.Jkj=(Ea,ib)=>{this.ze=Ea;this.OY(ib)};this.LHe=d;this.Fte=m;this.AW=A;this.Pxb=R;
this.vba=da}go(){const d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];let m=null;if(this.AW)if(this.Sf)if(void 0===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.SetDataKeys.Data]||null===d[OSF.DDA.Marshaling.SetDataKeys.Data]||void 0===d[OSF.DDA.Marshaling.BindingParameterKeys.Id]||null===d[OSF.DDA.Marshaling.BindingParameterKeys.Id])this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;
else{m=d[OSF.DDA.Marshaling.GetDataKeys.CoercionType].toString();var A=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString();const da=d[OSF.DDA.Marshaling.BindingParameterKeys.Id].toString();let Ea;({fJ:R}=this.Sf.Lof(da,this.nk));if(R&&(Ea=R[OSF.DDA.Marshaling.AppBindingKeys.BindingProperties])){var R=Ea[OSF.DDA.Marshaling.AppBindingKeys.BindingType];if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Text)this.ze=this.Sf.ldg(this.nk,da,A);else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.LHe){if(A.startsWith("<")){this.tmo(da,
A);return}this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.Fte){this.lko(da,A);return}if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Table)if(R===OSF.DDA.Marshaling.CoercionTypeKeys.Table){if((this.ze=({O5i:A}=this.QDj(d,Ea)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.Sf.sho(this.nk,da,d[OSF.DDA.Marshaling.SetDataKeys.Data],A,this.Jkj);return}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;
else if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)if(R===OSF.DDA.Marshaling.CoercionTypeKeys.Table||R===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix){if((this.ze=({O5i:A}=this.QDj(d,Ea)).returnValue)===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){this.Sf.qho(this.nk,da,d[OSF.DDA.Marshaling.SetDataKeys.Data],A,this.Jkj);return}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.OY(m)}QDj(d,m){let A=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;const R=m[OSF.DDA.Marshaling.AppBindingKeys.RowCount];m=m[OSF.DDA.Marshaling.AppBindingKeys.ColumnCount];var da=!!d&&(!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow]||!!d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol]);const Ea=
{};(Ea.isPartialTable=da)?(da=d[OSF.DDA.Marshaling.BindingParameterKeys.StartRow],d=d[OSF.DDA.Marshaling.BindingParameterKeys.StartCol],0>da||da>=R||0>d||d>=m?A=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn:(Ea.startRow=da,Ea.startCol=d)):(Ea.startRow=0,Ea.startCol=0);return{returnValue:A,O5i:Ea}}OY(d){yk(6,this.nk.Qn,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(16795289,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to SetAppBindingData API",["CoercionType"]:d});this.wo()}lko(d,m){this.Sf.pho(this.nk,d,m,A=>{this.ze=A;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}tmo(d,m){const A=new Qc(this.vba,this.Pxb);A.Ake(()=>{this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Xnb(A.Tfb,m.length)});this.Sf.rho(this.nk,d,m,R=>{A.C1d?Fb(jc(A.nFd),!1):(A.clearTimeout(),this.ze=R,this.Xnb(A.Tfb,m.length))})}Xnb(d,m){Ka(!1,this.errorCode,m,jc(d),this.nk.Qn);
this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}}Object(y.a)(Uk,"SetAppBindingDataMethod",hf,[]);class di extends hf{constructor(d,m,A){super();this.RBa=d;this.qy=m;this.fpd=A}execute(){if(this.RBa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],m=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Text],A,R;this.ze=({CEa:A,Bsb:R}=this.qy.zHb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(A.builtIn){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;
this.fpd&&ri(21,this.errorCode,this.nk);this.wo();return}const da=R.cloneNode(!0);A.setNodeText(R,m)?1!==R.nodeType?this.qy.b6c(R,da,d):(m=da.childNodes,this.ze=void 0!==m&&null!==m&&m.length?1===m.length&&3===m[0].nodeType?this.qy.b6c(R.firstChild,m[0],d):this.qy.b6c(R.firstChild,da,d):this.qy.dPn(R.firstChild,d)):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.fpd&&ri(6,this.errorCode,this.nk);this.wo()}}
Object(y.a)(di,"SetDataNodeTextMethod",hf,[]);class zk extends hf{constructor(d,m){super();this.RBa=d;this.qy=m}execute(){if(this.RBa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],m=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.Data],A,R;this.ze=({CEa:A,Bsb:R}=this.qy.zHb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(A.builtIn){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.wo();return}const da=R.cloneNode(!0);
9!==R.nodeType&&1!==R.nodeType&&A.setNodeText(R,m)?this.ze=this.qy.b6c(R,da,d):this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.wo()}}Object(y.a)(zk,"SetDataNodeValueMethod",hf,[]);class yl extends hf{constructor(d,m,A){super();this.RBa=d;this.qy=m;this.lWb=A}execute(){if(this.RBa){var d=this.parameters[OSF.DDA.Marshaling.DataNodeProperties.Handle],m=this.parameters[OSF.DDA.Marshaling.CustomXmlPartsKeys.Xml],
A,R;this.ze=({CEa:A,Bsb:R}=this.qy.zHb(d)).returnValue;if(this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(A.builtIn){this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;this.wo();return}const da=R.cloneNode(!0);if(m=A.setNodeXml(R,m)){({mfd:A}=this.qy.Vki(d));if(void 0!==A&&null!==A&&A[d.NodeIndex]===R)try{A[d.NodeIndex]=m}catch(Ea){this.lWb.zNi(d.NodeListCacheId)}this.ze=this.qy.b6c(m,da,d)}else this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}}else this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported;this.wo()}}Object(y.a)(yl,"SetDataNodeXmlMethod",hf,[]);class $k extends hf{constructor(d,m,A,R,da){super();this.Fte=d;this.cWj=m;this.Pxb=A;this.vba=R;this.P9j=da.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeTableIsEnabled");this.O9j=da.$("WordEditorAppsForOfficeSetSelectedDataAsyncCoercionTypeMatrixIsEnabled");this.N9j=da.$("WordEditorAppsForOfficeImageCoercionTypeIsEnabled")}go(){const d=this.parameters[OSF.DDA.Marshaling.UniqueArgumentKeys.SetData];
let m="";if(this.Sf)if(void 0===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||null===d[OSF.DDA.Marshaling.SetDataKeys.CoercionType]||void 0===d[OSF.DDA.Marshaling.SetDataKeys.Data]||null===d[OSF.DDA.Marshaling.SetDataKeys.Data])this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;else{m=d[OSF.DDA.Marshaling.SetDataKeys.CoercionType].toString();if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Text){this.tKn(d);return}if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Html&&this.Fte){this.oKn(d);return}if(m===
OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml&&this.cWj){if(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString().startsWith("<")){this.rKn(d);return}this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam}else{if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Table&&this.P9j){this.sKn(d);return}if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Matrix&&this.O9j){this.qKn(d);return}if(m===OSF.DDA.Marshaling.CoercionTypeKeys.Image&&this.N9j){this.pKn(d);return}this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}}else this.ze=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.OY(m)}sKn(d){this.Sf.joo(d[OSF.DDA.Marshaling.SetDataKeys.Data],m=>{this.ze=m;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Table)})}qKn(d){this.Sf.goo(d[OSF.DDA.Marshaling.SetDataKeys.Data],m=>{this.ze=m;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Matrix)})}tKn(d){this.Sf.koo(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),m=>{this.ze=m;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Text)})}oKn(d){this.Sf.doo(d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),
m=>{this.ze=m;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Html)})}rKn(d){const m=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),A=new Qc(this.vba,this.Pxb);A.Ake(()=>{this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout;this.Tnj(A.Tfb,m.length)});this.Sf.hoo(m,R=>{A.C1d?Fb(jc(A.nFd),!1):(A.clearTimeout(),this.ze=R,this.Tnj(A.Tfb,m.length))})}pKn(d){const m=d[OSF.DDA.Marshaling.SetDataKeys.Data].toString(),A=d[OSF.DDA.Marshaling.SetDataKeys.ImageWidth];d=d[OSF.DDA.Marshaling.SetDataKeys.ImageHeight];
0>A||0>d?(this.ze=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Image)):this.Sf.eoo(m,A,d,R=>{this.ze=R;this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Image)})}Tnj(d,m){Ka(!1,this.errorCode,m,jc(d),this.nk.Qn);this.OY(OSF.DDA.Marshaling.CoercionTypeKeys.Ooxml)}OY(d){yk(2,this.nk.Qn,this.errorCode,{["CoercionType"]:d});this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError&&v.ULS.sendTraceTag(17585946,341,10,"{0}",{["error"]:this.errorCode,
["appId"]:this.nk.Qn,["errMsg"]:"unexpected error to setSelectedDataAsync API",["CoercionType"]:d});this.wo()}}Object(y.a)($k,"SetSelectedDataMethod",hf,[]);class Vp extends Fd{constructor(d,m,A,R,da,Ea,ib){super();this.eEe=d;this.Ca=m;this.vba=A;this.Mk=R;this.lWb=da;this.qy=Ea;this.ii=ib}Aof(d){if(d=super.Aof(d))d.Sf=this.eEe;return d}tFn(){const d=this.Ca.$("WordEditorAppsForOfficeImportExternalHtmlDataIsEnabled")&&ld.a.$ke,m=this.Ca.$("WordEditorAppsForOfficeSelectionOoxmlIsEnabled"),A=this.Ca.nc("WordEditorAppsForOfficeSelectionOoxmlRequestTimeoutMilliSec",
3E4),R=this.Ca.$("WordEditorAppsForOfficeCustomXmlWriteIsEnabled"),da=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomxmlpartTelemetryEnabled",!1),Ea=new ke.a;Ea.Z(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>{const pc=this.Ca.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeHtmlIsEnabled"),Pc=this.Ca.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeTableIsEnabled"),gd=this.Ca.$("WordEditorAppsForOfficeGetSelectedDataAsyncCoercionTypeMatrixIsEnabled");return new Dd(pc,
m,Pc,gd,A,this.vba)});Ea.Z(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new $k(d,m,A,this.vba,this.Ca));Ea.Z(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new yb);Ea.Z(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new dd(this.ii));Ea.Z(OSF.DDA.MethodDispId.dispidAddDataPartMethod,()=>new Lj(R,this.Mk,da));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataPartByIdMethod,()=>new pi(this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataPartsByNamespaceMethod,()=>new Mj(this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataPartXmlMethod,
()=>new ck(this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataPartNodesMethod,()=>new Og(this.Mk,this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidDeleteDataPartMethod,()=>new Vm(R,this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataNodeValueMethod,()=>new Bf(this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataNodeXmlMethod,()=>new Fg(this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataNodeTextMethod,()=>new ze(this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataNodesMethod,()=>new Ue(this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidSetDataNodeValueMethod,
()=>new zk(R,this.qy));Ea.Z(OSF.DDA.MethodDispId.dispidSetDataNodeXmlMethod,()=>new yl(R,this.qy,this.lWb));Ea.Z(OSF.DDA.MethodDispId.dispidSetDataNodeTextMethod,()=>new di(R,this.qy,da));Ea.Z(OSF.DDA.MethodDispId.dispidAddDataNamespaceMethod,()=>new xg(R,this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataUriByPrefixMethod,()=>new Aj(this.Mk));Ea.Z(OSF.DDA.MethodDispId.dispidGetDataPrefixByUriMethod,()=>new $m(this.Mk));const ib=this.Ca.$(Vp.tth),Qb=this.Ca.$(Vp.wDk);Ea.Z(OSF.DDA.MethodDispId.dispidGetBindingMethod,
()=>new Yd(ib));Ea.Z(OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,()=>new Cr(ib));Ea.Z(OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,()=>new Jh(Qb));Ea.Z(OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,()=>new Ph(Qb));Ea.Z(OSF.DDA.MethodDispId.dispidSetBindingDataMethod,()=>new Uk(m,d,Qb,A,this.vba));Ea.Z(OSF.DDA.MethodDispId.dispidGetBindingDataMethod,()=>new rd(m,ib,A,this.vba));Ea.Z(OSF.DDA.MethodDispId.dispidReleaseBindingMethod,()=>new og(Qb));Ea.Z(OSF.DDA.MethodDispId.dispidAddColumnsMethod,
()=>new tn(Qb));Ea.Z(OSF.DDA.MethodDispId.dispidAddRowsMethod,()=>new xl(Qb));Ea.Z(OSF.DDA.MethodDispId.dispidClearAllRowsMethod,()=>new Up(Qb));ld.a.jle?(Ea.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new Za),Ea.Z(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Um),Ea.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Ma)):(Ea.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>hf.LJd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),Ea.Z(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,
()=>hf.LJd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)),Ea.Z(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>hf.LJd(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported)));Ea.Z(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>{const pc=this.Ca.$("WordEditorExtensionRichAPIIsEnabled"),Pc=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddingCompliantSolutionId",!1);return new ds(pc,Pc)});Ea.Z(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>
new Ve);Ea.Z(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new Ig);Ea.Z(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>{const pc=this.Ca.$(Vp.tth);return new mf(sh.a.instance,pg.InteractiveViewManager.instance.we.ke,pc)});Ea.Z(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>{const pc=this.Ca.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new ef(pc)});Ea.Z(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>{const pc=this.Ca.$("WordEditorAppsForOfficeShowDialogApiIsEnabled");return new tf(pc)});
Ea.Z(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new ll);Ea.Z(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>{const pc=this.Ca.$("WordEditorAppsForOfficeSingleSignOnIsEnabled");return new Po(pc,this.ii)});Ea.Z(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Te(this.ii));return Ea}}Vp.tth="WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled";Vp.wDk="WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled";Object(y.a)(Vp,"WordEditorMethodFactory",Fd,[]);class Mt extends qk{constructor(){super()}wc(d){if(yj.App.cfd||
yj.App.nLf||n.AFrameworkApplication.K.$("WordEditorIdeasIsEnabled")||n.AFrameworkApplication.wBb||n.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")||n.AFrameworkApplication.K.$("AddInCommandsIsEnabled")){super.wc(d);var m=n.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingReadFeatureIsEnabled"),A=n.AFrameworkApplication.K.$("WordEditorAppsForOfficeAppBindingWriteFeatureIsEnabled"),R=n.AFrameworkApplication.K.$("WordEditorContentControlReadIsEnabled"),da=n.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled");
d.ia("WordEditor.AppsForOffice.GetFileApiHelper",()=>new Xg(Xg.o4e,()=>n.AFrameworkApplication.rootQuerySignature,Ao.PageReader.instance,sf.StaticActiveAppFrame.za().jb.Zc,new pe.a,n.AFrameworkApplication.K,d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("WordEditor.AppsForOffice.IGetFileApiHelper").ha();d.ia("Box4.AppsForOffice.ShowDialogApiHelper",()=>new sm(sf.StaticActiveAppFrame.za(),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("Box4.AppsForOffice.IShowDialogApiHelper").ha();
R&&m&&d.ia("WordEditor.AppsForOffice.AppBindingHelper",()=>new df(d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel"),d.resolve("WordEditor.ContentControl.IContentControlManager"),sh.a.instance,new Rj.a,new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.Zc.xd),d.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),d.resolve("WordEditor.ITableEditor"),d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),d.resolve("Box4.ContentControlParagraphMapping"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).as("WordEditor.AppsForOffice.IAppBindingHelper").ha();
d.ia("WordEditor.AppsForOffice.TableMatrixHelper",()=>new Ym(n.AFrameworkApplication.va,sh.a.instance,d.resolve("WordEditor.ITableEditor"))).ha();d.ia("WordEditor.AppsForOffice.CustomXmlHelper",()=>new Ng(d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"))).as("WordEditor.AppsForOffice.ICustomXmlHelper").ha();d.ia("WordEditor.AppsForOffice.CustomXmlNodeListCache",()=>new ph(new Pd.a(()=>n.AFrameworkApplication.K.nc("WordEditorCustomXmlMaximumDataCollectionNumber",
1024)),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).as("WordEditor.AppsForOffice.ICustomXmlNodeListCache").ha();d.ia("WordEditor.AppsForOffice.OoxmlSelectionManager",()=>new cn(n.AFrameworkApplication.ta.Kq,()=>Ao.PageReader.instance.KSd(sf.StaticActiveAppFrame.za().jb.Zc),()=>n.AFrameworkApplication.rootQuerySignature,d.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),Oi.a.mR,n.AFrameworkApplication.K.$("AppsForOfficeFixIpIssueForInsertOoxmlIsEnabled"))).as("WordEditor.AppsForOffice.IOoxmlSelectionManager").ha();
d.ia("WordEditor.AppsForOffice.OoxmlRangeManager",()=>new oq(d.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"))).as("WordEditor.AppsForOffice.IOoxmlRangeManager").ha();d.ia("WordEditor.AppsForOffice.HtmlDataGetSetProvider",()=>new Ad(sh.a.instance,d.Oa("Box4.Actors.InternalClipboard"),n.AFrameworkApplication.va,d.resolve("Box4.IHtmlViewRootFactory"),Ni.a.aia())).as("WordEditor.AppsForOffice.IHtmlDataGetSetProvider").ha();d.ia("WordEditor.AppsForOffice.WordEditorApiObjectModel",()=>new Kj(sh.a.instance,
n.AFrameworkApplication.va,d.resolve("WordEditor.AppsForOffice.GetFileApiHelper"),d.resolve("Box4.AppsForOffice.IShowDialogApiHelper"),d.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),d.resolve("WordEditor.AppsForOffice.IOoxmlSelectionManager"),d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"),new Rj.a,R&&m?d.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):
null,d.resolve("WordEditor.Extension.DocumentFactory"),d.resolve("WordEditor.AppsForOffice.TableMatrixHelper"),new xi.a,d.resolve("Box4.IParagraphReader"),qe.a.instance)).as("WordEditor.AppsForOffice.IWordEditorApiObjectModel").ha();d.ia("WordEditor.AppsForOffice.WindowTimer",()=>new nb).as("WordEditor.AppsForOffice.IWindowTimers").ha();d.ia("WordEditor.AppsForOffice.WordEditorMethodFactory",()=>new Vp(d.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"),n.AFrameworkApplication.K,d.resolve("WordEditor.AppsForOffice.IWindowTimers"),
d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.AppsForOffice.ICustomXmlNodeListCache"),d.resolve("WordEditor.AppsForOffice.ICustomXmlHelper"),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).as("Common.App.AppsForOfficeCommon.IApiMethodFactory").ha();d.ia("WordEditor.AppsForOffice.WordEditorEventStore",()=>vd.Oal(d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),d.resolve("WordEditor.AppsForOffice.WordEditorApiObjectModel"))).as("Common.App.AppsForOfficeCommon.IApiEventStore").ha();
d.ia("WordEditor.AppsForOffice.WordEditorApiThrottleStore",()=>new ys(new OsfRuntime.Throttling.ThrottleFactory,n.AFrameworkApplication.K)).as("Common.App.AppsForOfficeCommon.IApiThrottleStore").ha();d.ia("Common.App.AppsForOfficeCommon.ApiManager",()=>new hb(d.resolve("WordEditor.AppsForOffice.WordEditorMethodFactory"),d.resolve("WordEditor.AppsForOffice.WordEditorEventStore"),d.resolve("WordEditor.AppsForOffice.WordEditorApiThrottleStore"))).as("Common.App.AppsForOfficeCommon.IApiManager").ha();
d.ia("Box4.SetDataVirtualSelectionMerger",()=>new bm).as("Box4.Actors.IVirtualSelectionMerger").ha();d.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor",()=>new Sm(d.Ve("Common.App.AppsForOfficeCommon.IAppsForOfficeManager"),null,d.Ve("Common.App.AppsForOfficeCommon.IContextActivationManager"),Ib.FocusManager.instance(),gc.a.instance,n.AFrameworkApplication.va,n.AFrameworkApplication.K,d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"),
d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),null,Hh.a.instance,d.resolve("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager"),null)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor").ha();d.ia("Wonca.AppsForOffice.SaveSettingsHelper",()=>new Se(new Rj.a)).ha();d.ia("Wonca.AppsForOffice.AddinActivator",()=>new Mb(d.Ve("Common.App.AppsForOfficeCommon.IContextActivationManager"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"),d.resolve("Wonca.AppsForOffice.SaveSettingsHelper"))).as("Wonca.IAddinActivator").ha();
d.ia("WordEditor.AppsForOffice.AppsForOfficeApiActor",()=>new la(n.AFrameworkApplication.va,Lc.a.instance,d.resolve("Box4.IOutlineEditor"),d.resolve("Box4.ICharacterPropertiesEditor"),new Rj.a,d.Ve("Box4.Actors.IClipboardOperationFactory"),d.resolve("Box4.IClipboardDataHelper"),n.AFrameworkApplication.K,xd.a.instance,d.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();d.ia("WordEditor.AppsForOffice.WordEditorAfoSettingsModel",()=>new Re(new ek)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel").ha();
d.ia("Wonca.AppsForOffice.BackCompatImageUploaderWrapper",()=>new Rp).as("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper").ha();d.ia("Wonca.IFrameEditors.AddinEditor",()=>new Fe(d.resolve("WordEditor.IImageEditor"),d.resolve("Wonca.IFrameEditors.IBackCompatImageUploaderWrapper"))).as("Wonca.IFrameEditors.IAddinEditor").ha();d.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeModel",()=>new Yk(ye.PageNavigator.instance,new Rj.a,new Qm,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeSettingsModel"),
d.resolve("Wonca.IFrameEditors.IAddinEditor"),n.AFrameworkApplication.va,Lc.a.instance)).as("Common.App.AppsForOfficeCommon.IAppsForOfficeModel").ha();d.ia("Common.App.AppsForOfficeCommon.AppsForOfficeManager",()=>new Ld(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeModel"))).as("Common.App.AppsForOfficeCommon.IAppsForOfficeManager").ha();d.ia("Common.App.AppsForOfficeCommon.HostControlInfo",()=>new zd(d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),
d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"))).ha();d.register(Md,"WordEditor.AppsForOffice.WordEditorActivationSettingsProvider").as("Common.App.AppsForOfficeCommon.IActivationSettingsProvider").ha();d.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory",()=>new pf(d.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"))).ha();d.ia("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory",()=>new Yi(d.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerBuilderFactory").create(),
d.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider"),d.resolve("Common.App.AppsForOfficeCommon.HostControlInfo"))).ha();d.ia("Common.App.AppsForOfficeCommon.IContextActivationManager",()=>{const Ea=d.resolve("Common.App.AppsForOfficeCommon.IContextActivationManagerFactory").create();Ea.setOAuthManager(d.resolve("Common.App.OAuth.IOAuthManager"));return Ea});d.ia("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager",()=>new rp(d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager"),
null,d.resolve("Common.App.AppsForOfficeCommon.ApiManager"),d.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeApiAdapter"),d.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeUIActor"),da&&A?d.resolve("WordEditor.AppsForOffice.IAppBindingHelper"):null,n.AFrameworkApplication.K,d.resolve("WordEditor.AppsForOffice.AppsForOfficeApiActor"))).ha();this.W.ia("WordEditor.AppsForOffice.ApiOperationChecker",()=>new Zh).as("WordEditor.AppsForOffice.IApiOperationChecker").ha();this.W.ia("Box4.AppsForOffice.IInitializeHelper",
()=>new Xi).ha()}}get name(){return"WordEditor.AppsForOffice"}init(){if(yj.App.cfd){var d=this.W.resolve("WordEditor.AppsForOffice.WordEditorActivationSettingsProvider");d.gKc=!0;n.AFrameworkApplication.K.$("OcpsIsEnabled")?this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(m=>{m.isFeatureEnabled("ConnectedServices",!0).then(A=>{d.gKc=A;this.initInternal();return null})}):this.initInternal()}}initInternal(){this.QUb=this.W.resolve("WordEditor.AppsForOffice.WordEditorAppsForOfficeIntegrationManager");
n.AFrameworkApplication.K.Nn(()=>{this.QUb.initialize();sf.StaticActiveAppFrame.za().updateCommandUI();if(n.AFrameworkApplication.K.$("SdxIsEnabled")){var m={};m.Application=n.AFrameworkApplication.K.kb("Application");m.SdxDmsUrl=n.AFrameworkApplication.K.kb("SdxDmsUrl");m.SdxCdnUrl=n.AFrameworkApplication.K.kb("SdxCdnUrl");m.UICulture=n.AFrameworkApplication.K.kb("UICulture");m.LoggableUserId=n.AFrameworkApplication.K.kb("LoggableUserId");m.SessionStartInfoJson=n.AFrameworkApplication.K.kb("SessionStartInfoJson");
m.StaticContentUrl=n.AFrameworkApplication.K.kb("StaticContentUrl");m.DmsSdxList=n.AFrameworkApplication.fUh;var A={};A.generalParameters=m;A.flightingTreatmentVariables=n.AFrameworkApplication.K.f2a;OfficeExt.SDXCatalog.InitializeSdx(A);let da=!1;m=0;if(n.AFrameworkApplication.K.$("AppsForOfficeSharedRuntimeIsEnabled")){A=this.QUb.x3b.P3i();for(var R of A)OfficeExt.SDXCatalog.MarkSdxPreloadStart(R),Sm.p8b===sa.a.eh(R)&&(da=!0,m=Sm.xij)}OfficeExt.SDXCatalog.PrefetchSdxAssets(n.AFrameworkApplication.K.appSettings,
n.AFrameworkApplication.K.f2a,n.AFrameworkApplication.K.kb("Application"),"*");n.AFrameworkApplication.K.$("WordEditorIdeasIsEnabled")&&OfficeExt.SDXCatalog.PrefetchSdxAssets(n.AFrameworkApplication.K.appSettings,n.AFrameworkApplication.K.f2a,n.AFrameworkApplication.K.kb("Application"),"fa000000029");R=n.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationDelayInMilliseconds",1E4);R+=m;n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000059.AutoActivationIsEnabled",
!1)&&(OfficeExt.SDXCatalog.PrefetchSdxAssets(n.AFrameworkApplication.K.appSettings,n.AFrameworkApplication.K.f2a,n.AFrameworkApplication.K.kb("Application"),Sm.p8b),window.setTimeout(()=>{const Ea=new dh.a(Sm.p8b,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),ib=new Nf.a("WordOnline","Web","en-Us"),Qb=new ei.a;Qb.optionalProperties[kf.a.pS]="Experimentation SDX";Qb.optionalProperties[kf.a.taskPaneWidth]=0;if(da){const pc={};pc.hostAddinActivationTimeStamp=Date.now();Qb.optionalProperties[kf.a.Inh]=
pc;Qb.optionalProperties[kf.a.sourceLocationOverrideResourceId]=Sm.lkf;rn.a.instance.KKf(Ea,Zi.a.Tyj,"",ib,Qb)}rn.a.instance.KKf(Ea,Zi.a.action,"AddinActivationAction",ib,Qb)},R))}});const d=this.W.resolve("Common.App.AppsForOfficeCommon.AppsForOfficeManager");this.W.resolve("Box4.AppsForOffice.IInitializeHelper").zDf(()=>{d.initialize()});this.W.resolve("WordEditor.ContentControl.IContentControlManager").TKk(this.W.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))}}Object(y.a)(Mt,"AppsForOfficePackage",
qk,[]);class Xo{constructor(){this.correlationId=this.sessionId=this.QPe=null;this.actionId=0;this.vd=null}get Fg(){return this.QPe?this.QPe:""}set Fg(d){this.QPe=d}}Object(y.a)(Xo,"AssistanceSearchVariableUrlParameterSet",null,[]);var Ys=c(174);class es{constructor(){this.Zh=!1;this.f_=!0;this.pfh=this.rrc=null}get isInitialized(){return this.Zh}initialize(d,m){const A=!!d&&!!m;A&&(this.rrc=d,this.pfh=m);this.Zh=A;n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||Ia.a.instance.Sa("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(R=>{R.Y8("Enabled").then(da=>{this.f_=da;return null},()=>null)})}Ub(d){d||(d=n.AFrameworkApplication.va);n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.f_=n.AFrameworkApplication.LF,Ia.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(m=>{m.isFeatureEnabled("mso_sendASmile",
!0).then(A=>{this.f_=n.AFrameworkApplication.LF&&A;(A=n.AFrameworkApplication.ta)&&A.updateCommandUI();return null},()=>null)}));d.qa(Q.a.WPb,K.a.frame,Object(I.a)(this,this.Oyo,"showSearchResults"))}Oyo(d,m,A,R,da){if(1===A)return n.AFrameworkApplication.K.$("IsFeedbackExperiencesAvailable")||(this.f_=!1),da&&"SourceControlId"in da&&(da=da.SourceControlId,("GiveFeedback"===da||"btnFeedback"===da||"btnFeedbackPane"===da||"PptEditingStatusBar.GiveFeedbackPane"===da||"GiveFeedbackPane"===da)&&!this.f_)?
8:Cq.SessionStatusManager.instance.Yj?8:32;v.ULS.sendTraceTag(4761738,1302,50,"");Ys.a.mark(4771);if(this.isInitialized){d=da.CommandValueId;m=da.SourceControlId;da=Object.assign(new Xo,{actionId:Q.a.WPb,vd:da});if(void 0!==d&&null!==d)da=es.gkm(d);else if(void 0!==m&&null!==m)switch(m){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":da.actionId=Q.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":da.actionId=
Q.a.TIh;break;case "btnShowTraining":case "Training":da.actionId=Q.a.wBj;break;case "btnWhatsNew":case "WhatsNew":da.actionId=Q.a.zsg}this.rrc.Mwo(this.pfh,da);Ys.a.mark(4772);return 32}Ys.a.mark(4772);return 8}dispose(){this.rrc&&(this.rrc.dispose(),this.rrc=null)}static get instance(){es._instance||(es._instance=new es);return es._instance}static gkm(d){const m=new Xo,A=d.indexOf("|");m.sessionId=d.substring(0,A);const R=d.indexOf("|",A+1);m.correlationId=d.substring(A+1,R);m.Fg=d.substr(R+1);return m}}
es._instance=null;Object(y.a)(es,"AssistanceActor",null,[10]);class Zs{constructor(){this.wMg=this.Ca=this.SUb=null;this.ZNe=!1}Mwo(d,m){if(m.actionId!==Q.a.giveFeedback||n.AFrameworkApplication.LF)if(this.ZNe&&!n.AFrameworkApplication.eL)this.SUb||(this.SUb=this.wMg()),this.SUb.WP(d,m);else if(m.actionId===Q.a.giveFeedback)this.vwo();else{d=d.Njb(m);m=null;try{sa.a.vP(d)&&(m=cb.a.vm(d,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(A){throw v.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+A.message),A;}m?v.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",d):v.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",d,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else v.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.SUb&&(this.SUb.dispose(),this.SUb=null)}upj(d,m,A){A&&Yc.c(d)?this.ZNe=!1:(this.wMg=d,this.ZNe=A);this.Ca=m}vwo(){n.AFrameworkApplication.va.processAction(Q.a.giveFeedback,2)}static createInstance(d,m,A=null){const R=new Zs;null==A?R.upj(d,m,n.AFrameworkApplication.vwh||m.$("HelpTabIsEnabled")):R.upj(d,m,A);return R}}Object(y.a)(Zs,"AssistanceDisplayManager",null,[1266,10]);
class tr{constructor(d,m,A,R,da){this.q7=d;this.lsd=m;this.xrd=A;this.IWj=R;this.Z5g=da}get lcid(){return this.q7}get namespace(){return this.lsd}get O5a(){return this.xrd}get hHk(){return this.IWj}get locale(){return this.Z5g}static xjm(d){const m=d.indexOf(".");return 0<=m&&m<d.length&&(d=parseInt(d.substring(0,m)),!isNaN(d))?d:tr.tIk}static createInstance(d){return new tr(n.AFrameworkApplication.lcid,d,tr.xjm(n.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
De.a.ug(n.AFrameworkApplication.lcid).name)}}tr.tIk=16;Object(y.a)(tr,"AssistanceSearchUrlParameterSet",null,[]);class Av{constructor(d,m){d=new gg.QueryStringBuilder(d);d.Ae("clid",m.lcid.toString());d.Ae("p1",m.namespace);d.Ae("ver",m.O5a.toString());d.Ae("apps",m.hHk);d.Ae("lc",m.locale);this._url=d.toString()}Njb(d){const m=new gg.QueryStringBuilder(this._url);m.Ae("src","TellMe");m.Ae("query",d.Fg);m.Ae("sessionid",d.sessionId);m.Ae("correlationid",d.correlationId);return m.toString()}static createInstance(d){return new Av(n.AFrameworkApplication.wwh,
d)}}Object(y.a)(Av,"AssistanceSearchUrlProvider",null,[1263]);class Nt{wc(){}init(){n.AFrameworkApplication.wBb&&!n.AFrameworkApplication.lle&&es.instance.Ub(n.AFrameworkApplication.va)}dispose(){es.instance.dispose()}csi(d){es.instance.initialize(Zs.createInstance(d,n.AFrameworkApplication.K),Av.createInstance(tr.createInstance("WDWAEndUser")))}}Object(y.a)(Nt,"AssistancePackage",null,[1,2]);class Fq{}Fq.Rhc=1;Fq.lC="AssistanceTaskPane";Fq.width=330;Fq.Mlg="AssistanceTaskPaneData";Fq.GAf="AssistanceContentFrame";
Object(y.a)(Fq,"AssistanceConstants",null,[]);var dx=c(24);class Dr{constructor(d){this.PMe=this.QMe=this.hB=this.mj=null;Ys.a.mark(4773);this.dzd=d;this.S_();this.Qz();Ys.a.mark(4774)}S_(){this.mj=this.dzd.eLc();this.bCf(this.mj.bVa.Mxh);this.mj.D7f(Object(I.a)(this,this.Uln,"onAssistanceTaskPaneHidden"));this.mj.Gm()}Qz(){ua.a.addHandler(this.hB,"load",this.QMe=Object(I.a)(this,this.Snb,"onIFrameLoad"));ua.a.addHandler(this.hB,"error",this.PMe=Object(I.a)(this,this.Rnb,"onIFrameError"))}caa(){ua.a.removeHandler(this.hB,
"load",this.QMe);this.QMe=null;ua.a.removeHandler(this.hB,"error",this.PMe);this.PMe=null}dispose(){this.caa();this.hB.parentNode.removeChild(this.hB);this.hB=null;this.mj&&(this.dzd.j7b(Fq.lC,this.mj),this.mj=null)}fef(){this.hB.src=Dr.X8g;this.mj.Hm()}WP(d,m){d=d.Njb(m);Ys.a.mark(4775);this.hB.src=d;this.mj.JY?this.mj.Gm():this.dzd.showTaskPane(this.mj)}cpa(){this.dzd.hideTaskPane(this.mj);this.fef()}bCf(d){const m=dx.a.createElement("iframe");m.src=Dr.X8g;m.style.height="100%";this.hB=m;d.appendChild(this.hB);
m.id=Fq.GAf}Uln(d){d===this.mj&&this.cpa()}Snb(d){v.ULS.sendTraceTag(4474517,1302,50,"The resource at {0} is loaded successfully in assistance task pane",d.target.src);Ys.a.mark(4776)}Rnb(d){v.ULS.sendTraceTag(4474518,1302,15,"Loading the resource at {0} failed in assistance task pane",d.target.src);Ys.a.mark(4776)}}Dr.X8g="about:blank";Object(y.a)(Dr,"AssistancePane",null,[905,10]);var Wq=c(880),ex=c(219),Kk=c(135);class Qo{eLc(){const d=new ex.CuiHelper(Kk.a.d0a,Box4Intl.Box4Strings);return Hh.a.instance.wOh(Fq.lC,
Fq.Rhc,Fq.width,Fq.Mlg,d)}showTaskPane(d){d.JY||(sf.StaticActiveAppFrame.za().T8a.Gtj(d.id),d.show(),yj.App.pn.I_a(Object(I.a)(d,d.Gm,"pollForStateAndUpdate")),yj.App.pn.updateCommandUI())}hideTaskPane(d){Hh.a.instance.hideTaskPane(d)}j7b(d,m){Hh.a.instance.j7b(d,m)}}Object(y.a)(Qo,"WordEditorTaskPaneHandler",null,[885]);class Yl extends Nt{constructor(){super();this.hXb=this.u0j=this.Ktc=this.Fkh=null}get name(){return"WordEditor.Assistance"}wc(d){this.W=d}init(){super.init();n.AFrameworkApplication.wBb&&
(n.AFrameworkApplication.K.$("HelpTabIsEnabled")&&n.AFrameworkApplication.LF&&!n.AFrameworkApplication.eL?(this.Fkh=this.W.Oa("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.csi(()=>new Uq(this.Fkh,this.Ktc,this.u0j,this.hXb,Wq.a.N9b()))):this.csi(()=>new Dr(new Qo)))}}Object(y.a)(Yl,"WordEditorAssistancePackage",Nt,[]);var Qx=c(1135);class Bv{create(){return new Qx.a}}Object(y.a)(Bv,"CustomXmlPartNodeFactory",null,[380]);class Uu{constructor(d){this.aMe=0;this.W_a=new Fk.a;this.NAb=
d}dtf(){if(this.aMe===Number.MAX_VALUE)throw v.ULS.sendTraceTag(19276675,366,10,"The namespace count reach the maximum allowed number"),Error.create("The namespaces count is larger than the maximum allowed number");const d="ns"+this.aMe.toString();this.aMe++;return d}KAi(d){return void 0===d||null===d?!1:""!==this.uRc(d)?!0:!1}isDefaultNamespace(d){return void 0===d||null===d?!1:"http://www.w3.org/XML/1998/namespace"===d}u4h(){if(void 0!==this.NAb&&null!==this.NAb){var d=RegExp('xmlns=["\']([^"]*)["\']|xmlns:([^=]*)="([^"]*)"',
"g"),m,A="";for(this.KAi("http://www.w3.org/XML/1998/namespace")||this.W_a.add("xml","http://www.w3.org/XML/1998/namespace");m=d.exec(this.NAb);)void 0!==m[1]&&null!==m[1]?A=m[1]:void 0!==m[3]&&null!==m[3]&&(A=m[3]),""===A||this.KAi(A)||this.W_a.add(this.dtf(),A)}}addNamespaceMapping(d,m){if(void 0===m||null===m||""===m||void 0===d||null===d||""===d)return v.ULS.sendTraceTag(19276676,366,10,"The namespace or prefix is empty"),!1;if(this.W_a.nb(d))return v.ULS.sendTraceTag(19714131,366,10,"The prefix is already exists"),
!1;this.W_a.add(d,m);return!0}Ysf(d){if(void 0===d||null===d||""===d)return"";let m;({value:m}=this.W_a.Fc(d,m));return void 0===m||null===m?"":m}uRc(d){if(void 0===d||null===d||""===d)return"";let m="";for(const A of this.W_a)if(A.value===d){m=A.key;break}return m}Aem(){this.u4h();let d=" ";for(const m of this.W_a)d=d+"xmlns:"+m.key+'="'+m.value+'" ';return d.trim()}}Object(y.a)(Uu,"XmlNamespaceManager",null,[]);class $s{constructor(d,m){this.NAb=this.GYa=this.Lc=this.mWb=this._id=this.Pta=null;
this.JNg=!1;this.lsd=null;this.init(d,m)}get jWa(){return this.NAb}get builtIn(){return this.JNg}get namespace(){return this.lsd}get id(){return this._id}get customXmlPartNode(){return this.mWb}selectNodes(d,m){return this.Pta.value.selectNodesByXPath(d,m)}getNodeXml(d){return this.Pta.value.getNodeXml(d)}setNodeXml(d,m){if(void 0!==m&&null!==m&&m.length>$s.CPf)return null;d=this.Pta.value.setNodeXml(d,m);void 0!==d&&null!==d&&(this.save(),this.lHj(m));return d}getNodeText(d){return this.Pta.value.getNodeText(d)}setNodeText(d,
m){return void 0!==m&&null!==m&&m.length>$s.CPf?!1:this.Pta.value.setNodeText(d,m)?(this.save(),!0):!1}getNodeBaseName(d){return this.Pta.value.getNodeBaseName(d)}getNodeNamespaceURI(d){return this.Pta.value.getNodeNamespaceURI(d)||""}getNodeType(d){return this.Pta.value.getNodeType(d)}uRc(d){return this.GYa.uRc(d)}Ysf(d){return this.GYa.Ysf(d)}wph(d,m){const A=this.GYa.addNamespaceMapping(d,m);A&&this.Pta.value.addNamespaceMapping(d,m);return A}appendChild(d,m){if(void 0!==m&&null!==m&&m.length>
$s.CPf)return null;d=this.Pta.value.appendChild(d,m);void 0!==d&&null!==d&&(this.save(),this.lHj(m));return d}uGf(){return this.jWa===this.mWb.getValue(wc.a.i1a)}Hqg(){this.init(this.mWb,this.Lc)}save(){const d=this.Lc.Pc(4);d.Db(this.mWb);const m=this.Pta.value.getDocumentElement();this.NAb=this.getNodeXml(m);this.mWb.setValue(wc.a.i1a,this.jWa);d.dispose()}init(d,m){this._id=d.getValue(wc.a.SDb);this.NAb=d.getValue(wc.a.i1a);this.JNg=d.getValue(wc.a.C6b);this.lsd=d.getValue(wc.a.yKd);this.GYa=new Uu(this.jWa);
const A=this.GYa.Aem();this.Pta=new Pd.a(()=>new OSF.XmlProcessor(this.jWa,A));this.mWb=d;this.Lc=m}lHj(d){d=new Uu(d);d.u4h();d=d.W_a;for(const m of d.keys)if(!this.GYa.isDefaultNamespace(d.J(m)))try{let A=this.GYa.dtf();for(;this.GYa.W_a.nb(A);)A=this.GYa.dtf();this.wph(A,d.J(m))}catch(A){v.ULS.sendTraceTag(20306075,366,10,"Cannot update namespace mapping as the namespace count has reached the maximum allowed number")}}}$s.CPf=1048576;Object(y.a)($s,"CustomXmlDocument",null,[886]);class ur{constructor(d,
m,A){this.Jtc=null;this.Xmh=new Ji.a;this.Dx=d;this.Itc=m;this.Lc=A}get fha(){if(void 0===this.Jtc||null===this.Jtc||23!==this.Jtc.role)this.Jtc=this.oVl();return this.Jtc}oVl(){const d=new If.GraphIterator;d.set(this.Dx.value);ye.PageNavigator.instance.GP(d);d.Tb(23);return void 0!==d&&null!==d&&52===d.Xe?d:null}CRd(d,m=!1){const A=[],R=this.fha;if(R){let da=R.Tb(24);for(;da;){const Ea=da.getValue(wc.a.yKd),ib=da.getValue(wc.a.C6b);Ea===d&&ib===m&&A.push(da);da=R.Lf(24)}}return A}oqf(d){let m=null;
const A=this.fha;if(A)for(var R=A.Tb(24);R;){R=R.getValue(wc.a.SDb);if(T.a.ih().equals(R,d)){m=A;break}R=A.Lf(24)}return m}Q8h(d){const m=d.getValue(wc.a.SDb),A=d.getValue(wc.a.i1a),R=this.Xmh.J(m);void 0!==R&&null!==R&&R.jWa===A?d=R:(d=new $s(d,this.Lc),this.Xmh.add(d.id,d),void 0!==R&&null!==R&&R.jWa!==A&&v.ULS.sendTraceTag(9187598,366,50,"Custom xml id: {0} is out of date",m));return d}DPc(){const d=[],m=this.fha;if(m)for(var A=m.Tb(24);A;)A=this.Q8h(A),d.push(A),A=m.Lf(24);return d}lQa(d){let m=
null;if(d=this.oqf(d))m=d.currentNode;return m?this.Q8h(m):null}UZe(d){let m=null;if(d.length>ur.Lbn)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,C1c:m};var A=new OSF.XmlProcessor(d,"");if(A.isValidXml()){const R=this.Lc.Pc(4);R.Ut(this.fha);A=A.getNodeNamespaceURI(A.getDocumentElement());const da=this.fha;m=this.Itc.create(1074135143);const Ea=new Rh.a(Eg.a.create(),1);m.setValue(wc.a.SDb,"{"+Lb.e(Ea.guid.toString())+"}");m.setValue(wc.a.i1a,d);m.setValue(wc.a.yKd,A||
"");m.setValue(wc.a.C6b,!1);da.Q3(m,24,Ea);R.dispose();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,C1c:m}}return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError,C1c:m}}FRh(d){if(d=this.oqf(d)){if(d.currentNode.getValue(wc.a.C6b))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError;const m=this.Lc.Pc(4);m.Ut(this.fha);d.tg();m.dispose();return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError}tio(d,
m){if(d=this.oqf(d)){const A=d.currentNode;A.getValue(wc.a.C6b)||(d=this.Lc.Pc(4),d.Ut(this.fha),A.setValue(wc.a.i1a,m),d.dispose())}}IEf(d){return d.builtIn&&"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties"===d.namespace}}ur.Lbn=1048576;Object(y.a)(ur,"WordEditorCustomXmlManager",null,[861]);class Ro{get name(){return"WordEditor.CustomXml"}init(){}dispose(){}wc(d){d.ia("WordEditor.CustomXmlPartNodeFactory",()=>new Bv).ha();d.ia("WordEditor.CustomXml.WordEditorCustomXmlManager",
()=>new ur(new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.Zc),Ia.a.instance.resolve("WordEditor.CustomXmlPartNodeFactory"),new Rj.a)).as("WordEditor.CustomXml.IWordEditorCustomXmlManager").ha()}static main(){z.a.instance.Gc(new Ro)}}Object(y.a)(Ro,"CustomXmlPackage",null,[1,2]);var Bo;(function(d){d[d.Boot=0]="Boot";d[d.Itg=1]="BeforeOpen";d[d.Vug=2]="OnPaneOpen";d[d.Uug=3]="OnPaneClose"})(Bo||(Bo={}));Object(y.b)("ReadyTime",Bo);class Vu{constructor(d,m,A,R,da){this.container=d;this.tv=m;this.actors=
A;this.VJ=R;this.lYf=(Ea,ib)=>{ib.data?this.VJ.ie(()=>{this.Od(this.tv.get(Bo.Uug));this.initialize(this.tv.get(Bo.Vug))},"WD:IOO"):this.VJ.ie(()=>{this.Od(this.tv.get(Bo.Itg));this.Od(this.tv.get(Bo.Vug));this.initialize(this.tv.get(Bo.Uug))},"WD:DOC")};this.imn=()=>{this.VJ.ie(()=>this.initialize(this.tv.get(Bo.Itg)),"WD:IBO")};da.S2b(this.lYf);da.hrh(this.imn)}boot(){this.onBoot()}onBoot(){this.VJ.ie(()=>{this.initialize(this.tv.get(Bo.Boot));this.actors.forEach(d=>d.Ub())},"WD:BOOT")}initialize(d){d.forEach(m=>
this.container.resolve(m).initialize())}Od(d){d.forEach(m=>this.container.resolve(m).Od())}}Object(y.a)(Vu,"DesignerPackageInitializer",null,[]);class Ot{lal(d,m,A,R,da){return new Vu(d,m,A,R,da)}}Object(y.a)(Ot,"DesignerInitializerFactory",null,[]);var fs=c(189),ru=c(232),fx=c(179),su=c(1055);class gx extends ed.a{constructor(d,m,A){super();this.DesiredRevisionId=this.FileId=this.TemplateUrl=null;this.TemplateUrl=d;this.FileId=m;this.DesiredRevisionId=A}ml(){return Sc.a.applyTemplate}static construct(d,
m,A){return new gx(d,m,A)}}Object(y.a)(gx,"ApplyTemplateRequest",ed.a,[]);class rg{constructor(d){this.SQ=d}applyTemplate(d,m){return new Promise((A,R)=>{const da=gx.construct(d,n.AFrameworkApplication.rootQuerySignature,m),Ea=String.format("{0}/we/OneNote.ashx?perfTag=ApplyTemplate&{1}",Ab.App.webServiceBase,n.AFrameworkApplication.rootQuerySignature);this.SQ.nj(Ea,2,vc.b(da),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,ib=>{var Qb,pc;if(null===(Qb=null===ib||void 0===ib?void 0:ib.data)||
void 0===Qb||!Qb.te)return R("No response data!");if(ib.data.Ne!==Xb.a.Zz)return R(`Bad Http Status ${ib.data.Ne}`);if(!({group:ib}=$b.a.d2(ib.data.te)).returnValue)return R("Empty ServerResponse!");Qb=null;if(null===(pc=null===ib||void 0===ib?void 0:ib.Responses)||void 0===pc||!pc.length||!(Qb=ib.Responses[0])||Qb.classId!=Sc.a.applyTemplate)return R("No valid response!");v.ULS.sendTraceTag(509642067,3016,50,"ApplyTemplate call successful.");A(Qb)},ib=>{var Qb,pc;v.ULS.sendTraceTag(509642066,3042,
10,"ApplyTemplates request failed [Status: {0}]",null===(Qb=null===ib||void 0===ib?void 0:ib.data)||void 0===Qb?void 0:Qb.status);R(null===(pc=null===ib||void 0===ib?void 0:ib.data)||void 0===pc?void 0:pc.status)},da)})}}Object(y.a)(rg,"ApplyTemplatesProxyImplementation",null,[]);var ni=c(457),xo=c(1720),Qr=c(1762),Vi=c(1081),Cv=c(1131),Dv=c(1062),Xq=c(947);class ir extends Xq.a{constructor(d,m,A=0,R=!0){super("DocumentEditedConditionId");this.Bhb=d;this.vg=m;this.Aef=A;this.kUo=R;this.QUf=this.qme=
0;this.q2c=()=>{setTimeout(()=>{var da,Ea;++this.QUf;0==this.qme&&(this.qme=(new Date).getTime());if(this.vg.oY){const ib=null===(da=this.vg.tM)||void 0===da?void 0:da.Nhl;da=null===(Ea=null===ib||void 0===ib?void 0:ib.GEb)||void 0===Ea?void 0:Ea.$Kb();null!==da&&void 0!==da&&da.some(Qb=>Qb instanceof Cv.a||Qb instanceof Dv.a||Qb instanceof Vi.a)||(0==this.Aef?this.ESi():(clearTimeout(this.Brb),this.Brb=setTimeout(()=>{this.Mwj();this.ESi();v.ULS.sendTraceTag(521446627,3016,50,"User stopped editing {0} seconds ago. Document has been edited {1} times. The last action was: {2}.                 {3} milliseconds have passed since the change began",
this.Aef/1E3,this.QUf,ib.actionId,(new Date).getTime()-this.qme);this.qme=this.QUf=0},this.Aef)))}},1E3)};this.Brb=void 0}initialize(){super.initialize();this.Bhb.bfb(this.q2c)}Od(){this.Bhb.j7c(this.q2c);this.Mwj();super.Od()}Mwj(){this.Brb&&(clearTimeout(this.Brb),this.Brb=void 0)}ESi(){this.pg(!0);this.kUo&&this.Bhb.j7c(this.q2c)}}Object(y.a)(ir,"DocumentEditedCondition",Xq.a,[]);class gs extends Xq.a{constructor(d,m,A){super("LocalStorageConditionId");this.sKi=d;this.$Oo=m;this.defaultValue=A}initialize(){var d;
super.initialize();n.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.Designer.LocalStorageConditionOverride",void 0)===this.sKi?this.pg(!0):this.pg((null!==(d=localStorage.getItem(this.sKi))&&void 0!==d?d:this.defaultValue)===this.$Oo)}}Object(y.a)(gs,"LocalStorageCondition",Xq.a,[]);var kq=c(712),lw=c(1088),pm=c(547),Zl=c(91);class Pt{constructor(d,m,A){this.sm=d;this.iNb=m;this.gMd=A;this.oVi=(R,da)=>{this.documentType=da.documentType;Pt.lAi||this.D5a();this.gMd.r2n(this.oVi)};
this.gMd.lyk(this.oVi)}D5a(){if(void 0===this.documentType||null===this.documentType)this.documentType=-1;this.userType=this.Akm();this.Mgf();const d=new pm.a;d.name=Pt.Fsl;d.dataFields=this.aal();d.dnmInterval=1;d.dnmAllowedPartA=[1,3,4,2,5];ah.a.sendDirectNumericEvent(d);Pt.lAi=!0}aal(){const d=[];[this.kJ("isBlank",this.Zvi),this.kJ("DocumentType",this.documentType),this.kJ("UserType",this.userType),this.kJ("TableCount",this.X$),this.kJ("CharacterCount",this.characterCount),this.kJ("ParagraphCount",
this.fS),this.kJ("ImageCount",this.HJ),this.kJ("ListElementsCount",this.EHi),this.kJ("BlobsCount",this.zHc),this.kJ("PageCount",this.Xy)].forEach(m=>{d.push(m)});return d}kJ(d,m){const A=new Ya.a;A.name=d;"number"===typeof m?A.int64=m:"boolean"===typeof m&&(A.bool=m);return A}Mgf(){this.fS=this.zHc=this.EHi=this.X$=this.HJ=this.characterCount=0;this.Xy=this.iNb.rHb();var d=yj.App.pn.jb.rc.ed;this.Zvi=Qe.ParagraphReader.Dba(d);if(!this.Zvi){d=this.sm.Joa(d,7,7).currentNode;var m=If.GraphIterator.eb(d);
for(d=bf.a.Gs(m,d);d.moveNext();)if(m=d.currentNode)if(pk.ImageReader.Mt(m))this.HJ++;else if(Bc.TableReader.LR(m))this.X$++;else if(Zl.ListItemReader.lg(m))this.EHi++;else if(Qe.ParagraphReader.Xb(m)){var A=io.e(m);for(let R=0;R<A.length;R++)5===A[R].vh?this.HJ++:this.zHc++;A=bg.AParagraphNode.QP(m.characterData);A=A.trim();this.characterCount+=A.length;0<A.length&&!Qe.ParagraphReader.N0(m)&&!Qe.ParagraphReader.HR(m)&&this.fS++}}}Akm(){return!0===n.AFrameworkApplication.K.$("IsO365ConsumerHost")?
1:!0===n.AFrameworkApplication.K.$("IsO365CommercialHost")?2:!0===n.AFrameworkApplication.K.$("IsEduUser")?3:0}}Pt.Fsl="Office.DNM.Word.Online.Designer.DocumentStatsEvent";Pt.lAi=!1;Object(y.a)(Pt,"DocumentStatsDnmLogger",null,[]);class mw{constructor(d){this.caf=d;this.D3g=!1;this.Fln=()=>{this.D3g=!0};this.caf.execute(m=>{var A;null===(A=m.add_onAiMakerTriggeredHandler)||void 0===A?void 0:A.call(m,this.Fln)})}get bJf(){return this.D3g}}Object(y.a)(mw,"AiMakerEngagement",null,[]);var st=c(709),tp=
c(1585),jr=c(401),Yo;(function(d){d[d.initial=0]="initial";d[d.left=1]="left";d[d.center=2]="center";d[d.right=3]="right";d[d.justify=4]="justify"})(Yo||(Yo={}));var wm;(function(d){d[d.initial=0]="initial";d[d.firstLine=1]="firstLine";d[d.hanging=2]="hanging"})(wm||(wm={}));var rq;(function(d){d[d.none=0]="none";d[d.unknownError=1]="unknownError";d[d.nonTargetDocument=2]="nonTargetDocument";d[d.trackChangesNotSupported=3]="trackChangesNotSupported";d[d.lowConfidenceDocument=4]="lowConfidenceDocument";
d[d.documentTooLarge=5]="documentTooLarge";d[d.multipleAuthorsNotSupported=6]="multipleAuthorsNotSupported"})(rq||(rq={}));var Tn;(function(d){d[d.table=0]="table";d[d.themeImage=1]="themeImage";d[d.complexDecorator=2]="complexDecorator";d[d.text2Image=3]="text2Image"})(Tn||(Tn={}));var Vk;(function(d){d[d.main=0]="main";d[d.coverPage=1]="coverPage";d[d.text2Image=2]="text2Image";d[d.letter=3]="letter";d[d.generalDocument=4]="generalDocument";d[d.toDoList=5]="toDoList";d[d.resume=6]="resume";d[d.coverLetter=
7]="coverLetter";d[d.notes=8]="notes";d[d.journal=9]="journal";d[d.letterhead=10]="letterhead";d[d.report=11]="report";d[d.article=12]="article";d[d.invoice=13]="invoice";d[d.favorites=14]="favorites";d[d.other=15]="other";d[d.none=16]="none"})(Vk||(Vk={}));var Wp;(function(d){d[d.letters=0]="letters";d[d.writing=1]="writing";d[d.lists=2]="lists";d[d.resumes=3]="resumes";d[d.business=4]="business";d[d.education=5]="education";d[d.newsletters=6]="newsletters"})(Wp||(Wp={}));(function(){function d(m,
A){void 0===m&&(m=Vk.none);void 0===A&&(A="");this.labelId=m;this.yea=A}d.prototype.getLabel=function(){var m;return null!==(m=this.labelId)&&void 0!==m?m:void 0};d.prototype.getStringId=function(){return this.yea};d.prototype.equals=function(m){return this.yea||m.yea?this.yea===m.yea:this.labelId===m.labelId};d.equals=function(m,A){return m||A?m&&A?m.equals(A):!1:m===A};d.prototype.toString=function(){return null!==this.yea?this.yea:null!==this.labelId?this.labelId.toString():""};return d})();var Bn;
(function(d){d[d.main=0]="main";d[d.templates=1]="templates";d[d.templateStyles=2]="templateStyles"})(Bn||(Bn={}));var Zf;(function(d){d[d.theme=0]="theme";d[d.templateTheme=1]="templateTheme";d[d.officeTemplate=2]="officeTemplate"})(Zf||(Zf={}));var Da;(function(d){d[d.BetweenLeftAndRightMargin=0]="BetweenLeftAndRightMargin";d[d.BetweenLeftAndRightEdge=1]="BetweenLeftAndRightEdge"})(Da||(Da={}));var Ra;(function(d){d[d.stretchInsideMargins=0]="stretchInsideMargins";d[d.stretchEdgeToEdge=1]="stretchEdgeToEdge";
d[d.original=2]="original"})(Ra||(Ra={}));var Ha;(function(d){d[d.stretchInsideMargins=0]="stretchInsideMargins";d[d.original=1]="original"})(Ha||(Ha={}));var Ba;(function(d){d[d.plain=0]="plain";d[d.predefined=1]="predefined";d[d.generatedByAI=2]="generatedByAI"})(Ba||(Ba={}));var Va=c(645),Gb=c(1558),Cb=c(138);class G{}Object(y.a)(G,"DesignerInfo",null,[]);class ha{constructor(d,m,A,R,da,Ea){this.eEb=d;this.assetId=m;this.isPremium=A;this.isL2Template=R;this.collectionId=da;this.collectionName=
Ea}}Object(y.a)(ha,"DesignInfo",null,[]);class La{}La.m5g="";La.aOf=d=>{var m;d.Elb()&&G.tB&&Ca.a(Cb.a.mUj,!0,void 0,[{name:"CollectionID",string:G.tB.collectionId},{name:"TemplateID",string:G.tB.assetId},{name:"TemplateType",string:null===(m=G.tB.eEb)||void 0===m?void 0:m.toString()},{name:"IsPremium",bool:G.tB.isPremium},{name:"IsProactivePane",bool:G.$Xc},{name:"IsL2Template",bool:G.tB.isL2Template}])};La.OLi=(d,m)=>{var A;m.Elb()&&(G.tB?Ca.a(Cb.a.nUj,!0,null,[{name:"CollectionID",string:G.tB.collectionId},
{name:"TemplateID",string:G.tB.assetId},{name:"TemplateType",string:null===(A=G.tB.eEb)||void 0===A?void 0:A.toString()},{name:"IsPremium",bool:G.tB.isPremium},{name:"IsProactivePane",bool:G.$Xc},{name:"IsL2Template",bool:G.tB.isL2Template},{name:"IsTemplateApplied",bool:d}]):v.ULS.shipAssertTag(509125727,3016,!1,"Could not log tried event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};La.B8m=d=>{var m,A;d.Elb()&&(G.tB?La.m5g!==G.tB.assetId&&(La.m5g=G.tB.assetId,Ca.a(Cb.a.lUj,
!0,void 0,[{name:"CollectionID",string:G.tB.collectionId},{name:"TemplateID",string:G.tB.assetId},{name:"TemplateType",string:null===(m=G.tB.eEb)||void 0===m?void 0:m.toString()},{name:"IsPremium",bool:G.tB.isPremium},{name:"IsProactivePane",bool:G.$Xc},{name:"IsL2Template",bool:null===(A=G.tB)||void 0===A?void 0:A.isL2Template}])):v.ULS.shipAssertTag(509096994,3016,!1,"Could not log edited event because template is not set in DesignerInfo.currentlyAppliedDesign!"))};Object(y.a)(La,"TemplateLogger",
null,[]);class lb{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep){this.oc=d;this.Sm=m;this.OJc=A;this.J4c=R;this.n7b=da;this.M8=Ea;this.D9n=ib;this.E7a=Qb;this.hC=pc;this.nN=Pc;this.eq=gd;this.taskManager=Cd;this.tS=ae;this.OKo=Xd;this.Ezj=se;this.Zd=Xe;this.Mv=Be;this.Eum=Hg;this.Hxh=Xh;this.qJ=Fl;this.FGk=Gm;this.Bnc=em;this.Zc=$n;this.vg=Ep;this.applyTheme=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(578856856,3016,!1),2;this.OJc.x3d();this.J4c.F6c();this.Sm.amIAlone||
v.ULS.sendTraceTag(573608067,3016,50,"Applying theme while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.Sm.yga,this.Sm.mC.aHa);const xp=Sj.theme.id;this.Ngb(163,()=>{this.Zd.$Wm()&&jr.a.gwa(new Va.ThemeOperationSignal({operation:Va.IThemeOperation.Apply,themeId:xp}));G.tB&&La.aOf(this.Zd);this.OKo.applyTheme(Sj.theme,!1);const vj=Sj.theme,Jr=G.tB&&0!=G.tB.eEb;G.tB=new ha(vj.type==Zf.templateTheme?1:0,vj.id.toString(),!1,vj.IsL2Template,vj.collectionId,vj.collectionName);La.OLi(Jr,
this.Zd);this.vg.R2b(this.yhc);Sj.callback&&Sj.callback(this.nN.gm.IPb)});cl&&(cl.Hs=xp,cl.NC=Sj.theme.isThemeInFavorites?1:0);2!=this.Zd.fnl()&&this.Ezj.PLi(Sj.theme);return 32};this.fixInconsistencies=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(578856857,3016,!1),2;this.OJc.x3d();this.J4c.F6c();this.Sm.amIAlone||v.ULS.sendTraceTag(573608068,3016,50,"Fixing inconsistencies while not alone {{ AmITheOnlyCoauthor: {0}, IsWebToWeb: {1} }}",this.Sm.yga,this.Sm.mC.aHa);this.Ngb(162,async()=>{try{const xp=
this.eq.Yf("UserAction",Cb.a.fixInconsistencies),vj=Date.now();this.n7b.hFk().then(()=>{Sj.callback&&Sj.callback(this.nN.gm.IPb);Ca.a(Cb.a.FGl,!0,Date.now()-vj);xp.stop()})}catch(xp){v.ULS.sendTraceTag(538240195,3016,10,xp)}});return 32};this.accept=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(578856858,3016,!1),2;this.Mv.isVisible&&this.J4c.F6c();this.Ngb(171,()=>{this.E7a.accept(Sj.paragraphNode,Sj.zuj)});cl&&(cl.Hs=Sj.role,cl.NC=this.Mv.isVisible?0:1);this.Zd.OEf()&&28==Sj.role&&this.Eum.kqn();
return 32};this.acceptAll=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(578856859,3016,!1),2;this.Ngb(167,()=>{this.E7a.acceptAll()});1!==Sj.source&&this.J4c.F6c();cl&&(cl.Hs=Sj.source,cl.NC=this.Mv.isVisible?0:1);return 32};this.reject=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(578856860,3016,!1),2;this.E7a.reject(Sj.paragraphNode,Sj.zuj);cl&&(cl.Hs=Sj.role,cl.NC=this.Mv.isVisible?0:1);return 32};this.rejectAll=(Mm,Mk,gm,cl)=>{this.Ngb(168,()=>{this.E7a.rejectAll()});cl&&(cl.NC=
this.Mv.isVisible?0:1);return 32};this.Jad=(Mm,Mk,gm,cl)=>{this.Ngb(211,()=>{this.E7a.Jad()});cl&&(cl.NC=this.Mv.isVisible?0:1);return 32};this.reviewChanges=(Mm,Mk,gm,cl)=>{this.Ngb(169,()=>{const Sj=this.nN.ucm();Sj&&this.hC.c6c(Gb.a.create(Sj))});cl&&(cl.NC=this.Mv.isVisible?0:1);return 32};this.tryAnyway=()=>{this.M8.Qpl();return 32};this.showMoreThemes=(Mm,Mk,gm,cl)=>{Mm=this.tS.s3m();cl&&(cl.Hs=Mm);return 32};this.logThemeInfo=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(546109061,3016,
!1),2;this.Ezj.PLi(Sj.theme);return 32};this.changeDesignerRole=(Mm,Mk,gm,cl,Sj)=>{Sj&&this.E7a.changeDesignerRole(Sj);this.Mv.isVisible&&this.J4c.F6c();cl&&(cl.Hs=Sj.role,cl.NC=this.Mv.isVisible?0:1);return 32};this.WJa=(Mm,Mk,gm,cl,Sj)=>{Sj&&this.E7a.WJa(Sj.paragraphNode);cl&&(cl.Hs=Sj.role,cl.NC=this.Mv.isVisible?0:1);return 32};this.Wrg=(Mm,Mk,gm,cl,Sj)=>{Sj.pKb?this.E7a.WJa(Sj.paragraphNode):this.E7a.Wrg(Sj.paragraphNode);cl&&(cl.Hs=Sj.pKb?1:0,cl.NC=this.Mv.isVisible?0:1);return 32};this.Dxn=
()=>sa.a.vP(Cb.a.ami)?(cb.a.vm(Cb.a.ami,void 0,void 0,"WordDesigner.OpenGreenroomPanel"),32):2;this.revertTheme=()=>{this.Ngb(208,()=>{this.D9n.revertTheme()});return 32};this.toggleFavorite=(Mm,Mk,gm,cl,Sj)=>{if(!Sj)return v.ULS.shipAssertTag(520488720,3016,!1),2;cl&&(cl.Hs=Sj.theme.id,cl.NC=Sj.kPm?1:0);this.tS.toggleFavorite(Sj.theme);return 32};this.applyOfficeTemplate=(Mm,Mk,gm,cl,Sj)=>{var xp;if(!Sj)return v.ULS.shipAssertTag(509693955,3016,!1),2;if(!Sj)return v.ULS.shipAssertTag(509642068,3016,
!1),2;null===(xp=this.qJ)||void 0===xp?void 0:xp.rjg();this.Hxh.showDialog();Mm=Eg.a.create();this.Bnc.MX=Mm;this.Bnc.Ikn=Sj;this.Bnc.inl=this.htg;this.Zc.addListener(this.Bnc);this.FGk.applyTemplate(Sj.template.binaryUrl,Mm.toString()).then(vj=>{if(0!=vj.StatusCode)v.ULS.shipAssertTag(509436170,3016,!1,`ApplyTemplate response not successful. OperationResult ${vj.StatusCode}`),this.htg(this.Bnc,Sj),this.wx();else{G.tB&&La.aOf(this.Zd);vj=G.tB&&0!=G.tB.eEb;const Jr=Sj.template;G.tB=new ha(2,Jr.templateId,
Jr.isPremium,Jr.isL2Template,Jr.collectionId,Jr.collectionName);La.OLi(vj,this.Zd);this.vg.R2b(this.yhc)}}).catch(vj=>{v.ULS.shipAssertTag(509638114,3016,!1,vj);this.htg(this.Bnc,Sj)});return 32};this.yhc=(Mm,Mk)=>{if(Mk.actionId===xe.a.Sua||this.vg.s9(Mk.actionId))La.aOf(this.Zd),G.tB=null,this.vg.g9f(this.yhc)};this.htg=(Mm,Mk)=>{var gm;this.Zc.removeListener(Mm);this.Hxh.mva();null===(gm=this.qJ)||void 0===gm?void 0:gm.XMd();Mk.Don(this.nN.gm.IPb)};this.wx=()=>{const Mm=new xb.StandardDialog;Mm.Cd=
0;Mm.sv(WordRibbonStrings.ApplyTemplateErrorDialogTitle,WordRibbonStrings.ApplyTemplateErrorDialogMessage,0)}}Ub(){this.oc.fb(xe.a.S_a,ic.a.view,this.applyTheme,1036);this.oc.fb(Ac.a.iPd,ic.a.view,this.fixInconsistencies,1028);this.oc.fb(Ac.a.kBd,ic.a.view,this.accept,1036);this.oc.fb(xe.a.Qeb,ic.a.view,this.acceptAll,1036);this.oc.fb(Ac.a.Dde,ic.a.view,this.reject,1036);this.oc.fb(Ac.a.K6c,ic.a.view,this.rejectAll,1036);this.oc.fb(Ac.a.designerSnoozeContextualSuggestions,ic.a.view,this.Jad,1036);
this.oc.fb(Ac.a.designerReviewChanges,ic.a.view,this.reviewChanges,1036);this.oc.fb(Ac.a.tSh,ic.a.view,this.tryAnyway,1028);this.oc.fb(Ac.a.rSh,ic.a.view,this.showMoreThemes,1036);this.oc.fb(Ac.a.mSh,ic.a.view,this.logThemeInfo,1124);this.oc.fb(Ac.a.changeDesignerRole,ic.a.view,this.changeDesignerRole,1036);this.oc.fb(Ac.a.WJa,ic.a.view,this.WJa,1036);this.oc.fb(Ac.a.sff,ic.a.view,this.Wrg,1036);this.oc.fb(Ac.a.nSh,ic.a.view,this.Dxn,1028);this.oc.fb(Ac.a.revertDesignerTheme,ic.a.view,this.revertTheme,
1028);this.oc.fb(Ac.a.g_h,ic.a.view,this.toggleFavorite,1036);this.oc.fb(xe.a.Sua,ic.a.view,this.applyOfficeTemplate,1036)}Ngb(d,m){d=this.Ugb(d,m);this.taskManager.Wb(d)}Ugb(d,m){return new $a.a(2,1,0,m,d)}}Object(y.a)(lb,"DesignerActionActor",null,[979]);const Vb=d=>{Ys.a.O5e&&window.performance.mark(d)};var tc=c(1607);class Nc{constructor(d,m,A,R,da,Ea,ib,Qb){this.oc=d;this.Mv=m;this.oSa=A;this.R9n=R;this.S9n=da;this.An=Ea;this.zt=ib;this.Zd=Qb;this.oSa.Hxk(this.LXf.bind(this))}Ub(){this.oc.fb(Ac.a.FJa,
K.a.frame,this.FJa.bind(this),1036);this.oc.fb(Ac.a.djc,ic.a.view,this.djc.bind(this),1124);this.oc.fb(Ac.a.E4f,ic.a.view,this.N5c.bind(this),1124);this.oc.fb(Ac.a.C4f,ic.a.view,this.N5c.bind(this),1124);this.oc.fb(Ac.a.D4f,ic.a.view,this.N5c.bind(this),1124);this.oc.fb(Ac.a.B4f,ic.a.view,this.N5c.bind(this),1124);this.oc.fb(Ac.a.F4f,ic.a.view,this.N5c.bind(this),1124);this.oc.fb(Ac.a.mff,ic.a.view,this.qLd.bind(this),1028);this.oc.fb(Ac.a.kff,ic.a.view,this.qLd.bind(this),1028);this.oc.fb(Ac.a.lff,
ic.a.view,this.qLd.bind(this),1028);this.oc.fb(Ac.a.jff,ic.a.view,this.qLd.bind(this),1028);this.oc.fb(Ac.a.sSh,ic.a.view,this.FJa.bind(this),1028);this.An.Q2b(this.k1.bind(this))}LXf(){this.R9n.dispatch(this.S9n.updateControlHiddenState(Cb.a.P7i,!1));Vb(Cb.a.d2i);window.performance&&"function"===typeof window.performance.measure&&window.performance.measure(Cb.a.bDn,Cb.a.e2i,Cb.a.d2i)}FJa(d,m,A,R,da){return 1===A?32:2===A?(d=Object(Oh.a)(tc.a,da)?da.id:0,G.$Xc=0!=d,R&&(R.Hs=this.Mv.isVisible?0:1,
R.NC=d),this.Mv.isVisible?this.Mv.hide():this.Mv.show(d),32):2}djc(d,m,A,R,da){if(1===A)return 32;if(!da)return 2;da&&(da[Je.a.On]=this.Mv.isVisible);return 32}N5c(d,m,A,R,da){if(1===A)return 32;if(!da)return 2;if(da)if(d===Ac.a.E4f)da[Ii.a.Visible]=!this.An.ena();else if(d===Ac.a.C4f)da[Ii.a.Visible]=this.An.ena();else if(d===Ac.a.D4f)da[Ii.a.Visible]=this.Zd.GIf()&&this.An.yWc(2);else if(d===Ac.a.B4f)da[Ii.a.Visible]=this.Zd.GIf()&&!this.An.yWc(2);else if(d!=Ac.a.F4f)return v.ULS.shipAssertTag(523850504,
3016,!1,`unexpected actionId: ${d}`),8;return 32}qLd(d,m,A){if(1===A)return 32;v.ULS.sendTraceTag(523850505,3016,50,`designerChangeSettings actionId: ${d}`);if(d===Ac.a.mff)this.An.Kvl();else if(d===Ac.a.kff)this.An.K_()?this.An.oTh():(v.ULS.sendTraceTag(509137224,3016,15,"designerDisableSuggestionsUntilUpdate fallback to local disable since roaming data is not ready"),this.An.Zff());else if(d===Ac.a.Dml)this.An.Zff();else if(d===Ac.a.lff)this.An.MEj(2);else if(d===Ac.a.jff)this.An.Glj(2),this.Mv.isVisible&&
this.Mv.hide();else return v.ULS.shipAssertTag(523850506,3016,!1,`unexpected actionId: ${d}`),8;return 32}k1(){this.zt.updateCommandUI()}}Object(y.a)(Nc,"DesignerActor",null,[979]);var hd=c(1110);class fd{constructor(d,m,A){this.oc=d;this.Era=m;this.i$=A;this.fza=(R,da,Ea)=>{var ib,Qb,pc,Pc,gd;return 1===Ea?(0===this.Era.nka&&this.Era.apc(0),v.ULS.sendTraceTag(524149770,3016,50,"CCP floatie opened or refreshed. Designer paste state: {0}. CorrelationId: {1}",null===(ib=this.Era.nka)||void 0===ib?void 0:
ib.toString(),null===(Qb=this.Era.EKb)||void 0===Qb?void 0:Qb.toString()),Ca.a("Box4PasteFloatieOpenedOrRefreshed",!0,void 0,[Object.assign(new Ya.a,{name:"DesignerPasteState",string:null===(pc=this.Era.nka)||void 0===pc?void 0:pc.toString()}),Object.assign(new Ya.a,{name:"CorrelationId",string:null===(Pc=this.Era.EKb)||void 0===Pc?void 0:Pc.toString()})]),1===this.Era.nka?32:2):2===Ea?(this.Era.DBi(this.Era.aca())&&!this.Era.DBi(null===(gd=this.Era.jJa)||void 0===gd?void 0:gd.lCn)&&n.AFrameworkApplication.va.Qb(xe.a.MTa,
2,null),this.Era.$ko(R),this.i$.jjc(Object.assign(new hd.a,{MWc:!0,aZ:"reformatPastedContentToDesignerPaste"})),R=this.Era.qGk(),v.ULS.sendTraceTag(524149771,3016,50,`Suggestions applied: ${R}`),Ab.App.tjc(()=>{this.i$.jjc(Object.assign(new hd.a,{MWc:!1,chg:!0}))}),32):2}}Ub(){this.oc.fb(xe.a.fza,ic.a.view,this.fza,1036)}}Object(y.a)(fd,"DesignerPasteActor",null,[979]);class sd{set MX(d){this.Zl=d}set inl(d){this.h1j=d}set Ikn(d){this.Rck=d}constructor(d){this.vg=d}Qnb(){}wya(){}VSa(d){d.xd.zm.id.guid.equals(this.Zl)&&
(this.hHn(),this.h1j(this,this.Rck))}hHn(){this.vg.Rfc(xe.a.Sua,this.vg.vU(),!0)}}Object(y.a)(sd,"TemplateAppliedListener",null,[]);class Kd{constructor(d,m){this.Zh=!1;this.bon=(A,R)=>{R.data?this.start():this.stop()};this.XLg=m;this.qkd=d}initialize(){this.Zh||(this.qkd.S2b(this.bon),this.Zh=!0)}Od(){}start(){for(const d of this.XLg)d.register()}stop(){for(const d of this.XLg)d.unregister()}}Object(y.a)(Kd,"WorkflowManager",null,[981,672]);class Nd{setTimeout(d,m){return window.setTimeout(d,m)}clearTimeout(d){window.clearTimeout(d)}}
Object(y.a)(Nd,"WindowTimeout",null,[980]);class we extends Xq.a{constructor(d,m,A){super(Cb.a.u0k);this.Il=d;this.Sm=m;this.hTf=A}static Dug(d,m){return!m||d.amIAlone?!0:d.mC.aHa&&0<(m&1)?0<(m&2)?!1:d.yga:!d.mC.aHa&&0<(m&4)?0<(m&8)?!1:d.yga:!0}initialize(){super.initialize();we.Dug(this.Sm,this.hTf)&&(this.Eia||v.ULS.sendTraceTag(540116318,3016,50,this.FO(this.Il,!0)),this.pg(!0))}Od(){super.Od()}}Object(y.a)(we,"CoAuthCondition",Xq.a,[]);class Ce extends Xq.a{pg(d){this.CYb===d&&d||super.pg(d)}}
Object(y.a)(Ce,"AOnChangeOrUnsatisfiedConditionProcessor",Xq.a,[]);class te extends Ce{constructor(d,m,A){super("DocumentHasHeadingConditionId");this.qS=d;this.LO=m;this.qxa=A;this.isInitialized=!1}initialize(){if(!this.isInitialized){super.initialize();this.isInitialized=!0;var d=this.qS.f0l();for(const m of d)this.LO.nMd(m)||this.qxa.y_e(m,!1);this.qxa.size&&(v.ULS.sendTraceTag(509649924,3016,50,"Document has headings suitable for image suggestions"),this.pg(!0))}}Od(){this.isInitialized&&(this.isInitialized=
!1,super.Od())}}Object(y.a)(te,"DocumentHasHeadingCondition",Ce,[]);class fe extends Ce{constructor(d,m,A,R){super(Cb.a.OUh);this.qgj=d;this.nEb=m;this.qS=A;this.qxa=R;this.rqe=this.isInitialized=!1;this.Iya=()=>{const da=this.qS.hwf();this.qxa.y_e(da,!0);this.pg(!!da)};this.n2c=()=>{n.AFrameworkApplication.lc.Wb(new $a.a(2,1,500,this.Iya));this.Od()}}initialize(){super.initialize();if(!this.isInitialized){this.isInitialized=!0;var d=this.qS.hwf();d?(this.qxa.y_e(d,!0),this.pg(!0)):this.rqe||(this.rqe=
!0,this.qgj.register(),this.nEb.register(),this.nEb.jG(this.n2c))}}Od(){this.isInitialized&&(this.isInitialized=!1,this.rqe&&(this.rqe=!1,this.nEb.kI(this.n2c),this.nEb.unregister(),this.qgj.unregister()));super.Od()}}Object(y.a)(fe,"DocumentHasTitleCondition",Ce,[]);class Cf extends Ce{constructor(){super("HeadingsImageConditionId")}kqn(){this.pg(!0)}}Object(y.a)(Cf,"HeadingsImageCondition",Ce,[978]);var Th=c(104);class Vf extends Xq.a{constructor(d,m,A,R,da=2E3){super(Cb.a.qLj);this.Bhb=d;this.lI=
m;this.qxa=A;this.rc=R;this.VKj=da;this.isInitialized=!1;this.jGi=1;this.d8e=()=>{if(!this.qxa.aJf){var Ea=Qe.ParagraphReader.$k(this.rc.ed),ib=this.qxa.bZl();null===Ea||void 0===Ea||!Ea.characterData||ib&&Ea.characterData===ib.BKf||100<=Ea.characterData.length||this.lI.lYc(Ea)||(ib=Th.FormattingReader.Xr(jd.a.create(Ea)),ib=Th.FormattingReader.Zn(ib,Me.a.fontSize,this.m1h),Ea!==this.gPd||this.m1h!==ib||this.jGl!==Ea.characterData?(this.gPd=Ea,this.m1h=ib,this.jGl=Ea.characterData,this.BUh()):(Ea=
Qe.ParagraphReader.yw(this.rc.ed,!1,!1).count,10>Ea&&Ea>this.jGi&&(this.BUh(),this.jGi=Ea)))}}}ndl(){return new $a.a(2,1,this.VKj,()=>{this.qxa.aJf=!0;this.pg(!0);this.w6d=null})}initialize(){super.initialize();this.isInitialized||(this.isInitialized=!0,this.Bhb.bfb(this.d8e),this.d8e())}Od(){this.isInitialized&&(this.isInitialized=!1,this.Bhb.j7c(this.d8e));super.Od()}BUh(){this.w6d?n.AFrameworkApplication.lc.z1(this.w6d,this.VKj):(this.w6d=this.ndl(),n.AFrameworkApplication.lc.Wb(this.w6d))}}Object(y.a)(Vf,
"ImageSuggestionWholeSessionTriggerCondition",Xq.a,[]);class Gj extends Ce{constructor(d,m){super(Cb.a.WRi);this.LO=d;this.rc=m}initialize(){super.initialize();const d=Qe.ParagraphReader.$k(this.rc.ed);this.pg(!this.LO.nMd(d))}}Object(y.a)(Gj,"NoCoverPhotoCondition",Ce,[]);class Qh extends Xq.a{constructor(d,m){super(Cb.a.oCn);this.context=m;this.h1=(A,R)=>{this.context.A_e(R.node);R.Uzi&&(this.context.UFl(),this.pg(!0))};this.H3c=d.Te(12);this.context=m}initialize(){super.initialize();this.H3c.crh(this.h1)}Od(){this.H3c.Wbj(this.h1);
super.Od()}}Object(y.a)(Qh,"PasteCondition",Xq.a,[]);class zg extends Xq.a{constructor(d){super(Cb.a.szn);this.oSa=d;this.e3d=this.isInitialized=!1;this.jXi=()=>{this.pg(this.oSa.Nvh)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.oSa.Nvh?this.pg(!0):this.e3d||(this.e3d=!0,this.oSa.Wwk(this.jXi)))}Od(){this.isInitialized&&(this.isInitialized=!1,this.e3d&&(this.oSa.R1n(this.jXi),this.e3d=!1),super.Od())}}Object(y.a)(zg,"PQLicenseCondition",Xq.a,[]);var $i=c(1641);
class xm extends Ce{constructor(d,m,A,R,da,Ea){super(Cb.a.RLn);this.q7b=d;this.iOb=m;this.s9m=A;this.rc=R;this.mb=da;this.q1=Ea;this.isInitialized=!1;this.TXi=(ib,Qb)=>{Qb.data.annotation?Qb.data.annotation.annotationType!==$i.DocumentPullQuoteAnnotation.getTypeName()?(v.ULS.shipAssertTag(542500387,3016,!1),this.pg(!1)):(ib=Qb.data.annotation.content)?(v.ULS.sendTraceTag(541446528,3016,50,"PullQuotes received; Number of detected pull quotes: {0}",ib.numberOfDetectedPullQuotes),this.pg(0<ib.numberOfDetectedPullQuotes)):
(v.ULS.shipAssertTag(542500416,3016,!1),this.pg(!1)):(v.ULS.shipAssertTag(542500386,3016,!1),this.pg(!1))}}initialize(){if(!this.isInitialized){super.initialize();var d=this.s9m.DSd();let m=!1;75>d.paragraphCount&&10>d.listElementsCount&&10>d.blobsCount&&2>d.tableCount&&(this.iOb.register(),this.q7b.register(),this.q7b.jG(this.TXi),d=this.cVl(),-1==d&&v.ULS.sendTraceTag(536941664,3016,15,"Current paragraph index for PQ signal could not be obtained."),d=new $i.PullQuotesSignal({currentParagraphIndex:d}),
this.q7b.gwa(d),this.iOb.gwa(d),this.isInitialized=m=!0);v.ULS.sendTraceTag(541446499,3016,50,"PullQuotes signal sent: {0}",m)}}Od(){this.isInitialized&&(this.q7b.kI(this.TXi),this.isInitialized=!1,super.Od())}cVl(){var d=this.mb.ib.lb;if(!d)return-1;d=d.isForward?d.Rc:d.Pa;if(!d||0>d.cpBegin)return-1;d=d.node;let m=0;if(this.ZEi(d)){var A=Qe.ParagraphReader.$k(this.rc.ed);A=this.q1.Nna(A,!1,!1);do if(this.ZEi(A.ex)){if(A.ex===d)return m;m++}while(A.h9())}return-1}ZEi(d){return Qe.ParagraphReader.Xb(d)&&
!Qe.ParagraphReader.HR(d)&&!Qe.ParagraphReader.N0(d)&&Qe.ParagraphReader.VWc(d)}}Object(y.a)(xm,"PullQuotesCondition",Ce,[]);var Xj=c(1648),Dg=c(1548);class Qg extends Ce{constructor(d,m,A,R){super(Cb.a.zzj);this.qS=d;this.uIb=m;this.qE=A;this.Zd=R;this.isInitialized=!1;this.$_f=0;this.MZd=!1;this.fWi=(da,Ea)=>{var ib;if(!Ea)v.ULS.shipAssertTag(520986718,3016,!1,"Got images for a non-existent paragraph");else if(this.uIb.has(Ea))if(++this.$_f,da=this.qS.getImages(Ea))if((null===(ib=da.BR)||void 0===
ib?void 0:ib.length)<Cb.a.M4d)v.ULS.shipAssertTag(543269218,3016,!1),this.y6d(!1);else{for(ib=0;ib<Cb.a.M4d&&da.BR[ib].category===Xj.SuggestionCategory.TextRelatedImage;)ib++;v.ULS.sendTraceTag(527210448,3016,50,`${ib} TextRelated image suggestions returned by workflow`);0<ib?(Ea=this.uIb.get(Ea),Ea.suggestion=new Dg.b(Rh.a.create(),da.BR,da.baseUrl,this.qE,this.Zd,Ea.D1d),this.y6d(!0)):this.y6d(!1)}else v.ULS.shipAssertTag(543269217,3016,!1),this.y6d(!1)}}initialize(){var d;super.initialize();if(!this.isInitialized){this.isInitialized=
!0;var m=[];for(const [A,R]of this.uIb)(null===(d=R.paragraph)||void 0===d?0:d.characterData)?(R.BKf=R.paragraph.characterData,m.push({id:A,text:R.BKf})):(v.ULS.shipAssertTag(543269214,3016,!1),this.uIb.delete(A));this.uIb.size?(this.lEi()||v.ULS.sendTraceTag(509649923,3016,50,"Request images for headings"),this.qS.initialize(),this.qS.B0e(this.fWi),this.qS.oPb(m)):(v.ULS.shipAssertTag(521184916,3016,!1),this.pg(!1))}}Od(){this.isInitialized&&(this.qS.kcj(this.fWi),this.qS.Od(),this.isInitialized=
!1);super.Od()}y6d(d){this.MZd||(this.MZd=d);this.$_f==this.uIb.size&&(this.pg(this.MZd),this.$_f=0,this.MZd=!1,this.lEi()||v.ULS.sendTraceTag(509649922,3016,50,"Received all images requested for headings"))}lEi(){return this.uIb.values().next().value.D1d}}Object(y.a)(Qg,"TextToImageCondition",Ce,[]);var cg=c(774),jf=c(1532);class Cn{constructor(d,m,A,R,da){this.Zd=d;this.n7b=m;this.zoa=A;this.gm=R;this.context=da;this.isInitialized=!1;this.rca=0;this.Lnb=(Ea,ib)=>{var Qb=ib.data.annotation;if(Qb)if(Qb.annotationType!==
jf.FormattingSuggestionsAnnotation.getTypeName())v.ULS.shipAssertTag(523068247,3016,!1);else if(Ea=this.zoa.getParent(Qb))if(ib.data.nt===cg.b.getTypeName())this.n7b.Tum(Ea);else if(ib.data.nt!==cg.a.getTypeName())v.ULS.shipAssertTag(523068249,3016,!1,`unexpected operationType: ${ib.data.nt}`);else{if(!this.Zd.QHf()&&!this.context.Sya.includes(Ea))if((Qb=Qb.content)&&Qb.range===jf.FormattingSuggestionsRange.List&&this.context.M5k(Ea))v.ULS.sendTraceTag(509870788,3016,50,`Don't skip list paragraph: ${null===
Ea||void 0===Ea?void 0:Ea.id}`);else{v.ULS.sendTraceTag(523068251,3016,50,`Skip paragraph not in pastedNodes: ${null===Ea||void 0===Ea?void 0:Ea.id}`);return}this.rca&&(Qb=[Object.assign(new Ya.a,{name:Cb.a.l6f,string:this.Zd.QHf()?"RealTimeInconsistencies":"BlueDiamondSmartPaste"})],Ca.a(Cb.a.k6f,!0,Date.now()-this.rca,Qb),this.rca=0);0<this.Zd.Pqb()&&this.context.Sya.includes(Ea)?v.ULS.sendTraceTag(521483353,3016,50,`Skip paragraph for SmartPaste CCP: ${null===Ea||void 0===Ea?void 0:Ea.id}`):this.n7b.bxo(Ea,
ib.data.annotation)}else v.ULS.shipAssertTag(523068248,3016,!1);else v.ULS.shipAssertTag(523068246,3016,!1)}}initialize(){this.isInitialized||(v.ULS.sendTraceTag(545874375,3016,50,"ConsistencySuggestionsProvider - initialize"),this.rca=Date.now(),this.zoa.jG(this.Lnb),this.gm.register(),this.zoa.register(),this.isInitialized=!0)}Od(){this.isInitialized&&(v.ULS.sendTraceTag(545874376,3016,50,"ConsistencySuggestionsProvider - deinitialize"),this.gm.unregister(),this.zoa.unregister(),this.zoa.kI(this.Lnb),
this.isInitialized=!1)}}Object(y.a)(Cn,"ConsistencySuggestionsProvider",null,[672]);class al{constructor(d,m,A,R=!0){this.clk=d;this.chk=m;this.yih=A;this.aud=R;this.eCj=(da,Ea)=>{Ea.qZ?this.aud&&this._timer?(clearTimeout(this._timer),this.HIj()):this.IDo():this.Od()};this._timer=void 0}initialize(){v.ULS.sendTraceTag(545874373,3016,50,"ConsistencySuggestionsTriggerManager - initialize");const d=this.cki();for(const m of d)m.U3(this.eCj),m.initialize()}Od(){v.ULS.sendTraceTag(545874374,3016,50,"ConsistencySuggestionsTriggerManager - deinitialize");
this.vwj();const d=this.cki();for(const m of d)m.Od(),m.dea(this.eCj)}vwj(){if(this.aud){if(!this._timer)return;clearTimeout(this._timer);this._timer=void 0}this.yih.Od()}IDo(){this.yih.initialize();this.aud&&this.HIj()}cki(){return this.aud?this.clk:this.chk}HIj(){this._timer=setTimeout(()=>{this.vwj()},3E4)}}Object(y.a)(al,"ConsistencySuggestionsTriggerManager",null,[912]);class nj{constructor(d){this.Jd=d;this.WJe=new Set;this.clear()}clear(){this.vZk()}get Sya(){return this.fbh}vZk(){this.fbh=
[];this.WJe.clear();this.dbh=!1}A_e(d){this.dbh&&this.clear();this.fbh.push(d);this.Jd&&(d=this.Jd.Aca(d))&&d.hasProperty(wc.a.listID)&&(d=d.getValue(wc.a.listID),this.WJe.add(d))}UFl(){this.dbh=!0}M5k(d){return(d=this.Jd.Aca(d))&&d.hasProperty(wc.a.listID)?(d=d.ja(wc.a.listID,-1),this.WJe.has(d)):!1}}Object(y.a)(nj,"ContextualSuggestionsContext",null,[]);var Un=c(1563);class Xp{constructor(d,m,A){this.LO=d;this.nN=m;this.hC=A;this.lqn=R=>{this.hC.ijc({role:28,paragraphNode:R.Lb.paragraph,placeholder:!1,
fpa:R});n.AFrameworkApplication.lc.Wb(new $a.a(2,1,0,()=>{this.hC.c6c(Gb.a.create(R.Lb.paragraph))},void 0,void 0,!0))}}Rxo(d){d.paragraphNode?d.suggestion?d.suggestion.rGb(d.gpa)?null==d.suggestion.eY(d.gpa)?v.ULS.shipAssertTag(541435532,3016,!1):3===this.nN.cje(new Un.b(d.suggestion,[d.paragraphNode],0,Qe.ParagraphReader.textLength(d.paragraphNode),()=>this.Tuh(d)))&&v.ULS.sendTraceTag(541435533,3016,50,"Contextual image suggestion offered"):v.ULS.shipAssertTag(541435531,3016,!1):v.ULS.shipAssertTag(540389592,
3016,!1):v.ULS.shipAssertTag(541435530,3016,!1)}Tuh(d){if(d.paragraphNode)if(d.suggestion)if(d.suggestion.rGb(d.gpa))if(null==d.suggestion.eY(d.gpa))v.ULS.shipAssertTag(527521920,3016,!1);else return v.ULS.sendTraceTag(527210447,3016,50,"Applying image suggestion. {0}",{["imageIndex"]:d.gpa,["imageConfidence"]:d.suggestion.U0l(d.gpa)}),3===this.nN.Z4i(d,m=>{m.suggestion.selectedIndex=m.gpa;if(m=this.LO.BCf(m.suggestion.rGb(m.gpa),m.paragraphNode,!0,xe.a.mBb,xe.a.A2e,{S7c:{CRb:0,cropAspectRatio:Cb.a.Qqi},
altText:m.suggestion.eY(m.gpa),vXd:xe.a.EDd},this.lqn))return{role:28,paragraphNode:m.Lb.paragraph,fpa:m,placeholder:!0}});else v.ULS.shipAssertTag(527521891,3016,!1);else v.ULS.shipAssertTag(527521890,3016,!1);else v.ULS.shipAssertTag(527521889,3016,!1)}}Object(y.a)(Xp,"ImageSuggestionHandlerImpl",null,[977]);class Lk{constructor(d,m,A,R){this.Mv=d;this.LO=m;this.rc=A;this.B1e=R}initialize(){}T5(){return this.Mv.isVisible?(v.ULS.sendTraceTag(543269248,3016,50,"Auto launch suppressed: pane already visible"),
!0):Object(st.g)()&&this.B1e.bJf?(v.ULS.sendTraceTag(509101060,3016,50,"Auto launch suppressed: AiMaker triggered"),!0):this.LO.nMd(Qe.ParagraphReader.$k(this.rc.ed))?(v.ULS.sendTraceTag(543269249,3016,50,"Auto launch suppressed: first paragraph is an image"),!0):!1}hV(){}}Object(y.a)(Lk,"ImageSuggestionSuppressionModel",null,[955]);class Ff extends Map{constructor(){super(...arguments);this.aJf=!1}y_e(d,m){if(d){var A=d.id.toString();this.has(A)?this.get(A).paragraph=d:this.set(A,{suggestion:null,
paragraph:d,BKf:"",D1d:m})}}bZl(){return this.values().next().value}}Object(y.a)(Ff,"ImageSuggestionContextMap",Map,[]);class po{constructor(d,m,A){this.Dka=d;this.eBf=m;this.qxa=A;this.isInitialized=!1;this.YBj=(R,da)=>{if(da.qZ)for(const Ea of this.qxa.values())Ea.suggestion&&this.eBf.Rxo(new Un.a(Ea.suggestion,Ea.paragraph,0));this.qxa.aJf=!1}}initialize(){if(!this.isInitialized){for(const d of this.Dka)d.U3(this.YBj),d.initialize();this.isInitialized=!0}}Od(){if(this.isInitialized){for(const d of this.Dka)d.Od(),
d.dea(this.YBj);this.isInitialized=!1}}}Object(y.a)(po,"ImageSuggestionTriggerManager",null,[912]);class Dn{constructor(d,m){this.Mv=d;this.B1e=m}initialize(){}T5(){return this.Mv.isVisible?(v.ULS.sendTraceTag(542500385,3016,50,"Auto launch suppressed: pane already visible"),!0):Object(st.g)()&&this.B1e.bJf?(v.ULS.sendTraceTag(509101059,3016,50,"Auto launch suppressed: AiMaker triggered"),!0):!1}hV(){}}Object(y.a)(Dn,"PullQuotesSuppressionModel",null,[955]);var Qt=c(1768);class tt{constructor(d,m,
A,R,da,Ea,ib=null,Qb){this.Dka=d;this.TLn=m;this.iOb=A;this.pff=R;this.nN=da;this.gm=Ea;this.qE=ib;this.Zd=Qb;this.nUd=(pc,Pc)=>{Pc.qZ&&this.Fyo().then(gd=>{v.ULS.sendTraceTag(542500378,3016,50,`PullQuotes showed: ${gd}`)});this.Od()}}initialize(){v.ULS.sendTraceTag(542500376,3016,50,"PullQuotesTriggerManager.ts - initialize");for(const d of this.Dka)d.U3(this.nUd),d.initialize()}Od(){v.ULS.sendTraceTag(542500377,3016,50,"PullQuotesTriggerManager.ts - deinitialize");for(const d of this.Dka)d.Od(),
d.dea(this.nUd)}Fyo(){return this.iOb.q9b().then(d=>{let m=0;try{for(const A of d){if(!A)return v.ULS.shipAssertTag(542500379,3016,!1),m;if(A.annotationType!==$i.PullQuoteAnnotation.getTypeName())return v.ULS.shipAssertTag(542500380,3016,!1),m;const R=A.content;if(!R)return v.ULS.shipAssertTag(542500381,3016,!1),m;if(0<R.confidence){const da=A.parent;if(!da)return v.ULS.sendTraceTag(512239202,3016,50,"Paragraph node is null."),m;const Ea=this.gm.GA(da);if(!Ea||27===Ea.role||Ea.xia)continue;let ib=
Qe.ParagraphReader.text(da);if(!ib)return v.ULS.shipAssertTag(512323934,3016,!1),m;const Qb=R.range.start,pc=R.range.length;v.ULS.sendTraceTag(538730699,3016,50,"PQ annotation info: {0}",{["annStart"]:Qb,["annLength"]:pc,["orgTextLength"]:ib.length,["paragraphLength"]:Qe.ParagraphReader.textLength(da)});0<pc&&(ib=ib.substr(Qb,pc));const Pc=Math.floor(Math.random()*Qt.a.nhj),gd=Rh.a.create();v.ULS.sendTraceTag(541446497,3016,50,"Detected pull quote info: {0}",{["suggestionId"]:gd,["confidence"]:R.confidence,
["textLength"]:ib.length,["paragraphLength"]:Qe.ParagraphReader.textLength(da),["paragraphRole"]:Ea.role});this.pff.ijc({role:27,paragraphNode:da,placeholder:!1});const Cd=this.nN.cje(new Un.b(new Dg.d(gd,1,this.qE,this.Zd,!0,Pc,ib),[da],Qb,Qb+pc,(ae,Xd)=>{if(!Xd||1!=Xd.length)return v.ULS.shipAssertTag(509744530,3016,!1,`Wrong paragraph count when applying pull quote ${null===Xd||void 0===Xd?void 0:Xd.length} suggestionId:${gd}`),!1;Xd=Xd[0];v.ULS.sendTraceTag(541446498,3016,50,"Blue dot clicked, creating pull quote with info: {0}",
{["suggestionId"]:gd,["textLength"]:ib.length,["paragraphLength"]:Qe.ParagraphReader.textLength(Xd),["paragraphRole"]:ae.role,["styleId"]:Pc});ae=[new Un.c(new Dg.d(gd,1,this.qE,this.Zd,!0,Pc,ib),Xd,Pc,ib,se=>{this.pff.c6c(Gb.a.create(se));this.pff.ijc({role:27,paragraphNode:se,placeholder:!1})})];this.TLn.KDd(ae);return!0}));Cd&&1!==Cd&&m++}}}catch(A){v.ULS.shipAssertTag(542500383,3016,!1,"Exception occurred: {0}",String.format("{0} {1}",A.message,A.stack))}finally{return m}}).catch(()=>{v.ULS.shipAssertTag(542500384,
3016,!1);return Promise.resolve(0)})}}Object(y.a)(tt,"PullQuotesTriggerManager",null,[912]);class Yq{constructor(d,m,A){this.source=d;this.event=m;this.target=A}}Object(y.a)(Yq,"Transition",null,[]);class zl{constructor(){this.EBj=[new Yq(0,0,1),new Yq(1,0,1),new Yq(1,1,2),new Yq(0,1,3),new Yq(3,2,0),new Yq(1,2,0),new Yq(2,2,0)];this.isInitialized=!1}I8m(d){const m=new Ya.a,A=new Ya.a;m.name=Cb.a.Bsl;m.int64=d.event;A.name=Cb.a.Dsl;A.int64=d.target;Ca.a(Cb.a.Csl,!0,void 0,[m,A])}transition(d,m){if(this.isInitialized&&
this.EBj)for(const A of this.EBj)if(A.event===d&&A.source===this.state)return m&&(this.I8m(A),this.state=A.target),!0;return!1}initialize(d){this.isInitialized||(this.state=d,this.isInitialized=!0)}getState(){return this.state}WLd(d){return this.transition(d,!0)}}Object(y.a)(zl,"DocumentStateMachine",null,[]);var lq=c(1541);class ut{constructor(d,m){this.pzj=d;this.AXd=m}equals(d){return!!d&&this.pzj===d.pzj&&this.AXd.length===d.AXd.length&&this.AXd.every((m,A)=>m===d.AXd[A])}}Object(y.a)(ut,"TemplateContent",
null,[]);class zs{d0o(d){this.S_m=this.Y$h(d)}RWm(d){var m;return!(null===(m=this.S_m)||void 0===m?0:m.equals(this.Y$h(d)))}Y$h(d){var m,A;let R=0;const da=[];d=Qe.ParagraphReader.yw(d,!0,!0);for(const Ea of d)if(d=Ea)Qe.ParagraphReader.RHb(d)&&da.push(d.id.toString()),R+=null!==(A=null===(m=d.characterData)||void 0===m?void 0:m.length)&&void 0!==A?A:0;return new ut(R,da)}}Object(y.a)(zs,"TemplateContentComparer",null,[]);class As{constructor(d,m,A,R,da,Ea){this.Vi=d;this.view=m;this.Bhb=A;this.vg=
R;this.r7b=da;this.Zd=Ea;this.fd=new vb.a;this.lzj=new zs;this.xtn=(ib,Qb)=>{this.vg.s9(Qb.actionId)&&this.rjg()};this.xZf=(ib,Qb)=>{this.Ryi||(this.lVi(ib,Qb),this.QDd&&this.XMd())};this.lVi=()=>{if(!this.QDd){let ib=!1;this.Exi()?ib=this.r7b.WLd(2):1===this.mQa()?this.lzj.RWm(this.view.ed)&&(ib=this.r7b.WLd(1),La.B8m(this.Zd)):ib=this.r7b.WLd(1);ib&&this.fd.raiseEvent("OnDocumentStateChanged",new lq.a(this.mQa()))}};this.EQo();this.Bhb.bfb(this.lVi);this.vg.Nrh(this.xZf);this.vg.Syk(this.xtn)}Exi(){return this.Vi.Dba(this.view.ed)}EQo(){const d=
this.Exi()?0:3;this.r7b.initialize(d)}e9h(){switch(this.mQa()){case 0:case 1:return Bn.templates;case 2:return Bn.templateStyles;default:return Bn.main}}rjg(){this.QDd=!0}XMd(){this.QDd=!1;this.r7b.WLd(0)&&this.wWo();this.lzj.d0o(this.view.ed)}wWo(){this.fd.raiseEvent("OnDocumentStateChanged",new lq.a(this.mQa()))}mQa(){return this.r7b.getState()}rrh(d){this.fd.addHandler("OnDocumentStateChanged",d)}freeze(){this.Ryi=!0}FSo(){this.Ryi=!1}}Object(y.a)(As,"DocumentStateMonitor",null,[976]);var vn=c(260);
class Yp extends vn.a{constructor(d,m,A){super(m);this.bGe=!1;this.errorState=d;this.r4a=A}get Eia(){return this.r4a&&this.bGe?!1:super.Eia}dismiss(){this.r4a&&!this.bGe&&(this.bGe=!0,this.pg(!1))}}Object(y.a)(Yp,"AErrorStateConditionProcessor",vn.a,[995,996,672]);class hs extends Yp{constructor(d){super(rq.nonTargetDocument,"DocumentLanguageErrorConditionId",!0);this.IWb=d;this.$ue=this.Aon.bind(this)}initialize(){super.initialize();void 0===this.IWb.AWc?this.IWb.vxk(this.$ue):this.LTa()}Od(){this.IWb.Obj(this.$ue);
super.Od()}LTa(){this.pg(void 0!==this.IWb.AWc&&!this.IWb.AWc)}Aon(){this.LTa();this.IWb.Obj(this.$ue)}}Object(y.a)(hs,"DocumentLanguageErrorCondition",Yp,[]);var Wm=c(336);class Er extends Yp{constructor(d){super(rq.documentTooLarge,"DocumentTooLargeErrorConditionId",!1);this.Mnb=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&(A.data.annotation?A.data.annotation.annotationType!==jf.FormattingSuggestionsSummaryAnnotation.getTypeName()?v.ULS.shipAssertTag(570781981,3016,!1):(m=A.data.annotation.content)?
this.pg(m.errorCode===jf.ErrorCode.DocumentTooLarge):v.ULS.shipAssertTag(570781982,3016,!1):v.ULS.shipAssertTag(570781980,3016,!1))};this.VWg=d}initialize(){super.initialize();this.VWg.jG(this.Mnb)}Od(){super.Od();this.VWg.kI(this.Mnb)}LTa(){}}Object(y.a)(Er,"DocumentTooLargeErrorCondition",Yp,[]);var Zo=c(1538);class Bs extends Yp{constructor(d,m,A){super(rq.lowConfidenceDocument,"LowConfidenceErrorConditionId",!0);this.nQg=-1;this.ccb=!1;this.LWf=(R,da)=>{da.data.nt===Wm.a.getTypeName()&&(da.data.annotation?
da.data.annotation.annotationType!==Zo.DocumentRoleDetectionAnnotation.getTypeName()?v.ULS.shipAssertTag(570781977,3016,!1):(R=da.data.annotation.content,R)?R.errorCode||(this.nQg=R.isTarget?1:0,this.ccb||this.LTa(),this.Nze.kI(this.LWf)):v.ULS.shipAssertTag(570781978,3016,!1):v.ULS.shipAssertTag(570781976,3016,!1))};this.Nze=d;this.gb=m;this.xj=A}initialize(){super.initialize();this.Nze.jG(this.LWf)}Od(){super.Od();this.Nze.kI(this.LWf)}LTa(){this.ccb=this.gb.Dba(this.xj.ed);this.pg(!this.nQg&&!this.ccb)}}
Object(y.a)(Bs,"LowConfidenceErrorCondition",Yp,[]);var vt=c(1260),vr=c(1261);class bl extends Yp{constructor(d,m){super(rq.multipleAuthorsNotSupported,"MultipleAuthorsErrorConditionId",!1);this.Sm=d;this.hTf=m;this.ZSg=!1}LTa(){const d=!we.Dug(this.Sm,this.hTf);this.pg(d);d&&!this.ZSg&&(this.ZSg=!0,v.ULS.sendTraceTag(556888910,vt.a.msoulscat_Wac_WordDesigner,vr.a.info,"Coauthoring error satisfied: {{ AmIAlone: {0}, AmITheOnlyCoauthor: {1}, IsWebToWeb: {2} }}",this.Sm.amIAlone,this.Sm.yga,this.Sm.mC.aHa))}}
Object(y.a)(bl,"MultipleAuthorsErrorCondition",Yp,[]);class wr extends Yp{constructor(d,m){super(rq.trackChangesNotSupported,"TrackChangeErrorConditionId",!1);this.Qd=d;this.JJa=m;this.BZi=()=>{this.LTa()}}initialize(){super.initialize();this.JJa.Cde("OnTrackChangesStatusUpdatedEventKey",this.BZi);this.LTa()}Od(){super.Od();this.JJa.J1n(this.BZi)}LTa(){this.pg(this.Qd.yg)}}Object(y.a)(wr,"TrackChangeErrorCondition",Yp,[]);class Rr{constructor(d){this.Zh=!1;this.Hjd=rq.none;this.Oue=!1;this.ZSa=()=>
{this.Lpg()};this.sa=new vb.a;this.iW=d}initialize(){if(!this.iW.count)v.ULS.shipAssertTag(570781983,3016,!1);else if(!this.Zh){for(const d of this.iW)d.initialize(),d.vCd(this.ZSa);this.Zh=!0;this.Lpg()}}Od(){if(this.Zh){for(const d of this.iW)d.aee(this.ZSa),d.Od();this.Zh=!1}}Nqh(d){this.sa.addHandler("CurrentErrorStateChangedEventKey",d)}V1n(d){this.sa.removeHandler("CurrentErrorStateChangedEventKey",d)}get FDb(){return this.Hjd}apj(d){this.Hjd!==d&&(this.Hjd=d,this.sa.raiseEvent("CurrentErrorStateChangedEventKey",
new lq.a(this.Hjd)))}Qpl(){for(const d of this.iW)d.r4a&&d.dismiss()}VPd(){this.Oue=!1;for(const d of this.iW)d.LTa();this.Lpg();return this.FDb}Avo(d){return d.r4a&&this.Oue&&this.FDb!==d.errorState}Lpg(){for(const d of this.iW)if(d.Eia&&!this.Avo(d)){this.apj(d.errorState);this.Oue=!0;return}this.apj(rq.none)}}Object(y.a)(Rr,"ErrorStateManagerV2",null,[975,672]);class Tl{constructor(d,m,A,R,da,Ea){this.taskPane=d;this.T1=m;this.cJo=A;this.M8=R;this.hC=da;this.L1=Ea;this.isInitialized=!1;this.toc=
()=>{this.taskPane.isVisible&&this.cJo.Fdc&&!this.M8.FDb&&(this.WBj(11===this.taskPane.Il?Cb.a.eUj:Cb.a.rAn),this.qAn=cb.a.$e(),window.addEventListener("FGWebSurfaceEvent",this.yLi,!0),this.T1.scj(this.toc),this.T1.mcj(this.toc),this.M8.V1n(this.toc))};this.yLi=ib=>{var Qb;"d7c04a5a-c5ed-43b1-a927-d2f31717f7ee"===(null===(Qb=null===ib||void 0===ib?void 0:ib.detail)||void 0===Qb?void 0:Qb.id)&&(ib=cb.a.$e()-this.qAn,v.ULS.sendTraceTag(529348737,3016,50,`Pane FRE shown after: ${ib}`));window.removeEventListener("FGWebSurfaceEvent",
this.yLi,!0)};this.mYi=()=>{this.WBj(Cb.a.Emn);this.hC.B2n(this.mYi)}}initialize(){this.isInitialized||(this.isInitialized=!0,this.T1.S2b(this.toc),this.T1.E0e(this.toc),this.M8.Nqh(this.toc),this.hC.H0e(this.mYi))}Od(){}WBj(d){this.L1.execute(m=>{m.logActivity(d,null)})}}Object(y.a)(Tl,"DesignerFirstRunExperienceManager",null,[972,672]);var Jg=c(127),sq=c(878),Ul=c(59),qh=c(253),Co=c(255),$f=c(74),Il=c(1080);class Yg{get state(){return this._state}constructor(){this._state="pending";this.Cyb=new Promise((d,
m)=>{this.gO=d;this.pma=m})}finally(d){return this.Cyb.finally(d)}then(d,m){return this.Cyb.then(d,m)}catch(d){return this.Cyb.catch(d)}resolve(d){this.gO(d);this._state="fulfilled"}reject(d){this.pma(d);this._state="rejected"}}Symbol.toStringTag;Object(y.a)(Yg,"DeferredPromise",null,[]);var ip=c(1729),is=c(1724),dn=c(149),uf=c(1547);const yo=(d,m,A=!0,R=()=>!0)=>{const da=new If.GraphIterator;da.set(d);Df.forEachCellInTable(da,Ea=>{(Ea=Ea.currentNode)&&R(Ea)&&(Ea.setValue(wc.a.mrb,dn.a.EDa),Ea.setValue(wc.a.jrb,
dn.a.EDa),Ea.setValue(wc.a.krb,dn.a.EDa),Ea.setValue(wc.a.lrb,dn.a.EDa));return!0});A&&(d.setValue(wc.a.pb,0),d.setValue(wc.a.qb,dn.a.EDa),d.setValue(wc.a.rb,0),d.setValue(wc.a.tb,dn.a.EDa),d.setValue(wc.a.Xa,0),d.setValue(wc.a.Ya,dn.a.EDa),d.setValue(wc.a.Va,0),d.setValue(wc.a.Wa,dn.a.EDa));da.set(d);m.MIj(da)},Al=(d,m)=>(null===d||void 0===d?void 0:d.type)===m,$o=d=>{if(!d.od())return!1;d.jd(11);return!0},wt=d=>{if(!d)return v.ULS.shipAssertTag(528779278,3016,!1),null;if(d=qh.WordSectionNavigator.instance.zL(d)){const m=
new is.a;m.marginTop=Co.a.instance.Noa(d);m.marginBottom=Co.a.instance.Owa(d);m.marginLeft=Co.a.instance.CJ(d);m.marginRight=Co.a.instance.oL(d);m.Ko=Co.a.instance.ru(d);m.uv=Co.a.instance.IB(d);m.Mxa=Co.a.instance.lXc(d);return m}v.ULS.shipAssertTag(529008003,3016,!1);return null},ti=(d,m,A)=>{var R;const da=new oi.DictionaryPropertySet;da.setValue(Dm.a.LP,d);da.setValue(Dm.a.Yja,!0);da.setValue(Dm.a.R4,!0);m.Qb(xe.a.sDa,2,da);d=[];for(A=A.ib.lb.GO(!0);A.moveNext();)(m=null===(R=A.current)||void 0===
R?void 0:R.node)&&d.push(m);return d},ao=()=>{var d=Ao.PageReader.instance.D$b();d=Qe.ParagraphReader.$k(d,!0,!0);if(!d)return v.ULS.shipAssertTag(527212705,3016,!1),!1;if(js())return!1;d=wt(d);if(!d)return!1;var m=ip.a.Sqa[3].ZMa,A=ip.a.Sqa[0].Kta,R=ip.a.Sqa[0].ZMa;if(!(d.uv===ip.a.Sqa[3].Kta&&d.Ko===m||d.uv===A&&d.Ko===R))return!1;m=ip.a.t1[0].hxb;A=ip.a.t1[0]._marginLeft;R=ip.a.t1[0].ixb;return d.marginTop===ip.a.t1[0].jxb&&d.marginBottom===m&&d.marginLeft===A&&d.marginRight&&R},js=()=>{const d=
If.GraphIterator.eb(yj.App.pn.jb.Zc);ye.PageNavigator.instance.GP(d);if(!d.currentNode)return v.ULS.shipAssertTag(527212706,3016,!1),!1;if(!d.EQa(0,m=>m instanceof Il.a))return!1;d.Rd();do{const m=d.currentNode;if(m&&m.ja(wc.a.UCb,void 0)===Cb.a.m9k)return!0}while(d.Oj());return!1},nn=(d,m)=>{d=Qe.ParagraphReader.yw(d,!1,!1);return null===d||void 0===d?void 0:d.toArray().filter(A=>{var R;const da=null===(R=null===A||void 0===A?void 0:A.characterData)||void 0===R?void 0:R.trim();return 0!==(null===
da||void 0===da?void 0:da.length)&&!(null===m||void 0===m?0:m.find(Ea=>Ea===da))})},Kn=(d,m,A,R,da,Ea,ib,Qb)=>{let pc=A.Rf(d);if(!pc.zb(14)||!pc.jd(14))return v.ULS.shipAssertTag(524115976,3016,!1),!1;if(!$o(pc))return v.ULS.shipAssertTag(524115977,3016,!1),!1;m.Oy(pc,!1,!1);m=m.OH(pc);en(d,m,R,da,Ea,ib,Qb,!0);pc=A.Rf(d);pc.od();pc.tg();pc.tg();return!0},at=(d,m)=>{d=m.Rf(d);$o(d)?d.Oj()&&m.X$h(d).Oj()&&(d.EQa(0,A=>Al(A,12)),null!==d&&Qe.ParagraphReader.isEmpty(d)&&(d.tg(),d.tg())):v.ULS.shipAssertTag(527462685,
3016,!1)},bt=(d,m,A,R,da=60)=>{var Ea,ib=Qe.ParagraphReader.yw(m,!1,!1);if(ib&&0!==ib.count){m=[];for(const Qb of ib)if(ib=Qb,0===(null===(Ea=null===ib||void 0===ib?void 0:ib.characterData)||void 0===Ea?void 0:Ea.trim().length)&&(m.push(ib),2===m.length))break;for(const Qb of d)Wu(Qb,A,R,da);for(const Qb of m)Wu(Qb,A,R,da)}},Wu=(d,m,A,R=60)=>{m.nic(d,0,Qe.ParagraphReader.textLength(d),A,R)},Xu=(d,m,A,R,da)=>{R=R.Rf(d);R.zb(14);const Ea=R.jd(14),ib=new Yg;A.ODf(d,0,Qe.ParagraphReader.textLength(d),
da,Qb=>{var pc;if(60===Qb){if(!m.read(Ea)){Qb=m.write;a:{switch(da){case uf.a.lkg:var Pc={type:Tn.table};break a;case uf.a.n5b:Pc={type:Tn.complexDecorator};break a}Pc=void 0}Qb.call(m,Ea,Pc)}0!==(null===(pc=null===d||void 0===d?void 0:d.characterData)||void 0===pc?void 0:pc.trim().length)&&m.k9o(Ea,d)}ib.resolve()});return ib},en=(d,m,A,R,da,Ea,ib,Qb=!1)=>{var pc;const Pc=d.UL,gd=A.Aei(d),Cd=ib.GA(d);d=Qe.ParagraphReader.Wda(d);const ae=jd.a.createTextRange(m,0,Qe.ParagraphReader.textLength(m));
R.Ge(ae,d);A.Nuh(m,gd);A=null!==(pc=null===Cd||void 0===Cd?void 0:Cd.role)&&void 0!==pc?pc:1;Qb&&1===A&&(da=da.Kg(Pc),da===Ul.StyleReader.wsb&&(A=2),da===Ul.StyleReader.hfd&&(A=3));1!==A&&(Ea.Bba(m,A),ib.V9c(m,A,Cd.rec,!1,Cd.k0c,Cd.u4d,Cd.listItemPrefix))},Yu=(d,m,A)=>{(d=d.properties)&&m.cfg(d,A)},ct=d=>d?d.replace(/((rgb\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}\s*\))|(#[0-9a-fA-F]{6}))/g,m=>$f.a.KId(m)):(v.ULS.shipAssertTag(523104409,3016,!1),d),tu=(d,m)=>{d=m.Rf(d);return $o(d)?!0:(v.ULS.shipAssertTag(509207309,
3016,!1),!1)};class Zu{constructor(d,m,A,R,da,Ea,ib,Qb,pc){this.Pf=d;this.sm=m;this.mb=A;this.KHc=R;this.oP=da;this.qc=Ea;this.Bz=ib;this.rc=Qb;this.Es=pc;this.CCf=(Pc,gd,Cd,ae,Xd)=>null!==gd&&void 0!==gd&&gd.properties?(null===Pc||void 0===Pc?void 0:Pc.property)===Dm.a.ft?(v.ULS.sendTraceTag(524076488,3016,50,`Image loaded after ${cb.a.$e()-Cd}`),ae&&this.WVh(gd,ae),Xd&&Xd(gd),!0):!1:(v.ULS.shipAssertTag(524076485,3016,!1),!1)}BCf(d,m,A,R=xe.a.R_,da=xe.a.A2e,Ea,ib){var Qb,pc,Pc,gd;try{if(d&&""!==
d){m||v.ULS.shipAssertTag(544011278,3016,!1,"Paragraph is not valid");var Cd=String.format('<img src="{0}"/>',d),ae=this.Mbl(m,A,da);if(ae){const Xd=null===(Qb=this.mb.ib)||void 0===Qb?void 0:Qb.lb;this.mb.Ac(new Pe.Selection([jd.a.Uc(ae,0)],!0));const se=new oi.DictionaryPropertySet;se.setValue(Dm.a.LP,Cd);se.setValue(Dm.a.R4,!0);n.AFrameworkApplication.va.Qb(R,2,se);const Xe=Qe.ParagraphReader.Wf(m,A);null===(pc=this.Es)||void 0===pc?void 0:pc.D1(0);null===(Pc=this.Es)||void 0===Pc?void 0:Pc.jVa();
this.mb.Ac(Xd);null===(gd=this.Es)||void 0===gd?void 0:gd.jOa();const Be=Zu.xSd(Xe);if(ib||Ea){const Hg=cb.a.$e();Zu.fCd(Be,Xh=>this.CCf(Xh,Be,Hg,Ea,ib))}return Be}v.ULS.shipAssertTag(545814281,3016,!1,"Unsuccessful node creation")}else v.ULS.shipAssertTag(545814280,3016,!1,"Invalid image URL")}catch(Xd){v.ULS.shipAssertTag(545814282,3016,!1,String.format("{0} {1}",Xd.message,Xd.stack))}}WVh(d,m){const A=null===d||void 0===d?void 0:d.properties;if(A)if(m){var R=this.Bz.Pc(15,m.vXd);try{R.Ky.Db(this.rc.ed),
m.S7c&&this.P7n(d,m.S7c),m.altText&&this.oP.CUa(A,m.altText)}finally{R.dispose()}}else v.ULS.shipAssertTag(523572621,3016,!1);else v.ULS.shipAssertTag(523572620,3016,!1)}Mbl(d,m,A){A=this.Bz.Pc(15,A,!1);try{A.Ky.Db(this.rc.ed);const R=this.sm.Rf(d);if(!R.od())return null;kh.OutlineElementNavigator.Yd(R);this.Pf.Oy(R,m,!1,void 0,void 0,!1);const da=new sq.a,Ea=this.qc.ZC(d);Ea&&(da.Rka=Ea.pj(Ul.StyleReader.Npc));return this.Pf.OH(R,da)}finally{A.dispose()}}nMd(d){return null!=this.sm.Rf(d).EQa(0,m=>
pk.ImageReader.cJb(m.properties))?!0:!!Zu.xSd(d)}pRk(d,m,A){if(0>=A)v.ULS.shipAssertTag(545367367,3016,!1,String.format("Aspect ratio:{0} must be bigger than 0",A));else{var R=d/m;if(A>R)return m=Math.floor((m-d/A)/m*5E4),{width:d,height:d/A,Mva:m,Jva:m};if(A<R)return d=Math.floor((d-m*A)/d*5E4),{width:m*A,height:m,Kva:d,Lva:d}}}E6e(d,m,A,R){let da={width:d,height:m};R.cropAspectRatio&&(d=this.pRk(d,m,R.cropAspectRatio),da={...da,...d},d=da.width,m=da.height);if(0===R.CRb&&A)return da.width=2*Jg.a.Yz(A.Ko-
A.marginLeft-A.marginRight)-.08,da.height=da.width/d*m,da;if(1===R.CRb&&A)return da.width=2*Jg.a.Yz(A.Ko),da.height=da.width/d*m,da.qri=-A.marginLeft,da;if(2===R.CRb&&0<R.Nyh&&0<R.Jyh)return A=Math.min(1*R.Nyh/d,1*R.Jyh/m),da.width=d*A,da.height=m*A,da;-1!==R.CRb&&v.ULS.shipAssertTag(524105118,3016,!1,"Couldn't stretch image for stretchType {0}",R.CRb);return da}TFk(d,m){var A,R,da,Ea,ib,Qb;const pc=d.properties;this.KHc.VIa(pc,m.width);this.KHc.UIa(pc,m.height);m.qri&&(null===(A=d.Lb)||void 0===
A?0:A.paragraph)&&su.a.yQa.Lza(null===(R=d.Lb)||void 0===R?void 0:R.paragraph,1,m.qri);(m.Mva||m.Jva||m.Kva||m.Lva)&&this.oP.aeg(pc,null!==(da=m.Mva)&&void 0!==da?da:0,null!==(Ea=m.Jva)&&void 0!==Ea?Ea:0,null!==(ib=m.Kva)&&void 0!==ib?ib:0,null!==(Qb=m.Lva)&&void 0!==Qb?Qb:0)}P7n(d,m){var A;if(d){var R=d.properties;if(R){var da=pk.ImageReader.WC(R);R=pk.ImageReader.YH(R);if(0>=da)v.ULS.shipAssertTag(545814284,3016,!1,String.format("Image width:{0} must be bigger than 0",da));else if(0>=R)v.ULS.shipAssertTag(545814285,
3016,!1,String.format("Image height:{0} must be bigger than 0",R));else{var Ea=wt(null===(A=d.Lb)||void 0===A?void 0:A.paragraph);m=this.E6e(da,R,Ea,m);this.TFk(d,m)}}else v.ULS.shipAssertTag(545814283,3016,!1,"Image properties should not be null")}else v.ULS.shipAssertTag(539772548,3016,!1,"Image blob should not be null")}Ajc(d,m){this.KHc.B8f(m,d);d=this.sm.Rf(m);Qe.ParagraphReader.isEmpty(d)&&this.Pf.mza(d.currentNode)}static xSd(d){var m;const A=(null===d||void 0===d?0:d.ra)?d.ra.length:0;for(let R=
0;R<A;R++){const da=d.ra.J(R);if(5==(null===(m=da.blob)||void 0===m?void 0:m.vh))return da.blob}return null}static fCd(d,m){const A=(R,da)=>{m(da)&&(d.properties.remove_propertyChanged(A),d.properties.vcj(A))};d.properties.add_propertyChanged(A);d.properties.Rrh(A)}static N4n(d){if(!d)return v.ULS.shipAssertTag(538996813,3016,!1),[d,!1];const m=/src="([\w\W]+?)"/g;let A,R=d,da=!1;for(;null!==(A=m.exec(d));)R=R.replace(A[1],Kk.a.xg(A[1])),da=!0;return[R,da]}}Object(y.a)(Zu,"DesignerImageManagerImpl",
null,[974]);var ks=c(1703),ym=c(1525);class ls{constructor(d,m,A,R){this.gm=d;this.hSb=m;this.rc=A;this.qc=R;this.isInitialized=!1;this.Jnc=new Map;this.i0f=new Map;this.fd=new vb.a;this.uZi=(da,Ea)=>{var ib;Ea.data.nt===Wm.a.getTypeName()&&(Ea.data.annotation?(da=this.w9l(Ea.data.annotation.parentPath),da.id&&da.text?Ea.data.annotation.annotationType!==ks.TextToImageAnnotation.getTypeName()?v.ULS.shipAssertTag(526424277,3016,!1):(Ea=Ea.data.annotation.content)?null!==(ib=Ea.images)&&void 0!==ib&&
ib.length?this.Jnc.set(da.text,{BR:Ea.images,baseUrl:Ea.baseUrl}):v.ULS.shipAssertTag(526424279,3016,!1):v.ULS.shipAssertTag(526424278,3016,!1):v.ULS.shipAssertTag(521184640,3016,!1),this.fd.raiseEvent("OnImagesChanged",da.id)):(v.ULS.shipAssertTag(526424276,3016,!1),this.fd.raiseEvent("OnImagesChanged",null)))}}initialize(){this.isInitialized||(this.isInitialized=!0,this.hSb.register(),this.hSb.jG(this.uZi))}Od(){this.isInitialized&&(this.isInitialized=!1,this.hSb.kI(this.uZi),this.hSb.unregister())}oej(){const d=
this.hwf();return d?this.oPb([{id:d.id.toString(),text:d.characterData}]):!0}oPb(d){d=d.filter(m=>{const A=m.id;m=m.text;return m?this.Jnc.has(m)?(this.fd.raiseEvent("OnImagesChanged",A),!1):!0:(v.ULS.sendTraceTag(512267554,3016,50,""===m?"DesignerTextToImageManager.RequestImages - paragraphText is empty":"DesignerTextToImageManager.RequestImages - paragraphText is null"),this.fd.raiseEvent("OnImagesChanged",A),!1)});if(!d.length)return!0;d.forEach(m=>{this.i0f.set(m.id,m.text);this.Jnc.set(m.text,
null)});this.Ifo(d);return!1}B0e(d){this.fd.addHandler("OnImagesChanged",d)}kcj(d){this.fd.removeHandler("OnImagesChanged",d)}hwf(){var d;const m=Qe.ParagraphReader.$k(this.rc.ed);return null===m||void 0===m||!m.characterData||m.bF?null:2===(null===(d=this.gm.GA(m))||void 0===d?void 0:d.role)||this.gm.oHf(m)&&this.qc.Kg(this.qc.hp(m))===Ul.StyleReader.wsb?m:null}f0l(){return Qe.ParagraphReader.yw(this.rc.ed,!1,!1,!1).toArray().filter(d=>{var m;const A=null===(m=this.gm.GA(d))||void 0===m?void 0:m.role;
return Object(ym.b)(A)||this.gm.oHf(d)&&this.qc.Kg(this.qc.hp(d))===Ul.StyleReader.wordStyleIdHeader?!0:!1})}n1l(){return this.Jnc.get(this.Jnc.keys().next().value)}getImages(d){d=this.i0f.get(d);return this.Jnc.get(d)}Ifo(d){d=d.map(m=>({id:m.id,body:new ks.TextToImageSignal({content:m.text})}));this.hSb.uvl(d,ks.TextToImageSignal.getTypeName())}w9l(d){let m="";d&&(d=d.split("\\",3),3<=d.length&&(m=d[2]));d=this.i0f.get(m);return{id:m,text:d}}}Object(y.a)(ls,"DesignerTextToImageManagerImpl",null,
[973]);class Ev{constructor(d){this.sa=new vb.a;this.rMg=this.c1g=this.Zh=!1;this.dv=d}get PLm(){return this.c1g}get Nvh(){return this.rMg}Hxk(d){this.sa.addHandler("LicenseStateChanged",d)}Wwk(d){this.sa.addHandler("PQLicenseStateChanged",d)}R1n(d){this.sa.removeHandler("PQLicenseStateChanged",d)}initialize(){this.Zh||(this.dv.execute(d=>{d.isFeatureEnabled(Cb.a.Jkf,Cb.a.sHi).then(m=>{m?d.getFeatureTier(Cb.a.Jkf,0).then(A=>{A=[Object.assign(new Ya.a,{name:"tier",int64:A})];Ca.a(Cb.a.b6o,!0,0,A)}):
Ca.a(Cb.a.d6o);this.rIj(m);return null});d.iza(Cb.a.Jkf,m=>{this.rIj(m.isEnabled)});d.isFeatureEnabled(Cb.a.N5i,Cb.a.sHi).then(m=>{this.vHj(m);return null});d.iza(Cb.a.N5i,m=>{this.vHj(m.isEnabled)})}),this.Zh=!0)}Od(){}rIj(d){this.c1g=d;this.sa.raiseEvent("LicenseStateChanged",new lq.a(d))}vHj(d){this.rMg=d;this.sa.raiseEvent("PQLicenseStateChanged",new lq.a(d))}}Object(y.a)(Ev,"LicenseManager",null,[971,672]);class Rt{constructor(d,m){this.Vi=d;this.rc=m}initialize(){const d=this.Vi.Dba(this.rc.ed);
v.ULS.sendTraceTag(541701569,3016,50,`isDocumentEmpty=${d}`)}Od(){}}Object(y.a)(Rt,"BlankDocumentLogger",null,[968]);class Gy{constructor(d,m,A){this.k0=d;this.zoa=m;this.T1=A;this.oZe=!1;this.I5a=null;this.rca=0;this.fde=!1;this.FVf=(R,da)=>{try{if(da.data.nt===Wm.a.getTypeName()){if(!this.fde){const Ea=[Object.assign(new Ya.a,{name:Cb.a.l6f,string:"PaneInconsistencies"})];Ca.a(Cb.a.k6f,!0,Date.now()-this.rca,Ea);this.fde=!0}if(this.I5a){let Ea;(Ea=this.I5a).interval=Ea.interval+Cb.a.GIh}else this.oZe||
(this.I5a=new $a.a(3,1,Cb.a.GIh,()=>{this.x3d();this.I5a=null}),ab.a.instance.Wb(this.I5a))}}catch(Ea){v.ULS.shipAssertTag(575930784,3016,!1,String.format("{0} {1}",Ea.message,Ea.stack))}};this.o$d=(R,da)=>{da.data&&this.rca&&Ca.a(Cb.a.sAn,!0,Date.now()-this.rca)}}initialize(){this.rca=Date.now();this.fde=!1;this.k0.jG(this.FVf);this.T1.E0e(this.o$d)}Od(){this.k0.kI(this.FVf);this.T1.mcj(this.o$d);this.fde=!0;this.rca=0}x3d(){try{this.oZe||this.zoa.q9b().then(d=>{v.ULS.sendTraceTag(575930781,3016,
50,"Consistency fix actions: {0}",d.count);Ca.a(Cb.a.ZTj,!0,void 0,[Object.assign(new Ya.a,{name:"FormattingSuggestionsCount",int64:d.count})]);const m={};for(const A of d){d=A.content;for(const R of d.suggestions)m[R.type.toString()]=R.type.toString()in m?m[R.type.toString()]+1:1}v.ULS.sendTraceTag(575930782,3016,50,"Consistency fix actions: {0} ",JSON.stringify(m));this.oZe=!0;this.I5a=null;this.k0.kI(this.FVf)})}catch(d){v.ULS.shipAssertTag(575930783,3016,!1,String.format("{0} {1}",d.message,d.stack))}}}
Object(y.a)(Gy,"ConsistencyFixActionsLogger",null,[970,672]);class Fv{constructor(d){this.pJ=d;this.YSg=this.Zh=!1;this.Fnb=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&(A.data.annotation?A.data.annotation.annotationType!==Zo.DocumentRoleDetectionAnnotation.getTypeName()?v.ULS.shipAssertTag(544035804,3016,!1):(m=A.data.annotation.content,m)?m.errorCode||(v.ULS.sendTraceTag(575248462,3016,50,"Document confidence: {0}",m.isTarget?1:0),v.ULS.sendTraceTag(544012318,3016,50,"Is well-formatted document: {0}",
m.isWellFormatted?1:0),m=[Object.assign(new Ya.a,{name:Cb.a.ssl,double:m.isTarget?1:0}),Object.assign(new Ya.a,{name:Cb.a.tsl,double:m.isWellFormatted?1:0})],Ca.a(Cb.a.rsl,!0,void 0,m),this.YSg=!0,this.Od()):v.ULS.shipAssertTag(544035805,3016,!1):v.ULS.shipAssertTag(544035803,3016,!1))}}initialize(){this.Zh||this.YSg||(this.pJ.jG(this.Fnb),this.Zh=!0)}Od(){this.Zh&&(this.pJ.kI(this.Fnb),this.Zh=!1)}}Object(y.a)(Fv,"DocumentRoleDetectionLogger",null,[967,672]);class $u{constructor(d=null,m,A){this.qE=
d;this.Dsg=m;this.Zd=A;this.lKd=0}L7m(){0===this.Zd.k3f()&&this.qE&&0<this.lKd&&(this.qE.execute(d=>{for(let m=0;m<Math.min(this.lKd,Cb.a.$bn);m++)d.logActivity(Cb.a.j3f,null)}),this.lKd=0)}F6c(){0===this.Zd.k3f()?this.lKd++:this.qE&&this.qE.execute(d=>{this.Dsg.setTimeout(()=>{d.logActivity(Cb.a.j3f,null);2===this.Zd.k3f()&&d.logActivity(Cb.a.j3f,null)},Cb.a.NIn)})}}Object(y.a)($u,"ProactiveSurveyEventLogger",null,[969]);var Ez=c(1798),av=c(1502),hx=c(2068),Do=c(38),Rx=c(119),uu=c(710),Hy=c(1723),
Sr=c(115);class Sx extends av.a{constructor(d,m,A,R){super();this.sla=d;this.fn=m;this.Uze=A;this.zTg=R;this.QXj=[Cb.a.N4e,Cb.a.O4e]}get Oca(){return this.sla.isEnabled()}get qkb(){return 3}get J3a(){return null!=this.mBg?this.mBg:this.mBg=[new hx.a(Do.a.ULj,null),new hx.a(Do.a.Jsg,null)]}QHa(d,m){const A=this.Cr.tEa;var R=this.Cr.FZc;if(A)if(3===A.type){if(A.WJ&&(R=A.WJ,this.aFh(R.CHc),1===A.action&&R.ps.includes(d))){d=m.Kh.querySelectorAll("*");for(let da=0,Ea=d.length;da<Ea;da++)this.zTg(d[da],
Do.a.Jsg);return}(R=A.HA)&&R.ps.includes(d)&&(R.ps[0]===d&&this.tho(R.CHc,A.action),this.gqb(m.Kh,A.action,d))}else R&&3===R.type&&3===A.action&&R.HA.ps.includes(d)&&this.gqb(m.Kh,0,d)}aSa(d){return Object(Oh.a)(Hy.a,d)}d3a(d,m){(d=Object(vf.a)(Hy.a,d))&&d.ps.forEach(A=>{m.add(A)})}gqb(d,m,A){if(2===m||!m){d=d.querySelectorAll("*");m=2===m?Do.a.ULj:Do.a.Jsg;for(let R=0,da=d.length;R<da;R++){const Ea=d[R];1===uu.a(Ea)&&this.VWk(A,Ea)&&this.Uze(Ea,m)}}}VWk(d,m){var A=this.fn.jRc(jd.a.create(d),1);if(!A||
!A.count)return!0;d=A.J(0).Bc;A=A.J(0).end;const R=Sr.a.Eb(m,Rx.a.Qna);m=Sr.a.Eb(m,Rx.a.c6a);return Math.max(d,R)<Math.min(A,m)}tho(d,m){switch(m){case 4:case 1:case 3:this.aFh(d);break;case 0:this.Uze(d,Cb.a.O4e);break;case 2:this.Uze(d,Cb.a.N4e)}}aFh(d){for(const m of this.QXj)this.zTg(d,m)}}Object(y.a)(Sx,"HighlightActor",av.a,[]);var Fz=c(1063);class Tx{constructor(d,m){this.wMe=this.O4g=this.RN=null;this.gb=d;this.H7=m}get key(){return"DESIGNER REVIEW"}get Ku(){return WordEditorIntl.WordEditorStrings.L_DesignerReview}reset(d){this.gb.Xb(d.node)?
this.RN=d.node:this.RN=null}lAa(){let d=null;if(!this.RN)return{returnValue:!1,RE:d};if(this.O4g!==this.RN){const m=this.H7.GA(this.RN);this.wMe=m.xia?m:null;this.O4g=this.RN}if(!this.wMe)return{returnValue:!1,RE:d};d=Object.assign(new Fz.a,{nE:this.key,contentObject:this.wMe,description:Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress});return{returnValue:!0,RE:d}}}Object(y.a)(Tx,"ReviewDetailsProvider",null,[345,346]);class Gz{constructor(d,m,A,R,da,Ea,ib,Qb){this.vxa=d;this.Cr=m;this.ZFa=
A;this.Ixh=R;this.Pfj=da;this.gZe=Ea;this.Vi=ib;this.gm=Qb}initialize(){this.Cr.j7a(this.ZFa);this.vxa.RTa(this.Ixh);this.Pfj.initialize();this.gZe.execute(d=>{d.tV(new Tx(this.Vi,this.gm))})}Od(){this.Cr.dpg(this.ZFa);this.vxa.foe(this.Ixh);this.Pfj.Od()}}Object(y.a)(Gz,"OnCanvasInitializer",null,[672]);class Hz{constructor(d,m,A){this.Zh=!1;this.v5=(R,da)=>{if(da&&da.yl&&da.yl.lb&&da.yl.lb.Pa&&da.yl.lb.Pa.node){R=da.yl.lb;var Ea=R.Pa.node;1!==da.Ux&&da.Ux||!Em.SelectionEditor.Pl(R)||!this.iik.lYc(Ea)?
this.lNg.aZk():this.lNg.kko(Ea)}};this.lNg=d;this.hb=m;this.iik=A}initialize(){this.Zh||(this.hb.Xw(this.v5),this.Zh=!0)}Od(){}}Object(y.a)(Hz,"ReviewSelectionManager",null,[672]);var Bl=c(99),on=c(140),Jl=c(409);const Vn=d=>0>d.indexOf(",")?on.FontUtils.ZBd(d,on.FontUtils.jEa(d)):d,fn=d=>{d=on.FontUtils.GQc(d).returnValue;return d.startsWith("'")||d.startsWith('"')?d.slice(1,-1):d},mq=[WordRibbonStrings.DesignerStyleFontAvenirNextDemiBold,WordRibbonStrings.DesignerStyleFontAvenir,WordRibbonStrings.DesignerStyleFontCentury,
WordRibbonStrings.DesignerStyleFontSitka,WordRibbonStrings.DesignerStyleFontWalbaum,WordRibbonStrings.DesignerStyleFontRockwellNova,WordRibbonStrings.DesignerStyleFontUnivers,WordRibbonStrings.DesignerStyleFontSagonaBook,WordRibbonStrings.DesignerStyleFontSagona,WordRibbonStrings.DesignerStyleFontFranklin,WordRibbonStrings.DesignerStyleFontPerpetua,WordRibbonStrings.DesignerStyleFontAmasisMTPro,WordRibbonStrings.DesignerStyleFontSabonNextLT,WordRibbonStrings.DesignerStyleFontTradeGothicNext,WordRibbonStrings.DesignerStyleFontCooperBlack,
WordRibbonStrings.DesignerStyleFontNeueHaasGroteskTextPro,WordRibbonStrings.DesignerStyleFontTisaOffcSerifPro,WordRibbonStrings.DesignerStyleFontQuireSans,WordRibbonStrings.DesignerStyleFontGillSansNova,WordRibbonStrings.DesignerStyleFontTheHand,WordRibbonStrings.DesignerStyleFontGoudyType,WordRibbonStrings.DesignerStyleFontPlantagenetCherokee,WordRibbonStrings.DesignerStyleFontFootlightMTLight,WordRibbonStrings.DesignerStyleFontBaskervilleOldFace,WordRibbonStrings.DesignerStyleFontLucidaCalligraphy,
WordRibbonStrings.DesignerStyleFontEbrima,WordRibbonStrings.DesignerStyleFontCorbel,WordRibbonStrings.DesignerStyleFontElephantPro,WordRibbonStrings.DesignerStyleFontDaytona,WordRibbonStrings.DesignerStyleFontBierstadt,WordRibbonStrings.DesignerStyleFontSitkaBanner,WordRibbonStrings.DesignerStyleFontGrandview,WordRibbonStrings.DesignerStyleFontSkeenaDisplay,WordRibbonStrings.DesignerStyleFontTenorite,WordRibbonStrings.DesignerStyleFontGadugi,WordRibbonStrings.DesignerStyleFontSeaford,WordRibbonStrings.DesignerStyleFontWalbaumDisplay,
WordRibbonStrings.DesignerStyleFontAgencyFB,WordRibbonStrings.DesignerStyleFontAharoni,WordRibbonStrings.DesignerStyleFontArial,WordRibbonStrings.DesignerStyleFontArialNova,WordRibbonStrings.DesignerStyleFontArialNovaBold,WordRibbonStrings.DesignerStyleFontArialNovaCondBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProBold,WordRibbonStrings.DesignerStyleFontAvenirNextLTProDemi,WordRibbonStrings.DesignerStyleFontBaguetScript,WordRibbonStrings.DesignerStyleFontBaguetScriptRegular,WordRibbonStrings.DesignerStyleFontBahnschrifr,
WordRibbonStrings.DesignerStyleFontBahnschrift,WordRibbonStrings.DesignerStyleFontBierstadtRegular,WordRibbonStrings.DesignerStyleFontBiome,WordRibbonStrings.DesignerStyleFontBodoniMT,WordRibbonStrings.DesignerStyleFontBritannic,WordRibbonStrings.DesignerStyleFontCalibri,WordRibbonStrings.DesignerStyleFontCalistoMT,WordRibbonStrings.DesignerStyleFontCavolini,WordRibbonStrings.DesignerStyleFontDubai,WordRibbonStrings.DesignerStyleFontElephantProRegular,WordRibbonStrings.DesignerStyleFontErasBoldITC,
WordRibbonStrings.DesignerStyleFontGeorgia,WordRibbonStrings.DesignerStyleFontGeorgiaPro,WordRibbonStrings.DesignerStyleFontJumble,WordRibbonStrings.DesignerStyleFontMVBoli,WordRibbonStrings.DesignerStyleFontNewsGothicMT,WordRibbonStrings.DesignerStyleFontPerpetuaBoldItalic,WordRibbonStrings.DesignerStyleFontPerpetuaItalic,WordRibbonStrings.DesignerStyleFontRastantyCortez,WordRibbonStrings.DesignerStyleFontSegoe,WordRibbonStrings.DesignerStyleFontSegoeScript,WordRibbonStrings.DesignerStyleFontSegoeUI,
WordRibbonStrings.DesignerStyleFontSegoeUIBold,WordRibbonStrings.DesignerStyleFontSitkaHeading,WordRibbonStrings.DesignerStyleFontSitkaText,WordRibbonStrings.DesignerStyleFontTenoriteBold,WordRibbonStrings.DesignerStyleFontTenoriteRegular,WordRibbonStrings.DesignerStyleFontTradeGothic,WordRibbonStrings.DesignerStyleFontTradeGothicInline,WordRibbonStrings.DesignerStyleFontVijaya,WordRibbonStrings.DesignerStyleFontWideLatin,WordRibbonStrings.DesignerStyleFontNordiqueInlineRegular];class kr{constructor(d,
m){this.Jq=d;this.title=m}}Object(y.a)(kr,"TriageOption",null,[]);class Fr extends kr{constructor(d,m,A,R,da,Ea,ib,Qb,pc){super(d,m);this.fontSize=R;this.color=da;this.bold=Ea;this.italic=ib;this.underline=Qb;this.backgroundImg=pc;this.font=Vn(A)}}Object(y.a)(Fr,"FormattedRangeTriageOption",kr,[]);class Iz extends Fr{constructor(d,m,A,R,da,Ea,ib,Qb,pc){super(0,m,A,R,da,Ea,ib,Qb,pc);this.role=d}}Object(y.a)(Iz,"RoleTriageOption",Fr,[]);class Iy extends Fr{constructor(d,m,A,R,da,Ea,ib,Qb,pc){super(1,
m,A,R,da,Ea,ib,Qb,pc);this.Y6a=d}}Object(y.a)(Iy,"PullQuoteTriageOption",Fr,[]);class Ux extends kr{constructor(d,m,A){super(2,void 0);this.imageUrl=d;this.altText=m;this.gpa=A}}Object(y.a)(Ux,"ImageTriageOption",kr,[]);class xt{constructor(d,m,A,R){this.Yhc=d;this.SAn=m;this.qc=A;this.Zd=R}f8l(d){if(!d)return v.ULS.shipAssertTag(574424853,3016,!1),this.tqf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle);let m=null;return({Muj:m}=this.SAn.sne(d.id)).returnValue?new Iz(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle,
this.Yhc.getPropertyValue(m,Me.a.font,Bl.a.PH),Math.min(this.waf(this.Yhc.getPropertyValue(m,Me.a.fontSize,Cb.a.xef)),xt.scn),$f.a.eF(this.Yhc.getPropertyValue(m,Me.a.fontColor,$f.a.I6b.a$a)),this.Yhc.getPropertyValue(m,Me.a.bold,!1),this.Yhc.getPropertyValue(m,Me.a.italic,!1),this.Yhc.getPropertyValue(m,Me.a.underline,!1),null):(v.ULS.sendTraceTag(512276631,3016,50,"No formatting information for paragraph. Showing Title style in the triage menu."),this.tqf(1,WordEditorIntl.WordEditorStrings.L_OriginalOptionTitle))}ujm(d,
m){const A=this.qc.Ar(),R=A.pj(ym.j(d));if(!R){if(14===d&&this.Zd.xpa()&&(v.ULS.sendTraceTag(541446534,3018,15,"No Caption style in the document."),m=this.rjm(A.pj(ym.j(13)),m),null!=m))return m;v.ULS.shipAssertTag(574424855,3016,!1);return this.tqf(d)}return new Iz(d,R.ja(Td.a.F6a,ym.k(d)),R.ja(Me.a.font,Bl.a.PH),m,$f.a.eF(R.ja(Me.a.fontColor,$f.a.I6b.a$a)),R.ja(Me.a.bold,!1),R.ja(Me.a.italic,!1),R.ja(Me.a.underline,!1),null)}tjm(d,m){let A=Bl.a.PH,R=$f.a.eF($f.a.I6b.a$a),da=!1,Ea="";switch(d){case 0:R=
"#201f1e";Ea="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="175" height="42" rx="2" fill="none"/><line x1="5" y1="4" x2="169" y2="4.00001" stroke="#EA6B14" stroke-width="2"/></svg>');break;case 1:R="#ffffff";A="Helvetica Neue";da=!0;Ea="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="4" width="160" height="37" fill="#5066DB"/><path d="M151 24V28.3178H152.859C152.859 29.0093 152.727 29.5981 152.464 30.0841C152.202 30.5514 151.713 30.9065 151 31.1495V33C151.582 32.9252 152.117 32.757 152.605 32.4953C153.112 32.215 153.544 31.8692 153.901 31.4579C154.257 31.0467 154.53 30.5701 154.717 30.028C154.924 29.486 155.018 28.9065 154.999 28.2897V24H151ZM156.999 14V28.3178H158.857C158.857 29.0093 158.726 29.5981 158.463 30.0841C158.2 30.5514 157.712 30.9065 156.999 31.1495V33C157.581 32.9252 158.116 32.757 158.604 32.4953C159.111 32.215 159.543 31.8692 159.899 31.4579C160.256 31.0467 160.528 30.5701 160.716 30.028C160.923 29.486 161.016 28.9065 160.998 28.2897V24H156.999Z" fill="white"/><rect x="5.6" y="0.6" width="158.8" height="35.8" stroke="black" stroke-width="1.2"/></svg>');
break;case 2:R="#007fac";A="SF Pro Display";Ea="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="3" width="162" height="34" fill="#EAEFF6"/><path d="M162 37H168V3H6V37H87H107.25H147.5" stroke="#007FAC" stroke-width="2"/><path d="M155.998 33V37.3178H157.857C157.857 38.0093 157.726 38.5888 157.463 39.0561C157.2 39.5421 156.712 39.9065 155.998 40.1495V42C156.58 41.9252 157.125 41.7477 157.632 41.4673C158.12 41.2056 158.542 40.8692 158.899 40.4579C159.256 40.0467 159.537 39.5701 159.744 39.028C159.932 38.486 160.016 37.9065 159.997 37.2897V33H155.998ZM150 33V37.3178H151.859C151.859 38.0093 151.727 38.5888 151.464 39.0561C151.202 39.5421 150.713 39.9065 150 40.1495V42C150.582 41.9252 151.126 41.7477 151.633 41.4673C152.122 41.2056 152.544 40.8692 152.901 40.4579C153.257 40.0467 153.539 39.5701 153.746 39.028C153.933 38.486 154.018 37.9065 153.999 37.2897V33H150Z" fill="#007FAC"/></svg>');
break;case 3:R="#3865a8";A="Avenir";Ea="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><svg x="0" y="2"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 0C5.89543 0 5 0.895431 5 2V25C5 36.1046 5.89543 37 7 37H83.0061C83.1025 37.2646 83.2556 37.5127 83.4655 37.7252L85.8929 40.1821C86.6692 40.9679 87.9278 40.9679 88.7041 40.1821L91.1314 37.7252C91.3413 37.5127 91.4945 37.2646 91.5909 37H167C168.105 37 169 36.1046 169 35V2C169 0.895431 168.105 0 167 0H7Z" fill="#E9EBF4"/></svg></svg>');
break;case 4:R="#201f1e",Ea="data:image/svg+xml,"+encodeURIComponent('<svg width="175" height="42" viewBox="0 0 175 42" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="3" width="2" height="6" fill="#548235"/><rect x="5" y="5" width="2" height="6" transform="rotate(-90 5 5)" fill="#548235"/><rect x="-5" y="29" width="2" height="6" transform="rotate(-90 5 29)" fill="#548235"/><rect x="7" y="19" width="2" height="6" transform="rotate(180 7 29)" fill="#548235"/><rect x="169" y="19" width="2" height="6" transform="rotate(-180 169 29)" fill="#548235"/><rect x="179" y="27" width="2" height="6" transform="rotate(90 169 27)" fill="#548235"/><rect x="169" y="3" width="2" height="6" transform="rotate(90 169 3)" fill="#548235"/><rect x="167" y="3" width="2" height="6" fill="#548235"/></svg>')}return new Iy(d,
m,A,this.waf(Cb.a.xef),R,da,!1,!1,Ea)}sjm(d,m){return new Ux(null===d||void 0===d?void 0:d.dwf(m),null===d||void 0===d?void 0:d.eY(m),m)}tqf(d,m=null){return new Iz(d,m||ym.k(d),Bl.a.PH,this.waf(Cb.a.xef),$f.a.eF($f.a.I6b.a$a),!1,!1,!1,null)}rjm(d,m){return null==d?null:new Iz(14,ym.k(14),d.ja(Me.a.font,Bl.a.PH),m,$f.a.eF(d.ja(Me.a.fontColor,$f.a.I6b.a$a)),!1,!0,!1,null)}waf(d){return d/2}}xt.scn=25;Object(y.a)(xt,"TriageOptionFactory",null,[965]);class Cs{constructor(d,m){this.options=d;this.selectedIndex=
m}}Object(y.a)(Cs,"TriageOptions",null,[]);class jp{constructor(d,m,A,R){this.gm=d;this.ene=m;this.Zd=A;this.lI=R}$7l(d){var m;if(!d)return v.ULS.shipAssertTag(574424851,3016,!1),null;const A=null===(m=this.lI.DU(d))||void 0===m?void 0:m.suggestion;m=this.gm.GA(d);return Object(Dg.e)(A)?this.pbm(A):2===(null===A||void 0===A?void 0:A.Jq)?this.j1l(A):this.LVl(d,m)}LVl(d,m){const A=jp.vjm(m.role,this.Zd.xpa()),R=Array(A.count-9+Math.max(3,this.gm.eAf+1)+1);R[jp.original]=this.ene.f8l(d);d=jp.original;
let da=1;for(let Ea=0;Ea<A.count;Ea++){const ib=A.J(Ea);if(this.Wto(ib)){da--;continue}const Qb=Ea+da;ib.role===m.role&&(d=Qb);R[Qb]=this.ene.ujm(ib.role,ib.dJ)}return new Cs(R,d)}pbm(d){const m=jp.qbm();let A,R=jp.original;A=Array(m.count);for(let da=0;da<m.count;da++){const Ea=m.J(da);Ea.dJ==d.Y6a&&(R=da);A[da]=this.ene.tjm(Ea.dJ,d.f5c)}return new Cs(A,R)}j1l(d){let m;m=Array(d.Vmc);for(let A=0;A<d.Vmc;A++)m[A]=this.ene.sjm(d,A);return new Cs(m,d.selectedIndex)}Odm(d,m){var A;if(!d)return v.ULS.shipAssertTag(572301728,
3016,!1),jp.original;if(!m)return v.ULS.shipAssertTag(572301729,3016,!1),jp.original;const R=null===(A=this.lI.DU(m))||void 0===A?void 0:A.suggestion;if(Object(Dg.e)(R))return R.Y6a;if(2===(null===R||void 0===R?void 0:R.Jq))return R.selectedIndex;if(0===(null===R||void 0===R?void 0:R.Jq))for(m=this.gm.GA(m),A=0;A<d.length;A++)if(0!==d[A].Jq)v.ULS.shipAssertTag(527569926,3016,!1,`${d[A].Jq}`);else if(d[A].role===m.role)return A;return jp.original}Wto(d){return 6<d.role&&12>=d.role&&4+this.gm.eAf<d.role}static vjm(d,
m=!1){const A=new U.a;A.add({role:13,dJ:12});A.add({role:4,dJ:19});A.add({role:5,dJ:18});A.add({role:6,dJ:17});A.add({role:7,dJ:16});A.add({role:8,dJ:15});A.add({role:9,dJ:14});A.add({role:10,dJ:13});A.add({role:11,dJ:12});A.add({role:12,dJ:12});A.add({role:2,dJ:25});A.add({role:3,dJ:19});m&&A.insert(jp.tUk,{role:14,dJ:11});15===d&&A.insert(jp.j2m,{role:15,dJ:12});return A}static qbm(){const d=new U.a;d.add({role:27,dJ:0});d.add({role:27,dJ:1});d.add({role:27,dJ:2});d.add({role:27,dJ:3});d.add({role:27,
dJ:4});return d}}jp.original=0;jp.tUk=1;jp.j2m=4;Object(y.a)(jp,"TriageOptionProvider",null,[964]);class St extends vn.a{constructor(d){super("FormattingSuggestionsReadyConditionId");this.pJ=d;this.YWf=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&A.data.annotation&&A.data.annotation.annotationType===jf.FormattingSuggestionsSummaryAnnotation.getTypeName()&&(m=A.data.annotation.content)&&!m.errorCode&&(this.pg(!0),this.pJ.kI(this.YWf))}}initialize(){super.initialize();this.pJ.jG(this.YWf)}Od(){this.pJ.kI(this.YWf);
super.Od()}}Object(y.a)(St,"FormattingSuggestionsReadyCondition",vn.a,[]);class ix extends vn.a{constructor(d){super("RoleDetectionReadyCondition");this.pJ=d;this.NYf=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&A.data.annotation&&A.data.annotation.annotationType===Zo.DocumentRoleDetectionAnnotation.getTypeName()&&(m=A.data.annotation.content)&&!m.errorCode&&(this.pg(!0),this.pJ.kI(this.NYf))}}initialize(){super.initialize();this.pJ.jG(this.NYf)}Od(){this.pJ.kI(this.NYf);super.Od()}}Object(y.a)(ix,"RoleDetectionReadyCondition",
vn.a,[]);class bv extends vn.a{constructor(d){super("ThemeGeneratorReadyCondition");this.a2=d;this.kZf=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&A.data.annotation&&A.data.annotation.annotationType===Va.ThemeGeneratorAnnotation.getTypeName()&&A.data.annotation.content&&(this.pg(!0),this.a2.kI(this.kZf))}}initialize(){super.initialize();this.a2.jG(this.kZf)}Od(){this.a2.kI(this.kZf);super.Od()}}Object(y.a)(bv,"ThemeGeneratorReadyCondition",vn.a,[]);var vu=c(177);class jx{constructor(d,m,A,R,da,Ea,ib,
Qb,pc,Pc){this.zt=d;this.LEa=m;this.T1=A;this.M8=R;this.focusManager=da;this.Syj=Ea;this.Pog=ib;this.OJc=Qb;this.oSa=pc;this.OIn=Pc;this.Npd=this.Vs=this.Zh=!1;this.z1b=0;this.ELn=(gd,Cd)=>{Cd?Cd.data?this.Vdd(Cd.data):v.ULS.shipAssertTag(556373976,3016,!1):v.ULS.shipAssertTag(556373975,3016,!1)};this.a6f=()=>{this.NUa(!0);this.Npd||this.G$();this.zt.updateCommandUI()};this.$5f=()=>{this.OJc.x3d();this.OJc.Od();this.OIn.L7m();this.NUa(!1);this.nea();this.zt.updateCommandUI();Ca.c(Ac.a.Z_k,void 0,
void 0,void 0,12)}}get isVisible(){return this.Vs}get Il(){return this.z1b}NUa(d){d!==this.Vs&&(this.Vs=d,this.T1.oPn(this.Vs))}show(d=0){this.isVisible?this.G$():(this.T1.mPn(),this.initialize(),this.M8.VPd(),this.Npd=!!d,this.z1b=d,this.$hg())}hide(){this.Pog().then(d=>{d.hideTaskPane(Cb.a.ZP,Cb.a.taskPaneLocation);return null})}initialize(){this.Zh||(this.LEa.Bzk(this.ELn),this.S_(),this.jka(),this.Zh=!0)}S_(){this.Syj.dPa();this.Syj.k6b(this.focusManager)}jka(){const d=this.focusManager.fe(Cb.a.ZP);
d.parent=vu.AFrame.Ap;d.bindAction(Im.KeyInputManager.PG(Box4Intl.Box4Strings.l_HK_Undo),xe.a.undo);d.bindAction(Im.KeyInputManager.PG(Box4Intl.Box4Strings.l_HK_Redo),xe.a.Gja)}G$(){this.focusManager.mg(Cb.a.ZP)}nea(){this.focusManager.mg(vu.AFrame.In)}$hg(){const d=this.LEa.Yha();d.isPaneAutoOpened=this.Npd;d.Il=this.z1b;this.Pog().then(m=>{m.showTaskPane(Cb.a.ZP,this.xA(d));return null})}Vdd(d){this.isVisible&&this.Pog().then(m=>{m.updateTaskPane(Cb.a.ZP,this.xA(d));return null})}xA(d){return Object.assign(new Jm.a,
{title:this.oSa.PLm?WordEditorIntl.WordEditorStrings.L_Designer:String.format("{0} ({1})",WordEditorIntl.WordEditorStrings.L_Designer,WordEditorIntl.WordEditorStrings.L_Preview),hideHeader:!1,width:Cb.a.taskPaneWidth,location:Cb.a.taskPaneLocation,contentProps:d,onOpen:this.a6f,onClose:this.$5f,enableResize:!1,isModernPane:!0,isPaneAutoOpened:this.Npd,Il:this.z1b})}}Object(y.a)(jx,"DesignerTaskPane",null,[963]);class yt{constructor(){this.sa=new vb.a}S2b(d){this.sa.addHandler("OnVisibilityChanged",
d)}scj(d){this.sa.removeHandler("OnVisibilityChanged",d)}E0e(d){this.sa.addHandler("OnLoadingStateChanged",d)}mcj(d){this.sa.removeHandler("OnLoadingStateChanged",d)}hrh(d){this.sa.addHandler("OnBeforeOpen",d)}oPn(d){this.sa.raiseEvent("OnVisibilityChanged",new lq.a(d))}nPn(d){this.sa.raiseEvent("OnLoadingStateChanged",new lq.a(d))}mPn(){this.sa.raiseEvent("OnBeforeOpen",new Sys.EventArgs)}}Object(y.a)(yt,"DesignerTaskPaneEvents",null,[961,962]);class Tt{constructor(d,m){this.T1=d;this.conditions=
m;this.uwb=this.isInitialized=!1;this.ZSa=()=>{this.bEh()}}initialize(){if(0==this.conditions.count)v.ULS.shipAssertTag(556619356,3016,!1);else if(!this.isInitialized){for(const d of this.conditions)d.initialize(),d.vCd(this.ZSa);this.isInitialized=!0;this.bEh()}}Od(){if(this.isInitialized){for(const d of this.conditions)d.aee(this.ZSa),d.Od();this.isInitialized=!1}}get Fdc(){return this.uwb}lpj(d){this.uwb!==d&&(this.uwb=d,this.T1.nPn(this.uwb))}bEh(){for(const d of this.conditions)if(!d.Eia){this.lpj(!1);
return}this.lpj(!0)}}Object(y.a)(Tt,"PaneLoadingManager",null,[960]);class Vx{constructor(d,m){this.Oh=!1;this.Z7j=d;this.Ky=m}dispose(){var d;this.Oh||(this.Ky.dispose(),null===(d=this.Z7j)||void 0===d?void 0:d.dispose(),this.Oh=!0)}}Object(y.a)(Vx,"DesignerTransaction",null,[983,10]);class dt{constructor(d,m){this.Lc=d;this.H7=m}Pc(d,m,A=!0){d=this.Lc.Pc(d);d.Uj=m;return new Vx(A?this.H7.b6n():null,d)}}Object(y.a)(dt,"DesignerTransactionFactory",null,[959]);class xB{constructor(d,m){this.yBd=d;
this.K4c=m}trigger(d,m){m?(v.ULS.sendTraceTag(554742742,3016,50,`DesignerProactiveTriggerManager.triggerDesigner - shouldStart=${m.qZ}`),m.qZ&&this.K4c.O3e(1,()=>{this.yBd.Qb(Ac.a.FJa,2,new tc.a(m.id))})):v.ULS.shipAssertTag(521172809,3016,!1)}}Object(y.a)(xB,"OpenDesignerPaneTriggerAction",null,[958]);class yB{constructor(d,m,A){this.GBd=d;this.EZe=m;this.Il=A}}Object(y.a)(yB,"TeachingCalloutButtonEventAction",null,[]);class Jz{constructor(d,m,...A){this.L1=d;this.Qlg=m;this.gCj=R=>{for(const da of this.fAh)(null===
R||void 0===R?void 0:R.type)===da.GBd&&da.EZe&&(v.ULS.sendTraceTag(520127499,3016,50,`TeachingCalloutTriggerAction.triggerTeachingActivityEventAction - buttonAction=${da.EZe}`),Ca.a(da.GBd),da.EZe.trigger(this,{id:da.Il,qZ:!0}),window.removeEventListener(da.GBd,this.gCj,!0))};if(A){this.fAh=A;for(const R of this.fAh)window.addEventListener(R.GBd,this.gCj,!0)}}trigger(d,m){m?(v.ULS.sendTraceTag(521172628,3016,50,`TeachingCalloutTriggerAction.trigger - shouldStart=${m.qZ}`),m.qZ&&this.L1&&this.Qlg&&
(Ca.a(this.Qlg),this.L1.execute(A=>{A.logActivity(this.Qlg,null)}))):v.ULS.shipAssertTag(521172808,3016,!1)}}Object(y.a)(Jz,"TeachingCalloutTriggerAction",null,[958]);class Jp extends kq.a{constructor(d,m,A,R){super(d,m,A,3016,"OnTriggerImageSuggestionEventKey");this.Uej=R}x3a(d){super.x3a(d);super.bDd()&&super.Zjb(this.Uej)}Zjb(d){super.Zjb(d);this.yza(!1);super.Zjb(this.Uej)}yza(d=!0){var m;super.yza(d&&!(null===(m=this.Gma)||void 0===m?0:m.T5()))}}Object(y.a)(Jp,"AutoResetSequentialTriggerModel",
kq.a,[]);class an extends vn.a{constructor(d){super(Cb.a.pLd);this.KH=d}initialize(){super.initialize();this.zth=this.KH.pk(19,()=>{this.pg(!0)})}Od(){this.zth&&this.zth.Eka(!0);this.gAa&&n.AFrameworkApplication.lc.ff(this.gAa);super.Od()}}Object(y.a)(an,"DesignerAfterApplicationBootCondition",vn.a,[]);var nw=c(995);class Wx extends vn.a{constructor(){super(Cb.a.xpl)}initialize(){super.initialize();Object(nw.a)().then(d=>{this.pg(!d)}).catch(()=>{this.pg(!0)})}}Object(y.a)(Wx,"DisabledCopilotCondition",
vn.a,[]);class zB extends vn.a{constructor(d){super(Cb.a.Cml);this.lRh=d}initialize(){super.initialize();0<=this.lRh&&(this.gAa=new $a.a(2,1,1E3*this.lRh,()=>{this.pg(!0)}),n.AFrameworkApplication.lc.Wb(this.gAa))}Od(){this.gAa&&n.AFrameworkApplication.lc.ff(this.gAa);super.Od()}}Object(y.a)(zB,"DesignerDelayCondition",vn.a,[]);class hh extends Ce{constructor(d,m,A){super(Cb.a.Hml);this.An=d;this.G1h=m;this.vSh=A;this.k1=()=>{this.An.K_()&&(this.pg(this.An.yWc(this.G1h)===this.vSh),this.An.fPb(this.k1))}}initialize(){super.initialize();
this.An.K_()?this.pg(this.An.yWc(this.G1h)===this.vSh):this.An.Q2b(this.k1)}Od(){this.An.fPb(this.k1);super.Od()}}Object(y.a)(hh,"DesignerFlagsSettingCondition",Ce,[]);var CA=c(1091);class wu extends Sys.EventArgs{constructor(d){super();this.documentType=d}}Object(y.a)(wu,"DocumentTypeObtainedEventArgs",Sys.EventArgs,[]);class Cm{constructor(){this.fd=new vb.a}lyk(d){this.fd.addHandler("DocumentTypeObtainedEventId",d)}r2n(d){this.fd.removeHandler("DocumentTypeObtainedEventId",d)}IOn(d){this.fd.raiseEvent("DocumentTypeObtainedEventId",
d)}}Object(y.a)(Cm,"DocumentTypeEventSource",null,[]);class Az extends Ce{constructor(d,m,A,R,da,Ea=null){super(Cb.a.SUh);this.Il=d;this.J8=m;this.gMd=A;this.$8o=R;this.RIo=da;this.DKf=null;this.MYc=this.isInitialized=!1;this.Knb=(ib,Qb)=>{if(Qb.data.nt===Wm.a.getTypeName()||Qb.data.nt===cg.n.getTypeName())Qb.data.annotation?Qb.data.annotation.annotationType!==ni.DocumentTypeClassifierAnnotation.getTypeName()?v.ULS.shipAssertTag(573907533,3016,!1):(ib=Qb.data.annotation.content)?ib.documentTypeConfidences.length?
(this.DKf=this.nq(),ib=ib.documentTypeConfidences[0].documentTypeLabel,this.MYc=Array.contains(this.RIo,ib),this.gMd.IOn(new wu(ib)),this.MYc&&!this.Eia&&v.ULS.sendTraceTag(561309448,3016,50,this.FO(this.Il,!0)),this.pg(this.MYc)):v.ULS.shipAssertTag(573907535,3016,!1):v.ULS.shipAssertTag(573907534,3016,!1):v.ULS.shipAssertTag(573907532,3016,!1)};this.nq=Ea?Ea:()=>new Date}get Zso(){return!this.DKf||+this.nq()-+this.DKf>this.$8o}initialize(){super.initialize();this.isInitialized||(this.J8.jG(this.Knb),
this.J8.register(),this.isInitialized=!0);this.Zso?(this.J8.gwa(new CA.a),v.ULS.sendTraceTag(509874258,3016,50,"DocumentTypeClassifierSignal emitted by the DocumentTypeCondition.")):(this.MYc&&v.ULS.sendTraceTag(561109203,3016,50,this.FO(this.Il,!0)),this.pg(this.MYc))}Od(){this.isInitialized&&(this.J8.kI(this.Knb),this.isInitialized=!1);super.Od()}}Object(y.a)(Az,"DocumentTypeCondition",Ce,[]);var Ck=c(952);class yA extends vn.a{constructor(d,m,A,R,da=null){super(Cb.a.NJl);this.Il=d;this.Kqb=m;this.gnf=
A;this.W0c=R;this.Wgc=(Ea,ib)=>{Ea=this.Kqb.q9h();ib.XA===Ck.a.APd&&(ib=Ea.values[Ck.a.APd],Ea=(ib-1)%this.W0c,this.fnf[Ea]=this.nq(),ib<this.W0c||+this.fnf[Ea]-+this.fnf[ib%this.W0c]>this.gnf||(v.ULS.sendTraceTag(561309447,3016,50,this.FO(this.Il,!0)),this.Kqb.b9f(this.Wgc),this.pg(!0)))};this.nq=da?da:()=>new Date;this.fnf=Array(R)}initialize(){super.initialize();this.Kqb.qrh(this.Wgc)}Od(){this.Kqb.b9f(this.Wgc);super.Od()}}Object(y.a)(yA,"FormattingActionsCondition",vn.a,[]);class yv extends vn.a{constructor(d,
m,A){super(Cb.a.PJl);this.Il=d;this.oc=m;this.Zd=A;this.K8=new Set;this.x_a=0;this.ZHd=1}initialize(){super.initialize();this.XBf();this.oc.gZ(this)}Od(){this.oc.OSb(this);super.Od()}r5(){}p5(d){2===d.behavior&&this.K8.has(d.actionId)&&(this.x_a+=1,this.x_a===this.ZHd&&(v.ULS.sendTraceTag(523351776,3016,50,this.FO(this.Il,!0)),this.pg(!0)))}XBf(){switch(this.Zd.hMd()){case 2:this.K8.add(xe.a.font);this.ZHd=1;break;case 3:this.K8.add(xe.a.LQ);this.ZHd=1;break;case 4:this.K8.add(xe.a.font),this.K8.add(xe.a.WA),
this.K8.add(xe.a.u0),this.K8.add(xe.a.K1),this.K8.add(xe.a.KC),this.K8.add(xe.a.bold),this.K8.add(xe.a.fz),this.K8.add(xe.a.underline),this.K8.add(xe.a.strikethrough),this.K8.add(xe.a.nZ),this.K8.add(xe.a.H$),this.K8.add(xe.a.Xv),this.K8.add(xe.a.ura),this.ZHd=3}}}Object(y.a)(yv,"FormattingChangeCondition",vn.a,[29]);class Mx extends Ce{constructor(d,m,A){super(Cb.a.n3h);this.Il=d;this.k0=m;this.nQf=A;this.isInitialized=!1;this.Lnb=(R,da)=>{da.data.nt===Wm.a.getTypeName()&&(da.data.annotation?da.data.annotation.annotationType!==
jf.FormattingSuggestionsSummaryAnnotation.getTypeName()?(v.ULS.shipAssertTag(574912652,3016,!1),this.pg(!1)):(R=da.data.annotation.content)?R.errorCode?this.pg(!1):((R=R.numberOfSuggestions>=this.nQf)&&!this.Eia&&v.ULS.sendTraceTag(561309445,3016,50,this.FO(this.Il,!0)),this.pg(R)):(v.ULS.shipAssertTag(574912653,3016,!1),this.pg(!1)):(v.ULS.shipAssertTag(574912651,3016,!1),this.pg(!1)))}}initialize(){super.initialize();this.isInitialized||(this.k0.jG(this.Lnb),this.k0.register(),this.isInitialized=
!0)}Od(){this.isInitialized&&(this.k0.unregister(),this.k0.kI(this.Lnb),this.isInitialized=!1);super.Od()}}Object(y.a)(Mx,"FormattingSuggestionsCondition",Ce,[]);class Dy extends vn.a{constructor(d,m,A){super(Cb.a.IAn);this.Il=d;this.Kqb=m;this.oQf=A;this.Wgc=(R,da)=>{R=this.Kqb.q9h();da.XA===Ck.a.fS&&((da=R.values[Ck.a.fS]>=this.oQf)&&!this.Eia&&v.ULS.sendTraceTag(561309446,3016,50,this.FO(this.Il,!0)),this.pg(da))}}initialize(){super.initialize();this.Kqb.qrh(this.Wgc)}Od(){this.Kqb.b9f(this.Wgc);
super.Od()}}Object(y.a)(Dy,"ParagraphCountCondition",vn.a,[]);class cr extends Ce{constructor(d,m,A){super(Cb.a.rgj);this.Il=d;this.pJ=m;this.Den=A;this.PUh=this.IUh=this.isInitialized=!1;this.Fnb=(R,da)=>{da.data.nt===Wm.a.getTypeName()&&(da.data.annotation?da.data.annotation.annotationType!==Zo.DocumentRoleDetectionAnnotation.getTypeName()?(v.ULS.shipAssertTag(555812322,3016,!1),this.pg(!1)):(da=da.data.annotation.content)?da.errorCode?this.pg(!1):((R=da.isTarget)&&!this.IUh&&v.ULS.sendTraceTag(561309451,
3016,50,this.FO(this.Il,!0,"subCondition=DocumentConfidenceCondition")),this.IUh=R,(da=da.supportedLanguagesCoverage>this.Den)&&!this.PUh&&v.ULS.sendTraceTag(555812353,3016,50,this.FO(this.Il,!0,"subCondition=DocumentLanguageCondition")),this.PUh=da,(R=R&&da)&&!this.Eia&&v.ULS.sendTraceTag(555812354,3016,50,this.FO(this.Il,!0)),this.pg(R)):(v.ULS.shipAssertTag(555812323,3016,!1),this.pg(!1)):(v.ULS.shipAssertTag(555812321,3016,!1),this.pg(!1)))}}initialize(){super.initialize();this.isInitialized||
(this.pJ.jG(this.Fnb),this.pJ.register(),this.isInitialized=!0)}Od(){this.isInitialized&&(this.pJ.unregister(),this.pJ.kI(this.Fnb),this.isInitialized=!1);super.Od()}}Object(y.a)(cr,"RoleDetectionCondition",Ce,[]);class Ey extends Ce{constructor(d,m,A){super(Cb.a.Ozj);this.Il=d;this.a2=m;this.mme=A;this.Zh=!1;this.f9d=()=>{v.ULS.sendTraceTag(541385729,3016,50,this.FO(this.Il,!0));this.pg(!0)}}initialize(){super.initialize();this.Zh||(this.a2.register(),this.mme.DCd(this.f9d),this.mme.initialize(),
this.Zh=!0)}Od(){this.Zh&&(this.mme.rcj(this.f9d),this.mme.Od(),this.a2.unregister(),this.Zh=!1);super.Od()}}Object(y.a)(Ey,"ThemesLoadedCondition",Ce,[]);class zA{constructor(d){this.engagement=d}initialize(){}T5(){return this.engagement.bJf?(v.ULS.sendTraceTag(509093536,3041,50,"Auto launch suppressed: AiMaker triggered"),!0):!1}hV(){}}Object(y.a)(zA,"DesignerContextualSuggestionsSuppressionModel",null,[955]);class AA{constructor(d,m,A){this.Dka=d;this.OGo=m;this.fne=A;this.Zh=!1;this.SBj=(R,da)=>
{this.fne&&this.fne.trigger(R,da);this.Od()}}initialize(){v.ULS.sendTraceTag(554742740,3016,50,`DesignerProactiveTriggerManager.initialize - isInitialized=${this.Zh}`);if(!this.Zh){this.OGo.initialize();for(const d of this.Dka)d.U3(this.SBj),d.initialize();this.Zh=!0}}Od(){v.ULS.sendTraceTag(554742741,3016,50,`DesignerProactiveTriggerManager.deinitialize - isInitialized=${this.Zh}`);if(this.Zh){for(const d of this.Dka)d.Od(),d.dea(this.SBj);this.Zh=!1}}}Object(y.a)(AA,"DesignerProactiveTriggerManager",
null,[912,672]);class pp extends kq.a{constructor(d,m,A,R=null,da=null){super(d,m,A,3016,"OnTriggerDesigner");this.nDn=da;this.Afk=R}x3a(d){var m;super.x3a(d);null===(m=this.nDn)||void 0===m?void 0:m.x3a(d)}Zjb(d){Array.contains(pp.Pkk,d)?(v.ULS.sendTraceTag(546137305,3016,50,`DesignerSequentialTriggerModel.handleConditionUnsatisfied - conditionId=${d}`),this.yza(!1)):super.Zjb(d)}yza(d=!0){var m,A;super.yza(d&&!(null===(m=this.Gma)||void 0===m?0:m.T5())&&!(null===(A=this.Afk)||void 0===A?0:A.T5()))}}
pp.Pkk=[Cb.a.rgj,Cb.a.SUh,Cb.a.n3h,Cb.a.WRi,Cb.a.OUh,Cb.a.zzj,Cb.a.Ozj];Object(y.a)(pp,"DesignerSequentialTriggerModel",kq.a,[]);class Of{constructor(d,m,A){this.U0c=d;this.bEo=m;this.REo=A}x3a(d){d===this.bEo&&(this.startTime=cb.a.$e());d===this.REo&&this.startTime&&(d=cb.a.$e()-this.startTime,v.ULS.sendTraceTag(512492310,3016,50,`${this.U0c} { elapsedTime: ${d} ms }`))}}Object(y.a)(Of,"DesignerTriggerModelPerformanceMeter",null,[]);class Oq{constructor(d,m,A){this.f1j=d;this.OUg=m;this.I3j=A}initialize(){}T5(){return this.I3j?
this.f1j.isVisible?(v.ULS.sendTraceTag(555771225,3016,50,"Auto launch suppressed: pane already visible"),!0):this.OUg.VPd()?(v.ULS.sendTraceTag(555771226,3016,50,"Auto launch suppressed: errorState {0}",this.OUg.FDb),!0):!1:(v.ULS.sendTraceTag(508952729,3016,50,"Auto launch suppressed: flight is disabled"),!0)}hV(){}}Object(y.a)(Oq,"HeuristicSuppressionModel",null,[955]);class dr{constructor(d){this.sbh=d;this.initialize()}initialize(){this.PHe=void 0;this.sbh.rVm(uf.a.pSh).then(d=>{this.PHe=d})}T5(){if(void 0===
this.PHe)return v.ULS.sendTraceTag(521199813,3016,50,"Auto launch suppressed: No results from intelligence"),!0;if(this.PHe)return v.ULS.sendTraceTag(521199812,3016,50,"Auto launch suppressed: pane was already opened for this document"),!0;this.sbh.yDn(uf.a.pSh);return!1}hV(){}}Object(y.a)(dr,"PersistenceSuppressionModel",null,[955]);class Go{constructor(d){this.l3f=d}initialize(){v.ULS.sendTraceTag(554742739,3016,50,"ProactiveTriggerDeinitializer.initialize");this.l3f.Od()}Od(){}}Object(y.a)(Go,
"ProactiveTriggerDeinitializer",null,[672]);class Vs{constructor(d,m,A){this.BJj=d;this.K4c=m;this.l3f=A}initialize(){v.ULS.sendTraceTag(554742738,3016,50,"ProactiveTriggerInitializer.initialize");this.BJj.initialize();this.K4c.X9i(this.BJj);this.l3f.initialize()}Od(){}}Object(y.a)(Vs,"ProactiveTriggerInitializer",null,[672]);var qu=c(614);class Pj{constructor(d,m,A=null){this.mLa=new qu.a;this.BTe=!1;this.Tub=this.Qxb=null;this.gVi=(R,da)=>{da.data?(this.Qxb=this.xD(),this.BTe=!1):(this.Qxb=this.Tub=
null,this.hNc())};this.ga=d;this.qkd=m;this.xD=A?A:()=>new Date}initialize(){this.qkd.S2b(this.gVi);this.ga.gZ(this);this.XBf()}Od(){this.qkd.scj(this.gVi);this.ga.OSb(this)}get id(){return 1}get Dhc(){return this.Qxb}get wNc(){return this.Tub}r5(){}p5(d){2===d.behavior&&this.mLa.contains(d.actionId)&&(this.Tub=this.xD(),this.hNc())}hNc(){this.BTe||(this.BTe=!0)}XBf(){this.mLa.add(xe.a.S_a);this.mLa.add(Ac.a.iPd);this.mLa.add(Ac.a.designerReviewChanges);this.mLa.add(xe.a.Qeb);this.mLa.add(Ac.a.K6c);
this.mLa.add(Ac.a.kBd);this.mLa.add(Ac.a.Dde);this.mLa.add(Ac.a.changeDesignerRole);this.mLa.add(Ac.a.WJa)}}Object(y.a)(Pj,"UserEngagementMonitor",null,[29,953,672,954]);class gj extends vn.a{constructor(d){super("DocumentOwnerConditionId");this.Il=d}initialize(){super.initialize();const d=n.AFrameworkApplication.K.$("IsDocumentOwner");v.ULS.sendTraceTag(521430743,3016,50,this.FO(this.Il,d,d&&!this.Eia?"The owner of the document has changed":""));this.pg(d)}Od(){super.Od()}}Object(y.a)(gj,"DocumentOwnerCondition",
vn.a,[]);class Mn extends vn.a{constructor(d,m){super("ProactiveV2AllowedBySettingsConditionId");this.An=d;this.Il=m;this.k1=()=>{if(this.An.K_()){var A=this.An.ena()&&this.An.SBi();v.ULS.sendTraceTag(521446609,3016,50,this.FO(this.Il,A));this.pg(A)}else v.ULS.shipAssertTag(521446610,3016,!1)}}initialize(){super.initialize();this.An.K_()?this.pg(this.An.ena()&&this.An.SBi()):this.An.Q2b(this.k1)}Od(){this.An.fPb(this.k1);super.Od()}}Object(y.a)(Mn,"ProactiveV2AllowedBySettingsCondition",vn.a,[]);
class ax{constructor(d,m,A,R,da,Ea){this.Zd=d;this.k0=m;this.yBd=A;this.K4c=R;this.M8=da;this.Fml=Ea;this.isInitialized=!1;this.Mnb=(ib,Qb)=>{Qb.data.nt===Wm.a.getTypeName()&&(Qb.data.annotation?Qb.data.annotation.annotationType!==jf.FormattingSuggestionsSummaryAnnotation.getTypeName()?v.ULS.shipAssertTag(521446622,3016,!1):(ib=Qb.data.annotation.content)?this.M8.VPd()?(v.ULS.sendTraceTag(521446620,3016,50,`Auto launch suppressed by errorState ${this.M8.FDb}`),this.Od()):(v.ULS.sendTraceTag(521446619,
3016,50,"Other conditions for the opening of the panel have been satisfied, check numberOfSuggestions = {0}",ib.numberOfSuggestions),!ib.errorCode&&ib.numberOfSuggestions>=this.Zd.QIn()?(this.K4c.O3e(1,()=>{this.yBd.Qb(Ac.a.FJa,2,new tc.a(11))}),v.ULS.sendTraceTag(521446618,3016,50,"All conditions have been met. Open Designer")):this.Od()):v.ULS.shipAssertTag(521446621,3016,!1):v.ULS.shipAssertTag(521446623,3016,!1))}}initialize(){this.isInitialized||(this.M8.VPd()?v.ULS.sendTraceTag(521446626,3016,
50,`ProactiveSuggestionsChecker - initialize supressed by errorState ${this.M8.FDb}`):(v.ULS.sendTraceTag(521446625,3016,50,"ProactiveSuggestionsChecker - initialize"),this.k0.jG(this.Mnb),this.k0.register(),this.Fml.initialize(),this.isInitialized=!0))}Od(){this.isInitialized&&(v.ULS.sendTraceTag(521446624,3016,50,"ProactiveSuggestionsChecker - deinitialize"),this.k0.unregister(),this.k0.kI(this.Mnb),this.isInitialized=!1)}}Object(y.a)(ax,"ProactiveSuggestionsChecker",null,[672]);class kj{constructor(d,
m,A,R,da){this.Dka=d;this.Axj=m;this.oc=R;this.An=da;this.isInitialized=this.Rff=this.osg=this.XKj=!1;this.Qvj=(Ea,ib)=>{v.ULS.sendTraceTag(521446614,3016,50,"ProactiveTriggerManagerV2 startNewChecker");ib.qZ?this.Axj.initialize():this.uwj()};this.lYf=(Ea,ib)=>{ib.data?(v.ULS.sendTraceTag(521446613,3016,50,"Stop on pane opened"),this.Od()):this.XKj&&(v.ULS.sendTraceTag(521446612,3016,50,"Restart due to AcceptAll from pane"),this.initialize())};A.S2b(this.lYf);this.oc.gZ(this)}initialize(){if(!this.isInitialized){this.isInitialized=
!0;v.ULS.sendTraceTag(521446617,3016,50,"ProactiveTriggerManagerV2 init");for(const d of this.Dka)d.U3(this.Qvj),d.initialize()}}Od(){if(this.isInitialized){this.isInitialized=!1;v.ULS.sendTraceTag(521446616,3016,50,"ProactiveTriggerManagerV2 deinit");this.uwj();for(const d of this.Dka)d.Od(),d.dea(this.Qvj)}}uwj(){v.ULS.sendTraceTag(521446615,3016,50,"ProactiveTriggerManagerV2 stopActiveChecker");this.Axj.Od()}r5(){}p5(d){if(2===d.behavior)switch(d.actionId){case xe.a.Qeb:this.osg=this.XKj=!0;this.Rff&&
this.An.YWh();break;case Ac.a.FJa:d=d.vd;!this.osg&&d&&11===d.id&&(this.An.ipl(),this.Rff=!0);break;case xe.a.S_a:case Ac.a.kBd:this.osg=!0,this.Rff&&this.An.YWh()}}}Object(y.a)(kj,"ProactiveTriggerManagerV2",null,[912,29]);var Or=c(146);class BA{constructor(d,m,A,R,da=null){this.paragraphFormat=d;this.wzj=m;this.textLength=A;this.N9d=R;this.RKj=da}}Object(y.a)(BA,"ParagraphFormattingFullSnapshot",null,[]);class Bz{constructor(d,m,A){this.Pp=d;this.cpEnd=m;this.Jn=A}}Object(y.a)(Bz,"TextRunFormattingFullSnapshot",
null,[]);class xC{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd){this.Md=d;this.d7=m;this.Ce=A;this.Xs=R;this.Ptd=da;this.$W=Ea;this.fDe=ib;this.tyd=Qb;this.De=pc;this.Hf=gd}ykc(d,m=!0){var A;if(d){this.Md.PSa(d);var R=new U.a;for(var da=0;da<d.ra.length-1;da++){var Ea=d.ra.J(da);Ea.formatting&&Ea.formatting.Jn&&R.add(new Bz(Ea.cp,d.ra.J(da+1).cp,Ea.formatting.Jn.clone()))}Ea=d.ra.J(d.ra.length-1);Ea.formatting&&Ea.formatting.Jn&&R.add(new Bz(Ea.cp,Ea.cp,Ea.formatting.Jn.clone()));da=Ea=null;m&&({dVa:Ea}=
this.tyd.sne(this.De.ZGb(d)),da=null===(A=this.De.hp(d))||void 0===A?void 0:A.id);this.Ptd.put(d.id,new BA(d.aE(),R,Qe.ParagraphReader.textLength(d),Ea,da))}else v.ULS.shipAssertTag(556410145,3016,!1)}lUa(d,m=!0){if(d){var A=null;if(({Muj:A}=this.Ptd.sne(d.id)).returnValue){const da=d.f0();try{this.Xs.IGd(d);if(A.paragraphFormat&&A.RKj&&d.UL&&d.UL.id===A.RKj)for(var R of d.properties.xl())A.paragraphFormat.hasProperty(R)||d.UL.hasProperty(R)&&d.properties.Cg(R);this.Xs.fvh(d,A.paragraphFormat);this.d7.s6();
let Ea=R=null;({Sda:R,vzj:Ea}=this.m9l(A));this.Kmo(d,R,A);for(const ib of A.wzj)this.opo(ib,Ea,A),this.HGk(ib,d);this.Md.PSa(d);d.Xl();m&&this.Ptd.remove(d.id)}finally{da&&da.dispose()}}}else v.ULS.shipAssertTag(556410146,3016,!1)}Qef(d){d?this.Ptd.remove(d.id):v.ULS.shipAssertTag(556410147,3016,!1)}HGk(d,m){var A=m.ra.J(m.ra.length-1);if(A.cp===d.Pp&&d.Pp===d.cpEnd)this.APo(A,d,m);else for(A=0;A<m.ra.length-1;A++){const R=m.ra.J(A),da=m.ra.J(A+1);if(R.cp>=d.Pp&&R.cp<d.cpEnd){let Ea=!1;da.cp<=d.cpEnd?
Ea=!0:v.ULS.sendTraceTag(540652370,3016,15,"applyTextRunFormattingOnParagraph: textRunFormatting.cpEnd < next.cp");Ea&&R.formatting&&(this.Ce.Lga(R.formatting),this.Ce.voj(R.formatting,d.Jn))}}}APo(d,m,A){A=this.Hf.Aca(A);let R=null;if(A&&m.Jn&&(R=m.Jn.xl())){this.Ce.Lga(d.formatting);this.Ce.voj(d.formatting,m.Jn);for(const da of R)A.setValue(da,m.Jn.tf(da))}}m9l(d){const m=new U.a,A=new U.a;let R=null;if(!d.N9d||!(R=d.N9d.xl()))return{Sda:m,vzj:A};for(d=0;d<R.length;d++){const da=R[d];fb.a.any(Or.a.gli(),
Ea=>Ea===da)?m.add(da):A.add(da)}return{Sda:m,vzj:A}}Kmo(d,m,A){this.$W.tX(this.fDe(d,0,Qe.ParagraphReader.textLength(d)),R=>{for(const da of m)this.Ce.hm(R,da,A.N9d.tf(da))})}opo(d,m,A){for(const R of m)d.Jn.hasProperty(R)||d.Jn.setValue(R,A.N9d.tf(R))}}Object(y.a)(xC,"RestoreManager",null,[952]);class kp{constructor(d,m,A){this.tub=d;this.hba=m;this.dLa=A}accept(d,m=!1){return d?kp.alb(()=>{this.hba.K7e(d,2,m)}):(v.ULS.shipAssertTag(590434823,3016,!1),!1)}acceptAll(){const d=this.tub.Pc(15,xe.a.Qeb);
try{return d.Ky.Db(this.dLa.ed),kp.alb(()=>{this.hba.Xzf(!1,0)})}finally{d&&d.dispose()}}reject(d,m=!1){if(!d)return v.ULS.shipAssertTag(590434824,3016,!1),!1;const A=this.tub.Pc(15,Ac.a.Dde);try{return A.Ky.Db(d),kp.alb(()=>{this.hba.K7e(d,3,m)})}finally{A&&A.dispose()}}rejectAll(){const d=this.tub.Pc(15,Ac.a.K6c);try{return d.Ky.Db(this.dLa.ed),kp.alb(()=>{this.hba.Xzf(!0)})}finally{d&&d.dispose()}}Wrg(d){if(!d)return v.ULS.shipAssertTag(529106274,3016,!1),!1;const m=this.tub.Pc(15,Ac.a.sff);try{return m.Ky.Db(d),
kp.alb(()=>{this.hba.K7e(d,.1,!1)})}finally{m&&m.dispose()}}Jad(){const d=this.tub.Pc(15,Ac.a.designerSnoozeContextualSuggestions);try{return d.Ky.Db(this.dLa.ed),kp.alb(()=>{this.hba.Xzf(!0);this.hba.Jad()})}finally{d&&d.dispose()}return!1}changeDesignerRole(d){if(null===d||void 0===d||!d.paragraphNode)return v.ULS.shipAssertTag(575484486,3016,!1),!1;const m=this.tub.Pc(15,Ac.a.changeDesignerRole);try{return m.Ky.Db(d.paragraphNode),kp.alb(()=>{1===d.Jq&&m.Ky.mHa(d.MX,1);this.hba.fVk(d)})}finally{m&&
m.dispose()}}WJa(d){if(!d)return v.ULS.shipAssertTag(573850376,3016,!1),!1;const m=this.tub.Pc(15,Ac.a.WJa);try{return m.Ky.Db(d),kp.alb(()=>{this.hba.WJa(d)})}finally{m&&m.dispose()}}static alb(d){try{return d(),!0}catch(m){return v.ULS.shipAssertTag(572068186,3016,!1,String.format("{0} {1}",m.message,m.stack)),!1}}}Object(y.a)(kp,"ReviewActions",null,[951]);var ow=c(1231),wj=c(1709),bx=c(1721),ho=c(1649);class Dk{constructor(d,m,A,R,da,Ea){this.MUe=d;this._state=m;this.euc=A;this.y7j=R;this.HWj=
da;this.NVj=Ea;this.MUe.uSa(this._state)}get suggestion(){return this.MUe}get state(){return this._state}set state(d){d!==this._state&&(this._state=d,this.suggestion.uSa(this._state))}get description(){return this.euc}get Lkb(){return this.y7j}get oBb(){return this.HWj}get aso(){return 0==this.MUe.Jq}get rO(){var d;return null!==(d=this.NVj)&&void 0!==d?d:[]}}Object(y.a)(Dk,"ReviewIntent",null,[]);class Wk{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh=null,Fl,Gm,em,$n,Ep,Mm){this.oc=
d;this.VJ=m;this.T1=A;this.N4=R;this.r9m=da;this.iI=Ea;this.Vi=ib;this.B1=Qb;this.ekc=pc;this.hC=Pc;this.lI=gd;this.gm=Cd;this.tbe=ae;this.Bz=Xd;this.l$=se;this.LO=Xe;this.b8b=Be;this.Y4k=Hg;this.qE=Xh;this.Zd=Fl;this.eBf=Gm;this.An=em;this.q1=$n;this.Jd=Ep;this.rc=Mm;this.j8c=null;this.JY=!1;this.E$i=new Map;this.eun=(Mk,gm)=>{this.l5b(gm.data.paragraphNode,5)};this.lun=(Mk,gm)=>{this.j8c?this.j8c(gm.data):this.JY&&v.ULS.shipAssertTag(590434837,3016,!1)};this.k1=()=>{this.An.ena()||this.JY||this.Kui()};
this.Mvn=(Mk,gm)=>{(this.JY=gm.data)&&this.Kui();!gm.data&&0<this.gm.IPb&&this.oc.Qb(xe.a.Qeb,2,new ho.a(1))};this.LYf=(Mk,gm)=>{if(Mk=this.lI.DU(gm.data.paragraphNode))if(gm.data.paragraphNode.Nae=gm.data.isVisible){if(0==Mk.state||.1==Mk.state)Mk.aso?this.yFk(gm.data.paragraphNode,Mk):Mk.oBb(),v.ULS.sendTraceTag(540676563,3016,50,"Role: {0};",Mk.Lkb);this.aGd(gm.data.paragraphNode,1);this.j8c&&this.j8c(this.gm.IPb)}else.1===Mk.state?this.hC.N5f(new wj.a(gm.data.paragraphNode,Mk.Lkb)):1<Mk.state&&
this.l5b(gm.data.paragraphNode,Mk.state)};this.jmn=(Mk,gm)=>{(Mk=this.lI.DU(gm.data.currentNode))&&1<Mk.state&&this.l5b(gm.data.currentNode,Mk.state)};this.gm.azk(this.lun);this.hC.Xyk(this.eun);this.hC.H0e(this.LYf);this.hC.Zxk(this.jmn);this.T1.S2b(this.Mvn);this.An.Q2b(this.k1)}Gno(d){this.j8c=d}cje(d){let m=0;if(!d.CSa)return v.ULS.sendTraceTag(521412957,3016,50,"Paragraph node not available."),m;if(!d.PDd)return v.ULS.shipAssertTag(545117584,3016,!1),m;const A=this.gm.GA(d.CSa);if(!this.An.ena())return v.ULS.sendTraceTag(537260062,
3016,50,`type: ${d.annotationType} role: ${A.role}`),1;if(0==d.suggestion.Jq&&this.gm.tAi(d.CSa,A))return v.ULS.sendTraceTag(529105475,3016,50,`type: ${d.annotationType} role: ${A.role}`),1;this.l$.ODf(d.CSa,d.Wbc,d.HVc-d.Wbc,d.annotationType,R=>{R||(m=this.Bje(new Un.b(d.suggestion,d.ps,d.Wbc,d.HVc,()=>{d.annotationType!==uf.a.m4f&&d.annotationType!==uf.a.xkg||this.l$.nic(d.CSa,d.Wbc,d.HVc-d.Wbc,d.annotationType,60);const da=d.PDd(A,d.ps);v.ULS.shipAssertTag(540676565,3016,da,`Contextual suggestion failed to apply. annotationType: ${d.annotationType}`);
return da}),0,this.ekc.t9b(A.role)))});1<m&&(d.annotationType===uf.a.m4f||d.annotationType===uf.a.xkg)&&this.qE&&this.qE.execute(R=>{R.logActivity(Cb.a.Inn,null)});v.ULS.sendTraceTag(540653090,3016,50,"Role: {0}; Status {1};",A.role,m);return m}APc(d,m=null){if(!m&&(m=Object(vf.a)(bg.AParagraphNode,d.parent),!m))return[];d=d.content;if(!d||!d.range||d.range!==jf.FormattingSuggestionsRange.List)return[m];if(15!==this.gm.GA(m).role)return[];d=this.Jd.Aca(m);if(!d||!d.hasProperty(wc.a.listID))return[m];
d=d.getValue(wc.a.listID);const A=this.q1.Nna(m,!0,!1),R=[];for(;m;){R.push(m);m=A.h9()?A.ex:null;const da=this.Jd.Aca(m);if(!da)break;if(!da.hasProperty(wc.a.listID))break;if(da.getValue(wc.a.listID)!==d)break}return R}zJn(d,m,A=null){if(!d)return v.ULS.shipAssertTag(590434825,3016,!1),0;if(!m)return v.ULS.shipAssertTag(590434828,3016,!1),0;const R=d.content;if(!R)return v.ULS.shipAssertTag(590434826,3016,!1),0;const da=this.APc(d);if(!da||!da.length)return v.ULS.shipAssertTag(590434827,3016,!1),
0;const Ea=this.gm.GA(da[0]);if(15===Ea.role&&1!==d.content.range)return 1;let ib=!1;da.forEach(Qb=>{this.gm.GA(Qb).A4a||(ib=!0)});return ib?this.dig(new Un.b(new Dg.c(Rh.a.create(),this.qE,this.Zd,!1,A),da,0,this.Vi.textLength(da[0]),()=>m(R,da)),this.ekc.t9b(Ea.role),!1):1}OJn(d,m,A){if(!d||0==d.length)return v.ULS.shipAssertTag(512603861,3016,!1),0;if(!m)return v.ULS.shipAssertTag(590434833,3016,!1),0;let R=!1;d.forEach(Ea=>{this.gm.GA(Ea).A4a||(R=!0)});const da=this.gm.GA(d[0]);return R?this.dig(new Un.b(new Dg.c(Rh.a.create(),
this.qE,this.Zd,!1,A),d,0,this.Vi.textLength(d[0]),()=>m(da,d)),this.ekc.t9b(da.role),!0):m(da,d)?2:0}YJn(d,m){if(!d)return v.ULS.shipAssertTag(589963425,3016,!1),0;if(!m)return v.ULS.shipAssertTag(512603860,3016,!1),0;const A=this.gm.GA(d);return A.A4a?m(A,d)?2:0:this.dig(new Un.b(new Dg.c(Rh.a.create(),this.qE,this.Zd,!1,null),[d],0,this.Vi.textLength(d),()=>m(A,d)),this.ekc.t9b(A.role),!0)}Z4i(d,m){if(!d)return v.ULS.shipAssertTag(555055119,3016,!1),0;if(!m)return v.ULS.shipAssertTag(555055120,
3016,!1),0;if(!d.paragraphNode)return v.ULS.shipAssertTag(555055121,3016,!1),0;m=m(d);const A=null===m||void 0===m?void 0:m.paragraphNode;if(!A)return v.ULS.shipAssertTag(541446668,3016,!1),0;this.hC.ijc(m);this.b8b.register(A,d.suggestion);return this.Bje(new Un.b(d.suggestion,[A],0,1,null),(null===m||void 0===m?0:m.placeholder)?.5:1,this.ekc.t9b(m.role))}K7e(d,m,A=!1){d?this.yEj(d,m,A):v.ULS.shipAssertTag(590434834,3016,!1)}Xzf(d,m){const A=[];this.lI.forEach(R=>{const da=this.lI.DU(R);if(void 0!==
m&&da.suggestion.Jq!==m)return v.ULS.sendTraceTag(537796610,3016,50,`skiped role: ${da.Lkb} type: ${da.suggestion.Jq}`),!0;d||0!=da.state&&.1!==da.state||(v.ULS.sendTraceTag(540676562,3016,50,"Role: {0};",da.Lkb),da.oBb());A.push(R);return!0},!d);A.length&&A.forEach(R=>{this.yEj(R,d?3:2,!0)});v.ULS.sendTraceTag(537796611,3016,50,`reject: ${d} count: ${A.length}`)}Jad(){this.An.ena()&&(v.ULS.sendTraceTag(537260063,3016,50,"snoozeContextualSuggestions"),this.An.oTh())}gvm(d){const m=this.gm.GA(d);m&&
!m.xia&&this.l5b(d,5)}fVk(d){if(null!==d&&void 0!==d&&d.paragraphNode){var m=this.lI.DU(d.paragraphNode),A=this.lI.DU(d.paragraphNode).suggestion,R=this.gm.GA(d.paragraphNode);switch(d.Jq){case 1:case 3:this.b8b.unregister(d.paragraphNode);const da=Ea=>{this.hC.ijc({role:27,paragraphNode:d.paragraphNode,placeholder:Ea})};d.paragraphNode=this.tbe.rVk(d.paragraphNode,A,()=>{this.hC.c6c(Gb.a.create(d.paragraphNode));da(!1)},d.MX);da(!0);this.b8b.register(d.paragraphNode,A);this.Bje(new Un.b(A,[d.paragraphNode],
0,1,null),1,this.ekc.t9b(d.role));break;case 2:this.b8b.unregister(d.paragraphNode);m=Qe.ParagraphReader.Wf(d.paragraphNode,!1);this.LO.Ajc(R.fpa,d.paragraphNode);this.eBf.instance.Tuh(new Un.a(A,m,d.gpa));break;default:1===d.role?m&&m.rO&&0<m.rO.length?m.rO.forEach(Ea=>{this.B1.lUa(Ea,!1)}):this.B1.lUa(d.paragraphNode,!1):0!=d.role&&d.role===R.ADd?(this.B1.lUa(d.paragraphNode,!1),this.iI.nfb(d.paragraphNode,R.BDd)):m&&m.rO&&0<m.rO.length?m.rO.forEach(Ea=>{this.iI.Bba(Ea,d.role)}):this.iI.Bba(d.paragraphNode,
d.role)}this.hC.N5f(new wj.a(d.paragraphNode,d.role));this.aGd(d.paragraphNode,4)}else v.ULS.shipAssertTag(575484485,3016,!1)}WJa(d){if(d){var m=this.lI.DU(d);m?(this.hC.N5f(new wj.a(d,m.Lkb)),3!==m.state&&.1!==m.state||m.oBb(),4===m.state&&(m&&m.rO&&0<m.rO.length?m.rO.forEach(A=>{this.B1.lUa(A,!1)}):this.B1.lUa(d,!1),m.oBb()),this.aGd(d,1)):v.ULS.shipAssertTag(573850382,3016,!1)}else v.ULS.shipAssertTag(573850381,3016,!1)}ucm(){let d=null;this.lI.forEach(m=>{d=m;return!1},!1);return d}s$b(d,m){return d?
this.lI.K6l(d,m):(v.ULS.shipAssertTag(590434835,3016,!1),null)}aGd(d,m){const A=this.lI.DU(d);A?(A.state=m,3===m&&27!=A.Lkb&&28!=A.Lkb&&1===A.rO.length&&(this.l$.nic(d,0,d.characterData.length,uf.a.tQh,70),this.E$i.set(d,Date.now()))):v.ULS.sendTraceTag(512239234,3016,50,"Review intent for given paragraph node is null.")}l5b(d,m){const A=this.lI.DU(d);if(!d.Nae||1<m)this.N4.LVa(d,1),A&&A.rO&&0<A.rO.length?A.rO.forEach(R=>{this.B1.Qef(R)}):this.B1.Qef(d),this.hC.d7i(new bx.a(d,m)),d=[Object.assign(new Ya.a,
{name:Cb.a.O3k,int64:m})],this.r9m(Cb.a.N3k,!0,void 0,d)}M3k(d){const m=this.lI.DU(d);let A=0;m?A=m.state:v.ULS.shipAssertTag(573687424,3016,!1);this.l5b(d,A)}yEj(d,m,A){const R=this.gm.GA(d);if(R.xia){var da=this.lI.DU(d),Ea=null===da||void 0===da?void 0:da.state;this.aGd(d,m);3===m||.1===m?27===R.role?(1===Ea&&(this.b8b.unregister(d),this.tbe.jaj(d)),A=!1):28===R.role?(this.b8b.unregister(d),this.LO.Ajc(R.fpa,d),A=!1):(da&&da.rO&&0<da.rO.length?da.rO.forEach(ib=>{this.B1.lUa(ib,!1)}):this.B1.lUa(d,
!1),this.hC.jPn(new wj.a(d))):2===m&&this.hC.hPn(new wj.a(d));A&&this.M3k(d)}}Bje(d,m,A,R=!1){const da=this.gm.GA(d.CSa);0<d.HVc&&!da.xia&&!this.xto(d.CSa)?(this.N4.nHa(d.CSa,new ow.a(1,d.Wbc,d.HVc,void 0,new Dk(d.suggestion,m,A,da.role,d.PDd,d.ps))),0==d.suggestion.Jq&&this.Y4k.register(d.CSa,d.suggestion),this.hC.iPn(new wj.a(d.CSa,da.role,R)),d=3):d=4;v.ULS.sendTraceTag(540653091,3016,50,"Role: {0}; Status {1}; State: {2};",da.role,d,m);return d}xto(d){var m=Date.now();return this.JY?!1:(d=this.E$i.get(d))?
m-d<this.Zd.BLk():!1}dig(d,m,A){this.VJ.ie(()=>{d.ps.forEach(R=>{this.B1.ykc(R,A)})},"WD:SF");if(d.PDd())return this.Bje(d,1,m,!A);d.ps.forEach(R=>{this.B1.Qef(R)});return 0}Kui(){this.lI.forEach(d=>{if(1<this.lI.DU(d).state)return!0;this.l5b(d,5);return!0},!1)}yFk(d,m){const A=this.Bz.Pc(15,xe.a.Kuh);try{m&&m.rO&&0<m.rO.length?(A.Ky.Db(this.rc.ed),m.rO.forEach(R=>{this.B1.ykc(R,!0)})):(A.Ky.Db(d),this.B1.ykc(d,!0)),m.oBb()}finally{A&&A.dispose()}}}Object(y.a)(Wk,"ReviewManager",null,[950]);class xq{constructor(d,
m,A,R){this.fn=d;this.gb=m;this.aNa=A;this.dLa=R}forEach(d,m=!1){if(d){var A=Object(vf.a)(bg.AParagraphNode,m?this.gb.XC(this.dLa.ed):this.gb.$k(this.dLa.ed));m=this.aNa.Nna(A,!0,m);do if(this.lYc(m.ex)&&!d(m.ex))break;while(m.h9())}else v.ULS.shipAssertTag(590391060,3016,!1)}K6l(d,m){if(!d)return v.ULS.shipAssertTag(590391061,3016,!1),null;for(d=this.aNa.Nna(d,!0,m);d.h9();)if(this.lYc(d.ex))return d.ex;return null}lYc(d){return d?0<this.fn.wQa(d,1,()=>!0).count:(v.ULS.shipAssertTag(590391062,3016,
!1),!1)}DU(d){if(!d)return v.ULS.sendTraceTag(522301513,3016,50,"Get null paragraphNode while trying to initialize ReviewIntent"),null;d=this.fn.wQa(d,1,()=>!0);if(1===d.count)return d.J(0).intent;v.ULS.sendTraceTag(522301514,3016,50,"Return null ReviewIntent because of unexpected ranges.count: {0}",d.count);return null}}Object(y.a)(xq,"ReviewTraverser",null,[946]);var Om;(function(d){d[d.None=0]="None";d[d.BRj=1]="ProactivePaneOpeningDisabled";d[d.xbp=2]="JumpstartProactivePaneOpeningDisabled"})(Om||
(Om={}));Object(y.b)("DesignerFlagSetting",Om);const xu=d=>{if(!d)return Om.None;const m=d.split(".");return 2===m.length&&1===parseInt(m[0])?parseInt(m[1]):"0"===d?Om.BRj:Om.None};class Kz{constructor(){this.FavoriteThemesIDs=this.DesignerFlags=this.CSDisableDate=null}equals(d){return this.CSDisableDate===d.CSDisableDate&&this.DesignerFlags===d.DesignerFlags&&this.FavoriteThemesIDs===d.FavoriteThemesIDs}}Object(y.a)(Kz,"WordDesignerSettings",null,[891]);class Jy{constructor(d,m){this.bfd=d;this.Zd=
m;this.roamingSettings=null;this.d3e=!0;this.fd=new vb.a}initialize(){if(this.bfd){v.ULS.sendTraceTag(523850467,3016,50,"DesignerSettingsManager - initialize with roaming");var d=Date.now();this.bfd.B5a().then(m=>{this.roamingSettings=m;this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);!0!==this.ena()&&(m=[Object.assign(new Ya.a,{name:"CSEnabled",bool:this.ena()})],Ca.a(Cb.a.X3m,!0,Date.now()-d,m));this.Zd.ggg()&&(m=new Kz,m.CSDisableDate=new Date(0),m.DesignerFlags="",m.FavoriteThemesIDs=
[],this.roamingSettings=m)}).catch(m=>{v.ULS.sendTraceTag(509137223,3016,15,`DesignerSettingsManager - failed loading from roaming with error ${JSON.stringify(m,["message","stack"],2)}`)})}else v.ULS.sendTraceTag(523850466,3016,50,"DesignerSettingsManager - initialize. No roaming")}Od(){v.ULS.sendTraceTag(523850497,3016,50,`DesignerSettingsManager - deinitialize. CS_enabled: ${this.ena()}`)}Q2b(d){this.fd.addHandler("OnSettingsChanged",d)}fPb(d){this.fd.removeHandler("OnSettingsChanged",d)}K_(){return this.Zd.Cie()||
this.Zd.ggg()?!0:!(!this.roamingSettings||!this.bfd)}Kvl(){this.ena()?v.ULS.shipAssertTag(523850498,3016,!1):(this.d3e=!0,this.roamingSettings&&(this.roamingSettings.CSDisableDate=new Date(0),this.Zdd()),this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs),v.ULS.sendTraceTag(523850499,3016,50,"DesignerSettingsManager - enableContextualSuggestions."))}ena(){if(this.Zd.Cie())return!0;if(this.K_())return!1===this.d3e||this.roamingSettings&&this.roamingSettings.CSDisableDate&&this.roamingSettings.CSDisableDate>
new Date(0)?!1:!0}Zff(){const d=this.ena();this.d3e=!1;d&&this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);v.ULS.sendTraceTag(523850500,3016,50,`DesignerSettingsManager - disableForSession. Changed:${d}`)}oTh(){if(this.roamingSettings){var d=this.ena();this.roamingSettings.CSDisableDate=new Date;this.Zdd();d&&this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);v.ULS.sendTraceTag(523850502,3016,50,`DesignerSettingsManager - disableUntilUpdate. Changed:${d}`)}else v.ULS.shipAssertTag(523850501,
3016,!1),this.Zff()}yWc(d,m){return this.K_()?xu(this.roamingSettings.DesignerFlags)&d?!0:!1:m}Glj(d){if(this.roamingSettings){var m=this.roamingSettings.DesignerFlags;d|=xu(m);this.roamingSettings.DesignerFlags=`1.${d}`;m!==this.roamingSettings.DesignerFlags&&(this.Zdd(),this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else v.ULS.shipAssertTag(508944657,3016,!1)}MEj(d){if(this.roamingSettings){var m=this.roamingSettings.DesignerFlags;d=xu(m)&~d;this.roamingSettings.DesignerFlags=`1.${d}`;
m!==this.roamingSettings.DesignerFlags&&(this.Zdd(),this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs))}else v.ULS.shipAssertTag(508944656,3016,!1)}SBi(){return!this.yWc(1,!0)}ipl(){this.Glj(1)}YWh(){this.MEj(1)}Z3l(){if(this.roamingSettings)return v.ULS.sendTraceTag(520488718,3016,50,`DesignerSettingsManager - getListOfFavoriteThemesIDs. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`),this.roamingSettings.FavoriteThemesIDs;v.ULS.shipAssertTag(520488719,3016,!1)}mMo(d){var m,
A;if(this.roamingSettings){var R=null!==(A=null===(m=this.roamingSettings.FavoriteThemesIDs)||void 0===m?void 0:m.indexOf(d,0))&&void 0!==A?A:-1;-1===R?(this.roamingSettings.FavoriteThemesIDs||(this.roamingSettings.FavoriteThemesIDs=[]),this.roamingSettings.FavoriteThemesIDs.unshift(d)):this.roamingSettings.FavoriteThemesIDs.splice(R,1);this.Zd.ggg()||this.Zdd();this.fd.raiseEvent("OnSettingsChanged",new Sys.EventArgs);v.ULS.sendTraceTag(520488716,3016,50,`DesignerSettingsManager - toggleFavoriteTheme. IDs of favorite themes:${this.roamingSettings.FavoriteThemesIDs}`)}else v.ULS.shipAssertTag(520488717,
3016,!1)}Zdd(){this.bfd&&(this.bfd.saveSettings(this.roamingSettings),v.ULS.sendTraceTag(523850503,3016,50,"DesignerSettingsManager - updateRoamingSettings"))}}Object(y.a)(Jy,"DesignerSettingsManager",null,[949]);class bo extends vn.a{constructor(d){super("DesignerSettingsReadyConditionId");this.An=d;this.k1=()=>{this.An.K_()?(this.pg(!0),this.An.fPb(this.k1)):v.ULS.sendTraceTag(523850465,3016,15,"DesignerSettingsReadyCondition: settings changed, but not loaded")}}initialize(){super.initialize();
this.An.K_()?this.pg(!0):this.An.Q2b(this.k1)}Od(){this.An.fPb(this.k1);super.Od()}}Object(y.a)(bo,"DesignerSettingsReadyCondition",vn.a,[]);var cx=c(719),Nx=c(879);class Ox{static URm(d){return String(d).charAt(0)==String(d)}static dwl(d){return Ox.URm(d)?"*"+d:d.toString()}static Jil(d){const m=[];for(let R=0;R<d.length;R+=2){var A=d.substring(R,Math.min(d.length,R+2));A=A.startsWith("*")?Number(A.substring(1)):Number(A);m.push(A)}return m}static BLm(d){return d instanceof Date&&!isNaN(d.getTime())}}
Object(y.a)(Ox,"WordDesignerSettingsUtils",null,[]);var wn=c(264);const Qp=new Date(0);class Su extends cx.a{constructor(d,m,A,R,da){super(d,m,A,R,da);this.J7="Word Designer";this.bxb=["CSDisableDate","DesignerFlags","FavoriteThemesIDs"];this.iZb=Su.hUj;this.cwc="getWordDesignerSettings";this.W_b="saveWordDesignerSettings";this.Idb=wn.a.cqe}cqe(){return this.oi}async W7c(){return!0}K2b(){var d;return["CSDisableDate",this.oi.CSDisableDate,"DesignerFlags",null!==(d=this.oi.DesignerFlags)&&void 0!==
d?d:"0","FavoriteThemesIDs",this.oi.FavoriteThemesIDs]}J2b(){var d,m=this.oi.CSDisableDate?this.oi.CSDisableDate.toISOString():"";m=this.oi.CSDisableDate?m.substring(0,m.indexOf("T")):"";const A=this.oi.FavoriteThemesIDs?this.oi.FavoriteThemesIDs.map(Ox.dwl).join(""):"";return{["CSDisableDate"]:this.qX(m),["DesignerFlags"]:this.qX(null!==(d=this.oi.DesignerFlags)&&void 0!==d?d:"0"),["FavoriteThemesIDs"]:this.qX(A)}}bLc(){return new Nx.a(this.oi)}get K6b(){return new Kz}W3c(d){const m=new Kz;if(d.CSDisableDate){const A=
this.c8i(d.CSDisableDate);m.CSDisableDate=Ox.BLm(A)?A:Qp}else m.CSDisableDate=null;m.DesignerFlags=d.DesignerFlags?this.i7c(d.DesignerFlags):"0";m.FavoriteThemesIDs=d.FavoriteThemesIDs?Ox.Jil(this.i7c(d.FavoriteThemesIDs)):[];return m}B5a(){return this.C_c()}saveSettings(d){this.oi=d;return this.M8c()}}Su.hUj="WordDesignerSettingsChangedEvent";Object(y.a)(Su,"WordDesignerSettingsHandler",cx.a,[948]);class yq{constructor(d,m,A,R,da,Ea,ib,Qb,pc=null,Pc){this.Zd=d;this.Jqa=m;this.UGd=A;this.zoa=R;this.k0=
da;this.vg=Ea;this.gm=Qb;this.qE=pc;this.n7b=Pc;this.hec=this.isInitialized=!1;this.nka=this.rca=0;this.O$d="";this.Kqa=new Map;this.dCb=new Map;this.dIc=0;this.p1a=new U.a;this.jJa=null;this.EKb=Rh.a.nil;this.GJb=!1;this.Sya=[];this.yhc=(gd,Cd)=>{this.jJa&&Cd.actionId===xe.a.fza&&this.jJa.Q_c()};this.Lnb=(gd,Cd)=>{if(null==this.Sya||0==this.Sya.length)this.nka=2;else if(Cd.data.nt!==cg.a.getTypeName())v.ULS.sendTraceTag(512350099,3016,50,`unexpected operationType: ${Cd.data.nt}`);else if(this.GJb)if(gd=
Cd.data.annotation)if(gd.annotationType!==jf.FormattingSuggestionsAnnotation.getTypeName())v.ULS.shipAssertTag(521429915,3016,!1);else if(Cd=this.zoa.getParent(gd))if(this.Sya.includes(Cd)){var ae=this.Sya.indexOf(Cd);-1!==ae&&(this.dCb.set(gd,{sgj:this.gm.GA(Cd),C0f:ae}),this.dIc=this.Sya.length,this.Uef(213),this.jJa||(this.jJa=new Dg.a(this.EKb,this.qE,this.Zd,!1,this.vg.aca),this.jJa.uSa(0)),1!==this.nka&&(this.nka=1,this.apc(this.nka)),this.dCb.size===this.dIc&&this.Poc(),this.WOo())}else v.ULS.sendTraceTag(521483348,
3016,50,`Skip non-pasted paragraph ${null===Cd||void 0===Cd?void 0:Cd.id}`);else v.ULS.shipAssertTag(521429914,3016,!1);else v.ULS.shipAssertTag(521429916,3016,!1)};this.Mnb=(gd,Cd)=>{Cd.data.nt===cg.a.getTypeName()&&(Cd.data.annotation?Cd.data.annotation.annotationType!==jf.FormattingSuggestionsSummaryAnnotation.getTypeName()?v.ULS.shipAssertTag(521429912,3016,!1):(this.rca&&(gd=[Object.assign(new Ya.a,{name:Cb.a.l6f,string:"CCPFloatieSmartPaste"})],Ca.a(Cb.a.k6f,!0,Date.now()-this.rca,gd),this.rca=
0),(Cd=Cd.data.annotation.content)?(Cd.errorCode||0===Cd.numberOfSuggestions)&&this.GJb&&0===this.nka&&this.wcf(213,5E3,!1):v.ULS.shipAssertTag(521429911,3016,!1)):v.ULS.shipAssertTag(521429913,3016,!1))};this.h1=(gd,Cd)=>{var ae;this.A_e(Cd.node);Cd.Uzi&&(this.GWk()?(this.gHm(),this.ZFo(),this.apc(0),this.wcf(213,1E4)):(this.vZo(this.Sya),this.Poc(),this.jJa&&1===this.jJa.jGo&&this.jJa.Q_c()),this.z1i=!0,Ca.a("PasteActionHappened",!0,void 0,[Object.assign(new Ya.a,{name:"IsNewPasteAction",Boolean:this.GJb}),
Object.assign(new Ya.a,{name:"CorrelationId",string:null===(ae=this.EKb)||void 0===ae?void 0:ae.toString()})]))};this.nka=0;this.usi();this.H3c=ib.Te(12)}initialize(){this.isInitialized||(v.ULS.sendTraceTag(521483352,3016,50,"SmartPasteManager - initialize"),this.vg.R2b(this.yhc),this.H3c.crh(this.h1),this.isInitialized=!0)}Od(){this.isInitialized&&(v.ULS.sendTraceTag(521483351,3016,50,"SmartPasteManager - deinitialize"),this.vg.g9f(this.yhc),this.Poc(),this.H3c.Wbj(this.h1),this.isInitialized=!1)}ZFo(){v.ULS.sendTraceTag(521483350,
3016,50,`SmartPasteManager - subscribe to AL was called: ${this.hec}`);this.hec||(this.rca=Date.now(),this.zoa.jG(this.Lnb),this.k0.jG(this.Mnb),this.k0.register(),this.zoa.register(),this.hec=!0,this.wcf(217,3E4))}Poc(){v.ULS.sendTraceTag(521483349,3016,50,`SmartPasteManager - unsub from AL was called: ${this.hec}`);this.hec&&(this.k0.unregister(),this.zoa.unregister(),this.zoa.kI(this.Lnb),this.k0.kI(this.Mnb),this.hec=!1,this.Uef())}usi(){switch(this.Zd.Pqb()){case 1:this.O$d="floatie.gbFormatWithDesignerButton-Menu16";
this.Jqa.Xeg("floatie.gbFormatWithDesignerButton");this.Kqa.set(0,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerAnalyzing,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.Kqa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipAvailable});this.Kqa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteFormatWithDesigner,altText:Box4Intl.Box4Strings.L_PasteFormatWithDesignerTooltipUnavailable});break;
case 2:this.O$d="floatie.gbMatchDocumentFormattingButton-Menu16";this.Jqa.Xeg("floatie.gbMatchDocumentFormattingButton");this.Kqa.set(0,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingAnalyzing,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Kqa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipAvailable});this.Kqa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormatting,
altText:Box4Intl.Box4Strings.L_PasteMatchDocumentFormattingTooltipUnavailable});break;case 3:this.O$d="floatie.gbUseSmartPasteButton-Menu16",this.Jqa.Xeg("floatie.gbUseSmartPasteButton"),this.Kqa.set(0,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPasteAnalyzing,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Kqa.set(1,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipAvailable}),this.Kqa.set(2,{labelText:Box4Intl.Box4Strings.L_PasteUseSmartPaste,
altText:Box4Intl.Box4Strings.L_PasteUseSmartPasteTooltipUnavailable})}}apc(d){if(0!==this.Kqa.size&&this.Kqa.get(d)){this.nka=d;var m=this.Kqa.get(d).labelText;d=this.Kqa.get(d).altText;var A=document.getElementById(this.O$d);this.Jqa.apc(m,d,A?!0:!1)}else this.usi(),v.ULS.sendTraceTag(521416988,3016,50,`pasteStateStrings initialized in updateSmartPasteButton method. Correlation id:${this.EKb}`)}gHm(){this.jJa=null;this.dCb.clear();this.nka=this.dIc=0;this.Uef()}wcf(d,m,A=!0){m=new $a.a(2,1,m,()=>
{switch(d){case 213:0===this.nka&&(this.apc(2),A&&this.Poc());break;case 217:this.Poc()}},d);n.AFrameworkApplication.lc.Wb(m);this.p1a.add(m)}Uef(d=null){if(0!==this.p1a.count)if(d){let m=0;for(;m<this.p1a.count;)this.p1a.J(m).Pra===d?(n.AFrameworkApplication.lc.ff(this.p1a.J(m)),this.p1a.removeAt(m)):m++}else{for(d=0;d<this.p1a.count;d++)n.AFrameworkApplication.lc.ff(this.p1a.J(d));this.p1a.clear()}}GWk(){if(this.UGd.instance){const d=this.UGd.instance.l$l();if(d!==Rh.a.nil&&d!==this.EKb)return this.EKb=
d,this.GJb=!0}else return v.ULS.sendTraceTag(521483347,307,10,"ClipboardActor future not ready"),this.GJb=!0;return this.GJb=0===this.dCb.size}vZo(d){1===this.nka&&(this.dIc!==d.length?v.ULS.sendTraceTag(521483346,3016,50,`Missmatch in number of pasted paragraph. Number of cached pasted paragraphs:${this.dIc}. Number of pasted paragraphs:${d.length}`):this.dCb.forEach((m,A)=>{m.C0f<d.length&&(A.parent=d[m.C0f])}))}$ko(d){this.UGd.instance?this.UGd.instance.kGi=d:v.ULS.sendTraceTag(521483345,307,10,
"ClipboardActor future not ready")}A_e(d){this.z1i&&(this.Sya=[],this.z1i=!1);this.Sya.push(d)}qGk(){this.Poc();if(0===this.dCb.size)return 0;const d=this.n7b.rGk(this.dCb,this.Sya);0<d?this.jJa.uSa(1):v.ULS.shipAssertTag(520646736,3016,!1);return d}DBi(d){return d?d===xe.a.NTa||d===xe.a.j$||d===xe.a.Gob:!1}aca(){return this.vg.aca}WOo(){const d=Ia.a.instance.Sa("Common.ISystemInitiatedFeedback");d&&d.execute(m=>{switch(this.Zd.Pqb()){case 1:m.logActivity(Cb.a.XTj,null);break;case 2:m.logActivity(Cb.a.cUj,
null);break;case 3:m.logActivity(Cb.a.pUj,null)}})}}Object(y.a)(yq,"SmartPasteManager",null,[672,947]);class dq{constructor(d){this.ppk=d}getPropertyValue(d,m,A){if(!d)return v.ULS.shipAssertTag(574407567,3016,!1),A;const R=new Kl.ScriptSharpLegacyMap;for(var da of d.wzj)if(da.Jn.hasProperty(m)){const Ea=da.cpEnd-da.Pp,ib=da.Jn.getValue(m);if(R.nb(ib)){let Qb;R.Z(Qb=ib,R.J(Qb)+Ea)}else R.add(ib,Ea)}da=d.textLength*Cb.a.FOo;for(const Ea of R.keys)if(R.J(Ea)>da)return Ea;if(d.paragraphFormat.hasProperty(m))return d.paragraphFormat.getValue(m);
d=d.paragraphFormat.ja(Td.a.styleName,Cb.a.EOo);return(d=this.ppk.Ar().QFa(d))?d.ja(m,A):A}}Object(y.a)(dq,"ParagraphFormattingSnapshotReader",null,[944]);class Uj{constructor(){this.gua=new Ji.a}put(d,m){this.gua.add(d,m)}sne(d){let m;return{returnValue:({value:m}=this.gua.Fc(d)).returnValue,Muj:m}}remove(d){this.gua.remove(d)}}Object(y.a)(Uj,"ParagraphFormattingStorage",null,[945]);class Fy{constructor(){this.NAc=new uk.a(T.a.ih())}put(d,m){this.NAc.nb(d)?this.NAc.Z(d,m):this.NAc.add(d,m)}sne(d){let m;
return{returnValue:({value:m}=this.NAc.Fc(d,m)).returnValue,dVa:m}}nb(d){return this.NAc.nb(d)}}Object(y.a)(Fy,"StyleStorage",null,[]);var eq=c(266);class Cz{constructor(d){this.eq=d;this.q4a=!1;this.YA=this.dialog=null;this.E_c=this.HJ=0;this.fd=new vb.a;this.IVf="OnApplyThemeDialogClosed"}showDialog(){this.dialog=new oa.a(!1,!1,!0);this.dialog.Cd=5;this.dialog.Uh(WordEditorIntl.WordEditorStrings.L_DesignerApplyThemeDialogTitle,null,this.eGb());this.YA=this.eq.Yf("DialogShown","ApplyThemeBlockingDialog");
this.q4a=!0;v.ULS.sendTraceTag(524121478,3016,50,"Apply theme blocking dialog is shown.");Ca.a(Cb.a.UGk,!0);this.E_c=this.HJ=0;eq.a.delay(6E4).continueWith(()=>{v.ULS.sendTraceTag(509367262,3016,50,"Apply theme blocking dialog started closing after timeout.");this.mva(!0)})}Xuo(d,m){var A,R;if(null===(A=d.decorators)||void 0===A?0:A.filter(Ea=>Ea.hasImages).length)return!0;const da=new Set;for(const [Ea,ib]of d.styles)null===(R=ib.decorators)||void 0===R?void 0:R.forEach(Qb=>{Qb.hasImages&&da.add(ym.g(Ea))});
if(!da.size)return!1;d=this.eq.Yf("UserAction","ApplyThemeDialogShouldShow");A=!1;for(const Ea of m.keys())if(da.has(Ea)){A=!0;break}d.stop();return A}mva(d=!1){this.q4a&&(d||this.E_c==this.HJ)&&(this.dialog.hide(),this.YA.stop(),this.q4a=!1,this.fd.raiseEvent(this.IVf),v.ULS.sendTraceTag(524121479,3016,50,`Apply theme blocking dialog has closed, isForced: ${d}`),d=[Object.assign(new Ya.a,{name:Cb.a.SGk,boolean:d})],Ca.a(Cb.a.RGk,!0,void 0,d))}g0e(){this.q4a&&(this.HJ+=1)}wUf(){if(this.q4a)return this.E_c+=
1,this.E_c==this.HJ?(this.mva(),!0):!1}y0e(d){this.fd.addHandler(this.IVf,d)}ecj(d){this.fd.removeHandler(this.IVf,d)}eGb(){return{["id"]:"ApplyThemeDialog",["dialogButtonsOption"]:5,["hideCloseButton"]:!0}}}Object(y.a)(Cz,"ApplyThemeDialogManagerImpl",null,[943]);class Pq{constructor(){this.sa=new vb.a}initialize(){}Od(){}DCd(d){this.sa.addHandler(Pq.UHa,d)}rcj(d){this.sa.removeHandler(Pq.UHa,d)}}Pq.UHa="OnThemesChanged";Object(y.a)(Pq,"AThemeProvider",null,[934,672]);class zv{constructor(d=Vk.none,
m=""){this.labelId=d;this.yea=m}getLabel(){return this.labelId}getStringId(){return this.yea}equals(d){return this.yea||d.yea?this.yea===d.yea:this.labelId===d.labelId}static equals(d,m){return d||m?d&&m?d.equals(m):!1:d===m}toString(){return null!==this.yea?this.yea:null!==this.labelId?this.labelId.toString():""}}Object(y.a)(zv,"SectionId",null,[]);class rt extends Pq{constructor(d,m,A,R,da){super();this.a2=d;this.qS=m;this.l1a=A;this.T1=R;this.Zd=da;this.Y6b=this.Lv=null;this.wfd=new Map([[Va.SectionLabel.Article,
Vk.article],[Va.SectionLabel.CoverLetter,Vk.coverLetter],[Va.SectionLabel.CoverPage,Vk.coverPage],[Va.SectionLabel.GeneralDocument,Vk.generalDocument],[Va.SectionLabel.Invoice,Vk.invoice],[Va.SectionLabel.Journal,Vk.journal],[Va.SectionLabel.Letter,Vk.letter],[Va.SectionLabel.Letterhead,Vk.letterhead],[Va.SectionLabel.Main,Vk.main],[Va.SectionLabel.Notes,Vk.notes],[Va.SectionLabel.Report,Vk.report],[Va.SectionLabel.Resume,Vk.resume],[Va.SectionLabel.Text2Image,Vk.text2Image],[Va.SectionLabel.ToDoList,
Vk.toDoList]]);this.Hsb=new Map([[Wp.letters,{id:"817f4488-91de-4a44-842e-44670553632b",displayName:"Letters"}],[Wp.writing,{id:"e3abc6aa-ea3f-4d0f-887d-e929caf85eaf",displayName:"Writing"}],[Wp.lists,{id:"d9d2be59-6d2a-41b7-bd37-74507d741f9c",displayName:"Lists"}],[Wp.resumes,{id:"39b64df5-1fb2-4699-b467-028bb20986e3",displayName:"Resumes"}],[Wp.business,{id:"f2015b9f-1a5f-4cdf-813a-3cbedcd28768",displayName:"Business"}],[Wp.education,{id:"f9f17e14-9f18-4872-ab1d-c4e05a7e3446",displayName:"Education"}],
[Wp.newsletters,{id:"dd8a511d-30c7-4019-8cfe-611888ea2450",displayName:"Newsletters"}]]);this.activeSection=null;this.isInitialized=!1;this.kth=(Ea,ib)=>{var Qb;this.a2.kI(this.kth);if(ib.data.annotation)if(ib.data.annotation.annotationType!==Va.ThemeGeneratorAnnotation.getTypeName())v.ULS.shipAssertTag(545399813,3016,!1);else if(Ea=ib.data.annotation.content){if(null===(Qb=Ea.sections)||void 0===Qb?0:Qb.length)this.Lv=this.bMl(Ea);this.sa.raiseEvent(Pq.UHa)}else v.ULS.shipAssertTag(545399814,3016,
!1);else v.ULS.shipAssertTag(545399812,3016,!1)};this.gZf=()=>{var Ea;this.Lv&&(this.Wnf(this.Lv)||(this.Lv=null===(Ea=this.Lv)||void 0===Ea?void 0:Ea.map(ib=>{ib.id.getLabel()===Vk.text2Image&&(ib.isLoaded=!0,ib.items=[]);return ib})),this.sa.raiseEvent(Pq.UHa))};this.omn=()=>{var Ea;const ib=this.ehi(this.Lv,Vk.text2Image);null!==ib&&void 0!==ib&&ib.items&&(this.qS.initialize(),this.qS.B0e(this.gZf),this.qS.oej()?this.Wnf(this.Lv)||(this.Lv=null===(Ea=this.Lv)||void 0===Ea?void 0:Ea.filter(Qb=>
Qb.id.getLabel()!==Vk.text2Image)):ib.isLoaded=!1,this.sa.raiseEvent(Pq.UHa))}}kVd(){return this.Lv}pSc(){return this.Y6b}m9b(){return this.activeSection}nY(){return!1}h3d(){}initialize(){this.isInitialized||(this.a2.jG(this.kth),this.a2.gwa(new Va.ThemeGeneratorSignal),this.T1.hrh(this.omn),this.isInitialized=!0)}Od(){}bMl(d){let m=[];this.Y6b=new uk.a(T.a.ih());this.activeSection=d.activeSection;for(const A of d.sections){if(A.label===Va.SectionLabel.CoverPage&&!ao())continue;d=[];for(const Ea of A.items){const ib=
Ea;if(yj.App.instance&&yj.App.instance.cD||void 0===ib.backgroundColor)ld.a.lda&&["D7ST","D14ST","D25ST"].some(Qb=>Qb===ib.name)||(this.Y6b.add(ib.name,ib.id),d.push(this.getTheme(ib,A)))}let R=null,da=null;if(this.Zd.Elb()){const Ea=this.u8h(this.wfd.get(A.label));Ea&&(R=Ea.id,da=Ea.displayName)}m.push({label:this.wfd.get(A.label),labelDisplayName:da,id:new zv(this.wfd.get(A.label),R),displayName:da,items:d,isLoaded:A.label!==Va.SectionLabel.Text2Image,nY:!1});A.label==Va.SectionLabel.Text2Image&&
(this.qS.initialize(),this.qS.B0e(this.gZf),this.qS.oej()&&(this.Wnf(m)||(m=null===m||void 0===m?void 0:m.filter(Ea=>Ea.id.getLabel()!==Vk.text2Image))))}return m}u8h(d){switch(d){case Vk.letter:case Vk.coverLetter:case Vk.letterhead:return this.Hsb.get(Wp.letters);case Vk.generalDocument:case Vk.journal:return this.Hsb.get(Wp.writing);case Vk.toDoList:return this.Hsb.get(Wp.lists);case Vk.resume:return this.Hsb.get(Wp.resumes);case Vk.notes:case Vk.invoice:return this.Hsb.get(Wp.business);case Vk.report:return this.Hsb.get(Wp.education);
case Vk.article:return this.Hsb.get(Wp.newsletters)}}getTheme(d,m){const A=new Map;let R=!1;for(const Ea of d.roles){var da=ym.f(Ea.type);A.set(ym.h(da),{decorators:this.l1a.i4h(Ea.style.decorators),fontName:Vn(Ea.style.fontFamily),fontSize:Ea.style.fontSize,fontColor:Ea.style.fontColor,bold:Ea.style.bold,italic:Ea.style.italic,underline:Ea.style.underline,alignment:Ea.style.alignment,lineSpacing:Ea.style.lineSpacing,beforeSpacing:Ea.style.beforeSpacing,afterSpacing:Ea.style.afterSpacing,specialIndentType:Ea.style.specialIndentType,
specialIndentBy:Ea.style.specialIndentBy,fontKerning:Ea.style.fontKerning,allCaps:Ea.style.allCaps});Ea.style.decorators&&(R=!0);da=Ea.style.fontFamily;Jl.a.fontService.isEnabled?Jl.a.fontService.Lna(da):Jl.a.BEa.isEnabled&&Jl.a.BEa.Lna(da)}m=this.u8h(this.wfd.get(m.label));return{type:d.type,name:d.name,id:d.id,styles:A,decorators:this.l1a.i4h(d.decorators),layout:d.layout,accentColor:d.accentColor,backgroundColor:d.backgroundColor,isSimpleTheme:!d.decorators&&!R,collectionId:null===m||void 0===
m?void 0:m.id,collectionName:null===m||void 0===m?void 0:m.displayName,IsL2Template:!1}}ehi(d,m){if(!d)return null;for(const A of d)if(A.id.getLabel()===m)return A;return null}Wnf(d){var m;const A=this.qS.n1l();this.qS.kcj(this.gZf);this.qS.Od();if(!A||null===(m=A.BR)||void 0===m||!m.length||A.BR[0].category!==Xj.SuggestionCategory.TextRelatedImage)return!1;d=this.ehi(d,Vk.text2Image);d.isLoaded=!0;null===d||void 0===d?void 0:d.items.forEach(R=>{var da;R.decorators=null===(da=R.decorators)||void 0===
da?void 0:da.map(Ea=>Ea.type===Tn.text2Image?{...Ea,imageUrl:A.baseUrl+A.BR[0].imageId,thumbnailUrl:A.baseUrl+A.BR[0].thumbnailId,altText:A.BR[0].altText}:Ea)});return!0}}Object(y.a)(rt,"AugLoopThemeProvider",Pq,[]);class Ws{constructor(d,m){this.text=d;this.role=m}}Object(y.a)(Ws,"BlankDocSentence",null,[]);class Tu{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc){this.$wj=1;this.Md=d;this.$o=m;this.Ce=A;this.Yc=R;this.zD=da;this.rh=Ea;this.$Ma=ib;this.gb=Qb;this.$W=pc;this.dLa=Pc}vYd(d){var m=Object(vf.a)(bg.AParagraphNode,
this.gb.$k(this.dLa.ed));m=this.hFm(m);this.SFo(m);d&&this.RDm(m)}WDj(d,m,A,R){let da=jd.a.createTextRange(m,d,d+this.$wj);this.Md.Ge(da,A);da=jd.a.createTextRange(m,d,d+A.length);m.WX(d);m.ra.nh(d).hyperlink=this.zD.fF(da,R,!0);this.$W.tX(da,Ea=>{this.Ce.S9c(Ea,!0)})}Kne(d,m,A){let R=jd.a.createTextRange(m,d,d+this.$wj);this.Md.Ge(R,A);R=jd.a.createTextRange(m,d,d+A.length);this.$W.tX(R,da=>{this.Ce.IL(da,!0)})}hFm(d){let m=Object(vf.a)(If.GraphIterator,this.Yc.Rf(d));m.od();const A=new U.a;for(let R=
0;10>R;R++){const da=Tu.F4e[R];kh.OutlineElementNavigator.Yd(m);this.rh.Oy(m,!1,!1);this.rh.OH(m);A.add(m.currentNode);const Ea=jd.a.Uc(m.currentNode,0);this.Md.Ge(Ea,da.text,!0,!1);this.$Ma.Bba(m.currentNode,da.role)}m=Object(vf.a)(If.GraphIterator,this.Yc.Rf(d));m.od();kh.OutlineElementNavigator.Yd(m);m.tg();return A}SFo(d){let m=0;for(const A of d)d=A.characterData.indexOf("$"),-1!==d&&(3===m?this.WDj(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreDesigner,Cb.a.gLk):6===
m?(this.Kne(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeStylesBold),d=A.characterData.indexOf("$"),this.Kne(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentStylesBold),d=A.characterData.indexOf("$"),this.WDj(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentLearnMoreStyles,Cb.a.hLk)):7===m?this.Kne(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold):9===m&&this.Kne(d,A,WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentHomeDesignerBold)),
m++}RDm(d){let m=0;for(;m<d.count;){var A=d.J(m);const da=Tu.F4e[m].role;for(;m+1<d.count&&Tu.F4e[m+1].role==da;)m++;var R=d.J(m);({id:A,returnValue:R}=this.$o.Uma(A.id,R.id));0===R?(A=this.$o.getById(A),A.title=ym.i(da),A.OJ=!0,A.removeWhenEdited=!0):v.ULS.shipAssertTag(528312211,3016,!1);m++}}}Tu.F4e=[new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentTitle,2),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSubtitle,3),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstHeading,
4),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFirstParagraph,13),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondHeading,5),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentSecondParagraph,13),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdParagraph,13),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFourthParagraph,13),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentThirdHeading,5),new Ws(WordEditorIntl.WordEditorStrings.L_Designer_BlankDocumentFifthParagraph,
13)];Object(y.a)(Tu,"BlankDocumentEditor",null,[942]);c(474);class Dz extends qu.a{constructor(){super();Dz.resolveInheritance();this.$$ge=this.getEnumerator}}Object(y.a)(Dz,"IntSet",qu.a,[130,78]);c(256);c(308);var Px=c(1704);const Xs=[Zo.RoleType.Title,Zo.RoleType.Subtitle,Zo.RoleType.Heading1,Zo.RoleType.Heading2,Zo.RoleType.Heading3,Zo.RoleType.Heading4,Zo.RoleType.Heading5,Zo.RoleType.Heading6,Zo.RoleType.Heading7,Zo.RoleType.Heading8,Zo.RoleType.Heading9,Zo.RoleType.BodyText,Zo.RoleType.ListItem],
Nq=[jf.FormattingSuggestionType.FontSize,jf.FormattingSuggestionType.FontFamily,jf.FormattingSuggestionType.FontColor,jf.FormattingSuggestionType.Alignment,jf.FormattingSuggestionType.Indentation,jf.FormattingSuggestionType.Bold,jf.FormattingSuggestionType.RightIndentation,jf.FormattingSuggestionType.Italic,jf.FormattingSuggestionType.Underline,jf.FormattingSuggestionType.AllCaps,jf.FormattingSuggestionType.LineSpacing,jf.FormattingSuggestionType.BeforeSpacing,jf.FormattingSuggestionType.AfterSpacing,
jf.FormattingSuggestionType.SpecialIndentType,jf.FormattingSuggestionType.SpecialIndentBy];class pw extends Pq{static zWk(d){const m=d.map(A=>A.roleType);return Xs.every(A=>m.includes(A))}static AWk(d){return d.every(m=>{const A=m.suggestions.map(R=>R.type);return Nq.every(R=>A.includes(R))})}}Object(y.a)(pw,"ACurrentThemeProvider",Pq,[]);class AB{constructor(){this.decorators=void 0;this.fontName=null;this.fontColor=this.fontSize=0;this.underline=this.italic=this.bold=!1;this.alignment=Yo.initial;
this.allCaps=!1;this.rightIndent=this.leftIndent=this.afterSpacing=this.beforeSpacing=this.lineSpacing=0;this.specialIndentType=wm.initial;this.fontKerning=this.specialIndentBy=0}}Object(y.a)(AB,"DesignerStyle",null,[]);class yu{constructor(){this.type=Zf.theme;this.styles=this.id=this.name=null;this.decorators=void 0;this.layout=null;this.accentColor=0;this.colorLabel=this.fontLabel=null;this.backgroundColor=void 0;this.isThemeInFavorites=this.isSimpleTheme=!1;this.collectionName=this.collectionId=
null;this.IsL2Template=!1}}Object(y.a)(yu,"DesignerTheme",null,[]);class Yj extends pw{constructor(d){super();this.oBe=null;this.Mjh=0;this.Btc=void 0;this.Zh=!1;this.Hzj=(m,A)=>{A.data.nt===Wm.a.getTypeName()&&(A.data.annotation?A.data.annotation.annotationType!==Px.ThemeExtractorAnnotation.getTypeName()?v.ULS.shipAssertTag(543745801,3016,!1):(m=A.data.annotation.content)?m.roleCommonProperties?(m=m.roleCommonProperties,this.oBe=Yj.H4h(m,!1),pw.zWk(m)&&pw.AWk(m)&&Yj.H4h(m,!0),this.Mjh=cb.a.$e(),
this.X7n(),this.sa.raiseEvent(Pq.UHa),v.ULS.sendTraceTag(524105094,3016,50,"theme provided")):(this.vZn(),v.ULS.sendTraceTag(524105093,3016,50,"no roleCommonProperties")):v.ULS.shipAssertTag(543745802,3016,!1):v.ULS.shipAssertTag(543745800,3016,!1))};this.yEc=d}get sBl(){return this.oBe}kVd(){return[]}m9b(){return null}pSc(){const d=new uk.a(T.a.ih());this.oBe&&d.add(Yj.CPh,255);return d}nY(){return!1}h3d(){}initialize(){this.Zh||(v.ULS.sendTraceTag(540312158,3016,50,"CurrentThemeProvider - initialize"),
this.yEc.register(),this.yEc.jG(this.Hzj),this.yEc.gwa(new Px.ThemeExtractorSignal),this.Zh=!0)}Od(){this.Zh&&(v.ULS.sendTraceTag(540312159,3016,50,"CurrentThemeProvider - deinitialize"),this.yEc.kI(this.Hzj),this.yEc.unregister(),this.Zh=!1)}YU(){return 1E3>cb.a.$e()-this.Mjh}vZn(){void 0!==this.Btc&&this.Btc.reject(Error("Theme was not extracted successfully"))}X7n(){void 0!==this.Btc&&(this.Btc.resolve(this.sBl),this.Btc=void 0)}static H4h(d,m=!0){const A=new uk.a(T.a.ih());for(var R of d)if(m||
!R.isGenerated){d=new AB;for(var da of R.suggestions){var Ea=da.fixedValue;switch(da.type){case jf.FormattingSuggestionType.FontSize:d.fontSize=parseFloat(Ea)/2;break;case jf.FormattingSuggestionType.FontFamily:d.fontName=Ea;break;case jf.FormattingSuggestionType.FontColor:d.fontColor=parseInt(Ea);break;case jf.FormattingSuggestionType.Alignment:d.alignment=this.tml(parseInt(Ea));break;case jf.FormattingSuggestionType.Indentation:d.leftIndent=parseFloat(Ea);break;case jf.FormattingSuggestionType.Bold:d.bold=
"true"===Ea;break;case jf.FormattingSuggestionType.RightIndentation:d.rightIndent=parseFloat(Ea);break;case jf.FormattingSuggestionType.Italic:d.italic="true"===Ea;break;case jf.FormattingSuggestionType.Underline:d.underline="true"===Ea;break;case jf.FormattingSuggestionType.AllCaps:d.allCaps="true"===Ea;break;case jf.FormattingSuggestionType.LineSpacing:d.lineSpacing=parseFloat(Ea);break;case jf.FormattingSuggestionType.BeforeSpacing:d.beforeSpacing=parseFloat(Ea);break;case jf.FormattingSuggestionType.AfterSpacing:d.afterSpacing=
parseFloat(Ea);break;case jf.FormattingSuggestionType.SpecialIndentType:d.specialIndentType=this.FBo(parseInt(Ea));break;case jf.FormattingSuggestionType.SpecialIndentBy:d.specialIndentBy=parseFloat(Ea)}}Ea=ym.f(R.roleType);A.add(ym.h(Ea),d)}m=Object;R=m.assign;da=new yu;d=Yj.CPh;Ea=new Map;for(const ib of A)Ea.set(ib.key,ib.value);return R.call(m,da,{name:d,styles:Ea})}static tml(d){switch(d){case 0:return Yo.left;case 1:return Yo.right;case 2:return Yo.center;case 3:return Yo.justify;default:return Yo.left}}static FBo(d){switch(d){case 0:return wm.firstLine;
case 1:return wm.hanging;default:return wm.firstLine}}}Yj.CPh="CurrentTheme";Object(y.a)(Yj,"CurrentThemeProvider",pw,[]);var $g=c(54);class co{static f1k(d){let m;[d,A,m]=$f.a.eXd(d);d=255*d/$f.a.g5;m=255*m/$f.a.g5;var A=255*A/$f.a.g5;if(240<m)return WordEditorIntl.WordEditorStrings.L_ColorWhite;if(20>m)return WordEditorIntl.WordEditorStrings.L_ColorBlack;if(20>=A)return 170<m?WordEditorIntl.WordEditorStrings.L_ColorGray25:100<m?WordEditorIntl.WordEditorStrings.L_ColorGray50:WordEditorIntl.WordEditorStrings.L_ColorGray80;
A=20<A&&75>=A?co.KPj:75<A&&115>=A?co.LPj:115<A&&150>=A?co.MPj:150<A&&240>=A?co.NPj:co.OPj;let R=0;for(;R<A.length&&d>=A[R];)R++;if(R==A.length)v.ULS.sendTraceTag(512570762,3023,10,"Hue index out of bounds");else return m>co.FQj[R]?co.YNj[R]:m<co.GQj[R]?co.XNj[R]:co.ZNj[R]}}co.YNj=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRose,WordEditorIntl.WordEditorStrings.L_ColorLightOrange,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorTan,
WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorLightYellow,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorLime,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorLightGreen,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorSkyBlue,WordEditorIntl.WordEditorStrings.L_ColorLightTurquoise,WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,
WordEditorIntl.WordEditorStrings.L_ColorLightBlue,WordEditorIntl.WordEditorStrings.L_ColorIceBlue,WordEditorIntl.WordEditorStrings.L_ColorPeriwinkle,WordEditorIntl.WordEditorStrings.L_ColorLavender,WordEditorIntl.WordEditorStrings.L_ColorPink,WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorRose];co.ZNj=[WordEditorIntl.WordEditorStrings.L_ColorCoral,WordEditorIntl.WordEditorStrings.L_ColorRed,WordEditorIntl.WordEditorStrings.L_ColorOrange,WordEditorIntl.WordEditorStrings.L_ColorBrown,
WordEditorIntl.WordEditorStrings.L_ColorTan,WordEditorIntl.WordEditorStrings.L_ColorGold,WordEditorIntl.WordEditorStrings.L_ColorYellow,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorOliveGreen,WordEditorIntl.WordEditorStrings.L_ColorGreen,WordEditorIntl.WordEditorStrings.L_ColorGreen,WordEditorIntl.WordEditorStrings.L_ColorBrightGreen,WordEditorIntl.WordEditorStrings.L_ColorTeal,WordEditorIntl.WordEditorStrings.L_ColorAqua,WordEditorIntl.WordEditorStrings.L_ColorTurquoise,
WordEditorIntl.WordEditorStrings.L_ColorPaleBlue,WordEditorIntl.WordEditorStrings.L_ColorBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorGalleryStandardColor10,WordEditorIntl.WordEditorStrings.L_ColorPink,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorRed];co.XNj=[WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed,WordEditorIntl.WordEditorStrings.L_ColorBrown,
WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorDarkYellow,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkGreen,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,
WordEditorIntl.WordEditorStrings.L_ColorDarkTeal,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorDarkBlue,WordEditorIntl.WordEditorStrings.L_ColorBlueGray,WordEditorIntl.WordEditorStrings.L_ColorIndigo,WordEditorIntl.WordEditorStrings.L_ColorDarkPurple,WordEditorIntl.WordEditorStrings.L_ColorPlum,WordEditorIntl.WordEditorStrings.L_ColorBrown,WordEditorIntl.WordEditorStrings.L_ColorDarkRed];co.KPj=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0];
co.LPj=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256];co.MPj=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256];co.NPj=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256];co.OPj=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,0,256];co.GQj=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100];co.FQj=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165];Object(y.a)(co,
"ColorNaming",null,[]);const qo=new Map([[3044790,3044790],[5269211,5269211],[32684,32684],[15362836,8600587],[13977459,11348049],[169590,160089],[1596093,1596093]]),lp=WordEditorIntl.WordEditorStrings.L_DesignerStyleTabularTitleDecoratorAltTextTitle,Gv=WordRibbonStrings.DesignerStyleCoverPageDecoratorAriaLabel,Gq=new Map([[Kk.a.xg("D10TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TIAltTextTitle,width:624,height:193}],[Kk.a.xg("D1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1TIAltTextTitle,
width:624,height:190}],[Kk.a.xg("D6TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD6TIAltTextTitle,width:624,height:193}],[Kk.a.xg("D7TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD7TIAltTextTitle,width:1575,height:728}],[Kk.a.xg("D31TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD31TIAltTextTitle,width:1428,height:390}],[Kk.a.xg("D3TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD3TIAltTextTitle,width:2216,
height:720}],[Kk.a.xg("D8TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TIAltTextTitle,width:1852,height:694}],[Kk.a.xg("D2TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD2TIAltTextTitle,width:1299,height:471}],[Kk.a.xg("D8TI1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI1AltTextTitle,width:1661,height:785}],[Kk.a.xg("D8TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI2AltTextTitle,width:1619,height:848}],
[Kk.a.xg("D8TI3a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI3aAltTextTitle,width:1602,height:473}],[Kk.a.xg("D8TI4a.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI4aAltTextTitle,width:1613,height:211}],[Kk.a.xg("D8TI5.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD8TI5AltTextTitle,width:1595,height:498}],[Kk.a.xg("D10TI2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD10TI2AltTextTitle,width:1281,height:357}],
[Kk.a.xg("D30TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD30TIAltTextTitle,width:1377,height:315}],[Kk.a.xg("DCL1TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL1TIAltTextTitle,width:2017,height:800}],[Kk.a.xg("DCL3TI.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageDCL3TIAltTextTitle,width:1246,height:551}],[Kk.a.xg("D1CP1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP1AltTextTitle,width:2112,height:1364}],
[Kk.a.xg("D1CP2.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP2AltTextTitle,width:624,height:624}],[Kk.a.xg("D1CP3.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP3AltTextTitle,width:624,height:433}],[Kk.a.xg("D1CP4.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerStyleImageD1CP4AltTextTitle,width:624,height:416}],[Kk.a.xg("DLT1.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:221}],[Kk.a.xg("DLT2.png"),
{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:540}],[Kk.a.xg("DLT3.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2048,height:152}],[Kk.a.xg("DLT4.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:300}],[Kk.a.xg("DLT5.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:300}],[Kk.a.xg("DLT6.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,
width:2448,height:709}],[Kk.a.xg("DLT7.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:300}],[Kk.a.xg("DLT8.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:280}],[Kk.a.xg("DLT9.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:704}],[Kk.a.xg("DLT10.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:593}],[Kk.a.xg("DLT11.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,
width:2448,height:380}],[Kk.a.xg("DLT12.png"),{altText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage,width:2448,height:160}]]);var cv=c(892),qw=c(1215),Hv=c(356);class tj{static vmm(){tj.Gb||(tj.Gb=new Kl.ScriptSharpLegacyMap,tj.Gb.add(Me.a.font,Bl.a.PH),tj.Gb.add(wc.a.Le,-1),tj.Gb.add(wc.a.Ke,-1),tj.Gb.add(wc.a.Ye,-1),tj.Gb.add(wc.a.Me,-1),tj.Gb.add(wc.a.Ie,-1),tj.Gb.add(wc.a.XT,""),tj.Gb.add(wc.a.Z_,""),tj.Gb.add(wc.a.PC,""),tj.Gb.add(wc.a.x0,""),tj.Gb.add(wc.a.XX,""),tj.Gb.add(Me.a.fontSize,
Bl.a.HM),tj.Gb.add(Me.a.fontColor,$f.a.auto),tj.Gb.add(Me.a.highlight,$f.a.auto),tj.Gb.add(Td.a.vx,$f.a.auto),tj.Gb.add(Me.a.vL,0),tj.Gb.add(Me.a.bold,!1),tj.Gb.add(Me.a.italic,!1),tj.Gb.add(Me.a.underline,!1),tj.Gb.add(Me.a.underlineType,Bl.a.TV),tj.Gb.add(Me.a.strikethrough,!1),tj.Gb.add(Td.a.Ht,!1),tj.Gb.add(Me.a.superscript,!1),tj.Gb.add(Me.a.subscript,!1),tj.Gb.add(Gg.a.$Va,!1),tj.Gb.add(wc.a.mw,""),tj.Gb.add(Me.a.UB,!1),tj.Gb.add(Me.a.V4,!1),tj.Gb.add(Me.a.isHidden,!1),tj.Gb.add(wc.a.p4a,!1),
tj.Gb.add(wc.a.Cib,0),tj.Gb.add(wc.a.noProof,!1),tj.Gb.add(Dm.a.eUf,!1),tj.Gb.add(Td.a.capitalization,0),tj.Gb.add(wc.a.bda,!1),tj.Gb.add(wc.a.o1,0),tj.Gb.add(wc.a.RA,0),tj.Gb.add(wc.a.pja,0),tj.Gb.add(wc.a.qt,0),tj.Gb.add(wc.a.iN,0),tj.Gb.add(wc.a.ee,0),tj.Gb.add(wc.a.xu,0),tj.Gb.add(wc.a.qja,0),tj.Gb.add(Td.a.N3c,0),tj.Gb.add(Td.a.M3c,0),tj.Gb.add(wc.a.Ui,Hv.a.gke),tj.Gb.add(wc.a.ua,Hv.a.Kig),tj.Gb.add(wc.a.ya,Hv.a.ya),tj.Gb.add(wc.a.xa,Hv.a.lineSpacing),tj.Gb.add(wc.a.C5,Hv.a.tZd),tj.Gb.add(wc.a.B5,
Hv.a.lZd),tj.Gb.add(wc.a.ZY,Hv.a.Lig),tj.Gb.add(wc.a.YY,Hv.a.Jig),tj.Gb.add(Me.a.Jh,0),tj.Gb.add(Me.a.gr,0),tj.Gb.add(Td.a.m6c,!1),tj.Gb.add(wc.a.Dw,null),tj.Gb.add(wc.a.Pz,null),tj.Gb.add(wc.a.Oz,null),tj.Gb.add(wc.a.Ti,-1));return tj.Gb}}tj.Gb=null;Object(y.a)(tj,"DefaultStyle",null,[]);class rw{constructor(d,m,A,R,da){this.sla=d;this.De=m;this.W1b=A;this.tyd=R;this.Qze=da}Xwl(d){return this.lfn(d)}g8a(d){var m=vg.a.zr();m=qh.WordSectionNavigator.instance.irf(m);d.layout||(d.layout={marginTop:Cb.a.MKd,
marginBottom:Cb.a.MKd,marginLeft:Cb.a.MKd,marginRight:Cb.a.MKd});m.properties.setValue(wc.a.marginTop,Jg.a.Nv(d.layout.marginTop));m.properties.setValue(wc.a.marginBottom,Jg.a.Nv(d.layout.marginBottom));m.properties.setValue(wc.a.marginLeft,Jg.a.Nv(d.layout.marginLeft));m.properties.setValue(wc.a.marginRight,Jg.a.Nv(d.layout.marginRight))}lfn(d){if(!d)return v.ULS.shipAssertTag(574755655,3016,!1),!1;let m=!0;d.type===Zf.templateTheme&&this.g8a(d);const A=this.De.Ar();if(d.styles.has("BodyText")){var R=
d.styles.get("BodyText");m=this.a1c(R,13,A)}else v.ULS.shipAssertTag(543745807,3016,!1);d.styles.forEach((da,Ea)=>{Ea=ym.g(Ea);if(13!==Ea&&14!==Ea||14===Ea&&this.sla.xpa())m=this.a1c(da,Ea,A)});if(this.sla.vxi())for(R=16;25>=R;R++){const da=ym.h(R);d.styles.has(da)||this.BVo(R,d,A)||(m=!1)}return m}a1c(d,m,A){var R;let da=ym.j(m),Ea=A.pj(da);!Ea&&14===m&&this.sla.xpa()&&(v.ULS.sendTraceTag(null,3018,15,"No Caption style in the document."),da=ym.j(13),Ea=A.pj(da));A=2===(null===(R=this.Qze)||void 0===
R?void 0:R.mQa())?rw.rff(d,m,!0):this.tvf(m,d,Ea,!0);if(Ea){if(this.tyd.put(da,Ea.clone().Gl()),A&&!this.W1b.LSa(ym.j(m),A,null))return!1}else return v.ULS.shipAssertTag(571999311,3016,!1),!1;return!0}BVo(d,m,A){const R=ym.j(d);A=A.pj(R);if(!A)return v.ULS.shipAssertTag(571012639,3016,!1),!1;const da=new Kl.ScriptSharpLegacyMap;m=m.accentColor;d=ym.c(d)?qo.has(m)?qo.get(m):0:0;da.add(Me.a.fontColor,0===d?$f.a.auto:$f.a.J5(d));this.tyd.put(R,A.clone().Gl());return this.W1b.LSa(R,da,null)}tvf(d,m,A,
R){if(R||!A){d=rw.rff(m,d);if(R&&A&&(A=A.xl()))for(R=0;R<A.length;R++)if(m=A[R],!d.nb(m)){let da;({value:da}=tj.vmm().Fc(m,da)).returnValue&&d.add(m,da)}return d}return null}static rff(d,m,A=!1){const R=new Kl.ScriptSharpLegacyMap;if(d.fontName){const da=fn(d.fontName);R.add(wc.a.XT,da);R.add(Me.a.font,da)}void 0!==d.fontColor&&R.add(Me.a.fontColor,0===d.fontColor?$f.a.auto:$f.a.J5(d.fontColor));void 0!==d.bold&&R.add(Me.a.bold,d.bold);void 0!==d.italic&&R.add(Me.a.italic,d.italic);void 0!==d.underline&&
R.add(Me.a.underline,d.underline);void 0!==d.allCaps&&R.add(Td.a.capitalization,d.allCaps?2:0);if(A)return R;void 0!==d.fontSize&&R.add(Me.a.fontSize,2*d.fontSize);void 0!==d.alignment&&R.add(Me.a.Jh,rw.uml(d.alignment));void 0!==d.beforeSpacing&&R.add(wc.a.Ui,Jg.a.mE(d.beforeSpacing));void 0!==d.afterSpacing&&R.add(wc.a.ua,Jg.a.mE(d.afterSpacing));R.add(wc.a.sw,15===m);R.add(wc.a.Ti,ym.a(m));d.lineSpacing&&(m=Object.assign(new cv.a,{unit:2,value:d.lineSpacing}),({xa:m,Ssg:A}=qw.a.usf(m)).returnValue?
(R.add(wc.a.ya,A),R.add(wc.a.xa,m)):v.ULS.shipAssertTag(592454611,3016,!1));switch(d.specialIndentType){case wm.firstLine:R.add(wc.a.RA,Jg.a.Nv(d.specialIndentBy));break;case wm.hanging:R.add(wc.a.qt,Jg.a.Nv(d.specialIndentBy))}return R}static uml(d){switch(d){case Yo.left:return 1;case Yo.center:return 2;case Yo.right:return 3;case Yo.justify:return 6;default:return v.ULS.shipAssertTag(592720768,3016,!1),null}}}Object(y.a)(rw,"StyleManager",null,[921]);class ms{constructor(d,m,A,R,da,Ea,ib,Qb,pc,
Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n){this.oc=d;this.oJ=m;this.sm=A;this.Pf=R;this.mb=da;this.Lk=Ea;this.wka=ib;this.iI=Qb;this.jg=pc;this.Sm=Pc;this.LO=gd;this.gm=Cd;this.Bz=ae;this.rn=Xd;this.Gqa=se;this.qc=Xe;this.l$=Be;this.J_=Hg;this.Zd=Xh;this.oNb=Fl;this.Es=Gm;this.Nl=em;this.qJ=$n;this.uQh=36;this.OPi=20}v2e(d,m,A){var R,da,Ea,ib,Qb,pc,Pc;if(d)if(m){var gd=!0,Cd=null===(R=this.mb.ib)||void 0===R?void 0:R.lb;d=Qe.ParagraphReader.$k(d,!0,!0);null===(da=this.Es)||void 0===da?void 0:da.jVa();
da=this.iEm(d,m);null===(Ea=this.Es)||void 0===Ea?void 0:Ea.jOa();gd&&(gd=0<(null===da||void 0===da?void 0:da.length));if(gd){A===Zf.templateTheme&&this.sll(da);Ea=new Set;gd=new Map;for(const ae of da)ae.bF&&Ea.add(ae.bF);this.BKn(Ea,m,gd)?this.uZo(da,m,gd,A)?(this.CKn(Ea,m),this.xDn(da,m),this.scrollIntoView(da,A===Zf.templateTheme),A!==Zf.templateTheme&&(null===(Qb=null===(ib=null===Cd||void 0===Cd?void 0:Cd.Pa)||void 0===ib?void 0:ib.node)||void 0===Qb?0:Qb.isConnected)&&(null===(pc=this.Es)||
void 0===pc?void 0:pc.jVa(),this.mb.Ac(Cd),null===(Pc=this.Es)||void 0===Pc?void 0:Pc.jOa())):v.ULS.shipAssertTag(520937801,3016,!1):v.ULS.shipAssertTag(520937802,3016,!1)}else v.ULS.shipAssertTag(520937803,3016,!1)}else v.ULS.shipAssertTag(536941707,3016,!1);else v.ULS.shipAssertTag(536941706,3016,!1)}sll(d){if(0<(null===d||void 0===d?void 0:d.length)){const m=d[d.length-1];!this.sm.Rf(m).zb(14)&&Qe.ParagraphReader.isEmpty(this.sm.Rf(m))&&(this.Pf.mza(m),d.pop())}}BKn(d,m,A){let R=void 0,da=!0;try{R=
this.Bz.Pc(15,xe.a.X3a,!1);R.Ky.Db(this.pageContentNode);for(const Ea of d)da&&(da=this.Q7n(Ea,m,A)),yo(Ea,this.Lk,!1,ib=>ib.hg),Yu(Ea,this.Lk,Gv),m.widthOption===Ra.stretchEdgeToEdge&&(this.wka.setCellPadding(Ea,1,this.uQh),this.wka.setCellPadding(Ea,3,this.uQh))}finally{R&&R.dispose()}return da}xDn(d,m){for(const A of d)A.bF||this.oJ.write(A,m)}CKn(d,m){var A;for(const R of d)m.heightOption===Ha.stretchInsideMargins&&this.vGl(R),d=nn(R,[]),this.oJ.write(R,m,d),(null===(A=this.qJ)||void 0===A?0:
A.QDd)||this.sDn(d,R)}sDn(d,m){const A=this.Bz.Pc(15,xe.a.rLd);try{A.Ky.Db(this.pageContentNode),bt(d,m,this.l$,uf.a.n5b)}finally{A.dispose()}}Z0n(d){const m=this.Bz.Pc(15,xe.a.o7a,!1);try{m.Ky.Db(this.pageContentNode);var A=this.sm,R=this.Pf;const da=A.Rf(d);null!==da&&da.od()&&(da.tg(),A.X$h(da).Oj()?da.tg():R.OH(da))}finally{m&&m.dispose()}}P8f(d){const m=this.Bz.Pc(15,xe.a.o7a,!1);try{m.Ky.Db(this.pageContentNode);at(d,this.sm);if(this.Zd.vCi()){let A=void 0,R=void 0;const da=Qe.ParagraphReader.yw(d,
!1,!1,!1);for(let Ea=da.count-1;0<=Ea;Ea--){const ib=da.J(Ea);if(!Qe.ParagraphReader.Xb(ib))continue;const Qb=this.qc.ZGb(ib);A||Qb!==ym.k(2)||Qe.ParagraphReader.Wda(ib)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle||(A=ib,this.ymi(A,2));R||Qb!==ym.k(3)||Qe.ParagraphReader.Wda(ib)===WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle||(R=ib,this.ymi(R,3));if(A&&R)break}}this.wka.jU(d)}finally{m&&m.dispose()}}h8f(d){this.oJ.read(d)&&(!Al(d,12)||null!==d&&void 0!==d&&d.bF?Al(d,
14)&&tu(d,this.sm)&&this.P8f(d):this.Z0n(d))}Inf(d){var m,A,R,da;if(!d)return null;const Ea=new Map,ib=atob(null===d||void 0===d?void 0:d.htmlToPaste),Qb=ct(ib);if(d.styleOverrides)for(const pc of d.styleOverrides){const Pc=ym.f(pc.type);Ea.set(ym.h(Pc),{fontName:pc.style.fontFamily?Vn(pc.style.fontFamily):void 0,fontSize:pc.style.fontSize,fontColor:pc.style.fontColor,bold:pc.style.bold,italic:pc.style.italic,underline:pc.style.underline,alignment:pc.style.alignment,lineSpacing:pc.style.lineSpacing,
beforeSpacing:pc.style.beforeSpacing,afterSpacing:pc.style.afterSpacing,specialIndentType:pc.style.specialIndentType,specialIndentBy:pc.style.specialIndentBy,fontKerning:pc.style.fontKerning,allCaps:pc.style.allCaps})}return{htmlToPaste:ib,htmlToPasteDark:Qb,imagePaths:null===(m=null===d||void 0===d?void 0:d.imagePaths)||void 0===m?void 0:m.map(pc=>Kk.a.xg(pc)),imageThumbnailPaths:null===(A=null===d||void 0===d?void 0:d.imagePaths)||void 0===A?void 0:A.map(pc=>Kk.a.xg("Thumbnail_"+pc)),thumbnailImage:this.Zd.xHk()?
Kk.a.xg(null===d||void 0===d?void 0:d.thumbnailImage):void 0,widthOption:null===d||void 0===d?void 0:d.widthOption,heightOption:null===d||void 0===d?void 0:d.heightOption,type:Tn.complexDecorator,hasImages:null!==(da=null===(R=null===d||void 0===d?void 0:d.imagePaths)||void 0===R?void 0:R.length)&&void 0!==da?da:!1,styleOverrides:Ea}}B_c(d){return Xu(d,this.oJ,this.l$,this.sm,uf.a.n5b)}iEm(d,m){var A=Qe.ParagraphReader.$k(this.pageContentNode,!0,!0);(new If.GraphIterator).set(A);A=this.Bz.Pc(4,xe.a.sDa);
try{A.Ky.Db(this.pageContentNode);const R=this.sm.Rf(d);if(!$o(R)){v.ULS.shipAssertTag(536941711,3016,!1);return}this.Pf.Oy(R,!0,!1,null,!1,!1);const da=new sq.a,Ea=this.qc.Ar();da.Rka=Ea.pj(Ul.StyleReader.wsb);const ib=this.Pf.OH(R,da);this.mb.Ac(new Pe.Selection([jd.a.Uc(ib,0)],!0))}finally{A&&A.dispose()}return ti(m.htmlToPaste,this.oc,this.mb)}Q7n(d,m,A){const R=wt(d);if(!R)return v.ULS.shipAssertTag(536941712,3016,!1),!1;m.heightOption===Ha.stretchInsideMargins&&this.nFo(d,R);m.widthOption!==
Ra.stretchInsideMargins&&m.widthOption!==Ra.stretchEdgeToEdge||this.oFo(d,R,m.widthOption===Ra.stretchEdgeToEdge);A.set(d,this.Ivf(d));return!0}nFo(d,m){m=lh.a.Ql(lh.a.Oi(m.uv-m.marginTop-m.marginBottom,1),1);const A=Bc.TableReader.qof(d);var R=new If.GraphIterator;R.set(d);R=Bc.TableReader.Euf(R);var da=R.reduce((Ea,ib)=>Ea+ib);da=0<da?m/da:void 0;if(1!==da)for(let Ea=0;Ea<A.count;Ea++){let ib;ib=da?R[Ea]*da:m/Bc.TableReader.gg(d);this.Lk.ylc(A.J(Ea),ib-.5/Bc.TableReader.gg(d))}}oFo(d,m,A){var R=
m.Ko;A?(d.properties.setValue(wc.a.ee,-m.marginLeft),d.properties.setValue(wc.a.xu,-m.marginRight)):R=R-m.marginLeft-m.marginRight;A=lh.a.Ql(lh.a.Oi(R,0),0);m=this.Ivf(d);R=m.reduce((da,Ea)=>da+Ea);A/=R;for(R=0;R<m.length;R++)this.Lk.lea(d,R,m[R]*A)}O7n(d){var m,A,R,da,Ea=d.currentNode;if(Ea&&!Ea.hg){var ib=Qe.ParagraphReader.yw(Ea,!1,!1,!1);if(d=Df.getContainingTableRow(d))if(d=$g.a.aSc(d),0>=d)v.ULS.shipAssertTag(523551523,3016,!1);else if(this.Nl.yd){if(Ea=Ea.Aj(this.Nl.yd.$b))if(Ea=lh.a.Ql(Ea.RQd(),
1)/d,1<Ea)for(const Qb of ib)if(Qe.ParagraphReader.Xb(Qb)){ib=jd.a.createTextRange(Qb,0,Qe.ParagraphReader.textLength(Qb));ib=Th.FormattingReader.Xr(ib);d=null!==(da=null===(R=null===(A=null===(m=null===ib||void 0===ib?void 0:ib.Lb)||void 0===m?void 0:m.formatting)||void 0===A?void 0:A.cache)||void 0===R?void 0:R.fontSize)&&void 0!==da?da:void 0;if(void 0===d){v.ULS.shipAssertTag(523548884,3016,!1);break}d=Math.floor(d/Ea);d<this.OPi&&(v.ULS.sendTraceTag(523548885,3016,50,"Font size limit reached"),
d=this.OPi);this.rn.hm(ib,Me.a.fontSize,d)}}else v.ULS.shipAssertTag(509667290,3016,!1);else v.ULS.shipAssertTag(523551522,3016,!1)}}uZo(d,m,A,R){var da=Qe.ParagraphReader.yw(this.pageContentNode,!1,!1,!1);const Ea=new U.a;for(var ib of da)d.includes(ib)||Ea.add(ib);da=this.gm.Hei(new Set([2,3]),Ea);for(const Qb of d)if(Qe.ParagraphReader.Xb(Qb))if(d=Qe.ParagraphReader.Wda(Qb).trim(),d.startsWith("Image"))this.J_.g0e(),this.mWo(Qb,m,A);else if(R!==Zf.templateTheme)switch(d){case "Title":d=void 0;
da.has(2)&&(d=da.get(2).J(0));!d&&1<Ea.count&&(ib=Ea.J(1),this.qc.Kg(this.qc.hp(ib))===Ul.StyleReader.wsb&&(d=ib));this.smi(Qb,d,2,m);break;case "Subtitle":d=void 0;da.has(3)&&(d=da.get(3).J(0));!d&&2<Ea.count&&(ib=Ea.J(2),this.qc.Kg(this.qc.hp(ib))===Ul.StyleReader.hfd&&(d=ib));this.smi(Qb,d,3,m);break;case "Author":d=this.Sm.Yx.IsAnonymous?WordEditorIntl.WordEditorStrings.L_Designer_CoverPageAuthorName:this.Sm.Yx.Name;d.endsWith(" \ud83c\udf0e")&&(d=Array.from(d).slice(0,-2).join(""));this.soe(Qb,
d,13,m);break;case "Company":this.soe(Qb,WordEditorIntl.WordEditorStrings.L_Designer_CoverPageCompanyName,13,m);break;case "Date":this.soe(Qb,(new Date).toLocaleDateString(),5,m)}return!0}qdj(d,m){d=jd.a.createTextRange(d,0,Qe.ParagraphReader.textLength(d));this.jg.Ge(d,m)}wGk(d,m,A){if(A.styleOverrides&&A.styleOverrides.has(ym.h(m))){A=A.styleOverrides.get(ym.h(m));m=rw.rff(A,m);A=jd.a.createTextRange(d,0,Qe.ParagraphReader.textLength(d));A=Th.FormattingReader.Xr(A);var R=new Set;R.add(Me.a.Jh);
R.add(wc.a.Ui);R.add(wc.a.ua);R.add(wc.a.ya);R.add(wc.a.xa);R.add(wc.a.ee);R.add(wc.a.xu);for(const da of m.keys)R.has(da)?d.setValue(da,m.J(da)):this.rn.hm(A,da,m.J(da))}}soe(d,m,A,R){const da=this.Bz.Pc(15,xe.a.sDa);try{da.Ky.Db(this.pageContentNode),this.qdj(d,m),this.iI.Bba(d,A),this.wGk(d,A,R)}finally{da&&da.dispose()}}mWo(d,m,A){var R=Qe.ParagraphReader.Wda(d).trim().split(" ");if(2!==R.length)v.ULS.shipAssertTag(536941713,3016,!1);else if(R=Number(R[1]),isNaN(R))v.ULS.shipAssertTag(536941714,
3016,!1);else{var da=this.Bz.Pc(15,xe.a.sDa);try{da.Ky.Db(this.pageContentNode),this.qdj(d,""),this.P4n(d,m.imagePaths[R],A)}finally{da&&da.dispose()}}}ymi(d,m){Kn(d,this.Pf,this.sm,this.oNb,this.jg,this.qc,this.iI,this.gm);this.iI.Bba(d,m)}L$l(d){switch(d){case 2:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageTitle;case 3:return WordEditorIntl.WordEditorStrings.L_Designer_CoverPageSubtitle;default:v.ULS.shipAssertTag(524115978,3016,!1)}}smi(d,m,A,R){m||v.ULS.sendTraceTag(521413784,3016,
50,`Using placeholder string for ${ym.h(A)}`);this.soe(d,m?Qe.ParagraphReader.Wda(m):this.L$l(A),A,R);this.Zd.vCi()&&m&&(d=new If.GraphIterator,d.set(m),$o(d),d.tg())}P4n(d,m,A){if(d.bEa&&d.bF){var R=d.bEa;this.wka.setCellPadding(R,1,0);this.wka.setCellPadding(R,3,0);this.wka.setCellPadding(R,0,0);this.wka.setCellPadding(R,2,0);var da=this.wka.Ls(R),Ea=new If.GraphIterator;Ea.set(d.bF);da=Bc.TableReader.Euf(Ea).slice(da,da+R.rowSpan).reduce((ib,Qb)=>ib+Qb,0);Ea=this.wka.XUd(R);this.LO.BCf(m,d,!1,
xe.a.X3a,xe.a.kYd,{S7c:{CRb:2,Nyh:Ea,Jyh:da},altText:Gq.has(m)?Gq.get(m).altText:void 0,vXd:xe.a.oVc},()=>{this.J_.wUf()&&this.W_o(A)});d=d.ja(Me.a.Jh,2);m=this.sm.Dk();m.set(R);m.Rd();m.tg();m.Rd();R=m.Rd();R.setValue(Me.a.Jh,d);R.setValue(wc.a.xu,0);R.setValue(wc.a.ee,0)}}W_o(d){for(const m of d.keys()){const A=this.Ivf(m),R=d.get(m);if(A.length!==R.length){v.ULS.shipAssertTag(520644507,3016,!1);break}for(let da=0;da<R.length;da++)A[da]!==R[da]&&this.Lk.lea(m,da,R[da])}}scrollIntoView(d,m){var A;
d=m?d.filter(R=>""!==(null===R||void 0===R?void 0:R.characterData)):d;if(d=d.length?d[0]:void 0)this.mb.Ac(new Pe.Selection([jd.a.Uc(d,0)],!0)),null===(A=this.Es)||void 0===A?void 0:A.D1(0)}vGl(d){const m=this.Bz.Pc(15,xe.a.X3a,!1);try{m.Ky.Db(d);const A=new If.GraphIterator;A.set(d);Df.forEachCellInTable(A,R=>{this.O7n(R);return!0})}finally{m.dispose()}}get pageContentNode(){return this.Gqa.value}Ivf(d){const m=new If.GraphIterator;m.set(d);return Bc.TableReader.Jha(m)}}Object(y.a)(ms,"ComplexDecoratorEditor",
null,[966]);var Ky=c(1874),Kp=c(2060);class oj{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd){this.fbg=[Me.a.bold,Me.a.fontColor,Me.a.italic,Me.a.strikethrough,Td.a.Ht,Me.a.subscript,Me.a.superscript,Me.a.underline,Gg.a.$Va];this.sla=d;this.fDe=m;this.AK=A;this.Ce=R;this.Xs=da;this.Mah=Ea;this.ev=ib;this.$W=Qb;this.Hf=pc;this.U6g=Pc;this.De=gd;this.Md=Cd;this.Bmd=ae;this.Qze=Xd;d=this.fbg.indexOf(Me.a.fontColor);-1<d&&this.fbg.splice(d,1)}Bba(d,m){var A,R;if(d){var da=this.De.Ar().pj(ym.j(m));
var Ea=!1;da||14!==m||(da=this.De.Ar().pj(ym.j(13)),Ea=!0);this.sla.SQm()&&15===m&&!this.U6g.oRc(d)&&this.U6g.d8k(d);if(this.sla.qRm()){var ib=ym.b(m)||2===m||3===m||14===m;(14!==m||14===m&&this.sla.xpa())&&this.ev.cK(da,d,!1,void 0,void 0,void 0,new Ky.a(this.fbg,ib,!0,!0))}else ib=this.Mah.Aei(d),(14!==m||14===m&&this.sla.xpa())&&this.ev.cK(da,d,!1),this.Mah.Nuh(d,ib);14===m&&this.sla.xpa()&&(Ea&&this.fFk(d,da),this.hVo(d));2===(null===(A=this.Qze)||void 0===A?void 0:A.mQa())&&d.bF&&0!==(null===
(R=d.characterData)||void 0===R?void 0:R.trim().length)&&this.yGl(d)}else v.ULS.shipAssertTag(592720725,3016,!1)}yGl(d){var m,A=d.bEa;if(null===A||void 0===A?0:A.hasProperty(Me.a.WK)){var R=A.tf(Me.a.WK);A=this.AK.Xr(jd.a.create(d));null!==(m=null===A||void 0===A?void 0:A.Jn)&&void 0!==m&&m.hasProperty(Me.a.fontColor)||(m=this.De.Kg(this.De.hp(d)),m=this.De.Ar().pj(m),m=null===m||void 0===m?void 0:m.getValue(Me.a.fontColor),1!==$f.a.v2a($f.a.E4e,$f.a.FBb(m))&&$f.a.v2a($f.a.Wpe,1!==$f.a.FBb(m))&&(R=
$f.a.v2a($f.a.FBb(m),$f.a.FBb(R)),d=this.o5l(d),R<d&&this.Ce.Mga(A)))}}o5l(d){const m=d.ra?d.ra.length:0;let A=3;for(let Ea=0;Ea<m-1;Ea++){var R=d.ra.J(Ea);if(R.formatting){var da=this.AK.Zn(R.formatting,Me.a.fontSize,0);R=this.AK.Zn(R.formatting,Me.a.bold,0);da=18<=da||14<=da&&R?3:4.5;da>A&&(A=da)}}return A}nfb(d,m){if(d)if(m){var A=this.Hf.Aca(d),R=null;A&&(R=this.Hf.gY(A));this.$W.tX(this.fDe(d,0,Qe.ParagraphReader.textLength(d)),da=>{for(const Ea of m)switch(Ea.type){case jf.FormattingSuggestionType.FontSize:this.WA(da,
Ea.fixedValue,A,d);break;case jf.FormattingSuggestionType.FontFamily:this.Njo(da,Ea.fixedValue,A,R,d);break;case jf.FormattingSuggestionType.FontColor:this.Xv(da,Ea.fixedValue,A,d);break;case jf.FormattingSuggestionType.Bold:this.IL(da,Ea.fixedValue,A,d);break;case jf.FormattingSuggestionType.Italic:this.fz(da,Ea.fixedValue);break;case jf.FormattingSuggestionType.Underline:this.R5(da,Ea.fixedValue);break;case jf.FormattingSuggestionType.Indentation:case jf.FormattingSuggestionType.RightIndentation:this.rko(d,
Ea.type,Ea.fixedValue);break;case jf.FormattingSuggestionType.Alignment:this.Qgo(d,Ea.fixedValue);break;case jf.FormattingSuggestionType.BeforeSpacing:this.Xpb(d,Ea.fixedValue);break;case jf.FormattingSuggestionType.AfterSpacing:this.Wpb(d,Ea.fixedValue);break;case jf.FormattingSuggestionType.LineSpacing:this.lD(d,Ea.fixedValue)}})}else v.ULS.shipAssertTag(592720730,3016,!1);else v.ULS.shipAssertTag(592720729,3016,!1)}WA(d,m,A,R){m=Number.parseInvariant(m);if(isNaN(m))v.ULS.shipAssertTag(592527906,
3016,!1);else if(this.Ce.WA(d,this.Ce.u5b(m)),A)try{this.rlo(R,m)}catch(da){v.ULS.shipAssertTag(574755654,3016,!1,"Couldn't set font size on a bullet/number. Exception: {0}",String.format("{0} {1}",da.message,da.stack))}}Xv(d,m,A,R){m=Number.parseInvariant(m);if(isNaN(m))v.ULS.shipAssertTag(592527907,3016,!1);else if(m=sa.a.jJ(m,6),this.Ce.Xv(d,m,null),A)try{this.qlo(R,m)}catch(da){v.ULS.shipAssertTag(520709763,3016,!1,"Couldn't set font color on a bullet/number. Exception: {0}",String.format("{0} {1}",
da.message,da.stack))}}Njo(d,m,A,R,da){m=m.split(",");if(0<m.length){m=m[0].trim();const Ea=this.AK.Zn(d,Me.a.font,"");Array.contains(Cb.a.t2h,Ea)||(this.Ce.bka(d,m),A&&R&&!R.listType&&this.plo(da,m))}}IL(d,m,A,R){m=Boolean.parse(m);this.Ce.IL(d,m);if(A)try{this.olo(R,m)}catch(da){v.ULS.shipAssertTag(520434947,3016,!1,"Couldn't set bold on a bullet/number. Exception: {0}",String.format("{0} {1}",da.message,da.stack))}}fz(d,m){m=Boolean.parse(m);this.Ce.fz(d,m)}R5(d,m){m=Boolean.parse(m);this.Ce.R5(d,
m)}rko(d,m,A){var R=parseFloat(A);isNaN(R)?v.ULS.shipAssertTag(592454612,3016,!1):(A=this.Xs.qq,R=Jg.a.mE(R),m===jf.FormattingSuggestionType.Indentation?A.Lza(d,1,R):A.rQb(d,1,R))}static vml(d){switch(d){case Yo.left:return Kp.a.Left;case Yo.center:return Kp.a.Center;case Yo.right:return Kp.a.Right;case Yo.justify:return Kp.a.Justified;default:return v.ULS.shipAssertTag(538240013,3016,!1),null}}Qgo(d,m){m=Number.parseInvariant(m);if(isNaN(m))v.ULS.shipAssertTag(592454613,3016,!1);else{switch(m){case Kp.a.Left:m=
1;break;case Kp.a.Right:m=3;break;case Kp.a.Center:m=2;break;case Kp.a.Justified:m=6;break;case Kp.a.None:m=0;break;default:return}this.Xs.pE(d,m)}}Xpb(d,m){m=Number.parseInvariant(m);isNaN(m)?v.ULS.shipAssertTag(574433370,3016,!1):this.Xs.Xpb(d,new cv.a(4,m))}Wpb(d,m){m=Number.parseInvariant(m);isNaN(m)?v.ULS.shipAssertTag(574433371,3016,!1):this.Xs.Wpb(d,new cv.a(4,m))}lD(d,m){m=Number.parseInvariant(m);isNaN(m)?v.ULS.shipAssertTag(574433372,3016,!1):this.Xs.lD(d,new cv.a(2,m))}olo(d,m){d=this.Md.S1a(d);
this.Ce.IL(d,m)}qlo(d,m){d=this.Md.S1a(d);this.Ce.Xv(d,m,null)}rlo(d,m){d=this.Md.S1a(d);this.Ce.WA(d,m)}plo(d,m){d=this.Md.S1a(d);this.Ce.bka(d,m)}fFk(d,m){if(null!=d&&null!=m){if(m.hasProperty(Me.a.fontSize)){var A=m.getValue(Me.a.fontSize);12<=A/2&&(A-=2)}this.nfb(d,[{type:jf.FormattingSuggestionType.FontSize,fixedValue:A.toString()},{type:jf.FormattingSuggestionType.Italic,fixedValue:"true"}])}}hVo(d){var m=Qe.ParagraphReader.Wf(d,!0);null!=m&&this.Bmd.kJh(m)?this.Xs.pE(d,Qe.ParagraphReader.Ox(m)):
(m=Qe.ParagraphReader.Wf(d,!1),null!=m&&this.Bmd.kJh(m)&&this.Xs.pE(d,Qe.ParagraphReader.Ox(m)))}}Object(y.a)(oj,"ParagraphDesigner",null,[927]);class BB{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg){this.oc=d;this.oJ=m;this.sm=A;this.Pf=R;this.iI=da;this.mb=Ea;this.wka=ib;this.Lk=Qb;this.Bz=pc;this.rc=Pc;this.Es=gd;this.l$=Cd;this.J_=ae;this.jg=Xd;this.oNb=se;this.qc=Xe;this.gm=Be;this.LO=Hg}v2e(d,m){var A,R,da,Ea;if(d)if(m){var ib=null===(A=this.mb.ib)||void 0===A?void 0:A.lb;if(this.insertTable(d,
m)){A=this.Bz.Pc(15,xe.a.sDa);var Qb=void 0,pc=void 0;try{A.Ky.Db(this.rc.ed);Qb=this.jhm(d);if(!Qb)return;pc=nn(Qb,["ParagraphPlaceholder"]);this.DFn(d,Qb,m);Yu(Qb,this.Lk,lp);this.hXn(Qb);bt(pc,Qb,this.l$,uf.a.lkg)}finally{A&&A.dispose()}this.mb.Ac(new Pe.Selection([jd.a.Uc(d,0)],!0));null===(R=this.Es)||void 0===R?void 0:R.D1(0);null===(da=this.Es)||void 0===da?void 0:da.jVa();this.mb.Ac(ib);null===(Ea=this.Es)||void 0===Ea?void 0:Ea.jOa();this.oJ.write(Qb,m,pc)}}else v.ULS.shipAssertTag(543737922,
3016,!1);else v.ULS.shipAssertTag(543737921,3016,!1)}jhm(d){d=this.sm.Rf(d);if(!$o(d))return v.ULS.shipAssertTag(527541731,3016,!1),null;if(!d.Oj())return v.ULS.shipAssertTag(527541760,3016,!1),null;const m=d.EQa(0,A=>Al(A,14));return Al(d.currentNode,14)?m:null}h8f(d,m){var A,R,da;const Ea=null===(A=this.mb.ib)||void 0===A?void 0:A.lb;this.mb.Ac(null);A=this.Bz.Pc(15,xe.a.o7a);try{A.Ky.Db(this.rc.ed),this.P8f(d,m)}finally{A&&A.dispose()}null===(R=this.Es)||void 0===R?void 0:R.jVa();this.mb.Ac(Ea);
null===(da=this.Es)||void 0===da?void 0:da.jOa()}P8f(d,m){var A;if(d&&m&&tu(d,this.sm)){m=Qe.ParagraphReader.yw(d,!1,!1);var R=void 0,da=this.oJ.read(d).OCd;for(let Ea=m.count-1;0<=Ea;Ea--){const ib=m.J(Ea),Qb=ib;if(0!==(null===(A=null===Qb||void 0===Qb?void 0:Qb.characterData)||void 0===A?void 0:A.trim().length)&&!da.find(pc=>{var Pc,gd;return(null===(Pc=pc.id)||void 0===Pc?void 0:Pc.toString())===(null===(gd=Qb.id)||void 0===gd?void 0:gd.toString())})){if(!Kn(ib,this.Pf,this.sm,this.oNb,this.jg,
this.qc,this.iI,this.gm))return;R||(R=ib)}}at(null!==R&&void 0!==R?R:d,this.sm);this.wka.jU(d)}}Inf(d){if(!d)return null;const m=Zu.N4n(atob(null===d||void 0===d?void 0:d.htmlTable)),A=ct(m[0]);return{htmlTable:m[0],htmlTableDark:A,hasImages:m[1],fontColor:null===d||void 0===d?void 0:d.fontColor,alignment:null===d||void 0===d?void 0:d.alignment,paragraphRow:null===d||void 0===d?void 0:d.paragraphRow,paragraphCol:null===d||void 0===d?void 0:d.paragraphCol,beforeSpacing:null===d||void 0===d?void 0:
d.beforeSpacing,afterSpacing:null===d||void 0===d?void 0:d.afterSpacing,type:null===d||void 0===d?void 0:d.type}}B_c(d){return Xu(d,this.oJ,this.l$,this.sm,uf.a.lkg)}insertTable(d,m){const A=this.sm.Rf(d);if(!$o(A))return v.ULS.shipAssertTag(542766210,3016,!1),!1;const R=this.Bz.Pc(4,xe.a.sDa);let da;d=Qe.ParagraphReader.Wf(d,!1);if(Qe.ParagraphReader.Xb(d)&&""===Qe.ParagraphReader.Wda(d))da=d;else try{R.Ky.Db(this.rc.ed),this.Pf.Oy(A,!1,!1),da=this.Pf.OH(A)}finally{R&&R.dispose()}this.mb.Ac(new Pe.Selection([jd.a.Uc(da,
0)],!0));ti(m.htmlTable,this.oc,this.mb);return!0}DFn(d,m,A){const R=this.sm.Rf(m);R.zb(8)&&(Df.moveToCellContent(R,A.paragraphRow,A.paragraphCol),Al(R.currentNode,11)?(R.Rd(),en(d,R.currentNode,this.oNb,this.jg,this.qc,this.iI,this.gm,!0),this.nBb(R.currentNode,m,A),d=this.sm.Rf(d),d.zb(8)&&(d.tg(),d.tg())):v.ULS.shipAssertTag(524115975,3016,!1))}hXn(d){const m=new If.GraphIterator;m.set(d);Df.forEachCellInTable(m,A=>{if(!A.dkb(11))return!0;A.Rd();if(!A.dkb(12))return A.sc(),!0;A.Rd();const R=A.currentNode;
Al(R,12)&&this.CCf(R);A.sc();A.sc();return!0})}CCf(d){const m=Zu.xSd(d);m&&(this.J_.g0e(),Zu.fCd(m,A=>{if((null===A||void 0===A?void 0:A.property)===Dm.a.ft)return this.LO.WVh(m,{S7c:void 0,altText:lp,vXd:xe.a.oVc}),this.J_.wUf(),!0}))}nBb(d,m,A){this.iI.nfb(d,[{type:jf.FormattingSuggestionType.FontColor,fixedValue:A.fontColor.toString()},{type:jf.FormattingSuggestionType.Alignment,fixedValue:oj.vml(A.alignment).toString()}]);const R=null!==A.beforeSpacing&&void 0!==A.beforeSpacing,da=null!==A.afterSpacing&&
void 0!==A.afterSpacing;if(R||da){const Ea=[];R&&Ea.push({type:jf.FormattingSuggestionType.BeforeSpacing,fixedValue:A.beforeSpacing.toString()});da&&Ea.push({type:jf.FormattingSuggestionType.AfterSpacing,fixedValue:A.afterSpacing.toString()});for(const ib of Qe.ParagraphReader.yw(m,!1,!1))ib!==d&&this.iI.nfb(ib,Ea)}yo(m,this.Lk,!1,Ea=>Ea.hg)}}Object(y.a)(BB,"TableDecoratorEditor",null,[966]);class yC{constructor(d,m,A,R,da,Ea,ib,Qb){this.oJ=d;this.LO=m;this.Bz=A;this.rc=R;this.q1=da;this.sm=Ea;this.l$=
ib;this.J_=Qb}v2e(d,m){if(d)if(m){if(d=this.HFm(d,m))m.decoratorId=d.properties.id.guid.toString(),this.oJ.write(d.Lb.paragraph,m)}else v.ULS.shipAssertTag(541735123,3016,!1,"Invalid decorator");else v.ULS.shipAssertTag(541735122,3016,!1,"Invalid node")}h8f(d,m){const A=this.Bz.Pc(15,xe.a.o7a);try{A.Ky.Db(this.rc.ed),this.q0n(d,m)}finally{A&&A.dispose()}}q0n(d,m){var A,R;if(d)if(m)if(m=null===m||void 0===m?void 0:m.decoratorId){var da=Zu.xSd(d),Ea=null===(A=null===da||void 0===da?void 0:da.properties)||
void 0===A?void 0:A.id;null!==(R=null===Ea||void 0===Ea?void 0:Ea.guid)&&void 0!==R&&R.toString()&&m===Ea.guid.toString()?this.mHk(d)?this.LO.Ajc(da,d):v.ULS.shipAssertTag(541735126,3016,!1,"Non-image and non-empty paragraphs before decorator"):v.ULS.shipAssertTag(538187611,3016,!1,"Decorator is not in its paragraph")}else v.ULS.shipAssertTag(538501596,3016,!1,"Decorator id null or undefined");else v.ULS.shipAssertTag(541735125,3016,!1,"Invalid decorator");else v.ULS.shipAssertTag(541735124,3016,
!1,"Invalid node")}mHk(d){d=this.q1.Nna(d,!0,!0);do if(!this.LO.nMd(d.ex)){const m=this.sm.Rf(d.ex);if(!Qe.ParagraphReader.isEmpty(m))return!1}while(d.h9());return!0}Inf(d){return d?d.type===Va.DecoratorType.ThemeImage?{imageUrl:Kk.a.xg(null===d||void 0===d?void 0:d.imageName),thumbnailUrl:Kk.a.xg("Thumbnail_"+(null===d||void 0===d?void 0:d.imageName)),imageType:null===d||void 0===d?void 0:d.imageType,type:null===d||void 0===d?void 0:d.type,hasImages:!0}:{imageUrl:"",thumbnailUrl:"",imageType:null===
d||void 0===d?void 0:d.imageType,type:null===d||void 0===d?void 0:d.type,hasImages:!0,altText:""}:null}B_c(d){const m=new Yg;this.l$.ODf(d,0,Qe.ParagraphReader.textLength(d),uf.a.Jzj,A=>{var R,da;60===A&&this.oJ.write(d,{decoratorId:null===(da=null===(R=d.id)||void 0===R?void 0:R.guid)||void 0===da?void 0:da.toString(),type:Tn.themeImage});m.resolve()});return m}HFm(d,m){var A,R;if(null===m||void 0===m||!m.imageUrl)return v.ULS.shipAssertTag(541735129,3016,!1,"Image URL is not valid"),null;d=Qe.ParagraphReader.$k(d,
!0,!0);if(!d)return v.ULS.shipAssertTag(541735130,3016,!1,"Cannot find paragraph"),null;this.J_.g0e();m=this.LO.BCf(m.imageUrl,d,!0,xe.a.X3a,xe.a.kYd,{S7c:{CRb:this.ui(m.imageType),cropAspectRatio:this.S0l(m)},altText:this.eY(m),vXd:xe.a.oVc},()=>{this.J_.wUf()});if((d=null===(A=null===m||void 0===m?void 0:m.Lb)||void 0===A?void 0:A.paragraph)&&(null===(R=m.properties)||void 0===R?0:R.id))return this.zDn(d),m;v.ULS.shipAssertTag(541735131,3016,!1,"Problem with image blob object while inserting theme image");
this.J_.mva(!0);return null}zDn(d){const m=this.Bz.Pc(15,xe.a.rLd);try{m.Ky.Db(this.rc.ed),this.l$.nic(d,0,Qe.ParagraphReader.textLength(d),uf.a.Jzj,60)}finally{m.dispose()}}ui(d){switch(d){case Da.BetweenLeftAndRightMargin:return 0;case Da.BetweenLeftAndRightEdge:return 1}}S0l(d){if(d.type===Tn.text2Image)return Cb.a.Qqi}eY(d){let m="";d.type===Tn.text2Image?m=d.altText:Gq.has(d.imageUrl)&&(m=Gq.get(d.imageUrl).altText);return m?m:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}}Object(y.a)(yC,
"ThemeImageDecoratorEditor",null,[966]);class eo{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep,Mm){this.oc=d;this.oJ=m;this.sm=A;this.Pf=R;this.iI=da;this.mb=Ea;this.wka=ib;this.LO=Qb;this.gm=pc;this.Bz=Pc;this.rc=gd;this.Lk=Cd;this.jg=ae;this.Sm=Xd;this.rn=se;this.q1=Xe;this.Gqa=Be;this.Es=Hg;this.l$=Xh;this.J_=Fl;this.Zd=Gm;this.oNb=em;this.qc=$n;this.Nl=Ep;this.qJ=Mm}create(d){if(d){var m=Array(d.length);d.forEach((A,R)=>{switch(A){case Tn.table:m[R]=new BB(this.oc,
this.oJ,this.sm,this.Pf,this.iI,this.mb,this.wka,this.Lk,this.Bz,this.rc,this.Es,this.l$,this.J_,this.jg,this.oNb,this.qc,this.gm,this.LO);break;case Tn.complexDecorator:m[R]=new ms(this.oc,this.oJ,this.sm,this.Pf,this.mb,this.Lk,this.wka,this.iI,this.jg,this.Sm,this.LO,this.gm,this.Bz,this.rn,this.Gqa,this.qc,this.l$,this.J_,this.Zd,this.oNb,this.Es,this.Nl,this.qJ);break;case Tn.themeImage:case Tn.text2Image:m[R]=new yC(this.oJ,this.LO,this.Bz,this.rc,this.q1,this.sm,this.l$,this.J_);break;default:v.ULS.shipAssertTag(542945287,
3016,!1)}});return m}v.ULS.shipAssertTag(543737925,3016,!1)}}Object(y.a)(eo,"DecoratorEditorFactoryImpl",null,[941]);class DA{constructor(d,m,A,R,da,Ea,ib,Qb){var pc;this.JKd=d;this.oJ=m;this.vg=A;this.sm=R;this.qJ=da;this.g1f=Ea;this.Bz=ib;this.Gqa=Qb;this.MWf=(Pc,gd)=>{if(2===gd.data){Pc=void 0;try{Pc=this.Bz.Pc(15,xe.a.uSh,!1),Pc.Ky.Db(this.Gqa.value),this.oJ.map.forEach((Cd,ae)=>{Cd.OCd.forEach(Xd=>{Xd&&this.g1f.nic(Xd,0,Qe.ParagraphReader.textLength(Xd),uf.a.n5b,70)});void 0!==ae&&bt(Cd.OCd,
ae,this.g1f,uf.a.n5b,70);ae&&this.g1f.nic(ae,0,Qe.ParagraphReader.textLength(ae),uf.a.n5b,70)}),this.oJ.clear()}finally{Pc.dispose()}}};null===(pc=this.qJ)||void 0===pc?void 0:pc.rrh(this.MWf)}Juh(d,m,A){if(!d)v.ULS.shipAssertTag(543737924,3016,!1);else if(m){var R=m.map(da=>da.type);this.JKd.create(R).forEach((da,Ea)=>{da.v2e(d,m[Ea],A)})}}ZZn(){this.oJ.map.forEach((d,m)=>{if(null!==m&&void 0!==m&&m.isConnected){var A=this.vg.s9(),R=this.JKd.create([d.gQh.type]);1===R.length&&R[0].h8f(m,d.gQh);A&&
this.oJ.remove(m)}})}dsm(){var d;return(null===(d=this.vg)||void 0===d?void 0:d.aca)===xe.a.Sua}M0n(){this.qJ.freeze();this.vg.undo();this.qJ.FSo()}async d2f(d){if(d){var m=this.JKd.create([Tn.themeImage,Tn.table,Tn.complexDecorator]),A=m[0],R=m[1];m=m[2];var da=[];for(const Ea of d)this.oJ.read(Ea)||(this.sm.Rf(Ea).zb(14)?da.push(R.B_c(Ea)):da.push(A.B_c(Ea)),da.push(m.B_c(Ea)));return Promise.all(da)}}i4h(d){if(!d)return null;const m=d.map(R=>R.type),A=[];this.JKd.create(m).forEach((R,da)=>{A.push(R.Inf(d[da]))});
return A}}Object(y.a)(DA,"DecoratorManagerImpl",null,[939]);class CB{constructor(d){this.OCd=[];this.gQh=d}loh(d){this.OCd.push(d)}}Object(y.a)(CB,"DecoratorInfoHolder",null,[]);class zC{constructor(){this.map=new Map}write(d,m,A){if(this.map.size>=Cb.a.Lil){v.ULS.sendTraceTag(526391136,3016,50,"Decorator storage capacity exceeded");const da=this.map.keys();for(let Ea=0;10>Ea;Ea++)this.map.delete(da.next().value)}this.map.set(d,new CB(m));const R=this.map.get(d);null===A||void 0===A?void 0:A.forEach(da=>
{R.loh(da)})}k9o(d,m){this.map.has(d)&&this.map.get(d).loh(m)}read(d){return this.map.has(d)?this.map.get(d):null}remove(d){this.map.has(d)&&this.map.delete(d)}clear(){this.map.clear()}csm(){for(const d of this.map.keys())if(null===d||void 0===d?0:d.isConnected)return!0;return!1}}Object(y.a)(zC,"DecoratorStorageImpl",null,[940]);class Ly{constructor(d,m,A,R,da,Ea,ib=null,Qb,pc,Pc,gd){this.n2a=d;this.Bz=m;this.iI=A;this.nN=R;this.rc=da;this.Vi=Ea;this.qE=ib;this.Zd=Qb;this.gm=pc;this.qc=Pc;this.W8=
gd}hFk(){return this.n2a.q9b().then(d=>{let m=0,A=0;const R=this.Bz.Pc(15,Ac.a.iPd);try{R.Ky.Db(this.rc.ed);for(const da of d){const Ea=this.NM(da),ib=this.m8a(da),Qb=this.uii(da,ib);if(ib){const pc=this.nN.OJn(this.nN.APc(da,Ea),(Pc,gd)=>{gd.forEach(Cd=>{this.iI.Bba(Cd,Pc.role)});return!0},Qb);pc&&1!==pc&&m++}else{const pc=this.nN.zJn(da,(Pc,gd)=>{gd.forEach(Cd=>{this.iI.nfb(Cd,Pc.suggestions)});return!0},Qb);pc&&1!==pc&&A++}}}finally{R&&R.dispose()}v.ULS.sendTraceTag(538190339,3016,50,`style:${m} df:${A} of total: ${d.count}`);
return m+A}).catch(d=>{v.ULS.shipAssertTag(538468955,3016,!1,String.format("{0} {1}",d.message,d.stack));return Promise.resolve(0)})}NM(d){if(!d)return v.ULS.shipAssertTag(546137295,3016,!1),null;if(!d.content)return v.ULS.shipAssertTag(546137296,3016,!1),null;const m=d.parent;return m?m:this.n2a.getParent(d)}m8a(d,m=0){const A=this.nN.APc(d,this.NM(d));if(!A.length)return!1;const R=this.gm.GA(A[0]);if(!R)return!1;m=0===m?R.role:m;const da=this.qc.Ar().pj(ym.j(m));if(!da)return v.ULS.sendTraceTag(538190341,
3016,50,`No WAC style for role: ${m}`),!1;var Ea=d.content;if(!Ea)return v.ULS.sendTraceTag(538190342,3016,50,`No formattingSuggestionsAnnotation for role: ${m}`),!1;d=new Set;let ib=!1;for(const Qb of Ea.suggestions){A.forEach(pc=>{this.bWm(Qb,da,Qe.ParagraphReader.ySc(pc))||(ib=!0)});if(ib)return v.ULS.sendTraceTag(538468956,3016,50,`type: ${Qb.type} role: ${R.role}`),!1;d.add(Qb.type)}m=this.wgm();for(const Qb of m)if(!d.has(Qb)&&(m=this.yLn(Qb))&&(Ea=da.getValue(m)))for(const pc of A){const Pc=
this.W8.Zn(this.W8.Xr(jd.a.create(pc)),m,null);if(Ea!==Pc)return v.ULS.sendTraceTag(512522202,3016,50,`type: ${Qb} role: ${R.role}`),!1}v.ULS.sendTraceTag(538468957,3016,50,`role: ${R.role}`);return!0}getPropertyValue(d,m,A,R){return(m=m.getValue(d))?m:A?(d=A.getValue(d))?d:R:R}bWm(d,m,A){switch(d.type){case jf.FormattingSuggestionType.FontSize:return Number.parseInvariant(d.fixedValue)===this.getPropertyValue(Me.a.fontSize,m,A,Bl.a.HM);case jf.FormattingSuggestionType.FontFamily:return d.fixedValue===
this.getPropertyValue(Me.a.font,m,A,"");case jf.FormattingSuggestionType.FontColor:return Number.parseInvariant(d.fixedValue)===this.getPropertyValue(Me.a.fontColor,m,A,$f.a.auto);case jf.FormattingSuggestionType.Bold:return Boolean.parse(d.fixedValue)===this.getPropertyValue(Me.a.bold,m,A,!1);case jf.FormattingSuggestionType.Italic:return Boolean.parse(d.fixedValue)===this.getPropertyValue(Me.a.italic,m,A,!1);case jf.FormattingSuggestionType.Underline:return Boolean.parse(d.fixedValue)===this.getPropertyValue(Me.a.underline,
m,A,!1);case jf.FormattingSuggestionType.LineSpacing:return this.yQm(m,A,d.fixedValue);case jf.FormattingSuggestionType.BeforeSpacing:return this.getPropertyValue(wc.a.Ui,m,A,0)===Jg.a.mE(Number.parseInvariant(d.fixedValue));case jf.FormattingSuggestionType.AfterSpacing:return this.getPropertyValue(wc.a.ua,m,A,0)===Jg.a.mE(Number.parseInvariant(d.fixedValue));case jf.FormattingSuggestionType.Indentation:return parseFloat(d.fixedValue)===this.getPropertyValue(wc.a.ee,m,A,0);case jf.FormattingSuggestionType.RightIndentation:return parseFloat(d.fixedValue)===
this.getPropertyValue(wc.a.xu,m,A,0);case jf.FormattingSuggestionType.Alignment:return this.qIm(m,A,d.fixedValue)}return!1}qIm(d,m,A){A=Number.parseInvariant(A);if(isNaN(A))return!0;d=this.getPropertyValue(Me.a.Jh,d,m,1);switch(A){case Kp.a.Left:return 1===d;case Kp.a.Right:return 3===d;case Kp.a.Center:return 2===d;case Kp.a.Justified:return 6===d}return!0}yQm(d,m,A){const R=this.getPropertyValue(wc.a.ya,d,m,void 0);d=this.getPropertyValue(wc.a.xa,d,m,0)/(0===R?240:20);return Number.parseFloat(A)===
d}wgm(){return[jf.FormattingSuggestionType.FontSize,jf.FormattingSuggestionType.FontFamily,jf.FormattingSuggestionType.FontColor,jf.FormattingSuggestionType.Bold,jf.FormattingSuggestionType.Italic,jf.FormattingSuggestionType.Underline,jf.FormattingSuggestionType.LineSpacing,jf.FormattingSuggestionType.BeforeSpacing,jf.FormattingSuggestionType.AfterSpacing,jf.FormattingSuggestionType.Indentation,jf.FormattingSuggestionType.RightIndentation,jf.FormattingSuggestionType.Alignment]}yLn(d){switch(d){case jf.FormattingSuggestionType.FontSize:return Me.a.fontSize;
case jf.FormattingSuggestionType.FontFamily:return Me.a.font;case jf.FormattingSuggestionType.FontColor:return Me.a.fontColor;case jf.FormattingSuggestionType.Bold:return Me.a.bold;case jf.FormattingSuggestionType.Italic:return Me.a.italic;case jf.FormattingSuggestionType.Underline:return Me.a.underline;case jf.FormattingSuggestionType.LineSpacing:return wc.a.xa;case jf.FormattingSuggestionType.BeforeSpacing:return wc.a.Ui;case jf.FormattingSuggestionType.AfterSpacing:return wc.a.ua;case jf.FormattingSuggestionType.Indentation:return wc.a.ee;
case jf.FormattingSuggestionType.RightIndentation:return wc.a.xu;case jf.FormattingSuggestionType.Alignment:return Me.a.Jh;default:v.ULS.shipAssertTag(512522201,3016,!1,`type: ${d}`)}}rGk(d,m){let A=0,R=0;const da=this.Bz.Pc(15,xe.a.fza);try{da.Ky.Db(this.rc.ed),d.forEach((Ea,ib)=>{if(this.m8a(ib,Ea.sgj.role))this.iI.Bba(this.NM(ib),Ea.sgj.role),A++;else{const Qb=ib.content;Qb&&(this.iI.nfb(m?m[Ea.C0f]:this.NM(ib),Qb.suggestions),R++)}})}finally{da&&da.dispose()}v.ULS.sendTraceTag(524170564,3016,
50,`style:${A} df:${R} of total: ${d.size}`);return A+R}eBl(d){let m=0;for(const A of d.suggestions)m+=Math.pow(2,A.type);return m}uii(d,m){const A=this.NM(d);if(!A)return[];const R=this.gm.GA(A);return R?(d=d.content)?[Object.assign(new Ya.a,{name:"formatTypes",int64:this.eBl(d)}),Object.assign(new Ya.a,{name:"role",int64:R.role}),Object.assign(new Ya.a,{name:"textLength",int64:A.FPb.length}),Object.assign(new Ya.a,{name:"useStyles",bool:m})]:[]:[]}Tum(d){this.nN.gvm(d)}bxo(d,m){const A=this.m8a(m),
R=this.uii(m,A);if(A)this.nN.cje(new Un.b(new Dg.c(Rh.a.create(),this.qE,this.Zd,!0,R),this.nN.APc(m,d),0,this.Vi.textLength(d),(da,Ea)=>{Ea.forEach(ib=>{this.iI.Bba(ib,da.role)});return!0}));else{const da=m.content;da&&this.nN.cje(new Un.b(new Dg.c(Rh.a.create(),this.qE,this.Zd,!0,R),this.nN.APc(m,d),0,this.Vi.textLength(d),(Ea,ib)=>{ib.forEach(Qb=>{this.iI.nfb(Qb,da.suggestions)});return!0}))}}}Object(y.a)(Ly,"DocumentConsistencyManager",null,[938]);var Iv=c(711);class sw{constructor(d){this.jpd=
void 0;this.Zh=!1;this.Fnb=(m,A)=>{m=A.data.nt;m!==Wm.a.getTypeName()&&m!==Iv.a.getTypeName()||this.update(A.data.annotation)};this.uTg=d;this.sa=new vb.a}vxk(d){this.sa.addHandler(sw.Ugf,d)}Obj(d){this.sa.removeHandler(sw.Ugf,d)}get AWc(){return this.jpd}set AWc(d){this.jpd!==d&&(this.jpd=d,this.sa.raiseEvent(sw.Ugf,new lq.a(this.jpd)))}initialize(){this.Zh||(this.uTg.jG(this.Fnb),this.Zh=!0)}Od(){this.Zh&&(this.uTg.kI(this.Fnb),this.Zh=!1)}update(d){this.AWc=d.content.supportedLanguagesCoverage>
Cb.a.Fxj}}sw.Ugf="DocumentContentLanguageSupportChangedEventKey";Object(y.a)(sw,"DocumentLanguageManager",null,[929,672]);var AC=c(323),tw=c(378);class Jv{constructor(d,m,A,R,da,Ea){this.jg=d;this.Zm=m;this.Jd=A;this.gm=R;this.SA=da;this.p1=Ea;this.HLf=new Ji.a}d8k(d){var m=this.gm.GA(d);if(null==m.k0c)v.ULS.shipAssertTag(556323523,3016,!1,"ListId not set in manual list item state!");else{var A=m.k0c,R=m.k0c,da=m.listItemPrefix,Ea=!1;this.HLf.nb(R)?A=this.HLf.get(R):Ea=!0;var ib=this.gm.L4l(R);if(ib)if(ib.levelInfos&&
ib.levelInfos.length){null==m.u4d&&v.ULS.shipAssertTag(556323526,3016,!1,"Manual List Item level is not set!");ib.fontFamily||v.ULS.shipAssertTag(556323527,3016,!1,"Font family not set for manual list item!");var Qb=ib.fontFamily||Bl.a.PH,pc=m.u4d||0,Pc=Jv.ssf(ib,pc);m=Jv.e4l(ib,pc);var gd=Jv.l3l(ib,pc);if(42===m)v.ULS.shipAssertTag(556323528,3016,!1,"Cannot map ListStyle!");else{A=this.scl(A,Qb,pc,Pc,m,gd);if(da)this.B0n(d,da);else if(ib.listType===Kp.e.Numbered){v.ULS.shipAssertTag(556323529,3016,
!1,"No list prefix detected!");return}da=new If.GraphIterator;ib=new oi.DictionaryPropertySet;this.bHn(d,m,da,ib);m=this.SA.yU(d);this.XEk(A,da,ib,Ea);this.p1.Lza(d,m.unit,m.value);d=this.oRc(d);null!=d?this.HLf.Z(R,d):v.ULS.shipAssertTag(556323530,3016,!1,"Didn't get list id of converted list!")}}else v.ULS.shipAssertTag(556323525,3016,!1,"No level infos in manual list info!");else v.ULS.shipAssertTag(556323524,3016,!1,"Cannot find manual list info!")}}oRc(d){d=this.Jd.Aca(d);return(null===d||void 0===
d?0:d.hasProperty(wc.a.listID))?d.getValue(wc.a.listID):null}XEk(d,m,A,R){this.Zm.Zma(A,m,d,R)}B0n(d,m){if(m)try{const A=jd.a.createTextRange(d,0,Jv.cam(m,d.characterData));this.jg.Ge(A,"")}catch(A){v.ULS.shipAssertTag(556074240,3016,!0,`Remove list prefix failed! error ${A}`)}}bHn(d,m,A,R){A.set(d);A.zb(11)&&A.jd(11);A.set(A.currentNode);Em.SelectionEditor.Bu(A);R.setValue(Dm.a.PJ,0);R.setValue(Dm.a.MA,6===m?1:0);R.setValue(wc.a.ks,AC.a.iXd)}scl(d,m,A,R,da,Ea){d=tw.a.IX(6===da?1:0,da,null,d,A,R,
m);Ea&&(d.UA=Ea);return d}static e4l(d,m){switch(Jv.v7l(d,m)){case "decimal":return 1;case "lowerLetter":return 2;case "lowerRoman":return 3;case "upperLetter":return 4;case "upperRoman":return 5;case "bullet":return 6;default:return 42}}static v7l(d,m){for(let A=0;A<d.levelInfos.length;A++){const R=d.levelInfos[A];if(R.level===m)return R.numberFormat||d.listType!==Kp.e.Numbered?d.levelInfos[A].numberFormat:"decimal"}v.ULS.shipAssertTag(556323531,3016,!1,"No number format for given level!");return null}static ssf(d,
m){for(let A=0;A<d.levelInfos.length;A++){const R=d.levelInfos[A];if(R.level===m)return R.levelText||d.listType!==Kp.e.Numbered?R.levelText:"%1."}v.ULS.shipAssertTag(556323532,3016,!1,"No level text for given level!");return null}static l3l(d,m){for(let A=0;A<d.levelInfos.length;A++){const R=d.levelInfos[A];if(R.level===m)return R.startAt}v.ULS.shipAssertTag(556323533,3016,!1,"No StartAt value for given level!");return null}static cam(d,m){var A=m.indexOf(d);if(-1==A)return v.ULS.shipAssertTag(556074241,
3016,!1,"Prefix not found in paragraph text!"),0;d=A+d.length;for(A=0;d+A<=m.length&&" "==m.charAt(d+A);)A++;return d+A}}Object(y.a)(Jv,"ManualListConverter",null,[928]);class Xx extends Pq{constructor(d){super();this.yTi=d;this.U8c=10;this.activeSection=this.Y6b=this.Lv=null;this.isInitialized=!1}kVd(){return this.Lv}pSc(){return this.Y6b}m9b(){return this.activeSection}nY(d){var m;const A=null===(m=this.Lv)||void 0===m?void 0:m.find(R=>R.id.equals(d));return A&&A.nY}h3d(d,m){const A=d?this.Lv.find(R=>
R.id.equals(d)):void 0;A&&this.yTi.QHi(n.AFrameworkApplication.uiCulture,d.toString(),this.U8c,A.items.length).then(R=>{var da;if(R&&0!==R.length){for(const Ea of R)A.items.push({type:Zf.officeTemplate,name:Ea.Id,templateId:Ea.Id,previewImageUrl:Ea.ThumbnailUrl,binaryUrl:Ea.BinaryUrl,isPortraitOriented:null!==(da=Ea.IsPortraitLayout)&&void 0!==da?da:!0,isPremium:Ea.IsPremium,collectionId:A.id.toString(),collectionName:A.displayName,isL2Template:m});A.nY=0===A.items.length%this.U8c;A.nY&&(this.sa.raiseEvent(Pq.UHa),
this.h3d(A.id))}else A.nY=!1;this.sa.raiseEvent(Pq.UHa)}).catch(()=>{A.nY=!1;this.sa.raiseEvent(Pq.UHa)});Promise.resolve()}dIi(){var d;this.yTi.QHi(n.AFrameworkApplication.uiCulture,null,this.U8c,null===(d=this.Lv)||void 0===d?void 0:d.length).then(m=>{var A;this.Y6b=new uk.a(T.a.ih());let R=new Map,da=new Map;for(let Ea of m)R.has(Ea.CollectionId)||(R.set(Ea.CollectionId,[]),da.set(Ea.CollectionId,Ea.CollectionDisplayName)),R.get(Ea.CollectionId).push({type:Zf.officeTemplate,name:Ea.Id,templateId:Ea.Id,
previewImageUrl:Ea.ThumbnailUrl,binaryUrl:Ea.BinaryUrl,isPortraitOriented:null!==(A=Ea.IsPortraitLayout)&&void 0!==A?A:!0,isPremium:Ea.IsPremium,collectionId:Ea.CollectionId,collectionName:Ea.CollectionDisplayName,isL2Template:Ea.IsL2Template});for(let Ea of R.keys())this.Lv.push({label:Vk.none,labelDisplayName:da.get(Ea),id:new zv(Vk.none,Ea),displayName:da.get(Ea),items:R.get(Ea),isLoaded:!0,nY:0<R.get(Ea).length&&0===R.get(Ea).length%this.U8c});0===this.Lv.length%this.U8c&&(this.sa.raiseEvent(Pq.UHa),
this.dIi());this.sa.raiseEvent(Pq.UHa)}).catch(m=>{v.ULS.shipAssertTag(509693954,3016,!1,`Office templates retrieval error: ${m}`)});Promise.resolve()}initialize(){this.isInitialized||(this.Lv=[],this.dIi(),this.isInitialized=!0)}Od(){}}Object(y.a)(Xx,"OfficeTemplatesThemeProvider",Pq,[]);var Hq=c(136),Lz=c(912);class DB{constructor(d=null,m=null){this.Wx=d;this.nKo=m}}Object(y.a)(DB,"ParagraphFormattingSnapshot",null,[]);class Kv{constructor(d,m){this.formatting=d;this.Vob=m}}Object(y.a)(Kv,"FormattingPropertyDefinitionPair",
null,[]);class Yx{constructor(d,m){this._fontColor=this.WEc=this._formatting=0;this.uW=null;this.Pp=d;this.o9k=m}ykc(d,m){if(!d)return v.ULS.shipAssertTag(592307426,3016,!1),!1;this._formatting=0;for(const A of Yx.TWg)m.Zn(d,A.Vob,!1)&&(this.dph(A.formatting),64===A.formatting&&(this.WEc=m.Zn(d,Me.a.underlineType,Bl.a.KSb)),256===A.formatting&&(this._fontColor=m.Zn(d,Me.a.fontColor,$f.a.auto)));d=m.Zn(d,Me.a.font,"");fb.a.contains(Cb.a.t2h,d)&&(this.dph(128),this.uW=d);return!!this._formatting}lUa(d,
m){if(!d)v.ULS.shipAssertTag(592307427,3016,!1);else if(!m)v.ULS.shipAssertTag(592307456,3016,!1);else if(this._formatting){for(const A of Yx.TWg)if(this.rvi(A.formatting))switch(A.formatting){case 1:m.IL(d,!0);break;case 8:m.Yge(d,!0);break;case 256:m.Xv(d,sa.a.jJ(this._fontColor,6),null);break;case 2:m.fz(d,!0);break;case 4:m.fka(d,!0);break;case 16:m.YIa(d,!0);break;case 32:m.xra(d,!0);break;case 64:m.hka(d,this.WEc)}this.rvi(128)&&m.bka(d,this.uW)}}dph(d){this._formatting|=d}rvi(d){return(this._formatting&
d)===d}}Yx.TWg=[new Kv(1,Me.a.bold),new Kv(256,Me.a.fontColor),new Kv(2,Me.a.italic),new Kv(4,Me.a.strikethrough),new Kv(8,Td.a.Ht),new Kv(16,Me.a.subscript),new Kv(32,Me.a.superscript),new Kv(64,Me.a.underline)];Object(y.a)(Yx,"TextRunFormattingSnapshot",null,[]);class EB{get Jo(){return null!=this.REg?this.REg:this.REg=Hq.a.getInstance()}constructor(d,m,A,R,da,Ea,ib){this.dnm=d;this.W8=m;this.rn=A;this.Jd=R;this.x5=da;this.Hea=Ea;this.Aw=ib}Nuh(d,m){if(d)if(m){var A=m.Wx;if(m=m.nKo){for(const R of m)this.Hea.tX(this.dnm(d,
R.Pp,R.o9k),da=>{R.lUa(da,this.rn)});if(A){if(!this.Jo.Ru&&(m=new If.GraphIterator,m.set(d),m.od())){m.sc();const R=new Lz.a;m.Bf(R,4);m.Bj(R);R.setValue(wc.a.listID,A.listId);R.setValue(wc.a.listLevel,A.listLevel)}this.Jo.es&&this.Aw.rlc(d,A.listId,A.listLevel)}}else v.ULS.shipAssertTag(590754180,3016,!1)}else v.ULS.shipAssertTag(590754179,3016,!1);else v.ULS.shipAssertTag(590754178,3016,!1)}Aei(d){if(!d)return v.ULS.shipAssertTag(590754181,3016,!1),null;const m=new U.a;for(var A=0;A<d.ra.length-
1;A++){const R=d.ra.J(A);if(!R.formatting)continue;const da=new Yx(R.cp,d.ra.J(A+1).cp);da.ykc(R.formatting,this.W8)&&m.add(da)}A=null;d=this.x5.Fl(d);Zl.ListItemReader.lg(d)&&(Zl.ListItemReader.Nj?A=Zl.ListItemReader.HGb(d):(A=new If.GraphIterator,A.set(d),this.Jd.VLb(A),A=this.Jd.fP(A.currentNode,!1,!1)));return new DB(A,m)}}Object(y.a)(EB,"ParagraphFormattingSnapshotManager",null,[926]);var et=c(367),uw=c(1733),EA=c(1675);class zo{static wmm(){zo.Gpb||(zo.Gpb=new Kl.ScriptSharpLegacyMap,zo.Gpb.add(0,
{indent:.3,pbd:(d,m,A)=>{const R=d.length+1,da=zo.vkc,Ea=zo.wkc;m=zo.mKc(m);const ib=m+66148;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${ib},"w":${A}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":20,"g":107,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":53734,"w":${A}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":0,"g":0,"r":0}}},"fontFamily":"${da}","fontSize":${Ea}},"length":${R}}],"paraFormatRunArray":[{"length":${R},"paragraphFormat":{"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":164030,"y":82747},"rot":0,"size":{"h":${m},"w":${A-
295364}}}},"wordGc2Type":13000}]}`}}),zo.Gpb.add(1,{indent:.9,pbd:(d,m,A)=>{const R=d.length+1,da=zo.vkc,Ea=zo.wkc;m=zo.mKc(m);const ib=m+777476,Qb=m+587852,pc=A-119350,Pc=A-1540438,gd=m+59675,Cd=A-453325;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${ib},"w":${A}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":219,"g":102,"r":80}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":249996,"y":143249},"rot":0,"size":{"h":${Qb},"w":${pc}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"fontFamily":"${da}","fontSize":${Ea}},"length":${R}}],"paraFormatRunArray":[{"length":${R},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":837024,"y":430397},"rot":0,"size":{"h":${m},"w":${Pc}}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":1}}},"lineDash":0,"weight":42863},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":112627,"y":0},"rot":0,"size":{"h":${Qb},"w":${pc}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":304366,"y":220893},"rot":0,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1},{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":0}}},"fontFamily":"Felix Titling","fontSize":4800,"italic":false,"strike":0,"underline":0},"length":1}],"paraFormatRunArray":[{"length":2,"paragraphFormat":{"alignment":0,"indent":0,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":107},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":${Cd},"y":${gd}},"rot":10800000,"size":{"h":458066,"w":364157}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${ib},"w":${A}}}}`}}),
zo.Gpb.add(2,{indent:.7,pbd:(d,m,A)=>{const R=d.length+1,da=zo.vkc,Ea=zo.wkc;m=zo.mKc(m);const ib=m+80835,Qb=A-999962,pc=m+444908,Pc=m+66148,gd=m+66148,Cd=13350-Math.round(gd/2),ae=142329+Math.round(gd/2),Xd=A-1134575,se=A-727217,Xe=m+190818,Be=A-Math.round(gd/2);m-=77606;const Hg=A-1149386;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":246,"g":239,"r":234}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":157851},"rot":10800000,"size":{"h":${Pc},"w":${A}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"${da}","fontSize":${Ea}},"length":${R}}],"paraFormatRunArray":[{"length":${R},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":443019,"y":244229},"rot":0,"size":{"h":${ib},"w":${Qb}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":8939,"y":159883},"rot":0,"size":{"h":37400,"w":671031}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Cd},"y":${ae}},"rot":5400000,"size":{"h":34645,"w":${gd}}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":25828,"y":${Xe}},"rot":0,"size":{"h":34537,"w":${Xd}}}},"wordGc2Type":13000},{"id":8,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${se},"y":${Xe}},"rot":0,"size":{"h":34537,"w":729926}}},"wordGc2Type":13000},{"id":9,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Be},"y":${ae}},"rot":5400000,"size":{"h":34645,"w":${gd}}}},"wordGc2Type":13000},{"id":10,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":1149133,"y":159846},"rot":0,"size":{"h":37400,"w":${Xd}}}},"wordGc2Type":13000},{"id":11,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${Hg},"y":${m}},"rot":0,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000},{"id":12,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0}},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":172,"g":127,"r":0}}},"fontFamily":"Felix Titling","fontSize":4800},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{"alignment":0}}],"text":"\\"","textbodyFormat":{"anchoring":0}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":681162,"y":0},"rot":10800000,"size":{"h":484389,"w":415634}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${pc},"w":${A}}}}`}}),
zo.Gpb.add(3,{indent:1,pbd:(d,m,A)=>{const R=d.length+1,da=zo.vkc,Ea=zo.wkc;m=zo.mKc(m);const ib=A-1518499,Qb=m+392522,pc=m,Pc=m-316115,gd=A/2-256447;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":158},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${gd},"y":${Pc}},"rot":2700000,"size":{"h":512895,"w":512895}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":244,"g":235,"r":233}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":25},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${pc},"w":${A}}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":168,"g":101,"r":56}}},"fontFamily":"${da}","fontSize":${Ea}},"length":${R}}],"paraFormatRunArray":[{"length":${R},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":726947,"y":71168},"rot":0,"size":{"h":${m},"w":${ib}}}},"wordGc2Type":13000}],"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":0,"size":{"h":${Qb},"w":${A}}}}`}}),
zo.Gpb.add(4,{indent:.3,pbd:(d,m,A)=>{const R=d.length+1,da=zo.vkc,Ea=zo.wkc;m=zo.mKc(m);const ib=m+125516,Qb=A-120310,pc=A-427001,Pc=m;A-=244619;d=JSON.stringify(d).slice(1,-1);return`{"elements":[{"id":2,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":255,"g":255,"r":255}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"weight":9525},"shapeType":4},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":true,"y":true},"pos":{"x":0,"y":0},"rot":10800000,"size":{"h":${ib},"w":${Qb}}}},"wordGc2Type":13000},{"id":3,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":0},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":4},"text":{"charFormatRunArray":[{"charFormat":{"bold":true,"fontFamily":"${da}","fontSize":${Ea}},"length":${R}}],"paraFormatRunArray":[{"length":${R},"paragraphFormat":{"alignment":1,"leftMargin":0,"lineSpacing":{"spaceUnit":0,"spaceValue":105},"rightMargin":0,"spaceAfterParagraph":{"spaceUnit":1,"spaceValue":8},"spaceBeforeParagraph":{"spaceUnit":1,"spaceValue":0}}}],"text":"${d}","textbodyFormat":{"anchoring":0,"upright":false}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":101388,"y":81834},"rot":0,"size":{"h":${m},"w":${pc}}}},"wordGc2Type":13000},{"id":4,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":${Pc}},"rot":0,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":5,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${A},"y":0},"rot":10800000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":6,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":0,"y":0},"rot":5400000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000},{"id":7,"shapewithtext":{"shape":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":0,"rgbaColor":{"a":1,"b":53,"g":130,"r":84}}},"lineProps":{"fillProps":{"fillPropsType":0},"lineDash":0,"lineJoin":0,"weight":9525},"shapeType":85},"style":{"fill":{"color":{"colorType":1,"schemeColor":{"presetColorType":4}},"index":1},"font":{"color":{"colorType":1,"schemeColor":{"presetColorType":14}},"index":1},"line":{"color":{"colorType":1,"schemeColor":{"presetColorType":4},"transforms":[{"colorTransformType":0,"shade":50}]},"index":2}},"text":{"charFormatRunArray":[{"charFormat":{"fillProps":{"fillPropsType":1,"solidFill":{"colorType":1,"schemeColor":{"presetColorType":14}}},"fontFamily":"+mn-lt"},"length":1}],"paraFormatRunArray":[{"length":1,"paragraphFormat":{}}],"text":"","textbodyFormat":{"anchoring":1}}},"wordanchor":{"transform":{"flip":{"x":false,"y":false},"pos":{"x":${A},"y":${Pc}},"rot":16200000,"size":{"h":130735,"w":124953}}},"wordGc2Type":13000}]}`}}));
return zo.Gpb}static mKc(d){return lh.a.L6a(d,0)*Jg.a.O7b+zo.Eao}}zo.Gpb=null;zo.vkc="Calibri";zo.wkc=1400;zo.Eao=256E3;Object(y.a)(zo,"PullQuoteStyles",null,[]);var Mz=c(1170);class ns{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be){this.oP=d;this.zX=m;this.vg=A;this.K=R;this.wnm=da;this.Xxm=Ea;this.mb=ib;this.Zb=Qb;this.jg=pc;this.Hea=Pc;this.rn=gd;this.logger=Cd;this.Pf=ae;this.rc=Xd;this.TQa=se;this.K4e=Xe;this.qc=Be;this.range=window.self.document.createRange()}Qph(d,m){var A;if(d)if(({value:Qb}=
zo.wmm().Fc(d.Y6a,Qb)).returnValue){var R=this.mel(d);if(R){var da=qh.WordSectionNavigator.instance.zL(R),Ea=da?Jg.a.Kog(Co.a.instance.CJ(da)):ns.mhj,ib=da?Jg.a.Kog(Co.a.instance.oL(da)):ns.mhj;da=(da?Jg.a.Kog(Co.a.instance.ru(da)):ns.zao)-Ea-ib;Ea=this.j0l(R,Qb.indent);ib=Qb.pbd(d.f5c,Ea,da);var Qb=new Pr.a(this.rc);this.mb.Ac(Pk.SelectionFactory.Dq(R));R=new uw.a(Qb,this.TQa,!0,this.oP,this.K,ye.PageNavigator.instance);R=new EA.a(R,ib,this.zX,this.vg,m,Rj.a.instance,!1,null,this.oP,this.Xxm,da/
ns.Aao,Ea+ns.Cao,this.K,this.K4e,this.Zb,!1,[]);R.Too(d.callback);R.jjo(pc=>{v.ULS.shipAssertTag(545271898,3016,!1,"PullQuote failed to create, error message: {0}",pc)});this.wnm.xcg(R,Qb,!1,m);return null===(A=Qb.ik)||void 0===A?void 0:A.node}v.ULS.shipAssertTag(555034258,3016,!1,"Unsuccessful node creation")}else v.ULS.shipAssertTag(555034257,3016,!1,String.format("Non existing styleId: {0}",d.Y6a));else v.ULS.shipAssertTag(555034256,3016,!1,"No PullQuoteData")}j0l(d,m){this.Hea.tX(jd.a.createTextRange(d,
0,Qe.ParagraphReader.textLength(d)),R=>{this.rn.WA(R,zo.wkc/100*2);this.rn.bka(R,zo.vkc)});su.a.yQa.Lza(d,1,Jg.a.Nv(m));su.a.yQa.rQb(d,1,Jg.a.Nv(m));this.rc.O9a();m=0;try{var A=d.Aj(this.rc.$b);const R=et.a.bha(A,!1,!1),da=Mz.a.yMh(R.NF,this.logger).DM;for(A=0;A<da.Fk.count-1;A++){const Ea=da.D2a(A);this.range.setStart(Ea.htmlElement,0);this.range.setEnd(Ea.htmlElement,Ea.htmlElement.textContent.length);const ib=this.range.getBoundingClientRect();m+=ib.height}}catch(R){m=ns.Bao,v.ULS.shipAssertTag(555034259,
3016,!1,"Couldn't calculate pull quote text height. Exception: {0}",String.format("{0} {1}",R.message,R.stack))}finally{return this.Hea.tX(jd.a.createTextRange(d,0,Qe.ParagraphReader.textLength(d)),R=>{this.rn.WA(R,22)}),su.a.yQa.Lza(d,1,Jg.a.Nv(0)),su.a.yQa.rQb(d,1,Jg.a.Nv(0)),m}}mel(d){var m=new If.GraphIterator;m.set(d.paragraphNode);if(!m.od())return null;kh.OutlineElementNavigator.Yd(m);this.Pf.Oy(m,!0,!1,void 0,void 0,!1);var A=new sq.a;const R=this.qc.ZC(d.paragraphNode);R&&(A.Rka=R.pj(Ul.StyleReader.Npc));
if(m=this.Pf.OH(m,A))A=jd.a.Uc(m,0),this.jg.Ge(A,d.f5c,!0,!1);return m}rVk(d,m,A,R){if(d)if(m)if(A){if(d=this.jaj(d))return m=new Un.c(m,d,m.Y6a,m.f5c,A),this.Qph(m,R);v.ULS.shipAssertTag(554443525,3016,!1,"No next node with pull quote")}else v.ULS.shipAssertTag(554443524,3016,!1,"No PullQuote success callback");else v.ULS.shipAssertTag(554443523,3016,!1,"No PullQuoteSuggestion");else v.ULS.shipAssertTag(554443522,3016,!1,"No PullQuoteNode")}jaj(d){if(d){var m=this.O6l(d);this.Pf.mza(d);m&&this.mb.Ac(Em.SelectionEditor.Jj(Pk.SelectionFactory.Xn(jd.a.create(m)),
!1,!1));return m}v.ULS.shipAssertTag(554443526,3016,!1,"No PullQuoteNode")}O6l(d){if(!d)return null;const m=new If.GraphIterator;m.set(d);m.od();m.sc();return m.Oj()?m.currentNode:null}}ns.Aao=9509.76;ns.Cao=50;ns.Bao=39;ns.mhj=914400;ns.zao=7772400;Object(y.a)(ns,"PullQuotesDesignerImpl",null,[925]);class FA{constructor(d,m,A,R){this.Bz=d;this.tbe=m;this.nN=A;this.rc=R}KDd(d){const m=this.Bz.Pc(15,Ac.a.KDd,!1),A=Eg.a.create();try{m.Ky.Db(this.rc.ed);let R=!0;for(const da of d)m.Ky.mHa(A,1),R=this.nN.Z4i(da,
Ea=>({role:27,paragraphNode:this.tbe.Qph(Ea,A),placeholder:!0}))&&R;return R}catch(R){return v.ULS.shipAssertTag(555034255,3016,!1,String.format("Applying pull quotes failed. Exception: {0} {1}",R.message,R.stack)),!1}finally{m&&m.dispose()}}}Object(y.a)(FA,"PullQuotesManagerImpl",null,[924]);class dv{constructor(d,m,A){this.Yr=d;this.vg=m;this.ju=A;this.dialog=null;this.q4a=!1;this.mva=R=>{1==R&&this.r5i(!0);this.q4a=!1}}revertTheme(){return this.vg.oY?this.vg.s9()?this.r5i():(this.openDialog(),
!1):(v.ULS.shipAssertTag(539829795,3016,!1),!1)}r5i(d=!1){var m=this.ju;if(null===m||void 0===m||!m.ed)return v.ULS.shipAssertTag(539808770,3016,!1),!1;const A=this.Yr.Pc(7,Ac.a.revertDesignerTheme);A.Db(m.ed);m=!0;try{for(;m&&this.vg.oY&&!this.vg.s9();)m=this.vg.undo();m&&this.vg.oY&&this.vg.s9()?m=this.vg.undo():(v.ULS.shipAssertTag(539829824,3016,!1,String.format("Has undo entries:{0}",this.vg.oY)),m=!1)}finally{return null===A||void 0===A?void 0:A.dispose(),d=Object.assign(new Ya.a,{name:"DialogShown",
bool:d}),Ca.a(Cb.a.hDn,m,void 0,[d]),m}}openDialog(){this.q4a||(this.dialog=new xb.StandardDialog,this.dialog.Cd=1,this.dialog.ye(1,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogButtonLabel),this.dialog.zg=Cb.a.C9n,this.dialog.sv(WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogTitle,WordEditorIntl.WordEditorStrings.L_DesignerRevertDialogDescription,0,this.mva),this.q4a=!0)}}Object(y.a)(dv,"RevertManager",null,[923]);class BC{t9b(d){return 27===d?WordEditorIntl.WordEditorStrings.L_DesignerPullQuoteReviewTitle:
28===d?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionV2ReviewTitle:WordEditorIntl.WordEditorStrings.L_DesignerFormattingFixesReviewTitle}}Object(y.a)(BC,"ReviewDescriptionBuilder",null,[922]);class th{constructor(d,m,A){A?(this.kcd=Vn(d),this.DHc=Vn(m)):(this.kcd=d,this.DHc=m)}}Object(y.a)(th,"FontPairing",null,[]);class vw{LM(d){return d?sa.a.PQ(d.kcd)^sa.a.PQ(d.DHc):0}equals(d,m){return d.kcd===m.kcd&&d.DHc===m.DHc}Goa(d){return d.kcd+":"+d.DHc}}Object(y.a)(vw,"EqualityComparer",null,
[246,247]);class Pg{constructor(d,m){this.tS=d;this.VJ=m;this.dcd=null;Pg.KBm();Pg.NCm();Pg.lOf=new lc.a(T.a.ih())}PLi(d){this.VJ.ie(()=>{this.D8m(d)},"WD:LTCI")}D8m(d){var m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh;if(d.styles&&!Pg.lOf.contains(d.name)){Pg.lOf.add(d.name);var Fl=[Object.assign(new Ya.a,{name:"themeId",int64:this.tS.lac(d.name)}),Object.assign(new Ya.a,{name:"formalInformalCategory",int64:Pg.J$h(d)}),Object.assign(new Ya.a,{name:"traditionalModernCategory",int64:Pg.Uji(d)}),
Object.assign(new Ya.a,{name:"titleFontName",string:fn(null===(m=d.styles.get("Title"))||void 0===m?void 0:m.fontName)}),Object.assign(new Ya.a,{name:"bodyFontName",string:fn(null===(A=d.styles.get("BodyText"))||void 0===A?void 0:A.fontName)}),Object.assign(new Ya.a,{name:"titleFontColor",string:null===(R=d.styles.get("Title"))||void 0===R?void 0:R.fontColor.toString(16)}),Object.assign(new Ya.a,{name:"subtitleFontColor",string:null===(da=d.styles.get("Subtitle"))||void 0===da?void 0:da.fontColor.toString(16)}),
Object.assign(new Ya.a,{name:"heading1FontColor",string:null===(Ea=d.styles.get("Heading1"))||void 0===Ea?void 0:Ea.fontColor.toString(16)}),Object.assign(new Ya.a,{name:"titleAlignment",int64:null===(ib=d.styles.get("Title"))||void 0===ib?void 0:ib.alignment}),Object.assign(new Ya.a,{name:"subtitleAlignment",int64:null===(Qb=d.styles.get("Subtitle"))||void 0===Qb?void 0:Qb.alignment}),Object.assign(new Ya.a,{name:"heading1Alignment",int64:null===(pc=d.styles.get("Heading1"))||void 0===pc?void 0:
pc.alignment}),Object.assign(new Ya.a,{name:"bodyAlignment",int64:null===(Pc=d.styles.get("BodyText"))||void 0===Pc?void 0:Pc.alignment}),Object.assign(new Ya.a,{name:"bodyFontSize",int64:null===(gd=d.styles.get("BodyText"))||void 0===gd?void 0:gd.fontSize}),Object.assign(new Ya.a,{name:"orderInThePane",int64:this.tim(d.name)}),Object.assign(new Ya.a,{name:"backgroundColor",string:null===(Cd=d.backgroundColor)||void 0===Cd?void 0:Cd.toString(16)}),Object.assign(new Ya.a,{name:"themeImageDecorator",
bool:null!==(Xd=null===(ae=d.decorators)||void 0===ae?void 0:ae.some(Gm=>Gm.type===Tn.themeImage))&&void 0!==Xd?Xd:!1}),Object.assign(new Ya.a,{name:"titleTableDecorator",bool:null!==(Be=null===(Xe=null===(se=d.styles.get("Title"))||void 0===se?void 0:se.decorators)||void 0===Xe?void 0:Xe.some(Gm=>Gm.type===Tn.table))&&void 0!==Be?Be:!1}),Object.assign(new Ya.a,{name:"complexThemeDecorator",bool:null!==(Xh=null===(Hg=d.decorators)||void 0===Hg?void 0:Hg.some(Gm=>Gm.type===Tn.complexDecorator))&&void 0!==
Xh?Xh:!1})];Ca.a(Cb.a.CKo,!0,void 0,Fl)}}static J$h(d){d=Pg.zji(d);return Pg.dr.nb(d)?Pg.dr.J(d):3}static Uji(d){d=Pg.zji(d);return Pg.lr.nb(d)?Pg.lr.J(d):3}static KBm(){Pg.dr=new uk.a(new vw);Pg.dr.add(new th("Walbaum Display","Walbaum Text",!0),0);Pg.dr.add(new th("Century Gothic","Century Gothic",!0),0);Pg.dr.add(new th("Perpetua","Perpetua",!0),0);Pg.dr.add(new th("Elephant Pro","Walbaum Text",!0),0);Pg.dr.add(new th("Imprint MT Shadow","Sabon Next LT",!0),0);Pg.dr.add(new th("Sitka Banner","Sitka Text",
!0),0);Pg.dr.add(new th("Sitka Banner","Franklin Gothic Book",!0),0);Pg.dr.add(new th("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),0);Pg.dr.add(new th("Univers Condensed Light","Univers",!0),0);Pg.dr.add(new th("Univers","Univers",!0),0);Pg.dr.add(new th("Walbaum Display Light","Avenir Next",!0),0);Pg.dr.add(new th("Goudy Type","Dante",!0),0);Pg.dr.add(new th("Lucida Calligraphy","Dante",!0),0);Pg.dr.add(new th("Edwardian Script ITC","Sabon Next LT",!0),0);Pg.dr.add(new th("Footlight MT Light",
"Goudy Old Style",!0),0);Pg.dr.add(new th("Rockwell Nova Light","News Gothic MT",!0),1);Pg.dr.add(new th("Walbaum Display","News Gothic MT",!0),1);Pg.dr.add(new th("Cooper Black","Neue Haas Grotesk Text Pro",!0),1);Pg.dr.add(new th("Franklin Gothic Heavy","Franklin Gothic Book",!0),0);Pg.dr.add(new th("Calibri Light","Calibri Body",!0),0);Pg.dr.add(new th("Impact","Neue Haas Grotesk Text Pro",!0),1);Pg.dr.add(new th("Rockwell Nova","Trade Gothic Next",!0),1);Pg.dr.add(new th("Trade Gothic Next Heavy",
"Georgia",!0),1);Pg.dr.add(new th("Tisa Offc Serif Pro","Avenir Next",!0),1);Pg.dr.add(new th("Quire Sans","Tisa Offc Serif Pro",!0),1);Pg.dr.add(new th("Amasis MT Pro","Trade Gothic Next",!0),1);Pg.dr.add(new th("Trade Gothic Next Cond","Trade Gothic Next",!0),1);Pg.dr.add(new th("Plantagenet Cherokee","Calibri (Body)",!0),1);Pg.dr.add(new th("Brush Script MT","Corbel",!0),1);Pg.dr.add(new th("Elephant Pro","Amasis MT Pro",!0),2);Pg.dr.add(new th("Rockwell Nova Extra Bold","Amasis MT Pro",!0),2);
Pg.dr.add(new th("Cooper Black","Amasis MT Pro",!0),2);Pg.dr.add(new th("Sagona ExtraLight","Quire Sans",!0),2);Pg.dr.add(new th("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),2);Pg.dr.add(new th("Sagona Book","Amasis MT Pro",!0),2);Pg.dr.add(new th("Trade Gothic Next Inline","Avenir Next",!0),2);Pg.dr.add(new th("Modern Love","Avenir Next LT Pro",!0),2);Pg.dr.add(new th("The Serif Hand Black","Amasis MT Pro Light",!0),2);Pg.dr.add(new th("The Hand Black","Avenir Next LT Pro",!0),2);Pg.dr.add(new th("Tisa Offc Serif Pro",
"Selawik",!0),2);Pg.dr.add(new th("Walbaum Display SemiBold","News Gothic MT",!0),2);Pg.dr.add(new th("Baskerville Old Face","Franklin Gothic Book",!0),2);Pg.dr.add(new th("Mistral","Univers",!0),2);Pg.dr.add(new th("Magneto","Ebrima",!0),2)}static NCm(){Pg.lr=new uk.a(new vw);Pg.lr.add(new th("Walbaum Display","Walbaum Text",!0),0);Pg.lr.add(new th("Perpetua","Perpetua",!0),0);Pg.lr.add(new th("Elephant Pro","Walbaum Text",!0),0);Pg.lr.add(new th("Imprint MT Shadow","Sabon Next LT",!0),0);Pg.lr.add(new th("Rockwell Nova Light",
"News Gothic MT",!0),0);Pg.lr.add(new th("Walbaum Display","News Gothic MT",!0),0);Pg.lr.add(new th("Cooper Black","Neue Haas Grotesk Text Pro",!0),0);Pg.lr.add(new th("Elephant Pro","Amasis MT Pro",!0),0);Pg.lr.add(new th("Rockwell Nova Extra Bold","Amasis MT Pro",!0),0);Pg.lr.add(new th("Cooper Black","Amasis MT Pro",!0),0);Pg.lr.add(new th("Goudy Type","Dante",!0),0);Pg.lr.add(new th("Lucida Calligraphy","Dante",!0),0);Pg.lr.add(new th("Century Gothic","Century Gothic",!0),1);Pg.lr.add(new th("Sitka Banner",
"Sitka Text",!0),1);Pg.lr.add(new th("Sitka Banner","Franklin Gothic Book",!0),1);Pg.lr.add(new th("Franklin Gothic Heavy","Franklin Gothic Book",!0),1);Pg.lr.add(new th("Impact","Neue Haas Grotesk Text Pro",!0),1);Pg.lr.add(new th("Rockwell Nova","Trade Gothic Next",!0),1);Pg.lr.add(new th("Trade Gothic Next Heavy","Georgia",!0),1);Pg.lr.add(new th("Sagona ExtraLight","Quire Sans",!0),1);Pg.lr.add(new th("Gill Sans Nova Ultra Bold","Gill Sans Nova",!0),1);Pg.lr.add(new th("Sagona Book","Amasis MT Pro",
!0),1);Pg.lr.add(new th("Trade Gothic Next Inline","Avenir Next",!0),1);Pg.lr.add(new th("Trade Gothic Next Cond","Trade Gothic Next",!0),1);Pg.lr.add(new th("Plantagenet Cherokee","Calibri (Body)",!0),1);Pg.lr.add(new th("Baskerville Old Face","Franklin Gothic Book",!0),1);Pg.lr.add(new th("Mistral","Univers",!0),1);Pg.lr.add(new th("Brush Script MT","Corbel",!0),1);Pg.lr.add(new th("Avenir Next LT Pro Light","Avenir Next LT Pro",!0),2);Pg.lr.add(new th("Univers Condensed Light","Univers",!0),2);
Pg.lr.add(new th("Univers","Univers",!0),2);Pg.lr.add(new th("Walbaum Display Light","Avenir Next",!0),2);Pg.lr.add(new th("Tisa Offc Serif Pro","Avenir Next",!0),2);Pg.lr.add(new th("Quire Sans","Tisa Offc Serif Pro",!0),2);Pg.lr.add(new th("Amasis MT Pro","Trade Gothic Next",!0),2);Pg.lr.add(new th("Modern Love","Avenir Next LT Pro",!0),2);Pg.lr.add(new th("The Serif Hand Black","Amasis MT Pro Light",!0),2);Pg.lr.add(new th("The Hand Black","Avenir Next LT Pro",!0),2);Pg.lr.add(new th("Tisa Offc Serif Pro",
"Selawik",!0),2);Pg.lr.add(new th("Calibri Light","Calibri Body",!0),2);Pg.lr.add(new th("Walbaum Display SemiBold","News Gothic MT",!0),2);Pg.lr.add(new th("Footlight MT Light","Goudy Old Style",!0),2);Pg.lr.add(new th("Magneto","Ebrima",!0),2);Pg.lr.add(new th("Edwardian Script ITC","Sabon Next LT",!0),2)}static zji(d){var m,A;const R=null===(m=d.styles.get("Title"))||void 0===m?void 0:m.fontName;d=null===(A=d.styles.get("BodyText"))||void 0===A?void 0:A.fontName;return R&&d?new th(R,d,!1):new th("default",
"default",!1)}tim(d){this.dcd||this.MCm(this.tS.l5h());return this.dcd.has(d)?this.dcd.get(d):(v.ULS.shipAssertTag(554995927,3016,!1),-1)}MCm(d){this.dcd=new Map;for(let m=0;m<d.length;m++)this.dcd.set(d[m].name,m)}}Pg.dr=null;Pg.lr=null;Pg.lOf=null;Object(y.a)(Pg,"ThemeCategorizer",null,[918]);class Zx{constructor(d,m){this.Hg=d;this.Qpe=m}CFl(d){let m=null;const A=Pg.J$h(d),R=Pg.Uji(d),da=this.fKm();da||v.ULS.sendTraceTag(523257814,3016,50,"applyThemeToTables - default color palette is changed");
0===A?da&&1!==R?2===R?m="List Table 3 {0}":0===R&&(m="Grid Table 3 {0}"):m="Plain Table 3":2===A?da&&2!==R?0===R?m="Grid Table 5 Dark {0}":1===R&&(m="List Table 5 Dark {0}"):m="Plain Table 5":1===A?da&&1!==R?2===R?m="Grid Table 3 {0}":0===R&&(m="List Table 7 Colorful {0}"):m="Plain Table 5":m="Table Grid";d=this.NDl(d.colorLabel);return String.format(m,d)}NDl(d){return d.includes("Blue")?"Accent 1":d.includes("Orange")?"Accent 2":d.includes("Yellow")?"Accent 4":d.includes("Turquoise")?"Accent 5":
d.includes("Green")?"Accent 6":"Accent 3"}fKm(){var d=Ao.PageReader.instance.D$b();if(!d)return!1;d=d.ja(wc.a.xrb,null);return $f.a.mJb(d)}vNm(d){return d.startsWith(Zx.pHm)?!1:!0}VGk(d,m){d=this.CFl(d);for(const R of m){m=this.Hg.q0(R);var A=this.Hg.pF(R);A=this.Hg.aVd(A);v.ULS.sendTraceTag(523572700,3016,50,`applyThemeToTables - current properties: preserveLook=${!0},
            tableLook=${m},
            currentStyle=${A}`);1696===m&&(this.vNm(A)||(m=32));this.Qpe.Whe(d,m,R)}}}Zx.pHm="Table Grid";Object(y.a)(Zx,"TableDesigner",null,[920]);var Nz=c(1705);class ww{constructor(d,m){this.Z1e=d;this.oJ=m;this.isInitialized=!1}initialize(){this.isInitialized||(this.isInitialized=!0,this.Z1e.register())}Od(){this.isInitialized&&(this.Z1e.unregister(),this.isInitialized=!1)}Ghm(d){if(d){var m=null,A=[],R=[],da=[],Ea=[],ib=null;ib=bf.a.gp(d);ib.xo(Qb=>36!==Qb.Xe,null);for(d=null;ib.moveNext();)if(d=
ib.currentNode,14===d.type){m||(m=d);break}if(m){m=If.GraphIterator.eb(m);do{ib=m.currentNode;if(this.oJ.read(ib))da.push(ib);else if(d=this.Ehm(ib))switch(d.type){case Nz.TableType.SimpleHeaded:R.push(ib);break;case Nz.TableType.Other:A.push(ib)}else v.ULS.sendTraceTag(524149721,3016,50,"No TableTypeAnnotation for table in document."),Ea.push(ib);m.Zr||m.LEn()}while(Object(Df.moveToNextTable)(m))}v.ULS.sendTraceTag(523902976,3016,50,`getTables stats: otherTables=${A.length},
      simpleHeadedTables=${R.length},
      decoratorTables=${da.length},
      noAnnotationTables=${Ea.length}`);return{other:A,fuj:R,Kil:da,Ohn:Ea}}v.ULS.shipAssertTag(524113552,3016,!1,"No target node")}Ehm(d){d=this.Z1e.y5h(d);for(const m of d)if(m.annotationType===Nz.TableTypeAnnotation.getTypeName())return m.content}}Object(y.a)(ww,"TableManager",null,[919,672]);class os{constructor(d,m,A){this.Qnc=d;this.Zd=m;this.An=A;this.fd=new vb.a;this.nye=this.Lv=null;this.areUserSettingsLoaded=this.isInitialized=!1;this.ege=null;this.k1=()=>{if(this.Zd.E3e())if(this.An.K_()){this.areUserSettingsLoaded=
!0;var R=this.yfj();0<R.length&&this.Lv.unshift({label:Vk.favorites,labelDisplayName:null,id:new zv(Vk.favorites),displayName:null,items:R,isLoaded:!0,nY:!1});this.Lv=null;this.fd.raiseEvent("OnThemesChanged");this.An.fPb(this.k1)}else this.areUserSettingsLoaded=!1,v.ULS.shipAssertTag(512337434,3016,!1)};this.htn=()=>{this.Lv=null;this.fd.raiseEvent("OnThemesChanged")};this.lMb=Cb.a.HAm}get Mhl(){if(!this.nye){const d=this.Qnc.filter(m=>m instanceof pw);this.nye=0===d.length?null:d[0]}return this.nye}initialize(){this.isInitialized||
(this.Qnc.forEach(d=>{d.DCd(this.htn);d!=this.Mhl&&d.initialize()}),this.isInitialized=!0,this.Zd.E3e()&&!this.An.K_()&&(this.areUserSettingsLoaded=!1,this.An.Q2b(this.k1)))}Od(){this.Zd.E3e()&&this.An.fPb(this.k1)}DCd(d){this.fd.addHandler("OnThemesChanged",d)}rcj(d){this.fd.removeHandler("OnThemesChanged",d)}czk(d){this.fd.addHandler("OnShowMoreThemes",d)}m9b(){var d;const m=null===(d=this.Qnc.find(A=>A instanceof rt))||void 0===d?void 0:d.m9b();return m?new zv(m):void 0}Qwf(){const d=this.Til(this.$Nl()),
m=this.Fci();d.forEach(A=>{A.id.getLabel()===Vk.main&&(A.items=m.items.slice(0,this.lMb))});return d}$Nl(){var d;if(this.Lv)return this.Lv;this.Lv=[];for(const m of this.Qnc)if(!(m instanceof pw)&&m.kVd())for(const A of m.kVd()){let R;if(this.Zd.Elb())if(R=A.displayName?this.Lv.filter(da=>{var Ea,ib;return(null===(Ea=da.displayName)||void 0===Ea?void 0:Ea.toLowerCase())===(null===(ib=A.displayName)||void 0===ib?void 0:ib.toLowerCase())}):null,0<(null===R||void 0===R?void 0:R.length)){for(const da of A.items){const Ea=
null===(d=R[0].items)||void 0===d?void 0:d.filter(ib=>ib.name===da.name);Ea&&0!==Ea.length||R[0].items.push(da)}A.nY&&A.nY!==R[0].nY&&(R[0].nY=A.nY)}else this.Lv.push(A);else R=this.Lv.filter(da=>da.label===A.label),0<(null===R||void 0===R?void 0:R.length)?R[0].items.push(...A.items):this.Lv.push(A)}this.Zd.vxi()&&this.Lv.forEach(m=>{for(const A of m.items)A.type===Zf.theme&&A.styles.forEach(R=>{var da=R.fontColor;const Ea=18<=R.fontSize||14<=R.fontSize&&R.bold?3:4.5;da=$f.a.cRd(da)<Ea?qo.has(da)?
qo.get(da):0:da;R.fontColor=da})});this.Lv.forEach(m=>{for(const da of m.items)if(da.type===Zf.theme||da.type===Zf.templateTheme||da.type===Zf.officeTemplate){var A=void 0;m=da;if(null===(A=m.styles)||void 0===A?0:A.has("Heading1")){A=m;a:{var R=m.styles.get("Heading1").fontName;R=fn(R);for(const Ea of mq)if(void 0!==Ea&&R.startsWith(Ea)){R=Ea;break a}v.ULS.shipAssertTag(557672E3,3016,!1);R=void 0}A.fontLabel=R}m.colorLabel=co.f1k(m.accentColor)}});if(this.Zd.PEf()){if(!this.An.K_())return this.areUserSettingsLoaded=
!1,v.ULS.shipAssertTag(512522208,3016,!1),this.Lv;this.areUserSettingsLoaded=!0;d=this.yfj();0<d.length&&this.Lv.unshift({label:Vk.favorites,labelDisplayName:null,id:new zv(Vk.favorites),displayName:null,items:d,isLoaded:!0,nY:!1})}return this.Lv}yfj(){const d=[];var m=this.An.Z3l();if(0<(null===m||void 0===m?void 0:m.length)){const A=this.l5h();for(const R of m)if(m=A.find(da=>da.id==R))m.isThemeInFavorites=!0,d.push(m)}return d}l5h(){var d;const m=[];null===(d=this.Lv)||void 0===d?void 0:d.forEach(A=>
{m.push(...A.items)});return m}lac(d){for(const m of this.Qnc)if(m.pSc()&&m.pSc().nb(d))return m.pSc().J(d);v.ULS.shipAssertTag(590386456,3016,!1);return 0}toggleFavorite(d){this.An.mMo(d.id);d.isThemeInFavorites=!d.isThemeInFavorites;this.Lv=null;this.fd.raiseEvent("OnThemesChanged")}s3m(){var d,m;this.lMb+=Cb.a.ckn;const A=null!==(m=null===(d=this.Fci())||void 0===d?void 0:d.items.length)&&void 0!==m?m:0;d=this.lMb<A;this.lMb=Math.min(this.lMb,A);this.fd.raiseEvent("OnShowMoreThemes",new lq.a(d));
return this.lMb}kIi(){if(null!==this.ege)for(const d of this.Qnc)d.nY(this.ege)&&d.h3d(this.ege,!0)}setSelectedSection(d){this.ege=d;this.kIi()}Fci(){var d;if(null===(d=this.Lv)||void 0===d||!d.length)return null;for(const m of this.Lv)if(m.id.getLabel()===Vk.main)return m;return null}Til(d){const m=[];null===d||void 0===d?void 0:d.forEach(A=>{m.push({label:A.label,labelDisplayName:A.labelDisplayName,id:A.id,displayName:A.displayName,items:[...A.items],isLoaded:A.isLoaded,nY:A.nY})});return m}}Object(y.a)(os,
"ThemeGenerator",null,[917,672]);class CC{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em){this.iLk=d;this.l1a=m;this.Zd=A;this.VJ=R;this.Bz=da;this.$s=Ea;this.iI=ib;this.q1=Qb;this.Vi=pc;this.nN=Pc;this.MFo=gd;this.OSo=Cd;this.rc=ae;this.cD=Xd;this.r$n=se;this.gm=Xe;this.J_=Be;this.oJ=Hg;this.ZHo=Xh;this.VHo=Fl;this.eq=Gm;this.qJ=em;this.dUi=()=>{var $n;null===($n=this.qJ)||void 0===$n?void 0:$n.XMd();this.J_.ecj(this.dUi)}}async applyTheme(d,m){var A,R,da,Ea;if(!d)return v.ULS.shipAssertTag(593073563,
3016,!1),!1;const ib=this.eq.Yf("UserAction",Cb.a.applyTheme),Qb=Date.now();let pc;try{const Pc=this.Vi.Dba(this.rc.ed),gd=this.Zd.gJm();this.r$n.Tln();let Cd=this.ORc();await this.d2f(Cd);if(d.type===Zf.templateTheme||d.type===Zf.officeTemplate)null===(A=this.qJ)||void 0===A?void 0:A.rjg();2!==(null===(R=this.qJ)||void 0===R?void 0:R.mQa())&&(this.oJ.csm()?(this.VJ.ie(()=>this.l1a.ZZn(),"WD:RAD"),Cd=this.ORc()):this.Zd.Elb()&&this.l1a.dsm()&&(this.l1a.M0n(),this.forceOutbound(),Cd=this.ORc()));const ae=
this.Q9l(d,Cd);A=!1;let Xd=xe.a.S_a;if(this.J_.Xuo(d,ae)){if(d.type===Zf.templateTheme||d.type===Zf.officeTemplate)A=!0,this.J_.y0e(this.dUi);this.J_.showDialog();Xd=xe.a.B2e}let se;this.Zd.pZd()&&(se=this.ZHo.Ghm(this.rc.ed));const Xe=null===se||void 0===se?void 0:se.fuj,Be=this.GKn(d,Cd,Xe,Pc&&gd,m,this.cD,Xd);this.zKn(d,ae);this.HKn(d);d.type!==Zf.templateTheme||A||(null===(da=this.qJ)||void 0===da?void 0:da.XMd());v.ULS.sendTraceTag(543481999,3016,50,`applyTheme result=${Be},
        isDocumentEmpty=${Pc},
        isBootstrappingEnabled=${gd},
        areTablesEnabled=${this.Zd.pZd()},
        areSimpleHeadedTablesDetected=${0<(null===Xe||void 0===Xe?void 0:Xe.length)}`);pc=[Object.assign(new Ya.a,{name:Cb.a.OGk,int64:se.other.length}),Object.assign(new Ya.a,{name:Cb.a.QGk,int64:se.fuj.length}),Object.assign(new Ya.a,{name:Cb.a.JGk,int64:se.Kil.length}),Object.assign(new Ya.a,{name:Cb.a.NGk,int64:se.Ohn.length}),Object.assign(new Ya.a,{name:Cb.a.PGk,int64:Be}),Object.assign(new Ya.a,{name:Cb.a.LGk,int64:Pc}),Object.assign(new Ya.a,{name:Cb.a.KGk,int64:gd}),Object.assign(new Ya.a,
{name:Cb.a.IGk,int64:this.Zd.pZd()}),Object.assign(new Ya.a,{name:"IsProactivePane",bool:G.$Xc}),Object.assign(new Ya.a,{name:"DesignType",string:null===(Ea=null===G||void 0===G?void 0:G.tB)||void 0===Ea?void 0:Ea.eEb.toString()}),Object.assign(new Ya.a,{name:"IsTemplateApplied",string:G.tB&&0!=G.tB.eEb})];return Be}catch(Pc){return v.ULS.shipAssertTag(592720733,3016,!1,String.format("{0} {1}",Pc.message,Pc.stack)),pc=[Object.assign(new Ya.a,{name:"error",string:Pc.message})],!1}finally{Ca.a(Cb.a.MGk,
!0,Date.now()-Qb,pc),ib.stop()}}GKn(d,m,A=[],R=!1,da=!1,Ea=!1,ib=xe.a.S_a){var Qb,pc,Pc;let gd=!0;ib=this.Bz.Pc(15,ib);try{ib.Ky.Db(this.rc.ed);this.VJ.ie(()=>this.MFo.Xwl(d),"WD:MS");const Cd=this.OSo.create(d,da||2===(null===(Qb=this.qJ)||void 0===Qb?void 0:Qb.mQa()),2===(null===(pc=this.qJ)||void 0===pc?void 0:pc.mQa()));Cd.IGh(m);this.VJ.ie(()=>{for(const ae of m)gd=!!this.nN.YJn(ae,(Xd,se)=>{Cd.P4c(se,Xd)||this.VJ.ie(()=>this.iI.Bba(se,Xd.role),"WD:ASFR");return!0})&&gd},"WD:PPFAT");this.VJ.ie(()=>
Cd.nBb(),"WD:URPAF");this.VJ.ie(()=>this.$s.s6(),"WD:ULN");Ea&&this.VJ.ie(()=>this.s2e(d),"WD:ABC");R&&this.iLk.vYd(this.Zd.rJm());2!==(null===(Pc=this.qJ)||void 0===Pc?void 0:Pc.mQa())&&(null===A||void 0===A?0:A.length)&&this.VJ.ie(()=>this.VHo.VGk(d,A),"WD:ATTT")}finally{ib&&ib.dispose()}return gd}Q9l(d,m){var A,R,da,Ea,ib=new Set;for(const [Qb,pc]of d.styles)(null===(A=pc.decorators)||void 0===A?0:A.length)&&ib.add(ym.g(Qb));d=new U.a(m.filter(Qb=>Qe.ParagraphReader.Xb(Qb)&&!Qb.bEa));ib=this.gm.Hei(ib,
d);if(!ib.has(2))for(const Qb of d)d=null!==(da=null===(R=this.gm.GA(Qb))||void 0===R?void 0:R.role)&&void 0!==da?da:1,m=null===Qb||void 0===Qb?void 0:Qb.UL,(null!==(Ea=null===m||void 0===m?void 0:m.ja(wc.a.ma,void 0))&&void 0!==Ea?Ea:void 0)==Ul.StyleReader.wsb&&1===d&&(this.gm.V9c(Qb,2,!1),ib.set(2,new U.a([Qb])));return ib}zKn(d,m){this.VJ.ie(()=>{for(const A of m.keys())for(const R of m.get(A))this.VJ.ie(()=>{var da;return this.l1a.Juh(R,null===(da=d.styles.get(ym.h(A)))||void 0===da?void 0:da.decorators,
d.type)},"WD:ADFS")},"WD:PSD")}HKn(d){d.decorators&&this.VJ.ie(()=>this.l1a.Juh(this.rc.ed,d.decorators,d.type),"WD:ADFT")}async d2f(d){d=this.l1a.d2f(d);let m;const A=new Promise(R=>m=setTimeout(()=>{R();v.ULS.sendTraceTag(527202188,3016,50,"Reading intelligence timed out")},2E3));await Promise.race([d,A]);clearTimeout(m)}s2e(d){var m;const A=null===(m=this.rc)||void 0===m?void 0:m.ed;A?void 0===d.backgroundColor?A.hasProperty(Me.a.lV)&&A.setValue(Me.a.lV,$f.a.white):A.setValue(Me.a.lV,$f.a.J5(d.backgroundColor)):
v.ULS.shipAssertTag(541102279,3016,!1)}ORc(){const d=this.Vi.$k(this.rc.ed),m=this.q1.Nna(d,!0,!1),A=[];this.VJ.ie(()=>{do A.push(m.ex);while(m.h9())},"WD:IFAP");return A}forceOutbound(){this.Vi.$k(this.rc.ed).Zi().contentReplicator.forceOutbound(null,()=>{v.ULS.sendTraceTag(508937036,3016,50,"forceOutbound failed")},null)}}Object(y.a)(CC,"ThemeManager",null,[916]);class xw{constructor(d,m,A,R){this.nNg=null;this.AK=d;this.$Ma=m;this.g1j=R;this.Sue=new U.a;this.Skh=new U.a}IGh(){}P4c(d,m){if(!d)return v.ULS.shipAssertTag(590206988,
3016,!1),!1;switch(m.role){case 1:return this.Skh.add(d),!0;case 13:return this.dJn(d,m.A4a),!1;default:return!1}}nBb(){var d=this.g1j.styles.get(ym.h(13)),m=1;0<this.Sue.count&&(m=this.ORk(this.Sue),m=2*d.fontSize/m);for(const A of this.Skh)if(d=If.GraphIterator.eb(A),Qe.ParagraphReader.isEmpty(d))this.$Ma.Bba(A,13);else{d=[];if(1!==m){const R=Math.ceil(m*this.fBh(A));d.push({type:jf.FormattingSuggestionType.FontSize,fixedValue:R.toString()})}this.$Ma.nfb(A,d)}}dJn(d,m){this.Sue.add(this.fBh(d));
!this.nNg&&m&&(this.nNg=this.y_h(d,Me.a.font,null))}y_h(d,m,A){return(d=this.AK.Xr(jd.a.create(d)))?this.AK.Zn(d,m,A):A}ORk(d){d.Sc((A,R)=>A-R);const m=d.count>>1;return d.count%2?d.J(m):(d.J(m)+d.J(m-1))/2}fBh(d){const m=this.y_h(d,Me.a.fontSize,Bl.a.HM),A=(d.ra?d.ra.length:0)-1;let R=0,da=0;for(let ib=0;ib<A;ib++){var Ea=d.ra.J(ib);const Qb=d.ra.J(ib+1);let pc=m;Ea.formatting&&(pc=this.AK.Zn(Ea.formatting,Me.a.fontSize,m));Ea=Qb.cp-Ea.cp;R+=pc*Ea;da+=Ea}return 0<da?R/da:m}}Object(y.a)(xw,"UnknownRoleProcessor",
null,[933]);class DC{constructor(d,m,A=!1){this.qff=d;this.B1=m;this.qxm=A;this.Xog=new Set}IGh(d){d.forEach(m=>{this.qxm&&(null===m||void 0===m?0:m.bEa)||1!==this.qff.GA(m).role||(this.B1.ykc(m,!0),this.Xog.add(m))})}P4c(d){return this.Xog.has(d)}nBb(){this.Xog.forEach(d=>{this.B1.lUa(d,!0)})}}Object(y.a)(DC,"UnknownRoleProcessorPreserveStyle",null,[933]);class FB{constructor(d,m,A,R,da){this.qff=d;this.W8=m;this.iI=A;this.Zd=R;this.B1=da}create(d,m,A=!1){return m?new DC(this.qff,this.B1,A):new xw(this.W8,
this.iI,this.Zd,d)}}Object(y.a)(FB,"UnknownRoleProcessorFactory",null,[915]);class Ds{constructor(){this.initialized=!1;this.map=new Map}initialize(){this.initialized=!0}register(d,m){this.initialized||this.initialize();this.map.has(d)||this.map.set(d,[]);this.map.get(d).push(m)}unregister(d){this.map.delete(d)}}Object(y.a)(Ds,"ASuggestionLifecycleManager",null,[914]);class My extends Ds{constructor(d){super();this.rm=d;this.Pnb=(m,A)=>{if(A.property===Me.a.lastModifiedTime&&this.map.has(A.node)){const R=
A.node.ja(Me.a.lastModifiedTime,void 0);if(R){let da=!0;this.map.get(A.node).forEach(Ea=>{Ea.uvh&&Ea.uvh>=R?Ea.Q_c():da=!1});da&&this.map.delete(A.node)}}}}initialize(){this.rm.Te(12).qo(this.Pnb);super.initialize()}register(d,m){super.register(d,m);m.uvh=d.ja(Me.a.lastModifiedTime,void 0)}}Object(y.a)(My,"ConsistencySuggestionLifecycleManager",Ds,[914]);class ev extends Ds{constructor(d){super();this.rm=d;this.Onb=(m,A)=>{this.map.has(A.node)&&(this.map.get(A.node).forEach(R=>{R.Q_c()}),this.map.delete(A.node))};
this.Kpn=(m,A)=>{this.map.has(A.node)&&!Object(io.a)(A.node,5)&&(this.map.get(A.node).forEach(R=>{(Object(Dg.e)(R)||2===(null===R||void 0===R?void 0:R.Jq))&&R.Q_c()}),this.map.delete(A.node))}}initialize(){const d=this.rm.Te(12);d.kw(this.Onb);d.qo(this.Kpn);super.initialize()}}Object(y.a)(ev,"EnhancementSuggestionLifecycleManager",Ds,[914]);class GB{constructor(d){this.vg=d;this.agf=this.ccg=null;this.r1d=this.isInitialized=!1;this.Abj=(m,A)=>{this.vg.s9(A.actionId)&&(this.ccg?this.ccg(null):v.ULS.shipAssertTag(574755666,
3016,!1))};this.qEj=()=>{this.agf?(this.agf(),Ca.a(Cb.a.mpl,!0),v.ULS.sendTraceTag(537794770,3016,50,"Revert button has been disabled")):v.ULS.shipAssertTag(537794769,3016,!1)}}initialize(){this.isInitialized||(this.qkg(),this.isInitialized=!0)}Od(){this.isInitialized&&(this.opg(),this.isInitialized=!1)}setSelectThemeButtonCallback(d){this.ccg=d}setDisableRevertButtonCallback(d){this.agf=d}qkg(){this.r1d||(this.vg.R2b(this.Abj),this.vg.nzk(this.qEj),this.r1d=!0)}opg(){this.r1d&&(this.vg.g9f(this.Abj),
this.vg.M2n(this.qEj),this.r1d=!1)}}Object(y.a)(GB,"DesignerUndoTracker",null,[913,672]);class Ut extends oa.a{constructor(d,m){super(!1,!1,!0);this.Mv=d;this.Is=m;this.XBb=void 0;this.VXk=A=>{Ca.a(Cb.a.oTj,!0,void 0,[{name:"chosenOption",string:A},{name:"index",int64:this.XBb.findIndex(R=>R.id===A)}]);this.hide();switch(A){case "Template":this.Mv.show(22);break;case "Upload":window.open("https://onedrive.live.com/");break;case "Learn":window.open("https://support.microsoft.com/en-us/word");break;
case "Other":this.Is.invokeUserFeedback("WordUserIntentDialogSurvey")}}}XAm(){this.XBb=[{["id"]:"Explore",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogExplore,["imageSrc"]:Kk.a.xg("UserIntentExploreIcon.png")},{["id"]:"Template",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTemplate,["imageSrc"]:Kk.a.xg("UserIntentTemplateIcon.png")},{["id"]:"Blank",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogBlank,["imageSrc"]:Kk.a.xg("UserIntentStartBlankIcon.png")},
{["id"]:"Upload",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogUpload,["imageSrc"]:Kk.a.xg("UserIntentUploadFileIcon.png")},{["id"]:"Learn",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogLearn,["imageSrc"]:Kk.a.xg("UserIntentHowToIcon.png")}];const d={["id"]:"Other",["text"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogOther,["imageSrc"]:Kk.a.xg("UserIntentMoreItemsIcon.png")};Ut.Izo(this.XBb);this.XBb.push(d)}hzo(){void 0===this.XBb&&this.XAm();localStorage.setItem(Ut.MSh,
"true");this.Uh("",void 0,{["id"]:Ut.id,["dialogButtonsOption"]:5,["bodyControls"]:{["dialogTitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogTitle,["dialogSubtitle"]:WordEditorIntl.WordEditorStrings.L_UserIntentDialogSubtitle,["chooseFunction"]:this.VXk,["rowsInfo"]:[this.XBb.slice(0,3),this.XBb.slice(3,6)]}});Ca.a(Cb.a.pTj)}static Izo(d){for(let m=d.length-1;0<m;m--){const A=Math.floor(Math.random()*(m+1));[d[m],d[A]]=[d[A],d[m]]}}}Ut.id="UserIntentDialog";Ut.MSh="UserIntentDialogShown";
Object(y.a)(Ut,"UserIntentDialog",oa.a,[]);class Ny{constructor(d,m){this.Dka=d;this.CJj=m;this.isInitialized=!1;this.TBj=(A,R)=>{R.qZ&&this.CJj&&this.CJj.hzo()}}initialize(){if(!this.isInitialized){for(const d of this.Dka)d.U3(this.TBj),d.initialize();this.isInitialized=!0}}Od(){if(this.isInitialized){for(const d of this.Dka)d.Od(),d.dea(this.TBj);this.isInitialized=!1}}}Object(y.a)(Ny,"UserIntentDialogTriggerManager",null,[912]);var Oy=c(121);class Py{constructor(d,m){this.theme=d;this.callback=
m}}Object(y.a)(Py,"ApplyThemeActionData",null,[]);class Tr{constructor(d){this.callback=d}}Object(y.a)(Tr,"FixInconsistenciesActionData",null,[]);var up=c(112);class fv{constructor(d,m){this.query=d;this.callback=m}}Object(y.a)(fv,"GenerateDocumentActionData",null,[]);class Oz{constructor(d,m){this.template=d;this.Don=m}}Object(y.a)(Oz,"ApplyOfficeTemplateActionData",null,[]);class EC{constructor(d,m,A,R,da,Ea){this.j1a=da;this.Rp=Ea;this.ga=d;this.hba=m;this.Okh=A}TGk(d,m){d=new Py(d,m);this.ga.Qb(xe.a.S_a,
2,d)}XFk(d,m){d=new Oz(d,m);this.ga.Qb(xe.a.Sua,2,d)}generateDocument(d,m){d=new fv(d,m);this.ga.Qb(xe.a.Iml,2,d)}GGl(d){d=new Tr(d);this.ga.Qb(Ac.a.iPd,2,d)}acceptAll(){const d=new ho.a(0);this.ga.Qb(xe.a.Qeb,2,d)}rejectAll(){this.ga.processAction(Ac.a.K6c,2)}showMoreThemes(){this.ga.processAction(Ac.a.rSh,2)}logThemeInfo(d){this.ga.Qb(Ac.a.mSh,2,{theme:d})}setReviewingCallback(d){this.hba.Gno(d)}setSelectThemeButtonCallback(d){this.Okh.setSelectThemeButtonCallback(d)}setDisableRevertButtonCallback(d){this.Okh.setDisableRevertButtonCallback(d)}reviewChanges(){this.ga.processAction(Ac.a.designerReviewChanges,
2)}openGreenroomInNewTab(){this.ga.processAction(Ac.a.nSh,2)}invokeUserFeedback(d){this.j1a.m8b(m=>{this.czo(m,d)})}czo(d,m){d.iJa(m,null)}tryAnyway(){this.ga.processAction(Ac.a.tSh,2)}revertTheme(){this.ga.processAction(Ac.a.revertDesignerTheme,2)}getFontColorCssWithRespectTheming(d){return this.Rp.yRd($f.a.J5(d),new up.a(Oy.a.hL()))}getColorCssWithRespectTheming(d){return this.Rp.n0($f.a.J5(d),new up.a(Oy.a.hL()))}toggleFavorite(d,m){this.ga.Qb(Ac.a.g_h,2,{theme:d,kPm:m})}}Object(y.a)(EC,"DesignerPropsActions",
null,[908]);class kx{constructor(){this.type=null;this.isDataLoaded=!1;this.errorState=rq.none;this.activeSection=this.sections=null;this.isPaneAutoOpened=!1;this.Il=0;this.applyOfficeTemplate=this.applyTheme=this.reviewChanges=this.fixInconsistencies=null;this.inconsistenciesCount=0;this.rejectAll=this.acceptAll=null;this.hasMoreThemesToShow=!1;this.tryAnyway=this.logThemeInfo=this.tryAgain=this.showMoreThemes=null;this.errorTimeout=0;this.paneContent=this.revertTheme=this.openGreenroomInNewTab=
this.invokeUserFeedback=this.setDisableRevertButtonCallback=this.setSelectThemeButtonCallback=this.setReviewingCallback=null;this.canGetFocus=!0;this.generateDocument=this.toggleFavorite=null;this.areUserSettingsLoaded=!1;this.animationSrc=this.setSelectedSection=this.showMoreTemplates=null}}Object(y.a)(kx,"DesignerTaskPaneData",null,[]);class Lv{constructor(d,m,A,R,da,Ea,ib,Qb){this.Zd=d;this.Is=m;this.M8=A;this.tAn=R;this.tS=da;this.gm=Ea;this.IO=ib;this.qJ=Qb}Pfb(){var d,m;return Object.assign(new kx,
{acceptAll:Object(I.a)(this.Is,this.Is.acceptAll,"acceptAll"),applyTheme:Object(I.a)(this.Is,this.Is.TGk,"applyThemeHandler"),applyOfficeTemplate:Object(I.a)(this.Is,this.Is.XFk,"applyOfficeTemplateHandler"),generateDocument:Object(I.a)(this.Is,this.Is.generateDocument,"generateDocument"),isDataLoaded:this.tAn.Fdc,errorState:this.M8.FDb,fixInconsistencies:Object(I.a)(this.Is,this.Is.GGl,"fixInconsistenciesHandler"),inconsistenciesCount:this.gm.inconsistenciesCount,invokeUserFeedback:void 0,rejectAll:Object(I.a)(this.Is,
this.Is.rejectAll,"rejectAll"),hasMoreThemesToShow:!0,showMoreThemes:Object(I.a)(this.Is,this.Is.showMoreThemes,"showMoreThemes"),logThemeInfo:Object(I.a)(this.Is,this.Is.logThemeInfo,"logThemeInfo"),reviewChanges:Object(I.a)(this.Is,this.Is.reviewChanges,"reviewChanges"),setReviewingCallback:Object(I.a)(this.Is,this.Is.setReviewingCallback,"setReviewingCallback"),setSelectThemeButtonCallback:Object(I.a)(this.Is,this.Is.setSelectThemeButtonCallback,"setSelectThemeButtonCallback"),setDisableRevertButtonCallback:Object(I.a)(this.Is,
this.Is.setDisableRevertButtonCallback,"setDisableRevertButtonCallback"),sections:this.tS.Qwf(),activeSection:this.tS.m9b(),type:Cb.a.Ryj,tryAnyway:Object(I.a)(this.Is,this.Is.tryAnyway,"tryAnyway"),openGreenroomInNewTab:this.Zd.KLm()?Object(I.a)(this.Is,this.Is.openGreenroomInNewTab,"openGreenroomInNewTab"):void 0,revertTheme:Object(I.a)(this.Is,this.Is.revertTheme,"revertTheme"),isCanvasDarkModeOn:!!this.IO&&this.IO.j8,getFontColorCssWithRespectTheming:Object(I.a)(this.Is,this.Is.getFontColorCssWithRespectTheming,
"getFontColorCssWithRespectTheming"),getColorCssWithRespectTheming:Object(I.a)(this.Is,this.Is.getColorCssWithRespectTheming,"getColorCssWithRespectTheming"),paneContent:null!==(m=null===(d=this.qJ)||void 0===d?void 0:d.e9h())&&void 0!==m?m:Bn.main,canGetFocus:!0,toggleFavorite:this.Zd.PEf()?Object(I.a)(this.Is,this.Is.toggleFavorite,"toggleFavorite"):void 0,areUserSettingsLoaded:this.tS.areUserSettingsLoaded,showMoreTemplates:Object(I.a)(this.tS,this.tS.kIi,"loadMoreTemplates"),setSelectedSection:Object(I.a)(this.tS,
this.tS.setSelectedSection,"setSelectedSection"),animationSrc:Kk.a.xg("TemplateAnimation.svg")})}I_k(d){return Object.assign(new kx,{acceptAll:d.acceptAll,applyTheme:d.applyTheme,applyOfficeTemplate:d.applyOfficeTemplate,generateDocument:d.generateDocument,isPaneAutoOpened:d.isPaneAutoOpened,errorState:d.errorState,isDataLoaded:d.isDataLoaded,fixInconsistencies:d.fixInconsistencies,inconsistenciesCount:d.inconsistenciesCount,invokeUserFeedback:d.invokeUserFeedback,rejectAll:d.rejectAll,hasMoreThemesToShow:d.hasMoreThemesToShow,
showMoreThemes:d.showMoreThemes,logThemeInfo:d.logThemeInfo,reviewChanges:d.reviewChanges,setReviewingCallback:d.setReviewingCallback,setSelectThemeButtonCallback:d.setSelectThemeButtonCallback,setDisableRevertButtonCallback:d.setDisableRevertButtonCallback,sections:d.sections,activeSection:d.activeSection,type:d.type,tryAnyway:d.tryAnyway,openGreenroomInNewTab:d.openGreenroomInNewTab,revertTheme:d.revertTheme,isCanvasDarkModeOn:d.isCanvasDarkModeOn,getFontColorCssWithRespectTheming:d.getFontColorCssWithRespectTheming,
getColorCssWithRespectTheming:d.getColorCssWithRespectTheming,paneContent:d.paneContent,canGetFocus:d.canGetFocus,toggleFavorite:this.Zd.PEf()?d.toggleFavorite:void 0,areUserSettingsLoaded:d.areUserSettingsLoaded,showMoreTemplates:d.showMoreTemplates,setSelectedSection:d.setSelectedSection,animationSrc:d.animationSrc})}}Object(y.a)(Lv,"DesignerPropsFactory",null,[907]);class Qy{constructor(d){this.Psa=null;this.MPe=d;this.sa=new vb.a}Bzk(d){this.sa.addHandler("PropsChangedEvent",d)}Yha(){this.Psa||
(this.Psa=this.MPe.Pfb());return this.Psa}upb(d,m=!1){if(d){this.Psa||(v.ULS.shipAssertTag(592496460,3016,!1),this.Psa=this.MPe.Pfb());var A=this.MPe.I_k(this.Psa);d(A);if(m||this.Svo(A))this.Psa=A,d=new lq.a(this.Psa),this.sa.j9&&this.sa.raiseEvent("PropsChangedEvent",d)}else v.ULS.shipAssertTag(592496459,3016,!1)}Svo(d){return d.inconsistenciesCount!==this.Psa.inconsistenciesCount||d.errorState!==this.Psa.errorState||d.isDataLoaded!==this.Psa.isDataLoaded||d.invokeUserFeedback!==this.Psa.invokeUserFeedback}}
Object(y.a)(Qy,"DesignerPropsManager",null,[906]);class $x{constructor(d,m,A,R,da,Ea,ib,Qb,pc=0,Pc,gd){this.LEa=d;this.M8=m;this.gm=A;this.T1=R;this.tS=da;this.Dsg=Ea;this.Is=ib;this.Anf=Qb;this.FLn=pc;this.Sdf=Pc;this.qJ=gd;this.isInitialized=!1;this.i4f=0;this.d5c=null;this.oqn=(Cd,ae)=>{this.$4k(()=>{this.LEa.upb(Xd=>{Xd.inconsistenciesCount=ae.data;Xd.canGetFocus=!0})})};this.f9d=()=>{this.LEa.upb(Cd=>{Cd.sections=this.tS.Qwf();Cd.activeSection=this.tS.m9b();Cd.canGetFocus=!0;Cd.areUserSettingsLoaded=
this.tS.areUserSettingsLoaded},!0)};this.fvn=(Cd,ae)=>{this.LEa.upb(Xd=>{Xd.sections=this.tS.Qwf();Xd.hasMoreThemesToShow=ae.data;Xd.canGetFocus=!0;Xd.areUserSettingsLoaded=this.tS.areUserSettingsLoaded},!0)};this.MWf=()=>{this.LEa.upb(Cd=>{if(this.qJ){const ae=this.qJ.e9h();Cd.paneContent!==ae&&(Cd.activeSection=void 0,Cd.paneContent=ae,Cd.canGetFocus=!1)}},!0)};this.nZf=(Cd,ae)=>{this.LEa.upb(Xd=>{Xd.isCanvasDarkModeOn=ae.isCanvasDarkModeOn;Xd.canGetFocus=!0},!0)};this.zhl=(Cd,ae)=>{this.LEa.upb(Xd=>
{Xd.errorState=ae.data;Xd.canGetFocus=!0})};this.o$d=(Cd,ae)=>{this.LEa.upb(Xd=>{Xd.isDataLoaded=ae.data;Xd.canGetFocus=!0;Xd.isPaneAutoOpened=G.$Xc})}}initialize(){this.isInitialized||(this.gm.uyk(this.oqn),this.M8.Nqh(this.zhl),this.tS.DCd(this.f9d),this.tS.czk(this.fvn),this.T1.E0e(this.o$d),this.Sdf.yCd(this.nZf),this.Anf.execute(async d=>{await d.isFeatureEnabled(Cb.a.WQi,!1)&&this.LEa.upb(m=>{m.invokeUserFeedback=A=>this.Is.invokeUserFeedback(A);m.canGetFocus=!0},!0)}),this.qJ&&this.qJ.rrh(this.MWf),
this.isInitialized=!0)}Od(){}$4k(d){this.d5c?(this.d5c=d,this.i4f||(this.i4f=this.Dsg.setTimeout(()=>{this.d5c();this.i4f=0},this.FLn))):(this.d5c=d,this.d5c())}}Object(y.a)($x,"DesignerPropsUpdater",null,[887,672]);class Gr{constructor(d,m,A){this.KH=d;this.Oml=m;this.jb=A;this.pka=()=>{this.JVc();this.jb.qpb(this.pka)};if(!d)throw fs.a.argument("AppLifecycleManager is null");if(!A)throw fs.a.argument("Workspace is null");}get Zd(){return null!=this.yyg?this.yyg:this.yyg=(()=>this.container.resolve("WordEditor.Designer.IDesignerControl"))()}get name(){return"WordEditor.Designer"}init(){this.container.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{this.xn()})}wc(d){this.container=d;d.ia("WordEditor.Designer.Perf.IPerfLogger",()=>new xo.a(cb.a.$e)).ha();d.ia("WordEditor.Designer.Persistence.IDesignerTransactionFactory",()=>new dt(d.resolve("Box4.Graph.IGraphTransactionFactory"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();d.ia("WordEditor.Designer.AL.IWorkflowManager",()=>{const da=new U.a;da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ);da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb);
da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a);da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ofe);da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Gzj);da.add(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2);return new Kd(d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),da)}).ha();d.ia("WordEditor.Designer.Style.IStyleManager",()=>new rw(d.resolve("WordEditor.Designer.IDesignerControl"),
d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("WordEditor.Designer.Storage.StyleStorage"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager",()=>new EB(jd.a.createTextRange,d.resolve("Box4.IFormattingReader"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.List.IListReader"),d.resolve("Box4.IOutlineElementNavigator"),d.resolve("Box4.TextFormattingHelper"),
d.resolve("Box4.List.ListItemEditor"))).ha();d.ia("WordEditor.Designer.Style.IManualListConverter",()=>new Jv(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.List.IListEditor"),d.resolve("Box4.List.IListReader"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.IParagraphIndentationReader"),su.a.yQa)).ha();d.ia("WordEditor.Designer.Style.Decorator.DecoratorStorage",()=>new zC).ha();d.ia("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory",
()=>new eo(n.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.ISelectionManager"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Designer.Image.DesignerImageManager"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
this.jb.rc,d.resolve("Box4.ITableEditor"),d.resolve("Box4.ICharacterPropertiesEditor"),Ab.App.zd,d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.IParagraphIteratorFactory"),new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.rc.ed),this.NCj(),d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),d.resolve("Box4.Styles.IWACStyleReader"),
pg.InteractiveViewManager.instance,this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.Style.Decorator.DecoratorManager",()=>new DA(d.resolve("WordEditor.Designer.Style.Decorator.DecoratorEditorFactory"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("Box4.IUndoManager"),d.resolve("Box4.Graph.IGraphIteratorFactory"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null,
d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.rc.ed))).ha();d.ia("WordEditor.Designer.Style.IParagraphDesigner",()=>new oj(d.resolve("WordEditor.Designer.IDesignerControl"),jd.a.createTextRange,d.resolve("Box4.IFormattingReader"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.IParagraphEditor"),d.resolve("WordEditor.Designer.Style.IParagraphFormattingSnapshotManager"),
d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("Box4.TextFormattingHelper"),d.resolve("Box4.List.IListReader"),d.resolve("WordEditor.Designer.Style.IManualListConverter"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.AugmentationLoop.IFormattingExtractor"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.Style.IUnknownRoleProcessorFactory",()=>new FB(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
d.resolve("Box4.IFormattingReader"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Review.IRestoreManager"))).ha();d.ia("WordEditor.Designer.Style.IBlankDocumentEditor",()=>new Tu(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("WordEditor.ContentControl.IContentControlManager"),d.resolve("Box4.IFormattingEditor"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.IHyperlinkEditor"),d.resolve("Box4.IOutlineElementEditor"),
d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.TextFormattingHelper"),this.jb.rc)).ha();d.ia("WordEditor.Designer.Style.ITableDesigner",()=>new Zx(d.resolve("WordEditor.IWACTableStyleReader"),tp.a.instance)).ha();d.ia("WordEditor.Designer.Style.ITableManager",()=>new ww(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").HIo,d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"))).ha();d.ia("WordEditor.Designer.Style.IThemeManager",
()=>new CC(d.resolve("WordEditor.Designer.Style.IBlankDocumentEditor"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Perf.IPerfLogger"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.IFlatListEditor"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphIteratorFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Designer.Review.IReviewManager"),
d.resolve("WordEditor.Designer.Style.IStyleManager"),d.resolve("WordEditor.Designer.Style.IUnknownRoleProcessorFactory"),this.jb.rc,!!Ab.App.instance&&Ab.App.instance.cD,d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorStorage"),d.resolve("WordEditor.Designer.Style.ITableManager"),
d.resolve("WordEditor.Designer.Style.ITableDesigner"),d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.Image.DesignerImageManagerImpl",()=>new Zu(d.resolve("Box4.IOutlineElementEditor"),d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.Images.IImageEditor"),d.resolve("WordEditor.IImageEditor"),d.resolve("Box4.Styles.IWACStyleReader"),
d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),this.jb.rc,this.NCj())).as("WordEditor.Designer.Image.DesignerImageManager").ha();d.ia("WordEditor.Designer.Image.DesignerTextToImageManagerImpl",()=>new ls(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").hSb,this.jb.rc,d.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Designer.Image.DesignerTextToImageManager").ha();
d.ia("WordEditor.Designer.Style.IDocumentLanguageManager",()=>new sw(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)).ha();d.ia("WordEditor.Designer.Style.IRevertManager",()=>new dv(d.resolve("Box4.Graph.IGraphTransactionFactory"),d.resolve("Box4.IUndoManager"),this.jb.ju)).ha();d.ia("WordEditor.Designer.Style.ApplyThemeDialogManager",()=>new Cz(d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"))).ha();this.bWn();this.aYn();this.JYn();this.WVn();d.ia("WordEditor.Designer.FRE.IFirstRunExperienceManager",
()=>new Tl(d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.Sa("Common.ISystemInitiatedFeedback"))).ha();d.ia("WordEditor.Designer.Style.IThemeCategorizer",()=>new Pg(d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.Designer.Perf.IPerfLogger"))).ha();
d.ia("WordEditor.Designer.Style.CurrentThemeProvider",()=>new Yj(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Gzj)).ha();d.ia("WordEditor.Designer.Style.AugLoopThemeProvider",()=>new rt(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),d.resolve("WordEditor.Designer.Style.Decorator.DecoratorManager"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();
this.Zd.Elb()&&d.ia("WordEditor.Designer.Style.OfficeTemplatesThemeProvider",()=>new Xx(d.resolve("Box4.OfficeTemplates.OfficeTemplatesDiscoveryService"))).ha();const m=new Pd.a(()=>{const da=[];da.push(d.resolve("WordEditor.Designer.Style.CurrentThemeProvider"));da.push(d.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"));this.Zd.Elb()&&da.push(d.resolve("WordEditor.Designer.Style.OfficeTemplatesThemeProvider"));return da});d.ia("WordEditor.Designer.Style.IThemeGenerator",()=>new os(m.value,
d.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha();d.ia("WordEditor.Designer.Trackers.IDesignerUndoTracker",()=>new GB(d.resolve("Box4.IUndoManager"))).ha();d.ia("WordEditor.Designer.Wire.IDesignerPropsActions",()=>new EC(n.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Review.IReviewManager"),d.resolve("WordEditor.Designer.Trackers.IDesignerUndoTracker"),d.Sa("Common.ISystemInitiatedFeedback"),Wq.a.N9b(),
d.resolve("Box4.ICssColorProvider"))).ha();d.ia("WordEditor.Designer.Wire.IDesignerPropsFactory",()=>new Lv(d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Pane.IPaneLoadingManager"),d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.IDarkModeState"),this.Zd.GRa()?
d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.BrowserApis.IWindowTimeout",()=>new Nd).ha();d.ia("WordEditor.Designer.Wire.IDesignerPropsUpdater",()=>new $x(d.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Style.IThemeGenerator"),
d.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),d.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"),d.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Zd.kbm(),d.resolve("Box4.DarkModeEventsManager"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null)).ha();d.ia("WordEditor.Designer.Wire.IDesignerPropsManager",()=>new Qy(d.resolve("WordEditor.Designer.Wire.IDesignerPropsFactory"))).ha();d.ia("WordEditor.Designer.Logging.IBlankDocumentLogger",
()=>new Rt(d.resolve("Box4.IParagraphReader"),this.jb.rc)).ha();d.ia("WordEditor.Designer.Logging.IConsistencyFixActionsLogger",()=>new Gy(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb,d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a,d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha();d.ia("WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",()=>new Fv(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)).ha();
d.ia("WordEditor.Designer.Logging.IProactiveSurveyEventLogger",()=>new $u(d.Sa("Common.ISystemInitiatedFeedback"),d.resolve("WordEditor.Designer.BrowserApis.IWindowTimeout"),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ia("WordEditor.Designer.IDesignerTaskPane",()=>new jx(sf.StaticActiveAppFrame.za(),d.resolve("WordEditor.Designer.Wire.IDesignerPropsManager"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),Ib.FocusManager.instance(),
Hh.a.instance,xh.UISurfaces.Pu,d.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),d.resolve("WordEditor.Designer.License.ILicenseManager"),d.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"))).ha();const A=new Pd.a(()=>new yt);d.ia("WordEditor.Designer.IDesignerTaskPaneEvents",()=>A.value).ha();d.ia("WordEditor.Designer.IDesignerTaskPaneEventsInternal",()=>A.value).ha();d.ia("WordEditor.Designer.License.ILicenseManager",()=>new Ev(d.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();
d.ia("WordEditor.Designer.Storage.IParagraphFormattingStorage",()=>new Uj).ha();d.ia("WordEditor.Designer.Storage.StyleStorage",()=>new Fy).ha();d.ia("WordEditor.Designer.Review.IReviewTraverser",()=>new xq(d.resolve("Box4.Intent.IIntentRangeEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IParagraphIteratorFactory"),this.jb.rc)).ha();d.ia("WordEditor.Designer.Review.IRestoreManager",()=>new xC(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("WordEditor.IFlatListEditor"),d.resolve("Box4.IFormattingEditor"),
d.resolve("Box4.IParagraphEditor"),d.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),d.resolve("Box4.TextFormattingHelper"),jd.a.createTextRange,d.resolve("WordEditor.Designer.Storage.StyleStorage"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("Box4.List.IListReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesDesigner",()=>new ns(d.resolve("WordEditor.IImageEditor"),d.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
d.resolve("Box4.IUndoManager"),n.AFrameworkApplication.K,d.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),d.resolve("Box4.Images.IImageReader"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.IFeatureHelper"),d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.TextFormattingHelper"),d.resolve("Box4.IFormattingEditor"),d.resolve("WordEditor.ClientPagination.IClientPaginationUlsLogger"),d.resolve("Box4.IOutlineElementEditor"),sf.StaticActiveAppFrame.za().jb.rc,n.AFrameworkApplication.ta.TQa,
d.resolve("Box4.IBlobReader"),d.resolve("Box4.Styles.IWACStyleReader"))).ha();this.container.ia("WordEditor.Designer.Style.PullQuotesManager",()=>new FA(d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),d.resolve("WordEditor.Designer.Review.IReviewManager"),sf.StaticActiveAppFrame.za().jb.rc)).ha();this.container.ia("WordEditor.Designer.Persistence.PersistenceHelper",()=>new uf.a(new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.Zc.xd),
d.resolve("Box4.IIntelligenceReader"),d.resolve("Box4.IIntelligenceEditor"),d.resolve("Box4.PersistenceSettingsManager"))).ha();d.ia("WordEditor.Designer.Review.IReviewManager",()=>new Wk(n.AFrameworkApplication.va,d.resolve("WordEditor.Designer.Perf.IPerfLogger"),d.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),d.resolve("Box4.Intent.IIntentRangeEditor"),Ca.a,d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Designer.Review.IRestoreManager"),
new BC,d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.Style.PullQuotesDesigner"),d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Persistence.PersistenceHelper"),d.resolve("WordEditor.Designer.Image.DesignerImageManager"),d.resolve("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager"),
d.resolve("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager"),d.Sa("Common.ISystemInitiatedFeedback"),d.resolve("WordEditor.Designer.IDesignerControl"),d.Sa("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),d.resolve("Box4.IParagraphIteratorFactory"),d.resolve("Box4.List.IListReader"),this.jb.rc)).ha();d.ia("WordEditor.Designer.Review.IReviewActions",()=>new kp(d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),
d.resolve("WordEditor.Designer.Review.IReviewManager"),this.jb.ju)).ha();d.ia("WordEditor.Designer.OnCanvas.ReviewSelectionManager",()=>new Hz(d.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),d.resolve("Box4.ISelectionManager"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();d.ia("WordEditor.Designer.OnCanvas.HighlightActor",()=>new Sx(d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("Box4.Intent.IIntentRangeEditor"),eg.a.$f,eg.a.Gw)).ha();d.ia("WordEditor.Designer.OnCanvas.IBlueDotActor",
()=>new Ez.a(d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("Box4.Highlight.IHighlightManager"),Object(I.a)(ru.a.instance,ru.a.instance.oE,"registerHandlerWithData"),Object(I.a)(fx.a.instance,fx.a.instance.ob,"registerHandler"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"),this.jb.ju)).ha();d.ia("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader",()=>new dq(d.resolve("Box4.Styles.IWACStyleReader"))).ha();
d.ia("WordEditor.Designer.OnCanvas.ITriageOptionFactory",()=>new xt(d.resolve("WordEditor.Designer.Storage.IParagraphFormattingSnapshotReader"),d.resolve("WordEditor.Designer.Storage.IParagraphFormattingStorage"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ia("WordEditor.Designer.OnCanvas.ITriageOptionProvider",()=>new jp(d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("WordEditor.Designer.OnCanvas.ITriageOptionFactory"),
d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.Review.IReviewTraverser"))).ha();d.ia("WordEditor.Designer.Style.IDocumentConsistencyManager",()=>new Ly(d.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a,d.resolve("WordEditor.Designer.Persistence.IDesignerTransactionFactory"),d.resolve("WordEditor.Designer.Style.IParagraphDesigner"),d.resolve("WordEditor.Designer.Review.IReviewManager"),this.jb.rc,d.resolve("Box4.IParagraphReader"),d.Sa("Common.ISystemInitiatedFeedback"),
d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.IFormattingReader"))).ha();const R=new Pd.a(()=>new Cf);d.ia("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition",()=>R.value).ha();d.ia("Box4.OfficeTemplates.ApplyTemplatesProxy",()=>new rg(n.AFrameworkApplication.He));d.ia("WordEditor.Designer.Style.ITemplateAppliedListener",()=>new sd(d.resolve("Box4.IUndoManager")));
d.ia("WordEditor.Designer.Actors.DesignerActionActor",()=>new lb(n.AFrameworkApplication.va,Ab.App.zd,d.resolve("WordEditor.Designer.Logging.IConsistencyFixActionsLogger"),d.resolve("WordEditor.Designer.Logging.IProactiveSurveyEventLogger"),d.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),d.resolve("WordEditor.Designer.Errors.IErrorStateManager"),d.resolve("WordEditor.Designer.Style.IRevertManager"),d.resolve("WordEditor.Designer.Review.IReviewActions"),d.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
d.resolve("WordEditor.Designer.Review.IReviewManager"),d.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),n.AFrameworkApplication.lc,d.resolve("WordEditor.Designer.Style.IThemeGenerator"),d.resolve("WordEditor.Designer.Style.IThemeManager"),d.resolve("WordEditor.Designer.Style.IThemeCategorizer"),d.resolve("WordEditor.Designer.IDesignerControl"),d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"),
d.resolve("WordEditor.Designer.Style.ApplyThemeDialogManager"),this.Zd.GRa()?d.resolve("WordEditor.Designer.DocumentState.IDocumentStateMonitor"):null,d.resolve("Box4.OfficeTemplates.ApplyTemplatesProxy"),d.resolve("WordEditor.Designer.Style.ITemplateAppliedListener"),this.jb.Zc,this.container.resolve("Box4.IUndoManager"))).ha();d.ia("WordEditor.Designer.Actors.DesignerActor",()=>new Nc(n.AFrameworkApplication.va,d.resolve("WordEditor.Designer.IDesignerTaskPane"),d.resolve("WordEditor.Designer.License.ILicenseManager"),
appChrome.api,appChrome.actions,d.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),sf.StaticActiveAppFrame.za(),d.resolve("WordEditor.Designer.IDesignerControl"))).ha();d.ia("WordEditor.Designer.SuggestionLifecycle.EnhancementSuggestionLifecycleManager",()=>new ev(d.resolve("Box4.Graph.IGraphInstance"))).ha();d.ia("WordEditor.Designer.SuggestionLifecycle.ConsistencySuggestionLifecycleManager",()=>new My(d.resolve("Box4.Graph.IGraphInstance"))).ha();d.ia("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement",
()=>new mw(d.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator"))).ha();d.ia("WordEditor.Designer.DocumentTypeEventSource",()=>new Cm).ha();this.Zd.e_d()&&d.ia("WordEditor.Designer.DocumentStatsDnmLogger",()=>new Pt(d.resolve("Box4.Graph.IGraphIteratorFactory"),d.resolve("WordEditor.IPageNumberFinder"),d.resolve("WordEditor.Designer.DocumentTypeEventSource"))).ha();this.Zd.Pqb()&&d.ia("WordEditor.Designer.Actors.DesignerPasteActor",()=>new fd(n.AFrameworkApplication.va,d.resolve("WordEditor.Designer.SmartPaste.SmartPasteManager"),
d.resolve("Box4.IPasteFloatieEventSource"))).ha();this.Zd.Pqb()?this.PYn():this.Zd.UZd()&&this.IVn();this.Zd.Kgg()&&this.F7f();this.Zd.Z_d()&&this.pXn();this.Zd.VBi()&&this.mYn();this.Zd.txi()&&this.fXn();this.Zd.OEf()&&this.WWn();this.Zd.bCi()&&this.pYn();this.Zd.kJf()&&this.jZn()}dispose(){}WVn(){this.Zd.GRa()&&(this.container.ia("WordEditor.Designer.DocumentState.DocumentStateMachine",()=>new zl).ha(),this.container.ia("WordEditor.Designer.DocumentState.IDocumentStateMonitor",()=>new As(this.container.resolve("Box4.IParagraphReader"),
this.jb.rc,this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.container.resolve("WordEditor.Designer.DocumentState.DocumentStateMachine"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha())}aYn(){const d=new Pd.a(()=>new St(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb)),m=new Pd.a(()=>new ix(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)),
A=new Pd.a(()=>new bv(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2)),R=new Pd.a(()=>{const da=new U.a;da.add(d.value);da.add(m.value);da.add(A.value);return da});this.container.ia("WordEditor.Designer.Pane.PaneLoadingManager",()=>new Tt(this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),R.value)).as("WordEditor.Designer.Pane.IPaneLoadingManager").ha()}JYn(){this.container.register(Su,"WordEditor.Designer.WordDesignerSettingsHandler").as("WordEditor.Designer.IWordDesignerSettingsHandler").ha().Ud(()=>
new Su(this.container.resolve("Box4.IRoamingServiceRequestManager"),this.container.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.container.resolve("Common.IAppSettingsManager"),new vb.a,this.container.resolve("Common.IUlsWrapper")));this.container.ia("WordEditor.Designer.Settings.DesignerSettingsManager",()=>new Jy(this.container.resolve("WordEditor.Designer.WordDesignerSettingsHandler"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).as("WordEditor.Designer.Settings.IDesignerSettingsManager").ha()}bWn(){const d=
new Pd.a(()=>new bl(Ab.App.zd,this.Zd.X6b())),m=new Pd.a(()=>new wr(this.container.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.container.resolve("Box4.TrackChange.ITrackChangeEventsActor"))),A=new Pd.a(()=>new hs(this.container.resolve("WordEditor.Designer.Style.IDocumentLanguageManager"))),R=new Pd.a(()=>new Er(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb)),da=new Pd.a(()=>new Bs(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,
this.container.resolve("Box4.IParagraphReader"),this.jb.rc)),Ea=new Pd.a(()=>{const ib=new U.a;this.Zd.X6b()&&ib.add(d.value);this.Zd.ILm()&&ib.add(m.value);ib.add(R.value);ib.add(A.value);this.Zd.PQm()&&ib.add(da.value);return ib});this.container.ia("WordEditor.Designer.Errors.IErrorStateManager",()=>new Rr(Ea.value)).ha()}PYn(){this.container.ia("WordEditor.Designer.SmartPaste.SmartPasteManager",()=>new yq(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("Box4.UI.PasteFloatieManager"),
this.container.Sa("Box4.Actors.ClipboardActor"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb,this.container.resolve("Box4.IUndoManager"),Ab.App.li.Al,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Sa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"))).ha()}IVn(){this.container.ia("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext",
()=>new nj(this.container.resolve("Box4.List.IListReader"))).ha();this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider",()=>new Cn(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Style.IDocumentConsistencyManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").n2a,this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))).ha();
const d=new Pd.a(()=>new we(6,Ab.App.zd,this.Zd.X6b())),m=new Pd.a(()=>new Qh(Ab.App.li.Al,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ContextualSuggestionsContext"))),A=new Pd.a(()=>new bo(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),R=new Pd.a(()=>{const Cd=new U.a;Cd.add(m.value);Cd.add(A.value);Cd.add(d.value);return Cd}),da=new Pd.a(()=>new zA(this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),Ea=new Pd.a(()=>
new pp(6,R.value,Object(st.g)()?da.value:null)),ib=new Pd.a(()=>{const Cd=[];Cd.push(Ea.value);return Cd}),Qb=new Pd.a(()=>new ir(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),pc=new Pd.a(()=>{const Cd=new U.a;Cd.add(Qb.value);Cd.add(A.value);return Cd}),Pc=new Pd.a(()=>new pp(6,pc.value,Object(st.g)()?da.value:null)),gd=new Pd.a(()=>{const Cd=[];Cd.push(Pc.value);return Cd});this.container.ia("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager",
()=>new al(ib.value,gd.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsProvider"),!this.Zd.QHf())).ha()}mYn(){this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker",()=>new ax(this.container.resolve("WordEditor.Designer.IDesignerControl"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb,n.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.container.resolve("WordEditor.Designer.FRE.IFirstRunExperienceManager")));const d=new Pd.a(()=>new gj(11)),m=new Pd.a(()=>new Mn(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),11)),A=new Pd.a(()=>new ir(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"),this.Zd.PIn(),!1)),R=new Pd.a(()=>{const ib=new U.a;ib.add(d.value);
ib.add(m.value);ib.add(A.value);return ib}),da=new Pd.a(()=>new kq.a(11,R.value,null,3016,Cb.a.TIn)),Ea=new Pd.a(()=>{const ib=[];ib.push(da.value);return ib});this.container.ia("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2",()=>new kj(Ea.value,this.container.resolve("WordEditor.Designer.ProactiveV2.ProactiveSuggestionsChecker"),this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"),n.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))).ha()}pXn(){const d=
new Pd.a(()=>new an(this.KH)),m=new Pd.a(()=>new Wx),A=new Pd.a(()=>new Ey(15,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),R=new Pd.a(()=>new Qr.a(15,this.container.resolve("Box4.IParagraphReader"),this.jb.rc,{QPb:!0,qP:!1,Cbc:!0,Bbc:!0,pP:!0})),da=new Pd.a(()=>{const pc=new U.a;pc.add(d.value);pc.add(m.value);pc.add(A.value);pc.add(R.value);return pc}),Ea=new Pd.a(()=>new Oq(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.Zd.Z_d())),ib=new Pd.a(()=>new pp(15,da.value,Ea.value,null,new Of("Jump-start templates loaded",Cb.a.pLd,Qr.a.G4e))),Qb=new Pd.a(()=>{const pc=new U.a;pc.add(ib.value);return pc});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial",()=>new AA(Qb.value,Ea.value,null)).ha()}jZn(){const d=new Pd.a(()=>new an(this.KH)),m=new Pd.a(()=>new gs(Ut.MSh,"false","false")),A=new Pd.a(()=>
new Qr.a(2,this.container.resolve("Box4.IParagraphReader"),this.jb.rc,{QPb:!0,qP:!1,Cbc:!0,Bbc:!0,pP:!0})),R=new Pd.a(()=>new Wx),da=new Pd.a(()=>{const ib=new U.a;ib.add(d.value);ib.add(m.value);ib.add(A.value);ib.add(R.value);return ib}),Ea=new Pd.a(()=>new kq.a(2,da.value,null,3016,Cb.a.pLd));this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialog",()=>new Ut(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Wire.IDesignerPropsActions"))).ha();
this.container.ia("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager",()=>new Ny([Ea.value],this.container.resolve("WordEditor.Designer.UserIntentDialog.UserIntentDialog"))).ha()}F7f(){const d=new Pd.a(()=>new we(1,Ab.App.zd,this.Zd.X6b())),m=new Pd.a(()=>new cr(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,Cb.a.Fxj)),A=[ni.DocumentTypeLabel.ManualsAndGuidelines,ni.DocumentTypeLabel.ContractsAndPolicies,ni.DocumentTypeLabel.ArticlesAndReports,
ni.DocumentTypeLabel.JobDescription],R=new Pd.a(()=>new Az(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Cb.a.iym,A)),da=new Pd.a(()=>new Dy(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Cb.a.oQf)),Ea=new Pd.a(()=>new yA(1,this.container.resolve("WordEditor.SignalAggregator.SignalAggregator"),Cb.a.gnf,Cb.a.W0c)),ib=new Pd.a(()=>new Mx(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CFb,
Cb.a.nQf)),Qb=new Pd.a(()=>new Ey(1,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),pc=new Pd.a(()=>new Qr.a(2,this.container.resolve("Box4.IParagraphReader"),this.jb.rc,{QPb:!0,qP:!1,Cbc:!0,Bbc:!0,pP:!0})),Pc=new Pd.a(()=>new ir(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),gd=new Pd.a(()=>new yv(10,n.AFrameworkApplication.va,
this.container.resolve("WordEditor.Designer.IDesignerControl"))),Cd=new Pd.a(()=>new Az(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Cb.a.ahf,[ni.DocumentTypeLabel.Letters])),ae=new Pd.a(()=>new Ey(10,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),Xd=new Pd.a(()=>new an(this.KH)),
se=new Pd.a(()=>new Wx),Xe=new Pd.a(()=>new bo(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),Be=new Pd.a(()=>new hh(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"),2,!1)),Hg=new Pd.a(()=>new zB(this.Zd.rZc())),Xh=new Pd.a(()=>new Ey(13,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a2,this.container.resolve("WordEditor.Designer.Style.AugLoopThemeProvider"))),Fl=new Pd.a(()=>new Qr.a(13,this.container.resolve("Box4.IParagraphReader"),
this.jb.rc,{QPb:!0,qP:!1,Cbc:!0,Bbc:!0,pP:!0})),Gm=new Pd.a(()=>{const vj=new U.a;vj.add(da.value);vj.add(d.value);vj.add(Ea.value);this.Zd.jMm()&&vj.add(R.value);vj.add(m.value);vj.add(ib.value);vj.add(Qb.value);return vj}),em=new Pd.a(()=>{const vj=new U.a;vj.add(Cd.value);1===this.Zd.hMd()?vj.add(Pc.value):vj.add(gd.value);vj.add(ae.value);return vj}),$n=new Pd.a(()=>{const vj=new U.a;vj.add(Xd.value);vj.add(se.value);this.Zd.GIf()&&(vj.add(Xe.value),vj.add(Be.value));vj.add(Hg.value);vj.add(Xh.value);
vj.add(Fl.value);return vj}),Ep=new Pd.a(()=>new Oq(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.Designer.Errors.IErrorStateManager"),this.Zd.UBi())),Mm=new Pd.a(()=>new dr(this.container.resolve("WordEditor.Designer.Persistence.PersistenceHelper"))),Mk=new Pd.a(()=>new pp(1,Gm.value,Ep.value)),gm=new Pd.a(()=>{let vj;return new pp(2,(vj=new U.a,vj.add(pc.value),vj),Ep.value)}),cl=new Pd.a(()=>new pp(10,em.value,Ep.value,Mm.value)),Sj=new Pd.a(()=>
new pp(13,$n.value,Ep.value,null,new Of("Jump-start proactive Designer Pane opening",Cb.a.pLd,Qr.a.G4e))),xp=new Pd.a(()=>{const vj=new U.a;(this.Zd.hMd()||this.Zd.e_d())&&vj.add(cl.value);this.Zd.IFf()&&vj.add(Mk.value);this.Zd.$vi()&&vj.add(gm.value);this.Zd.$_d()&&vj.add(Sj.value);return vj});this.container.ia("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager",()=>{let vj=new xB(n.AFrameworkApplication.va,this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"));
this.Zd.$_d()&&this.Zd.JJf()&&(vj=new Jz(this.container.Sa("Common.ISystemInitiatedFeedback"),Cb.a.xZm,new yB(Cb.a.yZm,vj,13)));return new AA(xp.value,Ep.value,vj)}).ha();this.container.ia("WordEditor.Designer.Proactive.IUserEngagementMonitor",()=>new Pj(n.AFrameworkApplication.va,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal"))).ha()}WWn(){const d=new Ff,m=new Pd.a(()=>new te(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),
d)),A=new Pd.a(()=>new Qg(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),d,this.container.Sa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),R=new Pd.a(()=>{const ib=new U.a;ib.add(this.container.resolve("WordEditor.Designer.ContextualSuggestions.Conditions.HeadingsImageCondition"));ib.add(m.value);ib.add(A.value);return ib}),da=new Pd.a(()=>new kq.a(14,R.value,null,3016,Cb.a.Fum)),Ea=new Pd.a(()=>{const ib=new U.a;
ib.push(da.value);return ib});this.container.ia("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager",()=>new po(Ea.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d)).ha()}fXn(){const d=new Ff,m=new Pd.a(()=>new ir(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.container.resolve("Box4.IUndoManager"))),A=new Pd.a(()=>new Vf(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("WordEditor.Designer.Review.IReviewTraverser"),d,this.jb.rc)),R=new Pd.a(()=>new we(8,Ab.App.zd,this.Zd.X6b())),da=new Pd.a(()=>new Gj(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.jb.rc)),Ea=new Pd.a(()=>new fe(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").ofe,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
d)),ib=[ni.DocumentTypeLabel.ManualsAndGuidelines,ni.DocumentTypeLabel.ArticlesAndReports,ni.DocumentTypeLabel.DocumentsDesignedForPrinting,ni.DocumentTypeLabel.Forms,ni.DocumentTypeLabel.ListsAndNotes,ni.DocumentTypeLabel.Plans],Qb=new Pd.a(()=>new Az(8,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Cb.a.ahf,ib)),pc=new Pd.a(()=>new Qg(this.container.resolve("WordEditor.Designer.Image.DesignerTextToImageManager"),
d,this.container.Sa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))),Pc=new Pd.a(()=>new bo(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),gd=new Pd.a(()=>{const se=new U.a;se.add(m.value);se.add(A.value);se.add(Pc.value);se.add(R.value);se.add(da.value);se.add(Ea.value);se.add(pc.value);this.Zd.tWm()&&se.add(Qb.value);return se}),Cd=new Pd.a(()=>new Lk(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),
this.container.resolve("WordEditor.Designer.Image.DesignerImageManagerImpl"),this.jb.rc,this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),ae=new Pd.a(()=>new Jp(8,gd.value,Cd.value,Cb.a.qLj)),Xd=new Pd.a(()=>{const se=new U.a;se.add(ae.value);return se});this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler",()=>new Xp(this.container.resolve("WordEditor.Designer.Image.DesignerImageManager"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),
this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();this.container.ia("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager",()=>new po(Xd.value,this.container.resolve("WordEditor.Designer.ContextualSuggestions.ImageSuggestionHandler"),d)).ha()}pYn(){const d=new Pd.a(()=>new zg(this.container.resolve("WordEditor.Designer.License.ILicenseManager"))),m=new Pd.a(()=>new we(9,Ab.App.zd,this.Zd.X6b())),A=new Pd.a(()=>new ir(this.container.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.container.resolve("Box4.IUndoManager"))),R=new Pd.a(()=>new Qr.a(9,this.container.resolve("Box4.IParagraphReader"),this.jb.rc,{QPb:!1,qP:!1,Cbc:!0,Bbc:!0,pP:!0})),da=[ni.DocumentTypeLabel.ManualsAndGuidelines,ni.DocumentTypeLabel.ArticlesAndReports,ni.DocumentTypeLabel.DocumentsDesignedForPrinting,ni.DocumentTypeLabel.Forms,ni.DocumentTypeLabel.JobDescription,ni.DocumentTypeLabel.ListsAndNotes,ni.DocumentTypeLabel.Plans],Ea=new Pd.a(()=>new Az(9,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").J8,
this.container.resolve("WordEditor.Designer.DocumentTypeEventSource"),Cb.a.ahf,da)),ib=new Pd.a(()=>new xm(this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").q7b,this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iOb,this.container.resolve("WordEditor.Designer.DocumentInfo"),this.jb.rc,this.container.resolve("Box4.ISelectionManager"),this.container.resolve("Box4.IParagraphIteratorFactory"))),Qb=new Pd.a(()=>new bo(this.container.resolve("WordEditor.Designer.Settings.IDesignerSettingsManager"))),
pc=new Pd.a(()=>{const ae=new U.a;ae.add(d.value);ae.add(A.value);ae.add(m.value);ae.add(Qb.value);ae.add(R.value);ae.add(Ea.value);ae.add(ib.value);return ae}),Pc=new Pd.a(()=>new Dn(this.container.resolve("WordEditor.Designer.IDesignerTaskPane"),this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerEngagement"))),gd=new Pd.a(()=>new pp(9,pc.value,Pc.value)),Cd=new Pd.a(()=>{const ae=[];ae.push(gd.value);return ae});this.container.ia("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager",
()=>new tt(Cd.value,this.container.resolve("WordEditor.Designer.Style.PullQuotesManager"),this.container.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").iOb,this.container.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),this.container.resolve("WordEditor.Designer.Review.IReviewManager"),this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.container.Sa("Common.ISystemInitiatedFeedback"),this.container.resolve("WordEditor.Designer.IDesignerControl"))).ha()}NCj(){const d=
sf.StaticActiveAppFrame.za().jb.rc;(null===d||void 0===d?0:d.Es)||v.ULS.sendTraceTag(529268809,3016,10,"AutoScroller not defined");return null===d||void 0===d?void 0:d.Es}xn(){this.Zd.NJ()?this.KH.pk(16,()=>{this.YUc()}):this.YUc()}YUc(){Vb(Cb.a.e2i);this.Zd.isEnabled()!==lw.a.zec()&&v.ULS.shipAssertTag(541169756,3016,!1,`${this.Zd.isEnabled()}, ${lw.a.zec()}`);this.Zd.isEnabled()&&(this.jb.Cxa?this.JVc():this.jb.vga(this.pka))}M7l(){const d="WordEditor.Designer.License.ILicenseManager WordEditor.Designer.Style.IDocumentLanguageManager WordEditor.Designer.Errors.IErrorStateManager WordEditor.Designer.Pane.IPaneLoadingManager WordEditor.Designer.Settings.IDesignerSettingsManager WordEditor.Designer.AL.IWorkflowManager WordEditor.Designer.OnCanvas.OnCanvasInitializer WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager".split(" ");
this.container.ia("WordEditor.Designer.OnCanvas.OnCanvasInitializer",()=>new Gz(this.container.resolve("Box4.Indicator.IIndicatorManager"),this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.Designer.OnCanvas.HighlightActor"),this.container.resolve("WordEditor.Designer.OnCanvas.IBlueDotActor"),this.container.resolve("WordEditor.Designer.OnCanvas.ReviewSelectionManager"),this.container.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.container.resolve("Box4.IParagraphReader"),
this.container.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();this.Zd.JLm()&&d.push("WordEditor.Designer.FRE.IFirstRunExperienceManager");this.Zd.UZd()&&!this.Zd.Pqb()&&d.push("WordEditor.Designer.ContextualSuggestions.ConsistencySuggestionsTriggerManager");this.Zd.Kgg()&&(d.push("WordEditor.Designer.Proactive.ProactiveTriggerInitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerInitializer",()=>new Vs(this.container.resolve("WordEditor.Designer.Proactive.IUserEngagementMonitor"),
this.container.resolve("WordEditor.ProactiveUxGovernance.IProactiveUxManager"),this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());this.Zd.Z_d()&&d.push("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManagerCommercial");this.Zd.VBi()&&d.push("WordEditor.Designer.ProactiveV2.ProactiveTriggerManagerV2");this.Zd.txi()&&d.push("WordEditor.Designer.ContextualSuggestions.ImageSuggestionTriggerManager");this.Zd.OEf()&&d.push("WordEditor.Designer.ContextualSuggestions.HeadingsImageSuggestionTriggerManager");
this.Zd.bCi()&&d.push("WordEditor.Designer.ContextualSuggestions.PullQuotesTriggerManager");this.Zd.Pqb()&&d.push("WordEditor.Designer.SmartPaste.SmartPasteManager");this.Zd.kJf()&&d.push("WordEditor.Designer.UserIntentDialog.UserIntentDialogTriggerManager");this.Zd.e_d()&&d.push("WordEditor.Designer.DocumentStatsDnmLogger");return d}N7l(){const d=["WordEditor.Designer.Wire.IDesignerPropsUpdater","WordEditor.Designer.Trackers.IDesignerUndoTracker","WordEditor.Designer.Logging.IDocumentRoleDetectionLogger",
"WordEditor.Designer.Logging.IConsistencyFixActionsLogger","WordEditor.Designer.Logging.IBlankDocumentLogger"];this.Zd.pZd()&&d.push("WordEditor.Designer.Style.ITableManager");return d}L7l(){const d=["WordEditor.Designer.Style.IThemeGenerator"];this.Zd.Kgg()&&(d.push("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer"),this.container.ia("WordEditor.Designer.Proactive.ProactiveTriggerDeinitializer",()=>new Go(this.container.resolve("WordEditor.ConditionalTriggering.TriggerModels.IProactiveTriggerManager"))).ha());
return d}JVc(){const d=this.container.resolve("WordEditor.Designer.Perf.IPerfLogger");d.ie(()=>{const m=new Map;m.set(0,this.M7l());m.set(2,this.N7l());m.set(1,this.L7l());m.set(3,[]);const A=[this.container.resolve("WordEditor.Designer.Actors.DesignerActor"),this.container.resolve("WordEditor.Designer.Actors.DesignerActionActor")];this.Zd.Pqb()&&A.push(this.container.resolve("WordEditor.Designer.Actors.DesignerPasteActor"));this.Oml.lal(this.container,m,A,d,this.container.resolve("WordEditor.Designer.IDesignerTaskPaneEventsInternal")).boot()},
"WD:II")}}Object(y.a)(Gr,"DesignerPackageManager",null,[1,2]);var GA=c(975),HB=c(1844),ps=c(957),Mv=c(932),hi=c(471),Nv=c(855),ft=c(510);class ay{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg){this.BSe=()=>{setTimeout(()=>{this.b3g&&Object(hi.o)("SelectionPointerUp")},100);return!0};this.ycg=Xh=>{Xh&&Xh.Hb.keyCode===Wj.a.msb?this.fYa.flag&&(Object(hi.o)("FocusOnInputNotif"),this.fYa.flag=!1):Xh&&Xh.Hb.keyCode===Wj.a.l2&&Object(hi.o)("FocusOutOfEditor");return!0};this.FXe=(Xh,Fl)=>
{Xh=Xh.getByTag(Fl);const Gm=[];for(let em=0;em<Xh.length();em++){const $n=Xh._GetItem(em);Gm.push($n.id)}this.iMa.set(Fl,Gm)};this.VZ=m;this.zD=A;this.mua=gd;this.hb=Xe;this.gj=Be;this.hd=R;this.$c=da;this.Vj=Ea;this.Ce=ib;this.w3=Qb;this.qba=pc;this.Vn=Pc;this.ofa=Cd;this.m_=[];this.UCc=[];this.cGe=this.WWb=this.xUg=this.txc=this.kZg=this.$La=this.b3g=!1;this.fYa={flag:!1};this.e0b=[];this.oih=[];this.iMa=new Map;this.ZWb=new Map;this.YWb=new Map;this.Ig=ae;this.aNa=Xd;this.gb=se;this.ga=Hg;this.dTc=
this.dTc.bind(this);this.oge=this.oge.bind(this);this.Apg=this.Apg.bind(this);this.JQl();this.odm();this.zeo();this._frame=n.AFrameworkApplication.ta;this.gj.mode=0;this.ofa.bfb(this.oge);this.hb.Xw(this.dTc);this._frame&&(this._frame.oD.ob(ea.a.zh,this._frame.get_element(),hi.s),this._frame.oD.ob(ea.a.SBb,this._frame.get_element(),this.BSe));Object(hi.k)()&&this.ga.qa(Ac.a.Ati,K.a.frame,this.nFm.bind(this));n.AFrameworkApplication.k0e(this.mni)}JQl(){Object(hi.o)("GetCAAEPlaceholders",JSON.stringify({["sessionId"]:n.AFrameworkApplication.userSessionId}))}nFm(d,
m,A){2===A&&Object(hi.o)("InsertSnippetPanel");return 32}odm(){Object(hi.o)("GetSPOReflowFlag")}CVo(d,m,A){(d=d.getByTag(A).getFirst())&&0<=m?(this.$La=!0,Object(Nv.g)(m,d)):this.$La=!1}zeo(){Object(hi.o)("DocumentGenLoaded")}mni(d,m){Object(hi.o)("SendWordErrorDetails",JSON.stringify(m))}oge(){let d=new ps.a("CAAEMessage");d.SendTime=Date.now();d=Object(hi.n)(d,JSON.stringify({editHappened:!0}),"EditHappenedInDocument");window.parent.postMessage(JSON.stringify(d),this.mua)}Oeo(){const d=this.VZ.create().body.getHtml();
Object(hi.o)("HtmlForDocument",d)}Hfo(){const d=this.VZ.create().body.text;Object(hi.o)("DocTextForSuggestions",d)}efo(){const d=this.VZ.create(),m=[];if(d.body.paragraphs)for(let A=0;A<d.body.paragraphs.length();A++)d.body.paragraphs._GetItem(A).text&&m.push(d.body.paragraphs._GetItem(A).text);Object(hi.o)("DocTextForRePrompt",JSON.stringify(m))}ifo(){const d=this.VZ.create().body.contentControls,m=[];[...this.ZWb.values()].forEach(A=>{const R=d.getByTag(A.tagId),da=[];for(let Ea=0;Ea<R.length();Ea++)da.push(R._GetItem(Ea).id);
da&&da.length&&m.push({...A,Agp:da})});Object(hi.o)("SendPlaceholderSuggestions",JSON.stringify(m))}dTc(){if(!this.txc){var d=this.VZ.create(),m=new ps.a("CAAEMessage");m.SendTime=Date.now();var A=d.iem();if("NoSelection"!==A)if("TextBoxSelection"===A)m.Values.payload="TextBoxSelection",m.Values.Action="UnSuccessfulSelectionV2",window.parent.postMessage(JSON.stringify(m),this.mua);else{A=d.getSelection();var R=A.contentControls,da=this.hb.ib.lb,Ea=da.length,ib=A.parentTableOrNullObject,Qb=this.hb.qg,
pc=da.Oe;if(!(l(da,A,R.length(),this.fYa,m,this.mua,void 0,this.WWb)||null!==Qb&&Object(Nv.a)(Qb,pc,R.length(),m,A,this.mua,this.hb.ib,ib,this.$La,this.$c,this.fYa,this.WWb)))if(ib=Object(hi.c)(da),1<Ea&&!this.WWb)m=Object(hi.m)(m,"MultipleContext"),window.parent.postMessage(JSON.stringify(m),this.mua);else if(Ea)if(Qb=this.$La?!0:""!==A.text&&A.wCf(!0),this.WWb)m=Object(hi.a)(m,da,ib,Qb,A.text,R,this.fYa),(d=this.wXg(A,d,da))&&"UnSuccessfulSelectionV2"!==m.Values.Action&&(m.Values.payload=d.Values.payload,
m.Values.Action=d.Values.Action),window.parent.postMessage(JSON.stringify(m),this.mua);else if(1==Ea){m=Object(hi.e)(m,ib,Qb,A.text,R.length(),this.fYa);if(d=this.wXg(A,d,da))m.Values.payload=d.Values.payload,m.Values.Action=d.Values.Action;window.parent.postMessage(JSON.stringify(m),this.mua)}}}}wXg(d,m,A){const R=new ps.a("CAAEMessage");if(0===d.text.length&&A.J(0).contextId===ic.a.Tc||1===d.text.length&&("\r"===d.text||"\n"===d.text))return R.Values.Action="EmptySelection",this.fYa.flag=!1,R.Values.payload=
this.UVg(m.body.contentControls),this.TVg(m.body.contentControls),R}S5j(d){const m=new ps.a("CAAEMessage");m.Values.Action="EmptySelection";this.fYa.flag=!1;m.Values.payload=this.UVg(d.body.contentControls);this.TVg(d.body.contentControls);return m}UVg(d){const m=new Set;this.m_.forEach(A=>{let R=d.getByTag(A);for(let da=0;da<R.length();da++){const Ea=R._GetItem(da);void 0!==Ea.Rvj&&""!==Ea.getRange(0).text||Ea.deleteContentControl(!0)}R=d.getByTag(A);0===R.length()&&m.add(A)});0!==m.size&&(this.m_=
this.m_.filter(A=>!m.has(A)));return Array.from(m)}TVg(d){const m=new Map;let A=!1;for(const [R,da]of this.iMa){const Ea=da.filter(ib=>null!==d.getByIdOrNullObject(ib));da.length!==Ea.length&&(A=!0);m.set(R,Ea)}A&&(this.iMa=m,Object(hi.v)(m))}Fed(d){return d&&d.title&&d.tag?!0:(v.ULS.sendTraceTag(541403280,2250,10,"Malformed CaaeMessagePlaceholder"),!1)}A3i(d){const m=new ps.a("CAAEMessage");m.Values.payload=d;m.SendTime=Date.now();window.parent.postMessage(JSON.stringify(m),this.mua)}XLh(d,m,A,R,
da){if(this.Fed(m)){var Ea=d.parentTableOrNullObject;const Qb=Object(Nv.e)(this.hb);var ib=!1;"Image"===A&&(ib=l(this.hb.ib.lb,d,d.contentControls.length(),this.fYa,void 0,void 0,!0,this.WWb));if(!ib&&Ea&&"Table"===A&&Qb)return A=Ea.getCell(0,0).body.getRange(2).insertContentControl(),A.text=" ",A.sP="Committed",A.title=m.title,A.appearance=2,A.tag=m.tag,this.m_.push(m.tag),!0;Ea=d.parentTableOrNullObject;if(!ib&&Ea&&"TableCell"===A){A=d.text.trim();ib=sc.a.Fmc(A);d.insertText(" ",4);A=d.getRange(2).insertContentControl();
for(Ea=0;Ea<ib.length;Ea++)0==Ea?A.insertText(ib[Ea],4):A.insertText(" "+ib[Ea],3);A.sP=R?"Committed":"Highlighted";1===ib.length&&""===ib[0]?A.insertText(" ",2):A.insertText("",2);d.insertText("",4)}else A=d.insertContentControl(),R?Object(hi.w)(A,"Committed"):Object(hi.w)(A,"Highlighted"),Object(hi.y)(A,2,"");A.title=m.title;A.appearance=2;A.tag=m.tag;this.m_.push(m.tag);da&&R&&(da.id=A.id);return!0}}Apg(d){const m=this.VZ.create().body.contentControls;d.map(A=>{A=m.getByTag(A);for(let R=0;R<A.length();R++){const da=
A._GetItem(R);da.appearance=2;da.insertText("",2);a(this.Ce,da,!0,this.cGe);Object(hi.w)(da,"Highlighted")}})}iul(d,m,A){if(this.Fed(m)&&(d=d.getByTag(m.tag),1<=d.length()))for(let R=0;R<d.length();R++){const da=d._GetItem(R);da.title=m.title;A&&(this.UCc=[],Object(hi.w)(da,"Highlighted"),da.insertText("",2))}}Bvm(d,m){if(this.kZg&&("hyperlink"===d.datatype||"email"===d.datatype)){let A=m.getRange(0).Xp.J(0);m.Of&&(A=jd.a.createTextRange(A.node,0,Qe.ParagraphReader.textLength(A.node)));this.zD.fF(A,
"email"===d.datatype?"mailto:"+d.title:d.title,!1)}}pDl(d,m){m.map(A=>{var R;const da=d.getByTag(A.tag);if(1<=da.length())for(let Ea=0;Ea<da.length();Ea++){const ib=da._GetItem(Ea);A.title&&(a(this.Ce,ib,"true"===(null===(R=A.title)||void 0===R?void 0:R.toLowerCase())?!1:!0,this.cGe),Object(hi.w)(ib,"Filled"))}})}gDl(d,m){m.map(A=>{const R=d.getByTag(A.tag);if(1<=R.length()){let da=!1;for(let Ea=0;Ea<R.length();Ea++){const ib=R._GetItem(Ea);A.title?ib.tag.endsWith("TableSelection")?da||(Object(Nv.c)(ib,
this.hd,this.Vj,this.w3,this.qba,this.Vn,this.zD,A.tableValues,A.tableValuesDataTypes),da=!0,Object(hi.w)(ib,"Filled"),ib.insertText("",2),Object(hi.o)("FilledValueContentControl","Updated value")):"string"===typeof A.title&&A.tag===ib.tag?(ib.tag.endsWith("ImageSelection")&&A.imageProperties&&A.imageProperties.imageUrl?(A.imageProperties={...A.imageProperties,altText:A.title},e(ib,A.imageProperties)):"RichMultiText"===A.datatype?(Object(hi.w)(ib,"Filled"),ib.insertHtml(A.title,4)):A.title!==ib.text&&
(Object(hi.w)(ib,"Filled"),ib.text=A.title,this.Bvm(A,ib)),Object(hi.o)("FilledValueContentControl","Updated value")):(Object(hi.w)(ib,"Filled"),Object(hi.o)("FilledValueContentControl")):(Object(hi.w)(ib,"Highlighted"),ib.insertText("",2))}}})}deleteContentControl(d,m){if(this.Fed(m)&&(d=d.getByTag(m.tag),1<=d.length())){for(let A=0;A<d.length();A++)d._GetItem(A).deleteContentControl(!0);this.m_=this.m_.filter(A=>A!==m.tag)}}Lll(){if(0<this.e0b.length){const d=this.VZ.create();for(let m=0;m<this.e0b.length;m++){const A=
d.contentControls.getByTag(this.e0b[m]);A&&A.length()&&A._GetItem(0).deleteContentControl(!0)}}}vco(d,m){this.Fed(m)&&(d=d.getByTag(m.tag),1<=d.length()&&(d=d._GetItem(0).Rvj,d=Pk.SelectionFactory.ne(d,0),sh.a.instance.Ac(d),Object(hi.o)("FilledValueContentControl","Updated value")))}ZWd(d,m,A,R){if(this.Fed(m))if(d=d.getByTag(m.tag),R){if(R=d.getByIdOrNullObject(R.id))"Hover"===A?Object(Nv.h)(R):"Highlight"===A&&Object(Nv.f)(R),R.insertText("",2)}else if(1<=d.length())for(R=0;R<d.length();R++)m=
d._GetItem(R),"Hover"===A?Object(Nv.h)(m):"Highlight"===A&&Object(Nv.f)(m),m.insertText("",2)}COo(d){let m=d.textOffset;var A=vg.a.zr();A=this.gb.$k(A);A=this.aNa.Nna(A,!1,!1);let R;do{const Ea=A.ex;if(Ea){var da=Qe.ParagraphReader.textLength(Ea);m>da?m=m-da-1:Qe.ParagraphReader.text(Ea).substring(m,m+d.length).toLowerCase()===d.name.toLowerCase()&&1<=m?(R=jd.a.createTextRange(Ea,m-1,m+d.name.length+1),this.eni(R,d)):(da=Qe.ParagraphReader.text(Ea).search(d.name),1<=da&&(R=jd.a.createTextRange(Ea,
da-1,da+d.name.length+1),this.eni(R,d)))}}while(A.h9()&&!R)}xvm(){this.ZWb.forEach(d=>{d.tagId&&(this.YWb.get(d.tagId).forEach(m=>{const A=new U.a;A.add(m);this.Ig.j1e(A);this.Ig.E_a(m,this.w3,void 0,!0)||(m=this.Ig.E_a(m,this.w3),Object(hi.w)(m,"Highlighted"),Object(hi.y)(m,2,""),m.title=d.name,m.appearance=2,m.tag=d.tagId)}),this.m_.push(d.tagId))})}eni(d,m){if(this.ZWb.has(m.name)){if({tagId:m}=this.ZWb.get(m.name),m&&this.YWb.has(m)){var A=this.YWb.get(m);A.push(d);this.YWb.delete(m);this.YWb.set(m,
A)}}else A=Math.floor(1E6*Math.random()+1).toString(),this.ZWb.set(m.name,{...m,tagId:A}),this.YWb.set(A,[d])}Ly(d){const m=this.VZ.create();var A=m.body.contentControls,R={id:void 0};switch(d.Values.Action){case "RemoveContentControlAck":A=this.S5j(m);window.parent.postMessage(JSON.stringify(A),this.mua);break;case "CreateContentControlForTableCell":var da=m.getSelection();A=d.Values.Placeholder;var Ea="PlaceholderV2"===d.Values.type;d=d.Values.source;this.$La=!0;this.txc=Ea;this.XLh(da,A,"TableCell",
Ea,R);this.hb.Ac(Em.SelectionEditor.Jj(this.hb.ib.lb,!1,!0,void 0,!1));this.$La=this.txc=!1;Ea&&(da=this.VZ.create().body.contentControls,void 0===d||"Panel"===d?Object(hi.h)(da,A,R.id):"PlaceholderCard"===d&&Object(hi.q)(da,A),this.FXe(da,A.tag));break;case "UpdateTableColumnHighlight":R=d.Values.MessageContent;d=d.Values.Placeholder;d.tag.endsWith("TableSelection")&&this.CVo(A,R,d.tag);break;case "GetTableColumnDetails":d=d.Values.Placeholder;d.tag.endsWith("TableSelection")&&Object(Nv.d)(A,d.tag);
break;case "FetchSelection":A=d.Values.Placeholder;d=this.VZ.create().body.contentControls;Object(hi.h)(d,A,void 0);break;case "CreateContentControl":Ea=m.getSelection();A=d.Values.Placeholder;da=d.Values.source;this.txc=d="PlaceholderV2"===d.Values.type;var ib=Object(hi.g)(A.tag);Ea=this.XLh(Ea,A,ib,d,R);this.$La=!0;Ea&&this.hb.Ac(Em.SelectionEditor.Jj(this.hb.ib.lb,!0,!1,void 0,!0));this.$La=this.txc=!1;d&&(d=this.VZ.create().body.contentControls,void 0===da||"Panel"===da?Object(hi.h)(d,A,R.id):
"PlaceholderCard"===da&&Object(hi.q)(d,A),this.FXe(d,A.tag));break;case "CancelWACContentControlCreation":this.$La=!0;this.hb.Ac(Em.SelectionEditor.Jj(this.hb.ib.lb,!0,!1,void 0,!0));this.$La=!1;break;case "EditContentControl":this.iul(A,d.Values.Placeholder,d.Values.type);break;case "FillConditionalAnswers":this.pDl(A,d.Values.Placeholder);break;case "FillValueForContentControl":this.gDl(A,d.Values.Placeholder);break;case "DeleteContentControl":d=d.Values.Placeholder;this.deleteContentControl(A,
d);this.iMa.delete(d.tag);break;case "RemoveSelections":R="AllCommited"===d.Values.type;da="All"===d.Values.type;const Qb=d.Values.Placeholder;if("Single"===d.Values.type&&d.Values.MessageContent){const pc=Object(hi.f)(JSON.parse(d.Values.MessageContent));this.m_=Object(hi.p)(Qb,A,this.m_,this.UCc,void 0,pc);0===A.getByTag(Qb.tag).length()?this.m_=this.m_.filter(Pc=>Pc!==Qb.tag):(A=this.iMa.get(pc.tag))&&this.iMa.set(pc.tag,A.filter(Pc=>Pc!=pc.id))}else R?(this.m_=(d=d.Values.PreviousPlaceholderTag)?
Object(hi.p)(Qb,A,this.m_,this.UCc,"Committed",void 0,d):Object(hi.p)(Qb,A,this.m_,this.UCc,"Committed",void 0),A=this.VZ.create().body.contentControls,d&&this.iMa.delete(Qb.tag),this.FXe(A,d?d:Qb.tag),Object(hi.u)(d?d:Qb.tag,this.iMa.get(d?d:Qb.tag))):da&&(this.m_=Object(hi.p)(Qb,A,this.m_,this.UCc,void 0,void 0),this.iMa.delete(Qb.tag));break;case "GetHTML":this.A3i(m.getSelection().getHtml());break;case "GetSelectedText":this.A3i(m.getSelection().text);break;case "ScrollToContentControl":d=d.Values.Placeholder;
this.xUg&&this.vco(A,d);break;case "HighlightHoveredContentControl":R=d.Values.Placeholder;(d=d.Values.MessageContent)?(d=Object(hi.f)(JSON.parse(d)),this.ZWd(A,R,"Hover",d)):this.ZWd(A,R,"Hover");break;case "UnhighlightHoveredContentControl":R=d.Values.Placeholder;(d=d.Values.MessageContent)?(d=Object(hi.f)(JSON.parse(d)),this.ZWd(A,R,"Highlight",d)):this.ZWd(A,R,"Highlight");break;case "PublishSaveTemplate":Oi.a.mR(de.a.closeDocument,!1,pc=>{pc={["data"]:pc,["sessionId"]:n.AFrameworkApplication.userSessionId,
["sortedPlaceholderTags"]:m.body.contentControls.getContentControls().map(Pc=>Pc.tag)};Object(hi.o)("ReceiveSuccessPublishSaveTemplate",JSON.stringify(pc))},(pc,Pc)=>{Object(hi.o)("ReceiveFailurePublishSaveTemplate",JSON.stringify({["data"]:pc,["statusCode"]:ft.a[Pc],["sessionId"]:n.AFrameworkApplication.userSessionId}))},null);break;case "SendPlaceholderCCDetails":R=d.Values.MessageContent;this.xUg=d.Values.isScrollDocEnabled;this.kZg=d.Values.highlightHyperlinkAndEmail;this.WWb=d.Values.isConditionalFieldsEnabled;
this.cGe=d.Values.isDocGenLoaded;(this.m_=R)&&0<R.length&&this.Apg(R);Object(hi.o)("EditFlowContentControlsLoaded",JSON.stringify({["sessionId"]:n.AFrameworkApplication.userSessionId}));d=new Map;this._frame&&(this._frame.oD.uc(ea.a.zh,this._frame.get_element(),hi.s),this._frame.oD.ob(ea.a.zh,this._frame.get_element(),this.ycg));for(da=0;da<R.length;da++){Ea=A.getByTag(R[da]);ib=[];for(let pc=0;pc<Ea.length();pc++)ib.push(Ea._GetItem(pc).id);d.set(R[da],ib)}this.iMa=new Map(d);Object(hi.r)(d);break;
case "CloseTemplateStudio":this.hb.jZ(this.dTc);n.AFrameworkApplication.Z1n(this.mni);this._frame&&(this._frame.oD.uc(ea.a.zh,this._frame.get_element(),this.ycg),this._frame.oD.uc(ea.a.SBb,this._frame.get_element(),this.BSe));break;case "SendAckForDocGenLoaded":this.hb.jZ(this.dTc);this._frame&&(this._frame.oD.uc(ea.a.zh,this._frame.get_element(),this.ycg),this._frame.oD.uc(ea.a.SBb,this._frame.get_element(),this.BSe),this._frame.oD.ob(ea.a.zh,this._frame.get_element(),hi.t));break;case "SPOInReflowMode":this.b3g=
d.Values.MessageContent;break;case "DisableEditDocCheck":this.ofa.j7c(this.oge);break;case "AddContentToDocument":this.VZ.create().body.insertHtml(d.Values.Content,4);this.e0b=d.Values.ContentControlIds;this.oih=d.Values.BreaksCount;Object(hi.o)("UpdatedContent");break;case "ReceivedUpdatedContent":A=this.VZ.create();for(d=0;d<this.e0b.length;d++)for(R=0;R<this.oih[d];R++)A.body.paragraphs._GetItem(d+R).text.length&&(da=A.body.paragraphs._GetItem(d+R).insertContentControl(),da.tag=this.e0b[d],da.appearance=
2);break;case "DeleteSectionFromTemplate":A=this.VZ.create().contentControls.getByTag(d.Values.ContentControlId);for(d=0;d<A.length();d++)A._GetItem(d).deleteContentControl(!1);break;case "EditSectionInTemplate":A=this.VZ.create();R=d.Values.ContentControlId;da=A.contentControls.getByTag(R);for(Ea=1;Ea<da.length();Ea++)da._GetItem(Ea).deleteContentControl(!1);A.contentControls.getByTag(R)._GetItem(0).text=d.Values.NewSectionText;break;case "GetHtmlForDocument":this.Oeo();break;case "GetDocTextForSuggestions":this.Lll();
this.Hfo();break;case "GetDocTextForRePrompt":this.efo();break;case "GetSuggestionsForFields":A=d.Values.MessageContent;this.ZWb=new Map;if(A&&0<A.length)for(d=0;d<A.length;d++)this.COo(A[d]);this.xvm();this.ifo()}}}Object(y.a)(ay,"CaaeMessageHandler",null,[892]);class Pz{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg){this.Jma=null;this.Qq=d;this.Gnd=m;this.IYj=new ay(this,A,R,da,Ea,ib,Qb,pc,Pc,gd,m,Cd,ae,Xd,se,Xe,Be,Hg);this.Qq.yba(Mv.a.eWh);this.Qq.yba(Mv.a.bWh);this.Gnd!==GA.a.jfb&&
(this.Qq.yba(this.Gnd),this.aq("CAAEMessage",this.IYj))}aq(d,m){v.ULS.sendTraceTag(541405831,2250,50,"Attempting to register a handler for MessageTypeId [{0}].",d);if(d&&""!==d)if("CAAEMessage"!==d)v.ULS.sendTraceTag(540357400,2250,10,"Attempted to register MessageTypeId other than CAAEMessage");else if(m){var A=!1;this.Qq.isEnabled()&&(this.Qq.Gv(d),A=this.Qq.eC(d,m.Ly.bind(m)));A||v.ULS.sendTraceTag(541405834,2250,10,"Failed to register Messenger handler for MessageTypeId [{0}].",d)}else v.ULS.sendTraceTag(541405833,
2250,10,"Attempted to register null IIncomingMessageHandler.");else v.ULS.sendTraceTag(541405832,2250,10,"Attempted to register null or empty MessageTypeId.")}sendMessage(d,m){if(this.Jma){var A=this.Jma.src;this.Qq.t0d(A)?Array.contains(Mv.a.fDd,d)?this.Qq.vUa(Object.assign(new ps.a,{MessageId:d,SendTime:Date.now(),Values:{["Payload"]:m}}),this.Jma.contentWindow,E.a.getOrigin(A))||v.ULS.sendTraceTag(541405838,2250,10,"Failed to send a message with MessageTypeId [{0}].",d):v.ULS.sendTraceTag(541405837,
2250,10,"Attempted to send a message with unsupported MessageTypeId [{0}].",d):v.ULS.sendTraceTag(541405836,2250,10,"Attempted to send a message to origin that's not allowed.")}else v.ULS.sendTraceTag(541405835,2250,10,"Attempted to send a message with undefined target iframe element and MessageTypeId [{0}].",d)}}Object(y.a)(Pz,"DocumentAssemblyMessenger",null,[873]);var IB=c(1393),En=c(1500),by=c(2069);class qs{constructor(d,m,A,R,da,Ea){this.qJh=this.sJh=null;this.ps=d;this.pJh=m;this.V5k=A;this.W5k=
R;this.sJh=da;this.qJh=Ea}}Object(y.a)(qs,"ContentAssemblyHighlightContext",null,[]);class Ry extends En.a{constructor(d,m,A,R){super();this.A_j=40;this.yBc="px";this.fue="aria-label";this.X5k="Field_20";this.gb=d;this.ig=m;this.yW=A;(this.hA=R)&&this.hA.wCd(this.aC.bind(this))}$0a(d){const m=[],A=d.m0a(0,this.A_j,this.zoom);m.push(this.Mna(d.y5,A,d.Bpc[0].y-d.M4[0].y));return m}Mna(d,m,A){const R=d.Ag.ownerDocument,da=Hm.a.createElement(R,Rm.a.div);da.className=Ry.z_j;da.style.left=m+this.yBc;da.style.top=
A+this.yBc;m=Hm.a.createElement(R,Rm.a.div);Xa.a("renderIcon")&&appChrome.api.renderIcon(this.X5k,m);m.setAttribute("role","img");m.setAttribute("alt","Conditional section");m.title="Conditional section";m.setAttribute(this.fue,"Conditional section");da.appendChild(m);d={context:new qs([],da,new Set,new Set,null,null),gVf:d,container:da};this.ig.oE(ea.a.click,da,this.HHa.bind(this),d);return da}n8a(d){d=this.gb.$k(d.Cb);return Object(hi.d)(d,!1,d.bF)}GGd(){const d=Object.assign(new by.a,{action:1,
type:7,HA:null,WJ:this.efa});this.efa=null;this.yW.KF(d)}aC(d,m){this.efa&&!m.U1a.yf.classList.contains(hi.j)&&this.GGd()}HHa(d){if(!d)return!1;let m=d.Vo.context;if(Ry.Z4a(m,this.efa))return!0;m=this.Irf(d.Vo.gVf,m,d.Vo.container);d=Object.assign(new by.a,{action:0,type:7,HA:m,WJ:this.efa});this.efa=m;this.yW.KF(d);return!0}Irf(d,m,A){m={rJh:new Set,mNb:new Set,tJh:null,U$e:null};const R=this.gb.yw(d.Cb,!0,!1),da=[];if(R)for(const Ea of R)da.push(Ea);this.Auk(d,m,da);return m=new qs(da,A,m.rJh,m.mNb,
m.tJh,m.U$e)}Auk(d,m,A){if(d.gk){var R=new Set;for(const Ea of d.Xg.ij)Ea.querySelectorAll("*").forEach(R.add,R);d=Array.from(R.values())}else d=Array.prototype.slice.call(d.htmlElement.querySelectorAll("*"),0);let da=[];m.mNb.add(A[0].id);m.tJh=A[0].id;m.U$e=A[0].id;d.forEach(Ea=>{const ib=Sr.a.Eb(Ea,"CaaeContentControlStartGuids");if(ib)for(const Qb of ib)da.push(Qb),m.rJh.add(Qb);if(!da.length)return!0;Ea=Sr.a.Eb(Ea,"CaaeContentControlEndGuids");if(!Ea)return!0;da=IB.a.xjc(da,Ea)});for(R=d=this.gb.Wf(A[A.length-
1],!1,!0);da.length&&d;){m.mNb.add(d.id);m.U$e=d.id;A.push(d);for(const Ea of R.mH)Ea.htmlElement.querySelectorAll(".CaaeContentControlEnd").forEach(ib=>{(ib=Sr.a.Eb(ib,"CaaeContentControlEndGuids"))&&(da=IB.a.xjc(da,ib))});R=d=this.gb.Wf(d,!1,!0)}}static Z4a(d,m){return!!m&&!!d&&d.pJh===m.pJh}}Ry.z_j="WordBookmarkSvgIndicatorContainer";Object(y.a)(Ry,"ContentAssemblyIndicatorActor",En.a,[609]);class Eo extends av.a{constructor(){super()}get Oca(){return!0}get qkb(){return 7}get J3a(){if(null!=this.h3)return this.h3;
this.h3=[];this.h3.push(new hx.a(hi.j,hi.j));return this.h3}QHa(d,m){var A;if(this.Oca){var R=this.Cr.tEa,da=this.Cr.FZc,Ea=d.bF;if(R&&7===R.type){da=m.nIa("*");const ib=R.HA;if(null===(A=R.WJ)||void 0===A?0:A.ps.includes(d))for(const Qb of da)this.Cr.UTa(Qb);Ea&&Object(hi.d)(d,!0,Ea)&&this.ooj(Ea,hi.j,!1);ib&&ib.ps.includes(d)&&this.gqb(m,R.action,ib,d,da,Ea)}else R&&da&&7===da.type&&3===R.action&&da.HA.ps.includes(d)&&(A=m.nIa("*"),this.gqb(m,0,da.HA,d,A,Ea))}}aSa(d){return d instanceof qs}d3a(d,
m){if(d)for(const A of d.ps)m.add(A)}ooj(d,m,A){d=d.qe(pg.InteractiveViewManager.instance.yd.$b).htmlElement.querySelectorAll("table");0!==d.length&&(A?d[0].classList.add(m):d[0].classList.remove(m))}gqb(d,m,A,R,da,Ea){if(0===m&&d.htmlElement)if(Ea)this.ooj(Ea,hi.j,!0);else{d=da.length;var ib=R.id===A.sJh,Qb=R.id===A.qJh;m=Array(d);var pc=[],Pc=0;Ea=!1;for(let Cd=0;Cd<d;Cd++){const ae=da[Cd];var gd=uu.a(ae);m[Cd]=gd;gd=ae.classList;if(0!=m[Cd]){const Xd=!gd.contains(Do.a.FG),se=Sr.a.Eb(ae,"CaaeContentControlEndGuids");
se&&pc.push(...se);if(ib){let Xe;if(Xe=Sr.a.Eb(ae,"CaaeContentControlStartGuids"))Pc+=Xe.length,gd.add(hi.j);if(se)for(const Be of se)this.EKm(A,Be)&&Pc--;0!==Pc&&Xd&&gd.add(hi.j)}ib||Qb||!A.W5k.has(R.id)||(Sr.a.Eb(ae,"CaaeContentControlEndGuids")&&Ea?gd.add(hi.j):Xd&&gd.add(hi.j))}Ea=!gd.contains(Do.a.M1a)}Ea=!1;if(Qb&&!ib)for(A=0;A<d;A++)R=da[A].classList,0!==m[A]&&!R.contains(Do.a.FG)&&Ea&&R.add(hi.j),Ea=!R.contains(Do.a.M1a)}}EKm(d,m){for(const A of d.V5k)if(m.equals(A))return!0;return!1}}Object(y.a)(Eo,
"ContentAssemblyHighlightActor",av.a,[617]);class HA{constructor(){this.W=null}get name(){return"WordEditor.DocumentAssemblyEditor"}wc(d){this.W=d;const m=n.AFrameworkApplication.QNb||GA.a.jfb;this.W.ia("WordEditor.DocumentAssemblyEditor.Messenger",()=>new Pz(new GA.a(null,null),m,this.W.resolve("WordEditor.Extension.DocumentFactory"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("WordEditor.Extension.IInsertApiOperations"),this.W.resolve("WordEditor.Extension.TableOperations"),this.W.resolve("WordEditor.IImageEditor"),
this.W.resolve("Box4.IFormattingEditor"),this.W.resolve("WordEditor.Extension.RequestContext"),this.W.resolve("WordEditor.Extension.TableCellFactory"),this.W.resolve("WordEditor.Extension.ParagraphFactory"),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.resolve("WordEditor.Extension.IContentControlOperations"),this.W.resolve("Box4.IParagraphIteratorFactory"),this.W.resolve("Box4.IParagraphReader"),sh.a.instance,HB.a.instance,n.AFrameworkApplication.va)).ha();this.W.ia("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor",
()=>new Ry(d.resolve("Box4.IParagraphReader"),ru.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),d.resolve("Box4.IInteractiveEventHandler"))).ha()}init(){this.W.resolve("WordEditor.DocumentAssemblyEditor.Messenger");n.AFrameworkApplication.pu&&(n.AFrameworkApplication.se("ccAnnotationsTreatment;ccAnnotationsControl"),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.contentControlAnnotations",!1)&&(this.W.resolve("Box4.Indicator.IIndicatorManager").RTa(this.W.resolve("WordEditor.DocumentAssemblyEditor.Actors.ContentAssemblyIndicatorActor")),
this.W.resolve("Box4.Highlight.IHighlightManager").j7a(new Eo)))}dispose(){}static main(){if(!n.AFrameworkApplication.eL&&n.AFrameworkApplication.pu){z.a.instance.Gc(new HA);const d=n.AFrameworkApplication.ta;d&&(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)&&"DocGen"!==n.AFrameworkApplication.pu&&"ContentAssemblyView"!==n.AFrameworkApplication.pu||!d.kra||d.kra.classList.add("HideRibbon"),d.zTc&&d.Mjg.classList.add("hidePanel"))}}}Object(y.a)(HA,
"DocumentAssemblyPackageManager",null,[1,2]);var Bj=c(874);class Ur extends Sys.EventArgs{constructor(d){super();this.Llb=d}}Object(y.a)(Ur,"LicenseStateChangeEventArgs",Sys.EventArgs,[]);class FC{constructor(d,m,A){this.dv=d;this.Ca=m;this.RJe=A;this.WKb=new Promise((R,da)=>{this.Vhk=R;this.nhk=da});this.tKl=R=>{if(R.featureName===Bj.a.Phf)switch(R.tierName){case 2:v.ULS.sendTraceTag(541332422,2250,50,"FreemiumCallback for {0} updated state to Premium",R.featureName);this.RJe.raiseEvent("OnLicenseStateChange",
new Ur(!0));this.dv.execute(da=>{da.yjc(R.featureName,this.rlk)});break;default:v.ULS.sendTraceTag(541332423,2250,10,"FreemiumCallback for {0} received with unexpected value {1}",R.featureName,R.tierName)}else v.ULS.sendTraceTag(541332424,2250,10,"FreemiumCallback received with unexpected FeatureName {0}",R.featureName)}}Vqh(d){this.RJe.addHandler("OnLicenseStateChange",d)}CAm(){this.byd=(d,m)=>{this.RJe.raiseEvent("OnLicenseStateChange",new Ur(2!==d));this.Vhk({mode:d,cZc:2!==d,Fmp:m})};this.r1j=
()=>{v.ULS.sendTraceTag(541131153,2250,50,"Disabling feature for reason: Tier name is basic");this.nhk("Tier name is basic")};this.dv.execute(d=>{d.getFeatureTier(Bj.a.Phf,0).then(m=>{const A=d.isFreemiumUpsellEnabled();if(32===this.ipm(m,A))v.ULS.sendTraceTag(541332419,2250,50,"WordEditor HandleEnableDisable Licensing completed successfully");else return d.isFeatureEnabled(Bj.a.Rhf,!0);return null}).then(m=>{null!==m&&(this.Fqm(m,d),v.ULS.sendTraceTag(541332420,2250,50,"WordEditor HandlePremium Licensing completed successfully"));
return null}).catch(m=>{v.ULS.sendTraceTag(541332421,2250,10,"Failed to initialize with licensing: Error {0}",m);m=d.isFreemiumUpsellEnabled();this.byd(1,m);return null})})}ipm(d,m){this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)&&(d=0);switch(d){case 2:return this.byd(0,m),32;case 1:return this.r1j(),32;default:return 2}}Fqm(d,m){const A=m.isFreemiumUpsellEnabled(),R=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",
!1);d&&!R?this.byd(1,A):(this.rlk=m.iza(Bj.a.Phf,this.tKl),this.byd(2,A||R))}}Object(y.a)(FC,"AddInLicensingManager",null,[874]);const gv=(d,m,A,R,da)=>{const Ea={state:3,daysRemaining:-1};d=Math.floor((+m-+d)/864E5);0>d?Ea.state=3:d>=A?(Ea.daysRemaining=A-d,Ea.state=d>A+30?2:5):(Ea.daysRemaining=A-d,Ea.state=1);if(2===Ea.state||5===Ea.state)Ea.state=R&&0<=da?0:Ea.state;return Ea};class Vr{constructor(d,m=null){this.Ca=d;this.xD=null!==m&&void 0!==m?m:()=>new Date}nKb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsWomppEnabled",
!1)}hpf(){const d=new Date(this.Ca.getStringFeatureGate("Microsoft.Office.WordOnline.FA000000029.WomppUntilDate","2021/12/1")),m=this.xD();return Math.floor((+d-+m)/864E5)}eMm(){const d=n.AFrameworkApplication.AHa;return d&&d.toLowerCase()===Vr.STj?!0:!1}}Vr.STj="tm67341774";Object(y.a)(Vr,"UpsellCampaignGate",null,[]);class Es{constructor(d){this.Ca=d}isEnabled(){const d=this.Ca.$("EditorBrowserExtensionPromo"),m=this.Ovl();return d||m}Ovl(){return"-4"===n.AFrameworkApplication.sessionStartInfoSettings.Ring}}
Object(y.a)(Es,"BxPromoGate",null,[]);class Sy{constructor(){this.isDismissed=this.isInstalled=!1}}Object(y.a)(Sy,"BxPromoSettings",null,[891]);class Zp extends cx.a{constructor(d,m,A,R,da){super(d,m,A,R,da);this.cwc="getEditorBxPromoSettings";this.W_b="saveEditorBxPromoSettings";this.iZb=Zp.ANj;this.bxb=["IsInstalled","IsDismissed"];this.J7="BX cross-promo";this.Idb=wn.a.Ohf}async Pko(){this.oi||(this.Eg.sendTraceTag(557183135,2250,15,"BX cross-promo settings null when setting isDismissed"),this.oi=
new Sy);this.oi.isDismissed=!0;await this.M8c()}get K6b(){return new Sy}K2b(){return["IsInstalled",this.oi.isInstalled,"IsDismissed",this.oi.isDismissed]}J2b(){return{["IsInstalled"]:this.qX(this.oi.isInstalled.toString()),["IsDismissed"]:this.qX(this.oi.isDismissed.toString())}}async W7c(d){const m=this.oi.isDismissed&&!d.isDismissed;this.oi.isDismissed=this.oi.isDismissed||d.isDismissed;this.oi.isInstalled=this.oi.isInstalled||d.isInstalled;return m}bLc(){return new Nx.a}W3c(d){const m=new Sy;m.isInstalled=
this.$7i(d.IsInstalled);m.isDismissed=this.$7i(d.IsDismissed);return m}}Zp.ANj="BxPromoSettingsChangedEvent";Object(y.a)(Zp,"BxPromoSettingsHandler",cx.a,[870,871,872]);const yw=[["363d7011-83dd-4cc0-bdec-ea4af4df4dbb",!1],["6d1d8c3d-62d5-45d1-b850-d8a98a24964b",!1]],GC=[["cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",!1],["f55d29d6-efd4-4a51-8a01-e0a7bd549073",!0],["c1ed6a31-f439-4115-8272-7bbd2f663a84",!0],["d124712e-74ac-43eb-9bb6-373b2398f448",!0],["ca649e0f-48de-4f54-b687-2bda07e40728",!0],["9e5c572b-ec30-4f6b-b75c-ad9e60efe95e",
!0],["12d7f72e-e53e-4b27-b1ed-4ee115f54994",!0],["f57c12d6-03e4-4f48-9b7b-f95802a6c669",!1],["25714ab1-190b-4ef3-8d3d-e45bfd591c45",!0],["708198dd-ecbf-44fb-a428-ff2bc10e4d17",!0],["0fc5f67a-9d4e-41de-a1c6-ebe9b8b9046c",!0],["6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",!0],["5d411ad2-a965-4c01-b425-ecce2b374dfa",!0],["e006985e-33eb-42e1-9196-1333c4ecad9c",!0],["e3391a10-ee05-41e7-984d-82e72981a099",!0],["520b6db9-9638-4266-aa31-dc2cadd19aa8",!0],["0124af9e-756d-4ab9-8cc6-d99a20c22897",!0],["b85a7205-ba3d-4afb-8187-86f8ea104c75",
!0],["0941dabb-e993-4a10-8a92-70a95ca5389d",!0],["7c2ff4d7-41a9-4310-949b-863a0dfa4257",!1],["0da5de95-d496-4d23-8f93-693ef6592ae6",!1],["04cc32b6-7af4-4778-8ce9-c32698169b6a",!0],["95647447-1670-4af1-868e-7266583f61ff",!0],["a7927082-e6bb-4061-a134-3051e5969222",!0],["c61cb624-820e-454a-b426-cdd4c0a7011b",!0],["26bdc172-02a8-4f0a-8ec0-6049906f1f7c",!0],["79dd443b-0b94-45a1-90ad-02807565324d",!1],["4ee98de6-ea40-48db-ae36-ca82fc8473f7",!0],["2948a1be-32f1-460e-84ef-8b89597af9f1",!0],["67718619-a6b1-43ec-af18-1c48bbc27acd",
!0],["a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",!0],["19c926ad-f32d-42f8-996f-853c3ba00ab5",!0],["5f1ea714-acc6-4b01-84d5-5a7666aa297b",!0],["296f8f65-02fb-45a7-b4ab-5dc137edc563",!0],["766428da-f41f-451d-818d-174eb99d84ba",!0],["8778ba37-ca99-4ab9-a964-55abd18f7eba",!0],["a44ac718-8213-42ff-87a5-1e5d6592c352",!1],["97e25aa1-c0cc-435f-adaa-e2d490553b6d",!0]],Qz=[["6d60d9da-9e38-4d1e-bfc5-05a04120eef9",!1],["63e72d3d-62d7-4e73-8d66-c137d8841121",!1],["27783a58-c44f-4778-9856-36d9eab63693",!1],["5cb7fc16-cd78-449c-86d9-5d047be21ac4",
!1],["79405b77-e475-4f04-ba37-a3e6be66d3f2",!0],["7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",!0],["ba48d6ad-df91-4420-b26f-31c07765842d",!0],["d7746119-e7e5-4e97-9979-bcd2114f9fe9",!1],["50d4e435-dd52-4c0d-bb7a-9bb1c154a148",!0],["ef92c613-9224-424f-b391-748476b011cb",!0],["9aabeae7-bda2-44a7-a7f1-9c3d9089191e",!0],["39e466f1-6ebd-4ada-a7db-e0cc74048f1e",!0],["55178e46-8927-4b63-b19e-7c6fb5f8929b",!0],["aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",!1],["8cf6f68e-f693-4e6f-b253-5092cd19b9e2",!0],["4f42f243-8cb5-4f1a-a5a6-58b60d303e02",
!0],["012a7c1a-292a-4e17-b126-00191939cc0d",!0],["6cb8eda6-6cac-443a-8e3a-0df80ba725f6",!0],["6dbfae4c-9818-4dec-a769-2595168927f2",!1],["02c15397-df70-4f00-aa4d-7269e6d4e712",!1],["bd326c9c-0e4a-4ddf-be36-1ef7bee200ca",!0],["49b2a4fe-b569-43fb-bb54-796eddc260b3",!0],["d1572a1d-58d1-443f-997e-2722cfc41afe",!0],["f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",!1],["64213f24-0943-4585-8dd4-ee4f26b47a37",!0],["413425d5-5a64-4ea6-84df-aae06c596439",!0],["a127d2c9-2faf-491b-8d6a-e9b027fec098",!0],["999cc56a-caa5-4889-829e-7e249688e1cf",
!0],["62540ee8-7f12-4c6e-be18-89268fa8a289",!1],["b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",!0],["c4301606-9bc2-4389-bb1a-c08370627172",!0],["75069b86-2fd8-4158-a9ab-2793fd1d6f8b",!0],["03522a58-4044-4bab-b796-0630ae2ad00a",!0],["9feebbfe-9e8d-4b59-8c7a-8b3c462d6697",!0],["e24fd819-cc17-4be9-afec-dd103055198e",!0],["72e604b0-a185-413b-bd45-ad555288c746",!1],["c1056d52-e69d-43a6-926c-662cb2228185",!0],["5b75d94a-856d-461b-9bb4-879f4502b4c3",!1],["6ae03cab-953e-4382-bd27-843c5d553b23",!1],["e8c121e0-1ecd-4e88-8694-2fb17acb519d",
!0],["f4aa4a0a-f81a-41ac-b710-de4a60b99282",!1],["ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",!0],["e805847a-9050-45de-b767-f48ed68ad848",!0],["d96e4e94-041b-4389-861d-3cd4556d55f6",!0],["84275a90-df79-4b9e-a208-9ec8b5e59622",!1],["faa8f367-32d3-44cc-8eda-6e1e9de23efc",!1],["c68edc3b-9340-4b68-9d18-268bb82e2d94",!0],["8caa3b8f-202e-4a32-91a8-320b5272777e",!0],["3f2eda01-e8a5-4ed9-9494-6de566bc5333",!1],["6a0e1c97-430e-4d83-889d-8c4fea315a83",!0],["aa78ec66-2078-42bf-84f5-c241eb53a531",!0],["fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",
!1],["2d08dbe8-c11b-4190-a428-9a2c0a37bd68",!0],["3fd9c226-3925-4855-ba1e-49eb9ee46d24",!0],["1c169b51-d9a5-4b69-9abc-2bcd5e9c5912",!0],["818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",!1],["79d4a5c7-11c0-4be1-8d3c-c322f9941323",!0],["b956d579-6d99-4278-8b7d-e281ab8c576b",!0],["55aa25a5-e28a-4f22-8410-34a4df965e30",!1],["d78a8ad6-bac7-47ff-8016-d75f7fcd8370",!0],["822bb35e-0608-466e-a771-a315fcf95821",!0],["0c576af1-54af-4acb-8065-4616bb73820d",!0],["e3994139-ff36-44da-ae72-500b70d9b80f",!0],["2700d569-bd6f-4806-9bf1-49abd64d9fd3",
!0],["3f2e6b47-fc23-4f99-ad25-1758e7f179b6",!0],["352579fc-6ae6-4eb1-8d3b-895ab239714e",!1],["985091e9-4b33-42f7-b2ff-191b03f2ba74",!0],["9d62fd01-8804-4485-a5f0-257131e4f6aa",!0],["e7c89ada-94b2-426a-b8ea-069712de5d9f",!1]];class zw{constructor(d,m,A){this.kma=d;this.dPe=m;this.Wsb=A;this.$Ya=new Map;this.j3g=this.p6g=this.qpd=!1;this.M0e=R=>{this.dPe.addHandler(zw.y2f,R)};this.B0o=(R,da)=>{R=!da.Llb;R!==this.qpd&&(this.qpd=R,this.kma.SCi()&&this.dPe.raiseEvent(zw.y2f))};this.CEf=(R,da,Ea)=>{if(!this.kma.PBi()&&
!this.kma.SCi())return!0;if(0===this.$Ya.size)return this.p6g||(ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:"Office.Word.Online.Ideas.PremiumPreviewCritiquesFilter.FilteringBeforeInitialization",dataFields:[]})),this.p6g=!0),!0;if(!this.qpd||"Spelling"===da||Ea&&-1===Ea.toLowerCase().search("en"))return!0;n.AFrameworkApplication.se("h03dh622;0g16j333");return this.j3g?!0:this.kma.PBi()?void 0!==this.$Ya.get(R)?!this.$Ya.get(R):!1:void 0!==this.$Ya.get(R)};this.isCritiqueTypeUnderPaywall=
(R,da,Ea)=>Ea&&-1===Ea.toLowerCase().search("en")?!1:void 0!==this.$Ya.get(R)?this.$Ya.get(R):!0}Jri(d,m=!1){this.qpd=!d.cZc;this.j3g=m;this.Wsb.Vqh(this.B0o);Qz.forEach(([A,R])=>this.$Ya.set(A,R));yw.forEach(([A,R])=>this.$Ya.set(A,R));this.kma.TUm()||GC.forEach(([A,R])=>this.$Ya.set(A,R));this.dPe.raiseEvent(zw.y2f)}}zw.y2f="PremiumPreviewFilterChangedEvent";Object(y.a)(zw,"PremiumPreviewCritiquesFilter",null,[869]);class Vt{constructor(){this.startDate=null;this.allPpTypes=this.currentPpType=this.acceptedSimilarityCitations=
this.acceptedTextPredictions=this.acceptedRefinements=this.acceptedSpellingAndGrammar=this.autoCorrectedErrors=this.totalDays=0}}Object(y.a)(Vt,"PremiumPreviewSettings",null,[891]);class Ov extends Vt{constructor(){super(...arguments);this.state=this.premiumSuggestionsCount=this.totalDays=this.daysRemaining=0;this.startDate=null;this.cardType=1}}Object(y.a)(Ov,"PremiumPreviewData",Vt,[]);var Fs=c(1161),Jx;(function(d){d[d.initial=0]="initial";d[d.inProgress=1]="inProgress";d[d.sAl=2]="expired";d[d.error=
3]="error";d[d.notInitialized=4]="notInitialized";d[d.gjp=5]="expiredWithMetrics";d[d.Ktp=6]="softPaywallInProgress"})(Jx||(Jx={}));Object(y.b)("PremiumPreviewState",Jx);var hv;(function(d){d[d.Ocp=1]="Regular";d[d.lep=2]="Wompp";d[d.rdp=4]="SoftPaywall"})(hv||(hv={}));Object(y.b)("PremiumPreviewType",hv);class zu{constructor(d,m,A,R,da,Ea,ib=null){this.k_b=d;this.Eeb=m;this.kma=A;this.xye=R;this.Eg=da;this.jCa=Ea;this.yye=!1;this.Nve=this.Eeb.nKb()?2:1;this.Wsn=(Qb,pc)=>{this.VUc(pc.settings)};this.xD=
ib?ib:()=>new Date;this.Xk=Object.assign(new Ov,{state:4});this.k_b.p0e(this.Wsn)}async start(d){const m=await this.K1l(),A=this.pfi(d);if(1===m.state&&2===m.currentPpType)this.Eg.sendTraceTag(545293637,2250,15,"User tried to enter WOMPP but already inProgress");else{switch(d){case 1:if(this.$1o(m,d)){this.Eg.sendTraceTag(545293638,2250,15,"Trying to start Premium Preview but already in PP.");return}this.k_b.Kej();break;case 2:if(1===m.state&&1===m.currentPpType){if(m.daysRemaining>A){this.Eg.sendTraceTag(545293639,
2250,15,"User tried to enter WOMPP but regular PP is longer.");return}}else this.k_b.Kej();break;default:this.Eg.sendTraceTag(545116506,2250,10,`Premium Preview started with type; ${hv[d]}`);return}this.setState(1,d);this.jCa.kqa(Ac.a.Cog,!0,null,null,null,null,[{...(new Ya.a),name:"ppType",string:hv[d]},{...(new Ya.a),name:"ppDuration",int64:A}])}}$1o(d,m){const A=d.allPpTypes,R=d.startDate;d=d.totalDays;return 1===m&&0===A?!!R&&!!d:0!==(A&m)}pfi(d){switch(d){case 1:return this.kma.cuf();case 2:return this.Eeb.hpf()}}K1l(){return new Promise(d=>
{if(this.yye&&4!==this.Xk.state)d(this.Xk);else{const m=(A,R)=>{4!==R.Xk.state&&(this.yye=!0,this.S2n(m),d(R.Xk))};this.gBb(m)}})}VUc(d){this.yye=!0;d?4===d.currentPpType?this.Xk={...(new Ov),cardType:4,state:6}:d.startDate||d.totalDays?(this.Xk={...gv(d.startDate,this.xD(),d.totalDays,this.Eeb.nKb(),this.Eeb.hpf()),...d,premiumSuggestionsCount:0,cardType:this.Nve},3===this.Xk.state&&this.Eg.sendTraceTag(559256014,2250,10,"Premium preview start date greater than current date"),1!==this.Xk.state||
2!==this.Xk.currentPpType||this.Eeb.nKb()||(this.Eg.sendTraceTag(540674119,2250,15,"Tried to start WOMPP but it is disabled. Defaulting to expired state."),this.Xk.state=2)):(this.Eg.sendTraceTag(559256013,2250,50,"Premium preview not yet started"),this.Xk=Object.assign(new Ov,{daysRemaining:this.kma.cuf(),state:0,totalDays:this.kma.cuf(),startDate:null,cardType:this.Nve})):(this.Eg.sendTraceTag(559256012,2250,15,"Trying to intialize premium preview data with null settings"),this.Xk=Object.assign(new Ov,
{state:3}));this.raiseEvent()}yio(d){this.Eg.sendTraceTag(559256015,2250,50,"Setting premium preview remaining days: {0}",d);this.Xk.daysRemaining=d;this.raiseEvent()}async Pgo(d){await this.k_b.mHo(d,this.Xk)}setState(d,m){this.Eg.sendTraceTag(559256016,2250,50,"Setting premium preview state: {0}",d);this.Xk||(this.Eg.sendTraceTag(559256017,2250,15,"Premium preview data null when setting state: {0}",d),this.Xk=new Ov,this.Xk.cardType=this.Nve);switch(d){case 1:const A=this.xD();this.k_b.Hoo(new Date(A.toUTCString()),
this.pfi(m),m);void 0!==m&&(this.Xk.allPpTypes|=m,this.Xk.currentPpType=m);break;case 0:this.Eg.sendTraceTag(559256019,2250,50,"Setting premium preview state to Initial from {0}",this.Xk.state),this.k_b.u7n(),this.raiseEvent()}this.Xk.state=d;this.raiseEvent()}raiseEvent(){this.jCa.kqa(Ac.a.UNb,!0,null,null,null,null,[{...(new Ya.a),name:"AllPpTypes",int64:this.Xk.allPpTypes},{...(new Ya.a),name:"CurrentPpType",string:hv[this.Xk.currentPpType]},{...(new Ya.a),name:"PremiumPreviewState",string:Jx[this.Xk.state]},
{...(new Ya.a),name:"DaysRemaining",int64:this.Xk.daysRemaining},{...(new Ya.a),name:"TotalDays",int64:this.Xk.totalDays},{...(new Ya.a),name:"PremiumSuggestionsCount",int64:this.Xk.premiumSuggestionsCount},{...(new Ya.a),name:"AcceptedRefinements",int64:this.Xk.acceptedRefinements},{...(new Ya.a),name:"AcceptedSimilarityCitations",int64:this.Xk.acceptedSimilarityCitations},{...(new Ya.a),name:"AcceptedSpellingAndGrammar",int64:this.Xk.acceptedSpellingAndGrammar},{...(new Ya.a),name:"AcceptedTextPredictions",
int64:this.Xk.acceptedTextPredictions},{...(new Ya.a),name:"AutoCorrectedErrors",int64:this.Xk.autoCorrectedErrors}]);this.xye.raiseEvent(zu.x2f,new Fs.a(this.Xk))}gBb(d){this.xye.addHandler(zu.x2f,d)}S2n(d){this.xye.removeHandler(zu.x2f,d)}}zu.x2f="PremiumPreviewDataChangedEvent";Object(y.a)(zu,"PremiumPreviewDataHandler",null,[]);class Kx{constructor(d,m){this.Ca=d;this.Wsb=m}cuf(){return this.Ca.getIntFeatureGate("Microsoft.Office.WordOnline.FA000000029.PremiumPreviewDuration",7)}async zHf(){if(!this.Ca.$("EditorPremiumPreviewEnabled"))return!1;
try{return!(await this.Wsb.WKb).cZc}catch(d){return!1}}oTm(){return this.Ca.$("EditorPremiumPreviewStateUpdateEnabled")}SCi(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.SelectedCritiquesDuringPremiumPreview",!1)}TUm(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.IsSelectedCritiquesDuringPremiumPReviewAcceptRateHigh",!1)}PBi(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.PremiumPreviewCritiquesFilterFixEnabled",
!1)}}Object(y.a)(Kx,"PremiumPreviewGate",null,[867]);const wB=new Map([["E_Refinements","acceptedRefinements"],["E_Similarity","acceptedSimilarityCitations"],["E_Spelling_Grammar","acceptedSpellingAndGrammar"],["E_TextPrediction","acceptedTextPredictions"],["E_AutoCorrect","autoCorrectedErrors"]]);class Li extends cx.a{constructor(d,m,A,R,da){super(d,m,A,R,da);this.cwc="getPremiumPreviewSettings";this.W_b="savePremiumPreviewSettings";this.iZb=Li.MGn;this.bxb="StartDate TotalDays AcceptedRefinements AcceptedSimilarity AcceptedSpellingAndGrammar AcceptedTextPrediction AutoCorrectErrors CurrentPpType AllPpTypes".split(" ");
this.J7="Premium preview";this.Idb=wn.a.Shf}async Hoo(d,m,A){this.oi||(this.Eg.sendTraceTag(559255966,2250,15,"Premium preview settings null when setting date and total days "),this.oi=new Vt);let R=this.oi.allPpTypes|A;this.oi.startDate&&this.oi.totalDays&&(R|=1);this.oi={...this.oi,startDate:d,totalDays:m,currentPpType:A,allPpTypes:R};await this.M8c()}async mHo(d,m){var A=await this.Dhi();A=this.TVi(A);for(const R of Ck.a.G7b)this.tUo(d,m,A,R);this.oi=A;this.Mhj(this.J2b())}Kej(){this.oi||(this.Eg.sendTraceTag(545338245,
2250,15,"Premium preview settings null when setting date and total days "),this.oi=new Vt);this.oi={...this.oi,acceptedRefinements:0,acceptedSimilarityCitations:0,acceptedSpellingAndGrammar:0,acceptedTextPredictions:0,autoCorrectedErrors:0}}tUo(d,m,A,R){const da=wB.get(R);m[da]=A[da]+=void 0==d.get(R)?0:d.get(R)}get K6b(){return new Vt}K2b(){return["StartDate",this.oi.startDate,"TotalDays",this.oi.totalDays,"AcceptedRefinements",this.oi.acceptedRefinements,"AcceptedSimilarity",this.oi.acceptedSimilarityCitations,
"AcceptedSpellingAndGrammar",this.oi.acceptedSpellingAndGrammar,"AcceptedTextPrediction",this.oi.acceptedTextPredictions,"AutoCorrectErrors",this.oi.autoCorrectedErrors,"CurrentPpType",this.oi.currentPpType,"AllPpTypes",this.oi.allPpTypes]}J2b(){var d=this.oi.startDate.toISOString();d=d.substring(0,d.indexOf("T"));return{["StartDate"]:this.qX(d),["TotalDays"]:this.qX(this.oi.totalDays.toString()),["AcceptedRefinements"]:this.qX(this.oi.acceptedRefinements.toString()),["AcceptedSimilarity"]:this.qX(this.oi.acceptedSimilarityCitations.toString()),
["AcceptedSpellingAndGrammar"]:this.qX(this.oi.acceptedSpellingAndGrammar.toString()),["AcceptedTextPrediction"]:this.qX(this.oi.acceptedTextPredictions.toString()),["AutoCorrectErrors"]:this.qX(this.oi.autoCorrectedErrors.toString()),["CurrentPpType"]:this.qX(this.oi.currentPpType.toString()),["AllPpTypes"]:this.qX(this.oi.allPpTypes.toString())}}async W7c(d){if(d.startDate!==this.oi.startDate||d.currentPpType!==this.oi.currentPpType)return!0;this.oi=d;return!1}bLc(){return new Nx.a}W3c(d){let m=
null;d.StartDate&&(m=this.c8i(d.StartDate));const A=this.e7a(d.TotalDays);return{startDate:m,totalDays:A,acceptedRefinements:this.e7a(d.AcceptedRefinements,!0),acceptedSimilarityCitations:this.e7a(d.AcceptedSimilarity,!0),acceptedSpellingAndGrammar:this.e7a(d.AcceptedSpellingAndGrammar,!0),acceptedTextPredictions:this.e7a(d.AcceptedTextPrediction,!0),autoCorrectedErrors:this.e7a(d.AutoCorrectErrors,!0),currentPpType:this.e7a(d.CurrentPpType,!0),allPpTypes:this.e7a(d.AllPpTypes,!0)}}}Li.MGn="PremiumPreviewSettingsChangedEvent";
Object(y.a)(Li,"PremiumPreviewSettingsHandler",cx.a,[866]);class zm{constructor(d,m,A,R,da,Ea=null){this.ga=d;this.Eg=m;this.kma=A;this.gNa=R;this.Eeb=da;this.VOg=!1;this.L2c=(ib,Qb)=>{if(!Qb||!Qb.Xk)this.Eg.sendTraceTag(559255960,2250,10,"PremiumPreviewStateUpdater: premium preview data is null");else if(Qb.Xk.state!==this.Xk.state||Qb.Xk.currentPpType!==this.Xk.currentPpType)this.Xk=Qb.Xk,this.ikj(this.Xk),this.dco()};this.tXk=()=>{if(1===this.Xk.state||5===this.Xk.state){const ib=gv(this.Xk.startDate,
this.xD(),this.Xk.totalDays,this.Eeb.nKb(),this.Eeb.hpf());this.Xk={...this.Xk,...ib};switch(this.Xk.state){case 2:case 5:this.Eg.sendTraceTag(559255963,2250,50,"Premium preview state check: preview expired");this.gNa.setState(this.Xk.state);break;case 3:this.Eg.sendTraceTag(559255964,2250,10,"Premium preview state check: start date greater than current date");this.gNa.setState(this.Xk.state);break;case 1:this.Eg.sendTraceTag(559255965,2250,50,"Premium preview state check: days remaining updated",
this.Xk.daysRemaining),this.gNa.yio(this.Xk.daysRemaining)}this.ikj(this.Xk)}};this.xD=Ea?Ea:()=>new Date;this.Xk=this.gNa.Xk;this.ECm()}ECm(){this.kma.oTm()?this.gNa.gBb(this.L2c):this.Eg.sendTraceTag(559255959,2250,10,"PremiumPreviewStateUpdater: premium preview update disabled")}ikj(d){this.Eg.sendTraceTag(559255961,2250,50,"Premium preview state change message sent");this.ga.Qb(Ac.a.UNb,2,d)}dco(){1!==this.Xk.state||this.VOg||(this.VOg=!0,window.setInterval(this.tXk,36E5),this.Eg.sendTraceTag(559255962,
2250,50,"Premium preview state check initiated"))}}Object(y.a)(zm,"PremiumPreviewStateUpdater",null,[]);class xs{constructor(d){this.Ca=d}Qyi(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.FreeUserExperienceEnabled",!1)}}Object(y.a)(xs,"SimulateFreeUserGate",null,[]);var fg=c(243),Wt=c(1771);class Rz{constructor(d,m,A,R){this.Je=d;this.Eg=m;this.dlk=A;this.nB=R}async initialize(){try{await this.nB.ll(),this.Je.ob(this,Wt.RoamingSettingAnnotation.getTypeName())}catch(d){this.Eg.sendTraceTag(0,
2250,10,"Soft Paywall annotation registration failed.",d)}}KB(d,m){m!==Wm.a.getTypeName()?this.Eg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings with wrong operation type",m):null!==d&&void 0!==d&&d.content&&fg.a.getTypeNameFor(d.content)===Wt.RoamingSettingAnnotation.getTypeName()?(m=d.content,m.settingValueJson?(d=JSON.parse(m.settingValueJson),this.dlk.updateAndPersistState(d),this.Eg.sendTraceTag(0,383,50,"SoftPaywall annotation initialized "+JSON.stringify(d))):this.Eg.sendTraceTag(0,
2250,10,"Handled Soft Paywall Roaming Settings annotation setting is invalid",d)):this.Eg.sendTraceTag(0,2250,10,"Handled Soft Paywall Roaming Settings annotation is invalid",d)}}Object(y.a)(Rz,"SoftPaywallAnnotationHandler",null,[55]);class gt{constructor(d,m,A,R){this.Chh=d;this.Dhh=m;this.jCa=A;this.Eg=R;this.initialCredits=20;this.isEnabled=!1;this.WTe=0}updateAndPersistState(d){this.softPaywallData=this.WEo(d)}get softPaywallData(){return{credits:this.credits,receivedCredits:this.receivedCredits,
receivedCreditsDate:this.receivedCreditsDate,isEnabled:this.isEnabled}}set softPaywallData(d){this.credits=d.credits;this.receivedCredits=d.receivedCredits;this.receivedCreditsDate=d.receivedCreditsDate}spendCredit(){0>=this.credits?this.Eg.sendTraceTag(512234826,2250,10,"Spend credits are called with no credits left",this.softPaywallData):(this.WTe++,this.credits--,this.Chh.Zjj(),this.jCa.kqa(Ac.a.VBo,!0,null,null,null,null,[{...(new Ya.a),name:"newData",string:JSON.stringify(this.softPaywallData)}]))}WEo(d){let m=
{...d},A=!1;this.Dhh.ruo(d)&&(m=this.r4n(d),A=!0);this.WTe&&(0<m.credits&&(m.credits--,A=!0),this.WTe--);A&&this.Chh.$fo(m);return m}r4n(d){const m={credits:this.initialCredits,receivedCredits:this.initialCredits,receivedCreditsDate:this.Dhh.Nuj(),isEnabled:this.isEnabled};this.jCa.kqa(Ac.a.y_o,!0,null,null,null,null,[{...(new Ya.a),name:"oldData",string:JSON.stringify(d)},{...(new Ya.a),name:"newData",int64:JSON.stringify(m)}]);return m}}Object(y.a)(gt,"SoftPaywallState",null,[]);class Aw{constructor(d,
m){this.Ca=d;this.Wsb=m}async isEnabled(){if(!this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1))return!1;try{return!(await this.Wsb.WKb).cZc}catch(d){return!1}}}Object(y.a)(Aw,"SoftPaywallGate",null,[864]);var Zq=c(372),nq=c(371);class lx{constructor(d,m,A,R){this.Je=d;this.Eg=m;this.nB=A;this.$V=R;this.qWj="SoftPaywall";this.Deh=10014}$fo(d){d=new Wt.RoamingSettingsWriteSignal({id:this.Deh,valueJson:JSON.stringify(d),settingType:Wt.RoamingSettingType.Dictionary});
const m=new Zq.a;m.body=d;d=Object.assign(new Wm.a,{parentPath:["Signal",Wt.RoamingSettingsWriteSignal.getTypeName()],items:[m]});this.aNd(d)}Zjj(){var d=new Wt.RoamingSettingsReadSignal({ids:[this.Deh]});const m=new Zq.a;m.body=d;d=Object.assign(new Wm.a,{parentPath:["Signal",Wt.RoamingSettingsReadSignal.getTypeName()],items:[m]});this.aNd(d)}async aNd(d){try{await this.nB.ll(),this.qZe(d)}catch(m){this.Eg.sendTraceTag(0,2250,10,"EnsureAugLoopRuntimeManager exception.",m)}}async qZe(d){try{await this.Je.activateAnnotation(Wt.RoamingSettingAnnotation.getTypeName(),
this.qWj),this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new nq.a,{operation:d}))}catch(m){this.Eg.sendTraceTag(0,2250,10,"Activating RoamingSettingAnnotation threw exception.",m)}}}Object(y.a)(lx,"SoftPaywallSignalSender",null,[863]);class ap{Nuj(){var d=new Date;return 100*d.getFullYear()+d.getMonth()+1}ruo(d){return null!==d&&void 0!==d&&d.receivedCreditsDate?Number(d.receivedCreditsDate)<this.Nuj():!0}}Object(y.a)(ap,"SoftPaywallUtils",null,[865]);class Ty extends kd.a{constructor(){super(...arguments);
this.W=null}get name(){return"WordEditor.EditorUpsell"}F8(d){this.W=d;this.W.ia("WordEditor.Ideas.AddInLoader.IAddInLicensingManager",()=>new FC(this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),n.AFrameworkApplication.K,new vb.a)).ha();this.W.ia("WordEditor.EditorUpsell.IPremiumPreviewGate",()=>new Kx(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.W.ia("WordEditor.EditorUpsell.ISimulateFreeUserGate",
()=>new xs(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.EditorUpsell.IUpsellCampaignGate",()=>new Vr(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler",()=>new Li(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.W.resolve("Common.IAppSettingsManager"),new vb.a,this.W.resolve("Common.IUlsWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.PremiumPreviewDataHandler",
()=>new zu(this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"),this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new vb.a,this.W.resolve("Common.IUlsWrapper"),this.W.resolve("Wac.Common.Utils.IOtelWrapper"))).as("WordEditor.EditorUpsell.IPremiumPreviewDataProvider").as("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").as("WordEditor.EditorUpsell.IPremiumPreviewDataHandler").as("WordEditor.EditorUpsell.IPremiumPreviewAPI").ha();
this.W.ia("WordEditor.EditorUpsell.PremiumPreviewCritiquesFilter",()=>new zw(this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),new vb.a,this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).as("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").ha();this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter");this.W.register(zm,"WordEditor.EditorUpsell.PremiumPreviewStateUpdater").ha().Ud(()=>new zm(n.AFrameworkApplication.va,this.W.resolve("Common.IUlsWrapper"),
this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataHandler"),this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate"))).ha();this.W.ia("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler",()=>new Zp(this.W.resolve("Box4.IRoamingServiceRequestManager"),d.resolve("Box4.RoamingSetting.IRoamingSettingCache"),this.W.resolve("Common.IAppSettingsManager"),new vb.a,this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsUpdater").as("WordEditor.Ideas.EditorUpsell.IBxPromoSettingsReader").ha();
this.W.ia("WordEditor.Ideas.EditorUpsell.IBxPromoGate",()=>new Es(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.EditorUpsell.ISoftPaywallGate",()=>new Aw(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager"))).ha();this.W.ia("WordEditor.EditorUpsell.SoftPaywallUtils",()=>new ap).ha();this.W.ia("WordEditor.EditorUpsell.SoftPaywallSignalSender",()=>new lx(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Common.IUlsWrapper"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.ISoftPaywallData",()=>new gt(this.W.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender"),this.W.resolve("WordEditor.EditorUpsell.SoftPaywallUtils"),this.W.resolve("Wac.Common.Utils.IOtelWrapper"),this.W.resolve("Common.IUlsWrapper"))).ha();this.W.ia("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler",
()=>new Rz(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"))).ha()}async H8(){var d=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewGate"),m=this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallGate"),A=this.W.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager");A.CAm();var R=this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");
const da=this.W.resolve("Common.IAppSettingsManager");d=await d.zHf();m=await m.isEnabled();da.$("WordEditorIdeasIsEnabled")&&m?(await this.HBf(),this.qAm(A,m)):da.$("WordEditorIdeasIsEnabled")&&(d||R.nKb())?(R=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewSettingsHandler"),this.W.resolve("WordEditor.EditorUpsell.PremiumPreviewStateUpdater"),await this.HBf(),R=await R.C_c(),this.VUc(R),A=await A.WKb,this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter").Jri(A)):this.HBf()}HBf(){this.W.resolve("WordEditor.Ideas.EditorUpsell.IBxPromoGate").isEnabled()&&
this.W.resolve("WordEditor.Ideas.EditorUpsell.BxPromoSettingsHandler").C_c()}VUc(d){this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewDataUpdater").VUc(d)}qAm(d,m){this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(async A=>{if(A.isFreemiumUpsellEnabled()){A=this.W.resolve("WordEditor.EditorUpsell.SoftPaywallSignalSender");var R=this.W.resolve("WordEditor.EditorUpsell.SoftPaywallAnnotationHandler"),da=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),
Ea=this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData");R.initialize();this.VUc({currentPpType:4});R=await d.WKb;da.Jri(R,m);Ea.isEnabled=!0;A.Zjj()}})}G8(){}static main(){z.a.instance.Gc(new Ty)}}Object(y.a)(Ty,"WordEditorEditorUpsellPackage",kd.a,[]);var Nr=c(805);class cy{constructor(d,m,A){this.ga=d;this.Eg=m;this.NYa=A;this.ai=null;this.ISg={["id"]:cy.oug,["bodyControls"]:{["id"]:cy.oug,["isModal"]:!0,["isBlocking"]:!1,["dialogType"]:0}};this.byn=()=>{try{this.ai=this.o6l(),this.ai.Cd=
5,this.ISg.bodyControls.dialogType=4,this.ai.Uh("",this.mva,this.ISg)}catch(R){this.Eg.sendTraceTag(542749407,2250,10,`Upsell share dialog failed to open. Error message: ${R.message}, error stack trace ${R.stack}`);return}this.NYa.Sv(Ac.a.rxn,!0)};this.mva=R=>{this.NYa.kqa(Ac.a.W_k,!0,null,null,null,null,[{...(new Ya.a),name:"ClosedWithDialogButtonType",string:Nr.a[R]}]);this.ga.Qb(Ac.a.D7a,2,"tell-a-friend-button")};this.ga.qa(Ac.a.Erm,ic.a.view,this.byn)}dispose(){this.ai&&this.ai.dispose()}o6l(){return new oa.a(!1,
!1,!0)}}cy.oug="GenericDialog";Object(y.a)(cy,"UpsellCampaignActor",null,[]);class mx extends kd.a{constructor(){super(...arguments);this.nlh=this.W=null}get name(){return"WordEditor.UpsellCampaign"}F8(d){this.W=d}H8(){const d=this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewAPI"),m=this.W.resolve("WordEditor.EditorUpsell.IUpsellCampaignGate");this.nlh=new cy(n.AFrameworkApplication.va,this.W.resolve("Common.IUlsWrapper"),this.W.resolve("Wac.Common.Utils.IOtelWrapper"));m.eMm()&&(d.start(2),
this.W.resolve("Wac.Common.Utils.IOtelWrapper").Sv(Ac.a.sxn,!0))}G8(){this.nlh.dispose()}static main(){(new Vr(n.AFrameworkApplication.K)).nKb()&&z.a.instance.Gc(new mx)}}Object(y.a)(mx,"WordEditorUpsellCampaignPackage",kd.a,[]);class Uy{constructor(){this.iw=(new Rj.a).Pc(15);const d=sf.StaticActiveAppFrame.za().jb.Zc;this.iw.Db(d)}dispose(){this.iw.dispose()}}Object(y.a)(Uy,"AutomationTransaction",null,[10]);const JB=()=>Ia.a.instance.resolve("WordEditor.Extension.DocumentFactory").create();var ff=
c(2113),IA=c(2072),Km=c(2074),Lm=c(1850),sl=c(231),KB=c(538),Vy=c(1570),JA=c(1054),Bw=c(604),ih=c(1519);class zt extends ih.a{constructor(d,m,A,R){super();this.$z=d;this._context=m;this.Vn=A;this.Je=R}get content(){return void 0===this.$z.content||null===this.$z.content?{}:this.$z.content}get id(){return this.$z.id}get _ReferenceId(){return this.yq?this.Tq:null}get _State(){return void 0===this.$z.content||null===this.$z.content||void 0===this.$z.content.M_||null===this.$z.content.M_||void 0===this.$z.content.M_.state||
null===this.$z.content.M_.state?0:this.$z.content.M_.state}set _State(d){void 0!==this.$z.content&&null!==this.$z.content&&void 0!==this.$z.content.M_&&null!==this.$z.content.M_||sc.a.Tf();this.$z.content.M_.state=d;this.Je.qAa(this.$z,d)}deleteObject(){this.ZKb();const d=Object(vf.a)(Bw.a,this.$z.parent);d||sc.a.Tf();d.deleteAnnotation(this.$z.content);this._State=70}getParentAsAnnotation(){this.ZKb();if(3===this.$z.uNb&&this.$z.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new zt(this.$z.parent,
this._context,this.Vn,this.Je));sc.a.Tf();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentAsParagraph(){this.ZKb();if(2===this.$z.uNb&&this.$z.parent)return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.Vn.create(this.$z.parent,this._context));sc.a.Tf();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getParentType(){this.ZKb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.$z.uNb)}_KeepReference(){this.rq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Annotation"}invokePropertyGet(d){switch(d){case 1:return this.content;
case 2:return this.id;case 3:return this._ReferenceId;case 4:return this._State}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this._State=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,
m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1006:return this.UD(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1005:return this.V9l();case 1004:return this.W9l();case 1003:return this.e$l()}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}V9l(){return this.getParentAsAnnotation()}W9l(){return this.getParentAsParagraph()}e$l(){return this.getParentType()}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}ZKb(){this.$z.oXc||(this._context.Jm.WH(),this._context.Jm.Iu(),this.$z=this.Je.ZKb(this.$z.id),this.$z.oXc||sc.a.Tf())}}Object(y.a)(zt,"Annotation",ih.a,[841]);class tq{constructor(d,m,A){this.Hse=this.Wk=-1;this.qp=A;0<d&&(this.Wk+=d);this.Hse=0<m?d+m<this.qp.length()?d+m:this.qp.length():this.qp.length()}get_current(){return this.Wk<this.Hse?this.qp._GetItem(this.Wk):null}moveNext(){const d=this.QQo();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}QQo(){this.Wk++;
return this.Wk<this.Hse?!0:!1}}Object(y.a)(tq,"ElementEnumerator",null,[882]);class LB extends ih.a{constructor(d,m,A,R){super();this.bW=this.KAc=null;this.rWj=d;this._context=m;this.Je=A;this.Vn=R;A.ob(this,d)}length(){return this.KAc.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){return!this.KAc||0>=this.length()?null:this.getItem(0)}getItem(d){return this._GetItem(d)}refresh(){this._context.Jm.WH();
this._context.Jm.Iu();return this.Je.getAnnotationsByType(this.rWj).then(d=>{this.z4c(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)})}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.AnnotationCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.fY(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){switch(d){case 1005:return this.VUn()}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}VUn(){return this.refresh()}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}KB(d,m){const A=new zt(d,this._context,this.Vn,this.Je);A.rq();this.rq();m===
Wm.a.getTypeName()?OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,4,A._ReferenceId):this.bW&&m===Iv.a.getTypeName()?(this.bW.Z(d.id,A),OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,5,A._ReferenceId)):m===JA.a.getTypeName()&&OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(this._ReferenceId,6,A._ReferenceId)}_GetItem(d){let m=null;"number"===typeof d?d<this.length()&&(m=this.KAc.J(d)):"string"===typeof d&&(m=d);if(m&&
this.bW.nb(m))return this.bW.J(m);sc.a.qd();return null}z4c(d){this.bW=new Fk.a;this.KAc=new U.a;if(d)for(const m of d)this.KAc.add(m.id),this.bW.add(m.id,new zt(m,this._context,this.Vn,this.Je))}}Object(y.a)(LB,"AnnotationCollection",ih.a,[55,841,857]);class nx{constructor(d,m){this.Je=d;this.Vn=m}create(d,m){return new LB(d,m,this.Je,this.Vn)}}Object(y.a)(nx,"AnnotationCollectionFactory",null,[]);var MB=c(644);class ro{constructor(d,m,A){this.Tmc=d;this.Rdo=m;this.tA=A}T$k(d,m){var A;this.a3o(d,
m);var R=d.node;const da=jr.a.DJ(R),Ea=R.ja(wc.a.uj,0);0===Ea&&(v.ULS.sendTraceTag(508863365,369,10,"AppId:{0}, cannot read paragraph textId.",m.appId),sc.a.Tf());const ib=d.Wj,Qb=d.vp-ib;if(0>=Qb)v.ULS.sendTraceTag(508859913,369,50,"AppId:{0}, range length must be positive.",m.appId);else{var pc=new U.a;pc.add(d);this.Rdo.select(pc,1);R=null===(A=R.characterData)||void 0===A?void 0:A.substring(ib,ib+Qb);A=Object.assign(new Wm.a,{parentRevId:Ea.toString(),parentPath:da.split("\\"),sourceTimestamp:Date.now(),
items:[Object.assign(new Zq.a,{id:this.C6l(),body:Object.assign(new MB.AddInTextAnnotation,{id:Eg.a.create().toString(),priority:1,context:R,startInContext:0,categoryName:ro.RId,suggestions:[],range:{start:ib,length:Qb}})})]});this.Tmc.submitOperation(A);A={};A.contextId=d.contextId==ic.a.Fd?"textRange":"paragraph";A.AppId=null===m||void 0===m?void 0:m.appId;v.ULS.sendTraceTag(508863364,369,50,rb.c(A))}}a3o(d,m){d.contextId!=ic.a.Fd&&d.contextId!=ic.a.paragraph&&(v.ULS.sendTraceTag(508863366,369,
15,"AppId:{0}, node must be textRange or paragraph.",m.appId),sc.a.qd())}C6l(){const d=ro.c0j+ro.QQg.toString();ro.QQg++;return d}bll(d,m){if(d)for(const A of d)if(A.contextId!=ic.a.Fd&&A.contextId!=ic.a.paragraph)v.ULS.sendTraceTag(508847651,369,50,"Skipping non-text context {0} for addin {1]",ic.a[A.contextId],m.appId);else if(d=jr.a.DJ(A.node),d=this.tA.zof(d))for(const R of d)R.content.categoryName===ro.RId&&this.tA.q1a(R,!1)}}ro.QQg=1;ro.c0j="#CP";ro.RId="CopilotHighlight";Object(y.a)(ro,"AnnotationOperations",
null,[1008]);class At{constructor(d,m,A){this.rql=1;this.qql=2;this.ii=m;this.z6=A;this.xC=d}getAppRuntimeStartState(){const d=this.z6.aQa(this.xC);return this.ii.Cof(d)==dk.background?1:0}setAppRuntimeStartState(d){const m=this.z6.aQa(this.xC);this.ii.Kkj(m,1==d?dk.background:dk.inactive)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case this.qql:return this.ROl();case this.rql:return this.aho(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}ROl(){return this.getAppRuntimeStartState()}aho(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.setAppRuntimeStartState(d);return null}}Object(y.a)(At,"AppRuntimePersistenceService",null,[]);class dy{constructor(d,m){this.EZ=d;this.z6=m}create(d,m){return new At(m,this.EZ,this.z6,d)}}Object(y.a)(dy,"AppRuntimePersistenceServiceFactory",null,[]);class ht{constructor(d,m,A){this.ii=m;this.z6=A;this.xC=
d}getAppRuntimeState(){const d=this.z6.aQa(this.xC);return this.ii.J0(d)?2:1}setAppRuntimeState(d){const m=this.z6.aQa(this.xC);2===d?(d=this.ii.dVd(m),d.isForUILessAction=!1,this.ii.showTaskPane(m,null,d)):1===d&&this.ii.LOa(m)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 2:return this.SOl();case 1:return this.bho(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}SOl(){return this.getAppRuntimeState()}bho(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.setAppRuntimeState(d);return null}}Object(y.a)(ht,"AppRuntimeService",null,[]);class Xt{constructor(d,m){this.EZ=d;this.z6=m}create(d,m){return new ht(m,this.EZ,this.z6,d)}}Object(y.a)(Xt,"AppRuntimeServiceFactory",null,[]);var Au=c(1835);class KA{constructor(){this.IMg=this.A$a=null;this.JMg=0;this.llh=this.sEc=null;this.r0g=!1}get appId(){return this.A$a}set appId(d){this.A$a=d}get authority(){return this.IMg}set authority(d){this.IMg=d}get authorityType(){return this.JMg}set authorityType(d){this.JMg=
d}get isAnonymous(){return this.r0g}set isAnonymous(d){this.r0g=d}get tenantId(){return this.sEc}set tenantId(d){this.sEc=d}get upn(){return this.llh}set upn(d){this.llh=d}getTypeName(){return"Microsoft.Authentication.AuthContext"}invokePropertyGet(d){switch(d){case 4:return this.appId;case 2:return this.authority;case 3:return this.authorityType;case 5:return this.isAnonymous;case 6:return this.tenantId;case 1:return this.upn}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this.appId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 2:this.authority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.authorityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 5:this.isAnonymous=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 1:this.upn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}qDl(d){this.upn=d.upn;this.authority=d.authority;this.authorityType=d.authorityType;this.tenantId=d.tenantId;this.isAnonymous=d.isAnonymous}}Object(y.a)(KA,"AuthContext",null,[]);var Fo=c(1606),Ci;(function(d){d[d.unknown=-1]="unknown";d[d.organizationAccount=0]="organizationAccount";d[d.microsoftAccount=1]="microsoftAccount"})(Ci||(Ci={}));Object(y.b)("IdentityType",Ci);class Cw{constructor(){this.AVg=
this.jUg=this.Rsa=null;this.Qwc=0}get displayName(){return this.Rsa}set displayName(d){this.Rsa=d}get email(){return this.jUg}set email(d){this.jUg=d}get federationProvider(){return this.AVg}set federationProvider(d){this.AVg=d}get identityType(){return this.Qwc}set identityType(d){this.Qwc=d}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(d){switch(d){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}static kbl(d){const m=new Cw;m.displayName=d.displayName;m.email=d.email;switch(d.authority){case "MicrosoftAccount":m.identityType=
1;break;default:m.identityType=0}m.federationProvider="";return m}}Object(y.a)(Cw,"OfficeIdentityInfo",null,[]);class Bt{constructor(d,m,A){this.fG=null;this._id=d;this._value=m;this.ek=A}get id(){return this._id}get value(){return this._value}set value(d){}getTypeName(){return"Microsoft.Authentication.RoamingSetting"}invokePropertyGet(d){switch(d){case 1:return this.id;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 2:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"any");this.fG=m[0].toString();return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromise((A,R)=>{if(1===this.ek){let da,Ea;try{da=Ia.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager"),
Ea=Ia.a.instance.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),Object(fm.b)()?Object(fm.a)(2,()=>da.eGc(parseInt(this.fG)),!1,()=>!0).then(()=>{Ea.y9i();A(null)}).catch(ib=>{v.ULS.sendTraceTag(528859142,3011,10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",ib);R(ib)}):da.eGc(parseInt(this.fG)).then(()=>{Ea.y9i();A(null)}).catch(ib=>{R(ib)})}catch(ib){R(ib)}}else 0===this.ek?(Ia.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").Ohj(this.fG),
A(null)):R(null)})}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(y.a)(Bt,"RoamingSetting",null,[]);class Lx{getItem(d){let m,A;if("ridTranscriptionQuotaMinutesUsed"===d)return OfficeExtension.WacRuntime.Utility.createPromise(R=>{Object(fm.b)()?Object(fm.a)(2,()=>Ia.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").Z2a(),
!0,()=>!0).then(da=>{m=da.toString();A=1;R(new Bt(d,m,A))}).catch(da=>{v.ULS.sendTraceTag(528859141,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",da)}):Ia.a.instance.resolve("WordEditor.TranscriptionRoamingServiceManager").Z2a().then(da=>{m=da.toString();A=1;R(new Bt(d,m,A))})});m=Ia.a.instance.resolve("WordEditor.TranslatorRoamingServiceManager").GVa;A=0;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Bt(d,m,A))}getItemOrNullObject(){return null}getTypeName(){return"Microsoft.Authentication.RoamingSettingCollection"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1:return this.fY(m);case 2:return this.S2a(m)}d=
this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}S2a(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}}Object(y.a)(Lx,"RoamingSettingCollection",null,[]);class Ln{static get yYh(){return Ln.D2j}static xca(d){return d in Ln.yYh?Ln.yYh[d].toString():d}}Ln.map=null;Ln.D2j={["GeneralException"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException,
["AccessDenied"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied,["ApiNotAvailable"]:WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ApiNotAvailable,["UserNotSignedIn"]:WordEditorIntl.WordEditorStrings.L_UserNotSignedIn,["UserAborted"]:WordEditorIntl.WordEditorStrings.L_UserAborted,["UnsupportedUserIdentity"]:WordEditorIntl.WordEditorStrings.L_UnsupoortedUserIdentity,["InvalidResourceUrl"]:WordEditorIntl.WordEditorStrings.L_InvalidResourceUrl,["InvalidGrant"]:WordEditorIntl.WordEditorStrings.L_InvalidGrant,
["AddinIsAlreadyRequestingToken"]:WordEditorIntl.WordEditorStrings.L_SSOAddinIsAlreadyRequestingToken,["ResourceNotAllowed"]:WordEditorIntl.WordEditorStrings.L_SSOResourceNotAllowed,["ClientError"]:WordEditorIntl.WordEditorStrings.L_SSOClientError,["ServerError"]:WordEditorIntl.WordEditorStrings.L_SSOServerError};Object(y.a)(Ln,"SingleSignOnErrorCodeMap",null,[]);class uq{constructor(d,m){this.Bgd=d;this.Qwc=m}get accessToken(){return this.Bgd}set accessToken(d){this.Bgd=d}get tokenIdenityType(){return this.Qwc}set tokenIdenityType(d){this.Qwc=
d}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(d){switch(d){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(y.a)(uq,"SingleSignOnToken",
null,[]);class Pv{constructor(d,m,A,R){this.ii=m;this.xC=d;this._context=R}get roamingSettings(){if(!this.ii.Et.getOsfControl(this.xC).isFirstParty())throw OfficeExtension.WacRuntime.Utility.createRichApiException(Fo.a.PAb,Ln.xca(Fo.a.PAb));return new Lx}getAccessToken(d){const m=this.ii.Et,A=m.getOsfControl(this.xC),R=A.getManifest(),da=R.getMarketplaceID(),Ea=R.getMarketplaceVersion();this.NY(d,da,Ea);return OfficeExtension.WacRuntime.Utility.createPromise((ib,Qb)=>{m._enableFirstPartySSO?A.isFirstParty()&&
this.TIm(R,d)?(this._context.Jm.WH(),Ia.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(d,da).then(pc=>{this._context.Jm.Iu();ib(pc)},pc=>{this._context.Jm.Iu();Qb(pc.toString())})):Qb(Fo.a.PAb):Qb(Fo.a.apiNotAvailable)}).then(ib=>{let Qb;switch(ib.authority){case Au.a.fxn:Qb=1;break;default:Qb=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new uq(ib.accessToken,Qb))},ib=>{this.G5m(d,da,ib);return ib?OfficeExtension.WacRuntime.Utility.createPromise((Qb,
pc)=>{pc(OfficeExtension.WacRuntime.Utility.createRichApiException(ib,Ln.xca(ib)))}):OfficeExtension.WacRuntime.Utility.createPromise((Qb,pc)=>{pc(OfficeExtension.WacRuntime.Utility.createRichApiException(Fo.a.generalException,Ln.xca(Fo.a.generalException)))})})}getAuthContext(){const d=this.ii.Et.getOsfControl(this.xC).getManifest(),m=d.getMarketplaceID(),A=d.getWebApplicationId();return OfficeExtension.WacRuntime.Utility.createPromise((R,da)=>{this._context.Jm.WH();Ia.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(m).then(Ea=>
{this._context.Jm.Iu();R(Ea)},Ea=>{this._context.Jm.Iu();da(Ea.toString())})}).then(R=>{const da=new KA;da.qDl(R);da.appId=A;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(da)},R=>R?OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{Ea(OfficeExtension.WacRuntime.Utility.createRichApiException(R,Ln.xca(R)))}):OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{Ea(OfficeExtension.WacRuntime.Utility.createRichApiException(Fo.a.generalException,Ln.xca(Fo.a.generalException)))}))}getPrimaryIdentityInfo(){const d=
this.ii.Et.getOsfControl(this.xC).getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this._context.Jm.WH();Ia.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(d).then(R=>{this._context.Jm.Iu();m(R)},R=>{this._context.Jm.Iu();A(R.toString())})}).then(m=>{m=Cw.kbl(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)},m=>m?OfficeExtension.WacRuntime.Utility.createPromise((A,R)=>{R(OfficeExtension.WacRuntime.Utility.createRichApiException(m,
Ln.xca(m)))}):OfficeExtension.WacRuntime.Utility.createPromise((A,R)=>{R(OfficeExtension.WacRuntime.Utility.createRichApiException(Fo.a.generalException,Ln.xca(Fo.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(d){switch(d){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1:return this.AMl(m);case 3:return this.cPl();case 2:return this.Gam()}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}AMl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,gk);return this.getAccessToken(d)}cPl(){return this.getAuthContext()}Gam(){return this.getPrimaryIdentityInfo()}TIm(d,
m){let A=!1;const R=d.getWebApplicationAuthorizations();d=null;for(const ib of R)if(ib.getResource().toLowerCase()===m.resource.toLowerCase()){d=ib;A=!0;break}if(!A){var da="";for(var Ea of R)da+=this.aVf(Ea.getResource().toLowerCase())+",";da=da.substring(0,da.length-1);v.ULS.sendTraceTag(39362643,369,50,"{0}",rb.c({["event"]:"AuthenticationService::IsAuthorizationDeclared",["authsLength"]:R.length,["resources"]:da}));return!1}Ea=m.scope.split(" ,+");for(da of Ea)if(""!==da){Ea=!1;for(const ib of d.getScopes())da.toLowerCase()===
ib.toLowerCase()&&(Ea=!0);if(!Ea)return!1}return!0}NY(d,m,A){d=this.aVf(d.resource);v.ULS.sendTraceTag(39102240,369,50,"{0}",rb.c({["manifestId"]:m,["manifestVersion"]:A,["resource"]:d}))}G5m(d,m,A){d=this.aVf(d.resource);v.ULS.sendTraceTag(39102241,369,10,"{0}",rb.c({["manifestId"]:m,["resource"]:d,["error"]:A}))}aVf(d){return(d?d:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(y.a)(Pv,"AuthenticationService",null,[]);class Sz{constructor(d,m){this.EZ=d;this.zfa=
m}create(d,m){return new Pv(m,this.EZ,this.zfa,d)}}Object(y.a)(Sz,"AuthenticationServiceFactory",null,[]);class iv extends ih.a{constructor(d){super();sc.a.iy(d,"FieldCollection");this.iXb=d}length(){return this.iXb.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){return this.iXb&&this.iXb.count?this.iXb.J(0):null}getByTypes(d){const m=new U.a;for(const A of this.iXb)for(const R of d)if(A.type===R){m.add(A);
break}return new iv(m)}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.iXb.J(d);sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.FieldCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1002:return this.Vh();case 1001:return this.Wh();case 1005:return this.Zof(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Zof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<int>");return this.getByTypes(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(iv,"FieldCollection",
ih.a,[841,857]);class bp extends ih.a{constructor(d){super();sc.a.iy(d,"InlinePictureCollection");this.ixc=d}length(){return this.ixc.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){sc.a.Ai()||sc.a.zk();return!this.ixc||0>=this.ixc.count?null:this.ixc.J(0)}_GetItem(d){d=sc.a.hQ(d);if(d<this.length())return this.ixc.J(d);v.ULS.sendTraceTag(16847771,369,10,"The index is out of the paragraph range.");sc.a.qd();
return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.InlinePictureCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(bp,"InlinePictureCollection",ih.a,[841,857]);var Wn;(function(d){d[d.before=0]="before";d[d.after=1]="after";d[d.start=2]="start";d[d.end=3]="end";d[d.replace=4]="replace"})(Wn||(Wn={}));Object(y.b)("InsertLocation",Wn);var Qv;(function(d){d[d.body=0]="body";d[d.Hna=1]="contentControl";d[d.Ahp=2]="customProperty";d[d.paragraph=
3]="paragraph";d[d.range=4]="range";d[d.table=5]="table";d[d.gy=6]="tableRow"})(Qv||(Qv={}));Object(y.b)("ObjectType",Qv);class ey extends ih.a{constructor(d,m,A,R,da,Ea,ib){super();this.gZb=this.Bcb=null;sc.a.iy(Qv[d],"ListCollection.calledClassName");sc.a.iy(da,"ListCollection.requestContext");this.dsc=d;this.Mm=m;this.We=A;this.ED=R;this._context=da;this.hn=Ea;this.gb=ib;this.ED&&this._context.nZc&&(this.gZb=this.ED.KVc.create(this.ED.Xp))}length(){return this.Bcb.count}_GetItem(d){d=sc.a.hQ(d);
if(0<=d&&d<this.length())return this.Bcb.J(d);v.ULS.sendTraceTag(19772865,369,10,"The index is out of the boundary of list in class ListCollection.");sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getById(d){(d=this.getByIdOrNullObject(d))||sc.a.Tk();return d}getByIdOrNullObject(d){if(!this.Bcb||!this.length())return null;for(let m=0;m<this.length();m++)if(this.Bcb.J(m).id===d)return this.Bcb.J(m);return null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){this.qGj();
return this.Bcb&&this.length()?this.Bcb.J(0):null}getItem(d){d=sc.a.hQ(d);return this.getById(d)}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){this.qGj();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.ListCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1002:return this.SPc(m);case 1005:return this.TPc(m);case 1004:return this.HG();case 1006:return this.IG();case 1:return this.fY(m);case 1001:return this.Vh();case 1003:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}SPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getById(d)}TPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getByIdOrNullObject(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}qGj(){let d=null;switch(this.dsc){case 0:d=this.gb.Hz(this.Mm,!0,!1);break;case 1:d=this.We.lF();break;case 4:d=n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.ED.Xbc?this.ED.Xbc.Xp:this.gZb?this.gZb.Xp:this.ED.Xp:this.ED.Xp;break;default:v.ULS.sendTraceTag(19772866,369,15,"AppId:{0}, invalid object type to get the list collection.",this._context.appId)}this.Bcb=this.hn.g5h(d,this._context)}M6c(){n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&
this.gZb&&(this.gZb.lpb(),this.gZb=null)}}Object(y.a)(ey,"ListCollection",ih.a,[841,857]);class rs extends ih.a{constructor(d){super();sc.a.iy(d,"NoteItemCollection");this.dAc=d}length(){return this.dAc.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){return this.dAc&&this.dAc.count?this.dAc.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.dAc.J(d);sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,
m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.NoteItemCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(rs,"NoteItemCollection",ih.a,[841,857]);class lr extends ih.a{constructor(d){super();sc.a.iy(d,"ParagraphCollection");this.dO=d}length(){return this.dO.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){sc.a.Ai()||sc.a.zk();return this.dO&&
this.dO.count?this.dO.J(0):null}getLast(){const d=this.getLastOrNullObject();d||sc.a.Tk();return d}getLastOrNullObject(){sc.a.Ai()||sc.a.zk();return this.dO&&this.dO.count?this.dO.J(this.dO.count-1):null}_GetItem(d){d=sc.a.hQ(d);if(d<this.length())return this.dO.J(d);v.ULS.sendTraceTag(16795330,369,10,"The index is out of the paragraph range.");sc.a.qd();return null}getById(d){(d=this.getByIdOrNullObject(d))||sc.a.Tk();return d}getByIdOrNullObject(d){var m;if(!d||!this.dO||!this.dO.count)return null;
const A=this.dO.getEnumerator();for(;A.moveNext();){const R=A.get_current();if((null===(m=R.Koa())||void 0===m?void 0:m.id.toString())===d)return R}return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.ParagraphCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1005:return this.IG();case 1004:return this.N2l();case 1006:return this.P2l();case 1007:return this.SPc(m);
case 1008:return this.TPc(m);case 1:return this.XV(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}N2l(){return this.getLast()}P2l(){return this.getLastOrNullObject()}SPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getById(d)}TPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByIdOrNullObject(d)}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(lr,"ParagraphCollection",ih.a,[841,857]);class ox extends ih.a{constructor(d,m,A,R,da,Ea){super();this.Z0b=this._tables=null;this.dsc=d;this.owd=m;this.ED=A;this.We=
R;this._context=da;this.$c=Ea;this.ED&&this._context.nZc&&(this.Z0b=this.ED.KVc.create(this.ED.Xp))}length(){return this._tables.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){this.AIj();return this._tables&&this.length()?this._tables.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(d<this._tables.count)return this._tables.J(d);v.ULS.sendTraceTag(19969492,369,10,"The index is out of the table collection range.");
sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){this.AIj();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.TableCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}AIj(){switch(this.dsc){case 0:case 5:this._tables=this.$c.Hhm(this.owd,this._context);break;case 1:var d=this.We.lF();this._tables=this.$c.Uii(d.J(0),d.J(d.count-1),this._context);break;case 4:d=n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.ED.Xbc?this.ED.Xbc.Xp:this.Z0b?this.Z0b.Xp:this.ED.Xp:this.ED.Xp;
this._tables=this.$c.Uii(d.J(0),d.J(d.count-1),this._context);break;default:v.ULS.sendTraceTag(19969493,369,15,"AppId:{0}, invalid object type to get the table collection.",this._context.appId)}}M6c(){n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.Z0b&&(this.Z0b.lpb(),this.Z0b=null)}}Object(y.a)(ox,"TableCollection",ih.a,[841,857]);class jv extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n){super();sc.a.jKa(d,"Body");this.Mm=d;
this._context=m;this.Vn=A;this.tk=R;this.gB=da;this.fM=Ea;this.Zta=ib;this.Yc=Qb;this.jla=pc;this.gb=Pc;this.iq=gd;this.pA=Cd;this.hd=ae;this.Qw=Xd;this.Ig=se;this.nA=Xe;this.ew=Be;this.om=Hg;this.$c=Xh;this.hn=Fl;this.Ts=Gm;this.cX=em;this.Ow=$n}get Nxh(){return this.Mm}get contentControls(){if(sc.a.FAa){var d=new Ch;d.types=[31];return this.getContentControls(d)}d=this.gb.Hz(this.Mm,!0,!1);return 0>=d.count?null:this.Ig.dac(d.J(0),d.J(d.count-1),this._context)}get endnotes(){var d=new U.a;switch(this.type){case 4:case 1:case 0:d.addRange(this.hd.X9b(this.Mm,
1));break;case 2:case 3:case 5:case 6:return null}d=this.hd.Gva(d,this._context);return new rs(d)}get fields(){const d=new U.a;switch(this.Mm.type){case 8:case 10:case 36:case 16:case 38:case 37:const m=this.gb.yw(this.Mm,!0,!1),A=m.count;for(let R=0;R<A;R++){const da=this.Ow.U9b(m.J(R),this._context,!0);d.addRange(da)}break;default:v.ULS.sendTraceTag(539530944,369,10,"AppId:{0}, in function Body.Fields, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",
this._context.appId),sc.a.Tf()}return new iv(d)}get font(){return this.gB.create(0,this.Mm,null,null,this._context)}get footnotes(){var d=new U.a;switch(this.type){case 4:case 1:case 0:d.addRange(this.hd.X9b(this.Mm,0));break;case 2:case 3:case 5:case 6:return null}d=this.hd.Gva(d,this._context);return new rs(d)}get inlinePictures(){var d=this.gb.yw(this.Mm,!0,!1);let m=0;const A=new U.a;for(const R of d){d=new U.a;this.Qw.csf(d,R);for(const da of d)A.add(this.fM.create(da,this._context,m++))}return new bp(A)}get lists(){return sc.a.Ai()?
new ey(0,this.Mm,null,null,this._context,this.hn,this.gb):null}get paragraphs(){const d=this.gb.yw(this.Mm,!0,!1);let m=0;const A=new U.a;for(const R of d)A.add(this.Vn.create(R,this._context,m++));return new lr(A)}get parentBody(){if(!sc.a.Ai())return null;const d=this.parentBodyOrNullObject;d||sc.a.Tk();return d}get parentBodyOrNullObject(){return sc.a.Ai()?this.$c.Qtf(this.Mm,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||sc.a.Tk();return d}get parentContentControlOrNullObject(){const d=
jd.a.create(this.Moa(!0)),m=jd.a.create(this.Moa(!1));this.hd.YJa(d,m);return this.Ig.eac(d,m,this._context)}get parentSection(){if(!sc.a.Ai())return null;const d=this.parentSectionOrNullObject;d||sc.a.Tk();return d}get parentSectionOrNullObject(){if(!sc.a.Ai())return null;const d=this.Yc.Rf(this.Mm);let m=null;switch(this.Mm.type){case 16:case 36:d.zb(10)&&(m=d.jo(10));break;case 10:m=this.Mm;break;case 8:1===d.Wp()&&(m=d.Rd())}return m?this.Zta.create(m,this._context):null}get style(){const d=this.gb.Hz(this.Mm,
!0,!1);return this.pA.PQc(d)}set style(d){const m=this.gb.Hz(this.Mm,!0,!1);this.pA.olc(m,d)}get styleBuiltIn(){if(!sc.a.Ai())return-1;const d=this.gb.Hz(this.Mm,!0,!1);return this.pA.oSd(d)}set styleBuiltIn(d){sc.a.Ai()||sc.a.zk();const m=this.gb.Hz(this.Mm,!0,!1);this.pA.ihe(m,d)}get tables(){return sc.a.Ai()?new ox(0,this.Mm,null,null,this._context,this.$c):null}get text(){let d="";switch(this.Mm.type){case 8:case 10:case 36:case 16:case 38:case 37:const m=this.gb.yw(this.Mm,!0,!1),A=m.count;for(let R=
0;R<A;R++)d+=this.gb.M6a(m.J(R)),R<A-1&&(d+=sc.a.Dmb);break;default:v.ULS.sendTraceTag(16814427,369,10,"AppId:{0}, in function Body.Text, Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),sc.a.Tf()}return d}get type(){if(!sc.a.Ai())return-1;switch(this.Mm.type){case 8:return 0;case 10:const d=this.Yc.Rf(this.Mm);d.zb(8);d.jd(8);return 1===d.Wp()?0:1;case 36:switch(this.Mm.properties.getValue(wc.a.Rac)){case 0:case 2:case 1:return 2;
case 3:case 5:case 4:return 3;default:return-1}case 16:return 4;case 38:return 0==this.hd.H4(this.Mm)?5:6;case 37:return 1==this.Mm.getValue(wc.a.A4)?5:6;default:return-1}}get _ReferenceId(){return this.yq?this.Tq:null}clear(){const d=(new Date).getTime(),m=this.gb.Hz(this.Mm,!0,!1);sc.a.tpc(m,"Body.Clear");this.hd.ZJa(m.J(0));this.hd.ZJa(m.J(m.count-1));if(8===this.Mm.type&&1<If.GraphIterator.eb(this.Mm).Wp())return OfficeExtension.WacRuntime.Utility.createPromise((A,R)=>{this.hd.EYk(m,this._context,
A,R,d)});this.hd.xCb(m);sc.a.Ylf()||(5===this.type||6===this.type)&&this.insertText(" ",2);sc.a.$M("Body.Clear",sc.a.zN(d));return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getComments(){if(0===this.type)return this.Ts.BNl(this._context);if(1===this.type)return this.Ts.JSl(this.Mm,this._context);const d=this.gb.Hz(this.Mm,!0,!1);return this.Ts.gRd(d,this._context)}getContentControls(d){var m;d=null!==(m=null===d||void 0===d?void 0:d.types)&&void 0!==m?m:[];sc.a.BNc(d);m=this.Ig.Cgm(this.Mm,
this._context);return 0===d.length?m:null===m||void 0===m?void 0:m.getByTypes(d)}getHtml(){const d=this.gb.Hz(this.Mm,!0,!1);return this.ew.getHtml(d.toArray(),this._context)}getOoxml(){const d=(new Date).getTime();this._context.Jm.WH();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{const R=this.gb.Hz(this.Mm,!0,!1);this.ew.getOoxml(R,this._context,m,A,d)})}getReviewedText(d){let m="";switch(this.Mm.type){case 8:case 10:case 36:case 16:case 38:case 37:const A=this.gb.yw(this.Mm,!0,
!1),R=A.count;for(let da=0;da<R;da++)m+=this.cX.uUd(A.J(da),d);break;default:v.ULS.sendTraceTag(545005571,369,10,"NodeType:{0} is not supported to get the reviewed text.",this.Mm.type)}return m}getRange(d){sc.a.Ai()||sc.a.zk();let m=new U.a;d&&5!==d?1===d?m.add(jd.a.create(this.Moa(!0))):2===d||4===d?m.add(jd.a.create(this.Moa(!1))):(v.ULS.sendTraceTag(18745291,369,15,"AppId:{0}, rangeLocation of Body.GetRange must be Start/End/Whole/Content/After.",this._context.appId),sc.a.qd()):m=this.gb.Hz(this.Mm,
!0,!1);this.om.Qge(m);return(d=this.om.D9b(m,d))?this.tk.create(d,this._context):null}insertBreak(d,m){const A=(new Date).getTime(),R=new U.a;this.hd.eJf(this.Mm)&&6!==d&&sc.a.pD();switch(m){case 2:var da=!1;d||(da=!0);da=this.gb.$k(this.Mm,!0,da);R.add(jd.a.create(da));break;case 3:da=this.Moa(!1);R.add(jd.a.create(da));break;default:v.ULS.sendTraceTag(17179034,369,15,"AppId:{0}, insertLocation of Body.InsertBreak must be Start or End.",this._context.appId),sc.a.qd()}6===d?this.hd.YJa(R.J(0),R.J(0)):
R.J(0).contextId!==ic.a.table&&(da=this.hd.Y0a(R.J(0).node,2===m),R.Z(0,da));return OfficeExtension.WacRuntime.Utility.createPromise((Ea,ib)=>{this.hd.insertBreak(R,d,m,this._context,Ea,ib,A)})}insertContentControl(d){sc.a.ijf(d,"Body");d=sc.a.lcd(d,0);1!==d||sc.a.FAa||sc.a.qd();const m=this.hd.V5b(this.Moa(!0),!0),A=this.hd.V5b(this.Moa(!1),!1);return this.Ig.Uma(m,A,this._context,d)}insertFileFromBase64(d,m){"<"===d.charAt(0)&&(v.ULS.sendTraceTag(18130831,369,10,"invalid argument for insertFileFromeBase64 API in Body class.",
this._context.appId),sc.a.qd());return this.lia(d,m,!1)}insertHtml(d,m){const A=(new Date).getTime();let R=new U.a;var da=2;switch(m){case 2:case 3:da=this.Moa(2===m);R.add(jd.a.create(da));da=2===m?0:1;break;case 4:return R=this.gb.Hz(this.Mm,!0,!1),sc.a.tpc(R,"Body.InsertHtml"),this.clear().then(()=>this.insertHtml(d,2));default:sc.a.qd()}this.hd.YJa(R.J(0),R.J(R.count-1),da);return this.ew.insertHtml(R,d,m,A,this._context)}insertInlinePictureFromBase64(d,m){const A=(new Date).getTime();2!==m&&
3!==m&&(v.ULS.sendTraceTag(17433734,369,50,"AppId:{0}, insert inline picture with none supported location in Body class",this._context.appId),sc.a.qd());const R=jd.a.create(this.Moa(2===m));let da=null;this.hd.YJa(R,R);({JJ:da}=this.hd.mL(R,R,m));let Ea;this.hd.ZT((Ea=new U.a,Ea.add(da),Ea),m,0);return this.Qw.HIb(d,da,this._context).then(ib=>{this._context.Jm.Iu(this.Mm);if(!ib)return v.ULS.sendTraceTag(17433736,369,10,"AppId:{0}, something went wrong when insert iamge into Body.",this._context.appId),
sc.a.$M("Body.InsertInlinePictureFromBase64",sc.a.zN(A),d.length,!1),sc.a.Tf(),null;sc.a.$M("Body.InsertInlinePictureFromBase64",sc.a.zN(A),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.fM.create(this.Qw.wOc(ib),this._context))})}insertOoxml(d,m){"<"!==d.charAt(0)&&(v.ULS.sendTraceTag(18130832,369,10,"invalid argument for InsertOoxml API in Body class.",this._context.appId),sc.a.qd());return this.lia(d,m,!0)}insertParagraph(d,m){var A=!1,R=null;switch(m){case 2:m=
0;R=this.gb.$k(this.Mm,!0,!0);A=!0;break;case 3:m=1;R=this.gb.XC(this.Mm,!0,!0);A=!1;break;default:v.ULS.sendTraceTag(17319647,369,15,"AppId:{0}, Invalid insert location for Body.InsertPparagraph method.",this._context.appId),sc.a.qd()}R||sc.a.Tf();if(14===R.type){let Ea;var da=this.$c.HSd((Ea=new U.a,Ea.add(jd.a.create(R)),Ea),A);d=sc.a.kKc(d);let ib;this.hd.insertText((ib=new U.a,ib.add(jd.a.Uc(da.node,0)),ib),d,m);A=da.node}else R=this.hd.Y0a(R,A),A=this.hd.insertParagraph((da=new U.a,da.add(R),
da),d,m);return this.Vn.create(A,this._context)}insertTable(d,m,A,R){sc.a.Ai()||sc.a.zk();const da=new U.a;var Ea=!1;let ib=null;switch(A){case 2:A=0;ib=this.gb.$k(this.Mm,!0,!0);Ea=!0;break;case 3:A=1;ib=this.gb.XC(this.Mm,!0,!0);Ea=!1;break;default:v.ULS.sendTraceTag(19951649,369,15,"AppId:{0}, Invalid insert location for Body.InsertTable method.",this._context.appId),sc.a.qd()}ib||sc.a.Tf();14===ib.type?da.add(jd.a.create(ib)):(Ea=this.hd.Y0a(ib,Ea),da.add(Ea));return this.$c.insertTable(da,d,
m,A,R,this._context)}insertText(d,m){var A=new U.a;switch(m){case 2:case 3:const R=this.Moa(2===m);A.add(jd.a.create(R));this.hd.YJa(A.J(0),A.J(A.count-1));break;case 4:(A=this.parentContentControlOrNullObject)&&A.clear();A=this.gb.Hz(this.Mm,!0,!1);this.hd.$u(A.J(0));this.hd.$u(A.J(A.count-1));break;default:v.ULS.sendTraceTag(21284487,369,15,"AppId:{0}, undefined location for Body.InsertText: {1}.",this._context.appId,Wn[m]),sc.a.qd()}this.hd.ZT(A,m,0);return this.DFm(A,d,m)}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>
{const R=this.gb.Hz(this.Mm,!0,!1);this.nA.find(R,d,m,A,this._context)})}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.Mm,!0,!1);this.nA.rib(R,d,m,A,this._context)})}select(d){const m=this.gb.Hz(this.Mm,!0,!1);this.iq.select(m,d)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.Mm,"Body")}getTypeName(){return"Microsoft.WordServices.Body"}invokePropertyGet(d){switch(d){case 3:return this.contentControls;case 19:return this.endnotes;case 20:return this.fields;
case 5:return this.font;case 18:return this.footnotes;case 7:return this.inlinePictures;case 11:return this.lists;case 2:return this.paragraphs;case 10:return this.parentBody;case 16:return this.parentBodyOrNullObject;case 4:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 13:return this.parentSection;case 17:return this.parentSectionOrNullObject;case 6:return this.style;case 14:return this.styleBuiltIn;case 12:return this.tables;case 8:return this.text;case 9:return this.type;
case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 6:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 14:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1019:return this.$Fb();case 1021:return this.uFa(m);case 1013:return this.pGb();case 1016:return this.Qoa(m);case 1020:return this.fHb(m);case 1007:return this.nGa(m);case 1006:return this.qpa(m);case 1017:return this.e4a(m);case 1003:return this.pGa(m);case 1015:return this.iea(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){switch(d){case 1011:return this.RDa();case 1014:return this.SGb();case 1009:return this.W3a(m);case 1008:return this.opa(m);case 1004:return this.Z3a(m);case 1010:return this.$3a(m);case 1005:return this.c4a(m);case 1012:return this.nra(m);case 1018:return this.Wka(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}RDa(){return this.clear()}$Fb(){return this.getComments()}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,Ch);return this.getContentControls(d)}pGb(){return this.getHtml()}SGb(){return this.getOoxml()}Qoa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}fHb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}W3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(m,d)}nGa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.insertContentControl(d)}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(m,d)}Z3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(m,d)}$3a(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(m,d)}c4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(m,d)}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertParagraph(m,d)}e4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(m,A,R,d)}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertText(m,d)}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}Moa(d){const m=If.GraphIterator.eb(this.Mm);var A=null;switch(this.Mm.type){case 8:A=jv.grf(m,10,d);m.Bj(A);A=jv.grf(m,23,d);break;case 10:A=jv.grf(m,23,d);break;case 36:case 16:case 38:case 37:A=m.currentNode;break;default:v.ULS.sendTraceTag(16814430,369,10,"AppId:{0}, In function Body.GetLowestLayerOffSpringParagraphNode(). Body root graph node must be from one of Document/Section/Headfooter/TableCell/FootnoteEndnote.",this._context.appId),sc.a.Tf()}return this.G4l(A,
d)}G4l(d,m){let A=null;if(d&&(23===d.type||36===d.type||16===d.type||38===d.type||37===d.type)){d=If.GraphIterator.eb(d);let R,da;do if(R=d.currentNode,da=m?d.Jt(2)?d.Tb(2):d.Rd():d.Jt(2)?d.EJ(2):d.lY(),R&&da&&11===R.type&&12===da.type){A=da;break}while(d.currentNode&&d.Jz())}return A}DFm(d,m,A){if(void 0===m||null===m)return null;var R=2===A?d.J(0):d.J(d.count-1);const da=3!==A?!0:!1;m=sc.a.Fmc(m);let Ea=null;const ib=this.Moa(da);if(ib){var Qb=null;switch(A){case 2:Ea=m.pop();d=0;this.hd.KWc(ib)&&
(Qb=this.hd.eSd(ib),-1!==Qb&&(d=Qb+2>this.gb.textLength(ib)?this.gb.textLength(ib):Qb+2));Qb=jd.a.Uc(ib,d);Qb.Fb=Qb.Sb=R.Ln();this.jla.Ge(Qb,Ea);Ea.length?(Qb=jd.a.createTextRange(ib,d,d+Ea.length),this.hd.$u(Qb,2)):(Qb=jd.a.Uc(ib,0),Qb.Fb=Qb.Sb=R.Ln());break;case 3:Ea=m.shift();Qb=jd.a.tw(ib);Qb.Fb=Qb.Sb=R.Mn();this.jla.Ge(Qb,Ea);Ea.length?(Qb=jd.a.createTextRange(ib,Qe.ParagraphReader.textLength(ib)-Ea.length,Qe.ParagraphReader.textLength(ib)),this.hd.$u(Qb,2)):(Qb=jd.a.tw(ib),Qb.Fb=Qb.Sb=R.Mn());
break;case 4:Ea=m.pop(),Qb=this.GFm(d,Ea,ib)}R=this.hd.jCd(m,Qb.node,da);2===A?(0<Ea.length||!Ea.length&&!m.length)&&R.add(Qb):3===A?(0<Ea.length||!Ea.length&&!m.length)&&R.insert(0,Qb):R.add(Qb);return this.tk.create(R,this._context)}return null}GFm(d,m,A){8===this.Mm.type&&1<If.GraphIterator.eb(this.Mm).Wp()&&(v.ULS.sendTraceTag(18667733,369,15,"AppId:{0}, Body.InsertText cannot replace the content of the document that contains multiple sections.",this._context.appId),sc.a.pD());A=A.ra;A&&A.length||
(v.ULS.sendTraceTag(20030220,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty before replacing the body.",this._context.appId),sc.a.Tf());A=A.first.wna(null);this.hd.xCb(d);d=this.Moa(!0);var R=d.ra;R&&R.length||(v.ULS.sendTraceTag(20030221,369,15,"AppId:{0}, CharacterPropertiesArray is null or empty after replacing the body.",this._context.appId),sc.a.Tf());R.J(0).formatting=A.formatting.wf(R.J(0));A=0;this.hd.KWc(d)&&(R=this.hd.eSd(d),-1!==R&&(sc.a.Ylf()?A=R+2:(A=R+1,m=" "+m)));R=jd.a.Uc(d,
A);const da=this.gb.Ml(d,0);R.Fb=R.Sb=0<da?da/2:-1;this.jla.Ge(R,m);d=m.length?jd.a.createTextRange(d,A,A+m.length):jd.a.Uc(d,A);d.Fb=R.Ln();d.Sb=m.length?0<da?0:-1:R.Mn();return d}lia(d,m,A){const R=(new Date).getTime();let da=new U.a;switch(m){case 2:case 3:const Ea=this.Moa(2===m);da.add(jd.a.create(Ea));break;case 4:da=this.gb.Hz(this.Mm,!0,!1);break;default:v.ULS.sendTraceTag(18130833,369,15,"AppId:{0}, invalid insert location for body's insert Ooxml or insert Docx method",this._context.appId),
sc.a.qd()}this.hd.YJa(da.J(0),da.J(da.count-1));return OfficeExtension.WacRuntime.Utility.createPromise((Ea,ib)=>{this.ew.insertOoxml(da,d,m,this.Mm,this._context,Ea,ib,R,A?0:1)})}static grf(d,m,A){let R=null;if(d)if(A&&d.Rd()){do if(d.currentNode.type===m){R=d.currentNode;break}while(d.Oj());d.sc()}else if(!A&&d.lY()){do if(d.currentNode.type===m){R=d.currentNode;break}while(d.FJ());d.sc()}return R}}Object(y.a)(jv,"Body",ih.a,[841]);class Wy{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,
Be,Hg,Xh,Fl){this.Zta=null;this.Vn=d;this.tk=m;this.gB=A;this.fM=R;this.Yc=da;this.jla=Ea;this.gb=ib;this.iq=Qb;this.pA=pc;this.hd=Pc;this.Qw=gd;this.Ig=Cd;this.nA=ae;this.ew=Xd;this.om=se;this.$c=Xe;this.hn=Be;this.Ts=Hg;this.cX=Xh;this.Ow=Fl}Ju(d){this.Zta=d}create(d,m){return new jv(d,m,this.Vn,this.tk,this.gB,this.fM,this.Zta,this.Yc,this.jla,this.gb,this.iq,this.pA,this.hd,this.Qw,this.Ig,this.nA,this.ew,this.om,this.$c,this.hn,this.Ts,this.cX,this.Ow)}}Object(y.a)(Wy,"BodyFactory",null,[858]);
var Bu=c(890);class Vl extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb){super();sc.a.tpc(d,"CommentContentRange");this.Ed=d;this.w3=m;this.hd=A;this.LWa=R;this.Hla=da;this.om=Ea;this.Ts=ib;this.kq=Qb}get bold(){const d=this.bY();return d.EHc?null:1===d.bold}set bold(d){sc.a.iy(d,"Font.Bold");this.kq.Fs(this.Oga().currentNode)?d!=this.bold&&(d=d?new Bu.a(1):new Bu.a(0),this.Hla.Jza(this.Ed,xe.a.bold,d),this.MCb()):sc.a.zrb()}get hyperlink(){const d=this.om.pjb(this.Ed).returnValue;return d&&d.length?
d[0].hyperlink.url:null}set hyperlink(d){this.kq.Fs(this.Oga().currentNode)?(this.om.tmj(this.Ed,d,!1,this.w3),this.MCb()):sc.a.zrb()}get italic(){const d=this.bY();return d.Aec?null:1===d.italic}set italic(d){sc.a.iy(d,"Font.Italic");this.kq.Fs(this.Oga().currentNode)?d!=this.italic&&(d=d?new Bu.a(1):new Bu.a(0),this.Hla.Jza(this.Ed,xe.a.fz,d),this.MCb()):sc.a.zrb()}get isEmpty(){return this.text===sc.a.Dmb}get text(){return this.om.$Td(this.Ed,this.w3)}get strikeThrough(){const d=this.bY();return d.Pmc?
null:1===d.strikethrough}set strikeThrough(d){sc.a.iy(d,"Font.StrikeThrough");this.kq.Fs(this.Oga().currentNode)?d!=this.strikeThrough&&(d=d?new Bu.a(1):new Bu.a(0),this.Hla.Jza(this.Ed,xe.a.strikethrough,d),this.MCb()):sc.a.zrb()}get underline(){const d=this.bY();return d.TV?-1:[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0][d.underlineType]}set underline(d){this.kq.Fs(this.Oga().currentNode)?d!==this.underline&&(0===d?(this.Hla.Jza(this.Ed,xe.a.hka,17),this.MCb()):1===d?(this.Hla.Jza(this.Ed,xe.a.hka,
0),this.MCb()):sc.a.qd()):sc.a.zrb()}get _ReferenceId(){return this.yq?this.Tq:null}_KeepReference(){return this.rq()}_OnAccess(){sc.a.tpc(this.Ed,"CommentContentRange");for(const d of this.Ed)sc.a.o2(d.node,"CommentContentRange")}insertText(d,m){if(this.kq.Fs(this.Oga().currentNode)){var A=new If.GraphIterator;A.set(this.Ed.J(0).node);A.zb(40);A.jd(40);d=1<sc.a.Fmc(d).length?this.hd.CEm(this.Ed,d,m):this.hd.insertText(this.Ed,d,m);m=d.count;var R=d.J(m-1);R.contextId===ic.a.paragraph&&(R=jd.a.createTextRange(R.node,
0,Qe.ParagraphReader.textLength(R.node)),d.removeAt(m-1),d.add(R));d.J(0).contextId===ic.a.Vc&&d.removeAt(0);d=this.LWa.create(d,this.w3);({startIndex:m,endIndex:R}=d.Z$h(A));this.MCb();d.zsh(A,m,R);return d}sc.a.zrb()}getTypeName(){return"Microsoft.WordServices.CommentContentRange"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId;case 3:return this.isEmpty;case 4:return this.hyperlink;case 2:return this.text;case 5:return this.bold;case 6:return this.italic;case 7:return this.strikeThrough;
case 8:return this.underline}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 5:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 6:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 7:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 8:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1001:return this.Vh();case 1002:return this.Wh();
case 1003:return this.pGa(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(m,d)}bY(){const d=this.Hla.bY(this.Ed);
d||sc.a.Tf();return d}Z$h(d){let m=-1,A=-1;const R=d.Wp();if(0<R){d.Rd();for(let da=0;da<R;da++)d.Rd(),d.currentNode.id==this.Ed.J(0).node.id&&(m=da),d.currentNode.id==this.Ed.J(this.Ed.count-1).node.id&&(A=da),d.sc(),d.Oj()}d.zb(40);d.jd(40);return{startIndex:m,endIndex:A}}zsh(d,m,A){const R=new U.a;if(0<d.Wp()){d.Rd();for(let Ea=0,ib=0;Ea<A+1;Ea++,ib++){d.Rd();if(Ea>=m&&Ea<A+1){var da=this.Ed.J(ib-m);if(da.contextId===ic.a.Vc){Ea--;da=R.J(R.count-1).node;R.add(jd.a.tl(da));continue}else da.contextId===
ic.a.Fd?R.add(jd.a.createTextRange(d.currentNode,da.Wj,da.vp)):da.contextId===ic.a.paragraph&&R.add(jd.a.create(d.currentNode))}d.sc();d.Oj()}d.zb(40);d.jd(40);this.Ed=R}}MCb(){const d=this.Oga();let m=-1,A=-1;({startIndex:m,endIndex:A}=this.Z$h(d));this.Ts.m3k(d.currentNode);this.zsh(d,m,A)}Xp(){return this.Ed}Oga(){const d=new If.GraphIterator;d.set(this.Ed.J(0).node);d.zb(40);d.jd(40);return d}}Object(y.a)(Vl,"CommentContentRange",ih.a,[841]);class NB{constructor(d,m,A,R){this.hd=d;this.Hla=m;
this.om=A;this.kq=R}Ju(d){this.Ts=d}create(d,m){return new Vl(d,m,this.hd,this,this.Hla,this.om,this.Ts,this.kq)}}Object(y.a)(NB,"CommentContentRangeFactory",null,[858]);class Tz extends ih.a{constructor(d){super();sc.a.iy(d,"CommentReplyCollection");this.HVb=d}length(){return this.HVb.count}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.HVb.J(d);sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){return this.HVb&&
0<this.HVb.count?this.HVb.J(0):null}getItem(d){d=sc.a.hQ(d);return d<this.length()?this.HVb.J(d):null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.CommentReplyCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.fY(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Tz,"CommentReplyCollection",ih.a,[841,857]);class Cu extends ih.a{constructor(d,m,A,R,da,Ea,ib){super();sc.a.iy(d,"Comment GraphNodeContext");
this.qaa=d;this.w3=m;this.Ts=A;this.tk=R;this.Qid=da;this.LWa=Ea;this.gb=ib}get authorEmail(){return this.Ts.E7h(this.qaa)}get authorName(){return this.qaa.getValue(wc.a.e5b)}get content(){return this.Ts.F7h(this.qaa)}set content(d){this.Ts.vdg(d,this.qaa,!0)}get contentRange(){const d=If.GraphIterator.eb(this.qaa),m=d.Wp(),A=new U.a;if(0<m){d.Rd();for(let R=0;R<m;R++)d.Rd(),R===m-1?A.add(jd.a.createTextRange(d.currentNode,0,this.gb.textLength(d.currentNode))):A.add(jd.a.create(d.currentNode)),d.sc(),
d.Oj()}return this.LWa.create(A,this.w3)}set contentRange(d){this.Ts.llj(d,this.qaa)}get creationDate(){return this.qaa.getValue(wc.a.XDa)}get id(){return this.qaa.getValue(wc.a.hF)}get _ReferenceId(){return this.yq?this.Tq:null}get replies(){var d=this.Ts.TSl(this.qaa);const m=new U.a;for(const A of d)d=this.Qid.create(A,this.w3),m.add(d);return new Tz(m)}get resolved(){return this.qaa.ja(wc.a.Qba,!1)}set resolved(d){this.Ts.W7n(this.qaa,d)}reply(d){if(this.resolved)sc.a.pD();else return d=this.Ts.evk(this.qaa,
d),this.Qid.create(d,this.w3)}deleteObject(){this.Ts.deleteComment(this.qaa)}getRange(){const d=this.Ts.Gwa(this.qaa),m=new U.a;for(let A=0;A<d.length;A++){const R=d.J(A);m.add(R)}return this.tk.create(m,this.w3)}_KeepReference(){return this.rq()}_OnAccess(){sc.a.o2(this.qaa,"Comment")}getTypeName(){return"Microsoft.WordServices.Comment"}invokePropertyGet(d){switch(d){case 1:return this.authorEmail;case 2:return this.authorName;case 3:return this.content;case 9:return this.contentRange;case 4:return this.creationDate;
case 7:return this.replies;case 8:return this.resolved;case 5:return this.id;case 6:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 8:this.resolved=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 9:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,Vl);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1001:return this.Qoa(m);case 1002:return this.p5n(m);case 1003:return this.UD(m);case 1005:return this.Vh();case 1004:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Qoa(){return this.getRange()}p5n(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.reply(d)}UD(){this.deleteObject();return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Cu,"Comment",ih.a,[841]);class ug{constructor(d,m,A){this.Ts=this.tk=null;this.Qid=d;this.LWa=m;this.gb=A}Ju(d,m){this.tk=d;this.Ts=
m}create(d,m){return new Cu(d,m,this.Ts,this.tk,this.Qid,this.LWa,this.gb)}}Object(y.a)(ug,"CommentFactory",null,[858]);var Du=c(1845),it=c(1638);class Xy extends ih.a{constructor(d){super();sc.a.iy(d,"CommentCollection");this.fh=d}length(){return this.fh.count}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.fh.J(d);sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){return this.fh&&
0<this.fh.count?this.fh.J(0):null}getItem(d){d=sc.a.hQ(d);return d<this.length()?this.fh.J(d):null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.CommentCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.fY(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}fY(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Xy,"CommentCollection",ih.a,[841,857]);var Eu=c(1527);class Fu{constructor(d,m,A,R,da,Ea,ib,Qb){this.vLa=null;this.kq=d;m.execute(pc=>{this.vLa=pc});this.MWa=A;this.lVj=R;this.hb=da;this.gb=Ea;this.om=ib;this.Psc=Qb}insertComment(d,m,A){this.kq.glb(this.lVj,!1)||sc.a.pD();var R=new Pe.Selection(d.toArray(),!0);d&&0<=d.count&&
d.J(0)&&d.J(0).contextId==ic.a.Tc&&this.hb.HCj(R);if(this.gb.Xb(d.J(0).node)&&this.gb.Xb(d.J(d.count-1).node)){d=this.hb.ib.lb;this.hb.Ac(R);R=Du.a.tDb(null);const da=new it.a;da.Yca(m+"\n");R.text=[da.O9b()];this.vLa.addComment(R,null);this.vLa.uva(R);m=Rh.a.If(R.objectId);m=this.kq.xd.Eb(m);this.hb.Ac(d);return this.MWa.create(m,A)}sc.a.qd();return null}F7h(d){d=If.GraphIterator.eb(d);d=this.kq.ZFb(d);return this.N$l(d[0])}vdg(d,m,A){this.kq.Fs(m)?(m=this.kq.m0(m.id.toString()),this.kq.VMc(m,null),
this.kq.VMc(m,null),A?(A=new it.a,A.Yca(d+"\n"),m.text=[A.O9b()]):m.text=[d],this.kq.wgb(m)):sc.a.zrb()}deleteComment(d){this.vLa.deleteComment(this.kq.m0(d.id.toString()))}evk(d,m){d=this.kq.yLh(this.kq.m0(d.id.toString()).id,null);const A=new it.a;A.Yca(m+"\n");d.text=[A.O9b()];this.vLa.uva(d);m=Rh.a.If(d.objectId);return this.kq.xd.Eb(m)}gRd(d,m){var A=this.XSl(d);d=new U.a;for(const R of A)A=this.MWa.create(R,m),d.add(A);return new Xy(d)}Gwa(d){return this.kq.Tuf(d.id)}TSl(d){var m=this.Gwa(d);
m=m.Pa.node.ra.nh(m.Pa.cpBegin);const A=new U.a;d=d.getValue(wc.a.MH);if(m.Ue&&0<m.Ue.length)for(let R=0;R<m.Ue.length;R++)if(m.Ue.J(R).Qc){const da=m.Ue.J(R).XFb();d===da.ja(wc.a.AM,null)&&A.add(da)}return A}SSl(d){return this.kq.$D(d).objectId}E7h(d){d=d.ja(wc.a.yJc,"");return!sa.a.af(d)&&(d=d.split("::"),!fb.a.af(d)&&2<=d.length)?d[1]:null}XSl(d){const m=new U.a,A=d.count;for(let Ea=0;Ea<A;Ea++){var R=d.J(Ea);if(R.contextId===ic.a.Vc)continue;const ib=-1===R.cpEnd?R.vp:R.cpEnd;R=R.node.ra;for(let Qb=
0;Qb<R.length;Qb++){if(0>R.J(Qb).cp)continue;if(R.J(Qb).cp>ib)break;const pc=R.J(Qb);if(pc.Ue&&0<pc.Ue.length)for(let Pc=0;Pc<pc.Ue.length;Pc++){const gd=pc.Ue.J(Pc).XFb();var da=this.Gwa(gd);sa.a.af(gd.ja(wc.a.AM,null))&&!m.contains(gd)&&(da=this.om.RHh(d.J(0),d.J(A-1),da.J(0),da.J(da.length-1)),10!=da&&13!=da&&0!=da&&11!=da&&8!=da&&m.add(gd))}}}return m}N$l(d){if(""==d)return"";let m="";d=it.a.hGb(d);for(let A=0;A<d.ops.length-1;A++){const R=d.ops[A];null!=R.attributes&&null!=R.attributes.atmention?
(m+="@",m+=R.attributes.atmention.fullName):m+=R.insert?R.insert:"\n"}return m}BNl(d){const m=new U.a;for(const R of this.kq.H1e)if(!R.Df&&!sa.a.af(R.objectId)){var A=Rh.a.If(R.objectId);A=this.kq.xd.Eb(A);A=this.MWa.create(A,d);m.add(A)}return new Xy(m)}JSl(d,m){const A=new U.a;for(const da of this.kq.H1e)if(!da.Df&&!sa.a.af(da.objectId)){var R=Rh.a.If(da.objectId);R=this.kq.xd.Eb(R);if(this.wwi(d,R,!0)||this.wwi(d,R,!1))R=this.MWa.create(R,m),A.contains(R)||A.add(R)}return new Xy(A)}W7n(d,m){this.vLa.qCb(this.kq.m0(d.id.toString()),
m)}wwi(d,m,A){m=this.kq.xd.Eb(A?Eu.k(m):Eu.h(m));m=If.GraphIterator.eb(m);return m.zb(10)&&(m.jd(10),m.Gn.equals(d))?!0:!1}m3k(d){const m=this.kq.m0(d.id.toString());this.kq.VMc(m,null);d=If.GraphIterator.eb(d);d=this.kq.ZFb(d);m.text=d;this.kq.wgb(m)}llj(d,m){this.kq.Fs(m)||sc.a.zrb();const A=d.Xp().count,R=Array(A);for(let da=0;da<A;da++){const Ea=d.Xp().J(da).node;Ea.iJb=!0;R[da]=Ea}d=this.Psc.$mg(R)[0];this.vdg(d,m,!1)}}Object(y.a)(Fu,"CommentOperations",null,[1006]);class Uz extends ih.a{constructor(d,
m,A,R,da,Ea){super();sc.a.iy(d,"CommentReply GraphNodeContext");this.dBa=d;this.w3=m;this.Ts=A;this.ji=R;this.MWa=da;this.LWa=Ea}get authorEmail(){return this.Ts.E7h(this.dBa)}get authorName(){return this.dBa.getValue(wc.a.e5b)}get content(){return this.Ts.F7h(this.dBa)}set content(d){this.Ts.vdg(d,this.dBa,!0)}get contentRange(){const d=If.GraphIterator.eb(this.dBa),m=d.Wp(),A=new U.a;if(0<m){d.Rd();for(let R=0;R<m;R++)d.Rd(),A.add(jd.a.create(d.currentNode)),d.sc(),d.Oj()}return this.LWa.create(A,
this.w3)}set contentRange(d){this.Ts.llj(d,this.dBa)}get creationDate(){return this.dBa.getValue(wc.a.XDa)}get id(){return this.dBa.getValue(wc.a.hF)}get _ReferenceId(){return this.yq?this.Tq:null}get parentComment(){var d=this.dBa.ja(wc.a.AM,null);return sa.a.af(d)?null:(d=this.ji.value.Eb(Rh.a.If(this.Ts.SSl(d))),this.MWa.create(d,this.w3))}deleteObject(){this.Ts.deleteComment(this.dBa)}_KeepReference(){return this.rq()}_OnAccess(){sc.a.o2(this.dBa,"CommentReply")}getTypeName(){return"Microsoft.WordServices.CommentReply"}invokePropertyGet(d){switch(d){case 1:return this.authorEmail;
case 2:return this.authorName;case 3:return this.content;case 4:return this.creationDate;case 5:return this.id;case 6:return this._ReferenceId;case 7:return this.parentComment;case 8:return this.contentRange}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.content=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 8:this.contentRange=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,Vl);return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1002:return this.UD(m);case 1001:return this.Vh();case 1003:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Uz,"CommentReply",ih.a,[841]);class LA{constructor(d){this.MWa=this.Ts=null;this.ji=d}Ju(d,m,A){this.MWa=d;this.Ts=m;this.LWa=A}create(d,m){return new Uz(d,m,this.Ts,this.ji,this.MWa,this.LWa)}}Object(y.a)(LA,"CommentReplyFactory",null,[858]);var jt=c(941),kv=c(143);class Yt extends ih.a{constructor(d){super();
sc.a.iy(d,"RangeCollection");this.fba=d}length(){return this.fba.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){sc.a.Ai()||sc.a.zk();return this.fba&&this.fba.count?this.fba.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(d<this.length())return this.fba.J(d);v.ULS.sendTraceTag(18745302,369,10,"The index is out of the boundary of range list.");sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,
m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.RangeCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Yt,"RangeCollection",ih.a,[841,857]);class Yy extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em){super();sc.a.iy(d,"wacContentControl");this.We=d;this._context=m;this.$o=A;this.L2=R;this.Vn=da;this.tk=Ea;this.gB=ib;this.fM=Qb;this.iq=pc;this.pA=Pc;this.hd=gd;this.Ig=Cd;this.Qw=ae;this.nA=
Xd;this.ew=se;this.om=Xe;this.hn=Be;this.$c=Hg;this.gb=Xh;this.Ts=Fl;this.cX=Gm;this.Ow=em}get appearance(){return this.We.appearance}set appearance(d){this.egb("ContentControl.Appearance");this.We.appearance=d;jt.a.iHa(this.We.objectId)}get cannotDelete(){return!this.We.qia}set cannotDelete(d){this.egb("ContentControl.CannotDelete");d&&this.removeWhenEdited&&sc.a.qd();this.We.qia=!d;jt.a.iHa(this.We.objectId)}get cannotEdit(){return!this.We.isEditable}set cannotEdit(d){this.egb("ContentControl.CannotEdit");
this.We.isEditable=!d;jt.a.iHa(this.We.objectId)}get color(){return null==this.We.color?"#000000":$f.a.eF(this.We.color).toUpperCase()}set color(d){this.egb("ContentControl.Color");d=sc.a.hKa(d,"ContentControl.Color",this._context);d=parseInt(d,16);isNaN(d)?sc.a.qd():(this.We.color=d,jt.a.iHa(this.We.objectId))}get endnotes(){var d=this.We.lF();d=this.hd.nSd(d,1);d=this.hd.Gva(d,this._context);return new rs(d)}get fields(){return this.We.OJ?new iv(new U.a):new iv(this.Ow.qYl(this.We,this._context))}get contentControls(){if(sc.a.FAa){var d=
new Ch;d.types=[31];return this.getContentControls(d)}d=this.$o.lL(this.We.start,this.We.end,1);for(const m of d)if(m.id===this.We.id){d.remove(m);break}return this.Ig.TUd(d,this._context)}get font(){null==this._font&&(this._font=this.gB.create(1,null,this.We,null,this._context));n.AFrameworkApplication.pu&&this._font._OnAccess();return this._font}get footnotes(){var d=this.We.lF();d=this.hd.nSd(d,0);d=this.hd.Gva(d,this._context);return new rs(d)}get id(){return this.We.id}get inlinePictures(){const d=
this.We.lF(),m=new U.a;for(const A of d)this.Rbl(m,A);return new bp(m)}get lists(){return sc.a.Ai()?new ey(1,null,this.We,null,this._context,this.hn,null):null}get paragraphs(){const d=this.We.lF();let m=0;const A=new U.a;for(const R of d)A.add(this.Vn.create(R.node,this._context,m++));return new lr(A)}get parentBody(){if(!sc.a.Ai())return null;const d=this.We.lF();return this.$c.Rtf(d.J(0).node,d.J(d.count-1).node,this._context)}get parentContentControl(){const d=this.parentContentControlOrNullObject;
d||sc.a.Tk();return d}get parentContentControlOrNullObject(){var d;for(d=this.We.parentId;(d=this.$o.getById(d))&&!this.Ig.tWc(d);)d=d.parentId;return d?this.L2.create(d,this._context):null}get parentTable(){if(!sc.a.Ai())return null;const d=this.parentTableOrNullObject;d||sc.a.Tk();return d}get parentTableCell(){if(!sc.a.Ai())return null;const d=this.parentTableCellOrNullObject;d||sc.a.Tk();return d}get parentTableCellOrNullObject(){return sc.a.Ai()?this.$c.H$b(this.We.start.node,this._context,this.We.end.node):
null}get parentTableOrNullObject(){return sc.a.Ai()?this.$c.Ejb(this.We.start.node,this._context,this.We.end.node):null}get placeholderText(){let d=this.We.placeholderText;d||(d=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);return d}set placeholderText(d){kv.a.oda?(d=sc.a.kKc(d),this.We.OJ&&(this.insertText(d,4),this.We.OJ=!0),this.We.placeholderText=d):(v.ULS.sendTraceTag(20833952,369,15,"AppId:{0}, set placeholder text for contentcontrol on wac is not allowed.",this._context.appId),
sc.a.pD())}get removeWhenEdited(){return this.We.removeWhenEdited}set removeWhenEdited(d){this.egb("ContentControl.RemoveWhenEdited");d&&this.cannotDelete&&sc.a.qd();this.We.removeWhenEdited=d;jt.a.iHa(this.We.objectId)}get style(){const d=this.We.lF();return this.pA.PQc(d)}set style(d){this.egb("ContentControl.Style");const m=this.We.lF();this.pA.olc(m,d);jt.a.iHa(this.We.objectId)}get styleBuiltIn(){if(!sc.a.Ai())return-1;const d=this.We.lF();return this.pA.oSd(d)}set styleBuiltIn(d){sc.a.Ai()||
sc.a.zk();const m=this.We.lF();this.pA.ihe(m,d);jt.a.iHa(this.We.objectId)}get Of(){return this.We.Of}get rlg(){if(!this.We.type){const d=If.GraphIterator.eb(this.We.start.node);if(d.zb(14))return d.jd(14)}}get Rvj(){if(!this.We.type)return this.We.start?this.We.start.node:void 0}get subtype(){if(!sc.a.Ai())return 0;if(sc.a.FAa)return this.sgm();if(!this.We.type){if(this.We.Of){const A=this.We.start.node,R=this.We.end.node;var d=If.GraphIterator.eb(A);if(d.zb(14)){var m=d.jd(14);d=this.gb.$k(m);m=
this.gb.XC(m);if(d&&m&&A.id===d.id&&R.id===m.id)return 16}return 2}return 1}return 0}get tables(){return sc.a.Ai()?new ox(1,null,null,this.We,this._context,this.$c):null}get tag(){return this.We.tag}set tag(d){this.egb("ContentControl.Tag");sc.a.iy(d,"Tag");this.We.tag=d;jt.a.iHa(this.We.objectId)}get text(){return this.We.OJ?"":this.We.getText()}getReviewedText(d){return this.We.OJ?"":this.cX.xcm(this.We,d)}get title(){return this.We.title}set title(d){this.egb("ContentControl.Title");sc.a.iy(d,
"Title");this.We.title=d;jt.a.iHa(this.We.objectId)}get type(){if(sc.a.FAa)switch(this.We.type){case 1:return 96}return 31}get _ReferenceId(){return this.yq?this.Tq:null}clear(){sc.a.dfd()?this.XZk():this.WZk()}deleteContentControl(d){sc.a.dfd()?this.$kl(d):this.Zkl(d)}getComments(){return this.Ts.gRd(this.We.lF(),this._context)}getContentControls(d){var m;d=null!==(m=null===d||void 0===d?void 0:d.types)&&void 0!==m?m:[];sc.a.BNc(d);m=this.$o.lL(this.We.start,this.We.end,1);for(var A of m)if(A.id===
this.We.id){m.remove(A);break}A=this.Ig.TUd(m,this._context);return 0===d.length?A:null===A||void 0===A?void 0:A.getByTypes(d)}getHtml(){const d=this.We.lF();return this.ew.getHtml(d.toArray(),this._context)}getOoxml(){const d=(new Date).getTime();this._context.Jm.WH();const m=this.We.lF();return OfficeExtension.WacRuntime.Utility.createPromise((A,R)=>{this.ew.getOoxml(m,this._context,A,R,d)})}getRange(d){sc.a.Ai()||sc.a.zk();1!==d&&2!==d&&d&&5!==d&&4!==d&&3!==d&&(v.ULS.sendTraceTag(18745292,369,
15,"AppId:{0}, rangeLocation of ContentControl.GetRange must be Start/End/Whole/Content/Before/After.",this._context.appId),sc.a.qd());var m=d;3===d&&(m=1);var A=this.We.lF(),R=A.J(0),da=A.J(A.count-1);if(da.contextId===ic.a.paragraph&&4===d){var Ea=(Ea=this.gb.textLength(da.node))?jd.a.createTextRange(da.node,0,Ea):jd.a.tw(da.node);A.removeAt(A.count-1);A.add(Ea);this.om.klc(R,da,A,!1)}m=this.om.D9b(A,m);A&&m&&0<A.count&&0<m.count&&(R=A.J(0),A=A.J(A.count-1),da=m.J(0),Ea=m.J(m.count-1),1===d?da.Fb=
Ea.Sb=R.Fb+1:2===d?da.Fb=Ea.Sb=A.Sb-1:5===d&&(da.Fb=R.Fb+1,Ea.Sb=A.Sb-1));return this.tk.create(m,this._context)}getTextRanges(d,m){sc.a.Ai()||sc.a.zk();var A=this.We.lF();d=this.om.Yvf(A,d,m);m=new U.a;for(A=0;A<d.length;A++)m.add(this.tk.create(d[A],this._context,A));return new Yt(m)}insertBreak(d,m){const A=(new Date).getTime();2!==m&&3!==m&&m&&1!==m&&(v.ULS.sendTraceTag(19158349,369,15,"AppId:{0}, invalid insert location for ContentControl.InsertBreak.",this._context.appId),sc.a.qd());this.HEb(m);
let R=!1;if(6===d||(sc.a.dqe()||this.We.Of)&&!d)R=this.Acc(m);const da=new U.a;da.add(this.kGb(m));R&&this.Ig.VEa();return OfficeExtension.WacRuntime.Utility.createPromise((Ea,ib)=>{this.hd.insertBreak(da,d,m,this._context,Ea,ib,A)})}insertFileFromBase64(d,m){"<"===d.charAt(0)&&(v.ULS.sendTraceTag(18130834,369,10,"invalid argument for insertFileFromeBase64 API in ContentControl class.",this._context.appId),sc.a.qd());this.We.isEditable||sc.a.Rnc(this._context.appId,"ContentControl.InsertFileFromBase64",
void 0,Wn[m]);this.HEb(m);return this.lia(d,m,!1)}insertHtml(d,m){this.HEb(m);return sc.a.dfd()?this.kEm(d,m):this.jEm(d,m)}insertInlinePictureFromBase64(d,m){this.HEb(m);return this.pVc(d,m)}insertOoxml(d,m){"<"!==d.charAt(0)&&(v.ULS.sendTraceTag(18130835,369,10,"invalid argument for InsertOoxml API in ContentControl class.",this._context.appId),sc.a.qd());this.HEb(m);return this.lia(d,m,!0)}insertParagraph(d,m){2!==m&&3!==m&&m&&1!==m&&(v.ULS.sendTraceTag(21070048,369,15,"AppId:{0}, Invalid insert location for ContentControl.InsertPparagraph method.",
this._context.appId),sc.a.qd());sc.a.dqe()||2!==m&&3!==m||this.We.Of||sc.a.Rnc(this._context.appId,"ContentControl.InsertParagraph",void 0,Wn[m]);this.HEb(m);const A=this.Acc(m),R=new U.a;R.add(this.kGb(m));2===m?m=0:3===m&&(m=1);A&&this.Ig.VEa();return this.Vn.create(this.hd.insertParagraph(R,d,m),this._context)}insertTable(d,m,A,R){sc.a.Ai()||sc.a.zk();2!==A&&3!==A&&A&&1!==A&&(v.ULS.sendTraceTag(20971524,369,15,"Invalid argument for InsertTable API in ContentControl class.",this._context.appId),
sc.a.qd());sc.a.dqe()||2!==A&&3!==A||this.We.Of||sc.a.Rnc(this._context.appId,"ContentControl.InsertParagraph",void 0,Wn[A]);this.HEb(A);const da=this.Acc(A),Ea=new U.a;Ea.add(this.kGb(A));2===A?A=0:3===A&&(A=1);da&&this.Ig.VEa();return this.$c.insertTable(Ea,d,m,A,R,this._context)}insertText(d,m){2!==m&&3!==m&&4!==m&&(v.ULS.sendTraceTag(21284488,369,15,"AppId:{0}, invalid location for ContentControl.InsertText: {1}.",this._context.appId,Wn[m]),sc.a.qd());var A=sc.a.Fmc(d);!sc.a.dqe()&&1<A.length&&
!this.We.Of&&sc.a.Rnc(this._context.appId,"ContentControl.InsertText","Attempt to insert multi-line text into an inline content control",Wn[m]);if(this.We.OJ&&1===A.length&&""===A[0])return this.tk.create(this.a$b(),this._context);if(!sc.a.dfd()&&(this.We.OJ||4===m))return this.We.bie(d)&&sc.a.Tf(),this.tk.create(this.a$b(),this._context);A=this.Acc(m);let R=new U.a;switch(m){case 2:case 3:R.add(this.kGb(m));break;case 4:R=this.a$b()}A&&this.Ig.VEa();return this.tk.create(this.hd.insertText(R,d,m),
this._context)}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.We.lF();this.nA.find(R,d,m,A,this._context)})}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.We.lF();this.nA.rib(R,d,m,A,this._context)})}select(d){switch(d){case 0:this.Ig.select(this.We);break;case 1:case 2:if(this.We.OJ)this.Ig.select(this.We);else{const m=1===d?this.We.start:this.We.end;let A;this.iq.select((A=new U.a,A.add(m),A),d)}}}split(d,m,A,R){sc.a.Ai()||
sc.a.zk();const da=this.We.lF();if(da&&0<da.count){let Ea;(Ea=da.J(0)).Fb=Ea.Fb+1;let ib;(ib=da.J(da.count-1)).Sb=ib.Sb-1}d=this.om.Emc(da,d,m,A,R);m=new U.a;for(A=0;A<d.length;A++)m.add(this.tk.create(d[A],this._context,A));return new Yt(m)}_KeepReference(){this.rq()}_OnAccess(){this.We.isValid()||(v.ULS.sendTraceTag(17155413,369,15,"AppId:{0}, Should not access invalid contentcontrol object.",this._context.appId),sc.a.Tf())}getTypeName(){return"Microsoft.WordServices.ContentControl"}invokePropertyGet(d){switch(d){case 7:return this.appearance;
case 10:return this.cannotDelete;case 11:return this.cannotEdit;case 8:return this.color;case 15:return this.contentControls;case 30:return this.endnotes;case 31:return this.fields;case 12:return this.font;case 29:return this.footnotes;case 1:return this.id;case 17:return this.inlinePictures;case 19:return this.lists;case 14:return this.paragraphs;case 25:return this.parentBody;case 16:return this.parentContentControl;case 26:return this.parentContentControlOrNullObject;case 22:return this.parentTable;
case 21:return this.parentTableCell;case 27:return this.parentTableCellOrNullObject;case 28:return this.parentTableOrNullObject;case 5:return this.placeholderText;case 9:return this.removeWhenEdited;case 13:return this.style;case 24:return this.styleBuiltIn;case 23:return this.subtype;case 20:return this.tables;case 4:return this.tag;case 18:return this.text;case 3:return this.title;case 6:return this.type;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 7:this.appearance=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 10:this.cannotDelete=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 11:this.cannotEdit=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 8:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 5:this.placeholderText=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 9:this.removeWhenEdited=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 13:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 24:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 4:this.tag=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1010:return this.RDa();case 1011:return this.UD(m);case 1021:return this.$Fb();case 1023:return this.uFa(m);case 1013:return this.pGb();case 1016:return this.Qoa(m);
case 1019:return this.nSc(m);case 1007:return this.qpa(m);case 1018:return this.e4a(m);case 1003:return this.pGa(m);case 1012:return this.iea(m);case 1017:return this.xRb(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1014:return this.SGb();case 1008:return this.W3a(m);case 1006:return this.opa(m);case 1004:return this.Z3a(m);case 1009:return this.$3a(m);case 1005:return this.c4a(m);
case 1015:return this.nra(m);case 1020:return this.Wka(m);case 1022:return this.fHb(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}RDa(){this.clear();return null}UD(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");this.deleteContentControl(d);return null}$Fb(){return this.getComments()}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ch);return this.getContentControls(d)}pGb(){return this.getHtml()}SGb(){return this.getOoxml()}Qoa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}nSc(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(m,d)}fHb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}W3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertBreak(m,d)}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(m,d)}Z3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(m,d)}$3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(m,d)}c4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(m,d)}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(m,d)}e4a(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(m,A,R,d)}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(m,
d)}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}xRb(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"Array<string>"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.split(m,A,R,d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}isValid(){return this.We.isValid()}Rbl(d,m){const A=new U.a;this.Qw.FSd(A,m);if(!(0>=A.count))for(const R of A)d.add(this.fM.create(R,this._context))}lia(d,m,
A){const R=(new Date).getTime();if(2===m||3===m||4===m){const da=this.We.lF();return OfficeExtension.WacRuntime.Utility.createPromise((Ea,ib)=>{const Qb=A?0:1;this.ew.insertOoxml(da,d,m,da.J(0).node,this._context,Ea,ib,R,Qb,this.We.id)})}v.ULS.sendTraceTag(18130836,369,15,"AppId:{0}, ContentControl.InsertOoxmlOrDocx: undefined location!",this._context.appId);sc.a.qd();return null}egb(d){this.We.isSupported||(v.ULS.sendTraceTag(19417247,369,15,"AppId:{0}, {1}: currently is not supported as the contentcontrol is no-supported on WAC!",
this._context.appId,d),sc.a.pD())}kGb(d){var m=null;switch(d){case 0:case 2:var A=this.We.start;m=this.We.Of?0:A.cpBegin;m=jd.a.Uc(A.node,m);m.Fb=d?m.Sb=A.Ln():m.Sb=A.Ln()-1;break;case 1:case 3:A=this.We.end,m=this.We.Of?A.node.characterData.length:A.cpEnd,m=jd.a.Uc(A.node,m),m.Fb=1===d?m.Sb=A.Mn()+1:m.Sb=A.Mn()}return m}a$b(){if(sc.a.i6o()&&!this.We.Of&&!this.We.start)return new U.a;const d=this.We.lF();let m;(m=d.J(0)).Fb=m.Fb+1;let A;(A=d.J(d.count-1)).Sb=A.Sb-1;return d}Acc(d){let m=!1;!this.We.OJ||
2!==d&&3!==d&&4!==d||(m=!0,this.Ig.gEb(),this.clear(),this.We.OJ=!1);return m}jEm(d,m){sc.a.upc(d,"ContentControl.InsertHtml");if(!this.We.isEditable)return sc.a.Rnc(this._context.appId,"ContentControl.InsertHtml",void 0,Wn[m]),null;const A=(new Date).getTime();if(this.We.u0d||this.We.Bdc)return v.ULS.sendTraceTag(19482261,369,15,"AppId:{0}, content control with Binding is not allowed for insertHtml API in ContentControl class.",this._context.appId),sc.a.pD(),null;if(2===m||3===m||4===m){const R=
this.We.lF(),da=this.We.contentControlNode;let Ea=this.We.id;return this.$o.ZOb(Ea)?(v.ULS.sendTraceTag(19482262,369,15,"AppId:{0}, failed to release content control for insertHtml API in ContentControl class.",this._context.appId),sc.a.Tf(),null):this.ew.insertHtml(R,d,m,A,this._context,!0).then(()=>{let ib=!1;if(1===R.count&&R.J(0).contextId===ic.a.Tc){ib=!0;let Qb=new U.a;Qb.add(R.J(0));Qb=this.hd.insertText(Qb," ",3);R.Z(0,Qb.J(0))}if(({id:Ea}=this.$o.ssk(R,da)).returnValue)return v.ULS.sendTraceTag(19482263,
369,10,"AppId:{0}, failed to restore the content control for insertHtml API in ContentControl class.",this._context.appId),sc.a.Tf(),null;this.We=this.$o.getById(Ea);ib&&this.We.bie("");return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.tk.create(R,this._context))})}v.ULS.sendTraceTag(19482264,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId);sc.a.qd();return null}kEm(d,m){const A=(new Date).getTime();sc.a.upc(d,"ContentControl.InsertHtml");
const R=this.Acc(m);let da=new U.a;switch(m){case 2:case 3:da.add(this.kGb(m));break;case 4:da=this.a$b();break;default:v.ULS.sendTraceTag(22062857,369,15,"AppId:{0}, invalid argument for insertHtml API in ContentControl class.",this._context.appId),sc.a.qd()}R&&this.Ig.VEa();return this.ew.insertHtml(da,d,m,A,this._context)}WZk(){this.We.clear()&&sc.a.Tf()}XZk(){this.hd.xCb(this.a$b())}Zkl(d){(d?this.$o.ZOb(this.id):this.$o.Nkl(this.id))&&sc.a.Tf()}$kl(d){d?(d=!1,this.We.OJ&&(d=!0,this.Ig.gEb(),
this.clear()),this.$o.ZOb(this.id)&&sc.a.Tf(),d&&this.Ig.VEa()):this.hd.R6b(this.We.lF())}get contentControlNode(){return this.We.contentControlNode}get sP(){return this.We.contentControlNode.sP}set sP(d){this.We.contentControlNode.sP=d}set text(d){n.AFrameworkApplication.pu&&this.We.bie(d)}pVc(d,m,A){const R=(new Date).getTime();let da=null,Ea=!1;switch(m){case 4:Ea=!0;this.Ig.gEb();this.clear();da=this.kGb(2);break;case 3:case 2:Ea=this.Acc(m);da=this.kGb(m);break;default:v.ULS.sendTraceTag(20047956,
369,15,"AppId:{0}, invalid argument for insertInlinePictureFromBase64 API in ContentControl class.",this._context.appId),sc.a.qd()}da||(v.ULS.sendTraceTag(20047957,369,50,"AppId:{0}, user wants to insert an image into content control but a wrong place or something wrong.",this._context.appId),sc.a.Tf());Ea&&this.Ig.VEa();let ib;this.hd.ZT((ib=new U.a,ib.add(da),ib),m,0);n.AFrameworkApplication.pu&&A?(this._context.Jm.Iu(),m=this.Qw.HIb(d,da,this._context,A)):m=this.Qw.HIb(d,da,this._context);return m.then(Qb=>
{n.AFrameworkApplication.pu||this._context.Jm.Iu();if(!Qb)return v.ULS.sendTraceTag(20047958,369,10,"AppId:{0}, something went wrong when insert iamge into ContentControl.",this._context.appId),sc.a.$M("ContentControl.InsertInlinePictureFromBase64",sc.a.zN(R),d.length,!1),sc.a.Tf(),null;sc.a.$M("ContentControl.InsertInlinePictureFromBase64",sc.a.zN(R),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.fM.create(this.Qw.wOc(Qb),this._context))})}dGb(){if(n.AFrameworkApplication.pu)return this.We.lF()}sgm(){return this.Ig.tWc(this.We)?
0===this.We.type?this.We.Of?this.IHk()?16:2:1:1===this.We.type?this.We.Of?64:32:0:0}IHk(){const d=this.We.start.node,m=this.We.end.node;var A=If.GraphIterator.eb(d);if(A.zb(14)){var R=A.jd(14);A=this.gb.$k(R);R=this.gb.XC(R);if(A&&R&&d.id===A.id&&m.id===R.id)return!0}return!1}HEb(d){96===this.type&&0!==d&&1!==d&&sc.a.pD()}}Object(y.a)(Yy,"ContentControl",ih.a,[841]);class MA{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd){this.$c=this.Ig=this.fM=this.tk=this.Vn=null;this.gB=d;this.$o=m;this.iq=A;this.pA=
R;this.hd=da;this.Qw=Ea;this.nA=ib;this.ew=Qb;this.om=pc;this.hn=Pc;this.gb=gd;this.WZj=Cd}Ju(d,m,A,R,da,Ea,ib){this.Vn=d;this.tk=m;this.fM=A;this.Ig=R;this.$c=da;this.cX=Ea;this.Ow=ib}create(d,m){return new Yy(d,m,this.$o,this,this.Vn,this.tk,this.gB,this.fM,this.iq,this.pA,this.hd,this.Ig,this.Qw,this.nA,this.ew,this.om,this.hn,this.$c,this.gb,this.WZj,this.cX,this.Ow)}}Object(y.a)(MA,"ContentControlFactory",null,[858]);class px extends ih.a{constructor(d){super();sc.a.iy(d,"ContentCollection");
this.Esa=d}length(){return this.Esa.count}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.Esa.J(d);v.ULS.sendTraceTag(17093347,369,10,"The index is out of the ContentControlCollection range.");sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getByChangeTrackingStates(d){sc.a.j6o()||sc.a.zk();if(null===d||void 0===d||!d.length)return null;let m=0;for(const A of d)0<=A&&4>=A?m|=A:sc.a.qd();d=new U.a;for(const A of this.Esa)A.isValid()&&(null!=A.contentControlNode.Zu?
this.cEf(m,4)&&d.add(A):null!=A.contentControlNode.Yv?this.cEf(m,2)&&d.add(A):this.cEf(m,1)&&d.add(A));return new px(d)}getById(d){(d=this.getByIdOrNullObject(d))||sc.a.Tk();return d}getByIdOrNullObject(d){let m=null;for(const A of this.Esa)if(A.id===d&&A.isValid()){m=A;break}return m}getByTag(d){return this.u6h(m=>m.tag===d)}getByTitle(d){return this.u6h(m=>m.title===d)}getByTypes(d){sc.a.Ai()||sc.a.zk();const m=new U.a;for(const A of this.Esa)if(A.isValid())for(const R of d)if(0<(A.subtype&R)){m.add(A);
break}return new px(m)}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){sc.a.Ai()||sc.a.zk();return this.Esa&&0<this.Esa.count?this.Esa.J(0):null}getItem(d){d=sc.a.hQ(d);return this.getById(d)}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.ContentControlCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1010:return this.CQl(m);case 1002:return this.SPc(m);case 1008:return this.TPc(m);case 1004:return this.GQl(m);case 1003:return this.HQl(m);
case 1006:return this.Zof(m);case 1007:return this.HG();case 1009:return this.IG();case 1:return this.fY(m);case 1001:return this.Vh();case 1005:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}getContentControls(){return this.Esa&&0<this.Esa.count?Array.from(this.Esa):[]}CQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,
"Array<int>");return this.getByChangeTrackingStates(d)}SPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getById(d)}TPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getByIdOrNullObject(d)}GQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByTag(d)}HQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByTitle(d)}Zof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"Array<int>");return this.getByTypes(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.getItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}cEf(d,m){return 0!==(d&m)}u6h(d){if(!d)return null;const m=new U.a;for(const A of this.Esa)d(A)&&A.isValid()&&m.add(A);return new px(m)}}Object(y.a)(px,"ContentControlCollection",ih.a,[841,857]);class fy{constructor(d,
m,A,R,da,Ea,ib,Qb,pc,Pc,gd){this.$o=d;this.DI=m;this.L2=A;this.hd=R;this.rH=da;this.jm=Ea;this.FCe=ib;this.Lo=Qb;this.gb=pc;this.Un=Pc;this.iq=gd}get OD(){return null!=this.Lxg?this.Lxg:this.Lxg=(()=>this.FCe())()}tWc(d){if(sc.a.FAa)switch(d.type){case 1:case 0:return!0;default:return!1}let m=!1;switch(d.type){case 0:m=!0}return m}m5h(d=null){const m=this.$o.CNl();return this.TUd(m,d)}dac(d,m,A=null){d=this.$o.lL(d,m,1);return this.TUd(d,A)}TUd(d,m=null){if(!d||!this.L2)return null;const A=new U.a;
for(const R of d)this.tWc(R)&&A.add(this.L2.create(R,m));return new px(A)}Cgm(d,m=null){d=this.gb.Hz(d,!0,!1);return 0>=d.count?null:this.dac(d.J(0),d.J(d.count-1),m)}Nei(d,m){return this.$o.lL(d,m,3,!0)}eac(d,m,A=null){m=this.$o.lL(d,m,3,!0);d=null;if(0<m.count)if(this.tWc(m.J(0)))d=m.J(0);else for(m=m.J(0),m=m.parentId;m=this.$o.getById(m);){if(this.tWc(m)){d=m;break}m=m.parentId}return d?this.L2.create(d,A):null}j1e(d){if(d.count){var m=d.J(0),A=d.J(d.count-1);if(m.contextId===ic.a.Vc){var R=this.gb.textLength(m.node)?
jd.a.tw(m.node):jd.a.create(m.node);R.Fb=m.Ln();R.Sb=m.Mn();m===A&&(A=R);m=R}A.contextId!==ic.a.Vc||this.gb.textLength(A.node)||(R=jd.a.create(A.node),R.Sb=A.Mn(),A=R);if((Em.SelectionEditor.pv(m)&&Em.SelectionEditor.olb(m)||this.gb.um(m))&&Em.SelectionEditor.pv(A)&&Em.SelectionEditor.olb(A)){R=this.Lo.y2a(m.node,m.Wj,m.Fb,!0);const da=this.Lo.y2a(A.node,A.vp,A.Sb,!1);if(!R&&!da||R&&da&&R.me.equals(da.me)&&R.Of)R=jd.a.create(A.node),R.Fb=A.Fb,R.Sb=A.Sb,A=R}d.Z(0,m);d.Z(d.count-1,A)}}Uma(d,m,A,R=0,
da=!1){let Ea=0;if(d=({id:Ea}=this.$o.zrk(d,m,R,da)).returnValue){if(da)return d;v.ULS.sendTraceTag(17148101,369,15,"AppId:{0}, failed to create a new block content control.",A.appId);sc.a.Tf();return null}if(da)return d;da=this.$o.getById(Ea);jt.a.z3d(da.objectId);da.type=R;return this.L2.create(da,A)}E_a(d,m,A=0,R=!1){let da=0;if(d=({id:da}=this.$o.E_a(d,null,A,R)).returnValue){if(R)return d;v.ULS.sendTraceTag(17148102,369,15,"AppId:{0}, failed to create a new inline content control.",m.appId);
sc.a.Tf();return null}if(R)return d;R=this.$o.getById(da);if(n.AFrameworkApplication.pu&&R&&null===R.start)return 2;jt.a.z3d(R.objectId);R.type=A;return this.L2.create(R,m)}uU(d,m){return this.$o.uU(d,m)}G4a(d){return this.rH.G4a(d)}gEb(){this.DI&&this.DI.gEb("RelateToSelection")}VEa(){this.DI&&this.DI.VEa("RelateToSelection")}select(d){this.jm.select(d.objectId,!0)}kdd(d){this.OD&&Em.SelectionEditor.Ze(d)&&this.OD.kdd(d)}RJa(d,m){if(!this.OD||!Em.SelectionEditor.Ze(d))return d;var A=m.J(0),R=jd.a.Uc(A.node,
A.Wj);R.Sb=R.Fb=A.Fb;A=m.J(m.count-1);var da=jd.a.Uc(A.node,A.vp);da.Sb=da.Fb=A.Sb;A=Em.SelectionEditor.Kk(A)||A.contextId===ic.a.paragraph;const Ea=new U.a;Ea.add(R);Ea.add(da);for(R=this.ebi(d.node,d.cpBegin,d.Fb);R;){da=d.node.id;d=this.Uwl(R,d,Ea);if(!d.node.id.equals(da)&&(R=this.Lo.Y7h(d.node,R.me),!R)){v.ULS.sendTraceTag(36459329,369,15,"Failed to find content control start boundary after split.");sc.a.Tf();break}this.Twl(R,Ea);R=this.Lo.Y7h(R.Lb.paragraph,R.me);da=R.Lb.Jb.AJ(R.me,!0);R=jd.a.Uc(R.Lb.paragraph,
R.Lb.cp);R.Sb=R.Fb=da+1;if(!this.OD.RJa(R)){v.ULS.sendTraceTag(36459330,369,15,"Failed to Convert inline content control to block.");sc.a.Tf();break}R=this.ebi(d.node,d.cpBegin,d.Fb)}A=this.p6l(Ea,A);!m.count||A&&A.count||(v.ULS.sendTraceTag(36459332,369,15,"GncList is empty after conversion"),sc.a.Tf());m.clear();m.addRange(A);return d}Uwl(d,m,A){if(!d.Lb.cp)return m;A.add(m);this.jvj(d,!0,A);m=A.J(A.count-1);A.removeAt(A.count-1);return m}Twl(d,m){(d=this.Lo.uTl(d))?d.Lb.cp!==this.gb.textLength(d.Lb.paragraph)&&
this.jvj(d,!1,m):(v.ULS.sendTraceTag(36459333,369,15,"Failed to find content control end boundary."),sc.a.Tf())}jvj(d,m,A){var R=d.Lb;d=R.Jb.AJ(d.me,d.Qc);R=jd.a.Uc(R.paragraph,R.cp);R.Sb=R.Fb=d+(m?0:1);m=new U.a;for(var da of A)m.add(this.K3b(da,R));({F6b:da}=this.hd.Pbc(R,!1));da=this.Un.Ee(da);for(d=0;d<A.count;d++)A.Z(d,this.i2l(A.J(d),R,da,m.J(d)))}uEf(d,m){return d.node.id.equals(m.node.id)&&(d.cpBegin>m.cpBegin||d.cpBegin===m.cpBegin&&d.Ln()>m.Ln())}YJk(d,m){return this.K3b(d,m)}K3b(d,m=null,
A=!1){return m&&!this.uEf(d,m)?null:this.Lo.y2a(d.node,d.cpBegin,d.Fb,A)}v8n(d,m,A,R){this.Tee(d,m,A,R)}Tee(d,m,A=null,R=null,da=!1){A&&R&&!this.uEf(A,R)||(A=d.node.ra.nh(da?d.Wj:d.vp))&&A.Jb&&A.Jb.length&&(m=m?A.Jb.AJ(m.me,m.Qc):-1,m=da?0<=m?m+1:0:0<=m?m:A.Jb.length,d.contextId===ic.a.Tc?d.Sb=d.Fb=m:da?d.Fb=m:d.Sb=m)}i2l(d,m,A,R){if(!this.uEf(d,m))return d;A=jd.a.Uc(A,d.cpBegin-m.cpBegin);this.Tee(A,R,d,m);return A}ebi(d,m,A){d=this.Lo.a9(d,m,A);for(const R of d)if(!R.Of)return R;return null}p6l(d,
m){const A=d.J(0);d=d.J(d.count-1);return this.iq.U$h(A,d,m)}}Object(y.a)(fy,"ContentControlOperations",null,[1005]);class NA extends ih.a{constructor(d){super();this.J1j=d}get body(){sc.a.pD();return null}get contentControls(){sc.a.pD();return null}get customXmlParts(){sc.a.pD();return null}get properties(){sc.a.pD();return null}get saved(){return!1}get sections(){sc.a.pD();return null}get settings(){sc.a.pD();return null}get _ReferenceId(){return this.yq?this.Tq:null}addStyle(){sc.a.pD();return null}deleteBookmark(){sc.a.pD()}getBookmarkRange(){sc.a.pD();
return null}getBookmarkRangeOrNullObject(){sc.a.pD();return null}getContentControls(){sc.a.pD();return null}insertFileFromBase64(){sc.a.pD();return null}getStyles(){sc.a.pD();return null}open(){return OfficeExtension.WacRuntime.Utility.createPromise(d=>{const m=new xb.StandardDialog;m.Cd=4;m.sv(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,A=>{1===A&&cb.a.vm(this.J1j,void 0,void 0,"ExtensionPackage.OpenDialog");d(null)})})}save(){sc.a.pD()}_KeepReference(){this.rq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.DocumentCreated"}invokePropertyGet(d){switch(d){case 3:return this.body;
case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1028:return this.R_e(m);case 1011:return this.Lef(m);case 1010:return this.Sof(m);case 1012:return this.Tof(m);case 1013:return this.uFa(m);case 1029:return this.wvf();case 1005:return this.pbg(m);case 1008:return this.Vh();case 1007:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1009:return this.Oxn();
case 1014:return this.opa(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}R_e(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.addStyle(m,d)}Lef(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.deleteBookmark(d);return null}Sof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
return this.getBookmarkRange(d)}Tof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRangeOrNullObject(d)}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ch);return this.getContentControls(d)}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,Qn);return this.insertFileFromBase64(m,
A,d)}wvf(){return this.getStyles()}Oxn(){return this.open()}pbg(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.save(m,d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(NA,"DocumentCreated",ih.a,[841]);class OB{create(d){return new NA(d)}}Object(y.a)(OB,"DocumentCreatedFactory",null,[]);var PB=c(218),gy=c(247);class OA extends ih.a{constructor(d,
m,A,R,da){super();this._context=d;this.Mk=m;this.xaa=A;this.Zbk=R;this.eXa=da}length(){return this.getCount()}_GetItem(d){if(sc.a.hQ(d)<this.length())return this.xaa.J(d);sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getCount(){this.x9a();return this.xaa.count}getItem(d){(d=this.getItemOrNullObject(d))||sc.a.Tk();return d}getItemOrNullObject(d){this.x9a();for(let m=0;m<this.xaa.count;m++)if(this.xaa.J(m).id==d)return this.xaa.J(m);return null}getOnlyItem(){const d=this.getOnlyItemOrNullObject();
d||sc.a.Tk();return d}getOnlyItemOrNullObject(){this.x9a();return 1==this.getCount()?this.xaa.J(0):null}x9a(){const d=this.Mk.DPc(),m=new U.a;for(let A=0;A<d.length;A++)if(d[A].namespace===this.Zbk){const R=this.eXa.create(d[A],this._context);d[A].builtIn&&0!=m.count?m.insert(0,R):m.add(R)}this.xaa=m}_KeepReference(){this.rq()}_OnAccess(){this._context.Jm.M4b(this.Mk.fha.currentNode)}getAsyncEnumerator(d,m){this.x9a();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartScopedCollection"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.A2a();case 2:return this.fY(m);case 1004:return this.S2a(m);case 1005:return this.S7l();case 1006:return this.T7l();
case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}A2a(){return this.getCount()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}S2a(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}S7l(){return this.getOnlyItem()}T7l(){return this.getOnlyItemOrNullObject()}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}}Object(y.a)(OA,"CustomXmlPartScopedCollection",ih.a,[841,857]);class vq extends ih.a{constructor(d,m,A,R,da){super();this._context=d;this.Mk=m;this.xaa=A;this.eXa=R;this.Lc=da}length(){return this.getCount()}_GetItem(d){if(sc.a.hQ(d)<this.length())return this.xaa.J(d);sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}add(d){let m=null;({C1c:m}=this.Mk.UZe(d)).returnValue!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&sc.a.qd();d=
new $s(m,this.Lc);return this.eXa.create(d,this._context)}getByNamespace(d){this.x9a();const m=this.xaa,A=new U.a;for(let R=0;R<m.count;R++)m[R].namespace===d&&A.add(this.eXa.create(m[R],this._context));return 0==A.count?null:new OA(this._context,this.Mk,A,d,this.eXa)}getCount(){this.x9a();return this.xaa.count}getItem(d){(d=this.getItemOrNullObject(d))||sc.a.Tk();return d}getItemOrNullObject(d){this.x9a();for(let m=0;m<this.xaa.count;m++)if(this.xaa.J(m).id==d)return this.xaa.J(m);return null}x9a(){const d=
this.Mk.DPc(),m=new U.a;for(let A=0;A<d.length;A++){const R=this.eXa.create(d[A],this._context);d[A].builtIn&&0!=m.count?m.insert(0,R):m.add(R)}this.xaa=m}_KeepReference(){this.rq()}_OnAccess(){this._context.Jm.M4b(this.Mk.fha.currentNode)}getAsyncEnumerator(d,m){this.x9a();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.CustomXmlPartCollection"}invokePropertyGet(d){switch(d){case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1004:return this.dGc(m);case 1005:return this.FQl(m);case 1003:return this.A2a();case 2:return this.fY(m);case 1006:return this.S2a(m);
case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}dGc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.add(d)}FQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByNamespace(d)}A2a(){return this.getCount()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getItem(d)}S2a(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(vq,"CustomXmlPartCollection",ih.a,[841,857]);var Iq=c(1616);class lv extends ih.a{constructor(d){super();sc.a.iy(d,"SectionCollection");this.dDc=d}length(){return this.dDc.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();
d||sc.a.Tk();return d}getFirstOrNullObject(){sc.a.Ai()||sc.a.zk();return this.dDc&&this.dDc.count?this.dDc.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(0<=d&&d<this.length())return this.dDc.J(d);v.ULS.sendTraceTag(16814432,369,10,"The index is out of the section range.");sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.SectionCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(lv,"SectionCollection",ih.a,[841,857]);class Dw extends ih.a{constructor(d,m,A){super();this.o3=d;this.Zea=m;this.r_=A}get key(){return this.o3}get value(){return this.r_.get(this.o3).getValue(wc.a.k3b)}set value(d){this.r_.get(this.o3).setValue(wc.a.k3b,
d)}get _Id(){return null}get _ReferenceId(){return this.yq?this.Tq:null}deleteObject(){const d=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled"),m=new If.GraphIterator;m.set(this.Zea);let A=m.Tb(21);for(;A;){if(A.getValue(wc.a.OGc)===this.o3){m.z1a(!d);break}A=m.Lf(21)}d&&this.Zea.OA(21);this.Zea.setValue(Me.a.QR,new Date);this.r_.delete(this.o3)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.r_.get(this.o3),"Setting")}getTypeName(){return"Microsoft.WordServices.Setting"}invokePropertyGet(d){switch(d){case 2:return this.key;
case 3:return this.value;case 4:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,
m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.UD(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Dw,"Setting",
ih.a,[841]);class PA extends ih.a{constructor(d,m){super();this.Zea=d;this.q0b=m;this.r_=new Map}get _ReferenceId(){return this.yq?this.Tq:null}add(d,m){d||sc.a.qd();this.eKa();if(this.r_.has(d))this.r_.get(d).setValue(wc.a.k3b,m),this.Zea.setValue(Me.a.QR,new Date);else{const A=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled");m=this.q0b.ucf(d,m);const R=Eg.a.create(),da=new If.GraphIterator;da.set(this.Zea);da.Q3(m,21,new Rh.a(R,1),!A);A&&this.Zea.OA(21);
this.Zea.setValue(Me.a.QR,new Date);this.r_.set(d,m)}return new Dw(d,this.Zea,this.r_)}deleteAll(){this.r_.clear();const d=!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSettingsChangedEventIsEnabled"),m=new If.GraphIterator;for(m.set(this.Zea);m.Tb(21);)m.z1a(!d);d&&this.Zea.OA(21);this.Zea.setValue(Me.a.QR,new Date)}getCount(){this.eKa();return this.r_.size}getItem(d){this.eKa();(d=this.gsf(d))||sc.a.Tk();return d}getItemOrNullObject(d){this.eKa();return this.gsf(d)}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,
m){this.eKa();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.SettingCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.dGc(m);case 1005:return this.Ief();case 1004:return this.A2a();case 1:return this.fY(m);case 1006:return this.S2a(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}length(){return this.r_.size}_GetItem(d){d=
sc.a.hQ(d);if(0>d||d>=this.r_.size)return sc.a.qd(),null;const m=this.r_.keys();let A="";for(let R=0;R<=d;R++)A=m.next().value;return this.gsf(A)}dGc(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");return this.add(m,d)}Ief(){this.deleteAll();return null}A2a(){return this.getCount()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItem(d)}S2a(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}eKa(){this.r_.clear();const d=new If.GraphIterator;d.set(this.Zea);let m=d.Tb(21);for(;m;){const A=m.getValue(wc.a.OGc);this.r_.set(A,m);m=d.Lf(21)}}gsf(d){return this.r_.has(d)?new Dw(d,this.Zea,this.r_):null}}Object(y.a)(PA,"SettingCollection",ih.a,[841,857]);class QB extends ih.a{constructor(d,m){super();this._style=
d;this.ev=m}get alignment(){if(this._style.hasProperty(Me.a.Jh))switch(this._style.getValue(Me.a.Jh)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(d){let m=0;switch(d){case 0:m=1;break;case 2:m=3;break;case 1:m=2;break;case 3:m=6;break;default:v.ULS.sendTraceTag(509097629,369,15,"set ParagraphFormat.Alignment with not supported value: {0}.",d),sc.a.qd()}d=new Map;d.set(Me.a.Jh,m);this.XB(d)}get firstLineIndent(){if(this._style.hasProperty(wc.a.RA)){const d=
this._style.getValue(wc.a.RA);return Jg.a.Lea(d)}}set firstLineIndent(d){d=Jg.a.mE(d);const m=new Map;0<=d?m.set(wc.a.RA,d):m.set(wc.a.qt,d);this.XB(m)}get keepTogether(){if(this._style.hasProperty(Gg.a.keepTogether))return this._style.getValue(Gg.a.keepTogether)}set keepTogether(d){sc.a.iy(d,"ParagraphFormat.KeepTogether");const m=new Map;m.set(Gg.a.keepTogether,d);this.XB(m)}get keepWithNext(){if(this._style.hasProperty(Gg.a.keepWithNext))return this._style.getValue(Gg.a.keepWithNext)}set keepWithNext(d){sc.a.iy(d,
"ParagraphFormat.KeepWithNext");const m=new Map;m.set(Gg.a.keepWithNext,d);this.XB(m)}get leftIndent(){if(this._style.hasProperty(wc.a.ee)){const d=this._style.getValue(wc.a.ee);return Jg.a.Lea(d)}}set leftIndent(d){const m=new Map;m.set(wc.a.ee,Jg.a.mE(d));this.XB(m)}get lineSpacing(){if(this._style.hasProperty(wc.a.xa)){const d=this._style.getValue(wc.a.xa);return Jg.a.Lea(d)}}set lineSpacing(d){sc.a.ZVa(d,"ParagraphFormat.LineSpacing");const m=new Map;m.set(wc.a.xa,Jg.a.mE(d));this.XB(m)}get lineUnitAfter(){if(this._style.hasProperty(wc.a.YY))return this._style.getValue(wc.a.YY)/
100;if(this._style.hasProperty(wc.a.ua)){const d=this._style.getValue(wc.a.ua);return Jg.a.Lea(d)/12}}set lineUnitAfter(d){sc.a.YVa(d,"ParagraphFormat.LineUnitAfter");const m=new Map;m.set(wc.a.YY,100*d);m.set(wc.a.B5,!1);this.XB(m)}get lineUnitBefore(){if(this._style.hasProperty(wc.a.ZY))return this._style.getValue(wc.a.ZY)/100;if(this._style.hasProperty(wc.a.Ui)){const d=this._style.getValue(wc.a.Ui);return Jg.a.Lea(d)/12}}set lineUnitBefore(d){sc.a.YVa(d,"ParagraphFormat.LineUnitBefore");const m=
new Map;m.set(wc.a.ZY,100*d);m.set(wc.a.C5,!1);this.XB(m)}get mirrorIndents(){}set mirrorIndents(d){}get outlineLevel(){if(this._style.hasProperty(wc.a.Ti))return this._style.getValue(wc.a.Ti)}set outlineLevel(d){if(0>d||9<d)v.ULS.sendTraceTag(509097628,369,10,"Set OutlineLevel with not supported value: {0}.",d),sc.a.qd();const m=new Map;m.set(wc.a.Ti,d);this.XB(m)}get rightIndent(){if(this._style.hasProperty(wc.a.xu)){const d=this._style.getValue(wc.a.xu);return Jg.a.Lea(d)}}set rightIndent(d){const m=
new Map;m.set(wc.a.xu,Jg.a.mE(d));this.XB(m)}get spaceAfter(){if(this._style.hasProperty(wc.a.YY))return this._style.getValue(wc.a.YY)/100*12;if(this._style.hasProperty(wc.a.ua)){const d=this._style.getValue(wc.a.ua);return Jg.a.Lea(d)}}set spaceAfter(d){sc.a.YVa(d,"ParagraphFormat.SpaceAfter");const m=new Map;m.set(wc.a.ua,Jg.a.mE(d));m.set(wc.a.B5,!1);this._style.Cg(wc.a.YY);this.XB(m)}get spaceBefore(){if(this._style.hasProperty(wc.a.ZY))return this._style.getValue(wc.a.ZY)/100*12;if(this._style.hasProperty(wc.a.Ui)){const d=
this._style.getValue(wc.a.Ui);return Jg.a.Lea(d)}}set spaceBefore(d){sc.a.YVa(d,"ParagraphFormat.SpaceBefore");const m=new Map;m.set(wc.a.Ui,Jg.a.mE(d));m.set(wc.a.C5,!1);this._style.Cg(wc.a.ZY);this.XB(m)}get widowControl(){if(this._style.hasProperty(Gg.a.widowControl))return this._style.getValue(Gg.a.widowControl)}set widowControl(d){sc.a.iy(d,"ParagraphFormat.WidowControl");const m=new Map;m.set(Gg.a.widowControl,d);this.XB(m)}get _ReferenceId(){return this.yq?this.Tq:null}_KeepReference(){return this.rq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.ParagraphFormat"}invokePropertyGet(d){switch(d){case 2:return this.alignment;
case 3:return this.firstLineIndent;case 4:return this.keepTogether;case 5:return this.keepWithNext;case 6:return this.leftIndent;case 7:return this.lineSpacing;case 8:return this.lineUnitAfter;case 9:return this.lineUnitBefore;case 10:return this.mirrorIndents;case 11:return this.outlineLevel;case 12:return this.rightIndent;case 13:return this.spaceAfter;case 14:return this.spaceBefore;case 15:return this.widowControl;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 2:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 3:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 4:this.keepTogether=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 5:this.keepWithNext=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 6:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 7:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 8:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 9:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 10:this.mirrorIndents=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 11:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 12:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 13:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 14:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 15:this.widowControl=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}XB(d){const m=this._style.getValue(wc.a.ma),A=new Kl.ScriptSharpLegacyMap;for(const R of d)A.Z(R[0],R[1]);this.ev.LSa(m,A,vg.a.zr())}}Object(y.a)(QB,"ParagraphFormat",ih.a,[841]);class qj extends ih.a{constructor(d,m,A){super();this.gB=d;this._style=m;this.ev=A;this.jfk=new QB(this._style,this.ev);this._font=this.gB.create(null,null,null,null,null,this._style)}get baseStyle(){if(this._style.hasProperty(wc.a.pa))return this._style.getValue(wc.a.pa)}get builtIn(){}get description(){}get font(){return this._font}get inUse(){if(this._style.hasProperty(wc.a.sDi))return this._style.getValue(wc.a.sDi)}get linked(){return this._style.hasProperty(wc.a.linkedStyle)?
!0:!1}get listTemplate(){return null}get nameLocal(){return this._style.getValue(Td.a.la)}get nextParagraphStyle(){if(this._style.hasProperty(Td.a.ae))return this._style.getValue(Td.a.ae)}get paragraphFormat(){return this.jfk}get priority(){if(this._style.hasProperty(Gg.a.oa))return this._style.getValue(Gg.a.oa)}set priority(d){sc.a.YVa(d,"Style.Priority");this.XB(Gg.a.oa,d)}get quickStyle(){if(this._style.hasProperty(wc.a.Hd))return this._style.getValue(wc.a.Hd)}set quickStyle(d){sc.a.iy(d,"Style.QuickStyle");
this.XB(wc.a.Hd,d)}get type(){return this._style.getValue(Td.a.na)}get unhideWhenUsed(){if(this._style.hasProperty(wc.a.unhideWhenUsed))return this._style.getValue(wc.a.unhideWhenUsed)}set unhideWhenUsed(d){sc.a.iy(d,"Style.UnhideWhenUsed");this.XB(wc.a.unhideWhenUsed,d)}get visibility(){if(this._style.hasProperty(wc.a.lfb))return this._style.getValue(wc.a.lfb)}set visibility(d){sc.a.iy(d,"Style.Visibility");this.XB(wc.a.lfb,d)}get _ReferenceId(){return this.yq?this.Tq:null}deleteObject(){const d=
new U.a;d.add(this._style.getValue(wc.a.ma));this.ev.ERh(d)}_KeepReference(){return this.rq()}_OnAccess(){}getTypeName(){return"Microsoft.WordServices.Style"}invokePropertyGet(d){switch(d){case 2:return this.baseStyle;case 3:return this.builtIn;case 4:return this.description;case 5:return this.font;case 6:return this.inUse;case 7:return this.linked;case 16:return this.listTemplate;case 8:return this.nameLocal;case 9:return this.nextParagraphStyle;case 15:return this.paragraphFormat;case 10:return this.priority;
case 11:return this.quickStyle;case 12:return this.type;case 13:return this.unhideWhenUsed;case 14:return this.visibility;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 10:this.priority=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 11:this.quickStyle=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 13:this.unhideWhenUsed=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 14:this.visibility=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
m){switch(d){case 1003:return this.UD(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}XB(d,m){const A=this._style.getValue(wc.a.ma),R=new Kl.ScriptSharpLegacyMap;R.Z(d,m);this.ev.LSa(A,R,vg.a.zr())}}
Object(y.a)(qj,"Style",ih.a,[841]);class Ct extends ih.a{constructor(d,m,A){super();this.CLe=new Map;this.w_g=new Map;this.gB=d;this.syd=m;this.ev=A}length(){return this.syd.DO}_GetItem(d){if(sc.a.hQ(d)<this.length())return this.w_g.get(d);v.ULS.sendTraceTag(508941208,369,10,"The index is out of the style collection range.");sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:null}getByName(d){(d=this.getByNameOrNullObject(d))||sc.a.Tk();return d}getByNameOrNullObject(d){if(this.CLe.has(d))return this.CLe.get(d);
var m=this.syd.QFa(d);return m?(m=new qj(this.gB,m,this.ev),this.CLe.set(d,m),m):null}getCount(){return this.syd.DO}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){this.Fqg();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}Fqg(){for(let d=0;d<this.length();d++){const m=new qj(this.gB,this.syd.PFa(d),this.ev);this.w_g.set(d,m)}}getTypeName(){return"Microsoft.WordServices.StyleCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.DQl(m);case 1004:return this.EQl(m);case 1005:return this.A2a();case 1:return this.XV(m);case 1002:return this.Vh();
case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}DQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByName(d)}EQl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getByNameOrNullObject(d)}A2a(){return this.getCount()}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Ct,"StyleCollection",ih.a,[841,857]);class Rv{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep,Mm,Mk,gm){this.xFb=gm;this.Pte=new Fk.a;this.DZn=()=>{this._RemoveAllReferences()};this.uIk=()=>{this._context.Jm.Iu()};sc.a.iy(d,"Document");this.Eu=d;this._context=m;this.NN=A;this.Zta=R;this.tk=da;this.ga=Ea;this.hb=ib;this.lA=Qb;this.Yk=pc;Pc.v0e(this.DZn);
this.Y5j=gd;this.Ig=Cd;this.Cub=ae;this.mWj=Xd;this.Bn=se;this.gb=Xe;this.nA=Be;this.ew=Hg;this.cX=Xh;this.Mk=Fl;this.eXa=Gm;this.Lc=em;this.q0b=$n;this.rz=Ep;this.ev=Mm;this.gB=Mk}get context(){return this._context}get allowCloseOnUntitled(){return!1}set allowCloseOnUntitled(d){sc.a.zk()}get body(){return this.NN.create(this.lA.hP(this.Eu.value),this._context)}get changeTrackingMode(){return this.cX.vRl()}set changeTrackingMode(d){this.cX.Mho(this.ga,d)}get contentControls(){if(sc.a.FAa){const d=
new Ch;d.types=[31];return this.getContentControls(d)}return this.Ig.m5h(this._context)}get customXmlParts(){sc.a.f6o()||sc.a.zk();const d=this.Mk.DPc(),m=new U.a;for(let A=0;A<d.length;A++){const R=this.eXa.create(d[A],this._context);d[A].builtIn&&0!=m.count?m.insert(0,R):m.add(R)}return new vq(this._context,this.Mk,m,this.eXa,this.Lc)}get properties(){sc.a.Ai()||sc.a.zk("Getter");return this.Cub}get saved(){return!this.Y5j()}get sections(){const d=If.GraphIterator.eb(this.lA.hP(this.Eu.value)),
m=new U.a;let A=0;this.Yk.RPa(d,R=>{m.add(this.Zta.create(R,this._context,A++));return!0});return new lv(m)}get settings(){this.context.nk||sc.a.Tf();const d=this.q0b.Sib(this.Eu,this.lA);d||sc.a.Tf();let m=this.q0b.Cwa(this.context.nk,d.currentNode);m||(m=this.q0b.Nkb(this.context.nk,d.currentNode));m||sc.a.Tf();return new PA(m,this.q0b)}get _ReferenceId(){return null}addStyle(d,m){sc.a.dxj()||sc.a.zk();const A=vg.a.zr(),R=new Ze.GraphTransaction(15);R.Db(A);R.Uj=xe.a.vDb;const da=new PB.a(new gy.a);
try{const Ea=sa.a.uY(d);da.setValue(wc.a.ma,sa.a.lza(Ea));da.setValue(Td.a.la,Ea);da.setValue(Td.a.styleName,Ea);da.setValue(Td.a.F6a,Ea);da.setValue(Td.a.na,m);da.setValue(Me.a.highlight,$f.a.auto);da.setValue(Td.a.vx,$f.a.auto);da.setValue(wc.a.Hd,!0);da.setValue(wc.a.le,!0);da.setValue(wc.a.pa,Ul.StyleReader.wordStyleIdNormal);da.Cg(wc.a.XK);d=[];d.push(da);vg.a.$Fc(d,A)}finally{R.dispose()}return new qj(this.gB,da,this.ev)}deleteBookmark(d){(d=this.Bn.Dwa(d))&&this.Bn.Z$i(d.id)}getAnnotationsByType(d){this._context.Jm.WH();
this._context.Jm.Iu();let m;this.Pte.nb(d)?m=this.Pte.J(d):(m=this.mWj.create(d,this._context),this.Pte.add(d,m));return m.refresh().then(()=>OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m))}getBookmarkRange(d){(d=this.getBookmarkRangeOrNullObject(d))||sc.a.Tk();return d}getBookmarkRangeOrNullObject(d){const m=this.Bn.vei(d);if(!m||m&&0==m.count)return null;const A=new U.a;d=this.Bn.Dwa(d);var R=this.Bn.Ewa(d,!0);var da=m.J(0);if(1==m.count){var Ea=this.Bn.Ewa(d,!1);Ea=Ea.Hba.Lb.cp;
R=R.Hba.Lb.cp;da=this.gb.textLength(da)===Ea-R?jd.a.create(da):jd.a.createTextRange(da,R,Ea)}else Ea=R.Hba.Lb.cp,da=0===Ea?jd.a.create(da):jd.a.createTextRange(da,Ea,this.gb.textLength(da));A.add(da);for(da=1;da<m.count;da++)da!=m.count-1?A.add(jd.a.create(m.J(da))):da==m.count-1&&(Ea=this.Bn.Ewa(d,!1))&&(R=m.J(da),Ea=Ea.Hba.Lb.cp,Ea=this.gb.textLength(R)===Ea?jd.a.create(R):jd.a.createTextRange(m.J(da),0,Ea),A.add(Ea));return this.tk.create(A,this._context)}getContentControls(d){var m;d=null!==(m=
null===d||void 0===d?void 0:d.types)&&void 0!==m?m:[];sc.a.BNc(d);m=this.Ig.m5h(this._context);return 0===d.length?m:null===m||void 0===m?void 0:m.getByTypes(d)}getEndnoteBody(){sc.a.mPc()||sc.a.zk();return this.NN.create(this.I$h(0),this._context)}getFootnoteBody(){sc.a.mPc()||sc.a.zk();return this.NN.create(this.I$h(1),this._context)}getMetadata(){sc.a.zk();return null}getNeighborhoodTextAroundSelection(){sc.a.zk();return null}iem(){var d=this.hb.ib.lb;if(!d)return"NoSelection";d=d.toArray();for(let m=
0;m<d.length;m++){const A=d[m];if(A.contextId===ic.a.W7&&19===A.node.type)return"TextBoxSelection"}return"ValidSelection"}getSelection(){var d=this.hb.ib.lb;d||sc.a.Tf();d=d.toArray();const m=new U.a;for(let A=0;A<d.length;A++){const R=d[A];R.contextId===ic.a.W7&&19===R.node.type&&sc.a.pD();m.add(R)}return this.tk.create(m,this._context)}insertFileFromBase64(d,m,A){sc.a.VLj()||sc.a.zk();"<"===d.charAt(0)&&(v.ULS.sendTraceTag(509110469,369,10,"invalid argument for insertFileFromBase64 API in Document class.",
this._context.appId),sc.a.qd());null===A&&(A=new Qn);return this.XDm(d,m,A)}getStyles(){sc.a.dxj()||sc.a.zk();return new Ct(this.gB,this.rz.Ar(),this.ev)}launchTapPane(){sc.a.zk()}save(){this._context.Jm.WH();this.ga.WIn(xe.a.TPb,this.uIk)}close(){}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.Eu.value,!0,!0,!0);this.nA.find(R,d,m,A,this._context)})}setMetadata(){sc.a.zk()}setMetadataOnTile(){sc.a.zk()}setNavigationPaneVisibility(d){this.ga.processAction(d?
Ac.a.imc:Ac.a.jJc,2)}_GetObjectByReferenceId(d){return Iq.a.instance.OOd(d)}_GetObjectTypeNameByReferenceId(d){return Iq.a.instance.OOd(d).getTypeName()}_KeepReference(){}_OnAccess(){}_RegisterEvent(d,m){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,d,m)}_RemoveAllReferences(){Iq.a.instance.pZk()}_RemoveReference(d){Iq.a.instance.d0n(d)}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.Eu.value,!0,!0,!0);this.nA.rib(R,
d,m,A,this._context)})}_UnregisterEvent(d,m){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,d,m)}getTypeName(){return"Microsoft.WordServices.Document"}invokePropertyGet(d){switch(d){case 9:return this.allowCloseOnUntitled;case 3:return this.body;case 10:return this.changeTrackingMode;case 4:return this.contentControls;case 8:return this.customXmlParts;case 6:return this.properties;case 1:return this.saved;case 2:return this.sections;case 7:return this.settings;
case 5:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 9:this.allowCloseOnUntitled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 10:this.changeTrackingMode=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1028:return this.R_e(m);case 1011:return this.Lef(m);case 1010:return this.Sof(m);case 1012:return this.Tof(m);case 1026:return this.uFa(m);case 1013:return this.Usf(m);case 1017:return this.i6l(m);case 1006:return this.nem();case 1029:return this.wvf();case 1016:return this.F0m(m);case 1005:return this.pbg(m);case 1027:return this.h0k(m);
case 1014:return this.veg(m);case 1015:return this.Tlo(m);case 1021:return this.amo(m);case 1001:return this.yUj(m);case 1002:return this.zUj(m);case 1008:return this.Vh();case 1007:return this.Wh();case 1018:return this.BUj(m);case 1004:return this.FUj();case 1003:return this.GUj(m);case 1019:return this.LUj(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1020:return this.COl(m);case 1022:return this.nra(m);case 1023:return this.Wka(m);
case 1025:return this.AXl();case 1024:return this.JZl();case 1030:return this.opa(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}R_e(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.addStyle(m,d)}Lef(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.deleteBookmark(d);return null}XDm(d,m,A){const R=(new Date).getTime();
let da=new U.a;const Ea=this.lA.hP(this.Eu.value);switch(m){case 2:var ib=this.gb.$k(Ea);da.add(jd.a.create(ib));break;case 3:ib=this.gb.XC(Ea);da.add(jd.a.create(ib));break;case 4:da=this.gb.Hz(Ea,!0,!1);break;default:v.ULS.sendTraceTag(509110468,369,15,`AppId:${this._context.appId}, invalid insert location for document's insert Docx method`,this._context.appId),sc.a.qd()}return OfficeExtension.WacRuntime.Utility.createPromise((Qb,pc)=>{this.ew.insertOoxml(da,d,m,Ea,this._context,Qb,pc,R,1,0,!1,
null,A)})}COl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getAnnotationsByType(d)}Sof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRange(d)}Tof(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getBookmarkRangeOrNullObject(d)}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ch);return this.getContentControls(d)}AXl(){return this.getEndnoteBody()}JZl(){return this.getFootnoteBody()}Usf(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMetadata(d)}i6l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.getNeighborhoodTextAroundSelection(d)}nem(){return this.getSelection()}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,Qn);return this.insertFileFromBase64(m,
A,d)}wvf(){return this.getStyles()}F0m(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.launchTapPane(d);return null}pbg(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.save(m,d);return null}h0k(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.close(d);return null}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,d)}veg(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.setMetadata(m,d);return null}Tlo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"any");this.setMetadataOnTile(m,A,d);return null}amo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");this.setNavigationPaneVisibility(d);return null}yUj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this._GetObjectByReferenceId(d)}zUj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this._GetObjectTypeNameByReferenceId(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}BUj(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this._RegisterEvent(m,d);return null}FUj(){this._RemoveAllReferences();return null}GUj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this._RemoveReference(d);return null}LUj(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this._UnregisterEvent(m,d);return null}I$h(d){const m=this.lA.hP(this.Eu.value);(d=this.xFb.LQc(m,d))||sc.a.Tk();return d}}Object(y.a)(Rv,"Document",null,[]);class Sv{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep,Mm,Mk,gm){this.px=d;this.context=m;this.GLk=A;this.Tco=R;this.XPn=da;this.oc=Ea;this.mb=ib;this.hi=Qb;this.Uf=pc;
this.x3b=Pc;this.nP=gd;this.W$e=Cd;this.p7b=ae;this.gDk=Xd;this.GKl=se;this.Vi=Xe;this.Cco=Be;this.PCl=Hg;this.uNo=Xh;this.h1a=Fl;this.fil=Gm;this.Yr=em;this.Dqo=$n;this.eVa=Ep;this.d6=Mm;this.nIl=Mk;this.xFb=gm}create(){return new Rv(this.px,this.context,this.GLk,this.Tco,this.XPn,this.oc,this.mb,this.hi,this.Uf,this.x3b,this.nP,this.W$e,this.p7b,this.gDk,this.GKl,this.Vi,this.Cco,this.PCl,this.uNo,this.h1a,this.fil,this.Yr,this.Dqo,this.eVa,this.d6,this.nIl,this.xFb)}}Object(y.a)(Sv,"DocumentFactory",
null,[]);class qx{constructor(d,m){this.Khh=this.QDc=null;this.cUe=d;this.Lc=m;this.kH()}get eH(){return this.Khh}kH(){const d=this.cUe.getValue(wc.a.PPh);this.QDc!==d&&(this.QDc=d,this.Khh=rb.b(this.QDc))}N7a(){const d=this.Lc.Pc(4);d.Db(this.cUe);this.QDc=rb.c(this.eH);this.cUe.setValue(wc.a.PPh,this.QDc);d.dispose()}}Object(y.a)(qx,"StandardPropertyDocument",null,[1026]);class cp extends $s{constructor(d,m){super(d,m)}Sfi(){return this.selectNodes("//ns0:property",null).length}Rfi(d){const m=this.selectNodes("//ns0:property",
null);for(const A of m)if(this.getKey(A).toLowerCase()===d.toLowerCase())return A;return null}dbm(d){const m=this.selectNodes("//ns0:property",null);return 0<=d&&d<m.length?m[d]:null}Tuk(d,m){if(void 0!==d&&null!==d&&void 0!==m&&null!==m){const A=this.selectSingleNode("//ns0:Properties",null);if((d=this.ebm(d,m))&&this.appendChild(A,d))return this.o7n(),!0}return!1}Fkl(){if(this.Sfi()){for(var d=this.selectSingleNode("//ns0:Properties",null);d.hasChildNodes();)d.removeChild(d.firstChild);this.save()}}getKey(d){if(void 0===
d||null===d)return null;d=this.selectSingleNode("@name",d);return void 0!==d&&null!==d?this.getNodeText(d):null}she(d,m){if(void 0===d||null===d||void 0===m||null===m)return!1;d=this.selectSingleNode("@name",d);return void 0!==d&&null!==d?this.setNodeText(d,m):!1}getType(d){return void 0!==d&&null!==d?this.getNodeBaseName(d.firstChild):null}getValue(d){return void 0!==d&&null!==d?this.getNodeText(d.firstChild):null}setValue(d,m){return void 0!==d&&null!==d&&void 0!==m&&null!==m?(m=this.eki(m),!!m&&
!!this.setNodeXml(d.firstChild,m)):!1}Ell(d){void 0!==d&&null!==d&&void 0!==d.parentNode&&null!==d.parentNode&&(d.parentNode.removeChild(d),this.save())}ebm(d,m){return(m=this.eki(m))?'<property xmlns="'+cp.xKd+'" fmtid="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}" pid="2" name="'+sa.a.zf(d)+'">'+m+"</property>":null}eki(d){var m=Object.getType(d);let A=null;m===Number?A=parseInt(String(d))===d?cp.SJj:cp.RJj:m===String?(m=RegExp("[0-9]{4}(-[0-9]{2}){2}T[0-9]{2}(:[0-9]{2}){2}\\.[0-9]{3}Z","g").exec(d),
A=void 0!==m&&null!==m&&0<m.length&&m[0]===d?cp.QJj:cp.TJj,d=sa.a.zf(d)):m===Boolean&&(A=cp.PJj);return A?"<vt:"+A+' xmlns:vt="'+cp.H2o+'">'+d+"</vt:"+A+">":null}o7n(){const d=this.selectNodes("//@pid",null);for(let m=0;m<d.length;m++)this.setNodeText(d[m],(m+2).toString())}selectSingleNode(d,m){d=this.selectNodes(d,m);return void 0!==d&&null!==d&&0<d.length?d[0]:null}}cp.xKd="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties";cp.H2o="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes";
cp.SJj="i4";cp.RJj="r8";cp.TJj="lpwstr";cp.PJj="bool";cp.QJj="filetime";Object(y.a)(cp,"CustomPropertyDocument",$s,[1041,886]);class mv extends ih.a{constructor(d,m,A,R){super();this._context=d;this.UN=A;this.Mk=m;this.dXa=R}get key(){return this.UN.getKey(this.dXa)}get type(){let d=0;switch(this.UN.getType(this.dXa)){case cp.SJj:case cp.RJj:d=1;break;case cp.TJj:d=0;break;case cp.PJj:d=3;break;case cp.QJj:d=2}return d}get value(){const d=this.UN.getValue(this.dXa);return 1===this.type?Number.parseInvariant(d):
3===this.type?Boolean.parse(d):2===this.type?new Date(d):d}set value(d){this.UN.setValue(this.dXa,d)||sc.a.qd()}get _Id(){return this.key}get _ReferenceId(){return this.yq?this.Tq:null}deleteObject(){this.UN.Ell(this.dXa);this.dXa=null}_KeepReference(){this.rq()}_OnAccess(){this._context.Jm.M4b(this.Mk.fha.currentNode);this.dXa||sc.a.Tk();if(!this.UN.uGf()){this.UN.Hqg();const d=this.UN.Rfi(this.key);d?this.dXa=d:sc.a.Tk()}}getTypeName(){return"Microsoft.WordServices.CustomProperty"}invokePropertyGet(d){switch(d){case 2:return this.key;
case 4:return this.type;case 3:return this.value;case 5:return this._Id;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.UD(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}a7n(d){this.UN.she(this.dXa,
d)}}Object(y.a)(mv,"CustomProperty",ih.a,[841]);class Gs extends ih.a{constructor(d,m,A,R){super();this._context=d;this.Mk=m;this.Itc=R;this.Lc=A;d=this.Mk.CRd(cp.xKd,!0);d=0<d.length?d[0]:this.Ycl();this.UN=new cp(d,this.Lc)}length(){return this.getCount()}_GetItem(d){d=sc.a.hQ(d);if(d=this.UN.dbm(d))return new mv(this._context,this.Mk,this.UN,d);v.ULS.sendTraceTag(21016673,369,10,"The index is out of the CustomPropertyCollection range.");sc.a.qd();return null}get _ReferenceId(){return this.yq?this.Tq:
null}add(d,m){void 0!==d&&null!==d&&void 0!==m&&null!==m||sc.a.qd();var A=this.UN.customXmlPartNode;if(!A.isConnected){const R=this.Mk.fha,da=A.getValue(wc.a.SDb);R.Q3(A,24,Rh.a.If(da+"{1}"))}(A=this.getItemOrNullObject(d))?(A.key!==d&&A.a7n(d),A.value=m):this.UN.Tuk(d,m)?A=this.getItemOrNullObject(d):sc.a.qd();return A}deleteAll(){this.UN.Fkl()}getCount(){return this.UN.Sfi()}getItem(d){(d=this.getItemOrNullObject(d))||sc.a.Tk();return d}getItemOrNullObject(d){return(d=this.UN.Rfi(d))?new mv(this._context,
this.Mk,this.UN,d):null}_KeepReference(){this.rq()}_OnAccess(){this._context.Jm.M4b(this.Mk.fha.currentNode);if(!this.UN.customXmlPartNode.isConnected){const d=this.Mk.CRd(cp.xKd,!0);0<d.length&&(this.UN=new cp(d[0],this.Lc))}this.UN.uGf()||this.UN.Hqg()}getAsyncEnumerator(d,m){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.CustomPropertyCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.dGc(m);case 1005:return this.Ief();case 1004:return this.A2a();case 1:return this.fY(m);case 1006:return this.S2a(m);
case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}dGc(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");return this.add(m,d)}Ief(){this.deleteAll();return null}A2a(){return this.getCount()}fY(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.getItem(d)}S2a(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getItemOrNullObject(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}Ycl(){const d=this.Itc.create(1074135143),m=new Rh.a(Eg.a.create(),1);d.setValue(wc.a.SDb,"{"+Lb.e(m.guid.toString())+"}");d.setValue(wc.a.i1a,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"></Properties>');
d.setValue(wc.a.yKd,cp.xKd);d.setValue(wc.a.C6b,!0);return d}}Object(y.a)(Gs,"CustomPropertyCollection",ih.a,[841,857]);class Gu extends ih.a{constructor(d,m,A,R,da){super();this.yK=this.Us=null;this._context=d;this.Mk=m;this.Lc=A;this.Itc=R;this.P8j=da}get applicationName(){this.yK.kH();return this.yK.eH.application}get author(){this.Us.kH();return this.Us.eH.Creator}set author(d){this.Us.kH();this.Us.eH.Creator=d;this.Us.N7a()}get category(){this.Us.kH();return this.Us.eH.Category}set category(d){this.Us.kH();
this.Us.eH.Category=d;this.Us.N7a()}get comments(){this.Us.kH();return this.Us.eH.Description}set comments(d){this.Us.kH();this.Us.eH.Description=d;this.Us.N7a()}get company(){this.yK.kH();return this.yK.eH.company}set company(d){this.yK.kH();this.yK.eH.company=d;this.yK.N7a()}get creationDate(){this.Us.kH();const d=this.Us.eH.CreatedDate;return void 0!==d&&null!==d?new Date(d):null}get customProperties(){return new Gs(this._context,this.Mk,this.Lc,this.Itc)}get format(){this.yK.kH();return this.yK.eH.format}set format(d){this.yK.kH();
this.yK.eH.format=d;this.yK.N7a()}get keywords(){this.Us.kH();return this.Us.eH.Keywords}set keywords(d){this.Us.kH();this.Us.eH.Keywords=d;this.Us.N7a()}get lastAuthor(){this.Us.kH();return this.Us.eH.LastModifiedBy}get lastPrintDate(){this.Us.kH();const d=this.Us.eH.LastPrinted;return void 0!==d&&null!==d?new Date(d):null}get lastSaveTime(){this.Us.kH();const d=this.Us.eH.Modified;return void 0!==d&&null!==d?new Date(d):null}get manager(){this.yK.kH();return this.yK.eH.manager}set manager(d){this.yK.kH();
this.yK.eH.manager=d;this.yK.N7a()}get revisionNumber(){this.Us.kH();return this.Us.eH.Revision}get security(){this.yK.kH();return this.yK.eH.docSecurity}get subject(){this.Us.kH();return this.Us.eH.Subject}set subject(d){this.Us.kH();this.Us.eH.Subject=d;this.Us.N7a()}get template(){this.yK.kH();return this.yK.eH.template}get title(){this.Us.kH();return this.Us.eH.Title}set title(d){this.Us.kH();this.Us.eH.Title=d;this.Us.N7a()}get _ReferenceId(){return this.yq?this.Tq:null}_KeepReference(){this.rq()}_OnAccess(){this.P8j||
sc.a.zk();this._context.Jm.M4b(this.Mk.fha.currentNode);this.loadDocumentProperty()}getTypeName(){return"Microsoft.WordServices.DocumentProperties"}invokePropertyGet(d){switch(d){case 11:return this.applicationName;case 5:return this.author;case 20:return this.category;case 7:return this.comments;case 23:return this.company;case 13:return this.creationDate;case 2:return this.customProperties;case 21:return this.format;case 6:return this.keywords;case 9:return this.lastAuthor;case 12:return this.lastPrintDate;
case 14:return this.lastSaveTime;case 22:return this.manager;case 10:return this.revisionNumber;case 19:return this.security;case 4:return this.subject;case 8:return this.template;case 3:return this.title;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 5:this.author=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 20:this.category=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 7:this.comments=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 23:this.company=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 21:this.format=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 6:this.keywords=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,
"string");return;case 22:this.manager=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 4:this.subject=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Vh();
case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}loadDocumentProperty(){if(void 0===this.Us||null===this.Us)this.Us=this.Yhi(Gu.T8k);if(void 0===this.yK||null===this.yK)this.yK=this.Yhi(Gu.BAl)}Yhi(d){d=this.Mk.CRd(d,!0);return new qx(d[0],this.Lc)}}Gu.T8k="http://schemas.openxmlformats.org/package/2006/metadata/core-properties";
Gu.BAl="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties";Object(y.a)(Gu,"DocumentProperties",ih.a,[841]);var Od=c(1882);class Hs extends Od.a{constructor(d,m,A,R,da,Ea,ib){super(da,d,null,m,A,null,null,R,Ea);this.Yld=ib}RVf(){this._state=0;this.Ieb=this.LW.G4d||this.LW.ignoreSpace||this.LW.ignorePunct?this.Xfa.$3i(this.LW):this.Xfa.C4c(this.LW.text)}i7e(){return this.Yld.J(this.bM)?!1:(this.Vfb(),this._state=2,this.uqb(!0),!0)}HZf(){this.txf(this.Yld.J(this.bM).node,0);this.bM++}Vfb(){this.bM=
0;this.Ieb=""}mCd(d,m){this.Sj.qCd(m)}k$e(){return this.bM<this.Yld.count}BVf(){this.bM>=this.Yld.count&&(this.bM=0,this._state=2,this.uqb(!0))}R$f(){const d=this.Xfa.vNb(this.Ieb);try{this.mXb=this.nXb.P$b(d.join("|"),this.LW)}catch(m){v.ULS.sendTraceTag(17339148,313,10,"ExtensionFindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.LW.matchCase,this.LW.matchWholeWord),this.mXb=null,this._state=2,this.uqb(!0)}return!1}}Object(y.a)(Hs,"ExtensionFindManager",
Od.a,[]);class Di{constructor(d,m,A,R){this.Xfa=d;this.pp=m;this.nXb=A;this.IJe=R}create(d,m,A){return new Hs(this.Xfa,this.pp,this.IJe,this.nXb,d,m,A)}}Object(y.a)(Di,"ExtensionFindManagerFactory",null,[]);var Zy=c(2078);class vp extends Zy.a{constructor(d,m,A,R){super();this.fba=this.gO=this.usd=null;m&&0<m.count&&(this.usd=this.f7l(m),this.gO=A,this.fba=new U.a);this.tk=d;this.w3=R}OPa(d,m){if(!d&&0<m.length)for(d=0;d<m.length;d++){const A=new U.a,R=m[d].nodeId;if(this.usd.nb(R)){const da=this.usd.J(R);
(da.contextId===ic.a.paragraph||da.contextId===ic.a.Fd&&m[d].Bc>=da.cpBegin&&m[d].end<=da.cpEnd)&&this.Fel(A,R,m[d])}}}Fel(d,m,A){d.add(jd.a.createTextRange(this.usd.J(m).node,A.Bc,A.end));this.fba.add(this.tk.create(d,this.w3,this.fba.count))}F8b(){this.gO(this.TPk())}TPk(){return new Yt(this.fba)}f7l(d){const m=new Ji.a;for(const A of d)m.add(A.node.id,A);return m}}Object(y.a)(vp,"ExtensionFindStatusManager",Zy.a,[]);class rx{constructor(){this.tk=null}Ju(d){this.tk=d}create(d,m,A){return new vp(this.tk,
d,m,A)}}Object(y.a)(rx,"ExtensionFindStatusManagerFactory",null,[]);var hy=c(1991);class QA extends hy.a{constructor(d,m,A,R,da,Ea,ib){super(d,m,A,R,da);this.gO=Ea;this.pma=ib}zBh(){this.pma(null)}ABh(){this.gO(this.mM.J(0))}BBh(){this.pma(null)}}Object(y.a)(QA,"ExtensionImageSteward",hy.a,[]);class Vz{constructor(d,m,A,R){this.Vj=d;this.Ib=m;this.Pm=A;this.rd=R}create(d,m,A){return new QA(d,this.Vj,this.Ib,this.Pm,this.rd,m,A)}}Object(y.a)(Vz,"ExtensionImageStewardFactory",null,[]);class Wz{[Symbol.iterator](){return this}constructor(d,
m=!1){this.YIm=m;d=this.Ugn(d);this.SVd=If.GraphIterator.eb(d);this.currentNode=this.hmb(d)?d:m?this.Efi():this.rdi()}next(){const d=this.currentNode;return null!=d?(this.currentNode=this.YIm?this.Efi():this.rdi(),{value:d}):{value:void 0,done:!0}}rdi(){for(;this.SVd.Ri(1);){const d=this.SVd.currentNode;if(this.hmb(d))return d}}Efi(){for(;this.SVd.RM(1);){const d=this.SVd.currentNode;if(this.hmb(d))return d}}Ugn(d){d=If.GraphIterator.eb(d);return d.zb(10)?d.jo(10):null}hmb(d){return!!d&&10===d.type&&
1073872968===d.Oc}static create(d,m=!1){return new Wz(d,m)}}Object(y.a)(Wz,"WordSectionNodeIterator",null,[]);var Zt;(function(d){d[d.unknown=0]="unknown";d[d.Eop=1]="notYetImplemented";d[d.nvp=2]="unsupportedSelection";d[d.W2h=3]="forceSaveFailed";d[d.Fpp=4]="ooxmlStringIsNull";d[d.Xhp=5]="dependencyNotReady";d[d.qip=6]="documentNotSupported";d[d.Epp=7]="ooxmlIsMalformated";d[d.wfp=8]="anchoredObjectSelection";d[d.qmp=9]="invalidParameter"})(Zt||(Zt={}));Object(y.b)("OoxmlApiInvocationError",Zt);
class $t{constructor(d,m,A,R,da,Ea){this.pma=this.gO=this._context=this.nfh=this.Zta=this.Ig=this.tk=null;this.jxc=this.Qtb=this.Mmh=this.D2=0;this.$kh=!1;this.gCa=d;this.hd=m;this.gb=A;this.Qw=R;this.cMa=Ea}Ju(d,m,A){this.tk=d;this.Ig=m;this.Zta=A}getHtml(d,m){sc.a.mPc()&&this.hd.eJf(d[0].node)&&sc.a.Lmg();m.Jm.WH();let A="";d=({WQa:A}=this.cMa.Bqf(d,!0)).returnValue;m.Jm.Iu();d!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&sc.a.Tf();return A}EWm(d){if((new RegExp($t.idh)).test(d))return!0;const m=
new RegExp($t.hdh,"g");let A=0;for(;m.exec(d)&&1>=A;)A++;return 1<A}XRm(d){return(new RegExp($t.hdh)).test(d)||(new RegExp($t.idh)).test(d)}insertHtml(d,m,A,R,da,Ea=!1,ib=null){this._context=da;da=this.XRm(m)?1:0;this.hd.ZT(d,A,da);let Qb=new U.a,pc=!1,Pc=null,gd=13;if(sc.a.dfd())4===A&&(this.Ig.gEb(),this.hd.xCb(d),this.Ig.VEa(),A=2),da=new U.a,da.addRange(d),pc=this.hd.X_d(da,A),{JJ:Pc,returnValue:gd}=this.hd.mL(da.J(0),da.J(da.count-1),A),this.EWm(m)&&(Pc=this.Ig.RJa(Pc,d)),Qb.add(Pc),pc&&({JJ:Pc,
returnValue:gd}=this.hd.mL(d.J(0),d.J(d.count-1),A));else{da=d.J(0);const Cd=d.J(d.count-1);({JJ:Pc,returnValue:gd}=this.hd.mL(da,Cd,A));13===gd?Qb=d:Qb.add(Pc)}ib&&ib.lpb();return OfficeExtension.WacRuntime.Utility.createPromise(Cd=>{const ae=this.cMa.Xge(Qb.toArray(),!0,m,(Xd,se)=>{Xd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&se||(ib&&ib.Hva(d),sc.a.Tf());Xd=new U.a;for(const Xe of se.toArray())Xd.add(Xe);Xd.J(0).contextId===ic.a.Tc?(Xd.clear(),Xd.add(Pc)):(this.hd.$u(Xd.J(0)),this.hd.$u(Xd.J(Xd.count-
1)));se=this.tk.create(Xd,this._context);Cd(se);if(Ea){if(pc&&(se=Xd.J(Xd.count-1),se.contextId===ic.a.paragraph)){let Xe;this.hd.dLd((Xe=new U.a,Xe.add(jd.a.create(this.gb.Wf(se.node,!1))),Xe))}this.kXo(d,Xd,gd,pc)}ib&&ib.Hva(d);sc.a.$M("FileApiOperations.InsertHtml",sc.a.zN(R),m.length)});ae!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(ib&&ib.Hva(d),ae===OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection&&sc.a.FAa&&sc.a.pD(),sc.a.Tf())})}kXo(d,m,A,R=!1){if(m.count&&(1!==m.count||
m.J(0).contextId!==ic.a.Tc)){var da=d.J(0),Ea=d.J(d.count-1),ib=m.J(m.count-1),Qb=this.gb.Wf(ib.node,!1);switch(A){case 0:ib.contextId!==ic.a.Fd||R?d.Z(0,jd.a.create(Qb)):(d.Z(0,jd.a.create(ib.node)),this.hd.$u(d.J(0),0),m.removeAt(m.count-1));d.J(0).Sb=da.Mn();d.$C(0,m);break;case 1:case 2:ib.contextId===ic.a.Fd?(d.Z(0,jd.a.tl(ib.node)),d.J(0).Sb=da.Mn()):ib.contextId===ic.a.paragraph?d.removeAt(0):ib.contextId===ic.a.Vc&&m.remove(ib);d.$C(0,m);break;case 3:if(A=da.cpEnd-da.cpBegin){if(ib.contextId===
ic.a.Fd)R?(d.Z(0,jd.a.createTextRange(Qb,0,A)),m.add(jd.a.tl(ib.node))):(d.Z(0,jd.a.createTextRange(ib.node,ib.cpBegin,ib.cpEnd+A)),m.removeAt(m.count-1),m.count||(d.J(0).Fb=ib.Ln())),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(d.J(0).node));else if(ib.contextId===ic.a.paragraph||ib.contextId===ic.a.Vc)d.Z(0,jd.a.createTextRange(Qb,0,A)),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(Qb));d.J(0).Sb=da.Mn()}else d.removeAt(0);d.$C(0,m);break;case 5:case 6:d.Z(0,jd.a.tl(ib.node));this.hd.rAa(d.J(0));
d.J(0).Sb=this.gb.uw(d.J(0).node);break;case 7:if(A=da.cpEnd-da.cpBegin){if(ib.contextId===ic.a.Fd)R?(d.Z(0,jd.a.createTextRange(Qb,0,A)),d.J(0).Fb=this.gb.ix(Qb)):(d.Z(0,jd.a.createTextRange(ib.node,ib.cpEnd,ib.cpEnd+A)),this.hd.rAa(d.J(0))),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(d.J(0).node));else if(ib.contextId===ic.a.paragraph||ib.contextId===ic.a.Vc)d.Z(0,jd.a.createTextRange(Qb,0,A)),d.J(0).Fb=this.gb.ix(Qb),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(Qb));d.J(0).Sb=
da.Mn()}else{if(ib.contextId===ic.a.Fd)d.Z(0,jd.a.Uc(ib.node,ib.cpEnd)),this.hd.rAa(d.J(0));else if(ib.contextId===ic.a.paragraph||ib.contextId===ic.a.Vc)d.Z(0,jd.a.tw(ib.node)),this.hd.rAa(d.J(0));d.J(0).Sb=d.J(0).Ln()+da.Mn()-da.Ln()}break;case 4:ib.contextId!==ic.a.Fd||R?(d.Z(0,jd.a.create(Qb)),d.J(0).Fb=da.Ln(),d.J(0).Sb=da.Mn()):(d.Z(0,jd.a.createTextRange(ib.node,ib.cpEnd,this.gb.textLength(ib.node))),this.hd.rAa(d.J(0)),d.J(0).Sb=da.Mn(),d.insert(1,jd.a.tl(ib.node)));break;case 9:Ea.contextId===
ic.a.Vc?R||(d.removeAt(d.count-1),m.J(0).contextId===ic.a.Fd&&0<d.count&&d.J(d.count-1).contextId===ic.a.Fd&&(m.Z(0,jd.a.createTextRange(m.J(0).node,d.J(d.count-1).cpBegin,m.J(0).cpEnd)),m.J(0).Fb=d.J(d.count-1).Ln(),d.removeAt(d.count-1))):Ea.contextId!==ic.a.paragraph||R||m.J(0).contextId!==ic.a.Fd||(d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,0,m.J(0).cpEnd)),d.J(d.count-1).Fb=Ea.Ln(),m.removeAt(0));ib.contextId===ic.a.Fd&&(R=jd.a.tl(ib.node),R.Sb=this.gb.uw(ib.node),m.add(R));d.addRange(m);
break;case 10:Ea.contextId===ic.a.Tc?d.removeAt(d.count-1):Ea.contextId===ic.a.Fd&&(m.J(0).contextId===ic.a.Fd?(d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,Ea.cpBegin,m.J(0).cpEnd)),this.hd.$u(d.J(d.count-1),1),m.removeAt(0)):m.J(0).contextId===ic.a.Vc&&d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,Ea.cpBegin,Ea.cpEnd)),d.J(d.count-1).Fb=Ea.Ln());d.addRange(m);break;case 12:R||(Ea.contextId===ic.a.Tc?d.Z(d.count-1,jd.a.Uc(m.J(0).node,Ea.cpBegin)):Ea.contextId===ic.a.Fd&&d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,
Ea.cpBegin,Ea.cpEnd)),d.J(d.count-1).Fb=Ea.Ln(),d.J(d.count-1).Sb=Ea.Mn());break;case 13:d.clear(),d.addRange(m)}}}getOoxml(d,m,A,R,da){this.cVc(null,m,A,R,da);this.gCa.getOoxml(d.toArray(),Ea=>{this.gO(Ea);this._context.Jm.Iu();sc.a.$M("FileApiOperations.GetOoxml",sc.a.zN(this.D2),Ea.length)},Ea=>{v.ULS.sendTraceTag(17568003,369,10,"AppId:{0}, {1}",this._context.appId,Zt[Ea]);this.pma(Zt[Ea]);this._context.Jm.Iu();sc.a.$M("FileApiOperations.GetOoxml",sc.a.zN(this.D2),void 0,!1)})}insertOoxml(d,m,
A,R,da,Ea,ib,Qb,pc,Pc=0,gd=!1,Cd=null,ae=null){this.hd.ZT(d,A,0);Cd&&Cd.lpb();this.cVc(R,da,Ea,ib,Qb,pc,Pc,A,gd);this._context.Jm.WH();this.MEm(d,m,Cd,ae)}cVc(d,m,A,R,da,Ea=0,ib=0,Qb=0,pc=!1){this.nfh=d?8===d.type||10===d.type?d:this.Atf(d):null;this._context=m;this.gO=A;this.pma=R;this.D2=da;this.Mmh=Ea;this.Qtb=ib;this.jxc=Qb;this.$kh=pc}MEm(d,m,A,R){let da=new U.a;var Ea=d.J(0);const ib=d.J(d.count-1);var Qb=null;const pc=({JJ:Qb}=this.hd.mL(Ea,ib,this.jxc)).returnValue;let Pc=null,gd=null;13===
pc?(da=d,this.Qtb||(this.Qtb=this.xTl(d)),Qb=jd.a.Uc(Ea.node,Ea.Wj),Qb.Sb=Qb.Fb=Ea.Fb,Ea=jd.a.Uc(ib.node,ib.vp),Ea.Sb=Ea.Fb=ib.Sb,Pc=this.Ig.K3b(Qb,void 0,!0),gd=this.Ig.K3b(Ea,void 0,!1)):(da.add(Qb),this.Qtb||-1===Qb.Ln()||(this.jxc=({$w:this.Qtb}=this.wTl(Qb,this.Qtb)).returnValue),Pc=this.Ig.K3b(Qb,void 0,!0),gd=this.Ig.K3b(Qb,void 0,!1));let Cd=-1,ae=-1;9===pc&&(Cd=ib.Ln(),ae=ib.Mn());this.gCa.Ghe(da.toArray(),m,this.Qtb,this.jxc,this.Mmh,R,Xd=>{this._context.Jm.Iu();var se=new U.a;Xd&&(se=this.gb.yw(this.nfh,
!0,!0),se=this.gCa.i$b(Xd,se),se.count||(se=this.Qw.dai(),se=this.gCa.i$b(Xd,se)));se.count?(this.Ig.Tee(se.J(0),Pc,void 0,void 0,!0),this.Ig.Tee(se.J(se.count-1),gd,void 0,void 0,!1),Xd=new U.a,Xd.addRange(se),sc.a.VLj()?isNull(R)?(Xd=this.tk.create(Xd,this._context),this.gO(Xd)):this.gO(new lv(this.Gdm(Xd,this.jxc))):(Xd=this.tk.create(Xd,this._context),this.gO(Xd)),this.$kh&&this.yoe(d,se,pc,Cd,ae),A&&A.Hva(d),sc.a.$M("FileApiOperations.SetOoxml",sc.a.zN(this.D2),m.length)):(v.ULS.sendTraceTag(18354846,
369,10,"AppId:{0}, Can't find the inserted content when setting ooxml",this._context.appId),this.pma(null))},Xd=>{this._context.Jm.Iu();v.ULS.sendTraceTag(17585566,369,10,"AppId:{0}, {1}",this._context.appId,Zt[Xd]);this.pma(Zt[Xd]);A&&A.Hva(d);sc.a.$M("FileApiOperations.SetOoxml",sc.a.zN(this.D2),m.length,!1)})}c9n(d,m,A){this.gCa.gag(d,6,R=>{R?m(R):A("retrieved styles string is empty or null")},R=>{A(Zt[R])})}Gdm(d,m){const A=new U.a;let R=0;switch(m){case 2:var da=d.J(d.count-1);for(var Ea of Wz.create(da.node,
!0))A.add(this.Zta.create(Ea,this._context,R++));break;case 4:case 3:Ea=d.J(0);for(da of Wz.create(Ea.node))A.add(this.Zta.create(da,this._context,R++))}return A}wTl(d,m){m=null;var A=d.node;let R=4;if(!A.ra)return{returnValue:0,$w:0};A=A.ra.nh(d.cpBegin);d=d.Ln();if(A&&A.Jb&&0<A.Jb.length){A=A.Jb;const da=A.length;!d&&A.J(0).Qc&&A.J(0).zp?(m=A.J(0).contentControlNode,R=0):d||A.J(0).Qc||!A.J(0).zp?d<=da&&0<d&&A.J(d-1).Qc&&A.J(d-1).zp?(m=A.J(d-1).contentControlNode,R=2):d<da&&0<d&&A.J(d-1).Qc&&!A.J(d-
1).zp&&A.J(d).Qc?(m=A.J(d).contentControlNode,R=0):d<=da&&0<d&&!A.J(d-1).Qc&&(m=A.J(d-1).contentControlNode,R=1):(m=A.J(0).contentControlNode,R=3)}m=m?m.ja(wc.a.$w,0):0;return{returnValue:R,$w:m}}xTl(d){let m=null;var A=null;({JJ:m}=this.hd.mL(d.J(0),d.J(d.count-1),2));({JJ:A}=this.hd.mL(d.J(0),d.J(d.count-1),3));d=this.a8h(m,!0);A=this.a8h(A,!1);return d===A?d:0}a8h(d,m){let A=null;var R=d.node;if(!R.ra)return 0;R=R.ra.nh(d.cpBegin);d=d.Ln();if(R&&R.Jb&&0<R.Jb.length){R=R.Jb;const da=R.length;m&&
0<d&&R.J(d-1).Qc&&R.J(d-1).zp?A=R.J(d-1).contentControlNode:!m&&d<da&&!R.J(d).Qc&&R.J(d).zp&&(A=R.J(d).contentControlNode)}return A?A.ja(wc.a.$w,0):0}yoe(d,m,A,R=-1,da=-1){if(!(0>=m.count||1===m.count&&m.J(0).contextId===ic.a.Tc)){var Ea=d.J(0),ib=d.J(d.count-1),Qb=m.J(0),pc=m.J(m.count-1);switch(A){case 0:pc.contextId===ic.a.Fd&&(d.Z(0,jd.a.create(pc.node)),d.J(0).Sb=Ea.Mn(),this.hd.$u(d.J(0),0),m.removeAt(m.count-1));d.$C(0,m);break;case 1:case 2:pc.contextId===ic.a.Vc&&d.removeAt(0);d.$C(0,m);
break;case 3:(A=Ea.cpEnd-Ea.cpBegin)?(pc.contextId===ic.a.Fd?(d.Z(0,jd.a.createTextRange(pc.node,pc.cpBegin,pc.cpEnd+A)),m.removeAt(m.count-1)):d.Z(0,jd.a.createTextRange(Ea.node,0,A)),d.J(0).Sb=Ea.Mn(),this.hd.$u(d.J(0),0)):d.removeAt(0);d.$C(0,m);break;case 5:case 6:pc.contextId===ic.a.Fd?(d.Z(0,jd.a.tl(pc.node)),d.J(0).Fb=d.J(0).Sb=this.gb.uw(pc.node)):d.Z(0,m.J(m.count-1));break;case 7:A=Ea.cpEnd-Ea.cpBegin;pc.contextId===ic.a.Fd?Ea.contextId===ic.a.Fd?(d.Z(0,jd.a.createTextRange(Ea.node,pc.cpEnd,
pc.cpEnd+A)),this.hd.rAa(d.J(0)),d.J(0).Sb=Ea.Mn()):(d.Z(0,jd.a.Uc(Ea.node,pc.cpEnd)),this.hd.rAa(d.J(0)),d.J(0).Sb=d.J(0).Fb+Ea.Mn()-Ea.Ln()):(Ea.contextId===ic.a.Fd?d.Z(0,jd.a.createTextRange(Ea.node,0,A)):d.Z(0,jd.a.Uc(Ea.node,0)),this.hd.ZJa(d.J(0),Ea));break;case 4:pc.contextId===ic.a.Fd&&(d.Z(0,jd.a.createTextRange(pc.node,pc.cpEnd,pc.node.characterData.length)),d.J(0).Sb=Ea.Mn(),this.hd.rAa(d.J(0)),d.insert(1,jd.a.tl(pc.node)));break;case 9:ib.contextId===ic.a.paragraph?(d.Z(d.count-1,jd.a.create(Qb.node)),
d.J(d.count-1).Fb=R,d.J(d.count-1).Sb=da,m.removeAt(0)):d.removeAt(d.count-1);d.addRange(m);break;case 10:Ea.contextId===ic.a.Tc?d.clear():m.J(0).contextId!==ic.a.Vc?(d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,ib.cpBegin,m.J(0).cpEnd)),m.removeAt(0),d.J(d.count-1).Fb=ib.Ln(),this.hd.$u(d.J(d.count-1),1)):(d.Z(d.count-1,jd.a.createTextRange(m.J(0).node,ib.cpBegin,ib.cpEnd)),d.J(d.count-1).Fb=ib.Ln());d.addRange(m);break;case 12:A=ib.cpEnd-ib.cpBegin;d.Z(d.count-1,A?jd.a.createTextRange(Qb.node,
ib.cpBegin,ib.cpEnd):jd.a.Uc(Qb.node,ib.cpBegin));d.J(d.count-1).Fb=ib.Ln();d.J(d.count-1).Sb=ib.Mn();break;case 13:d.clear(),d.addRange(m)}}}Atf(d){const m=new If.GraphIterator;m.set(d);d=null;m.zb(10)&&(d=m.jo(10));return d}}$t.hdh="<(?:p|li)(?:\\s|>|/)";$t.idh="<table(?:\\s|>|/)";Object(y.a)($t,"FileApiOperations",null,[1004]);var $y=c(1906);class RB{constructor(){}Ju(d,m,A,R,da,Ea){this.tk=d;this.Ow=m;this.$c=A;this.Ig=R;this.hd=da;this.iq=Ea}create(d,m,A=0,R=null){return new $y.a(d,m,A,R,this.tk,
this.Ow,this.$c,this.Ig,this.hd,this.iq)}}Object(y.a)(RB,"FieldFactory",null,[858]);var nv=c(137),Ew=c(101),HC=c(596),Xz=c(865),Wr=c(1216);class Dt{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd){this.evb=d;this.gb=m;this.Ig=A;this.sh=R;this.BC=da;this.F3=Ea;this.Yc=ib;this.Nld=Qb;this.zD=pc;this.imk=Pc;this.hd=gd;this.Mg=Cd;this.DVg=ae;this.ga=Xd}Gbm(d,m,A){if(!d.ra||!d.$oa)return{qka:null,startCp:0,endCp:0};for(;0<=m;m--){const R=d.ra.nh(m);if(R&&R.Hc)for(let da=0;da<R.Hc.length;da++){const Ea=
R.Hc.J(da);if(!Ea.vf&&1===Ea.ZB)return{qka:d,startCp:m,endCp:A}}}d=this.gb.Wf(d,!0,!0);return this.agi(d)}sYl(d,m,A,R){if(!d.ra)return{qka:null,startCp:0,endCp:0};for(let da=m;da<=d.characterData.length;da++){const Ea=d.ra.nh(da);if(Ea&&Ea.Hc)for(let ib=0;ib<Ea.Hc.length;ib++){const Qb=Ea.Hc.J(ib);if(!Qb.vf&&1===Qb.ZB)return da>=A?{qka:null,startCp:0,endCp:0}:{qka:d,startCp:da,endCp:A};if(da!==m&&!R)return this.Gbm(d,m,A)}}return{qka:null,startCp:0,endCp:0}}$Rd(d,m,A,R,da,Ea=!1){const ib=new U.a;
let Qb=d,pc=Qb.ra;if(pc&&Qb.$oa){let {qka:Xd,startCp:se,endCp:Xe}=this.sYl(d,m,A,da);if(Xd){Qb=Xd;pc=Qb.ra;var Pc=0;let Be=null;da=!0;Ea&&A===Qb.characterData.length&&Xe++;for(Ea=se;Ea<Xe;Ea++){var gd=pc.nh(Ea);if(gd&&gd.Hc)for(var Cd=0;Cd<gd.Hc.length;Cd++){var ae=gd.Hc.J(Cd);3===ae.vf&&1===ae.ZB?(da=!0,Be&&Pc!==gd.cp&&(Be.Ed.add(jd.a.createTextRange(Xd,Pc,gd.cp)),ib.add(Be))):ae.vf||1!==ae.ZB?5===ae.vf&&(Be.Ed.add(jd.a.createTextRange(Xd,Pc,gd.cp)),Be.Ed.add(jd.a.tl(Xd)),ae=this.gb.Wf(Xd,!1,!0),
ib.add(this.Klf(ae,Be))):(da=!1,Pc=new U.a,Be=this.evb.create(Pc,R),Pc=gd.cp)}}for(Ea=Xe;!da&&Ea<=Qb.characterData.length;Ea++)if((gd=pc.nh(Ea))&&gd.Hc)for(Cd=0;Cd<gd.Hc.length;Cd++)ae=gd.Hc.J(Cd),3===ae.vf&&1===ae.ZB?(da=!0,Be.Ed.add(jd.a.createTextRange(Xd,Pc,gd.cp)),ib.add(Be)):5===ae.vf&&(Be.Ed.add(jd.a.createTextRange(Xd,Pc,gd.cp)),Be.Ed.add(jd.a.tl(Xd)),ae=this.gb.Wf(Xd,!1,!0),ib.add(this.Klf(ae,Be)))}}if(nv.a.T8){d=this.n7l(jd.a.createTextRange(d,m,A),R);for(const Xd of d)ib.add(Xd)}return ib}n7l(d,
m){const A=d.node;let R=0,da=-1,Ea=null;const ib=[],Qb=A.ra;for(;Qb&&R<Qb.length;){const Pc=Qb.J(R++);if(Pc.Bm&&Ea){if(da<d.cpEnd&&d.cpBegin<Pc.cp&&Ea){var pc=new U.a;pc.add(jd.a.createTextRange(A,da,Pc.cp));ib.push(this.evb.create(pc,m,0,Ea));Ea=null}else da!==d.cpEnd&&d.cpBegin!==Pc.cp||!Ea||(pc=new U.a,pc.add(jd.a.createTextRange(A,da,Pc.cp)),ib.push(this.evb.create(pc,m,0,Ea)),Ea=null);if(Pc.cp>=d.cpEnd)break}if(Pc.hyperlink&&!Pc.Hc||Pc.hyperlink&&!this.nsm(Pc.Hc))da=Pc.cp,Ea=Pc.hyperlink}return ib}nsm(d){for(let m=
0;m<d.length;m++)if(1===d.J(m).vf){const A=d.J(m).NU;if(A&&A.startsWith(Ew.a.C8b)&&Ew.a.cSa(Ew.a.NFa(A)))return!0}return!1}agi(d){if(!d.ra||!d.$oa)return{qka:null,startCp:0,endCp:0};for(let m=d.characterData.length;0<=m;m--){const A=d.ra.nh(m);if(A&&A.Hc)for(let R=A.Hc.length-1;0<=R;R--){const da=A.Hc.J(R);if(!da.vf&&1===da.ZB)return{qka:d,startCp:m,endCp:d.characterData.length}}}d=this.gb.Wf(d,!0,!0);return this.agi(d)}U9b(d,m,A){return this.$Rd(d,0,d.characterData.length,m,A,!0)}Klf(d,m){const A=
d.ra;if(!A||!d.$oa)return m;let R=0;for(let da=0;da<A.length;da++){const Ea=A.J(da);if(Ea.Hc)for(let ib=0;ib<Ea.Hc.length;ib++){const Qb=Ea.Hc.J(ib);if(!(1<Qb.ZB))if(4===Qb.vf)R=Ea.cp;else{if(3===Qb.vf)return m.Ed.add(jd.a.createTextRange(d,R,Ea.cp)),m;if(5===Qb.vf)return m.Ed.add(jd.a.createTextRange(d,R,Ea.cp)),m.Ed.add(jd.a.tl(d)),d=this.gb.Wf(d,!1,!0),this.Klf(d,m)}}}return m}qYl(d,m){const A=d.start,R=d.end;if(A&&R)return d.Of?this.pYl(A,R,m):this.$Rd(A.node,A.cpBegin,R.cpEnd,m,!1)}pYl(d,m,A){m=
this.Ig.uU(d,m);d=new U.a;for(const R of m)m=this.U9b(R,A,!0),d.addRange(m);return d}getNextOrNullObject(d,m){if(!d.Ed||0===d.Ed.count)return null;d=d.Ed.J(d.Ed.count-1);if(d.cpEnd!==d.node.characterData.length){var A=this.$Rd(d.node,d.cpEnd,d.node.characterData.length,m,!0);if(0<A.count)return A.J(0)}for(d=this.gb.Wf(d.node,!1,!0);d;){A=this.U9b(d,m,!0);if(0<A.count)return A.J(0);d=this.gb.Wf(d,!1,!0)}return null}mYl(d){var m;if(null===d.Ed||0===d.Ed.count)return"";if(nv.a.T8&&d.EAf)return"HYPERLINK "+
(null===(m=d.EAf)||void 0===m?void 0:m.url);d=d.Ed.J(0);(d=d.node.ra.nh(-1==d.cpBegin?0:d.cpBegin))&&d.Hc||sc.a.Tf();for(m=0;m<d.Hc.length;++m)if(0===d.Hc.J(m).vf){const A=new HC.a(d.Hc,m);for(let R of Xz.a.Q5b(A,!1))if(1===R.Tp.vf)return R.Tp.NU}return""}ljo(d,m){if(null!==d.Ed&&0!==d.Ed.count){d=d.Ed.J(0);var A=d.node.ra.nh(d.cpBegin);if(A&&A.Hc)for(let R of Xz.a.nEa(d.node,d.cpBegin))1===R.Tp.vf&&(R.Tp.NU=m);else sc.a.Tf()}}a$h(d,m,A){const R=new U.a;for(const da of this.sh.Qx(d,0,this.sh.gg(d)-
1))R.addRange(this.b$h(da,m,A));return R}b$h(d,m,A){const R=new U.a;for(const da of this.BC.AB(d))R.addRange(this.rYl(da,m,A));return R}rYl(d,m,A){if(this.F3.$r(d))return null;const R=this.Yc.Dk();R.set(d);var da=R.Rd();for(d=new U.a;da;)da=R.Rd(),12===da.type?d.addRange(this.U9b(da,m,A)):14===da.type&&d.addRange(this.a$h(da,m,A)),R.sc(),da=R.Oj();return d}insertField(d,m,A,R=31,da,Ea=!1){R=0==R?31:R;this.hd.ZT(d,A,0);const ib=d.J(0),Qb=d.J(d.count-1);let pc=null;({JJ:pc}=this.hd.mL(ib,Qb,A));4==
A&&this.hd.R6b(d);switch(!0){case 31==R||81==R:return this.fEm(m,A,R,da,Ea,pc,ib,Qb);case 88==R:return this.nEm(d,m,A,da);case 13==R:return this.tFm(pc).then(()=>{var Pc=this.gb.Wf(pc.node,!1,!0);Pc=this.Lgm(Pc);return this.evb.create(Pc,m)});default:sc.a.qd()}}OCl(d){switch(d){case 31:return" DATE ";case 81:return" ADDIN ";default:return""}}fEm(d,m,A=31,R,da=!1,Ea,ib,Qb){return OfficeExtension.WacRuntime.Utility.createPromise(pc=>{var Pc=this.OCl(A);null!=R&&(Pc+=R);da||(Pc+=" \\* MERGEFORMAT ");
var gd=this.Nld.insertField(Ea,Pc,31!=A||nv.a.$Eb?"":"temp"),Cd=jd.a.cR(gd.cpBegin,gd.cpEnd,!1,0==m||2==m||4==m?ib.node:Qb.node);if(31==A){const ae=this.DVg.vVd(Wr.a.t8b(Pc));ae&&(nv.a.$Eb?(Cd=this.Nld.llf(gd),ae.poe(Pc,Cd)):(gd=new U.a,gd.add(Cd),ae.poe(Pc,gd)));Pc=this.Nld.llf(Ea);Pc=this.evb.create(Pc,d)}else Pc=new U.a([Cd]),Pc=this.evb.create(Pc,d);pc(Pc)})}nEm(d,m,A,R){return OfficeExtension.WacRuntime.Utility.createPromise(da=>{var Ea=this.hd.insertText(d,R,A),ib=Ea.J(0);ib=this.zD.fF(ib,R,
!1,!1,!0,!1);Ea=this.evb.create(Ea,m,0,ib);da(Ea)})}tFm(d){return OfficeExtension.WacRuntime.Utility.createPromise(m=>{if(32!==this.imk.Eti(0,d,2,null,{resolve:m}))throw sc.a.Tf();})}Lgm(d){var m,A=null===(m=null===d||void 0===d?void 0:d.ra)||void 0===m?void 0:m.first.Jb;(!A||0>=A.length)&&sc.a.Tf();m=d.ra.first.Jb.J(0);m.Of||(v.ULS.sendTraceTag(508949568,3019,15,"Content control is not block type"),sc.a.Tf());m=this.Mg.Fq(m.contentControlNode.id,!1);A=new U.a;for(A.add(jd.a.create(d));d&&(d=Qe.ParagraphReader.Wf(d,
!1),A.add(jd.a.create(d)),d.id!=m););return A}ZRd(d){if(null===d.Ed||0===d.Ed.count)return null;d=d.Ed.J(0);if((d=d.node.ra.nh(d.cpBegin))&&d.Hc){for(let m=0;m<d.Hc.length;m++){const A=d.Hc.J(m);if(0===A.vf)return A}return null}sc.a.Tf()}updateResult(d){const m=this.DVg.vVd(Wr.a.t8b(d.code));if(m)if(nv.a.T8){const A=this.Nld.llf(d.Ed.J(0));m.poe(d.code,A)}else m.poe(d.code,d.Ed);else 13===d.type&&this.ga.Mf(d.Ed.J(0),xe.a.$Sb,2,!1,null,null)}}Object(y.a)(Dt,"FieldOperations",null,[1003]);var Fw=c(727),
au=c(313),kt=c(334);class fo{constructor(){this.Hig=this.formatting=null}}Object(y.a)(fo,"TextFormattingActionData",null,[]);var az=c(790),bz=c(1480),Gw;(function(d){d[d.Tnp=-1]="mixed";d[d.none=0]="none";d[d.hidden=5]="hidden";d[d.vip=8]="dotLine";d[d.single=1]="single";d[d.word=2]="word";d[d.double=3]="double";d[d.Aup=6]="thick";d[d.dotted=4]="dotted";d[d.wip=20]="dottedHeavy";d[d.dashLine=7]="dashLine";d[d.Ghp=23]="dashLineHeavy";d[d.Hhp=39]="dashLineLong";d[d.Ihp=55]="dashLineLongHeavy";d[d.dotDashLine=
9]="dotDashLine";d[d.uip=25]="dotDashLineHeavy";d[d.Tup=10]="twoDotDashLine";d[d.Uup=26]="twoDotDashLineHeavy";d[d.Nvp=11]="wave";d[d.Pvp=27]="waveHeavy";d[d.Ovp=43]="waveDouble"})(Gw||(Gw={}));Object(y.b)("UnderlineType",Gw);class Tv extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd){super();this.tXb=this.Ed=null;this.dsc=d;this.owd=m;this.B_j=A;this.ED=R;this._context=da;this._style=Ea;this.ev=ib;this.gb=Qb;this.ga=pc;this.ala=Pc;this.Amd=null;this.Hla=gd;this.ED&&this._context.nZc&&(this.tXb=
this.ED.KVc.create(this.ED.Xp))}get bold(){if(null!=this._style){if(this._style.hasProperty(Me.a.bold))return this._style.getValue(Me.a.bold)}else{var d=this.bY();return d.EHc?null:1===d.bold}}set bold(d){sc.a.iy(d,"Font.Bold");if(null!=this._style){const m=new Map;m.set(Me.a.bold,d);this.XB(m)}else this.nlc(xe.a.bold,d)}get color(){if(null!=this._style){if(this._style.hasProperty(Me.a.fontColor)){var d=this._style.getValue(Me.a.fontColor);return 16777215<d?"#000000":$f.a.eF(d).toUpperCase()}}else return d=
this.bY(),d.R8b?"":16777215<d.fontColor?"#000000":$f.a.eF(d.fontColor).toUpperCase()}set color(d){d=sc.a.hKa(d,"Font.Color",this._context);if(null!=this._style){const m=new Map;m.set(Me.a.fontColor,Number("0x"+d));this.XB(m)}else this.Qdg(xe.a.Xv,d)}get doubleStrikeThrough(){if(null!=this._style){if(this._style.hasProperty(Td.a.Ht))return this._style.getValue(Td.a.Ht)}else{var d=this.bY();return d.LMc?null:1===d.Ht}}set doubleStrikeThrough(d){sc.a.iy(d,"Font.DoubleStrikeThrough");if(null!=this._style){const m=
new Map;m.set(Td.a.Ht,d);this.XB(m)}else this.nlc(xe.a.Ht,d)}get highlightColor(){if(null!=this._style){if(this._style.hasProperty(Me.a.highlight)){var d=this._style.getValue(Me.a.highlight);return 16777215<d?null:$f.a.eF(d).toUpperCase()}}else return d=this.bY(),d.OTc?"":16777215<d.highlight?null:$f.a.eF(d.highlight).toUpperCase()}set highlightColor(d){if(d&&""!==d)if(d=sc.a.hKa(d,"Font.HighlightColor",this._context),null!=this._style){const m=new Map;m.set(Me.a.highlight,Number("0x"+d));this.XB(m)}else this.Qdg(xe.a.nZ,
d);else null!=this._style?(d=new Map,d.set(Me.a.highlight,null),this.XB(d)):this.Qdg(xe.a.hva,"")}get italic(){if(null!=this._style){if(this._style.hasProperty(Me.a.italic))return this._style.getValue(Me.a.italic)}else{var d=this.bY();return d.Aec?null:1===d.italic}}set italic(d){sc.a.iy(d,"Font.Italic");if(null!=this._style){const m=new Map;m.set(Me.a.italic,d);this.XB(m)}else this.nlc(xe.a.fz,d)}get name(){if(null!=this._style){if(this._style.hasProperty(Me.a.font))return this._style.getValue(Me.a.font)}else{var d=
this.bY();return d.bPc?"":d.fontName}}set name(d){sc.a.upc(d,"Font.Name");if(null!=this._style){const m=new Map;m.set(Me.a.font,d);this.XB(m)}else this.Jza(xe.a.font,new Fw.a(d))}get size(){if(null!=this._style){if(this._style.hasProperty(Me.a.fontSize))return this._style.getValue(Me.a.fontSize)/2}else{var d=this.bY();return d.cPc?null:d.fontSize/2}}set size(d){if(d>Tv.Mbn||d<Tv.Aen)v.ULS.sendTraceTag(36312091,369,50,"Invalid font size: {0}.",d),sc.a.qd();if(null!=this._style){const m=new Map;m.set(Me.a.fontSize,
Math.round(2*d));this.XB(m)}else this.Jza(xe.a.WA,new Fw.a(Math.round(2*d)))}get strikeThrough(){if(null!=this._style){if(this._style.hasProperty(Me.a.strikethrough))return this._style.getValue(Me.a.strikethrough)}else{var d=this.bY();return d.Pmc?null:1===d.strikethrough}}set strikeThrough(d){sc.a.iy(d,"Font.StrikeThrough");if(null!=this._style){const m=new Map;m.set(Me.a.strikethrough,d);this.XB(m)}else this.nlc(xe.a.strikethrough,d)}get subscript(){if(null!=this._style){if(this._style.hasProperty(Me.a.subscript))return this._style.getValue(Me.a.subscript)}else{var d=
this.bY();return d.sbd?null:1===d.subscript}}set subscript(d){sc.a.iy(d,"Font.Subscript");if(null!=this._style){const m=new Map;m.set(Me.a.subscript,d);this.XB(m)}else this.nlc(xe.a.subscript,d)}get superscript(){if(null!=this._style){if(this._style.hasProperty(Me.a.superscript))return this._style.getValue(Me.a.superscript)}else{var d=this.bY();return d.tbd?null:1===d.superscript}}set superscript(d){sc.a.iy(d,"Font.SuperScript");if(null!=this._style){const m=new Map;m.set(Me.a.superscript,d);this.XB(m)}else this.nlc(xe.a.superscript,
d)}get underline(){const d=[1,2,3,6,4,20,7,23,39,55,9,25,10,26,11,27,43,0];if(null!=this._style){if(this._style.hasProperty(Me.a.underlineType)){var m=this._style.getValue(Me.a.underlineType);const A=this.iki();return d[A.J(Gw[m])]}}else return m=this.bY(),m.TV?-1:d[m.underlineType]}set underline(d){var m=this.iki();m.nb(Gw[d])||sc.a.qd();null!=this._style?(m=new Map,m.set(Me.a.underlineType,d),0!=d&&m.set(Me.a.underline,!0),this.XB(m)):this.Jza(xe.a.hka,m.J(Gw[d]))}get _ReferenceId(){return this.yq?
this.Tq:null}_KeepReference(){this.rq()}_OnAccess(){if(null==this._style)switch(this.dsc){case 0:case 5:case 6:this.Ed=this.gb.Hz(this.owd,!0,!1);break;case 3:this.Ed=new U.a;this.Ed.add(jd.a.create(this.owd));break;case 1:this.Ed=this.B_j.lF();break;case 4:n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")?this.Ed=this.ED.Xbc?this.ED.Xbc.Xp:this.tXb?this.tXb.Xp:this.ED.Xp:this.Ed=this.ED.Xp;break;default:v.ULS.sendTraceTag(21824032,369,15,"AppId:{0}, invalid object type to set font on.",
this._context.appId)}}getTypeName(){return"Microsoft.WordServices.Font"}invokePropertyGet(d){switch(d){case 4:return this.bold;case 6:return this.color;case 11:return this.doubleStrikeThrough;case 12:return this.highlightColor;case 5:return this.italic;case 2:return this.name;case 3:return this.size;case 10:return this.strikeThrough;case 8:return this.subscript;case 9:return this.superscript;case 7:return this.underline;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this.bold=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean?");return;case 6:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 11:this.doubleStrikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean?");return;case 12:this.highlightColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 5:this.italic=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean?");return;case 2:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.size=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number?");return;case 10:this.strikeThrough=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean?");return;case 8:this.subscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean?");return;case 9:this.superscript=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean?");return;case 7:this.underline=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}iki(){const d=new Fk.a;d.add("single",0);d.add("word",1);d.add("double",2);d.add("thick",3);d.add("dotted",4);d.add("dottedHeavy",5);d.add("dashLine",6);d.add("dashLineHeavy",7);d.add("dashLineLong",8);d.add("dashLineLongHeavy",9);d.add("dotDashLine",10);d.add("dotDashLineHeavy",11);d.add("twoDotDashLine",12);
d.add("twoDotDashLineHeavy",13);d.add("wave",14);d.add("waveHeavy",15);d.add("waveDouble",16);d.add("none",17);return d}nlc(d,m){m=m?new Bu.a(1):new Bu.a(0);sc.a.o9i()?this.Hla.Jza(this.Ed,d,m):this.Jza(d,m)}Qdg(d,m){this.Jza(d,m)}Jza(d,m){if(this.ala.JIc(this.Ed,0)){var A=new au.a;for(let R=0;R<this.Ed.count;R++)this.Ed.J(R).contextId!==ic.a.Tc&&A.addContext(this.Ed.J(R));this.ga.t3f(A,d,2,!0,new kt.a,m)}}bY(){this._OnAccess();if(!this.Amd)if(sc.a.o9i()){var d=this.Hla.bY(this.Ed);d&&(this.Amd=d)}else{d=
[new Pe.Selection(this.Ed.toArray(),!0)];d=new Jo.SelectionCollection(d,0);const m=new fo;m.formatting=new az.a;m.Hig=d;32===this.ga.Mf(new Pr.a(null),xe.a.q5c,2,!0,new kt.a,m)&&(this.Amd=m.formatting)}return this.Amd}M6c(){n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.tXb&&(this.tXb.lpb(),this.tXb=null)}XB(d){const m=this._style.getValue(wc.a.ma),A=new Kl.ScriptSharpLegacyMap;for(const R of d)A.Z(R[0],R[1]);this.ev.LSa(m,A,vg.a.zr())}}Tv.Mbn=bz.a.jOi/2;Tv.Aen=1;Object(y.a)(Tv,
"Font",ih.a,[841]);class RA{constructor(d,m,A,R,da){this.gb=d;this.ga=m;this.ala=A;this.Hla=R;this.ev=da}create(d,m,A,R,da,Ea=null){return new Tv(d,m,A,R,da,Ea,this.ev,this.gb,this.ga,this.ala,this.Hla)}}Object(y.a)(RA,"FontFactory",null,[]);class SA{constructor(d,m){this.ga=d;this.ala=m}bY(d){d=[new Pe.Selection(d.toArray(),!0)];d=new Jo.SelectionCollection(d,0);const m=new fo;m.formatting=new az.a;m.Hig=d;return 32===this.ga.Mf(new Pr.a(null),xe.a.q5c,2,!0,new kt.a,m)?m.formatting:null}Jza(d,m,
A){if(this.ala.JIc(d,0)){var R=new au.a;for(let da=0;da<d.count;da++)d.J(da).contextId!==ic.a.Tc&&R.addContext(d.J(da));this.ga.t3f(R,m,2,!0,new kt.a,A)}}}Object(y.a)(SA,"FontOperaions",null,[1002]);class Hw{constructor(d,m){this.Zt=d;this.TWe=m;this.pkh=[]}Iu(d=null,m=15){d||(d=this.Zt.value);m=this.TWe.Pc(m);m.Db(d);this.pkh.push(m)}WH(){this.pkh.pop().dispose()}M4b(d){this.WH();this.Iu(d,4)}}Object(y.a)(Hw,"GraphTransactionWrapper",null,[1001]);var Hu=c(1871);class SB{constructor(d,m,A,R,da,Ea,
ib,Qb,pc){this.dW=d;this.ap=m;this.gb=A;this.Eu=R;this.lA=da;this.P2j=Ea;this.Zf=ib;this.Ca=Qb;this.qr=pc}csf(d,m){sc.a.jKa(m,"GraphNode");const A=this.dW.OPc(m,5);this.fbi(A,m,d)}FSd(d,m){sc.a.iy(m,"GraphNodeContext");const A=this.dW.b6h(m);this.fbi(A,m.node,d)}fbi(d,m,A){for(const R of d){d=!1;const da=Ia.a.instance.Oa("Box4.IFeatureHelper");if(this.ap.occ(R)||this.ap.mcc(R)||this.ap.ncc(R)||this.ap.pcc(R)||da&&da.isFeatureEnabled(51)&&this.ap.qcc(R))d=!0;d&&(d=R.Lb.cp,A.add(jd.a.createTextRange(m,
d,d+1)))}}HIb(d,m,A,R){sc.a.upc(d,"imgBase64Str");d=d.trim();return OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{var ib=m.node,Qb=new If.GraphIterator;Qb.set(ib);const pc=this.P2j.create(Qb,da,Ea),Pc=document.createElement("img");da=()=>{const gd=new Hu.a(Pc.src,Pc.alt,Pc.width,Pc.height);this.akf(pc,gd,m,A)};ib=()=>{Ea("")};n.AFrameworkApplication.pu&&R?(R.useSourceImageProps&&(R.height=0,R.width=0),this.akf(pc,this.i1l(d,R),m,A)):(Qb=!1,(Qb=void 0!==Pc.onload&&void 0!==Pc.onerror)?
(Pc.onload=da,Pc.onerror=ib,Pc.src=String.format("data:image/png;base64,{0}",d)):this.akf(pc,this.h1l(d),m,A))})}h1l(d){const m=document.createElement("img");m.src=String.format("data:image/{0};base64,{1}","png",d);return new Hu.a(m.src,m.alt,m.width,m.height)}i1l(d,m){return new Hu.a(d,m.altText?m.altText:"",m.width,m.height)}k0h(d,m){if(m&&5===m.vh){m=m.id;d=this.dW.OPc(d,5);for(const A of d)if(A.id.equals(m))return A.Lb.cp}return-1}bEl(d,m){let A=this.k0h(d,m);return 0>A&&({node:d,returnValue:A}=
this.cEl(m),0>A)?{returnValue:-1,hoh:d}:{returnValue:A,hoh:d}}cEl(d){var m=this.dai();for(const A of m)if(m=this.k0h(A,d),-1!==m)return d=A,{returnValue:m,node:d};return{returnValue:-1,node:null}}wOc(d){const m=(new Date).getTime();let A=null;d=({hoh:A}=this.bEl(d.node,d.blob)).returnValue;sc.a.$M("ImageApiOperations.FindImageContextFromResult",sc.a.zN(m));return 0>d?(v.ULS.sendTraceTag(17433739,369,10,"the inserted inline picture can't be found"),sc.a.Tf(),null):jd.a.createTextRange(A,d,d+1)}getBase64ImageSrc(d,
m,A,R,da,Ea){const ib=this.ap.n6(d.properties,Dm.a.ft,null);ib?this.ap.O0(ib)?(this.ygi(d,ib,R),A.Jm.Iu(m.node)):(v.ULS.sendTraceTag(23594887,369,15,"AppId:{0}, Not valid ImageDataUrl: {1} ",A.appId,ib),sc.a.Tf()):this.Y0l(m,d,A,R,da,Ea)}Y0l(d,m,A,R,da,Ea){const ib=m.properties,Qb=this.ap.qFa(ib,d.node.Zi().xd,this.Ca,this.qr);this.ap.gKb(Qb)?this.ap.P2a(this.Zf,Qb,pc=>{let Pc=!0;const gd=pc.data.te;2===pc.data.status&&this.ap.O0(gd)?(this.ygi(m,gd,R),ib.setValue(Dm.a.ft,gd)):(da(""),Pc=!1);A.Jm.Iu(d.node);
sc.a.$M("ImageApiOperations.GetImageSrcFromServer",sc.a.zN(Ea),void 0,Pc)},()=>{da("");A.Jm.Iu(d.node);sc.a.$M("ImageApiOperations.GetImageSrcFromServer",sc.a.zN(Ea),void 0,!1)}):(v.ULS.sendTraceTag(23594888,369,15,"AppId:{0}, ImageDataUrl null, but not supported data url request: {1} ",A.appId,Qb),sc.a.Tf())}ygi(d,m,A){let R=null;const da=document.createElement("img");da.src=m;da.onload=()=>{var Ea=new km.a;const ib=Ea.nf(this.ap.WC(d.properties),0);Ea=Ea.nf(this.ap.YH(d.properties),1);const Qb=
document.createElement("canvas");Qb.width=ib;Qb.height=Ea;Qb.getContext("2d").drawImage(da,0,0,ib,Ea);R=Qb.toDataURL();A(R.substr(R.indexOf(";base64,")+8))}}dai(){const d=new If.GraphIterator;d.set(this.Eu.value);this.lA.GP(d);return this.gb.yw(this.lA.Etf(d.currentNode),!0,!0)}akf(d,m,A,R){d.Aqn(m,A);R.Jm.WH();d.pYf()}}Object(y.a)(SB,"ImageApiOperations",null,[999]);class TA extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe){super();sc.a.iy(d,"GraphNodeContext");this.xq=d;this._context=
m;this._id=A;this.Vn=R;this.tk=da;this.fM=Ea;this.ap=ib;this.Vj=Qb;this.Haa=this.wSd(this.xq);this.Qw=pc;this.Ig=Pc;this.iq=gd;this.hd=Cd;this.ew=ae;this.om=Xd;this.gb=se;this.$c=Xe}get altTextDescription(){return this.ap.uQa(this.Haa.properties)}set altTextDescription(d){this.Vj.qQb(this.Haa.properties,d)}get altTextTitle(){return this.ap.eY(this.Haa.properties)}set altTextTitle(d){this.Vj.CUa(this.Haa.properties,d)}get height(){const d=this.ap.YH(this.Haa.properties);return Jg.a.$5a(d)}set height(d){sc.a.ZVa(d,
"InlinePicture.Height");d=Jg.a.Uya(d);this.lockAspectRatio&&this.Vj.VIa(this.Haa.properties,this.width/this.height*d);this.Vj.UIa(this.Haa.properties,d)}get hyperlink(){return this.ap.f$b(this.Haa.properties)}set hyperlink(d){this.Vj.Cko(this.Haa.properties,d)}get imageFormat(){return 0}get lockAspectRatio(){return this.ap.I4a(this.Haa.properties)}set lockAspectRatio(d){this.Vj.vmj(this.Haa.properties,d)}get paragraph(){return this.Vn.create(this.xq.node,this._context)}get parentContentControl(){const d=
this.parentContentControlOrNullObject;d||sc.a.Tk();return d}get parentContentControlOrNullObject(){this.w9a();return this.Ig.eac(this.xq,this.xq,this._context)}get parentTable(){if(!sc.a.Ai())return null;const d=this.parentTableOrNullObject;d||sc.a.Tk();return d}get parentTableCell(){if(!sc.a.Ai())return null;const d=this.parentTableCellOrNullObject;d||sc.a.Tk();return d}get parentTableCellOrNullObject(){return sc.a.Ai()?this.$c.H$b(this.xq.node,this._context):null}get parentTableOrNullObject(){return sc.a.Ai()?
this.$c.Ejb(this.xq.node,this._context):null}get width(){const d=this.ap.WC(this.Haa.properties);return Jg.a.$5a(d)}set width(d){sc.a.ZVa(d,"InlinePicture.Width");d=Jg.a.Uya(d);this.lockAspectRatio&&this.Vj.UIa(this.Haa.properties,this.height/this.width*d);this.Vj.VIa(this.Haa.properties,d)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}deleteInlinePicture(){this.w9a();const d=this.xq.node;for(let m=0;m<d.ra.length;m++)if(d.ra.J(m).cp===this.xq.cpBegin){this.hd.qll(this.xq);
break}}getBase64ImageSrc(){const d=(new Date).getTime();this._context.Jm.WH();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this.Qw.getBase64ImageSrc(this.Haa,this.xq,this._context,m,A,d)})}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){sc.a.Ai()||sc.a.zk();const d=this.F6l();return d?this.fM.create(d,this._context):null}getRange(d){sc.a.Ai()||sc.a.zk();1!==d&&2!==d&&d&&(v.ULS.sendTraceTag(18745293,369,15,"AppId:{0}, rangeLocation of InlinePicture.GetRange must be Start/End/Whole.",
this._context.appId),sc.a.qd());const m=new U.a;m.add(this.xq);this.w9a();return this.tk.create(this.om.D9b(m,d),this._context)}insertBreak(d,m){m&&1!==m&&(v.ULS.sendTraceTag(17339015,369,15,"AppId:{0}, insertLocation of InlinePicture.InsertBreak must be Before or After.",this._context.appId),sc.a.qd());const A=(new Date).getTime(),R=new U.a;R.add(this.xq);this.w9a();return OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{this.hd.insertBreak(R,d,m,this._context,da,Ea,A)})}insertContentControl(){this.w9a();
const d=new U.a;d.add(this.xq);this.Ig.j1e(d);1!==d.count&&(v.ULS.sendTraceTag(37777540,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),sc.a.Tf());return d.J(0)!==this.xq?this.Ig.Uma(d.J(0),d.J(0),this._context):this.Ig.E_a(this.xq,this._context)}insertFileFromBase64(d,m){"<"===d.charAt(0)&&(v.ULS.sendTraceTag(18130837,369,10,"invalid argument for insertFileFromeBase64 API in InlinePicture class.",this._context.appId),sc.a.qd());return this.lia(d,m,!1)}insertHtml(d,m){const A=
(new Date).getTime();if(!m||1===m){const R=new U.a;R.add(this.xq);return this.ew.insertHtml(R,d,m,A,this._context)}sc.a.qd();return null}insertInlinePictureFromBase64(d,m){if(2===m||3===m)return v.ULS.sendTraceTag(17319648,369,50,"AppId:{0}, insert inline picture with none supported location in InlinePicture class.",this._context.appId),sc.a.qd(),null;const A=(new Date).getTime();let R=null;this.w9a();if(4===m){let da;this.hd.ZT((da=new U.a,da.add(this.xq),da),m,0);R=jd.a.Uc(this.xq.node,this.xq.cpBegin);
R.Fb=R.Sb=this.xq.Ln();this.deleteInlinePicture()}else{({JJ:R}=this.hd.mL(this.xq,this.xq,m));let da;this.hd.ZT((da=new U.a,da.add(R),da),m,0)}return this.Qw.HIb(d,R,this._context).then(da=>{this._context.Jm.Iu(this.xq.node);if(!da)return v.ULS.sendTraceTag(17433740,369,10,"AppId:{0}, something went wrong when insert iamge into InlinePicture.",this._context.appId),sc.a.$M("InlinePicture.InsertInlinePictureFromBase64",sc.a.zN(A),d.length,!1),sc.a.Tf(),null;sc.a.$M("InlinePicture.InsertInlinePictureFromBase64",
sc.a.zN(A),d.length);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.fM.create(this.Qw.wOc(da),this._context))})}insertOoxml(d,m){"<"!==d.charAt(0)&&(v.ULS.sendTraceTag(18130838,369,10,"invalid argument for InsertOoxml API in InlinePicture class.",this._context.appId),sc.a.qd());return this.lia(d,m,!0)}insertParagraph(d,m){m&&1!==m&&(v.ULS.sendTraceTag(21070049,369,15,"AppId:{0}, Invalid insert location for InlinePicture.InsertPparagraph method.",this._context.appId),sc.a.qd());
this.w9a();let A;return this.Vn.create(this.hd.insertParagraph((A=new U.a,A.add(this.xq),A),d,m),this._context)}insertText(d,m){m&&1!==m&&(v.ULS.sendTraceTag(17339328,369,15,"AppId:{0}, invalid location for InlinePicture.InsertText:{1}.",this._context.appId,Wn[m]),sc.a.qd());this.w9a();let A;return this.tk.create(this.hd.insertText((A=new U.a,A.add(this.xq),A),d,m),this._context)}select(d){const m=new U.a;m.add(this.xq);this.iq.select(m,d)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.xq.node,
"InlinePicture")}getTypeName(){return"Microsoft.WordServices.InlinePicture"}invokePropertyGet(d){switch(d){case 3:return this.altTextDescription;case 4:return this.altTextTitle;case 5:return this.height;case 6:return this.hyperlink;case 11:return this.imageFormat;case 7:return this.lockAspectRatio;case 10:return this.paragraph;case 9:return this.parentContentControl;case 15:return this.parentContentControlOrNullObject;case 14:return this.parentTable;case 13:return this.parentTableCell;case 16:return this.parentTableCellOrNullObject;
case 17:return this.parentTableOrNullObject;case 8:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 3:this.altTextDescription=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 4:this.altTextTitle=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 6:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 7:this.lockAspectRatio=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 8:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,
m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1012:return this.UD(m);case 1015:return this.Cca();case 1016:return this.Dca();case 1014:return this.Qoa(m);case 1004:return this.nGa(m);case 1010:return this.qpa(m);case 1007:return this.pGa(m);case 1013:return this.iea(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
m){switch(d){case 1003:return this.nPl();case 1006:return this.W3a(m);case 1011:return this.opa(m);case 1008:return this.Z3a(m);case 1005:return this.$3a(m);case 1009:return this.c4a(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteInlinePicture();return null}nPl(){return this.getBase64ImageSrc()}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}Qoa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,
"int");return this.getRange(d)}W3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(m,d)}nGa(){return this.insertContentControl()}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(m,d)}Z3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(m,d)}$3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(m,d)}c4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(m,d)}qpa(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(m,d)}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(m,d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();
return null}wSd(d){return this.ap.BFa(d)}F6l(){if(!this.xq)return null;const d=new U.a;if(this.xq.cpEnd!==this.xq.node.characterData.length){var m=jd.a.createTextRange(this.xq.node,this.xq.cpEnd,this.xq.node.characterData.length);this.Qw.FSd(d,m);if(d.count)return d.J(0)}for(m=this.gb.Wf(this.xq.node,!1,!0);m;){this.Qw.csf(d,m);if(d.count)return d.J(0);m=this.gb.Wf(m,!1,!0)}return null}lia(d,m,A){const R=(new Date).getTime();if(!m||1===m){this.w9a();const da=new U.a;da.add(this.xq);return OfficeExtension.WacRuntime.Utility.createPromise((Ea,
ib)=>{this.ew.insertOoxml(da,d,m,this.xq.node,this._context,Ea,ib,R,A?0:1)})}v.ULS.sendTraceTag(18130839,369,15,"AppId:{0}, InlinePicture.InsertOoxmlOrDocx: undefined location!",this._context.appId);sc.a.qd();return null}w9a(){const d=this.gb.Ml(this.xq.node,this.xq.cpBegin),m=this.gb.Ml(this.xq.node,this.xq.cpEnd);this.xq.Fb=0<d?d:-1;this.xq.Sb=0<m?0:-1}}Object(y.a)(TA,"InlinePicture",ih.a,[841]);class Am{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc){this.tk=this.Vn=null;this.ap=d;this.Vj=m;this.Qw=A;this.Ig=
R;this.iq=da;this.hd=Ea;this.ew=ib;this.om=Qb;this.gb=pc;this.$c=Pc}Ju(d,m){this.Vn=d;this.tk=m}create(d,m,A=0){return new TA(d,m,A,this.Vn,this.tk,this,this.ap,this.Vj,this.Qw,this.Ig,this.iq,this.hd,this.ew,this.om,this.gb,this.$c)}}Object(y.a)(Am,"InlinePictureFactory",null,[858]);var iy=c(449),bu=c(722),Is=c(1990),sx;(function(d){d[d.page=0]="page";d[d.next=2]="next";d[d.csp=1002]="sectionNext";d[d.$rp=3]="sectionContinuous";d[d.asp=4]="sectionEven";d[d.dsp=5]="sectionOdd";d[d.line=6]="line"})(sx||
(sx={}));Object(y.b)("BreakType",sx);class TB{constructor(){this.CGa=this.wSi=null;this.keepCurrentFocus=this.Rdc=!1}}Object(y.a)(TB,"NoteItemActionData",null,[]);class Iw{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd){this.pma=this.gO=this._context=this.$c=this.Ig=null;this.D2=0;this.ga=d;this.Md=m;this.rh=A;this.gb=R;this.ala=da;this.gCa=Ea;this.Nk=ib;this.Vd=Qb;this.GD=pc;this.EE=Pc;this.dta=gd;this.dW=Cd;this.Qcb=ae;this.hb=Xd}Ju(d,m){this.Ig=d;this.$c=m}jti(d,m,A){var R;({JJ:R}=this.mL(d.J(0),
d.J(d.count-1),1));d=Object.assign(new TB,{CGa:R,Rdc:!0,keepCurrentFocus:!0});if(32!==this.ga.Qb(0===A?Ac.a.insertFootnote:Ac.a.insertEndnote,2,d))return sc.a.pD(),null;A=new U.a;(R=this.dW.Oof(R.node,R.cpBegin))||sc.a.Tf();R=R.I4();R=this.eZl(R);A.add(jd.a.tw(R));m||(m="");this.insertText(A,m,1);return d.wSi}ull(d){var m=this.hb.ib;if(m&&m.lb&&m.lb.Pa&&(m=m.lb.Pa.node,12===m.type&&this.EE.K2a(m)===d&&32!==this.ga.Qb(Ac.a.r4,2,null))){sc.a.Tf();return}m=new U.a;if(d=d.xoa)d=d.Lb,m.add(jd.a.createTextRange(d.paragraph,
d.cp,d.cp+1));this.R6b(m)}H4(d){d=this.EE.H4(d);if(1===d)return 0;if(0===d)return 1}G6l(d,m){if(d=d.xoa)if(d=d.Lb,m=this.dta.hdi(d.paragraph,d.cp+1,0===m?1:0))return m.I4();return null}eZl(d){d&&38===d.type||sc.a.Tf();d=If.GraphIterator.eb(d);d.Rd();return d.Rd()}X9b(d,m){var A=new If.GraphIterator;A.set(d);d=new U.a;this.gb.Bjb(A,!0,!1,d);A=new U.a;for(const R of d)d=this.rrf(R,m),A.addRange(d);return A}rrf(d,m){var A=this.dW.OPc(d,7);d=new U.a;m=0===m?1:0;for(const R of A)A=R.I4(),R.H4()===m&&d.add(A);
return d}nSd(d,m){const A=new U.a,R=d.count;if(this.eJf(d.J(0).node))return d=this.b$l(d.J(0).node,m),A.add(d),A;for(let Qb=0;Qb<R;Qb++){var da=d.J(Qb);if(da.contextId==ic.a.Vc)continue;var Ea=da.node;let pc=0,Pc=Ea.characterData.length;0===Qb&&0<=da.cpBegin&&(pc=da.cpBegin);Qb===R-1&&0<=da.cpEnd&&(Pc=da.cpEnd);da=Ea.ra;for(Ea=0;Ea<da.length;Ea++)if(!(da.J(Ea).cp<pc)){if(da.J(Ea).cp>Pc)break;var ib=da.J(Ea).blob;if(ib&&7==ib.vh){const gd=0===m?1:0;ib.H4()===gd&&(ib=ib.I4(),A.add(ib))}}}return A}Gva(d,
m){const A=new U.a;let R=0;for(const da of d)A.add(this.Qcb.create(da,m,R++));return A}mL(d,m,A,R=!1){let da=0,Ea=null;switch(A){case 2:case 0:if(d.contextId===ic.a.paragraph)m=0,this.KWc(d.node)&&(R=this.eSd(d.node),-1!==R&&(m=R+2>this.gb.textLength(d.node)?this.gb.textLength(d.node):R+2)),Ea=jd.a.Uc(d.node,m),da=2===A?0:4;else if(d.contextId===ic.a.Vc)Ea=jd.a.tw(d.node),da=this.gb.textLength(d.node)?2===A?2:6:2===A?1:5;else if(d.contextId===ic.a.Fd||d.contextId===ic.a.Tc)Ea=jd.a.Uc(d.node,d.cpBegin),
da=2===A?3:7;else{if(d.contextId===ic.a.table)return{returnValue:8,JJ:d};sc.a.qd()}Ea.Fb=Ea.Sb=d.Ln();break;case 3:case 1:m.contextId===ic.a.paragraph||m.contextId===ic.a.Vc?(3===A?(Ea=jd.a.tw(m.node),Ea.Fb=Ea.Sb=m.Mn()):(Ea=this.MTl(m,R),0<this.gb.Ml(Ea.node,0)?Ea.Fb=Ea.Sb=this.gb.ix(Ea.node):Ea.Fb=Ea.Sb=-1),da=3===A?9:11):m.contextId===ic.a.Fd||m.contextId===ic.a.Tc?(Ea=jd.a.Uc(m.node,m.cpEnd),Ea.Fb=Ea.Sb=m.Mn(),da=3===A?10:12):sc.a.qd();break;case 4:({JJ:Ea}=this.mL(d,m,0));da=13;break;default:v.ULS.sendTraceTag(17339329,
369,15,"Undefined insert location: {0}",Wn[A]),sc.a.qd()}return{returnValue:da,JJ:Ea}}ode(d,m){if(1<d.count){const A=d.J(0);let R=d.J(d.count-1);switch(m){case 2:if(R.contextId===ic.a.Tc)d.remove(R),R=d.J(d.count-1),R.contextId===ic.a.paragraph&&(d.Z(d.count-1,jd.a.createTextRange(R.node,0,this.gb.textLength(R.node))),this.$u(d.J(d.count-1),2));else for(const da of d)if(da.contextId===ic.a.Vc){d.remove(da);d.insert(0,da);break}break;case 0:case 4:2===d.count&&R.contextId===ic.a.Tc?(d.remove(R),d.Z(0,
jd.a.tw(A.node)),this.$u(d.J(0),2,R)):m||d.J(1).contextId!==ic.a.Vc?d.remove(A):d.removeAt(1);break;case 3:A.contextId===ic.a.Tc&&(d.remove(A),R.contextId===ic.a.paragraph&&(d.Z(d.count-1,jd.a.createTextRange(R.node,0,this.gb.textLength(R.node))),this.$u(d.J(d.count-1),2)));break;case 1:2===d.count&&A.contextId===ic.a.Tc?d.remove(A):d.remove(R)}}}yoe(d,m,A,R,da){if(!R)return 13===A&&(d.clear(),d.add(m)),m;let Ea=null;const ib=d.J(0),Qb=d.J(d.count-1);switch(A){case 0:Ea=jd.a.createTextRange(m.node,
0,R);d.Z(0,jd.a.create(m.node));d.J(0).Sb=ib.Mn();this.$u(d.J(0),0);break;case 1:Ea=jd.a.createTextRange(m.node,0,R);d.Z(0,jd.a.create(m.node));d.J(0).Fb=0<this.gb.Ml(m.node,0)?this.gb.Ml(m.node,0):-1;d.J(0).Sb=0<this.gb.Ml(m.node,R)?this.gb.uw(m.node):-1;break;case 2:Ea=jd.a.createTextRange(m.node,da,da+R);d.insert(0,Ea);this.$u(d.J(0),2);break;case 3:Ea=jd.a.createTextRange(m.node,ib.cpBegin,ib.cpBegin+R);d.Z(0,jd.a.createTextRange(m.node,ib.cpBegin,ib.cpEnd+R));ib.contextId===ic.a.Fd?(d.J(0).Sb=
ib.Mn(),this.$u(d.J(0),0)):this.$u(d.J(0),2);break;case 4:Ea=jd.a.createTextRange(m.node,0,R);d.Z(0,jd.a.tl(m.node));A=this.gb.Ml(m.node,R+da);0<da?(d.insert(0,jd.a.createTextRange(m.node,R,R+da)),d.J(0).Sb=ib.Mn(),this.rAa(d.J(0))):(d.J(0).Fb=0<A?0:-1,d.J(0).Sb=0<A?this.gb.uw(m.node):-1);break;case 5:case 6:this.rAa(d.J(0));d.J(0).Sb=0<this.gb.Ml(d.J(0).node,this.gb.textLength(d.J(0).node))?this.gb.uw(m.node):-1;6===A&&this.xmf(m.node,da);Ea=jd.a.createTextRange(m.node,da,da+R);break;case 7:ib.cpBegin&&
this.xmf(m.node,ib.cpBegin);Ea=jd.a.createTextRange(m.node,ib.cpBegin,ib.cpBegin+R);ib.contextId===ic.a.Fd?(d.Z(0,jd.a.createTextRange(m.node,ib.cpBegin+R,ib.cpEnd+R)),this.rAa(d.J(0)),d.J(0).Sb=ib.Mn()):(d.Z(0,jd.a.Uc(m.node,ib.cpBegin+R)),this.rAa(d.J(0)),d.J(0).Sb=d.J(0).Ln()+ib.Mn()-ib.Ln());break;case 9:Ea=jd.a.createTextRange(m.node,da,da+R);d.removeAt(d.count-1);Qb.contextId===ic.a.paragraph?(d.add(jd.a.create(m.node)),d.J(d.count-1).Fb=Qb.Ln(),this.$u(d.J(d.count-1),1)):(d.add(jd.a.createTextRange(m.node,
da,da+R)),d.add(jd.a.tl(m.node)),R=this.gb.Ml(m.node,R+da),d.J(d.count-1).Fb=0<R?0:-1,d.J(d.count-1).Sb=0<R?this.gb.uw(m.node):-1);break;case 10:Ea=jd.a.createTextRange(m.node,Qb.cpEnd,Qb.cpEnd+R);Qb.cpEnd&&this.xmf(m.node,Qb.cpEnd);d.Z(d.count-1,jd.a.createTextRange(m.node,Qb.cpBegin,Qb.cpEnd+R));Qb.contextId!==ic.a.Tc||Qb.Ln()?d.J(d.count-1).Fb=Qb.Ln():d.J(d.count-1).Fb=-1;this.$u(d.J(d.count-1),1);break;case 11:Ea=da?jd.a.createTextRange(m.node,0,R):jd.a.create(m.node);break;case 12:Ea=jd.a.createTextRange(m.node,
Qb.cpEnd,Qb.cpEnd+R);break;case 13:Ea=jd.a.createTextRange(d.J(0).node,d.J(0).cpBegin,d.J(0).cpBegin+R),d.Z(0,Ea),this.$u(d.J(0),2)}this.$u(Ea,2);return Ea}YJa(d,m,A=2){if(2===A||!A){var R=d.node.ra;0<R.length&&((R=R.first)&&-1!==d.Ln()?d.Fb=R.Iw:d.Fb=-1)}if(2===A||1===A)d=m.node.ra,0<d.length&&((d=d.last)&&-1!==m.Mn()?m.Sb=d.Iw+d.vN+d.RX:m.Sb=-1)}ZJa(d,m=null){switch(d.contextId){case ic.a.paragraph:this.mVo(d);break;case ic.a.Fd:this.oVo(d,m);break;case ic.a.Tc:this.jVo(d,m)}}jVo(d,m=null){0<this.gb.Ml(d.node,
d.cpBegin)?d.Fb=d.Sb=this.gb.ix(d.node):d.Fb=d.Sb=-1;d.Sb=d.Fb+(m?m.Mn()-m.Ln():0)}oVo(d,m){const A=this.gb.Ml(d.node,d.cpBegin);d.Sb=m.Mn();d.Fb=0<A?this.gb.ix(d.node):-1}mVo(d){var m=this.gb.textLength(d.node);const A=this.gb.Ml(d.node,0);m=this.gb.Ml(d.node,m);d.Fb=0<A?this.gb.ix(d.node):-1;d.Sb=0<m?this.gb.uw(d.node):-1}$u(d,m=2,A=null){switch(d.contextId){case ic.a.paragraph:this.lVo(d,m);break;case ic.a.Fd:this.nVo(d,m);break;case ic.a.Tc:this.kVo(d,A)}}rAa(d){const m=d.contextId!==ic.a.Vc?
d.cpBegin:this.gb.textLength(d.node);d.Fb=0<this.gb.Ml(d.node,m)?0:-1}kVo(d,m=null){0<this.gb.Ml(d.node,d.cpBegin)?d.Fb=0:d.Fb=-1;d.Sb=d.Fb+(m?m.Mn()-m.Ln():0)}nVo(d,m=2){const A=this.gb.Ml(d.node,d.cpBegin),R=this.gb.Ml(d.node,d.cpEnd);switch(m){case 2:d.Fb=0<A?A:-1;d.Sb=0<R?0:-1;break;case 0:d.Fb=0<A?A:-1;break;case 1:d.Sb=0<R?0:-1}}lVo(d,m=2){const A=this.gb.textLength(d.node);var R=this.gb.Ml(d.node,0),da=this.gb.Ml(d.node,A);const Ea=0<R?R:-1;da=0<da?0:-1;const ib=0<R?R/2:-1;R=0<R?R/2:-1;switch(m){case 2:d.Fb=
0<A?Ea:ib;d.Sb=0<A?da:R;break;case 0:d.Fb=0<A?Ea:ib;break;case 1:d.Sb=0<A?da:R}}MTl(d,m=!1){const A=d.node;var R=this.gb.Wf(A,!1);if(!R)R=jd.a.Uc(A,this.gb.textLength(A)),R.Fb=R.Sb=d.Mn(),{F6b:R}=this.Pbc(R,!1),R=R.Tb(2);else if(m){d=this.$c.r0(R);for(m=null;d&&R===this.gb.$k(d);)m=d,d=this.$c.r0(d);m&&(R=this.$c.sti(m,!0))}return jd.a.Uc(R,0)}insertBreak(d,m,A,R,da,Ea,ib,Qb=null,pc=!1){this.ZT(d,A,6===m?0:1);let Pc=null,gd=({JJ:Pc}=this.mL(d.J(0),d.J(d.count-1),A)).returnValue;const Cd=new If.GraphIterator;
Cd.set(Pc.node);Cd.zb(23)||6===m||(v.ULS.sendTraceTag(17577860,369,15,"Inserting Break (excpect LineBreak) is only allowed in the main document."),sc.a.Tf());Qb&&Qb.lpb();switch(m){case 0:Pc=this.Ig.RJa(Pc,d);32!==this.ga.Mf(Pc,Ac.a.oGa,2,!1,null,null)&&sc.a.Tf();pc&&this.zGj(d,m,gd);Qb&&Qb.Hva(d);da(null);break;case 6:(R=this.X_d(d,A))&&({JJ:Pc,returnValue:gd}=this.mL(d.J(0),d.J(d.count-1),A));this.Md.kia(Pc,ae=>new iy.a(ae));pc&&this.zGj(d,m,gd);R&&this.ode(d,A);Qb&&Qb.Hva(d);da(null);break;case 2:case 1002:case 3:case 4:case 5:(A=
this.Ig.Nei(Pc,Pc))&&0<A.count&&(Qb&&Qb.Hva(d),sc.a.Rnc(R.appId,"Insert section break in content control is not allowed on wac currently.",void 0,sx[m]));this.cVc(R,da,Ea,ib);this.mFm(Pc,m,d,gd,Object(I.a)(this,this.jXo,"updateGncListForInsertSectionBreak"),Qb);break;default:v.ULS.sendTraceTag(17179037,369,15,"The breakType parameter is invalid: {0}.",sx[m]),sc.a.qd()}}mFm(d,m,A,R,da,Ea){let ib=0;switch(m){case 2:case 1002:ib=2;break;case 3:ib=3;break;case 4:ib=4;break;case 5:ib=5;break;default:v.ULS.sendTraceTag(18957145,
369,15,"The breakType parameter is undefined: {0}.",sx[m]),sc.a.qd()}this._context.Jm.WH();this.gCa.Ghe([d],"<w:p xmlns:w='http://schemas.microsoft.com/office/word/2003/wordml'><w:r><w:rPr><w:b/><w:b-cs/><w:color w:val='FF0000'/><w:sz w:val='28'/><w:sz-cs w:val='28'/></w:rPr><w:t>H</w:t></w:r></w:p>",0,0,ib,null,()=>{da&&da(A,R);this.gO(null);this._context.Jm.Iu();Ea&&Ea.Hva(A);sc.a.$M("InsertApiOperations.InsertSectionBreakUsingOoxml",sc.a.zN(this.D2),191)},Qb=>{v.ULS.sendTraceTag(18957146,369,10,
"AppId:{0}, {1}",this._context.appId,Zt[Qb]);this.pma(Zt[Qb]);this._context.Jm.Iu();Ea&&Ea.Hva(A);sc.a.$M("InsertApiOperations.InsertSectionBreakUsingOoxml",sc.a.zN(this.D2),191,!1)})}jXo(d,m){const A=d.J(0),R=d.J(d.count-1);if(7===m)d.Z(0,jd.a.cR(0,A.cpEnd-A.cpBegin,!1,A.node));else if(12===m){const da=this.gb.Wf(R.node,!0,!0);d.Z(d.count-1,jd.a.cR(R.cpBegin,R.cpEnd,!1,da))}this.vFj(A,d,m)}zGj(d,m,A){const R=d.J(0);var da=R.node;switch(m){case 6:4===A?(m=this.gb.textLength(da),d.Z(0,jd.a.tl(da)),
1<m&&d.insert(0,jd.a.createTextRange(da,1,m))):7===A&&((m=R.cpEnd-R.cpBegin)?d.Z(0,jd.a.createTextRange(da,R.cpBegin+1,R.cpEnd+1)):d.Z(0,jd.a.Uc(da,R.cpBegin+1)));this.bVo(R,d,A);break;case 0:7===A&&R.cpBegin?(da=this.gb.Wf(this.gb.Wf(da,!1),!1),m=R.cpEnd-R.cpBegin,d.Z(0,m?jd.a.createTextRange(da,0,m):jd.a.Uc(da,0)),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(da))):6===A&&(da=this.gb.Wf(this.gb.Wf(da,!1),!1),d.Z(0,jd.a.tl(da))),this.vFj(R,d,A)}}vFj(d,m,A){7===A||6===A||5===A?(A=m.J(0).node.ra,
0<A.length?(A=A.first)&&-1!==m.J(0).Ln()&&0<A.Iw&&(m.J(0).Fb=A.Iw):m.J(0).Fb=-1,this.yFj(m.J(0),d)):12===A&&(d=m.J(m.count-1),m=this.gb.Ml(d.node,d.cpEnd),d.Sb=0<m?d.Mn():-1,d.contextId===ic.a.Tc&&(d.Fb=0<m?d.Ln():-1))}bVo(d,m,A){4===A||7===A||5===A||6===A?(A=m.J(0).contextId===ic.a.Tc||m.J(0).contextId===ic.a.Fd?m.J(0).cpBegin:this.gb.textLength(m.J(0).node),A=this.gb.Ml(m.J(0).node,A),m.J(0).Fb=0<A?0:-1,this.yFj(m.J(0),d)):12===A&&(d=m.J(m.count-1),m=d.Mn()-d.Ln(),A=this.gb.Ml(d.node,d.cpEnd),d.Sb=
0<A?A:-1,d.contextId===ic.a.Tc&&(d.Fb=d.Mn()-m))}yFj(d,m){d&&m&&(d.Sb=d.contextId===ic.a.Tc||d.contextId===ic.a.Vc?d.Ln()+(m.Mn()-m.Ln()):m.Mn())}cVc(d,m,A,R){this._context=d;this.gO=m;this.pma=A;this.D2=R}Y0a(d,m=!0){var A=0;if(this.KWc(d)){const R=this.eSd(d);-1!==R&&(A=R+2>this.gb.textLength(d)?this.gb.textLength(d):R+2)}A=m?A:this.gb.textLength(d);A=jd.a.Uc(d,A);A.Fb=A.Sb=m?this.gb.ix(d):this.gb.uw(d);return A}eJf(d){return sc.a.mPc()?If.GraphIterator.eb(d).zb(37)?!0:!1:!1}KWc(d){const m=this.EE.K2a(d);
if(m&&this.gb.$k(m)==d)return!0}K2a(d){return this.EE.K2a(d)}eSd(d){d=d.ra;for(let m=0;m<d.length;m++){const A=d.J(m),R=A.blob;if(null!==R&&10===R.vh)return A.cp}return-1}insertParagraph(d,m,A){this.ZT(d,A,1);var R=!1;switch(A){case 0:R=!0;break;case 1:R=!1}m=sc.a.kKc(m);const da=R?d.J(0):d.J(d.count-1),Ea=this.gb.textLength(da.node);let ib;var Qb=this.gb.Wf(d.J(d.count-1).node,!1);({JJ:ib}=this.mL(d.J(0),d.J(d.count-1),A,!0));ib=this.Ig.RJa(ib,d);if(da.contextId===ic.a.paragraph||da.contextId===
ic.a.Vc){R=this.$c.r0(da.node);const pc=this.$c.r0(Qb);Qb=!Qb;R=!Qb&&!!pc&&pc!==R;if(1===A&&(Qb||R)){let Pc;A=this.zVc((Pc=new U.a,Pc.add(ib),Pc),m,3).J(0).node}else!A&&da.contextId===ic.a.Vc&&0<Ea?(A=this.jRa(ib,m,!1),d.Z(0,jd.a.tl(A)),d.J(0).Fb=d.J(0).Sb=this.gb.uw(A)):A=this.jRa(ib,m,!0)}else R?da.cpBegin?da.cpBegin===Ea?(A=this.jRa(ib,m,!1),d.Z(0,jd.a.tw(A)),0<m.length?this.$u(d.J(0),2,da):(m=this.gb.Ml(A,0),d.J(0).Fb=0<m?m/2:-1,d.J(0).Sb=d.J(0).Fb+da.Mn()-da.Ln())):A=this.OCf(ib,m,R,d):A=this.jRa(ib,
m,!0):da.cpEnd===Ea?A=this.jRa(ib,m,!1):da.cpEnd?A=this.OCf(ib,m,R):(A=this.jRa(ib,m,!0),d.Z(0,jd.a.Uc(A,0)),0<m.length?this.ZJa(d.J(0),da):(m=this.gb.Ml(A,0),d.J(0).Fb=0<m?m/2:-1,d.J(0).Sb=d.J(0).Fb+da.Mn()-da.Ln()));return A}OCf(d,m,A,R=null){let da;({yao:ib,F6b:da}=this.Pbc(d));d=this.rh.ppa(ib);if(A){A=da.Tb(2);var Ea=R.J(0).Ln();var ib=R.J(0).Mn();R.J(0).contextId===ic.a.Fd?(Ea=R.J(0).cpEnd-R.J(0).cpBegin,R.Z(0,jd.a.createTextRange(A,0,Ea)),0<this.gb.Ml(A,R.J(0).cpBegin)?R.J(0).Fb=this.gb.ix(A):
R.J(0).Fb=-1,R.J(0).Sb=ib):(R.Z(0,jd.a.Uc(A,0)),0<this.gb.Ml(A,R.J(0).cpBegin)?(R.J(0).Fb=Ea+this.gb.ix(A),R.J(0).Sb=R.J(0).Fb+ib-Ea):R.J(0).Fb=R.J(0).Sb=-1);1<R.count&&R.J(1).contextId===ic.a.Vc&&R.Z(1,jd.a.tl(A));da.sc();R=jd.a.Uc(A,0);0<this.gb.Ml(A,R.cpBegin)&&(R.Fb=R.Sb=this.gb.ix(A));this.rh.S$(da,d,R,!0,!0,!1)}else A=ib.Tb(2),ib.sc(),R=jd.a.tw(A),0<this.gb.Ml(A,R.cpBegin)?R.Fb=R.Sb=this.gb.uw(A):R.Fb=R.Sb=-1,this.rh.S$(ib,d,R,!0,!0,!0);d=d.Tb(2);R=jd.a.Uc(d,0);0<this.gb.Ml(d,0)?R.Fb=R.Sb=this.gb.ix(d):
R.Fb=R.Sb=-1;this.Md.Ge(R,m);return d}jRa(d,m,A,R=!1){({F6b:d}=this.Pbc(d,A,R));d=d.Tb(2);A=jd.a.Uc(d,0);0<this.gb.Ml(d,0)&&(A.Fb=A.Sb=this.gb.Ml(d,0)/2);this.Md.Ge(A,m);return d}Pbc(d,m=!1,A=!1){var R=null,da=new If.GraphIterator;da.set(d.node);da.zb(11)&&(R=da.jo(11));A?(A=If.GraphIterator.eb(R),A.zb(40),A.jd(40),da=new bu.a,A.aI(da,R,1),A=If.GraphIterator.eb(da),R=If.GraphIterator.eb(R)):(R=If.GraphIterator.eb(R),R.od(),kh.OutlineElementNavigator.Yd(R),A=m?this.rh.REm(R):this.rh.ppa(R));this.rh.S$(R,
A,d,!0,!0,!m);return{yao:R,F6b:A}}ZT(d,m,A){d&&d.count||(v.ULS.sendTraceTag(22577489,369,10,"The gncList shouldn't be null or empty."),sc.a.Tf());if(sc.a.mPc()){var R=this.$c.Jei(d.J(0).node,d.J(d.count-1).node);R&&4===m&&0===A&&37===R.type&&sc.a.Lmg()}if(1!==d.count||d.J(0).contextId!==ic.a.table){R=new U.a;var da=3;if(A&&1!==A)2===A?R=d:sc.a.Tf();else switch(da=1,m){case 2:case 0:d=this.V6h(d.J(0));R.add(d);1===A&&(da=5);break;case 3:case 1:d=this.V6h(d.J(d.count-1),!1);R.add(d);1===A&&(da=5);break;
case 4:R=d,da=4,1===A&&(da=6)}(nv.a.T8?this.ala.JIc(R,da):this.ala.JIc(R,da)&&!this.MCl(R))||(v.ULS.sendTraceTag(21033307,369,15,"The inserting operation here is not allowed due to conflict with non-deletable or non-editable content control or field range."),sc.a.pD())}}MCl(d){for(let m=0;m<d.count;m++){const A=d.J(m);if(A.contextId===ic.a.Tc||A.contextId===ic.a.Fd){if(this.NCl(A))return!0}else if((A.contextId===ic.a.Vc||A.contextId===ic.a.paragraph)&&this.LCl(A))return!0}return!1}NCl(d){const m=
d.cpBegin,A=d.cpEnd;d=this.gb.pQa(d.node);let R=0;for(;R<d.length;){const da=d[R];if(da.end<=m)R++;else{if(A<=da.Bc)break;return m>da.Bc||da.end>A}}return!1}LCl(d){d=d.node;return d.ja(wc.a.Txa,!1)||this.Nk.Ilb(d)}insertText(d,m,A){if(void 0===m||null===m)v.ULS.sendTraceTag(18477965,369,15,"Inserted text can not be null"),sc.a.qd();this.ZT(d,A,0);const R=4!==A&&this.X_d(d,A);var da=sc.a.Fmc(m),Ea=da.length;if(1<Ea){this.ZT(d,A,1);var ib=null;d.J(0).contextId===ic.a.paragraph&&4===A?ib=jd.a.Uc(d.J(d.count-
1).node,0):{JJ:ib}=this.mL(d.J(0),d.J(d.count-1),A);m=da.shift();const Cd=da.pop();var Qb=" "+m,pc=Cd+" ";4!==A&&(ib=this.Ig.RJa(ib,d));var Pc=new U.a;Pc.addRange(d);this.zVc(Pc,Qb+pc,A,!1);pc=jd.a.Uc(ib.node,ib.cpBegin+Qb.length);pc.Fb=pc.Sb=-1;if(4===A){var gd=this.Ig.YJk(ib,pc);pc=this.Ig.RJa(pc,Pc);ib=jd.a.Uc(pc.node,Math.max(pc.cpBegin-Qb.length,0));this.Ig.v8n(ib,gd,ib,pc)}({F6b:Pc}=this.Pbc(pc,!1));Qb=ib.node;Pc=Pc.Tb(2);pc=null;2<Ea&&(pc=this.jCd(da,ib.node,!1));da=jd.a.createTextRange(Qb,
ib.cpBegin,ib.cpBegin+1);this.$u(da,2);this.Md.Ge(da,"");ib.cpBegin||this.gb.textLength(Qb)!==m.length?m.length?(ib=jd.a.createTextRange(Qb,ib.cpBegin,ib.cpBegin+m.length),this.$u(ib,2)):(ib=jd.a.tl(Qb),ib.Fb=ib.Sb=this.gb.uw(Qb)):(ib=jd.a.create(Qb),this.$u(ib,2));da=jd.a.createTextRange(Pc,Cd.length,Cd.length+1);this.$u(da,2);this.Md.Ge(da,"");gd=jd.a.cR(0,Cd.length,!1,Pc);this.gb.textLength(Pc)===Cd.length&&(gd=jd.a.create(Pc),this.$u(gd,2));da=new U.a;Ea=new U.a;Ea.add(ib);Ea.J(Ea.count-1).contextId===
ic.a.Fd&&(ib=jd.a.tl(Qb),ib.Fb=ib.Sb=this.gb.uw(Qb),Ea.add(ib));pc&&Ea.addRange(pc);Ea.add(gd);ib=d.J(0);pc=d.J(d.count-1);switch(A){case 2:da.addRange(Ea);d.J(0).contextId===ic.a.paragraph||d.J(0).contextId===ic.a.Vc?(da.removeAt(da.count-1),d.Z(0,jd.a.create(Pc)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0)):d.J(0).contextId===ic.a.Fd?(da.removeAt(da.count-1),1<d.count&&d.J(0).node.id.equals(d.J(1).node.id)&&d.J(1).contextId===ic.a.Vc?(d.Z(0,jd.a.create(Pc)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0),d.removeAt(1)):
(d.Z(0,jd.a.createTextRange(Pc,0,d.J(0).cpEnd-d.J(0).cpBegin+Cd.length)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0))):d.J(0).contextId===ic.a.Tc&&d.removeAt(0);da.addRange(d);break;case 3:if(pc.contextId===ic.a.paragraph||pc.contextId===ic.a.Vc||pc.contextId===ic.a.Fd&&!pc.cpBegin)d.Z(d.count-1,jd.a.create(Qb)),d.J(d.count-1).Fb=pc.Ln(),this.$u(d.J(d.count-1),1);else if(pc.contextId===ic.a.Fd||pc.contextId===ic.a.Tc)pc.cpBegin!==pc.cpEnd||pc.cpBegin===pc.cpEnd&&m.length?(d.Z(d.count-1,jd.a.createTextRange(Qb,
pc.cpBegin,pc.cpEnd+m.length)),d.J(d.count-1).Fb=pc.Ln(),this.$u(d.J(d.count-1),1)):d.removeAt(d.count-1),d.add(jd.a.tl(Qb)),d.J(d.count-1).Fb=d.J(d.count-1).Sb=0<this.gb.Ml(Qb,this.gb.textLength(Qb))?this.gb.uw(Qb):-1;da.addRange(d);m=Ea.J(0);Ea.removeAt(0);da.addRange(Ea);Ea.insert(0,m);break;case 0:d.J(0).contextId===ic.a.Fd?(d.Z(0,jd.a.createTextRange(Pc,Cd.length,Cd.length+d.J(0).cpEnd-d.J(0).cpBegin)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0),1<d.count&&d.J(1).contextId===ic.a.Vc&&(m=d.J(1),d.Z(1,
jd.a.tl(Pc)),d.J(1).Fb=m.Ln(),d.J(1).Sb=m.Mn())):d.J(0).contextId===ic.a.Tc?(d.Z(0,jd.a.Uc(Pc,Cd.length+d.J(0).cpBegin)),this.$u(d.J(0),0),d.J(0).Sb=d.J(0).Fb+ib.Mn()-ib.Ln()):d.J(0).contextId===ic.a.Vc?(d.Z(0,jd.a.tl(Pc)),d.J(0).Fb=-1!==ib.Mn()?0:-1,d.J(0).Sb=0<this.gb.Ml(Pc,this.gb.textLength(Pc))?this.gb.uw(Pc):-1):d.J(0).contextId===ic.a.paragraph&&(Cd.length&&this.gb.textLength(Pc)?(d.Z(0,jd.a.cR(Cd.length,this.gb.textLength(Pc),!1,Pc)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0),1<d.count&&(d.insert(1,
jd.a.tl(Pc)),d.J(1).Fb=d.J(1).Sb=ib.Mn(),d.J(0).contextId===ic.a.Tc&&d.removeAt(0))):(d.Z(0,jd.a.create(Pc)),d.J(0).Sb=ib.Mn(),this.$u(d.J(0),0)));da.addRange(d);break;case 1:da.addRange(d);break;case 4:da.addRange(Ea)}R&&this.ode(da,A);d.clear();d.addRange(da);return Ea}return this.zVc(d,m,A,R)}X_d(d,m){let A;({JJ:A}=this.mL(d.J(0),d.J(d.count-1),m));var R=this.Ig.G4a(A);R&&(this.Ig.kdd(A),R=this.Ig.G4a(A));if(!R)return!1;R=null;let da=0;var Ea=d.J(d.count-1);if(1===m&&(Ea.contextId===ic.a.Vc||Ea.contextId===
ic.a.paragraph)&&(Ea=this.gb.Wf(Ea.node,!1))){const ib=jd.a.Uc(Ea,0);this.Ig.G4a(ib)||(R=ib,R.Fb=R.Sb=0<this.gb.Ml(Ea,0)?this.gb.ix(Ea):-1,da=d.count)}if(!R){let ib;Ea=this.insertParagraph((ib=new U.a,ib.add(A),ib),"",0);2!==m&&m&&4!==m?(R=jd.a.Uc(Ea,0),da=d.count):(R=jd.a.create(Ea),da=0);m=this.gb.Ml(Ea,0);R.Fb=R.Sb=0<m?m/2:-1}d.insert(da,R);return!0}zVc(d,m,A,R=!1){const da=m.length;let Ea=new U.a;const ib=d.J(0);var Qb=d.J(d.count-1);const pc=({JJ:Qb}=this.mL(ib,Qb,A)).returnValue,Pc=Qb.node.characterData.length;
if(13===pc)return this.Ig.gEb(),this.xCb(d),this.Ig.VEa(),ib.contextId!==ic.a.Tc&&this.Ig.G4a(d.J(0))&&this.VGj(d.J(0)),Ea=this.insertText(d,m,0),d.clear(),d.addRange(Ea),Ea;this.Md.Ge(Qb,m,this.TYc);Ea.add(this.yoe(d,Qb,pc,da,Pc));R&&this.ode(d,A);return Ea}jCd(d,m,A){const R=new U.a;var da=d.length;if(0<da&&m){m=jd.a.create(m);this.$u(m);R.add(m);if(A)for(--da;0<=da;da--)A=this.insertParagraph(R,d[da],0),A=jd.a.create(A),this.$u(A),R.insert(0,A);else for(let Ea=0;Ea<da;Ea++)A=this.insertParagraph(R,
d[Ea],1),A=jd.a.create(A),this.$u(A),R.add(A);R.remove(m)}return R}qll(d){let m;this.ZT((m=new U.a,m.add(d),m),4,2);this.Md.Ge(d,"")}EYk(d,m,A,R,da){this.ZT(d,4,2);this.cVc(m,A,R,da);this._context.Jm.WH();this.gCa.Ghe(d.toArray(),"<pkg:package xmlns:pkg='http://schemas.microsoft.com/office/2006/xmlPackage'><pkg:part pkg:name='/_rels/.rels' pkg:contentType='application/vnd.openxmlformats-package.relationships+xml' pkg:padding='512'><pkg:xmlData><Relationships xmlns='http://schemas.openxmlformats.org/package/2006/relationships'><Relationship Id='rId1' Type='http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument' Target='word/document.xml'/></Relationships></pkg:xmlData></pkg:part><pkg:part pkg:name='/word/document.xml' pkg:contentType='application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml'><pkg:xmlData><w:document xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main' ><w:body></w:body></w:document></pkg:xmlData></pkg:part></pkg:package>",
0,0,0,null,()=>{this.gO(null);this._context.Jm.Iu();sc.a.$M("InsertApiOperations.ClearBody",sc.a.zN(this.D2),void 0,!0)},Ea=>{v.ULS.sendTraceTag(19170978,369,10,"AppId:{0}, {1}",this._context.appId,Zt[Ea]);this.pma(Zt[Ea]);this._context.Jm.Iu();sc.a.$M("InsertApiOperations.ClearBody",sc.a.zN(this.D2),void 0,!1)})}V5b(d,m){const A=jd.a.create(d);m?A.Fb=this.gb.ix(d):A.Sb=this.gb.uw(d);return A}xmf(d,m){d=d.ra;for(let A=0;A<d.length;A++)if(d.J(A).cp===m){1<=A&&(!d.J(A-1).blob||d.J(A-1).formatting)&&
(d.J(A).formatting=d.J(A-1).formatting?d.J(A-1).formatting.wf(d.J(A)):null);break}}V6h(d,m=!0){if(!d)return null;let A=null;switch(d.contextId){case ic.a.paragraph:A=m?jd.a.Uc(d.node,0):jd.a.tw(d.node);break;case ic.a.Vc:A=jd.a.tw(d.node);break;case ic.a.Fd:case ic.a.Tc:A=jd.a.Uc(d.node,m?d.cpBegin:d.cpEnd)}A.Fb=m?A.Sb=d.Ln():A.Sb=d.Mn();return A}dLd(d){const m=[];for(var A of d)if(A&&A.contextId!==ic.a.Tc){if(A.contextId===ic.a.Vc){const R=A.iterator;R.od();R.sc();if(R.Nxa(1))continue}m.push(A)}A=
32;0<m.length&&(A=this.ga.Mf(new Pr.a(null),xe.a.Tva,2,!0,null,d.toArray()));return 32===A}xCb(d){if(d.count&&(1!==d.count||d.J(0).contextId!==ic.a.Tc)){this.ZT(d,4,2);var m=new U.a;m.addRange(d);var A=d.J(d.count-1),R=this.GTm(d);if(R)this.$c.CFh(R),d.clear(),d.addRange(this.gb.Hz(R,!0,!1));else{R=this.fCi(d);this.hCi(d)||R||!this.gCi(d)||sc.a.Tf();if(A.contextId===ic.a.Vc)if(1<d.count)d.removeAt(d.count-1);else return;else A.contextId!==ic.a.paragraph||R||(d.Z(d.count-1,jd.a.cR(0,this.gb.textLength(A.node),
!1,A.node)),d.J(d.count-1).Sb=A.Mn(),1===d.count&&(d.J(d.count-1).Fb=A.Ln()));this.sRh(d,m);sc.a.Ylf()&&this.oFm(m)}}}R6b(d){if(d.count&&(1!==d.count||d.J(0).contextId!==ic.a.Tc)){this.ZT(d,4,2);var m=new U.a;m.addRange(d);var A=d.J(d.count-1);this.hCi(d)||this.fCi(d)||!this.gCi(d)||sc.a.Tf();this.DTm(d)&&(A.contextId===ic.a.Vc?d.removeAt(d.count-1):A.contextId===ic.a.paragraph&&(d.Z(d.count-1,jd.a.createTextRange(A.node,0,this.gb.textLength(A.node))),this.ZJa(d.J(d.count-1),A),1===d.count&&(d.J(d.count-
1).Fb=A.Ln())));this.sRh(d,m)}}sRh(d,m){const A=d.J(0),R=d.J(d.count-1);let da=null,Ea=!1,ib=!1;A.contextId===ic.a.paragraph?({JJ:da}=this.mL(A,R,1),Ea=R.contextId===ic.a.Fd&&!this.TYc):this.TYc&&1===d.count&&A.contextId===ic.a.Fd?(ib=!0,da=this.kjm(A,da)):({JJ:da}=this.mL(A,R,this.TYc?1:2),ib=this.TYc);this.dLd(d)||(d.clear(),d.addRange(m),v.ULS.sendTraceTag(21641408,369,15,"AppId:{0}, Clear or Delete is not allowed on the current object.",this._context.appId),sc.a.Tf());ib&&!this.GD.A$e(R)&&({JJ:da}=
this.mL(A,R,0));Ea&&(da=jd.a.Uc(da.node,0),this.VGj(da));this.gb.Ml(da.node,da.cpBegin)||(da.Fb=da.Sb=-1);d.clear();d.add(da)}kjm(d,m){m=0;const A=this.GD.BQa(d.node,d.cpBegin,d.cpEnd);for(const R of A)R.Kd.authorName===n.AFrameworkApplication.userName&&1===R.Kd.changeType&&(m=d.cpBegin<=R.Bd?R.endCp>=d.cpEnd?m+d.cpEnd-R.Bd:m+R.endCp-R.Bd:R.endCp<=d.cpEnd?m+R.endCp-d.cpBegin:m+d.cpEnd-d.cpBegin);m=jd.a.Uc(d.node,d.cpBegin+(d.cpEnd-d.cpBegin-m));m.Fb=d.Ln();m.Sb=d.Ln();return m}VGj(d){var m=d.node.ra;
if(0<m.length){if(m=m.nh(d.cpBegin))m=m.Iw+m.vN,d.Fb=d.Sb=0<m?m:-1}else d.Fb=d.Sb=-1}GTm(d){const m=d.J(0);d=d.J(d.count-1);const A=this.$c.Vha(m.node,!0),R=this.gb.$k(A),da=this.gb.XC(A);return m.contextId!==ic.a.paragraph&&m.contextId!==ic.a.Vc||d.contextId!==ic.a.paragraph&&d.contextId!==ic.a.Vc||!R||R.id!==m.node.id||!da||da.id!==d.node.id?null:A}hCi(d){const m=d.J(0);var A=d.J(d.count-1);d=this.$c.Vha(m.node,!0);const R=this.gb.$k(d);A=this.$c.Vha(A.node,!0);return!R||R.id!==m.node.id||A&&d.id===
A.id?!1:!0}fCi(d){var m=d.J(0);d=d.J(d.count-1);const A=this.$c.Vha(d.node,!0),R=this.gb.XC(A);m=this.$c.Vha(m.node,!0);return!R||R.id!==d.node.id||m&&A.id===m.id?!1:!0}DTm(d){var m=d.J(0),A=d.J(d.count-1);m=this.gb.Wf(m.node,!0);d=this.$c.Vha(m,!0);d=this.gb.XC(d);A=this.gb.Wf(A.node,!1);var R=this.$c.Vha(A,!0);R=this.gb.$k(R);return d&&d.id===m.id&&R&&R.id===A.id?!0:!1}gCi(d){const m=d.J(0);d=d.J(d.count-1);const A=this.$c.Vha(m.node,!0),R=this.$c.Vha(d.node,!0),da=this.$c.Vha(m.node,!1),Ea=this.$c.Vha(d.node,
!1),ib=this.gb.$k(A),Qb=this.gb.XC(R);return!A&&!R||ib&&ib.id===m.node.id&&Qb&&Qb.id===d.node.id||da&&Ea&&da.id===Ea.id?!1:!0}get TYc(){return this.Vd.yg}CEm(d,m,A){var R=sc.a.Fmc(m),da=R.length;if(1<da){var Ea=null;d.J(0).contextId===ic.a.paragraph&&4===A?Ea=jd.a.Uc(d.J(d.count-1).node,0):{JJ:Ea}=this.mL(d.J(0),d.J(d.count-1),A);m=R.shift();const Pc=R.pop();var ib=" "+m,Qb=Pc+" ",pc=new U.a;pc.addRange(d);this.zVc(pc,ib+Qb,A,!1);Qb=jd.a.Uc(Ea.node,Ea.cpBegin+ib.length);Qb.Fb=Qb.Sb=-1;4===A&&(Ea=
jd.a.Uc(Qb.node,Math.max(Qb.cpBegin-ib.length,0)));({F6b:Qb}=this.Pbc(Qb,!1,!0));ib=Ea.node;Qb=Qb.Tb(2);pc=null;2<da&&(pc=this.Cuk(R,Ea.node));R=jd.a.createTextRange(ib,Ea.cpBegin,Ea.cpBegin+1);R.Fb=R.Sb=-1;this.Md.Ge(R,"");da=Ea.cpBegin||this.gb.textLength(ib)!==m.length?m.length?jd.a.createTextRange(ib,Ea.cpBegin,Ea.cpBegin+m.length):jd.a.tl(ib):jd.a.create(ib);Ea=jd.a.createTextRange(Qb,Pc.length,Pc.length+1);this.Md.Ge(Ea,"");let gd=jd.a.cR(0,Pc.length,!1,Qb);this.gb.textLength(Qb)===Pc.length&&
(gd=jd.a.create(Qb));Ea=new U.a;R=new U.a;R.add(da);R.J(R.count-1).contextId===ic.a.Fd&&(da=jd.a.tl(ib),R.add(da));pc&&R.addRange(pc);R.add(gd);pc=d.J(d.count-1);switch(A){case 2:Ea.addRange(R);d.J(0).contextId===ic.a.paragraph||d.J(0).contextId===ic.a.Vc?(Ea.removeAt(Ea.count-1),d.Z(0,jd.a.create(Qb))):d.J(0).contextId===ic.a.Fd?(Ea.removeAt(Ea.count-1),1<d.count&&d.J(0).node.id.equals(d.J(1).node.id)&&d.J(1).contextId===ic.a.Vc?(d.Z(0,jd.a.create(Qb)),d.removeAt(1)):d.Z(0,jd.a.createTextRange(Qb,
0,d.J(0).cpEnd-d.J(0).cpBegin+Pc.length))):d.J(0).contextId===ic.a.Tc&&d.removeAt(0);Ea.addRange(d);break;case 3:if(pc.contextId===ic.a.paragraph||pc.contextId===ic.a.Vc||pc.contextId===ic.a.Fd&&!pc.cpBegin)d.Z(d.count-1,jd.a.create(ib));else if(pc.contextId===ic.a.Fd||pc.contextId===ic.a.Tc)pc.cpBegin!==pc.cpEnd||pc.cpBegin===pc.cpEnd&&m.length?d.Z(d.count-1,jd.a.createTextRange(ib,pc.cpBegin,pc.cpEnd+m.length)):d.removeAt(d.count-1),d.add(jd.a.tl(ib));Ea.addRange(d);A=R.J(0);R.removeAt(0);Ea.addRange(R);
R.insert(0,A);break;case 0:d.J(0).contextId===ic.a.Fd?(d.Z(0,jd.a.createTextRange(Qb,Pc.length,Pc.length+d.J(0).cpEnd-d.J(0).cpBegin)),1<d.count&&d.J(1).contextId===ic.a.Vc&&d.Z(1,jd.a.tl(Qb))):d.J(0).contextId===ic.a.Tc?d.Z(0,jd.a.Uc(Qb,Pc.length+d.J(0).cpBegin)):d.J(0).contextId===ic.a.Vc?d.Z(0,jd.a.tl(Qb)):d.J(0).contextId===ic.a.paragraph&&(Pc.length&&this.gb.textLength(Qb)?(d.Z(0,jd.a.cR(Pc.length,this.gb.textLength(Qb),!1,Qb)),1<d.count&&(d.insert(1,jd.a.tl(Qb)),d.J(0).contextId===ic.a.Tc&&
d.removeAt(0))):d.Z(0,jd.a.create(Qb)));Ea.addRange(d);break;case 1:Ea.addRange(d);break;case 4:for(A=0;A<d.count-1;++A)m=d.J(A).node,m=If.GraphIterator.eb(m),m.zb(40),m.sc(),m.tg();Ea.addRange(R)}d.clear();d.addRange(Ea);return R}}Cuk(d,m){const A=new U.a,R=d.length;if(0<R&&m){m=jd.a.create(m);A.add(m);for(let Ea=0;Ea<R;Ea++){var da=this.PDm(A,d[Ea]);da=jd.a.create(da);A.add(da)}A.remove(m)}return A}PDm(d,m){m=sc.a.kKc(m);var A=d.J(d.count-1);const R=this.gb.textLength(A.node);let da;const Ea=this.gb.Wf(d.J(d.count-
1).node,!1);da=this.j2l(d.J(d.count-1));if(A.contextId===ic.a.paragraph||A.contextId===ic.a.Vc)if(Ea)A.contextId===ic.a.Vc&&0<R?(A=this.jRa(da,m,!1,!0),d.Z(0,jd.a.tl(A))):A=this.jRa(da,m,!0,!0);else{let ib;A=this.zVc((ib=new U.a,ib.add(da),ib),m,3).J(0).node}else A.cpEnd===R?A=this.jRa(da,m,!1,!0):A.cpEnd?A=this.OCf(da,m,!1):(A=this.jRa(da,m,!0,!0),d.Z(0,jd.a.Uc(A,0)));return A}j2l(d){var m=null;d.contextId===ic.a.paragraph||d.contextId===ic.a.Vc?(d=d.node,m=this.gb.Wf(d,!1),m||(d=jd.a.Uc(d,this.gb.textLength(d)),
m=this.KEm(d).Tb(2)),m=jd.a.Uc(m,0)):d.contextId===ic.a.Fd||d.contextId===ic.a.Tc?m=jd.a.Uc(d.node,d.cpEnd):sc.a.qd();return m}KEm(d){var m=null,A=new If.GraphIterator;A.set(d.node);A.zb(11)&&(m=A.jo(11));A=If.GraphIterator.eb(m);var R=If.GraphIterator.eb(m);R.zb(40);R.jd(40);const da=new bu.a;R.aI(da,m,1);m=If.GraphIterator.eb(da);R.Bj(da);R=this.rh.OH(m,void 0,!0);Is.a.Sk.YUa(If.GraphIterator.eb(A.Tb(2)),If.GraphIterator.eb(R),d,!0,!0,!0,!1);kh.OutlineElementNavigator.Yd(m);return m}oFm(d){for(const m of d)this.KWc(m.node)&&
this.insertText(new U.a([m])," ",2)}b$l(d,m){return(d=this.K2a(d))&&this.H4(d)===m?d:null}}Object(y.a)(Iw,"InsertApiOperations",null,[1E3]);var UA=c(328),cz=c(916);class Uv{constructor(d,m,A,R,da){this.X$a=this.EWa=-1;this.JAe=this.hUe=null;this.GAe=!1;this.E2g=!0;this.Lch=null;this.Md=m;this.ji=A;this.tLa=R;this.iq=da;this.Hva(d)}get rIa(){return this.Lch||(this.Lch=Rh.a.create())}get dbd(){const d=this.tLa.Eb(this.rIa);return d?this.hUe=this.ji.value.Eb(d.ZUa):null}set dbd(d){this.hUe=d}get rNc(){const d=
this.tLa.Eb(this.rIa);return d?this.JAe=this.ji.value.Eb(d.mwa):null}set rNc(d){this.JAe=d}get Xp(){var d=this.LUd(!0).returnValue;const m=this.LUd(!1).returnValue;if(!d||!m)return null;const A=jd.a.Uc(d.paragraph,d.cp),R=jd.a.Uc(m.paragraph,m.cp);if(!d.Jb||!d.Jb.length)this.EWa=-1;else if(d.Jb&&0<d.Jb.length&&-1===this.EWa||this.EWa>d.Jb.length)this.EWa=d.Jb.length;if(!m.Jb||!m.Jb.length)this.X$a=-1;else if(m.Jb&&0<m.Jb.length&&-1===this.X$a||this.X$a>m.Jb.length)this.X$a=0;this.GAe&&this.RAk(m);
A.Fb=this.EWa;R.Sb=this.X$a;d=this.iq.U$h(A,R,this.GAe);if(!d||!d.count)return null;1===d.count&&(d.J(0).contextId===ic.a.Vc||d.J(0).contextId===ic.a.Tc&&(this.E2g||this.X$a<this.EWa))&&(d.J(0).Fb=d.J(0).Sb=this.EWa);return d}RAk(d){if(!d.Ph){const m=this.u4(d.paragraph,d.paragraph.characterData.length);for(let A=0;A<d.Ji.length;A++){const R=d.Ji.J(A);if(R.yn.equals(this.rIa)){m.Ji||(m.Ji=new UA.a(m));m.Ji.add(R.wf(m));d.Ji.remove(R);d.Ji.length||(d.Ji=null);break}}}}Hva(d){if(n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&
d&&d.count){var m=d.J(0),A=d.J(d.count-1);this.tLa.luk(this.rIa,m.node.id,A.node.id);if(1===d.count)this.Ipm(d.J(0));else{switch(m.contextId){case ic.a.paragraph:d=this.u4(m.node,0);break;case ic.a.Vc:d=this.u4(m.node,m.node.characterData.length);break;case ic.a.Fd:d=this.u4(m.node,m.cpBegin);break;case ic.a.Tc:d=this.u4(m.node,m.cpBegin);break;default:return}var R=!1;switch(A.contextId){case ic.a.paragraph:var da=this.u4(A.node,A.node.characterData.length);R=!0;break;case ic.a.Fd:da=this.u4(A.node,
A.cpEnd);break;case ic.a.Vc:da=this.u4(A.node,A.node.characterData.length);R=!0;break;case ic.a.Tc:da=this.u4(A.node,A.cpEnd);break;default:return}this.EWa=m.Fb;this.X$a=A.Sb;d.Ji.add(new cz.a(d,null,this.rIa,this.tLa,!0));da.Ji.add(new cz.a(da,null,this.rIa,this.tLa,!1,R))}}}Ipm(d){let m=!1,A,R;switch(d.contextId){case ic.a.Tc:A=R=this.u4(d.node,d.cpBegin);this.E2g=d.Fb===d.Sb;break;case ic.a.Vc:A=R=this.u4(d.node,d.node.characterData.length);m=!0;break;case ic.a.Fd:A=this.u4(d.node,d.cpBegin);R=
this.u4(d.node,d.cpEnd);break;case ic.a.paragraph:A=this.u4(d.node,0);R=this.u4(d.node,d.node.characterData.length);m=!0;break;default:return}this.EWa=d.Fb;this.X$a=d.Sb;A.Ji.add(new cz.a(A,null,this.rIa,this.tLa,!0));R.Ji.add(new cz.a(R,null,this.rIa,this.tLa,!1,m))}lpb(){var d,m=({iIa:d}=this.LUd(!1)).returnValue;this.qaj(m,!1,d);m=({iIa:d}=this.LUd(!0)).returnValue;this.qaj(m,!0,d);this.tLa.wV(this.rIa)}qaj(d,m,A){if(d&&d.Ji){var R=m?this.dbd:this.rNc;for(let da=0;da<d.Ji.length;da++)if(d.Ji.J(da).yn.equals(this.rIa)&&
d.Ji.J(da).Qc===m){d.Ji.remove(d.Ji.J(da));if(!d.Ji.length)if(d.Ji=null,d.isEmpty){R.ra.remove(d);break}else if(0<d.cp&&d.gFf&&d.formatting&&A&&d.formatting.equals(A)){if((m=d.paragraph.ra.nh(d.cp-1))&&m.blob)break;R.ra.remove(d);break}break}}else v.ULS.sendTraceTag(20813538,369,50,"There should be some DynamicRangeObject on this chp, but unfortunately no.")}LUd(d){let m=null;const A=d?this.dbd:this.rNc;if(!A||!A.ra||!A.ra.length)return{returnValue:null,iIa:m};for(let R=0;R<A.ra.length;R++){const da=
A.ra.J(R);if(da.Ji)for(let Ea=0;Ea<da.Ji.length;Ea++)if(da.Ji.J(Ea).yn.equals(this.rIa)&&da.Ji.J(Ea).Qc===d)return d||(this.GAe=da.Ji.J(Ea).xMh),1<=R&&(m=A.ra.J(R-1).formatting),{returnValue:da,iIa:m}}return{returnValue:null,iIa:m}}u4(d,m){this.Md.C8a(jd.a.Uc(d,m));d=d.WX(m);d.Ji||(d.Ji=new UA.a(d));return d}}Object(y.a)(Uv,"InternalRange",null,[]);class dz{constructor(d,m,A,R,da,Ea,ib){this.RMb=(Qb,pc)=>{this.kAe.h1e(pc)};this.Md=d;this.ji=A;this.tLa=R;this.kAe=da;this.iq=Ea;ib.G0e(this.RMb)}create(d){return new Uv(d,
this.Md,this.ji,this.tLa,this.iq)}}Object(y.a)(dz,"InternalRangeFactory",null,[]);class UB{constructor(d,m,A){this.eOg="";this.Jld=0;this.zI=d;this._id=m;this.xC=A}get id(){return this._id}_RegisterStateChange(){this.Jld||(OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.xC,this._id,1),this.eOg=this.zI.iza(this._id,d=>{OfficeExtension.WacRuntime.RichApi.getEventManager().fireEvent(d.featureName,1,d)}));this.Jld++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Jld--;
this.Jld||this.zI.yjc(this._id,this.eOg);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(d){switch(d){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 6:return this.DUj();case 7:return this.NUj()}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}DUj(){return this._RegisterStateChange()}NUj(){return this._UnregisterStateChange()}}Object(y.a)(UB,"LicenseFeature",
null,[]);class wp{get scopes(){return null}set scopes(d){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(d){switch(d){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(y.a)(wp,"MsaDeviceTicketOptions",null,[]);class Hr{constructor(d,m,A){this.zI=d;this.EZ=
m;this.xC=A}getFeatureTier(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{this.zI.getFeatureTier(d,1===m?1:2===m?2:0).then(R=>{A(this.o3l(R))},()=>{A(m)})})}getLicenseFeature(d){d=new UB(this.zI,d,this.xC);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}getMsaDeviceTicket(){sc.a.zk();return null}isFeatureEnabled(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{this.zI.isFeatureEnabled(d,m).then(R=>{A(R)},()=>{A(m)})})}isFreemiumUpsellEnabled(){const d=
this.zI.isFreemiumUpsellEnabled();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}launchUpsellExperience(d){if(this.EZ.Et.getOsfControl(this.xC).isFirstParty())return this.zI.launchUpsellExperience(d),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Fo.a.PAb,"Access Denied");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 7:return this.Z5l(m);case 6:return this.KUj(m)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
m){switch(d){case 2:return this.jYl(m);case 5:return this.n3l(m);case 1:return this.kNm(m);case 3:return this.gOm();case 4:return this.G0m(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}jYl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getFeatureTier(m,d)}n3l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
return this.getLicenseFeature(d)}Z5l(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,wp);return this.getMsaDeviceTicket(m,A,d)}kNm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.isFeatureEnabled(m,d)}gOm(){return this.isFreemiumUpsellEnabled()}G0m(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchUpsellExperience(d)}KUj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this._TestFireStateChangedEvent(d);return null}o3l(d){switch(d){case 1:return 1;case 2:return 2;default:return 0}}}Object(y.a)(Hr,"License",null,[]);class Iu{constructor(d,m){this.EZ=d;this.GWj=m}create(d){return new Hr(this.GWj,this.EZ,d)}}Object(y.a)(Iu,"LicenseFactory",null,[]);class VA extends ih.a{constructor(d,
m,A,R,da,Ea,ib){super();sc.a.jKa(d,"List");this.PWa=d;this.sYa=m;this._context=A;this.hn=R;this.Vn=da;this.hd=Ea;this.gb=ib;this.Taa=this.hn.Nwa(this.sYa,this.PWa)}get id(){return this.sYa}get levelExistences(){if(!this.Taa)return null;const d=Array(sc.a.Wia);for(var m=0;m<d.length;m++)d[m]=!1;for(m=0;m<this.Taa.count;m++){const A=this.hn.sR(this.Taa.J(m));-1!==A&&(d[A]=!0)}return d}get levelTypes(){return this.hn.o4l(this.Taa.J(0))}get paragraphs(){const d=new U.a;for(let m=0;m<this.Taa.count;m++)d.add(this.Vn.create(this.hn.Swa(this.Taa.J(m)),
this._context));return new lr(d)}get _ReferenceId(){return this.yq?this.Tq:null}getLevelFont(){return null}getLevelParagraphs(d){(0>d||d>=sc.a.Wia)&&sc.a.qd();const m=new U.a;for(let A=0;A<this.Taa.count;A++)d===this.hn.sR(this.Taa.J(A))&&m.add(this.Vn.create(this.hn.Swa(this.Taa.J(A)),this._context));return new lr(m)}getLevelPicture(){return null}getLevelString(d){return this.hn.getLevelString(this.sYa,this.PWa,d)}insertParagraph(d,m){var A=null;let R=m,da=null;2!==m&&m?3===m||1===m?(R=1,A=this.hn.Swa(this.Taa.J(this.Taa.count-
1)),da=this.hd.Y0a(A,!1)):sc.a.qd():(R=0,A=this.hn.Swa(this.Taa.J(0)),da=this.hd.Y0a(A,!0));var Ea=null,ib=!1;m&&1!==m||(ib=m?!1:!0,Ea=this.gb.Wf(A,ib,!0));let Qb;A=this.hd.insertParagraph((Qb=new U.a,Qb.add(da),Qb),d,R);if(!A)return null;d=this.Vn.create(A,this._context);m&&1!==m||(this.hn.detachFromList(A),Ea&&(m=this.Vn.create(Ea,this._context),d.style=m.style,Ea=Ea.ra,ib&&0<Ea.length?(ib=Ea.J(Ea.length-1).wna(null))&&!ib.formatting&&1<Ea.length&&(ib=Ea.J(Ea.length-2).wna(null)):ib=Ea.first.wna(null),
A=A.ra,A.J(0).formatting=ib.formatting.wf(A.J(0)),d.leftIndent=m.leftIndent,d.firstLineIndent=m.firstLineIndent));return d}resetLevelFont(){}setLevelAlignment(d,m){this.hn.setLevelAlignment(this.sYa,this.PWa,d,this.L3l(m))}setLevelBullet(d,m,A,R){(0>d||d>=sc.a.Wia)&&sc.a.qd();0===m&&0>=A&&sc.a.qd();this.hn.setLevelBullet(this.PWa,this.sYa,d,m,A,R)}setLevelIndents(d,m,A){this.hn.tlo(this.sYa,this.PWa,d,m,A)}setLevelNumbering(d,m,A){(0>d||d>=sc.a.Wia)&&sc.a.qd();-1!==m||A||sc.a.qd();this.hn.setLevelNumbering(this.PWa,
this.Taa.J(0),this.sYa,d,m,A)}setLevelPicture(){}setLevelStartingNumber(d,m){this.hn.setLevelStartingNumber(this.sYa,this.PWa,d,m)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.PWa,"List");this.Taa=this.hn.Nwa(this.sYa,this.PWa);sc.a.iy(this.Taa,"List")}getTypeName(){return"Microsoft.WordServices.List"}invokePropertyGet(d){switch(d){case 1:return this.id;case 5:return this.levelExistences;case 4:return this.levelTypes;case 3:return this.paragraphs;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1010:return this.h3l(m);case 1004:return this.j3l(m);case 1009:return this.k3l(m);case 1007:return this.m3l(m);case 1003:return this.qpa(m);
case 1011:return this.e7n(m);case 1012:return this.glo(m);case 1005:return this.hlo(m);case 1013:return this.ilo(m);case 1006:return this.jlo(m);case 1008:return this.klo(m);case 1014:return this.llo(m);case 1001:return this.Vh();case 1002:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}h3l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getLevelFont(d)}j3l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelParagraphs(d)}k3l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelPicture(d)}m3l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getLevelString(d)}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertParagraph(m,d)}e7n(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");this.resetLevelFont(m,d);return null}glo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.setLevelAlignment(m,d);return null}hlo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");this.setLevelBullet(m,A,R,d);return null}ilo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"number");this.setLevelIndents(m,
A,d);return null}jlo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<any>");this.setLevelNumbering(m,A,d);return null}klo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");this.setLevelPicture(m,d);return null}llo(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.setLevelStartingNumber(m,d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}L3l(d){let m="";switch(d){case 0:m="left";break;case 2:m="right";break;case 1:m="center";break;default:v.ULS.sendTraceTag(21067539,369,10,"AppId:{0}, in function List.SetLevelAlignment, the alignment parameter should be Left/Right/Centered.",this._context.appId),
sc.a.qd()}return m}}Object(y.a)(VA,"List",ih.a,[841]);class WA{constructor(d,m){this.Vn=this.hn=null;this.hd=d;this.gb=m}Ju(d,m){this.hn=d;this.Vn=m}create(d,m,A){return new VA(d,m,A,this.hn,this.Vn,this.hd,this.gb)}}Object(y.a)(WA,"ListFactory",null,[]);class Lp extends ih.a{constructor(d,m,A,R,da){super();sc.a.jKa(d,"ListItem");this.Mfa=d;this._context=m;this.hn=A;this.Vn=R;this.Ryc=da}get level(){return this.hn.sR(this.Mfa)}set level(d){(d>=sc.a.Wia||0>d)&&sc.a.qd();this.hn.sR(this.Mfa)!==d&&this.hn.meg(this.Mfa,
d)}get listString(){const d=this.hn.IGb(this.Mfa);return this.Ryc.Lmb(d).J9}get siblingIndex(){const d=this.hn.sR(this.Mfa),m=this.jqf();let A=0;for(let R=0;R<m.count;R++)if(this.hn.sR(m.J(R))===d){if(this.Mfa.id.equals(m.J(R).id))return A;A++}return-1}get _ReferenceId(){return this.yq?this.Tq:null}getAncestor(d){(d=this.getAncestorOrNullObject(d))||sc.a.Tk();return d}getAncestorOrNullObject(d){const m=this.hn.sR(this.Mfa),A=this.jqf();var R=0;for(var da=0;da<A.count;da++)this.Mfa.id.equals(A.J(da).id)&&
(R=da);for(--R;0<=R;R--)if(da=this.hn.sR(A.J(R)),da<m&&(d&&da===m-1||!d))return this.Vn.create(this.hn.Swa(A.J(R)),this._context);return null}getDescendants(d){const m=this.hn.sR(this.Mfa),A=this.jqf();var R=0;for(var da=0;da<A.count;da++)this.Mfa.id.equals(A.J(da).id)&&(R=da);da=new U.a;for(R+=1;R<A.count;R++){const Ea=this.hn.sR(A.J(R));if(Ea>m)(d&&Ea===m+1||!d)&&da.add(this.Vn.create(this.hn.Swa(A.J(R)),this._context));else break}return new lr(da)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.Mfa,
"ListItem");const d=this.hn.IGb(this.Mfa);sc.a.o2(d,"ListItem")}getTypeName(){return"Microsoft.WordServices.ListItem"}invokePropertyGet(d){switch(d){case 4:return this.level;case 3:return this.listString;case 2:return this.siblingIndex;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 4:this.level=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.mOl(m);case 1005:return this.nOl(m);case 1004:return this.ZVl(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}mOl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getAncestor(d)}nOl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getAncestorOrNullObject(d)}ZVl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");return this.getDescendants(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();
return null}jqf(){let d;d=Zl.ListItemReader.HGb(this.Mfa,{FEa:-1}).listId;const m=new If.GraphIterator;m.set(this.Mfa);m.Ip();let A=m.Ps(36);A||(A=m.Ps(8));return this.hn.Nwa(d,A)}}Object(y.a)(Lp,"ListItem",ih.a,[841]);class ez{constructor(d,m){this.Vn=null;this.hn=d;this.Ryc=m}Ju(d){this.Vn=d}create(d,m){return new Lp(d,m,this.hn,this.Vn,this.Ryc)}}Object(y.a)(ez,"ListItemFactory",null,[]);var XA=c(80);class VB{constructor(d,m,A,R,da,Ea){this.Aw=Ea;this.gb=d;this.VJe=m;this.Hf=A;this.FK=R;this.Ryc=
da}getLevelString(d,m,A){(0>A||A>=sc.a.Wia)&&sc.a.qd();(m=this.Nwa(d,m))&&m.count||sc.a.Tf();for(var R=0;R<m.count;R++)if(this.sR(m.J(R))===A)return d=this.IGb(m.J(R)),this.Ryc.Lmb(d).J9;R="";var da=this.Hf.Px(m.J(0),d,A),Ea=tw.a.y8(da,null);if(1===Ea.listType)R=Ea.levelText;else if(Ea.listType)sc.a.Tf();else if(R=Ea.levelText,da=da.ja(Me.a.Y0,1),A+=1,R=sa.a.replaceAll(R,"%"+A,this.qKh(Ea,da)),0<=R.indexOf("%"))for(Ea=0;Ea<A;Ea++)0<=R.indexOf("%"+(Ea+1))&&(da=this.Efm(m.J(0),d,Ea),R=sa.a.replaceAll(R,
"%"+(Ea+1),da));return R}setLevelAlignment(d,m,A,R){(0>A||A>=sc.a.Wia||!R||""===R)&&sc.a.qd();(m=this.Nwa(d,m))||sc.a.Tf();this.Hf.Px(m.J(0),d,A).setValue(wc.a.wda,R);if(!Hq.a.getInstance().es){for(d=0;d<m.count;d++)if(this.sR(m.J(d))===A){const da=this.IGb(m.J(d));da&&da.setValue(wc.a.wda,R)}this.xZ(this.Swa(m.J(0)))}}setLevelStartingNumber(d,m,A,R){(0>A||A>=sc.a.Wia||0>R)&&sc.a.qd();(m=this.Nwa(d,m))&&m.count||sc.a.Tf();var da=this.Hf.Px(m.J(0),d,A);da.setValue(Me.a.Y0,R);if(!Hq.a.getInstance().Ru){var Ea=
-1;d=R;var ib=sc.a.Wia;let pc=!1;da=tw.a.y8(da,null);for(let Pc=0;Pc<m.count;Pc++){ib<A&&(pc=!0);ib=this.sR(m.J(Pc));if(ib===A&&!da.listType){var Qb=Pc;1!==Qb-Ea&&pc&&(d=R,pc=!1);Ea=this.l$b(m.J(Pc));this.Aw.qoe(Ea,d,d);Ea=Pc;d++}Hq.a.getInstance().es||(Qb=this.Swa(m.J(Pc)),this.xZ(Qb))}}}tlo(d,m,A,R,da){(0>A||A>=sc.a.Wia)&&sc.a.qd();(m=this.Nwa(d,m))||sc.a.Tf();d=this.Hf.Px(m.J(0),d,A);d.setValue(wc.a.ee,Jg.a.mE(R));da=Jg.a.mE(da);0<=da?(d.setValue(wc.a.RA,da),d.removeProperty(wc.a.qt)):(d.setValue(wc.a.qt,
0-da),d.removeProperty(wc.a.RA));for(d=0;d<m.count;d++)if(this.sR(m.J(d))===A){var Ea=this.Swa(m.J(d));Ea.Cg(wc.a.ee);Ea.Cg(wc.a.RA);Ea.Cg(wc.a.qt);!Hq.a.getInstance().es&&(Ea=this.IGb(m.J(d)))&&(Ea.setValue(wc.a.ee,Jg.a.mE(R)),0<=da?(Ea.setValue(wc.a.RA,da),Ea.removeProperty(wc.a.qt)):(Ea.setValue(wc.a.qt,0-da),Ea.removeProperty(wc.a.RA)))}Hq.a.getInstance().es||this.xZ(this.Swa(m.J(0)))}o4l(d){const m=this.T2a(d),A=Array(sc.a.Wia);for(let da=0;da<sc.a.Wia;da++){var R=this.Hf.Px(d,m,da);R=tw.a.y8(R,
null);R.listType?1===R.listType&&(A[da]=R.VXc?2:0):A[da]=1}return A}Nwa(d,m){m=this.gb.yw(m,!0,!1);const A=new U.a;for(const R of m)this.zSm(R,d)&&A.add(Qe.ParagraphReader.G$b(R));return A.count?A:null}IGb(d){return Zl.ListItemReader.e9(d)}l$b(d){const m=new If.GraphIterator;m.set(d);d=null;Zl.ListItemReader.lg(m)&&(this.Hf.EP(m),d=m.currentNode);return d}sR(d){let m=-1;Zl.ListItemReader.lg(d)&&(m=Zl.ListItemReader.HGb(d,{YDb:-1}).listLevel);return m}Swa(d){const m=new If.GraphIterator;m.set(d);d=
null;Zl.ListItemReader.lg(m)&&(d=m.Tb(2));return d}g5h(d,m){if(!d||!d.count)return null;const A=new U.a,R=new U.a;var da=null;for(let ib=0;ib<d.count;ib++){const Qb=d.J(ib).node;if(!(da&&Qb&&da.id.equals(Qb.id))){da=Qb;var Ea=void 0;Zl.ListItemReader.Nj?Zl.ListItemReader.isListItem(Qb)&&(Ea=Qe.ParagraphReader.G$b(Qb),Ea=this.T2a(Ea),R.contains(Ea)||(R.add(Ea),A.add(this.zjb(Qb)))):({tNb:Ea}=this.NXc(Qb)).returnValue&&(Ea=this.T2a(Ea),R.contains(Ea)||(R.add(Ea),A.add(this.zjb(Qb))))}}d=new U.a;for(da=
0;da<R.count;da++)d.add(this.VJe.create(A.J(da),R.J(da),m));return d}T2a(d){let m=-1;d=If.GraphIterator.eb(d);Zl.ListItemReader.lg(d)&&(m=Zl.ListItemReader.HGb(d,{FEa:-1}).listId);return m}NXc(d){if(!d)return{returnValue:!1,tNb:null};d=If.GraphIterator.eb(d);if(d.zb(11)){const m=d.jo(11);if((d=m)&&Zl.ListItemReader.lg(m))return{returnValue:!0,tNb:d}}else d=null;return{returnValue:!1,tNb:d}}attachToList(d,m,A,R){if(A>=sc.a.Wia||0>A)return sc.a.qd(),null;let da=null;if(Zl.ListItemReader.Nj){if(Zl.ListItemReader.isListItem(d)||
!(da=Qe.ParagraphReader.G$b(d)))return sc.a.Tf(),null}else if(({tNb:da}=this.NXc(d)).returnValue||!da)return sc.a.Tf(),null;var Ea=new If.GraphIterator;Ea.set(da);Ea.od();let ib=new oi.DictionaryPropertySet;var Qb=this.Hf.CQm(d,m);var pc=this.zjb(d);pc=this.Nwa(m,pc);Qb&&pc?(Qb=xe.a.ML,pc=this.IGb(pc.J(pc.count-1)),pc=this.Hf.gY(pc),1===pc.listType?Qb=xe.a.qD:pc.listType||(Qb=xe.a.ML),ib=this.FK.HNc(Qb,ib),{wxa:pc}=this.FK.Zma(ib,Ea,pc,!1)):Qb&&!pc?sc.a.Tf():sc.a.qd();if(!Hq.a.getInstance().Ru)if(Ea=
this.l$b(da))this.Aw.tAa(Ea,m),this.meg(da,A);else return v.ULS.sendTraceTag(20473551,369,10,"AppId:{0}, Something went wrong in native code and failed to create a list node.",R.appId),null;Hq.a.getInstance().es&&(this.Aw.tAa(d,m),this.meg(da,A));d=this.zjb(d);return this.VJe.create(d,m,R)}startNewList(d,m){if(Zl.ListItemReader.Nj){if(Zl.ListItemReader.isListItem(d))return sc.a.Tf(),null;var A=Qe.ParagraphReader.G$b(d)}else if(({tNb:A}=this.NXc(d)).returnValue)return sc.a.Tf(),null;const R=new If.GraphIterator;
R.set(A);R.od();let da=tw.a.IX(1,1),Ea=new oi.DictionaryPropertySet;Ea=this.FK.HNc(xe.a.qD,Ea);({wxa:da}=this.FK.Zma(Ea,R,da,!0));d=this.zjb(d);A=this.T2a(A);return this.VJe.create(d,A,m)}detachFromList(d){Zl.ListItemReader.HQm(d)||sc.a.Tf();this.FK.WIc(d)}meg(d,m){var A=this.sR(d);if(-1!==A&&m<sc.a.Wia&&-1<m){var R=this.l$b(d),da=this.IGb(d);if(R&&da){var Ea=this.T2a(d);Ea=this.Hf.Px(da,Ea,A);var ib=tw.a.y8(Ea,null);Ea=this.Rdi(d);Hq.a.getInstance().Ru||this.Aw.A9a(R,m);if(Hq.a.getInstance().es){var Qb=
this.Swa(d);this.Aw.A9a(Qb,m)}if(!this.Hf.gY(da).listType){({startAt:da,bwa:Qb}=this.w1l(d));Hq.a.getInstance().Ru||this.Aw.qoe(R,da,Qb);R=this.Rdi(d);for(let pc=0;pc<R.count;pc++)if(!Hq.a.getInstance().Ru){const Pc=this.l$b(R.J(pc));this.Aw.qoe(Pc,da+1+pc,Qb+1+pc)}}if(!ib.listType&&!this.ZWm(d)&&m!==A)for(d=0;d<Ea.count;d++)Hq.a.getInstance().Ru||(m=this.l$b(Ea.J(d)),A=Zl.ListItemReader.DVd(m),ib=Zl.ListItemReader.Twf(m),this.Aw.qoe(m,A-1,ib-1))}}}setLevelNumbering(d,m,A,R,da,Ea){let ib=0,Qb="right";
switch(da){case 0:ib=1;break;case 4:ib=2;break;case 2:ib=3;Qb="left";break;case 3:ib=4;break;case 1:ib=5;Qb="left";break;case -1:ib=1;break;default:sc.a.qd()}let pc="";if(Ea&&Ea.length){let Pc=!1;for(let gd=0;gd<Ea.length;gd++)if(Number===Object.getType(Ea[gd])){const Cd=Ea[gd];Pc=Cd===R||Pc;Cd>R?sc.a.qd():-1===da&&Cd===R?sc.a.qd():Cd<R&&this.Hf.Px(m,A,Cd).ja(Dm.a.MA,14)&&sc.a.qd();pc=pc+"%"+(Cd+1).toString()}else pc+=Ea[gd];-1===da||Pc||sc.a.qd()}else pc=null;m="%"+(R+1).toString();pc||(pc=m);this.Qmj(0,
ib,d,A,R,pc,"Calibri",Qb)}setLevelBullet(d,m,A,R,da,Ea){Ea=Ea?Ea:XA.a.ELc;switch(R){case 258231:da=61623;Ea="Symbol";break;case 131183:da=111;Ea="Courier New";break;case 716967:da=61607;Ea="Wingdings";break;case 716918:da=61558;Ea="Wingdings";break;case 717016:da=61656;Ea="Wingdings";break;case 717052:da=61692,Ea="Wingdings"}this.Qmj(1,1,d,m,A,String.fromCharCode(da),Ea,"left")}Rdi(d){var m=this.T2a(d);const A=this.sR(d),R=new U.a;m=this.Nwa(m,this.zjb(d));let da=!1;for(let Ea=0;Ea<m.count;Ea++){const ib=
this.sR(m.J(Ea));if(da&&ib<A)break;ib===A&&(da&&R.add(m.J(Ea)),d.id.equals(m.J(Ea).id)&&(da=!0))}return R}ZWm(d){var m=this.T2a(d);Zl.ListItemReader.Nj||this.sR(d);m=this.Nwa(m,this.zjb(d));return d.id.equals(m.J(0).id)?!0:!1}w1l(d){var m=this.T2a(d),A=this.sR(d);const R=this.Nwa(m,this.zjb(d));m=null;for(let da=0;da<R.count;da++)if(this.sR(R.J(da))===A){if(d.id.equals(R.J(da).id))break;m=R.J(da)}A=d=1;m&&!Hq.a.getInstance().Ru&&(m=this.l$b(m))&&(d=Zl.ListItemReader.DVd(m)+1,A=Zl.ListItemReader.Twf(m)+
1);return{startAt:d,bwa:A}}zSm(d,m){if(Zl.ListItemReader.Nj)return d?Zl.ListItemReader.cE(d,{FEa:-1}).listId===m:!1;let A=!1,R=null;d&&({tNb:R}=this.NXc(d)).returnValue&&this.T2a(R)===m&&(A=!0);return A}zjb(d){d=If.GraphIterator.eb(d);return d.zb(36)?d.jo(36):d.zb(38)?d.jo(38):d.zb(8)?d.jo(8):null}Qmj(d,m,A,R,da,Ea,ib,Qb){var pc=null;const Pc=this.Nwa(R,A);Pc||sc.a.Tf();for(var gd=0;gd<Pc.count;gd++)if(this.sR(Pc.J(gd))===da){pc=Pc.J(gd);break}gd=new oi.DictionaryPropertySet;const Cd=new If.GraphIterator;
if(pc){var ae=d?xe.a.qD:xe.a.ML;Cd.set(pc);Cd.od();gd=this.FK.HNc(ae,gd);ae=tw.a.IX(d,m)}else ae=this.Hf.Px(Pc.J(0),R,da),ae=tw.a.y8(ae,new oi.DictionaryPropertySet),ae.I$(d,m);ae.levelText=Ea;ae.font=ib;ae.YVc=!0;ae.zw=Qb;d=this.Hf.Px(Pc.J(0),R,da).ja(Me.a.Y0,XA.a.Vl);pc&&({wxa:ae}=this.FK.Zma(gd,Cd,ae,!1));if(!Hq.a.getInstance().es)for(pc=0;pc<Pc.count;pc++)m=this.Swa(Pc.J(pc)),this.xZ(m);d!==XA.a.Vl&&this.setLevelStartingNumber(R,A,da,d)}xZ(d){d&&d.setValue(Me.a.QR,new Date)}Efm(d,m,A){m=this.Hf.Px(d,
m,A);d=tw.a.y8(m,null);if(d.listType)return"";m=m.ja(Me.a.Y0,1);return this.qKh(d,m)}qKh(d,m){switch(d.Ooa()){case 0:return m+"";case 4:return sa.a.LId(m-1,!0);case 2:return sa.a.oKc(m,!0);case 3:return sa.a.LId(m-1,!1);case 1:return sa.a.oKc(m,!1);default:return m+""}}}Object(y.a)(VB,"ListOperations",null,[998]);class Yz extends ih.a{constructor(d,m,A,R,da,Ea,ib){super();sc.a.jKa(d,"NoteItem");this.LI=d;this._context=m;this._id=A;this.hd=ib;this.NN=R;this.tk=da;this.Qcb=Ea}get type(){return this.hd.H4(this.LI)}get body(){return this.NN.create(this.LI,
this._context)}get reference(){const d=new U.a;var m=this.LI.xoa;m&&(m=m.Lb,d.add(jd.a.createTextRange(m.paragraph,m.cp,m.cp+1)));return this.tk.create(d,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}deleteObject(){this.hd.ull(this.LI)}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){const d=this.hd.G6l(this.LI,this.type);return d?this.Qcb.create(d,this._context):null}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.LI,
"NoteItem")}getTypeName(){return"Microsoft.WordServices.NoteItem"}invokePropertyGet(d){switch(d){case 4:return this.body;case 5:return this.reference;case 3:return this.type;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.UD(m);case 1004:return this.Cca();case 1005:return this.Dca();case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();
return null}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(Yz,"NoteItem",ih.a,[841]);class Bm{constructor(){}Ju(d,m,A){this.NN=d;this.tk=m;this.hd=A}create(d,m,A=0){return new Yz(d,m,A,this.NN,this.tk,this,this.hd)}}Object(y.a)(Bm,"NoteItemFactory",null,[858]);var jy;(function(d){d[d.left=0]="left";d[d.right=1]="right";d[d.firstLine=2]="firstLine"})(jy||(jy={}));Object(y.b)("ExtensionParagraphIndent",
jy);var lt;(function(d){d[d.lineSpacing=0]="lineSpacing";d[d.before=1]="before";d[d.after=2]="after";d[d.inp=3]="lineBefore";d[d.hnp=4]="lineAfter"})(lt||(lt={}));Object(y.b)("ExtensionParagraphSpacing",lt);class Jw extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep){super();sc.a.jKa(d,"Paragraph");this.Nd=d;this._context=m;this._id=A;this.gB=R;this.fM=da;this.Vn=Ea;this.tk=ib;this.XJe=Qb;this.gb=pc;this.Xs=Pc;this.OI=gd;this.iq=Cd;this.pA=ae;this.hd=Xd;this.Qw=
se;this.Ig=Xe;this.nA=Be;this.ew=Hg;this.om=Xh;this.$c=Fl;this.hn=Gm;this.Ts=em;this.cX=$n;this.Ow=Ep}get alignment(){switch(this.gb.Ox(this.Nd)){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 7:case 9:case 11:case 10:case 13:return 3;default:return-1}}set alignment(d){let m=0;switch(d){case 0:m=1;break;case 2:m=3;break;case 1:m=2;break;case 3:m=6;break;default:v.ULS.sendTraceTag(16871628,369,15,"AppId:{0}, set Paragraph.Alignment with not supported value: {1}.",this._context.appId,d),
sc.a.qd()}this.Xs.pE(this.Nd,m)}get contentControls(){var d=jd.a.create(this.Nd);return sc.a.FAa?(d=new Ch,d.types=[31],this.getContentControls(d)):this.Ig.dac(d,d,this._context)}get fields(){return new iv(this.Ow.U9b(this.Nd,this._context,!1))}get endnotes(){var d=this.hd.rrf(this.Nd,1);d=this.hd.Gva(d,this._context);return new rs(d)}get firstLineIndent(){return this.Ktf(2)}set firstLineIndent(d){const m=this.Xs.qq;d=Jg.a.mE(d);0<=d?m.mea(this.Nd,d):m.bqb(this.Nd,0-d)}get font(){return this.gB.create(3,
this.Nd,null,null,this._context)}get footnotes(){var d=this.hd.rrf(this.Nd,0);d=this.hd.Gva(d,this._context);return new rs(d)}get inlinePictures(){const d=new U.a,m=new U.a;let A=0;this.Qw.csf(m,this.Nd);for(const R of m)d.add(this.fM.create(R,this._context,A++));return new bp(d)}get isLastParagraph(){if(!sc.a.Ai())return!1;var d=this.$c.PTd(this.Nd);return d?(d=this.gb.XC(d))?d.id.equals(this.Nd.id)?!0:!1:!1:!1}get isListItem(){return sc.a.Ai()?this.gb.HR(this.Nd):!1}get leftIndent(){return this.Ktf(0)}set leftIndent(d){this.Xs.qq.Lza(this.Nd,
1,Jg.a.mE(d))}get lineSpacing(){return this.NRc(0)}set lineSpacing(d){sc.a.ZVa(d,"Paragraph.LineSpacing");this.Xs.lD(this.Nd,new cv.a(2,d/12))}get lineUnitAfter(){return this.NRc(4)}set lineUnitAfter(d){sc.a.YVa(d,"Paragraph.LineUnitAfter");this.Xs.Wpb(this.Nd,new cv.a(2,d))}get lineUnitBefore(){return this.NRc(3)}set lineUnitBefore(d){sc.a.YVa(d,"Paragraph.LineUnitBefore");this.Xs.Xpb(this.Nd,new cv.a(2,d))}get list(){if(!sc.a.Ai())return null;const d=this.listOrNullObject;d||sc.a.Tk();return d}get listItem(){if(!sc.a.Ai())return null;
const d=this.listItemOrNullObject;d||sc.a.Tk();return d}get listItemOrNullObject(){if(!sc.a.Ai())return null;let d;if(Zl.ListItemReader.Nj){if(!Zl.ListItemReader.isListItem(this.Nd))return null;d=Qe.ParagraphReader.G$b(this.Nd)}else if(!({tNb:d}=this.hn.NXc(this.Nd)).returnValue)return null;return this.XJe.create(d,this._context)}get listOrNullObject(){if(!sc.a.Ai())return null;var d=new U.a;d.add(jd.a.create(this.Nd));d=this.hn.g5h(d,this._context);return d.count?d.J(0):null}get outlineLevel(){return this.gb.Qwa(this.Nd)+
1}set outlineLevel(d){if(1>d||10<d)v.ULS.sendTraceTag(19674595,369,10,"Set OutlineLevel with not supported value: {0}.",d),sc.a.qd();this.Xs.Amo(this.Nd,d-1)}get parentBody(){return sc.a.Ai()?this.$c.Qtf(this.Nd,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||sc.a.Tk();return d}get parentContentControlOrNullObject(){const d=jd.a.create(this.Nd);this.hd.YJa(d,d);return this.Ig.eac(d,d,this._context)}get parentTable(){if(!sc.a.Ai())return null;const d=
this.parentTableOrNullObject;d||sc.a.Tk();return d}get parentTableCell(){if(!sc.a.Ai())return null;const d=this.parentTableCellOrNullObject;d||sc.a.Tk();return d}get parentTableCellOrNullObject(){return sc.a.Ai()?this.$c.H$b(this.Nd,this._context):null}get parentTableOrNullObject(){return sc.a.Ai()?this.$c.Ejb(this.Nd,this._context):null}get rightIndent(){return this.Ktf(1)}set rightIndent(d){this.Xs.qq.rQb(this.Nd,1,Jg.a.mE(d))}get spaceAfter(){return this.NRc(2)}set spaceAfter(d){sc.a.YVa(d,"Paragraph.SpaceAfter");
this.Xs.Wpb(this.Nd,new cv.a(4,d))}get spaceBefore(){return this.NRc(1)}set spaceBefore(d){sc.a.YVa(d,"Paragraph.SpaceBefore");this.Xs.Xpb(this.Nd,new cv.a(4,d))}get style(){let d;return this.pA.PQc((d=new U.a,d.add(jd.a.create(this.Nd)),d))}set style(d){let m;this.pA.olc((m=new U.a,m.add(jd.a.create(this.Nd)),m),d)}get styleBuiltIn(){if(!sc.a.Ai())return-1;let d;return this.pA.oSd((d=new U.a,d.add(jd.a.create(this.Nd)),d))}set styleBuiltIn(d){sc.a.Ai()||sc.a.zk();let m;this.pA.ihe((m=new U.a,m.add(jd.a.create(this.Nd)),
m),d)}get tableNestingLevel(){return sc.a.Ai()?this.$c.Hii(this.Nd):0}get text(){return this.gb.M6a(this.Nd)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}attachToList(d,m){sc.a.Ai()||sc.a.zk();return this.hn.attachToList(this.Nd,d,m,this._context)}clear(){const d=jd.a.create(this.Nd);this.zFj(d);let m;this.hd.xCb((m=new U.a,m.add(d),m))}deleteParagraph(){const d=jd.a.create(this.Nd);this.zFj(d);let m;this.hd.R6b((m=new U.a,m.add(d),m))}detachFromList(){sc.a.Ai()||sc.a.zk();
this.hn.detachFromList(this.Nd)}getComments(){const d=new U.a;d.add(jd.a.create(this.Nd));return this.Ts.gRd(d,this._context)}getContentControls(d){var m;d=null!==(m=null===d||void 0===d?void 0:d.types)&&void 0!==m?m:[];sc.a.BNc(d);m=jd.a.create(this.Nd);m=this.Ig.dac(m,m,this._context);return 0===d.length?m:null===m||void 0===m?void 0:m.getByTypes(d)}getHtml(){const d=[jd.a.create(this.Nd)];return this.ew.getHtml(d,this._context)}getMetadata(){sc.a.zk();return null}getNext(){const d=this.getNextOrNullObject();
d||sc.a.Tk();return d}getNextOrNullObject(){sc.a.Ai()||sc.a.zk();const d=this.gb.Wf(this.Nd,!1,!0);return d?this.Vn.create(d,this._context):null}getOoxml(){const d=(new Date).getTime();this._context.Jm.WH();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{const R=new U.a;R.add(jd.a.create(this.Nd));this.ew.getOoxml(R,this._context,m,A,d)})}getPrevious(){const d=this.getPreviousOrNullObject();d||sc.a.Tk();return d}getPreviousOrNullObject(){sc.a.Ai()||sc.a.zk();const d=this.gb.Wf(this.Nd,
!0,!0);return d?this.Vn.create(d,this._context):null}getRange(d){sc.a.Ai()||sc.a.zk();1!==d&&2!==d&&d&&5!==d&&4!==d&&(v.ULS.sendTraceTag(18745294,369,15,"AppId:{0}, rangeLocation of Paragraph.GetRange must be Start/End/Whole/Content/After.",this._context.appId),sc.a.qd());const m=new U.a;m.add(jd.a.create(this.Nd));this.om.Qge(m);return(d=this.om.D9b(m,d))?this.tk.create(d,this._context):null}getSubrange(d,m){sc.a.Ai()||sc.a.zk();(0>d||d+m>this.gb.textLength(this.Nd)||0>m)&&sc.a.qd();d=m?jd.a.createTextRange(this.Nd,
d,d+m):jd.a.Uc(this.Nd,d);let A;return this.tk.create((A=new U.a,A.add(d),A),this._context,0)}getTextRanges(d,m){sc.a.Ai()||sc.a.zk();var A=new U.a;A.add(jd.a.create(this.Nd));this.om.Qge(A);d=this.om.Yvf(A,d,m);m=new U.a;for(A=0;A<d.length;A++)m.add(this.tk.create(d[A],this._context,A));return new Yt(m)}getReviewedText(d){return this.cX.uUd(this.Nd,d)}insertBreak(d,m){m&&1!==m&&(v.ULS.sendTraceTag(17179038,369,15,"AppId:{0}, insertLocation of Paragraph.InsertBreak must be Before or After.",this._context.appId),
sc.a.qd());const A=(new Date).getTime(),R=new U.a;R.add(jd.a.create(this.Nd));if(6===d)this.hd.YJa(R.J(0),R.J(0));else{const da=this.hd.Y0a(this.Nd,!m);R.Z(0,da)}return OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{this.hd.insertBreak(R,d,m,this._context,da,Ea,A)})}insertContentControl(d){sc.a.ijf(d,"Paragraph");d=sc.a.lcd(d,0);1!==d||sc.a.FAa||sc.a.qd();const m=this.hd.V5b(this.Nd,!0),A=this.hd.V5b(this.Nd,!1);return this.Ig.Uma(m,A,this._context,d)}insertFileFromBase64(d,m){"<"===d.charAt(0)&&
(v.ULS.sendTraceTag(18130840,369,10,"invalid argument for insertFileFromeBase64 API in Paragraph class.",this._context.appId),sc.a.qd());return this.lia(d,m,!1)}insertHtml(d,m){const A=(new Date).getTime();if(2===m||3===m||4===m){const R=new U.a,da=jd.a.cR(0,this.gb.textLength(this.Nd),!1,this.Nd);R.add(da);return this.ew.insertHtml(R,d,m,A,this._context)}sc.a.qd();return null}insertInlinePictureFromBase64(d,m){return this.pVc(d,m)}insertOoxml(d,m){"<"!==d.charAt(0)&&(v.ULS.sendTraceTag(18130841,
369,10,"invalid argument for InsertOoxml API in Paragraph class.",this._context.appId),sc.a.qd());return this.lia(d,m,!0)}insertParagraph(d,m){let A=null;switch(m){case 0:A=this.hd.Y0a(this.Nd,!0);break;case 1:A=this.hd.Y0a(this.Nd,!1);break;default:v.ULS.sendTraceTag(21070050,369,15,"AppId:{0}, Invalid insert location for Paragraph.InsertParagraph method.",this._context.appId),sc.a.qd()}let R;return this.Vn.create(this.hd.insertParagraph((R=new U.a,R.add(A),R),d,m),this._context)}insertTable(d,m,
A,R){sc.a.Ai()||sc.a.zk();const da=this.hd.Y0a(this.Nd,!A);let Ea;return this.$c.insertTable((Ea=new U.a,Ea.add(da),Ea),d,m,A,R,this._context)}insertText(d,m){2!==m&&3!==m&&4!==m&&(v.ULS.sendTraceTag(21284492,369,15,"AppId:{0}, invalid location for Paragraph.InsertText: {1}.",this._context.appId,Wn[m]),sc.a.qd());const A=jd.a.create(this.Nd);this.hd.YJa(A,A);let R;return this.tk.create(this.hd.insertText((R=new U.a,R.add(A),R),d,m),this._context)}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>
{const R=new U.a;R.add(jd.a.create(this.Nd));this.nA.find(R,d,m,A,this._context)})}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=new U.a;R.add(jd.a.create(this.Nd));this.nA.rib(R,d,m,A,this._context)})}select(d){const m=new U.a;m.add(jd.a.create(this.Nd));this.iq.select(m,d)}setMetadata(){sc.a.zk()}split(d,m,A){sc.a.Ai()||sc.a.zk();const R=new U.a;R.add(jd.a.create(this.Nd));this.om.Qge(R);d=this.om.Emc(R,d,!1,m,A);m=new U.a;for(A=0;A<d.length;A++)m.add(this.tk.create(d[A],
this._context,A));return new Yt(m)}startNewList(){sc.a.Ai()||sc.a.zk();return this.hn.startNewList(this.Nd,this._context)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.Nd,"Paragraph")}getTypeName(){return"Microsoft.WordServices.Paragraph"}invokePropertyGet(d){switch(d){case 7:return this.alignment;case 5:return this.contentControls;case 36:return this.endnotes;case 8:return this.firstLineIndent;case 37:return this.fields;case 3:return this.font;case 35:return this.footnotes;case 17:return this.inlinePictures;
case 28:return this.isLastParagraph;case 19:return this.isListItem;case 9:return this.leftIndent;case 11:return this.lineSpacing;case 16:return this.lineUnitAfter;case 15:return this.lineUnitBefore;case 24:return this.list;case 27:return this.listItem;case 34:return this.listItemOrNullObject;case 33:return this.listOrNullObject;case 12:return this.outlineLevel;case 23:return this.parentBody;case 6:return this.parentContentControl;case 30:return this.parentContentControlOrNullObject;case 26:return this.parentTable;
case 25:return this.parentTableCell;case 31:return this.parentTableCellOrNullObject;case 32:return this.parentTableOrNullObject;case 10:return this.rightIndent;case 14:return this.spaceAfter;case 13:return this.spaceBefore;case 4:return this.style;case 29:return this.styleBuiltIn;case 22:return this.tableNestingLevel;case 18:return this.text;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 7:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 8:this.firstLineIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 9:this.leftIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 11:this.lineSpacing=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");
return;case 16:this.lineUnitAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 15:this.lineUnitBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 12:this.outlineLevel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 10:this.rightIndent=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 14:this.spaceAfter=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"number");return;case 13:this.spaceBefore=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 4:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 29:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
m){switch(d){case 1022:return this.HIk(m);case 1011:return this.RDa();case 1012:return this.UD(m);case 1023:return this.lnl();case 1014:return this.pGb();case 1032:return this.$Fb();case 1034:return this.uFa(m);case 1028:return this.Usf(m);case 1024:return this.Cca();case 1026:return this.Dca();case 1025:return this.vam();case 1027:return this.yam();case 1017:return this.Qoa(m);case 1030:return this.mgm(m);case 1020:return this.nSc(m);case 1033:return this.fHb(m);case 1004:return this.nGa(m);case 1009:return this.qpa(m);
case 1019:return this.e4a(m);case 1005:return this.pGa(m);case 1013:return this.iea(m);case 1029:return this.veg(m);case 1018:return this.xRb(m);case 1021:return this.HDo();case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1015:return this.SGb();case 1010:return this.W3a(m);case 1008:return this.opa(m);case 1006:return this.Z3a(m);case 1003:return this.$3a(m);case 1007:return this.c4a(m);
case 1016:return this.nra(m);case 1031:return this.Wka(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HIk(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.attachToList(m,d)}RDa(){this.clear();return null}UD(){this.deleteParagraph();return null}lnl(){this.detachFromList();return null}$Fb(){return this.getComments()}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,Ch);return this.getContentControls(d)}pGb(){return this.getHtml()}Usf(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getMetadata(d)}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}SGb(){return this.getOoxml()}vam(){return this.getPrevious()}yam(){return this.getPreviousOrNullObject()}Qoa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}mgm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getSubrange(m,d)}nSc(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(m,d)}fHb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}W3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(m,d)}nGa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");return this.insertContentControl(d)}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(m,d)}Z3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.insertHtml(m,d)}$3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(m,d)}c4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(m,d)}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(m,d)}e4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(m,A,R,d)}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(m,d)}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.select(d);return null}veg(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.setMetadata(m,d);return null}xRb(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"boolean");return this.split(m,A,d)}HDo(){return this.startNewList()}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}pVc(d,m,A){const R=(new Date).getTime();if(!m||1===m)return v.ULS.sendTraceTag(17433743,369,50,"AppId:{0}, insert inline picture with none supported location in Paragraph class.",this._context.appId),sc.a.qd(),null;var da=null;if(4===m)da=jd.a.Uc(this.Nd,0),this.clear();else{da=jd.a.create(this.Nd);({JJ:da}=this.hd.mL(da,da,m));let Ea;this.hd.ZT((Ea=new U.a,Ea.add(da),Ea),m,0)}n.AFrameworkApplication.pu?(this._context.Jm.Iu(this.Nd),m=this.Qw.HIb(d,da,
this._context,A)):m=this.Qw.HIb(d,da,this._context);return m.then(Ea=>{n.AFrameworkApplication.pu||this._context.Jm.Iu(this.Nd);if(Ea)return sc.a.$M("Paragraph.InsertInlinePictureFromBase64",sc.a.zN(R),d.length),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.fM.create(this.Qw.wOc(Ea),this._context));v.ULS.sendTraceTag(17433744,369,10,"AppId:{0}, something went wrong when insert iamge into Paragraph.",this._context.appId);sc.a.$M("Paragraph.InsertInlinePictureFromBase64",sc.a.zN(R),
d.length,!1);sc.a.Tf();return null})}Ktf(d){var m=this.gb.c3a(this.Nd);if(m&&(m=m.Lt))switch(d){case 2:switch(d=this.Xtf(1,m.vea),m.specialIndentType){case 1:return d;case 2:return-d;default:return 0}case 0:return this.Xtf(m.xIb,m.OB);case 1:return this.Xtf(m.yIb,m.lpa);default:return 0}v.ULS.sendTraceTag(16832386,369,10,"AppId:{0}, error happened when reading paragraph {1} indent.",this._context.appId,jy[d]);sc.a.Tf();return 0}NRc(d){var m=this.gb.c3a(this.Nd);if(m&&(m=m.spacing))switch(d){case 0:return this.Ytf(m.lineSpacing.unit,
m.lineSpacing.value);case 1:return this.Ytf(m.beforeSpacing.unit,m.beforeSpacing.value);case 2:return this.Ytf(m.afterSpacing.unit,m.afterSpacing.value);case 3:return this.cci(m.beforeSpacing.unit,m.beforeSpacing.value);case 4:return this.cci(m.afterSpacing.unit,m.afterSpacing.value);default:return 0}v.ULS.sendTraceTag(16832387,369,10,"AppId:{0}, error happened when reading paragraph {1} spacing.",this._context.appId,lt[d]);sc.a.Tf();return 0}Xtf(d,m){switch(d){case 2:return d=lh.a.sCb(m),Jg.a.Lea(d);
case 1:return Jg.a.Lea(m);default:return 0}}Ytf(d,m){switch(d){case 2:return 12*m;case 3:return Jg.a.Lea(m);case 4:return m;default:return 0}}cci(d,m){switch(d){case 4:return m/12;case 3:return Jg.a.Lea(m)/12;case 2:return m;default:return 0}}zFj(d){const m=this.gb.Ml(this.Nd,0),A=this.gb.Ml(this.Nd,this.gb.textLength(this.Nd)),R=this.gb.ix(this.Nd),da=this.gb.uw(this.Nd),Ea=A-da;d.Fb=0<m?R+(R<Ea?Ea-R:0):-1;d.Sb=0<A?da+(R<Ea?0:Ea-R):-1}lia(d,m,A){const R=(new Date).getTime(),da=new U.a;switch(m){case 2:case 3:case 4:const Ea=
jd.a.create(this.Nd);this.hd.YJa(Ea,Ea);da.add(Ea);break;default:return v.ULS.sendTraceTag(18130842,369,15,"AppId:{0}, Paragraph.InsertOoxmlOrDocx: undefined location!",this._context.appId),sc.a.qd(),null}return OfficeExtension.WacRuntime.Utility.createPromise((Ea,ib)=>{this.ew.insertOoxml(da,d,m,this.Nd,this._context,Ea,ib,R,A?0:1)})}language(){return this.OI.msf(this.Nd)}Koa(){return this.Nd}}Object(y.a)(Jw,"Paragraph",ih.a,[841]);class Vv{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,
Be,Hg,Xh){this.tk=null;this.gB=d;this.fM=m;this.XJe=A;this.gb=R;this.Xs=da;this.OI=Ea;this.iq=ib;this.Ilk=Qb;this.hd=pc;this.Qw=Pc;this.Ig=gd;this.nA=Cd;this.ew=ae;this.om=Xd;this.$c=se;this.hn=Xe;this.Ts=Be;this.cX=Hg;this.Ow=Xh}Ju(d){this.tk=d}create(d,m,A=0){return new Jw(d,m,A,this.gB,this.fM,this,this.tk,this.XJe,this.gb,this.Xs,this.OI,this.iq,this.Ilk,this.hd,this.Qw,this.Ig,this.nA,this.ew,this.om,this.$c,this.hn,this.Ts,this.cX,this.Ow)}}Object(y.a)(Vv,"ParagraphFactory",null,[858]);var fz=
c(872);class mt extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep,Mm,Mk){super();this.n3=null;this.g3="_";this.RXj=40;sc.a.tpc(d,"Range");this.Ed=d;this._context=m;this._id=A;this.Vn=R;this.fM=da;this.gB=Ea;this.tk=ib;this.KVc=Qb;this.gb=pc;this.iq=Pc;this.pA=gd;this.hd=Cd;this.Qw=ae;this.Ig=Xd;this.nA=se;this.ew=Xe;this.om=Be;this.zD=Hg;this.$c=Xh;this.hn=Fl;this.Bn=Gm;this.Qcb=em;this.Ts=$n;this.cX=Ep;this.Ow=Mm;this.ghd=Mk;this._context.nZc&&(this.n3=
this.KVc.create(d))}get Xbc(){return this.n3}get Xp(){return this.Ed}get contentControls(){if(sc.a.FAa){var d=new Ch;d.types=[31];return this.getContentControls(d)}d=this.Ed.J(0);const m=this.Ed.J(this.Ed.count-1);return this.Ig.dac(d,m,this._context)}get endnotes(){var d=this.hd.nSd(this.Ed,1);d=this.hd.Gva(d,this._context);return new rs(d)}get fields(){const d=new U.a;var m=!1;for(let A=0;A<this.Ed.count;A++){const R=this.Ed.J(A);switch(R.contextId){case ic.a.paragraph:m=this.Ow.U9b(R.node,this._context,
m);d.addRange(m);m=!0;break;case ic.a.Fd:m=this.Ow.$Rd(R.node,R.cpBegin,R.cpEnd,this._context,m);d.addRange(m);m=!0;break;case ic.a.Vc:break;case ic.a.Tc:break;default:v.ULS.sendTraceTag(539530914,369,10,"AppId:{0}, the contextId {1} is not supported to get the fields.",this._context.appId,R.contextId),sc.a.Tf()}}return new iv(d)}get font(){return this.gB.create(4,null,null,this,this._context)}get footnotes(){var d=this.hd.nSd(this.Ed,0);d=this.hd.Gva(d,this._context);return new rs(d)}get hyperlink(){if(!sc.a.Ai())return null;
const d=(sc.a.V6f()?this.om.pjb(this.Ed):this.pjb()).returnValue;return d&&d.length?d[0].hyperlink.url:null}set hyperlink(d){sc.a.Ai()||sc.a.zk();if(sc.a.V6f())this.om.tmj(this.Xp,d,!0,this._context);else{this.JHf()||sc.a.Tf();if(this.Ed.J(0).contextId===ic.a.Tc||this.Ed.J(0).contextId===ic.a.Vc)v.ULS.sendTraceTag(18989185,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",this._context.appId),sc.a.Tf();var m,A=({STf:m}=this.pjb()).returnValue;if(A)for(let R=0;R<
A.length;R++)this.zD.jS(A[R].paragraph,A[R].hyperlink);d&&""!==d&&m&&0<m.count&&(this.om.SBh(m.J(0))?(A=!1,0===d.indexOf("#")&&(d=d.substr(1),A=!0),this.zD.fF(m.J(0),d,!1,!1,!1,A)):sc.a.pD())}}get inlinePictures(){const d=new U.a;let m=0;for(const A of this.Ed){const R=new U.a;this.Qw.FSd(R,A);for(const da of R)d.add(this.fM.create(da,this._context,m++))}return new bp(d)}get isEmpty(){return this.om.uJb(this.Ed)}get lists(){return sc.a.Ai()?new ey(4,null,null,this,this._context,this.hn,null):null}get paragraphs(){let d=
0;const m=new U.a,A=new qu.a;for(const R of this.Ed)A.contains(R.node.id.toString())||(A.add(R.node.id.toString()),m.add(this.Vn.create(R.node,this._context,d++)));return new lr(m)}get parentBody(){return sc.a.Ai()?this.$c.Rtf(this.Ed.J(0).node,this.Ed.J(this.Ed.count-1).node,this._context):null}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||sc.a.Tk();return d}get parentContentControlOrNullObject(){return this.Ig.eac(this.Ed.J(0),this.Ed.J(this.Ed.count-1),this._context)}get parentTable(){if(!sc.a.Ai())return null;
const d=this.parentTableOrNullObject;d||sc.a.Tk();return d}get parentTableCell(){if(!sc.a.Ai())return null;const d=this.parentTableCellOrNullObject;d||sc.a.Tk();return d}get parentTableCellOrNullObject(){if(!sc.a.Ai())return null;const d=this.Ed.J(0),m=this.Ed.J(this.Ed.count-1);return this.$c.H$b(d.node,this._context,m.node)}get parentTableOrNullObject(){if(!sc.a.Ai())return null;const d=this.Ed.J(0),m=this.Ed.J(this.Ed.count-1);return this.$c.Ejb(d.node,this._context,m.node)}get style(){return this.pA.PQc(this.Ed)}set style(d){this.pA.olc(this.Ed,
d)}get styleBuiltIn(){return sc.a.Ai()?this.pA.oSd(this.Ed):-1}set styleBuiltIn(d){sc.a.Ai()||sc.a.zk();this.pA.ihe(this.Ed,d)}get tables(){return sc.a.Ai()?new ox(4,null,this,null,this._context,this.$c):null}get text(){return sc.a.AUn()?this.om.$Td(this.Ed,this._context):this.$Td()}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}clear(){this.Anc();this.hd.xCb(this.Ed);this.pDb()}compareLocationWith(d){sc.a.Ai()||sc.a.zk();d&&d.Xp.count||sc.a.Tf();return this.om.RHh(this.Xp.J(0),
this.Xp.J(this.Xp.count-1),d.Xp.J(0),d.Xp.J(d.Xp.count-1))}deleteRange(){this.Anc();this.hd.R6b(this.Ed);this.pDb()}endPreview(){}expandTo(d){(d=this.expandToOrNullObject(d))||sc.a.Tk();return d}expandToOrNullObject(d){sc.a.Ai()||sc.a.zk();if(!d||!d.Xp.count)return null;if(this.rzi(d)){var m=this.om.BJ(this.Ed.J(0),!0),A=this.om.BJ(this.Ed.J(this.Ed.count-1),!1,!0),R=this.om.BJ(d.Xp.J(0),!0);d=this.om.BJ(d.Xp.J(d.Xp.count-1),!1,!0);const da=this.Pga(m,R),Ea=this.Pga(A,d);2===da&&(m=R);Ea||(A=d);R=
this.R$h(m,A);return this.tk.create(R,this._context)}return null}getBookmarks(d,m){const A=[],R=new U.a;var da=new U.a;for(const Ea of this.Xp){const ib=Ea.node;if(ib.ra)for(let Qb=0;Qb<ib.ra.length;Qb++){const pc=ib.ra.J(Qb);if(pc.$g)for(let Pc=0;Pc<pc.$g.length;Pc++){const gd=pc.$g.J(Pc).yn.toString();da.contains(gd)||da.add(gd);m||(R.contains(gd)?R.remove(gd):R.add(gd))}}else v.ULS.sendTraceTag(545396882,369,15,"Paragraph characterProperties is null")}for(const Ea of da)if(m||!m&&!R.contains(Ea))da=
this.Bn.QFb(Rh.a.If(Ea)).ja(wc.a.At,""),(d||!d&&!da.startsWith(this.g3))&&A.push(da);return A}getComments(){return this.Ts.gRd(this.Ed,this._context)}getContentControls(d){var m;d=null!==(m=null===d||void 0===d?void 0:d.types)&&void 0!==m?m:[];sc.a.BNc(d);m=this.Ed.J(0);const A=this.Ed.J(this.Ed.count-1);m=this.Ig.dac(m,A,this._context);return 0===d.length?m:null===m||void 0===m?void 0:m.getByTypes(d)}getHtml(){return this.ew.getHtml(this.Ed.toArray(),this._context)}getHyperlinkRanges(){sc.a.Ai()||
sc.a.zk();let d;const m=new U.a;({returnValue:d}=sc.a.V6f()?this.om.pjb(this.Ed):this.pjb());if(!d)return new Yt(m);for(let A=0;A<d.length;A++){const R=new U.a;R.add(jd.a.createTextRange(d[A].paragraph,d[A].cpBegin,d[A].cpEnd));m.add(this.tk.create(R,this._context,A))}return new Yt(m)}getNextTextRange(d,m){(d=this.getNextTextRangeOrNullObject(d,m))||sc.a.Tk();return d}getNextTextRangeOrNullObject(d,m){sc.a.Ai()||sc.a.zk();return(d=this.om.getNextTextRange(this.Ed,d,m))?this.tk.create(d,this._context):
null}getOoxml(){const d=(new Date).getTime();this._context.Jm.WH();return OfficeExtension.WacRuntime.Utility.createPromise((m,A)=>{this.ew.getOoxml(this.Ed,this._context,m,A,d)})}getReviewedText(d){return this.ycm(d)}getRange(d){sc.a.Ai()||sc.a.zk();1!==d&&2!==d&&d&&5!==d&&4!==d&&(v.ULS.sendTraceTag(18745295,369,15,"AppId:{0}, rangeLocation of Range.GetRange must be Start/End/Whole/Content/After.",this._context.appId),sc.a.qd());return(d=this.om.D9b(this.Ed,d))?this.tk.create(d,this._context):null}getTextRanges(d,
m){sc.a.Ai()||sc.a.zk();d=this.om.Yvf(this.Ed,d,m);m=new U.a;for(let A=0;A<d.length;A++)m.add(this.tk.create(d[A],this._context,A));return new Yt(m)}highlight(){if(Object(fz.b)()){var d=this.Ed.J(0);this.ghd.T$k(d,this._context)}}insertBookmark(d){var m=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu");if(sa.a.af(d)||d.length>this.RXj||d.includes(" ")||!m.test(d))sc.a.qd();else{m=this.Xp.J(0);var A=this.Xp.J(this.Xp.count-1);this.Bn.WFc(d,m.Wj,A.vp,m.node,A.node,!0)}}insertBreak(d,m){m&&
1!==m&&(v.ULS.sendTraceTag(17179039,369,15,"AppId:{0}, insertLocation of Range.InsertBreak must be Before, After.",this._context.appId),sc.a.qd());const A=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((R,da)=>{this.hd.insertBreak(this.Ed,d,m,this._context,R,da,A,this.n3,!0)})}insertComment(d){return void 0===d||null===d?(sc.a.qd(),null):this.Ts.insertComment(this.Xp,d,this._context)}insertContentControl(d){sc.a.ijf(d,"Range");d=sc.a.lcd(d,0);1!==d||sc.a.FAa||sc.a.qd();
return this.wCf(!1,d)}insertFileFromBase64(d,m){"<"===d.charAt(0)&&(v.ULS.sendTraceTag(18130843,369,10,"invalid argument for insertFileFromeBase64 API in Range class.",this._context.appId),sc.a.qd());return this.lia(d,m,!1)}insertEndnote(d){d=this.hd.jti(this.Ed,d,1);return this.Qcb.create(d,this._context)}insertFootnote(d){d=this.hd.jti(this.Ed,d,0);return this.Qcb.create(d,this._context)}insertHtml(d,m){const A=(new Date).getTime();return this.ew.insertHtml(this.Ed,d,m,A,this._context,!0,this.n3)}insertInlinePictureFromBase64(d,
m){const A=(new Date).getTime();this.hd.ZT(this.Ed,m,0);4===m&&this.clear();const R=this.hd.X_d(this.Ed,m);let da=null;const Ea=this.Ed.J(0),ib=this.Ed.J(this.Ed.count-1),Qb=({JJ:da}=this.hd.mL(Ea,ib,m)).returnValue,pc=da.node.characterData.length;this.Anc();return this.Qw.HIb(d,da,this._context).then(Pc=>{this._context.Jm.Iu(Ea.node);if(!Pc)return this.pDb(),v.ULS.sendTraceTag(17433748,369,10,"AppId:{0}, something went wrong when insert image into Range.",this._context.appId),sc.a.$M("Range.InsertInlinePictureFromBase64",
sc.a.zN(A),d.length,!1),sc.a.Tf(),null;sc.a.$M("Range.InsertInlinePictureFromBase64",sc.a.zN(A),d.length);Pc=this.Qw.wOc(Pc);this.hd.yoe(this.Ed,da,Qb,1,pc);R&&this.hd.ode(this.Ed,m);this.pDb();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.fM.create(Pc,this._context))})}insertOoxml(d,m){"<"!==d.charAt(0)&&(v.ULS.sendTraceTag(18130844,369,10,"invalid argument for InsertOoxml API in Range class.",this._context.appId),sc.a.qd());return this.lia(d,m,!0)}insertParagraph(d,m){m&&
1!==m&&(v.ULS.sendTraceTag(21070051,369,15,"AppId:{0}, Invalid insert location for Range.InsertParagraph method.",this._context.appId),sc.a.qd());this.Anc();var A=!m,R=A?this.Ed.J(0):this.Ed.J(this.Ed.count-1);R=this.gb.Wf(R.node,A);if(A=this.$c.HSd(this.Ed,!m))if(R){m?1===m&&(m=0):m=1;var da;var Ea=this.hd.insertParagraph((da=new U.a,da.add(A),da),d,m)}else d=sc.a.kKc(d),da=jd.a.Uc(A.node,0),0<this.gb.Ml(da.node,da.cpBegin)?da.Fb=da.Sb=this.gb.Ml(da.node,da.cpBegin)/2:da.Fb=da.Sb=-1,this.hd.insertText((Ea=
new U.a,Ea.add(da),Ea),d,m),Ea=A.node;else Ea=this.hd.insertParagraph(this.Ed,d,m);this.pDb();return this.Vn.create(Ea,this._context)}insertTable(d,m,A,R){sc.a.Ai()||sc.a.zk();A&&1!==A&&sc.a.qd();this.Anc();d=this.$c.insertTable(this.Ed,d,m,A,R,this._context,!0);this.pDb();return d}insertTapObjectFromFileContent(){return null}insertText(d,m){this.Anc();d=this.tk.create(this.hd.insertText(this.Ed,d,m),this._context);this.pDb();return d}intersectWith(d){(d=this.intersectWithOrNullObject(d))||sc.a.Tk();
return d}intersectWithOrNullObject(d){sc.a.Ai()||sc.a.zk();if(!d||!d.Xp.count)return null;if(this.rzi(d)){var m=this.om.BJ(this.Ed.J(0),!0),A=this.om.BJ(this.Ed.J(this.Ed.count-1),!1,!0),R=this.om.BJ(d.Xp.J(0),!0);d=this.om.BJ(d.Xp.J(d.Xp.count-1),!1,!0);const da=this.Pga(m,R),Ea=this.Pga(A,d),ib=this.Pga(m,d),Qb=this.Pga(A,R);if(!da||1===da)if(2===Qb||1===Qb)m=R;else return null;else if(2===ib)return null;if(Ea){if(ib&&1!==ib)return null;A=d}else if(!Qb)return null;R=this.R$h(m,A);return this.tk.create(R,
this._context)}return null}previewTextReplacement(){}removeHighlight(){Object(fz.b)()&&this.ghd.bll(this.Ed,this._context)}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{this.nA.find(this.Ed,d,m,A,this._context)})}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{this.nA.rib(this.Ed,d,m,A,this._context)})}select(d){this.iq.select(this.Ed,d)}split(d,m,A,R){sc.a.Ai()||sc.a.zk();d=this.om.Emc(this.Ed,d,m,A,R);m=new U.a;for(A=0;A<d.length;A++)m.add(this.tk.create(d[A],
this._context,A));return new Yt(m)}_KeepReference(){this.rq()}_OnAccess(){n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.n3&&((this.Ed=this.n3.Xp)||v.ULS.sendTraceTag(21824033,369,10,"AppId:{0}, the range is lost for unknown reason using the new range model.",this._context.appId));sc.a.tpc(this.Ed,"InternalRange");for(const d of this.Ed)sc.a.o2(d.node,"Range")}insertField(d,m,A,R){nv.a.T8||sc.a.zk();return this.Ow.insertField(this.Ed,this._context,d,m,A,R)}getTypeName(){return"Microsoft.WordServices.Range"}invokePropertyGet(d){switch(d){case 6:return this.contentControls;
case 22:return this.endnotes;case 23:return this.fields;case 3:return this.font;case 21:return this.footnotes;case 11:return this.hyperlink;case 8:return this.inlinePictures;case 10:return this.isEmpty;case 12:return this.lists;case 5:return this.paragraphs;case 16:return this.parentBody;case 7:return this.parentContentControl;case 18:return this.parentContentControlOrNullObject;case 15:return this.parentTable;case 14:return this.parentTableCell;case 19:return this.parentTableCellOrNullObject;case 20:return this.parentTableOrNullObject;
case 4:return this.style;case 17:return this.styleBuiltIn;case 13:return this.tables;case 9:return this.text;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 11:this.hyperlink=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 4:this.style=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 17:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1011:return this.RDa();case 1019:return this.C3k(m);case 1012:return this.UD(m);case 1035:return this.qwl();
case 1020:return this.nAl(m);case 1028:return this.oAl(m);case 1026:return this.UPl(m);case 1014:return this.pGb();case 1023:return this.I0l();case 1022:return this.Y6l(m);case 1030:return this.Z6l(m);case 1040:return this.$Fb();case 1042:return this.uFa(m);case 1017:return this.Qoa(m);case 1041:return this.fHb(m);case 1025:return this.nSc(m);case 1032:return this.Avm(m);case 1027:return this.FDm(m);case 1039:return this.ODm(m);case 1003:return this.nGa(m);case 1038:return this.$Dm(m);case 1037:return this.eEm(m);
case 1008:return this.qpa(m);case 1024:return this.e4a(m);case 1031:return this.AFm(m);case 1004:return this.pGa(m);case 1021:return this.yGm(m);case 1029:return this.zGm(m);case 1034:return this.lIn(m);case 1033:return this.m0n();case 1013:return this.iea(m);case 1018:return this.xRb(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1015:return this.SGb();case 1009:return this.W3a(m);
case 1007:return this.opa(m);case 1005:return this.Z3a(m);case 1010:return this.$3a(m);case 1006:return this.c4a(m);case 1016:return this.nra(m);case 1036:return this.Wka(m);case 1043:return this.aEm(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}RDa(){this.clear();return null}C3k(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,mt);return this.compareLocationWith(d)}UD(){this.deleteRange();return null}qwl(){this.endPreview();return null}nAl(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,mt);return this.expandTo(d)}oAl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,mt);return this.expandToOrNullObject(d)}UPl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getBookmarks(m,d)}pGb(){return this.getHtml()}I0l(){return this.getHyperlinkRanges()}Y6l(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getNextTextRange(m,d)}Z6l(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getNextTextRangeOrNullObject(m,d)}SGb(){return this.getOoxml()}$Fb(){return this.getComments()}uFa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Ch);return this.getContentControls(d)}Qoa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}fHb(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getReviewedText(d)}nSc(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.getTextRanges(m,d)}Avm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.highlight(d);
return null}FDm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.insertBookmark(d);return null}ODm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.insertComment(d)}W3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertBreak(m,d)}nGa(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int?");
return this.insertContentControl(d)}$Dm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.insertEndnote(d)}aEm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.insertField(m,A,R,d)}eEm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");return this.insertFootnote(d)}opa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertFileFromBase64(m,d)}Z3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertHtml(m,d)}$3a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,
"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertInlinePictureFromBase64(m,d)}c4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertOoxml(m,d)}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(m,
d)}e4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(m,A,R,d)}AFm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,
"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");return this.insertTapObjectFromFileContent(m,A,d)}pGa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertText(m,d)}yGm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,mt);return this.intersectWith(d)}zGm(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,mt);return this.intersectWithOrNullObject(d)}lIn(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.previewTextReplacement(d);return null}m0n(){this.removeHighlight();return null}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,
d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}xRb(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"boolean");return this.split(m,A,R,d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();
return null}M6c(){n.AFrameworkApplication.K.$("WordEditorAgaveRangeEnhancementIsEnabled")&&this.n3&&(this.n3.lpb(),this.n3=null)}Anc(){this.n3&&this.n3.lpb()}pDb(){this.n3?this.n3.Hva(this.Ed):this.n3=this.KVc.create(this.Ed)}ycm(d){let m="";for(let R=0;R<this.Ed.count;R++){var A=this.Ed.J(R);switch(A.contextId){case ic.a.paragraph:A=this.cX.uUd(A.node,d);m+=A;break;case ic.a.Fd:A=this.cX.yuf(A.node,d,A.cpBegin,A.cpEnd);m+=A;break;case ic.a.Vc:A.node.ra.last.Lh&&1==d||A.node.ra.last.zi&&0==d||(m+=
sc.a.Dmb);break;case ic.a.Tc:break;default:v.ULS.sendTraceTag(545005570,369,10,"The contextId {0} is not supported to get the reviewed text.",A.contextId)}}return m}$Td(){let d="";for(let m=0;m<this.Ed.count;m++){const A=this.Ed.J(m);switch(A.contextId){case ic.a.paragraph:d+=this.gb.M6a(A.node)+sc.a.Dmb;break;case ic.a.Fd:const R={Bd:A.cpBegin,endCp:A.cpEnd};d+=this.gb.M6a(A.node,void 0,R).substring(R.Bd,R.endCp);break;case ic.a.Vc:d+=sc.a.Dmb;break;case ic.a.Tc:break;default:v.ULS.sendTraceTag(17040522,
369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",this._context.appId,A.contextId),sc.a.Tf()}}return d}Wcc(d){return d.contextId===ic.a.paragraph?!1:!0}lia(d,m,A){const R=(new Date).getTime();return OfficeExtension.WacRuntime.Utility.createPromise((da,Ea)=>{const ib=A?0:1;this.ew.insertOoxml(this.Ed,d,m,this.Ed.J(0).node,this._context,da,Ea,R,ib,0,!0,this.n3)})}rzi(d){return this.om.qzi(this.Xp.J(0),d.Xp.J(0))}Pga(d,m){return this.om.Pga(d,m)}R$h(d,m){this.Pga(d,m);const A=new U.a;
for(const R of this.Ig.uU(d,m))A.add(jd.a.create(R));1===A.count?d.cpBegin!==m.cpEnd?m.cpEnd>this.gb.textLength(m.node)?(d.cpBegin<this.gb.textLength(m.node)&&0<d.cpBegin?A.Z(0,jd.a.createTextRange(d.node,d.cpBegin,this.gb.textLength(m.node))):d.cpBegin?A.removeAt(0):A.Z(0,jd.a.create(d.node)),d.cpBegin<=this.gb.textLength(m.node)&&0<d.cpBegin&&A.add(jd.a.tl(m.node))):A.Z(0,jd.a.createTextRange(d.node,d.cpBegin,m.cpEnd)):d.cpEnd<=this.gb.textLength(m.node)?A.Z(0,d):A.removeAt(0):(d.cpBegin&&(d.cpBegin===
this.gb.textLength(d.node)?A.Z(0,jd.a.tl(d.node)):d.cpBegin<this.gb.textLength(d.node)?(A.Z(0,jd.a.createTextRange(d.node,d.cpBegin,this.gb.textLength(d.node))),A.insert(1,jd.a.tl(d.node))):A.removeAt(0)),0<m.cpEnd&&m.cpEnd<=this.gb.textLength(m.node)?A.Z(A.count-1,jd.a.createTextRange(m.node,0,m.cpEnd)):m.cpEnd?A.Z(A.count-1,jd.a.create(m.node)):A.removeAt(A.count-1));this.om.klc(d,m,A,!0);return A}pjb(){let d=[];const m=new U.a;var A=this.Ed.J(0).node.id;let R=this.Ed.J(0).node;var da=this.Ed.J(0);
let Ea=this.Ed.J(0);for(let ib=0;ib<this.Ed.count;ib++){const Qb=this.Ed.J(ib).node,pc=Qb.id;if(!A.equals(pc)){A=da.cpBegin;da.contextId===ic.a.paragraph?A=0:da.contextId===ic.a.Vc&&(A=da.node.characterData.length);da=Ea.cpEnd;if(Ea.contextId===ic.a.paragraph||Ea.contextId===ic.a.Vc)da=Ea.node.characterData.length;A===da?m.add(jd.a.Uc(R,A)):m.add(jd.a.createTextRange(R,A,da));R=Qb;A=pc;da=this.Ed.J(ib)}Ea=this.Ed.J(ib)}A=da.cpBegin;da.contextId===ic.a.paragraph?A=0:da.contextId===ic.a.Vc&&(A=da.node.characterData.length);
da=Ea.cpEnd;if(Ea.contextId===ic.a.paragraph||Ea.contextId===ic.a.Vc)da=Ea.node.characterData.length;A===da?m.add(jd.a.Uc(R,A)):m.add(jd.a.createTextRange(R,A,da));for(const ib of m)ib.contextId===ic.a.Tc&&(d=d.concat.apply(d,this.sBf(ib))),d=d.concat.apply(d,Ew.a.Fz(ib,!1));return{returnValue:d,STf:m}}JHf(){const d=this.Ed.J(0).node.id;for(let m=0;m<this.Ed.count;m++){const A=this.Ed.J(m).node.id;if(!d.equals(A))return!1}return!0}sBf(d){const m=[],A=Ew.a.Fz(d,!0);for(const R of A)R.cpBegin===d.cpBegin&&
m.push(R);return m}wCf(d=!1,m=0){this.Ig.j1e(this.Ed);this.Ed.count||(v.ULS.sendTraceTag(37777541,369,10,"GncList's length is incorrect after adjustment.",this._context.appId),sc.a.Tf());var A=this.Ed.J(0),R=this.Ed.J(this.Ed.count-1);if(A===R&&A.contextId===ic.a.Tc&&this.Ig.G4a(A)){let Ea;R=A.node.ra.nh(A.cpBegin);Ea=A.Ln()<R.Iw?0:1;var da;R=this.hd.insertParagraph((da=new U.a,da.add(A),da),"",Ea);A=jd.a.create(R);0<this.gb.Ml(R,0)?A.Fb=A.Sb=this.gb.Ml(R,0)/2:A.Fb=A.Sb=-1;return this.Ig.Uma(A,A,
this._context,m,d)}return A===R&&A.contextId===ic.a.Vc?(da=jd.a.tw(A.node),da.Fb=da.Sb=A.Ln(),this.Ig.G4a(da)&&sc.a.pD(),this.Ig.E_a(da,this._context,m,d)):this.Wcc(A)?this.Ig.E_a(A,this._context,m,d):this.Wcc(R)?this.Ig.Uma(A,this.Ed.J(this.Ed.count-2),this._context,m,d):this.Ig.Uma(A,R,this._context,m,d)}Wtf(d){if(n.AFrameworkApplication.pu){const m=new U.a;this.Qw.FSd(m,d);return m}}oXo(){this.n3&&(this.Ed=this.n3.Xp)}}Object(y.a)(mt,"Range",ih.a,[841]);class mr{constructor(d,m,A,R,da,Ea,ib,Qb,
pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em){this.Vn=d;this.fM=m;this.gB=A;this.U7j=R;this.gb=da;this.iq=Ea;this.pA=ib;this.hd=Qb;this.Qw=pc;this.Ig=Pc;this.nA=gd;this.ew=Cd;this.om=ae;this.zD=Xd;this.$c=se;this.hn=Xe;this.Bn=Be;this.Qcb=Hg;this.Ts=Xh;this.cX=Fl;this.Ow=Gm;this.ghd=em}create(d,m,A=0){return new mt(d,m,A,this.Vn,this.fM,this.gB,this,this.U7j,this.gb,this.iq,this.pA,this.hd,this.Qw,this.Ig,this.nA,this.ew,this.om,this.zD,this.$c,this.hn,this.Bn,this.Qcb,this.Ts,this.cX,this.Ow,this.ghd)}}
Object(y.a)(mr,"RangeFactory",null,[858]);class Et{constructor(){this.xSg=this._value=""}get value(){return this._value}set value(d){this._value=d}get Yna(){return this.xSg}set Yna(d){this.xSg=d}}Object(y.a)(Et,"StringAndDelimiter",null,[]);class YA{constructor(){this.ebb=this.JCa=-1;this.p1g=!1}get start(){return this.JCa}set start(d){this.JCa=d}get end(){return this.ebb}set end(d){this.ebb=d}get iFf(){return this.p1g}set iFf(d){this.p1g=d}}Object(y.a)(YA,"SubRangeGncLocation",null,[]);class Wv{constructor(d,
m,A){this.gb=d;this.ga=m;this.zD=A}D9b(d,m){if(!d||0>=d.count)return null;var A=d.count;const R=new U.a;if(m)if(1===m)R.add(this.BJ(d.J(0),!0));else if(2===m)R.add(this.BJ(d.J(A-1),!1));else if(5===m){for(m=0;m<A-1;m++)R.add(d.J(m).clone());m=d.J(A-1).clone();const da=this.gb.textLength(m.node);switch(m.contextId){case ic.a.paragraph:if(m=da?jd.a.createTextRange(m.node,0,da):1===A?jd.a.Uc(m.node,0):null)m.Fb=this.gb.ix(m.node),m.Sb=this.gb.uw(m.node);break;case ic.a.Vc:1===A?(m=jd.a.tw(m.node),m.Fb=
d.J(A-1).Fb,m.Sb=this.gb.uw(m.node)):m=null}m&&R.add(m)}else if(4===m){A=d.J(A-1).clone();d=null;switch(A.contextId){case ic.a.paragraph:case ic.a.Vc:if(A=this.odi(A.node))d=jd.a.Uc(A.node,0),d.Fb=d.Sb=this.gb.ix(A.node);break;case ic.a.Tc:case ic.a.Fd:d=this.BJ(A,!1)}if(d)R.add(d);else return null}else v.ULS.sendTraceTag(18745303,369,15,"rangeLocation of GetChildRange must be Start/End/Whole/Content/After."),sc.a.qd();else for(m=0;m<A;m++)R.add(d.J(m).clone());return R}Emc(d,m,A,R,da,Ea=!0,ib=!0,
Qb=!1){if(!d||0>=d.count)return v.ULS.sendTraceTag(18745304,369,10,"the Gnc List should contain at least one graph node context."),null;Qb&&(R||A||Ea)&&sc.a.Tf();var pc=new U.a;pc.add(d.J(0).node);var Pc=[""],gd=0,Cd=d.J(0).node.id;for(var ae=0;ae<d.count;ae++){var Xd=d.J(ae).node,se=Xd.id;Cd.equals(se)||(Cd=se,gd++,pc.add(Xd),Pc[gd]="");switch(d.J(ae).contextId){case ic.a.paragraph:Xd=this.gb.text(Xd);break;case ic.a.Fd:case ic.a.Tc:Xd=this.gb.text(Xd).substring(d.J(ae).cpBegin,d.J(ae).cpEnd);break;
default:continue}Pc[gd]+=Xd}Ea||(Cd=d.J(0).node,ae=d.J(d.count-1).node,Pc[0]=this.gb.text(Cd),Pc[Pc.length-1]=this.gb.text(ae));Cd=Array(gd+1);for(ae=0;ae<gd+1;ae++)Cd[ae]=[],Xd=new Et,Xd.value=Pc[ae],Cd[ae][0]=Xd;for(Pc=0;Pc<m.length;Pc++)for(ae=m[Pc],Xd=0;Xd<gd+1;Xd++){se=Cd[Xd];var Xe=[];for(var Be=0;Be<se.length;Be++)Xe=Xe.concat.apply(Xe,this.GCo(ae,se[Be]));Cd[Xd]=Xe}m=Array(gd+1);for(Pc=0;Pc<gd+1;Pc++)for(m[Pc]=[],ae=Cd[Pc],Xd=0,Ea&&!Pc&&(Xd=this.jvf(d.J(0),!0)),se=this.gb.textLength(pc.J(Pc)),
Ea&&Pc===gd&&(se=this.jvf(d.J(d.count-1),!1)),Xe=0;Xe<ae.length;Xe++){Be=new YA;var Hg=ae[Xe];if(Hg=Hg.value.length+Hg.Yna.length){var Xh=Xd+Hg<se?Xd+Hg:se;Be.start=Xd;Be.end=Xh;Xd+=Hg}else Be.start=Xd,Be.end=Xd;if(Qb&&0<=Xe&&Xe<ae.length-1){Hg=ae[Xe+1];Xh=Hg.value.trimStart();const Fl=Hg.value.length-Xh.length;Be.end+=Fl;Xd+=Fl;Hg.value=Xh}m[Pc][Xe]=Be}if(R)for(Pc=0;Pc<gd+1;Pc++)for(ae=Cd[Pc],Xd=0;Xd<ae.length;Xd++)m[Pc][Xd].end-=ae[Xd].Yna.length;for(Cd=0;Cd<gd+1;Cd++)if(ae=pc.J(Cd),Pc=m[Cd][m[Cd].length-
1],this.gb.textLength(ae),Cd===gd&&(!Ea||d.J(d.count-1).contextId===ic.a.paragraph||d.J(d.count-1).contextId===ic.a.Vc)||!Cd&&(0<gd||!Ea||d.J(d.count-1).contextId===ic.a.paragraph||d.J(d.count-1).contextId===ic.a.Vc)||0<Cd&&Cd<gd)ae=new YA,ae.start=Pc.end,ae.end=Pc.end,ae.iFf=!0,m[Cd][m[Cd].length]=ae;Cd=Array(gd+1);for(Pc=0;Pc<gd+1;Pc++)for(Cd[Pc]=[],ae=pc.J(Pc),Xd=m[Pc],se=0;se<Xd.length;se++)Xe=new U.a,Be=Xd[se],Be=Be.iFf?jd.a.tl(ae):Be.start||Be.end!==this.gb.textLength(ae)?Be.start===Be.end?
jd.a.Uc(ae,Be.start):jd.a.createTextRange(ae,Be.start,Be.end):jd.a.create(ae),Xe.add(Be),Cd[Pc][se]=Xe;pc=[];gd=0;for(m=0;m<Cd.length;m++)for(Pc=Cd[m],ae=0;ae<Pc.length;ae++){if(A&&ae+1<Pc.length&&Pc[ae+1].J(0).contextId===ic.a.Vc)if(Xd=new U.a,m<Cd.length-1){Xd.addRange(Pc[ae]);this.pOm(Pc[ae])||Xd.J(Xd.count-1).contextId===ic.a.paragraph||(Xd.J(Xd.count-1).contextId===ic.a.Tc&&Xd.removeAt(Xd.count-1),Xd.add(Pc[ae+1].J(0)));Xd.addRange(Cd[m+1][0]);Cd[m+1][0]=Xd;break}else Xd=Pc[ae],Xd.J(Xd.count-
1).contextId===ic.a.paragraph?Pc.pop():Xd.J(Xd.count-1).contextId===ic.a.Tc?(se=Pc.pop(),Xd.Z(Xd.count-1,se.J(0))):Xd.J(Xd.count-1).contextId===ic.a.Fd&&(se=Pc.pop(),Xd.add(se.J(0)));if(!A){if(ae+1<Pc.length&&Pc[ae+1].J(0).contextId===ic.a.Vc)if(Xd=Pc[ae],Xd.J(Xd.count-1).contextId===ic.a.paragraph)Pc.pop();else if(Xd.J(Xd.count-1).contextId===ic.a.Tc){if(se=Pc.pop(),Xd.Z(Xd.count-1,se.J(0)),Qb&&0<ae){Pc[ae-1].add(se.J(0));Pc.pop();continue}}else Xd.J(Xd.count-1).contextId===ic.a.Fd&&(se=Pc.pop(),
Xd.add(se.J(0)));R&&this.lne(Cd[m][ae])}da&&(Cd[m][ae]=this.mne(Cd[m][ae],A));!Qb&&Ea&&(Xd=Cd[m][ae],se=d.J(0),Xe=d.J(d.count-1),this.klc(se,Xe,Xd,R));ib&&this.uJb(Cd[m][ae])||(pc[gd++]=Cd[m][ae])}return pc}Yvf(d,m,A){if(!d||!d.count)return null;m=this.Emc(d,m,!1,!1,!1,!1,!1,!0);for(var R=0;R<m.length&&!this.OFf(m[R],d.J(0),!0);)m.shift();for(R=m.length-1;0<=R&&!this.OFf(m[R],d.J(d.count-1),!1);R--)m.pop();if(A){d=[];A=0;for(R=0;R<m.length;R++)m[R]=this.mne(m[R]),this.uJb(m[R])||(d[A++]=m[R]);m=d}for(d=
0;d<m.length;d++)this.klc(null,null,m[d],!1);return m}getNextTextRange(d,m,A){if(!d||0>=d.count)return null;var R=new U.a;R.add(d.J(d.count-1));var da=this.Emc(R,m,!1,!1,!1,!1,!1,!0);R=new U.a;var Ea=-1;for(let ib=da.length-1;0<=ib&&!this.OFf(da[ib],d.J(d.count-1),!1);ib--)Ea=ib;if(-1!==Ea){for(;Ea<da.length&&this.uJb(R);Ea++)R=da[Ea],A&&(R=this.mne(R));this.klc(null,null,R,!1);if(!this.uJb(R))return R}d=d.J(d.count-1);do{if(d=this.odi(d.node))for(da=new U.a,da.add(d),da=this.Emc(da,m,!1,!1,!1,!1,
!0,!0),Ea=0;Ea<da.length&&this.uJb(R);Ea++)R=da[Ea],A&&(R=this.mne(R));else return null;this.klc(null,null,R,!1)}while(this.uJb(R));return R}uJb(d){for(let m=0;m<d.count;m++)switch(d.J(m).contextId){case ic.a.paragraph:case ic.a.Vc:return!1;case ic.a.Fd:if(d.J(m).cpBegin<d.J(m).cpEnd)return!1;break;case ic.a.Tc:if(d.J(m).Fb<d.J(m).Sb)return!1}return!0}BJ(d,m=!0,A=!1){if(!d)return null;let R=null;switch(d.contextId){case ic.a.paragraph:R=m?jd.a.Uc(d.node,0):A?jd.a.Uc(d.node,this.gb.textLength(d.node)+
1):jd.a.tw(d.node);break;case ic.a.Vc:R=!m&&A?jd.a.Uc(d.node,this.gb.textLength(d.node)+1):jd.a.tw(d.node);break;case ic.a.Fd:case ic.a.Tc:R=m?jd.a.Uc(d.node,d.cpBegin):jd.a.Uc(d.node,d.cpEnd)}R&&m&&-1!==d.Fb?R.Fb=R.Sb=d.Fb:R&&!m&&-1!==d.Sb&&(R.cpEnd===this.gb.textLength(d.node)+1?R.Fb=R.Sb=-1:R.Fb=R.Sb=d.Sb);return R}Qge(d){if(d&&d.count){var m=d.J(0);d=d.J(d.count-1);m.Fb=this.gb.ix(m.node);d.Sb=this.gb.uw(d.node)}}klc(d,m,A,R){if(A&&A.count){var da=A.J(0);A=A.J(A.count-1);var Ea=this.BJ(da),ib=
this.BJ(A,!1),Qb=null,pc=null;d&&(Qb=this.BJ(d));m&&(pc=this.BJ(m,!1));d&&Qb&&Qb.cpBegin===Ea.cpBegin?-1!==d.Fb&&(da.Fb=d.Fb):(0<this.gb.Ml(da.node,Ea.cpBegin)?da.Fb=0:da.Fb=-1,Ea.cpBegin||(da.Fb=this.gb.ix(da.node)));m&&pc&&pc.cpEnd===ib.cpEnd?-1!==m.Sb&&(A.Sb=m.Sb):(d=this.gb.Ml(A.node,ib.cpEnd),0<d?R?(A.Sb=d,ib.cpEnd===this.gb.textLength(ib.node)&&(A.Sb=this.gb.uw(ib.node))):A.Sb=0:A.Sb=-1)}}SBh(d){return 32!==this.ga.Mf(d,xe.a.insertHyperlink,1,!1,null,null)?!1:!0}odi(d){return(d=this.gb.Wf(d,
!1,!0))?jd.a.create(d):null}lne(d){let m=!1;if(d&&0<d.count)for(var A=0;A<d.count;){d.J(A).contextId===ic.a.Vc&&(d.removeAt(A),m=!0);break}if(d&&0<d.count)for(A=d.count-1;0<=A;A--){const R=d.J(A);if(R.contextId===ic.a.Vc)d.removeAt(A),m=!0;else if(R.contextId===ic.a.paragraph)if(m=!0,this.gb.textLength(R.node)){d.Z(A,jd.a.createTextRange(R.node,0,this.gb.textLength(R.node)));break}else d.removeAt(A);else break}return m}mne(d,m=!0){const A=new U.a;m&&this.lne(d);if(d&&0<d.count)for(var R=0;R<d.count;){var da=
this.kCj(d.J(R),!0);if(da.contextId===ic.a.Tc)d.removeAt(R);else if(d.Z(R,da),!m)break;if(m&&!this.lne(d))break}if(d&&0<d.count){do if(R=d.count-1,da=this.kCj(d.J(R),!1),da.contextId===ic.a.Tc)d.removeAt(R);else if(d.Z(R,da),!m)break;while((!m||m&&this.lne(d))&&0<d.count)}A.addRange(d);return A}kCj(d,m){if(!d)return null;var A=null;switch(d.contextId){case ic.a.Fd:case ic.a.paragraph:A=this.BJ(d,!0);var R=this.BJ(d,!1);const da=this.gb.text(A.node),Ea=da.substring(A.cpBegin,R.cpBegin);let ib=A.cpBegin;
R=R.cpEnd;m?ib+=Ea.length-Ea.trimStart().length:R=ib+Ea.trimEnd().length;A=R-ib?ib||R!==da.length?jd.a.createTextRange(A.node,ib,R):d:jd.a.Uc(A.node,ib);break;case ic.a.Vc:case ic.a.Tc:A=d}return A}OFf(d,m,A){if(0<d.count){const Ea=this.BJ(d.J(0),!0);var R=this.BJ(d.J(d.count-1),!1);if(!Ea.node.id.equals(m.node.id))return!1;var da=this.jvf(m,A);let ib=d=-1;switch(m.contextId){case ic.a.Fd:case ic.a.paragraph:this.gb.text(m.node).length?(d=2*da+1,ib=2*da-1):ib=d=0;break;case ic.a.Vc:case ic.a.Tc:d=
2*da,ib=2*da}da=Ea.cpBegin;m=R.cpEnd;0<m-da?(R=2*da,da=2*m-1,m===this.gb.text(Ea.node).length&&(da+=1)):(R=2*da,da=2*m);if(A&&d>=R&&d<=da||!A&&ib>=R&&ib<=da)return!0}return!1}jvf(d,m){let A=0,R=0;if(d)switch(d.contextId){case ic.a.paragraph:A=0;R=this.gb.textLength(d.node);break;case ic.a.Vc:A=this.gb.textLength(d.node);R=this.gb.textLength(d.node);break;case ic.a.Fd:case ic.a.Tc:A=d.cpBegin,R=d.cpEnd}return m?A:R}GCo(d,m){const A=m.value.split(d),R=[];for(let da=0;da<A.length;da++){const Ea=new Et;
Ea.value=A[da];Ea.Yna=da!==A.length-1?d:m.Yna;R[da]=Ea}return R}pOm(d){for(let m=0;m<d.count;m++)if(d.J(m).contextId===ic.a.Vc)return!0;return!1}RHh(d,m,A,R){if(this.qzi(d,A)){d=this.BJ(d,!0);m=this.BJ(m,!1,!0);A=this.BJ(A,!0);const da=this.BJ(R,!1,!0);R=this.Pga(d,A);const Ea=this.Pga(m,da);d=this.Pga(d,da);m=this.Pga(m,A);d=R?2===R?2===d?13:1===d?11:Ea?1===Ea?6:12:7:Ea?1===Ea?1:2:5:m?1===m?8:Ea?1===Ea?3:4:9:10}else d=0;return d}qzi(d,m){d=this.BJ(d,!0);m=this.BJ(m,!0);return 3!==this.Pga(d,m)}Pga(d,
m){if(d.node.id.equals(m.node.id)){var A=d.cpBegin-m.cpBegin;return A?0<A?2:0:(A=d.Ln()-m.Ln())?0<A?2:0:1}A=this.yji(d.node);const R=this.yji(m.node);A.insert(0,d.node);R.insert(0,m.node);d=A.count;for(m=R.count;0<d&&0<m&&A.J(--d).id.equals(R.J(--m).id););var da=A.J(d+1);switch(da.type){case 7:case 35:case 39:return 3;case 8:case 10:const Ea=this.jJh(A),ib=this.jJh(R);if(Ea||ib)return 3;da=If.GraphIterator.eb(da);return 0<da.Fwa(A.J(d))-da.Fwa(R.J(m))?2:0;default:return da=If.GraphIterator.eb(da),
0<da.Fwa(A.J(d))-da.Fwa(R.J(m))?2:0}}pjb(d){let m=[];const A=new U.a;var R=d.J(0).node.id;let da=d.J(0).node;var Ea=d.J(0);let ib=d.J(0);for(let Qb=0;Qb<d.count;Qb++){const pc=d.J(Qb).node,Pc=pc.id;if(!R.equals(Pc)){R=Ea.cpBegin;Ea.contextId===ic.a.paragraph?R=0:Ea.contextId===ic.a.Vc&&(R=Ea.node.characterData.length);Ea=ib.cpEnd;if(ib.contextId===ic.a.paragraph||ib.contextId===ic.a.Vc)Ea=ib.node.characterData.length;R===Ea?A.add(jd.a.Uc(da,R)):A.add(jd.a.createTextRange(da,R,Ea));da=pc;R=Pc;Ea=d.J(Qb)}ib=
d.J(Qb)}R=Ea.cpBegin;Ea.contextId===ic.a.paragraph?R=0:Ea.contextId===ic.a.Vc&&(R=Ea.node.characterData.length);Ea=ib.cpEnd;if(ib.contextId===ic.a.paragraph||ib.contextId===ic.a.Vc)Ea=ib.node.characterData.length;R===Ea?A.add(jd.a.Uc(da,R)):A.add(jd.a.createTextRange(da,R,Ea));for(const Qb of A)Qb.contextId===ic.a.Tc&&(m=m.concat.apply(m,this.sBf(Qb))),m=m.concat.apply(m,Ew.a.Fz(Qb,!1));return{returnValue:m,STf:A}}$Td(d,m){let A="";for(let R=0;R<d.count;R++){const da=d.J(R);switch(da.contextId){case ic.a.paragraph:A+=
this.gb.M6a(da.node)+sc.a.Dmb;break;case ic.a.Fd:const Ea={Bd:da.cpBegin,endCp:da.cpEnd};A+=this.gb.M6a(da.node,void 0,Ea).substring(Ea.Bd,Ea.endCp);break;case ic.a.Vc:A+=sc.a.Dmb;break;case ic.a.Tc:break;default:v.ULS.sendTraceTag(539848968,369,10,"AppId:{0}, the contextId {1} is not supported to get the text.",m.appId,da.contextId),sc.a.Tf()}}return A}tmj(d,m,A,R){this.JHf(d)||sc.a.Tf();if(d.J(0).contextId===ic.a.Tc||d.J(0).contextId===ic.a.Vc)v.ULS.sendTraceTag(540377293,369,15,"AppId:{0}, InsertionPoint and EndOfParagraph Can not be set hyperlink by API",
R.appId),sc.a.Tf();if(R=({STf:d}=this.pjb(d)).returnValue)for(let da=0;da<R.length;da++)this.zD.jS(R[da].paragraph,R[da].hyperlink);m&&""!==m&&d&&0<d.count&&(this.SBh(d.J(0))?(R=!1,A&&0===m.indexOf("#")&&(m=m.substr(1),R=!0),this.zD.fF(d.J(0),m,!1,!1,!1,R)):sc.a.pD())}yji(d){const m=new U.a;d=If.GraphIterator.eb(d);for(d.zb(7);d.sc();)m.add(d.currentNode);return m}jJh(d){for(let m=0;m<d.count;m++)if(35===d.J(m).type)return!0;return!1}sBf(d){const m=[],A=Ew.a.Fz(d,!0);for(const R of A)R.cpBegin===
d.cpBegin&&m.push(R);return m}JHf(d){const m=d.J(0).node.id;for(let A=0;A<d.count;A++){const R=d.J(A).node.id;if(!m.equals(R))return!1}return!0}}Object(y.a)(Wv,"RangeOperations",null,[994]);class go{constructor(d){this.controlId=this.appId=null;this.nZc=!1;this.nk=null;this.Jm=d}}Object(y.a)(go,"RequestContext",null,[]);var Wi=c(2075);class gz{constructor(){this.Xka=null;this.t1b=this.fAb=this.yUb=0;this.T4g=this.D3j=this.ztc=this.UDc=null;this.rmb=[]}get UE(){return this.Xka}set UE(d){this.Xka=d}get yZe(){return this.yUb}mie(d){this.yUb=
d}get Aka(){return this.fAb}Hlc(d){this.fAb=d}get d9a(){return this.t1b}get U$(){return this.UDc}set U$(d){this.UDc=d}get p4(){return this.ztc}set p4(d){this.ztc=d}get gFa(){return this.D3j}get rmb(){return this.T4g}set rmb(d){this.T4g=d}$2a(){throw Error.notImplemented();}iUd(){throw Error.notImplemented();}W9b(){throw Error.notImplemented();}Qbi(){throw Error.notImplemented();}qCd(){throw Error.notImplemented();}noh(){throw Error.notImplemented();}a7c(){throw Error.notImplemented();}vee(){throw Error.notImplemented();
}wFh(){throw Error.notImplemented();}INi(){throw Error.notImplemented();}S$b(){throw Error.notImplemented();}jP(){throw Error.notImplemented();}t$h(){throw Error.notImplemented();}Wrb(){throw Error.notImplemented();}Iej(){throw Error.notImplemented();}}Object(y.a)(gz,"FindResultManagerStub",null,[1527]);class ZA extends gz{constructor(d){super();this.qbb=d}qCd(d){this.qbb&&this.qbb.OPa(0,d)}}Object(y.a)(ZA,"ExtensionFindResultManager",gz,[]);class $A{constructor(d,m,A,R){this.kRg=d;this.v3j=m;this.B3j=
A;this.Omh=R}find(d,m,A,R,da){if(this.fYm(A)&&this.hYm(m,A)){var Ea=0;A&&(Ea|=A.matchCase?1:0,Ea|=A.matchPrefix?8:0,Ea|=A.matchSuffix?16:0,Ea|=A.matchWildcards?4:0,Ea|=A.matchWholeWord?2:0,Ea|=A.ignorePunct?32:0,Ea|=A.ignoreSpace?64:0);this.rib(d,m,Ea,R,da)}else v.ULS.sendTraceTag(18629911,344,10,"user have input a invalid search text."),sc.a.qd()}rib(d,m,A,R,da){this.gYm(A)&&this.iYm(m,A)?(d=this.LYl(d),0>=d.count?R(new Yt(new U.a)):(R=this.B3j.create(d,R,da),da=new ZA(R),this.v3j.create(R,da,d).find(this.rbm(m,
A)))):(v.ULS.sendTraceTag(545814685,344,10,"user have input an invalid search text."),sc.a.qd())}rbm(d,m){let A=Wi.a.none;if(!m)return this.kRg(d,A);m&4&&(A|=Wi.a.wildCards);m&1&&(A|=Wi.a.matchCase);m&2&&(A|=Wi.a.wholeWordOnly);m&8&&(A|=Wi.a.prefix);m&16&&(A|=Wi.a.suffix);m&64&&(A|=Wi.a.ignoreSpace);m&32&&(A|=Wi.a.ignorePunct);return this.kRg(d,A)}LYl(d){const m=new U.a;for(const A of d)A.contextId!==ic.a.paragraph&&A.contextId!==ic.a.Fd||m.add(A);return m}hYm(d,m){return null===d||""===d||m&&m.matchWildcards&&
!this.Omh.R1d(d)?!1:!0}fYm(d){return d&&d.matchCase&&d.matchWildcards?!1:!0}iYm(d,m){return null===d||""===d||4===m&&!this.Omh.R1d(d)?!1:!0}gYm(d){return 5===d?!1:!0}}Object(y.a)($A,"SearchExecutor",null,[993]);var WB;(function(d){d[d.primary=0]="primary";d[d.Vjp=1]="firstPage";d[d.bjp=2]="evenPages"})(WB||(WB={}));Object(y.b)("HeaderFooterType",WB);class ky extends ih.a{constructor(d,m,A,R,da,Ea,ib){super();sc.a.jKa(d,"Section");this.vjd=d;this._context=m;this._id=A;this.Zta=R;this.NN=da;this.bMa=
Ea;this.lm=ib}get body(){return this.NN.create(this.vjd,this._context)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}getFooter(d){return this.NN.create(this.N2a(!1,d),this._context)}getHeader(d){return this.NN.create(this.N2a(!0,d),this._context)}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){sc.a.Ai()||sc.a.zk();var d=If.GraphIterator.eb(this.vjd);return d.zb(8)?(d=d.t$b(1))?this.Zta.create(d,this._context):null:null}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.vjd,
"Section")}getTypeName(){return"Microsoft.WordServices.Section"}invokePropertyGet(d){switch(d){case 3:return this.body;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,
m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1004:return this.HZl(m);case 1003:return this.U_l(m);case 1005:return this.Cca();case 1006:return this.Dca();case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HZl(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getFooter(d)}U_l(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getHeader(d)}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}N2a(d,m){const A=new If.GraphIterator;A.set(this.vjd);let R=1,da=-1;switch(m){case 0:da=d?0:3;break;case 1:da=d?2:5;R=2;break;case 2:da=d?1:4;R=3;break;default:v.ULS.sendTraceTag(16831117,369,15,"AppId:{0}, the type of header footer is undefined: {1}.",
this._context.appId,WB[m]),sc.a.qd()}this.bMa.TXh(A,R);d=this.lm.TLb(A);m=null;d&&(m=this.lm.N2a(d,da));return m}}Object(y.a)(ky,"Section",ih.a,[841]);class cu{constructor(d,m,A){this.NN=d;this.bMa=m;this.lm=A}create(d,m,A=0){return new ky(d,m,A,this,this.NN,this.bMa,this.lm)}}Object(y.a)(cu,"SectionFactory",null,[858]);var XB=c(856);class YB{constructor(d,m,A,R,da){this.$c=null;this.hb=d;this.Fe=m;this.ME=A;this.gb=R;this.ga=da}Ju(d){this.$c=d}Eza(d,m){this.cjj(d,m)}Ado(d,m){this.cjj(d,m)}cjj(d,
m){const A=14===d.type,R=A?"Table":"Row";d=1===m?this.gb.$k(d):this.gb.XC(d);const da=1===m?0:this.gb.textLength(d);d=new Pe.Selection([jd.a.Uc(d,da)],!0);this.hb.Ac(d);m||32===this.ga.processAction(A?xe.a.Eza:xe.a.ZPb,2)||(v.ULS.sendTraceTag(20306081,369,10,"Commands.Select{0} failed",R),sc.a.Tf())}select(d,m){d.count||(v.ULS.sendTraceTag(17094667,369,10,"The gncList is empty when try to select the list."),sc.a.qd());const A=d.J(0);d=d.J(d.count-1);switch(m){case 0:var R=new Pe.Selection([A],!0);
R=this.Fe.Jj(R,!0,!1);var da=new Jo.SelectionCollection([R],0),Ea=new Pe.Selection([d],!0);Ea=this.Fe.Jj(Ea,!1,!0);if(({yl:da}=this.ME.DSb(da,Ea.Pa)).returnValue){if(1<da.length&&(R=this.$c.r0(A.node))){Ea=this.gb.$k(R);const ib=this.gb.XC(R);if(Ea===A.node&&ib===d.node){this.Eza(R,m);break}}this.hb.oZ(da)}else R=this.ME.Iy(R,Ea.Pa),this.hb.Ac(R);break;case 1:m=jd.a.Uc(A.node,A.Wj);m.Sb=m.Fb=A.Ln();R=new Pe.Selection([m],!0);this.hb.Ac(R);break;case 2:m=jd.a.Uc(d.node,d.vp);m.Sb=m.Fb=d.Mn();R=new Pe.Selection([m],
!0);this.hb.Ac(R);break;default:v.ULS.sendTraceTag(17094670,369,10,"The type of selectionMode is undefined!"),sc.a.qd()}}lRc(d){return new XB.a(this.Fe.Jj(this.ME.Xn(d),!0,!1))}$dd(d){this.hb.cEh()||this.hb.Ac(d.restore())}U$h(d,m,A){var R,da=this.Ffm(d,m,A);A=this.yXl(d,m,A);if(!da||!A)return null;da.Fb=d.Fb;A.Sb=m.Sb;const Ea=new U.a;if(da.equals(A))return da.Sb=A.Sb,Ea.add(da),Ea;Ea.add(da);const ib=this.gb.uw(da.node);if(da.node.id.equals(A.node.id))return da.contextId===ic.a.Fd&&da.cpEnd===this.gb.textLength(da.node)&&
A.contextId===ic.a.Vc&&(da.Sb=Math.min(ib,A.Sb),A.Sb=A.Fb=A.Sb),Ea.add(A),Ea;da.Sb=ib;A.Fb=this.gb.ix(A.node);da.contextId===ic.a.Fd&&(da=jd.a.tl(da.node),da.Sb=da.Fb=ib,Ea.add(da));d=d.node;m=m.node;do d=null!==(R=this.gb.Wf(d,!1,!0))&&void 0!==R?R:this.L6l(d),d.id.equals(m.id)||(da=jd.a.create(d),da.Fb=this.gb.ix(da.node),da.Sb=this.gb.uw(da.node),Ea.add(da));while(!d.id.equals(m.id));Ea.add(A);return Ea}Ffm(d,m,A){if(!d||!m)return null;if(d.node.id.equals(m.node.id)){if(m.cpBegin===this.gb.textLength(m.node)&&
A){if(d.cpBegin===m.cpBegin)return jd.a.tl(d.node);if(!d.cpBegin)return jd.a.create(d.node)}return d.cpBegin===m.cpBegin?jd.a.Uc(d.node,d.cpBegin):jd.a.createTextRange(d.node,d.cpBegin,m.cpBegin)}return d.cpBegin?d.cpBegin===this.gb.textLength(d.node)?jd.a.tl(d.node):jd.a.createTextRange(d.node,d.cpBegin,this.gb.textLength(d.node)):jd.a.create(d.node)}yXl(d,m,A){return d&&m?d.node.id.equals(m.node.id)?m.cpBegin===this.gb.textLength(m.node)&&A?d.cpBegin||d.cpBegin===m.cpBegin?jd.a.tl(d.node):jd.a.create(d.node):
d.cpBegin===m.cpBegin?jd.a.Uc(d.node,d.cpBegin):jd.a.createTextRange(d.node,d.cpBegin,m.cpBegin):A?jd.a.create(m.node):m.cpBegin?jd.a.createTextRange(m.node,0,m.cpBegin):jd.a.Uc(m.node,0):null}L6l(d){if(!sc.a.aPh())return null;d=If.GraphIterator.eb(d);if(!d.zb(37))return null;d.jd(38);return(d=d.Oj())?this.gb.$k(d):null}}Object(y.a)(YB,"SelectionApiHelper",null,[991]);class tx{constructor(){this.Yte=new Qm;this.Zte=new ek}Cwa(d,m){if(!d)return null;if(d.fN)return this.Cwa(d.fN,m);if(!d.Bia)return null;
const A=new If.GraphIterator;A.set(m);for(m=A.Tb(19);m;){const R=this.EKc(m);if(R&&R.Ovh(d))return m;m=A.Lf(19)}return null}Nkb(d,m){d||sc.a.Tf();if(d.fN)return this.Nkb(d.fN,m);if(d.Bia){const A=this.ecf(d);this.JZe(A,d,m);return A}return null}ucf(d,m){const A=this.Zte.create(1074135139);A.setValue(wc.a.OGc,d);A.setValue(wc.a.k3b,m);return A}Sib(d,m){const A=new If.GraphIterator;A.set(d.value);return m.GP(A)&&A.Tb(18)?A:null}EKc(d){const m=d.getValue(wc.a.kfb),A=d.getValue(wc.a.qDd),R=d.getValue(wc.a.l3b),
da=d.getValue(wc.a.m3b),Ea=d.getValue(wc.a.NGc),ib=d.getValue(wc.a.lfb),Qb=d.ja(Gg.a.e4e,null),pc=d.ja(Gg.a.f4e,0);d=d.id.toString();let Pc=null;Ea||(Pc=new fl(d,d,m,A,R,da,ib,!0,Qb,pc));return Pc}ecf(d){const m=this.Yte.create(1074135137);m.setValue(wc.a.kfb,d.Qn);m.setValue(wc.a.qDd,d.version);m.setValue(wc.a.l3b,d.store);m.setValue(wc.a.m3b,d.storeType);m.setValue(wc.a.lfb,d.PGc);m.setValue(wc.a.NGc,!1);m.setValue(wc.a.xth,!1);m.setValue(wc.a.Gth,"");m.setValue(wc.a.Lth,"right");m.setValue(wc.a.Oth,
350);m.setValue(wc.a.Nth,1);m.setValue(wc.a.Mth,!1);return m}JZe(d,m,A){const R=new If.GraphIterator;R.set(A);d.anchor?sc.a.qd():(m=Rh.a.If(m.Dth),Eg.a.compare(m.guid,Eg.a.nil)&&(m=new Rh.a(Eg.a.create(),1)),R.Q3(d,19,m))}}Object(y.a)(tx,"SettingOperations",null,[992]);var IC=c(899);class Xr{constructor(d,m,A,R,da,Ea){this.$c=null;this.rz=d;this.ga=m;this.gb=A;this.ala=R;this.Ay=da;this.rba=Ea;this.$Za=new Pd.a(()=>this.Ay.Sii());this.Rah=new Pd.a(()=>{const ib=new Fk.a,Qb=this.rz.Eei(),pc=this.rz.Otf();
for(const Pc of Qb.keys)ib.add(Pc,Qb.J(Pc));for(const Pc of pc.keys)ib.add(Pc,pc.J(Pc));return ib})}Ju(d){this.$c=d}PQc(d){let m="";for(let A=0;A<d.count;A++){if(!this.EIf(d.J(A).contextId))continue;const R=this.$$h(d.J(A));""===m&&""!==R&&(m=R);if(R!==m)return""}return m}$$h(d){if(!this.EIf(d.contextId))return"";const m=new IC.a;return 2===this.ga.Mf(d,xe.a.pIa,2,!1,new kt.a,m)?this.$$h(jd.a.create(d.node)):m.dVa.getValue(Td.a.la)}oSd(d){d=this.PQc(d).toLowerCase();return d in Xr.Izb?Xr.Izb[d]:-1}Jii(d){d=
this.Ay.pF(d);return this.Ay.aVd(d)}lhm(d){d=this.Jii(d).toLowerCase();return d in Xr.Izb?Xr.Izb[d]:-1}poj(d,m){sc.a.upc(m,"Table.Style/Table.StyleBuiltIn");m=this.c4i(m);const A=this.Ay.Ahm(m);A?(m=this.Ay.OUd(d,A),this.rba.HQb(m,d)):this.olc(this.gb.Hz(d,!0,!1),m)}fpo(d,m){m=this.vci(m);this.poj(d,m)}olc(d,m){if(this.ala.JIc(d,0)){m=this.c4i(m);var A=this.rz.Ar().QFa(m);A||(v.ULS.sendTraceTag(17334858,369,15,"The {0} style is not supported on word wac.",m),sc.a.qd());if(3===this.rz.NG(A)){var R=
this.$c.U7h(d.J(0).node);d=this.$c.U7h(d.J(d.count-1).node);R&&d&&R.id===d.id?this.rba.HQb(A,R):(v.ULS.sendTraceTag(20841048,369,15,"The {0} style only can be applied to table on word wac.",m),sc.a.qd())}else for(R of d)this.Tdg(R,A)}}ihe(d,m){m=this.vci(m);this.olc(d,m)}vci(d){let m="";for(const A of Object.keys(Xr.Izb))if(Xr.Izb[A]===d){m=A;break}d=m.split("-");1<d.length&&(m=d[0]+d[1].substr(1));for(const A of this.Rah.value.keys)if(A.toLowerCase()===m)return this.Rah.value.J(A);for(const A of this.$Za.value.keys)if(A.toLowerCase()===
m)return this.$Za.value.J(A);return""}Tdg(d,m){if(this.EIf(d.contextId)){var A=this.rz.NG(m);if(2===A){if(d.contextId===ic.a.Tc||d.contextId===ic.a.Fd){this.Tdg(jd.a.create(d.node),m);return}}else if(1===A){if(d.contextId===ic.a.paragraph){this.Tdg(jd.a.createTextRange(d.node,0,this.gb.textLength(d.node)),m);return}}else{v.ULS.sendTraceTag(17334859,369,10,"Table or other style: {0} is not supported on word wac.",m.toString());return}m=this.rz.Kg(m);this.ga.Mf(d,xe.a.LQ,2,!1,new kt.a,m)}}c4i(d){if(!(d.trim().toLowerCase()in
Xr.Izb))return d.trim();let m="";d=d.trim().toLowerCase().split(" ");for(const A of d){for(d=0;d<A.length;d++)m=d?m+A.charAt(d):m+A.charAt(0).toUpperCase();m+=" "}return m.trimEnd()}EIf(d){switch(d){case ic.a.paragraph:case ic.a.Fd:case ic.a.Tc:case ic.a.view:return!0;default:return!1}}}Xr.Izb=lf.a.i6("other",-1,"normal",0,"heading 1",1,"heading 2",2,"heading 3",3,"heading 4",4,"heading 5",5,"heading 6",6,"heading 7",7,"heading 8",8,"heading 9",9,"toc 1",19,"toc 2",20,"toc 3",21,"toc 4",22,"toc 5",
23,"toc 6",24,"toc 7",25,"toc 8",26,"toc 9",27,"footnote text",29,"header",31,"footer",32,"caption",34,"footnote reference",38,"endnote reference",42,"endnote text",43,"title",62,"subtitle",74,"hyperlink",85,"strong",87,"emphasis",88,"no spacing",157,"list paragraph",179,"quote",180,"intense quote",181,"subtle emphasis",260,"intense emphasis",261,"subtle reference",262,"intense reference",263,"book title",264,"bibliography",265,"toc heading",266,"table grid",154,"plain table 1",267,"plain table 2",
268,"plain table 3",269,"plain table 4",270,"plain table 5",271,"table grid light",272,"grid table 1 light",111,"grid table 1 light - accent 1",280,"grid table 1 light - accent 2",287,"grid table 1 light - accent 3",294,"grid table 1 light - accent 4",301,"grid table 1 light - accent 5",308,"grid table 1 light - accent 6",315,"grid table 2",274,"grid table 2 - accent 1",281,"grid table 2 - accent 2",288,"grid table 2 - accent 3",295,"grid table 2 - accent 4",302,"grid table 2 - accent 5",309,"grid table 2 - accent 6",
316,"grid table 3",275,"grid table 3 - accent 1",282,"grid table 3 - accent 2",289,"grid table 3 - accent 3",296,"grid table 3 - accent 4",303,"grid table 3 - accent 5",310,"grid table 3 - accent 6",317,"grid table 4",276,"grid table 4 - accent 1",283,"grid table 4 - accent 2",290,"grid table 4 - accent 3",297,"grid table 4 - accent 4",304,"grid table 4 - accent 5",311,"grid table 4 - accent 6",318,"grid table 5 dark",277,"grid table 5 dark - accent 1",284,"grid table 5 dark - accent 2",291,"grid table 5 dark - accent 3",
298,"grid table 5 dark - accent 4",305,"grid table 5 dark - accent 5",312,"grid table 5 dark - accent 6",319,"grid table 6 colorful",278,"grid table 6 colorful - accent 1",285,"grid table 6 colorful - accent 2",292,"grid table 6 colorful - accent 3",299,"grid table 6 colorful - accent 4",306,"grid table 6 colorful - accent 5",313,"grid table 6 colorful - accent 6",320,"grid table 7 colorful",279,"grid table 7 colorful - accent 1",286,"grid table 7 colorful - accent 2",293,"grid table 7 colorful - accent 3",
300,"grid table 7 colorful - accent 4",307,"grid table 7 colorful - accent 5",314,"grid table 7 colorful - accent 6",321,"list table 1 Light",322,"list table 1 light - accent 1",329,"list table 1 light - accent 2",336,"list table 1 light - accent 3",343,"list table 1 light - accent 4",350,"list table 1 light - accent 5",357,"list table 1 light - accent 6",364,"list table 2",323,"list table 2 - accent 1",330,"list table 2 - accent 2",337,"list table 2 - accent 3",344,"list table 2 - accent 4",351,
"list table 2 - accent 5",358,"list table 2 - accent 6",365,"list table 3",324,"list table 3 - accent 1",331,"list table 3 - accent 2",338,"list table 3 - accent 3",345,"list table 3 - accent 4",352,"list table 3 - accent 5",359,"list table 3 - accent 6",366,"list table 4",325,"list table 4 - accent 1",332,"list table 4 - accent 2",339,"list table 4 - accent 3",346,"list table 4 - accent 4",353,"list table 4 - accent 5",360,"list table 4 - accent 6",367,"list table 5 dark",326,"list table 5 dark - accent 1",
333,"list table 5 dark - accent 2",340,"list table 5 dark - accent 3",347,"list table 5 dark - accent 4",354,"list table 5 Dark - accent 5",361,"list table 5 Dark - accent 6",368,"list table 6 colorful",327,"list table 6 colorful - accent 1",334,"list table 6 colorful - accent 2",341,"list table 6 colorful - accent 3",348,"list table 6 colorful - accent 4",355,"list table 6 colorful - accent 5",362,"list table 6 colorful - accent 6",369,"list table 7 colorful",328,"list table 7 colorful - accent 1",
335,"list table 7 colorful - accent 2",342,"list table 7 colorful - accent 3",349,"list table 7 colorful - accent 4",356,"list table 7 colorful - accent 5",363,"list table 7 colorful - accent 6",370);Object(y.a)(Xr,"StyleApiHelper",null,[990]);var hz;(function(d){d[d.top=0]="top";d[d.left=1]="left";d[d.bottom=2]="bottom";d[d.right=3]="right";d[d.Lti=4]="insideHorizontal";d[d.Mti=5]="insideVertical";d[d.mmp=6]="inside";d[d.Q_i=7]="outside";d[d.all=8]="all"})(hz||(hz={}));Object(y.b)("BorderLocation",
hz);class aB extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd){super();this.sT=[0,2,1,3];this.Ef=d;this.O$a=m;this._context=A;this.Yc=R;this.sh=da;this.BC=Ea;this.Ay=ib;this.jl=Qb;this.F3=pc;this.C2=Pc;this.rba=gd;this.Zue=new Pd.a(()=>this.dQl());this.Yue=new Pd.a(()=>this.bQl())}get color(){return this.Gvf(3).toUpperCase()}set color(d){d=sc.a.hKa(d,"TableBorder.Color",this._context);this.dfg(3,d)}get type(){let d=this.Gvf(2);d||(d="mixed");return this.Zue.value.J(d)}set type(d){-1===d&&sc.a.qd();
this.dfg(2,this.cQl(d))}get width(){let d=this.Gvf(1);d||(d="0");return parseFloat(d)}set width(d){sc.a.ZVa(d,"TableBorder.Width");12<d&&sc.a.qd();this.dfg(1,d.toString())}get _ReferenceId(){return this.yq?this.Tq:null}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.Ef,"TableBorder")}getTypeName(){return"Microsoft.WordServices.TableBorder"}invokePropertyGet(d){switch(d){case 2:return this.color;case 3:return this.type;case 4:return this.width;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 2:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 3:this.type=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}Gvf(d){switch(this.Ef.type){case 16:return this.Fca(this.Ef,
this.O$a,d);case 15:return this.Xwa(this.Ef,this.O$a,d);case 14:return this.Ef.hasProperty(wc.a.vka)?this.Voa(this.Ef,this.O$a,d):this.j3a(this.Ef,this.O$a,d);default:return v.ULS.sendTraceTag(20828692,369,10,"AppId:{0}, The node type is invalid when get table border",this._context.appId),sc.a.Tf(),null}}Fca(d,m,A){let R=null;switch(m){case 8:case 7:R=this.y8l(d,A);break;case 1:case 3:case 0:case 2:R=this.Ay.eXl(Oy.a.Pmf(),d,this.Yue.value.J(hz[m]),A);3===A&&R===dn.a.P_&&(R="#000000");break;default:v.ULS.sendTraceTag(20828693,
369,15,"AppId:{0}, The border location is invalid when get table cell border",this._context.appId),sc.a.qd()}return R}Xwa(d,m,A){var R=null;switch(m){case 1:case 3:R=this.Yc.Rf(d);1===m?this.jl.G5d(R):this.jl.VQf(R);R=this.Fca(R.currentNode,m,A);break;case 0:case 2:var da=this.BC.AB(d);R=this.Fca(da.J(0),m,A);for(d=1;d<da.count;d++)if(R!==this.Fca(da.J(d),m,A))return this.Bca(A);break;case 6:case 5:da=this.BC.AB(d);1===da.count&&(v.ULS.sendTraceTag(20828694,369,15,"AppId:{0}, The border location is invalid when get table row border",
this._context.appId),sc.a.qd());R=this.Fca(da.J(0),3,A);if(this.Ef.hasProperty(wc.a.vka))for(m=1;m<da.count;m++)if(R!==this.Fca(da.J(m),1,A))return this.Bca(A);for(m=1;m<da.count-1;m++)if(R!==this.Fca(da.J(m),3,A))return this.Bca(A);break;case 7:R=this.Xwa(d,this.sT[0],A);for(da=1;da<this.sT.length;da++)if(R!==this.Xwa(d,this.sT[da],A))return this.Bca(A);break;case 8:R=this.Xwa(d,7,A);da=this.BC.AB(d);if(1<da.count&&R!==this.Xwa(d,6,A))return this.Bca(A);break;default:v.ULS.sendTraceTag(20828695,
369,15,"AppId:{0}, The border location is invalid when get table row border",this._context.appId),sc.a.qd()}return R}j3a(d,m,A){var R=null,da;let Ea;switch(m){case 1:case 3:d=this.sh.Qx(d,0,this.sh.gg(d)-1);R=this.Xwa(d.J(0),m,A);if(this.DJb(R))break;for(da=1;da<d.count;da++)if(R!==this.Xwa(d.J(da),m,A))return this.Bca(A);break;case 0:case 2:R=this.Yc.Rf(d);m?this.jl.XQf(R):this.jl.RLb(R);R=this.Xwa(R.currentNode,m,A);break;case 4:da=this.sh.gg(d);1>=da&&(v.ULS.sendTraceTag(20828696,369,15,"AppId:{0}, The border location is invalid when get table border",
this._context.appId),sc.a.qd());d=this.sh.Qx(d,0,da-1);R=this.Xwa(d.J(0),2,A);if(this.DJb(R))break;for(m=1;m<da-1;m++)if(R!==this.Xwa(d.J(m),2,A))return this.Bca(A);break;case 5:Ea=this.sh.hh(d);1>=Ea&&(v.ULS.sendTraceTag(20828697,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),sc.a.qd());da=this.sh.gg(d);d=this.sh.Qx(d,0,da-1);R=this.Xwa(d.J(0),m,A);if(this.DJb(R))break;for(da=1;da<d.count;da++)if(R!==this.Xwa(d.J(da),m,A))return this.Bca(A);break;case 6:da=
this.sh.gg(d);Ea=this.sh.hh(d);if(1===Ea&&1===da)v.ULS.sendTraceTag(20828698,369,15,"AppId:{0}, The border location is invalid when get table border",this._context.appId),sc.a.qd();else if(1===Ea)R=this.j3a(d,4,A);else if(1===da)R=this.j3a(d,5,A);else if(R=this.j3a(d,4,A),!this.DJb(R)&&R!==this.j3a(d,5,A))return this.Bca(A);break;case 7:R=this.j3a(d,this.sT[0],A);if(this.DJb(R))break;for(m=1;m<this.sT.length;m++)if(R!==this.j3a(d,this.sT[m],A))return this.Bca(A);break;case 8:if(R=this.j3a(d,7,A),
!this.DJb(R)&&(1<this.sh.hh(d)||1<this.sh.gg(d))&&R!==this.j3a(d,6,A))return this.Bca(A)}return R}Voa(d,m,A){let R=null;switch(m){case 1:case 3:case 0:case 2:case 4:case 5:R=this.Ay.MRd(Oy.a.Pmf(),d,this.Yue.value.J(hz[m]),A);3===A&&R===dn.a.P_&&(R="#000000");break;case 6:R=this.Voa(d,4,A);if(R!==this.Voa(d,5,A))return this.Bca(A);break;case 7:R=this.Voa(d,this.sT[0],A);for(m=1;m<this.sT.length;m++)if(R!==this.Voa(d,this.sT[m],A))return this.Bca(A);break;case 8:if(R=this.Voa(d,7,A),!this.DJb(R)&&
R!==this.Voa(d,6,A))return this.Bca(A)}return R}y8l(d,m){const A=this.Fca(d,this.sT[0],m);for(let R=1;R<this.sT.length;R++)if(A!==this.Fca(d,this.sT[R],m))return this.Bca(m);return A}Bca(d){switch(d){case 2:return"mixed";case 1:return"0";case 3:return""}return null}DJb(d){return"0"===d||"mixed"===d||""===d}dfg(d,m){switch(this.Ef.type){case 16:var A=this.Yc.Rf(this.Ef);A.zb(14);A=this.jl.getContainingTable(A);this.Yhe(this.Ef,this.O$a,d,m,!A.hasProperty(wc.a.vka));break;case 15:this.nqb(this.Ef,this.O$a,
d,m,!this.Ef.hasProperty(wc.a.vka));break;case 14:this.Ef.hasProperty(wc.a.vka)?this.Clc(this.Ef,this.O$a,d,m):this.IQb(this.Ef,this.O$a,d,m);break;default:v.ULS.sendTraceTag(20841049,369,10,"AppId:{0}, The node type is invalid when setting table border",this._context.appId),sc.a.Tf()}}Yhe(d,m,A,R,da=!0){switch(m){case 0:case 2:case 1:case 3:this.loj(d,m,A,R,da);break;case 8:case 7:this.Cmo(d,A,R,da);break;default:v.ULS.sendTraceTag(20841050,369,15,"AppId:{0}, The border location is invalid when setting table cell border",
this._context.appId),sc.a.qd()}}nqb(d,m,A,R,da=!0){switch(m){case 1:case 3:da=this.Yc.Rf(d);1===m?this.jl.G5d(da):this.jl.VQf(da);this.F3.$r(da.currentNode)||this.Yhe(da.currentNode,m,A,R);break;case 0:case 2:d=this.BC.AB(d);for(let Ea=0;Ea<d.count;Ea++)this.Yhe(d.J(Ea),m,A,R,da);break;case 6:case 5:d=this.BC.AB(d);1===d.count&&(v.ULS.sendTraceTag(20841051,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),sc.a.qd());for(m=0;m<d.count-1;m++)this.Yhe(d.J(m),
3,A,R);break;case 7:for(m=0;m<this.sT.length;m++)this.nqb(d,this.sT[m],A,R,da);break;case 8:this.nqb(d,7,A,R,da);this.nqb(d,6,A,R,da);break;default:v.ULS.sendTraceTag(20841052,369,15,"AppId:{0}, The border location is invalid when setting table row border",this._context.appId),sc.a.qd()}}IQb(d,m,A,R){var da;switch(m){case 1:case 3:d=this.sh.Qx(d,0,this.sh.gg(d)-1);for(da=0;da<d.count;da++)this.nqb(d.J(da),m,A,R);break;case 0:case 2:da=this.Yc.Rf(d);m?this.jl.XQf(da):this.jl.RLb(da);this.nqb(da.currentNode,
m,A,R);break;case 4:da=this.sh.gg(d);1>=da&&(v.ULS.sendTraceTag(20841053,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),sc.a.qd());d=this.sh.Qx(d,0,da-1);for(m=0;m<da-1;m++)this.nqb(d.J(m),2,A,R);break;case 5:var Ea=this.sh.hh(d);1>=Ea&&(v.ULS.sendTraceTag(20841054,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),sc.a.qd());da=this.sh.gg(d);d=this.sh.Qx(d,0,da-1);for(Ea=0;Ea<da;Ea++)this.nqb(d.J(Ea),
m,A,R);break;case 6:da=this.sh.gg(d);Ea=this.sh.hh(d);1===Ea&&1===da?(v.ULS.sendTraceTag(20841055,369,15,"AppId:{0}, The border location is invalid when setting table border",this._context.appId),sc.a.qd()):1===Ea?this.IQb(d,4,A,R):(1!==da&&this.IQb(d,4,A,R),this.IQb(d,5,A,R));break;case 7:for(m=0;m<this.sT.length;m++)this.IQb(d,this.sT[m],A,R);break;case 8:this.IQb(d,7,A,R),(1<this.sh.hh(d)||1<this.sh.gg(d))&&this.IQb(d,6,A,R)}}Clc(d,m,A,R){switch(m){case 1:case 3:case 0:case 2:case 4:case 5:this.$oo(d,
m,A,R);break;case 6:this.Clc(d,4,A,R);this.Clc(d,5,A,R);break;case 7:for(m=0;m<this.sT.length;m++)this.Clc(d,this.sT[m],A,R);break;case 8:this.Clc(d,6,A,R),this.Clc(d,7,A,R)}}loj(d,m,A,R,da=!0){let Ea=null,ib=null;var Qb=null;switch(A){case 3:Ea=this.Fca(d,m,2);ib=R;Qb=this.Fca(d,m,1);break;case 1:Ea=this.Fca(d,m,2);ib=sc.a.hKa(this.Fca(d,m,3),"TableBorder.Color",this._context);Qb=R;break;case 2:Ea=R,ib=sc.a.hKa(this.Fca(d,m,3),"TableBorder.Color",this._context),Qb=this.Fca(d,m,1)}A=parseInt(ib,16);
Qb=parseFloat(Qb);this.efg(d,m,Ea,Qb,A);da&&(m=({HAk:d}=this.mNl(d,m)).returnValue)&&this.efg(m,d,Ea,Qb,A)}efg(d,m,A,R,da,Ea=!0){m=this.Yue.value.J(hz[m]);Ea=Ea?this.C2.bP(m):this.C2.OM(m);Ea||(v.ULS.sendTraceTag(20841056,369,10,"AppId:{0}, The border property definition is invalid when setting table border",this._context.appId),sc.a.Tf());this.rba.xho(d,Ea,A,R,da)}mNl(d,m){d=this.Yc.Rf(d);d.zb(14);let A=null,R=0;switch(m){case 0:A=this.jl.GQi(d);R=2;break;case 2:A=this.jl.$Qf(d);R=0;break;case 1:this.F3.uia(d)||
(A=this.jl.YQf(d,!0),R=3);break;case 3:this.F3.gda(d)||(A=this.jl.YQf(d,!1),R=1)}return{returnValue:A,HAk:R}}Cmo(d,m,A,R=!0){for(let da=0;da<this.sT.length;da++)this.loj(d,this.sT[da],m,A,R)}cQl(d){for(const m of this.Zue.value.keys)if(this.Zue.value.J(m)===d)return m;return""}$oo(d,m,A,R){let da=null,Ea=null,ib=null;switch(A){case 3:da=this.Voa(d,m,2);Ea=R;ib=this.Voa(d,m,1);break;case 1:da=this.Voa(d,m,2);Ea=sc.a.hKa(this.Voa(d,m,3),"TableBorder.Color",this._context);ib=R;break;case 2:da=R,Ea=sc.a.hKa(this.Voa(d,
m,3),"TableBorder.Color",this._context),ib=this.Voa(d,m,1)}this.efg(d,m,da,parseFloat(ib),parseInt(Ea,16),!1)}bQl(){const d=new Fk.a;d.Z("top",5);d.Z("left",3);d.Z("bottom",0);d.Z("right",4);d.Z("insideHorizontal",1);d.Z("insideVertical",2);return d}dQl(){const d=new Fk.a;d.Z("mixed",-1);d.Z("none",0);d.Z("single",1);d.Z("double",3);d.Z("dotted",6);d.Z("dashed",7);d.Z("dotDash",8);d.Z("dotDotDash",9);d.Z("triple",10);d.Z("thinThickSmallGap",11);d.Z("thickThinSmallGap",12);d.Z("thinThickThinSmallGap",
13);d.Z("thinThickMediumGap",14);d.Z("thickThinMediumGap",15);d.Z("thinThickThinMediumGap",16);d.Z("thinThickLargeGap",17);d.Z("thickThinLargeGap",18);d.Z("thinThickThinLargeGap",19);d.Z("wave",20);d.Z("doubleWave",21);d.Z("dashSmallGap",22);d.Z("dashDotStroked",23);d.Z("threeDEmboss",24);d.Z("threeDEngrave",25);return d}}Object(y.a)(aB,"TableBorder",ih.a,[841]);class Zz{constructor(d,m,A,R,da,Ea,ib,Qb){this.Yc=d;this.sh=m;this.BC=A;this.Ay=R;this.jl=da;this.C2=ib;this.rba=Qb;Ea&&Ea.execute(pc=>{null==
pc?v.ULS.sendTraceTag(523580866,324,10,"ITableCellReader is null after future execution"):this.F3=pc})}create(d,m,A){return new aB(d,m,A,this.Yc,this.sh,this.BC,this.Ay,this.jl,this.F3,this.C2,this.rba)}}Object(y.a)(Zz,"TableBorderFactory",null,[]);class Kw extends ih.a{constructor(d,m,A,R,da,Ea){super();this.Pzb=null;this.Zg=d;this.ZZa=m;this.PYj=A;this._context=R;this.$c=da;this.sh=Ea}length(){return this.Pzb.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();
d||sc.a.Tk();return d}getFirstOrNullObject(){this.zIj();return this.Pzb&&this.length()?this.Pzb.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(d<this.length())return this.Pzb.J(d);v.ULS.sendTraceTag(19969494,369,10,"The index is out of the table row range.");sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){this.zIj();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.TableRowCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}zIj(){switch(this.PYj){case 1:let m=null,A=null;for(var d=0;d<this.ZZa.count;d++)if(this.ZZa.J(d).isConnected){m=this.ZZa.J(d);break}for(d=this.ZZa.count-
1;0<=d;d--)if(this.ZZa.J(d).isConnected){A=this.ZZa.J(d);break}if(!m&&!A){this.ZZa.clear();this.Pzb.clear();break}this.ZZa=this.sh.Juf(this.Zg,m,A);this.Pzb=this.$c.Oii(this.ZZa,this._context);break;case 0:this.Pzb=this.$c.Oii(this.sh.Qx(this.Zg,0,this.sh.gg(this.Zg)-1),this._context);break;default:v.ULS.sendTraceTag(20756162,369,10,"AppId:{0}, something went wrong when refresh the table row collection.",this._context.appId)}}}Object(y.a)(Kw,"TableRowCollection",ih.a,[841,857]);class iz extends ih.a{constructor(d,
m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae){super();sc.a.jKa(d,"TableCell");this.uz=d;this._context=m;this._id=A;this.qba=R;this.NN=da;this.Yc=Ea;this.LCa=ib;this.jl=Qb;this.F3=pc;this.$c=Pc;this.sh=gd;this.Hma=Cd;this.qA=ae}get body(){return this.NN.create(this.uz,this._context)}get cellIndex(){return this.$c.gRl(this.uz)}get columnWidth(){var d=this.$c.r0(this.uz);if(this.sh.RB(d))return null;var m=this.Yc.Rf(this.uz);m.zb(14);m=this.Hma.cQc(m);d=this.Hma.eRd(d);return-1===d[m]?0:Jg.a.$5a(d[m])}set columnWidth(d){sc.a.ZVa(d,
"TableCell.ColumnWidth");const m=this.$c.r0(this.uz);this.sh.RB(m)&&sc.a.Tf();var A=this.Yc.Rf(this.uz);A.zb(14);A=this.Hma.cQc(A);var R=this.Yc.Rf(m);let da=0;if(R.zb(14)){let Ea;const ib=({Ccd:Ea}=this.$c.iSc(m)).returnValue;Ea&&!this.$c.xni(ib)||sc.a.Tf();R=this.$c.Hpf(R)-Ea+ib[A];0<R?da=Math.min(Jg.a.Uya(d),R):sc.a.Tf()}else da=Jg.a.Uya(d);this.qA.lea(m,A,da)}get horizontalAlignment(){return this.$c.Lrf(this.uz)}set horizontalAlignment(d){this.$c.Xdg(this.uz,d)}get parentRow(){return this.$c.d$l(this.uz,
this._context)}get parentTable(){return this.$c.Ejb(this.uz,this._context)}get rowIndex(){return this.$c.Ls(this.uz)}get shadingColor(){return this.$c.Zuf(this.uz)}set shadingColor(d){d=sc.a.hKa(d,"TableCell.ShadingColor",this._context);this.$c.Veg(this.uz,d)}get value(){return this.$c.Kwf(this.uz)}set value(d){this.$c.vfg(this.uz,d)}get verticalAlignment(){return this.$c.Lwf(this.uz)}set verticalAlignment(d){this.$c.yfg(this.uz,d)}get width(){return Jg.a.$5a(this.$c.XUd(this.uz))}get _Id(){return this._id}get _ReferenceId(){return this.yq?
this.Tq:null}deleteColumn(){const d=this.$c.r0(this.uz);this.sh.RB(d)&&sc.a.Tf();this.$c.WRh(this.uz)}deleteRow(){var d=this.Yc.Rf(this.uz);d.zb(15);d=this.jl.mag(d);this.$c.Xef(d)}getBorder(d){return this.LCa.create(this.uz,d,this._context)}getCellPadding(d){switch(d){case 1:return this.$c.XSd(this.uz);case 3:return this.$c.vUd(this.uz);case 0:return this.$c.mwf(this.uz);case 2:return this.$c.Wof(this.uz);default:return sc.a.qd(),null}}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){let d=
null;const m=this.Yc.Rf(this.uz);m.zb(14);this.F3.gda(m)||(d=this.jl.YQf(m,!1));return d?this.qba.create(d,this._context):null}insertColumns(d,m,A){const R=this.Yc.Rf(this.uz);R.zb(14);const da=this.$c.r0(this.uz);this.sh.RB(da)&&(v.ULS.sendTraceTag(20758723,369,15,"The table is complex table when insert columns"),sc.a.Tf());this.jl.RLb(R);this.$c.insertColumns(m,R,d,A,this._context)}insertRows(d,m,A){sc.a.ZVa(m,"TableCell.InsertRows()");const R=this.Yc.Rf(this.uz);R.zb(14);this.jl.mag(R);d=this.$c.insertRows(m,
R,d,A,this._context);this.jl.nag(R);return new Kw(R.currentNode,d,1,this._context,this.$c,this.sh)}setCellPadding(d,m){this.$c.setCellPadding(this.uz,d,m)}split(d,m){if(0>=d||32767<d||0>=m||63<m)v.ULS.sendTraceTag(521483540,369,15,"The row/column count exceeds the maxium column size"),sc.a.qd();const A={};A.rows=d;A.columns=m;this.$c.nJa(this.uz,A)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.uz,"TableCell")}getTypeName(){return"Microsoft.WordServices.TableCell"}invokePropertyGet(d){switch(d){case 8:return this.body;
case 6:return this.cellIndex;case 15:return this.columnWidth;case 12:return this.horizontalAlignment;case 4:return this.parentRow;case 3:return this.parentTable;case 5:return this.rowIndex;case 9:return this.shadingColor;case 7:return this.value;case 14:return this.verticalAlignment;case 16:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
m){switch(d){case 15:this.columnWidth=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number?");return;case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 9:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 7:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 14:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1007:return this.Rkl();case 1006:return this.Gll();case 1008:return this.PPc(m);case 1023:return this.VPc(m);case 1011:return this.Cca();case 1012:return this.Dca();case 1004:return this.MDm(m);case 1003:return this.SCf(m);case 1024:return this.z9c(m);
case 1005:return this.xRb(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Rkl(){this.deleteColumn();return null}Gll(){this.deleteRow();return null}PPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}VPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");return this.getCellPadding(d)}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}MDm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");this.insertColumns(m,A,d);return null}SCf(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");return this.insertRows(m,A,d)}z9c(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");this.setCellPadding(m,d);return null}xRb(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");this.split(m,d);return null}Vh(){this._KeepReference();
return null}Wh(){this._OnAccess();return null}}Object(y.a)(iz,"TableCell",ih.a,[841]);class uj{constructor(d,m,A,R,da,Ea,ib){this.$c=this.NN=null;this.Yc=d;this.LCa=m;this.jl=A;this.sh=da;this.Hma=Ea;this.qA=ib;R&&R.execute(Qb=>{null==Qb?v.ULS.sendTraceTag(523580865,324,10,"ITableCellReader is null after future execution"):this.F3=Qb})}Ju(d,m){this.$c=d;this.NN=m}create(d,m,A=0){return new iz(d,m,A,this,this.NN,this.Yc,this.LCa,this.jl,this.F3,this.$c,this.sh,this.Hma,this.qA)}}Object(y.a)(uj,"TableCellFactory",
null,[858]);var jz=c(573);class ux extends ih.a{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm,em,$n,Ep,Mm,Mk,gm,cl){super();sc.a.jKa(d,"Table");this.Zg=d;this._context=m;this._id=A;this.gB=Ea;this.$0b=R;this.qba=da;this.Yc=ib;this.Vn=Qb;this.tk=pc;this.LCa=Pc;this.om=gd;this.qA=Cd;this.sh=ae;this.$c=Xd;this.BC=se;this.nA=Xh;this.Ay=Xe;this.rba=Be;this.gb=Hg;this.jl=em;this.hd=Fl;this.Ig=Gm;this.iq=$n;this.WAa=Ep;this.Yk=Mm;this.tCa=Mk;this.pA=gm;this.Ow=cl}Mza(d){this.rba.Mza(d,
this.Zg)}get alignment(){return this.$c.sNl(this.Zg)}set alignment(d){this.$c.Rgo(this.Zg,d)}get endnotes(){var d=this.hd.X9b(this.Zg,1);d=this.hd.Gva(d,this._context);return new rs(d)}get fields(){return new iv(this.Ow.a$h(this.Zg,this._context,!1))}get font(){return this.gB.create(5,this.Zg,null,null,this._context)}get footnotes(){var d=this.hd.X9b(this.Zg,0);d=this.hd.Gva(d,this._context);return new rs(d)}get headerRowCount(){return this.qA.O2a(this.Zg)}set headerRowCount(d){var m=this.sh.gg(this.Zg);
if(0>d||d>m)v.ULS.sendTraceTag(20833941,369,15,"Invalid HeaderRowCount when set Table.HeaderRowCount."),sc.a.qd();var A=d;m=this.sh.Qx(this.Zg,0,m-1);for(const R of m)m=R.ja(wc.a.Ylb,!1),0<A?m||R.setValue(wc.a.Ylb,!0):m&&R.setValue(wc.a.Ylb,!1),A--;A=this.Ay.q0(this.Zg);this.Mza(d?A|32:A&-33)}get horizontalAlignment(){return this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.Lrf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(d){this.$c.Xdg(this.Zg,d)}get isUniform(){return!this.sh.RB(this.Zg)}get nestingLevel(){return this.$c.Hii(this.Zg)}get parentBody(){return this.$c.Qtf(this.Zg,
this._context)}get parentContentControl(){const d=this.parentContentControlOrNullObject;d||sc.a.Tk();return d}get parentContentControlOrNullObject(){const d=jd.a.create(this.gb.$k(this.Zg)),m=jd.a.create(this.gb.XC(this.Zg));this.hd.YJa(d,m);return this.Ig.eac(d,m,this._context)}get parentTable(){const d=this.parentTableOrNullObject;d||sc.a.Tk();return d}get parentTableCell(){const d=this.parentTableCellOrNullObject;d||sc.a.Tk();return d}get parentTableCellOrNullObject(){return this.$c.H$b(this.Zg,
this._context)}get parentTableOrNullObject(){return this.$c.Ejb(this.Zg,this._context)}get rowCount(){return this.sh.gg(this.Zg)}get rows(){return new Kw(this.Zg,null,0,this._context,this.$c,this.sh)}get shadingColor(){return this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.Zuf,"getShadingColorOfTableCellNode"),"")}set shadingColor(d){d=sc.a.hKa(d,"Table.ShadingColor",this._context);this.$c.Veg(this.Zg,d)}get style(){return this.pA.Jii(this.Zg)}set style(d){this.pA.poj(this.Zg,d)}get styleBandedColumns(){return this.Ay.q0(this.Zg)&
1024?!1:!0}set styleBandedColumns(d){let m=this.Ay.q0(this.Zg);this.Mza(d?m&-1025:m|1024)}get styleBandedRows(){return this.Ay.q0(this.Zg)&512?!1:!0}set styleBandedRows(d){let m=this.Ay.q0(this.Zg);this.Mza(d?m&-513:m|512)}get styleBuiltIn(){return this.pA.lhm(this.Zg)}set styleBuiltIn(d){this.pA.fpo(this.Zg,d)}get styleFirstColumn(){return this.Ay.q0(this.Zg)&128?!0:!1}set styleFirstColumn(d){let m=this.Ay.q0(this.Zg);this.Mza(d?m|128:m&-129)}get styleLastColumn(){return this.Ay.q0(this.Zg)&256?
!0:!1}set styleLastColumn(d){let m=this.Ay.q0(this.Zg);this.Mza(d?m|256:m&-257)}get styleTotalRow(){return this.Ay.q0(this.Zg)&64?!0:!1}set styleTotalRow(d){let m=this.Ay.q0(this.Zg);this.Mza(d?m|64:m&-65)}get tables(){return new ox(5,this.Zg,null,null,this._context,this.$c)}get values(){return this.$c.wki(this.Zg)}set values(d){this.$c.Qoj(this.Zg,d)}get verticalAlignment(){return this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.Lwf,"getVerticalAlignmentOfTableCellNode"),-1)}set verticalAlignment(d){this.$c.yfg(this.Zg,
d)}get width(){let d=0;({Ccd:d}=this.$c.iSc(this.Zg));return Jg.a.$5a(d)}set width(d){sc.a.ZVa(d,"Table.Width");var m;const A=({Ccd:m}=this.$c.iSc(this.Zg)).returnValue;var R=this.Yc.Rf(this.Zg);d=R.zb(14)?Math.min(Jg.a.Uya(d),this.$c.Hpf(R)):Jg.a.Uya(d);if(m)for(R=0;R<A.length;R++)this.WAa.lea(this.Zg,R,A[R]/m*d);else for(m=0;m<A.length;m++)this.WAa.lea(this.Zg,m,d/A.length)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}addColumns(d,m,A){this.sh.RB(this.Zg)&&(v.ULS.sendTraceTag(20758721,
369,15,"The table is complext table when add columns"),sc.a.Tf());const R=this.Yc.Rf(this.Zg);this.jl.RLb(R);switch(d){case 2:d=0;this.jl.G5d(R);break;case 3:d=1;this.jl.VQf(R);break;default:v.ULS.sendTraceTag(20758722,369,15,"AppId:{0}, Invalid insert location for Table.AddColumns method.",this._context.appId),sc.a.qd()}this.$c.insertColumns(m,R,d,A,this._context)}addRows(d,m,A){sc.a.ZVa(m,"Table.AddRows()");const R=this.Yc.Rf(this.Zg);switch(d){case 2:d=0;this.jl.RLb(R);break;case 3:d=1;this.jl.XQf(R);
break;default:v.ULS.sendTraceTag(20756128,369,15,"AppId:{0}, Invalid insert location for Table.Addrows method.",this._context.appId),sc.a.qd()}d=this.$c.insertRows(m,R,d,A,this._context);return new Kw(this.Zg,d,1,this._context,this.$c,this.sh)}autoFitWindow(){var d=this.Yc.Rf(this.Zg),m=0;d.zb(14)?m=this.$c.Hpf(d):d.zb(10)?(m=d.jo(10),m=Jg.a.tdd(this.Yk.ru(m)-this.Yk.CJ(m)-this.Yk.oL(m))):d.zb(38)&&(m=d.jo(38),m=this.tCa.Y$b(m),m=Jg.a.rxa(m.cKc/96));var A;d=({Ccd:A}=this.$c.iSc(this.Zg)).returnValue;
if(A)for(let R=0;R<d.length;R++)this.WAa.lea(this.Zg,R,d[R]/A*m);else for(A=0;A<d.length;A++)this.WAa.lea(this.Zg,A,m/d.length)}clear(){this.$c.CFh(this.Zg)}deleteObject(){this.$c.jU(this.Zg)}deleteColumns(d,m){null===m&&(m=1);var A=this.sh.hh(this.Zg);(0>d||0>=m||d+m>A)&&sc.a.qd();this.sh.RB(this.Zg)&&sc.a.Tf();if(m===A)this.$c.jU(this.Zg);else{A=this.Yc.Rf(this.Zg);this.jl.RLb(A);A=this.BC.AB(A.currentNode);for(let R=d;R<d+m;R++)this.$c.WRh(A.J(R))}}deleteRows(d,m){null===m&&(m=1);const A=this.sh.gg(this.Zg);
(0>d||0>=m||d+m>A)&&sc.a.qd();if(m===A)this.$c.jU(this.Zg);else{d=this.sh.Qx(this.Zg,d,d+m-1);for(const R of d)this.$c.Xef(R)}}distributeColumns(){this.sh.RB(this.Zg)&&sc.a.Tf();let d;const m=({Ccd:d}=this.$c.iSc(this.Zg)).returnValue;m.length&&d||sc.a.Tf();for(let A=0;A<m.length;A++)this.WAa.lea(this.Zg,A,d/m.length)}getBorder(d){return this.LCa.create(this.Zg,d,this._context)}getCell(d,m){(d=this.getCellOrNullObject(d,m))||sc.a.Tk();return d}getCellOrNullObject(d,m){if(0>d||0>m||d>=this.sh.gg(this.Zg)||
m>=this.sh.hh(this.Zg))return null;const A=this.Yc.Rf(this.Zg);return(d=this.jl.FQi(A,d,m))?this.qba.create(d,this._context):null}getCellPadding(d){switch(d){case 1:d=this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.XSd,"getLeftMarginOfTableCellNode"),-1);break;case 3:d=this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.vUd,"getRighttMarginOfTableCellNode"),-1);break;case 0:d=this.$c.mHb(this.Zg,Object(I.a)(this.$c,this.$c.mwf,"getTopMarginOfTableCellNode"),-1);break;case 2:d=this.$c.mHb(this.Zg,Object(I.a)(this.$c,
this.$c.Wof,"getBottomMarginOfTableCellNode"),-1);break;default:return sc.a.qd(),null}return-1===d?null:d}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){var d=this.Yc.Rf(this.Zg);return(d=this.jl.ggn(d))?this.$0b.create(d,this._context):null}getParagraphAfter(){const d=this.getParagraphAfterOrNullObject();d||sc.a.Tk();return d}getParagraphAfterOrNullObject(){const d=this.gb.Wf(this.Zg,!1,!0,!1);return d?this.Vn.create(d,this._context):null}getParagraphBefore(){const d=
this.getParagraphBeforeOrNullObject();d||sc.a.Tk();return d}getParagraphBeforeOrNullObject(){const d=this.gb.Wf(this.Zg,!0,!0,!0);return d?this.Vn.create(d,this._context):null}getRange(d){1!==d&&2!==d&&d&&4!==d&&(v.ULS.sendTraceTag(20506275,369,15,"AppId:{0}, rangeLocation of Table.GetRange must be Start/End/Whole/After.",this._context.appId),sc.a.qd());const m=this.gb.Hz(this.Zg,!0,!1);return(d=this.om.D9b(m,d))?this.tk.create(d,this._context):null}insertContentControl(){return this.Ig.Uma(this.hd.V5b(this.gb.$k(this.Zg),
!0),this.hd.V5b(this.gb.XC(this.Zg),!1),this._context)}insertParagraph(d,m){var A=!0;switch(m){case 0:m=1;break;case 1:m=0;A=!1;break;default:v.ULS.sendTraceTag(20509196,369,15,"The type of insert location is not supported in Table.InsertParagraph: {0}.",Wn[m]),sc.a.qd()}var R=this.gb.Wf(this.Zg,A,!1,!1),da=new U.a;da.add(jd.a.create(this.Zg));da=this.$c.HSd(da,A);A=da.node;if(R){let Ea;A=this.hd.insertParagraph((Ea=new U.a,Ea.add(da),Ea),d,m)}else R=new U.a,R.add(jd.a.Uc(A,0)),this.hd.insertText(R,
d,m);return this.Vn.create(A,this._context)}insertTable(d,m,A,R){const da=new U.a;da.add(jd.a.create(this.Zg));return this.$c.insertTable(da,d,m,A,R,this._context)}mergeCells(d,m,A,R){var da=this.Yc.Rf(this.Zg),Ea=this.Yc.Rf(this.Zg);const ib=this.sh.gg(this.Zg),Qb=this.sh.hh(this.Zg);if(d>=ib||0>d||0>m||m>=Qb||0>A||A>=ib||0>R||R>=Qb||A<d||R<m)v.ULS.sendTraceTag(521483542,369,15,"Invalid Index for {0} {1} {2} {3}",d,m,A,R),sc.a.qd();this.jl.moveToCell(da,d,m);this.jl.moveToCell(Ea,A,R);A=this.jl.getContainingTable(da);
Ea=this.sh.RB(A)?Pk.SelectionFactory.pOh(da,Ea):Pk.SelectionFactory.oOh(da,Ea);Ea=sh.a.h4b(Ea);Ea=jz.a.Qsf(Ea);32!==Ea.response&&(v.ULS.sendTraceTag(521483541,369,15,"get mergeCell context data fail"),sc.a.qd());this.$c.mergeCells(da.currentNode,Ea);da=this.Yc.Rf(this.Zg);this.jl.moveToCell(da,d,m);return da.currentNode?this.qba.create(da.currentNode,this._context):null}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.Zg,!0,!1);this.nA.find(R,d,m,A,this._context)})}_Search2(d,
m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.Zg,!0,!1);this.nA.rib(R,d,m,A,this._context)})}select(d){this.iq.Eza(this.Zg,d)}setCellPadding(d,m){this.$c.setCellPadding(this.Zg,d,m)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.Zg,"Table")}getTypeName(){return"Microsoft.WordServices.Table"}invokePropertyGet(d){switch(d){case 33:return this.alignment;case 38:return this.endnotes;case 39:return this.fields;case 24:return this.font;case 37:return this.footnotes;
case 12:return this.headerRowCount;case 22:return this.horizontalAlignment;case 4:return this.isUniform;case 6:return this.nestingLevel;case 32:return this.parentBody;case 25:return this.parentContentControl;case 36:return this.parentContentControlOrNullObject;case 8:return this.parentTable;case 7:return this.parentTableCell;case 34:return this.parentTableCellOrNullObject;case 35:return this.parentTableOrNullObject;case 11:return this.rowCount;case 3:return this.rows;case 18:return this.shadingColor;
case 10:return this.style;case 17:return this.styleBandedColumns;case 16:return this.styleBandedRows;case 31:return this.styleBuiltIn;case 14:return this.styleFirstColumn;case 15:return this.styleLastColumn;case 13:return this.styleTotalRow;case 5:return this.tables;case 9:return this.values;case 23:return this.verticalAlignment;case 27:return this.width;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 33:this.alignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 12:this.headerRowCount=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 22:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 18:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return;case 10:this.style=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 17:this.styleBandedColumns=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 16:this.styleBandedRows=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 31:this.styleBuiltIn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 14:this.styleFirstColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"boolean");return;case 15:this.styleLastColumn=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 13:this.styleTotalRow=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");return;case 9:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"Array<Array<string>>");return;case 23:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 27:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1004:return this.csk(m);case 1003:return this.svk(m);case 1012:return this.vJk();case 1008:return this.RDa();case 1007:return this.UD(m);case 1010:return this.Ukl(m);case 1009:return this.Ill(m);case 1014:return this.Xql();case 1015:return this.PPc(m);
case 1005:return this.iRl(m);case 1028:return this.lRl(m);case 1023:return this.VPc(m);case 1025:return this.Cca();case 1029:return this.Dca();case 1027:return this.k9l();case 1031:return this.l9l();case 1026:return this.n9l();case 1030:return this.o9l();case 1019:return this.Qoa(m);case 1020:return this.nGa(m);case 1022:return this.qpa(m);case 1021:return this.e4a(m);case 1006:return this.$cn(m);case 1017:return this.iea(m);case 1024:return this.z9c(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){switch(d){case 1018:return this.nra(m);case 1032:return this.Wka(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}csk(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");this.addColumns(m,A,d);return null}svk(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");return this.addRows(m,A,d)}vJk(){this.autoFitWindow();return null}RDa(){this.clear();return null}UD(){this.deleteObject();return null}Ukl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int?");this.deleteColumns(m,d);return null}Ill(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int?");this.deleteRows(m,d);return null}Xql(){this.distributeColumns();return null}PPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}iRl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getCell(m,d)}lRl(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.getCellOrNullObject(m,d)}VPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getCellPadding(d)}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}k9l(){return this.getParagraphAfter()}l9l(){return this.getParagraphAfterOrNullObject()}n9l(){return this.getParagraphBefore()}o9l(){return this.getParagraphBeforeOrNullObject()}Qoa(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getRange(d)}nGa(){return this.insertContentControl()}qpa(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this.insertParagraph(m,d)}e4a(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"Array<Array<string>>");return this.insertTable(m,A,R,d)}$cn(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"int");return this.mergeCells(m,A,R,d)}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}z9c(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"number");this.setCellPadding(m,d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}Koa(){return n.AFrameworkApplication.pu?this.Zg:null}}Object(y.a)(ux,"Table",ih.a,[841]);class vx{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh,Fl,Gm){this.$c=this.tk=this.Vn=null;this.qba=m;this.gB=d;this.Yc=A;this.LCa=R;this.qA=da;this.sh=Ea;this.BC=ib;this.Ay=Qb;this.rba=pc;this.gb=Pc;this.nA=gd;this.jl=se;this.hd=Cd;this.Ig=ae;this.om=Xd;this.iq=Xe;this.WAa=
Be;this.Yk=Hg;this.tCa=Xh;this.pA=Fl;this.Ow=Gm}Ju(d,m,A){this.$c=d;this.Vn=m;this.tk=A}create(d,m,A=0){return new ux(d,m,A,this,this.qba,this.gB,this.Yc,this.Vn,this.tk,this.LCa,this.om,this.qA,this.sh,this.$c,this.BC,this.Ay,this.rba,this.gb,this.nA,this.hd,this.Ig,this.jl,this.iq,this.WAa,this.Yk,this.tCa,this.pA,this.Ow)}}Object(y.a)(vx,"TableFactory",null,[858]);var So=c(193),kz=c(895),ov;(function(d){d[d.top=0]="top";d[d.left=1]="left";d[d.bottom=2]="bottom";d[d.right=3]="right"})(ov||(ov={}));
Object(y.b)("CellPaddingLocation",ov);class Ju{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se){this.NN=null;this.xDl=(Xe,Be)=>{const Hg=Xe.parentNode;return 35===Xe.currentNode.type||Hg&&14===Hg.type||Be&&Xe.A3a(Be)?!1:!0};this.gb=d;this.hd=m;this.jl=A;this.ga=R;this.Yc=da;this.iq=Ea;this.Hma=ib;this.F3=Qb;this.$0b=pc;this.Uyd=Pc;this.qba=gd;this.sh=Cd;this.BC=ae;this.rh=Xd;this.Ig=se}Ju(d){this.NN=d}insertTable(d,m,A,R,da,Ea,ib=!1){let Qb;Qb=this.pKj(da,m,A,R);let pc=this.HSd(d,Qb);pc||({JJ:pc}=
this.hd.mL(d.J(0),d.J(d.count-1),R,!0));pc=this.Ig.RJa(pc,d);let Pc;this.hd.ZT((Pc=new U.a,Pc.add(pc),Pc),R,1);m=this.vFm(pc,m,A,Qb,d,Ea,ib);ib&&this.iq.select(d,0);da&&this.Qoj(m,da,!0);return m?this.$0b.create(m,Ea):null}sti(d,m){d=this.Yc.Rf(d);d.zb(7);d.sc();this.rh.Oy(d,m,!0,null,!1,!1);d.Tb(2);return d.currentNode}HSd(d,m){var A=m?d.J(0):d.J(d.count-1);if(A.contextId!==ic.a.paragraph&&A.contextId!==ic.a.table)return null;A=A.node;const R=this.Yc.Rf(A);R.zb(7);if(14!==A.type){let da=null;if(!this.sh.mx(R))return null;
for(;this.sh.mx(R);){this.jl.nag(R);const Ea=this.gb.$k(R.currentNode),ib=this.gb.XC(R.currentNode);if(m?A.id.equals(Ea.id):A.id.equals(ib.id))for(const Qb of d){const pc=m?ib.id:Ea.id;if(Qb.contextId===ic.a.paragraph&&Qb.node.id.equals(pc)){da=R.currentNode;break}}else break}da&&(A=da)}return 14===A.type?this.wyf(A,m,!0):null}wyf(d,m,A){let R=this.gb.Wf(d,m,!1,!1);if(!R&&A||R&&14===R.type)R=this.sti(d,m);d=null;R&&(m?(d=jd.a.tw(R),0<this.gb.Ml(R,this.gb.textLength(R))?d.Fb=d.Sb=this.gb.uw(R):d.Fb=
d.Sb=-1):(d=jd.a.Uc(R,0),0<this.gb.Ml(R,0)?d.Fb=d.Sb=this.gb.ix(R):d.Fb=d.Sb=-1));return d}Hhm(d,m){const A=new U.a;d=this.sh.lwf(d);for(let R=0;R<d.count;R++)A.add(this.$0b.create(d.J(R),m,R));return A}Uii(d,m,A){const R=new U.a;d=this.Sim(d,m);for(m=0;m<d.count;m++)R.add(this.$0b.create(d.J(m),A,m));return R}Oii(d,m){const A=new U.a;for(let R=0;R<d.count;R++)A.add(this.Uyd.create(d.J(R),m,R));return A}bhm(d,m){const A=new U.a;d=this.BC.AB(d);for(let R=0;R<d.count;R++)A.add(this.qba.create(d.J(R),
m,R));return A}Ejb(d,m,A=null){if(!d)return null;!A||d.id.equals(A.id)?A=this.Vha(d,!0):(d=this.Yc.Rf(d),d.zb(14),A=this.Yc.Rf(A),A.zb(14),A=this.jl.v9n(d,A));return A?this.$0b.create(A,m):null}d$l(d,m){d=this.Yc.Rf(d);d.zb(15);return(d=d.jd(15))?this.Uyd.create(d,m):null}H$b(d,m,A=null){if(!d)return null;!A||d.id.equals(A.id)?A=this.Vha(d,!1):(d=this.Yc.Rf(d),d.zb(14),A=this.Yc.Rf(A),A.zb(14),A=this.jl.w9n(d,A));return A?this.qba.create(A,m):null}Ls(d){const m=this.Yc.Dk();m.set(d);m.zb(14);return this.BC.Ls(m)}gRl(d){const m=
this.Yc.Dk();m.set(d);m.zb(14);return this.Hma.cQc(m,!0)}Kwf(d){if(this.F3.$r(d))return null;const m=this.Yc.Dk();m.set(d);var A=m.Rd();for(d="";A;){A=m.SGa;var R=m.Rd();if(12===R.type)d+=this.gb.Wda(R),A||(d+="\r");else if(14===R.type){A=this.wki(R);R="";for(let da=0;da<A.length;da++){const Ea=A[da].length;for(let ib=0;ib<Ea;ib++)R+=A[da][ib],R=ib===Ea-1?R+"\r":R+"\t"}d+=R}m.sc();A=m.Oj()}return d}xki(d){const m=new U.a;for(const A of this.BC.AB(d))m.add(this.Kwf(A));return[m.toArray()]}wki(d){const m=
new U.a;for(const A of this.sh.Qx(d,0,this.sh.gg(d)-1))m.add(this.xki(A)[0]);return m.toArray()}vfg(d,m,A=!1){this.F3.$r(d)||(A||this.G8e(d),A=this.Yc.Dk(),A.set(d),A.Tb(1),A=A.Rd(),d=new U.a,A=jd.a.cR(0,this.gb.textLength(A),!1,A),d.add(A),this.hd.insertText(d,m,2))}xfg(d,m,A=!1){d=this.BC.AB(d);(!m||!m.length||d.count<m[0].length)&&sc.a.qd();let R=0;for(const da of d)R<m[0].length?this.vfg(da,m[0][R++],A):A||this.G8e(da)}Qoj(d,m,A=!1){const R=this.sh.gg(d);R<m.length&&sc.a.qd();let da=0;for(const Ea of this.sh.Qx(d,
0,R-1))da<m.length?this.xfg(Ea,[m[da++]],A):A||this.I8e(Ea)}G8e(d){if(!this.F3.$r(d)){d=this.gb.Hz(d,!0,!1);this.hd.ZJa(d.J(0));this.hd.ZJa(d.J(d.count-1));this.hd.ZT(d,4,2);var m=d.J(d.count-1);d.Z(d.count-1,jd.a.cR(0,this.gb.textLength(m.node),!1,m.node));d.J(d.count-1).Sb=m.Mn();1===d.count&&(d.J(d.count-1).Fb=m.Ln());this.hd.dLd(d)}}I8e(d){for(const m of this.BC.AB(d))this.G8e(m)}CFh(d){const m=this.sh.gg(d);for(const A of this.sh.Qx(d,0,m-1))this.I8e(A)}Xef(d){var m=this.r0(d);if(1===this.sh.gg(m))this.jU(m);
else{var A=So.TableNodeContext.create(d);d=this.iq.lRc(A);32!==this.ga.Mf(A,xe.a.deleteRow,2,!0,null,null)&&(m=this.sh.RB(m),v.ULS.sendTraceTag(20304155,369,10,"Commands.DeleteRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",m,!0),sc.a.Tf());this.iq.$dd(d)}}mergeCells(d,m){const A=this.r0(d),R=So.TableNodeContext.create(d);d=this.iq.lRc(R);32!==this.ga.Mf(R,xe.a.mergeCells,2,!0,null,m)&&(m=this.sh.RB(A),v.ULS.sendTraceTag(523319324,369,10,"Commands.mergeCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",
m,!0),sc.a.Tf());this.iq.$dd(d)}nJa(d,m){const A=this.r0(d),R=So.TableNodeContext.create(d);d=this.iq.lRc(R);32!==this.ga.Mf(R,xe.a.nJa,2,!0,null,m)&&(m=this.sh.RB(A),v.ULS.sendTraceTag(523319326,369,10,"Commands.splitCells Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",m,!0),sc.a.Tf());this.iq.$dd(d)}WRh(d){var m=this.r0(d);1===this.sh.hh(m)?this.jU(m):(d=So.TableNodeContext.create(d),m=this.iq.lRc(d),32!==this.ga.Mf(d,xe.a.deleteColumn,2,!0,null,null)&&(v.ULS.sendTraceTag(20304157,
369,10,"Commands.DeleteColumn Error."),sc.a.Tf()),this.iq.$dd(m))}jU(d){d=jd.a.create(d);const m=this.iq.lRc(d);32!==this.ga.Mf(d,xe.a.jU,2,!0,null,null)&&(v.ULS.sendTraceTag(20304159,369,10,"Commands.DeleteTable Error."),sc.a.Tf());this.iq.$dd(m)}Sim(d,m){const A=new U.a;var R=d.node,da=m.node;if(R.id.equals(da.id)){if(this.Wcc(d))return A;m=If.GraphIterator.eb(R);m.zb(14)&&(R=this.jl.mag(m),da=this.jl.Ipf(m),this.kHi(d,d,da,R)&&(d=this.jl.getContainingTable(m),A.add(d)));return A}let Ea,ib;const Qb=
({YZc:Ea,Iag:ib}=this.zQd(R,da)).returnValue,pc=Ea[Qb];switch(pc.type){case 14:return A.add(pc),A;case 15:return A.add(Ea[Qb-1]),A;case 16:if(this.kHi(d,m,pc,Ea[Qb-1]))return A.add(Ea[Qb-2]),A}this.mhm(R,da,Ea,ib,Qb,A);return A}U7h(d){let m=null;d=If.GraphIterator.eb(d);d.zb(14)&&(m=Df.getContainingTable(d));return m}zQd(d,m){d=this.Rib(d);m=this.Rib(m);for(let A=0;A<d.length&&A<m.length;++A)if(d[A]!==m[A])return{returnValue:A-1,YZc:d,Iag:m};return{returnValue:0,YZc:d,Iag:m}}kHi(d,m,A,R){const da=
d.node,Ea=m.node,ib=this.gb.$k(A);A=this.gb.XC(A);return 1!==this.BC.AB(R).count||this.Wcc(d)||this.Wcc(m)||ib!==da||A!==Ea?!1:!0}mhm(d,m,A,R,da,Ea){const ib=this.Iii(A,da+1);R=this.Iii(R,da+1);ib&&Ea.add(ib);d=If.GraphIterator.eb(d);d.zb(7);A=bf.a.Gs(d,A[da]);for(A.xo(this.xDl,ib);A.moveNext()&&!(14===A.currentNode.type&&Ea.add(A.currentNode),R&&A.currentNode===R||A.currentNode.id.equals(m.id)););}Iii(d,m){for(;m<d.length;++m)if(14===d[m].type)return d[m];return null}Wcc(d){return-1===d.cpBegin&&
-1===d.cpEnd&&d.contextId===ic.a.paragraph?!1:d.contextId===ic.a.Fd||d.contextId===ic.a.Vc||d.contextId===ic.a.Tc}Rib(d){const m=[],A=new If.GraphIterator;A.set(d);for(A.zb(7);A.sc();)m.push(A.currentNode);m.reverse();return m}vFm(d,m,A,R,da,Ea,ib=!0){const Qb=R?da.J(0):da.J(da.count-1);let pc=0,Pc=!1;if(ib){const gd=Qb.node;pc=this.gb.textLength(gd);gd.id.equals(d.node.id)&&(Pc=!0)}v.ULS.sendTraceTag(21263694,369,50,"AppId:{0}, Insert table with row number: {1}, column number : {2}",Ea.appId,m,A);
m=Object.assign(new kz.a,{rows:m,columns:A,Rdc:!0});32!==this.ga.Mf(d,xe.a.insertTable,2,!1,new kt.a,m)&&(v.ULS.sendTraceTag(19951683,369,10,"Commands.InsertTable failed"),sc.a.Tf());d=m.tableNode;this.wyf(d,R,!1);this.wyf(d,!R,!1);m=this.gb.Wf(d,!1,!1,!1);if(!ib)return d;switch(Qb.contextId){case ic.a.paragraph:R&&(Pc&&1<da.count&&!pc?da.removeAt(0):Pc&&(da.Z(0,jd.a.create(m)),this.hd.ZJa(da.J(0))));break;case ic.a.Vc:R&&(1<da.count?da.removeAt(0):(da.Z(0,jd.a.Uc(m,0)),this.hd.ZJa(da.J(0))));break;
default:R?(da.Z(0,Qb.contextId===ic.a.Tc?jd.a.Uc(m,0):jd.a.createTextRange(m,0,Qb.cpEnd-Qb.cpBegin)),1<da.count&&da.J(1).contextId===ic.a.Vc&&(da.Z(1,jd.a.tl(m)),da.J(1).Fb=da.J(1).Sb=Qb.Mn()),this.hd.ZJa(da.J(0),Qb)):1!==da.count||da.J(0).contextId!==ic.a.Tc||da.J(0).cpBegin||(da.Z(0,jd.a.Uc(this.gb.$k(d),0)),this.hd.ZJa(da.J(0)))}return d}Hii(d){let m=this.sh.LR(d)?1:0;d=this.Yc.Rf(d);for(d.zb(7);d.jd(14);)m++;return m}Zuf(d){return d.hasProperty(Me.a.WK)?$f.a.eF(d.getValue(Me.a.WK)).toUpperCase():
""}Veg(d,m){this.ga.Mf(jd.a.create(d),xe.a.F$,2,!0,new kt.a,m)}Lwf(d){switch(d.ja(wc.a.wJa,"top")){case "top":return 0;case "center":return 1;case "bottom":return 2;default:return-1}}yfg(d,m){switch(m){case 0:m=xe.a.RJf;break;case 1:m=xe.a.PJf;break;case 2:m=xe.a.LJf;break;default:v.ULS.sendTraceTag(20492683,369,15,"The argument for VerticalAlignment must be Top/Center/Bottom.");sc.a.qd();return}this.ga.Mf(jd.a.create(d),m,2,!0,new kt.a,{})}Lrf(d){d=this.gb.yw(d,!0,!1);const m=this.gb.Ox(d.J(0));
for(let A=1;A<d.count;A++)if(!m||m!==this.gb.Ox(d.J(A)))return-2;return this.GFi(m)}Xdg(d,m){switch(m){case 0:m=xe.a.OJf;break;case 1:m=xe.a.MJf;break;case 2:m=xe.a.QJf;break;case 3:m=xe.a.NJf;break;default:v.ULS.sendTraceTag(20492684,369,15,"The argument for HorizontalAlignment must be Left/Centered/Right/Justified.");sc.a.qd();return}this.ga.Mf(jd.a.create(d),m,2,!0,new kt.a,{})}sNl(d){d=this.sh.Ox(d);return this.GFi(d)}Rgo(d,m){switch(m){case 0:m=xe.a.I9;break;case 1:m=xe.a.Kba;break;case 2:m=
xe.a.z$;break;default:v.ULS.sendTraceTag(20807900,369,15,"The argument for Alignment must be Left/Centered/Right.");sc.a.qd();return}this.ga.Mf(jd.a.create(d),m,2,!0,new kt.a,{})}XSd(d){const m=this.r0(d).ja(wc.a.oS,.15);return Jg.a.$5a(d.ja(wc.a.oS,m))}vUd(d){const m=this.r0(d).ja(wc.a.LV,.15);return Jg.a.$5a(d.ja(wc.a.LV,m))}mwf(d){const m=this.r0(d).ja(wc.a.pVa,0);return Jg.a.$5a(d.ja(wc.a.pVa,m))}Wof(d){const m=this.r0(d).ja(wc.a.oVa,0);return Jg.a.$5a(d.ja(wc.a.oVa,m))}setCellPadding(d,m,A){if(0>
A||1584<A)v.ULS.sendTraceTag(20772256,369,15,"The cell padding value should be between 0 and 1584 in points."),sc.a.qd();A=Jg.a.Uya(A);switch(d.type){case 14:this.Hho(d,Ju.Qve[ov[m]],A);break;case 15:this.dlj(d,Ju.Qve[ov[m]],A);break;case 16:this.clj(d,Ju.Qve[ov[m]],A);break;default:v.ULS.sendTraceTag(20772257,369,10,"The graph node should be is table, table row or table cell."),sc.a.qd()}}Hho(d,m,A){d=this.sh.Qx(d,0,this.sh.gg(d)-1);for(const R of d)this.dlj(R,m,A)}dlj(d,m,A){d=this.BC.AB(d);for(const R of d)this.clj(R,
m,A)}clj(d,m,A){const R=this.XUd(d);m===wc.a.oS?A=Math.min(R-Jg.a.Uya(this.vUd(d)),A):m===wc.a.LV&&(A=Math.min(R-Jg.a.Uya(this.XSd(d)),A));d.setValue(m,A)}nHb(d,m,A){d=this.BC.AB(d);const R=m(d.J(0));for(let da=1;da<d.count;da++)if(R==A||R!=m(d.J(da)))return A;return R}mHb(d,m,A){d=this.sh.Qx(d,0,this.sh.gg(d)-1);let R="number"===typeof A?0:"boolean"===typeof A?!1:null;for(let da=0;da<d.count;da++){const Ea=this.BC.AB(d.J(da));for(let ib=0;ib<Ea.count;ib++){const Qb=m(Ea.J(ib));da+ib||(R=Qb);if(R==
A||R!=Qb)return A}}return R}r0(d){return this.Vha(d,!0)}Vha(d,m){if(!d)return null;d=this.Yc.Rf(d);return d.zb(14)?m?this.jl.getContainingTable(d):this.jl.Ipf(d):null}Rtf(d,m,A){return(d=this.Jei(d,m))?this.NN.create(d,A):null}Qtf(d,m){return(d=this.PTd(d))?this.NN.create(d,m):null}Jei(d,m){if(!d||!m)return null;if(d.id.equals(m.id))return this.PTd(d);m=({YZc:d}=this.zQd(d,m)).returnValue;d=d[m];switch(d.type){case 16:case 36:case 8:case 10:case 37:return d;default:return this.PTd(d)}}PTd(d){let m=
null;d=If.GraphIterator.eb(d);d.zb(16)?m=d.jo(16):d.zb(36)?m=d.jo(36):d.zb(10)?m=d.jo(10):d.zb(8)?(d.jd(8),1!==d.Wp()&&(m=d.currentNode)):sc.a.aPh()&&d.zb(38)&&(m=d.jo(38));return m}Hpf(d){d.zb(14);var m=this.jl.Ipf(d);this.Yc.Rf(m).zb(14);const A=this.jl.getContainingTable(d);d=this.XUd(m);const R=m.ja(wc.a.oS,A.ja(wc.a.oS,.15));m=m.ja(wc.a.LV,A.ja(wc.a.LV,.15));m=d-R-m;0>=m&&(v.ULS.sendTraceTag(20730644,369,15,"Cell content width is not valid"),sc.a.Tf());return m}iSc(d){d=this.Hma.eRd(d);let m=
0;if(this.xni(d))var A=0;else{for(A of d)m+=A;A=m}return{returnValue:d,Ccd:A}}XUd(d){var m=this.Yc.Rf(d);m.zb(14);m=this.Hma.cQc(m);var A=this.r0(d);A=this.Hma.eRd(A);d=d.ja(wc.a.colSpan,1);let R=0;for(;d;d--,m++)if(-1===A[m]){R=0;break}else R+=A[m];return R}GFi(d){switch(d){case 1:return 0;case 2:return 1;case 3:return 2;case 6:case 9:case 11:case 10:case 7:case 13:return 3;default:return-1}}insertColumns(d,m,A,R,da){var Ea=!1;switch(A){case 0:Ea=!0;break;case 1:Ea=!1;break;default:v.ULS.sendTraceTag(20758724,
369,15,"The type of insert location is undefined: {0}.",Wn[A]),sc.a.qd()}A=this.jl.getContainingTable(m);var ib=this.sh.gg(A);const Qb=this.sh.hh(A);if(0>=d||d>63-Qb)v.ULS.sendTraceTag(20758725,369,15,"The insert column count plus original column count exceeds the maxium column size"),sc.a.qd();if(R)for(R.length>ib&&(v.ULS.sendTraceTag(20758726,369,15,"The values size is larger than table row size"),sc.a.qd()),ib=0;ib<R.length;ib++)R[ib].length>d&&(v.ULS.sendTraceTag(20758727,369,15,"The values size is larger than table size"),
sc.a.qd());this.LDm(d,m,Ea,da);d=this.Hma.cQc(m);if(R)for(m=0;m<R.length;m++)for(da=d;da<d+R[m].length;da++)Ea=this.Yc.Rf(A),Ea=this.jl.FQi(Ea,m,da),this.vfg(Ea,R[m][da-d])}LDm(d,m,A,R){const da=A?xe.a.Mbc:xe.a.JIb,Ea=jd.a.create(m.currentNode);for(let ib=0;ib<d;ib++)32!==this.ga.Mf(Ea,da,2,!1,new kt.a,null)&&sc.a.Tf(),1<d&&(R.Jm.WH(),R.Jm.Iu(m.currentNode));if(A)for(A=0;A<d;A++)m.FJ();else m.Oj()}xni(d){for(const m of d)if(-1===m)return!0;return!1}insertRows(d,m,A,R){const da=m.jo(14);A=this.pKj(R,
d+this.sh.gg(da),this.BC.AB(m.currentNode).count,A);d=this.kFm(d,m,A);if(R)for(m=0;m<R.length;m++)this.xfg(d.J(m),[R[m]]);return d}kFm(d,m,A){const R=A?xe.a.Rkb:xe.a.d4a,da=new U.a;for(let ib=0;ib<d;ib++){var Ea=jd.a.create(m.currentNode);Ea=this.ga.Mf(Ea,R,2,!1,new kt.a,null);32!==Ea&&(Ea=this.sh.RB(this.jl.getContainingTable(m)),v.ULS.sendTraceTag(20756129,369,10,"Commands.InsertRow Error. Table is complex table? {0}. Unblock complex table is enabled? {1}",Ea,!0),sc.a.Tf());A?(m.FJ(),da.insert(0,
m.currentNode)):(m.Oj(),da.add(m.currentNode))}return da}pKj(d,m,A,R){if(32767<m||0>=m||0>=A||63<A)v.ULS.sendTraceTag(20756130,369,15,"Invalid Size for {0}","inserted row"),sc.a.qd();if(d)if(d.length>m)v.ULS.sendTraceTag(20756131,369,15,"The values size is larger than {0}'s size","inserted row"),sc.a.qd();else for(m=0;m<d.length;m++)d[m].length>A&&(v.ULS.sendTraceTag(20756160,369,15,"The values size is larger than {0}'s sizeinserted row"),sc.a.qd());d=!1;switch(R){case 0:d=!0;break;case 1:d=!1;break;
default:v.ULS.sendTraceTag(20756161,369,15,"The type of insert location is undefined: {0}.",Wn[R]),sc.a.qd()}return d}}Ju.Qve=lf.a.i6("left",wc.a.oS,"right",wc.a.LV,"top",wc.a.pVa,"bottom",wc.a.oVa);Object(y.a)(Ju,"TableOperations",null,[989]);class lz extends ih.a{constructor(d,m,A){super();this.kEc=null;this.fv=d;this._context=m;this.$c=A}length(){return this.kEc.count}get _ReferenceId(){return this.yq?this.Tq:null}getFirst(){const d=this.getFirstOrNullObject();d||sc.a.Tk();return d}getFirstOrNullObject(){this.CFj();
return this.kEc&&this.length()?this.kEc.J(0):null}_GetItem(d){d=sc.a.hQ(d);if(d<this.length())return this.kEc.J(d);v.ULS.sendTraceTag(19969491,369,10,"The index is out of the table cell collection range.");sc.a.qd();return null}_KeepReference(){this.rq()}_OnAccess(){}getAsyncEnumerator(d,m){this.CFj();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tq(d,m,this))}getTypeName(){return"Microsoft.WordServices.TableCellCollection"}invokePropertyGet(d){switch(d){case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.HG();case 1004:return this.IG();case 1:return this.XV(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}HG(){return this.getFirst()}IG(){return this.getFirstOrNullObject()}XV(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this._GetItem(d)}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}CFj(){this.kEc=this.$c.bhm(this.fv,this._context)}}Object(y.a)(lz,"TableCellCollection",ih.a,[841,857]);class $z extends ih.a{constructor(d,m,
A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg){super();sc.a.jKa(d,"TableRow");this.fv=d;this._context=m;this._id=A;this.gB=da;this.Uyd=R;this.Yc=Ea;this.LCa=ib;this.gb=Qb;this.jl=gd;this.$c=Pc;this.hd=pc;this.BC=Cd;this.nA=ae;this.iq=Xd;this.WAa=se;this.sh=Xe;this.Ow=Be;this.qba=Hg}get cellCount(){return this.BC.AB(this.fv).count}get cells(){return new lz(this.fv,this._context,this.$c)}get endnotes(){var d=this.hd.X9b(this.fv,1);d=this.hd.Gva(d,this._context);return new rs(d)}get font(){return this.gB.create(6,
this.fv,null,null,this._context)}get fields(){return new iv(this.Ow.b$h(this.fv,this._context,!1))}get footnotes(){var d=this.hd.X9b(this.fv,0);d=this.hd.Gva(d,this._context);return new rs(d)}get horizontalAlignment(){return this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.Lrf,"getHorizontalAlignmentOfTableCellNode"),-2)}set horizontalAlignment(d){this.$c.Xdg(this.fv,d)}get isHeader(){return this.BC.XWc(this.fv)}get parentTable(){return this.$c.Ejb(this.fv,this._context)}get preferredHeight(){return this.BC.aSc(this.fv)}set preferredHeight(d){sc.a.YVa(d,
"TableRow.PreferredHeight");this.WAa.ylc(this.fv,Jg.a.Uya(d))}get rowIndex(){return this.$c.Ls(this.fv)}get shadingColor(){return this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.Zuf,"getShadingColorOfTableCellNode"),"")}set shadingColor(d){d=sc.a.hKa(d,"TableRow.ShadingColor",this._context);this.$c.Veg(this.fv,d)}get values(){return this.$c.xki(this.fv)}set values(d){this.$c.xfg(this.fv,d)}get verticalAlignment(){return this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.Lwf,"getVerticalAlignmentOfTableCellNode"),
-1)}set verticalAlignment(d){this.$c.yfg(this.fv,d)}get _Id(){return this._id}get _ReferenceId(){return this.yq?this.Tq:null}clear(){this.$c.I8e(this.fv)}deleteObject(){this.$c.Xef(this.fv)}getBorder(d){return this.LCa.create(this.fv,d,this._context)}getCellPadding(d){switch(d){case 1:d=this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.XSd,"getLeftMarginOfTableCellNode"),-1);break;case 3:d=this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.vUd,"getRighttMarginOfTableCellNode"),-1);break;case 0:d=this.$c.nHb(this.fv,
Object(I.a)(this.$c,this.$c.mwf,"getTopMarginOfTableCellNode"),-1);break;case 2:d=this.$c.nHb(this.fv,Object(I.a)(this.$c,this.$c.Wof,"getBottomMarginOfTableCellNode"),-1);break;default:return sc.a.qd(),null}return-1===d?null:d}getNext(){const d=this.getNextOrNullObject();d||sc.a.Tk();return d}getNextOrNullObject(){var d=this.Yc.Rf(this.fv);d.zb(14);return(d=this.jl.$Qf(d))?this.Uyd.create(d,this._context):null}insertContentControl(){return null}insertRows(d,m,A){sc.a.ZVa(m,"TableRow.InsertRows()");
const R=this.Yc.Rf(this.fv);R.zb(14);d=this.$c.insertRows(m,R,d,A,this._context);this.jl.nag(R);return new Kw(R.currentNode,d,1,this._context,this.$c,this.sh)}merge(){const d=this.Yc.Rf(this.fv);this.jl.G5d(d);var m=Pk.SelectionFactory.uOh(this.fv);m=sh.a.h4b(m);m=jz.a.Qsf(m);32!==m.response&&(v.ULS.sendTraceTag(521483539,369,15,"get mergeCell context data fail"),sc.a.qd());this.$c.mergeCells(d.currentNode,m);return this.fv?this.qba.create(this.fv,this._context):null}search(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>
{const R=this.gb.Hz(this.fv,!0,!1);this.nA.find(R,d,m,A,this._context)})}_Search2(d,m){return OfficeExtension.WacRuntime.Utility.createPromise(A=>{const R=this.gb.Hz(this.fv,!0,!1);this.nA.rib(R,d,m,A,this._context)})}select(d){this.iq.Ado(this.fv,d)}setCellPadding(d,m){this.$c.setCellPadding(this.fv,d,m)}_KeepReference(){this.rq()}_OnAccess(){sc.a.o2(this.fv,"TableRow")}getTypeName(){return"Microsoft.WordServices.TableRow"}invokePropertyGet(d){switch(d){case 4:return this.cellCount;case 3:return this.cells;
case 20:return this.endnotes;case 21:return this.fields;case 14:return this.font;case 19:return this.footnotes;case 12:return this.horizontalAlignment;case 16:return this.isHeader;case 5:return this.parentTable;case 17:return this.preferredHeight;case 6:return this.rowIndex;case 8:return this.shadingColor;case 7:return this.values;case 13:return this.verticalAlignment;case 1:return this._Id;case 2:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,m){switch(d){case 12:this.horizontalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return;case 17:this.preferredHeight=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"number");return;case 8:this.shadingColor=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return;case 7:this.values=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"Array<Array<string>>");return;case 13:this.verticalAlignment=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1006:return this.RDa();case 1005:return this.UD(m);case 1009:return this.PPc(m);case 1023:return this.VPc(m);case 1012:return this.Cca();
case 1013:return this.Dca();case 1025:return this.nGa(m);case 1003:return this.SCf(m);case 1004:return this.qdn();case 1007:return this.iea(m);case 1024:return this.z9c(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,m){switch(d){case 1008:return this.nra(m);case 1026:return this.Wka(m)}d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}RDa(){this.clear();
return null}UD(){this.deleteObject();return null}PPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getBorder(d)}VPc(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.getCellPadding(d)}Cca(){return this.getNext()}Dca(){return this.getNextOrNullObject()}nGa(){return this.insertContentControl()}SCf(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"Array<Array<string>>");return this.insertRows(m,A,d)}qdn(){return this.merge()}nra(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,zh.a);return this.search(m,d)}Wka(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int");return this._Search2(m,
d)}iea(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");this.select(d);return null}z9c(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"number");this.setCellPadding(m,d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)($z,"TableRow",ih.a,[841]);class Js{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae){this.$c=null;this.gB=d;this.Yc=
m;this.LCa=A;this.gb=R;this.hd=da;this.jl=Ea;this.BC=ib;this.nA=Qb;this.iq=pc;this.WAa=Pc;this.sh=gd;this.Ow=Cd;this.qba=ae}Ju(d){this.$c=d}create(d,m,A=0){return new $z(d,m,A,this,this.gB,this.Yc,this.LCa,this.gb,this.hd,this.$c,this.jl,this.BC,this.nA,this.iq,this.WAa,this.sh,this.Ow,this.qba)}}Object(y.a)(Js,"TableRowFactory",null,[858]);var bB=c(1166),JC=c(107);class ZB{constructor(d,m,A,R){this.Ig=d;this.gb=m;this.Vd=A;this.GD=R}vRl(){return this.Vd.QV?1:this.Vd.KJa?2:0}Mho(d,m){const A=bB.a.menuItemId,
R={};switch(m){case 0:R[A]=JC.a.lqc;break;case 1:R[A]=JC.a.kqc;break;case 2:R[A]=JC.a.ZTb}32!==d.Qb(Ac.a.Mea,2,R)&&(v.ULS.sendTraceTag(545043662,369,10,"BuildspkgCommands.updateTrackChangeStatus Error."),sc.a.Tf())}yuf(d,m,A,R){if(12!=d.type)return"";if(!this.GD.B$e(d,A,R))return this.aUd(d,A,R);const da=this.GD.BQa(d,A,R);let Ea="";for(const ib of da)2==ib.Kd.changeType?1==m&&(A<ib.Bd&&(Ea+=this.aUd(d,A,ib.Bd)),A=ib.endCp):1==ib.Kd.changeType&&0==m&&(A<ib.Bd&&(Ea+=this.aUd(d,A,ib.Bd)),A=ib.endCp);
A<R&&(Ea+=this.aUd(d,A,R));return Ea}uUd(d,m){let A=this.yuf(d,m,0,this.gb.textLength(d));d.ra.last.Lh&&1==m||d.ra.last.zi&&0==m||(A+=sc.a.Dmb);return A}xcm(d,m){let A="";const R=d.start,da=d.end;return R&&da?A=d.Of?this.YNl(R,da,m):A+this.yuf(R.node,m,R.cpBegin,da.cpEnd):A}YNl(d,m,A){let R="";d=this.Ig.uU(d,m);for(const da of d)R+=this.uUd(da,A);return R}aUd(d,m,A){m={Bd:m,endCp:A};return""+this.gb.M6a(d,void 0,m).substring(m.Bd,m.endCp)}}Object(y.a)(ZB,"TrackChangesOperations",null,[988]);var Lw=
c(1414);class qm{constructor(d,m,A){this.Cwc=new vb.a;this.Srd=[];this.Izc=[];this.gvd=new Map;this.xse=null;this.RUg=d;this.cXb=m;this.qRe=A;this.Rvm()}get hfa(){!this.xse&&Ab.App&&sf.StaticActiveAppFrame.za()&&sf.StaticActiveAppFrame.za().jb&&sf.StaticActiveAppFrame.za().jb.Zc&&sf.StaticActiveAppFrame.za().jb.Zc.contentReplicator&&(this.xse=sf.StaticActiveAppFrame.za().jb.Zc.contentReplicator);return this.xse}get px(){var d,m;return null===(m=null===(d=sf.StaticActiveAppFrame.za())||void 0===d?
void 0:d.jb)||void 0===m?void 0:m.Zc}get fd(){return this.hfa&&2===this.hfa.enabled?"Remote":"Local"}Txk(d){this.Cwc.addHandler(qm.kUi,d)}grh(d){this.Cwc.addHandler(qm.SVf,d)}i2n(d){this.Cwc.removeHandler(qm.SVf,d)}fireEvent(d,m){try{const A=this.RUg.Gci(d);if(!A)return null;const R=this.Lhm(d);if(0!==R.length){this.Cwc.raiseEvent(qm.SVf,{eventType:d});for(const da of R){const Ea=A.KJd(d,m,da);Ea&&this.ZLn(da,Ea)}this.qRe.Ton()}}catch(A){throw this.H5m(A,{eventType:d}),A;}}ZLn(d,m){let A=this.gvd.get(d);
A||(A=[],this.gvd.set(d,A));A.push(m)}Rvm(){sc.a.tva()&&(this.qRe.Qz(this.EBk.bind(this)),this.qRe.$Yn(),this.bXd=this.bXd.bind(this),this.grh(this.bXd))}bXd(){this.hfa&&(this.hfa.s0e(this.Ceo.bind(this)),Lw.a.instance.ACd(this.Cwl.bind(this)),this.i2n(this.bXd))}Cwl(){0!==this.Srd.length&&(this.Izc=this.Izc.concat(this.Srd),this.Srd=[])}Ceo(){if(0!==this.Izc.length){for(const d of this.Izc)this.Pjj(d);this.Izc=[]}}EBk(){this.Cwc.raiseEvent(qm.kUi);for(const d of this.gvd.values()){for(let m=1;m<
d.length;m++){const A=d[m-1],R=d[m];this.dhn(A,R)?this.RUg.Gci(R.eventType).t1e(A.eventData,R.eventData)||this.Acg(A):this.Acg(A)}this.Acg(d[d.length-1])}this.gvd.clear()}dhn(d,m){return d.eventType===m.eventType}Acg(d){d&&(this.hfa&&!this.hfa.dE()?this.Pjj(d):this.Srd.push(d))}Pjj(d){this.cXb.fireEvent(d.vnc,d.eventType,d.eventData)}H5m(d,m=null){d={["ErrMsg"]:d.message,["ErrStack"]:d.stack};m&&(d.ExtendMsg=m);v.ULS.sendTraceTag(523072988,369,50,"Exception in event: {0}",d)}Lhm(d){var m;const A=
[],R=null!==(m=this.cXb.m_eventIdControlMapByTarget)&&void 0!==m?m:{};for(const da of Object.keys(R))R[da][d]&&A.push(da);return A}}qm.kUi="BAE";qm.SVf="BFE";Object(y.a)(qm,"RichApiEventManager",null,[987]);class Ft{constructor(d){this.w$e=new Map;d.execute(m=>{this.iba=m;this.cXd()})}xEi(){return!1}uof(){return null}zEi(){return!1}cXd(){}yEi(d,m){if(!d)return!0;if(d instanceof jv)return this.qXm(d,m);if(this.zEi(d,m))return!0;d=this.o_l(d);return 0===d.count?!1:this.pXm(d,m)}pXm(d,m){for(const A of d)if(this.xEi(m,
A))return!0;return!1}qXm(d,m){var A=!1;switch(d.type){case 0:A=!0;break;case 1:case 4:A=this.uof(m,!0),m=this.uof(m,!1),A=this.zBi(A,d.Nxh)?!0:this.zBi(m,d.Nxh)}return A}zBi(d,m){if(!d)return!1;d=If.GraphIterator.eb(d);return d.zb(m.type)&&(d.jd(m.type),d.currentNode.equals(m))?!0:!1}o_l(d){return d instanceof Jw?(d=d.Koa(),d=new U.a([jd.a.create(d)])):d instanceof mt?(d.oXo(),d=d.Xp):d instanceof Yy&&d.isValid()?d=d.a$b():new U.a}N2d(d,m=0){!0!==this.w$e.get(d)&&(m=new $a.a(5,1,m,()=>{this.w$e.set(d,
!1);this.U6i(d)}),this.w$e.set(d,!0),n.AFrameworkApplication.lc.Wb(m))}U6i(){}}Object(y.a)(Ft,"AEventMessageManager",null,[860]);var ly=c(613),aA=c(1787);class pv{constructor(){this.replyIds=[]}Ioh(d){d.Df?this.addReply(d):this.addComment(d)}addReply(d){this.replyIds.push(d.H1a);this.id||(this.id=aA.a.getInstance().XWl(d.Df))}addComment(d){this.id=d.H1a}}Object(y.a)(pv,"CommentDetailInternal",null,[]);var Ku=c(1535);class my extends Ft{constructor(d,m){super(d);this.pSe=new Map;this.yrd=new Map;this.Ala=
m}KJd(d,m,A){const R=m.comment,da=Iq.a.instance.OOd(A);if(da){var Ea=this.PSl(R);if(this.yEi(da,Ea)&&(8!==d||!this.Ftm(A))&&(m=this.wRl(d,m)))return this.Adl(R,A,d,m)}}t1e(d,m){if(d.changeType!==m.changeType)return!1;m.commentDetails=d.commentDetails.concat(m.commentDetails);return!0}cXd(){this.iba.Txk(this.OYo.bind(this));this.iba.grh(this.DZk.bind(this))}xEi(d,m){switch(m.contextId){case ic.a.Fd:return this.pKm(d,m);case ic.a.paragraph:return this.oKm(d,m)}return!1}uof(d,m){return this.Ala.xd.Eb(m?
Eu.k(d):Eu.h(d))}OYo(){for(const d of this.yrd.values())this.c8k(d.eventData);this.yrd.clear()}Adl(d,m,A,R){var da,Ea=null!==(da=d.Df)&&void 0!==da?da:d.id;da=m+"_"+A+"_"+R+"_"+Ea;if(Ea=this.yrd.get(da))return Ea=Ea.eventData.commentDetails[0],Ea.Ioh(d),null;Ea=new pv;Ea.Ioh(d);Ea={vnc:m,eventType:A,eventData:{source:this.iba.fd,commentDetails:[Ea],changeType:R}};this.yrd.set(da,Ea);return Ea}DZk(d,m){m.eventType&&9===m.eventType&&(this.pSe=new Map)}Ftm(d){return this.pSe.get(d)?!0:(this.pSe.set(d,
!0),!1)}PSl(d){return this.Ala.xd.Eb(d.objectId)}wRl(d,m){if(10!==d)return"none";if(m.changeType)return m.changeType;d=m.comment;m=m.ETi;return d.done!==m.done?d.done?"resolved":"reopened":this.EUm(d.text[0],m.text[0])?null:d.Df?"replyEdited":"edited"}c8k(d){const m=d.commentDetails[0];d.commentDetails[0]={id:m.id,replyIds:m.replyIds}}EUm(d,m){return this.uKh(d)===this.uKh(m)}uKh(d){d=it.a.hGb(d).ops;let m="";for(const A of d)m+=this.thi(A);return m}thi(d){let m="";const A=["insert","attributes",
"optional"];for(const R of Object.keys(d)){const da=d[R];A.includes(R)||(m+=R);m=da instanceof Object?m+this.thi(da):m+da}return m}pKm(d,m){var A=new ly.a;A.add(d.id.toString());d=Ku.a.fQc(m.node,m.cpBegin,!0,A);A=(A=Ku.a.fQc(m.node,m.cpBegin,!1,A))&&A.Lb.cp<=m.cpEnd;return d&&d.Lb.cp<=m.cpEnd||A}oKm(d,m){const A=Eu.k(d);d=Eu.h(d);m=m.node;return A===m.id||d===m.id}}Object(y.a)(my,"CommentEventMessageManager",Ft,[860]);class Mw extends Ft{constructor(d,m,A,R,da,Ea){super(d);this.M0a=m;this.VCb=A;
this.mb=R;this.FX=da;this.W$e=Ea;this.Z4k=400;this.U2f=[];this.t5b=new Map}cXd(){if(sc.a.xJh()){this.M0a.addHandler(Xl.a.contentChanged,this.onContentChanged.bind(this));this.mb.Xw(this.WY.bind(this));var d=Ab.App.li.Al;d&&(d.Te(12).qo(this.IP.bind(this)),d.Te(55).ku((m,A)=>{this.c2c(A.node,!1)}),d.Te(55).pO((m,A)=>{this.c2c(A.node,!0)}))}}t1e(d,m){m.ids=d.ids.concat(m.ids);return!0}KJd(d,m,A){m=m.nodeId?this.VCb.qu(m.nodeId):m.node;const R=this.Lpf(m),da=Iq.a.instance.OOd(A);if(this.yEi(da,m))if(0===
d&&this.t5k(m.id))this.iba.fireEvent(0,{node:m});else return{eventType:d,eventData:{source:this.iba.fd,ids:[R]},vnc:A}}zEi(d,m){return d instanceof Yy?this.Lpf(m)===d.id:!1}WY(d,m){if(d=m.yl.lb){d=this.FX.e8h(d);for(const A of d)this.X_e(1,A),this.U2f.includes(A)||this.iba.fireEvent(12,{nodeId:A});for(const A of this.U2f)d.includes(A)||(this.iba.fireEvent(13,{nodeId:A}),this.X_e(1,A));this.U2f=d}}onContentChanged(d,m){this.X_e(2,m.me)}X_e(d,m){this.t5b.get(d)||this.t5b.set(d,new Set);this.t5b.get(d).add(m);
this.N2d(d,this.Z4k)}U6i(d){const m=this.t5b.get(d);if(m){for(const A of m)this.iba.fireEvent(d,{nodeId:A});this.t5b.set(d,new Set)}}t5k(d){let m=!1;for(const [A,R]of this.t5b)R.has(d)&&(this.iba.fireEvent(A,{nodeId:d}),R.delete(d),m=!0);return m}IP(d,m){if(m.property===Me.a.ho&&"Remote"===this.iba.fd){d=jd.a.create(m.node);d=this.W$e.Nei(d,d);for(const A of d)this.iba.fireEvent(2,{node:A.contentControlNode})}}c2c(d,m){var A,R;null!==(A=this.iba.px)&&void 0!==A&&A.xd.id.equals(d.Mc.id)&&d&&0!==this.Lpf(d)&&
(null===(R=this.iba)||void 0===R?void 0:R.fireEvent(m?0:3,{node:d}))}Lpf(d){return d.ja(wc.a.$w,0)}}Object(y.a)(Mw,"ContentControlEventMessageManager",Ft,[860]);class KC{constructor(d,m,A){this.m2k=d;this.MUk=m;this.gsl=A}Gci(d){let m=null;switch(d){case 11:case 10:case 7:case 8:case 9:m=this.m2k;break;case 3:case 1:case 2:case 0:case 12:case 13:m=this.MUk;break;case 14:m=this.gsl}return m}}Object(y.a)(KC,"EventMessageManagerMapper",null,[]);var wx=c(1427),mz=c(291);class $B extends wx.a{constructor(){super()}get index(){return 5}run(){this.PVj()}$Yn(){mz.GraphTransactionManager.instance.pra(this,
3)}Qz(d){this.PVj=d}Ton(){this.TY()}}Object(y.a)($B,"RichApiEventTransactionCompletedProcessor",wx.a,[]);class ik extends ih.a{constructor(d,m,A){super();this._context=d;this.Mk=m;this.P2=A}get id(){return this.P2.id}get namespaceUri(){return this.P2.namespace}get _ReferenceId(){return this.yq?this.Tq:null}deleteObject(){this.fgb();this.Mk.FRh(this.id)!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&sc.a.qd()}deleteAttribute(d,m,A){this.fgb();d=this.IHb(m,d);d=this.Ppb(d);1!==d.length&&sc.a.qd();
d[0].removeAttribute(A);this.P2.save()}deleteElement(d,m){this.fgb();d=this.IHb(m,d);d=this.Ppb(d);1!==d.length&&sc.a.qd();d[0].parentNode.removeChild(d[0]);this.P2.save()}getXml(){return this.P2.jWa}insertAttribute(d,m,A,R){this.fgb();d=this.IHb(m,d);d=this.Ppb(d);1!=d.length&&sc.a.qd();d[0].setAttribute(A,R);this.P2.save()}insertElement(d,m,A,R){this.fgb();d=this.IHb(A,d);d=this.Ppb(d);1!==d.length&&sc.a.qd();R||0===R?R>d[0].childNodes.length&&sc.a.qd():R=d[0].childNodes.length;m=new OSF.XmlProcessor(m,
"");d[0].insertBefore(m.getDocumentElement(),R===d[0].childNodes.length?null:d[0].childNodes[R])||sc.a.qd();this.P2.save()}query(d,m){d=this.IHb(m,d);d=this.Ppb(d,!1);m=[];if(d)for(let A=0;A<d.length;A++){const R=this.P2.getNodeXml(d[A]);m.push(R)}return m}setXml(d){this.fgb();const m=this.Ppb("/",!1);m&&(this.P2.setNodeXml(m[0].firstChild,d)||sc.a.qd())}updateAttribute(d,m,A,R){this.fgb();d=this.IHb(m,d);d=this.Ppb(d);1!==d.length&&sc.a.qd();d[0].hasAttribute(A)?d[0].setAttribute(A,R):sc.a.qd();
this.P2.save()}updateElement(d,m,A){this.fgb();d=this.IHb(A,d);d=this.Ppb(d);1!==d.length&&sc.a.qd();this.P2.setNodeXml(d[0],m)||sc.a.qd()}IHb(d,m){const A=Object.keys(d);for(let R=0;R<A.length;R++){const da=A[R],Ea=this.P2.uRc(d[da]);Ea&&(m=m.replace("/"+da+":","/"+Ea+":"))}return m}Ppb(d,m=!0){let A;try{A=this.P2.selectNodes(d,null)}catch(R){m&&sc.a.qd()}m&&!A&&sc.a.qd();return A}fgb(){this.P2.builtIn&&sc.a.qd()}_KeepReference(){this.rq()}_OnAccess(){this._context.Jm.M4b(this.Mk.fha.currentNode);
this.P2.uGf()||this.P2.Hqg();sc.a.o2(this.P2.customXmlPartNode,"CustomXmlPart")}getTypeName(){return"Microsoft.WordServices.CustomXmlPart"}invokePropertyGet(d){switch(d){case 2:return this.id;case 3:return this.namespaceUri;case 1:return this._ReferenceId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,m){this.invokePropertySet(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,m){switch(d){case 1003:return this.UD(m);case 1012:return this.Jkl(m);case 1009:return this.ell(m);case 1004:return this.$lm();case 1010:return this.BDm(m);case 1007:return this.YDm(m);case 1006:return this.DMn(m);case 1005:return this.jqo(m);case 1011:return this.PUo(m);case 1008:return this.AWo(m);case 1002:return this.Vh();case 1001:return this.Wh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,m){d=this.invokeMethod(d,m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}UD(){this.deleteObject();return null}Jkl(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");this.deleteAttribute(m,A,d);return null}ell(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");this.deleteElement(m,d);return null}$lm(){return this.getXml()}BDm(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");this.insertAttribute(m,A,R,d);return null}YDm(d){const m=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"any");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"int?");this.insertElement(m,A,R,d);return null}DMn(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any");return this.query(m,
d)}jqo(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.setXml(d);return null}PUo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"any"),R=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"string");this.updateAttribute(m,A,R,d);return null}AWo(d){const m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"string"),A=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"any");this.updateElement(m,A,d);return null}Vh(){this._KeepReference();return null}Wh(){this._OnAccess();return null}}Object(y.a)(ik,"CustomXmlPart",ih.a,[841]);class aC{constructor(d){this.Mk=d}Ju(){}create(d,m){return new ik(m,this.Mk,d)}}Object(y.a)(aC,"CustomXmlPartFactory",null,[858]);class bA extends Ft{constructor(d,m){super(d);this.LTb=m;this.Mda=
(A,R)=>{this.iba.fireEvent(14,{wordCount:R.state.wordCount})}}KJd(d,m,A){return{eventType:d,eventData:{source:this.iba.fd,wordCount:m.wordCount},vnc:A}}t1e(){return!0}cXd(){this.LTb?this.LTb.dfb(this.Mda):v.ULS.sendTraceTag(508826838,2250,10,"DocumentEventMessageManager.hookupToRichApiEvtManager: WordCountManager is not initialized yet!")}}Object(y.a)(bA,"DocumentEventMessageManager",Ft,[860]);class nt{constructor(){this.W=null}get name(){return"WordEditor.Extension"}init(){if(yj.App.cfd){this.W.resolve("WordEditor.Extension.RichApiEventManager");
var d=this.W.resolve("WordEditor.Extension.ContentControlFactory"),m=this.W.resolve("WordEditor.Extension.ContentControlOperations"),A=this.W.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),R=this.W.resolve("WordEditor.Extension.InlinePictureFactory"),da=this.W.resolve("WordEditor.Extension.ParagraphFactory"),Ea=this.W.resolve("WordEditor.Extension.RangeFactory"),ib=this.W.resolve("WordEditor.Extension.SelectionApiHelper"),Qb=this.W.resolve("WordEditor.Extension.TableFactory"),pc=
this.W.resolve("WordEditor.Extension.TableRowFactory"),Pc=this.W.resolve("WordEditor.Extension.TableCellFactory"),gd=this.W.resolve("WordEditor.Extension.FileApiOperations"),Cd=this.W.resolve("WordEditor.Extension.InsertApiOperations"),ae=this.W.resolve("WordEditor.Extension.TableOperations"),Xd=this.W.resolve("WordEditor.Extension.TrackChangesOperations"),se=this.W.resolve("WordEditor.Extension.ListOperations"),Xe=this.W.resolve("WordEditor.Extension.ListFactory"),Be=this.W.resolve("WordEditor.Extension.ListItemFactory"),
Hg=this.W.resolve("WordEditor.Extension.FieldFactory"),Xh=this.W.resolve("WordEditor.Extension.NoteItemFactory"),Fl=this.W.resolve("WordEditor.Extension.BodyFactory"),Gm=this.W.resolve("WordEditor.Extension.SectionFactory"),em=this.W.resolve("WordEditor.Extension.StyleApiHelper"),$n=this.W.resolve("WordEditor.Extension.CommentOperations"),Ep=this.W.resolve("WordEditor.Extension.CommentFactory"),Mm=this.W.resolve("WordEditor.Extension.CommentReplyFactory"),Mk=this.W.resolve("WordEditor.Extension.CommentContentRangeFactory"),
gm=this.W.resolve("WordEditor.Extension.FieldOperations");d.Ju(da,Ea,R,m,ae,Xd,gm);R.Ju(da,Ea);ib.Ju(ae);A.Ju(Ea);Hg.Ju(Ea,gm,ae,m,Cd,ib);da.Ju(Ea);gd.Ju(Ea,m,Gm);Cd.Ju(m,ae);Qb.Ju(ae,da,Ea);Xe.Ju(se,da);pc.Ju(ae);Pc.Ju(ae,Fl);Be.Ju(da);Xh.Ju(Fl,Ea,Cd);ae.Ju(Fl);Fl.Ju(Gm);em.Ju(ae);Ep.Ju(Ea,$n);Mm.Ju(Ep,$n,Mk);Mk.Ju($n)}}dispose(){}wc(d){this.W=d;d.ia("WordEditor.Extension.ExtensionFindManagerFactory",()=>new Di(new ff.a,new Lm.a,IA.a.instance,new Pd.a(()=>n.AFrameworkApplication.lc))).ha();d.ia("WordEditor.Extension.ExtensionFindStatusManagerFactory",
()=>new rx).ha();d.ia("WordEditor.Extension.SearchExecutor",()=>new $A(Km.a.createQuery,d.resolve("WordEditor.Extension.ExtensionFindManagerFactory"),d.resolve("WordEditor.Extension.ExtensionFindStatusManagerFactory"),new ff.a)).ha().as("WordEditor.Extension.ISearchExecutor");d.ia("WordEditor.Extension.ContentControlOperations",()=>new fy(d.resolve("WordEditor.ContentControl.IContentControlManager"),d.Oa("Box4.IContentControlDataChangedManager"),d.resolve("WordEditor.Extension.ContentControlFactory"),
d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IContentControlCharacterPropertiesEditor"),d.resolve("Box4.ContentControl.IContentControlOperator"),()=>d.Oa("Box4.IContentControlConverter"),d.resolve("Box4.IContentControlChpHelper"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IOutlineElementNavigator"),d.resolve("WordEditor.Extension.ISelectionApiHelper"))).ha().as("WordEditor.Extension.IContentControlOperations");d.ia("WordEditor.Extension.ListOperations",()=>new VB(d.resolve("Box4.IParagraphReader"),
d.resolve("WordEditor.Extension.ListFactory"),d.resolve("Box4.List.IListReader"),d.resolve("Box4.List.IListEditor"),d.resolve("Box4.IListMarkerUtility"),d.resolve("Box4.List.ListItemEditor"))).ha().as("WordEditor.Extension.IListOperations");d.ia("WordEditor.Extension.RangeOperations",()=>new Wv(d.resolve("Box4.IParagraphReader"),n.AFrameworkApplication.va,d.resolve("Box4.HyperlinkEditor"))).ha().as("WordEditor.Extension.IRangeOperations");d.ia("WordEditor.Extension.ExtensionImageStewardFactory",()=>
new Vz(d.resolve("WordEditor.IImageEditor"),n.AFrameworkApplication.lc,d.resolve("Box4.IUndoManager"),d.Oa("Box4.IFeatureHelper"))).ha();d.ia("WordEditor.Extension.ImageApiOperations",()=>new SB(d.resolve("Box4.BlobReaderProxy"),d.resolve("Box4.Images.ImageReaderProxy"),d.resolve("Box4.IParagraphReader"),new Pd.a(()=>sf.StaticActiveAppFrame.za().jb.Zc),ye.PageNavigator.instance,d.resolve("WordEditor.Extension.ExtensionImageStewardFactory"),n.AFrameworkApplication.He,n.AFrameworkApplication.K,n.AFrameworkApplication.ta.TQa)).as("WordEditor.Extension.IImageApiOperations").ha();
d.ia("WordEditor.Extension.SelectionApiHelper",()=>new YB(sh.a.instance,sl.a.instance,d.resolve("Box4.ISelectionFactory"),d.resolve("Box4.IParagraphReader"),n.AFrameworkApplication.va)).ha().as("WordEditor.Extension.ISelectionApiHelper");d.ia("WordEditor.Extension.StyleApiHelper",()=>new Xr(d.resolve("Box4.Styles.IWACStyleReader"),n.AFrameworkApplication.va,d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),d.resolve("WordEditor.IWACTableStyleReader"),tp.a.instance)).ha().as("WordEditor.Extension.IStyleApiHelper");
d.ia("WordEditor.Extension.InsertApiOperations",()=>new Iw(n.AFrameworkApplication.va,d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),xd.a.instance,d.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,d.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,KB.a.instance,Vy.a.instance,d.resolve("Box4.BlobReaderProxy"),
d.resolve("WordEditor.Extension.NoteItemFactory"),sh.a.instance)).ha().as("WordEditor.Extension.IInsertApiOperations");d.register(Dt,"WordEditor.Extension.FieldOperations").ha().as("WordEditor.Extension.IFieldOperations").Ud(()=>new Dt(d.resolve("WordEditor.Extension.FieldFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.ITableCellReader"),new xi.a,d.resolve("Box4.IFieldEditor"),
d.resolve("Box4.IHyperlinkEditor"),d.resolve("WordEditor.TableOfContents.ITableOfContentsActor"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.ContentControlParagraphMapping"),d.resolve("Box4.IFieldUpdaterFactory"),n.AFrameworkApplication.va));d.ia("WordEditor.Extension.FileApiOperations",()=>new $t(d.resolve("WordEditor.AppsForOffice.IOoxmlRangeManager"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ImageApiOperations"),
d.Oa("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"),d.resolve("WordEditor.AppsForOffice.IHtmlDataGetSetProvider"))).ha().as("WordEditor.Extension.IFileApiOperations");d.register(ZB,"WordEditor.Extension.TrackChangesOperations").ha().as("WordEditor.Extension.ITrackChangesOperations").Ud(()=>new ZB(d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,d.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));
d.ia("WordEditor.Extension.TableOperations",()=>new Ju(d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.InsertApiOperations"),d.resolve("Box4.ITableNavigator"),n.AFrameworkApplication.va,new xi.a,d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableColumnReader"),d.resolve("Box4.ITableCellReader"),d.resolve("WordEditor.Extension.TableFactory"),d.resolve("WordEditor.Extension.TableRowFactory"),d.resolve("WordEditor.Extension.TableCellFactory"),d.resolve("Box4.TableReaderProxy"),
d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.IOutlineElementEditor"),d.resolve("WordEditor.Extension.ContentControlOperations"))).ha().as("WordEditor.Extension.ITableOperations");d.ia("WordEditor.Extension.CommentOperations",()=>new Fu(d.resolve("WordEditor.Comments.IWordEditorCommentModel"),d.Sa("WordEditor.Comments.IEditorCommentManager"),d.resolve("WordEditor.Extension.CommentFactory"),n.AFrameworkApplication.va,sh.a.instance,d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.RangeOperations"),
d.resolve("WordEditor.Comments.ICommentFormatTranslator"))).ha().as("WordEditor.Extension.ICommentOperations");d.ia("WordEditor.Extension.FontOperations",()=>new SA(n.AFrameworkApplication.va,d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"))).ha().as("WordEditor.Extension.IFontOperations");d.ia("WordEditor.Extension.SettingOperations",()=>new tx).ha().as("WordEditor.Extension.ISettingOperations");d.ia("WordEditor.Extension.InlinePictureFactory",()=>new Am(d.resolve("Box4.Images.IImageReader"),
d.resolve("WordEditor.IImageEditor"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ITableOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.InlinePicture,Box4.GraphNodeContext>").ha();
d.ia("WordEditor.Extension.FontFactory",()=>new RA(d.resolve("Box4.IParagraphReader"),n.AFrameworkApplication.va,d.resolve("WordEditor.AppsForOffice.IApiOperationChecker"),d.resolve("WordEditor.Extension.IFontOperations"),d.resolve("Box4.Styles.IWACStyleEditor"))).ha();d.ia("WordEditor.Extension.TableBorderFactory",()=>new Zz(new xi.a,d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("WordEditor.IWACTableStyleReader"),d.resolve("Box4.TableNavigatorProxy"),d.Sa("Box4.TableCellReaderProxy"),
dn.a.instance,d.resolve("Box4.TableEditors.IWACTableStyleEditor"))).ha();d.ia("WordEditor.Extension.ParagraphFactory",()=>new Vv(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InlinePictureFactory"),d.resolve("WordEditor.Extension.ListItemFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("Box4.IParagraphEditor"),d.resolve("Box4.ILanguageReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),
d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.FileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Extension.ListOperations"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Paragraph,Box4.Graph.GraphNode>").ha();
d.ia("WordEditor.Extension.ContentControlFactory",()=>new MA(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.ContentControl.IContentControlManager"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),
d.resolve("WordEditor.Extension.ListOperations"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.CommentOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.ContentControl,WordEditor.ContentControl.IContentControl>").ha();d.ia("WordEditor.Extension.InternalRangeFactory",()=>new dz(d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.IParagraphReader"),new Pd.a(()=>sf.StaticActiveAppFrame.za()?sf.StaticActiveAppFrame.za().jb.Zc.xd:null),d.resolve("Box4.IDynamicRangeObjectSpace"),
d.resolve("Box4.IDynamicRangeEditor"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.ITableEditor"))).ha();d.ia("WordEditor.Extension.AnnotationOperations",()=>new ro(d.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha().as("WordEditor.Extension.IAnnotationOperations");d.ia("WordEditor.Extension.RangeFactory",()=>new mr(d.resolve("WordEditor.Extension.ParagraphFactory"),
d.resolve("WordEditor.Extension.InlinePictureFactory"),d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InternalRangeFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.SearchExecutor"),
d.resolve("WordEditor.Extension.FileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("Box4.HyperlinkEditor"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Extension.ListOperations"),d.resolve("WordEditor.Bookmark.IBookmarkManager"),d.resolve("WordEditor.Extension.NoteItemFactory"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"),d.resolve("WordEditor.Extension.IAnnotationOperations"))).ha();
d.ia("WordEditor.Extension.ListFactory",()=>new WA(d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.IParagraphReader"))).ha();d.ia("WordEditor.Extension.ListItemFactory",()=>new ez(d.resolve("WordEditor.Extension.ListOperations"),d.resolve("Box4.IListMarkerUtility"))).ha();d.ia("WordEditor.Extension.NoteItemFactory",()=>new Bm).ha();d.ia("WordEditor.Extension.FieldFactory",()=>new RB).ha();d.ia("WordEditor.Extension.BodyFactory",()=>new Wy(d.resolve("WordEditor.Extension.ParagraphFactory"),
d.resolve("WordEditor.Extension.RangeFactory"),d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.InlinePictureFactory"),new xi.a,d.resolve("Box4.ICharacterPropertiesEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IImageApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),
d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Extension.TableOperations"),d.resolve("WordEditor.Extension.ListOperations"),d.resolve("WordEditor.Extension.CommentOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),d.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Body,Box4.Graph.GraphNode>").ha();
d.ia("WordEditor.Extension.SectionFactory",()=>new cu(d.resolve("WordEditor.Extension.BodyFactory"),d.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),d.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Section,Box4.Graph.GraphNode>").ha();d.ia("WordEditor.Extension.TableCellFactory",()=>new uj(new xi.a,d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("Box4.TableNavigatorProxy"),d.Sa("Box4.TableCellReaderProxy"),
d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.ITableColumnReader"),d.resolve("Box4.ITableEditor"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableCell,Box4.Graph.GraphNode>").ha();d.ia("WordEditor.Extension.TableRowFactory",()=>new Js(d.resolve("WordEditor.Extension.FontFactory"),new xi.a,d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("Box4.TableNavigatorProxy"),d.resolve("Box4.ITableRowReader"),
d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableEditor"),d.resolve("Box4.TableReaderProxy"),d.resolve("WordEditor.Extension.FieldOperations"),d.resolve("WordEditor.Extension.TableCellFactory"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.TableRow,Box4.Graph.GraphNode>").ha();d.ia("WordEditor.Extension.TableFactory",()=>new vx(d.resolve("WordEditor.Extension.FontFactory"),d.resolve("WordEditor.Extension.TableCellFactory"),
new xi.a,d.resolve("WordEditor.Extension.TableBorderFactory"),d.resolve("WordEditor.ITableEditor"),d.resolve("Box4.TableReaderProxy"),d.resolve("Box4.TableRowReaderProxy"),d.resolve("Box4.Styles.IWACTableStyleReader"),d.resolve("Box4.TableEditors.IWACTableStyleEditor"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.RangeOperations"),
d.resolve("Box4.TableNavigatorProxy"),d.resolve("WordEditor.Extension.ISelectionApiHelper"),d.resolve("Box4.ITableEditor"),Co.a.instance,d.resolve("Box4.SectionAlignedViewPositionProvider"),d.resolve("WordEditor.Extension.IStyleApiHelper"),d.resolve("WordEditor.Extension.FieldOperations"))).as("WordEditor.Extension.IExtensionFactory<WordEditor.Extension.Table,Box4.Graph.GraphNode>").ha();d.ia("WordEditor.Extension.GraphTransactionWrapper",()=>new Hw(new Pd.a(()=>sf.StaticActiveAppFrame.za()?sf.StaticActiveAppFrame.za().jb.Zc:
null),new Rj.a)).as("WordEditor.Extension.IGraphTransactionWrapper");d.ia("WordEditor.Extension.RequestContext",()=>new go(d.resolve("WordEditor.Extension.GraphTransactionWrapper"))).ha();d.ia("WordEditor.Extension.DocumentProperties",()=>new Gu(d.resolve("WordEditor.Extension.RequestContext"),d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),new Rj.a,new Bv,n.AFrameworkApplication.K.$("WordEditorAppsForOfficeDocPropertiesIsEnabled"))).ha();d.ia("WordEditor.Extension.AnnotationCollectionFactory",
()=>new nx(d.resolve("Box4.AugmentationLoop.IAnnotationStorage"),d.resolve("WordEditor.Extension.ParagraphFactory"))).ha();d.ia("WordEditor.Extension.DocumentFactory",()=>new Sv(new Pd.a(()=>sf.StaticActiveAppFrame.za()?sf.StaticActiveAppFrame.za().jb.Zc:null),d.resolve("WordEditor.Extension.RequestContext"),d.resolve("WordEditor.Extension.BodyFactory"),d.resolve("WordEditor.Extension.SectionFactory"),d.resolve("WordEditor.Extension.RangeFactory"),n.AFrameworkApplication.va,sh.a.instance,ye.PageNavigator.instance,
Co.a.instance,d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ab.App.nP,d.resolve("WordEditor.Extension.ContentControlOperations"),d.resolve("WordEditor.Extension.DocumentProperties"),d.resolve("WordEditor.Extension.AnnotationCollectionFactory"),d.resolve("WordEditor.Bookmark.IBookmarkManager"),d.resolve("Box4.IParagraphReader"),d.resolve("WordEditor.Extension.SearchExecutor"),d.resolve("WordEditor.Extension.IFileApiOperations"),d.resolve("WordEditor.Extension.TrackChangesOperations"),
d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"),d.resolve("WordEditor.Extension.CustomXmlPartFactory"),new Rj.a,d.resolve("WordEditor.Extension.SettingOperations"),d.resolve("Box4.Styles.IWACStyleReader"),d.resolve("Box4.Styles.IWACStyleEditor"),d.resolve("WordEditor.Extension.FontFactory"),KB.a.instance)).ha();d.ia("WordEditor.Extension.DocumentCreatedFactory",()=>new OB).ha();d.ia("WordEditor.Extension.AuthenticationServiceFactory",()=>new Sz(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
d.resolve("Postmessage.IHostPostmessenger"))).ha();d.ia("WordEditor.Extension.LicenseFactory",()=>new Iu(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();d.ia("WordEditor.Extension.AppRuntimeServiceFactory",()=>new Xt(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();d.ia("WordEditor.Extension.CommentContentRangeFactory",
()=>new NB(d.resolve("WordEditor.Extension.IInsertApiOperations"),d.resolve("WordEditor.Extension.IFontOperations"),d.resolve("WordEditor.Extension.RangeOperations"),d.resolve("WordEditor.Comments.IWordEditorCommentModel"))).ha();d.ia("WordEditor.Extension.CommentFactory",()=>new ug(d.resolve("WordEditor.Extension.CommentReplyFactory"),d.resolve("WordEditor.Extension.CommentContentRangeFactory"),d.resolve("Box4.IParagraphReader"))).ha();d.ia("WordEditor.Extension.CommentReplyFactory",()=>new LA(new Pd.a(()=>
sf.StaticActiveAppFrame.za()?sf.StaticActiveAppFrame.za().jb.Zc.xd:null))).ha();d.ia("WordEditor.Extension.AppRuntimePersistenceServiceFactory",()=>new dy(d.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),d.resolve("Common.App.AppsForOfficeCommon.IActivatedAfoDataManager"))).ha();d.ia("WordEditor.Extension.RichApiEventManager",()=>new qm(d.resolve("WordEditor.Extension.EventMessageManagerMapper"),OfficeExtension.WacRuntime.RichApi.getEventManager(),new $B)).ha();d.ia("WordEditor.Extension.EventMessageManagerMapper",
()=>new KC(d.resolve("WordEditor.Extension.CommentEventMessageManager"),d.resolve("WordEditor.Extension.ContentControlEventMessageManager"),d.resolve("WordEditor.Extension.DocumentEventMessageManager"))).ha();d.ia("WordEditor.Extension.CommentEventMessageManager",()=>new my(d.Sa("WordEditor.Extension.RichApiEventManager"),d.resolve("WordEditor.Comments.EditorCommentModel"))).ha();d.ia("WordEditor.Extension.ContentControlEventMessageManager",()=>new Mw(d.Sa("WordEditor.Extension.RichApiEventManager"),
d.resolve("Box4.IContentControlDataChangedManager"),d.resolve("WordEditor.ContentControl.IContentControlGraphManager"),d.resolve("Box4.ISelectionManager"),d.resolve("Box4.IContentControlChpHelper"),d.resolve("WordEditor.Extension.ContentControlOperations"))).ha();d.ia("WordEditor.Extension.DocumentEventMessageManager",()=>new bA(d.Sa("WordEditor.Extension.RichApiEventManager"),this.sHb())).ha();d.ia("WordEditor.Extension.CustomXmlPartFactory",()=>new aC(d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager"))).ha()}sHb(){const d=
this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory");return d?d.getInstance(0):(v.ULS.sendTraceTag(508827729,2250,10,"Could not resolve wordCountManagerFactory"),null)}static main(){n.AFrameworkApplication.eL||z.a.instance.Gc(new nt)}}Object(y.a)(nt,"ExtensionPackage",null,[1,2]);var ny=c(1163);class Mp extends xb.StandardDialog{constructor(d){super();this.TAe=d;this.Cd=0;this.ye(1,CommonUIStrings.l_DialogClose)}MO(d){this.wx(d,CommonUIStrings.l_DefaultDialogTitle,this.TAe,null,!1,!0)}}
Object(y.a)(Mp,"ErrorDialog",xb.StandardDialog,[883]);class Xv{}Object(y.a)(Xv,"LearningToolsExtraInfoContext",null,[1188]);class Nw{static requestFullscreen(d){d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.msRequestFullscreen?d.msRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.requestFullscreen?d.requestFullscreen():v.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():
document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():v.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}}Object(y.a)(Nw,"FullscreenUtils",null,[]);var cA=c(87),Lg=c(1117),u=c(36);class C{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe,Be,Hg,Xh){this.Yhh=this.yze=0;this.KUg=this.Gk=this._iframe=this.W=this.EMa=null;this._title=d;this.zZb=m;this.Zf=A;
this.Pma=R;this.qm=da;this.Atb=Ea;this.k1b=ib;this.Omk=Qb;this.Mrc=pc;this.Nwc=Pc;this.TAe=gd;this.T0g=!1;this.sxe=0;this.Vb=ae;this.Nyc=Eg.a.create().toString();this.OJe=Xd;this.A$a=Be;this.ulk=Cd+"?appId="+Be;this.Zok=se;this.z8g=Xe;this.S1b=Hg;this.k0b=Xh;this.o3g=!1;this.rYj=De.a.ug(this.Mrc).name;this.a_=!1}w8a(){this.Gk=(new xf.a).create();this.Gk.Cd=5;this.Gk.Kt=!1;this.Gk.KL(null,null,null)}Y4b(){this.Gk&&(this.Gk.close(),this.Gk=null)}n0m(){this.KUg=new Mp(this.TAe);this.KUg.MO(Tf.a.iHi)}launch(d){v.ULS.sendTraceTag(2049E4,
306,50,"Learning Tools service launched");this.qm.start();this.yze=(new Date).getTime();this.w8a();var m={};m.title=this._title;m.chunks=this.Omk;m.StartingChunkIndex=this.OJe.SelectionChunkIndex;m.StartingCharIndex=this.OJe.SelectionCharIndex;var A="",R="",da="";this.S1b?(A={},A.data=m,m=rb.c(A),A="&useV2Endpoint=1",this.k0b&&(R="&sendDocxFile=1",da="&startIndex="+this.OJe.SelectionCharIndex)):m=rb.c(m);R=this.Pma+"OneNoteS2SHandler.ashx?action="+d+"&appId="+this.A$a+"&enabledConfig=WordEditorLearningToolsIsEnabled&"+
n.AFrameworkApplication.em+A+R+da;da={"Content-Type":"application/json; charset=utf-8"};da.LearningToolsSessionId=this.Nyc;this.Zf.nj(R,2,m,da,!1,2,Ea=>{this.TMb(Ea)},Ea=>{this.Bqa(Ea)},d,void 0,void 0,void 0,this.k1b);d=this.ulk+"&exitCallback="+cA.a.sZh+"&omkt="+this.rYj+"&sessionId="+this.Nyc+"&showFeedback="+n.AFrameworkApplication.LF.toString();this.Zok&&(d+="&v=2");this.w0m(d)}TMb(d){var m=C.s2l(d.data.te);this.EMa={};this.a_=!1;if(this.z8g)this.EMa.readerModel=m;else{d=Object(vf.a)(String,
m.url);const A=Object(vf.a)(String,m.storageId),R=Object(vf.a)(String,m.version);m=Object(vf.a)(String,m.processingHost);if(!d){u.b(20259850,200,10,"{0}",{["Desc"]:"NoUrl"});return}this.EMa.storageId=A;this.EMa.apiVersion=R;this.EMa.processingHost=m}this.bCj()}w0m(d){n.AFrameworkApplication.N_d=!0;this.W=document.createElement("div");this._iframe=document.createElement("iframe");this.W.appendChild(this._iframe);document.body.appendChild(this.W);C.zmj(this.W);C.zmj(this._iframe);this._iframe.id="ImmersiveReader-iframe";
this._iframe.title=this.Nwc;this._iframe.tabIndex=0;this._iframe.src=d;this._iframe.setAttribute("allowfullscreen","true");this._iframe.setAttribute("aria-modal","true");this.F2m()}Bqa(d){this.Cwj(!1);v.ULS.sendTraceTag(20259852,201,10,"{0}",this.cYl(d));this.Y4b();5!==d.data.status||this.a_?this.n0m():(this.a_=!0,this.dGh(),this.launch(Object(vf.a)(String,d.data.state)))}cYl(d){let m=-1;d&&d.data&&(m=d.data.Ne);500===m?v.ULS.sendTraceTag(37065042,201,10,"Failed to load the immersive reader for app {0} due to a 500 internal server error response from the LT service with LearningToolsSessionId {1}",
this.A$a,this.Nyc):408===m&&v.ULS.sendTraceTag(37065043,201,10,"Failed to load the immersive reader for app {0} due to a 408 request timeout from the LT service with LearningToolsSessionId {1}",this.A$a,this.Nyc);return{["desc"]:"LT failure",["status"]:m,["LearningToolsSessionId"]:this.Nyc}}F2m(){this.zZb.Awh(Object(I.a)(this,this.rPi,"messageHandler"))}bCj(){if(this.EMa&&this.o3g){this.Vb.hS("LearningToolsStaticReader");this.Cwj(!0);this.EMa.launchToPostMessageSentDurationInMs=this.qm.pi;var d={};
let m="";if(this.z8g)if(this.S1b){const A=this.EMa.readerModel;A.launchToPostMessageSentDurationInMs=this.qm.pi;m="LinguisticModel";d.messageValue=A}else m="ReaderModel2",d.messageValue=this.EMa;else m="Data",d.messageValue=this.EMa;d.messageType=m;this.Wjj(d);this._iframe&&(d=this.Vb.fe("LearningTools"),d.parent=vu.AFrame.xM,d.S3(()=>{this._iframe.focus()}),this.Vb.FL("LearningTools",!1));this.Wjj({messageType:"SetFocus"})}}Wjj(d){if(this._iframe&&this._iframe.contentWindow){const m=E.a.getOrigin(this._iframe.src);
this._iframe.contentWindow.postMessage(JSON.stringify(d),m)}}xql(){this.Y4b();const d=this.Vb.fe("LearningToolsStaticReader");d.parent=vu.AFrame.xM;d.S3(()=>{this._iframe.focus()});this.W.style.visibility="visible";this._iframe.style.visibility="visible";this.Vb.FL("LearningToolsStaticReader",!1);v.ULS.sendTraceTag(20490001,306,50,"Learning Tools iFrame loaded");this.Yhh=(new Date).getTime()-this.yze}Cwj(d){const m=new Lg.a,A=new Xv;d?(A.RequestSucceeded=!0,A.DocumentCharCount=this.Atb,A.StartToDisplayIFrameDuration=
this.Yhh):A.RequestSucceeded=!1;m.ExtraInfoContext=A;this.qm.Bwj(m)}rPi(d){if(d.data===cA.a.sZh)return v.ULS.sendTraceTag(20490002,306,50,"Postmessage sent with param: {0}",d.data),this.dGh(),!0;if(d.data===cA.a.hRn)return this.o3g=!0,this.xql(),this.bCj(),!0;if(d.data===cA.a.c6n)Nw.requestFullscreen(this.W);else if(d.data===cA.a.Yzl)Nw.exitFullscreen();else{let m=null;try{m=JSON.parse(d.data)}catch(A){return v.ULS.sendTraceTag(21320706,306,100,"Postmessage generated exception: "+A),!1}if(m&&(d=m.storageIdReceivedToContentLoadedDurationInMs))return this.T0g=
!0,this.sxe=d,v.ULS.sendTraceTag(22905240,306,50,"contentLoadedDuration:{0}",this.sxe),!0}v.ULS.sendTraceTag(20490003,306,100,"Postmessage fired with irrelevant param");return!1}dGh(){eg.a.rx(this._iframe);eg.a.rx(this.W);this.zZb.xSh(Object(I.a)(this,this.rPi,"messageHandler"));const d={};d.learningToolsSessionDurationInMs=(new Date).getTime()-this.yze;d.isContentLoaded=this.T0g;d.contentLoadedDuration=this.sxe;this.Vb.hS("LearningTools");n.AFrameworkApplication.N_d=!1;v.ULS.sendTraceTag(21320707,
306,50,JSON.stringify(d))}static zmj(d){d.style.position="absolute";d.style.width="100%";d.style.height="100%";d.style.left="0";d.style.top="0";d.style.borderWidth="0";d.style.visibility="hidden";d.style.zIndex="1000";d.style.background="white"}static s2l(d){var m=null;d=({Gt:m}=rb.d(d)).returnValue;m=Object(vf.a)(Object,m);return m?m:(u.b(20259851,200,10,"{0}",{["desc"]:"CouldntParse",["serialized"]:d}),null)}}Object(y.a)(C,"LearningToolsLauncher",null,[]);class W{constructor(){this.LanguageRunsList=
null;this.SelectionCharIndex=this.SelectionChunkIndex=0;this.LanguageRunsList=new U.a;this.SelectionCharIndex=this.SelectionChunkIndex=0}}Object(y.a)(W,"LearningToolsDocumentData",null,[]);var pa=c(939);class Oa{}Object(y.a)(Oa,"LearningToolsLanguageRun",null,[]);class jb{static MNk(d){let m=null;var A=If.GraphIterator.eb(d);if(!A.zb(8))throw Error("Could not locate page content node for given paragraph");for(A=bf.a.Gs(A,A.origin);A.moveNext();)Qe.ParagraphReader.oh(A.iterator)&&(d=A.currentNode,
d=this.WOk(d),m=this.Usk(d,m));return m}static Usk(d,m){null!=d&&(null==m&&(m=document.createElement("div")),m.appendChild(d));return m}static f4l(d){var m=new If.GraphIterator;m.set(d);m.zb(11);m.jd(11);var A="";m=d.Jd.ww(m);if(null!=m){d=Qe.ParagraphReader.qNb(d);const R=m.Tu;switch(m.listType){case 0:switch(m.listStyle){case 1:A="decimal";break;case 2:A="loweralpha";break;case 3:A="lowerroman";break;case 4:A="upperalpha";break;case 5:A="upperroman";break;default:A="decimal"}A=`lt:${A};in:${d};li:${R}`;
break;case 1:switch(m.listStyle){case 1:A="disc";break;case 2:A="circle";break;case 3:A="square";break;default:A="disc"}A=`lt:${A};in:${d}`}}return A}static uji(d){let m=d.isBold?"b:1;":"";m+=d.isItalic?"i:1;":"";m+=d.isUnderline?"u:1;":"";m+=d.isStrikethrough?"s:1;":"";m+=d.isSuperscript?"sup:1;":"";return m+=d.isSubscript?"sub:1;":""}static WOk(d){let m=null;const A=Qe.ParagraphReader.text(d);let R=0;for(;null!=d.ra&&R<d.ra.length;){var da=d.ra.J(R);var Ea=da.cp;var ib=R<d.ra.length-1?d.ra.J(R+
1).cp:Qe.ParagraphReader.textLength(d);let Qb="";null!=da.formatting?Qb=this.uji(da.formatting.cache):({formatting:da}=d.ra.ljb(da.cp),null!=da&&(Qb=this.uji(da.cache)));ib=A.substring(Ea,ib);0<ib.length&&(Ea=document.createElement("span"),Ea.setAttribute("style",Qb),Ea.innerText=ib,null==m&&(m=document.createElement("p")),m.appendChild(Ea));R++}null!=m&&Qe.ParagraphReader.HR(d)&&m.setAttribute("style",this.f4l(d));return m}}Object(y.a)(jb,"ImmersiveReaderUtility",null,[]);class Wb{get rym(){return`${Ab.App.webServiceBase}OneNoteS2SHandler.ashx?action=${this.Xqi}&appId=${this.Y7}&enabledConfig=WordEditorLearningToolsIsEnabled&${n.AFrameworkApplication.em}`}constructor(d,
m,A){this.asl=d;this.SQ=m;this.xLo=A;this.Y7="Word WAC";this.Xqi="immersivereader"}launch(){const d=this.w8a(WordEditorIntl.WordEditorStrings.l_LearningToolsLoadingMessage);this.pCl().then(m=>{d.close();return this.I0m(m)}).catch(m=>{v.ULS.sendTraceTag(509661463,209,10,"Immersive Reader failed to launch. Error msg: "+this.xca(m));d.close();(new Mp(WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage)).MO(Tf.a.iHi)})}pCl(){return new Promise((d,m)=>{this.SQ.nj(this.rym,1,null,null,!1,2,A=>
d(A.data.te),m,this.Xqi,void 0,void 0,void 0,this.xLo)})}async D3m(){if(window.immersiveReader)return window.immersiveReader;n.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?await appResourceLoader.loadChunk("immersiveReader"):await Ia.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("immersiveReader");return window.immersiveReader}async I0m(d){var m,A,R;const {["v0_7_0"]:{["launchAsync"]:da,["CookiePolicy"]:Ea}}=await this.D3m(),ib=null===(m=this.asl.body.paragraphs.getFirstOrNullObject())||
void 0===m?void 0:m.Koa();m={["title"]:(null===WordRibbonStrings||void 0===WordRibbonStrings?void 0:WordRibbonStrings.ImmersiveView)||"Immersive Reader",["chunks"]:[{["content"]:null===(A=jb.MNk(ib))||void 0===A?void 0:A.innerHTML,["mimeType"]:"text/html"}]};A={["uiLang"]:null===(R=n.AFrameworkApplication.K)||void 0===R?void 0:R.appSettings.UICulture,["cookiePolicy"]:Ea.Enable,["allowFullscreen"]:!0};await da(d,m,A)}w8a(d){const m=(new xf.a).create();m.Cd=5;m.Kt=!1;m.message=d;m.KL(null,null,null);
return m}xca(d){if("object"!==typeof d)return""+d;if("message"in d)return""+d.message;try{return JSON.stringify(d)}catch(m){return"'Could not JSON serialize the error'"}}}Object(y.a)(Wb,"ImmersiveReaderSDKLauncher",null,[]);class Cc{constructor(){this.qm=this.Pma=this.Zf=this.zZb=this.Duc=null;this.Mrc=this.k1b=this.Atb=0;this.Vb=this.rUe=this.Nwc=null;this.k0b=this.S1b=this.NLe=this.bYe=!1;this.qBl=(d,m,A)=>{if(1===A)return Cq.SessionStatusManager.instance.Yj?8:32;if(!sh.a.instance||!sh.a.instance.ib||
!sh.a.instance.ib.lb)return 8;if(this.G1o)return this.xhn.launch(),32;d=this.Duc.getSelection();this.k0b?Oi.a.mR(de.a.userAction,!0,this.MKb,this.IMb,d):(m=this.ORc(),A=this.aii(d),d=this.BWl(m,A,d),m=this.cim(d.LanguageRunsList),A=sa.a.yJ(n.AFrameworkApplication.Js.yz),(new C(A,this.zZb,this.Zf,this.Pma,this.qm,this.Atb,this.k1b,m,this.Mrc,this.Nwc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.rUe,this.Vb,d,this.bYe,this.NLe,"Word WAC",this.S1b,this.k0b)).launch("learningtools"));
return 32};this.MKb=d=>{const m=new W;d=this.wMl(Object(vf.a)(mt,d));m.SelectionCharIndex=d;d=sa.a.yJ(n.AFrameworkApplication.Js.yz);(new C(d,this.zZb,this.Zf,this.Pma,this.qm,this.Atb,this.k1b,[],this.Mrc,this.Nwc,WordEditorIntl.WordEditorStrings.l_LearningToolsErrorMessage,this.rUe,this.Vb,m,this.bYe,this.NLe,"Word WAC",this.S1b,this.k0b)).launch("learningtools")};this.IMb=(d,m)=>{v.ULS.sendTraceTag(41418846,209,10,"Error saving the docx file, status code: "+m);this.MKb(d)}}get G1o(){return null!=
this.HJg?this.HJg:this.HJg=n.AFrameworkApplication.K.$("LearningToolsNewImmersiveReaderSDKIsEnabled")}get xhn(){return null!=this.$Eg?this.$Eg:this.$Eg=(()=>new Wb(this.Duc,this.Zf,this.k1b))()}get name(){return"WordEditor.LearningToolsContentExtractor"}wc(){}init(){yj.App.nLf&&(this.Ub(),this.Duc=Ia.a.instance.Ve("WordEditor.Extension.DocumentFactory").value.create(),this.zZb=pa.a.instance,this.Zf=n.AFrameworkApplication.He,this.Pma=Ab.App.webServiceBase,this.qm=n.AFrameworkApplication.ta.Kq.DSa("LoadResource",
"ImmersiveReader"),this.k1b=n.AFrameworkApplication.K.nc("LearningToolsTimeoutMs",3E4),this.Mrc=n.AFrameworkApplication.lcid,this.Nwc=WoncaIntl.WoncaStrings.L_ImmersiveView,this.rUe=n.AFrameworkApplication.K.kb("LearningToolsStaticUrl"),this.Vb=Ib.FocusManager.instance(),this.NLe=n.AFrameworkApplication.K.$("WordEditorLearningToolsNewDataFlowIsEnabled"),this.S1b=n.AFrameworkApplication.K.$("LearningToolsV2EndpointIsEnabled"),this.k0b=n.AFrameworkApplication.K.$("LearningToolsSendDocxFileIsEnabled"));
this.bYe=n.AFrameworkApplication.K.$("WordEditorLearningToolsReactUIIsEnabled")}ORc(){this.Atb=0;const d=this.Duc.body.paragraphs,m=d.length(),A=Array(m);for(let R=0;R<m;R++)A[R]=d._GetItem(R),this.Atb+=A[R].text.length;return A}wMl(d){const m=d.paragraphs.getFirst();if(m){let A=0,R=0;const da=this.Duc.body.paragraphs,Ea=da.length();for(let ib=0;ib<Ea;ib++){const Qb=da._GetItem(ib);if(m.Koa().equals(Qb.Koa()))return A+=this.aii(d),A+=Qb.text.length?R:0;Qb.text.length?(A+=Qb.text.length+R,R=0):R++}}return 0}BWl(d,
m,A){const R=new W;if(1===d.length&&!d[0].text.length)return m=new Oa,m.Run="",R.LanguageRunsList.add(m),R;let da=-1;A=A.paragraphs.getFirst();let Ea=0;for(const Qb of d){d=Qb.language();for(let pc=0;pc<d.length;pc++){const Pc=d[pc],gd=Pc.Bc,Cd=Pc.end;var ib=Pc.lcid;let ae=0;const Xd=new Oa;let se="und";try{se=De.a.ug(ib).name}catch(Xe){v.ULS.sendTraceTag(25557076,209,10,"error "+Xe+" while reading lcid: "+ib)}Xd.Lang=se;ib=Qb.text.substring(gd,Cd);ib.length||Qb.isListItem?Ea=0:Ea++;2>=Ea&&(Cd===
Qb.text.length||pc===d.length-1)&&(ib+="\n");!gd&&Qb.isListItem?ae=Cc.zho(Qb,Xd,ib):Xd.Run=ib;R.LanguageRunsList.add(Xd);da++;A.Koa().equals(Qb.Koa())&&m>=gd&&m<=Cd&&(R.SelectionChunkIndex=da,R.SelectionCharIndex=m-Pc.Bc+ae)}}return R}dispose(){}Ub(){n.AFrameworkApplication.va.qa(xe.a.MKb,ic.a.application,this.qBl)}aii(d){let m=0;(d=d.Xp)&&0<d.count&&(m=d.J(0).Wj);return m}cim(d){const m=[];for(const A of d)m.push({["content"]:A.Run,["lang"]:A.Lang});return m}static zho(d,m,A){const R=d.list,da=d.listItem;
let Ea="";R&&da&&(Ea=R.levelTypes[da.level]?d.listItem.listString+" ":"\u2022 ");m.Run=Ea+A;return Ea.length}static main(){n.AFrameworkApplication.eL||z.a.instance.Gc(new Cc)}}Object(y.a)(Cc,"LearningToolsContentExtractorPackage",null,[1,2]);const Vc=()=>!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordListTransformationIsEnabled");class Bd{constructor(d,m){this.wZc=d;this.mb=m;this.W=null;this.T3n=(A,R,da)=>{if(1===da)return this.dgo(this.mb.ib.lb)?32:16;2===da&&this.W.Sa("WordEditor.INeuralRewriteMessageHandler").execute(Ea=>
{Ea.Kqn()});return 32}}dgo(d){if(!this.uec(d)||d.t4a)return!1;d=d.Pa;if(Qe.ParagraphReader.um(d)||Em.SelectionEditor.Ze(d)||Em.SelectionEditor.vl(d)){switch((this.wZc.FFa(d)||n.AFrameworkApplication.lcid)&1023){case 9:return!0;case 10:if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}uec(d){return d.dI||2<d.length||!d.length||2===d.length&&!Em.SelectionEditor.Kk(d.Rc)||1===d.length&&Em.SelectionEditor.Kk(d.Rc)?
!1:this.oJf(d.Pa)}oJf(d){return Qe.ParagraphReader.Xb(d.node)?""!==Qe.ParagraphReader.text(d.node).trim():!1}get name(){return"WordEditor.NeuralRewrite"}wc(d){this.W=d}init(){n.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const d=n.AFrameworkApplication.K;(d.$("RewriteIsEnabled")||d.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(m=>
{m.isFeatureEnabled(Bj.a.rRi,!1).then(A=>{A&&n.AFrameworkApplication.va.fb(Ac.a.rewrite,K.a.frame,this.T3n,1028);return null})})}dispose(){}static main(){z.a.instance.Gc(new Bd(Ia.a.instance.resolve("Box4.ILanguageReader"),Ia.a.instance.resolve("Box4.ISelectionManager")))}}Object(y.a)(Bd,"NeuralRewritePackage",null,[1,2]);var td=c(448);class Ed{constructor(d,m){this.gab=this.lj=null;this.$Wi=(A,R)=>{if(10===R.type&&(A="boolean"===typeof R.OL?R.OL?1:0:R.OL,this.gab!==A)){R="";switch(A){case null:case 0:R=
"Session not connected to OCS.";break;case 1:R="Session connected to OCS.";break;case 2:R="Session connected to OCS (WPM).";break;default:v.ULS.shipAssertTag(523120715,337,!1,"Unexpected hint value {0}",A)}v.ULS.sendTraceTag(523120716,337,50,R);this.gab=A;this.ega.pV(td.a.dVf)}};this.shc=(A,R)=>{R.newState||(v.ULS.sendTraceTag(36806805,337,50,"RTC disconnected. No longer able to fetch OCS connection status."),this.gab=null,this.ega.pV(td.a.dVf))};this.bZo=(A,R,da,Ea,ib)=>{if(1===da)return 32;ib[L.a.Visible]=
null!=this.gab;switch(this.gab){case null:case 0:ib[L.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected;break;case 1:ib[L.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsConnected;break;case 2:ib[L.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsFluidConnected;break;default:ib[L.a.Value]=WordEditorIntl.WordEditorStrings.L_OcsNotConnected,v.ULS.shipAssertTag(523120717,337,!1,"Unexpected hint value {0}",this.gab)}ib[S.a.labelText]=ib[L.a.Value];return 32};this.ga=d;this.ega=m}init(d){d?(this.lj=
d,this.lj.V3(this.$Wi),this.lj.Kua(this.shc),this.ga.fb(Ac.a.u6i,ic.a.application,this.bZo,96)):v.ULS.sendTraceTag(36282374,306,10,"Null rtcProxy. Cannot initialize Ocs connection status manager.")}dispose(){this.lj&&this.lj.iPb(this.$Wi)}}Object(y.a)(Ed,"OcsConnectionStatusManager",null,[10]);class Ke{constructor(){this.W=null}get name(){return"WordEditor.OcsConnectionStatusPackage"}wc(d){this.W=d;this.W.ia("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager",()=>new Ed(n.AFrameworkApplication.va,
this.W.resolve("WordEditor.IStatusBarUser"))).ha()}init(){this.W.resolve("Common.IAppSettingsManager").$("WordEditorShowOcsConnectionStatus")&&this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){const d=this.W.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager");this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(m=>{m.bE().continueWith(()=>{const A=m.bE().result;d.init(A)})})}dispose(){}static main(){z.a.instance.Gc(new Ke)}}Object(y.a)(Ke,"OcsConnectionStatusPackage",
null,[1,2]);var Gf=c(1138);class Kg{constructor(d,m){this.clientId=d;this.yS=m}}Object(y.a)(Kg,"VectorClockInfo",null,[]);class qg{constructor(d,m,A){this.lzb=d;this.Yc=m;this.c5j=A}$ym(){let d=this.wem();return d||(d=this.bfl(),d)?this.azm(d):(v.ULS.sendTraceTag(25723860,381,10,"Cannot create client vector clock graph node."),!1)}ohi(){return this.l7h(this.lzb)}l7h(d){const m=this.pSd();if(m&&m.Tb(1)){do{const A=m.currentNode,R=A.getValue(wc.a.ype);if(R==d)return d=A.getValue(wc.a.yS),new Kg(R,d)}while(m.Lf(1))
}return null}fOl(){const d=this.pSd();if(!d)return null;if(!d.Tb(1))return tm.empty();const m=new U.a;do{var A=d.currentNode;const R=A.getValue(wc.a.ype);A=A.getValue(wc.a.yS);R?m.add(new Kg(R,A)):v.ULS.sendTraceTag(25723861,381,15,"A vector clock node with null client id is present in the graph.")}while(d.Lf(1));return m}bfl(){const d=this.pSd();if(!d)return null;const m=new Gf.a;m.setValue(wc.a.ype,this.lzb);m.setValue(wc.a.yS,0);d.Bf(m,1);return m}wem(){const d=this.pSd();if(d&&d.Tb(1)){do{const m=
d.currentNode;if(m.getValue(wc.a.ype)==this.lzb)return m}while(d.Lf(1))}return null}azm(d){if(!d)return v.ULS.sendTraceTag(25723862,381,10,"Client vector clock node is null."),!1;const m=d.getValue(wc.a.yS)+1;d.setValue(wc.a.yS,m);return!0}pSd(){var d=this.c5j();if(!d)return v.ULS.sendTraceTag(25723864,381,10,"Cannot get an iterator since page content node is null."),null;d=this.Yc.Joa(d,7,7);return d.Tb(33)?d:(v.ULS.sendTraceTag(25723865,381,10,"Ocs Vector clock container node doesn't exist."),null)}}
Object(y.a)(qg,"ClientGraphOcsVectorClockHandler",null,[878]);class Ag{constructor(d,m,A,R){this.p2=d;this.yMd=m;this.Qtl=A;this.Lao=R}}Object(y.a)(Ag,"VectorClockBroadcastData",null,[]);class bj{PWl(d){if(!d)return v.ULS.sendTraceTag(25557077,381,15,"Unable to parse vector clock update message {0}",d),null;if(!d.SL1&&!d.SL2)return v.ULS.sendTraceTag(42243083,381,50,"Save Latency Message is null. [Message: {0}]",d),null;if(d.SL2)return this.yki(d.SL2);v.ULS.sendTraceTag(508833934,381,50,"Found save latency message with older SL1 format.");
return this.yki(d.SL1)}yki(d){return new Ag(new Kg(d.VCE.I.toUpperCase(),d.VCE.V),d.E,d.ER,d.SAG)}cdm(d){return d?{SL2:{E:d.yMd,ER:d.Qtl,SAG:d.Lao,VCE:{I:d.p2.clientId,V:d.p2.yS}}}:null}}Object(y.a)(bj,"OcsVectorClockRtcMessageConverter",null,[877]);class Ug extends Sys.EventArgs{constructor(d){super();this.PMk=d}}Object(y.a)(Ug,"OcsVectorClockRtcEventArgs",Sys.EventArgs,[]);class Ri{constructor(d){this.sa=new vb.a;this.lj=null;this.wYe=this.Zh=!1;this.Qeh=d}ozk(d){this.sa.addHandler("OnVectorClockRtcReceivedEventKey",
d)}N2n(d){this.sa.removeHandler("OnVectorClockRtcReceivedEventKey",d)}fzk(d){this.sa.addHandler("OnSuccessfulSaveToOcsEventKey",d)}H2n(d){this.sa.removeHandler("OnSuccessfulSaveToOcsEventKey",d)}lzk(d){this.sa.addHandler("OnTransitionInToOcsEventKey",d)}K2n(d){this.sa.removeHandler("OnTransitionInToOcsEventKey",d)}mzk(d){this.sa.addHandler("OnTransitionOutOfOcsEventKey",d)}L2n(d){this.sa.removeHandler("OnTransitionOutOfOcsEventKey",d)}init(d){this.Zh?v.ULS.sendTraceTag(25557078,381,10,"Trying to initialize OcsVectorClock Rtc Notification Handler again after it's already initialized."):
d?(this.Zh=!0,this.lj=d,this.lj.V3((m,A)=>{this.qun(A)})):v.ULS.sendTraceTag(25557079,381,10,"Null rtcProxy. Cannot initialize OcsVectorClock Rtc Notification Handler.")}Ukc(d){this.lj&&d&&this.lj.qN(8,this.Qeh.cdm(d))}qun(d){8===d.type?(d=this.Qeh.PWl(d.OL))&&this.sa.raiseEvent("OnVectorClockRtcReceivedEventKey",new Ug(d)):10===d.type?((d="boolean"===typeof d.OL?d.OL:0!==d.OL)?this.wYe||this.sa.raiseEvent("OnTransitionInToOcsEventKey"):this.wYe&&this.sa.raiseEvent("OnTransitionOutOfOcsEventKey"),
this.wYe=d):11===d.type&&this.sa.raiseEvent("OnSuccessfulSaveToOcsEventKey")}}Object(y.a)(Ri,"OcsVectorClockRtcNotificationHandler",null,[876]);class $p{constructor(d,m,A,R,da){this.CCa=A;this.fta=R;this.ON=da;this.r_g=(Ea,ib)=>{m.Iwn(ib.PMk)};this.q_g=()=>{m.nqn()};this.kah=()=>{d.Cvn()};this.D$g=()=>{d.pZf();m.pZf()};this.E$g=()=>{d.qZf();m.qZf()};this.P9g=()=>{d.zMb()}}XJl(){this.CCa.ozk(this.r_g);this.fta.CCd(this.q_g);this.CCa.fzk(this.kah);this.CCa.lzk(this.D$g);this.CCa.mzk(this.E$g);this.ON.pGc(this.P9g)}caa(){this.CCa&&
(this.CCa.N2n(this.r_g),this.CCa.H2n(this.kah),this.CCa.K2n(this.D$g),this.CCa.L2n(this.E$g));this.fta&&this.fta.qcj(this.q_g);this.ON&&this.ON.cee(this.P9g)}}Object(y.a)($p,"OcsVectorClockTelemetryEventForwarder",null,[]);class Ks{constructor(d,m){this.aWa=d;this.ajn=m}}Object(y.a)(Ks,"JournalEntry",null,[]);class ii{constructor(d,m,A,R,da,Ea){this.nfa=!0;this.lzb=d;this.Vk=m;this.vVb=A;this.$Xe=R;this.eVf=da;this.xD=Ea}Iwn(d){if(!this.nfa){var m=this.xD(),A=d.p2.clientId;if(A===this.lzb)v.ULS.sendTraceTag(25723870,
381,100,"Receiving own broadcast. Ignoring!");else if(this.tYm(A))v.ULS.sendTraceTag(25723871,381,100,"Receiving vector clock broadcast from a WAC client {0}. Ignoring!",A);else{var R=this.vVb.l7h(A);R&&R.yS>=d.p2.yS?v.ULS.sendTraceTag(25723872,381,100,"Receiving late vector clock broadcast for client {0} with vector clock value {1}. Ignoring!",A,d.p2.yS):this.$Xe.sA(new Ks(d,m))}}}nqn(){if(!this.nfa){var d=this.xD(),m=this.vVb.fOl();if(m)for(const A of m){if(m=this.$Xe.OEn(A.clientId,A.yS))for(const R of m)this.L6m(R,
d)}else v.ULS.sendTraceTag(25798300,381,10,"Cannot fetch vector clocks from graph. Disabling OcsVectorClockTelemetryInboundManager."),this.nfa=!0}}pZf(){v.ULS.sendTraceTag(36712913,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryInboundManager.");this.nfa=!1}qZf(){v.ULS.sendTraceTag(36712914,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryInboundManager.");this.nfa=!0;this.$Xe.zYk()}L6m(d,m){var A;m=m.getTime()-d.ajn.getTime();if(0>m)v.ULS.sendTraceTag(25723873,381,
100,"Received content before broadcast for VC {0} of client {1}. Ignoring!",d.aWa.p2.yS,d.aWa.p2.clientId);else{var R=Math.round(d.aWa.yMd/1E3),da=R+m,Ea=null===(A=n.AFrameworkApplication.K)||void 0===A?void 0:A.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogOcsOperationType",!1);n.AFrameworkApplication.se("4h53i273;ffdbc716");v.ULS.sendTraceTag(25723874,381,50,"Ocs Replication: {0}",Ea?ii.Wbf(d.aWa.p2.clientId,this.lzb,d.aWa.p2.yS,R,m,da,this.eVf.gab):ii.Vbf(d.aWa.p2.clientId,this.lzb,
d.aWa.p2.yS,R,m,da))}}tYm(d){return(d=this.Vk.mC.F9b(ii.ZRl(d)))&&d.Capabilities?d.Capabilities.SupportsAppInnerLoop:!1}static ZRl(d){return"{"+d.toLowerCase()+"}"}static Vbf(d,m,A,R,da,Ea){return{["S"]:d,["R"]:m,["V"]:A,["ST"]:R,["RT"]:da,["T"]:Ea}}static Wbf(d,m,A,R,da,Ea,ib){return{["S"]:d,["R"]:m,["V"]:A,["OT"]:ib,["ST"]:R,["RT"]:da,["T"]:Ea}}}Object(y.a)(ii,"OcsVectorClockTelemetryInboundManager",null,[]);var Lu=c(1185);class du extends wx.a{constructor(d){super();this.o7j=d}get index(){return 0}run(){this.o7j()}dK(){this.TY()}}
Object(y.a)(du,"OcsVectorClockUpdateProcessor",wx.a,[]);class qv{constructor(d,m,A,R,da){this.Zh=!1;this.nfa=!0;this.pXb=this.oMe=null;this.aYe=!0;this.C0o=()=>{this.nfa||this.aYe||(this.vVb.$ym()?this.aYe=!0:(v.ULS.sendTraceTag(25557084,381,10,"Cannot update vector clock graph node. Disabling OcsVectorClockTelemetryOutboundManager."),this.nfa=!0))};this.d3=d;this.vVb=m;this.CCa=A;this.eVf=R;this.xD=da}init(){this.Zh?v.ULS.sendTraceTag(25557082,381,10,"Trying to initialize OcsVectorClockTelemetryOutboundManager again after it's already initialized."):
(this.Tvm(),this.Zh=!0)}$ao(){const d=this.vVb.ohi();d?(Lu.a.StaticVarVectorClockClientId=d.clientId,Lu.a.StaticVarVectorClockValue=d.yS):(Lu.a.StaticVarVectorClockClientId=null,Lu.a.StaticVarVectorClockValue=null);Lu.a.StaticVarFirstEditTime=new Date}Tvm(){this.oMe=new du(this.C0o);this.d3.pra(this.oMe,7)}zMb(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClientToWfeDataEnabled",!1)&&this.$ao();this.nfa||this.pXb||(this.pXb=this.xD(),this.aYe=
!1,this.oMe.dK())}Cvn(){!this.nfa&&this.pXb&&(this.QMk(),this.pXb=null)}pZf(){v.ULS.sendTraceTag(36712918,381,50,"Transitioned in to OCS. Enabling OcsVectorClockTelemetryOutboundManager.");this.pXb=null;this.nfa=!1}qZf(){v.ULS.sendTraceTag(36712919,381,50,"Transitioned out of OCS. Disabling OcsVectorClockTelemetryOutboundManager.");this.nfa=!0}QMk(){var d;if(!this.nfa){var m=this.vVb.ohi();if(m){var A=1E3*(this.xD().getTime()-this.pXb.getTime());m=new Ag(m,A,0,"{CCCCCCCC-CCCC-CCCC-CCCC-FFFFFFFFFFFF}");
this.CCa.Ukc(m);A=null===(d=n.AFrameworkApplication.K)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogOcsOperationType",!1);n.AFrameworkApplication.se("4h53i273;ffdbc716");v.ULS.sendTraceTag(36712920,381,50,"Vector clock broadcast: {0}",A?qv.Wbf(m.p2.clientId,m.p2.yS,m.yMd,this.eVf.gab):qv.Vbf(m.p2.clientId,m.p2.yS,m.yMd))}else v.ULS.sendTraceTag(25557086,381,10,"Unable to get self vector clock from graph. Disabling OcsVectorClockTelemetryOutboundManager."),this.nfa=
!0}}static Vbf(d,m,A){return{["S"]:d,["V"]:m,["ST"]:A}}static Wbf(d,m,A,R){return{["S"]:d,["V"]:m,["OT"]:R,["ST"]:A}}}Object(y.a)(qv,"OcsVectorClockTelemetryOutboundManager",null,[]);var rv=c(1905);class nz{constructor(){this.gyc=new Fk.a;this.Jrd=new Fk.a}sA(d){const m=d.aWa.p2.clientId,A=d.aWa.p2.yS;let R;({value:R}=this.gyc.Fc(m,R)).returnValue||(R=new rv.a,this.gyc.Z(m,R));if(30<=R.count)v.ULS.sendTraceTag(25723905,381,50,"Already {0} pending entries in the journal for client {1}. Ignoring the new entry with vector clock value {2}!",
R.count,m,A);else{var da;({value:da}=this.Jrd.Fc(m,0)).returnValue&&da>=A||(R.enqueue(d),this.Jrd.Z(m,A))}}OEn(d,m){let A;if(!({value:A}=this.gyc.Fc(d,A)).returnValue||!A||!A.count)return null;for(d=new U.a;!A.isEmpty;){const R=A.bZ();if(R.aWa.p2.yS>m)break;d.add(R);A.dequeue()}return d}zYk(){for(const d of this.gyc.keys)this.gyc.remove(d);for(const d of this.Jrd.keys)this.Jrd.remove(d)}}Object(y.a)(nz,"VectorClockJournal",null,[855]);class Yv{constructor(){this.W=null;this.zr=()=>{const d=sf.StaticActiveAppFrame.za().jb.rc;
return d?d.ed:null}}get name(){return"WordEditor.OcsVectorClockTelemetry"}get clientId(){return n.AFrameworkApplication.userSessionId.toUpperCase()}wc(d){this.W=d;d.ia("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler",()=>new qg(this.clientId,d.resolve("Box4.Graph.IGraphIteratorFactory"),this.zr)).ha();d.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter",()=>new bj).ha();d.ia("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler",()=>
new Ri(d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcMessageConverter"))).ha();d.ia("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal",()=>new nz);d.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager",()=>new qv(d.resolve("Box4.Graph.IGraphTransactionManager"),d.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),d.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),
()=>new Date)).ha();d.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager",()=>new ii(this.clientId,Ab.App.zd,d.resolve("WordEditor.OcsVectorClockTelemetry.IClientGraphOcsVectorClockHandler"),d.resolve("WordEditor.OcsVectorClockTelemetry.IVectorClockJournal"),d.resolve("WordEditor.OcsConnectionStatus.OcsConnectionStatusManager"),()=>new Date)).ha();d.ia("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder",()=>new $p(d.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager"),
d.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager"),d.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler"),Lw.a.instance,d.resolve("Box4.ContentEditableViewEventSource"))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.xn()})}xn(){this.wAm();const d=this.W.resolve("WordEditor.OcsVectorClockTelemetry.IOcsVectorClockRtcNotificationHandler");this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(m=>{m.bE().continueWith(()=>
{const A=m.bE().result;d.init(A)})});this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder").XJl()}wAm(){this.W.resolve("Common.IAppSettingsManager");this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryOutboundManager").init();this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryInboundManager")}dispose(){if(this.W){var d=this.W.resolve("WordEditor.OcsVectorClockTelemetry.OcsVectorClockTelemetryEventForwarder");d&&d.caa()}}static main(){z.a.instance.Gc(new Yv)}}
Object(y.a)(Yv,"OcsVectorClockTelemetryPackage",null,[1,2]);var oz;(function(d){d[d.generic=0]="generic";d[d.coherencyFailure=1]="coherencyFailure";d[d.disabledByPolicy=2]="disabledByPolicy";d[d.fileCheckedOut=3]="fileCheckedOut";d[d.fileEncrypted=4]="fileEncrypted";d[d.fileLocked=5]="fileLocked";d[d.fileNotSupported=6]="fileNotSupported";d[d.fileTooLarge=7]="fileTooLarge";d[d.invalidOperationOnZeroByteFile=8]="invalidOperationOnZeroByteFile";d[d.labelDisabled=9]="labelDisabled";d[d.labelErrorRetryLater=
10]="labelErrorRetryLater";d[d.labelIdNotFound=11]="labelIdNotFound";d[d.labelIrmDisabledByTenant=12]="labelIrmDisabledByTenant";d[d.labelNotSupported=13]="labelNotSupported";d[d.mandatoryConflict=14]="mandatoryConflict";d[d.minorVersionLimitExceeded=15]="minorVersionLimitExceeded"})(oz||(oz={}));Object(y.b)("SetPolicyLabelErrorType",oz);var xx=c(714),oy=c(1915),pz=c(1719);class dA{constructor(d,m){this.Je=d;this.bba=m}initialize(){const d=jr.a.ll();d&&d.then(()=>{this.cWc()?this.Je.ob(this,"AugLoop_SecurityClp_LabellingAnnotation"):
this.Je.ob(this,"AugLoop_Automatic_Clp_LabellingAnnotation")})}KB(d=null,m=null){v.ULS.sendTraceTag(575963811,337,50,"HandleAnnotationEvent");if(Qq.WoncaApp.A_.x5o.ZGf()){if(this.cWc()){if(!d||"AugLoop_SecurityClp_LabellingAnnotation"!==d.annotationType){v.ULS.sendTraceTag(538845259,337,15,"HandleAnnotationEvent - unsupported annotation");return}}else if(!d||"AugLoop_Automatic_Clp_LabellingAnnotation"!==d.annotationType){v.ULS.sendTraceTag(575972804,337,15,"HandleAnnotationEvent - unsupported annotation");
return}if(!m||m!==Wm.a.getTypeName()&&m!==Iv.a.getTypeName())v.ULS.sendTraceTag(575972805,337,15,"HandleAnnotationEvent - unsupported opType");else{m=d.content||{};d=m.automatic||{};var A=d.sensitivityLabel||{};d=this.cWc()?d.id:A.id;A=m.recommended||{};var R=A.sensitivityLabel||{};m=this.cWc()?A.id:R.id;A=this.cWc()?A.policyTip:R.policyTip;this.bba.REk(d,m,A,this.jQm())}}else v.ULS.sendTraceTag(575972803,337,15,"HandleAnnotationEvent - not IsNotRead")}jQm(){const d=sf.StaticActiveAppFrame.za().jb.Zc.Iba;
return!d.Yma||""===d.Yma||d.bKb}cWc(){return n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(y.a)(dA,"AutoClpAnnotationEventHandler",null,[55]);class qz{eIh(d,m,A,R,da,Ea,ib,Qb){const pc=m.E1f;let Pc="",gd="";const Cd=d.DefaultLabelId;let ae;d.SensitivityLabels.forEach(Xe=>{Xe.Id==Qb&&(Pc=Xe.ParentId);Xe.Id==pc&&(gd=Xe.ParentId);Xe.Id==Cd&&Xe.ParentId&&(ae=Xe.ParentId)});const Xd=[];d.SensitivityLabels.forEach(Xe=>{Xe.Id!=Qb&&Xe.Id!=
Pc&&Xe.Id!=pc&&Xe.Id!=gd&&Xe.Id!=d.DefaultLabelId||Xd.push(Xe);ae&&Xe.Id==ae&&Xd.push(Xe)});d.SensitivityLabels=Xd;const se={};se.clpLabelId=m.E1f||"";se.clpTenantId=R;se.clpApplyLabelFlags=m.tDa;se.clpSupportsOfficeClientCoauthoring=A;se.clpUserName=da;se.clpUserPrincipalName=Ea;se.clpDocLocation=ib;se.clpActions=rb.c(d);m=rb.c(se);A=[];A.push(m);return A}}Object(y.a)(qz,"AutoSaveParameterComposer",null,[854]);class Yr{}Yr.mGh="WordClpReadPolicy";Yr.$4b="WordClpSetPolicy";Yr.cHd="wordclpfc";Object(y.a)(Yr,
"Constants",null,[]);class ui{constructor(d){this.jdh=!0;this.LXg=this.Umd=this.KXg=0;this.Aid=this.OCe=!1;this.Y9c=this.Ib=null;this.yga=()=>Ab.App.zd.amIAlone||Ab.App.zd.yga&&Ab.App.zd.mC.aHa;this.rln=()=>{n.AFrameworkApplication.va.fb(xe.a.OHj,K.a.frame,this.DZo,96);uo.a.Gp(ui.W.Sa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(m=>{var A=0;na.Health.instance.recordKpiUsage(Yr.mGh,1,Yr.cHd,this.H2a());A=(new Date).getTime();ui.Hh=m.result;this.beb&&(ui.Hh.Rzm(Ab.App.Xoa().CWR(()=>Ab.App.Xoa().result.mC)),
ui.Hh.kAm(ui.W.Sa("Common.Interface.IRtcBasicProvider")),ui.Hh.yxk(this.S$l));ui.Hh.clb=ui.Hh.clb&&n.AFrameworkApplication.K.$("WordApplyManualPolicyLabelIsEnabled");this.Aid&&ui.Hh.Qzk(this.$un);ui.Hh.cDi=!0;ui.Hh.xnj=n.AFrameworkApplication.K.nc("WordClpSetPolicyLabelZeroByteFailureRetryIntervalMs",3E4);ui.Hh.GCd(this.Zun);ui.Hh.P0e(this.Yun);n.AFrameworkApplication.K.$("AutoClpIsEnabled")&&n.AFrameworkApplication.K.$("AugLoopAnnotationsIsEnabled")&&(ui.Hh.xxk(this.tVn),n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)&&(ui.Hh.txk(this.rJd),ui.Hh.Yzk(this.QUo),ui.Hh.Zzk(this.RUo)));ui.Hh.Xqh(this.NFk);ui.Hh.Wzk(this.QRo);m=n.AFrameworkApplication.K.kb("AppliedPolicyId");""===m&&(m=this.FTd().Yma);ui.$tb=m;n.AFrameworkApplication.pu||ui.Hh.iGb(m,Eb.boot,this.yga,!1);A=Object.assign(new uc.a,{durationMs:(new Date).getTime()-A});na.Health.instance.recordKpiSuccess(Yr.mGh,A)});uo.a.Gp(ui.W.Sa("Common.App.Policy.Contracts.IPolicyActor")).continueWith(m=>{ui.bba=m.result;ui.bba.clb=ui.bba.clb&&n.AFrameworkApplication.K.$("WordApplyManualPolicyLabelIsEnabled")})};
this.S$l=(m,A)=>{v.ULS.sendTraceTag(579203664,337,100,"GetPolicyLabelHandler");this.OCe&&(ui.$tb=ui.Hh.wy.AppliedPolicyId,ui.jye=ui.Hh.wy.PolicyLabelVersionToken);m=this.FTd();this.TFi(m.Yma,ui.Hh.wy.AppliedPolicyId)||!(0<this.Umd)||this.OCe&&A.T$l===Eb.selfSetPolicyLabel||(this.Umd--,v.ULS.sendTraceTag(579737543,337,15,"LabelId from host did not match content stream."),A=new $a.a(2,1,this.LXg,()=>{v.ULS.sendTraceTag(579715490,337,15,"Retrying GetDocumentPolicyLabelsRequestAsync after labelId mismatch. getPolicyRetryRemainingCount : {0}",
this.Umd);const R=this.FTd();ui.Hh.iGb(R.Yma,Eb.refresh,this.yga,!0)}),this.Ib.Wb(A))};this.DZo=(m,A,R)=>{v.ULS.sendTraceTag(579203665,337,100,"UpdatePolicyLabelFromBox4 - Begin.");if(1===R)return 32;m=this.FTd();const da=m.Yma;m=this.beb?m.GNb:null;if(this.beb?ui.jye===m:this.TFi(ui.$tb,da))return v.ULS.sendTraceTag(579203666,337,100,"UpdatePolicyLabelFromBox4 - Label Change not detected."),32;v.ULS.sendTraceTag(579203667,337,100,"UpdatePolicyLabelFromBox4 - Label Change detected.");this.Umd=this.KXg;
ui.Hh?ui.Hh.iGb(da,Eb.refresh,this.yga,!0):uo.a.Gp(ui.W.Sa("Common.App.Policy.Contracts.IPolicyManager")).continueWith(Ea=>{ui.Hh=Ea.result;ui.Hh.iGb(da,Eb.refresh,this.yga,!0)});ui.$tb&&(ui.lPe=ui.$tb);ui.$tb=da;this.beb&&(ui.jye=m);v.ULS.sendTraceTag(579203668,337,100,"UpdatePolicyLabelFromBox4 - End.");return 32};this.$un=(m,A)=>{m=this.H2a(A.H2e);na.Health.instance.recordKpiUsage(Yr.$4b,1,Yr.cHd,m);this.Y9c=this.nq()};this.Yun=(m,A)=>{this.Aid||na.Health.instance.recordKpiUsage(Yr.$4b,1,Yr.cHd,
this.H2a());m=this.Qib(A.H2e,this.Y9c);m.extendedProperties.set("ErrorType",oz[A.errorType]);na.Health.instance.recordKpiFailure(Yr.$4b,"Shared or Host SetPolicyLabel failure.",!1,!1,m)};this.Zun=(m,A)=>{this.Aid||(na.Health.instance.recordKpiUsage(Yr.$4b,1,Yr.cHd,this.H2a()),this.Y9c=this.nq());m=sf.StaticActiveAppFrame.za().jb.Zc;if(!this.beb){var R=new Ze.GraphTransaction(0);try{R.Db(m),m.Iba.Yma=A.E1f}finally{R&&R.dispose()}}ui.Dhd=ui.W.resolve("WordEditor.AutoSaveParamsUpdateService");R=new If.GraphIterator;
R.set(m);if(ui.lA.GP(R)){m=R.Tb(35);R=ui.Hh.wy;var da=wc.a.Ieg,Ea=n.AFrameworkApplication.K,ib=null;ib=Ea.kb("EditDocInClientUrl");ib||(v.ULS.sendTraceTag(523567771,337,50,"EditDocInClientUrl setting was empty. Falling back to WopiSrc"),ib=Ea.kb("WopiSrc"));ib||v.ULS.sendTraceTag(523567772,337,10,"WopiSrc setting was empty.");var Qb=null;Qb=ui.lPe?this.SMg.eIh(R,A,this.beb,Ea.kb("TenantId"),Ea.kb("UserName"),Ea.kb("UserPrincipalName"),ib,ui.lPe):this.SMg.eIh(R,A,this.beb,Ea.kb("TenantId"),Ea.kb("UserName"),
Ea.kb("UserPrincipalName"),ib,ui.$tb);ui.Dhd.bkj(m,da,Qb,()=>{const pc=this.Qib(A.tDa,this.Y9c);na.Health.instance.recordKpiSuccess(Yr.$4b,pc)},(pc,Pc)=>{pc=this.Qib(A.tDa,this.Y9c);pc.extendedProperties.set("statusCode",ft.a[Pc]);na.Health.instance.recordKpiFailure(Yr.$4b,"Word Save Failed",!1,!1,pc);v.ULS.sendTraceTag(592311969,337,10,"SetPolicyLabel Save failed with {0}.",ft.a[Pc])})}};this.tVn=()=>{this.jdh&&(ui.KMg=new dA(ui.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),ui.W.resolve("Common.App.Policy.Contracts.IPolicyActor"),
ui.Hh),ui.KMg.initialize());this.jdh=!1};this.rJd=(m,A)=>{const R=Object.assign(new Wm.a,{parentPath:["session","doc","security"],items:[Object.assign(new Zq.a,{id:"clp",body:Object.assign(new oy.CLP,{existingLabelPriority:A.existingLabelPriority,partialDocSITs:A.lGh,fullDocSITs:A.kGh})})]});jr.a.ll().then(()=>{xx.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new nq.a,{operation:R}))})};this.QUo=(m,A)=>{const R=Object.assign(new Iv.a,{parentPath:["session","doc","security"],items:[Object.assign(new Zq.a,
{id:"clp",body:Object.assign(new oy.CLP,{existingLabelPriority:A.existingLabelPriority})})]});jr.a.ll().then(()=>{xx.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new nq.a,{operation:R}))})};this.RUo=(m,A)=>{const R=Object.assign(new Iv.a,{parentPath:["session","doc","security"],items:[Object.assign(new Zq.a,{id:"clp",body:Object.assign(new oy.CLP,{partialDocSITs:A.lGh,fullDocSITs:A.kGh})})]});jr.a.ll().then(()=>{xx.a.getAugLoopRuntimeManager().submitOperation(Object.assign(new nq.a,
{operation:R}))})};this.NFk=(m,A)=>{A&&A.appMode?(m=1===A.appMode,n.AFrameworkApplication.va.Qb(m?Ac.a.cnc:Ac.a.N8a,2,{IsFromMandatoryLabeling:!0}),m||""===A.FNi||ui.bba.OFk(A.FNi),A=m?1:3,m=n.AFrameworkApplication.va.mode,A!==m&&v.ULS.sendTraceTag(545818049,337,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",A,m)):v.ULS.sendTraceTag(572302786,337,15,"ApplyMandatoryLabeling is called with invalid inputs.")};this.QRo=(m,A)=>{A.Xto&&n.AFrameworkApplication.va.Qb(xe.a.openInClient,
2,!1)};this.SMg=d}get beb(){return n.AFrameworkApplication.K.$("SupportsOfficeClientCoauthoring")&&n.AFrameworkApplication.K.$("CoAuthForProtectedFilesIsEnabled")}get name(){return"WordEditor.Policy"}init(){ui.lA=ye.PageNavigator.instance;this.Ib=ab.a.instance;ui.Zb.pq.continueWith(()=>{this.xn()});this.KXg=n.AFrameworkApplication.K.nc("WordClpGetPolicyRetryCount",10);this.LXg=n.AFrameworkApplication.K.nc("WordClpGetPolicyRetryTimeoutMs",3E4);this.OCe=n.AFrameworkApplication.K.$("WordClpGetPolicyUpdateLocal");
this.Aid=n.AFrameworkApplication.K.$("ClpKpiIsEnabled")}dispose(){}wc(d){ui.W=d;ui.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new pz.a(ui.W.resolve("Box4.Graph.IGraphIteratorFactory"),Oi.a.mR)).ha()}nq(){return(new Date).getTime()}xn(){ui.Zb.isFeatureEnabled(66)&&n.AFrameworkApplication.K.$("SupportsPolicies")&&db.a.get_instance().pk(10,this.rln)}H2a(d=null){const m=new Map;m.set("ClpCoauth",this.beb.toString());null!=d&&m.set("ApplyLabelFlags",Nb[d]);return m}FTd(){return sf.StaticActiveAppFrame.za().jb.Zc.Iba}TFi(d,
m){return(d||"")===(m||"")}Qib(d,m){const A=new uc.a;A.extendedProperties=this.H2a(d);null!=m&&(A.durationMs=this.nq()-m);return A}static get Zb(){return null!=ui.Azg?ui.Azg:ui.Azg=ui.W.resolve("Box4.IFeatureHelper")}static main(){z.a.instance.Gc(new ui(new qz))}}ui.W=null;ui.Hh=null;ui.bba=null;ui.Dhd=null;ui.lA=null;ui.KMg=null;ui.$tb="";ui.jye="";ui.lPe="";Object(y.a)(ui,"WordEditorPolicyPackage",null,[1,2]);class Mu{}Mu.SIn="Microsoft.Office.WordOnline.ProactiveUxOpenedCooldownMilliseconds";Mu.RIn=
"Microsoft.Office.WordOnline.ProactiveUxEngagedCooldownMilliseconds";Object(y.a)(Mu,"Constants",null,[]);class py{constructor(d,m=null){this.fCc=new U.a;this.Ca=d;this.xD=m?m:()=>new Date;this.Uok=this.Ca.getIntFeatureGate(Mu.SIn,24E4);this.Sok=this.Ca.getIntFeatureGate(Mu.RIn,6E4)}X9i(d){this.fCc.contains(d)||this.fCc.add(d)}O3e(d,m){if(1===this.fCc.count&&this.fCc.J(0).id===d)m();else{v.ULS.sendTraceTag(572339906,3025,50,"{0} attempted to trigger proactively",d);var A=this.xD(),R=null,da=null,Ea=
null;for(const ib of this.fCc){if(ib.id===d&&ib.Dhc){v.ULS.shipAssertTag(572592797,3025,!1,"{0} is already open",d);return}this.yyi(ib.Dhc,R?R.Dhc:null)&&(R=ib);this.yyi(ib.wNc,da?da.wNc:null)&&(da=ib)}R&&this.sqj(A,R.Dhc,this.Uok)?Ea=R:da&&this.sqj(A,da.wNc,this.Sok)&&(Ea=da);Ea?v.ULS.sendTraceTag(572838542,3025,50,JSON.stringify({Sdp:d,w$o:Ea.id,x$o:Ea.Dhc,v$o:Ea.wNc})):m()}}yyi(d,m){return!!d&&(!m||d>m)}sqj(d,m,A){return!!m&&+d-+m<A}}Object(y.a)(py,"ProactiveUxManager",null,[881]);class eu{get name(){return"WordEditor.ProactiveUxGovernance"}init(){}wc(d){d?
d.ia("WordEditor.ProactiveUxGovernance.IProactiveUxManager",()=>new py(n.AFrameworkApplication.K)).ha():v.ULS.shipAssertTag(572838541,3025,!1)}dispose(){}}Object(y.a)(eu,"PackageManager",null,[1,2]);class qy{constructor(d){this.name=d;this.PVh=1;this._lcidMap=[]}ruk(d,m){if(!m)throw Error.argumentNull(m.toLocaleString());this._lcidMap[d]=m}zRd(d){return this._lcidMap[d&1023]}isValid(){return this.name&&this._lcidMap?!0:!1}}Object(y.a)(qy,"LanguageModel",null,[1064,1063]);class eA{constructor(){this.Tbg=
this.igc=this.nMc=this.Gkc=this.atg=0}isValid(){return 0>=this.atg||0>=this.Gkc||0>=this.Tbg||this.igc>this.Gkc?!1:!0}}Object(y.a)(eA,"ObjectCountParameterSet",null,[1063]);class cB{constructor(){this.K0j=this.H0j=this.Q0j=this.P0j=0}create(d){switch(d){case 1:return this.eal();default:throw Error.notImplemented("algorithmType");}}eal(){const d=new qy("Default language model based on word, image and table count");this.pc(d,0,0);this.pc(d,1,138);this.pc(d,2,184);this.pc(d,3,218);this.pc(d,4,158);this.pc(d,
5,166);this.pc(d,6,199);this.pc(d,7,179);this.pc(d,8,184);this.pc(d,9,228);this.pc(d,10,218);this.pc(d,11,161);this.pc(d,12,195);this.pc(d,13,187);this.pc(d,14,161);this.pc(d,15,179);this.pc(d,16,188);this.pc(d,17,193);this.pc(d,18,193);this.pc(d,19,202);this.pc(d,20,199);this.pc(d,21,166);this.pc(d,22,181);this.pc(d,23,228);this.pc(d,24,188);this.pc(d,25,184);this.pc(d,26,180);this.pc(d,27,180);this.pc(d,28,180);this.pc(d,29,199);this.pc(d,30,193);this.pc(d,31,166);this.pc(d,32,138);this.pc(d,33,
228);this.pc(d,34,184);this.pc(d,35,184);this.pc(d,36,180);this.pc(d,37,161);this.pc(d,38,180);this.pc(d,39,180);this.pc(d,40,228);this.pc(d,41,138);this.pc(d,42,193);this.pc(d,43,138);this.pc(d,44,138);this.pc(d,45,166);this.pc(d,46,228);this.pc(d,47,180);this.pc(d,48,228);this.pc(d,49,228);this.pc(d,50,228);this.pc(d,51,228);this.pc(d,52,228);this.pc(d,53,228);this.pc(d,54,202);this.pc(d,55,184);this.pc(d,56,199);this.pc(d,57,228);this.pc(d,58,228);this.pc(d,59,228);this.pc(d,60,228);this.pc(d,
61,179);this.pc(d,62,228);this.pc(d,63,184);this.pc(d,64,184);this.pc(d,65,228);this.pc(d,66,228);this.pc(d,67,184);this.pc(d,68,184);this.pc(d,69,228);this.pc(d,70,228);this.pc(d,71,228);this.pc(d,72,228);this.pc(d,73,228);this.pc(d,74,228);this.pc(d,75,228);this.pc(d,76,228);this.pc(d,77,228);this.pc(d,78,228);this.pc(d,79,228);this.pc(d,80,166);this.pc(d,81,228);this.pc(d,82,228);this.pc(d,83,228);this.pc(d,84,228);this.pc(d,85,193);this.pc(d,86,218);this.pc(d,87,228);this.pc(d,88,228);this.pc(d,
89,228);this.pc(d,90,228);this.pc(d,91,228);this.pc(d,92,228);this.pc(d,93,228);this.pc(d,94,228);this.pc(d,95,228);this.pc(d,96,228);this.pc(d,97,228);this.pc(d,98,228);this.pc(d,99,228);this.pc(d,100,228);this.pc(d,101,228);this.pc(d,102,228);this.pc(d,103,228);this.pc(d,104,228);this.pc(d,105,228);this.pc(d,106,228);this.pc(d,107,228);this.pc(d,108,228);this.pc(d,109,228);this.pc(d,110,228);this.pc(d,111,228);this.pc(d,112,228);this.pc(d,113,228);this.pc(d,114,228);this.pc(d,115,228);this.pc(d,
116,228);this.pc(d,117,228);this.pc(d,118,228);this.pc(d,119,228);this.pc(d,120,228);this.pc(d,121,228);this.pc(d,122,228);this.pc(d,124,228);this.pc(d,126,228);this.pc(d,127,228);this.pc(d,128,228);this.pc(d,129,228);this.pc(d,130,228);this.pc(d,131,228);this.pc(d,132,228);this.pc(d,133,228);this.pc(d,134,228);this.pc(d,135,228);this.pc(d,136,228);this.pc(d,140,228);this.pc(d,145,228);this.pc(d,146,228);this.pc(d,147,228);return d}pc(d,m,A){d.ruk(m,Object.assign(new eA,{atg:A,Gkc:this.P0j,Tbg:this.Q0j,
nMc:this.H0j,igc:this.K0j}))}}Object(y.a)(cB,"LanguageModelFactory",null,[1050]);class yx{constructor(){this.g8i=this.bDf=this.VDb=0}}Object(y.a)(yx,"ReadingTimeValue",null,[]);class fu{constructor(){this.PVh=this.D1e=1;this.nlg=this.UAf=this.Isg=this.Eng=-1}}Object(y.a)(fu,"ReadingTimeOutput",null,[]);class rz{constructor(){this.S8g=!1;this.y3k=(d,m)=>m.VDb>d.VDb?1:d.VDb>m.VDb?-1:0}get D1e(){return 1}muf(d,m,A){if(!d)throw Error.argumentNull("ReadingTimeInput");if(!m)throw Error.argumentNull("ObjectCountParameterSet");
if(!A)throw Error.argumentNull("Language model is null");var R=new U.a,da=0;for(var Ea=0;Ea<d.p5a.count;Ea++){var ib=A.zRd(d.p5a.J(Ea));void 0!==ib&&null!==ib?da+=d.zsb.J(Ea)/A.zRd(d.p5a.J(Ea)).atg:this.S8g||(this.S8g=!0,v.ULS.sendTraceTag(41554646,338,50,"Language in paragraph is not supported in language model and is holding {0} words",d.zsb.J(Ea)))}this.E_e(R,da,0);da=A=0;Ea=m.Gkc;0<m.nMc&&(A=Math.floor((m.Gkc-m.igc)/m.nMc),da=(m.Gkc-m.igc)%m.nMc,Ea=m.igc);Ea=Math.max(0,(d.HJ-A)*Ea);for(ib=A;ib>=
Math.max(0,A-d.HJ+1);--ib)Ea+=m.igc+da+ib*m.nMc;this.E_e(R,Ea/60,1);this.E_e(R,d.X$*m.Tbg/60,2);d=this.sSk(R);R.Sc(this.y3k);m=this.tSk(R);d=Object.assign(new fu,{D1e:this.D1e,PVh:1,Eng:d});m=Math.round(m);for(const Qb of R){R=Qb.bDf+(0<m?1:0);switch(Qb.g8i){case 0:d.Isg=R;break;case 1:d.UAf=R;break;case 2:d.nlg=R}0<m&&m--}return d}E_e(d,m,A){d.add(Object.assign(new yx,{g8i:A,bDf:this.ofi(m,Math.floor),VDb:m%1}))}sSk(d){let m=0;for(const A of d)m+=A.bDf+A.VDb;return this.ofi(m,Math.ceil)}tSk(d){let m=
0;for(const A of d)m+=A.VDb;return m}ofi(d,m){d=m(d);if(!this.isSafeInteger(d)||0>d)throw Error.argumentOutOfRange("result is not a positive safe integer");return d}isSafeInteger(d){return isFinite(d)&&Math.floor(d)===d&&Math.abs(d)<=this.MAX_SAFE_INTEGER}get MAX_SAFE_INTEGER(){return 9007199254740991}}Object(y.a)(rz,"ObjectCountReadingTimeStrategy",null,[1065]);class gu{constructor(d,m){if(!d)throw Error.argumentNull("IReadingTimeStrategy");if(!m)throw Error.argumentNull("ILanguageModel");if(!m.isValid())throw Error.argument("ILanguageModel");
this.bhk=d;this.LIe=m}muf(d){if(this.isValid(d)){if(this.yPm(d))return new fu;if(!this.yHk(d))throw Error.argument("Input fields are in invalid state");}else throw Error.argument("ReadingTimeInput is null");let m=this.LIe.zRd(d.LCID);if(void 0===m||null===m)m=this.LIe.zRd(0);return this.bhk.muf(d,m,this.LIe)}isValid(d){return d?!0:!1}yPm(d){return 0>d.HJ&&0>d.X$&&!d.p5a&&!d.zsb}yHk(d){return 0<=d.HJ&&0<=d.X$&&!!d.LCID}}Object(y.a)(gu,"ReadingTimeAlgorithm",null,[1062]);class fA{constructor(d){this.g4g=
d}create(d){if(!this.g4g)throw Error.argumentNull("ILanguageModelFactory");switch(d){case 1:return this.createInstance(new rz,this.g4g.create(d));default:throw Error.notImplemented("WordCount");}}createInstance(d,m){if(!d)throw Error.argumentNull("IReadingTimeStrategy");if(!m)throw Error.argumentNull("LanguageModel");return new gu(d,m)}}Object(y.a)(fA,"ReadingTimeFactory",null,[1049]);var dB=c(376);class sz{constructor(){this.Bnb=this.znb=this.numWords=this.LIo=this.lym=this.X8o=this.HTa=-1}}Object(y.a)(sz,
"ReadingTimeStats",null,[1076]);class ry{constructor(){this.l6=new sz;this.K5=new sz;this.kKj=this.jKj=!1}get bTi(){return this.n$b(this.K5.numWords,this.l6.numWords,"WC",this.zYc())}get gRn(){return this.nuf(this.K5.HTa,this.l6.HTa,this.K5.numWords+this.K5.znb+this.K5.Bnb,this.l6.numWords+this.l6.znb+this.l6.Bnb,"RTSB")}get dRn(){return this.nuf(this.K5.HTa,this.l6.HTa,this.K5.numWords+this.K5.znb+this.K5.Bnb,this.l6.numWords+this.l6.znb+this.l6.Bnb,"RTDB",!0)}get eRn(){return this.Fbm(this.K5.HTa,
this.l6.HTa,this.K5.numWords+this.K5.znb+this.K5.Bnb,this.l6.numWords+this.l6.znb+this.l6.Bnb)}get cRn(){return this.zYc()?WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogSelectionDescription:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatsDialogDescription}$4h(d,m,A,R){return R?this.Krg(d,m,A):this.Ged(m,A)}n$b(d,m,A,R){return this.$4h(d,m,A,R).toLocaleString()}ouf(d,m,A,R,da,Ea,ib=!1){d=this.$4h(d,m,da,Ea);A=Ea?A:R;R=Math.floor(d/1440);da=d%1440;d=Math.floor(da/60);da%=60;if(0<R)return d?
String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,R),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,d)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultDay,R);if(0<d)return da?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultComposite,String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,d),String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin,
da)):String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeResultHour,d);m=Ea&&60>m&&!ib?WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMinWithoutAbbreviation:WordEditorIntl.WordEditorStrings.L_ReadingTimeResultMin;return!da&&0<A?WordEditorIntl.WordEditorStrings.L_ReadingTimeLessThanOneMin:String.format(m,da)}nuf(d,m,A,R,da,Ea=!1){const ib=this.zYc(),Qb=this.ouf(d,m,A,R,da,ib);d=ib?this.ouf(d,m,A,R,da,!1):Qb;m=Ea?WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBox:WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionStatusBar;
Ea=Ea?d:WordEditorIntl.WordEditorStrings.L_ReadingTimeStatusBar;Ea=ib?m:Ea;return ib?String.format(Ea,Qb,d):String.format(Ea,Qb)}Fbm(d,m,A,R){const da=this.ouf(d,m,A,R,"RTDT",this.zYc(),!0);return this.zYc()?String.format(WordEditorIntl.WordEditorStrings.L_ReadingTimeSelectionDialogBoxTitle,da):this.nuf(d,m,A,R,"RTDT")}Krg(d,m,A){d=this.Ged(d,A);return d>m?(this.kKj||(this.kKj=!0,v.ULS.sendTraceTag(40916112,338,15,"Sel>Total for {0}",A)),m):d}Ged(d,m){0>d&&!this.jKj&&(this.jKj=!0,v.ULS.sendTraceTag(40916113,
338,15,"{0}<0",m));return Math.max(d,0)}zYc(){return 0<this.K5.numWords+this.K5.znb+this.K5.Bnb}}Object(y.a)(ry,"ReadingTimeStatsFacade",null,[]);class Zv{}Zv.fRn="ReadingTimeButton";Object(y.a)(Zv,"ReadingTimeConstants",null,[]);class hu{constructor(d,m,A,R,da,Ea){this.nwc=this.nYb=!1;this.pHe=!0;this.nvd="";this.Aje=(ib,Qb,pc)=>{if(1===pc)return this.Ndc?32:8;ib=this.je.Yf("UserAction","Show Reading Time Dialog.");ib.start();Qb=this.h3i();if(!Qb||0>Qb.l6.HTa)return 8;this.x_.Sxa&&v.ULS.sendTraceTag(40916104,
338,50,"Open reading time dialog with total reading time of {0}.",Qb.l6.HTa);pc=new xb.StandardDialog;pc.Cd=0;pc.lka(Qb.eRn,String.format(Qb.cRn,Qb.dRn),null);ib.stop();return 32};this.Lme=(ib,Qb,pc)=>{if(1===pc)return this.Sxa?32:8;this.Ndc?this.jpl():this.Tvl();sf.StaticActiveAppFrame.za().lH({ShowReadingTime:"CheckboxModel"});return 32};this.gce=(ib,Qb,pc,Pc,gd)=>{if(1===pc)return this.Sxa?32:8;gd[Je.a.On]=this.Ndc;return 32};this.fce=(ib,Qb,pc,Pc,gd)=>{if(1===pc)return 32;gd[Ii.a.Visible]=this.nvd!==
WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden;gd[Ii.a.LabelText]=this.nvd;return 32};this.otn=()=>{this.Wdd()};this.VXi=()=>{this.Wdd()};this.x_=d;this.iDc=m;this.Fxe=R;this.Gxe=A;this.WDc=da;this.je=Ea;this.x_.Czk(this.otn);this.iDc.Sxa&&this.iDc.Srh(this.VXi);this.x_.Srh(this.VXi);this.Wdd()}get oef(){return!ld.a.W4}Ub(){const d=n.AFrameworkApplication.va;d.qa(Ac.a.Aje,ic.a.view,this.Aje);d.fb(Ac.a.fce,ic.a.application,this.fce,96);d.qa(Ac.a.Lme,ic.a.application,this.Lme);d.fb(Ac.a.gce,ic.a.application,
this.gce,96)}Tvl(){this.Sxa&&(this.mpj(!0),this.ahe(!0),this.Wdd())}jpl(){this.mpj(!1);this.ahe(!1);this.Wdd()}get Ndc(){this.nYb||(this.pHe=this.Fxe("WACReadingTimeEnabled",this.oef),this.nYb=!0);return this.pHe}mpj(d){this.pHe=d}get Sxa(){return this.x_.Sxa}get eK(){return null!=this.yHg?this.yHg:this.yHg=(()=>this.WDc())()}h3i(){const d=new ry;this.tIj(d.l6,this.x_);this.iDc.Sxa&&this.tIj(d.K5,this.iDc);return d}tIj(d,m){d.HTa=m.Pva.Eng;d.X8o=m.Pva.Isg;d.lym=m.Pva.UAf;d.LIo=m.Pva.nlg;d.numWords=
m.Lx;d.znb=m.HDb;d.Bnb=m.LDb}HJl(){this.x_.Moe();this.iDc.Moe();const d=this.h3i();return this.Ndc&&this.Sxa?0>d.l6.HTa?WordEditorIntl.WordEditorStrings.L_ReadingTimeCalculating:d.gRn:WordEditorIntl.WordEditorStrings.L_ReadingTimeHidden}Wdd(){hu.Hk.ie(()=>{this.Lto(this.x_)&&(v.ULS.sendTraceTag(40916106,338,50,"Reading time document stats: {0}",{["totalReadingTime"]:this.x_.Pva?this.x_.Pva.Eng:-1,["wordReadingTime"]:this.x_.Pva?this.x_.Pva.Isg:-1,["imageReadingTime"]:this.x_.Pva?this.x_.Pva.UAf:-1,
["tableReadingTime"]:this.x_.Pva?this.x_.Pva.nlg:-1,["words"]:this.x_.Lx,["images"]:this.x_.HDb,["tables"]:this.x_.LDb}),this.nwc=!0);const d=this.HJl();this.eK&&d!==this.nvd&&(this.nvd=d,this.eK.pV(Zv.fRn))},"RIA:URTD")}ahe(d){this.Gxe("WACReadingTimeEnabled",d?"true":"false",Sl.a.pHa)}Lto(d){return!this.nwc&&-1!==d.HDb&&-1!==d.Lx&&-1!==d.LDb}static get Hk(){return dB.a.instance}}Object(y.a)(hu,"ReadingTimeActor",null,[]);class Zr{constructor(){this.LCID=1033;this.X$=this.HJ=-1;this.zsb=new U.a;
this.p5a=new U.a}}Object(y.a)(Zr,"ReadingTimeInput",null,[]);class Ls extends Sys.EventArgs{constructor(d){super();this.isEnabled=d}}Object(y.a)(Ls,"ReadingTimeAvailabilityChangedEventArg",Sys.EventArgs,[]);class Jq extends Sys.EventArgs{constructor(d){super();this.state=d}}Object(y.a)(Jq,"ReadingTimeChangedEventArg",Sys.EventArgs,[]);class gA{constructor(d,m,A,R,da,Ea){this.mvd=null;this.eub=new fu;this.$I=null;this.zld=!1;this.sa=new vb.a;this.Ahc=()=>{this.Sxa?this.Qz():this.caa();this.Moe();this.uPn(this.Sxa)};
this.Mda=()=>{this.Moe();this.vPn(this.eub)};this.OI=d;this.hb=m;try{this.mvd=A.create(1)}catch(ib){this.mvd=null,v.ULS.sendTraceTag(40916107,338,15,"Error when retrieving the reading time algorithm: [message: {0}] [callstack: {1}].",ib.message,ib.stack)}this.RXa=Ea.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Xik=Ea.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.Imh=da;R.execute(ib=>{this.$I=ib.getInstance(this.Imh);this.Ahc(this,null)})}Qz(){this.zld||
(this.$I.S0e(this.Ahc),this.$I.dfb(this.Mda),this.zld=!0)}caa(){this.zld&&(this.$I.$2n(this.Ahc),this.$I.fee(this.Mda),this.zld=!1)}G2l(){return this.OI.FFa(this.hb.qg)}Moe(){if(this.Sxa){var d=new Zr;d.HJ=this.HDb;d.X$=this.LDb;d.LCID=this.G2l();d.zsb=this.Shl;d.p5a=this.odf;try{if(this.eub=this.mvd.muf(d),void 0===this.eub||null===this.eub)this.eub=new fu}catch(m){this.eub=new fu,v.ULS.sendTraceTag(40916108,338,15,"Error when retrieving reading time: [message: {0}] [callstack: {1}].",m.message,
m.stack)}}}vPn(d){this.sa.raiseEvent("rttek",new Jq(d))}uPn(d){this.sa.raiseEvent("rtac",new Ls(d))}Srh(d){this.sa.addHandler("rttek",d)}Czk(d){this.sa.addHandler("rtac",d)}get Pva(){return this.eub}get Lx(){return this.$I?this.$I.Lx:-1}get odf(){return this.$I?this.$I.odf:null}get Shl(){return this.$I?this.$I.Thl:null}get HDb(){return this.$I?this.$I.HDb:-1}get LDb(){return this.$I?this.$I.LDb:-1}get Sxa(){return!!this.mvd&&this.fSa&&!(1===this.Imh&&!this.Xik)}get fSa(){return this.RXa&&!!this.$I&&
this.$I.fSa}}Object(y.a)(gA,"ReadingTimeManager",null,[853]);class $r{constructor(){this.dQe=this.W=null;this.pka=()=>{this.oka()}}get name(){return"WordEditor.ReadingTime"}init(){if(this.Ndc()){const d=sf.StaticActiveAppFrame.za().jb;d.Cxa?(d.qpb(this.pka),this.oka()):d.vga(this.pka);v.ULS.sendTraceTag(40916109,338,50,"Reading time package initialized.")}}Ndc(){return n.AFrameworkApplication.K.$("ReadingTimeIsEnabled")&&n.AFrameworkApplication.K.$("EnableTimeToReadAsPremiumFeature")}dispose(){}wc(d){this.W=
d;this.W.ia("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory",()=>new cB).ha();this.W.ia("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory",()=>new fA(this.W.resolve("WordEditor.ReadingTime.Algorithm.ILanguageModelFactory"))).ha();this.W.ia("WordEditor.ReadingTime.IReadingTimeManager",()=>new gA(Ia.a.instance.resolve("Box4.ILanguageReader"),sh.a.instance,this.W.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.W.Sa("WordEditor.WordCount.IWordCountManagerFactory"),0,Ia.a.instance.resolve("Common.IAppSettingsManager"))).ha()}oka(){Ab.App.li?
this.dQe?v.ULS.sendTraceTag(40916111,306,15,"ReadingTimeActor is alreadyd initialized. Skipping feature bootstrapping."):(this.dQe=new hu(Ia.a.instance.resolve("WordEditor.ReadingTime.IReadingTimeManager"),new gA(Ia.a.instance.resolve("Box4.ILanguageReader"),sh.a.instance,this.W.resolve("WordEditor.ReadingTime.Algorithm.IReadingTimeFactory"),this.W.Sa("WordEditor.WordCount.IWordCountManagerFactory"),1,Ia.a.instance.resolve("Common.IAppSettingsManager")),Sl.a.ZIa,Sl.a.tca,()=>Ia.a.instance.Oa("WordEditor.IStatusBarUser"),
Ia.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")),this.dQe.Ub()):v.ULS.sendTraceTag(40916110,306,15,"TheNotebookManager is null. Reading Time will not be available.")}static main(){z.a.instance.Gc(new $r)}}Object(y.a)($r,"ReadingTimePackage",null,[1,2]);var Ow=c(171);class Ms{}Ms.Y_f="ParagraphAdded";Ms.a0f="ParagraphDeleted";Ms.aBn="ParagraphTopologyAdded";Ms.bBn="ParagraphTopologyAttached";Ms.a1i="ParagraphTopologyDeleted";Ms.cBn="ParagraphTopologyChanged";Object(y.a)(Ms,
"SchemaNames",null,[]);class zx{}Object(y.a)(zx,"Lambda",null,[]);class Ax{constructor(d,m,A){this.exceptionType=d;this.message=m;this.data=A}static exceptionTypeToString(d){switch(d){case 0:return"Unknown";case 1:return"NoOutput";case 2:return"Authentication";case 3:return"JoinTimedOut";case 4:return"LambdaThrow";case 5:return"LambdaErrorCallback";default:return"Invalid Error Type"}}static parseExceptionData(d){let m="";try{m=String.fromCharCode.apply(null,d)}catch(A){return"Failed to decode exception data:"+
A.toString()}return m}}Object(y.a)(Ax,"LambdaException",null,[]);class ss{}ss.Osh="ResumeAnalysis.Request";ss.kBb="ResumeAnalysis.Response";Object(y.a)(ss,"ResumeAnalysisAugmentationSchemaNames",null,[]);var sy;(function(d){d[d.no=0]="no";d[d.Dnp=1]="maybe";d[d.yes=2]="yes"})(sy||(sy={}));Object(y.b)("ClassificationResult",sy);var ty;(function(d){d[d.success=0]="success";d[d.partialSuccess=1]="partialSuccess";d[d.error=2]="error";d[d.disabled=3]="disabled";d[d.trp=4]="resumeClassifierNotRan"})(ty||
(ty={}));Object(y.b)("Status",ty);class ot{constructor(){this.responseStatus=this.isResume=0;this.isCurrentUserAuthor=!1;this.httpStatusCode=0;this.editorServiceCorrelationId=null}static r8e(d){d=sy[d];return""===d?"Invalid result":d}static ufj(d){d=ty[d];return""===d?"Invalid status":d}}Object(y.a)(ot,"ResumeAnalysisResponse",null,[]);class wq{constructor(d,m,A){this.tte=this.vQe=this.Brc=null;this.w_m=(R,da,Ea)=>{da=null;v.ULS.sendTraceTag(40253441,388,50,"LambdaBeforeFunc was triggered.");try{const pc=
this.t_a.instance;if(pc)if(wq.Fqj(this.Ca,pc.getInstance(0)))if(v.ULS.sendTraceTag(40960031,388,50,"ResumeAnalysisWorkflow.LambdaBeforeFunc: Document is within the required size limit to be classified."),R)if(R&&R.Tile){var ib=R.Tile,Qb=this.Fnk.qKo(R,wq.OQe,this.vHc===wq.aff);Qb?(da=Qb,wq.OQe++,v.ULS.sendTraceTag(38416535,388,50,"{0}: Successfully converted tile {1} to ResumeAnalysis request.",this.jsa,ib.Id)):v.ULS.sendTraceTag(38416534,388,10,"{0}: ResumeAnalysisRequest is null for tile: {1}.",
this.jsa,ib.Id)}else v.ULS.sendTraceTag(38416533,388,10,"{0}: Tile for LambdaBeforeFunc is null.",this.jsa);else v.ULS.sendTraceTag(38416532,388,10,"{0}: Input for LambdaBeforeFunc is null.",this.jsa);else v.ULS.sendTraceTag(40253442,388,50,"{0}: Document character count has exceeded limit. Not running remote classification workflow.",this.jsa);else v.ULS.sendTraceTag(40767962,388,50,"{0}: WordCountManagerFactory hasn't been initialized yet. Not running remote classification workflow.",this.jsa)}catch(pc){v.ULS.sendTraceTag(38416536,
388,10,"{0}: Exception caught in LambdaBeforeDone: {1}.",this.jsa,pc)}finally{Ea(da)}};this.v_m=(R,da,Ea)=>{da=null;v.ULS.sendTraceTag(40253443,388,50,"LambdaAfterFunc was triggered.");try{if(R)if(R&&void 0!==R.responseStatus&&null!==R.responseStatus&&void 0!==R.isResume&&null!==R.isResume){switch(R.responseStatus){case 0:v.ULS.sendTraceTag(40253445,388,50,"Resume Classification response status: Success; EditorServiceCorrelationId {0}.",R.editorServiceCorrelationId);2!==R.isResume&&1!==R.isResume||
v.ULS.sendTraceTag(40253446,388,50,"Resume Classification result: {0}; EditorServiceCorrelationId {1}.",ot.r8e(R.isResume),R.editorServiceCorrelationId);break;case 4:v.ULS.sendTraceTag(40503426,388,100,"Resume Classification not ran; EditorServiceCorrelationId {0}.",R.editorServiceCorrelationId);break;default:v.ULS.sendTraceTag(40253447,388,10,"Resume Classification response status: {0}; EditorServiceCorrelationId {1}.",ot.ufj(R.responseStatus),R.editorServiceCorrelationId)}da=R}else R&&void 0!==
R.exceptionType&&null!==R.exceptionType&&void 0!==R.message&&null!==R.message&&void 0!==R.data&&null!==R.data&&void 0!==R.data.data&&null!==R.data.data?v.ULS.sendTraceTag(38896389,388,10,"LambdaAfter: Received exception: [Type] {0}, [Message] {1} [Exception] {2}",Ax.exceptionTypeToString(R.exceptionType),R.message,Ax.parseExceptionData(R.data.data)):v.ULS.sendTraceTag(38896390,388,10,"LambdaAfter: Unexpected input: {0}",JSON.stringify(R));else v.ULS.sendTraceTag(40253444,388,10,"LambdaAfter: Null input received from CloudAL.")}catch(ib){v.ULS.sendTraceTag(40702466,
388,10,"LambdaAfter: Exception occured - {0}.",ib)}finally{Ea(da)}};this.Fnk=d;this.Ca=m;this.t_a=A}get proto(){return""}get vKk(){this.Brc||(this.Brc=Object.assign(new zx,{name:"LambdaBefore_ResumeAnalysis",inputSchema:this.vHc,outputSchema:ss.Osh,func:this.w_m}));return this.Brc}get SZn(){this.vQe||(this.vQe=Object.assign(new zx,{name:"LambdaRemote_ResumeAnalysis",inputSchema:ss.Osh,outputSchema:ss.kBb,func:null}));return this.vQe}get xBk(){this.tte||(this.tte=Object.assign(new zx,{name:"LambdaAfter_ResumeAnalysis",
inputSchema:ss.kBb,outputSchema:ss.kBb,func:this.v_m}));return this.tte}upl(){this.Brc&&(this.Brc.func=()=>{},v.ULS.sendTraceTag(40960032,388,50,"LambdaBeforeFunc: {0} was disabled. Not running remote classification workflow.",this.jsa))}static get aff(){return wq._deletedSchemaName}static set aff(d){wq._deletedSchemaName=d}static Fqj(d,m){d=d.nc("ResumeClassificationMaxCharacterCountFilter",1E4);m=m.s6b;if(0>d||m<d)return!0;v.ULS.sendTraceTag(38634824,388,50,"ShouldDocumentBeClassified: Document classification was stopped as Doc Size[{0}] >= ResumeClassificationMaxCharacterCountFilter[{1}].",
m,d);return!1}static get requestOrderInSession(){return wq.OQe}}wq.OQe=1;wq._deletedSchemaName=null;Object(y.a)(wq,"AResumeAnalysisWorkflow",null,[]);class $v extends wq{constructor(d,m,A){super(d,m,A)}get jsa(){return"ResumeAnalysisTileAddedWorkflow"}get vHc(){return Ms.aBn}}Object(y.a)($v,"ResumeAnalysisTileAddedWorkflow",wq,[]);class Pw extends wq{constructor(d,m,A){super(d,m,A)}get jsa(){return"ResumeAnalysisTileAttachedWorkflow"}get vHc(){return Ms.bBn}}Object(y.a)(Pw,"ResumeAnalysisTileAttachedWorkflow",
wq,[]);class aw extends wq{constructor(d,m,A){super(d,m,A)}get jsa(){return"ResumeAnalysisTileChangedWorkflow"}get vHc(){return Ms.cBn}}Object(y.a)(aw,"ResumeAnalysisTileChangedWorkflow",wq,[]);class hA extends wq{constructor(d,m,A){super(d,m,A)}get jsa(){return"ResumeAnalysisTileDeletedWorkflow"}get vHc(){return Ms.a1i}}Object(y.a)(hA,"ResumeAnalysisTileDeletedWorkflow",wq,[]);class bi{constructor(){this.revisionId=null;this.revisionSequence=0;this.tileId=null;this.tileType=0}}Object(y.a)(bi,"TileMetadata",
null,[]);class Qw{constructor(){this.languageId=this.text=null}}Object(y.a)(Qw,"TileElement",null,[]);class eB{constructor(){this.nodes=null}}Object(y.a)(eB,"ReadingOrderTopology",null,[]);class mp{constructor(){this.deletedTileIds=this.readingOrderTopology=this.tiles=this.documentSessionId=null;this.requestOrderInSession=0;this.bestGuessUserLastNames=this.accessToken=null}}Object(y.a)(mp,"ResumeAnalysisRequest",null,[]);class tz{constructor(){this.elements=this.metadata=null}}Object(y.a)(tz,"ResumeAnalysisTile",
null,[]);class uy{constructor(){this.bestGuessUserLastNames=this.accessToken=null}qKo(d,m,A){if(!d)return v.ULS.sendTraceTag(38564366,388,10,"TextTileToResumeAnalysisRequest: Null or empty text tile request"),null;const R=d.Tile;if(!R||0>=m||null===R.Content&&!A)return v.ULS.sendTraceTag(38416537,388,10,"TextTileToResumeAnalysisRequest: Null or empty text tile or RequestOrderInSession is invalid : {0}.",(0>=m).toString()),null;const da=Object.assign(new bi,{tileId:R.Id,revisionSequence:R.RevisionSequence,
revisionId:R.RevisionId,tileType:1}),Ea=Object.assign(new Qw,{text:R.Content,languageId:R.Language}),ib=Object.assign(new mp,{requestOrderInSession:m,documentSessionId:n.AFrameworkApplication.userSessionId,accessToken:this.accessToken,bestGuessUserLastNames:this.bestGuessUserLastNames});A?ib.deletedTileIds=[R.Id]:(ib.tiles=[Object.assign(new tz,{metadata:da,elements:[Ea]})],ib.readingOrderTopology=Object.assign(new eB,{nodes:d.Topology}));v.ULS.sendTraceTag(40253448,388,50,"TextTileToResumeAnalysisRequest: TileId = {0}, RevisionSequence = {1}, RevisionId = {2}, languageId = {3}, requestOrderInSession = {4}, isDeleteRequest = {5}",
R.Id,R.RevisionSequence,R.RevisionId,R.Language,m,A);return ib}}Object(y.a)(uy,"TextTileToResumeAnalysisRequestTransformer",null,[875]);class as{constructor(){this.RequestedAudience=this.SessionId=null}static construct(d,m){const A=new as;A.SessionId=d;A.RequestedAudience=m;return A}}Object(y.a)(as,"EditorServiceTokenGeneratorRequest",null,[]);class fB{constructor(d,m,A){this.request=as.construct(d,m);this.headers=this.qOk(A)}gOn(d,m,A){v.ULS.sendTraceTag(40194629,388,50,"QueueTokenGenerationRequest: Adding GenerateEditorServiceToken request to the TheClientRequestManager; CorrelationId: {0}",
this.headers["X-CorrelationId"]);n.AFrameworkApplication.He.nj(String.format(d,Ab.App.webServiceBase,n.AFrameworkApplication.rootQuerySignature),2,rb.c(this.request),this.headers,!1,2,m,A,this.request)}qOk(d){return{["X-CorrelationId"]:d.toString()}}}Object(y.a)(fB,"EditorServiceTokenGenerator",null,[]);class uz{constructor(d,m=-1,A=-1){this.iyc=0;this.Ktd=this.tIe=null;this.Qwj=d+"PaneKeepClosedUntil";0>m&&n.AFrameworkApplication.K.zU("SdxNoInteractivityThresholdInSeconds",10);0>A&&n.AFrameworkApplication.K.zU("SdxKeepClosedTimeInHours",
336)}isPaneAutoOpened(){return!!this.Ktd}Ito(){if(0===this.iyc){const d=rj.a.instance.getItem(this.Qwj);d&&""!==d?(this.tIe=new Date(d),this.iyc=1):this.iyc=2}if(1===this.iyc){if(this.tIe>new Date)return!0;rj.a.instance.removeItem(this.Qwj);this.tIe=null;this.iyc=2}return!1}}Object(y.a)(uz,"TimeBasedPaneSuppressionHandler",null,[1267]);class vz{constructor(){this.handler=this.schemaName=null}}Object(y.a)(vz,"AddEventHandlerParameters",null,[]);class wz{constructor(){this.lambdaAfter=this.lambdaRemote=
this.lambdaBefore=this.name=null}}Object(y.a)(wz,"RegisterSimpleRemoteWorkflowParameters",null,[]);class gB{constructor(){this.handler=this.schemaName=null}}Object(y.a)(gB,"RemoveEventHandlerParameters",null,[]);class bC{constructor(d,m){this.RYe=this.aDc=null;this.Rmi=A=>{A=A.output;v.ULS.sendTraceTag(40253440,388,50,"HandlePaneAutoOpen was triggered.");A.responseStatus||(null===A||void 0===A.isResume||null===A.isResume?v.ULS.sendTraceTag(38896385,388,10,"HandleOnAugResult: response == null: {0}, response.IsResume==[null, undefined]: {1}",
null===A,void 0===A.isResume||null===A.isResume):(v.ULS.sendTraceTag(38896386,388,2===A.isResume?50:100,"Resume Classification Result: {0}, IsCurrentUserAuthor: {1}",ot.r8e(A.isResume),A.isCurrentUserAuthor),2===A.isResume&&A.isCurrentUserAuthor&&(A=(new Date).getTime()-n.AFrameworkApplication.xX,v.ULS.sendTraceTag(40478042,388,50,"First Yes Classification result. Elapsed time in ms since boot: {0}",A),this.aDc.Ito()||32===n.AFrameworkApplication.va.Qb(xe.a.Kyo,2,1)&&xx.a.getAugLoopRuntimeManager().removeEventHandler(Object.assign(new gB,
{schemaName:ss.kBb,handler:this.Rmi})))))};this.lwo=A=>{v.ULS.sendTraceTag(40960028,388,50,"ShouldWorkflowsBeDisabled was triggered.");if(A&&A.output){if(A=A.output,3===A.responseStatus||2===A.responseStatus||2===A.isResume){if(this.RYe)for(const R of this.RYe)R.upl();v.ULS.sendTraceTag(40960030,388,50,"ShouldWorkflowsBeDisabled: Workflows disabled; ResponseStatus: {0}; IsResume: {1}; HttpStatusCode: {2}; EditorServiceCorrelationId: {3}",ot.ufj(A.responseStatus),ot.r8e(A.isResume),A.httpStatusCode,
A.editorServiceCorrelationId)}}else v.ULS.sendTraceTag(40960029,388,50,"ShouldWorkflowsBeDisabled: resultData or resultData.Output was null. Abandoning ShouldWorkflowsBeDisabled check.")};this.Ca=d;this.Ca.$("ResumeClassificationIsEnabled")&&((v.ULS.sendTraceTag(38416530,388,100,"Initializing ResumeAssistantAugLoopRuntimeManager."),d=n.AFrameworkApplication.K.kb("ResumeAssistantAppAssetId"),this.aDc=new uz(d),m)?m.eRo(d,this.aDc)||(v.ULS.sendTraceTag(40478041,388,10,"panSuppresessionHandler is already registered."),
this.aDc=m.d9l(d)):(v.ULS.sendTraceTag(40478040,388,10,"sdxPaneSuppressionManager is null."),this.aDc=null))}initialize(d){return jr.a.ll().then(()=>{const m=xx.a.getAugLoopRuntimeManager();m.addEventHandler(Object.assign(new vz,{schemaName:ss.kBb,handler:this.Rmi}));m.addEventHandler(Object.assign(new vz,{schemaName:ss.kBb,handler:this.lwo}));m.addEventHandler(Object.assign(new vz,{schemaName:ss.kBb,handler:()=>{this.fDk()}}));const A=new U.a;if(d){for(const R of d)v.ULS.sendTraceTag(38416531,388,
50,"Registering remote workflow: "+R.jsa),A.add(m.registerSimpleRemoteWorkflow(Object.assign(new wz,{name:R.jsa,lambdaBefore:R.vKk,lambdaRemote:R.SZn,lambdaAfter:R.xBk})));this.RYe=d}return Promise.all(A.toArray())}).catch(()=>{})}fDk(){v.ULS.sendTraceTag(38896387,388,100,"Annotate ResumeClassifcation result.")}}Object(y.a)(bC,"ResumeAssistantAugLoopRuntimeManager",null,[856]);class Rw{constructor(){this.t_a=this.W=null;this.Dhb=Rh.a.create();this.Iul=d=>{if(void 0===d||null===d||void 0===d.data||
null===d.data||void 0===d.data.te||null===d.data.te)v.ULS.sendTraceTag(40194594,388,10,"EditorServiceTokenSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined; CorrelationId: {0}",this.Dhb);else if(d.data.Ne!==Xb.a.Zz)v.ULS.sendTraceTag(40194595,388,10,"EditorServiceTokenSuccessCallback: Editor Service token generation returned unexpected response code {0}; CorrelationId:{1}",d.data.Ne,this.Dhb);else try{const R=rb.a(d.data.te);if(this.af(R.AccessToken))v.ULS.sendTraceTag(40424461,
388,10,"EditorServiceTokenSuccessCallback: Auth Token for Resume Classification was null or empty; CorrelationId:{0}",this.Dhb);else{v.ULS.sendTraceTag(40194624,388,50,"EditorServiceTokenSuccessCallback: Auth Token for Resume Classification successfully received; CorrelationId:{0}",this.Dhb);var m=this.W.resolve("WordEditor.ResumeAssistant.ITextTileToResumeAnalysisRequestTransformer");m.accessToken=R.AccessToken;m.bestGuessUserLastNames=[];n.AFrameworkApplication.K.rw("BestGuessUserLastName")&&m.bestGuessUserLastNames.push(n.AFrameworkApplication.K.kb("BestGuessUserLastName"));
wq.aff=Ms.a1i;var A=[new $v(m,n.AFrameworkApplication.K,this.t_a),new Pw(m,n.AFrameworkApplication.K,this.t_a),new aw(m,n.AFrameworkApplication.K,this.t_a),new hA(m,n.AFrameworkApplication.K,this.t_a)];v.ULS.sendTraceTag(40194625,388,50,"EditorServiceTokenSuccessCallback: Resume will be classified. Initializing ResumeAssistantAugLoopRuntimeManager.");this.W.Sa("Box4.AugmentationLoop.TileView<Microsoft.Office.AugLoop.Text.TextTile,Box4.AViewableGraphNode>").execute(()=>{this.W.resolve("Common.IDynamicScriptLoaderProvider");
this.W.resolve("WordEditor.ResumeAssistant.ResumeAssistantAugLoopRuntimeManager").initialize(A)})}}catch(R){v.ULS.sendTraceTag(40194626,388,10,"EditorServiceTokenSuccessCallback: {0}; CorrelationId:{1}",R.message,this.Dhb)}};this.Gul=d=>{void 0===d||null===d||void 0===d.data||null===d.data||void 0===d.data.te||null===d.data.te?v.ULS.sendTraceTag(40194627,388,10,"EditorServiceTokenFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined; CorrelationId: {0}",this.Dhb):v.ULS.sendTraceTag(40194628,
388,10,"EditorServiceTokenFailCallback: Editor Service token generation server request failed:{0}; CorrelationId:{1}",d.data.te,this.Dhb)}}get Hul(){return"{0}/we/GenerateEditorServiceToken.ashx?{1}"}get name(){return"WordEditor.ResumeAssistant"}wc(d){this.W=d;this.W.ia("WordEditor.ResumeAssistant.TextTileToResumeAnalysisRequestTransformer",()=>new uy).as("WordEditor.ResumeAssistant.ITextTileToResumeAnalysisRequestTransformer").ha();this.W.ia("WordEditor.ResumeAssistant.ResumeAssistantAugLoopRuntimeManager",
()=>new bC(n.AFrameworkApplication.K,this.W.resolve("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager"))).ha()}init(){if(n.AFrameworkApplication.K.$("ResumeClassificationIsEnabled")&&n.AFrameworkApplication.K.$("ResumeClassificationShouldBeEnabled")){v.ULS.sendTraceTag(40194592,388,50,"Init: Resume Classification is enabled after boot. Will check EditorServiceApiResumeClassifierEndpoint and wait for WordCount to initialized to proceed.");const A=n.AFrameworkApplication.K.kb("EditorServiceGenerateTokenResumeClassifierRequestedAudience");
if(this.af(A))v.ULS.sendTraceTag(40194593,388,10,"Init: Resume Classification will not be enabled as Config value EditorServiceGenerateTokenResumeClassifierRequestedAudience was empty.");else{this.t_a=this.W.Sa("WordEditor.WordCount.IWordCountManagerFactory");var d=Ow.a.instance.pDd,m=uo.a.Gp(this.t_a);eb.Task.WAA.call(null,d,m).continueWith(()=>{v.ULS.sendTraceTag(38634822,388,50,"Init: WordCount has been initialized. Will verify if Resume Classification can proceed.");wq.Fqj(n.AFrameworkApplication.K,
this.t_a.instance.getInstance(0))&&(v.ULS.sendTraceTag(38634823,388,50,"Init: Resume Classification is enabled after boot. Requesting GenerateEditorServiceToken API for token."),(new fB(n.AFrameworkApplication.userSessionId,A,this.Dhb)).gOn(this.Hul,this.Iul,this.Gul))})}}}af(d){return void 0===d||null===d||""===d.trim()}dispose(){}static main(){n.AFrameworkApplication.se("8517a656;8c199277");n.AFrameworkApplication.K&&!n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ResumeClassificationCodeCleanUp",
!1)&&z.a.instance.Gc(new Rw)}}Object(y.a)(Rw,"ResumeAssistantPackage",null,[1,2]);class vy{constructor(){this.Fk=null}pDa(d,m){this.Fk||(this.Fk={});this.Fk[m]||(this.Fk[m]=0);this.Fk[m]+=d}getData(){return this.Fk}reset(){this.Fk=null}}Object(y.a)(vy,"MultiSumDataAggregator",null,[1081]);class iA extends Sys.EventArgs{constructor(){super();this.XA=null}}Object(y.a)(iA,"DocumentSignalReadyEventArgs",Sys.EventArgs,[]);class Ir extends Sys.EventArgs{constructor(){super()}}Object(y.a)(Ir,"SignalAddedToBatchWindowEventArgs",
Sys.EventArgs,[]);var iu;(function(d){d[d.srp=0]="rest";d[d.add=1]="add";d[d.edit=2]="edit";d[d.document=3]="document";d[d.Gip=4]="editorAccept"})(iu||(iu={}));Object(y.b)("SignalCategory",iu);class jA extends Sys.EventArgs{constructor(){super();this.NUc=this.tN=0}}Object(y.a)(jA,"SignalReadyEventArgs",Sys.EventArgs,[]);class Sw{constructor(){this.startTime=null;this.tN=this.Chf=0;this.values=null;this.NUc=0}get endTime(){return this.startTime.getTime()+this.Chf}}Object(y.a)(Sw,"SignalSummary",null,
[]);class kA{constructor(d,m,A,R,da=null){this.jWe=null;this.zab=0;this.Pwb=this.ptc=null;this.sa=new vb.a;this.SWk=()=>{const Ea=this.xD(),ib=this.Jqf(this.Pwb,Ea);ib>this.fve&&(this.zab&&this.vii(0,Ea,ib),this.Pwb=Ea)};this.Ib=d;this.fve=m;this.IXj=A;this.Ofk=R;this.ndh={};this.Pze={};this.gxd=new tg.a;this.Phd=new vy;this.Nue=new U.a;this.hnd=!1;da||(da=()=>new Date);this.xD=da}hpb(d){3===d.tN&&1!==d.Nua?v.ULS.sendTraceTag(590401570,389,10,"Signal Aggregator: Signals at the document level should be of aggregation type Last. SignalId{0}",
d.XA):(v.ULS.sendTraceTag(590401571,389,50,"Signal Aggregator: Registered a signal type: SignalId: {0}, SignalCategory: {1}, SignalDescription: {2}, AggregationType: {3}",d.XA,d.tN,d.y8a,d.Nua),this.ndh[d.XA]=d)}init(d=null){d||(d=this.xD());this.zab=0;this.Pwb=this.ptc=d;this.hnd=!0}xhi(){if(!this.hnd)return v.ULS.sendTraceTag(590401601,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),null;const d=new U.a;d.add(Object.assign(new Sw,{tN:3,values:this.Pze}));
for(const m of this.gxd){const A=Object.assign(new Sw,{tN:m.key,values:m.value.getData()});d.add(A)}return d}q9h(){return this.hnd?Object.assign(new Sw,{tN:3,values:this.Pze}):(v.ULS.sendTraceTag(574419076,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first."),null)}track(d){if(this.hnd){var m=this.ndh[d.XA];if(!m)v.ULS.sendTraceTag(590401603,389,10,"Signal Aggregator: Recieved a signal that was never registered: {0}",d.XA);else if(1===m.Nua)this.Pze[d.XA]=d.value,
this.sa.raiseEvent("DocumentSignalReadyEventKey",Object.assign(new iA,{XA:d.XA}));else if(!m.Nua){this.Ivk(d,m.tN);const A=this.Jqf(this.Pwb,d.timestamp);(m.tN!==this.zab||A>this.fve)&&this.vii(m.tN,d.timestamp,A);this.Pwb=d.timestamp;this.Phd.pDa(d.value,d.XA);this.Txl()}}else v.ULS.sendTraceTag(590401602,389,10,"Signal Aggregator: Must call Init(timestamp) to initialize the aggregator first.")}Ivk(d,m){this.gxd.nb(m)||this.gxd.Z(m,new vy);this.gxd.J(m).pDa(d.value,d.XA)}Jqf(d,m){return+m-+d}Txl(){this.jWe||
(this.jWe=new $a.a(4,2,this.Ofk,this.SWk,193),this.Ib.Wb(this.jWe))}vii(d,m,A){A>this.fve&&d&&(this.kHd(0,m),this.Phd.reset(),this.ptc=this.Pwb,this.zab=0);A=Object.assign(new jA,{tN:this.zab,NUc:d});this.Q0k(d,m);this.Phd.reset();this.ptc=m;this.zab=d;this.sa.raiseEvent("SignalReadyEventKey",A)}kHd(d,m){this.zab&&(m=this.Pwb);d=Object.assign(new Sw,{tN:this.zab,values:this.Phd.getData(),startTime:this.ptc,Chf:this.Jqf(this.ptc,m),NUc:d});this.Nue.add(d);m=new Ir(d);this.sa.raiseEvent("SignalAddedToBatchWindowEventKey",
m);v.ULS.sendTraceTag(590401605,389,50,"New Signal Bucket Added. SignalCategory: {0}, Values: {1}, StartTime: {2}, Duration (ms): {3}, IncomingCategory: {4}",iu[d.tN],d.values,d.startTime,d.Chf,iu[d.NUc]);return d.endTime}Q0k(d,m){for(d=this.kHd(d,m)-this.IXj;this.Nue.J(0).endTime<d;)this.Nue.removeAt(0)}Hrh(d){this.sa.addHandler("SignalReadyEventKey",d)}F2n(d){this.sa.removeHandler("SignalReadyEventKey",d)}qrh(d){this.sa.addHandler("DocumentSignalReadyEventKey",d)}b9f(d){this.sa.removeHandler("DocumentSignalReadyEventKey",
d)}}Object(y.a)(kA,"SignalAggregator",null,[1053]);var LC=c(411),Tw=c(307),Nu=c(122),lA=c(220),MC=c(1770);class xr{constructor(d,m=1){this.XA=d;this.timestamp=new Date;this.value=m}}Object(y.a)(xr,"SignalEntry",null,[]);class mA{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae){this.vak=Qb;this.lXj=pc;this.uX=Pc;this.JJk=gd;this.kma=Cd;this.Zd=ae;this.YN=new qu.a;this.CWg=0;this.$G=()=>{const Xd=new xr(Ck.a.vDh);this.B3.track(Xd)};this.gja=()=>{const Xd=new xr(Ck.a.Y_f);this.B3.track(Xd)};this.Ynb=
()=>{const Xd=new xr(Ck.a.a0f);this.B3.track(Xd)};this.Mda=(Xd,se)=>{Xd=new xr(Ck.a.wordCount,se.state.wordCount);this.B3.track(Xd);Xd=new xr(Ck.a.fS,se.state.fS);this.B3.track(Xd)};this.Wln=(Xd,se)=>{se.action==Tw.b.Apply&&(Xd=new xr(this.GNi(se.category),1),this.B3.track(Xd))};this.brn=(Xd,se)=>{se.action==MC.a.kept&&(Xd=new xr(this.GNi(se.category),1),this.B3.track(Xd))};this.Pvn=()=>{const Xd=new xr("E_TextPrediction",1);this.B3.track(Xd)};this.jUi=()=>{const Xd=new xr("E_AutoCorrect",1);this.B3.track(Xd)};
this.B3=d;this.wq=m;this.Ds=A;this.Nr=R;this.ga=da;this.Je=Ea;this.Ca=ib;this.Qz()}async Qz(){var d;const m=this.wq.Te(12);m.ku(this.gja);m.kw(this.Ynb);this.Ds.dfb(this.Mda);this.Nr.addHandler(lA.a.typingProcess,this.$G);this.Zd.IFf()&&(this.OAm(),this.ga.gZ(this));n.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordSignalAggregatorCritiqueCountSettings");this.Ca.$("SignalAggregatorCritiqueCountIsEnabled")&&jr.a.ll().then(()=>{this.Je.ob(this,LC.a.getTypeName())});await (null===
(d=this.kma)||void 0===d?void 0:d.zHf())&&(this.lXj.execute(A=>A.Qxk(this.Wln)),this.vak.execute(A=>A.xyk(this.brn)),Nu.a.rzk(this.Pvn),this.uX.r0e(this.jUi),this.JJk.r0e(this.jUi))}r5(){}p5(d){2===d.behavior&&this.YN.contains(d.actionId)&&(this.CWg++,d=new xr(Ck.a.APd,this.CWg),this.B3.track(d))}KB(d){d&&d.content&&d.annotationType===LC.a.getTypeName()&&(d=d.content,d=new xr(d.categoryName,d.count),this.B3.track(d))}GNi(d){switch(d){case "Spelling":case "Grammar":return"E_Spelling_Grammar";case "Similarity":return"E_Similarity";
default:return"E_Refinements"}}OAm(){this.YN.add(xe.a.font);this.YN.add(xe.a.WA);this.YN.add(xe.a.u0);this.YN.add(xe.a.K1);this.YN.add(xe.a.KC);this.YN.add(xe.a.bold);this.YN.add(xe.a.fz);this.YN.add(xe.a.underline);this.YN.add(xe.a.strikethrough);this.YN.add(xe.a.subscript);this.YN.add(xe.a.superscript);this.YN.add(xe.a.t0a);this.YN.add(xe.a.MDa);this.YN.add(xe.a.NDa);this.YN.add(xe.a.eva);this.YN.add(xe.a.u0a);this.YN.add(xe.a.nZ);this.YN.add(xe.a.H$);this.YN.add(xe.a.Xv);this.YN.add(xe.a.ura);
this.YN.add(xe.a.LQ)}}Object(y.a)(mA,"SignalAggregatorEventCoordinator",null,[29,1052]);class Uw{constructor(){this.XA=null;this.tN=0;this.y8a=null;this.Nua=0}}Object(y.a)(Uw,"SignalDef",null,[]);class hB{constructor(){this.W=null}get name(){return"WordEditor.SignalAggregator"}wc(d){this.W=d;d=this.W.resolve("Common.IAppSettingsManager");const m=d.nc("SignalAggregatorBucketThresholdMilliseconds",1E4),A=d.nc("SignalAggregatorBatchWindowMilliseconds",12E4),R=d.nc("SignalAggregatorPollingIntervalMilliseconds",
6E3);this.W.ia("WordEditor.SignalAggregator.SignalAggregator",()=>new kA(n.AFrameworkApplication.lc,m,A,R)).as("WordEditor.SignalAggregator.ISignalAggregator").ha()}init(){if(Ab.App.li){var d=Ab.App.li.Al;if(d){var m=this.W.resolve("WordEditor.SignalAggregator.SignalAggregator");this.MYn(m);m.init();var A=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0);new mA(m,d,A,this.W.resolve("Box4.EditStateEventManager"),n.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
n.AFrameworkApplication.K,this.W.Sa("WordEditor.CanvasContextual.LegacyProofingIntentProvider"),this.W.Sa("WordEditor.CanvasContextual.AugLoopProofingIntentProvider"),this.W.resolve("Box4.IAutoCorrectScheduler"),this.W.resolve("Box4.AutocorrectActionExecutor"),this.W.Oa("WordEditor.EditorUpsell.IPremiumPreviewGate"),this.W.resolve("WordEditor.Designer.IDesignerControl"))}else v.ULS.sendTraceTag(590401569,306,15,"Graph is null. Signal Aggregator will not be available")}else v.ULS.sendTraceTag(590401568,
306,15,"TheNotebookManager is null. Signal Aggregator will not be available")}MYn(d){let m=Object.assign(new Uw,{XA:Ck.a.vDh,tN:2,y8a:"The number of characters that have been typed",Nua:0});d.hpb(m);m=Object.assign(new Uw,{XA:Ck.a.Y_f,tN:2,y8a:"The number of paragraphs that have been added",Nua:0});d.hpb(m);m=Object.assign(new Uw,{XA:Ck.a.a0f,tN:2,y8a:"The number of paragraphs that have been deleted",Nua:0});d.hpb(m);m=Object.assign(new Uw,{XA:Ck.a.APd,tN:3,y8a:"The total count of font formatting changes that have been applied",
Nua:1});d.hpb(m);m=Object.assign(new Uw,{XA:Ck.a.wordCount,tN:3,y8a:"The latest word count of the document",Nua:1});d.hpb(m);m=Object.assign(new Uw,{XA:Ck.a.fS,tN:3,y8a:"The latest paragraph count of the document",Nua:1});d.hpb(m);if(n.AFrameworkApplication.K.$("SignalAggregatorCritiqueCountIsEnabled"))for(var A=0;A<Ck.a.Qcf.length;A++)m=Object.assign(new Uw,{XA:Ck.a.Qcf[A],tN:3,y8a:String.format("The latest {0} critique count of the document",Ck.a.Qcf[A]),Nua:1}),d.hpb(m);for(A=0;A<Ck.a.G7b.length;A++)m=
Object.assign(new Uw,{XA:Ck.a.G7b[A],tN:4,y8a:String.format("Accepted {0} count",Ck.a.G7b[A]),Nua:0}),d.hpb(m)}dispose(){}static main(){z.a.instance.Gc(new hB)}}Object(y.a)(hB,"SignalAggregatorPackage",null,[1,2]);class Bx{}Object(y.a)(Bx,"ApplicationProperties",null,[]);class nA{}Object(y.a)(nA,"EnterpriseUserInfo",null,[]);class iB{}Object(y.a)(iB,"FeatureGates",null,[]);class Ou{constructor(d,m,A=!0){this.qng=9E5;this.sng=3E5;this.GOf=null;this.EMi="";this.EOf=0;this.ehb=Date.now;this.P9=d;this.ySa=
m;A&&this.vof()}Vem(){const d=this.ehb();if(d<this.EOf+this.qng)return d>this.EOf+this.sng&&this.vof(),this.EMi;this.vof();return""}vof(){this.GOf=this.GOf||new Promise(d=>{this.Wem().then(m=>{this.EMi=m;this.EOf=this.ehb();this.GOf=null;d(m)})})}Wem(){return this.ySa&&this.ySa.length?new Promise(d=>{this.P9.RV("SmartLookup",this.ySa).then(m=>{m.IsSuccess?m.Token||(d(""),v.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(v.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
m.ErrorCode+": "+m.ErrorMessage),d(""));d(m.Token)}).catch(m=>{m=rb.c(m);v.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+m);d("")})}):(v.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(y.a)(Ou,"SmartLookupAuthenticationManager",null,[1328]);class bw{static lfm(){switch(n.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":n.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")?
"PROD":n.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")?"INT":bw.J9h()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static J9h(){switch(Object(vf.a)(String,n.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(n.AFrameworkApplication.K){let d=n.AFrameworkApplication.K.kb("UserPrincipalName");d=sa.a.eh(d);const m=n.AFrameworkApplication.K.rw("SmartLookupINTEnabledForSKITeam")?n.AFrameworkApplication.K.EB("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(m,d)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static Eem(){switch(n.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":n.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")?"PROD":n.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")?"INT":bw.J9h()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(y.a)(bw,"Utils",null,[]);class Vw{constructor(d){v.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Smb=n.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");this.Q9m=n.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern");this.ySa=n.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.WOf=E.a.dY(n.AFrameworkApplication.K.kb("AppCatalogUrl")||"");
this.Ki=new iB;this.Ki.EnableAllTabV2=!0;this.Ki.EnableIntentService=!0;this.Ki.EnableInDocumentSearch=n.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch");this.Ki.EnableLocalSearch=n.AFrameworkApplication.K.$("SmartLookupEnableLocalSearch");this.Ki.IntentServiceEndpoint=bw.Eem();this.g$m=new Ou(d,this.ySa)}get approvedOriginPattern(){return this.Q9m}QOl(){const d=new Bx;d.anid="";d.applicationVersion=n.AFrameworkApplication.buildVersion;d.appCorrelationId=Eg.a.create().toString();d.themePlatform=
Vw.E4o;d.lcid=n.AFrameworkApplication.lcid;d.launchUtcTime=(new Date).toUTCString();d.featureGates=this.Ki;var m=De.a.ug(n.AFrameworkApplication.lcid);m=m?m.name:null;d.market=this.w8h(m);d.uiLanguage=m;d.sessionId=n.AFrameworkApplication.userSessionId;d.themeId=0;d.parentalControl=Vw.q0f;const A=new nA;A.CountryCode=this.w8h(m);A.ServiceEndpoint=this.ySa;A.IsGoLocal=!1;A.IsEnabled=this.Smb;A.IsEnterpriseEnabled=this.Smb;A.TenantRoot=this.WOf;d.enterpriseUserInfo=A;d.accessToken=this.g$m.Vem();return d}w8h(d){d=
d.split("-");return d[d.length-1]}}Vw.E4o="web";Vw.q0f="yes";Object(y.a)(Vw,"SmartLookupManager",null,[1279]);class oA{constructor(){this.W=null}get name(){return"Common.App.SmartLookup"}wc(d){this.W=d;v.ULS.sendTraceTag(41521356,1313,50,"SmartLookupPackage - Initialize");this.W.register(1279,"Common.App.SmartLookup.ISmartLookupManager").ha().Ud(()=>new Vw(this.W.resolve("Common.App.OAuth.IOAuthManager")))}dispose(){}}Object(y.a)(oA,"SmartLookupPackage",null,[1,2]);class wy{}Object(y.a)(wy,"Selection",
null,[]);class cC{}Object(y.a)(cC,"ConfigurationProvider",null,[]);var dC=c(294);class ju{static Qkc(d){const m=new dC.a;m.name="Office.Insights.SmartLookup.LaunchPane";m.samplingPolicy=2;const A=[];(d=Sf.a.b9("AppCorrelationId",d,2))&&Array.add(A,d);m.dataFields=A;ah.a.sendActivityEvent(m)}}Object(y.a)(ju,"LoggingUtils",null,[]);var Gt=c(1734),pA=c(1867);class Ht{constructor(d,m,A,R,da,Ea){this.NTc=(ib,Qb,pc)=>{if(2!==pc)return 32;this.LJb()&&this.ii.DCb(Ht.appId);return 32};this.qmc=(ib,Qb,pc)=>
{if(2!==pc)return 32;ib=(new pA.a).getSelectedText();ib=Object.assign(new wy,{neighborhood:ib.neighborhood,mentionStart:ib.mentionStart,mentionLength:ib.mentionLength});this.XPb=Object.assign(new Gt.a,{selection:ib,entryPoint:0});return this.OZc()};this.BGa=(ib,Qb,pc)=>{if(2!==pc)return 32;ib=(new pA.a).getSelectedText();ib=Object.assign(new wy,{neighborhood:ib.neighborhood,mentionStart:ib.mentionStart,mentionLength:ib.mentionLength});this.XPb=Object.assign(new Gt.a,{selection:ib,entryPoint:10});
return this.OZc()};this.q9=(ib,Qb,pc,Pc,gd)=>{if(1===pc)return Cq.SessionStatusManager.instance.Yj?8:32;ib=gd.CommandValueId;try{this.XPb=rb.a(ib)}catch(Cd){return v.ULS.sendTraceTag(41521359,1313,15,"SmartLookup application interface [{0}] is not in proper format",ib),8}return this.OZc()};this.uad=(ib,Qb,pc,Pc,gd)=>{if(1===pc)return 32;try{this.XPb=gd}catch(Cd){return v.ULS.sendTraceTag(41694411,1313,15,Cd.message),8}return this.OZc()};this.tad=(ib,Qb,pc,Pc,gd)=>{if(1===pc)return 32;if(!gd)return 8;
ib=gd.query?gd.query:"";ib=Object.assign(new wy,{neighborhood:ib,mentionStart:0,mentionLength:ib.length});this.XPb=Object.assign(new Gt.a,{selection:ib,entryPoint:0});return this.OZc()};this.ga=d;this.ii=m;this.oNi=A;this.XPb=null;this.a0c=new le.a;this.sourceLocationOverrideResourceId=bw.lfm();this.a0c.sourceLocationOverrideResourceId=this.sourceLocationOverrideResourceId;this.a0c.pS=CommonUIStrings.L_SmartLookupPaneTitle;this.a0c.taskPaneWidth=400;this.qMi=da;this.isFirstLaunch=!0;d=Object.assign(new cC,
{channelId:"SmartLookup",approvedOriginPattern:this.oNi.approvedOriginPattern});this.Fpi=SmartLookupHostRuntime.setup(d,[Ea])}AYn(){v.ULS.sendTraceTag(41521357,1303,50,"Registering SmartLookup ribbon button.");this.ga.qa(Ac.a.qmc,K.a.frame,this.qmc);this.ga.qa(Ac.a.NTc,K.a.frame,this.NTc);this.ga.qa(Q.a.q9,K.a.frame,this.q9);this.ga.qa(Q.a.BGa,K.a.frame,this.BGa);this.ga.qa(Q.a.uad,K.a.frame,this.uad);this.ga.qa(Q.a.tad,K.a.frame,this.tad);this.t1n()}t1n(){this.ga.Mja("mso_smartLookup",Ac.a.qmc,K.a.frame,
this.qmc,d=>{sf.StaticActiveAppFrame.za().Zoc(d,Object(I.a)(this.qMi,this.qMi.VFb,"getCommandById"))});this.ga.Mja("mso_smartLookup",Ac.a.NTc,K.a.frame,this.NTc,()=>{});this.ga.Mja("mso_smartLookup",Q.a.q9,K.a.frame,this.q9,()=>{});this.ga.Mja("mso_smartLookup",Q.a.BGa,K.a.frame,this.BGa,()=>{});this.ga.Mja("mso_smartLookup",Q.a.uad,K.a.frame,this.uad,()=>{});this.ga.Mja("mso_smartLookup",Q.a.tad,K.a.frame,this.tad,()=>{})}mmc(){if(!this.LJb()){const m=this.oNi.QOl();var d={};m.applicationName=Ht.mGn;
m.isFirstLaunch=this.isFirstLaunch;m.themeId=5;d[Ht.smartLookupApplicationInterface]=this.XPb;d[Ht.TDk]=m;this.a0c.bS=d;d=n.AFrameworkApplication.K.$("SmartLookupSdxFlowIsEnabled");this.ii.V5(Ht.appId,this.a0c,d);this.isFirstLaunch=!1;ju.Qkc(m.appCorrelationId)}this.Fpi.onPaneStateChanged(!0)}LJb(){return this.ii.J0(Ht.appId+"."+this.sourceLocationOverrideResourceId)}OZc(){this.LJb()?this.Fpi.search(this.XPb):this.mmc();return 32}}Ht.TDk="AppProperties";Ht.mGn="Word";Ht.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Ht.appId="FA000000006";Object(y.a)(Ht,"SmartLookupAddIn",null,[1051]);class sv{getId(){return"SerpletExecutor"}}sv.Poi="FA000000012";sv.queryPrefix="AssetID=";Object(y.a)(sv,"BaseSerpletExecutor",null,[879,880]);class ku extends sv{constructor(d){super();this.dX=d}openHelpTaskPane(d){const m={};m.query=sv.queryPrefix+d;d=new le.a;d.bS=m;this.dX.V5(sv.Poi,d)}}Object(y.a)(ku,"WordSerpletExecutor",sv,[]);class tv extends oA{constructor(){super();this.XKa=null}get name(){return"WordEditor.SmartLookup"}init(){tv.isFeatureEnabled()&&
this.oka()}wc(d){super.wc(d);this.XKa=d;tv.isFeatureEnabled()&&(this.XKa.ia("WordEditor.SmartLookup.WordSerpletExecutor",()=>new ku(this.XKa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"))).as("Common.App.SmartLookup.ISerpletExecutor").ha(),this.XKa.ia("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn",()=>new Ht(n.AFrameworkApplication.va,this.XKa.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.XKa.resolve("Common.App.SmartLookup.ISmartLookupManager"),
this.XKa.resolve("Common.IAppSettingsManager"),this.XKa.resolve("Common.IExternalUICommandDefinitionMapping"),this.XKa.resolve("Common.App.SmartLookup.ISerpletExecutor"),sf.StaticActiveAppFrame.za().T8a)).ha())}oka(){v.ULS.sendTraceTag(41497102,1303,50,"SmartLookup package initialized.");this.XKa.resolve("WordEditor.SmartLookup.SmartLookupManager.ISmartLookupAddIn").AYn()}static main(){tv.isFeatureEnabled()&&z.a.instance.Gc(new tv)}static isFeatureEnabled(){return!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")}}
Object(y.a)(tv,"WordEditorSmartLookupPackage",oA,[]);class dp{constructor(){this.ShapeId=0;this.RunSmartArtAnalysis=!1;this.Hints=null;this.Hints={}}}Object(y.a)(dp,"ShapeInputData",null,[]);class NC{constructor(){this.TextBoxes=this.Title=null;this.Title="";this.TextBoxes=[]}}Object(y.a)(NC,"SlideData",null,[]);class zD{constructor(){this.SlideId=0;this.Hints=this.ShapeInputMetaData=null;this.ShapeInputMetaData=[];this.Hints={}}}Object(y.a)(zD,"SlideInputData",null,[]);class eC{constructor(){this.Hints=
this.SlideInputMetaData=null;this.SlideInputMetaData=[];this.Hints={}}}Object(y.a)(eC,"PresentationInputData",null,[]);class AD{constructor(){this.Hints=this.TextInputData=this.PresentationInputMetaData=null;this.PresentationInputMetaData=new eC;this.TextInputData=new NC;this.Hints={}}}Object(y.a)(AD,"TextAnalysisGenericInput",null,[]);class BD{constructor(){this.ShapeId=0;this.Texts=null;this.Texts=[];this.ShapeId=0}}Object(y.a)(BD,"TextBox",null,[]);class jB{constructor(){this.Bullet=this.Text=
null;this.Level=0;this.Bullet=this.Text="";this.Level=0}}Object(y.a)(jB,"TextObj",null,[]);var OC;(function(d){d[d.acp=0]="NoBullet";d[d.kap=1]="DefaultBullet";d[d.fcp=2]="NumberBullet"})(OC||(OC={}));Object(y.b)("BulletType",OC);class xz{constructor(d){this.Zf=d}PSk(d,m,A,R){const da=this.f$k(d.listId);da.TextInputData=this.Vfl(d);for(const Ea of m)Ea(da);d=rb.c(da);this.Zf.nj("ListDesignerHandler.ashx",2,d,null,!1,2,Ea=>{A(Ea)},Ea=>{R(Ea)},null)}iao(d){d&&d.PresentationInputMetaData&&d.PresentationInputMetaData.SlideInputMetaData&&
1===d.PresentationInputMetaData.SlideInputMetaData.length&&d.PresentationInputMetaData.SlideInputMetaData[0].ShapeInputMetaData&&1===d.PresentationInputMetaData.SlideInputMetaData[0].ShapeInputMetaData.length&&(d.PresentationInputMetaData.SlideInputMetaData[0].ShapeInputMetaData[0].RunSmartArtAnalysis=!0)}hfm(d){let m;return({Gt:m}=rb.d(d)).returnValue&&m&&m.presentationAnalyses&&1===m.presentationAnalyses.slideAnalyses.length&&m.presentationAnalyses.slideAnalyses[0].shapeAnalyses&&1===m.presentationAnalyses.slideAnalyses[0].shapeAnalyses.length?
m.presentationAnalyses.slideAnalyses[0].shapeAnalyses[0].smartArtOutput:null}f$k(d){const m=new AD;m.PresentationInputMetaData.SlideInputMetaData.push(new zD);m.PresentationInputMetaData.SlideInputMetaData[0].ShapeInputMetaData.push(Object.assign(new dp,{ShapeId:d}));return m}Vfl(d){const m=new NC;m.TextBoxes.push(Object.assign(new BD,{ShapeId:d.listId}));for(const A of d.X0)m.TextBoxes[0].Texts.push(Object.assign(new jB,{Text:A.data,Level:A.RXd,Bullet:OC[A.cQk]}));return m}}Object(y.a)(xz,"TextAnalysisServiceHelper",
null,[846]);class iD{constructor(){this.W=null}get name(){return"WordEditor.TextAnalysisServiceHelper"}wc(d){this.W=d;this.W.ia("WordEditor.TextAnalysisServiceHelper.ITextAnalysisServiceHelper",()=>new xz(n.AFrameworkApplication.He)).ha()}init(){}dispose(){this.W=null}static main(){z.a.instance.Gc(new iD)}}Object(y.a)(iD,"TextAnalysisServiceHelperPackage",null,[1,2]);class CD{constructor(d,m,A,R,da,Ea){this.prc=!1;this.mje=(ib,Qb,pc)=>2!==pc?32:this.QEc&&this.k_a?this.k_a.LJb?this.QEc.ovm(pc):this.QEc.qzo(pc):
16;this.ejc=(ib,Qb,pc,Pc,gd)=>this.QEc?this.QEc.ejc(ib,Qb,pc,Pc,gd):16;this.ga=d;this.QEc=m;this.azb=A;this.k_a=R;this.y1b=da;this.O8j=Ea}register(d=!1){if(this.prc)v.ULS.sendTraceTag(51667738,3011,15,"Attempted to register Transcription add-in commands more than once.");else{this.prc=!0;v.ULS.sendTraceTag(51667739,3011,50,"Registering Transcription add-in commands.");this.y1b&&(this.O8j?this.y1b.ozo():this.y1b.pzo());var m={},A=new U.a;m.Transcription="ButtonModel";A.add("btnWordTranscription");
this.ga&&(this.ga.qa(Ac.a.mje,K.a.frame,this.mje),this.ga.fb(Ac.a.ejc,ic.a.view,this.ejc,96));d&&this.azb&&this.azb.$Ja(m)}}}Object(y.a)(CD,"TranscriptionAddInCommands",null,[851]);class np{constructor(d,m){this.Jyb=d;this.Fv=m}K5l(d,m){Object(fm.a)(2,()=>this.Fv.Z2a(),!0,()=>!0).then(A=>{d[np.q5d]=A;m(d)}).catch(A=>{v.ULS.sendTraceTag(528859138,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",A)})}J5l(d,m){this.Jyb.Z2a().then(A=>{d[np.q5d]=A;m(d)})}buk(d,m,A){Object(fm.a)(2,
()=>this.Fv.eGc(d[np.z6d]),!1,()=>!0).then(()=>{Object(fm.a)(2,()=>this.Fv.Z2a(),!0,()=>!0).then(R=>{this.Fv.ZEb();m[np.q5d]=R;A(m)}).catch(R=>{v.ULS.sendTraceTag(528859139,3011,10,"GET Call for Transcription File Upload Minutes Failed With Exception: {0}",R)})}).catch(R=>{v.ULS.sendTraceTag(528859140,3011,10,"ADD Call for Transcription File Upload Minutes Failed With Exception: {0}",R)})}auk(d,m,A){this.Jyb.eGc(d[np.z6d]).then(()=>{this.Jyb.Z2a().then(R=>{this.Jyb.ZEb();m[np.q5d]=R;A(m)})})}Jrm(d,
m){return new Promise((A,R)=>{const da={};switch(d){case np.I5l:Object(fm.b)()?this.K5l(da,A):this.J5l(da,A);break;case np.Ytk:if(void 0===m[np.z6d]||null===m[np.z6d]){R(np.Aui);break}Object(fm.b)()?this.buk(m,da,A):this.auk(m,da,A);break;case np.c0o:if(void 0===m[np.Rlg]||null===m[np.Rlg]){R(np.Aui);break}A=m[np.Rlg];!isNaN(A)&&isFinite(A)&&Sl.a.set("TeachingUIShowCount",A.toString());break;default:R(np.nUo)}})}}np.I5l="GetMonthlyMinutesUsed";np.q5d="monthlyMinutesUsed";np.Ytk="AddMinutesUsed";np.z6d=
"numMinutesUsed";np.c0o="UpdateTeachingUIShowCount";np.Rlg="teachingUIShowCountNew";np.Aui="invalidArgs";np.nUo="unsupportedRequestType";Object(y.a)(np,"TranscriptionAddInRequestHandler",null,[849]);class f{constructor(d,m,A){this.sessionId=d;this.locale=A;this.ii=m;this.uwb=this.htm=!1}get Fdc(){return this.uwb}set Fdc(d){this.uwb=d}get LJb(){return this.ii?this.ii.J0(vm.Fkc):!1}}Object(y.a)(f,"TranscriptionAddInState",null,[]);class w{ozo(){appChrome.showTranscribeAsSplitButton()}pzo(){appChrome.showTranscribeAsStandaloneGroup()}aAf(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShowHideTranscriptionPane",
!0))}}Object(y.a)(w,"TranscriptionButtonEnabler",null,[848]);class F{constructor(d){this.XEb=m=>{this.JGe=m.isEnabled};this.JGe=this.qYb=!1;this.initialized=d?new Promise((m,A)=>{d.execute(R=>{this.qYb=R.isFreemiumUpsellEnabled();const da=R.isFeatureEnabled(Bj.a.xBj,!1);R.iza(Bj.a.xBj,this.XEb);this.TBm(da).then(()=>{m(!0)}).catch(Ea=>{v.ULS.sendTraceTag(555054277,3011,10,"Failed to initialize transcription licensed user using isFeatureEnabled "+Ea.toString());A("Failed to initialize transcription licensed user")})})}):
Promise.resolve(!0)}get isFreemiumUpsellEnabled(){return this.qYb}get xGf(){return this.JGe}TBm(d){return new Promise(m=>{d.then(A=>{this.JGe=A?!0:!1;m(!0)})})}}Object(y.a)(F,"TranscriptionLicenseState",null,[]);class Z{constructor(d){this.WUc=0;this.Fv=d}ZEb(){return this.Z2a().then(d=>{this.WUc=d}).catch(d=>{v.ULS.sendTraceTag(587310852,3011,10,"Failed to get initial monthly minutes used: "+d.toString())})}Z2a(){return new Promise((d,m)=>{this.Fv?this.Fv.uHb(Z.twf,0).continueWith(A=>{A.Gi?m(A.exception):
d(parseInt(A.result))},8):d(0)})}eGc(d){return new Promise((m,A)=>{this.Fv?this.Fv.ika(Z.vbg,d.toString()).continueWith(R=>{R.Gi?(v.ULS.sendTraceTag(540375233,3011,10,"SaveTranscriptionMinutes: TaskFaulted. ExceptionDetails:{0} Stack:{1}",R.exception,R.exception.stack),A(R.exception)):m(null)},8):m(null)})}}Z.twf="getTranscriptionQuota";Z.vbg="saveTranscriptionQuota";Object(y.a)(Z,"TranscriptionMonthlyQuotaManager",null,[]);class ja{constructor(){this.UWe="";this.REc="Office.Voice.Transcription."}cfo(d){this.UWe=
Eg.a.create().toString();d=[this.ZJd(),this.GNh(!1)].concat(this.hNh(d));ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:this.REc+"PaneOpened",dataFields:d}))}Deo(d){ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:this.REc+"PaneOpened",dataFields:[this.ZJd(),this.GNh(!0),this.Ldl(d)]}))}dfo(d){ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:this.REc+"PaneOpened",dataFields:[this.ZJd(),this.Mdl(d)]}))}afo(d){this.Xfo(d)}lfo(d,m,A){ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:this.REc+
"Preinitialization",dataFields:[Object.assign(new Ya.a,{name:"DurationMs",int64:d}),Object.assign(new Ya.a,{name:"IsRibbonButtonDisabled",bool:m}),Object.assign(new Ya.a,{name:"DisabledReason",string:A})]}))}Xfo(d){const m=this.hNh(d);m.push(this.Kdl(d),this.ZJd());ah.a.sendTelemetryEvent(Object.assign(new Bg.a,{name:this.REc+"PaneClosed",dataFields:m}))}Kdl(d){return Object.assign(new Ya.a,{name:"PaneOpenDurationInSecs",string:d.PaneOpenDurationInSecs})}ZJd(){return Object.assign(new Ya.a,{name:"TranscriptionSessionId",
string:this.UWe})}GNh(d){return Object.assign(new Ya.a,{name:"PaneOpenedFinalEvent",bool:d})}Mdl(d){return Object.assign(new Ya.a,{name:"PaneOpenSucceeded",bool:d})}Ldl(d){return Object.assign(new Ya.a,{name:"IsLicensedUser",bool:d})}hNh(d){return[Object.assign(new Ya.a,{name:"DeviceNetDownLinkInMbPerSec",double:d.DeviceNetDownLink}),Object.assign(new Ya.a,{name:"EffectiveNetworkType",string:d.EffectiveNetworkType}),Object.assign(new Ya.a,{name:"IsOnline",bool:d.IsOnline})]}}Object(y.a)(ja,"TranscriptionTelemetryHelper",
null,[847]);var Ja=c(1124);class gb{constructor(){this.Leb=this.hAb=this.y1b=this.tua=this.c_a=this.dsd=this.W=null;this.pka=()=>{sf.StaticActiveAppFrame.za().jb.qpb(this.pka);this.F3i()};this.y1b=new w}get name(){return"WordEditor.Transcription"}init(){if(Ab.App.UYc()){const d=sf.StaticActiveAppFrame.za().jb;d.Cxa?this.F3i():d.vga(this.pka);v.ULS.sendTraceTag(51667727,3011,50,"Transcription package initialized.")}}dispose(){}Jgi(){const d=n.AFrameworkApplication.K.$("IsAnonymousUser"),m=n.AFrameworkApplication.K.$("IsRoamingServiceEnabled");
return d||!m?null:this.W.resolve("Box4.IRoamingServiceRequestManager")}wc(d){this.W=d;if(Ab.App.UYc()){const m=this.W.resolve("Box4.ILanguageReader").FFa(this.W.resolve("Box4.ISelectionManager").qg);this.W.ia("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState",()=>new f(n.AFrameworkApplication.userSessionId,this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),De.a.ug(m).bQd)).as("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState").ha();this.dsd=new Z(this.Jgi());
this.hAb=new Ja.a(this.Jgi());let A;A=new np(this.dsd,this.hAb);this.c_a=new ja;this.tua=new F(this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"));this.Leb=d.resolve("WordEditor.CustomXml.IWordEditorCustomXmlManager");this.W.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn",()=>new vm(this.W.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),this.W.resolve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),this.W.resolve("WordEditor.Extension.DocumentProperties"),
this.c_a,n.AFrameworkApplication.K,this.dsd,A,this.tua,this.hAb,this.Leb)).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").ha();this.W.ia("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands",()=>{var R;return new CD(n.AFrameworkApplication.va,this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn"),this.W.resolve("Common.IRibbonButtonUpdater"),this.W.resolve("WordEditor.Transcription.SDXAddInLoader.TranscriptionAddInState"),null!==(R=this.y1b)&&
void 0!==R?R:new w,yj.App.wxi()&&yj.App.xxi())}).as("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").ha();v.ULS.sendTraceTag(51667730,3011,50,"Transcription package configured.")}}F3i(){if(Ab.App.UYc()){var d=Date.now();this.nPb(!0);var m=[];var A=Object(fm.b)()?this.hAb.ZEb().then(()=>({name:"QuotaCheck",succeeded:!0})):this.dsd.ZEb().then(()=>({name:"QuotaCheck",succeeded:!0}));m.push(A);A=n.AFrameworkApplication.K.$("IsO365ConsumerHost");var R=n.AFrameworkApplication.K.$("IsAnonymousUser");
A&&!R&&m.push(this.tCl());Promise.all(m).then(da=>{da=da.filter(ib=>!ib.succeeded).map(ib=>ib.name);const Ea=Date.now()-d;this.c_a.lfo(Ea,0<da.length,da.join(","));0===da.length?this.oka():(new w).aAf();this.nPb(!1)}).catch(da=>{v.ULS.sendTraceTag(555055175,3011,10,"Failed to initialize transcription feature "+da.toString());(new w).aAf();this.nPb(!1)})}}async tCl(){try{return await this.tua.initialized,{name:"UpsellLicenseCheck",succeeded:this.tua.isFreemiumUpsellEnabled||this.tua.xGf}}catch(d){return v.ULS.sendTraceTag(555054278,
3011,10,"Failed to get/initialize transcription license state "+d.toString()),Promise.reject("Failed to get/initialize transcription license state")}}oka(){this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddIn").load();this.W.resolve("WordEditor.Transcription.SDXAddInLoader.ITranscriptionAddInCommands").register()}nPb(d){appChrome.api.setAsyncRequestStatus("transcribe",d)}static main(){Ab.App.UYc()?(z.a.instance.Gc(new gb),v.ULS.sendTraceTag(51667728,3011,50,"Transcription package registered with PackageLifecycleManager.")):
(v.ULS.sendTraceTag(51667729,3011,50,"Skip Transcription package registration, because the feature is disabled."),(new w).aAf())}}Object(y.a)(gb,"WordEditorTranscriptionPackage",null,[1,2]);var ub=c(1769);class Sb{constructor(d,m,A,R,da,Ea){this.rh=m;this.qA=A;this.rba=R;this.Md=da;this.Xs=Ea;this.HK=d}r5k(d,m,A,R){const da=If.GraphIterator.eb(d.X0[0].outlineElementNode);da.od();da.MVd()?(this.Raj(d),this.rh.Oy(da,!1,!1)):(da.Ps(23),this.Raj(d),this.HK.Pkb(da,null));switch(A){case 1:this.QIh(da,m,
R);break;case 2:this.PIh(da,m,R)}return da.currentNode}p6f(d,m,A,R){m=this.g4l(d,m);d=If.GraphIterator.eb(d);d.od();d.tg();switch(A){case 1:this.QIh(d,m,R);break;case 2:this.PIh(d,m,R)}return d.currentNode}Raj(d){for(const m of d.X0)d=new If.GraphIterator,d.set(m.outlineElementNode),d.od(),this.rh.A1a(d)}QIh(d,m,A){this.qA.sEa(d,m.length,2);this.Who(d);for(let R=0;R<m.length;++R)Df.moveToCell(d,R,0),this.RBd(d,m[R].vNi.trim()),Df.moveToNextColumn(d),this.RBd(d,m[R].text.trim(),1,!0),Df.returnToContainingTable(d);
this.rba.Whe(A,1664,d.currentNode)}PIh(d,m,A){this.qA.sEa(d,2,m.length);for(let R=0;R<m.length;++R)Df.moveToCell(d,0,R),this.RBd(d,m[R].vNi.trim()),Df.moveToNextRow(d),this.RBd(d,m[R].text.trim()),Df.returnToContainingTable(d);this.rba.Whe(A,1568,d.currentNode)}RBd(d,m,A=2,R=!1){this.HK.Z7(d,!0);const da=Qe.ParagraphReader.$k(d.currentNode),Ea=jd.a.Uc(da,0);this.Md.Ge(Ea,m);this.Xs.pE(da,A);R&&this.Xs.qq&&this.Xs.qq.Lza(da,1,288);Df.returnToContainingCell(d);this.HK.Z7(d,!0);Df.returnToContainingCell(d)}Who(d){var m=
d.currentNode.uG,A=m?m[0]+m[1]:13.5;m=.37*A;A-=m;this.qA.lea(d.currentNode,0,m);this.qA.lea(d.currentNode,1,A)}g4l(d,m){d=If.GraphIterator.eb(d);d.od();switch(m){case 1:return this.i4l(d);case 2:return this.h4l(d);default:return null}}i4l(d){const m=[],A=Bc.TableReader.gg(d.currentNode);for(let R=0;R<A;++R){Df.moveToCell(d,R,0);const da=this.hVd(d);Df.moveToNextColumn(d);const Ea=this.hVd(d);m.push(new ub.a(da,Ea));Df.returnToContainingTable(d)}return m}h4l(d){const m=[],A=Bc.TableReader.hh(d.currentNode);
for(let R=0;R<A;++R){Df.moveToCell(d,0,R);const da=this.hVd(d);Df.moveToNextRow(d);const Ea=this.hVd(d);m.push(new ub.a(da,Ea));Df.returnToContainingTable(d)}return m}hVd(d){const m=new Sys.StringBuilder;d=Qe.ParagraphReader.yw(d.currentNode,!1,!1);for(let A=0;A<d.count;++A)A===d.count-1?m.append(Qe.ParagraphReader.text(d.J(A))):m.appendLine(Qe.ParagraphReader.text(d.J(A)));return m.toString()}}Object(y.a)(Sb,"TableConstructor",null,[845]);class mc{constructor(){this.W=null}get name(){return"WordEditor.Transformation"}wc(d){this.W=
d;this.W.ia("WordEditor.Transformation.ITableConstructor",()=>new Sb(this.W.resolve("Box4.IOutlineEditor"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.ITableEditor"),this.W.resolve("Box4.TableEditors.IWACTableStyleEditor"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("Box4.IParagraphEditor"))).ha()}init(){}dispose(){this.W=null}static main(){z.a.instance.Gc(new mc)}}Object(y.a)(mc,"TransformationPackage",null,[1,2]);var Uc=c(157),od=c(103);class Wd extends Uc.a{constructor(){super();
this.language=null;this.percentage=this.characterCount=0;this.H_=Object.assign(new od.a,{T_:Wd.getTypeName(),B_:Wd.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(y.a)(Wd,"LanguageCountAnnotation",Uc.a,[]);const oe=(d,m)=>-1===d.indexOf("-")&&-1===m.indexOf("-")?d===m:d.startsWith(m)||m.startsWith(d)?!0:!1;class Ee{constructor(){this.Vab=new Ji.a}Ntk(d){void 0===d||null===d||void 0===d.language||null===
d.language||void 0===d.percentage||null===d.percentage||void 0===d.characterCount||null===d.characterCount?v.ULS.sendTraceTag(42500685,399,10,"AddNewLanguage: Null or undefined languageCountAnnotation parameter."):this.Vab.Z(d.language.toLowerCase(),d)}IWl(){let d=0;for(let m=0;m<this.Vab.count;m++)d+=this.Vab.values.J(m).percentage;return d}JWl(d){if(!d)return v.ULS.sendTraceTag(42500686,399,10,"GetDocumentLanguageCompositionPercentageForKnownLanguages: Null or undefined knownLanguageTags parameter."),
0;let m=0;for(const A of d)for(d=0;d<this.Vab.count;d++)if(oe(this.Vab.keys.J(d),A)){const R=this.Vab.values.J(d);R&&(m+=R.percentage)}return m}DOl(){let d=0;for(let m=0;m<this.Vab.count;m++)d+=this.Vab.values.J(m).characterCount;return d}}Object(y.a)(Ee,"IntelligentSuggestionsDocumentLanguageComposition",null,[]);class Jf extends xb.StandardDialog{constructor(){super()}Uh(d,m,A,R,da){if(void 0===d||null===d)return v.ULS.sendTraceTag(42500737,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined standardDialogHandler parameter."),
!1;if(void 0===m||null===m)return v.ULS.sendTraceTag(42823903,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined reactDialogHandler parameter."),!1;if(void 0===A||null===A||!A.length)return v.ULS.sendTraceTag(42500738,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined fromLanguage parameter."),!1;if(void 0===R||null===R||!R.length)return v.ULS.sendTraceTag(42500739,399,10,"TranslatorIntelligentSuggestionsReactDialog: Null or undefined toLanguage parameter."),
!1;v.ULS.sendTraceTag(42500740,399,50,"TranslatorIntelligentSuggestionsReactDialog: Trying to display the translation suggestion dialog.");da?(da={["messageText"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage},da.pathText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,da.sentenceEndText=CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod,d=new oa.a(!1,!1,!0),d.Cd=4,d.ye(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,
A)),d.ye(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),A={["id"]:"TranslatorIntelligentSuggestionsDialog",["icon"]:{["iconName"]:"Translator_32",["ariaLabel"]:CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText},["bodyControls"]:da},d.Uh(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,R),m,A)):(this.Cd=4,this.ye(2,String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxNeverFrom,A)),this.ye(1,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate),
this.anb(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTitle,R),String.format("{0} {1}{2}",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessage,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxPrefPath,CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxMessagePeriod),"Translator_32x32x32",CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslateIconAltText,d,null));return!0}}Object(y.a)(Jf,"TranslatorIntelligentSuggestionsReactDialog",
xb.StandardDialog,[]);var Qf;(function(d){d[d.ok=0]="ok";d[d.iop=1]="neverFrom";d[d.cancel=2]="cancel"})(Qf||(Qf={}));Object(y.b)("UserAction",Qf);class kg{constructor(d,m,A,R,da,Ea,ib,Qb,pc,Pc,gd,Cd,ae,Xd,se,Xe){this.EYg=!1;this.kLa=this.fG=null;this.Lcm=Be=>{try{if(6===Be.status){const Hg=Be.result;Hg&&Hg.length?this.fG=rb.b(Hg):v.ULS.sendTraceTag(42500693,399,15,"GetRoamingSettingsFrom: Roaming settings are null or empty which might mean that the user cannot access the Roaming Service due to the type of the account they have.")}else v.ULS.sendTraceTag(42500694,
399,10,"GetRoamingSettingsFrom: Could not retrieve the Roaming Settings as the task run status is: {0}",Be.status);this.fG?this.WTh():(v.ULS.sendTraceTag(42783172,399,10,"RoamingSettings are null so quiting: {0}",{["ProcessingTime"]:this.XW.pi}),this.t9a())}catch(Hg){v.ULS.sendTraceTag(42500695,399,10,"GetRoamingSettingsFrom: Failed to deserialize the Roaming Settings. Exception: {0}. ProcessingTime: {1}",Hg,this.XW.pi),this.t9a()}};this.mGm=Be=>{this.gui(Be,null)};this.gui=Be=>{this.zUe.stop();Be=
1===Be?0:2===Be?1:2;this.hui(Be,"DialogBox");v.ULS.sendTraceTag(42500705,399,50,"IntelligentSuggestionsHandleDialog: Pressed {0}",Qf[Be])};this.Je=d;this.ywc=A;this.Tzd=m;this.tkh=R;this.XW=Ea.DSa("Task","TranslatorIntelligentSuggestionsAugLoop");this.zUe=Ea.DSa("DialogShown","TranslatorIntelligentSuggestionsDialogBox");this.fg=da;this.a7g=ib;this.Zrd=Qb;this.Obk=pc;this.J7g=Pc;this.Q9j=gd;this.rMa=Cd;this.G9j=Xd;this.j$j=se;this.b7g=Xe;({value:this.kLa}=kg.JVa.Fc(ae.toLocaleLowerCase())).returnValue||
(this.kLa=ae,-1!==this.kLa.lastIndexOf("-")&&(this.kLa=this.kLa.substring(0,this.kLa.lastIndexOf("-"))))}initialize(){var d=this.tkh.njm();if(!d)return v.ULS.sendTraceTag(42500687,399,10,"Initialize: Not able to get the roaming settings (check user type)."),null;d.continueWith(this.Lcm,8);d=new $a.a(2,1,500,()=>{sj.Scd.n6n()});n.AFrameworkApplication.lc.Wb(d);return jr.a.ll().then(()=>{this.Je.ob(this,"AugLoop_Text_LanguageCountAnnotation");this.XW.start();v.ULS.sendTraceTag(42500688,399,50,"TranslatorAugLoopRuntimeManager: Registerd Handler for AL runtime manager at {0}.",
Date.now())})}KB(d,m){try{if(m===Wm.a.getTypeName()){var A=d.content;void 0===A||null===A||void 0===A.language||null===A.language||void 0===A.percentage||null===A.percentage||void 0===A.characterCount||null===A.characterCount?v.ULS.sendTraceTag(42500689,399,10,"HandleAnnotationEvent: Null or undefined languageCountAnnotation parameter."):(v.ULS.sendTraceTag(42500690,399,50,"HandleAnnotationEvent: Annotation received: {0}",A),A.language=A.language.toLocaleLowerCase(),A.percentage>this.ywc.percentage&&
(this.ywc=A),oe(this.kLa,A.language)&&A.percentage>this.Zrd?(v.ULS.sendTraceTag(42500691,399,50,"HandleAnnotationEvent: {0}.",{["MinKnownLangPer"]:this.Zrd,["ActualUILangPer"]:A.percentage,["ProcessingTime"]:this.XW.pi}),this.t9a()):(this.Tzd.Ntk(A),this.WTh()))}}catch(R){v.ULS.sendTraceTag(42500692,399,10,"HandleAnnotationEvent: Exception: {0}",R)}}WTh(){if(this.NHk()&&this.xvo()){const A=this.lsf(this.ywc.language);if(A&&A.displayName&&A.displayName.length){var d=this.lsf(this.$ji());if(d&&d.displayName&&
d.displayName.length)if(v.ULS.sendTraceTag(42783173,399,50,"DisplayIntelligentSuggestionsIfReady: Ready to show callout or dialog if flight is enabled. ProcessingTime:{0}",this.XW.pi),this.G9j&&this.j$j)this.XW.pi>this.b7g?v.ULS.sendTraceTag(51512477,399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the teaching callout as it took too long to process the document {0}",{["MaxWaitTime"]:this.b7g,["ActualWaitTime"]:this.XW.pi}):this.rzo(A.displayName,d.displayName);else if(void 0!==this.fg&&
null!==this.fg&&this.fg.LJh)v.ULS.sendTraceTag(50644368,399,50,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog as the user has already started editing the document. ProcessingTime:{0}",this.XW.pi);else{if(this.Q9j)if(this.XW.pi>this.a7g)v.ULS.sendTraceTag(42823902,399,15,"DisplayIntelligentSuggestionsIfReady: Not displaying the dialog box as it took too long to process the document {0}",{["MaxWaitTime"]:this.a7g,["ActualWaitTime"]:this.XW.pi});else{this.zUe.start();var m=new Jf;m.Uh(this.mGm,
this.gui,A.displayName,d.displayName,this.rMa)||(this.zUe.stop(),m.dispose())}}else v.ULS.sendTraceTag(42500697,399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for the language we want to translate to.")}else v.ULS.sendTraceTag(42500696,399,10,"DisplayIntelligentSuggestionsIfReady: Could not retrieve/match language information from Translator for document main language.")}}NHk(){return this.fG?void 0===this.fG.NeverShowCallout||null===this.fG.NeverShowCallout||
this.fG.NeverShowCallout?(v.ULS.sendTraceTag(42500698,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as 'never show callout' setting is set to true. ProcessingTime:{0}",this.XW.pi),this.t9a(),!1):this.EYg?(v.ULS.sendTraceTag(42500699,399,50,"AreTranslationSuggestionsPrerequisitesSatisfied: Bail as translation suggestion has already been attempted. ProcessingTime:{0}",this.XW.pi),this.t9a(),!1):"1"===E.a.iP(window.self.location.href,"translatorRedirect")?(v.ULS.sendTraceTag(42783174,
399,50,"Translated document - pressed show Original: {0}",{["ProcessingTime"]:this.XW.pi}),this.t9a(),!1):12E4<this.XW.pi?(v.ULS.sendTraceTag(42500700,399,15,"AreTranslationSuggestionsPrerequisitesSatisfied: Stopping from listening to annotations as it took too long to process the document {0}",{["MaxWaitTime"]:12E4,["ActualWaitTime"]:this.XW.pi}),this.t9a(),!1):!0:!1}xvo(){const d=this.Tzd.IWl();v.ULS.sendTraceTag(42500701,399,50,"ShouldSuggestTranslation: DocProcessedPer {0}.",d);if(d>this.Obk){var m=
this.JNl();m=this.Tzd.JWl(m);const A=100*Math.trunc((this.Tzd.DOl()+50)/100);v.ULS.sendTraceTag(42500702,399,50,"ShouldSuggestTranslation: {0}.",{["MinKnownLangPer"]:this.Zrd,["ActualKnownLangPer"]:m,["NoChars"]:A,["DocProcessedPer"]:d});if(m<this.Zrd)return this.EYg=!0,v.ULS.sendTraceTag(42783175,399,50,"Known languages composition less than default bar, one final check pending: {0}",{["ProcessingTime"]:this.XW.pi}),this.t9a(),A<this.J7g?(v.ULS.sendTraceTag(42500703,399,15,"ShouldSuggestTranslation: The number of characters of the annotations are less than the minimum required: {0}",
{["MinNoChars"]:this.J7g,["ActualNoChars"]:A}),!1):!0;v.ULS.sendTraceTag(42783176,399,50,"Known languages composition greater than default bar, : {0}",{["ProcessingTime"]:this.XW.pi});this.t9a()}return!1}hui(d,m){try{if(!d){const A=new $a.a(2,1,100,()=>{sj.GBj(this.$ji())});n.AFrameworkApplication.lc.Wb(A)}else if(1===d){const A=this.lsf(this.ywc.language);if(A&&A.name&&A.name.length){let R=A.name.toLocaleLowerCase();"no"===R&&(R="nb");this.tkh.Ohj(R)}else v.ULS.sendTraceTag(42500704,399,10,"IntelligentSuggestionsUserAction: Could not retrieve/match language information from Translator for document main language.")}v.ULS.sendTraceTag(51512478,
399,50,"IntelligentSuggestionsUserAction: UserSelected:{0}, SourcePrompt:{1}, Language:{2}",Qf[d],m,this.ywc.language)}catch(A){v.ULS.sendTraceTag(51512479,399,10,"IntelligentSuggestionsUserAction: Exception: {0}",A)}}t9a(){this.Je.uc(this,"AugLoop_Text_LanguageCountAnnotation");v.ULS.sendTraceTag(42500706,399,50,"UnregisterAugmentationLoopHandler: Unregisterd Handler for AL runtime manager at {0}",Date.now())}JNl(){const d=new U.a;if(void 0!==this.fG.LanguageTagsExcluded&&null!==this.fG.LanguageTagsExcluded)for(var m=
0;m<this.fG.LanguageTagsExcluded.length;m++)d.add(this.fG.LanguageTagsExcluded[m].toLowerCase());d.contains(this.kLa)||d.add(this.kLa);void 0!==this.fG.AlwaysTranslatePreference&&null!==this.fG.AlwaysTranslatePreference&&this.fG.AlwaysTranslatePreference&&void 0!==this.fG.DocumentTargetLanguage&&null!==this.fG.DocumentTargetLanguage&&(m=this.fG.DocumentTargetLanguage.toLocaleLowerCase(),kg.ESa.nb(m)&&(m=kg.ESa.J(m)),d.contains(m)||d.add(m));return d}$ji(){if(void 0!==this.fG.AlwaysTranslatePreference&&
null!==this.fG.AlwaysTranslatePreference&&this.fG.AlwaysTranslatePreference&&void 0!==this.fG.DocumentTargetLanguage&&null!==this.fG.DocumentTargetLanguage){let d=this.fG.DocumentTargetLanguage.toLocaleLowerCase();kg.ESa.nb(d)&&(d=kg.ESa.J(d));return d}return this.kLa}lsf(d){if(!d||!d.length)return v.ULS.sendTraceTag(42500707,399,10,"GetLanguageInfoFromTranslator: Provided null or empty parameter."),null;d=d.toLocaleLowerCase();const m=sj.Scd.J2l();if(!m)return v.ULS.sendTraceTag(42500736,399,10,
"GetLanguageInfoFromTranslator: Could not retrieve the language names from Ogma/BRS"),null;for(let A=0;A<m.length;A++){let R=m[A].name.toLowerCase();kg.ESa.nb(R)&&(R=kg.ESa.J(R),m[A].name=R);if(oe(R,d))return m[A]}return null}rzo(d,m){xh.UISurfaces.MM().then(A=>{let R=null;const da=()=>{R?A.removeNotification(R):v.ULS.sendTraceTag(51512480,399,15,"ShowTranslatorTeachingCallout: Attempting to close callout but id is null.")};var Ea=this.bki(CommonUIStrings.l_TranslatorIntelligentSuggestionsDialogBoxTranslate,
0,da);const ib=this.bki(String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutSecondaryButton,d),1,da);Ea=Object.assign(new uh.a,{target:"button[data-unique-id=Review]",content:CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutMessage,title:String.format(CommonUIStrings.l_TranslatorIntelligentSuggestionsTeachingCalloutTitle,m),primaryButtonProps:Ea,secondaryButtonProps:ib,useTeachingStyles:!0,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,
calloutProps:Object.assign(new lg.a,{preventDismissOnScroll:!0,directionalHint:5,onDismiss:()=>{this.mJo(da)}})});Ea=A.callout(Ea);R=A.addNotification(Ea);return null}).catch(A=>{v.ULS.sendTraceTag(51512481,399,10,"ShowTranslatorTeachingCallout: Error while showing the teaching callout. ErrorMessage:{0}",A);return!1});v.ULS.sendTraceTag(51512482,399,50,"ShowTranslatorTeachingCallout: Teaching Callout Shown. ProcessingTime:{0}",this.XW.pi)}bki(d,m,A){return Object.assign(new Bq.a,{label:d,onExecute:()=>
{this.hui(m,"TeachingCallout");A()}})}mJo(d){v.ULS.sendTraceTag(51512483,399,50,"TeachingCalloutDismiss: Action:{0}, ProcessingTime:{1}","CalloutClosed",this.XW.pi);d()}static sD(){kg.ESa=new Ji.a;kg.ESa.add("zh-cht","zh-hant");kg.ESa.add("zh-chs","zh-hans");kg.ESa.add("nb","no");kg.JVa=new Ji.a;kg.JVa.add("zh-tw","zh-hant");kg.JVa.add("zh-cn","zh-hans");kg.JVa.add("zh-sg","zh-hans");kg.JVa.add("zh-mo","zh-hant");kg.JVa.add("zh-hk","zh-hant");kg.JVa.add("nb-no","no");kg.JVa.add("nn-no","no");kg.JVa.add("pt-br",
"pt")}}kg.ESa=null;kg.JVa=null;Object(y.a)(kg,"TranslatorAugLoopRuntimeManager",null,[54,55]);kg.sD();class ud{constructor(){this.skh=this.W=null}get name(){return"WordEditor.Translator"}init(){n.AFrameworkApplication.K.Nn(()=>{if(ud.iGf())try{this.skh=this.W.resolve("WordEditor.Translator.TranslatorAugLoopRuntimeManager"),this.skh.initialize()}catch(d){v.ULS.sendTraceTag(42500741,399,10,"TranslatorPackage: Failed to initialize AL runtime manager. Exception: {0}",d)}})}dispose(){}wc(d){this.W=d;ud.iGf()&&
(this.W.ia("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition",()=>new Ee).ha(),this.W.ia("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation",()=>new Wd).ha(),this.W.ia("WordEditor.Translator.TranslatorAugLoopRuntimeManager",()=>new kg(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Translator.IntelligentSuggestionsDocumentLanguageComposition"),this.W.resolve("Microsoft.Office.AugLoop.Text.LanguageCountAnnotation"),this.W.resolve("WordEditor.TranslatorRoamingServiceManager"),
this.W.resolve("Box4.IEditViewStateManager"),n.AFrameworkApplication.ta.Kq,n.AFrameworkApplication.K.nc("LanguageIntelligentSuggestionMaxWaitTimeAnnotationsMs",5E3),n.AFrameworkApplication.K.nc("LanguageIntelligentSuggestionMinKnownLangCompositionPercentage",10)/100,n.AFrameworkApplication.K.nc("LanguageIntelligentSuggestionMinProcessedDocLangCompositionPercentage",95)/100,n.AFrameworkApplication.K.nc("LanguageIntelligentSuggestionMinDocumentCharCountFromAnnotations",1E3),!0,!!n.AFrameworkApplication.ta&&
n.AFrameworkApplication.ta.Kb.uF,n.AFrameworkApplication.uiCulture,n.AFrameworkApplication.ta.Kb.TRa,!0,n.AFrameworkApplication.K.nc("LanguageIntelligentSuggestionMaxWaitTimeTeachingCalloutMs",1E4))).as("WordEditor.Translator.ITranslatorAugLoopRuntimeManager").ha())}static main(){ud.iGf()&&z.a.instance.Gc(new ud)}static iGf(){return!n.AFrameworkApplication.eL&&!!n.AFrameworkApplication.K&&n.AFrameworkApplication.K.$("LanguageIntelligentSuggestionIsEnabled")&&n.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&
n.AFrameworkApplication.K.$("AugLoopServerSideSeedingIsEnabled")}}Object(y.a)(ud,"WordEditorTranslatorPackage",null,[1,2]);var Ge=c(1849);class qi{constructor(d,m){this.YBa=d;this.Apk=m;this.KMb=this.KMb.bind(this);this.LMb=this.LMb.bind(this);this.UMb=this.UMb.bind(this)}xde(){this.YBa.x7f(this.KMb);this.YBa.y7f(this.LMb);this.YBa.H7f(this.UMb)}F0d(){return!1}KMb(d,m,A){1<d.length&&"!"===d.trimEnd()?this.YBa.reset():"."===d.charAt(d.length-1)&&this.Apk.Yeo(d,A)}LMb(){}UMb(){}}Object(y.a)(qi,"WordAiAssistantInitHandler",
null,[56]);var fi=c(1112),jh=c(1922),vh=c(1931),zj=c(53);class Rk{constructor(d){zj.a.assign(Rk,this,d)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(d){return zj.a.matchesTypesFor(d,[Rk.getTypeName()])}}Rk.H_={T_:Rk.getTypeName(),B_:Rk.getBaseTypes()};class bk{constructor(d){zj.a.assign(bk,this,d)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(d){return zj.a.matchesTypesFor(d,
[bk.getTypeName()])}}bk.H_={T_:bk.getTypeName(),B_:bk.getBaseTypes()};class yi{constructor(d){zj.a.assign(yi,this,d)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(d){return zj.a.matchesTypesFor(d,[yi.getTypeName()])}}yi.H_={T_:yi.getTypeName(),B_:yi.getBaseTypes()};class nh{constructor(d){zj.a.assign(nh,this,d)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(d){return zj.a.matchesTypesFor(d,
[nh.getTypeName()])}}nh.H_={T_:nh.getTypeName(),B_:nh.getBaseTypes()};class Fj{constructor(d){zj.a.assign(Fj,this,d)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(d){return zj.a.matchesTypesFor(d,[Fj.getTypeName()])}}Fj.H_={T_:Fj.getTypeName(),B_:Fj.getBaseTypes()};class jj{static create(d){const m=new jj(d);return m.activateAnnotation(d.responseType).then(()=>m)}constructor(d){this.config=d;this.nextMessageId=0;
this.responseCallbacks=new Map;const m=["session","chats"],A=Rh.a.create().toString(),R=[...m,A];this.messagesPath=[...R,"messages"];this.config.session.submitOperations([new cg.a({parentPath:m,items:[{id:A,body:d.chat}]}),new cg.a({parentPath:R,items:[{id:"messages",body:new yi}]})])}send(d,m){const A=`${this.nextMessageId++}`;this.responseCallbacks.set(A,m);this.config.session.submitOperations([new cg.a({parentPath:this.messagesPath,items:[{id:A,body:d}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(d){return this.config.session.activateAnnotation(d,
{callback:m=>{if(cg.a.typeGuard(m)&&this.isUnderSubtree(m.parentPath,this.messagesPath))for(const A of m.items){const R=m.parentPath[m.parentPath.length-1],da=this.responseCallbacks.get(R);da&&(da(A.body),this.responseCallbacks.delete(R))}}}).then(({token:m})=>{this.activatedAnnotationToken=m})}isUnderSubtree(d,m){if(d.length<m.length)return!1;for(let A=0;A<m.length;A++)if(d[A]!==m[A])return!1;return!0}}Object(y.a)(jj,"ChatHelper",null,[]);class Pn{constructor(d,m){this.hb=d;this.cMa=m}Yeo(d,m){var A,
R;const da=null===(R=null===(A=this.hb.ib)||void 0===A?void 0:A.lb)||void 0===R?void 0:R.Rc;da&&(A=da.node,Qe.ParagraphReader.Xb(A)&&(A=Qe.ParagraphReader.text(A),0>m||m>A.length||(A=A.substring(0,m),this.createChatHelper({chat:new jh.BasicChat({modelConfig:new vh.OpenAiTextModelConfig({model:vh.OpenAiModel.TextDavinci003,parameters:{temperature:.9}}),context:A,prefixText:"\u00acHuman\u00ac",suffixText:"\u00acAI\u00ac",historyDepth:0}),responseType:jh.BasicChatResponse.getTypeName()}).then(Ea=>{Ea.send(new Fj({message:"Give response to this query as a HTML element to be put inside a paragraph- "+
d}),ib=>{ib=ib.text.replace(/^\n/,"");ib=ib.replace(/\n$/,"");const Qb=jd.a.createTextRange(da.node,0,m+d.length);this.cMa.Xge([Qb],!0,ib,()=>{})})}).catch(()=>{v.ULS.sendTraceTag(508944669,389,15,"WordAiAssistantTextHandler::sendMsg - could not process the request.")}))))}createChatHelper(d){return fi.a.JQd().getSession().then(m=>jj.create({session:m,...d}))}}Object(y.a)(Pn,"WordAiAssistantTextHandler",null,[]);class gi extends kd.a{get name(){return"WordEditor.WordAiAssistantPackage"}F8(d){const m=
new Ge.a(d.resolve("Box4.IEditingDomManager"),d.resolve("Box4.ICaretPositionManager"),d.resolve("Box4.BackspaceDeleteEventSource"),pg.InteractiveViewManager.instance,"!");m.Afb(sf.StaticActiveAppFrame.za().jb,Im.KeyInputManager.instance);d.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler",()=>new qi(m,d.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler"))).ha();d.ia("WordEditor.WordAiAssistantPackage.WordAiAssistantTextHandler",()=>new Pn(d.resolve("Box4.ISelectionManager"),
d.resolve("WordEditor.AppsForOffice.HtmlDataGetSetProvider")));d.resolve("WordEditor.WordAiAssistantPackage.WordAiAssistantInitHandler").xde()}H8(){}G8(){}static main(){n.AFrameworkApplication.K&&n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordAiAssistantPackage",!1)&&z.a.instance.Gc(new gi)}}Object(y.a)(gi,"WordAiAssistantPackage",kd.a,[]);Type.registerNamespace("B4Apps");Type.registerNamespace("ResumeAssistant.AppForOffice");Type.registerNamespace("WEAFO");Type.registerNamespace("WECX");
Type.registerNamespace("WELT");Type.registerNamespace("Wonca.AddInCommands");Type.registerNamespace("Wonca.AppsForOffice");Type.registerNamespace("WordEditor.AcronymsWeb");Type.registerNamespace("WordEditor.AddInCommands");Type.registerNamespace("WordEditor.Assistance");Type.registerNamespace("WordEditor.ConditionalTriggering");Type.registerNamespace("WordEditor.Designer");Type.registerNamespace("WordEditor.EditorUpsell");Type.registerNamespace("WordEditor.Extension");Type.registerNamespace("WordEditor.Ideas");
Type.registerNamespace("WordEditor.Ideas.TriggerModels");Type.registerNamespace("WordEditor.ListTransformationSuggestion");Type.registerNamespace("WordEditor.NeuralRewrite");Type.registerNamespace("WordEditor.OcsConnectionStatus");Type.registerNamespace("WordEditor.OcsVectorClockTelemetry");Type.registerNamespace("WordEditor.Policy");Type.registerNamespace("WordEditor.ProactiveUxGovernance");Type.registerNamespace("WordEditor.ReadingTime");Type.registerNamespace("WordEditor.ResumeAssistant");Type.registerNamespace("WordEditor.SmartLookup");
Type.registerNamespace("WordEditor.SmartLookup.SmartLookupManager");Type.registerNamespace("WordEditor.TextAnalysisServiceHelper");Type.registerNamespace("WordEditor.UpsellCampaign");Type.registerNamespace("WordEditor.Transcription");Type.registerNamespace("WordEditor.Transcription.SDXAddInLoader");Type.registerNamespace("WordEditor.Transformation");Type.registerNamespace("WordEditor.Translator");Type.registerNamespace("WordEditor.DocumentAssemblyEditor");Type.registerNamespace("Common.App.ContentSecurityPolicy");
M.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.DisplayEnvironmentName");O.main();Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("CommandUI.AddInCommands");$e.main();Ro.main();"undefined"==typeof OfficeExtension&&Type.registerNamespace("OfficeExtension");"undefined"==typeof OfficeExtension.WacRuntime&&(OfficeExtension.WacRuntime={},Type.registerNamespace("OfficeExtension.WacRuntime"));
"undefined"==typeof OfficeExtension.WacRuntime.IAsyncEnumerator&&(OfficeExtension.WacRuntime.IAsyncEnumerator=function(){},OfficeExtension.WacRuntime.IAsyncEnumerator.prototype={get_current:null,moveNext:null},OfficeExtension.WacRuntime.IAsyncEnumerator.registerInterface("OfficeExtension.WacRuntime.IAsyncEnumerator"));nt.main();HA.main();window.WordEditor.Extension.Range=mt;window.WordEditor.Extension.AutomationUtility=k;window.WordEditor.Extension.SearchOptions=zh.a;window.WordEditor.Extension.AutomationTransaction=
Uy;n.AFrameworkApplication.eL||z.a.instance.Gc(new Mt);Ke.main();Yv.main();Type.registerNamespace("Common.App.LearningTools");z.a.instance.Gc(new Yl);Cc.main();Type.registerNamespace("Common.App.Policy");tb.main();ui.main();Rw.main();$r.main();try{z.a.instance.Gc(new eu)}catch(d){v.ULS.shipAssertTag(572838543,3025,!1,d.message)}cd.main();if(!n.AFrameworkApplication.eL)if(sf.StaticActiveAppFrame.za())try{z.a.instance.Gc(new Gr(db.a.get_instance(),new Ot,sf.StaticActiveAppFrame.za().jb))}catch(d){v.ULS.shipAssertTag(592720736,
3016,!1,String.format("{0} {1}",d.message,d.stack))}else v.ULS.shipAssertTag(592558211,3016,!1);gb.main();ud.main();tv.main();mc.main();iD.main();Vc()&&z.a.instance.Gc(new (c(1987).ListTransformationSuggestionPackageManager)(Vc()));Bd.main();hB.main();Ty.main();ny.a.main();nd.main();mx.main();Type.registerNamespace("Common.App.AppLoadStateTracker");window.Common.App.AppLoadStateTracker.AppLoadStateTracker=x.a;z.a.instance.Gc(new t,7);gi.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20380705/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll3.js.map
/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1515:function(D,J,c){c.d(J,"a",function(){return n});D=c(0);var l=c(2),e=c(1997),a=c(143),k=c(7),x=c(1646),y=c(1606);class n{static jKa(t,z){t||(k.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",z),n.Tf())}static tpc(t,z){t&&t.count||(k.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",z),n.Tf())}static o2(t,z){n.jKa(t,z);t.isConnected||(k.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",z),n.Tk())}static iy(t,z){null===t&&(k.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",z),n.qd())}static upc(t,z){t&&""!==t||(k.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",z),n.qd())}static ZVa(t,z){if(null===t||0>=t)k.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",z,t),n.qd()}static YVa(t,z){if(null===t||0>t)k.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",z,t),n.qd()}static hQ(t){if("number"===typeof t)return t;n.qd();return 0}static hKa(t,z,v){n.upc(t,z);var I=e.a.zva(t);I=""!==I?I:t;"#"!==I.charAt(0)&&(I="#"+I);let E=!1;if(7>I.length)E=!0;else for(let H=1;7>H;H++){const M=I.charAt(H);if(!("0"<=M&&"9">=M||"A"<=M&&"F">=M||"a"<=M&&"f">=M)){E=!0;break}}if(E)throw k.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",v.appId,z,t),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return n.BHn(I)}static BHn(t){return t.substring(5,7)+t.substring(3,5)+t.substring(1,3)}static $M(t,z,v=0,I=!0){k.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:t,["BlobSize"]:v,["Latency"]:z,["ExecutionStatus"]:I})}static zN(t){return(new Date).getTime()-t}static Tf(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static qd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static zk(t=""){if("Getter"!==t)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static zrb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.PAb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Tk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.$Ym,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static Lmg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static Rnc(t,z,v="",I=""){t="AppId:"+t+",";t=(""!==v?t+("Property"+v):t+"Method")+(":"+z+", currently is not allowed on Word Wac");""!==I&&(t+=" for Parameter:"+I);k.ULS.sendTraceTag(19415938,369,15,t);"Getter"!==v&&n.pD()}static pD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static XKo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.nyn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static Ai(){return l.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static dfd(){return l.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static dqe(){return l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get FAa(){return a.a.z1f}static kKc(t){t=(t||
"").replace(RegExp("\\r","g"),"\\r");t=t.replace(RegExp("\\n","g"),"\\n");return t=t.replace(RegExp("\\v","g"),"\\v")}static Fmc(t){return t.split(RegExp("\r\n|\r|\n"))}static o9i(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static V6f(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static AUn(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static tva(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static f6o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static EGl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static xJh(){var t;l.AFrameworkApplication.se("46ab6280;fg4g7862");return null===(t=l.AFrameworkApplication.K)||void 0===t?
void 0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static Ylf(){l.AFrameworkApplication.se("241fi198;754i3702");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static mPc(){l.AFrameworkApplication.se("0cdc8638;0cdc8638");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static VLj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",
!1)}static j6o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static i6o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static aPh(){var t;l.AFrameworkApplication.se("aa6dc483;d84c1847");return null===(t=l.AFrameworkApplication.K)||void 0===t?void 0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static l6o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",
!1)}static dxj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static BNc(t){null!==t&&void 0!==t&&t.length&&t.some(z=>-1===n.lcd(z))&&n.qd()}static ijf(t,z){null!=t&&(t=n.lcd(t),k.ULS.sendTraceTag(509616404,369,50,`${z}.insertContentControl(${x.a[t]})`),-1===t&&n.qd())}static lcd(t,z=-1){switch(t){case 96:return 1;case 31:return 0;default:return z}}}n.Dmb="\r";n.AWh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);n.Wia=9;Object(D.a)(n,
"Utility",null,[])},1525:function(D,J,c){c.d(J,"g",function(){return I});c.d(J,"f",function(){return E});c.d(J,"e",function(){return H});c.d(J,"d",function(){return M});c.d(J,"h",function(){return K});c.d(J,"i",function(){return L});c.d(J,"a",function(){return S});c.d(J,"k",function(){return Q});c.d(J,"j",function(){return N});c.d(J,"c",function(){return O});c.d(J,"b",function(){return X});var l=c(59),e=c(7),a=c(1538);c.n(a);D=c(1221);c.n(D);c=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},
{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];const k={[D.ParagraphRoleType.Title]:2,
[D.ParagraphRoleType.Subtitle]:3,[D.ParagraphRoleType.FirstLevelHeading]:4,[D.ParagraphRoleType.SecondLevelHeading]:5,[D.ParagraphRoleType.ThirdLevelHeading]:6,[D.ParagraphRoleType.ForthLevelHeading]:7,[D.ParagraphRoleType.FifthLevelHeading]:8,[D.ParagraphRoleType.SixthLevelHeading]:9,[D.ParagraphRoleType.SeventhLevelHeading]:10,[D.ParagraphRoleType.EighthLevelHeading]:11,[D.ParagraphRoleType.NinthLevelHeading]:12,[D.ParagraphRoleType.BodyText]:13,[D.ParagraphRoleType.BulletedListItem]:15,[D.ParagraphRoleType.NumberedListItem]:15};
D=[{role:1,fH:{default:"Unknown",QJ:null}},{role:2,fH:{default:"Title",QJ:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,fH:{default:"Subtitle",QJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,fH:{default:"Heading1",QJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,fH:{default:"Heading2",QJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,fH:{default:"Heading3",QJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,fH:{default:"Heading4",QJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,
fH:{default:"Heading5",QJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,fH:{default:"Heading6",QJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,fH:{default:"Heading7",QJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,fH:{default:"Heading8",QJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,fH:{default:"Heading9",QJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,fH:{default:"BodyText",QJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,fH:{default:"Caption",QJ:Box4Intl.Box4Strings.L_StyleWordCaption}},
{role:15,fH:{default:"ListItem",QJ:null}},{role:16,fH:{default:"SubtleEmphasis",QJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,fH:{default:"Emphasis",QJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,fH:{default:"IntenseEmphasis",QJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,fH:{default:"Strong",QJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,fH:{default:"Quote",QJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,fH:{default:"IntenseQuote",QJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},
{role:22,fH:{default:"SubtleReference",QJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,fH:{default:"IntenseReference",QJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,fH:{default:"BookTitle",QJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,fH:{default:"NoSpacing",QJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const x=new Map(D.map(U=>[U.fH.default,U.role])),y=new Map(D.map(U=>[U.role,U.fH.default])),n=new Map(D.map(U=>[U.role,U.fH.QJ])),t=new Map(c.map(U=>[U.roleType,
U.role])),z=new Map(c.map(U=>[U.role,U.roleType])),v=(U,T,Y)=>U.has(T)?U.get(T):Y,I=U=>v(x,U,1),E=U=>v(t,U,1),H=U=>v(z,U,a.RoleType.Unknown),M=U=>k[U],K=U=>v(y,U,"Unknown"),L=U=>v(n,U,null),S=U=>{switch(U){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},Q=U=>{switch(U){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";
case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";
case 25:return"No Spacing";default:return"Unknown"}},N=U=>{switch(U){case 13:return l.StyleReader.wordStyleIdNormal;case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.wsb;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.hfd;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.MTb;case 8:return l.StyleReader.NTb;case 9:return l.StyleReader.OTb;case 10:return l.StyleReader.Kpc;
case 11:return l.StyleReader.Lpc;case 12:return l.StyleReader.PTb;case 16:return l.StyleReader.vsb;case 17:return l.StyleReader.W9a;case 18:return l.StyleReader.tsb;case 19:return l.StyleReader.oMj;case 20:return l.StyleReader.Opc;case 21:return l.StyleReader.usb;case 22:return l.StyleReader.pMj;case 23:return l.StyleReader.nMj;case 24:return l.StyleReader.lMj;case 25:return l.StyleReader.Npc;case 14:return l.StyleReader.mMj;default:return e.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+
K(U)),"Unknown"}},O=U=>{switch(U){case 18:case 21:case 23:return!0;default:return!1}},X=U=>4<=U&&12>=U},1527:function(D,J,c){c.d(J,"c",function(){return v});c.d(J,"b",function(){return I});c.d(J,"t",function(){return H});c.d(J,"r",function(){return L});c.d(J,"q",function(){return S});c.d(J,"g",function(){return Q});c.d(J,"d",function(){return N});c.d(J,"o",function(){return O});c.d(J,"n",function(){return X});c.d(J,"a",function(){return U});c.d(J,"e",function(){return T});c.d(J,"i",function(){return Y});
c.d(J,"m",function(){return aa});c.d(J,"s",function(){return ba});c.d(J,"j",function(){return oa});c.d(J,"k",function(){return ma});c.d(J,"h",function(){return ea});c.d(J,"v",function(){return ua});c.d(J,"u",function(){return sa});c.d(J,"p",function(){return Aa});c.d(J,"f",function(){return za});c.d(J,"l",function(){return xa});D=c(22);var l=c(61),e=c(115),a=c(125);J=c(394);var k=c(38),x=c(8),y=c(419),n=c(6),t=c(7),z=c(1535);const v=new J.a,I=`.ParaWrappingDiv .${k.a.rMd}`,E=D.a.instance.Ve("Box4.CommentParagraphMapping"),
H=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let M=void 0;const K=()=>{if(void 0===M){let ka;try{ka=CSS.supports("selector(:not(* *))")}catch(wa){ka=!1}ka||t.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");M=ka}return M},L=ka=>!!ka&&!!ka.Df,S=(ka,
wa,ia,va)=>{if(!ka||!ka.objectId)return!1;const na=ia.Eb(l.a.If(ka.objectId)),Ca=z.a.bac(na,!0),ta=z.a.bac(na,!1);if(!Ca||!ta||Ca===ta&&Ca!==wa||!x.ParagraphReader.LXc(wa,Ca,ta))return!1;ka=!0;var fa=!1;Ca===wa&&(fa=z.a.uca(na,ia,!0),ka=ka&&!!fa&&fa.Lb.cp<=va,fa=!!fa&&fa.Lb.cp===va);wa===ta&&(wa=z.a.uca(na,ia,!1),ka=ka&&!!wa&&wa.Lb.cp>va,fa=fa&&!!wa&&wa.Lb.cp===va);return ka||fa},Q=ka=>{if(!ka)return null;ka=e.a.Eb(ka,k.a.CJc);return null!==ka&&void 0!==ka?ka:[]},N=ka=>ka?e.a.Eb(ka,k.a.AHd):null,
O=(ka,wa)=>{if(!ka)return-1;for(let ia=0;ia<ka.length;ia++)if(ka[ia].Zhc.equals(wa))return ia;return-1},X=(ka,wa)=>{if(!ka)return-1;for(let ia=0;ia<ka.length;ia++)if(ka[ia].jui.equals(wa))return ia;return-1},U=ka=>`Comment Object Id: ${ka.objectId}`,T=(ka=!1)=>za(document.getElementById(a.AppFrame.oKa),ka),Y=()=>Array.from(document.getElementById(a.AppFrame.oKa).querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")),
aa=(ka,wa=!1)=>{if(ka.gk){for(const ia of ka.Xg.ij)if(xa(ia,wa))return!0;return!1}return xa(ka.htmlElement,wa)},ba=ka=>!!ka&&!!ka.ja(n.a.AM,null),oa=()=>{const ka=new Set,wa=Y();for(let ia=0;ia<wa.length;ia++)Q(wa[ia]).forEach(va=>{ka.add(va.toString())});return ka},ma=(ka,wa)=>wa?Fa(ka,!0,wa):Pa(ka,!0),ea=(ka,wa)=>wa?Fa(ka,!1,wa):Pa(ka,!1),ua=(ka,wa)=>{Na(ka,wa,!0);y.a.isEnabled&&!ka.jlb&&t.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ka.id} StartParaId: ${wa}`)},
sa=(ka,wa)=>{Na(ka,wa,!1);y.a.isEnabled&&!ka.jlb&&t.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${ka.id} EndParaId: ${wa}`)},Fa=(ka,wa,ia)=>{var va,na;const Ca=ka.id.toString();return wa?y.a.isEnabled?null!==(va=E.value.H0a.get(Ca))&&void 0!==va?va:ia:ka.ja(n.a.ZUa,ia):y.a.isEnabled?null!==(na=E.value.G0a.get(Ca))&&void 0!==na?na:ia:ka.ja(n.a.mwa,ia)},Pa=(ka,wa)=>{const ia=ka.id.toString();return wa?y.a.isEnabled?E.value.H0a.get(ia):ka.getValue(n.a.ZUa):y.a.isEnabled?
E.value.G0a.get(ia):ka.getValue(n.a.mwa)},Na=(ka,wa,ia)=>{const va=ka.id.toString();y.a.isEnabled?ka.jlb||(ia?E.value.H0a:E.value.G0a).set(va,wa):ka.setValue(ia?n.a.ZUa:n.a.mwa,wa)},Aa=ka=>y.a.isEnabled?E.value.H0a.has(ka.objectId)&&E.value.G0a.has(ka.objectId):!0,za=(ka,wa)=>{if(wa){if(K())return Array.from(ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)"));
wa=ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart");const ia=wa.length;if(0<ia){ka=ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const va=[];let na=0;for(let Ca=0,ta=ka.length;Ca<ta;Ca++){const fa=ka[Ca];na<ia&&wa[na]===fa?++na:va.push(fa)}return va}}return Array.from(ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},
xa=(ka,wa)=>{if(wa){if(K())return!!ka.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)");wa=ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length;
if(0<wa)return wa!==ka.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ka.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1530:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(2),e=c(1836),a=c(19);class k{static y$h(){return k.nAk+"_"+e.a.TTc+"_"+a.a.PQ(l.AFrameworkApplication.userName)+"_"}static X4h(x){return x+"_"+e.a.TTc+"_"+a.a.PQ(l.AFrameworkApplication.userName)+"_"}static Ifi(){return k.MIn+
"_"+e.a.TTc+"_"+a.a.PQ(l.AFrameworkApplication.userName)+"_"}}k.hOa="ack0";k.iOa="ack1";k.JCd="ack2";k.nAk="ack3";k.Yrh="ack4";k.Zrh="ack7";k.EGi="ack8";k.isj="ack9";k.Z3e="ack10";k.Awo="ack13";k.OGi="ack14";k.W2b="AddinDetailsRefreshed";k.lAk="DdaMethod";k.kAk="ControlId";k.NCd="OsfcontrolId";k.$0e="SecurityOrigin";k.Y2b="ak0";k.sAk="ak1";k.bsh="ak2";k.U0e="ak4";k.Xrh="Office.AutoShowTaskpaneWithDocument";k.$rh="value";k.rAk="errorCode";k.Xtl="SourceControlId";k.Vtl="OsfControl";k.Wtl="RibbonUpdaterData";
k.ome="AddinShared";k.MIn="__OSF_PRIVATECATALOG_ADDINIDS";Object(D.a)(k,"AddinConstantsString",null,[])},1532:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1853),J);e(c(1854),J)},1535:function(D,J,c){D=c(0);var l=c(22),e=c(81),a=c(61),k=c(2),x=c(738),y=c(139),n=c(244),t=c(613),z=c(25),v=c(5),I=c(257),E=c(8),H=c(419),M=c(329),K=c(1191),L=c(76),S=c(65),Q=c(1799),N=c(1841),O=c(1842),X=c(16),U=c(6),T=c(601),Y=c(7),aa=c(111),ba=c(251),oa=c(83),ma=c(1696);class ea extends Sys.EventArgs{constructor(xa,ka){super();this.graphNode=xa;this.Z1k=ka}}Object(D.a)(ea,"OnCopyCommentEventArgs",Sys.EventArgs,
[]);class ua extends Sys.EventArgs{constructor(xa,ka){super();this.graphNode=xa;this.T_k=ka}}Object(D.a)(ua,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var sa=c(1223),Fa=c(1527),Pa=c(1599);class Na extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(D.a)(Na,"OnDeleteEventArgs",Sys.EventArgs,[]);class Aa extends Sys.EventArgs{constructor(xa){super();this.commentNode=xa}}Object(D.a)(Aa,"OnPasteEventArgs",Sys.EventArgs,[]);c.d(J,"a",function(){return za});class za{static get jg(){return null!=
za.lxg?za.lxg:za.lxg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fd(){return null!=za.Wyg?za.Wyg:za.Wyg=new e.a}static get ZDa(){return Pa.a.instance}static get sj(){return z.StaticActiveAppFrame.za().jb.Zc.xd}static get Zb(){return null!=za.Wzg?za.Wzg:za.Wzg=l.a.instance.Oa("Box4.IFeatureHelper")}static isComment(xa){return 40===xa.Xe}static IZd(xa){return 40===xa.type}static kEf(xa){return!!xa&&39===xa.Xe}static uWf(xa,ka){ka.property===X.a.gf&&(za.hJb=!1)}static yWf(xa,ka){ka&&
!xa.Qc&&za.wRh(xa)}static wRh(xa){const ka=xa.Lb.paragraph.Mc;xa=ka.Eb(xa.Lj);za.ANc();xa&&xa.anchor&&za.deleteComment(xa,ka)}static Qbf(xa){const ka=new v.GraphIterator;ka.set(xa.Zi());za.ZDa.Z5a(ka);return ka}static deleteComment(xa,ka){xa?(za.ANc(),za.aLd(xa,ka),xa.anchor&&(za.fd.raiseEvent(za.m2c,new Na(xa)),ka=xa.ja(U.a.hF,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${xa.id}`),za.dQg.add(ka.toString()),ka=new v.GraphIterator,ka.set(xa),ka.zb(39),ka.tg())):
Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static GLm(xa){return za.dQg.contains(xa)}static aLd(xa,ka){za.ANc();const wa=za.uca(xa,ka,!0);ka=za.uca(xa,ka,!1);za.opb(wa);za.opb(ka);wa&&ka&&wa.Lb===ka.Lb&&Y.ULS.sendTraceTag(50619292,327,10,`comment ${xa.id} start and end range objects belonged to same chp`)}static opb(xa){if(xa&&xa.Lb.Ue){xa.Lb.Ue.remove(xa);const ka=xa.Lb.paragraph;0<=xa.pe&&xa.pe<ka.xe.length&&(xa.Lb.cp||1!==ka.xe.length||(ka.xe.xY(0,4),ka.xe.uq.Z(1,I.CharacterPropertiesEditor.bN),
ka.xe.ot.Z(1,I.CharacterPropertiesEditor.ZR)),ka.xe.removeAt(xa.pe,4));ka.Xl()}}static pmn(xa,ka){if(ka){var wa=ka.paragraph;xa=ka.cpBegin;var ia=ka.cpEnd;if(wa&&E.ParagraphReader.Xb(wa)&&(wa=wa.ra)){ka.So[za.MHd]||(ka.So[za.MHd]=[]);ka=ka.So[za.MHd];for(let na=0;na<wa.length;na++){const Ca=wa.J(na).Ue;if(!Ca)continue;const ta=Ca.length;var va=wa.J(na).cp;if(va<xa||va>ia)for(va=0;va<ta;va++)ka.push(Ca.J(va))}}}}static yln(xa,ka){if(ka&&(xa=ka.So[za.MHd]))for(ka=0;ka<xa.length;ka++)za.wRh(xa[ka])}static uca(xa,
ka,wa){if(!xa)return null;const ia=wa?Fa.k(xa,a.a.nil):Fa.h(xa,a.a.nil);ka=ka.Eb(ia);return ka?za.Gwa(ka,xa.id,wa):(wa||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${xa.id} Anchor Id: ${ia} ${za.FLm(ia)}`),null)}static FLm(xa){return H.a.isEnabled?`isDeletedParagraph: ${za.ZRh.has(xa.toString())}`:""}static Gwa(xa,ka,wa){for(let ia=0;ia<xa.ra.length;ia++){const va=xa.ra.J(ia);if(va.Ue)for(let na=0;na<va.Ue.length;na++)if(va.Ue.J(na).Lj.equals(ka)&&wa===va.Ue.J(na).Qc)return va.Ue.J(na)}return null}static bac(xa,
ka){if(!xa)return null;ka=ka?Fa.k(xa,a.a.nil):Fa.h(xa,a.a.nil);return xa.Mc.Eb(ka)}static fQc(xa,ka,wa,ia=null){const va=!ia;for(let na=0;na<xa.ra.length;na++){const Ca=xa.ra.J(na);if(Ca.cp>=ka&&Ca.Ue)for(let ta=0;ta<Ca.Ue.length;ta++){const fa=Ca.Ue.J(ta).Lj.toString();if(Ca.Ue.J(ta).Qc===wa&&(va||ia.contains(fa)))return Ca.Ue.J(ta)}}return null}static S2l(xa,ka,wa,ia){for(let va=0;va<xa.ra.length;va++){const na=xa.ra.J(va);if(na.cp>ka)break;if(na.cp===ka&&na.Ue)for(let Ca=na.Ue.length-1;0<=Ca;Ca--){const ta=
na.Ue.J(Ca).Lj.toString();if(na.Ue.J(Ca).Qc===wa&&ia.contains(ta))return na.Ue.J(Ca)}}return null}static u2b(xa,ka,wa,ia){let va=null;for(let na=0;na<xa.ra.length;na++){let Ca=xa.ra.J(na);if(Ca.cp>=wa){Ca.cp>wa||!Ca.formatting?(va=za.jg.sZ(xa,na,wa,va),Ca=xa.ra.J(na)):va=Ca.formatting;Ca.Ue||(Ca.Ue=new M.a(Ca));za.OBd(ka,Ca.Ue,va.Xj,ia);break}Ca.formatting&&(va=Ca.formatting)}}static OBd(xa,ka,wa,ia){wa=ka.Lb.paragraph;const va=new K.a(ka.Lb,null,xa,ia);for(let na=0;na<ka.length;na++)if(ka.J(na).Lj===
xa&&ka.J(na).Qc===ia){Y.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",xa,ia);break}ka.add(va);wa.Xl();va.pe?wa.xe.xY(va.pe-1,4):wa.xe.npa(va.pe,4);wa.xe.uq.Z(va.pe,I.CharacterPropertiesEditor.bN);wa.xe.ot.Z(va.pe,I.CharacterPropertiesEditor.ZR);return va}static ANc(){if(!za.hJb){var xa=new v.GraphIterator;xa.set(z.StaticActiveAppFrame.za().jb.Zc);za.ZDa.Z5a(xa);if(xa.Tb(1))for(;xa.Lf(1););za.hJb=!0}}static EEl(xa){const ka=
new v.GraphIterator;ka.set(z.StaticActiveAppFrame.za().jb.Zc);za.ZDa.Z5a(ka);if(39!==ka.Xe)return!1;let wa;if(wa=ka.Tb(1)){if(wa.id.equals(xa))return!0;for(;wa=ka.Lf(1);)if(wa.id.equals(xa))return!0}return!1}static RMb(xa,ka){za.R6c(ka)}static oRj(xa,ka){H.a.isEnabled&&(xa=ka.node)&&(ka=E.ParagraphReader.uR(xa),za.Wfe(ka)&&za.ZRh.add(xa.id.toString()))}static Wfe(xa){return 0<xa?document.querySelector("div.PageContentContainer p[paraid='"+xa+"']"):null}static R6c(xa){za.f8f(E.ParagraphReader.YFb(xa));
let ka=null;var wa=new v.GraphIterator;wa.set(xa);if(wa.Ip()&&(wa=L.a.Gs(wa,wa.origin),wa.moveNext()))for(;wa.moveNext();)if(E.ParagraphReader.oh(wa.iterator)){ka=wa.iterator.currentNode;break}if(ka){xa=E.ParagraphReader.YFb(xa);for(const ia of xa)ia.Qc&&(xa=ia.Lb.paragraph.Mc.Eb(ia.Lj))&&(za.opb(ia),za.u2b(ka,xa.id,0,!0),Fa.v(xa,ka.id))}}static f8f(xa){for(const ka of xa)if(!ka.Qc){xa=ka.Lb.paragraph.Mc;const wa=xa.Eb(ka.Lj);za.deleteComment(wa,xa)}}static MTd(xa,ka){const wa=[];if(!xa)return Y.ULS.shipAssertTag(594908762,
327,!1,"Trying to highlight null node."),wa;if(!xa.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),wa;const ia=za.uca(xa,za.sj,!0),va=za.uca(xa,za.sj,!1);if(!ia||!va)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${xa.id}`),wa;xa=!1;let na=ia.Lb.paragraph;for(;na&&(!ka||!ka(na,na===ia.Lb.paragraph));){na===ia.Lb.paragraph&&(xa=!0);xa&&wa.push(na);if(na===va.Lb.paragraph)break;na=E.ParagraphReader.Wf(na,!1)}return wa}static vWf(xa,
ka){ka.So.Comments||(ka.So.Comments={});za.l7d(ka.operation,ka.v_i,ka.original,ka.clone,ka.So.Comments,!0)}static xWf(xa,ka){ka.So.Comments||(ka.So.Comments={});za.l7d(ka.operation,ka.v_i,ka.original,ka.clone,ka.So.Comments,!1)}static knn(xa,ka){ka.So.Comments||(ka.So.Comments={});xa=ka.So.Comments;if((ka=Object.keys(xa))&&0<ka.length)for(let wa=0;wa<ka.length;wa++){const ia=xa[ka[wa].toString()];ia&&(ia.Lj=null,za.opb(ia))}}static l7d(xa,ka,wa,ia,va,na){const Ca=wa.Mc;var ta=E.ParagraphReader.YFb(ia);
ta.sort((Ia,Ya)=>Ia.Lb.cp<Ya.Lb.cp||Ia.Lb.cp===Ya.Lb.cp&&Ia.Qc?-1:Ia.Lb.cp===Ya.Lb.cp&&Ia.Qc===Ya.Qc?0:1);const fa=new oa.a,Xa=new ba.a,ob=za.Zb.isFeatureEnabled(115);for(const Ia of ta)if(Object(aa.a)(sa.MainView,S.InteractiveViewManager.instance.yd)){var xb=Ca.Eb(Ia.Lj);if(xb&&xb.isConnected)if(Ia.Qc)va[Ia.Lj.toString()]=Ia;else{var zb=xb.ja(U.a.hF,0);ta=na?za.M4c(xb,ia,xa,ka):za.R4c(xb,ia,xa,ka);if(na)ob&&(zb=v.GraphIterator.eb(ia),zb.zb(25)&&zb.jd(25)&&ma.a.fd.raiseEvent(ma.a.UUi,new ea(zb.currentNode,
ta.getValue(U.a.hF))));else{if(ob){var Lb=ta.ja(U.a.hF,0);zb&&Lb&&(Xa.nb(zb)?Xa.J(zb)!==Lb&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",zb,Lb,Xa.J(zb)):Xa.add(zb,Lb))}ta.setValue(U.a.hlb,!0);xb.ja(U.a.L9e,null)||(zb=xb.ja(U.a.SOa,null))&&ta.setValue(U.a.L9e,zb);ta.setValue(U.a.SOa,k.AFrameworkApplication.userSessionId)}zb=Ia.Lj.toString();Lb=va[zb];Ia.Lj=ta.id;if(!na){Ia.jv=
null;xb=xb.getValue(U.a.MH);const Ya=ta.getValue(U.a.MH);va[xb]=Ya;if(xb=ta.ja(U.a.AM,null))fa.nb(xb)||fa.add(xb,[]),fa.J(xb).push(ta)}Fa.u(ta,ia.id);ia.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Lb?(Lb.Lj=ta.id,na||(Lb.jv=null),Fa.v(ta,Lb.Lb.paragraph.id),delete va[zb]):(za.u2b(ia,ta.id,Ia.Lb.cp,!0),Fa.v(ta,ia.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",za.EEl(Ia.Lj),!xb)),
Ia.Lj=null,za.opb(Ia)}else Ia.Lj=null,za.opb(Ia);if(!na){for(const Ia of fa){xa=Ia.key;ka=Ia.value;for(const Ya of ka)Ya.setValue(U.a.AM,va[xa])}0<Xa.count&&ob&&(wa=v.GraphIterator.eb(wa),wa.zb(25)&&wa.jd(25)&&ma.a.fd.raiseEvent(ma.a.vXi,new ua(wa.currentNode,Xa)))}ia.jk()}static Xif(xa,ka){if(xa.zb(25)&&xa.jd(25)&&!xa.Jt(16)){const wa=v.GraphIterator.eb(ka);wa.zb(39);wa.jd(39);ka=T.b(wa.currentNode,ka.Zi().Mc,!0);xa.Bf(ka,16)}}static Laf(xa,ka){var wa=ka.Zi().xd;wa=T.b(xa,wa,!0);ka=v.GraphIterator.eb(ka);
za.Xif(ka,xa);ka.Tb(16);ka.Q3(wa,1,xa.id);return wa}static M4c(xa,ka,wa,ia){za.ANc();ka=za.Laf(xa,ka);ka.jlb=!0;za.xzl(xa,ka,wa,ia);return ka}static xzl(xa,ka,wa,ia){xa=new Q.a(v.GraphIterator.eb(xa),v.GraphIterator.eb(ka),{});xa.WQb=!0;wa=new x.a(wa,ia,new N.a(xa,null));wa.Qh=!0;wa.Rl("ExecuteInternalCommentCopy");wa.run()}static R4c(xa,ka,wa,ia){za.ANc();var va=ka.Zi().xd;ka=v.GraphIterator.eb(ka);ka.zb(7);ka.jd(7);ka.Tb(16);va=T.b(xa,va,!0);va.Gg(U.a.MH,y.a.create().toString());va.Gg(U.a.commentId,
n.a.FF());let na=!1;za.REi(va.tf(U.a.hF))?na=!0:va.Gg(U.a.hF,za.Hqf());ka.Bf(va,1);za.yzl(xa,va,wa,ia);ka.Bj(va);ka.EJ(1);ka.ajb(2);ka.Tb(2);va.setValue(U.a.MH,ka.currentNode.tf(U.a.Wc).toString());za.fd.raiseEvent(za.Bsn,new Aa(va));na&&this.SPh.add(va.id.toString());return va}static yzl(xa,ka,wa,ia){xa=new O.a(v.GraphIterator.eb(xa),v.GraphIterator.eb(ka),null,null);wa=new x.a(wa,ia,xa);wa.Qh=!0;wa.Rl("ExecuteInternalCommentPaste");wa.run()}static Hqf(){const xa=n.a.kjc(1,this.bOi);return za.REi(xa)?
xa:za.Hqf()}static REi(xa){if(!xa)return!1;if(z.StaticActiveAppFrame.za()){const ka=new v.GraphIterator;ka.set(z.StaticActiveAppFrame.za().jb.Zc);za.ZDa.Z5a(ka);let wa=ka.Rd();for(;wa;){if(wa.tf(U.a.hF)===xa)return!1;wa=ka.Oj()}}return!0}static x0e(xa){za.fd.addHandler(za.m2c,xa)}}za.Bsn="OnPaste";za.m2c="OnDelete";za.MHd="CommentRangesToTrimOutsideSelection";za.dQg=new t.a;za.hJb=!1;za.bOi=2147483646;za.SPh=new Set;za.ZRh=new Set;Object(D.a)(za,"CommentEditor",null,[])},1538:function(D,J,c){var l=
this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1838),J);e(c(1839),J)},1541:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e){super();this.data=e}}Object(D.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1543:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.completion=new Promise((e,a)=>{this.resolve=e;this.reject=a})}}Object(D.a)(l,"ControlledPromise",null,[])},1545:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.vq="SpellingErrorV2";l.ejg="SpellingErrorV2Themed";l.R6k="ContextualSpellingAndGrammarErrorV2";
l.naf="ContextualSpellingAndGrammarErrorV2Themed";l.TCd="AdvancedProofingIssueV2Themed";l.Z7i="AdvancedProofingIssueV2Themed";l.buj="SimilarityReviewed";l.cuj="SimilarityReviewedThemed";l.duj="SimilarityUnreviewed";l.euj="SimilarityUnreviewedThemed";l.BKh="CopilotHighlightThemed";l.Cmc="SpellingErrorHighlight";l.wac="GrammarErrorHighlight";l.gfb="CritiqueIndicatorHighlight";l.Y7i="ReactiveRewriteIndicatorHighlight";l.Rzo="SimilarityHighlight";l.Szo="SimilarityReviewedHighlight";l.kEd="IdeasSuggestionConfirmation";
Object(D.a)(l,"CanvasContextualCssClasses",null,[])},1547:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);var l=c(6),e=c(292),a=c(1200),k=c(1106),x=c(7);class y{constructor(n,t,z,v){this.Y0m=n;this.cGm=t;this.bGm=z;this.w2i=v}nic(n,t,z,v,I){n?(n=this.PKc(n,t,z),null!==n&&(v=this.$af(v,n,I),this.bGm.setState(this.Y0m.value,v))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}PKc(n,t,z){return 0>z?(x.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),
null):e.a.ZKc(n.ja(l.a.Wc,-1),n.ja(l.a.uj,-1),t,z,t,z,n)}$af(n,t,z){return Object.assign(new k.a,{annotationType:n,contentDescriptor:t,state:z})}ODf(n,t,z,v,I){if(n){var E=n.ja(l.a.Wc,-1),H=n.ja(l.a.uj,-1);-1===E||-1===H?I(null):(n=this.PKc(n,t,z),null===n?I(0):this.cGm.I2c(n,v,M=>{I(M)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}yDn(n){if(n){var t=a.a.mal(n);this.w2i.Oph({wqb:t,settingType:n})||x.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}rVm(n){return new Promise(t=>
{this.w2i.Xei(n,z=>{(null===z||void 0===z?0:z.wqb)?t(z.wqb):t(null)})})}}y.m4f="WordDesignerPullQuotesAnnotation";y.tQh="WordDesignerDefaultAnnotation";y.xkg="WordDesignerSuggestedImageAnnotation";y.Jzj="WordDesignerThemeImageAnnotation";y.lkg="WordDesignerStylizedTitleAnnotation";y.n5b="WordDesignerComplexDecoratorAnnotationType";y.pSh="DesignerPaneSuppressionSetting";Object(D.a)(y,"PersistenceHelperImpl",null,[957])},1548:function(D,J,c){function l(K){return 1===(null===K||void 0===K?void 0:K.Jq)||
3===(null===K||void 0===K?void 0:K.Jq)}D=c(0);var e=c(40),a=c(43),k=c(32),x=c(7),y=c(1648),n;(function(K){K[K.initial=0]="initial";K[K.h4o=.1]="viewingOriginal";K[K.gHk=.5]="applying";K[K.applied=1]="applied";K[K.bfp=2]="accepted";K[K.rejected=3]="rejected";K[K.yrp=4]="roleChanged";K[K.tmp=5]="invalidated"})(n||(n={}));Object(D.b)("ReviewIntentState",n);const t=K=>{switch(K){case n.h4o:return n.rejected;case n.gHk:return n.applied;default:return K}};var z=c(138);c.d(J,"d",function(){return I});c.d(J,
"e",function(){return l});c.d(J,"b",function(){return E});c.d(J,"c",function(){return H});c.d(J,"a",function(){return M});class v{constructor(K,L,S=null,Q,N=!0){this.id=K;this.Jq=L;this.qE=S;this.Zd=Q;this.RKm=N;this.fzi=!1;this.hGi=e.a.$e()}Vni(){return!1}uSa(K){this.e5(n[t(K)]);this.T3d(K)}T3d(K){1===K&&this.qE&&this.Zd&&(this.RKm?(this.Zd.sIm()&&this.qE.execute(L=>{L.logActivity(z.a.UTj,null)}),2===this.Jq&&this.Zd.uWm()?this.qE.execute(L=>{L.logActivity(z.a.jUj,null)}):1===this.Jq&&this.Zd.oSm()?
this.qE.execute(L=>{L.logActivity(z.a.dUj,null)}):0===this.Jq&&this.Zd.fOm()&&this.qE.execute(L=>{L.logActivity(z.a.YTj,null)})):4===this.Jq&&this.Zd.OLm()&&this.qE.execute(L=>{L.logActivity(z.a.WTj,null)}))}Q_c(){6E4>e.a.$e()-this.hGi?this.e5("removed"):x.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Jq,"removedButKept")}p6m(){this.fzi||(this.e5("hovered"),this.fzi=!0)}e5(K){this.hGi=e.a.$e();x.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",
this.id,this.Jq,K);a.a(z.a.anl,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Jq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:K})])}}Object(D.a)(v,"DesignerSuggestion",null,[]);class I extends v{constructor(K,L=1,S=null,Q,N=!1,O=0,X=""){super(K,L,S,Q,N);this.Y6a=O;this.f5c=X}}Object(D.a)(I,"PullQuoteSuggestion",v,[]);class E extends v{constructor(K,L,S,Q=null,N,O){super(K,2,Q,N);this.BR=L;this.baseUrl=S;this.D1d=O;this.selectedIndex=
0;this.Vmc=z.a.GAm}Wym(){x.ULS.shipAssertTag(527708514,3016,this.Vmc===z.a.akn,`${this.Vmc}`);this.Vmc=Math.min(this.BR.length,z.a.M4d)}Vni(){return this.Vmc<Math.min(this.BR.length,z.a.M4d)}rGb(K){return K>=this.BR.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.BR[K].imageId}dwf(K){return K>=this.BR.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.BR[K].thumbnailId}eY(K){return K>=this.BR.length?(x.ULS.shipAssertTag(527708545,3016,!1),null):this.BR[K].altText?
this.BR[K].altText:this.BR[K].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}U0l(K){var L;return K>=this.BR.length?(x.ULS.shipAssertTag(527210446,3016,!1),0):null!==(L=this.BR[K].score)&&void 0!==L?L:0}uSa(K){if(!this.D1d){const L=n[t(K)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,L);a.a(z.a.Kml,!0,void 0,
[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:L})])}super.uSa(K)}}Object(D.a)(E,"ImageSuggestion",v,[]);class H extends v{constructor(K,L=null,S,Q,N=null){super(K,0,L,S,Q);this.metadata=N;this.wPi=!1}uSa(K){this.wPi||(this.wPi=!0,this.metadata&&a.a(z.a.fbl,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.uSa(K)}}Object(D.a)(H,"InconsistencySuggestion",v,[]);class M extends v{constructor(K,L=
null,S,Q=!1,N){super(K,4,L,S,Q);this.lCn=N}uSa(K){this.jGo=K;super.uSa(K)}}Object(D.a)(M,"DesignerPasteSuggestion",v,[])},1550:function(D,J,c){c.d(J,"a",function(){return l});const l={hHh:"CommentDeepLinkNavigationFailed",yHd:"CommentDataLoss",g5b:"CommentExperienceDegraded",Ikf:"CommentsFeatureUsage",P9e:"CommentThreadInProgress",NHd:"CommentReplyInProgress",kHh:"CommentEditInProgress",zHd:"CommentDeepLink",fHh:"CommentCommit",h5b:"CommentLoad",zHh:"CommentInitialization"}},1551:function(D,J,c){c.d(J,
"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1,y=!1,n=!1,t=!1,z=null){this.ul=e;this.source=a;this.hSa=k;this.xga=x;this.wmc=y;this.Rjf=n;this.pPa=t;this.Ro=z}}Object(D.a)(l,"ContextualIntentInvocationParameters",null,[])},1552:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=null,n=null,t=null,z=0,v=0){this.n5=this.Enc=this.ZHa=this.cS=null;this.TH=z;this.bde=e;this.nTa=a;this.V8a=k;x&&(this.cS=x);null!=y&&(this.ZHa=y);null!=n&&(this.Enc=n);t&&
(this.n5=t);this.shapeId=v}}Object(D.a)(l,"AnchorData",null,[])},1556:function(D,J,c){c.d(J,"a",function(){return v});D=c(0);var l=c(19),e=c(192),a=c(15),k=c(539),x=c(44),y=c(17),n=c(23),t=c(238),z=c(8);class v{constructor(I,E,H,M,K){this.lIb=I;this.v3a=E;this.kxb=H;this.Xla=M;this.Md=K;this.H5g=0;this.Cbb=null;this.cjk=!1;this.p5g=!0;this.f0g=null;this.p1c=this.Yqd=!0;this.v1g=!1;this.MAc=I?I.innerText:z.ParagraphReader.text(E)}get aD(){throw Error.notImplemented("The inherit class should have the default value.");
}set aD(I){}get UKb(){return this.H5g}ppj(I){this.H5g=I}get lb(){return this.Cbb}set lb(I){this.Cbb=I}get YG(){return this.kxb}get c1(){return this.Xla}get xyi(){return this.v1g}get EEi(){return!1}get Lya(){return this.MAc}get Ivo(){return!0}invoke(){this.v1g=!0;if(this.lIb&&this.lIb.parentNode&&!this.aD){var I=this.lIb.innerText;if(this.p1c&&l.a.substring(this.MAc,this.kxb,this.Xla)!==l.a.substring(I,this.kxb,this.Xla))return 0;this.iEb(this.lIb);this.ppj(this.lIb.innerText.length-I.length);return 1}this.Yqd||
e.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.p5g)return e.a.instance.Yb("AbortedAction",{["Reason"]:this.f0g}),0;var E=z.ParagraphReader.text(this.v3a);I=E.length;var H=this.MAc.length,M=l.a.substring(this.MAc,this.kxb,this.Xla).trimEnd();E=l.a.substring(E,this.kxb,this.Xla).trimEnd();this.Ivo&&M===E&&this.Xla>H&&(this.Xla=H);if(this.p1c&&M!==E)if(H=M.replace(RegExp('"',"g"),""),H===l.a.substr(E,0,H.length))this.Xla-=2;else return 0;if(a.App.zd.Uo&&k.CoauthLockEditor.getInstance().p8a(v.Xf.E9b(this.v3a)))return 0;
H=new x.GraphTransaction(15);H.Db(this.v3a);H.Uj=this.commandId;this.coa(this.v3a);this.ppj(z.ParagraphReader.textLength(this.v3a)-I);this.Cbb&&!this.cjk&&y.SelectionEditor.Pl(this.Cbb)&&(E=this.Cbb.Pa,I=E.cpBegin,M=E.cpEnd,E=E.node,E===this.v3a&&this.UKb&&(I>=this.Xla&&(I+=this.UKb),M>=this.Xla&&(M+=this.UKb),this.Cbb=n.SelectionFactory.mJ(E,I,M)));H.dispose();return 2}VJj(){this.Yqd=this.gEh()}iEb(){}gEh(){var I=z.ParagraphReader.text(this.v3a);const E=l.a.substring(this.MAc,this.kxb,this.Xla).trimEnd();
I=l.a.substring(I,this.kxb,this.Xla).trimEnd();return E===I}static get Xf(){return t.a.instance}}Object(D.a)(v,"AAutoCorrectAction",null,[519])},1557:function(D,J,c){c.d(J,"a",function(){return Q});D=c(0);var l=c(115),e=c(2),a=c(553),k=c(243),x=c(340),y=c(1545),n=c(786),t=c(307),z=c(509),v=c(644);c.n(v);var I=c(871);c.n(I);var E=c(614),H=c(1067),M=c(1680),K=c(105),L=c(872),S;(function(N){N[N.Spelling=0]="Spelling";N[N.Grammar=1]="Grammar";N[N.Style=2]="Style";N[N.sqc=3]="Similarity";N[N.Ptg=4]="ContextIQ";
N[N.rNj=5]="AutoReplace";N[N.Stg=6]="CopilotHighlight"})(S||(S={}));Object(D.b)("AnnotationRenderCategory",S);class Q{static IUl(N){switch(Q.qUd(N)){case S.Spelling:N=y.a.ejg;break;case S.Grammar:N=y.a.naf;break;case S.sqc:N=60!==N.M_.state&&70!==N.M_.state?y.a.euj:y.a.cuj;break;case S.Ptg:if(M.a.pDi(N))return;N=y.a.TCd;break;case S.rNj:N=y.a.kEd;break;case S.Stg:N=y.a.BKh;break;default:N=y.a.TCd}return N}static Ojm(N){switch(Q.qUd(N)){case S.Spelling:return t.f.SpellingSquiggle;case S.Grammar:return t.f.GrammarSquiggle;
default:return t.f.CritiqueSquiggle}}static qUd(N){let O;if(Q.iec(N)){switch(N.priority){case 0:O=S.Spelling;break;case 1:O=S.Grammar;break;default:O=S.Style}Object(L.b)()&&this.iZd(N)&&(O=S.Stg)}else Q.aec(N)?O=S.sqc:Q.LWc(N)&&(O=S.Ptg);return O}static iZd(N){return k.a.getTypeNameFor(N)===v.AddInTextAnnotation.getTypeName()}static iec(N){const O=k.a.getTypeNameFor(N);return O===x.a.getTypeName()||O===n.a.getTypeName()||Object(L.b)()&&this.iZd(N)}static LWc(N){return k.a.getTypeNameFor(N)===I.FlagAnnotation.getTypeName()}static aec(N){return k.a.getTypeNameFor(N)===
a.a.getTypeName()}static m1d(N){return Q.iec(N)?0===N.priority:!1}static D_d(N){return Q.iec(N)?1===N.priority:!1}static VHm(N){return k.a.getTypeNameFor(N)===n.a.getTypeName()}static TDf(N){return null!=N&&"Spelling"===N.categoryName&&1===N.suggestions.length&&4===(N.suggestions[0].suggestionActions&4)}static Bgm(N,O){const X=[t.b.IgnoreOnce];switch(N){case 0:X.push(t.b.IgnoreAll);O&&X.push(t.b.AddToDictionary);break;case 1:X.push(t.b.Options)}return X}static F6h(N){return Q.iec(N)?N.categoryName:
Q.aec(N)?Q.auj:Q.LWc(N)?Q.gHl:null}static $uf(N,O){let X=z.a.Jlc;switch(N){case 0:X=O?z.a.pie:z.a.jqj;break;case 1:X=z.a.iqj}return X}static p9b(N,O=!1,X){X="IntentProvider_Suggestion_"+X;let U=l.a.Eb(N,X);O&&!U&&l.a.Sl(N,X,U=new E.a);return U}static Fyf(N,O,X,U,T,Y,aa,ba,oa=!1,ma){U&&X&&(!(X=Y.Q4h(X,T))||!H.a.PGa()&&e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.qUd(X)==S.Style||(aa.kNd(N,O,ba),Q.p9b(N,!0,ma).add(X.id),O=Q.IUl(X),N.classList.add(O),
Q.gTb&&Q.KZe(N,X),oa&&H.a.T_c()))}static get gTb(){return null!=Q.GJg?Q.GJg:Q.GJg=e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static KZe(N,O){Q.m1d(O)?N.setAttribute("aria-invalid","spelling"):Q.D_d(O)&&N.setAttribute("aria-invalid","grammar")}static BRa(N,O,X){N=(N=Q.p9b(N,!1,X))?K.firstOrDefault(N):null;return{returnValue:!!N,type:N?X:null,data:N}}}Q.auj="Similarity";Q.gHl="FlagAnnotation";Object(D.a)(Q,"AnnotationHelper",null,
[])},1558:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(28),e=c(7);class a{constructor(k){this.ul=k}static create(k){if(!k)return e.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(D.a)(a,"ShowReviewArgs",null,[])},1559:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.data=this.landingTab=null}}Object(D.a)(l,"LaunchData",null,[])},1563:function(D,J,c){c.d(J,"c",function(){return a});c.d(J,"a",function(){return k});
c.d(J,"b",function(){return x});D=c(0);var l=c(1547);class e{constructor(y,n,t){this.suggestion=y;this.Jq=n;this.paragraphNode=t}get role(){switch(this.Jq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(D.a)(e,"AddEnhancementActionData",null,[]);class a extends e{constructor(y,n,t,z,v,I=1){super(y,I,n);this.Y6a=t;this.f5c=z;this.callback=v}}Object(D.a)(a,"AddPullQuoteActionData",e,[]);class k extends e{constructor(y,n,t=0){super(y,2,n);this.gpa=t}}Object(D.a)(k,"AddCoverPhotoActionData",
e,[]);class x{constructor(y,n,t,z,v){this.suggestion=y;this.ps=n;this.Wbc=t;this.HVc=z;this.PDd=v}get annotationType(){switch(this.suggestion.Jq){case 1:case 3:return l.a.m4f;case 2:return l.a.xkg;default:return l.a.tQh}}get CSa(){return this.ps&&1<=this.ps.length?this.ps[0]:null}}Object(D.a)(x,"AddDesignerSuggestionActionData",null,[])},1567:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"OAuthResult",null,[])},1568:function(D,J,c){c.r(J);c.d(J,"FindManagerHelper",
function(){return n});D=c(0);var l=c(7),e=c(111),a=c(15),k=c(178),x=c(1068);J=c(1850);var y=c(25);class n extends J.a{constructor(){super()}get Zc(){return y.StaticActiveAppFrame.za().jb.Zc}get sj(){return y.StaticActiveAppFrame.za().jb.Zc.xd}get Hpa(){return y.StaticActiveAppFrame.za().jb.Hpa()}get tEf(){return y.StaticActiveAppFrame.za().jb.rc.$i}J_e(t){a.App.li.Al.dOa(t)}K5d(t,z,v){return x.b(t,z,v)}xog(t,z,v){if(1===v){if(!n.hi.yog(t))return!1}else if(!(t.Xe===z||t.zb(z)&&t.jd(z)))return!1;return Object(e.a)(99,
t.currentNode)||this.K5d(t,z,v)?!0:!1}zFa(t){return this.sj.Eb(t).zFa()}eCi(t,z,v,I){if(!t||t.matchCase!==v.matchCase||t.matchWholeWord!==v.matchWholeWord||I.length!==z.length)return!0;for(t=0;t<I.length;t++){if(I[t]!==z[t])return!0;if(v.matchCase){if(I[t]!==z[t])return!0}else if(I[t].toLocaleLowerCase()!==z[t].toLocaleLowerCase())return!0}return!1}oCi(t,z,v,I){if(!t||t.matchWholeWord&&!v.matchWholeWord||t.matchCase&&!v.matchCase||I.length!==z.length)return!1;if(t.matchWholeWord)return t.matchCase?
z[0]===I[0]:I[0].toLocaleLowerCase()===z[0].toLocaleLowerCase();for(let E=0;E<I.length;E++)if(t.matchCase){if(!I[E].startsWith(z[E]))return!1}else if(!I[E].toLocaleLowerCase().startsWith(z[E].toLocaleLowerCase()))return!1;t.matchCase===v.matchCase&&t.matchWholeWord===v.matchWholeWord&&1===z.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:v.text.length});return!0}zde(t,z,v){const I=a.App.li.Al.Te(12);I.qo(t);I.ku(z);I.kw(v)}static get hi(){return k.PageNavigator.instance}static get instance(){n.gvb||
(n.gvb=new n);return n.gvb}}n.gvb=null;Object(D.a)(n,"FindManagerHelper",J.a,[])},1569:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(2);class e{constructor(){this.currentDocumentPath=l.AFrameworkApplication.K.kb("EditDocInClientUrl")}}Object(D.a)(e,"SmartLookupApplicationInterface",null,[])},1570:function(D,J,c){c.d(J,"a",function(){return S});D=c(0);var l=c(738),e=c(5),a=c(1799),k=c(1841),x=c(1842),y=c(199),n=c(8),t=c(44),z=c(141),v=c(178),I=c(551),E=c(6),H=c(601),M=c(78),K=c(172),
L=c(538);class S{constructor(Q,N,O,X,U){S.l_d=!1;this.EE=Q;this.UNe=N;this.TNe=O;this.Yc=X;this.r4j=U}Qjo(Q,N){this.EE.zpa(Q)&&Q.properties.setValue(E.a.yoa,N)}d8b(){if(!S.l_d){var Q=this.pei();for(var N=Q.Tb(7);N;N=Q.Ri(7))for(N=Q.Tb(8);N;N=Q.Ri(8));S.l_d=!0}}pei(){const Q=this.Yc.Dk();Q.set(this.r4j());S.hi.GP(Q);return Q}av(){const Q=this.pei();this.TNe.L5d(Q);this.t4n(Q.currentNode);S.l_d=!1}tJn(Q){this.d8b();if(Q.isConnected){var N=this.H4(Q);if(N=this.EE.LQc(Q,N)){var O=this.Yc.Dk();O.set(N);
O.zb(25);Q.anchor&&(O.set(Q),O.zb(37),O.tg())}}}nxl(Q,N){if(Q.zb(25)&&Q.jd(25)&&!Q.Jt(7)){const O=e.GraphIterator.eb(N);O.zb(37);O.jd(37);N=H.b(O.currentNode,N.Zi().Mc,!0);Q.Bf(N,7)}}Czl(Q,N,O,X){Q=new a.a(e.GraphIterator.eb(Q),e.GraphIterator.eb(N),{});Q.WQb=!0;O=new l.a(O,X,new k.a(Q,null));O.Qh=!0;O.Rl("ExecuteInternalFootnoteEndnoteCopy");O.run()}Laf(Q,N){N=N.Lb.paragraph;var O=N.Zi().xd;O=H.b(Q,O,!0);N=e.GraphIterator.eb(N);this.nxl(N,Q);N.Tb(7);N.Bf(O,8);return O}M4c(Q,N,O,X){this.d8b();const U=
this.H4(Q);if(!this.EE.LQc(this.EE.zei(Q),U))return null;N=this.Laf(Q,N);this.Czl(Q,N,O,X);return N}R4c(Q,N,O,X){this.d8b();var U=N.Lb.paragraph;const T=U.Zi().xd;U=e.GraphIterator.eb(U);U.zb(7);U.jd(7);this.I5d(U,N.H4());N=H.b(Q,T,!0);U.Bf(N,8);this.Dzl(Q,N,O,X);return N}Dzl(Q,N,O,X){Q=new x.a(e.GraphIterator.eb(Q),e.GraphIterator.eb(N),null,null);O=new l.a(O,X,Q);O.Qh=!0;O.Rl("ExecuteInternalFootnoteEndnotePaste");O.run()}I5d(Q,N){Q.Tb(7);this.EE.Lyi(Q,N)||Q.Lf(7)}Cbi(Q,N){const O=this.Yc.Dk();
O.set(N);O.zb(7);O.jd(7);this.I5d(O,Q);return O}hdi(Q,N,O){return this.qdi(Q,N,O,!1)}uam(Q,N,O){return this.qdi(Q,N,O,!0)}qdi(Q,N,O,X){var U=this.Yc.Dk();let T=null,Y=!1;U.set(Q);U.Ip();U.jd(8);U.Rd();for(U=y.a.Gs(U,U.oed(8));U.moveNext();){if(n.ParagraphReader.Xb(U.currentNode)){const ba=U.currentNode;var aa=M.i(ba,7);for(const oa of aa){if(ba===Q){aa=oa.Lb.cp;if(X&&aa>=N)return T;aa>=N&&-1!==N&&(Y=!0)}if(oa.H4()===O){if(!X&&Y)return oa;T=oa}}ba===Q&&(Y=!0)}if(X&&Y)return T}return null}t4n(Q){const N=
new t.GraphTransaction(3);N.Db(Q);Q=y.a.gp(S.hi.uu(Q));let O=1,X=1;for(;Q.moveNext();){var U=Q.currentNode;if(U&&n.ParagraphReader.Xb(U)){U=M.i(U,7);for(const T of U){U=T.I4();const Y=T.H4()?O++:X++;this.Qjo(U,Y)}}}N.dispose()}H4(Q){return this.EE.zpa(Q)?Q.properties.getValue(E.a.A4):0}static SZl(){return new S(L.a.instance,z.PageReader.instance,v.PageNavigator.instance,new I.a,S.QMl)}static QMl(){return K.App.pn.jb.Zc}static get hi(){return v.PageNavigator.instance}static get instance(){return null!=
S.wCg?S.wCg:S.wCg=S.SZl()}}S.l_d=!1;Object(D.a)(S,"FootnoteEndnoteEditorInteractive",null,[377])},1576:function(D,J,c){D=c(0);class l{static D6l(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(D.a)(l,"EventReceiverIdCounter",null,[]);c.d(J,"a",function(){return e});class e{constructor(a,k){this.bXb=a;this._id=l.D6l();this.$hk=k}get id(){return this._id}notify(a,k){this.$hk(a,k)}jP(a,k){return this.bXb.sMn(a,k?this:null)}}Object(D.a)(e,"EventReceiver",null,[507])},1580:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.open="open";l.refresh="refresh";l.lbg="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.acf="createNew";Object(D.a)(l,"ReasonList",null,[])},1581:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{static $cd(e){if(!e)return"{NULL}";const a=e.length;if(600>=a)return e;const k=a-195;return e.substring(0,400)+"[...]"+e.substring(k,a)}}Object(D.a)(l,"LogUtils",null,[])},1582:function(D,J,c){c.d(J,"b",function(){return l});c.d(J,
"a",function(){return e});c.d(J,"c",function(){return a});const l=(k,x,y,n,t,z,v,I)=>{var E=1;if(!k&&!x||!y||!n)return E;t&&z?(z=y+k,E=n+x,k=1/y,x=1/n,t=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>E?E=1:1280<E&&(E=1280),k=z-y,x=E-n,I?(y=z/y,n=E/n,E=Math.abs(y-v)<Math.abs(n-v)?y:n):E=Math.abs(k/y)>Math.abs(x/n)?z/y:E/n,E<t&&(E=t)):t?(v=y+k,1>v?v=1:1920<v&&(v=1920),E=v/y):z&&(v=n+x,1>v?v=1:1280<v&&(v=1280),E=v/n);return E},e=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>
k&&(k+=360);return k}},1583:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupSelection",null,[])},1585:function(D,J,c){c.d(J,"a",function(){return L});D=c(0);var l=c(22),e=c(903),a=c(551),k=c(33),x=c(178),y=c(6),n=c(47),t=c(16),z=c(7),v=c(111),I=c(69),E=c(55),H=c(481),M=c(149),K=c(1069);class L{constructor(S,Q,N,O,X,U){this.qpk=S;this.De=Q;this.kxf=N;this.BZb=O;this.q5j=X;this.p5j=U}get Lk(){return null!=this.eIg?this.eIg:this.eIg=l.a.instance.resolve("WordEditor.ITableEditor")}get Qd(){return null!=
this.fJg?this.fJg:this.fJg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.NIg?this.NIg:this.NIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get ETb(){return this.qpk.value}get Ued(){return this.De.value}PZk(S){const Q=this.ETb.OUd(S,e.a.hMb);Q&&(this.HQb(Q,S),this.Mza(1696,S))}HQb(S,Q,N=!0){const O=this.ETb.gSc(Q);if(O&&(S=this.Ued.Kg(S),O.pj(S))){const X=this.ETb.q0(Q);let U="Unknown";this.ETb.$Za.value&&(U=
this.ETb.$Za.value.nb(S)?S:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:U,["RowCount"]:this.q5j(Q),["ColumnCount"]:this.p5j(Q),["HR"]:!!(X&32),["FC"]:!!(X&128),["TR"]:!!(X&64),["LC"]:!!(X&256),["BR"]:!(X&512),["BC"]:!(X&1024),["TableId"]:Q.id.toString()});N&&this.MUa(Q);this.P_o(Q,O);N=O.pj(S);Q.properties.setValue(y.a.tableStyle,N.id);this.NZk(Q);Q.$_.nia(!0)}}Whe(S,Q,N){if(S=this.ETb.OUd(N,S))this.Mza(Q,N),this.HQb(S,N)}Mza(S,Q,N=!0){N&&this.MUa(Q);Q.properties.setValue(y.a.tableLook,
S);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(S&32),["FC"]:!!(S&128),["TR"]:!!(S&64),["LC"]:!!(S&256),["BR"]:!(S&512),["BC"]:!(S&1024),["TableId"]:Q.id.toString()});Q.$_.nia(!0)}P_o(S,Q){(S=this.BZb(S))&&Q.Xhe(S)}NZk(S){if(S.isConnected){S.hasProperty(n.a.vx)&&S.removeProperty(n.a.vx);this.C1n(S);this.xbj(S);S=this.kxf.Rf(S);for(var Q=S.Tb(1);Q;){for(Q=S.Tb(1);Q;)Q.hasProperty(t.a.WK)&&Q.removeProperty(t.a.WK),Q.hasProperty(y.a.wJa)&&Q.removeProperty(y.a.wJa),this.npb(Q),this.xbj(Q),Q=S.Ri(1);Q=
S.Ri(1)}}}aVd(S){let Q=S.ja(n.a.F6a,null);if(Q)return Q;if(S=this.Ued.Kg(S))if(Q=({value:Q}=this.ETb.$Za.value.Fc(S,Q)).returnValue?Q:null)return Q;return S}xho(S,Q,N,O,X){S.properties.setValue(Q.style,N);S.properties.setValue(Q.size,O*M.a.IHc);S.properties.setValue(Q.color,X)}MUa(S){if(this.Qd.yg){var Q;Object(v.a)(H.a,S)&&(Q=Object(I.a)(H.a,S))&&(Q=Q.qV())&&this.Ej.MUa(S,Q)}}C1n(S){S.Cg(y.a.Xa,y.a.Ya,y.a.Zza,y.a.pb,y.a.qb,y.a.Xza,y.a.Va,y.a.Wa,y.a.Wza,y.a.rb,y.a.tb,y.a.Yza,y.a.ub,y.a.vb,y.a.tJa,
y.a.Nb,y.a.Ob,y.a.uJa)}npb(S){S.Cg.apply(S,this.Lk.VCh)}xbj(S){S.Cg(y.a.Fa,y.a.Aa,y.a.Ba,y.a.Da,y.a.oS,y.a.LV,y.a.pVa,y.a.oVa)}static zhm(){return new L(l.a.instance.Ve("WordEditor.IWACTableStyleReader"),l.a.instance.Ve("Box4.Styles.IWACStyleReader"),new a.a,Object(E.a)(L.hi,L.hi.uu,"navigateToPageContentNode"),k.TableReader.gg,k.TableReader.hh,K.a.instance)}static get hi(){return x.PageNavigator.instance}static get instance(){return null!=L.uDg?L.uDg:L.uDg=L.zhm()}}Object(D.a)(L,"WACTableStyleEditor",
null,[368,369])},1592:function(D,J,c){J=c(1982);c=c(1983);c.Bvp=J;c.Cvp=c;D.exports=c},1599:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(178),e=c(250);class a{Z5a(k){a.hi.GP(k);return k.Tb(16)}static Wr(){return new e.a(()=>new a)}static get instance(){return a._instance.value}static get hi(){return l.PageNavigator.instance}}a._instance=a.Wr();Object(D.a)(a,"CommentNavigator",null,[394])},1600:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(){super();
this.HVi=this.CHa=null}}Object(D.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1601:function(D,J,c){c.d(J,"a",function(){return H});D=c(0);var l=c(7),e=c(15),a=c(539),k=c(37),x=c(61),y=c(2066),n=c(2),t=c(1535),z=c(1550),v=c(118),I=c(605),E=c(1527);class H{static t7m(){const M=document.getElementsByClassName(I.a.d_f);if(M&&M.length){var K=M[0].clientWidth;for(let L=1;L<M.length;L++){if(M[L].clientWidth!==K||L===M.length-1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",M[L].clientWidth-
K,M.length);break}K=M[L].clientWidth}}}static Lug(M,K,L){M&&(M=e.App.zd.fq.Isf(M),a.CoauthLockEditor.getInstance().p8a(M)&&l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${K.objectId} added to a locked ${L?"start":"end"} paragraph. Lock Type ${M.Type.toString()}`))}static F3o(M,K,L){var S=K.Eb(x.a.If(M.objectId));if(S){var Q=t.a.uca(S,K,!0);K=t.a.uca(S,K,!1);null!==Q&&void 0!==Q&&Q.jv||(Q=E.k(S),l.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${Q}, CommentObjectId: ${M.objectId}`),
H.JKi(L));null!==K&&void 0!==K&&K.jv||(S=E.h(S),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${S}, CommentObjectId: ${M.objectId}`),H.JKi(L))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${M.objectId}`)}static JKi(M){M.logKpiFailure(z.a.fHh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.yHd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static i7m(M,K,L){0!==M.size&&M.forEach(S=>
{K.has(S)||H.j7m(S,L)})}static j7m(M,K){K.Eb(x.a.If(M))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${M}`)}static JWk(M){const K=new Set;M.forEach(L=>{L&&L.yj&&((L=H.v8l(L))?K.add(L):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});K.forEach(L=>{const S=L.ja(v.a.T9e,[]);0===L.ja(v.a.R9e,[]).length&&0===S.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${L.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static aYm(M,
K,L,S){M=L.H7h(M);if(!M)return!1;L=E.k(M,x.a.nil);S=S.Eb(L);K.has(L.toString())&&l.ULS.sendTraceTag(539800643,327,15,`Para Node ${L} missing comment reference for comment ${M.id}`);return S&&S.yj?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${L} with missing comment reference for comment ${M.id} is in a invalid state ${S?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static v8l(M){let K;try{K=k.OutlineElementNavigator.Fl(M)}catch(L){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${M.id} OutlineNode failed to retrieve ${L}`)}return K}static TWl(M){var K;
switch(null===(K=M.Cz)||void 0===K?void 0:K.sessionType){case y.a.create:return z.a.P9e;case y.a.reply:return z.a.NHd;case y.a.edit:return z.a.kHh}}static YDh(M){if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(M=M[1])&&0!==M.length){var K=new Set;for(let L=0;L<M.length;L++)K.add(M[L].UserId);M.length>K.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${M.length-K.size}`)}}}Object(D.a)(H,"CommentDiagnosticHelpers",
null,[])},1602:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(7);class e{constructor(a){this.xj=a}get Ek(){return this.xj&&this.xj.$i?this.xj:null}rUa(a,k){return this.Ek?this.Ek.Z6e(a,!0)?this.Ek.rUa(a,k,!0,!0,!1):(l.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(D.a)(e,"PageViewWrapper",null,[])},1603:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);var l=c(57),e=c(175),a=c(7),k=c(82),x=c(62);class y{constructor(n,
t,z){a.ULS.shipAssertTag(6305502,307,!!n);this.properties=n;this.Ic=t;this.zT=z}Uei(){return this.properties.ja(e.a.LP,"")}R3i(){return!0}PCj(){let n=!1,t=null;const z=this.Uei();if(this.zT||""!==z)try{({$va:t,returnValue:n}=this.Foc(z))}catch(v){a.ULS.shipAssertTag(4203138,307,!1),this.Ic.Yb(k.a.soa,{["Reason"]:x.a.H5e}),l.a.RQ(t)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Ic.Yb(k.a.f2,{["Reason"]:x.a.kkf});return{returnValue:n,xId:t}}}Object(D.a)(y,"AStringInputImportStrategy",
null,[545])},1604:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.jaa=[]}q8h(){const e=new l;for(let a=0;a<this.jaa.length;a++)e.add(this.J(a));return e}get count(){return this.jaa.length}J(e){return this.jaa[e]}Z(e,a){return this.jaa[e]=a}add(e){this.jaa.push(e)}clear(){Array.clear(this.jaa)}contains(e){return Array.contains(this.jaa,e)}getRange(e,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(e+x));return k}indexOf(e){return Array.indexOf(this.jaa,e)}insert(e,
a){Array.insert(this.jaa,e,a)}remove(e){return Array.remove(this.jaa,e)}removeAt(e){Array.removeAt(this.jaa,e)}removeRange(e,a){for(let k=0;k<a;k++)Array.removeAt(this.jaa,e)}reverse(){this.jaa.reverse()}sort(){this.jaa.sort()}toArray(){return Array.clone(this.jaa)}}Object(D.a)(l,"List",null,[])},1606:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.generalException="GeneralException";l.invalidArgument="InvalidArgument";l.notImplemented="NotImplemented";l.PAb="AccessDenied";l.$Ym=
"ItemNotFound";l.notSupported="NotSupported";l.apiNotAvailable="ApiNotAvailable";l.notAllowed="NotAllowed";l.nyn="OperationCancelled";l.userNotSignedIn="UserNotSignedIn";l.userAborted="UserAborted";l.invalidResourceUrl="InvalidResourceUrl";l.invalidGrant="InvalidGrant";l.clientError="ClientError";l.serverError="ServerError";Object(D.a)(l,"ErrorCodes",null,[])},1607:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.id=e}}Object(D.a)(l,"DesignerPaneToggleData",null,
[])},1609:function(D,J,c){c.d(J,"a",function(){return x});D=c(0);var l=c(1883),e=c(551),a=c(6),k=c(1068);class x{constructor(y){this.CYl=(n,t)=>{const z=this.Lgi(n),v=this.Yc.Rf(t);return v.zb(z)?(v.jd(z),new l.a(v.currentNode,t,n)):null};this.BYl=(n,t)=>{let z=null,v=null;const I=this.Lgi(n);t=this.Yc.Rf(t);({rootNode:z,qka:v}=this.Mno(t,n,I,z,v));return z&&v?new l.a(z,v,n):null};this.GYl=n=>{n=this.Yc.Rf(n);return(this.F9(2)||this.F9(4))&&n.zb(36)?(n.jd(36),this.qFl(n.currentNode)):(this.F9(8)||
this.F9(16))&&n.zb(37)?(n.jd(37),this.K0h(n.currentNode)):this.F9(32)&&n.zb(40)?32:this.F9(1)&&n.zb(8)?1:0};this.Yc=y;this.rFl=this.GYl;this.cFl=this.CYl;this.bFl=this.BYl;this.IFl=31;this.Dkg=this.KYl()}g$h(y){const n=[],t=this.rFl(y);if(t){var z=this.cFl(t,y);z&&(n[n.length]=z)}for(const v of this.Dkg)v!==t&&v&&(z=this.bFl(v,y))&&(n[n.length]=z);return n}F9(y){return!!y&&!!(this.IFl&y)}Mno(y,n,t,z,v){if(y.zb(7)){y.jd(7);if(8===t||37===t||39===t)for(var I=y.Rd();I;){if(I.type===t)if(37===t){if((8===
n||16===n)&&n===this.K0h(I)){z=y.currentNode;break}}else{z=y.currentNode;break}I=y.Oj()}z&&y.Jz()&&(I=this.Yc.Rf(z),k.b(I,t,n)&&(v=y.currentNode))}return{rootNode:z,qka:v}}KYl(){const y=[];this.F9(1)&&(y[y.length]=1);this.F9(2)&&(y[y.length]=2);this.F9(4)&&(y[y.length]=4);this.F9(8)&&(y[y.length]=8);this.F9(16)&&(y[y.length]=16);this.F9(32)&&(y[y.length]=32);return y}Lgi(y){let n=8;switch(y){case 1:case 2:case 4:n=8;break;case 8:case 16:n=37;break;case 32:n=39}return n}K0h(y){y=y.properties.getValue(a.a.A4);
return this.F9(8)&&1===y?8:this.F9(16)&&!y?16:0}qFl(y){y=y.getValue(a.a.Rac);return this.F9(2)&&x.DOm(y)?2:this.F9(4)&&x.$Nm(y)?4:0}static gF(){return new x(new e.a)}static get instance(){return null!=x.CCg?x.CCg:x.CCg=x.gF()}static DOm(y){return y&&1!==y&&2!==y?!1:!0}static $Nm(y){return 3===y||4===y||5===y?!0:!1}}Object(D.a)(x,"WordFindContextHelper",null,[362])},1617:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(93),e=c(1543);class a{constructor(k){this.taskManager=k}qwa(k,x){const {priority:y=
2,delay:n=0}=null!==x&&void 0!==x?x:{},t=new e.a,z=async()=>await k();x=new l.a(y,1,n,()=>{z().then(t.resolve).catch(t.reject)});this.taskManager.Wb(x);return t.completion}}Object(D.a)(a,"TaskDispatcher",null,[])},1618:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(139),e=c(2),a=c(7);class k{constructor(x,y){this.SQ=x;this.vZ=y}fK(x,y,n){x={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),
["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(n)})},["survey"]:{["surveyId"]:x},["telemetry"]:this.g0a(),["web"]:this.UBb()};this.Eja(JSON.stringify(x),{["Content-Type"]:"application/json"})}g0a(){const x=e.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:e.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,
["processSessionId"]:x.WACSessionID,["flights"]:e.AFrameworkApplication.K.kb("FlightId"),["loggableUserId"]:e.AFrameworkApplication.K.kb("LoggableUserId"),["tenantId"]:e.AFrameworkApplication.K.kb("TenantId")}}Eja(x,y,n=0){3<n||this.vZ.qwa(()=>{this.SQ.nj("https://petrol.office.microsoft.com/v1/feedback",2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.Eja(x,y,n+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",
n)},null)},{delay:this.TVl(n)})}TVl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}UBb(){const x=e.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(D.a)(k,"EditorAiSurveysApiClient",null,[])},1620:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);class l{constructor(a){this.selectedRating=a}}Object(D.a)(l,"EditorAiRatingData",null,[]);class e{constructor(a,k,x){this.rating=[new l(a)];
this.comment=[k,...x]}}Object(D.a)(e,"EditorAiSurveyData",null,[])},1627:function(D,J,c){var l=c(1552);D=c(0);class e{}Object(D.a)(e,"SerializableAnchorDataV1",null,[]);class a{}Object(D.a)(a,"SerializableCpDataV1",null,[]);var k=c(1002);c.d(J,"a",function(){return x});c.d(J,"c",function(){return y});c.d(J,"b",function(){return n});c.d(J,"d",function(){return t});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1655).versionedDeserialize(z.OS),z.PE,z.TE,c(1655).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const v=
new e;v.RK=z.bde;v.PS=z.nTa;v.TS=z.V8a;v.DK=z.TH;v.SI=z.shapeId;z.cS&&(v.OS=t(z.cS));z.ZHa&&(v.PE=z.ZHa);z.Enc&&(v.TE=z.Enc);z.n5&&(v.OE=t(z.n5));return v},n=z=>{if(!z)return null;const v=new k.a(z.CP);v.uwa=null!=z.FB?z.FB:0;v.wha=null!=z.FE?z.FE:0;v.rva=null!=z.CB?z.CB:0;v.sva=null!=z.CE?z.CE:0;v.YQa=null!=z.HB?z.HB:0;v.hia=null!=z.HE?z.HE:0;v.xza=null!=z.R?z.R:0;v.pwa=null!=z.E?z.E:0;v.dAa=null!=z.TW?z.TW:0;v.Oya=null!=z.PB?z.PB:0;v.symbols=null!=z.SYM?z.SYM:0;v.xxa=null!=z.IE?z.IE:0;v.uya=null!=
z.OO?z.OO:0;v.Gua=null!=z.AX?z.AX:0;v.cEa=null!=z.CCI?z.CCI:0;v.dryDeletion=null!=z.DD?z.DD:0;return v},t=z=>{if(!z)return null;const v=new a;v.CP=z.cp;v.VS=1;0<z.uwa&&(v.FB=z.uwa);0<z.wha&&(v.FE=z.wha);0<z.rva&&(v.CB=z.rva);0<z.sva&&(v.CE=z.sva);0<z.YQa&&(v.HB=z.YQa);0<z.hia&&(v.HE=z.hia);0<z.xza&&(v.R=z.xza);0<z.pwa&&(v.E=z.pwa);0<z.dAa&&(v.TW=z.dAa);0<z.Oya&&(v.PB=z.Oya);0<z.symbols&&(v.SYM=z.symbols);0<z.xxa&&(v.IE=z.xxa);0<z.uya&&(v.OO=z.uya);0<z.Gua&&(v.AX=z.Gua);0<z.cEa&&(v.CCI=z.cEa);0<z.dryDeletion&&
(v.DD=z.dryDeletion);return v}},1635:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x=""){this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(D.a)(l,"CommentTaskPerson",null,[1138])},1636:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=!1){this.priority=this.completion=-1;this.type=e;this.user=a;this.time=k;this.recordId=x;this.isLossy=y}}Object(D.a)(l,"HistoryRecord",null,[])},1637:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.yellow="FFFF00";l.E1m="00FF00";l.lHk="00FFFF";l.EKl="FF00FF";l.blue="0000FF";l.red="FF0000";l.ahn="000080";l.Vyj="008080";l.green="008000";l.purple="800080";l.jbn="800000";l.Qkn="808000";l.gray="808080";l.MAo="C0C0C0";l.black="000000";Object(D.a)(l,"FontHighlightColorEnum",null,[])},1638:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.yaa={};this.yaa.ops=[]}Yca(e){const a=this.yaa.ops;if(a.length){var k=a.length-
1;const x=a[k];if(!x.attributes){x.insert+=e;a[k]=x;this.yaa.ops=a;return}}k={};k.insert=e;Array.add(a,k)}RCf(e,a){const k={};this.Jnj(k,a);Array.add(this.yaa.ops,this.b6b(e,k))}tCf(e,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;e=this.b6b(e,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),e.optional=a);Array.add(this.yaa.ops,e)}insertImage(e,a){e=this.b6b(e,{});const k={};k.base64=a.base64;a={};
a.image=k;e.optional=a;Array.add(this.yaa.ops,e)}cti(e,a){const k={};k.link=a.link;this.Jnj(k,a);Array.add(this.yaa.ops,this.b6b(e,k))}O9b(){return Sys.Serialization.JavaScriptSerializer.serialize(this.yaa)}b6b(e,a){const k={};k.insert=e;k.attributes=a;return k}Jnj(e,a){this.iQb(a.weight>=l.e5d,e,"weight",a.weight);this.iQb(a.italic,e,"italic",!0);this.iQb(a.underline,e,"underline",!0);this.iQb(a.strikethrough,e,"strikethrough",!0);this.iQb(!!a.highlight,e,"highlight",a.highlight);this.iQb(!!a.color,
e,"color",a.color);this.iQb(!!a.paragraph,e,"paragraph",a.paragraph)}iQb(e,a,k,x){e&&(a[k]=x)}static hGb(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e,!0)}}l.e5d=700;Object(D.a)(l,"DeltaFormatCreator",null,[1094])},1639:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(598),e=c(394);class a{constructor(k=!1){this.dN=null;this.C3a=!1;k&&(this.dN=new l.a(new e.a))}}Object(D.a)(a,"OpenCommentInfo",null,[])},1640:function(D,J,c){c.d(J,"b",function(){return t});c.d(J,"a",
function(){return z});c.d(J,"c",function(){return v});c.d(J,"d",function(){return I});c.d(J,"e",function(){return E});var l=c(20),e=c(2),a=c(118),k=c(7),x=c(459),y=c(445),n=c(263);const t=()=>l.a.Nt,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,v=H=>!!H&&H.isConnected,I=(H,M,K,L)=>{if(!M||!M.isConnected)return H.dispose(),!1;const S=M.Zi(),Q=M.ja(a.a.RJ,n.a.Qt),N={};N[x.a.nodeId]=M.id.toString();N[x.a.cellId]=S.Fm.toString();N[x.a.fileId]=S.yr;N[x.a.$ua]=S.contentReplicator.Su.toString();
N[x.a.YM]=S.contentReplicator.YM;N[x.a.MX]=K.toString();N[x.a.lcid]=e.AFrameworkApplication.lcid.toString();N[x.a.accessToken]=e.AFrameworkApplication.accessToken;N[x.a.classId]=M.Oc.toString();N[x.a.RJ]=Q;L=L||{};for(const O of y.a(L))N[O]=L[O];for(const O of y.a(N))H.Z5b(O,N[O]);return!0},E=(H,M,K)=>{const L={};L.IsResponseNull=!M;M&&(L.OperationResult=M.StatusCode,L.RevisionListLength=M.RevisionList?M.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",
L);K&&K.isConnected&&(M&&!M.StatusCode?(K.zJ().contentReplicator.kF(null,null,null),H.Rqg()):H.bOb(null,M?M.StatusCode:14))}},1641:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});
e(c(1855),J);e(c(1856),J)},1642:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(l,"InsightsParameters",null,[])},1646:function(D,J,c){c.d(J,"a",function(){return l});c.d(J,"b",function(){return e});D=c(0);var l;(function(a){a[a.Unknown=-1]="Unknown";a[a.Ycp=0]="RichText";a[a.zcp=1]="PlainText";a[a.xcp=2]="Picture";a[a.I$o=3]="ComboBox";a[a.uap=4]="DropDownList";a[a.A$o=5]="BuildingBlockGallery";
a[a.Date=6]="Date";a[a.Rcp=7]="RepeatSectionItem";a[a.G$o=8]="CheckBox";a[a.Qcp=9]="RepeatSection";a[a.wNj=10]="Bibliography";a[a.Adp=11]="TableOfContents";a[a.jRj=12]="NumberOfContentControlKinds"})(l||(l={}));Object(D.b)("ContentControlKind",l);const e=a=>{for(let k=0;k<l.jRj;++k)if(l[k]===a)return k;return l.Unknown}},1647:function(D,J,c){c.d(J,"c",function(){return y});c.d(J,"b",function(){return n});c.d(J,"a",function(){return t});var l=c(40),e=c(599),a=c(63),k=c(65),x=c(280);const y=(z,v,I)=>
{var E=z.characterData.length;if(v>I||I>E)return null;a:{for(H of z.mH)if(E=H.mc,E.ue&&E===k.InteractiveViewManager.instance.yd){var H=E;break a}H=null}if(!H)return null;H=z.Aj(H.$b);if(!H)return null;E=[];z=z.ra;for(let K=z.zca(v);K<z.length;K++){var M=z.J(K);if(M.cp>I||M.cp===I&&v!==I)break;(M=x.a.Wwa(H,M.cp))&&0>Array.indexOf(E,M)&&E.push(M)}return E},n=z=>{let v=null;for(const E of z){var I=l.a.getElementBounds(E);v?(z=v,z.x>I.x&&(z.x=I.x),z.x+z.width<I.x+I.width&&(z.width=I.x+I.width-z.x),z.y>
I.y&&(z.y=I.y),z.y+z.height<I.y+I.height&&(z.height=I.y+I.height-z.y)):v=I}v||(v=new Sys.UI.Bounds(0,0,0,0));return v},t=(z,v)=>{z=n(z);if(!z.width&&!z.height)return null;const I=document.createElement("div");I.id=v;I.style.position="absolute";I.style.left=z.x+"px";I.style.top=z.y+"px";I.style.width=z.width+"px";I.style.height=z.height+"px";I.style.zIndex="-9999";a.d(I,e.a.tBb,"true");return I}},1648:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,
y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1877),J);e(c(1878),J);e(c(1879),J);e(c(1880),J);e(c(1881),J)},1649:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.source=e}}Object(D.a)(l,"AcceptAllActionData",null,[])},1651:function(D,J,c){c.d(J,
"a",function(){return N});D=c(0);var l=c(718),e=c(28),a=c(25),k=c(17),x=c(23),y=c(8),n=c(11),t=c(761),z=c(553),v=c(243),I=c(69),E=c(75),H=c(111),M=c(1223),K=c(1551),L=c(871);c.n(L);var S=c(1557),Q=c(872);class N{constructor(O,X,U,T,Y,aa,ba){this.aNa=O;this.hb=X;this.fn=U;this.Dn=T;this.Lab=Y;this.K5j=aa;this.HWb=ba}Hoa(O){return(O=this.Dn.Hoa(O))&&Object(I.a)(l.a,O.errorDetails)&&!O.errorDetails.H4a()?O:null}wFa(O){return this.Lab.wFa(O)}cof(O){if(!O)return null;if(t.a(O.annotationType)){if((O=O.content)&&
O.suggestions&&!N.f3b(O))return O}else if(O.annotationType===z.a.getTypeName()){if((O=O.content)&&O.suggestions)return O}else if(O.annotationType===L.FlagAnnotation.getTypeName()&&(O=O.content)&&O.results)return O;return null}xOd(O,X,U){let T=null,Y=null,aa=null;var ba=this.fn.jRc(O,0);if(!ba||!ba.count)return{returnValue:!1,annotation:T,B5i:Y,W1e:aa};for(const oa of ba){if(X&&(oa.Bc!==O.cpBegin||oa.end!==O.cpEnd))continue;ba=this.cof(oa.intent);if(!ba||U&&!U(ba))continue;let ma;({stop:ma}=N.Rrj(Y,
ba)).returnValue&&(T=oa.intent,Y=ba,aa=e.a.createTextRange(O.node,oa.Bc,oa.end));if(ma)break}return{returnValue:!!Y,annotation:T,B5i:Y,W1e:aa}}Q4h(O,X){let U=null;for(const T of O){if(T.type)continue;O=this.cof(T.intent);if(!O||X&&!X(O))continue;let Y;({stop:Y}=N.Rrj(U,O)).returnValue&&(U=O);if(Y)break}return U}tji(O,X,U,T,Y){const aa=new E.a;if(T.NXd){var ba=this.fn.wQa(O,0,oa=>{if(X>oa.Bc||oa.Bc>U)return!1;oa=this.cof(oa.intent);return!oa||N.f3b(oa)||T.f6c&&!T.f6c(oa)?!1:!0});for(const oa of ba)aa.add(oa)}if(T.MXd){ba=
this.Dn.G4(O,oa=>{if(X>oa.Bc||oa.Bc>U)return!1;oa=oa.errorDetails;return oa.H4a()||T.Y4c&&!T.Y4c(oa)?!1:!0});for(const oa of ba)aa.add(oa)}if(T.LXd){O=this.Lab.xqf(O,oa=>X>oa.Bc||oa.Bc>U||T.dMc&&!T.dMc(oa.PD)?!1:!0);for(const oa of O)aa.add(oa)}aa.Sc(Y);return aa}Aqf(O,X){return Math.min(Math.abs(X-O.Bc),Math.abs(X-O.end))}N6l(O,X,U,T){let Y,aa=0;T?(T=0,Y=X-1):(T=X+1,Y=O.characterData.length);U=this.tji(O,T,Y,U,(ba,oa)=>this.Aqf(ba,X)-this.Aqf(oa,X));if(!U.count)return{returnValue:null,offset:aa};
aa=X<U.J(0).Bc||X>U.J(0).end?this.Aqf(U.J(0),X):0;return{returnValue:e.a.createTextRange(O,U.J(0).Bc,U.J(0).end),offset:aa}}itf(O,X,U,T){let Y=0;var aa=({offset:Y}=this.N6l(O,X,U,T)).returnValue;if(aa)return{returnValue:aa,offset:Y};aa=this.aNa.MOh(O,T);if(!aa)return{returnValue:null,offset:Y};for(Y=T?X:O.characterData.length-X;aa.h9();){O=aa.ex;X=this.tji(O,0,O.characterData.length,U,(ba,oa)=>ba.Bc===oa.Bc?ba.end-oa.end:ba.Bc-oa.Bc);if(X.count)return U=T?X.J(X.count-1):X.J(0),Y+=T?O.characterData.length-
U.end:U.Bc,{returnValue:e.a.createTextRange(O,U.Bc,U.end),offset:Y};Y+=O.characterData.length}return{returnValue:null,offset:Y}}htf(O,X,U,T){return this.itf(O,X,U,T).returnValue}ZLc(O,X,U){let T=0,Y=1;this.htf(O,X,U,!1)&&Y++;this.htf(O,X,U,!0)&&(T++,Y++);return{index:T,count:Y}}gSl(O,X,U){let T;const Y=({offset:T}=this.itf(O,X<O.characterData.length?X+1:X,U,!0)).returnValue;if(Y&&!T)return Y;X=({offset:O}=this.itf(O,1<X?X-1:0,U,!1)).returnValue;return Y&&X?T<O?Y:X:Y?Y:X}sij(O,X){let U=null;a.StaticActiveAppFrame.za()&&
Object(H.a)(M.MainView,a.StaticActiveAppFrame.za().jb.rc)&&(U=a.StaticActiveAppFrame.za().jb.rc);if(!U)return!1;this.hb.Ac(k.SelectionEditor.Jj(x.SelectionFactory.Xn(O),!0,!1));O=U.Es.Adm();const T=(O-250)/2;U.Es.D1(100<T?100-100*T/O:-1,void 0,void 0,Y=>{window.setTimeout(()=>{X(Y)},0)});return!0}YLb(O,X,U=4,T=!0){const Y=()=>{X.Xi.fE||X.DN(new K.a(O,U,!1,T,void 0,!0))};X.Xi.dismiss();this.K5j.select(O.node,O.cpBegin,O.cpBegin);if(!this.HWb.aMd(O.node))return this.sij(O,()=>{Y()});Y();return!0}static f3b(O){if(!O)return!0;
if(!O.M_||!O.M_.state)return!1;O=O.M_.state;return 60===O||70===O}static Rrj(O,X){const U=Object(Q.b)()&&S.a.iZd(X)||v.a.getTypeNameFor(X)===z.a.getTypeName();return{returnValue:!O||U||t.a(v.a.getTypeNameFor(X))&&O.priority>X.priority,stop:U}}oTf(O,X,U,T,Y=4,aa=!0){O=this.NTl(O);if(!O)return!1;X=this.CSh(O,X,U,T);return this.YLb(O,X,Y,aa)}NTl(O){var X=this.hb.ib.lb;for(const U of X)if(y.ParagraphReader.Xb(U.node)&&(X=U.contextId,X===n.a.Tc||X===n.a.Fd||X===n.a.paragraph))return this.gSl(U.node,X!==
n.a.paragraph?U.cpBegin:0,O);return null}CSh(O,X,U,T){return this.THm(O)?X:this.WLm(O)?T:U}THm(O){return this.xOd(O,!0,null).returnValue}WLm(O){return!!this.wFa(O)}}Object(D.a)(N,"SuggestionNavigator",null,[])},1652:function(D,J,c){c.d(J,"c",function(){return e});c.d(J,"a",function(){return a});c.d(J,"b",function(){return k});var l=c(26);const e=(x,y,n)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),n))for(x=x.firstChild;x;)e(x,y,!0),
x=x.nextSibling},a=x=>{x=document.createElement(x);x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var n=x.className;if(l.c(n)||-1===n.indexOf(y))y=n.trim()+" "+y,y=y.trim(),x.className=y}}},1653:function(D,J,c){c.d(J,"a",function(){return t});D=c(0);var l=c(7),e=c(55),a=c(2),k=c(190),x=c(22),y=c(294),n=c(32);class t{constructor(){this.bga=null}Ene(){try{this.bga||(this.bga=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(z){l.ULS.sendTraceTag(51689674,
1300,10,"Unable to resolve ISearchOAuthManager: "+z)}}jwf(z,v){return this.bga?this.bga.getToken(z,v):new Promise(I=>{x.a.instance.Sa("Common.App.SearchCommon.ISearchOAuthManager").execute(E=>{E?(this.bga=E,this.bga.getToken(z,v).then(H=>I(H))):I(null)})})}z4l(){this.Ene();return this.bga?this.bga.getToken("Search",a.AFrameworkApplication.oOf):null}qii(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>
{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.Ene();return this.bga?this.bga.getToken("Search",a.AFrameworkApplication.ukg):null}Zhm(){this.Ene();return this.bga?this.bga.getToken("Search",this.Whm()):null}Whm(){return a.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")}Xem(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>
{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.Ene();return this.bga?this.bga.getToken("SmartLookup",this.Uem()):null}Uem(){return a.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")}A4l(){return Object(e.a)(this,this.z4l,"getLokiTokenPromise")}rgm(){return Object(e.a)(this,this.qii,"getSubstrateTokenPromise")}$Qb(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Kb.$Qb}Mim(){const z={};this.$Qb()&&(z.Loki=this.A4l(),z.Substrate=this.rgm());
return z}R_c(z){k.a.PIa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new n.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new n.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}K3m(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.R_c(!1);return!1}).then(()=>{this.R_c(!0);return!0}):new Promise((z,v)=>{const I=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA;
I?I.loadScript("tellme-strings").then(()=>{this.R_c(!0);z(!0)}).catch(()=>{this.R_c(!1);v(!1)}):(this.R_c(!1),v(!1))})}static MUm(){return!!a.AFrameworkApplication.ta&&(a.AFrameworkApplication.ta.Kb.NYc||a.AFrameworkApplication.ta.Kb.$dc)}static Z0d(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Kb.$dc}}Object(D.a)(t,"ReactSharedHeaderSearchUtils",null,[])},1655:function(D,J,c){c.r(J);c.d(J,"validateCpDataV1",function(){return e});c.d(J,"isEqual",function(){return a});c.d(J,"isSupportedCpVersion",
function(){return k});c.d(J,"validateVersionedCpData",function(){return y});c.d(J,"versionedDeserialize",function(){return n});var l=c(1627);const e=t=>"number"!==typeof t.CP||null!=t.FB&&"number"!==typeof t.FB||null!=t.FE&&"number"!==typeof t.FE||null!=t.HB&&"number"!==typeof t.HB||null!=t.HE&&"number"!==typeof t.HE||null!=t.CB&&"number"!==typeof t.CB||null!=t.CE&&"number"!==typeof t.CE||null!=t.R&&"number"!==typeof t.R||null!=t.E&&"number"!==typeof t.E||null!=t.TW&&"number"!==typeof t.TW||null!=
t.PB&&"number"!==typeof t.PB||null!=t.SYM&&"number"!==typeof t.SYM||null!=t.IE&&"number"!==typeof t.IE||null!=t.OO&&"number"!==typeof t.OO||null!=t.AX&&"number"!==typeof t.AX||null!=t.CCI&&"number"!==typeof t.CCI||null!=t.DD&&"number"!==typeof t.DD?!1:!0,a=(t,z)=>t||z?t&&z&&t.CP===z.CP&&t.FB===z.FB&&t.FE===z.FE&&t.HB===z.HB&&t.HE===z.HE&&t.CB===z.CB&&t.CE===z.CE&&t.R===z.R&&t.E===z.E&&t.TW===z.TW&&t.PB===z.PB&&t.SYM===z.SYM&&t.IE===z.IE&&t.OO===z.OO&&t.AX===z.AX&&t.CCI===z.CCI&&t.DD===z.DD?!0:!1:
!0,k=t=>1===t,x=t=>{let z=t,v=0;"number"===typeof z.VS&&(v=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,Trg:v};z=null;for(let I=0;I<t.length;I++){const E=t[I];1===E.VS&&E.VS>v&&(v=E.VS,z=t[I])}return{returnValue:z,Trg:v}},y=t=>{const z=({Trg:t}=x(t)).returnValue;if(!z)return!1;switch(t){case 0:case 1:return e(z);default:return!1}},n=t=>{if(!t)return null;const z=({Trg:t}=x(t)).returnValue;if(!z)return null;switch(t){case 0:case 1:return l.b(z);default:return null}}},
1668:function(D,J,c){D=c(0);var l=c(760),e=c(19),a=c(174),k=c(79),x=c(2),y=c(22),n=c(7),t=c(1471),z=c(11),v=c(104),I=c(28),E=c(3),H=c(1078),M=c(135),K=c(17),L=c(23),S=c(101),Q=c(8);class N{static get $wh(){N.xrc||(N.xrc=[],N.Nfc(l.a.ug("ar-sa")),N.Nfc(l.a.ug("de-de")),N.Nfc(l.a.ug("es-es")),N.b1(l.a.ug("en-029"),l.a.ug("en-us")),N.b1(l.a.ug("en-au"),l.a.ug("en-us")),N.b1(l.a.ug("en-bz"),l.a.ug("en-us")),N.b1(l.a.ug("en-ca"),l.a.ug("en-us")),N.b1(l.a.ug("en-gb"),l.a.ug("en-us")),N.b1(l.a.ug("en-id"),
l.a.ug("en-us")),N.b1(l.a.ug("en-my"),l.a.ug("en-us")),N.b1(l.a.ug("en-ph"),l.a.ug("en-us")),N.b1(l.a.ug("zh-tw"),l.a.ug("en-us")),N.Nfc(l.a.ug("fr-fr")),N.b1(l.a.ug("hr-ba"),l.a.ug("hr-hr")),N.b1(l.a.ug("it-ch"),l.a.ug("it-it")),N.b1(l.a.ug("nb-no"),l.a.ug("nn-no")),N.Nfc(l.a.ug("nl-nl")),N.b1(l.a.ug("ro-md"),l.a.ug("ro-ro")),N.b1(l.a.ug("ru-md"),l.a.ug("ru-ru")),N.b1(l.a.ug("sr-latn-ba"),l.a.ug("sr-latn-cs")),N.b1(l.a.ug("sr-latn-me"),l.a.ug("sr-latn-cs")),N.b1(l.a.ug("sr-latn-rs"),l.a.ug("sr-latn-cs")),
N.Nfc(l.a.ug("sr-cyrl-cs")),N.b1(l.a.ug("sv-fi"),l.a.ug("sv-se")));return N.xrc}static Nfc(Wa){N.xrc[Wa.languageId]=Wa.LCID}static b1(Wa,Bb){N.xrc[Wa.LCID]=Bb.LCID}static Y9h(Wa){var Bb=l.a.ug(Wa);if(!Bb)return 0;Bb=N.$wh[Bb.LCID]||N.$wh[Bb.languageId]||0;return Bb===Wa?0:Bb}}N.xrc=null;Object(D.a)(N,"AutoCorrectListFallback",null,[]);var O=c(359),X=c(86),U=c(175),T=c(118),Y=c(6),aa=c(16),ba=c(5),oa=c(80),ma=c(378),ea=c(37),ua=c(58),sa=c(99),Fa=c(44),Pa=c(1556);class Na extends Pa.a{constructor(Wa,
Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,hc,bc);this.QY=Gc}get aD(){return!0}get commandId(){return E.a.kJk}set aD(Wa){super.aD=Wa}}Object(D.a)(Na,"ARegexCorrectAction",Pa.a,[]);class Aa extends Na{static get Gmb(){if(null!=Aa.rEg)var Wa=Aa.rEg;else(Wa=y.a.instance.Oa("Box4.List.IListCommands"))||n.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),Wa=Aa.rEg=Wa;return Wa}static get Zm(){return null!=Aa.vEg?Aa.vEg:Aa.vEg=y.a.instance.resolve("Box4.List.IListEditor")}static get Jd(){return null!=
Aa.MEg?Aa.MEg:Aa.MEg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Wa,Bb]=this.QY;return Bb?Wa.replace(Bb,"%1"):Wa}}Object(D.a)(Aa,"AListAutoCorrectAction",Na,[]);var za=c(136);class xa extends Aa{get commandId(){return E.a.cJk}coa(Wa){if(xa.Gmb){var Bb=ba.GraphIterator.eb(Wa);Bb.od();ea.OutlineElementNavigator.Yd(Bb);if(xa.Zm.uie(Bb,this.QY[0])){var Ob=xa.Jd.ww(Bb),hc=this.QY[0],Gc=e.a.charAt(hc,0),bc=this.R4l(Gc),Dc=ma.a.IX(1,bc.listStyle);Ob&&Dc.szf(Ob)||(Ob=new Fa.GraphTransaction(15),
Ob.Ut(Bb),this.Md.Ge(I.a.createTextRange(Wa,this.YG,this.c1+1),"",!0,!1),xa.Zm.nlo(Dc),Wa=new O.DictionaryPropertySet,Wa.setValue(U.a.Rmf,!0),Gc&&(Dc.MQ=Gc,Wa.setValue(T.a.MQ,Dc.MQ)),Wa.setValue(Y.a.Ot,bc.levelText),Wa.setValue(aa.a.font,bc.fontName),"-"===Gc&&X.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,xa.zB,null),za.a.GY&&(Wa.setValue(T.a.eqa,"autocorrect"),Wa.setValue(T.a.Mia,hc)),xa.Gmb.dQk(Dc.listType,Dc.listStyle,Wa),Ob.dispose())}}}R4l(Wa){const Bb={listStyle:0,levelText:oa.a.KKd,
fontName:oa.a.ELc};switch(Wa){case "*":return{...Bb,listStyle:1};case "-":return{...Bb,levelText:"-",fontName:sa.a.PH};default:return Bb}}static xG(Wa,Bb,Ob,hc,Gc){return new xa(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new xa(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}}xa.zB="wwaengidc";xa.b7f=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(D.a)(xa,"BulletListAction",Aa,[]);var ka=c(83);class wa extends Na{constructor(Wa,Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,hc,Gc,bc);this.Gxc=!1;this.aD=!Wa;wa.rp=new ka.a}get aD(){return this.Gxc}set aD(Wa){this.Gxc=
Wa}iEb(Wa){this.e8e(Wa.innerText,(Bb,Ob,hc)=>{Wa.innerText=e.a.substring(Wa.innerText,0,Bb)+hc+e.a.right(Wa.innerText,Ob)})}coa(Wa){this.e8e(Q.ParagraphReader.text(Wa).substring(this.YG,this.c1),(Bb,Ob,hc)=>{this.Md.Ge(I.a.createTextRange(Wa,this.YG+Bb,this.YG+Ob),hc,!0,!1)})}e8e(Wa,Bb){if(!(2>this.QY.length)&&this.QY[1]){var Ob=this.QY[1];wa.rp.count||this.i3i();wa.rp.nb(Ob)&&(Wa=Wa.lastIndexOf(Ob),-1!==Wa&&Bb(Wa,Wa+Ob.length,wa.rp.J(Ob)))}}}Object(D.a)(wa,"ADictionarySequenceReplacerAction",Na,
[]);class ia extends wa{get commandId(){return E.a.U3e}i3i(){wa.rp.Z("--","\u2014");wa.rp.Z(" -- "," \u2013 ");wa.rp.Z(" - "," \u2013 ");wa.rp.Z("-- ","\u2014");wa.rp.Z(" --"," \u2013");wa.rp.Z(" -"," \u2013")}static xG(Wa,Bb,Ob,hc,Gc){return new ia(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new ia(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}}Object(D.a)(ia,"DashAction",wa,[]);class va extends wa{constructor(Wa,Bb,Ob,hc,Gc,bc,Dc){super(Wa,Bb,Ob,hc,Gc,bc);this.ga=Dc}get commandId(){return E.a.dJk}i3i(){wa.rp.Z(":)",
"\ud83d\ude0a");wa.rp.Z(":-)","\ud83d\ude0a");wa.rp.Z(":|","\ud83d\ude10");wa.rp.Z(":-|","\ud83d\ude10");wa.rp.Z(":(","\ud83d\ude41");wa.rp.Z(":-(","\ud83d\ude41");wa.rp.Z(";)","\ud83d\ude09");wa.rp.Z(";-)","\ud83d\ude09");wa.rp.Z(":D","\ud83d\ude00");wa.rp.Z(":-D","\ud83d\ude00");wa.rp.Z(":')","\ud83d\ude02");wa.rp.Z("=D","\ud83d\ude03");wa.rp.Z(":>","\ud83d\ude06");wa.rp.Z(":->","\ud83d\ude06");wa.rp.Z(":3","\ud83d\ude0a");wa.rp.Z(":-3","\ud83d\ude0a");wa.rp.Z("B-)","\ud83d\ude0e");wa.rp.Z("*-*",
"\ud83d\ude0d");wa.rp.Z(":*","\ud83d\ude19");wa.rp.Z(":-*","\ud83d\ude19");wa.rp.Z(":X","\ud83d\ude36");wa.rp.Z(":-X","\ud83d\ude36");wa.rp.Z(":O","\ud83d\ude2e");wa.rp.Z(":-O","\ud83d\ude2e");wa.rp.Z(":#","\ud83e\udd10");wa.rp.Z(":-#","\ud83e\udd10");wa.rp.Z(":P","\ud83d\ude1b");wa.rp.Z(":-P","\ud83d\ude1b");wa.rp.Z(";P","\ud83d\ude1c");wa.rp.Z(";-P","\ud83d\ude1c");wa.rp.Z(":-/","\ud83d\ude15");wa.rp.Z("$-$","\ud83e\udd11");wa.rp.Z(":S","\ud83d\ude16");wa.rp.Z(":-S","\ud83d\ude16");wa.rp.Z(":[",
"\ud83d\ude1f");wa.rp.Z(":-[","\ud83d\ude1f");wa.rp.Z(":\u2019(","\ud83d\ude22");wa.rp.Z(":'(","\ud83d\ude22");wa.rp.Z("@-@","\ud83d\ude31")}coa(Wa){this.e8e(Q.ParagraphReader.text(Wa).substring(this.YG,this.c1),(Bb,Ob,hc)=>{Bb=I.a.createTextRange(Wa,this.YG+Bb,this.YG+Ob);Ob={};Ob.MenuItemId=hc;this.ga.Mf(Bb,E.a.Okb,2,!1,null,Ob,null)})}static xG(Wa,Bb,Ob,hc,Gc,bc){return new va(null,Wa,Bb,Ob,hc,Gc,bc)}static gU(Wa,Bb,Ob,hc,Gc,bc){return new va(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc,bc)}}Object(D.a)(va,"EmojiAction",
wa,[]);class na{constructor(Wa,Bb,Ob,hc){this.US=Wa;this.Wzd=Bb;this.nyc=hc;this.dG=Ob}qBi(){if(!this.dG)return!1;this.US=this.US.trimStart();return this.US===this.dG?!0:!1}JYm(){if(!this.US)return!1;const Wa=this.US.lastIndexOf(" ");return-1!==Wa&&"."===this.US.charAt(Wa-1)&&"."===this.US.charAt(Wa-3)?!0:!1}IYm(){if(!this.US)return!1;var Wa=this.US.lastIndexOf(" ");return-1!==Wa&&(Wa=this.US.substring(0,Wa-1).lastIndexOf(" "),"."===this.US.charAt(Wa+2))?!0:!1}VRm(){return this.qBi()&&(1===this.dG.length&&
"."===this.Wzd||"."===this.US.charAt(1))?!0:!1}WRm(){return this.dG?0<="\\/".indexOf(this.Wzd)||3===this.dG.length&&0<="\\/".indexOf(this.dG.charAt(1))?!0:!1:!1}RQm(){return this.dG?0<=this.dG.indexOf("@")?!0:!1:!1}UB(){if(!this.dG)return!1;for(const Wa of na.Ywf())if(e.a.startsWith(this.dG+this.Wzd,Wa))return!0;return!1}vQm(){return this.dG?"i"===this.dG&&0<=na.quotes.indexOf(this.Wzd)?!0:!1:!1}rKm(){if(!this.US)return!1;const Wa=e.a.r5a(this.US,this.US.length-1);if(-1!==Wa&&this.US.substring(Wa+
1,this.US.length)===this.dG){const Bb=this.US.charAt(Wa-1);if(0<=na.Ocg.indexOf(Bb)||0<=na.quotes.indexOf(Bb)&&0<=na.Ocg.indexOf(this.US.charAt(Wa-2)))return!0}return!1}XVk(){return!this.US||this.JYm()||this.VRm()||this.WRm()||this.IYm()||this.RQm()||this.UB()?!1:this.qBi()||this.vQm()||this.rKm()?!0:!1}static Ywf(){return na.N5g||(na.N5g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}na.Ocg=".!?";na.quotes="'\"";na.N5g=null;Object(D.a)(na,"FirstLetterUpperCaseRules",null,[]);class Ca{constructor(Wa){this.dG=
Wa}cKl(){if(!this.dG)return null;for(let Wa=0;Wa<Ca.dli().length;Wa++)if(this.dG===Ca.dli()[Wa])return Ca.omm()[Wa];return null}static dli(){return Ca.XWg||(Ca.XWg=["1/2","1/4","3/4"])}static omm(){return Ca.WWg||(Ca.WWg=["\u00bd","\u00bc","\u00be"])}}Ca.XWg=null;Ca.WWg=null;Object(D.a)(Ca,"FractionsCollection",null,[]);class ta extends Pa.a{constructor(Wa,Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,hc,bc);this.ZKh=Gc}get aD(){return!0}get commandId(){return E.a.eJk}iEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,
0,this.YG)+this.ZKh+e.a.right(Wa.innerText,this.c1)}coa(Wa){this.Md.Ge(I.a.createTextRange(Wa,this.YG,this.c1),this.ZKh,!0,!1)}set aD(Wa){super.aD=Wa}static xG(Wa,Bb,Ob,hc,Gc){return new ta(null,Wa,Bb,Ob,hc,Gc)}}Object(D.a)(ta,"FractionsReplaceCorrectAction",Pa.a,[]);class fa extends Aa{get commandId(){return E.a.gJk}coa(Wa){if(fa.Gmb){var Bb=ba.GraphIterator.eb(Wa);Bb.od();ea.OutlineElementNavigator.Yd(Bb);if(fa.Zm.uie(Bb,this.QY[0])){var [Ob,hc]=this.QY,Gc=fa.Wjn(hc),bc=e.a.qec(hc)?4:2,Dc=I.a.createTextRange(Wa,
this.YG,this.c1+1);fa.Zm.J3b(Wa,Bb,bc,Gc,Dc,Ob,this.levelText,fa.Gmb)}}}static xG(Wa,Bb,Ob,hc,Gc){return new fa(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new fa(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}static Wjn(Wa){if(!Wa)return 0;Wa=e.a.eh(Wa);if(!e.a.mZd(Wa.charAt(0)))return 0;const Bb=Wa.charCodeAt(0)-97+1;let Ob;for(Ob=1;Ob<Wa.length&&Wa.charAt(Ob)===Wa.charAt(0);Ob++);return 26*(Ob-1)+Bb}}Object(D.a)(fa,"LetterListAction",Aa,[]);var Xa=c(122);class ob extends Aa{get commandId(){return E.a.J3b}coa(Wa){if(ob.Gmb){var Bb=
ba.GraphIterator.eb(Wa);Bb.od();ea.OutlineElementNavigator.Yd(Bb);if(ob.Zm.uie(Bb,this.QY[0])){var [Ob,hc]=this.QY,Gc=parseInt(hc);if(!(99999999<=Gc)){var bc=I.a.createTextRange(Wa,this.YG,this.c1+1);Xa.a.b2d()&&Xa.a.kom();ob.Zm.J3b(Wa,Bb,1,Gc,bc,Ob,this.levelText,ob.Gmb)}}}}static xG(Wa,Bb,Ob,hc,Gc){return new ob(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new ob(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}}Object(D.a)(ob,"NumberListAction",Aa,[]);class xb extends Pa.a{get aD(){return!0}get commandId(){return E.a.iJk}iEb(){}coa(Wa){const Bb=
I.a.createTextRange(Wa,this.c1-2,this.c1),Ob=new Fa.GraphTransaction(15);Ob.Db(Wa);let hc=!1,Gc=null,bc=0;for(;bc<Wa.ra.length;){var Dc=Wa.ra.J(bc),Ub=Dc.E9;const Fc=Dc.SU;if(Dc.cp>=Bb.cpBegin){Dc.cp>Bb.cpBegin||!Dc.formatting?Gc=hc?Dc.formatting:this.Md.sZ(Wa,bc,Bb.cpBegin,Gc):(Gc=Dc.formatting,Fc&&(hc=!1),Ub&&(hc=!0));bc++;break}Dc.formatting&&(Gc=Dc.formatting);Fc&&(hc=!1);Ub&&(hc=!0);bc++}for(;bc<Wa.ra.length;){Ub=Wa.ra.J(bc);if(Ub.cp>=Bb.cpEnd){if(Ub.cp>Bb.cpEnd||!Ub.formatting&&!Ub.Ph)hc||this.Md.sZ(Wa,
bc,Bb.cpEnd,Gc);hc||xb.rn.xra(Gc,!0);break}Ub.formatting&&(hc||xb.rn.xra(Gc,!0),Gc=Ub.formatting);Dc=Ub.E9;Ub=Ub.SU;Dc&&(hc=!0);!Dc&&Ub&&(hc=!1);bc++}Ob.dispose()}set aD(Wa){super.aD=Wa}static get rn(){return null!=xb.KAg?xb.KAg:xb.KAg=y.a.instance.resolve("Box4.IFormattingEditor")}static xG(Wa,Bb,Ob,hc){return new xb(null,Wa,Bb,Ob,hc)}}Object(D.a)(xb,"OrdinalsReplaceCorrectAction",Pa.a,[]);var zb=c(91),Lb=c(217),Ia;(function(Wa){Wa[Wa.F7i=0]="rand";Wa[Wa.G7i=1]="randOld";Wa[Wa.jMi=2]="lorem"})(Ia||
(Ia={}));Object(D.b)("RandTextType",Ia);class Ya extends Na{constructor(Wa,Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,hc,Gc,bc);Ya.UPe||Ya.nEo()}static FRm(){var Wa;return null===(Wa=x.AFrameworkApplication.K)||void 0===Wa?void 0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return E.a.jJk}coa(Wa){if(!(Wa.su||za.a.getInstance().es&&(za.a.getInstance().OHf?zb.ListItemReader.isListItem(Wa):Lb.a.Dpa(Wa)))){var Bb=this.Cbb.Pa.node===Wa,Ob=5,hc=3;if(this.QY[0].startsWith("=rand.old")){var Gc=
Ia.G7i;Ob=3}else if(this.QY[0].startsWith("=rand"))Gc=Ia.F7i;else if(this.QY[0].startsWith("=lorem"))Gc=Ia.jMi;else return;this.QY[1]&&(Ob=parseInt(this.QY[1]));this.QY[2]&&(hc=parseInt(this.QY[2]));if(!(20<hc||100<Ob)){Wa.zJ().rF.f8(7);var bc=ba.GraphIterator.eb(Wa);bc.od();ea.OutlineElementNavigator.Yd(bc);Ya.Pf.Oy(bc,!1,!1);Ya.Pf.OH(bc);var Dc=!1;switch(Gc){case Ia.F7i:Gc=Ya.UPe;break;case Ia.G7i:Gc=Ya.Jch;break;case Ia.jMi:Gc=Ya.I6g;Dc=!0;break;default:return}var Ub=0;for(let Sa=0;Sa<Ob;++Sa){const wb=
[];for(var Fc=0;Fc<hc;Fc++)wb.push(Gc[Ub++%Gc.length]);Fc=I.a.Uc(bc.currentNode,0);if(Dc){const Tb=v.FormattingReader.Xr(Fc);Ya.rn.hm(Tb,Y.a.noProof,!0)}this.Md.Ge(Fc,wb.join(Ya.FRm()?"":" "),!0,!1);Sa<Ob-1&&(ea.OutlineElementNavigator.Yd(bc),Ya.Pf.Oy(bc,!1,!1),Ya.Pf.OH(bc))}Ob=bc.currentNode;bc=ba.GraphIterator.eb(Wa);bc.od();ea.OutlineElementNavigator.Yd(bc);bc.tg();Bb&&(this.Cbb=L.SelectionFactory.ne(Ob,Q.ParagraphReader.textLength(Ob)))}}}static get Pf(){return null!=Ya.rFg?Ya.rFg:Ya.rFg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get rn(){return null!=
Ya.OAg?Ya.OAg:Ya.OAg=y.a.instance.resolve("Box4.IFormattingEditor")}static nEo(){Ya.UPe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ya.Jch=["The quick brown fox jumps over the lazy dog. "];Ya.I6g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static xG(Wa,
Bb,Ob,hc,Gc){return new Ya(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new Ya(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}}Ya.UPe=null;Ya.Jch=null;Ya.I6g=null;Object(D.a)(Ya,"RandAction",Na,[]);class eb{constructor(Wa,Bb,Ob,hc){this.pattern=hc&8?new RegExp(Wa,"i"):new RegExp(Wa);this.Dwm=Bb;this.bnm=Ob;this.flags=hc}}Object(D.a)(eb,"RegexAutoCorrectEntry",null,[]);class sb extends Aa{get commandId(){return E.a.lJk}coa(Wa){if(sb.Gmb){var Bb=ba.GraphIterator.eb(Wa);Bb.od();ea.OutlineElementNavigator.Yd(Bb);
if(sb.Zm.uie(Bb,this.QY[0])){var [Ob,hc]=this.QY,Gc=sb.Xjn(hc);if(!(0>=Gc)){var bc=e.a.qec(hc.charAt(0))?5:3,Dc=I.a.createTextRange(Wa,this.YG,this.c1+1);sb.Zm.J3b(Wa,Bb,bc,Gc,Dc,Ob,this.levelText,sb.Gmb)}}}}static xG(Wa,Bb,Ob,hc,Gc){return new sb(null,Wa,Bb,Ob,hc,Gc)}static gU(Wa,Bb,Ob,hc,Gc){return new sb(Wa,ua.a(Wa).Cb,Bb,Ob,hc,Gc)}static Xxl(){sb.vNa||(sb.vNa={},sb.vNa.M=1E3,sb.vNa.D=500,sb.vNa.C=100,sb.vNa.L=50,sb.vNa.X=10,sb.vNa.V=5,sb.vNa.I=1)}static Xjn(Wa){if(!Wa)return 0;sb.Xxl();Wa=e.a.ZA(Wa);
let Bb=0,Ob=0;for(let hc=Wa.length-1;0<=hc;hc--){const Gc=sb.vNa[e.a.charAt(Wa,hc).toString()];Ob=Gc<Bb?Ob-Gc:Ob+Gc;Bb=Gc}return Ob}}sb.vNa=null;sb.b7f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Wa=>`\\(?(${Wa})[\\.\\)\\-]`);Object(D.a)(sb,"RomanListAction",Aa,[]);var lc=c(41);class vb extends Pa.a{constructor(Wa,Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,Ob+1,bc);this.Snk=
hc;this.UQg=Gc;this.p1c=!1}get aD(){return!1}get commandId(){return E.a.mJk}iEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,0,this.YG)+this.UQg+e.a.right(Wa.innerText,this.c1)}coa(Wa){this.Md.Ge(I.a.createTextRange(Wa,this.YG,this.c1),this.Snk,!0,!1);this.Md.Ge(I.a.createTextRange(Wa,this.YG,this.YG+1),this.UQg,!0,!1)}set aD(Wa){super.aD=Wa}static xG(Wa,Bb,Ob,hc,Gc,bc){if("'"!==Ob&&'"'!==Ob)return null;var Dc=ba.GraphIterator.eb(Wa);Dc.od();ea.OutlineElementNavigator.Yd(Dc);if(lc.OutlineElementReader.Pn(Dc.currentNode))return null;
hc=!Bb||e.a.qda(hc)||-1!==Array.indexOf(vb.qxn,hc);Dc="'"===Ob;return new vb(bc,Wa,Bb,Ob+"",hc?Dc?"\u2018":"\u201c":Dc?"\u2019":"\u201d",Gc)}}vb.qxn=["[","{","("];Object(D.a)(vb,"SmartQuoteCorrectAction",Pa.a,[]);class Eb extends Pa.a{constructor(Wa,Bb,Ob,hc,Gc,bc){super(Wa,Bb,Ob,hc,bc);this.TQg=Gc}get aD(){return Eb.Gxc}set aD(Wa){Eb.Gxc=Wa}get commandId(){return E.a.nJk}VJj(){this.Yqd=this.gEh();this.Yqd||(this.p5g=!1,this.f0g="MatchTextIsNotTheSame")}iEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,
0,this.YG)+this.TQg+e.a.right(Wa.innerText,this.c1)}coa(Wa){this.Md.Ge(I.a.createTextRange(Wa,this.YG,this.c1),this.TQg,!0,!1)}static gU(Wa,Bb,Ob,hc,Gc){const bc=ua.a(Wa);return new Eb(Wa,bc?bc.Cb:null,Bb,Ob,hc,Gc)}static xG(Wa,Bb,Ob,hc,Gc){return new Eb(null,Wa,Bb,Ob,hc,Gc)}}Eb.Gxc=!1;Object(D.a)(Eb,"StringReplaceCorrectAction",Pa.a,[]);class Ua extends Pa.a{constructor(Wa,Bb,Ob,hc,Gc,bc,Dc,Ub){super(Wa,Bb,Ob,hc,Gc);this.Nk=bc;this.m9j=Dc;this.GD=Ub}get aD(){return!0}get commandId(){return E.a.oJk}iEb(Wa){let Bb=
e.a.substring(Wa.innerText,this.YG,this.c1);Bb.charAt(0)!==Bb.charAt(0).toUpperCase()&&(Bb=Bb.charAt(0).toUpperCase()+Bb.substring(1,Bb.length));Wa.innerText=e.a.substring(Wa.innerText,0,this.YG)+Bb+e.a.right(Wa.innerText,this.c1)}coa(Wa){const Bb=this.YG,Ob=this.YG+1,hc=Wa.characterData.substring(Bb,Ob).charAt(0);if(!e.a.qec(hc)){const Gc=I.a.createTextRange(Wa,Bb,Ob);this.NKm(Gc)||this.GD&&this.GD.QYc(Wa,Bb,Ob)||this.Md.Ge(Gc,hc.toUpperCase().toString(),!0,!1)}}NKm(Wa){return this.m9j?!!this.Nk&&
this.Nk.x9(Wa):!1}set aD(Wa){super.aD=Wa}static gU(Wa,Bb,Ob,hc){const Gc=ua.a(Wa);return new Ua(Wa,Gc?Gc.Cb:null,Bb,Ob,hc,null,!1,null)}static xG(Wa,Bb,Ob,hc,Gc,bc){return new Ua(null,Wa,Bb,Ob,hc,Gc,!0,bc)}}Object(D.a)(Ua,"UpperFirstLetterAutoCorrectAction",Pa.a,[]);class Ta{constructor(Wa,Bb){this.nyc=Bb;this.dG=Wa}S2o(){const Wa=Number.parseInvariant(this.dG.substring(0,this.dG.length-2));switch(Number.parseInvariant(this.dG.charAt(this.dG.length-3).toString())){case 1:return 11===Wa?"th":"st";
case 2:return 12===Wa?"th":"nd";case 3:return 13===Wa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}hSm(){var Wa=l.a.ug(this.nyc);if(!Wa||!Wa.name.toLowerCase().startsWith("en")||!this.dG||2>=this.dG.length)return!1;for(Wa=0;Wa<Ta.FVd().length;Wa++)if(this.dG.toLowerCase().endsWith(Ta.FVd()[Wa])){if(RegExp("^\\d+$").test(this.dG.substr(0,this.dG.length-2))){const Bb=this.S2o();if(this.dG.toLowerCase().endsWith(Ta.FVd()[Wa])&&Bb===Ta.FVd()[Wa])return!0}break}return!1}static FVd(){return Ta.U$g||
(Ta.U$g=["st","nd","rd","th"])}}Ta.U$g=null;Object(D.a)(Ta,"ValidateOrdinalsRule",null,[]);c.d(J,"a",function(){return Nb});class Nb{constructor(Wa,Bb,Ob,hc,Gc,bc,Dc){this.cCc=[];this.XUb=[];this.wrc=[];this.vue=new Set;this.Vbb=-1;this.RZg=this.Yfa=!1;this.G6j=Wa;this.Md=Bb;this.Nk=Ob;this.ga=hc;this.cW=bc;this.GD=Dc;Gc?(this.Yfa=Gc.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.RZg=Gc.$("HyperlinkUrlValidationIsEnabled"),n.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Yfa})):
(n.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Yfa=!1)}klb(Wa){return 0<=Nb.V3e.indexOf(Wa)}$If(Wa){return 0<=Nb.W3e.indexOf(Wa)}IGf(Wa){return Wa.toLowerCase()===Wa}qec(Wa){return Wa.toUpperCase()===Wa}mZd(Wa){return Wa.toLowerCase()!==Wa.toUpperCase()}wNm(Wa,Bb,Ob,hc){return(new na(Wa,Bb,Ob,hc)).XVk()}OUl(Wa){do{if(Wa.getAttribute("xml:lang"))return l.a.ug(Wa.getAttribute("xml:lang"))||l.a.QVc;if(Wa.getAttribute("lang"))return l.a.ug(Wa.getAttribute("lang"))||
l.a.QVc;Wa=Wa.parentNode}while(Wa&&1===Wa.nodeType);return l.a.QVc}iqf(Wa){return l.a.ug(v.FormattingReader.language(v.FormattingReader.Xr(Wa)))||l.a.QVc}SOd(Wa,Bb){0>Bb&&(Bb=0);let Ob=-1;const hc=Nb.V3e.length;for(let Gc=0;Gc<hc;++Gc){const bc=Wa.lastIndexOf(e.a.charAt(Nb.V3e,Gc),Bb);bc>Ob&&(Ob=bc)}Wa=e.a.r5a(Wa,Bb);Wa>Ob&&(Ob=Wa);return Ob}oEl(Wa){for(let Bb=0;Bb<Wa.length;++Bb)if(this.mZd(e.a.charAt(Wa,Bb)))return Bb;return-1}Jlf(Wa,Bb){if(!Wa||0>Bb)return-1;let Ob=Bb;Ob=Ob?this.SOd(Wa,Ob-1):-1;
Ob=Ob>e.a.r5a(Wa,Bb-1)?Ob:e.a.r5a(Wa,Bb-1);Ob++;return Ob}R0h(Wa,Bb,Ob){this.zNc(Bb);if(!this.XUb[Bb]){Bb=N.Y9h(Bb);if(0>=Bb)return null;this.zNc(Bb);if(!this.XUb[Bb])return null}if(Ob&&this.wrc[Bb]&&Array.contains(this.wrc[Bb],Wa+Ob))return null;Ob=this.XUb[Bb][e.a.eh(Wa)];if("string"!==typeof Ob||Ob===Wa||!Ob)return null;var hc=this.oEl(Wa);if(0>hc||this.IGf(e.a.charAt(Wa,hc)))return Ob;Bb=!0;for(hc+=1;hc<Wa.length;++hc){const Gc=e.a.charAt(Wa,hc);Bb&&!this.qec(Gc)&&(Bb=!1)}return Bb?null:e.a.ZA(e.a.substring(Ob,
0,1))+e.a.right(Ob,1)}CEl(Wa,Bb,Ob,hc){a.a.mark(4666);const Gc=this.OUl(Bb).LCID;let bc=0,Dc=Wa;const Ub=Bb.innerText;var Fc=Ub.lastIndexOf(" ",Wa);if(this.nFf(Ub.substring(Fc+1,Wa)))return a.a.mark(4667),null;Fc=null;var Sa=!1;do{Dc=Dc?this.SOd(Ub,Dc-1):-1;if(-1===Dc&&!Ob){Sa=Bb;var wb=null;if(!this.klb(Ub.charAt(0))){do{for(;Sa&&!Sa.previousSibling;)Sa=Sa.parentNode;Sa&&(Sa=Sa.previousSibling,wb=Sa.innerText)}while(Sa&&!wb);if(Sa&&wb&&!this.klb(e.a.charAt(wb,wb.length-1)))return a.a.mark(4667),
null}Sa=!0}wb=e.a.substring(Ub,Dc+1,Wa);++bc;var Tb=this.R0h(wb,Gc,hc.toString());if(Tb)Fc=Eb.gU(Bb,Dc+1,Wa,Tb,this.Md),Nb.nNf();else for(const Hb of this.cCc)if(!(Hb.flags&1&&!(Ob&&1>Dc)||Hb.flags&4||Hb.flags&2&&" "!==hc)&&(Tb=Hb.pattern.exec(wb))){Fc=Hb.Dwm(Bb,Dc+1,Wa,Tb,this.Md,this.ga);break}}while(!Sa&&!Fc&&bc<Nb.fOi&&0<=Dc);a.a.mark(4667);return Fc}AEl(Wa,Bb,Ob){const hc=Wa.node;let Gc=Q.ParagraphReader.text(hc);0>Bb&&(Bb=Wa.cpBegin);Wa=this.iqf(Wa).LCID;if(this.nFf(Gc.substring(e.a.r5a(Gc,
Bb)+1,Bb)))return null;var bc=-1,Dc=S.a.d$b(hc);for(var Ub=0;Ub<Dc.length;Ub++)if(Bb>Dc[Ub].cpEnd)bc=Dc[Ub].cpEnd;else{if(Bb>Dc[Ub].cpBegin)return null;break}Dc=null;Ub=(Ub=Bb)?this.SOd(Gc,Ub-1):-1;Ub<bc&&(Ub=bc-1);bc=e.a.substring(Gc,Ub+1,Bb);bc=bc.trimStart();if(1>Ub)for(const Fc of this.cCc){let Sa=Gc;" "!==Ob&&(Sa=Gc+Ob);if(Fc.pattern.exec(Sa))return null}Gc=Gc.substring(0,Bb);if(!this.wNm(Gc,Ob.toString(),bc,Wa))return null;bc.charAt(0).toUpperCase()!==bc.charAt(0)&&(Dc=Ua.xG(hc,Ub+1,Bb,this.Md,
this.Nk,this.GD));return Dc}s0h(Wa,Bb,Ob){Wa=L.SelectionFactory.Eo(Wa,!1);if(!Wa)return null;Wa=Wa.Rc;return K.SelectionEditor.Ze(Wa)?this.AEl(Wa,Bb,Ob):null}nFf(Wa){return e.a.vP(Wa)}mlf(Wa,Bb,Ob,hc){a.a.mark(4666);const Gc=Wa.node,bc=this.iqf(Wa).LCID,Dc=Q.ParagraphReader.text(Gc);0>Bb&&(Bb=Wa.cpBegin);if(Ob&&!this.klb(e.a.charAt(Dc,Bb))||this.nFf(Dc.substring(e.a.r5a(Dc,Bb)+1,Bb)))return a.a.mark(4667),null;Wa=-1;Ob=S.a.d$b(Gc);for(var Ub=0;Ub<Ob.length;Ub++)if(Bb>Ob[Ub].cpEnd)Wa=Ob[Ub].cpEnd;
else{if(Bb>Ob[Ub].cpBegin)return null;break}Ob=0;Ub=Bb;let Fc=null;do{Ub=Ub?this.SOd(Dc,Ub-1):-1;Ub<Wa&&(Ub=Wa-1);const wb=e.a.substring(Dc,Ub+1,Bb);++Ob;var Sa=null;let Tb=!1;if(H.a.lVh){const Hb=Dc+String.fromCharCode(hc);Tb=this.cCc.some($a=>$a.pattern.exec(Hb))}Tb||(Sa=this.R0h(wb,bc,null));if(Sa)this.cW.aUa&&(Fc=Eb.xG(Gc,Ub+1,Bb,Sa,this.Md),Nb.nNf());else for(const Hb of this.cCc)if(!(Hb.flags&1&&-1!==Ub||Hb.flags&4&&hc!==k.a.Rs||Hb.flags&2&&hc!==k.a.gKa)&&(Sa=Hb.pattern.exec(wb))){Fc=Hb.bnm(Gc,
Ub+1,Bb,Sa,this.Md,this.ga);if(Fc.commandId!==E.a.U3e&&!this.cW.aUa||Fc.commandId===E.a.U3e&&!this.cW.v7c)Fc=null;break}}while(0<=Ub&&Ub>=Wa&&!Fc&&Ob<Nb.fOi);a.a.mark(4667);return Fc}r0h(Wa,Bb,Ob){Wa=L.SelectionFactory.Eo(Wa,!1);if(!Wa)return null;Wa=Wa.Rc;return K.SelectionEditor.Ze(Wa)?this.mlf(Wa,Bb,!1,Ob):null}z0h(Wa,Bb){var Ob=L.SelectionFactory.Eo(Wa,!1);if(!Ob)return null;let hc=Ob.Rc;Ob.Zw&&Ob.Rc.contextId!==z.a.Vc&&0<=Bb&&(hc=I.a.Uc(Wa,Bb));if(!K.SelectionEditor.Ze(hc)||S.a.Lxa(hc,!1))return null;
Ob=Q.ParagraphReader.text(hc.node);Wa=0<Bb?e.a.r5a(Ob,Bb-1)+1:e.a.r5a(Ob,Ob.length-1)+1;Bb=0<Bb?Bb:Ob.length;Ob=e.a.substring(Ob,Wa,Bb);return!Ob||this.RZg&&!S.a.cSa(Ob)||!e.a.vP(Ob)&&!e.a.EWc(Ob)||!Nb.jp.S0n(hc,Wa,Bb)?null:this.G6j.Fbl(hc.node,Wa,Bb)}D0h(Wa,Bb){var Ob=L.SelectionFactory.Eo(Wa,!1);if(!Ob)return null;var hc=Ob.Rc;if(!K.SelectionEditor.Ze(hc))return null;0>Bb&&(Bb=hc.cpBegin);var Gc=Q.ParagraphReader.text(hc.node);Ob=this.Jlf(Gc,Bb);const bc=Nb.W3e.length;for(let Dc=0;Dc<bc;++Dc){const Ub=
Gc.lastIndexOf(e.a.charAt(Nb.W3e,Dc),Bb-1);Ub>Ob&&(Ob=Ub+1)}Gc=e.a.substring(Gc,Ob,Bb);if(!Gc)return null;hc=this.iqf(hc).LCID;return(new Ta(Gc,hc)).hSm()?xb.xG(Wa,Ob,Bb,this.Md):null}o0h(Wa,Bb){var Ob=L.SelectionFactory.Eo(Wa,!1);if(!Ob)return null;Ob=Ob.Rc;if(!K.SelectionEditor.Ze(Ob))return null;0>Bb&&(Bb=Ob.cpBegin);var hc=Q.ParagraphReader.text(Ob.node);Ob=this.Jlf(hc,Bb);hc=e.a.substring(hc,Ob,Bb);return hc?(hc=(new Ca(hc)).cKl())?ta.xG(Wa,Ob,Bb,hc,this.Md):null:null}zFl(Wa,Bb,Ob,hc,Gc){var bc=
L.SelectionFactory.Eo(Wa,!1);if(!bc)return null;bc=bc.Rc;if(Ob>Bb||!K.SelectionEditor.Ze(bc))return null;0>Bb&&(Bb=bc.cpBegin);if(0>Bb)return null;bc=Q.ParagraphReader.text(bc.node);return vb.xG(Wa,Ob,Gc,Bb?bc.charAt(Bb-1):"\x00",this.Md,hc)}XAb(Wa,Bb,Ob,hc){this.cCc.push(new eb(`^${Wa}$`,Bb,Ob,hc))}TPf(Wa){if(this.XUb[this.Vbb]){const Bb=this.XUb[this.Vbb];for(const Ob in Wa)Bb[Ob]=Wa[Ob]}else this.XUb[this.Vbb]=Wa}XPf(Wa){this.wrc[this.Vbb]?this.wrc[this.Vbb].push(...(Wa||[])):this.wrc[this.Vbb]=
Wa}L2m(Wa,Bb){var Ob;this.vue.has(Bb)||(this.vue.add(Bb),null===(Ob=x.AFrameworkApplication.He)||void 0===Ob?void 0:Ob.nj(Wa,1,null,null,!1,3,hc=>{this.Vbb=Bb;try{Object(t.a)(hc.data.te)}catch(Gc){n.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:hc.data?hc.data.te:""})}this.Vbb=-1},()=>{this.gxl(Bb)},null,void 0,void 0,void 0,void 0,"27"))}gxl(Wa){Wa=N.Y9h(Wa);0<Wa&&this.zNc(Wa)}static get IJk(){return null!=Nb.Qwg?Nb.Qwg:Nb.Qwg=(()=>Nb.fxh.map(([Wa,...Bb])=>
(new eb(`^${Wa}`,...Bb)).pattern))()}static get fxh(){return null!=Nb.Rwg?Nb.Rwg:Nb.Rwg=(()=>[...xa.b7f.map(Wa=>[Wa,xa.gU,xa.xG,3]),["\\(?(\\d+)[\\.\\)\\-]",ob.gU,ob.xG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",fa.gU,fa.xG,3],...sb.b7f.map(Wa=>[Wa,sb.gU,sb.xG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",fa.gU,fa.xG,3]])()}U2m(){this.zNc(1033);this.XAb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ya.gU,Ya.xG,5);this.XAb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ya.gU,Ya.xG,5);this.XAb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ya.gU,Ya.xG,5);Nb.fxh.forEach(Wa=>this.XAb(...Wa));this.XAb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",ia.gU,ia.xG,0);this.XAb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",va.gU,va.xG,0);this.XAb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",va.gU,va.xG,0)}zNc(Wa){this.vue.has(Wa)||this.L2m(M.a.KMk(String.format("Acl/Acl{0}.js",Wa)),Wa)}static nNf(){y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(Wa=>{Wa.logActivity("AutocorrectStringMatch",null)})}static get jp(){return null!=Nb.yBg?Nb.yBg:
Nb.yBg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Nb.V3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Nb.W3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Nb.Ocg=".!?";Nb.fOi=5;Object(D.a)(Nb,"AutoCorrectRules",null,[511])},1673:function(D,J,c){D=c(0);var l=c(75),e=c(55),a=c(326),k=c(342);class x{constructor(H,M,K,L=0,S=0,Q=null,N=null){this.commandId=H;this.controlId=M;this.timeStamp=K;this.commandSurface=a.a[L];this.Ux=k.a[S];
this.contentType=Q;this.$le=N}}Object(D.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.hVj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))");this.Z_j=RegExp("(CoauthorsRendered|DoNothing|MenuClose|MenuOpen|ZeroTermContextMenuClose|SmartLookupContextMenu|TabSwitch|((TellMe).+))")}isNullOrUndefined(H){return null===H||"undefined"===typeof H}lYm(H){return!this.hVj.exec(H)}mYm(H){return this.isNullOrUndefined(H)||!H.trim().length?!1:!this.Z_j.exec(H)}}
Object(D.a)(y,"EventsCacheLoggingUtils",null,[]);class n{constructor(H,M,K,L){this.CmdId=this.ParentTcid=this.Tcid=null;this.Time=0;this.Tcid=H;this.ParentTcid=M;this.CmdId=K;this.Time=L}}Object(D.a)(n,"MRUControl",null,[]);var t=c(2),z=c(1852),v=c(660),I=c(158);c.d(J,"a",function(){return E});class E{constructor(){this.izc=null;this.f7g=this.GKe=20;this.hsd=this.Bta=this.Avc=this.Iid=this.jjd=null;this.Tgh=this.QGe=!1}init(){this.izc=new y;this.jjd=new l.a;this.Iid=new l.a;this.Avc=new l.a;this.GKe=
t.AFrameworkApplication.K.nc("MaxCommandClickedEventQueueSize",20);z.a.eyk(Object(e.a)(this,this.L1k,"commandClickEventRaised"));v.a.instance.Zqh(Object(e.a)(this,this.uRn,"recordActionEvent"));this.QGe=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserMRUActionsCookieEnabled",!1);this.Tgh=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPreferParentControls",!0);this.QGe&&(this.Bta=new l.a,this.hsd="UserRecentActions_"+this.FQd(),
this.t3m())}FQd(){switch(t.AFrameworkApplication.ta.Kb.xk){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}t3m(){var H=I.a.get(this.hsd);if(!this.izc.isNullOrUndefined(H)&&0<H.length){let M=null;try{M=JSON.parse(decodeURIComponent(H))}catch(K){I.a.remove(this.hsd);return}H=0;for(const K of M)this.Bta.insert(H++,K)}}xsk(H){const M=this.Tgh&&!this.izc.isNullOrUndefined(H.eic)&&0<H.eic.length;if(0<this.Bta.count){for(var K=
0;K<this.Bta.count&&3>K;K++){var L=this.Bta.J(K);if(M&&L.ParentTcid===H.eic||L.Tcid===H.controlId)return}for(K=3;K<this.Bta.count;K++)if(L=this.Bta.J(K),M&&L.ParentTcid===H.eic||L.Tcid===H.controlId){this.Bta.remove(L);break}}this.Bta.insert(0,new n(H.controlId,H.eic,H.commandId,H.time));this.Bta.count>this.f7g&&this.Bta.removeAt(this.f7g);H=JSON.stringify(this.Bta.toArray());I.a.ZIa(this.hsd,H,I.a.pHa)}dog(H){H.count>this.GKe&&H.removeAt(this.GKe)}L1k(H,M){this.jjd.insert(0,new x(M.commandId,M.controlId,
M.time,M.commandSurface,M.Ux,M.contentType,M.eic));this.dog(this.jjd);this.QGe&&this.izc.mYm(M.controlId)&&this.xsk(M)}uRn(H,M){this.Iid.insert(0,new x(M.actionName,M.controlId,M.timeStamp,M.commandSurface,M.Ux,M.contentType,M.$le));this.dog(this.Iid);this.izc.lYm(M.actionName)&&(this.Avc.insert(0,new x(M.actionName,M.controlId,M.timeStamp,M.commandSurface,M.Ux,M.contentType,M.$le)),this.dog(this.Avc))}eQc(){return this.jjd}Nib(){return this.Iid}static get instance(){return E._instance||(E._instance=
new E)}}E._instance=null;Object(D.a)(E,"CommandClickEventsCache",null,[])},1675:function(D,J,c){D=c(0);var l=c(139),e=c(61),a=c(359),k=c(56),x=c(3),y=c(737),n=c(18),t=c(5),z=c(303),v=c(44),I=c(1345),E=c(833),H=c(118),M=c(47),K=c(16),L=c(6),S=c(175),Q=c(42),N=c(7),O=c(1892),X=c(691),U=c(1732),T=c(127),Y=c(1582);class aa{constructor(sa,Fa,Pa,Na,Aa,za){this.H7b=this.UH=null;this.Dnf=Fa;if(sa[X.a.PSc])this.lP=sa[X.a.PSc],this.DGc=sa[X.a.DGc],this.H7b=Array(4),this.H7b[0]=sa[X.a.Fhb],this.H7b[1]=sa[X.a.Ghb],
this.H7b[2]=sa[X.a.Hhb],this.H7b[3]=sa[X.a.Ehb],this.q5o=sa[X.a.width],this.Ium=sa[X.a.height],this.$xa=void 0!==sa[X.a.$xa]?"true"===sa[X.a.$xa].toLowerCase():void 0,this.Ns=Pa,this.w7b=Na;else{Fa=sa[X.a.Fhb];const xa=sa[X.a.Ghb],ka=sa[X.a.Hhb],wa=sa[X.a.Ehb];za&&za.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==Fa&&void 0!==xa&&void 0!==ka&&void 0!==wa?(this.Fhb=Fa,this.Ghb=xa,this.Hhb=ka,this.Ehb=wa):(this.Fhb=sa[X.a.left],this.Ghb=sa[X.a.right],this.Hhb=sa[X.a.top],this.Ehb=sa[X.a.bottom]);
this.width=sa[X.a.width];this.height=sa[X.a.height];this.rotationAngle=sa[X.a.angle];this.uEn=sa[X.a.tEn];this.Ns=Pa;this.w7b=Na;this.kgb=Aa;this.gGa=2;this.flipH=this.cY(sa,X.a.flipH);this.flipV=this.cY(sa,X.a.flipV);this.Ein();this.NWo()}}NWo(){this.UH||(this.UH=Array(4),this.UH[0]=T.a.EG(this.Fhb),this.UH[1]=T.a.EG(this.Ghb),this.UH[2]=T.a.EG(this.Hhb),this.UH[3]=T.a.EG(this.Ehb))}Ein(){var sa=Y.c(this.rotationAngle);if(45<=sa&&135>=sa||225<=sa&&315>=sa){sa=this.width/2;const Fa=this.height/2;
this.Fhb-=sa-Fa;this.Ghb+=sa-Fa;this.Hhb-=Fa-sa;this.Ehb+=Fa-sa}}cY(sa,Fa){if(sa.hasOwnProperty(Fa))return sa[Fa]}}Object(D.a)(aa,"JsonToDocumentXmlResponseCommonParams",null,[]);class ba extends aa{constructor(sa,Fa,Pa,Na,Aa,za){super(sa,Fa,Pa,Na,Aa,za);this.ICk="string"===typeof sa[X.a.iDd]?sa[X.a.iDd]:null;this.s8b="string"===typeof sa[X.a.s8b]?sa[X.a.s8b]:null}}Object(D.a)(ba,"JsonToDocumentXmlResponseDrawingParams",aa,[]);var oa=c(523),ma=c(507);class ea extends aa{constructor(sa,Fa,Pa,Na,Aa,
za){var xa,ka,wa,ia,va;super(sa,Fa,Pa,Na,Aa,za);this.O0o=sa[X.a.aEn];this.H5k=sa[X.a.TDn];this.gGa=ma.a.rendered;this.H5k||(this.gGa=ma.a.notRendered,this.UH=oa.a.instance.Foa(T.a.EG(this.width),T.a.EG(this.height),this.rotationAngle));this.ZZf=this.cY(sa,X.a.Ghc);this.O9d=this.cY(sa,X.a.O9d);this.$Zf=this.cY(sa,X.a.$Zf);this.hLj=this.cY(sa,X.a.gLj);this.Vpe=this.cY(sa,X.a.Vpe);this.xsg=this.cY(sa,X.a.xsg);this.L6c=null!==(xa=this.cY(sa,X.a.L6c))&&void 0!==xa?xa:"";this.extension=sa[X.a.extension];
this.Kva=null!==(ka=this.cY(sa,X.a.left))&&void 0!==ka?ka:0;this.Mva=null!==(wa=this.cY(sa,X.a.top))&&void 0!==wa?wa:0;this.Lva=null!==(ia=this.cY(sa,X.a.right))&&void 0!==ia?ia:0;this.Jva=null!==(va=this.cY(sa,X.a.bottom))&&void 0!==va?va:0;this.lockAspectRatio=this.cY(sa,X.a.lockAspectRatio);this.Byh=this.cY(sa,X.a.vja);this.borderStyle=this.cY(sa,X.a.Oqa);this.borderColor=this.cY(sa,X.a.dIa);this.hMk=void 0!==this.Byh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=
this.cY(sa,X.a.altTextDescription);this.alphaModFix=this.cY(sa,X.a.alphaModFix)}}Object(D.a)(ea,"JsonToDocumentXmlResponsePictureParams",aa,[]);c.d(J,"a",function(){return ua});class ua{constructor(sa,Fa,Pa,Na,Aa,za,xa,ka,wa,ia,va,na,Ca,ta,fa,Xa,ob){this.kbb=this.Kzb=null;this.bnd=sa;this.zCe=Fa;this.qK=Pa;this.Pm=Na;this.Zl=Aa;this.Lc=za;this.N2j=ka;this.$Tg=xa;this.Vj=wa;this.ap=ia;this.Mfk=va;this.Lfk=na;this.Ca=Ca;this.dW=ta;this.rd=fa;this.e9j=Xa;this.g7j=ob}Bqa(sa,Fa,Pa,Na,Aa,za,xa){za.stop();
xa?N.ULS.sendTraceTag(575522565,3001,10,sa):N.ULS.sendTraceTag(575522566,3001,10,sa);this.$Tg?(Na=this.Lc.Pc(7,x.a.QSc),Na.Db(Pa),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&Fa.Gb.setValue(H.a.TPa,!1),Fa.Gb.setValue(M.a.B0,0),Fa.Gb.setValue(K.a.Kia,Fa.YQk),Fa.Gb.setValue(K.a.Jia,Fa.WQk),Na.dispose()):Na();this.kbb&&this.kbb(sa);Aa()}phc(sa,Fa,Pa,Na,Aa,za,xa){N.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",
{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:xa.pi});var ka=sa.data.te,wa=null;try{wa=JSON.parse(ka)}catch(va){this.Bqa("Failed to parse incoming JSON blob.",Fa,Aa,Na,Pa,xa,!1);return}if(O.a.error in wa)this.Bqa("Error code returned from WordGraphicsEditorHandler endpoint: "+wa[O.a.error],Fa,Aa,Na,Pa,xa,!1);else{ka=10;var ia=1;try{ka=parseInt(wa[X.a.Ns]),ia=parseInt(wa[X.a.w7b])}catch(va){this.Bqa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",Fa,Aa,Na,Pa,xa,
!1);return}Pa=sa.data.request?y.a.eOc(sa.data.request.get_body()):null;sa=null;sa=Fa.Gb;Na=Fa.getId();Fa=sa.getValue(L.a.Ns);Fa=Fa!==ka&&(5===Fa||5===ka||this.rsm(sa,wa));5===ka?(wa=new ea(wa,this.zCe,ka,ia,Pa,this.Ca),sa=this.ZSl(Aa,za,wa,Fa,sa,Na)):(wa=new ba(wa,this.zCe,ka,ia,Pa,this.Ca),sa=this.YSl(Aa,za,wa,Fa,sa,Na));wa=this.Lc.Pc(7,x.a.QSc);ka=Aa;n.ImageReader.r9(Aa)&&Fa&&(ka=t.GraphIterator.eb(Aa),ka.zb(12),ka=ka.parentNode);wa.Db(ka);sa();this.qK.SIa(za);wa.dispose();if(this.Zl&&this.Zl!==
l.a.nil){const va=ka.Zi();null===va||void 0===va?void 0:va.contentReplicator.forceOutbound(()=>{N.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:xa.pi});xa.stop();const na=new e.a(this.Zl,1);this.Pm.m5b(va,na);const Ca=this.bnd.properties;null!=Ca&&Object(z.a)(()=>{const ta=new v.GraphTransaction(3,x.a.m9);ta.Db(Aa);Ca.setValue(H.a.H5,1);ta.dispose()})},null,null)}this.Kzb&&this.Kzb(Aa)}}Vth(sa,Fa){sa.Ae(O.a.A1f,
"false");sa.Ae(O.a.Dnf,this.zCe);sa.Ae(O.a.taf,"0");sa.cJ(X.a.kgb,window.self.devicePixelRatio.toString());void 0!==Fa&&null!==Fa&&(Fa=this.ap.sn(Fa.ik),Fa=this.ap.ui(Fa),sa.Ae(X.a.Ns,I.a[Fa]));this.e9j&&(sa.Ae(X.a.EXd,"true"),sa.Ae(X.a.vym,this.g7j.toString()))}Gnh(sa){if(this.$Tg){sa=sa.ik;var Fa=this.ap.sn(sa);if(!Fa)return null;const Pa=new U.a(this.N2j,Fa),Na=this.Lc.Pc(15,x.a.QSc);Na.Db(sa.node);this.s2i(Fa,!1);Fa.setValue(L.a.Ns,Fa.ja(L.a.Ns,10));Na.Uj=x.a.QSc;Na.mHa(this.Zl,1);Na.dispose();
return Pa}Fa=new a.DictionaryPropertySet;this.s2i(Fa,!0);return(sa=this.Vj.oUh(sa,Fa,this.Zl))&&sa.blob?new U.a(sa.blob.id,sa.blob.properties):null}tUd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}s2i(sa,Fa){sa.setValue(K.a.Kia,k.a.Ql(this.Mfk,0));sa.setValue(K.a.Jia,k.a.Ql(this.Lfk,1));this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!Fa?sa.setValue(H.a.TPa,!0):sa.setValue(M.a.B0,1);sa.setValue(S.a.R4,!0)}YSl(sa,Fa,Pa,Na,Aa,za){const xa=
ka=>{this.bnd.pXo(Pa,ka,sa)};return this.oRi(Na,Aa,sa)?this.K7h(Fa,Aa,za,xa):()=>{xa(Aa)}}ZSl(sa,Fa,Pa,Na,Aa,za){const xa=ka=>{this.bnd.qXo(Pa,ka,sa)};return this.oRi(Na,Aa,sa,Pa)?this.K7h(Fa,Aa,za,xa):()=>xa(Aa)}oRi(sa,Fa,Pa,Na){return sa?!0:Na?n.ImageReader.xTd(Fa,Pa.Mc,!1)!==Na.ZZf:!1}K7h(sa,Fa,Pa,Na){const Aa=E.a.instance.Wfd;Aa.ax(Fa);Aa.id=Pa;return()=>{this.bnd.V4n(sa,Pa,Aa,this.dW,Na)}}Too(sa){this.Kzb=sa}jjo(sa){this.kbb=sa}rsm(sa,Fa){return this.rd.isFeatureEnabled(48)&&(sa.hasProperty(Q.a.lP)&&
!Fa[X.a.PSc]||!sa.hasProperty(Q.a.lP)&&Fa[X.a.PSc])?!0:!1}}Object(D.a)(ua,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[612])},1676:function(D,J,c){D=c(0);var l=c(35),e=c(7),a=c(459),k=c(578),x=c(2001),y=c(2),n=c(19),t=c(258),z=c(1800),v=c(25);class I extends x.a{constructor(H,M,K,L,S,Q,N=null,O=!1){super(H,M,K,L,S,"WACUploadFrame",y.AFrameworkApplication.userSessionId,Q,!1,N,O)}JB(H){return v.StaticActiveAppFrame.za().rj(H)}Lkj(H){t.a.instance.bBb(H)}NKc(){y.AFrameworkApplication.canary&&
this.Z5b(a.a.canary,y.AFrameworkApplication.canary);v.StaticActiveAppFrame.za().jb.activeSection.VH&&this.Z5b(a.a.VH,v.StaticActiveAppFrame.za().jb.activeSection.VH)}GUd(H){let M=null,K;({group:K}=k.a.d2(H)).returnValue?M=K.Responses[0]:e.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return M}Aac(){e.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");
const H=new z.a;H.StatusCode=14;this.hfj(H);this.WBd()}ZMb(H){H?(H=n.a.bxj(H),H=H.replace(RegExp("&amp;","g"),"&"),(H=this.GUd(H))?(this.hfj(H),this.WBd()):this.Aac()):this.Aac()}}Object(D.a)(I,"Box4UploadFrame",x.a,[]);c.d(J,"a",function(){return E});class E extends I{constructor(H,M,K,L,S,Q=null,N=!1){super(H,M,K,L,S,E.xMl(),Q,N);this.hCf()}static xMl(){return E.Qlh.join(",")+","+E.WXe.join(",")}NKc(){super.NKc();this.Z5b(a.a.rsb,"1");this.Z5b(a.a.sTb,"1")}Aac(){super.Aac();e.ULS.sendTraceTag(41697632,
322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}GUd(H){const M=super.GUd(H);if(!M)try{const K=l.a(H);k.a.snf(K)}catch(K){e.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",K.toString())}return M}}E.Qlh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");E.WXe=[".webp"];Object(D.a)(E,"Box4ImageUploadFrame",I,[])},1678:function(D,J,c){D=c(0);class l{}Object(D.a)(l,"AuthContext",null,[]);var e=c(2),a=c(468);c.d(J,
"a",function(){return k});class k{static getAuthContext(){const x=e.AFrameworkApplication.K.kb("UserPrincipalName")||"";let y=x;e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.OAuthManagerSettings.pkn||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,authorityType:k.KQd(),tenantId:e.AFrameworkApplication.K.kb("TenantId")||""})}static KQd(){let x=0;const y=k.P5h();"aad"===y.toLowerCase()?x=2:
"msa"===y.toLowerCase()&&(x=1);return x}static P5h(){return e.AFrameworkApplication.K.kb("HostAuthType")||""}}Object(D.a)(k,"OAuthIdentity",null,[])},1679:function(D,J,c){c.r(J);D=c(0);var l=c(1844),e=c(55),a=c(1846),k=c(451),x=c(1847),y=c(177),n=c(2),t=c(96),z=c(90),v=c(537),I=c(232),E=c(10),H=c(67),M=c(79),K=c(102),L=c(93),S=c(30),Q=c(57),N=c(40),O=c(20),X=c(12);class U{constructor(aa){this.k5d=4;this.nch=0;this.tSg=this.sOg=this.Ldh=this.ATg=this.efh=this.MCa=this.f1b=this.Uw=this.dih=this.GWg=
this.HWg=this.DCa=this.tZa=this.Wze=this.sXa=this.kXa=this.W=this.O6=this.$Aa=null;O.a.Jxa&&(this.k5d=6);this.zv=aa;this.$Z=K.KeyInputManager.ic(M.a.l2,0);this.render()}get containerElement(){return this.W}dispose(){var aa=n.AFrameworkApplication.ta.nD;const ba=n.AFrameworkApplication.ta.oD;aa.uc(E.a.click,this.W,Object(e.a)(this,this.QUi,"onContainerClick"));aa.uc(E.a.wB,this.W,Object(e.a)(this,this.RUi,"onContainerDoubleClick"));ba.uc(E.a.zh,this.W,Object(e.a)(this,this.SUi,"onContainerKeyPress"));
this.kXa&&(aa.uc(E.a.click,this.kXa,Object(e.a)(this,this.FWf,"onDeleteButtonClick")),ba.Vrb(this.kXa,this.tSg));this.sXa&&(aa.uc(E.a.click,this.sXa,Object(e.a)(this,this.NWf,"onDoneButtonClick")),ba.Vrb(this.sXa,this.ATg));this.DCa&&(aa.uc(E.a.click,this.DCa,Object(e.a)(this,this.L8d,"onSaveButtonClick")),ba.Vrb(this.DCa,this.efh));this.$Aa&&(aa.uc(E.a.click,this.$Aa,Object(e.a)(this,this.cWf,"onCancelButtonClick")),ba.Vrb(this.$Aa,this.sOg));this.tZa&&(aa.uc(E.a.click,this.tZa,Object(e.a)(this,
this.JYf,"onReplyButtonClick")),ba.Vrb(this.tZa,this.Ldh));this.Uw&&(ba.uc(E.a.tu,this.Uw,Object(e.a)(this,this.NHa,"onKeyEvent")),ba.uc(E.a.zh,this.Uw,Object(e.a)(this,this.NHa,"onKeyEvent")),O.a.vi&&(aa=n.AFrameworkApplication.ta.Lnc,aa.uc(E.a.IJc,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent")),aa.uc(E.a.q5b,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent")),aa.uc(E.a.r5b,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent"))),v.a.instance.uc(E.a.paste,this.Uw,Object(e.a)(this,
this.G2c,"onPaste")));this.MCa=this.f1b=this.Uw=this.$Aa=this.DCa=this.Wze=this.sXa=this.tZa=this.kXa=this.W=null}focus(){H.FocusManager.instance().jD(y.AFrame.Sr);this.W.focus();this.zv.Yq.Apf().hk.iz(this.W)}e2h(){H.FocusManager.instance().jD(a.a.AJc);this.Uw.focus();this.zv.Yq.Apf().hk.iz(this.Uw);2===this.zv.Zq&&this.Uw.value&&0<this.Uw.value.length&&N.a.W8c(this.Uw);const aa=this.zv.Yq.Oda.D3c,ba=N.a.g3a(aa,this.W);ba.y+this.W.clientHeight>aa.scrollTop+aa.clientHeight&&(aa.scrollTop=ba.y+this.W.clientHeight-
aa.clientHeight)}VFl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.$Aa.style.display="none";this.Uw.style.display="none";H.FocusManager.iog(this.Uw);H.FocusManager.iog(this.DCa);H.FocusManager.instance().fe(a.a.AJc).mr(this.$Z);H.FocusManager.instance().q7a(a.a.AJc);K.KeyInputManager.instance.uc(E.a.tu,this.Uw,Object(e.a)(this,this.NHa,"onKeyEvent"));K.KeyInputManager.instance.uc(E.a.zh,this.Uw,Object(e.a)(this,this.NHa,"onKeyEvent"));if(O.a.vi){const aa=n.AFrameworkApplication.ta.Lnc;
aa.uc(E.a.IJc,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent"));aa.uc(E.a.q5b,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent"));aa.uc(E.a.r5b,this.Uw,Object(e.a)(this,this.IHa,"onCompositionEvent"))}v.a.instance.uc(E.a.paste,this.Uw,Object(e.a)(this,this.G2c,"onPaste"));this.O6.removeChild(this.Uw);this.O6.removeChild(this.f1b);this.MCa=this.f1b=this.Uw=null;this.tqg();this.Xdd();this.focus()}Xdd(){this.adj(this.dih,this.HWg,this.GWg,this.Wze,this.W)}render(){var aa=k.a("a",this.Via("cc"),
"CommentContainer");S.a.kr(aa,S.a.zga,a.a.c3k);aa.tabIndex=0;this.zv.Df&&(aa.className+=" Reply1");var ba=k.a("div",this.Via("ch"),"CommentHeaderRow");const oa=k.a("span",this.Via("ca"),"CommentAuthor UIFontBold");oa.innerText=this.zv.author;ba.appendChild(oa);const ma=k.a("span",this.Via("ct"),"CommentDate");ma.innerText=U.Cil(this.zv.date,this.zv.Yq.Bil,this.zv.Yq.fLo);Sys.UI.DomElement.addCssClass(ma,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");ba.appendChild(ma);const ea=k.a("span",
this.Via("ci"),"CommentStatusIcon");ba.appendChild(ea);let ua=null;this.zv.gJb&&(ua=x.a.V0a(this.Via("cl"),a.a.e2k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ua,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ua.tabIndex=0,ba.appendChild(ua));this.O6=k.a("div",this.Via("cn"),"CommentContent");let sa=null,Fa=null,Pa=null;this.zv.gJb?(sa=k.a("textarea",this.Via("ce"),a.a.HHh+" UIFont"),sa.rows=this.k5d,sa.cols=50,sa.tabIndex=0,S.a.kr(sa,
"title",CommonUIStrings.l_CommentContent),this.O6.appendChild(sa),Fa=k.a("div","","CommentTextMeasurementContainer"),Pa=k.a("textarea","",a.a.HHh+" UIFont"),Pa.rows=1,Pa.cols=50,Pa.style.visibility="hidden",Pa.spellcheck=!1,Fa.appendChild(Pa),this.O6.appendChild(Fa),2===this.zv.Zq&&(sa.value=this.zv.text.join("\n")+"\n")):this.tqg();const Na=k.a("div","","CommentFooterRow"),Aa=k.a("span",this.Via("cf"),""),za=x.a.V0a(this.Via("cr"),a.a.X2k+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,
"CommentReply_16x16x32",!1);za.tabIndex=0;za.setAttribute(S.a.uh,S.a.Z3);Aa.appendChild(za);const xa=x.a.V0a(this.Via("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);xa.tabIndex=0;const ka=xa.childNodes[0].childNodes[0];Aa.appendChild(xa);const wa=x.a.V0a(this.Via("cx"),a.a.g2k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);xa.tabIndex=0;Aa.appendChild(wa);Na.appendChild(Aa);const ia=k.a("span",
this.Via("cfa"),""),va=x.a.V0a(this.Via("cs"),a.a.Y2k,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.jQb(va,!1);va.tabIndex=0;ia.appendChild(va);Na.appendChild(ia);this.adj(ea,Aa,ia,ka,aa);this.zv.Yq.TKh||(oa.setAttribute("Unselectable","on"),ma.setAttribute("Unselectable","on"));aa.appendChild(ba);aa.appendChild(this.O6);aa.appendChild(Na);this.W=aa;this.sXa=xa;this.Wze=ka;this.kXa=wa;this.tZa=za;this.DCa=va;this.Uw=sa;this.f1b=Fa;this.MCa=Pa;this.$Aa=ua;this.HWg=Aa;this.GWg=ia;this.dih=ea;
aa=n.AFrameworkApplication.ta.nD;ba=n.AFrameworkApplication.ta.oD;aa.ob(E.a.click,this.W,Object(e.a)(this,this.QUi,"onContainerClick"));aa.ob(E.a.wB,this.W,Object(e.a)(this,this.RUi,"onContainerDoubleClick"));ba.ob(E.a.zh,this.W,Object(e.a)(this,this.SUi,"onContainerKeyPress"));this.sXa&&(aa.ob(E.a.click,this.sXa,Object(e.a)(this,this.NWf,"onDoneButtonClick")),this.ATg=ba.fpb(this.sXa,Object(e.a)(this,this.NWf,"onDoneButtonClick"),M.a.Rs));this.tZa&&(aa.ob(E.a.click,this.tZa,Object(e.a)(this,this.JYf,
"onReplyButtonClick")),this.Ldh=ba.fpb(this.tZa,Object(e.a)(this,this.JYf,"onReplyButtonClick"),M.a.Rs));this.DCa&&(aa.ob(E.a.click,this.DCa,Object(e.a)(this,this.L8d,"onSaveButtonClick")),this.efh=ba.fpb(this.DCa,Object(e.a)(this,this.L8d,"onSaveButtonClick"),M.a.Rs));this.kXa&&(aa.ob(E.a.click,this.kXa,Object(e.a)(this,this.FWf,"onDeleteButtonClick")),this.tSg=ba.fpb(this.kXa,Object(e.a)(this,this.FWf,"onDeleteButtonClick"),M.a.Rs));this.$Aa&&(aa.ob(E.a.click,this.$Aa,Object(e.a)(this,this.cWf,
"onCancelButtonClick")),this.sOg=ba.fpb(this.$Aa,Object(e.a)(this,this.cWf,"onCancelButtonClick"),M.a.Rs));sa&&(ba.ob(E.a.tu,sa,Object(e.a)(this,this.NHa,"onKeyEvent")),ba.ob(E.a.zh,sa,Object(e.a)(this,this.NHa,"onKeyEvent")),O.a.vi&&(aa=n.AFrameworkApplication.ta.Lnc,aa.ob(E.a.IJc,sa,Object(e.a)(this,this.IHa,"onCompositionEvent"),null),aa.ob(E.a.q5b,sa,Object(e.a)(this,this.IHa,"onCompositionEvent"),null),aa.ob(E.a.r5b,sa,Object(e.a)(this,this.IHa,"onCompositionEvent"),null)),v.a.instance.ob(E.a.paste,
sa,Object(e.a)(this,this.G2c,"onPaste")),this.kro())}Nnj(aa){x.a.jQb(this.DCa,aa)}Via(aa){return aa+"_"+this.zv.id}adj(aa,ba,oa,ma,ea){switch(this.zv.pUa){case 0:case 1:this.Btj(aa,0);break;case 2:case 4:aa.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ea,"SaveFailure"),Sys.UI.DomElement.addCssClass(ea,"NoReply"),this.Btj(aa,1)}this.zv.done?(Sys.UI.DomElement.addCssClass(ea,"CommentIsDone"),ma.className=z.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(ea,
"CommentIsDone"),ma.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.zv.gJb?(Sys.UI.DomElement.addCssClass(ea,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ea,"SelectedComment"),aa.style.display="none",ba.style.display="none",oa.style.display="inline",0===this.zv.Yq.mode&&(this.Nnj(!1),x.a.jQb(this.$Aa,!1))):(1===this.zv.$ja?(Sys.UI.DomElement.addCssClass(ea,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ea,"SelectedParentComment"),ba.style.display=1!==this.zv.Yq.mode||3===this.zv.pUa||
this.zv.IRa?"none":"inline"):(2===this.zv.$ja?(Sys.UI.DomElement.removeCssClass(ea,"SelectedComment"),Sys.UI.DomElement.addCssClass(ea,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ea,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ea,"SelectedParentComment")),ba.style.display="inline"),oa.style.display="none")}Btj(aa,ba){Q.a.MD(aa);switch(ba){case 0:ba=document.createElement("img");ba.alt=CommonUIStrings.l_CommentProgressTooltip;ba.src=t.a.Sba("progress16.gif");aa.appendChild(ba);
break;case 1:ba=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),aa.appendChild(ba)}aa.style.display="inline-block"}tqg(){Q.a.RQ(this.O6);var aa=this.zv.text;1===aa.length&&aa[0]&&(aa=aa[0].split("\n"));for(const ba of aa)aa=k.a("p","","CommentContentPara"),aa.innerText=ba||"\u00a0",this.zv.Yq.TKh||aa.setAttribute("Unselectable","on"),this.O6.appendChild(aa)}kro(){const aa=H.FocusManager.instance().fe(a.a.AJc);aa.parent=y.AFrame.Sr;I.a.instance.w2b(a.a.AJc,
this.Uw);aa.bindAction(K.KeyInputManager.ic(M.a.hse,2),X.a.Jg);aa.bindAction(this.$Z,X.a.G9e);aa.bindAction(K.KeyInputManager.ic(M.a.w6,0),X.a.C1a);aa.bindAction(K.KeyInputManager.ic(M.a.Oea,0),X.a.C1a);aa.mr(H.FocusManager.instance().YW);aa.mr(H.FocusManager.instance().ZW)}QUi(aa){if(this.zv.gJb&&aa.Hb.target===this.Uw)return!0;this.zv.XYf();return!0}RUi(){this.zv.uVi();return!0}SUi(aa){let ba=!1;aa.Hb.keyCode===M.a.Rs&&(0===this.zv.$ja?this.zv.XYf():this.zv.uVi(),ba=!0);return ba}FWf(){if(this.kXa.disabled)return!0;
this.zv.eja();return!0}NWf(){if(this.sXa.disabled)return!0;this.zv.ewn();return!0}JYf(){if(this.tZa.disabled)return!0;this.zv.Ttn();return!0}L8d(){if(this.DCa.disabled)return!0;this.zv.VMb(this.Uw.value);return!0}cWf(){if(this.$Aa.disabled)return!0;this.zv.vMb();return!0}NHa(aa){if(aa.Hb.ctrlKey&&aa.Hb.keyCode===M.a.Rs)return 0<this.Uw.value.length&&this.L8d(null),!0;if(aa.Hb.keyCode===M.a.l2)return!0;this.onTextEntered(aa.eventName===E.a.tu&&aa.Hb.charCode===M.a.Rs);return!1}IHa(){this.onTextEntered(!1);
return!1}G2c(){const aa=new L.a(0,1,0,()=>{this.onTextEntered(!1)},1);n.AFrameworkApplication.lc.Wb(aa);return!1}onTextEntered(aa){if(0!==this.zv.Yq.mode&&(this.Nnj(0<this.Uw.value.length),!O.a.Jxa)){this.f1b.clientWidth!==this.Uw.clientWidth&&(this.f1b.style.width=this.Uw.clientWidth+"px");this.MCa.value=this.Uw.value+"___";this.nch>this.Uw.value.length&&(this.MCa.rows=1);for(var ba=0,oa=Number.MAX_VALUE;1<=(ba=this.MCa.scrollHeight-this.MCa.clientHeight)&&ba<oa;)oa=ba,this.MCa.rows++;this.MCa.rows<
this.k5d?this.Uw.rows=this.k5d:(aa&&this.MCa.rows++,this.Uw.rows=this.MCa.rows);this.nch=this.Uw.value.length}}static Cil(aa,ba,oa){if(!aa||isNaN(aa.getDate()))return"";let ma=oa;const ea=new Date;if(ea.getFullYear()!==aa.getFullYear()||ea.getMonth()!==aa.getMonth()||ea.getDate()!==aa.getDate())ma=String.format(CommonUIStrings.l_CommentLongDateFormat,ba,oa);return aa.localeFormat(ma)}}Object(D.a)(U,"CommentViewObject",null,[10,1296]);var T=c(139);c.d(J,"Comment",function(){return Y});class Y{constructor(aa,
ba,oa,ma,ea,ua,sa,Fa,Pa=!1,Na=null,Aa=null,za=null){this.TLg=this.ULg=this.WTg=null;this.Uwd=0;this.Mdb=2;this.fBa=0;this.dAe=this.nO=null;this.TGf=!1;this.objectId=null;this.IRa=!1;this._id=aa;this.gYg=ba;this.GMg=oa;this.ekd=ma;this.Lvd=ea;this.sLa=ua;this.dO=sa;this.eYg=Fa;this.uJh=Pa;this.vXj=Na;this.wXj=Aa;this.usersByReactionType=za;this.gj=l.a.instance}get id(){return this._id}set id(aa){this._id=aa}get author(){return this.Y0d?CommonUIStrings.l_RemovedAuthorName:this.GMg}get authorId(){return this.vXj}get I3b(){return this.wXj}get date(){return this.Y0d?
null:this.ekd}set date(aa){this.ekd=aa}get done(){return this.sLa}set done(aa){this.sLa!==aa&&(this.sLa=aa,this.nO&&this.nO.Xdd())}get emi(){return this.eYg}set emi(aa){this.eYg=aa}get Df(){return this.Lvd}set Df(aa){this.Lvd=aa}get text(){return this.dO}set text(aa){this.dO=aa;this.nO&&this.nO.tqg()}get fxa(){return this.gYg}set fxa(aa){this.gYg=aa}get H1a(){return this.WTg}set H1a(aa){this.WTg=aa}get HGc(){return this.ULg}set HGc(aa){this.ULg=aa}get GGc(){return this.TLg}set GGc(aa){this.TLg=aa}get $ja(){return this.Uwd}set $ja(aa){this.Uwd!==
aa&&(this.Uwd=aa,this.nO&&this.nO.Xdd())}get pUa(){return this.Mdb}set pUa(aa){this.Mdb===aa||0===this.Mdb&&2===aa||3===this.Mdb||(this.Mdb=aa,this.nO&&this.nO.Xdd())}get Zq(){return this.fBa}set Zq(aa){if(this.fBa!==aa){const ba=this.gJb&&0===aa;this.fBa=aa;ba&&this.nO&&this.nO.VFl()}}get gJb(){return 1===this.fBa||2===this.fBa}get Y0d(){return!!this.gj&&this.gj.aea}get containerElement(){return this.nO?this.nO.containerElement:null}get Yq(){return this.gj}get Cz(){return this.dAe}set Cz(aa){this.dAe=
aa}dispose(){this.nO&&(this.nO.dispose(),this.nO=null)}render(){this.nO=new U(this);return this.nO.containerElement}X5a(){this.nO&&this.nO.Xdd()}focus(){this.XYf();this.nO.focus();this.gJb&&this.nO.e2h()}toString(){let aa="[null]";this.dO&&0<this.dO.length&&(aa=30<this.dO[0].length?this.dO[0].substr(0,30)+"...":this.dO[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.GMg||"[null]",this.ekd?this.ekd.toString():"[null]",this.Lvd||"[null]",this.sLa,aa)}XYf(){2===
this.Yq.mode||3===this.Yq.mode?this.gJb&&this.nO.e2h():(H.FocusManager.instance().jD(y.AFrame.Sr),1!==this.Uwd&&this.Yq.selectComment(this._id))}uVi(){this.Yq.qGo&&0===this.fBa&&(H.FocusManager.instance().jD(y.AFrame.Sr),this.fBa=2,this.Mdb=0,this.Yq.editComment(this,null))}Gon(){3===this.Yq.mode&&(H.FocusManager.instance().jD(y.AFrame.Sr),this.fBa=0,this.Mdb=2,this.Yq.g7e())}eja(){H.FocusManager.instance().jD(y.AFrame.Sr);this.Yq.deleteComment(this)}ewn(){this.Yq.qCb(this,!this.sLa)}Ttn(){2!==this.Yq.mode&&
(H.FocusManager.instance().jD(y.AFrame.Sr),this.Yq.addReply(this.Lvd||this._id,null))}VMb(aa){H.FocusManager.instance().jD(y.AFrame.Sr);this.dO=Array(1);this.dO[0]=aa;1===this.fBa?this.Yq.uva(this):this.Yq.wgb(this)}vMb(){H.FocusManager.instance().jD(y.AFrame.Sr);this.Yq.Oda.D3c&&this.Yq.Oda.D3c.focus();1===this.fBa?(this.Yq.deleteComment(this),this.Yq.$fe(this.Df)):this.Gon()}static ULh(aa,ba,oa,ma){const ea=T.a.create().toString();aa=new Y(ea,Y.Tnm,aa,new Date,ba,!1,[],oa,!1,n.AFrameworkApplication.K.kb("PresenceUserId"),
n.AFrameworkApplication.K.kb("PresenceProvider"));aa.fBa=1;aa.Mdb=0;aa.dAe=ma;return aa}}Y.Tnm=null;Y.q0i=-1;Object(D.a)(Y,"Comment",null,[10,776])},1680:function(D,J,c){D=c(0);var l=c(1231),e=c(2068),a=c(1106),k=c(8),x=c(104),y=c(44),n=c(28),t=c(23),z=c(307),v=c(774),I=c(949),E=c(61),H=c(2),M=c(782),K=c(20),L=c(79),S=c(400),Q=c(760),N=c(19),O=c(14),X=c(7),U=c(372),T=c(870),Y=c(371),aa=c(871),ba=c(509),oa=c(1058),ma=c(32);class ea{constructor(){this.fNe=void 0}onKeyPressed(xa){return this.fNe?this.fNe(xa):
!1}setKeyPressHandler(xa){this.fNe=xa}}var ua=c(1469),sa=c(1651),Fa=c(1557),Pa=c(1545);c.d(J,"a",function(){return za});var Na;(function(xa){xa[xa.nNj=0]="ArrowDown";xa[xa.oNj=1]="ArrowUp";xa[xa.n$o=2]="ArrowLeft";xa[xa.o$o=3]="ArrowRight";xa[xa.End=4]="End";xa[xa.jPj=5]="Enter";xa[xa.Cap=6]="Escape";xa[xa.HPj=7]="Home";xa[xa.udp=8]="Space";xa[xa.Tab=9]="Tab"})(Na||(Na={}));Object(D.b)("KeyIdentifier",Na);var Aa;(function(xa){xa.Seen="Seen";xa.Tried="Tried";xa.Kept="Kept";xa.Rejected="Rejected"})(Aa||
(Aa={}));Object(D.b)("EngagementType",Aa);class za extends I.a{constructor(xa,ka,wa,ia,va,na,Ca,ta,fa,Xa,ob,xb,zb,Lb,Ia,Ya,eb,sb,lc){super();this.ga=xa;this.Je=ka;this.Md=wa;this.zD=ia;this.hb=va;this.MI=na;this.nB=Ca;this.$V=ta;this.YBa=fa;this.YI=ob;this.PK=xb;this.pCa=zb;this.aWj=Lb;this.fn=Ia;this.ld=Ya;this.rC=eb;this.aG=sb;this.Lc=lc;this.Fkk=0;this.aTe=!1;this.TKe=1E3;this.Ikk=3500;this.Mxd="ContextIQSignalId";this.CTe=0;this.x1g=!0;this.$na=()=>{this.YBa.reset();this.R4m()};this.r2c=(vb,Eb)=>
{for(const Ua of Eb.Qj)vb=Ua.intent,8===vb.type&&(0<=Ua.UKb?(vb=vb.Lb.paragraph,Eb=this.fn.j$b(vb,8,Ua.cpBegin,Ua.cpEnd),1<=Eb.count&&Eb.J(0)&&(Eb=vb.characterData.indexOf("@",Eb.J(0).Bc),this.fn.Zog(vb,Ua.cpBegin,Ua.cpEnd),Eb=new l.a(8,Eb,Eb+1,E.a.create()),this.fn.nHa(vb,Eb))):this.WBa.Sv(O.a.laf,!0,void 0,void 0,void 0,void 0))};Xa&&Xa.execute(vb=>this.ima=vb);this.WBa=new oa.a;this.a4g=new ea;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.D4h(!0);this.f4h();this.Md.z0e(this.r2c);
this.aWj.gpb(this);this.xfa=[new e.a(Pa.a.gfb,Pa.a.gfb)]}onSessionClose(){}onSessionConnect(){this.D4h(!1);this.f4h()}onSessionDisconnect(){}get gIb(){return this.xfa}static hDk(xa){return xa.results&&0!==xa.results.length?xa.results[0].entityType===aa.EntityType.Topic:!1}static pDi(xa){return za.lOj()&&Fa.a.LWc(xa)&&this.hDk(xa)?!0:za.kOj()?xa.isStealth:!1}static jSd(xa){var ka,wa;if(0!==(null===(ka=null===xa||void 0===xa?void 0:xa.results)||void 0===ka?void 0:ka.length))return null===(wa=null===
xa||void 0===xa?void 0:xa.results[0])||void 0===wa?void 0:wa.entityType}BRa(xa,ka){return Fa.a.BRa(xa,ka,ba.a.hgb)}c1a(xa,ka){xa=Fa.a.p9b(xa,!1,ba.a.hgb);if(!xa||!xa.contains(ka))return null;ka=this.Je.Gha(ka);return za.pDi(null===ka||void 0===ka?void 0:ka.content)?Pa.a.TCd:Pa.a.gfb}jpb(xa){za.Kfd()&&!this.Ev&&(this.Ev=xa,this.pCa.nDa((ka,wa)=>{ka=wa.paragraphNode;const ia=wa.Ija;for(const va of wa.contents)1!=va.DG&&0!=va.DG||Fa.a.Fyf(va.element,ka,va.intents,this.KGc,this.Nza,this.PK,this.Ev,ia,
!1,ba.a.hgb)}))}f4h(){const xa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),ka=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),wa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),ia=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),va=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",
!1),na=za.Lfd()&&za.oEf?void 0:[Object.assign(new aa.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],Ca=Object.assign(new T.a,{parentPath:["Signal",aa.ClientConfigSignal.getTypeName()],items:[Object.assign(new U.a,{id:"ClientConfigSignal",body:Object.assign(new aa.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new aa.SessionConfig,{clientConfig:Object.assign(new aa.ClientConfig,{ecc:Object.assign(new aa.EccConfig,
{enabled:za.Mfd()||za.Lfd(),entities:[Object.assign(new aa.EccEntityConfig,{entityType:aa.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:na}),Object.assign(new aa.EccEntityConfig,{entityType:aa.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new aa.EccEntityConfig,{entityType:aa.EntityType.Loop,enabled:xa,queryPrefix:["@"]})],bestMatch:Object.assign(new aa.BestMatchConfig,{enabled:za.Qtg()}),scopes:Object.assign(new aa.ScopeConfig,{enabled:!1})}),flag:Object.assign(new aa.FlagConfig,
{enabled:za.Kfd(),entities:[Object.assign(new aa.EntityConfig,{entityType:aa.EntityType.Loop,enabled:xa&&va}),Object.assign(new aa.EntityConfig,{entityType:aa.EntityType.Topic,enabled:ia}),Object.assign(new aa.EntityConfig,{entityType:aa.EntityType.Address,enabled:wa}),Object.assign(new aa.EntityConfig,{entityType:aa.EntityType.Satori,enabled:ka})]}),nudge:Object.assign(new aa.NudgeConfig,{enabled:!1}),prediction:Object.assign(new aa.PredictionConfig,{enabled:!1})})})})})]});this.nB.ll().then(()=>
{this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:Ca}));X.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}D4h(xa){const ka=Object.assign(new T.a,{parentPath:["Signal",aa.StartupSignal.getTypeName()],items:[Object.assign(new U.a,{id:"SessionStartupSignal",body:Object.assign(new aa.StartupSignal,{timestamp:Date.now()})})]});this.nB.ll().then(()=>{xa&&this.fC();this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,
{operation:ka}));X.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}fC(){za.Mfd()&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Je.ob(this,aa.EccResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Je.ob(this,aa.UserInitiatedResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));
za.Kfd()&&(this.Je.ob(this,aa.FlagResultAnnotation.getTypeName()),X.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}iVo(xa,ka,wa,ia,va){const na=void 0===ka?!1:this.CTe>ka;this.Xi.fE&&!na&&(xa=this.j4h(xa),ia&&xa.suggestionGroups&&0<xa.suggestionGroups.length&&(xa.suggestionGroups[0].previewData=ia.substring(va+1,ia.length)),this.Xi.definition=xa,ka&&(this.CTe=ka));ka?(ia=Date.now(),wa=[Object.assign(new ma.a,{name:this.Mxd,string:wa}),Object.assign(new ma.a,{name:"ContextIQMenuOpen",
bool:this.Xi.fE}),Object.assign(new ma.a,{name:"ContextIQStaleAnnotation",bool:na})],this.WBa.I_c("ContextIQUserInitUserPerceivedLatency",ia-ka,1,!0,void 0,wa)):X.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}j4h(xa){if(xa){var ka=[],wa=[];switch(xa.annotationType){case aa.UserInitiatedResultAnnotation.getTypeName():var ia=xa.content;if(!ia)return;for(var va of ia.results)ka=ka.concat(va.results);
ia=ba.a.y0a;break;case aa.EccResultAnnotation.getTypeName():va=xa.content;if(!va)return;for(const na of va.entityResults)ka=ka.concat(na.entities);za.Qtg()&&(wa=null===(ia=va.treatments)||void 0===ia?void 0:ia.bestMatchEntries);ia=ba.a.y0a;break;case aa.FlagAnnotation.getTypeName():ka=ka.concat(xa.content.results);ia=ba.a.hgb;break;default:return}xa={annotationId:xa.id,results:ka,bestMatchResults:wa};if(ka=this.x1g)this.x1g=!1;return{...z.g,id:ia,suggestionGroups:[{type:ia,isContentPending:!1,contentData:xa,
isFirstInvoke:ka}]}}}async getPersonImageUrl(xa,ka){xa=new M.a(xa,"O365",ka,xa);if(this.ima&&this.ima.getPersonaIconPropertiesArray&&(xa=await this.ima.getPersonaIconPropertiesArray([xa]),0<xa.length&&xa[0].authorImageURL))return xa[0].authorImageURL}static Tqe(){return za.Mfd()||za.Kfd()}static Mfd(){return za.Mqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static Lfd(){return za.Mqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",
!1)}static Kfd(){return za.Mqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",!1)}static kOj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static jOj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",!1)}static Qtg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",
!1)}static lOj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlagsLimitIsEnabled",!1)}static Mqe(){return!K.a.lda&&!K.a.Q4}static get z8a(){return za.Hkk}xzo(xa){if(this.ima){var ka={...z.g,id:ba.a.y0a,suggestionGroups:[{type:ba.a.y0a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},wa=!1;this.ga.l0(O.a.SUa)&&(wa=!0);this.Xi.mka(xa,ka,this,!0,!1,null,this.$na,null,!1,ia=>{ia.shouldIgnoreFocusEvent=va=>{var na;return this.aTe?!0:
va===(null===(na=this.ld.we)||void 0===na?void 0:na.editingElement)};ia.getPersonImageUrl=this.getPersonImageUrl},wa,!1,this.a4g)}else X.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}fGh(){this.Xi.dismiss()}onKeyDown(xa){if(xa&&xa.Hb){switch(xa.Hb.keyCode){case L.a.Oea:var ka=Na.nNj;break;case L.a.RL:ka=Na.End;break;case L.a.Rs:ka=Na.jPj;break;case L.a.v6:ka=Na.HPj;break;case L.a.Kw:ka=Na.Tab;break;case L.a.w6:ka=Na.oNj}void 0!==ka&&
(xa.Hb.stopPropagation(),xa.Hb.preventDefault(),this.a4g.onKeyPressed(ka))}}KB(xa,ka){if(xa&&xa.content&&ka===v.a.getTypeName()&&(xa.annotationType===aa.UserInitiatedResultAnnotation.getTypeName()||xa.annotationType===aa.EccResultAnnotation.getTypeName())){var wa=ka=void 0,ia=void 0,va=0,na=xa.parentPath.split("\\");if(na&&6===na.length)if(wa=na[5],na=Date.now(),wa in za.z8a){clearTimeout(za.z8a[wa].wLo);ka=za.z8a[wa].startTime;ia=za.z8a[wa].Ozo;va=za.z8a[wa].eEd;delete za.z8a[wa];const Ca=[Object.assign(new ma.a,
{name:this.Mxd,string:wa})];this.WBa.I_c("ContextIQUserInitALLatency",na-ka,1,!0,void 0,Ca)}else X.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else X.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.iVo(xa,ka,wa,ia,va)}}get types(){return[ba.a.y0a,ba.a.hgb]}Cpg(xa,ka){this.Xi.fE&&this.Xi.Cpg(xa,ka)}get KGc(){return!S.SessionStatusManager.instance.Yj&&
1!=H.AFrameworkApplication.ta.mode}Nza(xa){return xa&&Fa.a.LWc(xa)?!sa.a.f3b(xa):!1}DN(xa){if(za.Tqe()){var ka,wa;if(S.SessionStatusManager.instance.Yj||!this.KGc||!({annotation:ka,W1e:wa}=this.PK.xOd(xa.ul,xa.Rjf,this.Nza)).returnValue)return!1;if(ka.annotationType===aa.FlagAnnotation.getTypeName()){let ia=!1;this.ga.l0(O.a.SUa)&&(ia=!0);const va=this.j4h(ka);xa=this.Xi.mka(wa,va,this,xa.hSa,xa.pPa,null,na=>{(null===na||void 0===na?void 0:na.cardType)===ba.a.hgb&&(null===na||void 0===na?0:na.eOf)&&
this.WBa.Sv(O.a.BId,!0,void 0,void 0,void 0,void 0,{Mif:Aa.Tried,entityType:za.jSd(ka.content)})},null,!1,null,ia);this.Xi.mQb({eOf:!0,cardType:ba.a.hgb});xa&&this.WBa.Sv(O.a.BId,!0,void 0,void 0,void 0,void 0,{Mif:Aa.Seen,entityType:za.jSd(ka.content)});return xa}return!1}}XQo(xa,ka){this.Je.qAa(xa,70);const wa=this.rC.h8h(xa,0);if(wa){const ia=new a.a;ia.contentDescriptor=wa;ia.annotationType=xa.annotationType;ia.state=70;this.aG.setState(ka,ia)}}executeAction(xa,ka,wa,ia){var va,na,Ca,ta=Date.now();
if(!ka)return!1;var fa=null===(va=this.Xi.definition)||void 0===va?void 0:va.id;switch(xa.actionType){case z.b.Apply:this.Xi.mQb({cardType:fa,eOf:!1});this.YVd(xa.descriptorData,ka,wa,ia);fa===ba.a.hgb&&(ka={Mif:Aa.Kept,entityType:za.jSd(null===(na=this.Je.Gha(xa.descriptorData.annotationId))||void 0===na?void 0:na.content)},this.WBa.Sv(O.a.BId,!0,void 0,void 0,void 0,void 0,ka));this.fGh();break;case z.b.ClearSearch:this.aTe=!0;this.clearSearch(ka,wa,ia,!1);this.Xi.fE&&(this.dtj(),fa=k.ParagraphReader.text(ka).substring(0,
wa+1),this.Unf(ka,fa,wa,ta));this.aTe=!1;break;case z.b.Retry:this.Xi.fE&&(this.dtj(),fa=k.ParagraphReader.text(ka).substring(0,ia),this.Unf(ka,fa,wa,ta));break;case z.b.OpenEditorPane:if(32!==this.ga.processAction(O.a.SUa,2))return X.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",xa.actionType),!1;break;case z.b.IgnoreOnce:if(!za.jOj)return!1;wa=this.Je.Gha(null===(Ca=xa.descriptorData)||void 0===Ca?void 0:Ca.annotationId);this.XQo(wa,ka.Mc);ta=this.Lc.Pc(3);
try{ta.Db(ka),ka.nl(16,!0)}finally{ta&&ta.dispose()}this.WBa.Sv(O.a.BId,!0,void 0,void 0,void 0,void 0,{Mif:Aa.Rejected,entityType:za.jSd(wa.content)});this.Xi.mQb({eOf:!1,cardType:fa});this.Xi.dismiss();break;default:return X.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",xa.actionType),!1}return!0}Unf(xa,ka,wa,ia){var va,na;const Ca=wa.toString(),ta=xa.id.toString(),fa=ta+"-"+Ca;var Xa=++this.Fkk;const ob=fa+"-"+Xa;Xa=(Xa=x.FormattingReader.gSd(xa,
wa,k.ParagraphReader.textLength(xa)))?x.FormattingReader.language(Xa):H.AFrameworkApplication.lcid;Xa=null!==(na=null===(va=Q.a.ug(Xa))||void 0===va?void 0:va.bQd)&&void 0!==na?na:"";ka.length>this.TKe&&(wa-=ka.length-this.TKe,ka=ka.slice(-this.TKe));const xb=Object.assign(new T.a,{parentPath:["Signal",ua.a.getTypeName(),ta,Ca,fa],items:[Object.assign(new U.a,{id:ob,body:Object.assign(new ua.a,{languageId:Xa,startOfSentence:!0,text:ka,timestamp:Date.now(),userInitQuery:!0})})]});this.nB.ll().then(()=>
{this.$V.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:xb}));X.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const zb=[Object.assign(new ma.a,{name:this.Mxd,string:ob})];this.WBa.I_c("ContextIQUserInitSignalGenerationLatency",Date.now()-ia,1,!0,void 0,zb)});"@"===ka.slice(-1)&&wa===ka.length-1&&(va=this.fn.j$b(xa,8,wa,wa))&&0===va.count&&(va=new l.a(8,wa,wa+1,E.a.create()),this.fn.nHa(xa,va));xa=setTimeout(()=>{this.kxo(ob)},this.Ikk);za.z8a[ob]=
{startTime:ia,Ozo:ka,eEd:wa,wLo:xa}}ZXo(){if(this.Xi.fE&&this.Xi.definition&&this.Xi.definition.suggestionGroups&&this.Xi.definition.suggestionGroups[0]){const xa=this.Xi.definition;xa.suggestionGroups[0].isContentPending=!0;this.Xi.definition=xa}}dtj(){this.Xi.definition={...z.g,id:ba.a.y0a,suggestionGroups:[{type:ba.a.y0a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}kxo(xa){if(xa in za.z8a){var ka=za.z8a[xa].startTime;ka=void 0===ka?!1:this.CTe>ka;!ka&&this.Xi.fE&&(this.Xi.definition=
{...z.g,id:ba.a.y0a,suggestionGroups:[{type:ba.a.y0a,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});xa=[Object.assign(new ma.a,{name:this.Mxd,string:xa}),Object.assign(new ma.a,{name:"ContextIQMenuOpen",bool:this.Xi.fE}),Object.assign(new ma.a,{name:"ContextIQStaleSignal",bool:ka})];this.WBa.I_c("ContextIQUserInitALTimeout",1,0,!0,void 0,xa)}}YVd(xa,ka,wa,ia){var va=xa.type;switch(va){case aa.EntityType.File:this.insertHyperlink(ka,
wa,ia,xa.fileName,xa.url+"?web=1");break;case aa.EntityType.People:za.oEf?this.insertHyperlink(ka,wa,ia,xa.displayName,"mailto:"+xa.primaryEmailAddress):this.CQo(xa,ka,wa,ia);break;case aa.EntityType.Loop:this.zEm(xa,ka,wa,ia);break;case aa.EntityType.Address:this.zDm(xa,ka,wa,ia);break;case aa.EntityType.Satori:va="https://www.bing.com/search?q="+xa.title.replace(" ","+");this.insertHyperlink(ka,wa,ia,xa.title,va);break;case aa.EntityType.Topic:this.insertHyperlink(ka,wa,ia,xa.title,xa.url);break;
default:X.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",va)}}CQo(xa,ka,wa,ia){const va=xa.primaryEmailAddress,na=new M.a(va,"O365",xa.displayName,va);this.ima.checkUserAccess(na).then(Ca=>{Ca.UserCanWrite?(X.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.rVc(ka,wa,ia,na)):this.hDj(na,ka,wa,ia)},()=>{X.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");
this.hDj(na,ka,wa,ia)})}hDj(xa,ka,wa,ia){this.ima.grantUsersAccess([xa]).then(va=>{let na=!1;va.Details&&(na=va.Details.Result[0].UserCanWrite);na?(X.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.rVc(ka,wa,ia,xa)):(X.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ka,wa,ia,!0))},()=>{X.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}rVc(xa,ka,wa,ia){this.fn.Zog(xa,
ka,wa);this.WBa.Sv(O.a.laf,!0,void 0,void 0,void 0,void 0);this.MI.rVc(xa,ka,wa,ia.DisplayName,ia.Email)}insertHyperlink(xa,ka,wa,ia,va){if(xa){var na=new y.GraphTransaction(15),Ca=ia+" ";try{na.Db(xa);this.fn.Zog(xa,ka,wa);this.WBa.Sv(O.a.laf,!0,void 0,void 0,void 0,void 0);this.Md.Ge(n.a.createTextRange(xa,ka,wa),Ca);const ta=N.a.ibc(va);this.zD.fF(n.a.createTextRange(xa,ka,ka+ia.length),ta,!1,!1,!1);this.hb.Ac(t.SelectionFactory.ne(xa,ka+Ca.length))}finally{na&&na.dispose()}}else X.ULS.sendTraceTag(509612897,
3034,15,"Paragraph node is undefined/null.")}zEm(xa,ka,wa,ia){if(ka){var va=new y.GraphTransaction(15);try{va.Db(ka);this.Md.Ge(n.a.createTextRange(ka,wa,ia),"");this.hb.Ac(t.SelectionFactory.ne(ka,wa));const na=xa.id;na===ba.a.F9m?this.ga.processAction(O.a.yVc,2):na===ba.a.C9m?this.ga.processAction(O.a.kVc,2):na===ba.a.E9m?this.ga.processAction(O.a.wYd,2):X.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{va&&va.dispose()}}else X.ULS.sendTraceTag(537458135,3034,
15,"Paragraph node is undefined/null.")}zDm(xa,ka,wa,ia){if(ka){var va=new y.GraphTransaction(15);try{va.Db(ka);const na=N.a.ibc(xa.url);this.zD.fF(n.a.createTextRange(ka,wa,ia),na,!1,!1,!1);this.hb.Ac(t.SelectionFactory.ne(ka,ia));const Ca=this.Je.Gha(xa.annotationId);this.Je.qAa(Ca,60)}finally{va&&va.dispose()}}else X.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(xa,ka,wa,ia){if(xa){var va=new y.GraphTransaction(15);ia||(ka+=1);try{va.Db(xa),this.Md.Ge(n.a.createTextRange(xa,
ka,wa),""),this.hb.Ac(t.SelectionFactory.ne(xa,ka))}finally{va&&va.dispose()}}else X.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}R4m(){this.YI.execute(xa=>{xa.logActivity("CIQ_AtInvoke",null)})}}za.oEf=!1;za.Hkk={};Object(D.a)(za,"ContextIQIntentProvider",I.a,[55,367])},1682:function(D,J,c){D=c(0);var l=c(337),e=c(252);class a{constructor(x,y,n,t,z,v,I){this.fj=x;this.focusManager=y;this.jF=n;this.clickInputManager=t;this.Ckc=z;this.g1i=v;this.YQh=I;this.lR=this.jDb();
this.jF.U7(this.lR.name);this.clickInputManager.w2b(this.lR.name,this.fj,this.lR.VVa);x=this.ubf();this.focusManager.Qfb(this.fj,this.lR,x)}focus(){this.isFocused||this.focusManager.mg(this.lR.name)}get isFocused(){return this.focusManager.currentScope===this.lR}addIsFocusChangedHandler(x){this.lR.S3(()=>x(!0));this.lR.bOa(()=>x(!1))}Dph(x){this.lR.D_a(x)}dispose(){var x;this.focusManager.q7a(this.lR.name);this.focusManager.currentScope||this.focusManager.mg(null!==(x=this.YQh)&&void 0!==x?x:e.a.In)}jDb(){var x;
const y=this.focusManager.fe(this.Ckc);y.parent=null!==(x=this.g1i)&&void 0!==x?x:e.a.Ap;y.VVa=!0;y.c8c=!0;y.fI=!0;return y}ubf(){const x=new l.DOMFocusListing(()=>this.fj);x.Qm(8);return x}}Object(D.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(J,"a",function(){return k});class k{constructor(x,y,n,t){this.options=x;this.focusManager=y;this.jF=n;this.clickInputManager=t}registerScope(x){return new a(x,this.focusManager,this.jF,this.clickInputManager,this.options.Ckc,this.options.g1i,this.options.YQh)}}
Object(D.a)(k,"EditorAiFocusManagerImpl",null,[])},1692:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.handler=null}}Object(D.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1694:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{static get Shc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.wFb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(D.a)(l,"FontInfoPaneConstants",null,[])},1695:function(D,J,c){c.d(J,"a",function(){return l});
D=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(D.a)(l,"CommentTaskSchedule",null,[])},1696:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(81);class e{static get fd(){return null!=e.Uyg?e.Uyg:e.Uyg=new l.a}static fyk(a){e.fd.addHandler(e.UUi,a)}static Myk(a){e.fd.addHandler(e.vXi,a)}}e.UUi="OnCopyComment";e.vXi="OnPasteComment";Object(D.a)(e,"CommentEventsManager",null,[])},1697:function(D,J,c){c.d(J,"a",function(){return l});const l={Ikf:"TasksFeatureUsage",
YIo:"TaskExperienceDegraded",Ple:"TaskCreate",Qle:"TaskEngagement"}},1700:function(D,J,c){c.d(J,"c",function(){return x});c.d(J,"b",function(){return y});c.d(J,"a",function(){return n});var l=c(75),e=c(7),a=c(2),k=c(35);const x=t=>{if(!t)return null;let z;try{z=k.b(t)}catch(v){z=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",v)}return z},y=(t,z)=>{let v=[];if(t.breadcrumbs&&0<t.breadcrumbs.length)v=t.breadcrumbs;else{const I=t.service_info;
I&&I.friendly_service_name&&Array.add(v,I.friendly_service_name);t.display_path&&Array.addRange(v,t.display_path)}return v.join(z?" \u00ab ":" \u200f\u00bb ")},n=(t,z=!1)=>{if(!t)return[];if(!t.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!t.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];t=t.documents.items;const v=new l.a;for(let E=0;E<t.length;E++){const H=t[E];var I=H.web_url;if(!I){e.ULS.sendTraceTag(578320064,202,
15,"Empty web_url");if(!H.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}I=String.format("{0}?web=1",H.url)}const M={};M.DocumentUrl=I;M.MruId=H.mru_id;{I=H;let K=I.title;K?(I.extension&&(K=String.format("{0}.{1}",K,I.extension)),I=K):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),I="")}M.FileName=I;M.IsPinned=H.is_pinned;M.Path=y(H,a.AFrameworkApplication.isRtl);z&&(M.App=H.app,M.TimeStamp=H.time_stamp);v.add(M)}return v.toArray()}},1701:function(D,J,c){c.d(J,"a",function(){return k});
D=c(0);var l=c(55),e=c(93),a=c(20);class k{constructor(x,y,n){this.gq=this.AZf=null;this.leh=this.Fdb=this.keh=this.xCa=0;this.Uld=null;this._context=x;this.Ib=y;this.Ca=n;this.v1a=!1;this.ned=!0;this.r7n();this.knb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ca}get retryCount(){return this.xCa}get f9n(){return this.keh}get C7a(){return this.Fdb}get h9n(){return this.leh}t6a(x){this.gq=x;if(!this.v1a){if(this.ned){if(this.knb&&a.a.WG){this.Uld=
x.yMc(Object(l.a)(this,this.RWf,"onFileChosen"));return}this.Uld=x.yMc(null);if(!this.Nka(this.Uld,x))return}this.wwa(x,null)}}RWf(x){if(this.Nka(x,this.gq)){if(a.a.WG||a.a.Dj)this.Uld=x;this.wwa(this.gq,null)}}zhc(){this.AZf&&this.AZf()}n9n(x){if(!x||this.retryCount>=this.f9n)return!1;this.xCa=this.retryCount+1;const y=new e.a(2,1,this.C7a,()=>{this.y7c(x)},110);this.Ib.Wb(y);this.C7a<this.h9n&&(this.Fdb=2*this.C7a);return!0}r7n(){this.xCa=0;this.keh=this.K.nc("Box4UploadRetryCount",20);this.Fdb=
this.K.nc("Box4UploadRetryDelayStart",200);this.leh=this.K.nc("Box4UploadRetryDelayMax",3200);this.gq&&(this.gq.dispose(),this.gq=null)}}Object(D.a)(k,"FileUploader",null,[])},1702:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.Callback="action";Object(D.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1703:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,
k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1857),J);e(c(1858),J);e(c(1859),J);e(c(1860),J);e(c(1861),J);e(c(1862),J)},1704:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};
Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1863),J);e(c(1864),J)},1705:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};
Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1865),J);e(c(1866),J)},1707:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(D.a)(l,"CalloutButtonProps",null,[])},1708:function(D,J,c){function l(){a||(e.Health.instance.addQosPillar("AsyncCollab"),
a=!0)}c.d(J,"a",function(){return l});var e=c(86);let a=!1},1709:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a=0,k=!1){this.FJj=!1;this.paragraphNode=e;this.RTf=a;this.FJj=k}}Object(D.a)(l,"ReviewActionArgs",null,[])},1713:function(D,J,c){c.d(J,"a",function(){return l});c.d(J,"b",function(){return e});D=c(0);class l{constructor(k,x,y,n,t,z,v){this.ccpId=k;this.pKey=x;this.type=y;this.count=n;this.dc=t;this.client=z;this.version=v}}Object(D.a)(l,"ClipServiceArgs",null,
[]);var e;(e||(e={})).Chart="chart";Object(D.b)("ClipServiceDataType",e);var a;(a||(a={})).ExcelOnline="XLO";Object(D.b)("ClipServiceClientApp",a)},1714:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e=0,a=0,k=0,x=0,y="",n="",t="",z="",v="0pt",I="0pt",E="0pt",H="0pt"){this.borderTopStyle=e;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=y;this.borderRightColor=n;this.borderBottomColor=t;this.borderLeftColor=z;this.borderTopWidth=
v;this.borderRightWidth=I;this.borderBottomWidth=E;this.borderLeftWidth=H}}Object(D.a)(l,"TableCellBorderProperties",null,[])},1715:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e="",a="",k="",x=""){this.WUk=e;this.VUk=a;this.TUk=k;this.UUk=x}}Object(D.a)(l,"TableCellMarginProperties",null,[])},1719:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(44);c(6);var e=c(7),a=c(1483);class k{constructor(x,y){this.u8m=()=>{e.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};
this.hya=(n,t)=>{e.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",t)};this.ovb=y}bkj(x,y,n,t=null,z=null,v=null){if(x){var I=new l.GraphTransaction(0);I.Db(x);x.setValue(y,n);I.dispose();try{this.ovb(a.a.autoSaveParams,!1,t||this.u8m,z||this.hya,v,null,null)}catch(E){e.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",E.message)}}else e.ULS.sendTraceTag(39358946,324,10,
"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(D.a)(k,"AutoSaveParamsUpdateService",null,[376])},1720:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(7);class e{constructor(a){this.Wzj=a}ie(a,k){if(a){var x=this.Wzj();a();a=this.Wzj();l.ULS.sendTraceTag(555307094,345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(D.a)(e,"PerfLogger",null,[576])},1721:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.paragraphNode=
e;this.state=a}}Object(D.a)(l,"ReviewCompletedArgs",null,[])},1722:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.index=e;this.count=a}}Object(D.a)(l,"DesignerReviewPosition",null,[])},1723:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(D.b)("BlueDotHighlightContextType",l);class e{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.ps=
a;this.CHc=k;this.GMo=x;this.DLk=y}}Object(D.a)(e,"BlueDotHighlightContext",null,[])},1724:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.uv=this.Ko=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.Mxa=!1;this.jNb=this.BLb=5;this.zna=this.aF=this.tJc=0;this.u1k=!1}}Object(D.a)(l,"SectionPropertiesData",null,[])},1725:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(195);class l extends c.a{constructor(){super();this.OnRetryCommandId=
this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(D.a)(l,"ErrorViewProps",c.a,[])},1726:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(195);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}
Object(D.a)(l,"MultiActionButtonProps",c.a,[])},1727:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaInfo",null,[])},1728:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaIdentifiers",null,[])},1729:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);J=c(1157);c=c(1089);class l{}l.t1=[new J.a(1440,1440,1440,1440),new J.a(720,720,720,720),new J.a(1440,1440,1080,1080),new J.a(1440,1440,2880,2880),new J.a(1440,1440,1800,1800)];
l.Sqa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(D.a)(l,"PredefinedPageProperties",null,[])},1731:function(D,J,c){c.d(J,"a",function(){return E});D=c(0);var l=c(205),e=c(2),a=c(22),k=c(20),x=c(18),y=c(1345),n=c(258),t=c(443),z=c(7),v=c(459),I=c(691);class E{constructor(H,M,K,L,S,Q,N,O,X,U,T,Y,aa,ba){this.qr=H;this.Yvb=M;this.Ca=K;this.Op=L;this.Pr=S;this.uE=Q;this.oba=N;this.xab=O;this.sab=X;this.vab=U;this.wab=T;this.tbb=Y;this.ubb=
aa;this.fqd=ba}build(H,M,K,L){const S=new l.QueryStringBuilder("WordOart.ashx");e.AFrameworkApplication.qga(S);S.Ae(v.a.nodeId,M.id.toString());M=x.ImageReader.H$l(M,H.Mc);S.Ae(I.a.DKd,M?M.ja(t.a.$Uf,""):"");S.Ae(I.a.width,this.Op.toString());S.Ae(I.a.height,this.Pr.toString());S.Ae(I.a.g4c,this.oba.toString());S.Ae(I.a.o4n,y.a[this.Yvb]);M=this.Ca.$("WordEditorImageCropIsEnabled");S.Ae(I.a.ZOh,M.toString());M&&(S.Ae(I.a.top,this.xab.toString()),S.Ae(I.a.bottom,this.sab.toString()),S.Ae(I.a.left,
this.vab.toString()),S.Ae(I.a.right,this.wab.toString()));M=this.Ca.$("WordEditorImageRotateIsEnabled");S.Ae(I.a.Dgj,M.toString());M&&(S.Ae(I.a.angle,this.uE.toString()),S.Ae(I.a.flipH,this.tbb?"true":"false"),S.Ae(I.a.flipV,this.ubb?"true":"false"));S.Ae(I.a.A1f,K?"true":"false");S.Ae(I.a.strict,this.fqd?"true":"false");this.Ca.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.qr&&this.qr.dAf&&S.Ae(I.a.G3a,this.qr.dAf);(H=H.Zi())?(S.Ae(v.a.fileId,H.yr),S.Ae(v.a.cellId,H.Fm.toString())):
z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",S.toString());H=a.a.instance.Oa("Box4.IFeatureHelper");H=!!H&&H.isFeatureEnabled(51);S.Ae(I.a.Btl,"true");S.Ae(I.a.gDm,H.toString());S.Ae(I.a.BWh,"true");H&&S.Ae(I.a.I2i,H.toString());S.Ae(I.a.jDm,"true");n.a.instance.bBb(S);K&&L&&!k.a.ht&&S.cJ(I.a.kgb,window.self.devicePixelRatio.toString());S.Ae(I.a.kxh,"true");return S.toString()}}Object(D.a)(E,"WordOartEndpointUrlBuilder",null,[])},1732:function(D,
J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(16);class e{constructor(a,k){this._id=a;this.Gb=k;this.YQk=k.ja(l.a.Kia,0);this.WQk=k.ja(l.a.Jia,0)}getId(){return this._id}}Object(D.a)(e,"GraphicsEditorImageContainer",null,[626])},1733:function(D,J,c){c.d(J,"a",function(){return N});D=c(0);var l=c(61),e=c(2),a=c(127),k=c(205),x=c(18),y=c(523),n=c(737),t=c(6),z=c(175),v=c(47),I=c(16),E=c(42),H=c(443),M=c(118),K=c(1010),L=c(7),S=c(691),Q=c(1731);class N{constructor(O,X,U,T,Y,aa){this.properties=
null;this.qr=X;this.Vj=T;this.Ca=Y;this.lA=aa}pXo(O,X,U){O.lP||(X.setValue(t.a.EGc,O.ICk),X.setValue(t.a.dOd,O.s8b));this.BMj(O,X,U)}qXo(O,X,U){X.setValue(t.a.BNb,O.O0o);x.ImageReader.xTd(X,U.Mc,!1)!==O.ZZf&&X.Cg(t.a.bae,z.a.ft,z.a.Eqa,v.a.U9a);if(O.O9d)X.setValue(I.a.Uda,l.a.If(O.O9d));else{var T=this.uMh(O.ZZf,O.$Zf,O.extension);U.Mc.Xu(T);X.setValue(I.a.Uda,T.id)}O.Vpe?X.setValue(v.a.U9a,l.a.If(O.Vpe)):O.hLj&&(T=this.uMh(O.hLj,O.xsg,O.extension),U.Mc.Xu(T),X.setValue(v.a.U9a,T.id));X.ja(t.a.cae,
"")!==O.L6c&&(""!==O.L6c?X.setValue(t.a.cae,O.L6c):X.removeProperty(t.a.cae));0===O.Kva&&0===O.Mva&&0===O.Lva&&0===O.Jva||this.Vj.aeg(X,O.Mva,O.Jva,O.Kva,O.Lva);void 0!==O.lockAspectRatio?X.setValue(t.a.wY,O.lockAspectRatio):X.setValue(t.a.wY,!1);O.hMk&&(this.yQb(X,t.a.vja,O.Byh),this.yQb(X,t.a.Oqa,O.borderStyle),this.yQb(X,t.a.dIa,O.borderColor));void 0!==O.altTextDescription&&X.setValue(t.a.vY,O.altTextDescription);this.yQb(X,E.a.alphaModFix,O.alphaModFix);this.BMj(O,X,U);O=y.a.instance.Jjf(X);
X.setValue(t.a.Vda,O)}uMh(O,X,U){const T=new K.a(524345);T.setValue(H.a.$Uf,O);T.setValue(H.a.Ghc,O);T.setValue(v.a.QCl,l.a.If(O).guid);T.setValue(t.a.Cqi,X);T.setValue(H.a.Wkf,e.AFrameworkApplication.rootQuerySignature);T.setValue(v.a.I_h,U);return T}BMj(O,X,U){O.lP?(this.properties=X,X.setValue(E.a.lP,O.lP),O.DGc&&X.setValue(E.a.hDd,O.DGc),X.setValue(E.a.bxa,O.q5o),X.setValue(E.a.cxa,O.Ium),X.setValue(E.a.JQa,O.H7b),X.setValue(t.a.Ns,O.Ns),X.setValue(t.a.Ahb,O.w7b),X.setValue(v.a.B0,0),this.Ca&&
this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(M.a.TPa,!1),X.setValue(M.a.H5,0),this.yQb(X,E.a.s4a,O.$xa),this.Roh(X,U,!1,!0),this.fYk(X)):(X.setValue(t.a.gGa,O.gGa),X.setValue(z.a.ft,O.gGa?O.uEn:""),O.kgb&&X.setValue(z.a.sIb,O.kgb),X.setValue(t.a.Ns,O.Ns),X.setValue(t.a.Ahb,O.w7b),X.setValue(t.a.Vda,O.UH),X.setValue(I.a.Kia,a.a.EG(O.width)),X.setValue(I.a.Jia,a.a.EG(O.height)),X.setValue(v.a.l1f,a.a.EG(O.width)),X.setValue(v.a.j1f,
a.a.EG(O.height)),X.setValue(z.a.eGa,-1),X.setValue(z.a.dGa,-1),X.setValue(I.a.Oxa,!0),X.setValue(t.a.KU,O.rotationAngle),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(M.a.TPa,!1),X.setValue(v.a.B0,0),O.gGa&&this.Roh(X,U,!0,!1),this.gYk(X));5!=x.ImageReader.ui(X)?this.iYk(X):this.eYk(X);this.yQb(X,t.a.mzf,O.flipH);this.yQb(X,t.a.Jzf,O.flipV)}V4n(O,X,U,T,Y=null){O=this.Vj.Q4n(O.ik,X,U,T);null==O?L.ULS.sendTraceTag(561538391,
3001,10,"Failed to replace picture properties"):Y&&Y(O)}Roh(O,X,U,T){let Y=!1;var aa=this.lA.uu(X);aa&&aa.tf(t.a.AIf)&&(Y=!0);aa=x.ImageReader.yca(O);const ba=x.ImageReader.Loa(O);X=(new Q.a(this.qr,x.ImageReader.ui(O),this.Ca,x.ImageReader.oF(O),x.ImageReader.KG(O),x.ImageReader.p0(O),x.ImageReader.Fjb(O),Math.max(aa.top,0),Math.max(aa.bottom,0),Math.max(aa.left,0),Math.max(aa.right,0),ba.xib,ba.hFa,Y)).build(X,O,!0,!1);T&&(T=new k.QueryStringBuilder(X),T.Ae(S.a.EXd,"true"),X=T.toString());O.setValue(t.a.Chb,
X);U&&n.a.zQb(O,1,e.AFrameworkApplication.K,this.qr)}yQb(O,X,U){void 0===U||null===U?O.removeProperty(X):O.setValue(X,U)}gYk(O){O.removeProperty(E.a.lP);O.removeProperty(E.a.hDd);O.removeProperty(E.a.bxa);O.removeProperty(E.a.cxa);O.removeProperty(E.a.JQa);O.removeProperty(E.a.K6d);O.removeProperty(E.a.csl);O.removeProperty(E.a.s4a)}iYk(O){O.removeProperty(t.a.bae);O.removeProperty(t.a.BNb);O.removeProperty(I.a.Uda);O.removeProperty(t.a.cae)}eYk(O){O.removeProperty(t.a.dOd);O.removeProperty(t.a.EGc);
O.removeProperty(E.a.lP);O.removeProperty(E.a.hDd)}fYk(O){O.removeProperty(t.a.EGc);O.removeProperty(z.a.ft);O.removeProperty(I.a.Kia);O.removeProperty(I.a.Jia);O.removeProperty(t.a.Vda);O.removeProperty(z.a.Eqa);O.removeProperty(t.a.dOd);O.removeProperty(t.a.KU)}}Object(D.a)(N,"GraphicsEditorImageEditor",null,[613])},1734:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupApplicationInterface",null,[])},1735:function(D,J,c){c.d(J,"a",function(){return l});D=
c(0);class l{constructor(e,a,k,x,y,n){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=e;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=n}}Object(D.a)(l,"FileInfo",null,[])},1762:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(7);c=c(260);class e extends c.a{constructor(a,k,x,y){super(e.G4e);this.Il=a;this.Vi=k;this.view=x;this.options=y}initialize(){super.initialize();const a=this.options.QPb==this.Vi.Dba(this.view.ed,
{qP:this.options.qP,Vca:this.options.Cbc,jpa:this.options.Bbc,pP:this.options.pP});a&&!this.Eia&&l.ULS.sendTraceTag(557114691,3028,50,this.FO(this.Il,!0,`satisfiedIfBlank=${this.options.QPb}`));this.pg(a)}Od(){super.Od()}}e.G4e="BlankDocumentConditionId";Object(D.a)(e,"BlankDocumentCondition",c.a,[])},1766:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(D.a)(l,"ImageProps",null,[])},1768:function(D,J,c){c.d(J,"a",
function(){return v});D=c(0);var l=c(61),e=c(8),a=c(11),k=c(7),x=c(14),y=c(1563),n=c(1548),t=c(1558),z=c(1551);class v{constructor(I,E,H,M,K,L,S){this.fVi=(Q,N)=>{N&&N.data&&N.data.ul&&(Q=new z.a(N.data.ul,1,!0),this.Tye.DN(Q))};this.lYi=(Q,N)=>{N&&N.data&&N.data.ul&&N.data.ul.node&&this.e1j.gRi(this.Tye,N.data.ul.node)};this.fkc=(Q,N,O)=>{Q=N.view.ue?N.view:null;if(!Q||!Q.mb)return 8;Q=Q.mb.ib.J(0).Pa;return e.ParagraphReader.Xb(Q.node)?1===O?32:2===O?(O=new z.a(Q,2,!1),this.Tye.DN(O),32):2:2};this.g6b=
(Q,N,O)=>{var X,U;Q=N.view.ue?N.view:null;if(!Q||!Q.mb)return 8;Q=null===(X=Q.mb.ib.J(0))||void 0===X?void 0:X.Pa;return Q&&Q.node?e.ParagraphReader.Xb(Q.node)?1===O?32:2===O?(O=Q.node,X=e.ParagraphReader.text(Q.node),N=Q.cpBegin,Q=Q.cpEnd-N,0<Q&&(X=X.substr(N,Q)),Q=Math.floor(Math.random()*v.nhj),N=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:N,["textLength"]:X.length,["paragraphLength"]:e.ParagraphReader.textLength(O),
["paragraphRole"]:null===(U=this.H7.GA(O))||void 0===U?void 0:U.role,["styleId"]:Q},this.Zak.DSd()),U=[new y.c(new n.d(N,3,null,null,!1,Q,X),O,Q,X,T=>{this.rWb.c6c(t.a.create(T));this.rWb.ijc({role:27,paragraphNode:T,placeholder:!1})},3)],this.Jgk.KDd(U),32):2:2:8};this.ga=I;this.Tye=E;this.e1j=H;this.rWb=M;this.Jgk=K;this.H7=L;this.Zak=S}initialize(){this.ga.fb(x.a.fkc,a.a.view,this.fkc,1028);this.rWb.gzk(this.lYi);this.rWb.byk(this.fVi);this.ga.fb(x.a.g6b,a.a.view,this.g6b,4)}dispose(){this.ga.Vv(x.a.g6b,
a.a.view,this.g6b);this.rWb.n2n(this.fVi);this.rWb.I2n(this.lYi);this.ga.Vv(x.a.fkc,a.a.view,this.fkc)}}v.nhj=5;Object(D.a)(v,"DesignerActionListener",null,[997,10])},1770:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(D.a)(l,"CritiqueAction",null,[])},1779:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.sRj="PageContentOrigin";this.ePj=500;this.owg=["resize"];this.VKo=e=>()=>{!this.dnd&&e&&
(this.dnd=setTimeout(()=>this.iFh(),this.ePj),e())}}addHandler(e){this.aPb();this.YLa=this.VKo(e);this.Ywn(this.YLa);this.owg.forEach(a=>{window.addEventListener(a,this.YLa)})}aPb(){var e;this.iFh();null===(e=this.dnh)||void 0===e?void 0:e.disconnect();this.owg.forEach(a=>{window.removeEventListener(a,this.YLa)});this.YLa=void 0}iFh(){this.dnd&&(clearTimeout(this.dnd),this.dnd=void 0)}Ywn(e){this.dnh=new MutationObserver(e);(e=document.getElementsByClassName(this.sRj)[0])&&this.dnh.observe(e,{attributes:!0,
attributeFilter:["style"]})}}Object(D.a)(l,"EditorAiWindowEventManager",null,[])},1780:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(39),e=c(10);class a{constructor(k){var x,y;this.Nl=k;this.kS=null;this.kS=null===(y=null===(x=this.Nl)||void 0===x?void 0:x.yd)||void 0===y?void 0:y.container}addHandler(k){this.kS&&(this.aPb(),this.YLa=k,l.a.addHandler(this.kS,e.a.scroll,this.YLa),l.a.addHandler(this.kS,e.a.resize,this.YLa))}aPb(){this.kS&&this.YLa&&(l.a.removeHandler(this.kS,e.a.scroll,
this.YLa),l.a.removeHandler(this.kS,e.a.resize,this.YLa))}}Object(D.a)(a,"EditorAiPositionManager",null,[])},1781:function(D,J,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.jz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(J,"__esModule",{value:!0});e(c(1972),J);e(c(1973),J);e(c(1974),J);e(c(1975),J);e(c(1976),J);e(c(1977),J)},1783:function(D){var J="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(J){var c=new Uint8Array(16);D.exports=function(){J(c);return c}}else{var l=Array(16);D.exports=function(){for(var e=0,a;16>
e;e++)0===(e&3)&&(a=4294967296*Math.random()),l[e]=a>>>((e&3)<<3)&255;return l}}},1784:function(D){for(var J=[],c=0;256>c;++c)J[c]=(c+256).toString(16).substr(1);D.exports=function(l,e){e=e||0;return[J[l[e++]],J[l[e++]],J[l[e++]],J[l[e++]],"-",J[l[e++]],J[l[e++]],"-",J[l[e++]],J[l[e++]],"-",J[l[e++]],J[l[e++]],"-",J[l[e++]],J[l[e++]],J[l[e++]],J[l[e++]],J[l[e++]],J[l[e++]]].join("")}},1785:function(D,J,c){c.d(J,"a",function(){return l});const l={lAj(e){return"function"===typeof e?{execute:e}:e}}},
1787:function(D,J,c){var l=c(0),e=c(25),a=c(1845),k=c(368),x=c(613),y=c(61),n=c(22),t=c(2063),z=c(2),v=c(109),I=c(93),E=c(1638),H=c(189);class M{constructor(cc,Ic){this.CommentId=cc;this.ResolveState=Ic}}Object(l.a)(M,"CommentProperties",null,[]);var K=c(587),L=c(2066),S=c(2067),Q=c(1679),N=c(2065),O=c(194),X=c(1843);class U extends X.a{constructor(cc,Ic="",Yc="",ad="",yd=!1){super(cc,Ic,Yc,ad,yd);this.DateUtc=null}}Object(l.a)(U,"CommentReactionUser",X.a,[]);var T;(function(cc){cc[cc.like=1]="like"})(T||
(T={}));Object(l.b)("ReactionType",T);var Y;(function(cc){cc[cc.first=0]="first";cc[cc.done=0]="done";cc[cc.undone=1]="undone";cc[cc.addComment=2]="addComment";cc[cc.deleteComment=3]="deleteComment";cc[cc.editComment=4]="editComment";cc[cc.addReaction=5]="addReaction";cc[cc.removeReaction=6]="removeReaction";cc[cc.last=7]="last"})(Y||(Y={}));Object(l.b)("CommentChangeType",Y);var aa=c(244),ba=c(1472),oa=c(250);class ma{constructor(){this.ngh=this.Cih=!1;this.Gnk=[]}get poc(){return this.Gnk}get FRb(){return this.Cih}set FRb(cc){this.Cih=
cc;for(const Ic of this.poc)Ic.FRb=cc}get uQb(){return this.ngh}set uQb(cc){this.ngh=cc;for(const Ic of this.poc)Ic.uQb=cc}j9a(cc){for(const Ic of this.poc)cc=Ic.j9a(cc);return cc}}Object(l.a)(ma,"AggregateCommentTaskPersonTransformer",null,[1145]);var ea=c(7),ua=c(139),sa=c(1636);class Fa{constructor(cc,Ic){this.V$j=new oa.a(()=>Ic.j9a(cc.value))}BVl(){return new Date}U0a(cc,Ic,Yc){if(0===cc)throw ea.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const ad=ua.a.create().toString();Yc=new sa.a(cc,this.V$j.value,Yc,ad,!1);Yc.commentId=Ic;ea.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",cc);return Yc}}Object(l.a)(Fa,"HistoryRecordFactory",null,[1147]);var Pa=c(1695);class Na{constructor(cc,Ic,Yc,ad,yd,ne){this.isLossy=cc;this.title=Ic;this.assignees=Yc;this.schedule=ad;this.completion=yd;this.priority=ne}}Object(l.a)(Na,"CommentTaskState",null,[]);class Aa{constructor(){this.commentId=
null}}Object(l.a)(Aa,"HistoryItem",null,[]);class za{constructor(cc,Ic,Yc,ad,yd,ne,Oe){this.YFe=!1;if(1!==Ic.type)throw Error.argument("createRecord");this.Wtc=Yc;this.Stc=ad;this.Ttc=yd;this.I8g=1;this.Und=cc;this.Xbk=ne;this._state=new Na(!1,this.Wtc,Oe,new Pa.a,this.Ttc,this.Stc);this._history=[];this.nNh(Ic)}j6b(cc,Ic){if(1!==cc.type)throw Error.argument("createRecordTemplate");const Yc=za.Kgm(cc,this.I8g);this.I8g++;return Object.assign(new sa.a(Ic,cc.user,cc.time,Yc),{commentId:cc.commentId})}get dGi(){return this.history[this.history.length-
1]}get Eni(){return this.state.completion===this.Ttc}get Dni(){return this.state.priority===this.Stc}get Fni(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Gni(){return this.state.title===this.Wtc}nNh(cc){cc=Object.assign(new Aa,{commentId:cc.commentId,records:[cc]});this.history.push(cc)}K5h(cc){let Ic=-1;for(let Yc=0;Yc<this.state.assignees.length;Yc++)if(this.Und.equals(this.state.assignees[Yc],
cc)){Ic=Yc;break}return Ic}Zro(cc){const Ic=this.dGi,Yc=Ic.records[Ic.records.length-1];return this.Und.equals(Yc.user,cc.user)&&Ic.commentId===cc.commentId&&Yc.time.getTime()===cc.time.getTime()?!0:!1}G0o(cc){switch(cc.type){case 2:-1===this.K5h(cc.assignee)&&this.state.assignees.push(cc.assignee);break;case 3:const Ic=this.K5h(cc.assignee);0<=Ic&&this.state.assignees.splice(Ic,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=cc.schedule;break;case 6:this.state.completion=
cc.completion;break;case 9:this.state.title=cc.title;break;case 10:this.state.priority=cc.priority;break;case 0:this.state.isLossy=!0;break;case 1:ea.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.YFe=!0;break;case 8:this.YFe=!1;break;case -1:ea.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}cc.isLossy&&(this.state.isLossy=!0);this.Zro(cc)?this.dGi.records.push(cc):this.nNh(cc)}get isDeleted(){return this.YFe}get state(){return this._state}get history(){return this._history}t0l(cc){if(!cc)return this.history;
const Ic=Array.clone(this.history),Yc=Ic[0],ad=Yc.records.shift();if(!this.Xbk){var yd=this.j6b(ad,4);Yc.records.unshift(yd)}!cc.Eni&&this.Eni&&(yd=this.j6b(ad,6),yd.completion=this.Ttc,Yc.records.unshift(yd));!cc.Dni&&this.Dni&&(yd=this.j6b(ad,10),yd.priority=this.Stc,Yc.records.unshift(yd));!cc.Fni&&this.Fni&&(yd=this.j6b(ad,5),yd.schedule=new Pa.a,Yc.records.unshift(yd));!cc.Gni&&this.Gni&&(yd=this.j6b(ad,9),yd.title=this.Wtc,Yc.records.unshift(yd));cc.isDeleted&&(cc=this.j6b(ad,8),Yc.records.unshift(cc));
return Ic}static Kgm(cc,Ic){return"Synthesized-"+cc.recordId+"-"+Ic}}Object(l.a)(za,"CommentTaskStateBuilder",null,[]);class xa{constructor(cc,Ic,Yc,ad){this.id=cc;this.commentId=Ic;this.currentState=Yc;this.history=ad}}Object(l.a)(xa,"CommentTaskItem",null,[]);var ka=c(1635);const wa=cc=>{const Ic=new ka.a(cc.UserId,cc.Provider,cc.DisplayName,cc.Email);Ic.IsCurrentUser=cc.IsCurrentUser;return Ic};var ia=c(1840);class va{static clone(cc){cc=va.R_k(cc.extensions);return new ia.a(cc)}static ZFh(cc){return cc?
va.clone(cc):null}static isEmpty(cc){return!cc.extensions||!cc.extensions.count}static af(cc){return!cc||va.isEmpty(cc)}static R_k(cc){if(!cc)return null;const Ic=new k.a;cc.forEach((Yc,ad)=>{Ic.add(Yc,ad);return!0});return Ic}}Object(l.a)(va,"ExtensionListExtensions",null,[]);class na{static clone(cc){var Ic=wa(cc.user);Ic=new sa.a(cc.type,Ic,cc.time,cc.recordId,cc.isLossy);Ic.commentId=cc.commentId;Ic.anchorExtensionList=va.ZFh(cc.anchorExtensionList);Ic.recordExtensionList=va.ZFh(cc.recordExtensionList);
cc.assignee&&(Ic.assignee=wa(cc.assignee));if(cc.schedule){var Yc=cc.schedule;const ad=new Pa.a;ad.startDate=Yc.startDate;ad.endDate=Yc.endDate;Ic.schedule=ad}Ic.completion=cc.completion;Ic.title=cc.title;Ic.priority=cc.priority;Ic.undoId=cc.undoId;return Ic}}Object(l.a)(na,"HistoryRecordExtensions",null,[]);class Ca{constructor(cc,Ic,Yc,ad,yd,ne,Oe,nf=!1){this.Und=cc;this.pud=Ic;this.oNa=Yc;this.L_j=ad;this.Wtc=yd;this.Stc=ne;this.Ttc=Oe;this.Hpd=nf}Qfl(cc,Ic,Yc,ad=null){if(!cc)throw ea.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Ic)throw ea.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Yc||!Yc.length)throw ea.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Yc[0].type)throw ea.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var yd=[],ne=null,Oe=this.KKn(Yc);
for(var nf of Yc)if(!Oe.contains(nf.recordId))if(Yc=this.aki(nf.commentId,ad),Yc=this.eMl(nf,Yc),1===Yc.type){let Ye=[];this.Hpd&&ne&&ne.state&&(Ye=ne.state.assignees);ne=new za(this.Und,Yc,this.Wtc,this.Stc,this.Ttc,this.Hpd,Ye);yd.push(ne)}else if(ne)ne.G0o(Yc);else throw ea.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");
Oe=null;nf=[];if(ne){ne.isDeleted||(Oe=ne.state);ne=null;for(var wf of yd)yd=wf.t0l(ne),Array.addRange(nf,yd),ne=wf}wf=this.aki(Ic,ad);Oe&&(Oe.completion=this.e4k(Ic,ad,Oe.completion));return new xa(cc,wf,Oe,nf)}p4h(cc,Ic,Yc,ad=null){if(!Ic)throw ea.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Yc&&!cc)throw ea.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const yd=[],ne=this.oNa.BVl();if(Yc){var Oe=
this.oNa.U0a(1,cc,ne);yd.push(Oe)}Oe=null;if(Ic.assigneeUpdate){if(!Ic.assigneeUpdate.assigneesToAdd||!Ic.assigneeUpdate.assigneesToRemove)throw ea.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var nf=0;nf<Ic.assigneeUpdate.assigneesToAdd.length;nf++){var wf=this.oNh(2,Ic.assigneeUpdate.assigneesToAdd[nf],cc,ne);wf&&yd.push(wf)}for(nf=0;nf<Ic.assigneeUpdate.assigneesToRemove.length;nf++)(wf=this.oNh(3,Ic.assigneeUpdate.assigneesToRemove[nf],
cc,ne))&&yd.push(wf)}else Ic.assignee&&(Yc||(Oe=this.oNa.U0a(4,cc,ne),yd.push(Oe)),nf=this.oNa.U0a(2,cc,ne),Oe=this.pud.j9a(Ic.assignee),nf.assignee=Oe,yd.push(nf));Ic.title?(ad=this.oNa.U0a(9,cc,ne),ad.title=Ic.title,yd.push(ad)):Yc&&ad&&(nf=this.oNa.U0a(9,cc,ne),nf.title=this.L_j.Ajm(ad,Oe),yd.push(nf));if(Ic.schedule){if(Ic.schedule.startDate>Ic.schedule.endDate)throw ea.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");ad=this.oNa.U0a(5,cc,ne);
ad.schedule=Ic.schedule;yd.push(ad)}if(void 0!==Ic.completion&&null!==Ic.completion){ad=Ic.completion;if(0>ad||100<ad)throw ea.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Yc||ea.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",ad);Yc=this.oNa.U0a(6,cc,ne);Yc.completion=ad;yd.push(Yc)}if(void 0!==Ic.priority&&null!==Ic.priority){Ic=Ic.priority;if(0>Ic||10<Ic)throw ea.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),
Error.argumentOutOfRange("priority");cc=this.oNa.U0a(10,cc,ne);cc.priority=Ic;yd.push(cc)}return yd}oNh(cc,Ic,Yc,ad){if(2!==cc&&3!==cc)return ea.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;cc=this.oNa.U0a(cc,Yc,ad);cc.assignee=this.pud.j9a(Ic);return cc}KKn(cc){const Ic=new x.a,Yc=new x.a;for(let ad=cc.length-1;0<=ad;ad--){const yd=cc[ad],ne=Yc.contains(yd.recordId);ne||-1!==yd.type||(Yc.contains(yd.undoId)?ea.ULS.sendTraceTag(578670598,
327,50,"Multiple Undo records attempting to undo the same record."):Yc.add(yd.undoId));if(ne||-1===yd.type)Ic.contains(yd.recordId)?ea.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Ic.add(yd.recordId)}return Ic}eMl(cc,Ic){const Yc=na.clone(cc);Yc.commentId=Ic;Yc.user=this.pud.j9a(cc.user);Yc.assignee=this.pud.j9a(cc.assignee);return Yc}e4k(cc,Ic,Yc){let ad=Yc;cc&&Ic&&(({value:Ic}=Ic.Fc(cc)).returnValue?(ad=Ic.ResolveState?
100:100===Yc?0:Yc,ad!==Yc&&ea.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",cc)):ea.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",cc));return ad}aki(cc,Ic){let Yc=cc;cc&&Ic&&(({value:Ic}=Ic.Fc(cc)).returnValue?Yc=Ic.CommentId:(ea.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",cc),Yc=cc));return Yc}}
Object(l.a)(Ca,"CommentTaskTranslatorImpl",null,[1146]);var ta=c(1060),fa=c(1236);class Xa{constructor(){this.Ihb=CommonUIStrings.l_Ellipsis}Ajm(cc,Ic){if(!cc)throw ea.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var Yc=E.a.hGb(cc)}catch(wf){throw ea.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var ad=cc=0,yd=0;const ne=RegExp("\\s+","g"),Oe=new Sys.StringBuilder;
for(var nf of Yc.ops)nf.attributes&&nf.attributes.atmention&&nf.attributes.atmention.email&&Ic&&(Yc=nf.attributes.atmention.email,0<Yc.length&&(Yc===Ic.UserId||Yc===Ic.Email||Yc===ta.a.jib(Ic.UserId))&&(ad=cc,yd=ad+nf.insert.length)),Yc=nf.insert.replace(ne," "),cc+=Yc.length,Oe.append(Yc);!yd&&Ic&&ea.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Ic.Provider);Ic=Oe.toString().trimEnd();cc=Ic.length;255<cc?(nf=(255-(yd-ad))/2,0>ad-nf?(cc=fa.a.instance.s2a(Ic,255-this.Ihb.length),
yd=Ic.substring(0,cc)+this.Ihb,cc="Trimmed End"):yd+nf>cc?(ad=fa.a.instance.L2a(Ic,cc-255+this.Ihb.length),yd=this.Ihb+Ic.substring(ad,cc),cc="Trimmed Start"):(ad=fa.a.instance.L2a(Ic,ad-nf+this.Ihb.length),cc=fa.a.instance.s2a(Ic,yd+nf-this.Ihb.length),yd=this.Ihb+Ic.substring(ad,cc)+this.Ihb,cc="Trimmed Both")):(cc="No Trim",yd=Ic);ea.ULS.sendTraceTag(592998804,327,50,cc);return yd}}Object(l.a)(Xa,"ContentExtractor",null,[]);class ob{constructor(cc,Ic){this.N6j=cc;this.W$j=Ic;this.uQb=this.FRb=
!1}j9a(cc){if(!cc)return null;if(void 0===cc.UserId||null===cc.UserId)throw ea.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(cc.IsCurrentUser||!this.N6j.equals(this.W$j.value,cc))return cc;cc=wa(cc);cc.IsCurrentUser=!0;return cc}}Object(l.a)(ob,"EnsureIsCurrentUserSetTransformer",null,[1145]);class xb{constructor(){this.uQb=this.FRb=!1}j9a(cc){if(!cc)return null;if(void 0===cc.UserId||null===cc.UserId)return cc;if(!cc.Email||""===cc.Email){let Ic;
if(Ic=ta.a.jib(cc.UserId))return cc=wa(cc),cc.Email=Ic,cc}return cc}}Object(l.a)(xb,"RestoreEmailTransformer",null,[1145]);class zb{constructor(){this.uQb=this.FRb=!1}j9a(cc){if(!cc)return null;if(void 0!==cc.UserId&&null!==cc.UserId)return cc;switch(this.FRb?this.uQb?2:1:0){case 0:if(void 0===cc.UserId||null===cc.UserId)throw ea.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");cc=wa(cc);break;case 1:if(void 0===cc.Id||null===cc.Id)throw ea.ULS.sendTraceTag(593368214,
327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===cc.Email||null===cc.Email)throw ea.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Ic=zb.r1i(cc.Id,cc.Email,null);if(!Ic||""===Ic)throw ea.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Yc=z.AFrameworkApplication.K.kb("HostAuthType")||"";if("aad"!==Yc.toLowerCase()||Ic.startsWith("S::")){if("msa"===Yc.toLowerCase())throw ea.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");ea.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Yc)}else throw ea.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");cc=new ka.a(Ic,"AD",cc.DisplayName,cc.Email);break;case 2:if(void 0===cc.UserPrincipalName||null===cc.UserPrincipalName)throw ea.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==cc.SuggestionSubtype&&null!==cc.SuggestionSubtype)if("OrganizationUser"===cc.SuggestionSubtype)Ic="AD";else throw ea.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",cc.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw ea.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Yc=zb.r1i(cc.Id,cc.UserPrincipalName,cc.AadObjectId);if(!Yc||""===Yc)throw ea.ULS.sendTraceTag(593368205,327,
10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Ic&&!Yc.startsWith("S::"))throw ea.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");cc=new ka.a(Yc,Ic,cc.Name,cc.UserPrincipalName);break;default:throw ea.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return cc}static r1i(cc,Ic,Yc){if(!Ic||""===Ic)return ea.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),cc;if(Yc&&""!==Yc)return"S::"+
Ic+"::"+Yc;if(!cc||""===cc)return ea.ULS.sendTraceTag(593368217,327,50,"Missing ID"),cc;if(cc.startsWith("S::"))return cc;if(-1!==cc.indexOf("@")){Yc=cc.split("@");if(ua.a.isValid(Yc[0]))return"S::"+Ic+"::"+Yc[0];ea.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return cc}}Object(l.a)(zb,"UserIdCanonicalizationTransformer",null,[1145]);class Lb{constructor(cc,Ic,Yc=!1,ad=!1){this.x2j=cc;this.uOg=Ic;this.Iak=Yc;this.Hpd=ad}E$k(){const cc=new ta.a;var Ic=new oa.a(Lb.eVl);
const Yc=new ma;this.uOg&&(Yc.poc.push(new zb),Yc.poc.push(new xb));this.x2j&&Yc.poc.push(new ob(cc,Ic));Yc.FRb=this.uOg;Yc.uQb=this.Iak;Ic=new Fa(Ic,Yc);const ad=new Xa;return new Ca(cc,Yc,Ic,ad,Lb.Ujl,Lb.Ljl,Lb.Mjl,this.Hpd)}static eVl(){const cc=new ka.a(z.AFrameworkApplication.K.kb("PresenceUserId")||"",z.AFrameworkApplication.K.kb("PresenceProvider")||"",z.AFrameworkApplication.userName||"");cc.IsCurrentUser=!0;return cc}}Lb.Ujl="";Lb.Ljl=5;Lb.Mjl=0;Object(l.a)(Lb,"CommentTaskTranslatorFactory",
null,[1137]);var Ia=c(43),Ya=c(165),eb=c(12),sb=c(5),lc=c(52),vb=c(178),Eb=c(49),Ua=c(23),Ta=c(743),Nb=c(38),Wa=c(8),Bb=c(1231),Ob=c(17),hc=c(28),Gc=c(76),bc=c(15),Dc=c(291),Ub=c(131),Fc=c(533),Sa=c(206),wb=c(394),Tb=c(722),Hb=c(373),$a=c(65),ab=c(238),rb=c(11),cb=c(254),rc=c(6),Rb=c(710),fb=c(598),Pb=c(360),Ec=c(55),uc=c(614),ya=c(111),db=c(83),tb=c(224),Xb=c(1496),$b=c(35),Ab=c(1062);class vc{create(){return new Ab.a}}Object(l.a)(vc,"CommentNodeFactory",null,[380]);var Sc=c(1223),ed=c(1082),pd=
c(1535),oc=c(1599);class cd{constructor(){this.qNc=this.cbd=null;this.YMd=this.wke=!1;this.ROa=this.WDa=null}}Object(l.a)(cd,"CommentAnchorParaNodesStatus",null,[]);var Xc=c(1427),ic=c(16);class Ac extends Xc.a{constructor(cc){super();this.hhk=cc}get index(){return 2}run(){this.hhk()}gHh(cc,Ic){Ic.property===ic.a.gf&&this.TY()}}Object(l.a)(Ac,"CommentContentPropertyTracker",Xc.a,[]);var wd=c(1527);class Je{constructor(cc,Ic){this.Zhc=cc;this.jui=Ic}}Object(l.a)(Je,"CommentIntentIdentifier",null,[]);
var Zd=c(1051),le=c(1237),kc=c(197),kd=c(172);class nd extends Xc.a{constructor(cc,Ic){super();this.Y$a=new fb.a(new Zd.a);this.D1b=new le.a(wd.c);this.E1b=new kc.ScriptSharpLegacyMap;this.edk=cc;this.hek=Ic;this.E1b.add(rc.a.Qba,1);this.E1b.add(rc.a.MH,0);this.E1b.add(ic.a.gf,0);this.E1b.add(rc.a.VQ,2)}get index(){return 4}run(){let cc="";for(const Ic of this.Y$a)if(this.edk(Ic),this.D1b.nb(Ic.id))for(const Yc of this.D1b.J(Ic.id))cc+="_"+Yc;this.hek(cc);this.Y$a.clear();this.D1b=new le.a(wd.c)}S2k(cc,
Ic){cc=Ic.property;if(cc===rc.a.Qba||cc===rc.a.MH||cc===ic.a.gf||kd.App.mqe&&cc===rc.a.e5b||cc===rc.a.VQ)this.Y$a.add(Ic.node),this.E1b.nb(cc)&&(this.D1b.nb(Ic.node.id)||this.D1b.add(Ic.node.id,new uc.a),this.D1b.J(Ic.node.id).add(this.E1b.J(cc))),this.TY();pd.a.SPh.has(Ic.node.id.toString())&&cc===rc.a.hF&&ea.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}d3k(cc,Ic){Ic.property===ic.a.ho&&(cc=Ic.node,cc.iJb&&(this.Y$a.add(cc),this.TY()))}eJo(cc,Ic){this.Y$a.add(Ic.node);
this.TY()}}Object(l.a)(nd,"CommentNodeTransactionCompletedProcessor",Xc.a,[]);var Ud=c(1600),Qd=c(1639);class Gd{constructor(){this.hAe=new Map;this.lDe=new Map}jsk(cc,Ic){if(this.hAe.has(cc))throw Error("DuplicateDurableId");if(this.lDe.has(Ic))throw Error("DuplicateGuardId");this.hAe.set(cc,Ic);this.lDe.set(Ic,cc)}E_l(cc){return this.hAe.get(cc)}v9h(cc){return this.lDe.get(cc)}}Object(l.a)(Gd,"CommentIdMapper",null,[]);var of=c(14),Tf=c(1550),uh=c(1697),Gh=c(1601),Dh=c(123),lg=c(116),xh=c(995);
c.d(J,"a",function(){return eg});class eg extends a.a{constructor(cc,Ic,Yc,ad,yd,ne,Oe,nf,wf,Ye,Rg,Db,Zb,xc,Jd,ie,De,qf,tg,Ah,ji,Bh,Tj,sf,vf,Sf=null,ah){super();this.Dx=cc;this.KJe=Ic;this.FJe=Yc;this.Lc=ad;this.VZj=yd;this.Uwb=ne;this.IYe=Oe;this.Psc=nf;this.Ca=wf;this.rd=Ye;this.fn=Rg;this.oZb=Db;this.g_=Zb;this.dZb=xc;this.A5g=Jd;this.Sg=ie;this.Pm=De;this.uWa=qf;this.hj=tg;this.J2=Ah;this.rK=ji;this.b_a=Bh;this.ACc=Tj;this.Tsc=[];this.NWa=[];this.XVe=new k.a(0);this.Uvd=new k.a;this.azd=new fb.a(Pb.a.ih());
this.vVe=new fb.a(Pb.a.ih());this.Qkd=null;this.Gub=new k.a;this.Mye=!1;this.Sid=new x.a;this.a0g=!1;this.Ywe=new Set;this.twe=0;this.WZ=[];this.LWb=2;this.OCa=new k.a(!1);this.$zc=new x.a;this.Luc=new Map;this.Nid=new Gd;this.Oid=0;this.UZj=5;this.rMb=(mg,Bg)=>{mg=Bg.paragraphNode;for(const Cg of Bg.contents)this.eia(Cg.element,mg,Cg.intents,Cg.DG)};this.c2c=(mg,Bg)=>{if(mg.Mc.id.equals(this.xd.id)){this.uWa.uIa(7);var Cg=mg.getValue(rc.a.MH),ki=mg.getValue(rc.a.hF).toString();Cg=this.Sg.Rhb?this.Luc.has(ki)?
this.Luc.get(ki):ki:Cg;Cg=this.$D(Cg);if(Bg){if(Cg){this.Tx&&this.Tx.Df===Cg.id&&(ea.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.rK.logKpiFailure(Tf.a.NHd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Tf.a.yHd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));Bg=Cg.Df?"The comment is a reply":"";ki=wd.k(mg,y.a.nil).toString();const Rh=wd.h(mg,y.a.nil).toString();if(this.Sid.contains(Cg.id)&&!pd.a.GLm(Cg.H1a)){this.Sid.remove(Cg.id);const ml=
+new Date-+Cg.date;ea.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",wd.a(Cg),ml,ki,Rh,Bg)}else ea.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",wd.a(Cg),ki,Rh,Bg);this.gj.MLc(Cg);this.LRh(mg.id)}}else if(!Cg){this.rK.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();n.a.instance.Oa("WordEditor.Comments.EditorCommentManager")||ea.ULS.sendTraceTag(525379405,
327,10,"comment Manager resolve failed");if(this.Sg.$Db&&!this.hj.IY){this.J2.s$("OnCommentInit",Object.assign(new Ud.a,{HVi:()=>{this.wWf(mg);this.SOb()}}));return}this.Sg.$q||this.hj.IY||this.J2.s$("OnCommentInit");this.VNn(mg)||this.wWf(mg)}this.Mye=!0}};this.SOb=(mg=null)=>{this.Sg.dSb&&this.ksi();this.Sg.dSb&&this.Pwl();this.rJ.UOb(void 0,mg);this.uWa.uIa(8)};this.sZi=(mg,Bg,Cg)=>{if(mg.Mc.id.equals(this.xd.id)){var ki=mg.ja(rc.a.taskId,"");if(""===ki)ea.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");
else{if(Bg)if(this.vVe.add(ki),ki=this.dZb.value.$ii(mg),void 0!==ki&&null!==ki)this.Gub.remove(ki);else{ea.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.azd.add(ki),Bg=this.dZb.value,mg=Bg.$ii(mg),void 0!==mg&&null!==mg)for(this.Gub.J(mg)?this.Gub.Z(mg,ki):this.Gub.add(mg,ki),mg=Bg.bji(ki),Bg=0;Bg<mg.length;Bg++){var Rh=mg[Bg].commentId;Rh&&(Rh=Number.parseInvariant(Rh),this.Gub.J(Rh)||this.Gub.add(Rh,ki))}else{ea.ULS.sendTraceTag(591971723,
3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}Cg&&this.SOb()}}};this.GVo=mg=>{if(pd.a.IZd(mg)){const Cg=this.m0(mg.id.toString());if(Cg){const ki={text:Cg.text,done:Cg.done};var Bg=sb.GraphIterator.eb(mg);Cg.text=this.ZFb(Bg);this.QKi(Cg.text);Cg.done=mg.ja(rc.a.Qba,!1);mg.hasProperty(rc.a.VQ)&&(Bg=(Bg=mg.getValue(rc.a.VQ))?$b.b(Bg||""):null,Cg.usersByReactionType=Bg,Gh.a.YDh(Cg.usersByReactionType),this.TWk(Cg));this.JVo(mg,Cg);Cg.Df||this.OVo(mg,
Cg);!this.Sg.tva||!this.KE||this.Tx&&this.Tx.id===Cg.id||this.KE.fireEvent(10,{comment:Cg,ETi:ki})}}else this.rd.isFeatureEnabled(115)&&72===mg.type?this.sZi(mg,!1,!1):this.IVo(mg)};this.Qwl=()=>{const mg=this.hRd();for(this.Tsc.sort((Bg,Cg)=>{const ki=Bg.ja(rc.a.AM,null),Rh=Cg.ja(rc.a.AM,null);if(!ki&&Rh)return-1;if(!Rh&&ki)return 1;Bg.hasProperty(rc.a.XDa)&&Cg.hasProperty(rc.a.XDa)?(Bg=Bg.getValue(rc.a.XDa),Cg=Cg.getValue(rc.a.XDa),Cg=Bg<Cg):(Bg=new Date(Bg.getValue(rc.a.zJc)),Cg=new Date(Cg.getValue(rc.a.zJc)),
Cg=Bg<Cg);return Cg?-1:1});this.Tsc.length;){const Bg=this.Tsc[0];mg.ckb(Bg)&&(mg.Bj(Bg),this.gj.addComment(this.vJd(mg),null),this.gj.mode=1);Array.removeAt(this.Tsc,0)}if(mg.Tb(1))for(;mg.Lf(1););this.rd.isFeatureEnabled(115)&&this.dZb.value.dji();this.Mye&&(this.SOb(),this.Mye=!1)};this.jol=mg=>{1===mg&&(tb.WoncaApp.gme.DLh(),this.oZb.value.W7a(!0,"CommentInboundFailed"));this.g_.gI(lc.a.Taf,this.OFi)};this.oia=mg=>{if(!this.Sg.$q||mg.done)return!1;if(mg.Zq===t.a.beingCreated)return!0;if(mg.objectId){if(this.mKm(mg))return!1;
if(!this.OQm(mg.objectId)||mg.Df)return!0;for(const Bg of this.$O())if(Bg.Df===mg.id)return!0}return!1};eg.qK=Sf;this.qsd=new fb.a(Pb.a.ih());!this.Sg.$Db&&this.Sg.$q||Ab.a.QTa(this.c2c);vf.nDa(this.rMb);sf&&(sf.kw((mg,Bg)=>{mg=wd.o(this.WZ,Bg.node.id);0<this.WZ.length&&(!mg||mg===this.WZ.length-1)&&(this.LWb=1,this.WZ=[])}),ah.execute(mg=>{this.KE=mg}),z.AFrameworkApplication.VG&&(z.AFrameworkApplication.se("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.Sg.xJk&&Object(xh.a)().then(mg=>
{mg||this.urk()})))}urk(){v.a.instance.Wb(new I.a(5,1,0,()=>{const cc=this.Lc.Pc(7);cc.Db(this.pKa);var Ic=e.StaticActiveAppFrame.za().jb.Zc;Ic&&(Ic=vb.PageNavigator.instance.hP(Ic),Ic=sb.GraphIterator.eb(Ic),Ic.Rd(),Ic.Rd(),Ic.Rd(),Ic.Rd(),Eb.a.instance.Ac(Ua.SelectionFactory.mJ(Ic.currentNode,0,0)),Ic=new E.a,Ic.Yca("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),this.tDb(Eb.a.instance.ib.lb,
"Microsoft Word",Ic),cc.dispose(),Ia.a("ShareTUICommentCreated"),ea.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get rJ(){return this.gj}get H1e(){return this.fh}get OFi(){return null!=this.gEg?this.gEg:this.gEg=Object.assign(new Ta.a,{h8:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,ona:1})}get Yr(){return this.Lc}get px(){return this.Dx.value}get xd(){return this.px.xd}get pKa(){return this.KJe.value}get ZDa(){return this.FJe.value}get mb(){return this.Uwb.value}get dZ(){return this.Ca.kb("PresenceUserId")}get P6a(){return this.Ca.kb("PresenceProvider")}eia(cc,
Ic,Yc,ad){if(Yc&&this.Tx&&(!this.Tx||!this.Tx.Df)){var yd=!1;for(const ne of Yc)if(3===ne.type)switch(yd=!0,Yc=wd.n(this.WZ,ne.id),-1<Yc&&(this.WZ[Yc].Zhc=Ic.id),cc.classList.add(Nb.a.rMd),ad){case 1:cc.classList.add(Nb.a.ohf);break;case 0:cc.classList.add(Nb.a.phf)}yd||cc.classList.remove(Nb.a.rMd,Nb.a.phf,Nb.a.ohf);this.uWa.uIa(3)}}Bpf(cc=!1){return this.IYe.yKl(this.fh,z.AFrameworkApplication.va.mode,Ic=>!this.Sg.tRb||!cc||this.oia(Ic))}epf(cc){return this.IYe.PQl(this.gj.model.$O(),z.AFrameworkApplication.va.mode,
cc)}Stf(cc){if(!cc||!cc.Df)return cc;cc=cc.Df;for(let Ic=0;Ic<this.fh.length;Ic++)if(this.fh[Ic].id===cc)return this.fh[Ic];return null}D$k(){const cc=[];if(this.rd.isFeatureEnabled(115)){var Ic=this.dZb.value;for(const Yc of Ic.dji())(Ic=this.F4h(Yc))&&cc.push(Ic)}return cc}jzm(cc){if(!this.NWa)throw H.a.invalidOperation("UpdateContent must have been called before this.");for(let Ic=0;Ic<this.NWa.length;Ic++)if(this.NWa[Ic].id===cc)return Ic;return-1}ksi(){const cc=new db.a;for(const Yc of this.fh)if(Yc.objectId&&
Yc.fxa){var Ic=y.a.If(Yc.objectId);if((Ic=this.xd.Eb(Ic))&&Ic.hasProperty(rc.a.hF))if(Ic=Ic.getValue(rc.a.hF).toString(),cc.nb(Ic)){const ad=cc.J(Ic).CommentId;this.AQj(ad,Yc,Ic)}else cc.add(Ic,new M(Yc.id,Yc.done))}this.Qkd=cc}AQj(cc,Ic,Yc){cc!==Ic.fxa?(ea.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",Yc,Ic.objectId,Ic.fxa,cc),this.rK.logKpiFailure(Tf.a.h5b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Tf.a.g5b,isInternal:!0})):ea.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",Yc,Ic.fxa,Ic.objectId)}F4h(cc){const Ic=this.A5g.value;var Yc=this.dZb.value;const ad=Yc.gac(cc);if(void 0===ad||null===ad)return ea.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",cc),null;Yc=Yc.bji(cc);try{return Ic.Qfl(cc,ad.toString(),Yc,this.Qkd)}catch(yd){return ea.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",yd.message),null}}I7h(cc=!1,Ic=!1){const Yc=new x.a,ad=Ic?wd.j():new Set;this.OCa.keys.forEach(yd=>{ad.has(yd)||cc&&this.OCa.J(yd)||Yc.add(yd);return!0});return Yc}wTd(){if(!this.fh)return 0;let cc=0;for(const Ic of this.fh)Ic.Df||cc++;return cc}DWc(cc){var Ic,Yc;return(null===(Yc=null===(Ic=this.Tx)||void 0===Ic?void 0:Ic.Cz)||void 0===Yc?void 0:Yc.draftId)===cc}msk(cc){var Ic;if(cc.Zq===t.a.beingCreated){if(this.gj.mode=2,this.Ubb=cc,
this.mb.ib){var Yc=this.mb.ib.lb;if(Yc&&Yc.Pa){Yc=this.q_o(Yc);for(var ad=0;ad<Yc.length;ad++){var yd=Yc.J(ad).node;if(!Wa.ParagraphReader.Xb(yd)||!(-1!==Yc.J(ad).cpBegin&&-1!==Yc.J(ad).cpEnd||-1!==Yc.J(ad).Wj&&-1!==Yc.J(ad).vp))continue;var ne=-1===Yc.J(ad).cpBegin?Yc.J(ad).Wj:Yc.J(ad).cpBegin;const Oe=-1===Yc.J(ad).cpEnd?Yc.J(ad).vp:Yc.J(ad).cpEnd,nf=y.a.create();this.fn.nHa(yd,new Bb.a(3,ne,Oe,nf));this.WZ.push(new Je(yd.id,nf));this.Tsk(null===(Ic=cc.Cz)||void 0===Ic?void 0:Ic.draftId,yd,ne,Yc)}}}}else this.M6f(cc);
Yc=({index:Ic}=this.wne(cc)).returnValue;ad=null;if(!cc.Df){yd=this.I7h();cc.Zq!==t.a.beingCreated&&(ad=this.jem(cc),yd.remove(cc.objectId));yd=({index:ne}=this.e6l(ad,yd)).returnValue;Ic=-1<ne?ne:Ic;ne=0;if(yd)for(;Ic<this.fh.length&&this.fh[Ic].Df;)Ic++;if(!yd&&this.Sg.$q&&cc.Zq===t.a.beingCreated)for(yd=0;yd<Ic;yd++)this.fh[yd].Df||this.fh[yd].done||ne++;this.iFo(cc,ne)}Yc&&(Array.insert(this.fh,Ic,cc),this.Sg.tva&&this.KE&&cc.Zq!==t.a.beingCreated&&(cc.Df?this.KE.fireEvent(10,{comment:cc,changeType:"replyAdded"}):
this.KE.fireEvent(11,{comment:cc})),this.psk(cc,ad))}q_o(cc){if(this.Sg.cAl){var Ic=Ob.SelectionEditor.kAl(cc);Ic&&(this.mb.Ac(Ic),cc=Ic)}else Ob.SelectionEditor.Pl(cc)&&(Ic=Ob.SelectionEditor.j0(cc.Pa,!1))&&(this.mb.Ac(Ic),cc=Ic);return cc}Tsk(cc,Ic,Yc,ad){this.Sg.contentNavigationApiEnabled&&cc&&Ic&&ad&&this.ACc.Y_e({contentId:cc,containerContentType:0,n$:{Bd:Yc,cN:Ic.Uk}},{selection:ad})}psk(cc,Ic){if(this.Sg.contentNavigationApiEnabled&&cc&&!cc.Df&&cc.Zq!==t.a.beingCreated){var Yc=this.xd.Eb(cc.objectId);
if(Yc){var ad=wd.k(Yc,y.a.nil);ad=this.xd.Eb(ad);ad=pd.a.Gwa(ad,Yc.id,!1);(null===ad||void 0===ad?0:ad.Lb)&&(null===ad||void 0===ad?0:ad.paragraph)?this.ACc.Y_e({contentId:cc.id,containerContentType:0,n$:{Bd:ad.Lb.cp,cN:ad.paragraph.Uk}},{selection:Ic}):ea.ULS.sendTraceTag(520717896,327,10,`comment object id: ${Yc.id},
        commentStartRangeObject Valid: ${!!ad},
        containingProperties Valid: ${!(null===ad||void 0===ad||!ad.Lb)},
        paragraph valid: ${!(null===ad||void 0===ad||!ad.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}uva(cc){super.uva(cc);this.Sid.add(cc.id)}H4n(cc,Ic){this.Sg.contentNavigationApiEnabled&&this.ACc.G4n(cc,Ic)}iFo(cc,Ic){this.Sg.$q&&cc.Zq===t.a.beingCreated&&cc.Cz&&this.XVe.Z(cc.Cz.draftId,Ic)}vim(cc){return this.XVe.J(cc)}paj(cc){this.XVe.remove(cc)}x1l(cc){let Ic=0,Yc=0;for(let ad=0;ad<this.fh.length;ad++){if(this.fh[ad].id===cc.id){Yc=ad;break}this.fh[ad].Df||this.fh[ad].done||Ic++}return{returnValue:Yc,SKo:Ic}}Tuf(cc){var Ic=null,Yc=this.xd.Eb(cc);
cc=pd.a.uca(Yc,this.xd,!0);Yc=pd.a.uca(Yc,this.xd,!1);cc&&Yc&&(Ic=Ua.SelectionFactory.ne(cc.Lb.paragraph,cc.Lb.cp),Ic=Ua.SelectionFactory.Iy(Ic,hc.a.Uc(Yc.Lb.paragraph,Yc.Lb.cp)));cc&&Yc||this.rK.logKpiFailure(Tf.a.h5b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return Ic}jem(cc){cc=y.a.If(cc.objectId);return this.Tuf(cc)}C8f(cc,Ic){var Yc=this.xd.Eb(cc);if(Yc){var ad=this.xd.Eb(wd.k(Yc));Yc=this.xd.Eb(wd.h(Yc));if(ad===Yc)for(Yc=0;Yc<ad.ra.length&&!ad.ra.J(Yc).gRo(cc,Ic);Yc++);}}e6l(cc,
Ic){let Yc=-1;var ad=null;cc||(cc=this.mb.ib?this.mb.ib.lb:null);if(!cc||!cc.Pa)return{returnValue:null,index:Yc};const yd=this.qfi(cc.Pa);if(!yd)return{returnValue:null,index:Yc};var ne=pd.a.S2l(yd.iterator.currentNode,cc.Pa.cpBegin,this.Sg.$q,Ic);ne&&(ad=this.m0(ne.Lj.toString()),ne=Array.indexOf(this.fh,ad),ad=0<=ne?ad:null,Yc=0<=ne?ne+1:Yc);ad||(cc=this.G7h(yd,cc.Pa,this.Sg.$q,Ic),ad=0<=cc?this.fh[cc]:null,Yc=0<=cc?cc:Yc);return{returnValue:ad,index:Yc}}MSl(cc=null){var Ic=null;Ic=this.mb.ib.lb;
return Ic&&Ic.Pa?this.RYl(Ic.Pa,this.Sg.$q,cc):null}qfi(cc){const Ic=new sb.GraphIterator;Ic.set(cc.node);return Ic.Ip()?Gc.a.Gs(Ic,Ic.origin):null}RYl(cc,Ic,Yc=null){const ad=this.qfi(cc);cc=this.G7h(ad,cc,Ic,Yc);return-1<cc?this.fh[cc]:null}G7h(cc,Ic,Yc,ad=null){let yd=-1;if(cc)for(Ic=Ic.cpBegin;-1===yd&&cc.moveNext();)Wa.ParagraphReader.oh(cc.iterator)&&((Ic=pd.a.fQc(cc.iterator.currentNode,Ic,Yc,ad))&&(yd=Array.indexOf(this.fh,this.m0(Ic.Lj.toString()))),Ic=0);return yd}ywi(cc){const Ic=cc.toString();
return this.OCa.nb(Ic)&&this.OCa.J(Ic)||this.$zc.contains(cc)&&this.xd.jxa(cc)&&this.xd.Eb(cc).ja(rc.a.Qba,!1)}mlj(cc,Ic=!1){if(cc=this.gQc(cc))cc.TGf=!Ic}rHf(cc){return this.OCa.nb(cc.toString())||this.$zc.contains(cc)&&this.xd.jxa(cc)&&!this.xd.Eb(cc).ja(rc.a.AM,null)}M6f(cc){!cc.objectId||cc.Df||this.OCa.nb(cc.objectId)||this.OCa.add(cc.objectId,cc.done)}deleteComment(cc){cc&&!cc.Df&&(this.Sg.$q&&cc.Zq!==t.a.beingCreated?this.OCa.remove(cc.objectId):cc.Zq===t.a.beingCreated&&this.xEj());this.Sid.remove(cc.id);
return super.deleteComment(cc)}Iqf(cc){return cc&&cc.hasProperty(rc.a.hF)?cc.tf(rc.a.hF).toString():""}gQc(cc){if(!cc)return null;if(this.Sg.Rhb)return this.$D(cc);for(const Ic of this.fh){const Yc=this.xd.Eb(y.a.If(Ic.objectId));if(this.Iqf(Yc)===cc.toString())return cc=Yc.tf(rc.a.MH),this.$D(cc)}return null}C5f(cc,Ic=!1){if(cc&&pd.a.IZd(cc)&&this.rd.isFeatureEnabled(115)){const Yc=this.Iqf(cc);if(""!==Yc){if(Ic){let ad;if(this.Qkd&&({value:ad}=this.Qkd.Fc(Yc,ad)).returnValue&&ad.ResolveState===
cc.ja(rc.a.Qba,!1))return}(cc=this.Gub.J(Number.parseInvariant(Yc)))&&this.azd.add(cc)}}}VNn(cc){const Ic=this.zpf(cc);let Yc=!1;Ic.wke&&Ic.YMd||(this.$zc.add(cc.id),Yc=!0,this.OUi(cc));return Yc}OUi(cc){K.a.T3(z.AFrameworkApplication.lc,()=>{this.wWf(cc);this.$zc.remove(cc.id);this.$zc.count||(this.SOb(),this.rJ.RWo())},"DelayLoadCommentNodeIntoModel")}wWf(cc){if(!this.gj&&(ea.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.Oid<this.UZj)){this.Oid+=1;this.OUi(cc);ea.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.Oid}`);return}const Ic=this.hRd();Ic.Bj(cc);if(Ic.Jz()){let Yc;try{Yc=this.vJd(Ic)}catch(ad){ea.ULS.Vz(512553930,327,10,ad,"create comment from comment node failed")}if(!Yc){ea.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===cc||void 0===cc?void 0:cc.id}`);this.rK.logKpiFailure(Tf.a.h5b,"CommentCreationFailed",{isInternal:!0},{name:Tf.a.g5b,isInternal:!0});return}this.gj.addComment(Yc,null);2!==this.gj.mode&&3!==this.gj.mode&&(this.gj.mode=
1);this.C5f(cc);this.jjn(Yc);this.wKj(Yc)}else this.Tsc.push(cc);this.J2.s$("OnCommentNodeAdded",{commentNode:cc})}jjn(cc){this.Sg.$q&&!this.hj.Am&&this.rJ.Tz&&cc.Df&&this.rJ.Tz.id===cc.Df&&this.rJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,cc.author),!1)}zpf(cc){const Ic=new cd;Ic.cbd=wd.k(cc,y.a.nil);Ic.qNc=wd.h(cc,y.a.nil);cc=Ic.cbd.equals(y.a.nil);const Yc=Ic.qNc.equals(y.a.nil);cc||(Ic.WDa=this.xd.Eb(Ic.cbd),Ic.wke=!!Ic.WDa&&Ic.WDa.isConnected);Yc||(Ic.ROa=this.xd.Eb(Ic.qNc),
Ic.YMd=!!Ic.ROa&&Ic.ROa.isConnected);return Ic}KXh(cc,Ic){const Yc=this.jzm(cc);-1!==Yc&&Array.removeAt(this.NWa,Yc);Ic||((cc=this.F4h(cc))?this.NWa.push(cc):ea.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}Pwl(){for(const cc of this.azd)this.KXh(cc,!1);this.azd.clear();for(const cc of this.vVe)this.KXh(cc,!0);this.vVe.clear()}wne(cc){var Ic=this.fh.length,Yc=!1;if(cc.Df){var ad=(Yc=this.$D(cc.Df))&&Yc.objectId?this.xd.Eb(y.a.If(Yc.objectId)):null;ad=!!ad&&ad.hasProperty(rc.a.XDa);
Ic=Array.indexOf(this.fh,Yc);Yc=0>Ic;for(Ic+=1;Ic<this.fh.length&&this.fh[Ic].Df===cc.Df&&this.fh[Ic]!==this.Tx&&!(ad&&cc.date<this.fh[Ic].date);)Ic++}return{returnValue:!Yc,index:Ic}}Pvm(){const cc=new nd(this.GVo,this.SOb),Ic=bc.App.li.Al;Ic.Te(40).qo(Object(Ec.a)(cc,cc.S2k,"commentPropertyChanged"));Ic.Te(12).qo(Object(Ec.a)(cc,cc.d3k,"commentTextChanged"));this.rd.isFeatureEnabled(115)&&Ic.Te(72).qo(Object(Ec.a)(cc,cc.eJo,"taskPropertyChanged"));Dc.GraphTransactionManager.instance.pra(cc,3)}QKi(cc){this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&cc&&0!==cc.length&&(cc=E.a.hGb(cc[0]),1<cc.ops.length||0===cc.ops.length||("\n"===cc.ops[0].insert&&(this.twe+=1),3<this.twe&&ea.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}TWk(cc){if(cc&&this.Ywe.has(cc.id)){var Ic=cc.usersByReactionType[1];for(let Yc=0;Ic&&Yc<Ic.length;Yc++)if(Ic[Yc].UserId===this.dZ)return;ea.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${cc.objectId} removed by inbound changes`)}}OVo(cc,Ic){this.c0k(Ic);
const Yc=this.Sg.$q;Yc&&this.msm(Ic)?(this.okl(Ic),this.C5f(cc),this.YZo(Ic)):Yc||this.C5f(cc,!0)}IVo(cc){const Ic=new sb.GraphIterator;Ic.set(cc);Ic.zb(40);Ic.jd(40);if(Ic.currentNode){if(cc=this.m0(Ic.currentNode.id.toString())){const Yc={done:cc.done,text:cc.text};cc.text=this.ZFb(Ic);this.QKi(cc.text);!this.Sg.tva||!this.KE||this.Tx&&this.Tx.id===cc.id||this.KE.fireEvent(10,{comment:cc,ETi:Yc})}}else ea.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Ub.a[cc.type])}YZo(cc){if(!this.hj.Am){var Ic=
new uc.a;this.Joe(cc,Ic);0<Ic.count&&Rb.b(Ic)}}okl(cc){const Ic=new I.a(0,1,0,()=>{this.HVo(cc)},137,void 0,!0);z.AFrameworkApplication.lc.Wb(Ic)}c0k(cc){var Ic;null!==(Ic=this.Tx)&&void 0!==Ic&&Ic.Cz&&this.Tx.Cz.sessionType!==L.a.metadata&&(Ic=this.Tx,cc.Df||!cc.done||Ic.Df!==cc.id&&Ic.id!==cc.id||(ea.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",Ic.Zq),this.rK.logKpiFailure(Tf.a.NHd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Tf.a.yHd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),Ic.Zq===t.a.beingCreated?(this.gj.clearSelection(),this.deleteComment(Ic),this.selectComment(cc)):Ic.Zq===t.a.beingEdited&&(Ic.Zq=t.a.normal,Ic.pUa=S.a.succeeded,this.gj.g7e())))}JVo(cc,Ic){var Yc;const ad=null===(Yc=Ic.Cz)||void 0===Yc?void 0:Yc.draftId;if(this.Sg.Rhb){if(cc=cc.getValue(rc.a.hF).toString(),Ic.id!==cc){if(!Ic.Df)for(Yc=Array.indexOf(this.fh,Ic)+1;Yc<this.fh.length&&this.fh[Yc].Df===Ic.id;Yc++)this.fh[Yc].Df=cc;ea.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");Ic.id=cc;this.Luc.has(cc)&&this.Luc.delete(cc)}}else if(cc=cc.getValue(rc.a.MH),Ic.id!==cc){if(!Ic.Df)for(Yc=Array.indexOf(this.fh,Ic)+1;Yc<this.fh.length&&this.fh[Yc].Df===Ic.id;Yc++)this.fh[Yc].Df=cc;Ic.id=cc}ad&&this.H4n(ad,Ic.id)}msm(cc){return this.OCa.nb(cc.objectId)&&this.OCa.J(cc.objectId)!==cc.done}HVo(cc){this.OCa.Z(cc.objectId,cc.done);if(cc.done)if(this.rJ.Uoc(cc),this.hj.Am)this.rJ.w2c(cc,!0);else{var Ic=new I.a(0,1,0,()=>{this.rJ.w2c(cc,!0,!1);this.Uvd.remove(cc.id)},
139);this.Uvd.add(cc.id,Ic);z.AFrameworkApplication.lc.Wb(Ic);this.pz&&cc.id===(void 0===this.pz.Df||null===this.pz.Df?this.pz.id:this.pz.Df)&&this.rJ.clearSelection()}else this.rJ.Uoc(cc),Ic=null,({value:Ic}=this.Uvd.Fc(cc.id)).returnValue?(z.AFrameworkApplication.lc.ff(Ic),this.Uvd.remove(cc.id)):this.rJ.w2c(cc,!1)}QWi(){this.hBm();this.fBm();z.AFrameworkApplication.K.$("IsDocumentOwner")||n.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(cc=>{cc.logActivity("ShowTUIForCommentAwareness",
null)})}fBm(){this.Sg.dSb&&this.ksi();this.Sg.dSb&&(this.NWa=this.D$k(),ed.a.QTa(this.sZi))}hBm(){!this.Sg.$Db&&this.Sg.$q&&Ab.a.QTa(this.c2c);this.Pvm();this.Ovm()}Ovm(){const cc=new Ac(this.Qwl),Ic=bc.App.li.Al;Ic.Te(39).qo(Object(Ec.a)(cc,cc.gHh,"commentContainerPropertyChanged"));this.rd.isFeatureEnabled(115)&&Ic.Te(71).qo(Object(Ec.a)(cc,cc.gHh,"commentContainerPropertyChanged"));Dc.GraphTransactionManager.instance.pra(cc,3)}m0(cc){for(let Ic=0;Ic<this.fh.length;Ic++){const Yc=this.fh[Ic];if(Yc.objectId===
cc)return Yc}return null}rwk(cc){if(cc)for(const Ic of cc)Ic&&this.qsd.add(Ic)}mZk(){this.qsd.clear()}RZe(cc,Ic){Array.insert(this.fh,Ic,cc);this.M6f(cc);this.d5m(cc);Ic=this.KRd(cc);this.qsd.contains(Ic)&&(cc.TGf=!0,this.qsd.remove(Ic))}wKj(cc){wd.p(cc)||ea.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${cc.objectId}`)}d5m(cc){ea.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${wd.a(cc)} `)}vJd(cc){40!==cc.Xe&&ea.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const Ic=cc.currentNode;var Yc=Ic.getValue(rc.a.e5b),ad=Ic.getValue(rc.a.MH);const yd=Ic.getValue(rc.a.hF).toString(),ne=Ic.getValue(rc.a.zJc);let Oe=null,nf=null;if(Ic.hasProperty(rc.a.VQ)){var wf=Ic.getValue(rc.a.VQ);Oe=wf?$b.b(wf||""):null;Gh.a.YDh(Oe)}Ic.hasProperty(rc.a.XDa)&&(nf=Ic.getValue(rc.a.XDa));let Ye=null,Rg=null;Ic.hasProperty(rc.a.vHd)&&Ic.hasProperty(rc.a.yJc)&&(Ye=Ic.getValue(rc.a.vHd),Rg=Ic.getValue(rc.a.yJc));wf=wd.k(Ic,y.a.nil).toString();const Db=wd.h(Ic,y.a.nil).toString(),
Zb=Ic.ja(rc.a.Qba,!1),xc=Ic.ja(rc.a.AM,null),Jd=Ic.ja(rc.a.ikb,!1);let ie;Ic.attrString?(ad=this.ial(Ic.attrString),ie=ad.paragraphs,ad=ad.fxa.toString()):ie=this.ZFb(cc);Yc=new Q.Comment(this.Sg.Rhb?yd:ad,ad,Yc,nf||new Date(ne),this.Sg.Rhb?this.Nid.v9h(xc):xc,Zb,ie,Q.Comment.q0i,Jd,Rg,Ye,Oe);Yc.HGc=wf;Yc.GGc=Db;Yc.objectId=Ic.id.toString();Yc.H1a=yd;this.Hoh(yd,ad);cc.jd(39);return Yc}ial(cc){let Ic=cc.tFl(new Fc.a(0));const Yc=new E.a;let ad=0;for(;Ic&&!Ic.kre();){let yd=void 0;Ic.vAi||(yd=cc.JB(Ic));
const ne=cc.Yha(Ic.pbe),Oe=ne&&ne.properties.get("2");ne&&ne.properties.forEach(()=>{});const nf=new N.a;"para"==Oe?ad=null===ne||void 0===ne?void 0:ne.properties.get("5417"):Oe||(nf.weight=(null===ne||void 0===ne?0:ne.properties.get("1436"))?E.a.e5d:0,Yc.RCf(yd,nf),Yc.Yca("\n"));Ic=cc.W6l(Ic)}return{fxa:ad,paragraphs:[Yc.O9b()]}}Hoh(cc,Ic){(!cc||Number.parseInvariant(cc)>=pd.a.bOi)&&ea.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${cc}`);Ic||ea.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${Ic}`);
try{this.Nid.jsk(cc,Ic)}catch(Yc){"DuplicateDurableId"===Yc.message?ea.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${cc} with Guard Id: ${Ic}`):"DuplicateGuardId"===Yc.message?ea.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${Ic} with Durable Id: ${cc}`):ea.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Yc}`)}}ZFb(cc){var Ic;if(40!==cc.Xe)return ea.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",cc.Xe),this.Psc.$mg([]);
let Yc=cc.Xe+":";const ad=cc.Wp();0<ad?(cc.Rd(),Yc+=cc.Xe+":"):(ea.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(Ic=cc.currentNode)||void 0===Ic?void 0:Ic.id}`),Ic=new Dh.a,Ic.inStaging=!0,this.rK.logKpiFailure(Tf.a.h5b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Tf.a.yHd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Ic},lg.a));Ic=Array(ad);for(let yd=0;yd<ad;yd++){cc.Rd();Yc+=cc.Xe+":";const ne=cc.currentNode;ne.iJb=!0;Ic[yd]=
ne;ne.ra||ea.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+Yc);!ne.ra&&this.Sg.Aeo&&(z.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.Ep());cc.sc();cc.Oj();Yc+=yd<ad-1?":"+cc.Xe+":":":"}return this.Psc.$mg(Ic)}Ep(){if(tb.WoncaApp.gme){var cc=new Xb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);
cc.Cd=1;cc.ye(1,WoncaIntl.WoncaStrings.l_SendErrorReport);cc.ye(0,WoncaIntl.WoncaStrings.l_NoThanks);cc.FV(1);cc.wx(lc.a.Taf,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.jol,!1)}else this.g_.gI(lc.a.Taf,this.OFi)}KRd(cc){if(!cc||!cc.objectId)return"";cc=y.a.If(cc.objectId);cc=this.xd.Eb(cc);return this.Iqf(cc)}$9l(cc){return this.KRd(cc.Df?this.$D(cc.Df):cc)}iUn(cc,Ic){if(this.rd.isFeatureEnabled(115))if(this.Sg.aea)ea.ULS.sendTraceTag(595128897,3003,
50,"RecordTaskChanges no ops because filter PII flag on"),this.SOb();else{this.b_a.Sv(eb.a.Tfg);var Yc=null===Ic||void 0===Ic?void 0:Ic.taskId,ad=!Yc;ad?this.b_a.logKpiUsage(uh.a.Ple,0):this.b_a.logKpiUsage(uh.a.Qle,0);try{const wf=this.dZb.value,Ye=this.KRd(cc);if(""===Ye)this.U3d(ad,"FailedDurableIdForComment");else{var yd=this.$9l(cc);if(""===yd)this.U3d(ad,"FailedDurableIdForParentComment");else if(ad&&cc.Cz.sessionType!==L.a.create&&cc.Cz.sessionType!==L.a.reply)ea.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",cc.Cz.sessionType),this.b_a.logKpiFailure(uh.a.Ple,"FailedTaskCreateInvalidSessionType");else{var ne=null;cc.Cz.sessionType!==L.a.metadata&&(ne=Ye);var Oe=this.A5g.value;var nf=O.a.af(cc.text)?Oe.p4h(ne,Ic,ad):Oe.p4h(ne,Ic,ad,cc.text[0]);0<nf.length?ad?(wf.Ugb(Number.parseInvariant(yd),nf)||this.b_a.logKpiFailure(uh.a.Ple,"TaskCreateFailed"),this.SOb()):(this.b_a.logKpiUsage(uh.a.Qle,0),wf.DEk(Yc,nf)||this.b_a.logKpiFailure(uh.a.Qle,
"TaskEngagementFailed")):this.U3d(ad,"HistoryRecordsLengthZero")}}}catch(wf){this.U3d(ad,"RecordTaskChangesFailed")}}}U3d(cc,Ic){const Yc={name:uh.a.YIo,isInternal:!0};cc?this.b_a.logKpiFailure(uh.a.Ple,Ic,Yc):this.b_a.logKpiFailure(uh.a.Qle,Ic,Yc)}PBd(cc,Ic){if(cc){var Yc=z.AFrameworkApplication.userName,ad=Ic.toString();cc.usersByReactionType||(cc.usersByReactionType={});var yd=cc.usersByReactionType[ad];Yc=new U(this.dZ,this.P6a,Yc);Yc.DateUtc=new Date;yd?yd.push(Yc):cc.usersByReactionType[ad]=
[Yc];ea.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",Ic,cc.Df?"reply":"parent",cc.objectId);ad=[cc];this.rK.Sv(of.a.T2k,{succeeded:!0,customData:{reactionType:T[Ic]}});this.o6c(ad,Y.addReaction);this.Ywe.add(cc.id)}}Ode(cc,Ic){if(cc&&cc.usersByReactionType){var Yc=cc.usersByReactionType[Ic.toString()];if(Yc&&Yc.length){for(let ad=0;ad<Yc.length;ad++)if(Yc[ad].UserId===this.dZ){Array.removeAt(Yc,ad);break}ea.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
Ic,cc.Df?"reply":"parent",cc.objectId);Yc=[cc];this.rK.Sv(of.a.V2k,{succeeded:!0,customData:{reactionType:T[Ic]}});this.Ywe.delete(cc.id);this.o6c(Yc,Y.removeReaction)}}}o6c(cc,Ic){const Yc=this.Lc.Pc(15);Yc.Db(this.pKa);this.px.rF.f8(3);switch(Ic){case Y.deleteComment:for(Ic=0;Ic<cc.length;Ic++){var ad=cc[Ic];if(ad.Zq===t.a.beingCreated)this.Sg.contentNavigationApiEnabled&&this.ACc.remove(ad.Cz.draftId),this.rJ.Ppg();else{var yd=y.a.If(ad.objectId);(yd=this.xd.Eb(yd))&&pd.a.aLd(yd,this.xd);ea.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${ad.objectId}]`);this.Sg.tva&&this.KE&&(ad.Df?this.KE.fireEvent(10,{comment:ad,changeType:"replyDeleted"}):this.KE.fireEvent(7,{comment:ad}));this.Sg.contentNavigationApiEnabled&&this.ACc.remove(ad.id)}}break;case Y.addComment:this.gj.mode=1;cc=cc[0];cc.date=new Date;Ic=this.idl(cc);ad=Ic.getValue(rc.a.hF).toString();cc.H1a=ad;this.Sg.Rhb&&this.Luc.set(ad,cc.id);ad=cc.text;yd=this.hRd();if(cc.Df){var ne=this.$D(cc.Df),Oe=this.xd.Eb(y.a.If(ne.objectId));
Ic.setValue(rc.a.AM,Oe.getValue(rc.a.MH));this.addReply(Ic,ad,this.xd,yd,Oe);ea.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${cc.objectId}][ParentObjectId:${ne.objectId}]`)}else(ne=this.mb.ib.lb)&&ne.Pa&&(Ob.SelectionEditor.Pl(ne)&&(Oe=Ob.SelectionEditor.j0(ne.Pa,!1))&&(this.mb.Ac(Oe),ne=Oe,ea.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Wa.ParagraphReader.Xb(ne.Pa.node)&&Wa.ParagraphReader.Xb(ne.Rc.node)&&(this.VAb(Ic,ad,yd,ne),ea.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${cc.objectId}]`)));ad=Ic.ja(rc.a.MH,null);cc.fxa=ad;cc.pUa=S.a.sentToServer;cc.pUa=S.a.succeeded;cc.objectId=Ic.id.toString();this.M6f(cc);this.wKj(cc);this.Hoh(cc.H1a,cc.fxa);this.Sg.tva&&this.KE&&(cc.Df?this.KE.fireEvent(10,{comment:cc,changeType:"replyAdded"}):this.KE.fireEvent(11,{comment:cc}));break;case Y.editComment:this.gj.mode=1;cc=cc[0];Ic=y.a.If(cc.objectId);Ic=this.xd.Eb(Ic);ad=cc.fxa;cc.fxa||(ad=Ic.getValue(rc.a.MH),ea.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${cc.objectId} while editing`),ad=this.Sg.Rhb?ad:cc.id);this.IFj(Ic,cc.text,ad);ea.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${cc.objectId}]`);cc.pUa=S.a.sentToServer;cc.pUa=S.a.succeeded;this.Sg.tva&&this.KE&&this.KE.fireEvent(10,{comment:cc,changeType:cc.Df?"replyEdited":"edited"});break;case Y.addReaction:case Y.removeReaction:Ic=cc[0];cc=y.a.If(Ic.objectId);cc=this.xd.Eb(cc);(Ic=(Ic=Ic.usersByReactionType)?$b.c(Ic):"")&&cc.setValue(rc.a.VQ,
Ic);break;case Y.done:case Y.undone:for(Ic=0;Ic<cc.length;Ic++)ad=cc[Ic],yd=y.a.If(ad.objectId),this.xd.Eb(yd).setValue(rc.a.Qba,ad.done),ea.ULS.sendTraceTag(594124932,327,50,`${ad.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${ad.objectId}]`),this.Sg.tva&&this.KE&&this.KE.fireEvent(10,{comment:ad,changeType:ad.done?"resolved":"reopened"})}this.Pm.sF();ea.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");Yc.dispose()}hRd(){const cc=new sb.GraphIterator;
cc.set(this.px);this.ZDa.Z5a(cc);return cc}a9c(){return this.Xij(!0)}b9c(){return this.Xij(!1)}Xij(cc){if(!this.fh.length)return null;let Ic=this.pz;do{if(Ic){const Yc=this.Sg.$q&&!this.hj.Am;Ic=cc?this.PYl(Ic,Yc):this.QYl(Ic,Yc)}else Ic=cc?this.fh[0]:this.fh[this.fh.length-1];if(!Ic)return null}while(Ic.Df&&""!==Ic.Df);this.selectComment(Ic);return Ic}VLh(cc,Ic,Yc,ad,yd){const ne=this.VZj.create(1074135127);this.Sg.aea&&(Ic=CommonUIStrings.l_RemovedAuthorName,Yc=null);ne.setValue(rc.a.commentId,
aa.a.FF());ne.setValue(rc.a.hF,pd.a.Hqf());ne.setValue(rc.a.SOa,z.AFrameworkApplication.userSessionId);ne.setValue(rc.a.MH,cc);ne.setValue(rc.a.e5b,Ic);ne.setValue(rc.a.AHh,Ic);ne.setValue(rc.a.zJc,Yc?ba.a.XPd(Yc,"MM/dd/yyyy HH:mm:ss",ba.a.dataCulture):"");ne.setValue(rc.a.XDa,Yc);ne.setValue(rc.a.Qba,ad);yd&&(cc=yd?$b.c(yd):"",ne.setValue(rc.a.VQ,cc));ne.setValue(rc.a.yJc,this.dZ);ne.setValue(rc.a.vHd,this.P6a);return ne}idl(cc){var Ic;const Yc=this.VLh(cc.id,cc.author,cc.date,cc.done,null!==(Ic=
cc.usersByReactionType)&&void 0!==Ic?Ic:{});cc.Df&&(this.Sg.Rhb?((Ic=this.Nid.E_l(cc.Df))||ea.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${cc.Df}`),cc=Ic):cc=cc.Df,Yc.setValue(rc.a.AM,cc));return Yc}addReply(cc,Ic,Yc,ad,yd){this.addComment(cc,Ic,ad);Ic=eg.Wph(cc,Yc,yd,!0);Yc=eg.Wph(cc,Yc,yd,!1);Ic&&wd.v(cc,Ic.Lb.paragraph.id);Yc&&(wd.u(cc,Yc.Lb.paragraph.id),Yc.Lb.paragraph.id||ea.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}VAb(cc,Ic,Yc,
ad){this.addComment(cc,Ic,Yc);let yd,ne;({start:Ic,end:yd,startCp:Yc,endCp:ne,Mvh:Oe}=this.cRk());Oe&&(ad.Pa.node===Ic&&(Yc=Sa.a.fjb(ad,!0)),ad.Rc.node===yd&&(ne=Sa.a.fjb(ad,!1)));if(-1===Yc||-1===ne){this.a0g||0!==this.LWb||(this.rK.logKpiFailure(Tf.a.P9e,"DraftSelectionLost",{isInternal:!0},{name:Tf.a.g5b,isInternal:!0}),this.a0g=!0);Ic=ad.Pa.node;Yc=Sa.a.fjb(ad,!0);yd=ad.Rc.node;ne=Sa.a.fjb(ad,!1);if(2<ad.length){var Oe=[];for(let nf=0;nf<ad.length;nf++)Oe.push(ad.J(nf).node.id);this.Aph(cc,Oe)}ea.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.LWb)}else if(2<this.WZ.length){Oe=[];for(ad=0;ad<this.WZ.length;ad++)Oe.push(this.WZ[ad].Zhc);this.Aph(cc,Oe)}pd.a.u2b(Ic,cc.id,Yc,!0);pd.a.u2b(yd,cc.id,ne,!1);wd.v(cc,Ic.id);wd.u(cc,yd.id);this.xEj();yd.id||ea.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}Aph(cc,Ic){if(!(2>=Ic.length||!cc||wd.s(cc))){this.hj.iV.add(cc.id,new fb.a(new wb.a));for(var Yc=y.a.Cq(Ic[0],Ic[1])?2:1,ad=Ic.length-2;Yc<=ad;Yc++){const yd=Ic[Yc];this.hj.fy.nb(yd)?
this.hj.fy.J(yd).dN||(this.hj.fy.J(yd).dN=new fb.a(new wb.a)):this.hj.fy.add(yd,new Qd.a(!0));this.hj.fy.J(yd).C3a=!0;this.hj.fy.J(yd).dN.add(cc.id);this.hj.iV.J(cc.id).add(yd)}}}cRk(){let cc=null,Ic=-1,Yc=null;var ad=-1;let yd=!1;if(!this.WZ.length||2!==this.LWb)return{start:cc,end:Yc,startCp:Ic,endCp:ad,Mvh:yd};cc=this.xd.Eb(this.WZ[0].Zhc);Yc=1===this.WZ.length?cc:this.xd.Eb(this.WZ[this.WZ.length-1].Zhc);if(Wa.ParagraphReader.Xb(cc)&&Wa.ParagraphReader.Xb(Yc)){ad=Oe=>3===Oe.type;let ne=this.fn.wQa(cc,
3,ad);Ic=0<ne.count?ne.J(0).Bc:-1;cc!==Yc&&(ne=this.fn.wQa(Yc,3,ad));ad=0<ne.count?ne.J(0).end:-1;-1===Ic&&null!=cc&&(Ic=cc.ra.first.cp,yd=!0,ea.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===ad&&null!=Yc&&(ad=Yc.ra.last.cp,yd=!0,ea.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.LWb=-1===Ic||-1===ad?0:2;return{start:cc,end:Yc,startCp:Ic,endCp:ad,Mvh:yd}}xEj(){for(const cc of this.WZ){const Ic=this.xd.Eb(cc.Zhc);Wa.ParagraphReader.Xb(Ic)&&this.fn.LVa(Ic,
3)}this.WZ=[];this.LWb=2}addComment(cc,Ic,Yc){cc.anchor||(Yc.Bf(cc,1),Yc.Bj(cc),this.nlj(cc,Ic,Yc))}nlj(cc,Ic,Yc){let ad=0;var yd=null;Ic=this.Psc.QLo(Ic,ne=>{const Oe=new Tb.a;Yc.Bf(Oe,1);Yc.Bj(Oe);Yc.Bf(ne,2);Yc.Bj(ne);Yc.sc();Yc.sc()});for(let ne=0;ne<Ic.length;ne++)yd=Ic[ne],ad=yd.getValue(rc.a.Wc),eg.Sk.TVa(yd),eg.qK&&eg.qK.BOa&&eg.qK.SIa(hc.a.create(yd));cc.setValue(rc.a.MH,ad.toString());return yd}glb(cc,Ic){return this.BIm(cc,Ic)}vsm(){return 0<this.WZ.length}tDb(cc,Ic,Yc){return cc.Pa&&Wa.ParagraphReader.Xb(cc.Pa.node)&&
Wa.ParagraphReader.Xb(cc.Rc.node)?(Ic=this.VLh(Wa.ParagraphReader.uR(cc.Rc.node).toString(),Ic?Ic:z.AFrameworkApplication.userName,new Date,!1,{}),Yc||(Yc=new E.a,Yc.Yca("\n")),this.VAb(Ic,[Yc.O9b()],this.hRd(),cc),Ic):null}Fs(cc){return!this.IYe.Ogg(this.gQc(cc.getValue(rc.a.hF)))}IFj(cc,Ic,Yc){const ad=new sb.GraphIterator;for(ad.set(cc);ad.Rd();)ad.tg();this.nlj(cc,Ic,ad).Gg(rc.a.Wc,Number.parseInvariant(Yc));cc.setValue(rc.a.MH,Yc);if(Ic=this.m0(cc.id.toString()))Ic.uJh=!1;cc.setValue(rc.a.ikb,
!1)}HFj(cc,Ic){this.IFj(cc,[Sys.Serialization.JavaScriptSerializer.serialize(Ic)],cc.getValue(rc.a.MH))}UG(cc){cc=this.xd.Eb(y.a.If(cc));return!!cc&&cc.ja(rc.a.UG,!1)}J2i(cc){cc=this.xd.Eb(y.a.If(cc));return!!cc&&cc.ja(rc.a.cJh,!1)}mKm(cc){const Ic=wd.j();return cc&&Ic.has(cc.objectId)}OQm(cc){const Ic=this.xd.Eb(y.a.If(cc));return Ic?this.tdc(Ic):(ea.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+cc),!1)}tdc(cc){var Ic=cc.id,Yc=wd.k(cc),ad=wd.h(cc);if(!y.a.Cq(Yc,ad))return!1;
Yc=cc.Mc.Eb(Yc);if(!Yc)return!1;ad=({PIc:cc}=this.yKc(Yc,Ic,!0)).returnValue;var yd=({PIc:Ic}=this.yKc(Yc,Ic,!1)).returnValue;if(-1===ad||-1===yd)return!1;Yc=Yc.ra;ad=Yc.J(cc);yd=Yc.J(Ic);if(!ad.hyperlink||!ad.hyperlink.SG||!yd.Bm)return!1;for(cc+=1;cc<Ic;cc++)if(ad=Yc.J(cc),ad.hyperlink||ad.Bm)return!1;return!0}mTc(){return eg.Fsm(this.fh,cc=>this.UG(cc),cc=>this.J2i(cc))}yKc(cc,Ic,Yc){let ad;for(ad=0;ad<cc.ra.length;ad++){const yd=cc.ra.J(ad);if(yd.Ue)for(let ne=0;ne<yd.Ue.length;ne++){const Oe=
yd.Ue.J(ne);if(Oe.Lj.equals(Ic)&&Oe.Qc===Yc)return{returnValue:yd.cp,PIc:ad}}}return{returnValue:-1,PIc:ad}}LRh(cc){if(this.hj.iV.nb(cc)){const Ic=new uc.a;for(const Yc of this.hj.iV.J(cc))this.x_n(Yc,cc,Ic);this.hj.iV.remove(cc);Rb.b(Ic)}}Joe(cc,Ic){if(cc.objectId){cc=y.a.If(cc.objectId);var Yc=this.xd.Eb(cc);if(Yc){var ad=wd.k(Yc,y.a.nil);Yc=wd.h(Yc,y.a.nil);ad.equals(y.a.nil)||Ic.add(this.xd.Eb(ad));Yc.equals(y.a.nil)||Ic.add(this.xd.Eb(Yc));if(this.hj.iV.nb(cc))for(const yd of this.hj.iV.J(cc))Ic.add(this.xd.Eb(yd))}}}x_n(cc,
Ic,Yc){let ad;({value:ad}=this.hj.fy.Fc(cc,ad));ad&&(ad.dN.remove(Ic),ad.dN.count||(ad.C3a=!1,Yc.add(this.xd.Eb(cc))))}static get Sk(){return null!=eg.cGg?eg.cGg:eg.cGg=n.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return eg.fm()}static fm(){if(eg._instance)return eg._instance;const cc=new oa.a(()=>(new Lb(!0,!0,!0)).E$k()),Ic=n.a.instance;eg._instance=new eg(new oa.a(()=>e.StaticActiveAppFrame.za().jb.Zc),new oa.a(()=>e.StaticActiveAppFrame.za().jb.rc.ed),new oa.a(()=>oc.a.instance),
new Hb.a,new vc,new oa.a(()=>Eb.a.instance),Ic.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),Ic.resolve("WordEditor.Comments.ICommentFormatTranslator"),Ic.resolve("Common.IAppSettingsManager"),Ic.resolve("Box4.IFeatureHelper"),Ic.resolve("Box4.Intent.IIntentRangeEditor"),new oa.a(()=>bc.App.sS),Ic.resolve("Box4.IKickoutExecutor"),Ic.Ve("WordEditor.Tasks.ITaskActor"),cc,Ic.resolve("WordEditor.Comments.CommentsSettings"),Ic.resolve("Box4.IUndoManager"),Ic.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),
Ic.resolve("WordEditor.Comments.CommentsState"),Ic.resolve("WordEditor.Comments.WordCommentEventsActor"),Ic.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Ic.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Ic.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),bc.App.li.Al.Te(12),Ic.resolve("Box4.ParagraphRenderEvents"),Ic.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Ic.Sa("WordEditor.Extension.RichApiEventManager"));return eg._instance}static Wph(cc,
Ic,Yc,ad){Ic=pd.a.uca(Yc,Ic,ad);if(!Ic)return null;Ic=Ic.Lb.Ue;return pd.a.OBd(cc.id,Ic,Ic.J(0).jv,ad)}BIm(cc,Ic){if(bc.App.lostSession||(Ic?!bc.App.Fs:!bc.App.Fs&&!bc.App.Cm)||1===cc.mode||!Object(ya.a)(Sc.MainView,$a.InteractiveViewManager.instance.yd))return!1;cc=this.pOl();return!cc||ab.a.instance.a0(cc)||ab.a.instance.yia(cc)||cc.contextId===rb.a.W7||cb.a.AFf(cc)&&cb.a.Tcc()?!1:!0}pOl(){const cc=$a.InteractiveViewManager.instance.yd;var Ic=cc.mb.qg;this.Tx&&Ya.n(Ic.node)&&(Ic=sb.GraphIterator.eb(Ic.node),
Ic.zb(12),Ic=Ic.jo(12),Ic=Ua.SelectionFactory.Kna(Ic),cc.mb.Ac(Ic),Ic=cc.mb.qg);return Ic}static Fsm(cc,Ic,Yc){const ad=new uc.a,yd=new uc.a,ne=new db.a,Oe=new db.a;for(const Ye of cc){var nf=Ye.id,wf=Ye.objectId;cc=Ye.done;const Rg=!!wf&&Ic(wf);nf&&(cc&&ad.add(nf),Rg&&yd.add(nf),wf&&ne.Z(nf,wf));if(nf=Ye.Df)({value:wf}=Oe.Fc(nf,0)).returnValue||(wf=0),Oe.Z(nf,wf+1);if(!nf&&!cc&&!Rg)return!0}for(const Ye of yd){if(ad.contains(Ye))continue;let Rg;if(({value:Rg}=ne.Fc(Ye,Rg)).returnValue&&Yc(Rg))return!0;
let Db;if(({value:Db}=Oe.Fc(Ye,0)).returnValue&&0<Db)return!0}return!1}GSl(cc){const Ic=[];let Yc=this.fh.findIndex(ad=>ad.id===cc);if(-1<Yc)for(Ic.push(this.fh[Yc]);++Yc<this.fh.length&&this.fh[Yc].Df===cc;)Ic.push(this.fh[Yc]);return Ic}XWl(cc){return this.Nid.v9h(cc)}}eg._instance=null;eg.qK=null;Object(l.a)(eg,"EditorCommentModel",a.a,[761,762,763])},1791:function(D,J,c){D=c(0);var l=c(400),e=c(139),a=c(43),k=c(307),x=c(3),y=c(7),n=c(14),t=c(1649),z=c(1607);class v{constructor(ba,oa,ma=!1){this.paragraphNode=
ba;this.role=oa;this.zuj=ma}}Object(D.a)(v,"DesignerReviewActionData",null,[]);class I{constructor(ba,oa,ma){this.paragraphNode=ba;this.Jq=oa;this.role=ma}}Object(D.a)(I,"TriageActionData",null,[]);class E extends I{constructor(ba,oa){super(ba,0,oa)}}Object(D.a)(E,"RoleTriageActionData",I,[]);class H extends I{constructor(ba,oa,ma){super(ba,1,27);this.styleId=oa;this.MX=ma}}Object(D.a)(H,"PullQuoteTriageActionData",I,[]);class M extends I{constructor(ba,oa){super(ba,2,28);this.gpa=oa}}Object(D.a)(M,
"ImageTriageActionData",I,[]);class K{constructor(ba,oa){this.paragraphNode=ba;this.pKb=oa}}Object(D.a)(K,"ViewOriginalActionData",null,[]);var L=c(138),S=c(1548),Q=c(1721);class N{constructor(ba,oa){this.currentNode=ba;this.nextNode=oa}}Object(D.a)(N,"ReviewNavigationArgs",null,[]);class O{constructor(ba,oa){this.paragraphNode=ba;this.isVisible=oa}}Object(D.a)(O,"ReviewVisibilityArgs",null,[]);class X{constructor(ba){this.Wik=ba}getSelectedOption(){return this.Wik}getSeparatorIndexes(){return[1]}}
Object(D.a)(X,"DesignerPreviewData",null,[]);var U=c(509),T=c(949),Y=c(1722);c.d(J,"a",function(){return aa});class aa extends T.a{constructor(ba,oa,ma,ea,ua,sa,Fa,Pa,Na,Aa,za,xa){super();this.oc=ba;this.Zd=oa;this.sLd=ma;this.N4=ea;this.Vi=ua;this.hC=sa;this.LBj=Fa;this.gm=Pa;this.Mv=Na;this.tLd=Aa;this.Is=za;this.Anf=xa;this.ueb=null;this.rhd=void 0;this.xxe=0;this.FH=[U.a.iSh]}get types(){return this.FH}get njj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get Hae(){return 0}gvo(ba){return 3!==
ba.suggestion.Jq&&!this.Mv.isVisible&&(!this.xxe||!ba.oBb&&1===this.xxe)}DN(ba){var oa;if(!ba.source||l.SessionStatusManager.instance.Yj)return!1;const ma=ba.ul;var ea=this.N4.jRc(ma,1);if(!ea||!ea.count)return!1;const ua=ea.J(0).intent;if(ba.wmc)return.5!=(null===ua||void 0===ua?void 0:ua.state)&&4!=(null===ua||void 0===ua?void 0:ua.state);const sa=ma.node;if(0==(null===ua||void 0===ua?void 0:ua.state)&&(2==(null===ua||void 0===ua?void 0:ua.suggestion.Jq)||1==(null===ua||void 0===ua?void 0:ua.suggestion.Jq)))return ua.oBb(),
this.N4.LVa(sa,1),this.hC.d7i(new Q.a(sa,1)),!0;if(1==ba.source&&27==(null===ua||void 0===ua?void 0:ua.Lkb)&&(.5==(null===ua||void 0===ua?void 0:ua.state)||4==(null===ua||void 0===ua?void 0:ua.state)))return!1;ea=this.Mv.isVisible?this.sLd.Dnl(sa):new Y.a(0,1);let Fa;const Pa=this.d2l(null===(oa=null===ua||void 0===ua?void 0:ua.suggestion)||void 0===oa?void 0:oa.Jq);oa=this.Xi.mka(ma,{id:"Intent-"+U.a.iSh,suggestionGroups:[{type:Pa,id:Pa,title:ua.description,snippet:this.xHn(this.Vi.Wda(ma.node)),
snippetFormatting:[],supportedActions:this.jpf(null===ua||void 0===ua?void 0:ua.suggestion,!0),suggestions:({Odo:Fa}=this.HOh(sa)).returnValue,previewData:Fa?new X(Fa):null,isContentPending:!1}],setSize:ea.count,positionInSet:ea.index},this,ba.hSa,!1,()=>{var Na;this.hC.e7i(new O(sa,!0));this.Mv.isVisible||3===(null===(Na=null===ua||void 0===ua?void 0:ua.suggestion)||void 0===Na?void 0:Na.Jq)||this.xxe++},()=>{this.hC.e7i(new O(sa,!1))},null,!1,Na=>{Na.showDesignerButton=!this.Mv.isVisible;Na.shouldSkipTwoStepReview=
!0;Na.isFormattingSuggestion=0==ua.suggestion.Jq;Na.isMultiParagraphSuggestion=1<ua.rO.length;Na.proactivePromptHintType=this.gvo(ua)?k.e.HideFromReviewCardAndRibbon:k.e.None});a.c(n.a.wxn,oa,void 0,void 0,30);return oa}executeAction(ba,oa){var ma,ea,ua,sa,Fa;if(!ba||!oa)return!1;const Pa=this.gm.GA(oa);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",ba.actionType,null===Pa||void 0===Pa?void 0:Pa.role,this.Mv.isVisible);const Na=this.tLd.DU(oa);try{switch(ba.actionType){case k.b.Accepted:const Aa=
this.oc.Qb(n.a.kBd,2,new v(oa,null===Pa||void 0===Pa?void 0:Pa.role,!0));this.cqg(Ca=>{Ca.supportedActions=this.jpf(null===Na||void 0===Na?void 0:Na.suggestion,!1)});return this.Mv.isVisible&&32===Aa?this.nTf(oa):32===Aa;case k.b.Rejected:const za=this.oc.Qb(n.a.Dde,2,new v(oa,null===Pa||void 0===Pa?void 0:Pa.role,!0));2===(null===Na||void 0===Na?void 0:Na.suggestion.Jq)||Object(S.e)(null===Na||void 0===Na?void 0:Na.suggestion)||this.Pdd(oa,!1);2===(null===Na||void 0===Na?void 0:Na.suggestion.Jq)&&
this.Xi.dismiss();return this.Mv.isVisible&&32===za?this.nTf(oa):32===za;case k.b.Next:case k.b.Previous:return!this.Mv.isVisible||this.nTf(oa,ba.actionType===k.b.Previous);case k.b.Apply:const xa=null===(ma=ba.suggestion)||void 0===ma?void 0:ma.contentData;let ka;switch(null===xa||void 0===xa?void 0:xa.Jq){case 0:ka=new E(oa,xa.role);break;case 1:case 3:const Ca=xa.Y6a;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ea=null===Na||void 0===Na?void 0:
Na.suggestion)||void 0===ea?void 0:ea.id,["newStyleId"]:Ca});Na.suggestion.Y6a=Ca;ka=new H(oa,Ca,e.a.create());break;case 2:ka=new M(oa,xa.gpa);break;default:return y.ULS.shipAssertTag(527459665,3016,!1,String.format("DesignerSuggestionType: {0}",xa.Jq)),!1}this.Xi.focus();const wa=this.oc.Qb(n.a.changeDesignerRole,2,ka);this.Pdd(oa,!1);return 32===wa;case k.b.AcceptAll:return 32===this.oc.Qb(x.a.Qeb,2,new t.a(2));case k.b.RejectAll:return 32===this.oc.processAction(n.a.K6c,2);case k.b.SnoozeAll:return 32===
this.oc.processAction(n.a.designerSnoozeContextualSuggestions,2);case k.b.Undo:const ia=this.oc.Qb(n.a.WJa,2,new v(oa,null===Pa||void 0===Pa?void 0:Pa.role));this.Pdd(oa,!0);return 32===ia;case k.b.OpenDesignerPane:return 32===this.oc.Qb(n.a.FJa,2,new z.a(6));case k.b.ViewOriginal:const va={pKb:ba.descriptorData.isViewingOriginal,geg:ba.descriptorData.setIsViewingOriginal};if(void 0==(null===va||void 0===va?void 0:va.pKb)||void 0==(null===va||void 0===va?void 0:va.geg))return y.ULS.shipAssertTag(538789889,
3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===va||void 0===va?void 0:va.pKb,null===va||void 0===va?void 0:va.geg)),!1;this.Xi.focus();const na=this.oc.Qb(n.a.sff,2,new K(oa,va.pKb));va.geg(!va.pKb);this.Pdd(oa,!0);return 32===na;case k.b.GiveFeedback:switch(null===(ua=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===ua?void 0:ua.Jq){case 0:return this.Is.invokeUserFeedback(L.a.$Tj),!0;case 1:case 3:return this.Is.invokeUserFeedback(L.a.fUj),!0;case 2:return this.Is.invokeUserFeedback(L.a.bUj),
!0;default:return y.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(sa=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===sa?void 0:sa.Jq)),!1}case k.b.ShowMore:switch(null===(Fa=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===Fa?void 0:Fa.Jq){case 2:y.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Na.suggestion.Wym(),this.Pdd(oa,!0,!0)}return!0;default:return!1}}catch(Aa){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",
Aa.message,Aa.stack)),!1}}nTf(ba,oa=!1){const ma=this.sLd.s$b(ba,oa)||this.sLd.s$b(ba,!oa);this.hC.ePn(new N(ba,ma,!oa));return!ma||this.sLd.gRi(this,ma)}$Zl(ba){switch(ba.Jq){case 0:case 1:case 3:return{...k.h,font:ba.font,cssColor:ba.color,fontSize:ba.fontSize,fontWeight:ba.bold?k.d.Bold:k.d.Normal,italic:ba.italic,underlineType:ba.underline?k.f.Single:k.f.None,backgroundImg:ba.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${ba.Jq}`)}}a1l(ba){if(2===ba.Jq)return{src:ba.imageUrl,
width:0,height:0,imageAltText:ba.altText}}HOh(ba){var oa=null;let ma=null;if(this.ueb=this.LBj.$7l(ba)){ma=Array(this.ueb.options.length);for(ba=0;ba<this.ueb.options.length;ba++)oa=this.ueb.options[ba],ma[ba]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",ba),title:oa.title,supportedActions:[k.b.Apply],contentData:oa,image:this.a1l(oa),titleFormatting:[this.$Zl(oa)]};oa=(null===ma||void 0===ma?0:ma.length)?ma[this.ueb.selectedIndex]:void 0}return{returnValue:ma,Odo:oa}}cqg(ba){this.Xi.definition?
this.Xi.definition.suggestionGroups?1===this.Xi.definition.suggestionGroups.length&&(ba(this.Xi.definition.suggestionGroups[0]),this.Xi.definition=this.Xi.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}Pdd(ba,oa,ma=!1){const ea=this.tLd.DU(ba);this.cqg(ua=>{ua.supportedActions=this.jpf(null===ea||void 0===ea?void 0:ea.suggestion,oa);if(this.ueb){if(ma){var sa=this.HOh(ba).returnValue;
ua.suggestions=sa}sa=this.LBj.Odm(this.ueb.options,ba);ua.previewData=new X(ua.suggestions[sa])}})}jpf(ba,oa){const ma=[];oa?(ma.push(k.b.Accepted),ma.push(k.b.Rejected),0==(null===ba||void 0===ba?void 0:ba.Jq)&&ma.push(k.b.ViewOriginal)):(ma.push(k.b.Next),ma.push(k.b.Undo));this.Mv.isVisible||(this.Zd.SKm()&&this.wHk(ea=>{ea&&this.cqg(ua=>ua.supportedActions.push(k.b.GiveFeedback))})&&ma.push(k.b.GiveFeedback),this.Zd.HLm()&&ma.push(k.b.OpenDesignerPane),ma.push(k.b.SnoozeAll));0===(null===ba||
void 0===ba?void 0:ba.Jq)&&ma.push(k.b.AcceptAll);ma.push(k.b.RejectAll);(null===ba||void 0===ba?0:ba.Vni())&&ma.push(k.b.ShowMore);return ma}xHn(ba){const oa=ba.split(" ",10);return 10>oa.length?ba:oa.join(" ")+"\u2026"}static NLm(ba){return ba===U.a.jSh||ba===U.a.kSh||ba===U.a.oSh}d2l(ba){return 2===ba?U.a.kSh:1===ba||3===ba?U.a.oSh:U.a.jSh}wHk(ba){void 0===this.rhd&&this.Anf.execute(async oa=>{this.rhd=await oa.isFeatureEnabled(L.a.WQi,!1);ba(this.rhd)});return!!this.rhd}}Object(D.a)(aa,"DesignerIntentProvider",
T.a,[])},1798:function(D,J,c){D=c(0);var l=c(506),e=c(465),a=c(10),k=c(1500),x=c(2069),y=c(355),n=c(7),t=c(111),z=c(1558);class v{constructor(K,L,S){this.isVisible=K;this.elements=L;this.content=S}}Object(D.a)(v,"TooltipVisibilityArgs",null,[]);var I;(function(K){K[K.consistency=0]="consistency";K[K.zqp=1]="pullQuote";K[K.$tp=2]="suggestedImage";K[K.Aqp=3]="pullQuoteMenu";K[K.cip=4]="designerPaste"})(I||(I={}));Object(D.b)("DesignerSuggestionType",I);var E=c(138),H=c(1723);c.d(J,"a",function(){return M});
class M extends k.a{constructor(K,L,S,Q,N,O,X,U){super();this.sm=K;this.Cr=L;this.d_k=S;this.dQi=Q;this.Vi=N;this.hC=O;this.lI=X;this.rc=U;this.jva=this.aGa=null;this.onMouseEnter=T=>{T=T.Vo;this.hC.y7i(new v(!0,[T.CHc],T.GMo));if(T.ps&&0<T.ps.length){const Y=this.lI.DU(T.ps[0]);Y&&Y.suggestion.p6m()}return this.rmj(T)};this.zqa=T=>{this.hC.y7i(new v(!1));return this.kFh(T.Vo)};this.HHa=T=>{if(M.Z4a(T.Vo,this.jva))return!0;this.hC.fPn(z.a.create(T.Vo.ps[0]));return!0};this.LYf=(T,Y)=>{Y.data?Y.data.isVisible?
this.Rho(Y.data.paragraphNode):this.KYk():n.ULS.shipAssertTag(573850384,3016,!1)};this.hC.H0e(this.LYf)}kko(K){K?(K=this.Jrf(K))&&this.rmj(K):n.ULS.shipAssertTag(589693324,3016,!1)}aZk(){this.kFh(this.aGa)}n8a(K){K=this.Vi.$k(K.Cb);return!!K&&this.lI.lYc(K)}$0a(K){const L=K.m0a(0,E.a.CLk,this.zoom),S=[];S.push(this.Mna(K.y5,L,K.Bpc[0].y-K.M4[0].y));return S}Mna(K,L,S){var Q,N=K.Ag.ownerDocument;const O=l.a.createElement(N,e.a.div);O.className=E.a.xLk;O.style.left=L+"px";O.style.top=S+"px";L=l.a.createElement(N,
e.a.div);L.className=E.a.ALk;N=l.a.createElement(N,e.a.div);N.className=E.a.yLk;K=this.Vi.$k(K.Cb);S=this.lI.DU(K);if(null===(Q=null===S||void 0===S?void 0:S.suggestion)||void 0===Q?0:Q.Jq)N.className+=String.format(" {0}",I[S.suggestion.Jq]);L.appendChild(N);O.appendChild(L);O.id=M.d6h(K);Q=this.Jrf(K,O);1==Q.DLk&&(N.className+=String.format(" {0}",E.a.zLk));this.jva&&this.jva.ps.includes(K)?(O.className+=String.format(" {0}",E.a.O4e),this.jva=Q):this.aGa&&this.aGa.ps.includes(K)&&(O.className+=
String.format(" {0}",E.a.N4e),this.aGa=Q);this.dQi(a.a.XR,O,this.onMouseEnter,Q);this.dQi(a.a.yL,O,this.zqa,Q);this.d_k(a.a.click,O,this.HHa,Q);return O}Rho(K){if(K){var L=this.Jrf(K);L?(this.lI.DU(K)&&(K=Object.assign(new x.a,{action:0,type:3,HA:L,WJ:this.jva}),this.Cr.KF(K)),this.jva=L,M.Z4a(this.aGa,this.jva)&&(this.aGa=null)):n.ULS.shipAssertTag(590112344,3016,!1)}else n.ULS.shipAssertTag(590112343,3016,!1)}KYk(){if(this.jva){var K=Object.assign(new x.a,{action:1,type:3,HA:null,WJ:this.jva});
this.jva=null;this.Cr.KF(K)}}rmj(K){if(M.Z4a(K,this.jva)||M.Z4a(K,this.aGa))return!0;const L=Object.assign(new x.a,{action:2,type:3,HA:K,WJ:this.aGa});this.aGa=K;this.Cr.KF(L);return!0}kFh(K){if(M.Z4a(K,this.jva))return!0;K=Object.assign(new x.a,{action:3,type:3,HA:null,WJ:this.aGa});this.aGa=null;this.Cr.KF(K);return!0}Jrf(K,L){L=L?L:this.LPl(K);if(!L)return null;const S=this.lI.DU(K);return new H.a(0<(null===S||void 0===S?void 0:S.rO.length)?null===S||void 0===S?void 0:S.rO:[K],L,M.Mji(S),M.MPl(S))}static Mji(K){if(!K)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;
switch(K.suggestion.Jq){case 0:return M.vZd(K.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return M.vZd(K.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return M.vZd(K.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;
default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static MPl(K){return K?M.vZd(K.state)?1:0:0}static vZd(K){return 0!==K&&.1!==K}LPl(K){var L=null,S=this.sm.Rf(K);S.zb(11)&&(S.sc(),S=S.currentNode.Aj(this.rc.$b))&&(K=String.format("#{0}",M.d6h(K)),L=S.htmlElement.querySelector(K),!L&&Object(t.a)(y.a,S)&&(L=(L=S.TOd())?L.querySelector(K):null));return L}static d6h(K){return String.format("p{0}{1}",K.id.guid,K.id.n)}static Z4a(K,L){return!!L&&!!K&&K.CHc===L.CHc}}Object(D.a)(M,
"BlueDotActor",k.a,[611,609])},1799:function(D,J,c){D=c(0);var l=c(641);class e{constructor(k){this.vGa=k.g2l();this.FHb=k.Brf("intCopy");this.z$d=k.Gei("intCopy");this.wCb=k.opf("intCopy");this.Dfb=k.Pof("intCopy")}static mF(){return e.Wr()}static Wr(){return new e(l.a.instance)}}Object(D.a)(e,"InternalCopyUsageHelper",null,[]);c.d(J,"a",function(){return a});class a{constructor(k,x,y){this.hX=e.mF();this.rGd=null;this.WQb=this.dpe=!1;this.vVg=null;this.source=k;this.target=x;this.c0f=y}get Mka(){return this.hX}get So(){return this.vVg}set So(k){this.vVg=
k}}Object(D.a)(a,"InternalCopyArguments",null,[])},1800:function(D,J,c){D=c(0);var l=c(1466);class e extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(D.a)(e,"ALocalCobaltServerResponse",l.a,[]);c.d(J,"a",function(){return a});class a extends e{constructor(){super();this.RootCellId=null;
this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(D.a)(a,"GetChangesResponse",e,[])},1801:function(D,J,c){D=c(0);var l=c(81);class e extends Sys.EventArgs{constructor(){super()}}Object(D.a)(e,"UploadEventArgs",Sys.EventArgs,[]);c.d(J,"a",function(){return a});class a{constructor(){this.sa=
new l.a}Vqg(k){this.sa.raiseEvent("UploadStarted",new e(k,-1))}epc(k,x){this.sa.raiseEvent("UploadComplete",new e(k,x))}static get instance(){return null!=a.kDg?a.kDg:a.kDg=new a}}Object(D.a)(a,"Box4UploadNotifier",null,[573])},1804:function(D,J,c){D=c(0);var l=c(32),e=c(1075);class a extends e.a{isUserPromptField(H){return new k(H)}annotationStatusField(H){return new x(H)}annotationCharCountField(H){return new y(H)}userPromptCharCountField(H){return new n(H)}precedingTextsCharCountField(H){return new t(H)}followingTextsCharCountField(H){return new z(H)}promptTriggerSourceField(H){return new v(H)}promptIdField(H){return new I(H)}}
Object(D.a)(a,"AiInserterDataFieldsFactoryImpl",e.a,[]);class k extends l.a{constructor(H){super();this.name="isUserPrompt";this.bool=H}}Object(D.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(H){super();this.name="annotationStatus";this.int64=H}}Object(D.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(H){super();this.name="annotationCharCount";this.int64=H}}Object(D.a)(y,"AnnotationCharCountField",l.a,[]);class n extends l.a{constructor(H){super();this.name=
"userPromptCharCount";this.int64=H}}Object(D.a)(n,"UserPromptCharCountField",l.a,[]);class t extends l.a{constructor(H){super();this.name="precedingTextsCharCount";this.int64=H}}Object(D.a)(t,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(H){super();this.name="followingTextsCharCount";this.int64=H}}Object(D.a)(z,"FollowingTextsCharCountField",l.a,[]);class v extends l.a{constructor(H){super();this.name="promptTriggerSource";this.string=H}}Object(D.a)(v,"PromptTriggerSourceField",
l.a,[]);class I extends l.a{constructor(H){super();this.name="promptId";this.string=H}}Object(D.a)(I,"PromptIdField",l.a,[]);l=c(950);c.d(J,"a",function(){return E});class E extends l.a{constructor(H){super(H,"AiInsert");this.fieldsFactory=new a}}Object(D.a)(E,"AiInserterTelemetryLoggerImpl",l.a,[])},1834:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static O5h(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(D.a)(l,"WopiAuthContext",null,[844])},1835:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.fxn="OneDriveWOPI";Object(D.a)(l,"HostApplicationType",null,[])},1836:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.wMj="WAC_Word";
l.TTc=null;Object(D.a)(l,"AddinHostApp",null,[])},1838:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.RoleType=J.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(J.ErrorCode||(J.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";
c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(J.RoleType||(J.RoleType={}))},1839:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.NavigationPaneInputClassifierSignal=J.DesignerInputClassifierSignal=J.DocumentRoleDetectionAnnotation=J.RoleDetectionAnnotation=J.RoleDetectionSettings=J.RoleDetectionCustomMetadata=
J.BasePartialDocumentLevelAnnotation=J.WordNavPaneInputTargetDocumentClassificationAnnotation=J.WordDesignerInputTargetDocumentClassificationAnnotation=J.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(196);class e{constructor(E){l.SchemaObject.assign(e,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[e.getTypeName()])}}J.BaseInputTargetDocumentClassificationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(E){l.SchemaObject.assign(a,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[a.getTypeName()])}}J.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(E){l.SchemaObject.assign(k,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[k.getTypeName()])}}J.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(E){l.SchemaObject.assign(x,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[x.getTypeName()])}}J.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(E){l.SchemaObject.assign(y,this,E)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[y.getTypeName()])}}J.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class n{constructor(E){l.SchemaObject.assign(n,this,E)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[n.getTypeName()])}}J.RoleDetectionSettings=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class t{constructor(E){l.SchemaObject.assign(t,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[t.getTypeName()])}}J.RoleDetectionAnnotation=t;t.H_={T_:t.getTypeName(),B_:t.getBaseTypes()};
class z{constructor(E){l.SchemaObject.assign(z,this,E)}get metadata(){return this.M_}set metadata(E){this.M_=E}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[z.getTypeName()])}}J.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class v{constructor(E){l.SchemaObject.assign(v,
this,E)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,[v.getTypeName()])}}J.DesignerInputClassifierSignal=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class I{constructor(E){l.SchemaObject.assign(I,this,E)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(E){return l.SchemaObject.matchesTypesFor(E,
[I.getTypeName()])}}J.NavigationPaneInputClassifierSignal=I;I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()}},1840:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.extensions=e}}Object(D.a)(l,"ExtensionList",null,[])},1841:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(1799);class l extends c.a{constructor(e,a){super(e.source,e.target,e.c0f);this.yi=e;this.insertAfter=a}get Mka(){return this.yi.Mka}get So(){return this.yi.So}set So(e){this.yi.So=e}}Object(D.a)(l,
"CoreInternalCopyArguments",c.a,[])},1842:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=null){this.source=e;this.target=a;this.insertAfter=k;this.j_f=x;this.So=y||{}}}Object(D.a)(l,"CoreInternalPasteArguments",null,[])},1843:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(D.a)(l,"OfficeSharedCommentUser",null,[])},1844:function(D,J,c){c.d(J,"a",function(){return K});D=c(0);var l=c(55),e=c(1845),a=c(177),k=c(2),x=c(130),y=c(337),n=c(1400),t=c(777),z=c(541),v=c(1401),I=c(183),E=c(182),H=c(70),M=c(12);class K{constructor(L){this.Faa=this.Yh=this.K2=null;this.uD=0;this.GVb=this.Dla=this.Vb=null;this.ygh=!1;this.Uwe=null;this.TKh=!0;this.ga=L;this.Ub()}get Oda(){return this.K2}get model(){return this.Yh}get bbc(){return this.Faa}get Bil(){return k.AFrameworkApplication.Tro}get fLo(){return k.AFrameworkApplication.pqj}get Vkl(){return CommonUIStrings.l_DeleteCommentConfirm}get qGo(){return!1}get BA(){return!1}get HRi(){return!1}get Ejj(){return!1}get JYh(){return this.Dla}set JYh(L){this.Dla=
L}get mode(){return this.uD}set mode(L){L!==this.uD&&(this.uD=L,-1!==this.uD&&(this.K2.X5a(),this.Yh.X5a(),0===this.uD&&this.Aif()))}get RQb(){return this.ygh}set RQb(L){this.ygh=L}get aea(){return!1}get osj(){return!0}dispose(){this.K2&&(this.K2.dispose(),this.K2=null);this.Yh&&(this.Yh.dispose(),this.Yh=null);this.Faa&&(this.Faa.dispose(),this.Faa=null);this.Aif()}selectComment(L,S=1){const Q=this.Yh.$D(L);!Q||2===this.mode&&1!==Q.Zq||(this.Yh.selectComment(Q),this.Faa.highlightComment(Q,!0),this.K2.selectComment(Q,
S),1===S&&this.RQb&&this.Dla.selectComment(L))}a9c(){const L=this.Yh.a9c();L&&(this.Faa.highlightComment(L,!0),this.K2.selectComment(L),this.RQb&&this.Dla.selectComment(L.id))}b9c(){const L=this.Yh.b9c();L&&(this.Faa.highlightComment(L,!0),this.K2.selectComment(L),this.RQb&&this.Dla.selectComment(L.id))}$fe(L){L?this.selectComment(L,0):this.K2.wRi&&this.Apf().hk.iz(this.K2.wRi)}clearSelection(){this.Yh.clearSelection();this.RQb&&this.Dla.selectComment(null);this.Faa.ZYk()}paneClosing(){this.BA||(2===
this.uD?(this.clearSelection(),this.deleteComment(this.Yh.Tx)):this.clearSelection())}VAb(L){if(1===this.mode){L=e.a.tDb(L);var S=({anchor:Q}=this.Faa.C9k()).returnValue;if(Q&&0===S)this.addComment(L,Q);else{switch(S){case 1:L=CommonUIStrings.l_NewCommentError;break;case 2:L=CommonUIStrings.l_NewCommentInvalidContent;break;default:L=CommonUIStrings.l_NewCommentError}var Q=new E.StandardDialog;Q.Cd=0;Q.lka(CommonUIStrings.l_DefaultDialogTitle,L,null)}}}addComment(L){0!==this.mode&&(this.Yh.msk(L),
0===L.Zq||this.HRi||this.selectComment(L.id),this.ga.processAction(M.a.CHh,2))}editComment(L,S){1===this.mode&&L&&(this.Yh.VMc(L,S),this.selectComment(L.id))}g7e(){this.Yh.aUk()}addReply(L,S){1===this.mode&&(L=this.Yh.yLh(L,S),this.selectComment(L.id,0),this.ga.processAction(M.a.GHh,2))}deleteComment(L){if(1!==this.mode)if(2===this.mode){if(1!==L.Zq)return;this.mode=1}else return;this.osj&&1!==L.Zq?(this.GVb=L,L=new E.StandardDialog,L.Cd=4,L.FV(2),L.Yhg(CommonUIStrings.l_DefaultDialogTitle,this.Vkl,
Object(l.a)(this,this.dll,"deleteDialogHandler"))):this.MLc(L)}Ub(){this.ga.fb(M.a.a2k,H.a.frame,x.ActionManager.Nf,64);this.ga.fb(M.a.b2k,H.a.frame,x.ActionManager.Nf,64);this.ga.fb(M.a.bHh,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(M.a.G9e,H.a.frame,x.ActionManager.Nf);this.ga.qa(M.a.iHh,H.a.frame,x.ActionManager.Nf);this.ga.qa(M.a.jHh,H.a.frame,x.ActionManager.Nf);this.ga.fb(M.a.h2k,H.a.frame,x.ActionManager.Nf,64);this.ga.fb(M.a.i2k,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(M.a.CHh,H.a.frame,
x.ActionManager.Nf);this.ga.qa(M.a.DHh,H.a.frame,x.ActionManager.Nf);this.ga.qa(M.a.GHh,H.a.frame,x.ActionManager.Nf);this.ga.fb(M.a.Z2k,H.a.frame,x.ActionManager.Nf,64);this.ga.fb(M.a.a3k,H.a.frame,x.ActionManager.Nf,64);this.ga.fb(M.a.$2k,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(M.a.IHh,H.a.frame,x.ActionManager.Nf);this.ga.qa(M.a.f6a,H.a.frame,()=>{this.f6a();return 32})}dll(L){1===L?this.MLc(this.GVb):(this.GVb&&this.selectComment(this.GVb.id),this.GVb=null)}MLc(L){const S=L.Df;1===L.Zq?this.ga.processAction(M.a.G9e,
2):this.ga.processAction(M.a.iHh,2);this.GVb=null;this.RQb||this.clearSelection();L=this.Yh.deleteComment(L);for(let Q=0;Q<L.length;Q++)L[Q].dispose();this.$fe(S)}qCb(L,S){0!==this.mode&&(this.ga.processAction(S?M.a.jHh:M.a.IHh,2),this.Yh.qCb(L,S))}uva(L){this.Yh.uva(L);this.mode=1;this.ga.processAction(M.a.DHh,2)}wgb(L){this.Yh.wgb(L);this.mode=1}o3k(L,S){this.Yh.iUn(L,S)}fVc(){}Aif(){}kRb(L,S,Q,N,O){return this.K2.kRb(L,S,Q,N,O)}OV(L,S,Q,N,O){return this.K2.OV(L,S,Q,N,O)}Apf(){var L=this.Vb.getRegion(a.AFrame.Sr);
if(!L){const S=this.Vb.fe(a.AFrame.Sr);L=new y.DOMFocusListing(()=>this.Oda.D3c);L.Lja=!0;L.Qm(3);L.Qm(2);L.Qm(4);L.Qm(1);L.Qm(6);L.Qm(5);this.Vb.nna(()=>this.Oda.D3c,S,L);L=this.Vb.getRegion(a.AFrame.Sr);L.TTa();L.yP=!0;L.J0a=!0;S.mr(this.Vb.YW);S.mr(this.Vb.ZW)}return L}PBd(L,S){0!==this.mode&&this.Yh.PBd(L,S)}Ode(L,S){0!==this.mode&&this.Yh.Ode(L,S)}f6a(){I.UISurfaces.MM().then(L=>{var S=Object.assign(new n.a,{target:this.Ejj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new v.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});S=L.callout(S);const Q=Object.assign(new z.a,{expirationOptions:Object.assign(new t.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Uwe=L.addNotification(S,Q)})}dismiss(){I.UISurfaces.MM().then(L=>{L.removeNotification(this.Uwe);return this.Uwe=null})}static get instance(){return K._instance||
(K.factory?K._instance=K.factory():null)}static set instance(L){K._instance=L}}K._instance=null;K.factory=null;Object(D.a)(K,"CommentManager",null,[765,766,10])},1845:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(2),e=c(951);class a{constructor(){this.gj=null;this.fh=[];this._changes=[];this.Ubb=this.f0b=this.pz=null}get tt(){return this.pz}get Tx(){return this.Ubb}initialize(k){this.gj=k}dispose(){const k=this.fh.length;for(let x=0;x<k;x++)this.fh[x].dispose();this.fh=[]}X5a(){this.pz&&
this.pz.X5a();this.f0b&&this.f0b.X5a()}selectComment(k){this.clearSelection();k.$ja=1;this.pz=k;if(k.Df){var x=Array.indexOf(this.fh,k);for(--x;0<=x;x--){const y=this.fh[x];if(y.id===k.Df){y.$ja=2;this.f0b=y;break}}}l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Kb.Ppa&&e.ShyRibbon.cgb(1,0)}a9c(){if(!this.fh.length)return null;let k;k=this.pz?this.D7h(this.pz,!0):this.fh[0];this.selectComment(k);return k}b9c(){if(!this.fh.length)return null;let k;k=this.pz?this.HSl(this.pz):this.fh[this.fh.length-
1];this.selectComment(k);return k}clearSelection(){this.pz&&(this.pz.$ja=0,this.pz=null);this.f0b&&(this.f0b.$ja=0,this.f0b=null)}VMc(k,x){this.gj.mode=3;k.Zq=2;k.pUa=0;k.Cz=x;this.Ubb=k}aUk(){this.Ubb=null;this.gj.mode=1}yLh(k,x){var y=this.$D(k);this.gj.mode=2;this.Ubb=k=c(1679).Comment.ULh(l.AFrameworkApplication.userName,k,y.emi,x);for(x=this.fh.length-1;0<=x;x--)if(y=this.fh[x],y.Df===k.Df||y.id===k.Df){Array.insert(this.fh,x+1,k);break}return k}uva(k){this.JHh(k,2)}wgb(k){this.JHh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.fh,k);for(;y<this.fh.length;){const n=this.fh[y];if(n.id===k.id||n.Df===k.id)Array.removeAt(this.fh,y),Array.add(x,n);else break}this.o6c(x,3);-1<Array.indexOf(x,this.Ubb)&&(this.Ubb=null,this.gj.mode=1);return x}qCb(k,x){const y=[];let n=Array.indexOf(this.fh,k);for(;n<this.fh.length;){const t=this.fh[n];if(t.id===k.id||t.Df===k.id)t.done=x,Array.add(y,t),n++;else break}this.o6c(y,x?0:1)}$O(){return Array.clone(this.fh)}Eac(){return!!this.fh&&!!this.fh.length}$D(k){for(let x=
0;x<this.fh.length;x++){const y=this.fh[x];if(y.id===k)return y}return null}D7h(k,x){k=Array.indexOf(this.fh,k);return k===this.fh.length-1?x?this.fh[0]:null:this.fh[k+1]}PYl(k,x=!1){let y=k=Array.indexOf(this.fh,k);do if(y=y===this.fh.length-1?0:y+1,!x||!this.fh[y].done)return this.fh[y];while(y!==k);return this.fh[k]}HSl(k){return(k=Array.indexOf(this.fh,k))?this.fh[k-1]:this.fh[this.fh.length-1]}QYl(k,x=!1){let y=k=Array.indexOf(this.fh,k);do if(y=y?y-1:this.fh.length-1,!x||!this.fh[y].done)return this.fh[y];
while(y!==k);return this.fh[k]}PBd(){}Ode(){}JHh(k,x){const y=[];k.Zq=0;Array.add(y,k);this.o6c(y,x);this.Ubb=null}static tDb(k){return c(1679).Comment.ULh(l.AFrameworkApplication.userName,null,c(1679).Comment.q0i,k)}}Object(D.a)(a,"CommentModel",null,[10,762])},1846:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{}l.AJc="CommentPaneTextbox";l.LHd="CommentPane";l.g2k="CommentDeleteButton";l.Y2k="CommentSaveButton";l.X2k="CommentReplyButton";l.e2k="CommentCancelButton";l.HHh="CommentTextEntry";
l.c3k="CommentTabHelp";Object(D.a)(l,"CommentManagerConstants",null,[])},1847:function(D,J,c){c.d(J,"a",function(){return k});D=c(0);var l=c(451),e=c(90),a=c(30);class k{dispose(){}static V0a(x,y,n,t=null,z=!0){var v=z?"":n;x=l.a("a",x,"StandardButton "+y);x.title=v;x.tabIndex=0;v=null;t?(v=e.createClusteredImage(16,16,t,"StandardButtonImage",!0,null),v.setAttribute(a.a.uh,a.a.xz),x.appendChild(v)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(t=l.a("span",null,"StandardButtonLabel"),
t.innerText=n,x.appendChild(t)):Sys.UI.DomElement.addCssClass(v,"StandardButtonImageNoText");x.setAttribute(a.a.uh,a.a.Z3);return x}static jQb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.yM,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.xp,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.kr(x,a.a.q3e,y))}}Object(D.a)(k,"SimpleButtonFactory",null,[10])},1849:function(D,J,c){c.d(J,"a",function(){return I});D=c(0);var l=c(79),e=c(10),a=c(2),k=c(20),x=c(19),y=c(43),n=c(7),t=c(3),z=c(15),v=c(25);class I{constructor(E,H,M,K,L="@"){this.UQe=this.rqd=this.oFe=this.ge=null;this.Y3g=this.iwb=this.Sla=this.rta=this.bNg=!1;this.Ifa=0;this.bhg=!1;this.$Mb=()=>{this.reset()};this.tOa=S=>{this.Ifa=S.Hb.keyCode;var Q=S.Hb.rawEvent.key;Q&&Q!==this.Yna||(this.bhg=!0);return this.Sla&&
this.rqd?S.Hb.keyCode===l.a.l2||S.Hb.keyCode===l.a.Rs||S.Hb.keyCode===l.a.Kw?(Q=!1,S.Hb.keyCode===l.a.l2?(n.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),Q=!0):S.Hb.keyCode===l.a.Rs?n.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):S.Hb.keyCode===l.a.Kw&&n.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.rqd(S),Q&&this.reset(),!0):S.Hb.keyCode===l.a.Oea||S.Hb.keyCode===l.a.w6||
S.Hb.keyCode===l.a.m2||S.Hb.keyCode===l.a.n2||S.Hb.keyCode===l.a.v6||S.Hb.keyCode===l.a.RL?(this.rqd(S),!0):!1:!1};this.Qra=S=>{if(this.bhg||this.Sla){this.bhg=!1;var Q=this.MRc(),N=this.uQc(S.Hb.target),O=S.Hb.rawEvent.inputType;return(void 0!==O&&null!==O||this.Ifa!==l.a.qC&&this.Ifa!==l.a.k2)&&"deleteContentBackward"!==O&&"deleteContentForward"!==O?this.ini(Q,N,S.Hb.target):!1}};this.uKk=S=>{if(1!==S.Hb.rawEvent.key.length)return!1;const Q=this.MRc(),N=this.uQc(S.Hb.target);return this.ini(Q,N,
S.Hb.target)};this.iSa=S=>{if(!this.Sla)return!1;const Q=this.MRc(),N=this.uQc(S.Hb.target);(S.Hb.keyCode===l.a.qC||S.Hb.keyCode===l.a.k2||(S.Hb.keyCode===l.a.tWa||S.Hb.keyCode===l.a.Bqc)&&S.Hb.ctrlKey)&&this.Iyf(Q,N,S.Hb.target);return!1};this.h4e=(S,Q)=>{this.Ifa=Q.UDf?l.a.qC:Q.isDelete?l.a.k2:this.Ifa;this.Sla&&(Q.UDf?this.mom(Q.JFi):Q.isDelete&&this.Uom(Q.JFi))};this.Be=E;this.qk=H;this.zrc=M;this.ld=K;this.Yna=L;this.reset()}Afb(E,H){this.rta||(this.rta=!0,E.Cxa?this.Bfb(H):E.vga(()=>{this.rta||
this.Bfb(H)}))}dispose(){this.iwb&&(v.StaticActiveAppFrame.za().Onc.uc(e.a.input,this.ld.we.editingElement,this.Qra),this.iwb=!1);this.bNg&&(this.ge.uc(e.a.tEd,this.ld.we.editingElement,this.uKk),this.bNg=!1);this.Y3g&&(this.ge.uc(e.a.mG,this.ld.we.editingElement,this.tOa),this.ge.uc(e.a.zh,this.ld.we.editingElement,this.iSa));v.StaticActiveAppFrame.za().cea(this.$Mb);this.xwj()}x7f(E){this.oFe=E}H7f(E){this.UQe=E}y7f(E){this.rqd=E}AKk(){this.Sla=!0;a.AFrameworkApplication.se("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}xwj(){this.Sla=
!1}fE(){return this.Sla}Bfb(E){this.ge=E;if(!this.ld.yd)n.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.ld.yd.$i){if(z.App.LHc&&k.a.fle||k.a.Nt)v.StaticActiveAppFrame.za().Onc.ob(e.a.input,this.ld.we.editingElement,this.Qra,null),this.iwb=!0;this.ge&&(this.ge.ob(e.a.mG,this.ld.we.editingElement,this.tOa),this.ge.ob(e.a.zh,this.ld.we.editingElement,this.iSa),this.Y3g=!0);this.zrc.frh(this.h4e);v.StaticActiveAppFrame.za().G_(this.$Mb)}}ini(E,
H,M){if(1>H)return!1;E=E.replace(new RegExp(I.newLine,"g"),"");const K=E.charAt(H-1);this.Sla&&K!==this.Yna?this.Iyf(E,H,M):this.Sla||K!==this.Yna?this.Sla&&K===this.Yna&&n.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.oFe&&(this.reset(),this.nIn(H,E)&&(this.AKk(),this.Iyf(E,H,M),n.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===H?"true":"false")));return this.Sla}reset(){this.rta=!1;this.xwj();this.UQe&&this.UQe()}uQc(E){return this.qk.x9b(2,
E)}MRc(){return this.Be.vw().innerText}nIn(E,H){return 0>E-2||this.AVk(H.charAt(E-2))?!0:!1}AVk(E){return x.a.qda(E)||"("===E}Iyf(E,H,M){if(!E||""===E||0>H)this.reset();else{const {Bij:K,eEd:L}=this.d_m(E,H);this.oFe(K,M,L)}}d_m(E,H){const M=this.ZOl(E,H);if(0<=M&&H<=E.length)return{Bij:E.substring(M,H),eEd:M};this.reset();return{Bij:"",eEd:M}}ZOl(E,H){let M=-1,K=H;for(K;0<=K&&63>=H-K;K--)if(E.charAt(K)===this.Yna){M=K;break}63<H-K&&-1==M&&y.c(t.a.IRo,!0,void 0,void 0,void 0,void 0);return M}mom(E){E=
this.uQc(E.Hb.target);E=this.MRc().charAt(E-1);this.Sla&&E===this.Yna&&this.reset()}Uom(E){E=this.uQc(E.Hb.target);E=this.MRc().charAt(E);this.Sla&&E===this.Yna&&this.reset()}}I.newLine="\n";Object(D.a)(I,"AtMentionsListener",null,[14])},1850:function(D,J,c){c.d(J,"a",function(){return z});D=c(0);var l=c(7),e=c(78),a=c(773),k=c(124),x=c(8),y=c(352),n=c(1851);class t{constructor(v,I){this.PTc=v;this.fWc=I}x9h(){return this.fWc?this.PTc.Bc:this.PTc.end}Qio(v){this.fWc?this.PTc.Bc=v:this.PTc.end=v}mzi(v,
I){const E=this.x9h()+(this.fWc?0:-1);return E>=v&&E<I}}Object(D.a)(t,"HitRangeEdge",null,[]);class z{get Zc(){return null}get sj(){return null}get Hpa(){return!1}get tEf(){return!1}J_e(){}K5d(){return!1}xog(){return!1}i$h(v){return e.f(v,()=>!1)}zFa(){return null}b5d(v,I,E,H,M){I=I||[];E=E||[];const K=[];let L=0,S=0,Q=0;for(;L<I.length||S<E.length;){const N=L<I.length&&S<E.length?I[L].Bc<E[S].Bc?I[L++]:E[S++]:L<I.length?I[L++]:E[S++];K[Q]=n.a.createInstance(N.Bc,N.end,v,Q,H,M);++Q}return K}u0l(v,
I){if(!I)return null;if(!x.ParagraphReader.gJh(v))return this.Xjb(v.characterData,I);const E=this.ilm(v,k.AParagraphNode.IOc);v=this.mlm(v,E);I=this.Xjb(v,I);if(!I)return I;I=this.mFn(I);this.OZn(I,E);return I=this.EDl(I,E)}ilm(v,I){I=Object(y.c)(I);const E=Object(y.a)(I);return[...x.ParagraphReader.XRc(v)].map(H=>{H.isVisible=E(H);return H})}mlm(v,I){I=I.filter(E=>E.isVisible);return x.ParagraphReader.gVd(v,I)}mFn(v){const I=[];for(const E of v)I.push(new t(E,!0)),I.push(new t(E,!1));return I}OZn(v,
I){if(0!==v.length){var E=0,H=0;for(const M of I){if(E>=v.length)break;if(M.isVisible)for(;E<v.length;){I=v[E];if(!I.mzi(M.f4.cp-H,M.cpEnd-H))break;I.Qio(I.x9h()+H);E++}else H+=M.cpEnd-M.f4.cp}}}EDl(v,I){if(0===v.length)return[];const E=[];let H=0,M=!1;for(const K of I){if(H>=v.length)break;if(K.isVisible)for(;H<v.length;){I=v[H];if(!I.mzi(K.f4.cp,K.cpEnd))break;I.fWc?M=!0:!I.fWc&&M&&(E.push(I.PTc),M=!1);H++}else M=!1}return E}eCi(){return!1}oCi(){return!1}Xjb(v,I){if(I&&v){let E;const H=[];try{for(;E=
I.exec(v);){const M=new a.a(E.index,I.lastIndex);H.push(M)}return H}catch(M){l.ULS.sendTraceTag(522846819,313,15,M instanceof SyntaxError?"Invalid regular expression":`errorName: ${M.name}`)}}return null}zde(){}}Object(D.a)(z,"BaseFindManagerHelper",null,[708])},1851:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y,n,t){this.id=++l.bik;this.cNg=e;this.ebb=a;this.P8g=k;this.mZg=x;this.ek=y;this.p0g=n;this.pp=t;this.next=this.previous=null}get Bc(){return this.cNg}get end(){return this.ebb}get type(){return this.ek}$di(){return this.pp.zFa(this.nodeId)}get nodeId(){return this.P8g}get UQa(){return this.mZg}get kZd(){return this.p0g}y8k(e){this.cNg=
e.Bc;this.ebb=e.end;this.P8g=e.nodeId;this.mZg=e.UQa;this.ek=e.type;this.p0g=e.kZd}static createInstance(e,a,k,x,y,n){const {FindManagerHelper:t}=c(1568);return new l(e,a,k,x,y,n,t.instance)}}l.bik=0;Object(D.a)(l,"FindResult",null,[730])},1852:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(2);c=c(81);class e{static eyk(a){e.uwg.addHandler(e.OGh,a)}static zOn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&e.uwg.raiseEvent(e.OGh,a)}}e.OGh="CommandClickEvent";e.uwg=
new c.a;Object(D.a)(e,"CommandClickEvents",null,[])},1853:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.ErrorCode=J.FormattingSuggestionsRange=J.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=
10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(J.FormattingSuggestionType||(J.FormattingSuggestionType={}));(function(c){c[c.Paragraph=0]="Paragraph";c[c.List=1]="List"})(J.FormattingSuggestionsRange||(J.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(J.ErrorCode||
(J.ErrorCode={}))},1854:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.FormattingSuggestionsSummaryAnnotation=J.FormattingSuggestionsAnnotation=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}J.FormattingSuggestionsAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}J.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1855:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1856:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.PullQuotesSignal=J.DocumentPullQuoteAnnotation=J.PullQuoteAnnotation=void 0;const l=c(196);class e{constructor(x){l.SchemaObject.assign(e,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[e.getTypeName()])}}J.PullQuoteAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}J.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}J.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1857:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1858:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1859:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1860:function(D,J,
c){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageAnnotation=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};
e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();J.TextToImageAnnotation=D},1861:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();J.TextToImageSignal=D},1862:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.TextToImageTraceSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();J.TextToImageTraceSignal=D},1863:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1864:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.ThemeExtractorSignal=J.ThemeExtractorAnnotation=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}J.ThemeExtractorAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}J.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1865:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.TableType=
void 0;D=J.TableType||(J.TableType={});D[D.Other=0]="Other";D[D.SimpleHeaded=1]="SimpleHeaded"},1866:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.TableTypeAnnotation=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}J.TableTypeAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1867:function(D,J,c){c.d(J,"a",function(){return v});D=c(0);c(1583);var l=c(1642),e=c(2),a=c(19);c(1569);c(35);var k=c(7),x=c(1430),y=c(17),n=c(124),t=c(8),z=c(25);class v{constructor(I=2E3){this.Aok=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.Fcb=I}jLm(){v.vU();return!0}TXm(){return!0}getSelectedText(){const I=v.vU();return this.EUd(I)}Quf(){const I=
v.vU();return this.aem(I)}EUd(I){return this.khi(I,!0)}aem(I){return this.khi(I,!1)}khi(I,E){try{return this.$dm(I,E)}catch(H){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}$dm(I,E){var H=null;let M=!1;E&&I&&I.Zw&&y.SelectionEditor.Ze(I.Pa)&&y.SelectionEditor.Vlb(I.Pa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),M=y.SelectionEditor.Ze(I.Pa),(H=
y.SelectionEditor.j0(I.Pa,!1))&&H.Zw&&0<=H.Pa.cpBegin&&0<=H.Pa.cpEnd&&1>=H.Pa.cpEnd-H.Pa.cpBegin&&(H=null));H&&(I=H);if(!I)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const K=new Sys.StringBuilder;H=E=0;const L=[],S=I.length;let Q=null;for(let U=0;U<S;U++){var N=I.J(U);if(!t.ParagraphReader.Xb(N.node)||Array.contains(L,N.node.Uk))continue;L.push(N.node.Uk);const T=x.a.create(N.cpBegin,N.cpEnd),Y=t.ParagraphReader.pib(N.node,n.AParagraphNode.IOc,null,T);e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&M&&(Q=this.rBl(Y,T.Bd));let aa=Y,ba=0;var O=t.ParagraphReader.Wf(N.node,!0,!0,!0);N=t.ParagraphReader.Wf(N.node,!1,!0,!0);let oa=0;for(;aa.length<this.Fcb&&(O||N);){if(!(oa%2)&&O){var X=t.ParagraphReader.text(O,n.AParagraphNode.IOc);X&&(aa=X+" "+aa,ba+=X.length+1);O=t.ParagraphReader.Wf(O,!0,!0,!0)}1===oa%2&&N&&(aa=(X=t.ParagraphReader.text(N,n.AParagraphNode.IOc))?aa+" "+X:aa,N=t.ParagraphReader.Wf(N,!1,!0,!0));oa++}O=U===S-1;U||-1===T.Bd||(E=T.Bd);H+=O&&-1!==T.endCp?T.endCp:Y.length;K.append(aa);
e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&M&&Q&&(E=Q.start,H=Q.start+Q.length);E+=ba;H+=ba;O||(K.append(" "),H++)}for(I=n.AParagraphNode.QP(K.toString()," ");E<H&&a.a.Pv(I.charCodeAt(E));)E++;for(;H>E&&a.a.Pv(I.charCodeAt(H-1));)H--;return this.gBk(I,E,H)}rBl(I,E){for(var H;null!==(H=this.Aok.exec(I));){const M=H.index;H=H[0].length;if(E>=M&&E<=M+H)return{start:M,length:H}}return null}gBk(I,E,H){if(I.length>this.Fcb){var M=H-E;if(M>
this.Fcb)I=I.substr(E,this.Fcb),H=this.Fcb,E=0;else{M=Math.max(E-Math.floor((this.Fcb-M)/2),0);let K;K=Math.min(M+this.Fcb,I.length);M=Math.max(K-this.Fcb,0);E-=M;H-=M;I=I.substring(M,K)}}return Object.assign(new l.a,{neighborhood:I,mentionStart:E,mentionLength:H-E})}static vU(){var I=z.StaticActiveAppFrame.za().jb.rc;if(!I)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;I=I.mb;return I&&I.ib&&I.ib.length?I.ib.lb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(D.a)(v,"Box4InsightsSelection",null,[682,683])},1868:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(405);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(D.a)(l,"IconGalleryButtonProps",c.a,[])},1869:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.y=this.x=0}}Object(D.a)(l,"IPoint",null,[])},1870:function(D,J,c){c.d(J,"a",function(){return a});
D=c(0);var l=c(19),e=c(7);c=c(1603);class a extends c.a{constructor(k,x,y,n,t){super(k,x,t);this.lk=y;this.ehh=t}Foc(k){let x;if(this.zT&&!k)return e.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,$va:null};if(this.ehh){if(this.lk)return x=this.lk.u0f(k,!1),{returnValue:!0,$va:x};e.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const n=document.createElement("p");
n.innerText=this.i_c(k[y]);x.appendChild(n)}y=document.createElement("span");y.innerText=l.a.oNc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,$va:x}}i_c(k){return l.a.oNc(k.length?k:" ")}}Object(D.a)(a,"MultiLineTextImportStrategy",c.a,[])},1871:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(869);class l extends c.a{constructor(e,a,k,x,y=null,n=0,t=0,z=null,v=null,I=null,E=null){super(y?y.f$:null,y?y.LB:null,y?y.Mya:null,y?y.cultureName:null,y?y.dDa:null);this.src=e;this.alt=
a;this.width=k;this.height=x;this.maxWidth=n;this.maxHeight=t;this.href=z;this.kml=v;this.vkf=I;this.TGd=E}}Object(D.a)(l,"ImageSemanticArgs",c.a,[])},1872:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(113);class e{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,n,t,z,v,I,E,H,M,K,L,S,Q=null){const N=new e;N.ImageId=a;N.Src=k;N.Alt=x;N.Width=y;N.Height=n;N.Desc=t;N.LockId=z;N.ImageAnchorId=v;N.IsImageFromPaste=I;N.EditContainerWidth=E;N.LocalizedPicture=H;N.IsLayoutSizeSetByUser=M;if(K&&0<K.length){N.ContentNodes=Array(K.length);a=0;for(const O of K)N.ContentNodes[a]=l.a(O),a++}N.RunId=L;N.WordId=S;N.ClipServiceArgs=Q;return N}}Object(D.a)(e,"PastedPicture",null,[])},1873:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);
var l=c(22);J=c(594);var e=c(532);class a extends J.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}ml(){return e.a.picturePaste}static construct(k,x,y=null,n=!1){const t=new a;t.DataUriPictures=x;t.PastedPictures=k;(k=l.a.instance.Oa("Box4.IFeatureHelper"))&&k.isFeatureEnabled(10)&&
k.isFeatureEnabled(51)&&(t.ClipServicePictures=n,t.ChartsPasteFromXLOIsEnabled=!0,t.InkEditingInCanvasSupportedIsEnabled=!0,t.PictureEditingInIllustrationCanvasIsEnabled=!0,t.InkExternalPartFileFormatFixIsEnabled=!0);y&&y.length&&(t.FileId=y);return t}}Object(D.a)(a,"PicturePasteRequest",J.a,[])},1874:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1){this.DFb=e;this.IFi=a;this.VSk=k;this.JZm=x}}Object(D.a)(l,"ClearSpecificFormattingProperties",null,[])},1877:function(D,
J){Object.defineProperty(J,"__esModule",{value:!0})},1878:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.SuggestionCategory=void 0;D=J.SuggestionCategory||(J.SuggestionCategory={});D[D.TextRelatedImage=0]="TextRelatedImage";D[D.AbstractImage=1]="AbstractImage";D[D.Icon=2]="Icon"},1879:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1880:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1881:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});
J.TextToSuggestionSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();J.TextToSuggestionSignal=D},1882:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);var l=c(93),e=c(194),a=c(7),
k=c(111),x=c(143);class y{constructor(n,t,z,v,I,E,H,M,K){this.UAd=0;this.LW=null;this.Ieb="";this.fYb=this.GBe=!1;this.GLa=this.R7=null;this.N9f=!1;this.mXb=null;this.tDo=L=>{this.GLa===L&&(this.GLa=null,this.R7?this.Ieb=this.Xfa.C4c(this.LW.text):(this.RVf(),this.findInternal(null)),this.Fvj())};this.findInternal=()=>{this.R7=null;if(!this.i7e())if(!this.Xfa.vNb(this.Ieb).length)this.Vfb(),this.uqb(!0);else if(!this.R$f())switch(this._state){case 0:this.T4o();break;case 1:this.n8i()}};this.qbb=n;
this.Xfa=t;this.s3j=z;this.pp=v;this.IJe=I;this.Vyb=E;this.A3j=H;this.nXb=M;this.Sj=K;this._state=2;this.bM=0}get msg(){return this.UAd}set msg(n){this.UAd=n}get Gpc(){return this.UAd}set Gpc(n){this.UAd=n}get taskManager(){return this.IJe.value}get jPb(){return this.Vyb.value}get d8c(){return this.A3j.value}get $Dl(){return this.GBe}uqb(n){(this.GBe=n)&&this.qbb&&this.qbb.F8b()}get Blf(){return null}get EOc(){return this.mXb}find(n){this.LW=n;this.xZk();this.GLa=new l.a(2,1,this.msg,this.tDo,51);
this.taskManager.Wb(this.GLa)}p0a(){}Q$f(){}Dli(){}Ili(){}moi(){return!1}xZk(){this.R7&&(this.taskManager.ff(this.R7),this.R7=null);this.GLa&&(this.taskManager.ff(this.GLa),this.GLa=null)}T4o(){var n=(new Date).getTime();this.qUi();const t=this.U4o(n);this._state||(this.R7=new l.a(2,1,this.Gpc,this.findInternal,52),this.taskManager.Wb(this.R7));n=(new Date).getTime()-n;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:n,["Count"]:t})}txf(n,t,z=!0){this.PDh(n);if(Object(k.a)(99,n))if(12===
n.type)this.znm(n,t,this.fYb,z);else{const v=this.pp.Xjb(n.zFa(),this.EOc);z&&(v&&0<v.length?this.BUa(n,v):n.una());z=this.pp.b5d(n.id,v,null,t,this.fYb);this.mCd(n.id,z,n,t);this.qPf(n)}}znm(n,t,z,v=!0){const I=[];var E=this.pp.i$h(n);if(!e.a.af(E)&&(this.qPf(n),v))for(var H of E)E=this.pp.Xjb(H.zFa(),this.EOc),e.a.af(E)?this.una(H):(this.BUa(H,E),I.push(E));H=x.a.BJh?this.pp.u0l(n,this.EOc):this.pp.Xjb(n.zFa(),this.EOc);this.una(n);!e.a.af(H)&&v&&this.BUa(n,H);z=this.pp.b5d(n.id,H,I,t,z);this.mCd(n.id,
z,n,t)}U4o(n){let t=this._state=0;const z=this.$hi();this.W3i();const v=this.Foj();do this.HZf(),t++;while(this.k$e(z)&&(new Date).getTime()-n<y.yOi);v&&v.dispose();this.BVf();return t}RVf(){}Fvj(){}i7e(){return!1}Vfb(){}R$f(){return!1}n8i(){}qUi(){}PDh(){}BUa(){}una(){}qPf(){}mCd(){}BVf(){}$hi(){return null}W3i(){}Foj(){return null}HZf(){}k$e(){return!1}}y.yOi=200;Object(D.a)(y,"BaseFindManager",null,[1529])},1883:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a,k){this.rootNode=
e;this.qka=a;this.L8b=k}}Object(D.a)(l,"FindNodeContext",null,[])},1889:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(D.a)(l,"IconSetContainer",null,[])},1892:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);c=c(459);class l extends c.a{constructor(){super()}}l.taf="conversionRequestType";l.A1f="png";l.Dnf="gc2json";l.strict=
"strict";l.Wzl="existingcontent";l.error="error";Object(D.a)(l,"GraphicsEditorParameters",c.a,[])},1905:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.xtb=0;this.Yrd=isFinite(e)?Math.max(e,8):8;this.qp=Array(this.Yrd);this.$j=this.Meb=this.mZa=0;this.ZQg=this.v8h(this.Yrd)}get count(){return this.$j}get isEmpty(){return!this.count}enqueue(e){this.count===this.xtb&&this.Qym();this.qp[this.Meb]=e;this.Meb++;this.Meb===this.xtb&&(this.Meb=0);this.$j=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");
const e=this.qp[this.mZa];this.mZa++;this.mZa===this.xtb&&(this.mZa=0);this.$j=this.count-1;this.count<=this.ZQg&&this.Oil();return e}bZ(){if(!this.count)throw Error.create("Empty Queue");return this.qp[this.mZa]}Qym(){this.enj(2*this.xtb)}Oil(){const e=Math.max(this.xtb/2,this.Yrd);this.count>e||this.enj(e)}enj(e){const a=Array(e);let k=0;if(this.mZa<this.Meb||!this.count)for(var x=this.mZa;x<this.Meb;x++)a[k]=this.qp[x],k++;else{for(x=this.mZa;x<this.xtb;x++)a[k]=this.qp[x],k++;for(x=0;x<this.Meb;x++)a[k]=
this.qp[x],k++}this.qp=a;this.xtb=e;this.mZa=0;this.Meb=k;this.ZQg=this.v8h(e)}v8h(e){return e<=this.Yrd?-1:Math.floor(.25*e)}}Object(D.a)(l,"Queue",null,[])},1972:function(D,J){Object.defineProperty(J,"__esModule",{value:!0})},1973:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.AiInsertStreamCompletedAnnotation=J.AiInsertStreamChunkAnnotation=J.AiInsertAnnotationV2=J.AiInsertAnnotation=void 0;const l=c(196);class e{constructor(y){l.SchemaObject.assign(e,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=
y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[e.getTypeName()])}}J.AiInsertAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(y){l.SchemaObject.assign(a,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotationV2"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,
[a.getTypeName()])}}J.AiInsertAnnotationV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(y){l.SchemaObject.assign(k,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[k.getTypeName()])}}J.AiInsertStreamChunkAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(y){l.SchemaObject.assign(x,
this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[x.getTypeName()])}}J.AiInsertStreamCompletedAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},1974:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.CountLimitType=void 0;D=J.CountLimitType||(J.CountLimitType={});D[D.character=
0]="character";D[D.word=1]="word";D[D.sentence=2]="sentence";D[D.paragraphs=3]="paragraphs"},1975:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.LimitCount=J.AiInsertSignalV2=J.AiInsertSignal=void 0;const l=c(196);class e{constructor(x){l.SchemaObject.assign(e,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[e.getTypeName()])}}J.AiInsertSignal=
e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignalV2"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}J.AiInsertSignalV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}static getTypeName(){return"AugLoop_AiInsert_LimitCount"}static getBaseTypes(){return[]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[k.getTypeName()])}}J.LimitCount=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1976:function(D,J){Object.defineProperty(J,"__esModule",{value:!0});J.Status=void 0;D=J.Status||(J.Status={});D[D.Success=0]="Success";D[D.BlockedByShortInputFilter=1]="BlockedByShortInputFilter";D[D.BlockedByLanguageDetector=2]="BlockedByLanguageDetector";D[D.BlockedByPrefilter=3]="BlockedByPrefilter";D[D.BlockedByContentModerator=4]="BlockedByContentModerator";D[D.BlockedByPostfilter=5]="BlockedByPostfilter";D[D.FailedToGenerateContent=
6]="FailedToGenerateContent";D[D.UnexpectedError=7]="UnexpectedError";D[D.InvalidInputError=8]="InvalidInputError";D[D.MissingTemplateError=9]="MissingTemplateError"},1977:function(D,J,c){Object.defineProperty(J,"__esModule",{value:!0});J.QualityStatus=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_AiInsert_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}
J.QualityStatus=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1982:function(D,J,c){var l=c(1783),e=c(1784),a,k,x=0,y=0;D.exports=function(n,t,z){z=t&&z||0;var v=t||[];n=n||{};var I=n.node||a,E=void 0!==n.PFh?n.PFh:k;if(null==I||null==E){var H=l();null==I&&(I=a=[H[0]|1,H[1],H[2],H[3],H[4],H[5]]);null==E&&(E=k=(H[6]<<8|H[7])&16383)}H=void 0!==n.zgn?n.zgn:(new Date).getTime();var M=void 0!==n.USi?n.USi:y+1,K=H-x+(M-y)/1E4;0>K&&void 0===n.PFh&&(E=E+1&16383);(0>K||H>x)&&void 0===n.USi&&(M=0);if(1E4<=
M)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");x=H;y=M;k=E;H+=122192928E5;n=(1E4*(H&268435455)+M)%4294967296;v[z++]=n>>>24&255;v[z++]=n>>>16&255;v[z++]=n>>>8&255;v[z++]=n&255;n=H/4294967296*1E4&268435455;v[z++]=n>>>8&255;v[z++]=n&255;v[z++]=n>>>24&15|16;v[z++]=n>>>16&255;v[z++]=E>>>8|128;v[z++]=E&255;for(E=0;6>E;++E)v[z+E]=I[E];return t?t:e(v)}},1983:function(D,J,c){var l=c(1783),e=c(1784);D.exports=function(a,k,x){x=k&&x||0;"string"==typeof a&&(k="binary"===a?Array(16):null,a=null);
a=a||{};a=a.random||(a.j$n||l)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(k)for(var y=0;16>y;++y)k[x+y]=a[y];return k||e(a)}},1988:function(D,J,c){c.r(J);D=c(0);var l=c(2),e=c(93),a=c(2072),k=c(7),x=c(69),y=c(55),n=c(111),t=c(250),z=c(551),v=c(373),I=c(76),E=c(3),H=c(60),M=c(44),K=c(1068),L=c(5),S=c(95);class Q extends H.a{constructor(){super(new S.a(33));this.Dlf=this.Qag=0}VXd(){return 0}FHa(){const zb=new M.GraphTransaction(3);zb.Db(this);const Lb=new L.GraphIterator;Lb.set(this);if(Lb.Jz()){const Ia=
Lb.Rd();Lb.set(Ia);const Ya=K.b(Lb,this.Qag,this.Dlf),eb=new L.GraphIterator;eb.set(this);eb.Rd();eb.tg();Ya&&Lb.currentNode!==Ia&&eb.Bf(Lb.currentNode,-2)}zb.dispose()}}Object(D.a)(Q,"FindTrackingNode",H.a,[]);var N=c(17),O=c(49),X=c(8),U=c(1882),T=c(1883);class Y{constructor(zb){this.Yc=zb;zb=[];zb.push(1);this.Dkg=zb}g$h(zb){const Lb=this.Yc.Dk();Lb.set(zb);const Ia=[];Lb.zb(8)&&(Lb.jd(8),Ia.push(new T.a(Lb.currentNode,zb,1)));return Ia}static gF(){return new Y(new z.a)}static get instance(){return null!=
Y.oCg?Y.oCg:Y.oCg=Y.gF()}}Object(D.a)(Y,"FindContextHelper",null,[362]);var aa=c(1568),ba=c(368),oa=c(109),ma=c(16),ea=c(25);class ua{constructor(zb,Lb,Ia,Ya,eb,sb,lc,vb,Eb){this.Co=null;this.LXb=this.oDe=!1;this.Jab=this.zLg=this.Y$a=null;this.eeh=!1;this.IP=(Ua,Ta)=>{Ua=Ta.node;Ta.property===ma.a.ho&&this.DXc(Ua)&&this.JHb(Ua,3)};this.Ynb=(Ua,Ta)=>{Ua=Ta.node;this.DXc(Ua)&&this.JHb(Ua,2)};this.gja=(Ua,Ta)=>{Ua=Ta.node;Ta=Ta.MEf;!this.fB.$Dl&&Ta||!this.DXc(Ua)||this.JHb(Ua,1)};this.processDirtyNodes=
()=>{const Ua=this.je.Yf("UserAction","ProcessDirtyNodesInFindResultsTime");this.Co=null;const Ta=this.Lc.Pc(3);Ta.Db(this.pp.Zc);0<this.addedNodes.count&&(this.LXb=!0,this.jPg(this.addedNodes,this.fB.Sj));0<this.RLc.count&&this.jPg(this.RLc,this.fB.Sj);if(0<this.dgb.count){const Nb=!this.mhk(this.dgb,this.fB,this.pp,this.lhk);this.LXb=this.LXb||Nb}Ta.dispose();this.fB.Sj.Wrb();this.lqb(this.LXb);this.dij();Ua.stop()};this.Vbo=()=>{this.MGd();if(0<this.dgb.count||0<this.addedNodes.count||0<this.RLc.count)this.Co=
new e.a(2,1,500,this.processDirtyNodes,53),this.Ib.Wb(this.Co)};this.fB=zb;this.tW=Lb;this.pp=Ia;this.Ib=Ya;this.Lc=eb;this.jPg=sb;this.mhk=lc;this.lhk=vb;this.je=Eb;this.reset();this.dij=this.Vbo;this.pp.zde(this.IP,this.gja,this.Ynb)}get dgb(){return this.Y$a}get addedNodes(){return this.zLg}get RLc(){return this.Jab}get tfj(){return this.eeh}get lsm(){return 0<this.dgb.count||0<this.RLc.count}start(){this.oDe=!0;this.lqb(!1)}stop(){this.reset()}reset(){this.oDe=!1;this.lqb(!1);this.Y$a=new ba.a;
this.zLg=new ba.a;this.Jab=new ba.a;this.MGd()}DXc(zb){return!!zb.Mc&&!!this.pp.sj&&zb.Mc.id.equals(this.pp.sj.id)}JHb(zb,Lb){if(this.oDe&&Object(n.a)(99,zb)&&!this.fB.jPb.w7c)if(this.fB.Sj.d9a||this.fB.Sj.rmb.length){switch(Lb){case 1:this.dgb.nb(zb.id)||this.addedNodes.Z(zb.id,zb);break;case 2:this.dgb.nb(zb.id)&&this.dgb.remove(zb.id);this.addedNodes.nb(zb.id)?this.addedNodes.remove(zb.id):this.RLc.Z(zb.id,zb);break;case 3:this.dgb.Z(zb.id,zb)}this.dij()}else 2!==Lb&&this.lqb(this.LXb=!0)}MGd(){this.Co&&
(this.Ib.ff(this.Co),this.Co=null)}lqb(zb){this.tfj!==zb&&(this.eeh=zb,this.tW.lqb(zb));zb||(this.LXb=!1)}static gF(zb,Lb){return new ua(zb,Lb,aa.FindManagerHelper.instance,oa.a.instance,new v.a,ua.QYk,ua.rZn,ua.qZn,ea.StaticActiveAppFrame.za().Kq)}static createInstance(zb,Lb){return ua._instance||(ua._instance=ua.gF(zb,Lb))}static rZn(zb,Lb,Ia,Ya){let eb=!1;const sb=ua.mki(zb,ua.Zbn);for(let lc=0;lc<sb.length;++lc){const vb=!Ya(sb[lc],Lb,Ia);eb=eb||vb;zb.remove(sb[lc].id)}return!eb}static qZn(zb,
Lb,Ia){const Ya=Lb.Sj;zb.una();const eb=zb.id,sb=Ya.S$b(eb);if(sb)Lb=Ia.Xjb(zb.zFa(),Lb.EOc),Ia=Ia.b5d(eb,Lb,null,sb.type,sb.kZd),zb.BUa(Lb),Ya.vee(eb,Ia);else return!1;return!0}static QYk(zb,Lb){const Ia=ua.mki(zb,ua.Ybn);for(let Ya=0;Ya<Ia.length;++Ya){const eb=Ia[Ya],sb=eb.id;eb.una();Lb.a7c(sb);zb.remove(sb)}}static mki(zb,Lb){const Ia=[];let Ya=Lb;zb.forEach((eb,sb)=>{Ia.push(sb);--Ya;return Ya?!0:!1});return Ia}}ua.Zbn=5;ua.Ybn=15;ua._instance=null;Object(D.a)(ua,"FindResultAppEventCoordinator",
null,[1554]);class sa{constructor(zb,Lb){this.fAb=this.yUb=0;this.ztc=this.UDc=this.Xka=null;this.t1b=0;this.Iwb=null;this.tW=zb;this.Gla=Lb;this.yZa=new ba.a;this.Zyb=new ba.a;this.Pcb=new ba.a;this.Rab=new ba.a;this.xZa=new ba.a(0);this.xCc=new ba.a;for(zb=0;zb<Lb.length;++zb)this.xZa.Z(Lb[zb],0);this.rmb=[]}get UE(){return this.Xka}set UE(zb){this.Xka=zb;zb=Array(1);zb[0]=this.Xka;this.tW.OPa(3,zb)}get U$(){return this.UDc}set U$(zb){this.UDc=zb}get p4(){return this.ztc}set p4(zb){this.ztc=zb}get gFa(){let zb=
null;for(const Lb of this.Gla)if(zb=this.yZa.J(Lb))break;return zb}get yZe(){return this.yUb}mie(zb){zb!==this.yUb&&(this.yUb=zb)}get Aka(){return this.fAb}Hlc(zb){zb!==this.fAb&&(this.fAb=zb,this.tW&&!this.fAb&&(this.tW.Dge(0),this.tW.hie(0)))}get d9a(){return this.t1b}get Uec(){return this.Iwb}HZe(zb,Lb){if(zb&&!(0>=zb.length)){var Ia=zb[0].type,Ya=Lb,eb=Ya?Ya.next:this.yZa.J(Ia);Ya||this.yZa.Z(Ia,zb[0]);for(const sb of zb){const lc=sb;this.xCc.Z(lc.id,lc);Ya&&(Ya.next=lc);lc.previous=Ya;Ya=lc}Ya&&
(Ya.next=eb);eb&&(eb.previous=Ya);Lb&&zb[0].nodeId.equals(Lb.nodeId)||this.Pcb.Z(zb[0].nodeId,zb[0]);!eb&&Ya&&this.Zyb.Z(Ya.type,Ya);this.Uec===Lb&&(this.Iwb=Ya);this.xZa.Z(Ia,this.xZa.J(Ia)+zb.length);this.Hlc(this.Aka+zb.length);this.t1b=this.d9a+zb.length;this.tW&&this.tW.OPa(0,zb)}}qCd(zb){!zb||0>=zb.length||this.HZe(zb,this.Zyb.J(zb[0].type))}noh(zb){!zb||0>=zb.length||(this.Uec&&this.Uec.type!==zb[0].type&&(this.Iwb=null),this.HZe(zb,this.Uec))}a7c(zb){const Lb=this.S$b(zb);if(Lb){zb=Lb;for(var Ia=
0;zb;){++Ia;if(!zb.next||!zb.nodeId.equals(zb.next.nodeId))break;zb=zb.next}this.lbj(Lb,zb)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",zb.toString())}lbj(zb,Lb){let Ia=0,Ya=0;const eb=[];let sb=zb;for(;sb!==Lb.next;){const lc=this.ACi(sb);this.Pcb.J(sb.nodeId).id===sb.id&&(sb.next&&sb.next.nodeId.equals(sb.nodeId)?(this.Pcb.Z(sb.nodeId,sb.next),lc&&this.Rab.Z(sb.nodeId,sb.next)):(this.Pcb.remove(sb.nodeId),lc&&this.Rab.remove(sb.nodeId)));this.Uec&&
this.Uec.id===sb.id&&(this.Iwb=zb.previous);this.U$&&this.U$.id===sb.id&&(this.U$=this.jtf(sb,zb));this.p4&&this.p4.id===sb.id&&(this.p4=this.jtf(sb,zb));this.UE&&this.UE.id===sb.id&&(this.UE=this.jtf(sb,zb));this.xCc.remove(sb.id);eb.push(sb);sb=sb.next;lc?++Ya:++Ia}zb.previous?zb.previous.next=Lb.next:Lb.next?this.yZa.Z(Lb.type,Lb.next):this.yZa.remove(Lb.type);Lb.next?Lb.next.previous=zb.previous:zb.previous?this.Zyb.Z(zb.type,zb.previous):this.Zyb.remove(zb.type);Lb.next=null;zb.previous=null;
this.xZa.Z(zb.type,this.xZa.J(zb.type)-Ia);this.Hlc(this.Aka-Ia);this.t1b=this.d9a-(Ia+Ya);this.tW&&this.tW.OPa(1,eb)}vee(zb,Lb){const Ia=this.S$b(zb);if(Ia){const Ya=[],eb=[],sb=[];let lc=Ia,vb,Eb=0;do Eb<Lb.length?(lc.y8k(Lb[Eb]),Ya.push(lc)):(eb.push(lc),this.U$&&this.U$.id===lc.id&&0<Ya.length&&(this.U$=Ya[Ya.length-1])),++Eb,vb=lc,lc=lc.next;while(lc&&vb.nodeId.equals(lc.nodeId));for(;Eb<Lb.length;++Eb)sb.push(Lb[Eb]);0<eb.length&&this.lbj(eb[0],eb[eb.length-1]);0<sb.length&&this.HZe(sb,0<Ya.length?
Ya[Ya.length-1]:Ia);Lb=Ya.length;if(0<Lb){if(this.Rab.nb(zb)){this.Rab.remove(zb);this.Hlc(this.Aka+Lb);let Ua,Ta;(Ua=this.xZa).Z(Ta=Ya[0].type,Ua.J(Ta)+Lb)}this.tW&&this.tW.OPa(4,Ya)}}else k.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",zb.toString())}wFh(){this.Pcb=new ba.a;this.Rab=new ba.a;this.yZa=new ba.a;this.Zyb=new ba.a;this.xCc=new ba.a;for(let zb=0;zb<this.Gla.length;++zb)this.xZa.Z(this.Gla[zb],0);this.UE=null;this.mie(0);this.p4=this.U$=
this.Iwb=null;this.Hlc(0);this.t1b=0;this.tW&&this.tW.OPa(2,null)}INi(){this.Rab=new ba.a;this.Pcb.forEach((zb,Lb)=>{this.Rab.Z(zb,Lb);return!0});for(let zb=0;zb<this.Gla.length;++zb)this.xZa.Z(this.Gla[zb],0);this.UE=null;this.mie(0);this.Iwb=null;this.Hlc(0);this.tW&&this.tW.OPa(2,null)}S$b(zb){return this.Pcb.nb(zb)?this.Pcb.J(zb):null}jP(zb){let Lb=null;this.xCc.nb(zb)&&(Lb=this.xCc.J(zb));return Lb}t$h(zb){return this.yZa.nb(zb)?this.yZa.J(zb):null}U2l(zb){return this.Zyb.nb(zb)?this.Zyb.J(zb):
null}Wrb(){var zb=0;if(this.UE){zb=0;const Ya=this.UE.type;var Lb=this.yZa.J(Ya);if(Lb){for(var Ia=1;Lb&&this.UE.id!==Lb.id;)this.ACi(Lb)||++Ia,Lb=Lb.next;Lb&&(zb=Ia)}if(Lb){Lb=0;for(Ia=0;Ia<this.Gla.length&&this.Gla[Ia]!==Ya;++Ia)Lb+=this.xZa.J(this.Gla[Ia]);zb=Lb+zb}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.UE=null,zb=0}this.mie(zb);this.tW&&(this.tW.Dge(this.yZe),this.tW.hie(this.Aka))}$2a(zb){return this.sTd(zb,
!1)}iUd(zb){return this.sTd(zb,!0)}sTd(zb,Lb){let Ia=Lb?zb.previous:zb.next,Ya=zb.type;for(;!Ia&&(Ya=this.M6l(Ya,Lb),Ia=Lb?this.U2l(Ya):this.t$h(Ya),Ya!==zb.type););return Ia||zb}W9b(zb){return this.q7h(zb,!1)}Qbi(zb){return this.q7h(zb,!0)}q7h(zb,Lb){let Ia=this.sTd(zb,Lb);for(;Ia.nodeId.equals(zb.nodeId)&&Ia.id!==zb.id;)Ia=this.sTd(Ia,Lb);return Ia}M6l(zb,Lb){let Ia=0;for(let Ya=0;Ya<this.Gla.length;++Ya)if(zb===this.Gla[Ya]){Ia=Ya;break}Lb?(--Ia,0>Ia&&(Ia=this.Gla.length-1)):(++Ia,Ia===this.Gla.length&&
(Ia=0));return this.Gla[Ia]}Iej(){this.Iwb=null}jtf(zb,Lb){zb=this.$2a(zb);zb.id===Lb.id&&(zb=null);return zb}ACi(zb){return this.Rab.nb(zb.nodeId)}static createInstance(zb,Lb,Ia=!1){return Ia?new sa(zb,Lb):sa._instance||(sa._instance=new sa(zb,Lb))}}sa._instance=null;Object(D.a)(sa,"FindResultManager",null,[1527]);class Fa{constructor(zb,Lb){this.Tmm=Ia=>{const Ya=this.pp.sj.Eb(Ia.nodeId);if(Ya){if(this.zC.UE){var eb=this.pp.sj.Eb(this.zC.UE.nodeId);(eb=Object(x.a)(99,eb))?eb.XEh():k.ULS.sendTraceTag(4069060,
313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.zC.UE.nodeId})}Ya.dPf(Ia.UQa,Ia.type)?(this.zC.UE=Ia,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:Ia.id})):c(1988).FindManager.instance.moi()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ya.id,["HitIndexInNode"]:Ia.UQa,["ResultId"]:Ia.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ya.id,["HitIndexInNode"]:Ia.UQa,
["ResultId"]:Ia.id});this.zC.Wrb()}else k.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:Ia.nodeId})};this.zC=zb;this.pp=Lb;this.axf=this.Tmm}Gli(){const zb=this.zC.UE?this.zC.$2a(this.zC.UE):this.zC.gFa;this.axf(zb)}Smm(){const zb=this.zC.UE?this.zC.iUd(this.zC.UE):this.zC.gFa;this.axf(zb)}Kli(zb){const Lb=this.zC.jP(zb);Lb?this.axf(Lb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:zb})}static gF(zb){return new Fa(zb,
aa.FindManagerHelper.instance)}static createInstance(zb){return Fa._instance||(Fa._instance=Fa.gF(zb))}}Fa._instance=null;Object(D.a)(Fa,"FindResultNavigator",null,[1526]);var Pa=c(19),Na=c(1236);H=c(150);class Aa{static vNb(zb){const Lb=[];var Ia=RegExp('"[^"\\r\\n]*"',"ig"),Ya=zb.match(Ia);let eb;if(Ya&&0<Ya.length)for(eb=0;eb<Ya.length;eb++){var sb=Ya[eb].split('"').join("");sb=sb.trim();sb=sb.split(Aa.Oad).join(" ");if(""!==sb){Lb.push(sb);var lc=sb.split(Aa.punctuation).join(" ");lc=lc.trim();
lc=lc.split(Aa.Oad).join(" ");""!==lc&&lc!==sb&&Lb.push(lc)}}zb=zb.split(Ia).join(" ");Ia=Na.a.instance.rQl(zb);if(!Ia.length)return Lb.sort(Aa.Tuj),Lb;Ya=Ia[0];for(eb=1;eb<Ia.length;eb++)if(lc=Ia[eb],2!==Ya.VL||2!==lc.VL)sb=zb.substring(Ya.cp,lc.cp),sb=sb.trim(),Aa.mFi(sb,Ya)&&Lb.push(sb),Ya=lc;sb=zb.substring(Ya.cp,zb.length);sb=sb.trim();Aa.mFi(sb,Ya)&&Lb.push(sb);Lb.sort(Aa.Tuj);return Lb}static mFi(zb,Lb){return""!==zb&&'"'!==zb&&1!==Lb.VL}static X4n(zb){for(let Lb=0;Lb<zb.length;Lb++)zb[Lb]=
zb[Lb].split(Aa.Oad).join("\\s+");return zb}static Tuj(zb,Lb){return zb.length>Lb.length?-1:zb.length===Lb.length?0:1}}Aa.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");Aa.Oad=RegExp("\\s+");Aa.cVn=[new H.a(RegExp("\\[","g"),"\\["),new H.a(RegExp("\\]","g"),"\\]"),new H.a(RegExp("\\\\","g"),"\\\\"),new H.a(RegExp("\\^","g"),"\\^"),new H.a(RegExp("\\$","g"),"\\$"),new H.a(RegExp("\\.","g"),"\\."),new H.a(RegExp("\\|","g"),"\\|"),new H.a(RegExp("\\+","g"),"\\+"),new H.a(RegExp("\\(",
"g"),"\\("),new H.a(RegExp("\\)","g"),"\\)"),new H.a(RegExp("\\?","g"),"\\?"),new H.a(RegExp("\\*","g"),"\\*")];Object(D.a)(Aa,"SearchAndFindUtils",null,[]);class za{C4c(zb){return Pa.a.oha(zb,Aa.cVn)}vNb(zb){zb=Aa.vNb(zb);return zb=Aa.X4n(zb)}$3i(){return null}R1d(){return!1}static get instance(){return null!=za.QCg?za.QCg:za.QCg=new za}}Object(D.a)(za,"QueryProcessor",null,[1153]);var xa=c(738),ka=c(22),wa=c(11),ia=c(28),va=c(654),na=c(773),Ca=c(15),ta=c(206),fa=c(238);class Xa{constructor(){this.x7c=
this.transaction=null;this.Grb=this.P9f=0;this.M9f=this.ahb=null}}Object(D.a)(Xa,"ReplaceAllContext",null,[]);class ob{constructor(zb,Lb,Ia,Ya,eb,sb,lc,vb,Eb,Ua,Ta){this.Dpn=(Nb,Wa,Bb,Ob,hc)=>{let Gc=null;if(Nb>Wa)for(Gc=Bb;0<Wa&&Gc.nodeId.equals(hc.id);)Gc=this.zC.$2a(Gc),--Wa;else 0<Nb?Gc=this.zC.W9b(Bb):Ob.nodeId!==hc.id&&(Gc=Ob);return Gc};this.nFh=()=>{const Nb=this.zC.rmb;if(Nb&&0<Nb.length){const Wa=this.Lc.Pc(3);Wa.Db(this.pp.sj.Eb(Nb[0]));for(let Bb=0;Bb<Nb.length;++Bb){const Ob=this.pp.sj.Eb(Nb[Bb]);
Ob?Ob.una(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",Nb[Bb])}Wa.dispose();Array.clear(this.zC.rmb)}};this.uvn=(Nb,Wa)=>{this.oCc=!0;this.Oaj();const Bb=new Xa;Bb.x7c=Nb?Nb:"";Bb.M9f=Wa;Bb.Grb=this.zC.Aka;Nb=this.Lc.Pc(15);Nb.Db(this.pp.Zc);Bb.transaction=Nb;this.Lzl(Bb,Nb)};this.Uon=(Nb,Wa)=>{Nb=new xa.a(null,this.jKn,Nb);const Bb=this.pp.Zc;Bb&&Bb.zJ().rF.f8(9);Nb.Rl("ReplaceAll");Wa.RIa(Nb);Nb.run()};this.etn=(Nb,Wa)=>{Nb=this.je.Yf("UserAction",
"OnProcessReplaceAll");if(this.bUm(Wa))return this.S3k(Wa),!1;let Bb=Wa.ahb;Bb||(Bb=this.zC.gFa);Wa.ahb=this.zC.W9b(Bb);const Ob=this.pp.sj.Eb(Bb.nodeId);if(!Ob)return k.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Bb.id,Bb.nodeId),!0;const hc=Ob.rQa();if(hc&&hc.length)if(this.JVk(Ob,hc[0].Bc,hc[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",Ob.id);else{let Gc=0;for(let bc=0;bc<hc.length;++bc){Wa.P9f+=
1;const Dc=this.replaceText(this.fB.Blf,Ob,Wa.x7c,ia.a.createTextRange(Ob,hc[bc].Bc+Gc,hc[bc].end+Gc));Gc+=Wa.x7c.length-(hc[bc].end-hc[bc].Bc)+Dc;Ob.Oeg(0,Wa.x7c.length)}0<Wa.x7c.length&&this.zC.rmb.push(Bb.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Bb.id,Bb.nodeId);Nb.stop();return!0};this.vnn=Nb=>{Nb.transaction.dispose();this.oCc=!1;this.fB.p0a(!1);Nb.M9f&&Nb.M9f(Nb.P9f,Nb.Grb)};this.Rtn=(Nb,Wa,Bb,Ob)=>{!Nb.matchCase&&0<
Bb.length&&(Nb=Wa.zFa().substr(Ob.cpBegin,Ob.cpEnd-Ob.cpBegin),Bb=this.sUk(Bb,Nb));return this.pCc(Ob,Bb,!0,!1)};this.fB=zb;this.zC=Lb;this.pp=Ia;this.Lc=Ya;this.HJe=eb;this.H8j=lc;this.hLg=vb;this.pCc=Eb;this.U$j=Ua;this.je=Ta;this.oCc=!1;this.QDo=this.uvn;this.jKn=this.etn;this.S3k=this.vnn;this.Lzl=this.Uon;this.Oaj=this.nFh;this.replaceText=this.Rtn;this.sUk=ob.Fmn;this.T6l=this.Dpn}get nI(){return this.HJe.value}get w7c(){return this.oCc}replace(zb){var Lb=!1;if(this.w7c)return k.ULS.sendTraceTag(4069062,
313,15,"Replace: Cancelled as replace is already in progress"),Lb;if(this.nI.Ihl){var Ia=this.nI.y4;const sb=Ia.node;Ia.contextId===wa.a.paragraph&&(Ia=ia.a.createTextRange(sb,0,X.ParagraphReader.textLength(sb)));var Ya=Object(x.a)(99,sb);if(Ya){var eb=new na.a(Ia.cpBegin,Ia.cpEnd);eb=Ya.Yai(eb);if(eb!==va.a.invalid&&0<=eb){if(this.yDh(Ia))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),Lb;this.oCc=!0;Lb=this.Lc.Pc(15);Lb.Db(sb);this.replaceText(this.fB.Blf,Ya,
zb,Ia);Lb.dispose();this.Oaj();Ya.Oeg(eb,zb.length);0<zb.length&&this.zC.rmb.push(sb.id);zb=this.zC.S$b(sb.id);Ia=this.zC.$2a(zb);Ya=Ya.rQa();Ya=this.pp.b5d(sb.id,Ya,null,zb.type,zb.kZd);this.zC.vee(sb.id,Ya);(Ia=this.T6l(Ya.length,eb,zb,Ia,sb))?this.fB.d8c.Kli(Ia.id):this.zC.Wrb();Lb=!0;this.oCc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,
313,50,"Replace: Cancelled as current selection does not contain single context");Lb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.fB.N9f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.fB.d8c.Gli());return Lb}replaceAll(zb,Lb){this.w7c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.zC.Aka?this.QDo(zb,Lb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}yDh(zb){const Lb=
this.H8j(zb);!Lb&&this.hLg.value&&this.U$j.value&&this.hLg.value(zb.node);return Lb}JVk(zb,Lb,Ia){return this.yDh(ia.a.createTextRange(zb,Lb,Ia))}bUm(zb){return zb.ahb===this.zC.gFa}static get jg(){return null!=ob.kxg?ob.kxg:ob.kxg=ka.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static gF(zb,Lb){const Ia=new t.a(()=>Ca.App.zd&&Ca.App.zd.fq?Object(y.a)(Ca.App.zd.fq,Ca.App.zd.fq.iG,"acquireAndApplyLock"):null);return new ob(zb,Lb,aa.FindManagerHelper.instance,new v.a,new t.a(()=>ta.a.instance),
new t.a(()=>O.a.instance),Object(y.a)(fa.a.instance,fa.a.instance.QKm,"isContextSetInLockedRange"),Ia,Object(y.a)(ob.jg,ob.jg.Ge,"replaceTextRange"),new t.a(()=>Ca.App.zd.Uo),ea.StaticActiveAppFrame.za().Kq)}static createInstance(zb,Lb){return ob._instance||(ob._instance=ob.gF(zb,Lb))}static Fmn(zb,Lb){const Ia=Pa.a.eh(Lb);!Pa.a.localeCompare(Pa.a.ZA(Lb),Lb)&&Pa.a.localeCompare(Ia,Lb)?zb=Pa.a.ZA(zb):Pa.a.qec(Lb.charAt(0))&&!Pa.a.IGf(Lb.charAt(0))&&(Lb=Pa.a.ZA(zb.substr(0,1)),zb=1===zb.length?Lb:Lb+
zb.substr(1,zb.length-1));return zb}}ob._instance=null;Object(D.a)(ob,"ReplaceManager",null,[1470]);c.d(J,"FindManager",function(){return xb});class xb extends U.a{constructor(zb,Lb,Ia,Ya,eb,sb,lc,vb,Eb,Ua,Ta,Nb,Wa,Bb,Ob,hc=!1){super(zb,Lb,Ia,eb,sb,Wa,Bb,Ta,Nb);this.Fla=this.VCc=null;this.WAd=!1;this.ZCa=this.Fab=this.scb=null;this.fvc=0;this.Ayd=Ya;this.Uwb=lc;this.Yc=vb;this.Lc=Eb;this.ZOe=Ua;this.z3j=Ob;this.Kyc=[];this._state=2;this.wzb=!hc;this.bub=new Q;this.pp.J_e(this.bub);this.L0b=new Q;
this.pp.J_e(this.L0b);this.pp.Zc&&(this.scb=this.pp.sj);this.msg=400;this.Gpc=100}get mb(){return this.Uwb.value}get Blf(){return this.VCc}get YOd(){return this.z3j.value}p0a(zb=!0){this.jPb&&this.jPb.w7c||(this.Vfb(zb),this.qbb.reset(),this.Ieb="",this.Ayd&&this.YOd.stop(),this.yZk(),this.coj(null))}yZk(){this.R7&&(this.taskManager.ff(this.R7),this.R7=null);this.GLa&&(this.taskManager.ff(this.GLa),this.GLa=null)}Vfb(zb=!0){!this.scb&&0<this.Sj.d9a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});
if(0<this.Sj.d9a&&this.scb){let Ia=this.Sj.gFa;const Ya=Ia.nodeId;if(this.scb.Eb(Ya)){const eb=this.Lc.Pc(3);for(eb.Db(this.scb.Eb(Ya));Ia;){const sb=this.scb.Eb(Ia.nodeId);var Lb=Object(x.a)(99,sb);if(Lb){if(this.wzb&&(Lb.una(void 0,zb),X.ParagraphReader.Xb(sb)&&(Lb=this.pp.i$h(sb))))for(const lc of Lb)lc.una(void 0,zb);sb.nl(16,!0)}Ia=this.Sj.W9b(Ia);if(!Ia||Ia.nodeId.equals(Ya))break}eb.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Sj.wFh()}zb&&
this.jPb&&this.jPb.nFh();this.Oej();this.Kyc=[];this.mXb=this.VCc=null;this.bM=0;this.N9f=this.WAd=!1}Q$f(){const zb=this.LW;this.Vfb();zb&&""!==zb.text&&this.find(zb)}moi(){return this.Ayd&&this.YOd.lsm}kfj(){10>this.fvc?(this.fvc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.fvc}),this.find(this.LW)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.va.processAction(E.a.y4b,2),this.fvc=0)}n8i(){var zb=(new Date).getTime();
let Lb=!1;this.Sj.d9a||(Lb=!0);let Ia=0;if(!Lb){this.Sj.U$||(this.Sj.U$=this.Sj.gFa);this.Sj.p4||(this.Sj.p4=this.Sj.U$,this.Sj.UE=null);let Ya=null,eb=!0;for(;!Lb&&this.Sj.p4&&(new Date).getTime()-zb<U.a.yOi;){const sb=this.Sj.p4,lc=this.pp.sj.Eb(sb.nodeId);lc?(eb&&(Ya=this.Lc.Pc(3),Ya.Db(lc),eb=!1),sb.kZd&&!this.Fab&&(this.Fab=lc),this.Sj.p4=this.Sj.W9b(this.Sj.p4),Lb=!this.Sj.p4||this.Sj.p4.nodeId.equals(this.Sj.U$.nodeId),this.txf(lc,sb.type,this.wzb),++Ia):this.Sj.a7c(sb.nodeId)}Ya&&Ya.dispose()}this.Sj.Wrb();
Lb&&(this.Sj.p4=null,this.WAd?this._state=0:(this._state=2,this.uqb(!0)));this.R7=new e.a(2,1,this.Gpc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.R7);zb=(new Date).getTime()-zb;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:zb,["Count"]:Ia,["Total"]:this.Sj.Aka,["TotalWithDirty"]:this.Sj.d9a})}fHn(){this.Vfb();this.bM=0;if(this.pp.tEf&&this.wzb){var zb=this.mb;if(zb){var Lb=zb.ib.lb;if(Lb){var Ia=ea.StaticActiveAppFrame.za().jb.rc;(Ia=Ia?Ia.Es:null)&&
Ia.jVa();Lb=N.SelectionEditor.Jj(Lb,!1,!1);zb.Ac(Lb);Ia&&Ia.jOa()}}}zb=this.Pnl();this.Fla=this.s3j.g$h(zb)}doj(){this.coj(this.Fla[this.bM].qka)}coj(zb){this.Joo(zb);this.xlj(zb)}Oej(){this.Fab=null;this.fYb=!1}gtf(zb){const Lb=this.Yc.Dk();Lb.set(zb);if(!Lb.zb(7))return Lb.reset(),null;if(this.pp.K5d(Lb,7,0))return zb=Lb.currentNode,Lb.reset(),zb;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");Lb.reset();return null}Pnl(){if(this.pp.tEf){var zb=this.mb;if((zb=zb?zb.ib.lb:
null)&&this.wzb)return zb.Rc.al?(zb=zb.Rc,N.SelectionEditor.pv(zb)?(zb=zb.node,Object(n.a)(99,zb)?zb:this.gtf(zb)):Object(n.a)(99,zb.node)?zb.node:this.gtf(zb.node)):this.gtf(this.pp.Zc);zb=this.Yc.Dk();zb.set(this.pp.Zc);if(this.pp.xog(zb,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const Lb=zb.currentNode;zb.reset();return Lb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");
return null}lvf(){const zb=this.Yc.Dk();zb.set(this.L0b);if(1===zb.Wp())return zb.Rd(),zb.currentNode;k.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}Joo(zb){const Lb=this.Lc.Pc(3);Lb.Db(this.L0b);const Ia=this.Yc.Dk();Ia.set(this.L0b);Ia.Jz()&&(Ia.Rd(),Ia.tg());zb&&(Ia.Bf(zb,81),zb=this.Fla[this.bM],this.L0b.Qag=zb.rootNode.type,this.L0b.Dlf=zb.L8b);Lb.dispose()}$Ul(){if(this.bub){var zb=this.Yc.Dk();zb.set(this.bub);if(zb.Wp())return zb.Rd(),zb.currentNode;
zb=this.ZOe(this.pp.Zc);zb.moveNext();if(zb.currentNode)return zb.currentNode}k.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");return null}xlj(zb){const Lb=this.Lc.Pc(3);Lb.Db(this.bub);const Ia=this.Yc.Dk();Ia.set(this.bub);Ia.Jz()&&(Ia.Rd(),Ia.tg());zb&&(Ia.Bf(zb,81),zb=this.Fla[this.bM],this.bub.Qag=zb.rootNode.type,this.bub.Dlf=zb.L8b);Lb.dispose()}Dli(){let zb=this.Sj.UE||this.Sj.gFa;if(zb){for(var Lb=!1,Ia=!0;zb;){var Ya=this.pp.sj.Eb(zb.nodeId);if(Ya=Object(x.a)(99,
Ya))if(Lb=Ya.ePf(zb.type)){Ia&&(zb=this.Sj.$2a(zb));break}else zb=this.Sj.$2a(zb);else if(Ia=zb,zb=this.Sj.W9b(zb),this.Sj.a7c(Ia.nodeId),!zb||Ia.nodeId.equals(zb.nodeId))break;Ia=!1}Lb?(this.Sj.UE=zb,this.Sj.Wrb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}Ili(){let zb=this.Sj.UE||this.Sj.gFa;if(zb){for(var Lb=!1,Ia=!0;zb;){var Ya=this.pp.sj.Eb(zb.nodeId);if(Ya=Object(x.a)(99,Ya))if(Lb=Ya.ANi(zb.type)){Ia&&
(zb=this.Sj.iUd(zb));break}else zb=this.Sj.iUd(zb);else if(Ia=zb,zb=this.Sj.Qbi(zb),this.Sj.a7c(Ia.nodeId),!zb||Ia.nodeId.equals(zb.nodeId))break;Ia=!1}Lb?(this.Sj.UE=zb,k.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Sj.Wrb()}}PTk(){return 2===this._state&&(this.N9f||this.Ayd&&this.YOd.tfj)}RVf(){this.pp.Hpa?(this.Ieb=this.Xfa.C4c(this.LW.text),this.scb=this.pp.sj,this.Oej()):this.kfj()}Fvj(){this.Ayd&&
this.YOd.start()}i7e(){if(!this.pp.Hpa||this.scb!==this.pp.sj)return this.Vfb(),this.kfj(),!0;this.fvc=0;return!1}R$f(){const zb=this.Xfa.vNb(this.Ieb),Lb=this.PTk();let Ia=!1;if(Lb||this.pp.eCi(this.VCc,this.Kyc,this.LW,zb)){Ia=!0;this.uqb(!1);this.qbb.update();this.qbb.Glf();!Lb&&this.pp.oCi(this.VCc,this.Kyc,this.LW,zb)?(this.Sj.INi(),this.Sj.p4=null,this._state=1):(this.fHn(),this.doj(),this._state=0,this.WAd=!0);this.VCc=this.LW;this.Kyc=zb;try{this.mXb=this.nXb.P$b(this.Kyc.join("|"),this.LW)}catch(Ya){return k.ULS.sendTraceTag(0,
313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.LW.matchCase,this.LW.matchWholeWord),this.mXb=null,this._state=2,this.uqb(!0),!0}this.R7=new e.a(2,1,this.Gpc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.R7)}return Ia}qUi(){if(!this.Fab){const zb=this.Yc.Dk();zb.set(1===this.Fla[this.bM].L8b?this.pp.Zc:this.Fla[this.bM].rootNode);this.pp.xog(zb,this.Fla[this.bM].rootNode.type,this.Fla[this.bM].L8b)?
(this.Fab=zb.currentNode,zb.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),zb.reset(),this.R7=new e.a(2,1,this.Gpc,Object(y.a)(this,this.findInternal,"findInternal"),52),this.taskManager.Wb(this.R7))}}BVf(){this.Sj.Wrb();this.xlj(this.ZCa.currentNode);this.ZCa.currentNode===this.lvf()&&(this.bM++,this.bM===this.Fla.length?(this.bM=0,this._state=2,this.WAd=!1,this.uqb(!0)):this.doj());this.ZCa=null}$hi(){return this.lvf()}W3i(){const zb=this.$Ul();this.ZCa=
this.Yc.Dk();this.ZCa.set(zb);this.ZCa.e2(this.Fla[this.bM].rootNode)}Foj(){const zb=this.Lc.Pc(3);zb.Db(this.ZCa.currentNode);return zb}HZf(){this.txf(this.ZCa.currentNode,this.Fla[this.bM].L8b,this.wzb);this.pp.K5d(this.ZCa,this.Fla[this.bM].rootNode.type,this.Fla[this.bM].L8b)}k$e(zb){return!!this.ZCa.currentNode&&!this.ZCa.currentNode.id.equals(zb.id)}PDh(zb){!this.fYb&&this.Fab&&zb.id===this.Fab.id&&this.lvf().id!==this.Fab.id&&0<this.Sj.d9a&&(this.fYb=!0,this.Sj.Iej())}mCd(zb,Lb,Ia,Ya){const eb=
this.Sj.S$b(zb);eb?this.Sj.vee(zb,Lb):this.fYb?this.Sj.noh(Lb):this.Sj.qCd(Lb);this.wzb&&!this.Sj.UE&&0<Lb.length&&Ia.ePf(Ya)&&(this.Sj.UE=eb?eb:Lb[0],this.Sj.U$||(this.Sj.U$=this.Sj.UE))}BUa(zb,Lb){zb.BUa(Lb)}una(zb){this.wzb&&zb.una()}qPf(zb){zb.nl(16,!0)}static gF(zb,Lb,Ia,Ya,eb=!1){Lb||(Lb=za.instance);Ia||(Ia=Y.instance);const sb=sa.createInstance(zb,Ia.Dkg,eb),lc=new t.a(()=>ob.createInstance(xb.instance,xb.instance.Sj)),vb=new t.a(()=>Fa.createInstance(xb.instance.Sj)),Eb=new t.a(()=>ua.createInstance(xb.instance,
zb));return new xb(zb,Lb,Ia,Ya,aa.FindManagerHelper.instance,new t.a(()=>l.AFrameworkApplication.lc),new t.a(()=>O.a.instance),new z.a,new v.a,I.a.createInstance,a.a.instance,sb,lc,vb,Eb,eb)}static get instance(){return xb._instance}static createInstance(zb,Lb=null,Ia=null,Ya=!1,eb=!1){return eb?xb.gF(zb,Lb,Ia,Ya,!0):xb.instance||(xb._instance=xb.gF(zb,Lb,Ia,Ya))}}xb._instance=null;Object(D.a)(xb,"FindManager",U.a,[])},1990:function(D,J,c){D=c(0);var l=c(22),e=c(2),a=c(244),k=c(43),x=c(6),y=c(16),
n=c(47),t=c(7),z=c(69),v=c(111),I=c(75),E=c(88),H=c(209),M=c(11),K=c(5),L=c(601),S=c(104),Q=c(833),N=c(1055),O=c(37),X=c(221),U=c(207),T=c(84);class Y{constructor(vb){this.uqa=vb}}Object(D.a)(Y,"ValidParentData",null,[]);var aa=c(41),ba=c(339),oa=c(671),ma=c(365),ea=c(670),ua=c(518);class sa{constructor(){this.U6b=0}}Object(D.a)(sa,"BelowOutlineElementData",null,[]);var Fa=c(639),Pa=c(877),Na=c(543);class Aa extends Fa.a{constructor(vb,Eb,Ua,Ta){super(4,Ta);this.S6b=vb;this.OAb=Eb;this.wHc=Ua}pac(){var vb=
this.S6b;if(!vb)return t.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const Eb=[],Ua=new Pa.a(this.S6b.id,this.S6b.Wc,this.OAb?this.OAb.id:null);""!==vb.characterData&&vb.characterData&&(vb=new Na.DeleteTextUpdateHint(this.S6b.id,0,vb.characterData),Eb.push(vb));Eb.push(Ua);return Eb}}Object(D.a)(Aa,"DeleteParagraphOperation",Fa.a,[]);var za=c(954),xa=c(470);class ka extends Fa.a{constructor(vb,Eb,Ua,Ta,Nb){super(3,Nb);this.vqa=
vb;this.USa=Eb;this.mhn=Ua;this.pya=Ta}pac(){const vb=[];var Eb=new za.AddParagraphUpdateHint(this.pya.id,this.pya.Wc,this.vqa?this.vqa.id:null);vb.push(Eb);""!==this.pya.characterData&&this.pya.characterData&&(Eb=new xa.a(this.pya.id,0,this.pya.characterData),vb.push(Eb));return vb}}Object(D.a)(ka,"InsertNewParagraphOperation",Fa.a,[]);var wa=c(953);class ia extends Fa.a{constructor(vb,Eb,Ua,Ta){super(2,Ta);this.vqa=vb;this.USa=Eb;this.$4d=Ua}pac(){const vb=[],Eb=new wa.MergeParagraphUpdateHint(this.vqa.id,
this.vqa.Wc,this.vqa.characterData.length,this.USa.id,this.USa.Wc,this.$4d.id,this.$4d.Wc);vb.push(Eb);return vb}}Object(D.a)(ia,"MergeParagraphOperation",Fa.a,[]);var va=c(876);class na extends Fa.a{constructor(vb,Eb,Ua,Ta,Nb){super(1,Nb);this.o5=vb;this.kvj=Eb;this.OAb=Ua;this.wHc=Ta}pac(){const vb=[],Eb=new va.a(this.o5.id,this.o5.Wc,this.kvj,this.OAb.id,this.OAb.Wc,this.wHc.id,this.wHc.Wc);vb.push(Eb);return vb}}Object(D.a)(na,"SplitParagraphOperation",Fa.a,[]);var Ca=c(377),ta=c(15),fa=c(539),
Xa=c(44),ob=c(1116),xb=c(33),zb=c(124),Lb=c(238),Ia=c(8),Ya=c(185),eb=c(12),sb=c(91);c.d(J,"a",function(){return lc});class lc{constructor(vb,Eb,Ua,Ta,Nb,Wa,Bb=null,Ob=null,hc=null,Gc=null,bc=null){this.nV=bc;this.HK=vb;this.FK=Eb;this.Hf=Ua;this.h7=Bb;this.ev=Ob;this.rz=hc;this.Mo=Gc}Dqk(vb){var Eb;(null===(Eb=ta.App.zd)||void 0===Eb?0:Eb.Uo)&&ta.App.zd.fq.iG(vb)}Kza(vb,Eb,Ua,Ta=!1){O.OutlineElementNavigator.Ee(vb);Ia.ParagraphReader.oh(vb)?lc.Sk.qq.Kza(vb,Eb,Ua):xb.TableReader.isTable(vb)&&14===
vb.Xe&&(Eb=(new ma.a(1,Ua)).Xt,Ua=Object(z.a)(ba.TableNode,vb.currentNode),this.noj(Ua,Eb,Ta));O.OutlineElementNavigator.Yd(vb)}noj(vb,Eb,Ua=!1){vb&&Object(v.a)(ba.TableNode,vb)&&(Ua?Eb?(vb.setValue(x.a.ee,Eb),Eb=xb.TableReader.hh(vb),lc.Lk.xeg(vb,Eb)):vb.removeProperty(x.a.ee):vb.ee=Eb)}get qq(){return N.a.TGb}get tE(){return this.ev||(this.ev=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get qc(){return this.rz||(this.rz=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Qd(){return null!=
this.YIg?this.YIg:this.YIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.KIg?this.KIg:this.KIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Zm(){return this.FK.value}get Jd(){return this.Hf.value}get CL(){return this.HK.value}get Xf(){return Lb.a.instance}get OD(){return null!=this.Oxg?this.Oxg:this.Oxg=l.a.instance.Oa("Box4.IContentControlConverter")}Tgb(){const vb=Q.a.instance.createInstance(393229);vb.setValue(y.a.EL,
X.a.first);vb.setValue(y.a.Ogl,new Date);vb.Woc();return vb}Fdl(){const vb=new ob.a;vb.setValue(y.a.EL,X.a.first);return vb}Bhf(vb,Eb,Ua=!1){aa.OutlineElementReader.$Hf(vb)?(vb=aa.OutlineElementReader.isRtl(vb),Ua?this.CQb(Eb,vb):this.BQb(Eb,vb)):this.o1n(Eb)}Elc(vb,Eb){const Ua=O.OutlineElementNavigator.Fl(vb);aa.OutlineElementReader.Pn(Ua)!==Eb&&(this.BQb(Ua,Eb),vb.anchor.yY(4))}BQb(vb,Eb){const Ua=new Xa.GraphTransaction(7);Ua.Db(vb);this.CQb(vb,Eb);const Ta=new K.GraphIterator;Ta.set(vb);Ca.a.instance.MGm(Ta);
if(Ta.zb(10)){const Nb=Ta.jd(10);Ta.Tb(1)===vb&&this.CL.BQb(Nb,Eb)}Ua.dispose()}CQb(vb,Eb){let Ua=null,Ta=null;if(E.a.instance.J(1)&&vb.isConnected){Ua=Ia.ParagraphReader.yw(vb,!0,!0);Ta=new I.a;for(let Nb=0;Nb<Ua.count;Nb++)12===Ua.J(Nb).type&&Ta.add(Ua.J(Nb).aE())}vb.properties.setValue(y.a.m1,Eb);if(E.a.instance.J(1)&&Ua&&Ta)if(Ua.count!==Ta.count)t.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Ua.count,Ta.count);else for(vb=0;vb<Ua.count;vb++)this.Ej.GV(Ua.J(vb),
Ta.J(vb),this.Qd.yg)}o1n(vb){vb.properties.removeProperty(y.a.m1)}OH(vb,Eb=null,Ua=!1){var Ta,Nb=null;let Wa=null;if(!aa.OutlineElementReader.yh(vb))return t.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let Bb=null,Ob=null,hc=0;Eb&&(Bb=Eb.formatting,Ob=Eb.Rka,hc=Eb.languageId);Ua||({vqa:Nb,USa:Wa}=this.R4h(vb,Nb,Wa));Eb=H.a.instance.createInstance(393230);Eb.setValue(y.a.ho,"");vb.Bf(Eb,2);vb.Bj(Eb);lc.Sk.cPb(Eb);lc.Sk.A$m(Eb);lc.Sk.TVa(Eb);this.Dqk(Eb);
e.AFrameworkApplication.VG&&!e.AFrameworkApplication.Acj&&(e.AFrameworkApplication.se("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),(null===(Ta=e.AFrameworkApplication.K)||void 0===Ta?0:Ta.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.AJk());Bb&&(Eb.ra.first.formatting.Xj=Bb);hc||(hc=e.AFrameworkApplication.lcid);vb.currentNode.Gg(y.a.p8c,vb.currentNode.ja(y.a.p8c,hc));vb.currentNode.setValue(x.a.oTa,0);Ob&&this.tE.cK(Ob,Eb,!0);!Ua&&Nb&&(Ua=new ua.a(Eb),
Nb=new ka(Nb,Wa,Nb,Ua,Eb.foa),vb.currentNode.zJ().rF.JH(Nb));return Eb}AJk(){if(this.nV){for(var vb,Eb=this.nV.gPd();Eb;){const Ua=Eb.node;if(0<Ia.ParagraphReader.textLength(Ua,9)&&(vb=zb.AParagraphNode.vYl(Ua.characterData.trim()),0<vb.length))break;Eb=Eb.next}vb&&32===e.AFrameworkApplication.va.Qb(eb.a.renameFile,2,vb)&&this.Mo&&(this.Mo.execute(Ua=>{Ua.logActivity("AutoRenameDocumentCallout",null)}),k.a("AutoRenameDocumentSuccess"))}}R4h(vb,Eb,Ua){Ua=new K.GraphIterator;Ua.kd(vb);Eb=null;Ua.uFf?
Ua.currentNode.zJ().rF.f8(6):(O.OutlineElementNavigator.g1(Ua,!0,!1),Eb=this.rSd(Ua));Ua.kd(vb);Ua=this.X5h(Ua);return{vqa:Eb,USa:Ua}}X5h(vb){const Eb=new K.GraphIterator;Eb.kd(vb);vb=null;Eb.SGa||(O.OutlineElementNavigator.ns(Eb,!0,!1),vb=this.rSd(Eb));return vb}rSd(vb,Eb=!1){vb=O.OutlineElementNavigator.Ee(vb,!0);return vb?this.cai(vb,Eb):(t.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}cai(vb,Eb=!1){if(12===vb.type)return Eb?new ua.a(vb):new ea.a(vb);vb.zJ().rF.f8(5);
return new oa.a(vb)}z_k(vb,Eb){var Ua=Eb.currentNode.clone();vb.aI(Ua,null,1);vb.Bj(Ua);Ua.Oba=Eb.currentNode;O.OutlineElementNavigator.Ee(Eb);Eb.o9&1&&Eb.currentNode.yTb(null);Ua=Eb.currentNode.clone();Ua.qJa=Eb.currentNode.qJa;Ua.UL=Eb.currentNode.UL;vb.aI(Ua,null,2);vb.Bj(Ua);vb.G0(1);Ua.Oba=Eb.currentNode;Ua.setValue(x.a.Wc,a.a.FF());Eb.Ps(11)}cPb(vb){vb.Tb(2)&&vb.tg()}I4n(vb,Eb){const Ua=vb.currentNode;O.OutlineElementNavigator.Ee(vb);const Ta=vb.currentNode;O.OutlineElementNavigator.Yd(vb);
Eb.EJ(1);O.OutlineElementNavigator.Ee(Eb);vb.Bf(Eb.currentNode,2);Eb.tg();var Nb=new K.GraphIterator;Nb.kd(Eb);if(Nb.Tb(1)){const Wa=new K.GraphIterator;Wa.kd(vb);const Bb=new Y(null);if(!this.Kkm(Wa,Nb.currentNode,Bb))return;L.g(Wa,null,1,1,Nb,-1)}Eb.tg();Nb=null;vb.RM(1)&&(Nb=vb.currentNode);for(vb.sc();U.OutlineNavigator.S9(Eb);)vb.aI(Eb.currentNode,Nb,1),Nb=Eb.currentNode,Eb.tg();vb.Bj(Ua);vb.Bj(Ta);vb.tg()}S$(vb,Eb,Ua,Ta,Nb,Wa,Bb=!1,Ob=!1){var hc=aa.OutlineElementReader.yh(vb),Gc=aa.OutlineElementReader.yh(Eb),
bc=Ua.isValid&&Ua.contextId===M.a.Tc;hc&&Gc&&bc||t.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",hc,Gc,bc);var Dc=vb.currentNode;this.cPb(Eb);Gc=Eb.Xe;let Ub,Fc=null;hc=bc=null;let Sa=!1;O.OutlineElementNavigator.Ee(vb);const wb=vb.Xe;if(Ia.ParagraphReader.oh(vb)){Ub=vb.currentNode;(bc=Object(z.a)(zb.AParagraphNode,Ub))?bc.ra&&bc.ra.length||t.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
bc):t.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");bc=new ua.a(bc);(Sa=Ua.cpBegin===Ia.ParagraphReader.textLength(Ub))&&(hc=this.X5h(Eb));const Tb=Eb.currentNode;Fc=this.OH(Eb,void 0,!0);lc.Sk.YUa(vb,Eb,Ua,Nb,Wa,Bb,Ob);Ta?(Nb=this.qc.hp(Ub))&&this.tE.cK(Nb,Fc,!0):Sa&&(Nb=this.qc.hp(Ub))&&((Ob=Nb.ja(n.a.ae,null))?(Nb=this.qc.ZC(Fc).pj(Ob),this.tE.cK(Nb,Fc,!1)):this.tE.cK(Nb,Fc,!0));this.Bhf(Dc,Tb)}O.OutlineElementNavigator.Yd(vb);O.OutlineElementNavigator.Yd(Eb);O.OutlineElementNavigator.Ee(vb);
(Dc=Object(z.a)(zb.AParagraphNode,vb.currentNode))?Dc.ra&&Dc.ra.length||t.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Dc):t.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Dc=new ua.a(Dc);O.OutlineElementNavigator.Yd(vb);(vb=Fc)?vb.ra&&vb.ra.length||t.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",vb):(t.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),t.ULS.sendTraceTag(40425482,307,50,
"SplitAtIp state. {0}",{["splittingAtEnd"]:Sa,["moveText"]:Wa,["overrideParagraphStyle"]:Ta,["sourceOutlineElementContentNodeType"]:wb,["destinationOutlineElementNodeType"]:Gc,["alwaysMoveEopToDestinationPara"]:Bb}));Sa?(Ua=new ua.a(vb),Ua=new ka(bc,hc,Dc,Ua,vb.foa),Eb.currentNode.zJ().rF.JH(Ua)):(Ua=Wa?new na(bc,Ua.cpBegin,Dc,new ua.a(vb),vb.foa):new na(bc,Ua.cpBegin,new ua.a(vb),Dc,vb.foa),Eb.currentNode.zJ().rF.JH(Ua));return vb}IBh(vb,Eb){O.OutlineElementNavigator.Ee(vb);let Ua=Ia.ParagraphReader.Bt(vb.currentNode)&&
this.uTk(vb);const Ta=vb.currentNode;Ua=Eb?Ua&&!this.Xf.ZAn(Ta):Ua&&!this.Xf.PAn(Ta);O.OutlineElementNavigator.Yd(vb);return Ua}uTk(vb){return Ia.ParagraphReader.oh(vb)&&!Ia.ParagraphReader.Bgb(vb.currentNode)}merge(vb,Eb,Ua,Ta,Nb=null,Wa=!1,Bb,Ob=!1,hc=!1,Gc=!1){var bc;if(vb.currentNode.id===Eb.currentNode.id)return!1;let Dc;const Ub=new K.GraphIterator;Ub.kd(Eb);Bb=this.rSd(Ub);Ub.kd(vb);Dc=this.rSd(Ub,!0);if(!this.IBh(Eb,!0)||!this.IBh(vb,!1))return!1;if(this.Xf.jh){O.OutlineElementNavigator.Ee(vb);
O.OutlineElementNavigator.Ee(Eb);var Fc=Ia.ParagraphReader.oh(vb)?vb.currentNode:null,Sa=Ia.ParagraphReader.oh(Eb)?Eb.currentNode:null;O.OutlineElementNavigator.Yd(vb);O.OutlineElementNavigator.Yd(Eb);if(Fc&&Sa&&!this.Xf.JBh(Fc,Sa,!1)){if(!this.OD||!this.Xf.JBh(Fc,Sa,!0))return!1;this.OD&&(this.OD.NDj(Fc,!1),this.OD.NDj(Sa,!0))}}Fc=Object(z.a)(zb.AParagraphNode,vb.currentNode);Fc=(Ua||!Fc||!Fc.characterData.length)&&!sb.ListItemReader.lg(vb);Ob||this.Zm.merge(vb,Eb,Fc,Nb);O.OutlineElementNavigator.Ee(vb);
Nb=vb.currentNode.foa;O.OutlineElementNavigator.Ee(Eb);if(Ia.ParagraphReader.oh(Eb)){Ob=Eb.currentNode;if(null===(bc=ta.App.zd)||void 0===bc?0:bc.Uo)if(bc=vb.currentNode,Fc=fa.CoauthLockEditor.getInstance(),Fc.p8a(this.Xf.E9b(Ob))||Fc.p8a(this.Xf.E9b(bc)))return Eb.sc(),vb.sc(),!1;bc=!1;(Ob=vb.parentNode)&&aa.OutlineElementReader.Gpa(Ob)&&(bc=sb.ListItemReader.lg(Ob));(Ob=this.dso(Ia.ParagraphReader.isEmpty(vb),bc,Ua,Ta,hc))&&(Fc=this.qc.qvf(Eb))&&this.tE.cK(Fc,vb.currentNode,!0);Ua&&(Fc=Eb.currentNode,
Sa=vb.currentNode,(Ob||bc)&&Ya.b(Fc,Sa),hc&&Ta||this.h7.lPi(Fc,Sa,bc),e.AFrameworkApplication.eo("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),Gc&&(hc=this.w8k(Sa,Fc),t.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",hc)));Ua=lc.Sk.merge(vb,Eb,Ua,Ta,Wa);Wa=Ub.currentNode;Ta=vb.currentNode;vb.sc();Ua&&aa.OutlineElementReader.isEmpty(Eb,!0)&&this.A1a(Eb);vb=new ia(Dc,Bb,new ea.a(Wa),Nb);Ta.zJ().rF.JH(vb);return!0}Eb.sc();vb.sc();return!1}w8k(vb,Eb){let Ua=null;
Eb&&Eb.ra&&0<Eb.ra.length&&Eb.ra.first.Ph&&(Ua=Eb.ra.first.formatting);return Ua&&vb&&vb.ra&&0<vb.ra.length&&S.FormattingReader.P5k(vb.ra)?(vb.ra.last.formatting=Ua.wf(vb.ra.last),!0):!1}dso(vb,Eb,Ua,Ta,Nb){return Eb?!1:Ua?!(Ta&&Nb):vb}SEm(vb){const Eb=new K.GraphIterator;Eb.set(vb.node);Eb.od();O.OutlineElementNavigator.Yd(Eb);const Ua=this.ppa(Eb),Ta=this.ppa(Eb);this.S$(Eb,Ua,vb,!1,!0,!0);aa.OutlineElementReader.isEmpty(Eb,!1)&&(this.Zm.$da(Eb),Eb.tg());aa.OutlineElementReader.isEmpty(Ua,!1)&&
!aa.OutlineElementReader.zlb(Ua)&&(this.Zm.$da(Ua),Ua.tg());return Ta}Oy(vb,Eb,Ua,Ta=null,Nb=!1,Wa=!0){if(!this.qTk(vb))return null;const Bb=vb.currentNode;var Ob=!1;Wa&&(Ob=sb.ListItemReader.lg(vb),Nb=Eb||Nb||!aa.OutlineElementReader.isEmpty(vb,!1),Ob=this.Zm.Fvo(Ob,Nb));Nb=Eb?vb.RM(1):vb.currentNode;vb.sc();Ua=this.CL.Pkb(vb,Nb,Ua,Ta);if(!Ua)return null;this.Bhf(Bb,Ua);Wa&&Ob&&this.Zm.bOo(vb,Eb,Bb,Ua);return Ua}qTk(vb){return aa.OutlineElementReader.yh(vb)&&(vb=vb.parentNode,T.OutlineReader.y0d(vb)||
aa.OutlineElementReader.Gpa(vb)||aa.OutlineElementReader.NRa(vb))?!0:!1}mza(vb){const Eb=new K.GraphIterator;Eb.set(vb);Eb.od();Eb.Ps(11);let Ua=null,Ta=null;({vqa:Ua,USa:Ta}=this.R4h(Eb,Ua,Ta));let Nb=-1;12===vb.type&&(Nb=vb.foa);Eb.currentNode?(Eb.currentNode.zJ().rF.JH(new Aa(this.cai(vb,!0),Ua,Ta,Nb)),this.A1a(Eb)):t.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}A1a(vb){if(vb.Jt(1)){const Eb=new sa,Ua=new K.GraphIterator;Ua.kd(vb);this.uPl(Ua,Eb)&&
this.qq.TLc(vb,-Eb.U6b)}vb.tg();xb.TableReader.mx(vb)&&this.XFn(vb)}NCf(vb,Eb,Ua){if(!T.OutlineReader.nx(vb)&&!aa.OutlineElementReader.yh(vb))return null;const Ta=this.Fdl();0<Ua&&Ua<X.a.last&&Ta.setValue(y.a.EL,Math.min(X.a.nil,Ua));vb.aI(Ta,Eb,1);return Ta}UEm(vb,Eb){if(!aa.OutlineElementReader.yh(vb)&&!aa.OutlineElementReader.tL(vb)||!T.OutlineReader.Qxa(vb.parentNode)&&!aa.OutlineElementReader.Gpa(vb.parentNode))return null;const Ua=vb.currentNode;let Ta;Ta=vb.currentNode;vb.sc();Eb=this.NCf(vb,
Ta,Eb);vb.Bj(Ua);return Eb}XFn(vb){aa.OutlineElementReader.tL(vb)&&(vb.Jt(1)||vb.tg());this.A1h(vb,!1);this.Ash(vb)}A1h(vb,Eb){var Ua,Ta=null;for(Ua=vb.Tb(1);Ua;){var Nb=!1;aa.OutlineElementReader.NRa(Ua)&&!vb.Jt(1)&&(Nb=!0);var Wa=Ua;Ua=vb.Ri(1);if(Nb)Nb=new K.GraphIterator,Nb.set(Wa),Nb.od(),Nb.tg();else if(aa.OutlineElementReader.NRa(Wa)){if(Ta){Nb=new K.GraphIterator;Nb.set(Ta);var Bb=new K.GraphIterator;Bb.set(Wa);Bb.od();Nb.Bf(Bb.currentNode,1);Bb.tg();Bb=aa.OutlineElementReader.Iha(Wa);Bb===
X.a.nil&&(Bb=1);const Ob=aa.OutlineElementReader.Iha(Wa);(Bb=Math.max(0,Ob-Bb))?Wa.setValue(y.a.EL,Math.min(X.a.nil,Bb)):(Nb.Bj(Wa),vb.Tb(1),L.e(Nb),Nb.sc());Eb&&this.A1h(Nb,!0)}}else Ta=Wa}Eb=null;Ta=X.a.last+1;for(Ua=vb.Tb(1);Ua;Ua=vb.Ri(1))if(aa.OutlineElementReader.tL(vb))Wa=aa.OutlineElementReader.Iha(Ua),Ta>Wa&&(Ta=Wa,Eb=Ua);else{vb.sc();return}if(Eb){for(Ua=vb.Tb(1);Ua;Ua=vb.Ri(1))Ua!==Eb&&(Ua=aa.OutlineElementReader.Iha(Ua),vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,Ua-Ta)));Ta+=aa.OutlineElementReader.Iha(vb.currentNode);
vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,Ta));Ua=new K.GraphIterator;Ua.kd(vb);Ua.Bj(Eb);Ua.Tb(1);L.e(Ua)}}Kkm(vb,Eb,Ua){var Ta=aa.OutlineElementReader.Iha(vb.currentNode);if(1===Ta)return!0;if(aa.OutlineElementReader.tL(vb))return!1;if(!vb.ajb(1)||this.$Rm(vb,Eb))return vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,1)),!0;if(Ua.uqa&&vb.Bj(Ua.uqa)){if(aa.OutlineElementReader.tL(vb)&&1===Ta+aa.OutlineElementReader.Iha(vb.currentNode))return Ua.uqa=vb.EJ(1),vb.sc(),!0;vb.sc()}if(Ua.uqa&&vb.Bj(Ua.uqa)||
!Ua.uqa&&vb.Tb(1)){if(vb.currentNode!==Eb&&vb.Lf(1)&&aa.OutlineElementReader.tL(vb)&&1===Ta+aa.OutlineElementReader.Iha(vb.currentNode))return Ua.uqa=null,!0;vb.sc()}if(vb.ckb(Eb)&&this.ZRm(vb,Eb)){for(Ua=vb.Tb(1);Ua;Ua=vb.Ri(1))if(Ua!==Eb){var Nb=aa.OutlineElementReader.Iha(Ua);Ua.setValue(y.a.EL,Math.min(X.a.nil,Nb+(Ta-1)))}vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,1));return!0}if(1>Ta)return Ta=this.NCf(vb,Ua.uqa,1-Ta),vb.Bj(Ta),Ua.uqa=null,!0;if(1<Ta){vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,
1));Eb=null;for(Nb=vb.Tb(1);Nb;){if(aa.OutlineElementReader.tL(vb)){Nb.setValue(y.a.EL,Math.min(X.a.nil,Ta-1+aa.OutlineElementReader.Iha(Nb)));Nb=vb.Ri(1);continue}Eb||(Eb=this.UEm(vb,Ta-1));const Wa=Nb;Nb=L.i(vb,Eb,1);Nb===Eb&&(Nb=vb.Ri(1));Ua.uqa===Wa&&(Ua.uqa=Eb,Eb=null)}return!0}return!1}$Rm(vb,Eb){return K.GraphIterator.kca(()=>{if(1===vb.ajb(1)){const Ua=vb.Tb(1);vb.sc();if(Ua===Eb)return!0}return!1})}ZRm(vb,Eb){return K.GraphIterator.kca(()=>{let Ua;for(Ua=vb.Tb(1);Ua;Ua=vb.Ri(1))if(Ua!==Eb&&
!aa.OutlineElementReader.tL(vb))return vb.sc(),!1;return!0})}uPl(vb,Eb){Eb.U6b=0;do{const Ua=vb.currentNode;if(vb.Tb(1))Eb.U6b-=aa.OutlineElementReader.Iha(Ua);else{if(T.OutlineReader.nx(vb)||null===vb.currentNode)return!1;if(3!==vb.role||!vb.dia(1))for(;!vb.Ri(1);)if(Eb.U6b+=aa.OutlineElementReader.Iha(vb.currentNode),T.OutlineReader.nx(vb)||null===vb.currentNode)return!1}}while(aa.OutlineElementReader.tL(vb));return!0}ppa(vb,Eb=!1){return this.rYd(vb,!1,Eb)}REm(vb){return this.rYd(vb,!0,!1)}rYd(vb,
Eb,Ua=!1){const Ta=new K.GraphIterator;Ta.kd(vb);vb=new K.GraphIterator;vb.kd(Ta);this.Oy(vb,Eb,!1,null,Ua);vb.currentNode.setValue(y.a.EL,Math.min(X.a.nil,aa.OutlineElementReader.Iha(Ta.currentNode)));Ta.Tb(1)&&L.g(vb,null,1,1,Ta,-1);return vb}Ash(vb){if(aa.OutlineElementReader.t6n(vb)){1!==aa.OutlineElementReader.Iha(vb.currentNode)&&vb.currentNode.setValue(y.a.EL,X.a.first);for(var Eb=vb.Tb(1);Eb;)if(aa.OutlineElementReader.tL(vb)){Eb=new K.GraphIterator;Eb.kd(vb);Eb.sc();const Ua=new K.GraphIterator;
Ua.kd(vb);Ua.Tb(1);L.g(Eb,vb.currentNode,1,1,Ua,-1);Eb=vb.rhb(1)}else this.Ash(vb),Eb=vb.Ri(1)}}static get Lk(){return null!=lc.jIg?lc.jIg:lc.jIg=l.a.instance.resolve("Box4.ITableEditor")}static get Sk(){return lc.Xs||(lc.Xs=l.a.instance.resolve("Box4.IParagraphEditor"))}static set Sk(vb){lc.Xs=vb}}lc.Xs=null;Object(D.a)(lc,"OutlineElementEditor",null,[381])},1991:function(D,J,c){D=c(0);var l=c(139),e=c(46),a=c(22),k=c(2),x=c(61),y=c(648),n=c(93),t=c(86),z=c(400),v=c(358),I=c(19),E=c(359),H=c(56),
M=c(182),K=c(43),L=c(35),S=c(12),Q=c(1604),N=c(1713),O=c(118),X=c(6),U=c(16),T=c(175),Y=c(7),aa=c(459),ba=c(691),oa=c(578),ma=c(1035),ea=c(123),ua=c(18),sa=c(253),Fa=c(255),Pa=c(28),Na=c(36);class Aa{constructor(eb){this.kz=null;this.j7g=!1;this.As=null;this.mM=new Q.a;this.PEe=new Q.a;this.zc=eb}get Anb(){Na.a(4281429,307,this.mM.count===this.PEe.count);return this.mM.count}get O4d(){return this.j7g}set O4d(eb){this.j7g=eb}N3b(eb){this.kz=eb}get MX(){return null}Ish(eb,sb){this.mM.add(eb);this.PEe.add(sb)}}
Aa.Wmb=2712;Object(D.a)(Aa,"APicturePasteHandler",null,[546]);var za=c(258),xa=c(3),ka=c(15),wa=c(1169),ia;(function(eb){eb[eb.unknown=0]="unknown";eb[eb.other=1]="other";eb[eb.file=2]="file";eb[eb.blob=3]="blob";eb[eb.Jgp=4]="chromeExtension";eb[eb.cid=5]="cid"})(ia||(ia={}));Object(D.b)("UnsupportedUrlScheme",ia);var va=c(263),na=c(44),Ca=c(8),ta=c(1872),fa=c(1873),Xa=c(1801);class ob{constructor(){this.delay=this.retry=0}}Object(D.a)(ob,"ForceInboundData",null,[]);class xb{constructor(eb,sb,lc,
vb){this.sWd=!1;this.request=eb;this.k6n=sb;this.url=vb;this.fFm=lc}}Object(D.a)(xb,"PicturePasteRequestInfo",null,[]);var zb=c(397),Lb=c(25);c.d(J,"a",function(){return Ya});const Ia=["ImageInsertFailed"];class Ya extends Aa{constructor(eb,sb,lc,vb,Eb,Ua=null,Ta=null,Nb=!1,Wa=null,Bb=null){super(eb);this.Zl=l.a.nil;this.mB=new Q.a;this.PMa=0;this.xyc=this.seh=null;this.Cch=!1;this.xBc=null;this.wmd=new Q.a;this.Xo=null;this.sHn=()=>{var Ob=this.pPl(),hc=131073;this.m$j&&(hc=1073872970);Ob=e.a.Oo(Ob,
aa.a.cellId,this.As.Fm.toString());Ob=e.a.Oo(Ob,aa.a.MX,this.Zl.toString());Ob=e.a.Oo(Ob,aa.a.classId,hc.toString());this.As.VH&&(Ob=e.a.Oo(Ob,aa.a.VH,this.As.VH));Ob=e.a.Oo(Ob,aa.a.rsb,"1");Ob=e.a.Oo(Ob,ba.a.imageType,"1");Ob=za.a.instance.$_e(Ob);let Gc=0;hc=Ob;var bc=new Q.a;const Dc=new Q.a,Ub=new Q.a,Fc=new Q.a,Sa=new Q.a,wb=new Q.a;var Tb="",Hb=a.a.instance.Oa("Box4.IFeatureHelper");Hb=!!Hb&&Hb.isFeatureEnabled(10)&&Hb.isFeatureEnabled(51);for(let rc=0;rc<this.Anb;rc++){var $a=this.PEe.J(rc);
Y.ULS.shipAssertTag(7869452,307,!!$a.src);Y.ULS.shipAssertTag(7869453,307,""!==$a.src);Y.ULS.shipAssertTag(7869454,307,19922944>$a.src.length);const Rb=this.mM.J(rc);var ab=Rb.node.ja(O.a.RJ,va.a.Qt);this.QXo(Rb.blob,$a);var rb=$a.alt;var cb=$a.kml;cb||(cb=rb,rb="");const fb=Rb.blob;ab=ta.a.construct(fb?fb.id.toString():Rb.node.id.toString(),$a.src,rb,$a.width,$a.height,cb,ab,Rb.JU,!!fb&&fb.properties.ja(X.a.wia,!1),fb?fb.properties.ja(O.a.kha,-1):-1,fb?fb.properties.ja(X.a.Nmb,Box4Intl.Box4Strings.l_Picture):
"",Rb.node.properties.ja(U.a.Oxa,!1),null,null,null,$a.TGd);$a.src.startsWith("data:")?(cb=!1,Hb&&$a.TGd?(cb=!0,$a=Sa,rb=wb):($a=Ub,rb=Fc),$a.add(ab),rb.add(Rb),cb=fa.a.construct($a.toArray(),!cb,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null,cb),cb=L.c(cb),cb.length>Ya.tcn?(Y.ULS.shipAssertTag(7869456,307,1<$a.count),$a.remove(ab),rb.remove(Rb),cb=this.mB.count?(new x.a(this.Zl,Gc)).toString():this.As.contentReplicator.Su.toString(),hc=e.a.Oo(hc,aa.a.$ua,
cb),hc=e.a.Oo(hc,aa.a.hic,Gc.toString()),ua.ImageReader.wBf&&(hc=e.a.Oo(hc,aa.a.sTb,"1")),this.mB.add(new xb(fa.a.construct($a.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null),Tb,rb,hc)),Gc+=Ub.count,$a=new Q.a,$a.add(ab),rb=new Q.a,rb.add(Rb)):Tb=cb):(bc.add(ab),Dc.add(Rb))}Ub.count&&(hc=Ob,cb=this.mB.count?(new x.a(this.Zl,Gc)).toString():this.As.contentReplicator.Su.toString(),hc=e.a.Oo(hc,aa.a.$ua,cb),hc=e.a.Oo(hc,aa.a.hic,Gc.toString()),
ua.ImageReader.wBf&&(hc=e.a.Oo(hc,aa.a.sTb,"1")),Tb=fa.a.construct(Ub.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null),this.mB.add(new xb(Tb,L.c(Tb),Fc,hc)),Gc+=Ub.count,this.wmd.add(Ya.Omf));bc.count&&(hc=Ob,cb=this.mB.count?(new x.a(this.Zl,Gc)).toString():this.As.contentReplicator.Su.toString(),hc=e.a.Oo(hc,aa.a.$ua,cb),hc=e.a.Oo(hc,aa.a.hic,Gc.toString()),hc=e.a.Oo(hc,aa.a.sTb,"1"),bc=fa.a.construct(bc.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.As.yr:null),this.mB.add(new xb(bc,L.c(bc),Dc,hc)),k.AFrameworkApplication.Ria("WoInc325;WoInc325cf"),this.wmd.add(this.KWg));Sa.count&&(hc=Ob,cb=this.mB.count?(new x.a(this.Zl,Gc)).toString():this.As.contentReplicator.Su.toString(),hc=e.a.Oo(hc,aa.a.$ua,cb),hc=e.a.Oo(hc,aa.a.hic,Gc.toString()),hc=e.a.Oo(hc,aa.a.sTb,"1"),Ob=fa.a.construct(Sa.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.yr:null,!0),this.mB.add(new xb(Ob,L.c(Ob),wb,hc)),this.wmd.add(this.KWg));
Y.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.mB?this.mB.count:-1)+" picture paste requests to send");this.Spb()};this.picturePasteRequestSucceeded=Ob=>{var hc;Y.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.H0l(Ob));if(({group:Gc}=oa.a.d2(Ob.data.te)).returnValue){var Gc=Gc.Responses[0];if(Gc.StatusCode)if(46!==Gc.StatusCode||this.mB.J(this.PMa).sWd){Y.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+
Gc.StatusCode);Ob=Object.assign(new ea.a,{extendedProperties:new Map});Ob.extendedProperties.set("statuscode",Gc.StatusCode.toString());if(null===(hc=k.AFrameworkApplication.K)||void 0===hc?0:hc.$("ShouldLogPicturesExtendedHealthKpis")){var bc={name:zb.c.sbc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Ob};Ob.extendedProperties.set("ErrorLevel","warning");this.rg.logKpiFailure({kpiName:zb.c.fGa,errorName:"PictureRemotePasteFailed",
optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Ob},optionalVeto:bc})}else t.Health.instance.recordQosError("PictureRemotePasteFailed",Ia,!1,!0,!1,!1,Ob);this.rpm()}else this.mB.J(this.PMa).sWd=!0,this.Spb();else{Gc=hc="";Ob&&Ob.data&&Ob.data.jj&&(ba.a.hI in Ob.data.jj&&Ob.data.jj[ba.a.hI]&&(Gc=Ob.data.jj[ba.a.hI]),"X-CorrelationId"in Ob.data.jj&&Ob.data.jj["X-CorrelationId"]&&(hc=Ob.data.jj["X-CorrelationId"]));Y.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",
Gc,hc);(null===(bc=k.AFrameworkApplication.K)||void 0===bc?0:bc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiSuccess({kpiName:zb.c.fGa});this.xBc&&(this.xBc.stop(),this.xBc=null);this.PMa++;this.LEj&&this.Spb();this.seh=this.As.contentReplicator.Su;let Dc=null;Dc=Object.assign(new ob,{retry:0,delay:this.wmd.J(this.PMa-1)});Ob=new n.a(2,1,Ya.Omf,()=>{this.As.contentReplicator.l2f(this.R2h,Dc)},124);this.Ib.Wb(Ob)}}else Y.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),
Ob=new y.a(Ob.data),this.qic(Ob)};this.R2h=Ob=>{const hc=!x.a.Cq(this.seh,this.As.contentReplicator.Su);Y.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",hc);if(hc)this.ABh();else{const Gc=Ob?Ob:null;if(Ob&&Gc&&Gc.retry<Ya.gJl){Gc.retry+=1;Ob=new n.a(2,1,Gc.delay,()=>{this.As.contentReplicator.l2f(this.R2h,Gc)},125);this.Ib.Wb(Ob);return}Ob=Ya.Omf;null!=Gc&&(Ob=Gc.delay);Ob=new n.a(2,1,Ob,()=>{this.As.contentReplicator.l2f(null,null)},125);this.Ib.Wb(Ob);this.BBh()}Ya.SUf--;
k.AFrameworkApplication.va.processAction(S.a.D9a,2);Xa.a.instance.epc(this.As,0);this.Xvg();this.Hv.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.qic=Ob=>{var hc,Gc="",bc="";Ob&&Ob.data&&Ob.data.jj&&("X-CorrelationId"in Ob.data.jj&&Ob.data.jj["X-CorrelationId"]&&(Gc=Ob.data.jj["X-CorrelationId"]),ba.a.hI in Ob.data.jj&&Ob.data.jj[ba.a.hI]&&(bc=Ob.data.jj[ba.a.hI]));bc=""===bc?"":String.format("[Operation Result: {0}]",bc);Gc=""===Gc?"":String.format("[X-CorrelationID: {0}]",Gc);
Y.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",bc,Gc,Ob.data.Ne,z.SessionStatusManager.instance.bD);9===Ob.data.status||this.mB.J(this.PMa).sWd?(Xa.a.instance.epc(this.As,127),this.hDh(),this.xBc=null,(null===(hc=k.AFrameworkApplication.K)||void 0===hc?0:hc.$("ShouldLogPicturesExtendedHealthKpis"))?(Ob=Object.assign(new ea.a,{extendedProperties:new Map([["HttpStatus",String(Ob.data.Ne)],["ConnectionState",String(z.SessionStatusManager.instance.bD)],
["OperationResult",bc],["CorrelationId",Gc],["ErrorLevel","warning"]])}),this.rg.logKpiFailure({kpiName:zb.c.fGa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Ob},optionalVeto:{name:zb.c.sbc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):t.Health.instance.recordQosError("PictureRemotePasteFailed",Ia,!1,!0,!1,!1,null)):(this.mB.J(this.PMa).sWd=!0,this.Spb())};this.rg=
v.a.getInstance(zb.a);this.Vj=sb;this.Ib=lc;this.Pm=vb;this.je=Lb.StaticActiveAppFrame.za().Kq;this.QEe=Ua;this.z7=Ta;this.Pak=Nb;this._operationId=Wa;this.Fik=Bb;this.KWg=k.AFrameworkApplication.K.nc("PicturePasteHttpForceInboundDelay",3E3);this.Cch=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;ka.App.Mnc.addHandler(this);this.m$j=!!Eb&&Eb.isFeatureEnabled(122)}get Hv(){return this.Xo||(this.Xo=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get oic(){return ka.App.oic}get tOi(){return this.Anb===
ka.App.zPf}get LEj(){return this.PMa!==this.mB.count}Xvg(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const eb=a.a.instance.Sa("Common.ISystemInitiatedFeedback");eb&&eb.execute(sb=>{sb.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get MX(){return this.Zl}zya(eb){var sb;eb.alt.length>Aa.Wmb&&(eb.alt=eb.alt.substring(0,I.a.Lz(eb.alt,Aa.Wmb)?Aa.Wmb-1:Aa.Wmb));this.rg.logKpiUsage({kpiName:zb.c.fGa,
kpiType:0});if(this.z7&&Ya.ePm(eb)){this.Pak&&K.c(xa.a.CBl);var lc="unknown";this.Cch&&(eb=new URL(eb.src),lc=ia[wa.a.lUo(eb.protocol)]);Y.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,lc,this.Fik);eb=Object.assign(new ea.a,{extendedProperties:new Map});eb.extendedProperties.set("protocol",lc);(null===(sb=k.AFrameworkApplication.K)||void 0===sb?0:sb.$("ShouldLogPicturesExtendedHealthKpis"))?(sb={name:zb.c.sbc,
errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:eb},eb.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:zb.c.fGa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:eb},optionalVeto:sb})):t.Health.instance.recordQosError("PictureRemoteWithLocalPath",Ia,!0,!0,!1,!1,eb);this.Vyo()}else sb=new E.DictionaryPropertySet,eb=this.Vhj(eb),null!==eb.TGd&&eb.TGd.type===
N.b.Chart&&sb.setValue(X.a.Ns,7),this.Vj.Kae(sb,eb.width,eb.height,!0),Y.ULS.shipAssertTag(7869444,307,Ca.ParagraphReader.Xb(this.zc.currentNode)),this.xBc=this.je.Yf("WebServiceCall",Ya.VDn),Y.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",eb.width,eb.height)),lc=Pa.a.tw(this.zc.currentNode),sb=this.Vj.uYd(lc,sb),this.Ish(sb,eb)}pYf(){0<this.Anb&&(this.Zl=l.a.create(),this.As=this.mM.J(0).node.Zi(),Y.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",
this.Anb),this.O4d&&(Y.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.ayo()),Xa.a.instance.Vqg(this.As),this.Xvg(),this.As.contentReplicator.forceOutbound(this.sHn,null,null))}nhe(eb){if(0<this.Anb){const lc=eb.ja(X.a.wia,!1),vb=eb.ja(T.a.aZc,!1),Eb=eb.ja(T.a.R4,!1);eb=eb.ja(O.a.kha,-1);for(let Ua=0;Ua<this.mM.count;Ua++){var sb=this.mM.J(Ua).blob;sb&&(sb=sb.properties,sb.setValue(X.a.wia,lc),sb.setValue(T.a.aZc,vb),sb.setValue(T.a.R4,Eb),sb.setValue(O.a.kha,eb),this.Vj.Abg(sb,
eb))}}}s6a(){}Vhj(eb){var sb=sa.WordSectionNavigator.instance.zL(this.zc.Gn);if(!sb)return eb;var lc=H.a.Oi(Ya.Uf.IB(sb)-Ya.Uf.Owa(sb)-Ya.Uf.Noa(sb),1);sb=H.a.Oi(Ya.Uf.ru(sb)-Ya.Uf.CJ(sb)-Ya.Uf.oL(sb),0);Y.ULS.shipAssertTag(7869449,307,0<=lc);Y.ULS.shipAssertTag(7869450,307,0<=sb);if(eb.height>lc){const vb=lc/eb.height;eb.height=lc;eb.width=Math.floor(eb.width*vb)}eb.width>sb&&(lc=sb/eb.width,eb.width=sb,eb.height=Math.floor(eb.height*lc));return eb}Vyo(){const eb=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;
if(!this.xyc||this.xyc.message!==eb&&!this.xyc.Opa)this.xyc=this.z7.Eva(eb,!1),this.z7.sA(this.xyc)}pPl(){if(this.QEe&&this.QEe.xmp())return this.QEe.Hkp();var eb=new Sys.Net.WebRequest;eb.set_url("PicturePaste.ashx");eb=eb.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(eb=e.a.Oo(eb,aa.a.fileId,this.As.yr));return eb}QXo(eb,sb){if(eb&&sb){const lc=H.a.nf(ua.ImageReader.WC(eb.properties),0);eb=H.a.nf(ua.ImageReader.YH(eb.properties),1);0<lc&&lc<sb.width&&
(sb.width=lc,sb.height=eb)}}Spb(){const eb={},sb=l.a.create().toString();eb[Ya.correlationID]=sb;k.AFrameworkApplication.He.nj(this.mB.J(this.PMa).url,2,this.mB.J(this.PMa).k6n,eb,!1,2,this.picturePasteRequestSucceeded,this.qic,null,void 0,void 0,void 0,void 0,"26");Ya.SUf++;Y.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",sb)}H0l(eb){return eb&&eb.data?eb.data.Ne:-1}rpm(){Xa.a.instance.epc(this.As,127);this.hDh()}hDh(){Y.ULS.shipAssertTag(7869458,
307,this.LEj);const eb=new na.GraphTransaction(15);eb.Db(this.mM.J(0).node);for(let sb=this.PMa;sb<this.mB.count;sb++){const lc=this.mB.J(sb).fFm;for(let vb=0;vb<lc.count;vb++){const Eb=lc.J(vb).blob.properties;this.Vj.CUa(Eb,Box4Intl.Box4Strings.l_PastedImageFailed);ua.ImageReader.wmj(Eb,ma.a.failed)}}eb.dispose();this.Pm.W4b(this.As,!1);this.zBh()}ayo(){const eb=new M.StandardDialog;eb.Cd=0;eb.wx(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,
ka.App.zPf),null,!0);k.AFrameworkApplication.va.processAction(xa.a.R1i,2)}Aqn(eb,sb){eb.alt.length>Aa.Wmb&&(eb.alt=eb.alt.substring(0,I.a.Lz(eb.alt,Aa.Wmb)?Aa.Wmb-1:Aa.Wmb));const lc=new E.DictionaryPropertySet;this.Vj.Kae(lc,eb.width,eb.height);sb=this.Vj.uYd(sb,lc);eb=this.Vhj(eb);this.Ish(sb,eb)}zBh(){}ABh(){}BBh(){}KWd(){return!!Ya.SUf}static get Uf(){return Fa.a.instance}static ePm(eb){return!!eb&&!!eb.src&&!wa.a.ADi(eb.src)}}Ya.Omf=1E3;Ya.gJl=4;Ya.VDn="PicturePasteRequestTime";Ya.correlationID=
"X-CorrelationId";Ya.SUf=0;Ya.tcn=20971520;Object(D.a)(Ya,"Box4ImageSteward",Aa,[547])},1993:function(D,J,c){D=c(0);var l=c(55),e=c(90),a=c(10),k=c(30);class x extends Sys.UI.Control{constructor(H,M,K,L){super(document.createElement("div"));this.NZ=this.gla=this.$L=this.dw=this.f3=this.J$a=this.Ycb=null;this.owc=this.Fbb=!1;this.content=this._title=null;this.Tka=0;this.pxh=null;this.Ega=0;this.QYi=null;this.fjh=H;this.c_b=M;this.sk=K;this.aGh=L;this.kj=M.ownerDocument;this.JWd=this.Kt=this.jT=!1}get d$(){this.Ycb||
(this.Ycb=this.kj.createElement("div"),this.Ycb.id=this.rj("WACCalloutOuter"),this.Ycb.className="WACCalloutOuter",this.Ycb.setAttribute(k.a.uh,k.a.Vvh),this.Ycb.style.width=this.Tka+"px");return this.Ycb}get uHc(){if(!this.J$a){this.J$a=this.kj.createElement("div");this.J$a.id=this.rj("WACCalloutBeakContainer");this.J$a.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.Ega||6===this.Ega||4===this.Ega)H="CalloutBeakBottomFilled_32x16x32";H=e.createClusteredImage(32,
16,H,"WACCalloutBeak",!0,"");this.J$a.appendChild(H)}return this.J$a}set uHc(H){this.J$a=H}get cI(){return this.jT}get title(){return this._title}set title(H){this._title!==H&&(this._title=H,this.gla&&(this.gla.innerText=this._title))}get Kt(){return this.Fbb}set Kt(H){this.Fbb!==H&&(this.Fbb=H,this.f3&&(this.f3.contains(this.$L)&&!this.Fbb?this.f3.removeChild(this.$L):!this.f3.contains(this.$L)&&this.Fbb&&this.Goh()))}get JWd(){return this.owc}set JWd(H){this.owc!==H&&(this.owc=H,this.f3&&(this.f3.contains(this.gla)&&
!this.owc?this.f3.removeChild(this.gla):!this.f3.contains(this.gla)&&this.owc&&this.rqh()))}show(){this.jT||(this.zal(),this.eJ(),this.c_b.appendChild(this.d$),this.d$.style.display="Block",this.zoo(),this.jT=!0,this.QYi&&this.QYi())}dismiss(){this.jT&&(this.jnl(),this.c_b.removeChild(this.d$),this.jT=!1,this.aGh&&this.aGh())}dispose(){this.dismiss();this.gla=this.$L=this.dw=this.J$a=this.f3=this.Ycb=null;Sys.Component.prototype.dispose.call(this)}rj(H){return this.get_element().id+H}zal(){this.f3=
this.kj.createElement("div");this.f3.id=this.rj("WACCalloutHeader");this.f3.className="WACCalloutHeader";this.Kt&&this.Goh();this.JWd&&this.rqh();this.dw=this.kj.createElement("div");this.dw.id=this.rj("WACCalloutContent");this.dw.className="WACCalloutContent";this.dw.style.width=190<this.Tka?this.Tka-26+"px":"164px";this.dw.appendChild(this.content);this.d$.appendChild(this.uHc);this.d$.appendChild(this.f3);this.d$.appendChild(this.dw)}Goh(){this.$L=this.kj.createElement("a");this.$L.className="WACCalloutCloseAnchor";
this.$L.id=this.rj("WACCalloutCloseAnchor");this.$L.href="#";this.f3.appendChild(this.$L);const H=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.$L.appendChild(H)}rqh(){this.gla=this.kj.createElement("div");this.gla.className="WACCalloutTitle UIFontBold";this.gla.style.width=190<this.Tka?this.Tka-30+"px":"160px";this.gla.id=this.rj("WACCalloutTitle");this.gla.innerText=this.title;this.f3.contains(this.$L)?this.f3.insertBefore(this.gla,
this.$L):this.f3.appendChild(this.gla)}zoo(){var H=this.fjh;let M;if(1===this.Ega){var K=this.pxh.y+16;M=-16}else 2===this.Ega||3===this.Ega||0===this.Ega?(K=H.y+H.height+15,M=-15):(K=H.y-this.d$.clientHeight-15-2,M=this.d$.clientHeight-1);this.d$.style.top=K+"px";this.uHc.style.top=M+"px";1===this.Ega?(H=this.pxh.x-16,this.d$.style.left="50%",this.d$.style.marginLeft=-this.Tka/2+"px",K=Sys.UI.DomElement.getBounds(this.d$),this.uHc.style.left=H-K.x+"px"):(K=H.x+this.fjh.width/2,2===this.Ega||5===
this.Ega?(H=20,K-=36):0===this.Ega||4===this.Ega?(H=this.Tka/2-16,K-=this.Tka/2):(H=this.Tka-20-32,K=K-this.Tka+36),this.d$.style.left=K+"px",this.uHc.style.left=H+"px")}eJ(){this.Kt&&!this.NZ&&(this.NZ=Object(l.a)(this,this.Nga,"closeHandler"),this.sk.ob(a.a.click,this.$L,this.NZ,null))}jnl(){this.Kt&&this.NZ&&(this.sk.uc(a.a.click,this.$L,this.NZ),this.NZ=null)}Nga(){this.dismiss();return!0}}Object(D.a)(x,"Callout",Sys.UI.Control,[1210]);class y extends x{constructor(H,M,K,L,S,Q=null){super(H,K,
S.X1,Q);this.T7g=0;this.Tka=this.u5l(L);this.s1b=M;this.Yi=S;this.vLo=7;this.Sq=this.s1b.ownerDocument.createElement("div");this.Sq.className="ModalCalloutControlOverlay";this.Sq.tabIndex=0;this.s1b.insertBefore(this.Sq,this.s1b.firstChild)}show(){this.cI||(this.Yi.Jae(),this.Yi.Fga(!1),this.Sq.style.zIndex=String(this.Yi.fDa),super.show(),this.Qz(),this.T7g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.vLo))}dismiss(){this.cI&&(this.Yi.ica(!1),this.caa(),this.s1b&&this.s1b.contains(this.Sq)&&
this.s1b.removeChild(this.Sq),super.dismiss(),window.clearTimeout(this.T7g))}Qz(){this.Yi.G_(Object(l.a)(this,this.dismiss,"dismiss"));this.Yi.nD.ob(a.a.click,this.Sq,Object(l.a)(this,this.onClick,"onClick"))}caa(){this.Yi.cea(Object(l.a)(this,this.dismiss,"dismiss"));this.Yi.nD.uc(a.a.click,this.Sq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}u5l(H){let M=0;switch(H){case 0:M=190;break;case 1:M=250;break;case 2:M=300;break;case 3:M=360}return M}}Object(D.a)(y,"ModalCallout",
x,[]);var n=c(7),t=c(541),z=c(183);class v extends y{constructor(H,M,K,L,S,Q=null){super(H,M,K,L,S,Q);this.rT=null}show(){if(!this.cI){const H=Object.assign(new t.a,{onShow:()=>{y.prototype.show.call(this)}});z.UISurfaces.MM().then(M=>{const K=M.externalNotification();this.rT=M.addNotification(K,H);return null},M=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",M);return null})}}dismiss(){this.cI&&this.rT&&(z.UISurfaces.MM().then(H=>{H.removeNotification(this.rT);return this.rT=
null},H=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(D.a)(v,"ReactManagedModalCallout",y,[]);var I=c(2);c.d(J,"a",function(){return E});class E{static fNh(H,M,K,L){return I.AFrameworkApplication.ta.Kb.TRa?new v(H,M,K,L,I.AFrameworkApplication.ta,null):new y(H,M,K,L,I.AFrameworkApplication.ta,null)}}Object(D.a)(E,"ModalCalloutControlFactory",null,[])},1997:function(D,J,c){D=c(0);var l=c(56),e=c(127),a=c(19),k=c(2),x=c(85);
class y{constructor(E,H){this.value=E;this.wKl=H}get z_d(){return this.wKl}}Object(D.a)(y,"ElementValueWrapper",null,[]);class n extends y{constructor(E,H,M){super(E,H);this.rCi=M}}Object(D.a)(n,"DimensionWrapper",y,[]);var t=c(1714),z=c(1715),v=c(7);c.d(J,"a",function(){return I});class I{static get Spi(){return I.B6j}static get yle(){return I.emk}static get wle(){return I.dmk}static Jwf(E,H,...M){H=I.vki(H);let K=!1;H||(H=I.Qkm(E,...M),K=!!H);return new y(H,K)}static vki(E){for(const H of E)if(void 0!==
H&&null!==H&&""!==H)return H.trim();return null}static Qkm(E,...H){for(const M of H)if(H=E.getAttribute(M),void 0!==H&&null!==H&&(H+="",void 0!==H&&null!==H&&""!==H))return H.trim();return null}static J$l(E,H){H=parseFloat(H);if(isNaN(H))return 0;switch(E){case "px":return Math.round(H);case "pt":return Math.round(l.a.cZ(H,0,!1));case "in":return Math.round(l.a.Uca(H,0,!1));case "cm":return Math.round(l.a.Uca(e.a.bDh(H),0,!1));case "mm":return Math.round(l.a.Uca(e.a.bDh(.1*H),0,!1));default:return H}}static afe(E,
H,...M){E=I.Jwf(E,H,...M);M=0;H=!1;if(E.value){H=E.value.endsWith("%");let K;H?(M="%",K=a.a.substring(E.value,0,E.value.length-1)):E.z_d?(M="px",K=E.value):(M=E.value.substr(E.value.length-2),isNaN(parseFloat(M))?K=a.a.substring(E.value,0,E.value.length-2):(M="px",K=E.value));M=I.J$l(M,K)}return new n(M,E.z_d,H)}static Iki(E){return I.afe(E,[E.style.width],"width","WIDTH","Width")}static rai(E){return I.afe(E,[E.style.height],"height","HEIGHT","Height")}static CJ(E){return I.afe(E,[E.style.marginLeft],
"leftmargin","LEFTMARGIN","LeftMargin")}static oL(E){return I.afe(E,[E.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Wkm(E){E=I.Jwf(E,[E.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return E.value&&E.value in I.yle&&void 0!==I.yle[E.value]&&null!==I.yle[E.value]?I.yle[E.value]:0}static xWm(E){E=I.vki([E.style.borderCollapse]);return!!E&&!(void 0===E||null===E)&&("collapse"===E||"COLLAPSE"===E||"Collapse"===E)}static jPl(E){return I.Jwf(E,[E.style.backgroundColor,
E.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static U7k(E){const H=a.a.substring(E,0,1),M=a.a.substring(E,1,2);E=a.a.substring(E,2,3);return H+H+M+M+E+E}static zva(E){let H="";if(!E||""===E)return H;H=E.trim();if(H.startsWith("rgb")){H=a.a.substring(H,H.indexOf("(")+1,H.length-1);E=H.split(",");if(3!==E.length)return"";H="";for(let K=0;K<E.length;K++){var M=parseInt(E[K]);if(isNaN(M)||0>M||255<M)return"";M=M.toString(16);1===M.length&&(M="0"+M);H+=M}return a.a.ZA(H)}if(I.Spi[a.a.eh(H)])return I.Spi[a.a.eh(H)];
H.startsWith("#")&&(H=a.a.substring(H,1,H.length));if(isNaN(parseInt(H,16)))return"";3===H.length&&(H=I.U7k(H));return 6!==H.length?"":H}static OBn(E){var H=E.indexOf("mso-tab-count");if(-1===H)return 0;const M=RegExp("([\\d])");let K="";for(H=H+13+1;H<E.length;H++){const L=E.charAt(H).toString();if(M.test(L))K+=L;else break}E=0;""!==K&&(E=parseInt(K));return E}static aWd(E,H){const M=I.jPl(E);M&&""!==M&&H.mv(K=>K.F$(I.zva(M)))}static G6h(E){var H,M=E.style;if(!M)return null;let K=I.wle[M.borderTopStyle];
const L=I.zva(M.borderTopColor);let S=M.borderTopWidth,Q=I.wle[M.borderRightStyle];const N=I.zva(M.borderRightColor);let O=M.borderRightWidth,X=I.wle[M.borderBottomStyle];const U=I.zva(M.borderBottomColor);let T=M.borderBottomWidth,Y=I.wle[M.borderLeftStyle];const aa=I.zva(M.borderLeftColor);M=M.borderLeftWidth;k.AFrameworkApplication.se("gdea6103;0df65435");if(null===(H=k.AFrameworkApplication.K)||void 0===H?0:H.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))E=
E.getAttribute("border"),null!==E&&(K=this.dlc(E,K),X=this.dlc(E,X),Y=this.dlc(E,Y),Q=this.dlc(E,Q),S=this.elc(E,S),O=this.elc(E,O),T=this.elc(E,T),M=this.elc(E,M),v.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new t.a(K,Q,X,Y,L,N,U,aa,S,O,T,M)}static elc(E,H){return""===H?E+"px":H}static dlc(E,H){return 0===H?"0"===E?1:11:H}static hRl(E){var H=E.querySelectorAll("[class^=TableCellContent]");H=1===H.length?H[0]:void 0;return(E=(null===H||void 0===
H?0:H.style)?H.style:E.style)?new z.a(E.paddingTop,E.paddingRight,E.paddingBottom,E.paddingLeft):null}}I.B6j=x.a.i6("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson",
"DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray",
"696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue",
"ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3",
"mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip",
"FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8",
"tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");I.emk=x.a.i6("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);I.dmk=x.a.i6("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(D.a)(I,"DefaultHtmlTranslatorHelper",
null,[])},2E3:function(D,J,c){D=c(0);var l=c(7),e=c(55),a=c(2),k=c(216),x=c(212),y=c(93);class n{constructor(){this.P4d=22;this.jag=1E3;this.j9n=2E4;this.p9n=18E4}}Object(D.a)(n,"Config",null,[]);c.d(J,"a",function(){return t});class t{constructor(z){this._url=this.xv=null;this.AZa=this.zZa=0;this.Feb=!1;this.y3c="";this.$dh=this._body=this._headers=null;this.z7=z}send(z,v,I,E,H,M){this._url=z;this.xv=H;this.Feb=M;this._body=v;this._headers=I;this.$dh=E;this.makeRequest(null)}makeRequest(){a.AFrameworkApplication.He.nj(this._url,
1,this._body,this._headers,!0,2,Object(e.a)(this,this.TMb,"onRequestSucceeded"),Object(e.a)(this,this.Bqa,"onRequestFailed"),null,void 0,void 0,void 0,void 0,"16",void 0,void 0,void 0,this.$dh)}TMb(z){var v=t.wT;this.P7c();var I=z.data.Qja;let E=null;if(I){t.eYm(I)||(I=Sys.Net.XMLDOM(z.data.te,!0));if("undefined"===typeof I.selectSingleNode){v=z.data.te||"[null]";800<v.length&&(v=v.substring(0,400)+"[...]"+v.substring(v.length-400,v.length));l.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',
v);this.t3a(z.data);return}E=I.selectSingleNode("/docdata/status")}a.AFrameworkApplication.ova&&z.data.jj[k.PageStats.kNb]&&(this.y3c+=z.data.jj[k.PageStats.kNb].toString());E&&("InProgress"===E.text&&this.zZa++<t.au.P4d||"ServiceBusy"===E.text&&3>this.AZa++)?(l.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",E.text,this.zZa+this.AZa,this._url),this.FIa(t.au.jag*(this.zZa+this.AZa))):(I=E?E.text:null,l.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",
I,this._url),4<v&&l.ULS.sendTraceTag(524104657,301,15,"Request Complete. Result: {0}; Url: {1}; Retry: {2}",I,this._url,v),a.AFrameworkApplication.ova&&""!==this.y3c&&(z.data.jj[k.PageStats.kNb]=this.y3c,this.y3c=""),this.xv(!0,I,z.data))}Bqa(z){this.Feb?(t.yCa||(t.rcb=new Date,t.yCa=!0,t.wT=1),(new Date).getTime()-t.rcb.getTime()<t.au.p9n?(this.retryOnFailure(4<=t.wT?t.au.j9n:t.au.jag),4===t.wT&&(t.eAc=this.z7.Eva(CommonUIStrings.l_NetworkProblemToast,!0),this.z7.sA(t.eAc))):this.t3a(z.data)):4>
t.wT?this.retryOnFailure(2*t.au.jag):this.t3a(z.data)}FIa(z){z=new y.a(2,1,z,Object(e.a)(this,this.makeRequest,"makeRequest"),94);a.AFrameworkApplication.lc.Wb(z)}retryOnFailure(z){this.FIa(z);t.wT++}t3a(z){l.ULS.sendTraceTag(524104658,301,15,"Request failed - giving up (failures "+t.wT+"): "+this._url);this.xv(!1,null,z)}P7c(){t.yCa=!1;t.wT=0;if(t.eAc){this.z7.removeEntry(t.eAc);t.eAc=null;const z=this.z7.Eva(CommonUIStrings.l_NetworkRestoredToast,!1);z.image=3;this.z7.sA(z)}}static I8(z,v,I){return t.Nrl(z,
v,I)}static Nrl(z,v,I){if(x.a.instance.gva()&&a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.hAf)return!1;(new t(I)).send(z,null,null,null,v,!1);return!0}static eYm(z){return!!z&&"undefined"!==typeof z.selectSingleNode}}t.rcb=null;t.yCa=!1;t.wT=0;t.eAc=null;t.au=new n;Object(D.a)(t,"ClientRequestWithRetry",null,[])},2001:function(D,J,c){D=c(0);var l=c(7),e=c(55),a=c(2),k=c(39);const x=(L,S,Q)=>{if(L){var N=0;do{try{L();break}catch(O){if(l.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",
N,Q,O.message,O.stack),N>=S)break}N++}while(1)}};var y=c(93),n=c(30),t=c(35),z=c(205),v=c(170),I=c(46),E=c(316),H=c(20),M=c(139);c.d(J,"a",function(){return K});class K{constructor(L,S,Q,N,O,X,U,T,Y=!0,aa=null,ba=!1){this.R_h="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.Jl=this.wvc=this.ABe=this.p_a=this.Rld=this.DE=this._form=null;this.Oh=!1;this.lz=this.Sld=this.Ceb=null;this._parent=L;this.A7j=S;this.Yhk=Q;this.$Wg=O;this.FCa=U;this.cLg=T;this.BOg=aa;this.MXe=!1;this.A8j=N.$("CanaryRenewalForFileUploadIsEnabled");
this.A1o=!1;(this.Wcb=ba)||this.H9k(X);Y&&this.hCf()}get hfj(){return this.Yhk}get sessionId(){return this.FCa}get iFrame(){return this._iframe}get WO(){return this.DE}get knb(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get L_h(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get KQm(){return this.Wcb?!1:v.b(this._iframe.contentWindow.location.pathname,this.R_h,0)}get tCk(){return!H.a.Cpa&&
a.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}hCf(){this.lz=M.a.create().toString();this.Wcb?this.cjf():this.oEk()}H9k(L){this._iframe=document.createElement("iframe");this._iframe.className=L;this._iframe.id=L;this.$Wg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.p_a=Object(e.a)(this,this.BZf,"onUploadFrameLoad");k.a.addHandler(this._iframe,"load",this.p_a)}yMc(L=null){a.AFrameworkApplication.ta.Jae();
if(!this.DE)return l.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";k.a.addHandler(this.DE,"change",()=>{this.TCl(L)});x(Object(e.a)(this,this.K_h,"fileInputClick"),1,"DoFileOpenDialog");return this.DE.value}TCl(L){L&&L(this.DE.value)}UCl(){this.Rld&&(this.Rld.innerText=this.hbi())}JXn(L){k.a.addHandler(this.DE,"change",()=>{L(this.hbi())})}hbi(){let L=null;if(this.DE.value){const S=this.DE.value,Q=S.lastIndexOf("\\");0<Q&&(L=S.substring(Q+1,S.length))}return L?L:""}K_h(){try{l.ULS.sendTraceTag(35939520,
322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.DE.click()}catch(L){throw l.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",L.message),L;}}rbd(){this.kVm()?this.qxj():(this.Lqg(),this._form.submit())}kVm(){return(this.A8j||this.Wcb)&&!(void 0===window.self.FormData||null===window.self.FormData)}Xjj(L){if(L){const S=this.sLh();this.Jl=new XMLHttpRequest;this.Jl.open("POST",S);this.Jl.setRequestHeader("X-CorrelationId",this.lz);this.U5m(L);this.Jl.onreadystatechange=
Object(e.a)(this,this.Nea,"uploadResponseReceived");this.Jl.send(L)}}U5m(L){if(!H.a.Cpa&&L.get){var S=L.get("ImageId");L=window.self.navigator;S={["CorrelationId"]:this.lz,["Canary"]:a.AFrameworkApplication.canary,["ImageNodeId"]:S};L&&(L=L.connection?L.connection:L.mozConnection?L.mozConnection:L.webkitConnection?L.webkitConnection:null)&&(S.effectiveType=L.effectiveType,S.downlink=L.downlink,S.type=L.type,S.rtt=L.rtt);l.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",
S)}}qxj(){try{this.Lqg();l.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const L=new (Type.parse("FormData"))(this._form);this.Xjj(L)}catch(L){l.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+L.message),this.ZMb(null)}}pxj(L){try{if(this.Lqg(),l.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.c3o(L)){this.Sld=L;this._form.contains(this.DE)&&
this._form.removeChild(this.DE);var S=new (Type.parse("FormData"))(this._form);S.append("applicationfileInput",L.blob,L.filename);this.Xjj(S)}else this.ZMb(null)}catch(Q){l.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Q.message),this.ZMb(null)}}c3o(L){return L&&void 0!==L.blob&&null!==L.blob&&void 0!==L.filename&&null!==L.filename&&""!==L.filename?void 0===window.self.FormData||null===window.self.FormData?(l.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),
!1):!0:(L=L?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===L.blob||null===L.blob,void 0===L.filename||null===L.filename||""===L.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",l.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",L)),!1)}Nea(){if(4===this.Jl.readyState)if(200===this.Jl.status){l.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.lz);const L=this.Jl.getResponseHeader("X-NewKey"),S=this.GJm(this.Jl);let Q=!1;if(void 0!==L&&null!==L&&S&&(Q=this.N2o(L),!this.MXe&&Q)){l.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.lz);this.MXe=!0;this.NKc();void 0!==this.Sld&&null!==this.Sld?this.pxj(this.Sld):this.qxj();return}l.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.MXe,S,!(void 0===L||null===L),Q,this.lz);this.ZMb(this.Jl.responseText)}else l.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Jl.status,this.Jl.responseText?!1:!0,this.lz),this.ZMb(null)}GJm(L){try{const S=t.a(L.responseText).Responses;if(void 0!==S&&null!==S&&1===S.length){const Q=S[0];if(void 0!==Q&&null!==Q&&2===Q.length&&28===Q[1].StatusCode)return!0}}catch(S){}return!1}N2o(L){E.a.xpg(L);return a.AFrameworkApplication.canary!==
L?!1:!0}Lqg(){this.Ceb||(this.Ceb=new Date)}dispose(){this.Oh||(this.Wcb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),k.a.removeHandler(this._iframe,"load",this.p_a),this.p_a=null),this.ABe&&(k.a.removeHandler(this.DE,"change",this.ABe),this.ABe=null),this.L_h&&(this.wvc&&(k.a.removeHandler(this.DE,"change",this.wvc),this.wvc=null),this.Rld=null),this.DE=this._form=this._parent=this._iframe=null,this.Oh=!0,this.Ceb=null,l.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}Z5b(L,
S){if(this._form){var Q;(Q=this._form.querySelector("input[name="+L+"]"))?Q.value=S:(Q=this.Pbf(),Q.type="hidden",Q.id=L,Q.name=L,Q.value=S,this._form.appendChild(Q))}}Pbf(){return this.Wcb?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}BZf(){try{if(!this._iframe.contentWindow.document.body)return}catch(S){this.Aac();return}if(!(this._initialized||this.knb&&H.a.WG))this.cjf();else if(!this.knb||!H.a.WG||this.KQm){let S;S=H.a.ht?this._iframe.contentWindow.document.body.innerText:
this.A1o?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var L=this._iframe.contentWindow.document.body.innerText.toLowerCase();const Q=0<=L.indexOf("responses")||0<=L.indexOf("wopisrc");L=0<=L.indexOf("http error");!Q&&L&&l.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.ZMb(S)}}cjf(){if(!this._initialized){var L=this.JB("uploadForm");
const S=this.JB("fileInput"),Q=this.sLh();this.dbl();this._form.id=L;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=Q;this.DE.type="file";this.cLg&&(this.DE.accept=this.cLg,this.BOg&&(this.DE.capture=this.BOg));this.DE.id=S;this.DE.name=S;this.tCk&&(this.DE.multiple=!0);!this.L_h||H.a.ht||H.a.Nt||(this.wvc=Object(e.a)(this,this.UCl,"fileInputChangedHandleAccessibility"),k.a.addHandler(this.DE,"change",this.wvc),this.Rld=n.a.Sth(this._form,this.DE,"InputFileDescription"));
this.$Wg&&(this.Wcb||(L=this._iframe.contentWindow.document.body,L.style.margin="0",L.style.overflow="hidden"),L=a.AFrameworkApplication.ta,this.DE.style.fontFamily=L.nAa,this.DE.style.fontSize=L.Qog,this.DE.style.margin="0");(L=document.getElementById("__REQUESTDIGEST"))&&this.Z5b("__REQUESTDIGEST",L.value);this.NKc();this._form.appendChild(this.DE);this._initialized=!0;this.A7j(this)}}dbl(){if(this.Wcb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.DE=document.createElement("input");
else{this._form=this._iframe.contentWindow.document.createElement("form");const L=this._iframe.contentWindow.document;L.body.appendChild(this._form);this.DE=L.createElement("input")}}oEk(){this._parent.appendChild(this._iframe);this.knb&&H.a.WG&&this.cjf()}sLh(){var L=new z.QueryStringBuilder(this.R_h);a.AFrameworkApplication.qga(L);this.Lkj(L);L=L.toString();if(H.a.Dj||H.a.WG||H.a.Nt)L=I.a.l9b(L);return L}WBd(){const L=new y.a(2,1,0,Object(e.a)(this,this.delayedDispose,"delayedDispose"),4);a.AFrameworkApplication.lc.Wb(L)}}
Object(D.a)(K,"UploadFrame",null,[10])},2002:function(D,J,c){D=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(D.a)(l,"QueueNode",null,[]);c.d(J,"a",function(){return e});class e{constructor(){this.rvb=this.mtb=null;this.$j=0}get count(){return this.$j}get isEmpty(){return!this.count||!this.mtb||!this.rvb}enqueue(a){a=new l(a);this.isEmpty?this.rvb=this.mtb=a:this.mtb=this.mtb.next=a;this.$j=this.count+1}back(){return this.isEmpty?null:this.mtb.data}dequeue(){if(this.isEmpty)return null;
const a=this.rvb;this.rvb=a.next;this.$j=this.count-1;this.rvb||(this.mtb=null);return a.data}clear(){this.rvb=this.mtb=null;this.$j=0}toArray(){const a=Array(this.count);let k=this.rvb;for(let x=0;x<this.count&&k;x++)a[x]=k.data,k=k.next;return a}}Object(D.a)(e,"Queue",null,[])},2060:function(D,J,c){c.d(J,"b",function(){return l});c.d(J,"e",function(){return e});c.d(J,"d",function(){return a});c.d(J,"c",function(){return k});c.d(J,"h",function(){return x});c.d(J,"a",function(){return y});c.d(J,"f",
function(){return n});c.d(J,"g",function(){return t});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=2]="Floating"})(l||(l={}));var e;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(e||(e={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=
5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]=
"DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=
17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var n;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=
7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(n||(n={}));var t;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(t||(t={}))},2063:function(D,J,c){c.d(J,"a",function(){return l});
D=c(0);var l;(function(e){e[e.normal=0]="normal";e[e.beingCreated=1]="beingCreated";e[e.beingEdited=2]="beingEdited"})(l||(l={}));Object(D.b)("CommentType",l)},2065:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(l,"DeltaAttributes",null,[])},2066:function(D,J,c){c.d(J,"a",function(){return l});
D=c(0);class l{static asf(e){return e===l.create?0:e===l.reply?1:e===l.edit?2:e===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(D.a)(l,"CommentSessionType",null,[])},2067:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.unsaved=0]="unsaved";e[e.sentToServer=1]="sentToServer";e[e.succeeded=2]="succeeded";e[e.failed=3]="failed";e[e.saveNotNeeded=4]="saveNotNeeded"})(l||(l={}));Object(D.b)("CommentSaveStatus",l)},2068:function(D,
J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this.className=e;this.RSc=a}}Object(D.a)(l,"HighlightCssClassPair",null,[])},2069:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(){this.type=this.action=0;this.WJ=this.HA=null}}Object(D.a)(l,"HighlightOperation",null,[])},2070:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(532);J=c(233);var e=c(113);class a extends J.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=
null}ml(){return l.a.pagination}static Uba(k,x){const y=new a;y.FileId=k;y.LastKnownPaginationRevision=e.a(x);return y}}Object(D.a)(a,"PaginationRequest",J.a,[])},2072:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{P$b(e,a){let k="g";a.matchCase||a.G4d||(k+="i");if(a.matchPrefix||a.matchWholeWord)e="\\b"+e;if(a.matchSuffix||a.matchWholeWord)e+="\\b";return new RegExp(e,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;Object(D.a)(l,"FindUtils",null,
[1321])},2074:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e,a){this._text=e;this.Bvc=a}get text(){return this._text}get matchCase(){return this.TJb(1)}get matchWholeWord(){return this.TJb(2)}get G4d(){return this.TJb(4)}get matchPrefix(){return this.TJb(8)}get matchSuffix(){return this.TJb(16)}get ignorePunct(){return this.TJb(32)}get ignoreSpace(){return this.TJb(64)}TJb(e){return(this.Bvc&e)===e}static createQuery(e,a){return new l(e,a)}}Object(D.a)(l,"Query",null,
[1319])},2075:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.none=0]="none";e[e.matchCase=1]="matchCase";e[e.wholeWordOnly=2]="wholeWordOnly";e[e.wildCards=4]="wildCards";e[e.prefix=8]="prefix";e[e.suffix=16]="suffix";e[e.ignorePunct=32]="ignorePunct";e[e.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(D.b)("QueryFilters",l)},2076:function(D,J,c){c.d(J,"a",function(){return y});D=c(0);var l=c(156),e=c(177),a=c(2),k=c(67),x=c(203);class y extends l.a{constructor(n,
t=!1){super(n,!1,t)}get yXc(){return!1}get iL(){return x.a.cMc+"/modeless"}get tmb(){return null}set tmb(n){}get omb(){return null}set omb(n){}Uh(n,t=null,z=null){this.HT&&(z.isModal=!1);super.Uh(n,t,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Kc)this.ZGj(),a.AFrameworkApplication.ta.xx.fx(e.AFrame.yQf),super.hide()}btk(){const n=a.AFrameworkApplication.ta.xx,t=a.AFrameworkApplication.ta.Hp;n.U7(this.iL);
n.MT(this.iL);t.fe(this.iL).parent=e.AFrame.Ap}jDa(){k.FocusManager.nK()&&(super.jDa(),this.btk(),a.AFrameworkApplication.ta.xx.aJ(e.AFrame.yQf))}o8f(){if(k.FocusManager.nK()&&!a.AFrameworkApplication.Qk){const n=k.FocusManager.instance();n.hS(this.iL);const t=n.getRegion(this.iL);t&&t.hk.iz(null);n.q7a(this.iL)}}Yda(){"DL"===this.aDa||"DP"===this.aDa?super.Yda():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.ZGj(),this.cxh()&&this.nuj(this.Kc.clientHeight,
this.Kc.clientWidth)):this.LL()}LL(){this.nuj(l.a.dSg,l.a.kSg)}nuj(n,t){if(this.omb&&this.tmb){let z,v;z=x.a.Cae+this.tmb;v=x.a.Bae+this.omb;z+n>this.IB()&&(z=this.IB()-n);v+t>this.ru()&&(v=this.ru()-t);this.ouj(z,v)}else super.LL()}ptf(n){if(!n)return null;n.endsWith("px")&&(n=n.substring(0,n.length-2));return x.a.zdc(n)?((n=parseInt(n))||(n=1),n):null}ZGj(){if(this.Kc&&this.Kc.style){var n=this.ptf(this.Kc.style.top);n&&(this.tmb=n-x.a.Cae);if(n=a.AFrameworkApplication.isRtl?this.ptf(this.Kc.style.right):
this.ptf(this.Kc.style.left))this.omb=n-x.a.Bae}}}Object(D.a)(y,"ModelessCustomDialog",l.a,[])},2077:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);var l;(function(e){e[e.connected=0]="connected";e[e.disconnected=1]="disconnected";e[e.connecting=2]="connecting";e[e.timeout=3]="timeout"})(l||(l={}));Object(D.b)("AppNetworkConnectivityState",l)},2078:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{OPa(){}F8b(){}hie(){}Dge(){}reset(){}Glf(){}update(){}lqb(){}dispose(){}}Object(D.a)(l,
"FindStatusManagerStub",null,[468,10])},2086:function(D,J,c){c.d(J,"b",function(){return l});c.d(J,"a",function(){return e});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var e;(function(a){a.left="left";a.center="center";a.right="right";a.both="both"})(e||(e={}))},2087:function(D,J,c){c.d(J,"a",function(){return e});D=c(0);var l=c(775);class e{static for(a){return[l.b.getTypeName(),
a.getTypeName()]}}Object(D.a)(e,"RequestSignalParentPath",null,[])},2088:function(D,J,c){c.d(J,"a",function(){return a});D=c(0);var l=c(774),e=c(1785);class a{constructor(k){this.jfd=!1;this.operation=k}static zFb(k){return new a(k)}LUc(){this.jfd=!0;return this}Zpe(k){this.UHd=this.V5e(k);return this}build(){let k;this.UHd&&(k={LUc:this.jfd,UHd:this.UHd});return{operation:this.operation,$$f:k}}V5e(k){const {annotation:x,ELb:y,nt:n="add"}=k,t=e.a.lAj(y);return(z,v)=>z.annotationType!==x.getTypeName()||
v!==this.Wam(n)?!1:t.execute(z)}Wam(k){switch(k){case "add":return l.a.getTypeName();case "update":return l.n.getTypeName();case "delete":return l.b.getTypeName();default:throw Error(`Unknown operation type: "${k}"`);}}}Object(D.a)(a,"AugloopRequestBuilder",null,[1935,1936,1937])},2089:function(D,J,c){c.d(J,"a",function(){return l});D=c(0);class l{constructor(e){this.parentId=e;this.execute=a=>a.parentPath.endsWith(this.parentId)}}Object(D.a)(l,"ParentIdAnnotationMatcher",null,[1933])},2110:function(D,
J,c){D=c(0);var l=c(1635),e=c(1636),a=c(1695),k=c(225),x=c(35);class y{}y.eventType="Type";y.$hb="Time";y.eventId="Id";y.Kwh="AttributionId";y.Lwh="AttributionProvider";y.Jwh="AttributionName";y.twh="AssigneeId";y.uwh="AssigneeProvider";y.swh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.aHh="Anchor";y.anchorExtensionList="AnchorExtensionList";y.Z1i="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy="IsLossy";y.recordExtensionList="RecordExtensionList";Object(D.a)(y,
"Key",null,[]);var n=c(368),t=c(1840);const z=I=>{if(!I)return null;let E=null;I=n.a.mDb(I,H=>H.toString(),H=>H.toString());0<I.count&&(E=new t.a(I));return E};c.d(J,"a",function(){return v});class v{Pcg(I){if(!I)return"[]";I=v.J7k(I);return x.c(I)}W6b(I){I=x.b(I||"[]");return v.s7k(I)}static Kea(I,E){throw Error.argument(I,E);}static y$b(I,E){E=E.toString();return E in I?I[E].toString():null}static kHb(I,E){E=E.toString();E in I||v.Kea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",
E));return I[E].toString()}static dsf(I,E){E=E.toString();E in I||v.Kea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",E));return Number.parseInvariant(I[E].toString())}static Y7l(I,E,H){E=E.toString();return E in I?Boolean.parse(I[E].toString()):H}static Z7l(I,E){E=E.toString();return E in I?I[E]:null}static $jg(I){I=new Date(I);isNaN(I.getUTCMilliseconds())&&v.Kea("dateTime","Date and time is in invalid format");return I}static cef(I){return I.toISOString()}static sMh(I,
E){return z(v.Z7l(I,E))}static K7k(I){const E={};E[y.eventType]=I.type;E[y.$hb]=v.cef(I.time);E[y.eventId]=I.recordId;I.isLossy!==v.pAi&&(E[y.isLossy]=I.isLossy);I.user&&(I.user.UserId&&I.user.Provider&&I.user.DisplayName||v.Kea("record","HistoryRecord has invalid attribution"),E[y.Kwh]=I.user.UserId,E[y.Lwh]=I.user.Provider,E[y.Jwh]=I.user.DisplayName);I.commentId&&(E[y.aHh]=I.commentId);if(I.anchorExtensionList&&I.anchorExtensionList.extensions){var H=I.anchorExtensionList.extensions.Znc();E[y.anchorExtensionList]=
H}I.recordExtensionList&&I.recordExtensionList.extensions&&(H=I.recordExtensionList.extensions.Znc(),E[y.recordExtensionList]=H);switch(I.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:I.assignee&&I.assignee.UserId&&I.assignee.Provider&&I.assignee.DisplayName||v.Kea("record","HistoryRecord has invalid assignee");E[y.twh]=I.assignee.UserId;E[y.uwh]=I.assignee.Provider;E[y.swh]=I.assignee.DisplayName;break;case 5:I.schedule||v.Kea("record","Schedule history record must have a schedule object");
I.schedule.startDate&&(E[y.startDate]=v.cef(I.schedule.startDate));I.schedule.endDate&&(E[y.endDate]=v.cef(I.schedule.endDate));break;case 6:(0>I.completion||100<I.completion)&&v.Kea("record","Progress history record must have a completion >= 0 and <= 100");E[y.Z1i]=I.completion;break;case 10:(0>I.priority||10<I.priority)&&v.Kea("record","Priority history record must have a completion >= 0 and <= 10");E[y.priority]=I.priority;break;case 9:I.title||v.Kea("record","SetTitle history record must have a title");
E[y.title]=I.title;break;case -1:I.undoId||v.Kea("record","Undo history record must have an id to undo");E[y.undoId]=I.undoId;break;default:v.Kea("record","Unsupported history record type")}return E}static T7k(I){var E=null,H=v.y$b(I,y.Kwh);const M=v.y$b(I,y.Lwh),K=v.y$b(I,y.Jwh);if(H||M||K)H&&M&&K||v.Kea("dictionary","Record has invalid attribution user"),E=new l.a(H,M,K);E=new e.a(v.dsf(I,y.eventType),E,v.$jg(v.kHb(I,y.$hb)),v.kHb(I,y.eventId));E.commentId=v.y$b(I,y.aHh);E.anchorExtensionList=v.sMh(I,
y.anchorExtensionList);E.recordExtensionList=v.sMh(I,y.recordExtensionList);E.isLossy=v.Y7l(I,y.isLossy,v.pAi);switch(E.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:E.assignee=new l.a(v.kHb(I,y.twh),v.kHb(I,y.uwh),v.kHb(I,y.swh));break;case 5:E.schedule=new a.a;if(H=v.y$b(I,y.startDate))E.schedule.startDate=v.$jg(H);if(I=v.y$b(I,y.endDate))E.schedule.endDate=v.$jg(I);break;case 10:E.priority=v.dsf(I,y.priority);(0>E.priority||10<E.priority)&&v.Kea("dictionary","Priority record must have history >= 0 and <= 10");
break;case 6:E.completion=v.dsf(I,y.Z1i);(0>E.completion||100<E.completion)&&v.Kea("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:E.title=v.kHb(I,y.title);break;case -1:E.undoId=v.kHb(I,y.undoId);break;default:v.Kea("dictionary","Unsupported history record type")}return E}static J7k(I){const E=Array(I.length);for(let H=0;H<I.length;++H)E[H]=v.K7k(I.J(H));return E}static s7k(I){const E=new k.a;for(const H of I)I=v.T7k(H),E.add(I);return E}}v.pAi=!1;Object(D.a)(v,"JsonTaskHistorySerialization",
null,[707])},2111:function(D,J,c){D=c(0);class l{constructor(){this.skg=new Set}subscribe(z){this.skg.add(z)}unsubscribe(z){this.skg.delete(z)}KB(z,v){for(const I of this.skg)try{I.filter(z,v)&&I.action(z,v)}catch{}}}Object(D.a)(l,"DelegatingAnnotationEventHandlerImpl",null,[]);var e=c(401),a=c(371),k=c(250),x=c(1543);class y{constructor(){this.L_=[]}enqueue(z){var v;this.L_.push(z);null===(v=this.promise)||void 0===v?void 0:v.resolve()}async dequeue(){0===this.L_.length&&(this.promise=new x.a,await this.promise.completion);
return this.L_.shift()}}Object(D.a)(y,"BlockingQueue",null,[]);class n{constructor(z,v,I,E){this.tA=z;this.e3b=v;this.X3=I;this.lrn=async()=>{await e.a.ll();return this.X3.getAugLoopRuntimeManager()};this.lhj=new k.a(this.lrn);this.Yqk=this.Oqk(E.map(H=>H.getTypeName()))}async executeRequest(z){const v=z.operation;if(z=z.$$f)return z=this.bro(z),await this.submitOperation(v),z;await this.submitOperation(v)}async oZh(z){const v=z.operation;z=z.$$f;if(!z)throw Error("Streaming request must have result handling");
z=this.gro(z);await this.submitOperation(v);return z}async dispose(){await this.lhj.value;for(const z of this.Yqk)this.tA.uc(this.e3b,z)}bro(z){const v=z.LUc,I=z.UHd;let E;return(new Promise(H=>{E={filter:I,action:M=>{v?H(M):H(M.content)}};this.e3b.subscribe(E)})).finally(()=>{this.e3b.unsubscribe(E)})}gro(z){const v=z.LUc,I=z.nEf;z=z.YHd;const E=new x.a,H=new y,M={filter:z,action:K=>{H.enqueue(v?K:K.content)}};this.e3b.subscribe(M);return{chunks:this.Uql({[Symbol.asyncIterator](){return{async next(){const K=
await H.dequeue();return I(K)?(E.resolve(K),{value:void 0,done:!0}):{value:K,done:!1}}}}},()=>{this.e3b.unsubscribe(M)}),completion:E.completion}}async *Uql(z,v){try{for await(const I of z)yield I}finally{v()}}async submitOperation(z){(await this.lhj.value).submitOperation(Object.assign(new a.a,{operation:z}))}Oqk(z){const v=new Set;for(const I of z)v.add(I)&&this.tA.ob(this.e3b,I);return v}}Object(D.a)(n,"AugloopAsyncClientImpl",null,[1972]);c.d(J,"a",function(){return t});class t{constructor(z,
v){this.tA=z;this.X3=v}R5b(z){return new n(this.tA,new l,this.X3,z.mDd)}}Object(D.a)(t,"AugloopAsyncClientFactory",null,[])},2113:function(D,J,c){D=c(0);class l{constructor(k){this.result=null;this.C9i=k}exec(k){return(this.result=this.C9i.exec(k))?!0:!1}AJ(){return this.result.index}USd(){return this.C9i.lastIndex}}Object(D.a)(l,"RegularExpressionWrapper",null,[]);var e=c(19);c.d(J,"a",function(){return a});class a{C4c(k){return this.zvj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}$3i(k){var x=
k.text;x=k.G4d?this.FCo(x):this.zvj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.ULn);y="["+y+"]*";for(let n=1;n<x.length;n++)if(!k.G4d||"{"!==x[n].charAt(0)&&"@"!==x[n].charAt(0))x[n]=y+x[n]}return x.join("")}vNb(k){return[k]}R1d(k){for(let x=0;x<k.length;++x){const y=k.charAt(x);let n=0;if("["===y){if(!({XD:n}=this.VVm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("<"===y){if(!this.SVm(k.substr(x)))return!1}else if(">"===y){if(!x)return!1}else if("{"===
y){if(!x||!({XD:n}=this.UVm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("@"===y){if(!x||!this.TVm(k.substr(x)))return!1}else if("("===y){if(!({XD:n}=this.RVm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}Z0h(k,x){let y,n;n=y=0;if(k.length<=x)return{returnValue:!1,XD:y,Yed:n};const t=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<t;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,n=5,{returnValue:!0,XD:y,Yed:n}}else if("{"===z)for(z=-1,x+=1;x<
t;x++){let v=k.charAt(x);if(","===v)z=x;else if("}"===v)return n=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,XD:y,Yed:n}}return{returnValue:!1,XD:y,Yed:n}}GRo(k,x,y){let n;if((n=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let t,z;if(!({XD:t,Yed:z}=this.Z0h(k,x+1)).returnValue)return{returnValue:this.TJa("*",y,!1),XD:n};k=this.TJa("*",y,!0)+this.TJa(k.substring(x+1,t+1),z);n=t;if(7===z||8===z)k+="?";return{returnValue:k,XD:n};case "@":return n=x+1,{returnValue:this.TJa("*",y,!0),XD:n};case "*":if(!x){for(n++;"*"===
k.charAt(n);)n++;if(n===k.length)return{returnValue:this.TJa("*",y,!0),XD:n}}return{returnValue:this.TJa("*",y,!1),XD:n};default:return{returnValue:this.TJa("*",y,!1),XD:n}}else return{returnValue:this.TJa(k,y,!0),XD:n}}TJa(k,x,y=!1){const n=k.length;switch(x){case 5:return"!"===k.charAt(1)&&2<n?"([^"+this.b4i(k.substr(2,n-3))+"]\u0640*)":"(["+this.b4i(k.substr(1,n-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";case 4:return"\\b";case 1:return".";
case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}Kki(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}xGn(k){return"["===k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===k||'"'===k||"\u201c"===k||"\u201d"===k||e.a.qda(k)?this.q3f(k):k}b4i(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.xGn(k.charAt(y));return x.join("")}VVm(k){let x;var y;x=-1;var n=new l(RegExp("\\[.+?\\]",
"g"));if(n.exec(k)){if(y=n.AJ())return{returnValue:!1,XD:x};x=n.USd()}else return{returnValue:!1,XD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,XD:x};y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){n=y.AJ();const t=RegExp("[-]","g");n=k.substring(n,y.USd()).split(t);if(n[0].charAt(0)>n[1].charAt(0))return{returnValue:!1,XD:x}}return{returnValue:!0,XD:x}}SVm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(k)?
!1:!0}UVm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,XD:x};const n=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(n.exec(k)){if(y=n.AJ())return{returnValue:!1,XD:x};x=n.USd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,XD:x}}else return{returnValue:!1,XD:x};return{returnValue:!0,XD:x}}TVm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?!1:
!0}RVm(k){let x;x=-1;let y;const n=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(n.exec(k)){y=n.AJ();x=n.USd();if(y)return{returnValue:!1,XD:x};if(this.R1d(k.substring(1,x-1)))return{returnValue:!0,XD:x}}return{returnValue:!1,XD:x}}FCo(k){const x=[],y=k.length;let n=0;for(let t=0;t<y;++t){const z=n,v=k.charAt(t);let I=0,E=0;"["===v||"\\"===v||"^"===v||"$"===v||"."===v||"|"===v||"+"===v||"("===v||")"===v||"?"===v||"*"===v||"<"===v||">"===v||"@"===v||"?"===v||"{"===v?"["!==v&&"{"!==v||!({XD:I,
Yed:E}=this.Z0h(k,t)).returnValue?"?"===v||"<"===v||">"===v||"@"===v?(E=this.Kki(v),x[z]=this.TJa(v,E)):"*"===v?(E=this.Kki(v),x[z]=({XD:I}=this.GRo(k,t,E)).returnValue,t=I):"("===v||")"===v?(E=10,x[z]=this.TJa(v,E)):x[z]=String.format("\\{0}",v):(x[z]=this.TJa(k.substr(t,I+1-t),E),t=I):x[z]="'"===v||"\u2018"===v||"\u2019"===v||'"'===v||"\u201c"===v||"\u201d"===v||"-"===v||"\u2013"===v||"\u2014"===v||e.a.qda(v)?"["+this.q3f(v)+"]":"\u2026"===v?"\\.\\.\\.":v;""!==x[z]&&0===E&&(x[z]=t<k.length-1&&("@"===
k.charAt(t+1)||"{"===k.charAt(t+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");n++}return x}zvj(k){const x=[];for(let y=0;y<k.length;++y){const n=k.charAt(y);x[y]="["===n||"\\"===n||"^"===n||"$"===n||"."===n||"|"===n||"+"===n||"("===n||")"===n||"?"===n||"*"===n?String.format("\\{0}",n):"'"===n||"\u2018"===n||"\u2019"===n||'"'===n||"\u201c"===n||"\u201d"===n||"-"===n||"\u2013"===n||"\u2014"===n||e.a.qda(n)?"["+this.q3f(n)+"]":"\u2026"===n?"\\.\\.\\.":n;""!==x[y]&&(x[y]+="\u0640*")}return x}q3f(k){return"'"===
k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":e.a.qda(k)?a.ISo:k}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.ISo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.ULn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(D.a)(a,"WordQueryProcessor",null,[1153])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20380705/wdjs/WordEditorDSVersionHistoryRemoved.common.js.map